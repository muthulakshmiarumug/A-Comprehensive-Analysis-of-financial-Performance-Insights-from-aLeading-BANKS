'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1488:function(E,K,c){E=c(0);var l=c(15),f=c(42),a=c(6),k=c(116),x=c(168),y=c(800),n=c(223),u=c(602),z=c(2),w=c(365),F=c(22),G=c(55),H=c(243),L=c(1),I=c(1558);class N{constructor(X,W){this.E1j=X;this.kA=W}J(X){return this.E1j.lz(X,this.kA)}}Object(E.a)(N,"PropertyMergeStrategies",null,[]);var P=c(1629),M=c(1581);class J extends M.a{constructor(){super();this.HZc=this.V3d=this.Mn=null;this.rae=0}get lga(){return"Property"}fEb(){this.detail.Z("Type",
this.lga);this.detail.Z("ComplexMerger",null!=this.Mn?this.Mn:-1);this.detail.Z("Strategy",null!=this.V3d?this.V3d:-1);this.detail.Z("ClassId",null!=this.HZc?this.HZc:-1);this.detail.Z("PropId",this.rae);return this.detail}}Object(E.a)(J,"PropertyMergeFailureDetail",M.a,[]);c.d(K,"a",function(){return V});class V{constructor(X=null){this.gbh=this.Xb=null;this.ZWb=X||this.BOc()}get Mn(){return 1}get jlb(){return this.ZWb}BOc(){return[Object(G.a)(this,this.jOo,"tryPreProcessFavoredRevision"),Object(G.a)(this,
this.dZk,"cloneObjectAndRemoveNeededProperties"),Object(G.a)(this,this.$No,"tryMergeNodeInternal")]}get kA(){return 5}get tae(){return this.gbh||(this.gbh=new N(this.uk(),this.kA))}aC(X,W){const U=X.Ng.value.yf;x.a.instance.Ta(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",U.id,U.Qc);X.iq.logger.Og(Object.assign(new J,{Mn:this.Mn,HZc:U.Qc,rae:W}));return!1}Hkg(X){const W=X.Ng.value;x.a.instance.Ta(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.yf.id,W.yf.Qc);for(let U=0;U<this.jlb.length;U++)if(!(0,this.jlb[U])(X))return x.a.instance.Ta(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.yf.id,W.yf.Qc,U),X.iq.logger.y2d("GraphNodeComplexMerge.GetMergeFunctions()",U),this.W1m(X),X.Uk=null,!1;x.a.instance.Ta(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",W.yf.id,W.yf.Qc);
return!0}W1m(X){X.Fog||(X.Fog=!0,P.a(X.Ng.value.Ku,"Base",1),P.a(X.Ng.value.yf,"Favored",1),P.a(X.vn.value.yf,"Conflict",1))}jOo(X){const W=X.Ng.value,U=this.tae;if(!W.bY)return!0;let Y=!0;W.Mpa.forEach((ca,aa)=>{if(!aa.bY||X.sg.contains(ca))return!0;aa=U.J(ca);if(5===aa){const fa=W.Ku.Qc;x.a.instance.Ta(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",fa,ca,aa);X.iq.logger.Og(Object.assign(new J,
{Mn:this.Mn,HZc:fa,rae:ca,V3d:aa}));return Y=!1}6===aa&&X.I0f.add(ca);return!0});return Y}dZk(X){X.Uk=X.Ng.value.yf.IK();const W=X.I0f,U=X.Uk;W&&W.forEach(Y=>{U.removeProperty(y.a.wX(Y));return!0});return!0}$No(X){const W=X.vn.value,U=W.Ku.Qc,Y=this.tae;let ca=!0;W.Mpa.forEach((aa,fa)=>{const pa=Y.J(aa);ca=this.aOo(X,fa,aa,pa);ca||(X.Uk=null,x.a.instance.Ta(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",U,aa,pa),X.iq.logger.Og(Object.assign(new J,{Mn:this.Mn,
HZc:U,rae:aa,V3d:pa})));return ca});return ca}aOo(X,W,U,Y){const ca=X.Uk;if(!W.bY&&8!==Y||2===Y||7===Y||X.sg.contains(U))return!0;if(5===Y)return!1;if(4===Y||3===Y){let aa;if(({value:aa}=X.Ng.value.Mpa.Dc(U)).returnValue&&aa.bY)return 4!==Y;Y=0}8===Y&&(Y=0);if(0===Y){if(!W.isDeleted)return X=y.a.wX(U),(V.v0o(W,U,X)||V.fso())&&ca.YSa(X,W.newValue),!0;Y=6}return 6===Y?(ca.removeProperty(y.a.wX(U)),!0):1===Y?this.aC(X,U):!1}Pbn(X,W,U,Y,ca,aa){X=X||new n.a;W=W||new n.a;U=U||new n.a;var fa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
X.length,W.length,U.length),pa=X.length<=W.length&&X.length<=U.length;this.kyi()&&pa&&x.a.instance.Ta(541181455,1,1,fa);if(!pa&&this.qwi(aa.runtime.Xb))return null;if(this.kyi())for(fa=0;fa<X.length;fa++){pa=X.eg(fa);var ra=W.eg(fa);let la=U.eg(fa);pa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",pa,ra,la,fa,X.length);x.a.instance.Ta(541181457,1,1,pa)}if(this.qwi(aa.runtime.Xb))for(aa=
0;aa<X.length;aa++)if(fa=X.eg(aa),pa=W.eg(aa),ra=U.eg(aa),!Y(fa,pa)||!Y(fa,ra))return null;X=X.k5();Y=new u.a;aa=X.length;for(fa=aa;fa<W.length;fa++)pa=W.eg(fa),X.add(pa),Y.add(pa);for(;aa<U.length;aa++)W=U.eg(aa),Y.contains(W)?x.a.instance.Ta(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(X.add(W),ca(W));return X}kyi(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}qwi(X){if(!X)return!1;
X.eTd(1000008);return X.$hb(1000008)}GRm(X){if(!X)return!1;X.eTd(1000009);return X.$hb(1000009)}zNi(X,W,U,Y){return I.a(X,W,U,Y)}XFa(X,W,U){X=X||new n.a;W=W||new n.a;U=U||new n.a;const Y=X.TG(),ca=W.TG(),aa=U.TG();X=V.filter(X,fa=>ca.contains(fa)&&aa.contains(fa));X.TG();X.RC(X.length,V.filter(W,fa=>!Y.contains(fa)));X.RC(X.length,V.filter(U,fa=>!Y.contains(fa)&&!ca.contains(fa)));return X}Ibn(X,W){const U=y.a.wX(W),Y=X.Zd;var ca=Y.getPropertyObjectIds(X.Ng.value.Ku,U),aa=Y.getPropertyObjectIds(X.Ng.value.yf,
U);const fa=Y.getPropertyObjectIds(X.vn.value.yf,U);ca=this.XFa(ca,aa,fa);aa=X.Uk;0<ca.length?Y.setPropertyObjectIds(aa,U,ca):aa.removeProperty(U);X.sg.add(W)}Xeb(X,W,U){X.hasProperty(U)?W.YSa(U,X.EX(U)):W.removeProperty(U)}u2n(X,W){var U=W.Hl();for(const Y of U)W.removeProperty(Y);U=X.Hl();for(const Y of U)W.YSa(Y,X.EX(Y))}wHf(X,W,U,Y,ca){W=X.getPropertyInt32(W,ca);U=X.getPropertyInt32(U,ca);U=null!=W&&null!=U?Math.max(W,U):null!=U?U:null!=W?W:null;null!=U?X.setPropertyInt32(Y,ca,U):Y.removeProperty(ca)}F6e(X,
W,U,Y,ca,aa){W=X(W,ca);U=X(U,ca);X=X(Y,ca);Y=W.TG();let fa=!1;aa&&(fa=aa(W,U,X));fa?(aa=!0,Y=!1):(aa=Y.vHh(U),Y=Y.vHh(X));x.a.instance.Ta(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.yb(ca),W.dr(),U.dr(),X.dr(),aa,Y);return{gHc:X,N2a:aa,C2a:Y}}UUk(X,W,U,Y,ca){let aa;W=X(W,ca);U=X(U,ca);X=X(Y,ca);Y=this.rBi(W,U);aa=this.rBi(W,X);x.a.instance.Ta(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.yb(ca),W.dr(),U.dr(),X.dr(),Y,aa);return{gHc:X,N2a:Y,C2a:aa}}rBi(X,W){if(!X&&!W)return!0;if(!X||!W)return!1;if(!X.count&&!W.count)return!0;let U=!1;W.forEach((Y,ca)=>U=X.nb(Y)&&ca==X.J(Y));return U}uk(){let X;X=this.GRm(this.Xb)?V.V9j.value:V.U9j.value;const W=new w.a(0);for(let U=0;U<X.length;U++)W.Z(X[U],7);return W}static M7(){return new V}static get instance(){return V._instance.value}static fso(){return F.a.instance.Na("Box4.IFeatureHelper").isFeatureEnabled(77)}static v0o(X,W,U){if(void 0!==
X.newValue&&null!==X.newValue||L.a.Uyi(U.type))return!0;V.m3m(X,W,U);return!1}static m3m(X,W,U){U=U.type===L.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);U||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",X.newValue,X.oldValue));x.a.instance.Ta(19145822,1,2,W)}static GMf(X,W,U){const Y=y.a.yb(U),ca=X.Zd;var aa=ca.getPropertyObjectIds(X.Ng.value.Ku,U);const fa=ca.getPropertyObjectIds(X.Ng.value.yf,U);var pa=ca.getPropertyObjectIds(X.vn.value.yf,U);pa=V.Dhm(pa,
X.iq.runtime.Vjc);W=W.XFa(aa,fa,pa);aa=X.Uk;0<W.length?ca.setPropertyObjectIds(aa,U,W):aa.removeProperty(U);X.sg.add(Y);return!0}static Dhm(X,W){const U=new n.a;X.forEach(Y=>{W.contains(Y,(ca,aa)=>ca.equals(aa))||U.add(Y);return!0});return U}static filter(X,W){const U=new n.a;X.forEach(Y=>{W(Y)&&U.add(Y);return!0});return U}static XYl(){return[y.a.yb(l.a.rhf),y.a.yb(l.a.lastModifiedTime),y.a.yb(l.a.mL),y.a.yb(l.a.t5c),y.a.yb(l.a.e8f),y.a.yb(f.a.FZc),y.a.yb(a.a.VEd),y.a.yb(a.a.Ofb),y.a.yb(k.a.Dfj)]}static YYl(){return[y.a.yb(l.a.rhf),
y.a.yb(l.a.lastModifiedTime),y.a.yb(l.a.mL),y.a.yb(l.a.t5c),y.a.yb(l.a.e8f),y.a.yb(f.a.FZc),y.a.yb(a.a.VEd),y.a.yb(k.a.Dfj)]}}V._instance=new H.a(V.M7);V.U9j=new H.a(V.XYl);V.V9j=new H.a(V.YYl);Object(E.a)(V,"GraphNodeComplexMerge",null,[1E3])},1489:function(E,K,c){c.r(K);E=c(0);var l=c(110),f=c(1509),a=c(1495),k=c(1632),x=c(1633);class y{constructor(u,z){this.Eab=!1;this.Iha=null;if(!u)throw Error.argumentNull("annotations");if(!u.Obc(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.tw=u;this.edc=this.tw.Rbi(z);this.wkk=z}get O0b(){return this.tw}get isReadOnly(){return this.Eab}get vTa(){return this.wkk}shb(u){if(0>u||u>=this.edc)throw Error.argument("iField","Invalid field index");return this.Iha&&null!=this.Iha[u]?this.Iha[u]:this.tw.vgi(this.vTa,u)}hag(u,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.edc)throw Error.argument("iField","Invalid field index");if(!this.tw.Iac(this.tw.fFb(this.vTa,
u),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Iha||(this.Iha=Array(this.edc)))[u]=z}Gda(){const {Annotations:u}=c(1489);let z="[";if(this.Iha){let w=!0;for(let F=0;F<this.edc;++F){if(null==this.Iha[F])continue;const G=this.tw.fFb(this.vTa,F);if(u.xqb(G,this.Iha[F],this.tw.vgi(this.vTa,F)))continue;w?w=!1:z+=", ";z+=this.tw.wgi(this.vTa,F);z+="=";const H=this.tw.Gda(G,this.Iha[F]);G===u.g$?(z+='"',z+=f.a.mif(H),z+='"'):z+=H}}return z+"]"}isEqual(u){const {Annotations:z}=
c(1489);if(this===u)return!0;if(!u||this.tw!==u.O0b||this.vTa!==u.vTa)return!1;for(let w=0;w<this.edc;++w)if(!z.xqb(this.tw.fFb(this.vTa,w),this.shb(w),u.shb(w)))return!1;return!0}clone(){const u=new y(this.tw,this.vTa);this.Iha&&(u.Iha=Array.clone(this.Iha));return u}oT(){return this.isReadOnly?this.clone():this}RJf(){const {Annotations:u}=c(1489);if(!this.isReadOnly&&(this.Eab=!0,this.Iha))for(let z=0;z<this.edc;++z){const w=this.Iha[z];null!=w&&u.ZIb(w)}}toString(){return this.Gda()}}Object(E.a)(y,
"StructValue",null,[1553,1551]);c.d(K,"Annotations",function(){return n});class n{constructor(u,z){if(!u)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.g8m=z.Pql;let w=0;var F=z.dhb(u.J(w));++w;this.CLf=new k.a(new x.a(F));this.B1j=u.J(w);++w;this.ZKi=Array(this.tKd);this.kYc=Array(this.tKd);this.alb=Array(this.tKd);for(F=0;F<this.tKd;++F){this.ZKi[F]=z.QD(u.J(w));++w;this.kYc[F]=u.J(w);++w;var G=u.J(w);++w;this.alb[F]=Array(G);for(var H=0;H<G;++H)this.alb[F][H]=
z.QD(u.J(w)),++w}this.vkk=u.J(w);++w;this.FLi=Array(this.h9c);this.i3d=Array(this.h9c);this.j3d=Array(this.h9c);this.h3d=Array(this.h9c);for(F=0;F<this.h9c;++F)for(this.FLi[F]=z.QD(u.J(w)),++w,G=u.J(w),++w,this.i3d[F]=Array(G),this.j3d[F]=Array(G),this.h3d[F]=Array(G),H=0;H<G;++H)this.i3d[F][H]=z.QD(u.J(w)),++w,this.j3d[F][H]=u.J(w),++w,this.h3d[F][H]=({Xga:w}=this.QNa(this.j3d[F][H],u,w,null,null,null)).returnValue,n.ZIb(this.h3d[F][H]);this.hWj=u.J(w);++w;this.gLf=Array(this.j1b);this.hLf=Array(this.j1b);
this.fLf=Array(this.j1b);for(F=0;F<this.j1b;++F)this.gLf[F]=z.QD(u.J(w)),++w,this.hLf[F]=u.J(w),++w,this.fLf[F]=({Xga:w}=this.QNa(this.hLf[F],u,w,null,null,null)).returnValue,n.ZIb(this.fLf[F])}bNc(u){for(let z=0;z<this.j1b;++z)if(this.gLf[z]===u)return z;return-1}R3h(u){if(!this.Mbc(u))throw Error.argument("attrID","Invalid attribute ID");return this.gLf[u]}getAttributeType(u){if(!this.Mbc(u))throw Error.argument("attrID","Invalid attribute ID");return this.hLf[u]}fFb(u,z){if(!this.Obc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.j3d[n.i9c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}Gda(u,z){if(!this.WGf(u))throw Error.argument("typeID","Invalid type ID");if(!this.Iac(u,z))throw Error.argument("value","Value is not of the correct type");switch(u){case n.g$:return z;case n.$ya:return z?"True":"False";case n.xIa:case n.Rqa:return z.toString();case n.pV:return z.Gda();default:if(!n.gI(u)&&n.tad(u)){u=n.dif(u);const G=this.alb[u].length;switch(this.kYc[u]){case 0:return this.alb[u][z];
case 1:if(z){var w="";for(var F=1;F<G;++F)z&1<<F-1&&(0<w.length&&(w+=" & "),w+=this.alb[u][F]);return w}return this.alb[u][0];case 2:w="";for(F=0;F<G;++F)z&1<<F&&(0<w.length&&(w+=" & "),w+=this.alb[u][F]);return w;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.kYc[u]);}}else return z.Gda()}}WGf(u){switch(u){case n.g$:case n.$ya:case n.xIa:case n.Rqa:case n.pV:return!0;default:return n.gI(u)?this.WGf(n.h1a(u)):n.tad(u)?this.OTm(u):this.Obc(u)}}OTm(u){u=n.dif(u);return 0<=
u&&u<this.ZKi.length}Obc(u){u=n.i9c(u);return 0<=u&&u<this.FLi.length}Mbc(u){return 0<=u&&u<this.j1b}Iac(u,z){if(null==z)return!1;switch(u){case n.g$:return"string"===typeof z;case n.$ya:return"boolean"===typeof z;case n.xIa:return"number"===typeof z;case n.Rqa:return"number"===typeof z;case n.pV:return Object(l.a)(1550,z);default:if(n.gI(u))return Object(l.a)(1552,z)&&z.x4===n.h1a(u);if(n.tad(u)){if("number"!==typeof z)return!1;u=n.dif(u);const w=this.alb[u].length;switch(this.kYc[u]){case 0:return 0<=
z&&z<w;case 1:return!(z&-1<<w-1);case 2:return!!z&&!(z&-1<<w);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.kYc[u]);}}else return Object(l.a)(1553,z)&&z.vTa===u}}get j1b(){return this.hWj}get tKd(){return this.B1j}get h9c(){return this.vkk}tMl(u){if(!this.Mbc(u))throw Error.argument("attrID","Invalid attribute ID");return this.fLf[u]}Rbi(u){if(!this.Obc(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.i3d[n.i9c(u)].length}wgi(u,z){if(!this.Obc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.i3d[n.i9c(u)][z]}vgi(u,z){if(!this.Obc(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.h3d[n.i9c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}QNa(u,z,w,F,G,H){if(!z)throw Error.argumentNull("initData");if(n.gI(u)){var L=z.J(w);++w;u=n.h1a(u);var I=new a.a(this,u);for(var N=0;N<L;++N)Array.add(I.items,({Xga:w}=this.QNa(u,z,w,F,G,H)).returnValue);return{returnValue:I,Xga:w}}switch(u){case n.g$:return{returnValue:(F||
this.CLf).QD(z.J(w++)),Xga:w};case n.$ya:return{returnValue:1===z.J(w++),Xga:w};case n.xIa:return{returnValue:z.J(w++),Xga:w};case n.Rqa:return{returnValue:(G||this.g8m)[z.J(w++)],Xga:w};case n.pV:u=z.J(w++);L=new f.a(this);for(I=0;I<u;++I)N=z.J(w),++w,H&&(N=H[N]),L.Fy(N,({Xga:w}=this.QNa(this.getAttributeType(N),z,w,F,G,H)).returnValue);return{returnValue:L,Xga:w};default:if(n.tad(u))return{returnValue:z.J(w++),Xga:w};if(n.MCj(u)){L=z.J(w++);I=new y(this,u);for(N=0;N<L;++N){const P=z.J(w);++w;I.hag(P,
({Xga:w}=this.QNa(this.fFb(u,P),z,w,F,G,H)).returnValue)}return{returnValue:I,Xga:w}}throw Error.argument("typeID","Invalid type ID");}}static tad(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static MCj(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static gI(u){return 32768===(u&32768)}static r1l(u){if(n.gI(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static h1a(u){if(!n.gI(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static xqb(u,z,w){switch(u){case n.g$:case n.$ya:case n.xIa:case n.Rqa:return z===w;case n.pV:return z.isEqual(w);default:return n.gI(u)?z.isEqual(w):n.tad(u)?z===w:z.isEqual(w)}}static ZIb(u){Object(l.a)(1551,u)&&u.RJf()}static oT(u){return Object(l.a)(1551,u)?u.oT():u}static dif(u){return u-16}static i9c(u){return(u&-16385)-16}}n.g$=1;n.$ya=2;n.xIa=3;n.Rqa=5;n.pV=9;Object(E.a)(n,"Annotations",null,[1554])},1493:function(E,K,c){E=c(0);var l=c(344);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(E.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(E.a)(a,"InsightsParameters",null,[]);var k=c(1723),x=c(1724),y=c(1725),n=c(1726),u=c(2),z=c(1540),w=c(1554),F=c(35),G=c(20),H=c(19),L=c(25);c.d(K,"a",function(){return I});class I{static get GAf(){return"Insights_16x16x32"}static get eCl(){return"Find_16x16x32"}static get r_i(){return"-Parameterized"}static get Neg(){return"Parameterized"}static get yme(){return"bTryQuery"}static get Okg(){return"TellMeSuggestion_"}static get nCj(){return"bTryQueryAlternate"}static get iig(){return"MenuTellMe"}static get YAn(){const N=
{},P=[];Array.add(P,{Term:{PeopleType:"Person"}});N.And=P;return N}static vbf(N){return N+I.r_i}static getParameter(N){let P="",M="";if(N)for(let J=0;J<N.MYh;++J)"Type"===N.Ipf(J)?P=N.getValue(J):"Value"===N.Ipf(J)&&(M=N.getValue(J));return new l.a(P,M)}static uBb(N){N=Object.assign(new a,{neighborhood:N,mentionStart:0,mentionLength:N.length});return F.c(N)}static xMh(N,P,M){N=Object.assign(new f,{displayName:N,email:P,userId:M});return F.c(N)}static JNa(N,P,M=null){return F.c(I.bgi(N,P,M,null))}static bgi(N,
P,M=null,J=null){N=Object.assign(new w.a,{neighborhood:N,mentionStart:0,mentionLength:N?N.length:0});return Object.assign(new z.a,{selection:N,userIntent:J,entryPoint:P,launchData:M})}static E6n(N,P){return I.JNa(N,I.Jdj(P))}static Jdj(N){switch(N){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static AKm(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static zbc(){const N=
u.AFrameworkApplication.K?u.AFrameworkApplication.K.jb("SovereignEnvironmentName"):null;return!!N&&0<N.length}static isEnterpriseUser(){const N=u.AFrameworkApplication.K?u.AFrameworkApplication.K.jb("HostAuthType"):null;return!!N&&"aad"===N.toLowerCase()||"external"===N&&I.vCf()}static Lcg(N){return N.aHo&&!I.zbc()}static OAi(){const N=u.AFrameworkApplication.K?u.AFrameworkApplication.K.jb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.K&&"UnifiedUiHostTeams"===N&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Kcg(N){return N.JTa&&N.fAl&&(N.W9c||N.U9c||N.kkb)&&!I.OAi()&&I.isEnterpriseUser()&&!I.zbc()}static sha(){return u.AFrameworkApplication.K?u.AFrameworkApplication.S6a||u.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.S6a}static cR(N){return!N||I.mBi(N.Dg)}static mBi(N){return!N||!N.trim().length}static ime(N){if(!N)return 0;const P=Math.pow(10,5);return Math.round(N*P)/P}static nJo(){var N=new Date;return N?new Date(N.getUTCFullYear(),N.getUTCMonth(),N.getUTCDate(),
N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds(),N.getUTCMilliseconds()):null}static Ruf(N){N=new Date(N);return(I.nJo().getTime()-N.getTime())/1E3}static YBi(N){const {InsightsMenuItemFactory:P}=c(1722);switch(N){case k.a.yxf:case x.a.z_h:case P.Sri:case y.a.uQi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return N.startsWith(I.yme)||
N.startsWith(I.Okg)||N.startsWith(I.nCj)||N.startsWith("PeopleSuggestion")||N.startsWith("FileSuggestion")||N.startsWith("FindInDocumentSuggestion")||N.startsWith("NotesSuggestion")||N.startsWith("OnenoteNotesSuggestion")||N.startsWith("SmartLookupFromTellMe")||N.startsWith("GetHelpFromTellMe")||N.startsWith("GetHelpWithDescriptionFromTellMe")||N.startsWith("AddinSuggestion")||N.startsWith("OfficeScripts")?!0:!1}static bqf(N,P){const M=[];Array.add(M,new n.a(400,N));Array.add(M,new n.a(200,P));N=
{};N.parts=M;return JSON.stringify(N)}static chb(N){const P=N.indexOf("<b0>"),M=N.lastIndexOf("</b0>"),J=[];Array.add(J,new n.a(400,N.substring(0,P)));Array.add(J,new n.a(600,N.substring(P+4,M)));Array.add(J,new n.a(400,N.substring(M+5,N.length)));N={};N.parts=J;return JSON.stringify(N)}static Uhi(N){const P=I.Ruf(N);return 60>P?CommonUIStrings.l_TimeSince_SecsAgo:3600>P?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(P/60).toString()):86400>P?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(P/3600).toString()):172800>P?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(N)).localeFormat("MMMM dd, yyyy"))}static PPl(N){const P=Array(N.length);for(let M=0;M<N.length;M++)P[M]=N[M].commandId;return P}static vCf(){if("Dev Box"===u.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse"))return!0;let N=u.AFrameworkApplication.K.jb("UserPrincipalName");N=L.c(N)?"":H.a.Ug(N);const P=u.AFrameworkApplication.K.Sw("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.K.KC("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(P,N)&&"inner"===u.AFrameworkApplication.K.jb("Microsoft365Ring")}static TYl(N){switch(I.$Od(N)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static fcm(N){N=I.$Od(N);switch(N){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return N}}static $Od(N){switch(N.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static voa(){return G.a.i4&&!G.a.zq}}I.t7a=9E5;Object(E.a)(I,"TellMeUtils",null,[])},1494:function(E,K,c){c.r(K);E=c(0);var l=c(498),f=c(355),a=c(55),k=c(110),x=c(73),y=c(1649),n=c(215);class u{constructor(Sa,Ab,Fb,Va,Wa,jb){this.groupType=Sa;this.resultType=Ab;this.zgg=Fb;this.t8=Va;this.bff=Wa;this.resultIndex=
jb}}Object(E.a)(u,"ClickLoggingInfo",null,[]);const z=Sa=>{const Ab=[];for(;Sa;)Array.add(Ab,"{ContextId:"+Sa.contextId+", IsGraphNodeContext:"+Sa.el+"}"),Sa=Sa.$j;Ab.reverse();return"{"+Ab.join(", ")+"}"};class w{constructor(){this.noa=this.sessionId=null}}Object(E.a)(w,"CorrelationRecord",null,[1442]);var F=c(1514);class G{constructor(Sa,Ab){this.provider=Sa;this.H7a=Ab}}Object(E.a)(G,"ExternalResultProvider",null,[]);class H{constructor(Sa,Ab){this.Id=null;this.TimeStamp=0;this.Id=Sa;this.TimeStamp=
Ab}}Object(E.a)(H,"MRUControl",null,[]);var L=c(1634),I=c(1493),N=c(2),P=c(1377);class M{constructor(Sa,Ab){this.kak=10;this.O6=[];this.UAa=[];this.c1g=this.b1g=!1;this.pxc=this.oxc="";this.XWb=Ab;this.fc=Sa}DNc(){!this.b1g&&this.fc&&(this.oxc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.fc.application,this.O6=this.G4h(),this.b1g=!0);return this.O6}k9l(){!this.c1g&&this.fc&&(this.pxc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.fc.application,this.UAa=this.G4h(!0),this.c1g=!0);return this.UAa}RSm(Sa){return Sa.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Sa||"TryOfficeUpsell"===Sa}bCf(Sa){return this.aFm(Sa)||this.RSm(Sa)||I.a.YBi(Sa)?!1:!0}QYa(Sa){Sa=Sa.ControlId;this.bCf(Sa)&&(Sa=this.v5f(Sa),this.GZn(Sa),this.$8m(),Array.insert(this.O6,0,new H(Sa,Date.now())),this.oxc.length&&(Sa=JSON.stringify(this.O6),P.a.instance.setItem(this.oxc,Sa)))}EE(Sa){this.Z8m();Array.insert(this.UAa,0,new H(L.a[Sa],Date.now()));this.pxc.length&&(Sa=JSON.stringify(this.UAa),P.a.instance.setItem(this.pxc,Sa))}G4h(Sa=!1){if(!this.O6.length){var Ab=
Sa?P.a.instance.getItem(this.pxc):P.a.instance.getItem(this.oxc);if(!Ab||""===Ab)return Sa?this.UAa:this.O6;let Fb=null;try{Fb=JSON.parse(Ab)}catch(Va){this.hXk(Sa),Fb=null}if(!Fb||!Fb.length||10<Fb.length)return Sa?this.UAa:this.O6;Ab=0;for(const Va of Fb)if(Sa||this.fc.M_d(Va.Id)&&this.bCf(Va.Id))if(Sa?Array.insert(this.UAa,Ab++,Va):Array.insert(this.O6,Ab++,Va),Ab===this.XWb)break}return Sa?this.UAa:this.O6}k9e(Sa){Sa=this.v5f(Sa);for(const Ab of this.O6)if(Ab.Id===Sa)return!0;return!1}hXk(Sa=
!1){P.a.instance.setItem(Sa?this.pxc:this.oxc,"")}qHm(Sa){Sa=this.v5f(Sa.ControlId);return this.bCf(Sa)?this.k9e(Sa):!1}GZn(Sa){if(0<this.O6.length){let Ab=0;for(const Fb of this.O6){if(Fb.Id===Sa){Array.removeAt(this.O6,Ab);break}Ab++}}}v5f(Sa){return"Excel"===this.fc.application&&Sa.startsWith("m_excelWebRenderer_ewaCtl_")?Sa.substr(26,Sa.length):Sa}$8m(){this.O6.length===this.XWb&&Array.removeAt(this.O6,this.O6.length-1)}Z8m(){this.UAa.length===this.kak&&Array.removeAt(this.UAa,this.UAa.length-
1)}aFm(Sa){Sa=Sa.split("|");let Ab="";if(6<=Sa.length)Ab=Sa[0];else if(3<=Sa.length){if("3"===Sa[0])return!0;Ab=Sa[1]}return Ab.startsWith("WA")}static createInstance(Sa){let Ab=3;N.AFrameworkApplication.K&&(Ab=N.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3));return new M(Sa,Ab)}}Object(E.a)(M,"MruControlsManager",null,[1441]);class J{constructor(Sa){this.kwb=Sa}Tfa(Sa,Ab){let Fb;return Sa.aD&&(Fb=this.kwb[Sa.value])?Fb.Tfa(Sa,Ab):(Fb=this.G5h(Sa.value))?Fb.Tfa(Fb.Edn,Ab):null}S6l(Sa,
Ab){if(Sa=this.kwb[Sa])for(const Fb of Ab)if(Ab=I.a.getParameter(Fb),Ab.key===Sa.UXf)return Ab.value;return null}qhn(Sa){(Sa=this.G5h(Sa))&&Sa.nhn()}G5h(Sa){const Ab=Sa.indexOf(I.a.r_i);return 0<Ab?this.kwb[Sa.substring(0,Ab)]:null}}Object(E.a)(J,"ParameterizedCommandManager",null,[1440]);var V=c(1524);class X{constructor(Sa,Ab){this.Dg=Sa;this.gnb=Ab}}Object(E.a)(X,"TellMeQuery",null,[]);var W=c(1631);class U{constructor(Sa,Ab){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Sa;this.TimeElapsedSinceClick=
Ab}}Object(E.a)(U,"CommandClickedEvent",null,[]);var Y=c(25);class ca{constructor(Sa,Ab){this.Eck=Sa;this.Tsa=Ab}resultsUpdated(Sa){this.Eck(Y.c(Sa.query)?"":Sa.query.Dg,Sa.lo,Sa.attributes,this.Tsa,Sa.fbc)}}Object(E.a)(ca,"ResultsUpdatedCallback",null,[1439]);class aa{constructor(Sa,Ab,Fb,Va,Wa){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Sa;this.TimeElapsedSinceClick=Fb;this.CommandSurface=Va;this.CommandId=
Ab;this.TerminalParentControlId=Wa}}Object(E.a)(aa,"UserActionEvent",null,[]);var fa=c(74);class pa{constructor(Sa,Ab){this.menuModel=Sa;this.resultCount=Ab}}Object(E.a)(pa,"GeneratedMenuModel",null,[]);class ra{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(E.a)(ra,"MenuModel",null,[]);class la{constructor(Sa,Ab,Fb){this.fc=Sa;this.kwb=Ab;this.Zea=Fb}vJl(Sa,Ab,Fb){const {TellMeActor:Va}=c(1494);let Wa=0;const jb=new ra,mc=[];
let yb="";jb.sections=[];let Oa=new fa.a;const Gb=!!this.fc&&this.fc.q3a;var Wb=!!this.fc&&this.fc.Job||N.AFrameworkApplication.ta.Nb.Job;for(const Mb of Sa){Sa=0;Gb||(Oa=new fa.a);const Qc=new fa.a;let Ic=Mb.displayName;for(const Ed of Mb.results){if(0<=Ed.value.indexOf(I.a.Neg)){if(Ed.aD){var kc=this.kwb[Ed.value];if(kc&&Ed.value.endsWith(I.a.Neg)){if("FindParameterized"!==Ed.value&&!Wb){const me=[];me.push(appChrome.actions.setControlLabel(Ed.value,kc.VPd(Ed)));me.push(appChrome.actions.setButtonCommandValueId(Ed.value,
kc.fof(Ed)));appChrome.api.dispatch(me)}kc=Ed.value.replace(I.a.Neg,"");Oa.remove(kc)?Sa--:Qc.add(kc);Oa.add(Ed.value);Sa++}}}else switch(Ed.type){case 5:Qc.contains(Ed.value)||(Oa.add(Ed.value),Sa++);break;case 7:Oa.add(Ed.aD);Sa++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Oa.add(Ed.value),Sa++}13===Mb.groupType&&(Ic=I.a.sha()?0<Ab.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Ab):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Ab));21===Mb.groupType&&(Ic=CommonUIStrings.l_LearningUILiveText)}Wa+=Sa;""!==Ic&&0<Sa&&(yb+=" , "+Sa.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Ic+" , ");0<Oa.count&&!Gb&&(Sa=appChrome.api.menuSection(Oa.toArray(),Mb.displayName,null,V.a[Mb.groupType]),mc.push(Sa))}Wb=null;0<Wa&&(Wb=0<Ab.length?1!==Wa?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Wa,Ab):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Ab):1!==Wa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Wa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Gb?(Ab=appChrome.api.menuSection(Oa.toArray(),"",null,null),mc.push(Ab)):Wb+=yb);Fb&&(this.fc.Yva?Va.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Wb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Wb)));jb.sections=
mc;return new pa(jb,Wa,[])}static get ahf(){return la.kTg||(la.kTg=new pa(Object.assign(new ra,{sections:[]}),0,[]))}}la.kTg=null;Object(E.a)(la,"TellMeMenuDefintionGenerator",null,[]);var qa;(function(Sa){Sa[Sa.TellMeControlActivated=0]="TellMeControlActivated";Sa[Sa.TellMeQueryExecuted=1]="TellMeQueryExecuted";Sa[Sa.TellMeResultsRendered=2]="TellMeResultsRendered";Sa[Sa.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(qa||(qa={}));Object(E.b)("PerformanceMarker",qa);var La;(function(Sa){Sa[Sa.TellMeTimeToRender=
0]="TellMeTimeToRender";Sa[Sa.TellMeSessionLength=1]="TellMeSessionLength";Sa[Sa.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(La||(La={}));Object(E.b)("PerformanceMeasure",La);class Pa{mark(Sa){window.performance.mark(qa[Sa])}measure(Sa,Ab,Fb){const {TellMeActor:Va}=c(1494);try{window.performance.measure(La[Sa],qa[Ab],qa[Fb])}catch(Wa){Va.instance.Oe.onError("TellMePerformance:Measure","error measuring "+La[Sa])}}qKf(Sa,Ab,Fb){const {TellMeActor:Va}=c(1494);Va.instance.Oe.AKf(Ab,Fb,Sa,this.a2l(Sa))}JXk(){var Sa=
[0,1,2,3];for(const Ab of Sa)window.performance.clearMarks(qa[Ab])}clearMeasures(Sa){for(const Ab of Sa)window.performance.clearMeasures(La[Ab])}a2l(Sa){let Ab=0;(Sa=this.fLl(Sa))&&0<Sa.length&&(Ab=Sa[Sa.length-1].duration);return Ab}fLl(Sa){return window.performance.getEntriesByName(La[Sa],"measure")}}Object(E.a)(Pa,"TellMePerformance",null,[]);var Ka=c(1561),Na=c(1560),sa=c(35);class wa{constructor(Sa){this.wlk=Sa}KKb(Sa,Ab,Fb){const {TellMeActor:Va}=c(1494);Va.instance.Oe.v0(Ab,Na.a.qgc,Sa.data.Qe.toString(),
Math.round(window.performance.now()-Fb),Na.a.qgc,!0,Ka.a.zPa);Sa=sa.b(Sa.data.we);Ab=-1;Sa.Index&&(Ab=Sa.Index);Va.instance.Oe.C5m(Ab,this.wlk)}rKb(Sa,Ab,Fb){const {TellMeActor:Va}=c(1494);Va.instance.Oe.v0(Ab,Na.a.qgc,Sa.data.Qe.toString(),Math.round(window.performance.now()-Fb),Na.a.qgc,!1,Ka.a.zPa)}q9l(Sa){if(Sa&&""!==Sa.trim()){const Fb=window.performance.now(),Va=N.AFrameworkApplication.Kxj;var Ab={};Ab.Text=Sa;Ab.IsFileHash="false";Ab=sa.c(Ab);N.AFrameworkApplication.Ne.tj(Va,2,Ab,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,Wa=>{this.KKb(Wa,Sa.length,Fb)},Wa=>{this.rKb(Wa,Sa.length,Fb)},null,null,!1,4E3,6E3)}}}Object(E.a)(wa,"TellMeQueryIndexCallback",null,[]);var ja=c(1496);class ha{constructor(Sa,Ab,Fb){this.xml=Sa;this.resultCount=Ab;this.tol=Fb}}Object(E.a)(ha,"GeneratedMenuXml",null,[]);var va=c(1723),xa=c(19);class ma{constructor(Sa,Ab){this.bgd=Sa||{};this.hXa=Ab}get fNb(){return 5}Tfa(Sa,Ab=null){return this.hXa.Tfa(Sa,Ab)||this.nMk(Sa.value)}nMk(Sa){return ma.v4e(Sa,this.bgd[Sa]||
null)}static v4e(Sa,Ab=null){Sa=String.format('<ClonedControl Id="{0}" ',Sa);for(let Wa in Ab){var Fb=Wa,Va=Ab[Wa];Va=Va?xa.a.Af(Va.toString()):"";Sa+=String.format('{0}="{1}" ',Fb,Va)}return Sa+"/>"}}Object(E.a)(ma,"CommandMenuItemFactory",null,[1437]);var Ja=c(160);class oa{constructor(){this.s2j=CommonUIStrings.l_FindInDocumentText}get fNb(){return 8}Tfa(Sa){var Ab=Sa.aD;Sa=xa.a.Af(Sa.value);const Fb=xa.a.Af(Ab);Ab=xa.a.Af(String.format(this.s2j,Ab));return this.IIl(Sa,Fb,Ab)}IIl(Sa,Ab,Fb){return Ja.a(Sa,
"1540292897",Fb,I.a.eCl,null,Ab,Fb,null,null)}}Object(E.a)(oa,"FindInDocumentMenuItemFactory",null,[1437]);var za=c(1724),Fa=c(1722),kb=c(1725);class fb{get fNb(){return 7}Tfa(Sa){const Ab=Object(x.a)(W.a,Sa);return this.EJl(xa.a.Af(Sa.value),Ab.id)}EJl(Sa,Ab){return Ja.a(Ab,"1404166600",Sa,null,null,Sa,Sa,null,null)}}Object(E.a)(fb,"TryQueryMenuItemFactory",null,[1437]);class lb{constructor(Sa){this.p6=[];this.fc=Sa}nVl(Sa){for(const Ab of this.p6)if(Ab.fNb===Sa)return Ab;return null}ha(Sa){this.p6.push(Sa)}PTn(Sa){this.ha(new ma(this.fc.v5k,
Sa));this.ha(new kb.a(this.fc.ggn));this.ha(new va.a(this.fc.Eao,this.fc.Dao,this.fc.kHo,this.fc.wrm,this.fc.fro));this.ha(new Fa.InsightsMenuItemFactory);this.ha(new oa);this.ha(new za.a);this.ha(new fb)}}Object(E.a)(lb,"MenuItemFactoryRegistry",null,[]);var sb=c(1497);class ab{constructor(Sa,Ab){this.fc=Sa;this.c6g=new lb(this.fc);this.c6g.PTn(Ab)}wJl(Sa,Ab){let Fb=0;const Va=[],Wa=[];for(const mc of Sa){Sa=I.a.iig;var jb=[];for(const yb of mc.results){const Oa=this.c6g.nVl(yb.type).Tfa(yb,Ab);
Sa=I.a.iig;jb.push(Oa);if(13===yb.type||14===yb.type)Sa="Menu32";17===yb.type&&(Sa="MenuTellMeExtended");yb.groupType=mc.groupType;Wa.push(Object(x.a)(sb.a,yb))}Fb=Fb?Fb:jb.length;jb=Ja.d("TellMeDropdownControls",jb);Sa=Ja.g("TellMeDropdownMenuSection",jb,Sa,mc.displayName);Va.push(Sa)}Ab=Ja.h(Va,"LookupDropdownMenu");return new ha(Ab,Fb,Wa)}static get KJd(){return ab.lTg||(ab.lTg=new ha(Ja.h([],"LookupDropdownMenu"),0,[]))}}ab.lTg=null;Object(E.a)(ab,"TellMeXmlGenerator",null,[]);class Ga{}Ga.yen=
"MRU";Ga.test="Test";Object(E.a)(Ga,"ActionType",null,[]);var Ua=c(1543),wb;(function(Sa){Sa[Sa.Service=0]="Service";Sa[Sa.Local=1]="Local";Sa[Sa.MRU=2]="MRU";Sa[Sa.TestResult=3]="TestResult";Sa[Sa.Unknown=4]="Unknown"})(wb||(wb={}));Object(E.b)("SubResultType",wb);var cc=c(82);class zb{constructor(Sa,Ab,Fb,Va,Wa=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Sa;this.IsEnabled=Ab;this.ResultType=L.a[Fb];this.SubResultType=wb[Va];
this.OptionalData=Wa?cc.a.toJSON(Wa):null}}Object(E.a)(zb,"ResultInfo",null,[]);var nb=c(111),eb=c(185),Ib=c(288);class Xa{constructor(Sa,Ab=null){this.old="TellMeWAC.";this.gek=Sa;this.zmk=Ab}qHa(Sa,Ab,Fb){Ab=nb.a.yC(Ab);Sa=nb.a.rbf(Sa,this.gek,this.zmk,Fb,Ab);eb.a.qHa(Sa,this.old)}pHa(Sa,Ab,Fb=0){Ab=nb.a.yC(Ab);eb.a.pHa(Object.assign(new Ib.a,{name:Sa,dataFields:Ab,durationMs:Fb}),this.old)}}Object(E.a)(Xa,"TellMeOtelLogger",null,[1453]);var Ra=c(135);class gb{constructor(Sa,Ab,Fb,Va,Wa,jb,mc){this.Q6=
this.qaa=this.TOg=null;this.Oda=Sa;this.oTb=Ab;this.RLa=Fb;this.Dab=Va;this.vWa=Wa;this.Z8j=jb;this.Q6=mc?mc:new Xa(this.Dab?n.CuiHelper.Meg:n.CuiHelper.Xke)}get $q(){return this.Dab}get Rpa(){return this.RLa}Uge(Sa){this.TOg=Sa;switch(Sa){case ja.a.contextMenu:this.qaa=ja.a.contextMenu;break;default:this.qaa=ja.a.tellMe}}iJk(Sa,Ab){this.RLa.noa||(this.RLa.noa=Ra.a.create().toString(),this.AIi(Sa,!0,Ab))}qVh(Sa,Ab=!0){this.RLa.noa&&this.I1m(Sa,Ab);this.Dab&&appChrome.api.updateTellMeCorrelationId("");
this.RLa.noa=null}AIi(Sa,Ab,Fb){const {TellMeActor:Va}=c(1494),Wa=this.P7(F.a.u2a);Wa[Ua.a.culture]=this.oTb;Wa[Ua.a.appName]=this.Oda;Wa[Ua.a.context]=Sa;Wa[Ua.a.ZZd]=this.vWa;Wa[Ua.a.PSm]=this.Z8j;Wa[Ua.a.ARm]=Fb;Wa[Ua.a.KLm]=Ab;Wa[Ua.a.contentType]=Va.instance.oHd;this.Q6.qHa(F.a.u2a,Wa,this.TOg);this.Dab&&appChrome.api.updateTellMeCorrelationId(this.RLa.noa)}I1m(Sa,Ab){const Fb=this.P7(F.a.MGb);Fb[Ua.a.xrl]=Sa;Fb[Ua.a.JLm]=Ab;this.Q6.pHa(F.a.MGb,Fb)}B5m(Sa,Ab,Fb){let Va=0;!Fb&&0<Sa.length&&(Va=
Sa.trim().split(" ").length);const Wa=this.P7(F.a.query);Wa[Ua.a.query]="!";Wa[Ua.a.aMb]=Ab;Wa[Ua.a.N4i]=Sa.length;Wa[Ua.a.pDi]=Fb;Wa[Ua.a.V5o]=Va;this.Q6.qHa(F.a.query,Wa,this.qaa)}u3m(Sa,Ab,Fb,Va,Wa,jb,mc,yb=null){const Oa=this.P7(F.a.latency);Oa[Ua.a.culture]=this.oTb;Oa[Ua.a.N4i]=Sa;Oa[Ua.a.QCj]=Ab;Oa[Ua.a.statusCode]=Fb;Oa[Ua.a.service]=Wa;Oa[Ua.a.isSuccess]=jb;Oa[Ua.a.YWm]=mc;yb&&(Oa[Ua.a.NJo]=yb);this.Q6.pHa(F.a.latency,Oa,Va)}AKf(Sa,Ab,Fb,Va){const Wa=this.P7(F.a.performance);Wa[Ua.a.culture]=
this.oTb;Wa[Ua.a.mJk]=qa[Sa];Wa[Ua.a.Ptl]=qa[Ab];Wa[Ua.a.oBn]=La[Fb];this.Q6.pHa(F.a.performance,Wa,Va)}M5m(Sa,Ab){var {TellMeActor:Fb}=c(1494);const {CommandResultsUtility:Va}=c(1533);if(Sa.results.length){var Wa=this.P7(F.a.ybj);Wa[Ua.a.t8]=Ab.toString();Wa[Ua.a.groupType]=V.a[Sa.groupType];16===Sa.groupType&&(Wa[Ua.a.$Qm]=Fb.instance.obd);Ab=[];Fb=[];var jb=[];for(const mc of Sa.results)Wa[Ua.a.resultType]||(Wa[Ua.a.resultType]=L.a[mc.type]),Sa={},27===mc.type&&(Sa.AssetId=mc.KI),Fb.push(Va.yTc(mc.value)),
Ab.push(mc.value),jb.push(new zb(mc.value,Va.yTc(mc.value),mc.type,mc.Svj,Sa));0<Ab.length&&(Wa[Ua.a.G6n]="{"+Ab.join(", ")+"}",Wa[Ua.a.qtl]="{"+Fb.join(", ")+"}",Wa[Ua.a.C6n]=sa.c(jb));this.Q6.qHa(F.a.ybj,Wa,this.qaa)}}jKl(Sa,Ab){if(4===Sa)return Ga.yen;switch(Ab){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return L.a[Ab]}d1m(Sa,Ab,Fb,Va,Wa){const jb=this.P7(F.a.click);jb[Ua.a.QCj]=Sa;jb[Ua.a.nzn]=Ab;jb[Ua.a.commandId]=
Fb;jb[Ua.a.n3]=Va;jb[Ua.a.actionType]=this.jKl(Wa.groupType,Wa.resultType);jb[Ua.a.resultType]=L.a[Wa.resultType];jb[Ua.a.zgg]=wb[Wa.zgg];jb[Ua.a.groupType]=V.a[Wa.groupType];jb[Ua.a.t8]=Wa.t8.toString();jb[Ua.a.bff]=Wa.bff.toString();jb[Ua.a.resultIndex]=Wa.resultIndex.toString();this.Q6.qHa(F.a.click,jb,this.qaa)}j1m(Sa,Ab){this.RLa.noa||(this.RLa.noa=Ra.a.create().toString(),this.AIi("",!1,Ab));Ab=this.P7(F.a.lIh);Ab[Ua.a.aMb]=Sa;this.Q6.pHa(F.a.lIh,Ab)}WIi(Sa,Ab,Fb){if(Sa){if(Fb)for(let Va in Fb)Sa[Va]=
Fb[Va];this.Q6.pHa(F.a.events,Sa,Ab)}}EG(Sa,Ab,Fb=null){const Va=this.P7(F.a.events);Va[Ua.a.event]=Sa;this.WIi(Va,Math.round(Ab),Fb)}MFa(Sa,Ab,Fb=null){const Va=this.P7(F.a.events);Va[Ua.a.event]=F.a.error;Va[Ua.a.module]=Sa;Va[Ua.a.errorMessage]=Ab;Va[Ua.a.message]=Ab;this.WIi(Va,Math.round(window.performance.now()),Fb)}b1m(Sa){const Ab=this.P7(F.a.lFh);Ab[Ua.a.value]=Sa;Ab[Ua.a.fce]=this.Dab;this.Q6.qHa(F.a.lFh,Ab,this.qaa)}u0m(Sa){const Ab=this.P7(F.a.gmh);Ab[Ua.a.value]=Sa;Ab[Ua.a.fce]=this.Dab;
this.Q6.qHa(F.a.gmh,Ab,this.qaa)}i2m(Sa){const Ab=this.P7(F.a.jZh);Ab[Ua.a.value]=Sa;Ab[Ua.a.fce]=this.Dab;this.Q6.qHa(F.a.jZh,Ab,this.qaa)}z5m(Sa){const Ab=this.P7(F.a.f4i);Ab[Ua.a.value]=Sa;Ab[Ua.a.fce]=this.Dab;this.Q6.qHa(F.a.f4i,Ab,this.qaa)}J0m(Sa){const Ab=this.P7(F.a.Vij);Ab[Ua.a.value]=Sa;this.Q6.qHa(F.a.Vij,Ab,this.qaa)}D5m(Sa,Ab){const Fb=this.P7(F.a.I4i);Fb[Ua.a.qgc]=Sa;Ab&&(Fb[Ua.a.noa]=Ab);this.Q6.pHa(F.a.I4i,Fb)}P7(Sa){return{["SessionID"]:this.RLa.sessionId,["CorrelationID"]:this.RLa.noa,
["Time"]:(new Date).getTime(),["Event"]:Sa,["Scenario"]:this.qaa}}}Object(E.a)(gb,"UsageLogger",null,[1438]);var Bb=c(65),$b=c(1673),Qb=c(1203),Ac=c(1530),Db=c(91),dc=c(26),Pb=c(220),Ub=c(527),rb=c(20),Yb=c(742),Ya=c(67),Ob=c(13);c.d(K,"TellMeActor",function(){return vc});class vc{constructor(){this.hXa=this.A2=this.Ub=this.Ma=this.IP=this.Lz=this.Hb=this.ga=this.Oe=this.xK=this.JJe=this.xlh=this.ela=this.fc=null;this.oWb=!1;this.wve=[];this.POg=[];this.fkh=[];this.R6g=[];this.S6g=[];this.O1g=!1;
this.gTb=this.Zea=null;this.nvc=this.vWa=!1;this.Qod=!0;this.OZ=this.luc=this.$Wg=this.ZJe=this.D6g=null;this.VY=[];this.V9a=this.JTb=this.dAa=this.Qrd=this.Ufh=null;this.EVb=!1;this.SJe=0;this.GSb=null;this.Tsa=-1;this.e6g=0;this.vvc=!1;this.w$a=null;this.akh=!1;this.ISb=this.Ip=null}get oHd(){return this.IP?this.IP.contentType:vc.unknown}get actions(){return this.VY}set actions(Sa){this.VY=Sa}oSd(){return this.Oe?this.Oe.Rpa.noa:null}DO(){return this.fc}get jdn(){return this.Qod}get P1o(){return this.D6g}performance(){return this.xK}get Eeg(){return this.Ufh}set Eeg(Sa){this.Ufh=
Sa}get obd(){return this.akh}set obd(Sa){this.akh=Sa}WG(Sa){const Ab=window.performance.now();this.Zea&&!Y.c(Sa)&&(this.Zea(Sa),this.Oe.JA(F.a.WG,window.performance.now()-Ab))}initialize(Sa,Ab=null,Fb=null,Va=null,Wa=null,jb=null,mc=null,yb=null,Oa=null,Gb=null,Wb=null){const {InteractionLogger:kc}=c(1963),{GroupsPlacementInfo:Mb}=c(1959),{AggregatorResultsProvider:Qc}=c(1751);this.fc=Sa;this.vWa=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.ubc;this.Oe=Va;if(!Va){Va=new w;Va.sessionId=
N.AFrameworkApplication.userSessionId;const Ic=Yb.a.og(N.AFrameworkApplication.lcid)||Yb.a.aTc;this.Oe=new kc(new gb(this.fc.application,Ic.name,Va,this.fc.$q,this.vWa,Sa.JTa,null),this.fc.C5k,this.fc)}this.hXa=new J(this.fc.parameterData);this.xlh=Fb||new ab(this.fc,this.hXa);this.Zea=mc;this.JJe=this.JJe||new la(this.fc,this.fc.parameterData,mc);this.Ub=Bb.FocusManager.instance();this.A2=M.createInstance(this.fc);this.$Wg=new Mb(Sa);this.ga=Wa||N.AFrameworkApplication.va;this.Hb=jb||N.AFrameworkApplication.pc;
this.Lz=Oa;this.ela=Ab;this.Ip=Wb;this.xK=new Pa;this.ISb=new l.a(f.a.ai());this.Qrd=[];Oa?Oa.execute(Ic=>{Ic.isFeatureEnabled(vc.$Go,!0).then(Ed=>{const {AggregatorResultsProvider:me}=c(1751);this.vvc=Ed;this.ela=this.ela||me.createInstance(this.A2,this.fc,this.hXa,this.vvc);for(const Be of this.Qrd)this.ela.EE(Be.provider,Be.H7a);this.Qrd=[];return null})}):(this.vvc=!0,this.ela=this.ela||Qc.createInstance(this.A2,this.fc,this.hXa,this.vvc));this.Ma=yb;this.dAa=ab.KJd;this.D6g=new Promise(Ic=>{this.ZJe=
Ic});Gb&&Gb.execute(Ic=>{this.IP=Ic});this.fc.$q&&I.a.OAi()&&(Sa=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.fc.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(Sa,Sa)))}Tb(){this.Muk()}iVn(Sa){this.luc=Sa}Muk(){this.ga.fb(Ob.a.tellMe,Ya.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.fb(Ob.a.hig,Ya.a.frame,Object(a.a)(this,this.Ryh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(Ob.a.mig,Ya.a.frame,Object(a.a)(this,this.oJi,"logItemExecuted"),
96);this.ga.fb(Ob.a.pig,Ya.a.frame,Object(a.a)(this,this.KIi,"logControlDeactivation"),96);this.ga.fb(Ob.a.oig,Ya.a.frame,Object(a.a)(this,this.kJi,"logInputFocus"),96);this.ga.fb(Ob.a.kig,Ya.a.frame,Object(a.a)(this,this.u2a,"interactionBegin"),96);this.ga.fb(Ob.a.sig,Ya.a.frame,Object(a.a)(this,this.u2a,"interactionBegin"),96);this.ga.fb(Ob.a.nig,Ya.a.frame,Object(a.a)(this,this.jJi,"logInputBlur"),96);this.ga.fb(Ob.a.qig,Ya.a.frame,Object(a.a)(this,this.JIi,"logControlActivated"),96);this.ga.fb(Ob.a.V9c,
Ya.a.frame,Object(a.a)(this,this.r0h,"focusSearchBox"),96);this.ga.fb(Ob.a.gig,Ya.a.frame,Object(a.a)(this,this.gHh,"constructLiveNotificationForMenu"),96);this.ga.fb(Ob.a.tig,Ya.a.frame,Object(a.a)(this,this.DAf,"insertTryQuery"),96);this.ga.fb(Ob.a.VIf,Ya.a.frame,Object(a.a)(this,this.DAf,"insertTryQuery"),96);this.ga.fb(Ob.a.Ajf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.Bjf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.Cjf,Ya.a.frame,
Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.Djf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.Ejf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.tWf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.uWf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.vWf,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.AYf,Ya.a.frame,Object(a.a)(this,this.q2a,
"insertMention"),96);this.ga.fb(Ob.a.BYf,Ya.a.frame,Object(a.a)(this,this.q2a,"insertMention"),96);this.ga.fb(Ob.a.CYf,Ya.a.frame,Object(a.a)(this,this.q2a,"insertMention"),96);this.ga.fb(Ob.a.jig,Ya.a.frame,Object(a.a)(this,this.nYi,"openFeedback"),96);this.ga.fb(Ob.a.uig,Ya.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Ob.a.C_e,Ya.a.frame,Object(a.a)(this,this.u0d,"launchAddin"),96);this.ga.fb(Ob.a.D_e,Ya.a.frame,Object(a.a)(this,this.u0d,"launchAddin"),96);this.ga.fb(Ob.a.E_e,
Ya.a.frame,Object(a.a)(this,this.u0d,"launchAddin"),96);this.ga.fb(Ob.a.$Ob,Ya.a.frame,Object(a.a)(this,this.$Ob,"showTellMeCoachmark"),96);this.ga.fb(Ob.a.qIf,Ya.a.frame,Object(a.a)(this,this.CEi,"launchAddinStore"),96);this.ga.fb(Ob.a.g2f,Ya.a.frame,Object(a.a)(this,this.i5i,"quickActionOnFileHandler"),96);this.ga.fb(Ob.a.wmf,Ya.a.frame,Object(a.a)(this,this.I2h,"generateSlidesFromFiles"),96)}hTn(Sa){this.Qod=!1;const Ab=window.performance.now();Sa.N3a.isCompleted?(this.Qod=!0,this.ZJe(!0)):Sa.UZ(()=>
{this.Qod=!0;this.ZJe(!0);this.Oe.JA(F.a.Zjl,window.performance.now()-Ab)});this.TTn(Sa)}TTn(Sa){Ub.a.C3c(Object(a.a)(this,this.JId,"dispatcher"));Ub.a.KKc([new Pb.a(Ob.a.tellMe,Ya.a.frame,96),new Pb.a(Ob.a.hig,Ya.a.frame,96),new Pb.a(Ob.a.mig,Ya.a.frame,96),new Pb.a(Ob.a.pig,Ya.a.frame,96),new Pb.a(Ob.a.oig,Ya.a.frame,96),new Pb.a(Ob.a.kig,Ya.a.frame,96),new Pb.a(Ob.a.sig,Ya.a.frame,96),new Pb.a(Ob.a.nig,Ya.a.frame,96),new Pb.a(Ob.a.qig,Ya.a.frame,96),new Pb.a(Ob.a.V9c,Ya.a.frame,96),new Pb.a(Ob.a.gig,
Ya.a.frame,96),new Pb.a(Ob.a.tig,Ya.a.frame,96),new Pb.a(Ob.a.VIf,Ya.a.frame,96),new Pb.a(Ob.a.Ajf,Ya.a.frame,96),new Pb.a(Ob.a.Bjf,Ya.a.frame,96),new Pb.a(Ob.a.Cjf,Ya.a.frame,96),new Pb.a(Ob.a.Djf,Ya.a.frame,96),new Pb.a(Ob.a.Ejf,Ya.a.frame,96),new Pb.a(Ob.a.tWf,Ya.a.frame,96),new Pb.a(Ob.a.uWf,Ya.a.frame,96),new Pb.a(Ob.a.vWf,Ya.a.frame,96),new Pb.a(Ob.a.AYf,Ya.a.frame,96),new Pb.a(Ob.a.BYf,Ya.a.frame,96),new Pb.a(Ob.a.CYf,Ya.a.frame,96),new Pb.a(Ob.a.jig,Ya.a.frame,96),new Pb.a(Ob.a.uig,Ya.a.frame,
96),new Pb.a(Ob.a.C_e,Ya.a.frame,96),new Pb.a(Ob.a.D_e,Ya.a.frame,96),new Pb.a(Ob.a.E_e,Ya.a.frame,96),new Pb.a(Ob.a.$Ob,Ya.a.frame,96),new Pb.a(Ob.a.qIf,Ya.a.frame,96),new Pb.a(Ob.a.g2f,Ya.a.frame,96),new Pb.a(Ob.a.wmf,Ya.a.frame,96)],Sa)}JId(Sa,Ab,Fb,Va,Wa){if(Ab.contextId===Ya.a.frame)switch(Sa){case Ob.a.tellMe:return this.tellMe(Sa,Ab,Fb,Va,Wa);case Ob.a.hig:return this.Ryh(Sa,Ab,Fb,Va,Wa);case Ob.a.mig:return this.oJi(Sa,Ab,Fb,Va,Wa);case Ob.a.pig:return this.KIi(Sa,Ab,Fb,Va,Wa);case Ob.a.oig:return this.kJi(Sa,
Ab,Fb,Va,Wa);case Ob.a.kig:return this.u2a(Sa,Ab,Fb,Va,Wa);case Ob.a.sig:return this.o6n(Fb);case Ob.a.nig:return this.jJi(Sa,Ab,Fb,Va,Wa);case Ob.a.qig:return this.JIi(Sa,Ab,Fb,Va,Wa);case Ob.a.V9c:return this.r0h(Sa,Ab,Fb,Va,Wa);case Ob.a.gig:return this.gHh(Sa,Ab,Fb,Va,Wa);case Ob.a.tig:case Ob.a.VIf:return this.DAf(Sa,Ab,Fb,Va,Wa);case Ob.a.Ajf:case Ob.a.Bjf:case Ob.a.Cjf:case Ob.a.Djf:case Ob.a.Ejf:case Ob.a.tWf:case Ob.a.uWf:case Ob.a.vWf:case Ob.a.uig:return this.DRa(Sa,Ab,Fb,Va,Wa);case Ob.a.AYf:case Ob.a.BYf:case Ob.a.CYf:return this.q2a(Sa,
Ab,Fb,Va,Wa);case Ob.a.jig:return this.nYi(Sa,Ab,Fb,Va,Wa);case Ob.a.C_e:case Ob.a.D_e:case Ob.a.E_e:return this.u0d(Sa,Ab,Fb,Va,Wa);case Ob.a.$Ob:return this.$Ob(Sa,Ab,Fb,Va,Wa);case Ob.a.qIf:return this.CEi(Sa,Ab,Fb,Va,Wa);case Ob.a.g2f:return this.i5i(Sa,Ab,Fb,Va,Wa);case Ob.a.wmf:return this.I2h(Sa,Ab,Fb,Va,Wa)}return 2}r0h(Sa,Ab,Fb){if(1===Fb)return 32;this.Mmj();Sa=!1;(this.fc.JTa||this.vWa)&&(Ab=document.getElementById("SearchButton"))&&Ab.click();if(!this.fc.JTa&&this.vWa)for(Ab=document.getElementsByClassName("ms-suiteux-search-box"),
Fb=0;Fb<Ab.length;Fb++){const Va=Ab[Fb].querySelector("input[type=search]");Va&&(Sa=Bb.FocusManager.WJ(Va))}else Sa=Bb.FocusManager.WJ($get(this.fc.$q?n.CuiHelper.Meg:n.CuiHelper.Xke));this.nvc=!0;return Sa?32:8}DAf(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Mmj();Sa=Wa.CommandValueId;Ab=this.fc.$q?n.CuiHelper.Meg:n.CuiHelper.Xke;this.fc.$q&&!Y.c(Wa[Qb.a.gTa])&&(Wa[Qb.a.gTa]=!1);if(Sa){if(this.fc.$q)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Sa)),
this.w$a=[19],32;if(Wa=$get(Ab))Wa.value=Sa}return Bb.FocusManager.WJ($get(Ab))?32:8}Mmj(){this.Ub.nL(this.fc.JTa||this.vWa?this.fc.PFb:this.fc.W5a,!1)}aKl(Sa,Ab){switch(Sa){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Ab);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Ab);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Ab);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Ab)}return Ab}gHh(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Sa=this.dAa?this.dAa.resultCount:0;Wa.Value=1!==Sa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Sa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.dAa)for(const jb of this.dAa.tol)Wa=Object(k.a)(W.a,jb)?jb.id:xa.a.replaceAll(jb.value,'"',""),(Wa=$get(Wa+"-"+I.a.iig))&&dc.a.gr(Wa,dc.a.pfa,
xa.a.Af(this.aKl(jb.groupType,Wa.innerText)));return 32}Ryh(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.GSb=new Db.a(2,1,0,()=>{Wa[$b.a.Callback]()},97);this.dAa&&this.Hb.Wb(this.GSb);return 32}oJi(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;Wa.CloseAllMenus&&(Sa=void 0===Wa.ParentControlId||null===Wa.ParentControlId?
"<NA>":Wa.ParentControlId,Ab=this.gTb?this.gTb[Wa.ControlId]:null,!Ab&&this.gTb&&"<NA>"!==Sa&&(Ab=this.gTb[Sa]),Ab||(Ab=this.oWb&&this.A2.qHm(Wa),Ab=this.rll(Ab,Wa.ControlId),Ab=new u(Ab,32,4,-1,-1,-1),this.Oe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Wa.ControlId+" determined group:"+V.a[Ab.groupType])),this.Oe.qln(Wa.ControlId,Sa,Wa.CommandId,Wa.CloseAllMenus,Ab),this.hXa.qhn(Wa.ControlId),Wa.Location!==ja.a.contextMenu&&(this.A2.QYa(Wa),this.A2.EE(Ab.resultType),this.fc.She&&
this.ela.Csk(Wa.CommandId)));return 32}KIi(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;(new wa(this.oSd())).q9l(this.JTb);Sa=this.JTb;Ab=this.Tsa;Fb=this.Oe.Cgd;if(Y.c(Wa))return this.Oe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Wa=Wa.UILocation;Sa&&0<Sa.length&&this.vvc&&I.a.Lcg(this.fc)&&this.fc.w_d&&19!==Wa&&Ab>Fb&&!this.fc.sP&&(this.Oe.DKf(Sa),this.Oe.Z$f(Ab));this.Oe.b5n();this.fc.doe&&19!==Wa&&(this.xK.mark(3),this.xK.measure(1,0,3),this.xK.measure(2,2,3),this.xK.qKf(0,
1,2),this.xK.qKf(2,2,3),this.xK.qKf(1,0,3),this.xK.JXk(),this.xK.clearMeasures([0,2,1]));this.Oe.Xln(window.performance.now()-this.SJe);this.fc.$q&&(this.V9a=null,this.Oe.uxa());this.nvc=this.EVb=!1;this.JTb="";return 32}kJi(Sa,Ab,Fb){if(1===Fb)return 32;this.Oe.cmb(z(Ab),this.nvc);return 32}jJi(Sa,Ab,Fb){if(1===Fb)return 32;this.Oe.uxa();this.EVb=!1;return 32}JIi(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;this.OZ=null;Wa&&(this.OZ=Wa);this.fc.doe&&(Y.c(this.OZ)||this.OZ.Location!==ja.a.contextMenu)&&this.xK.mark(0);
this.Oe.Uge(Y.c(this.OZ)||Y.c(this.OZ.Location)?ja.a.unknown:this.OZ.Location);this.Oe.Wln(this.e6g,this.nvc);this.EVb||this.F4a();return 32}LKh(Sa,Ab){const Fb=[],Va=Date.now();for(let Wa of Sa)Sa=(Va-Wa.timeStamp)/1E3,Sa=I.a.ime(Sa),Array.add(Fb,new U(Ab?Wa.commandId:Wa.controlId,Sa));return Fb}Pel(Sa){const Ab=[],Fb=Date.now();for(let Va of Sa)if(Va.controlId||"keyboardShortcut"===Va.commandSurface)Sa=(Fb-Va.timeStamp)/1E3,Sa=I.a.ime(Sa),Array.add(Ab,new aa(Va.controlId,Va.commandId,Sa,Va.commandSurface,
Va.ale));return Ab}vLh(Sa=!1){var Ab=Sa?this.A2.k9l():this.A2.DNc();Sa=[];const Fb=Date.now();for(const Va of Ab)Ab=(Fb-Va.TimeStamp)/1E3,Ab=I.a.ime(Ab),Array.add(Sa,new U(Va.Id,Ab));return Sa}F4a(){if(!this.EVb){this.oWb=this.EVb=!0;""!==this.fc.o9f&&N.AFrameworkApplication.Dn(this.fc.o9f);if(!this.O1g){this.O1g=!0;const Sa={};Sa.IsMLREnabled=this.fc.lNm;Sa.IsReactRibbonEnabled=this.fc.$q;Sa.IsSharedHeaderEnabled=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.wJ;Sa.IsSearchUxEnabled=
this.vWa;Sa.IsTellMeInHeaderEnabled=this.fc.JTa;Sa.IsGoLocalEnv=I.a.AKm();Sa.IsSovereignEnvironment=I.a.zbc();Sa.IsTellMeServiceResultsEnabled=I.a.Lcg(this.fc);Sa.IsSubstrateProviderEnabled=I.a.Kcg(this.fc);Sa.ShouldFetchTokens=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.GOb;Sa.IsSerpletEnabled=I.a.sha();Sa.FirstOnClickTimeInMS=Math.round(window.performance.now());Sa.IsHeaderHidden=N.AFrameworkApplication.hideHeader||N.AFrameworkApplication.NX;Sa.IsSearchInHeaderHidden=N.AFrameworkApplication.YQc;
void 0!==window.performance.timing&&null!==window.performance.timing&&(Sa.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Sa.IsFindWithMatchesEnabled=this.fc.OLd;Sa.HelpShowsTopSearchResult=this.fc.P7c;Sa.HelpShowsNumberOfMatches=this.fc.O7c;N.AFrameworkApplication.K&&(Sa.UiHost=N.AFrameworkApplication.K.jb("UiHostIntegrationType"));this.Oe.g6m(JSON.stringify(Sa))}this.wve=this.LKh(y.a.instance.uNc(),!1);this.POg=this.LKh(y.a.instance.Wgb(),!0);this.fkh=this.Pel(y.a.instance.Wgb());
this.R6g=this.vLh();this.S6g=this.vLh(!0);this.Oe.F4a()}}u2a(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(rb.a.vUc)return 32;this.SJe=window.performance.now();this.F4a();Sa=new ca(Object(a.a)(this,this.Axa,"onRequestCompleted"),0);this.Tsa++;this.Oe.beginQuery("",this.Tsa,this.oWb);this.Zlg(!0,null);this.dAa=ab.KJd;this.V9a=la.ahf;if(this.ela)vc.instance.actions=[],this.ela.QH(new X("",this.Tsa),Sa,this.fc.$q);
else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.GSb&&this.Hb.Wb(this.GSb);return 32}o6n(Sa){if(1===Sa)return 32;this.Ub.CR(this.fc.JTa||this.vWa?this.fc.PFb:this.fc.W5a,!1);return 32}tellMe(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.OZ=Wa;this.Oe.Uge(Y.c(this.OZ.Location)?ja.a.unknown:this.OZ.Location);Sa=this.OZ.Value;this.fc.$q||Sa&&""!==Sa.trim()?(!this.V9a&&this.fc.$q&&
(this.Oe.cmb(z(Ab),this.nvc),this.F4a()),this.txl(Sa,this.OZ.Location),this.OZ.PopulationXML=this.dAa.xml):this.oWb?this.OZ.PopulationXML=this.dAa.xml:(this.OZ.PopulationXML=ab.KJd.xml,this.V9a=la.ahf,this.JTb="");return 32}txl(Sa,Ab){this.SJe=window.performance.now();this.fc.doe&&Ab!==ja.a.contextMenu&&this.xK.mark(1);this.fc.$q&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Sa));Sa&&0<Sa.trim().length&&(this.oWb=!1);this.fc.Rvl();Ab=Y.c(Ab)?ja.a.tellMe:Ab;if(Sa!==this.JTb||this.fc.$q){this.Tsa++;
this.Oe.beginQuery(Sa,this.Tsa,this.oWb);this.Zlg(!0,null);const Fb=new X(Sa,this.Tsa),Va=new ca(Object(a.a)(this,this.Axa,"onRequestCompleted"),this.Tsa);this.dAa=ab.KJd;this.V9a=la.ahf;if(this.ela)vc.instance.actions=[],this.ela.QH(Fb,Va,this.fc.$q,Ab,this.w$a),this.w$a=null;else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.e6g=this.Tsa;this.JTb=Sa}}hVo(Sa){if(this.fc.$q){var Ab=appChrome.selectors.getActiveControlStates();if(Ab=Object(x.a)(Object,
Ab[Sa.value])){Sa.label=Ab.label;let Fb=null;"description"in Ab&&(Fb=Ab.description);Fb&&Object.getType(Fb)===String?Sa.description=Fb:"secondaryText"in Ab?Sa.description=Ab.secondaryText:"fullDescriptionLabel"in Ab&&(Sa.description=Ab.fullDescriptionLabel)}}}XCn(Sa){this.gTb={};let Ab=0,Fb=0;for(const Va of Sa){Sa=0;for(const Wa of Va.results)this.gTb[Wa.value]=new u(Wa.groupType,Wa.type,Wa.Svj,Ab,Sa,Fb),Sa++,Fb++,Wa.label||5!==Wa.type||this.hVo(Wa);0<Sa&&Ab++}}afc(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;
if(Y.c(Wa))return this.Oe.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Sa=Wa.CommandValueId)&&window.open(Sa,"_blank");return 32}QEi(Sa){const Ab={};Ab.token=this.Eeg;Ab.files=sa.c(Sa);Ab.type="MultiFilesDeckGeneration";if(N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb(Ob.a.sXm,2,Ab),!0;Sa=I.a.bgi("",I.a.Jdj("GenerateDeckFromFile"),Object.assign(new Ac.a,{landingTab:"All",data:Ab}));Sa=this.ga.Qb(Ob.a.B8,
2,Sa);return 32!==Sa?(this.Oe.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+Sa+"."),!1):!0}i5i(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Ub.$kf();if(Sa=Wa.TerminalParentControlId){Sa=this.ISb.J(Sa);if(!Sa)return 16;Ab=[];Array.add(Ab,Sa);if(!this.QEi(Ab))return 8}return 32}I2h(){if(!this.ISb.count)return 16;const Sa=[];for(let Ab of this.ISb.values)Array.add(Sa,
Ab);return this.QEi(Sa)?32:8}q2a(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:InsertMention","actiondata comes null"),16;Sa=Wa.UILocation;let jb;Wa=Wa.CommandValueId;try{jb=sa.a(Wa)}catch(mc){return this.Oe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Y.c(jb)?(this.Oe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Y.c(this.luc)?(this.Oe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),
16):19!==Sa?(this.Oe.onError("TellMeActor:InsertMention","location "+Sa+" is unexpected"),16):this.luc.q2a(jb.displayName,jb.email,jb.userId)?32:(this.Oe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}DRa(Sa,Ab,Fb,Va,Wa){return 1===Fb?32:Y.c(Wa)?(this.Oe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Wa.UILocation?this.nCm(Fb,Wa):this.afc(Sa,Ab,Fb,Va,Wa)}nYi(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.Ip&&window.setTimeout(()=>{this.Ip.execute(jb=>{jb.IHa("TellMeSurvey",null)})},vc.wzl);return 32}nCm(Sa,Ab){if(1===Sa)return 32;if(Y.c(Ab))return this.Oe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Y.c(this.luc))return this.Oe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Sa=Ab.CommandValueId;return Y.c(Sa)?(this.Oe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.luc.insertHtmlText(Sa)?32:(this.Oe.onError("TellMeActor:InsertUrl",
"url is not inserted"),16)}Axa(Sa,Ab,Fb,Va,Wa){Fb=window.performance.now();this.XCn(Ab);this.Oe.Rio(Ab);this.fc.$q?(this.V9a=this.JJe.vJl(Ab,Sa,Wa),this.fc.Yva?(this.VY.push(appChrome.actions.updateTellMeSearchResults(this.V9a.menuModel,Sa,Wa)),appChrome.api.dispatch(this.VY)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.V9a.menuModel,Sa,Wa)),this.fc.doe&&this.EVb&&(Y.c(this.OZ)||this.OZ.Location!==ja.a.contextMenu)&&(this.xK.mark(2),this.xK.measure(0,1,2))):this.dAa=this.xlh.wJl(Ab,
this.Oe.Rpa);this.GSb&&this.Hb.Wb(this.GSb);Wa={};Wa.GroupsCount=Ab.length;Wa.QueryID=Va;Wa.QueryLength=Sa.length;this.Oe.JA(F.a.Gcl,window.performance.now()-Fb,Wa)}rll(Sa,Ab){return Ab.startsWith(this.fc.$q?I.a.Okg:I.a.yme)?5:Sa?4:"bSearchHelp"===Ab||Ab.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ab||Ab.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ab?24:Ab===this.fc.Vjf?2:0}EE(Sa,Ab){this.ela?this.ela.EE(Sa,Ab):Array.add(this.Qrd,new G(Sa,Ab))}CEi(Sa,Ab,Fb,Va,Wa){if(1===Fb)return 32;
if(Y.c(Wa))return this.Oe.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Sa={};Sa.SourceControlId=Wa.SourceControlId;Sa.Query=Wa.CommandValueId;Wa=this.ga.Qb(Ob.a.ZWc,2,Sa);if(32!==Wa)this.Oe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Wa+".");return Wa}return this.ga.Qb(Ob.a.ZWc,2,Wa)}u0d(Sa,Ab,Fb,Va,Wa){({AddinResultsProvider:Sa}=
c(1647));if(1===Fb)return 32;if(Y.c(Wa))return this.Oe.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Fb=Wa.CommandValueId;if(Y.b(Fb))return this.Oe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Sa.nzb[Fb])return this.Oe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Fb+" doesn't not exist in entitlements"),16;Wa=c(1647).AddinResultsProvider.nzb[Fb];Sa={};Sa.solutionId=Wa.id;Sa.version=Wa.appVersion;Sa.storeType=Wa.storeType;Sa.storeId=Wa.storeId;Sa.assetId=
Wa.assetId;Sa.assetStoreId=Wa.assetStoreId;Sa.displayName=Wa.displayName;Sa.targetType=Wa.targetType;Sa.height=Wa.height;Sa.width=Wa.width;Wa=this.ga.Qb(Ob.a.qAf,2,Sa);if(32!==Wa)this.Oe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Wa+". AssetId: "+Fb);return Wa}$Ob(){if(!Y.c(this.Ip))for(let Sa of y.a.instance.Wgb()){if("ShowContextMenuWithFloatie"===Sa.commandId)return this.Ip.execute(Ab=>{Ab.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Sa.commandId&&
-1===Sa.commandId.indexOf("Tab"))break}return 8}Zlg(Sa,Ab="",Fb=null){Sa?this.ISb=new l.a(f.a.ai()):Ab&&Fb&&this.ISb.add(Ab,Fb)}static get instance(){return vc._instance||(vc._instance=new vc)}}vc._instance=null;vc.$Go="mso_tellMeService";vc.unknown="Unknown";vc.wzl=500;Object(E.a)(vc,"TellMeActor",null,[])},1495:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(1509);class f{constructor(a,k){this.Eab=!1;const {Annotations:x}=c(1489);if(!a)throw Error.argumentNull("annotations");if(!a.WGf(k))throw Error.argument("memberTypeID",
"Invalid type ID");if(x.gI(k))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.tw=a;this.tak=k;this.jp=[]}get O0b(){return this.tw}get isReadOnly(){return this.Eab}get x4(){return this.tak}get items(){return this.jp}Gda(){const {Annotations:a}=c(1489);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=", ");const n=this.tw.Gda(this.x4,this.items[x]);this.x4===a.g$?(k+='"',k+=l.a.mif(n),k+='"'):k+=n}return k+"]"}isEqual(a){const {Annotations:k}=c(1489);if(this===
a)return!0;if(!a||a.O0b!==this.tw||a.x4!==this.x4||a.items.length!==this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.xqb(this.x4,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new f(this.tw,this.x4);Array.addRange(a.items,this.items);return a}oT(){return this.isReadOnly?this.clone():this}RJf(){const {Annotations:a}=c(1489);if(!this.isReadOnly){this.Eab=!0;for(const k of this.items)a.ZIb(k)}}toString(){return this.Gda()}}Object(E.a)(f,"ListValue",null,[1552,1551])},
1496:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(E.a)(l,"TellMeScenario",null,[])},1497:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k=null,x=null,y=4,n=-99999,u=0){this.KI="";this.Szd=-1;this.value=f;this.type=a;this.Svj=y;this.label=this.aD=k;this.groupType=30;this.description=x;this.score=n;this.count=u}}Object(E.a)(l,"ResultBinding",null,[])},1500:function(E,K,c){c.d(K,
"a",function(){return l});E=c(0);class l{constructor(f){this.attributes=null;this.query=f;this.lo=[]}Uu(f){this.lo.push(f)}G$i(f){const a=[];for(const k of this.lo)k.groupType!==f&&a.push(k);this.lo.length!==a.length&&(this.lo=a)}get fbc(){return!1}}Object(E.a)(l,"SimpleResultsUpdatedEventArgs",null,[1421])},1501:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f=30,a=""){this.XL=[];this.groupType=f;this.displayName=a}get results(){return this.XL}Nw(f){f.groupType=this.groupType;
Array.add(this.results,f)}j5f(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(E.a)(l,"SimpleResultGroup",null,[1422])},1509:function(E,K,c){E=c(0);class l{constructor(a,k){this.Kdb=a;this.value=k}}Object(E.a)(l,"AttrValuePair",null,[]);c.d(K,"a",function(){return f});class f{constructor(a){this.Eab=!1;if(!a)throw Error.argumentNull("annotations");this.tw=a;this.nY=[]}get O0b(){return this.tw}get isReadOnly(){return this.Eab}get Mwf(){return 0<
this.nY.length}Hq(a){if(!this.tw.Mbc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const k of this.nY)if(a===k.Kdb)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}Fy(a,k){var {Annotations:x}=c(1489);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.tw.Mbc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.tw.Iac(this.tw.getAttributeType(a),k))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");x.ZIb(k);for(x=0;x<this.nY.length;++x){const y=this.nY[x];if(a===y.Kdb){y.value=k;return}}Array.add(this.nY,new l(a,k))}qSa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.tw.Mbc(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.nY.length;++k)if(a===this.nY[k].Kdb){Array.removeAt(this.nY,k);break}}MMd(a){if(!a)throw Error.argumentNull("action");
for(const k of this.nY)a(k.Kdb,k.value)}clone(){const a=new f(this.tw);a.i_a(this);return a}i_a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.O0b!==this.tw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.nY);a.MMd((k,x)=>{this.Fy(k,x)})}Gda(){const {Annotations:a}=c(1489);let k="[",x=!0;for(const y of this.nY){x?x=!1:k+=", ";k+=this.tw.R3h(y.Kdb);k+="=";const n=
this.tw.getAttributeType(y.Kdb),u=this.tw.Gda(n,y.value);n===a.g$?(k+='"',k+=f.mif(u),k+='"'):k+=u}return k+"]"}isEqual(a){const {Annotations:k}=c(1489);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.tw!==a.O0b||this.Mwf!==a.Mwf)return!1;let x=0,y=null,n=!1;a.MMd((u,z)=>{++x;if(!n){var w=-1;for(let F=0,G=this.nY.length;F<G;++F)if(this.nY[F].Kdb===u){w=F;break}0>w?n=!0:(y||(y=Array(this.nY.length)),y[w]=z)}});if(this.nY.length!==x||n)return!1;for(let u=0,z=this.nY.length;u<
z;++u)if(!k.xqb(this.tw.getAttributeType(this.nY[u].Kdb),this.nY[u].value,y[u]))return!1;return!0}oT(){return this.isReadOnly?this.clone():this}RJf(){const {Annotations:a}=c(1489);if(!this.isReadOnly){this.Eab=!0;for(const k of this.nY)a.ZIb(k.value)}}toString(){return this.Gda()}static mif(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(E.a)(f,"FeatureBundle",null,[1550,1551])},1514:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}
l.click="Click";l.u2a="InteractionBegin";l.MGb="InteractionEnd";l.lIh="ControlActivated";l.query="Query";l.I4i="QueryIndexRecorded";l.lFh="Clicks";l.gmh="ActionEvents";l.jZh="FilteredActionEvents";l.Vij="SessionContext";l.latency="Latency";l.performance="Performance";l.ybj="RenderedResults";l.events="Events";l.Gcl="CreateResultsMenu";l.WG="UpdateRibbonControls";l.F6n="ResultsAggregation";l.QH="IssueQuery";l.j0k="CommandSuggestions";l.error="Error";l.EJf="LoadModelData";l.Zjl="DepsResolveTime";l.kdn=
"ModelDataWaitTime";l.timedOut="TimedOut";l.azk="AddinQueryCommandReady";l.CKl="GetAddinEntitlements";l.f4i="ProviderMRUEvents";l.htl="EnableAddinSearchCommands";Object(E.a)(l,"EventNames",null,[])},1516:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.zLf=null;this.tca=this.BLf=0}Vlf(f,a,k){if(!f)throw Error.argumentNull("referenceList");if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>f.length)throw Error.argumentOutOfRange("length");if(a+
k>f.length)throw Error.argument("Invalid start-length range");this.zLf=f;this.BLf=a;this.tca=k}Rgb(f,a,k){this.Vlf(f.zLf,f.BLf+a,k)}J(f){if(0>f||f>=this.tca)throw Error.argumentOutOfRange("index");return this.zLf[this.BLf+f]}get count(){return this.tca}static Vaf(f){const a=new l;a.Vlf(f,0,f.length);return a}}Object(E.a)(l,"ReadOnlyList",null,[1577])},1524:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.Classifier=0]="Classifier";f[f.AppsForOffice=1]="AppsForOffice";
f[f.FindInDocument=2]="FindInDocument";f[f.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";f[f.RecentlyUsed=4]="RecentlyUsed";f[f.TryQuery=5]="TryQuery";f[f.Empty=6]="Empty";f[f.TryCommand=7]="TryCommand";f[f.Assistance=8]="Assistance";f[f.Answer=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.WolframAnswer=12]="WolframAnswer";f[f.Insights=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.Recommended=16]="Recommended";f[f.ServiceClassifier=17]=
"ServiceClassifier";f[f.ServiceRecommended=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Learning=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.ActionAI=24]="ActionAI";f[f.ActionAICommand=25]="ActionAICommand";f[f.SummarizeDeck=26]="SummarizeDeck";f[f.Addin=27]="Addin";f[f.OfficeScript=28]="OfficeScript";f[f.AddinStoreEntry=29]="AddinStoreEntry";f[f.None=30]="None";f[f.MergedActions=31]="MergedActions";f[f.MergedScopedSearches=32]="MergedScopedSearches";
f[f.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(E.b)("ResultGroupType",l)},1531:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1581);class l extends c.a{constructor(){super();this.info=this.qj=this.eventId=null}get lga(){return"Misc"}fEb(){this.detail.Z("Type",this.lga);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.qj);this.detail.Z("Info",this.info);return this.detail}}Object(E.a)(l,"BasicMergeFailureDetail",c.a,[])},1532:function(E,K,c){c.d(K,
"a",function(){return k});E=c(0);var l=c(602),f=c(800),a=c(1548);class k{constructor(x,y=!0){this.wm=y&&x?x.IK():x;this.c_b=new l.a}qC(x){this.c_b.add(f.a.yb(x))}jno(x){this.c_b=x}DNi(x){this.wm&&(new a.a(this.wm,x)).Mpa.forEach((y,n)=>{n.bY&&!this.c_b.contains(y)&&(this.c_b.add(y),n.isDeleted?(n=this.wm,n.hasProperty(f.a.wX(y))&&n.removeProperty(f.a.wX(y))):this.wm.YSa(f.a.wX(y),n.newValue));return!0})}}Object(E.a)(k,"PartialMergeResult",null,[])},1533:function(E,K,c){c.r(K);c.d(K,"CommandResultsUtility",
function(){return z});E=c(0);var l=c(1543),f=c(1514),a=c(1544),k=c(1497),x=c(1501),y=c(1494),n=c(1493),u=c(2);class z{static Cad(w,F){if(F&&F.$q){const G={};for(const H of w)F.M_d(H)&&(G[H]=appChrome.selectors.getModelType(H));y.TellMeActor.instance.WG(G)}}static lHo(w){return w.startsWith("btnTellMeOfficeAddIn")}static yTc(w){const F=y.TellMeActor.instance.DO();return!!F&&F.$q&&!appChrome.selectors.isControlDisabled(w)}static p2d(w,F,G,H){if(y.TellMeActor.instance.Oe&&w){const L=[];for(const I of w)L.push(String.format('{{"Id":"{0}","Score":{1}}}',
I.commandId,I.score));w={};w[l.a.suggestions]="[{"+L.join(",")+"}]";w[l.a.pDi]=F;w[l.a.groupType]=G;w[l.a.provider]=H;y.TellMeActor.instance.Oe.JA(f.a.j0k,window.performance.now(),w)}}static xRl(w,F){const G=[],H=[];for(const L of F){F=L.commandId;let I=L;L.commandId in w&&(F=w[L.commandId],I=new a.a(F,L.score));Array.contains(H,F)||(G.push(I),H.push(F))}return G}static lPc(w,F,G,H,L,I,N,P){G.Gof&&(F=z.xRl(G.Gof,F));var M=n.a.PPl(F);z.Cad(M,G);var J=[],V=[];M=[];const X=new x.a(N);N=16===N||18===
N||7===N||4===N?u.AFrameworkApplication.K?u.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3):3:0===N||17===N||25===N?5:0;for(const W of F)if(!z.oHm(W.commandId)){F=z.lHo(W.commandId);if(G.M_d(W.commandId)&&!F){if(n.a.YBi(W.commandId))continue;F=null;L&&I&&(F=L.S6l(W.commandId,I));z.yTc(W.commandId)?Array.add(J,new k.a(W.commandId,5,F,null,P,W.score)):Array.add(V,new k.a(W.commandId,5,F,null,P,W.score))}else G.uzb&&F&&H&&Array.add(M,W.commandId.substr(21));if(J.length+M.length>=
N)break}G=0;for(L=0;L<J.length&&G<N;L++,G++)X.Nw(J[L]);for(J=0;J<V.length&&G<N;J++,G++)X.Nw(V[J]);for(V=0;V<M.length&&G<N;V++,G++)H.unp(w,M[V],X);return X}static oHm(w){z.dwh||(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.Sw("TellMeControlPredictionBlockList")&&u.AFrameworkApplication.K.KC("TellMeControlPredictionBlockList").forEach(F=>{Array.add(z.cwh,F.toLowerCase())}),z.dwh=!0);return Array.contains(z.cwh,w.toLowerCase())}static QBf(w){return 2<w.length&&";"===w.charAt(0)&&";"===w.charAt(w.length-
1)&&!!u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static I5h(w){const F=new x.a(0);var G=w.split(";");w=y.TellMeActor.instance.DO();for(const H of G)if(0<H.length){G=H.split(":");const L=2===G.length?G[0]:H;if(!w.M_d(L))break;if(1===G.length)G=new k.a(L,5,null,null,1),F.Nw(G);else if(2===G.length)G=new k.a(L,5,G[1],null,1),F.Nw(G);else break}return F}static esk(w,
F,G){if(!(F&&F.results&&w&&w.results&&w.results.length))return{returnValue:!1,GYe:w,xZe:F};const H=[];for(var L of F.results)Array.add(H,L.value);L=0;const I=0<F.results.length?F.results[0].score:0;for(const N of w.results)if(N.score>G&&!Array.contains(H,N.value)&&z.yTc(N.value)&&(0<I&&(N.score=I),Array.insert(F.results,L,N),L++),2===L)break;return 0<L?(G=F.results.length-5,0<G&&F.j5f(G),{returnValue:!0,GYe:w,xZe:F}):{returnValue:!1,GYe:w,xZe:F}}}z.dwh=!1;z.cwh=[];Object(E.a)(z,"CommandResultsUtility",
null,[])},1542:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{static cJo(f){return f.toString().charCodeAt(0)}static pSm(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static huh(f,a){if(f===a)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static guh(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=l.Hbj(f);a=l.Hbj(a);return f===a}static Hbj(f){return f.replace(l.zYc," ")}static jpb(f,a,k){return f.substring(a,a+k)}}l.zYc=RegExp("\u00a0",
"g");Object(E.a)(l,"CharUtils",null,[])},1543:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.appName="AppName";l.n3="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture="Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.noa="CorrelationID";l.nzn="ParentUiElement";l.query="Input";l.aMb="QueryID";l.N4i="QueryLength";l.qgc="QueryIndex";l.G6n="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source=
"Source";l.timeStamp="Time";l.QCj="UiElement";l.fce="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.NJo="TokenAcquired";l.YWm="LatencyType";l.groupName="GroupName";l.t8="GroupIndex";l.groupType="GroupType";l.C6n="ResultInfoList";l.resultType="ResultType";l.zgg="SubResultType";l.JLm="IsInputBlur";l.KLm="IsInputFocus";l.ARm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.xrl="DwellTime";l.pDi="IsZeroTerm";l.V5o="WordsCount";l.ZZd="IsSearchUxEnabled";
l.PSm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.bff="DisplayIndex";l.qtl="EnableList";l.provider="Provider";l.contentType="ContentType";l.$Qm="IsSelectionBased";l.mJk="BeginPerformanceMarker";l.Ptl="EndPerformanceMarker";l.oBn="PerformanceMeasure";Object(E.a)(l,"Columns",null,[])},1544:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.commandId=f;this.score=a}}Object(E.a)(l,"CommandSuggestion",null,[])},1548:function(E,K,c){E=c(0);
var l=c(365),f=c(800),a=c(243),k=c(55);class x{constructor(n,u,z){this.tfk=n;this.Nbk=u;this.ebk=z;this.NEe=new a.a(Object(k.a)(this,this.hVk,"checkIfDifferent"))}get dnb(){return this.tfk}get oldValue(){return this.Nbk}get newValue(){return this.ebk}get ijb(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get bY(){return this.ijb||
this.isDeleted||this.NEe.value}hVk(){return this.ijb||this.isDeleted?!0:!f.a.nuh(this.dnb,this.oldValue,this.newValue)}}Object(E.a)(x,"PropertyDiff",null,[]);c.d(K,"a",function(){return y});class y{constructor(n,u){this.Kbk=n;this.bbk=u;this.NEe=new a.a(()=>this.KTc());this.vfk=new a.a(Object(k.a)(this,this.Dwl,"evaluatePropertyDiffs"))}get Ku(){return this.Kbk}get yf(){return this.bbk}get ijb(){return!!this.yf&&!this.Ku}get isDeleted(){return!this.yf&&!!this.Ku}get bY(){return this.ijb||this.isDeleted||
this.NEe.value}get Mpa(){return this.vfk.value}KTc(n=null){let u=!1;this.Mpa.forEach((z,w)=>{u=w.bY&&(!n||7!==n.J(z));return!u});return u}Dwl(){const n=new l.a;var u=this.yf,z=this.Ku;if(this.ijb){z=u.Hl();for(var w=0;w<z.length;w++){var F=z[w];n.Z(f.a.yb(F),new x(F,null,u.EX(F)))}}else if(this.isDeleted)for(u=z.Hl(),w=0;w<u.length;w++)F=u[w],n.Z(f.a.yb(F),new x(F,z.EX(F),null));else{w=z.Hl();for(F=0;F<w.length;F++){var G=w[F],H=f.a.yb(G),L=z.EX(G);const I=u.hasProperty(G)?u.EX(G):null;n.Z(H,new x(G,
L,I))}w=u.Hl();for(F=0;F<w.length;F++)G=w[F],z.hasProperty(G)||(H=f.a.yb(G),L=u.EX(G),n.Z(H,new x(G,null,L)))}return n}}Object(E.a)(y,"MergeableObjectDiff",null,[])},1558:function(E,K,c){c.d(K,"b",function(){return x});c.d(K,"a",function(){return n});var l=c(223),f=c(365),a=c(602),k=c(1714);const x=(z,w,F)=>{const G=y(z,w,F);let H=0,L=0,I=0,N=new k.a;const P=new l.a;for(let M=0;M<G.length;M++){const J=G.eg(M+1);N.mAd(z.eg(H));N.oAd(w.eg(L));N.sAd(F.eg(I));H++;L++;for(I++;H<z.length&&(!J||!J.equals(z.eg(H)));)N.mAd(z.eg(H)),
H++;for(;L<w.length&&(!J||!J.equals(w.eg(L)));)N.oAd(w.eg(L)),L++;for(;I<F.length&&(!J||!J.equals(F.eg(I)));)N.sAd(F.eg(I)),I++;P.add(N);N=new k.a}for(;H<z.length;)N.mAd(z.eg(H)),H++;for(;L<w.length;)N.oAd(w.eg(L)),L++;for(;I<F.length;)N.sAd(F.eg(I)),I++;N.isEmpty||P.add(N);return P},y=(z,w,F)=>{const G=new l.a,H=w.TG(),L=F.TG();z.forEach(I=>{H.contains(I)&&L.contains(I)&&G.add(I);return!0});return G},n=(z,w,F)=>{z=z||new l.a;w=w||new l.a;F=F||new l.a;const G=new l.a,H=new f.a(0),L=new a.a;for(var I=
0;I<z.length;I++){var N=z.eg(I);H.Z(N,I)}for(z=I=0;I<w.length&&z<F.length;){N=w.eg(I);let P=F.eg(z),M=H.lz(N,-1),J=H.lz(P,-1);-1===M?(u(L,G,N),I++):-1===J?(u(L,G,P),z++):M===J?(u(L,G,N),I++,z++):M<J?I++:z++}for(;I<w.length;I++)N=w.eg(I),-1===H.lz(N,-1)&&u(L,G,N);for(;z<F.length;z++)w=F.eg(z),-1===H.lz(w,-1)&&u(L,G,w);return G},u=(z,w,F)=>{z.contains(F)||(w.add(F),z.add(F))}},1559:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(58);class f{constructor(){this.cp=0;this.id=l.a.create()}}
Object(E.a)(f,"LcsUpdateHint",null,[1043,68])},1560:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.qgc="QueryIndex";l.Lxj="TellMeRanker";l.Mxj="TellMeRankerLogging";Object(E.a)(l,"Services",null,[])},1561:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.zPa="HttpRequest";l.provider="Provider";Object(E.a)(l,"LatencyTypes",null,[])},1564:function(E,K,c){E=c(0);var l=c(15),f=c(6),a=c(223),k=c(168),x=c(239),y=
c(58),n=c(602),u=c(55),z=c(236),w=c(1581);class F extends w.a{constructor(){super();this.JSa=null}get lga(){return"CreateMergeBlock"}fEb(){this.detail.Z("Type",this.lga);this.detail.Z("Revision",this.JSa);return this.detail}}Object(E.a)(F,"CreateMergeBlockFailureDetail",w.a,[]);var G=c(1627),H=c(1629),L=c(1713),I=c(1582),N=c(1532),P=c(1773);c.d(K,"a",function(){return M});class M{static EGd(J,V,X,W,U,Y,ca){let aa;aa="";const fa=new a.a;for(let ra=0;ra<X.length;ra++){var pa=void 0;let la;pa=G.a.QRl(V,
X.J(ra),W,U,Y,ca,J);if(!pa)return{returnValue:null,h4a:aa};({FMf:la,h4a:pa}=pa.Zai());if(!la)return{returnValue:null,h4a:aa};aa+=pa;fa.RC(fa.length,la)}return{returnValue:fa,h4a:aa}}static yLh(J,V,X,W,U,Y,ca,aa){let fa,pa,ra,la,qa,La;La=qa=la=ra=pa=fa=null;({h4a:la,returnValue:fa}=M.EGd(V,Pa=>J.runtime.sk.J(Pa),X,1,Y,ca,aa));if(!fa)return k.a.instance.Ta(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
J.logger.Og(Object.assign(new F,{JSa:"Base"})),{returnValue:!1,EK:fa,xLc:pa,wad:ra,jBd:la,qLd:qa,Ume:La};({h4a:qa,returnValue:pa}=M.EGd(V,Pa=>J.runtime.zu.J(Pa)||J.runtime.sk.J(Pa),W,2,Y,ca,aa));if(!pa)return k.a.instance.Ta(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),J.logger.Og(Object.assign(new F,{JSa:"Favored"})),{returnValue:!1,EK:fa,xLc:pa,wad:ra,jBd:la,qLd:qa,Ume:La};({h4a:La,returnValue:ra}=
M.EGd(V,Pa=>J.runtime.Iq.J(Pa)||J.runtime.sk.J(Pa),U,4,Y,ca,aa));return ra?{returnValue:!0,EK:fa,xLc:pa,wad:ra,jBd:la,qLd:qa,Ume:La}:(k.a.instance.Ta(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),J.logger.Og(Object.assign(new F,{JSa:"Unfavored"})),{returnValue:!1,EK:fa,xLc:pa,wad:ra,jBd:la,qLd:qa,Ume:La})}static jFh(J,V=!1){const X=new a.a;let W=0;for(;W<J.length;){var U=J.J(W);if(1===U.type||
4===U.type||2===U.type)X.add(U),W++;else if(3===U.type){let ca="";ca+=U.character;W++;let aa=U.lQa,fa=!1;for(;W<J.length;W++){var Y=J.J(W);3===Y.type?U.runId===Y.runId&&U.iJ.equals(Y.iJ)&&(U.Mba===Y.Mba||U.CEa===Y.CEa)&&U.xF.BA(Y.xF)&&(!V||U.Yt&&U.Yt.equals(Y.Yt))?(ca+=Y.character,Y.lQa&&(aa=!0)):fa=!0:fa=!0;if(fa){U=new P.a(null,U.source,U.Hj,U.yg,U.runId,U.iJ,ca,U.Blb,!0,aa,U.Mba,U.CEa,U.ZRa,U.xF,U.Yt);X.add(U);break}}}}k.a.instance.Ta(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
X.dr());return X}static a0k(J,V=!1){const X=new a.a;let W=0;for(;W<J.length;){var U=J.J(W);if(1===U.type||4===U.type||2===U.type)X.add(U),W++;else if(3===U.type){let ca=U.character.toString();W++;let aa=U.lQa;for(;W<J.length;W++){var Y=J.J(W);if(3===Y.type&&M.lro(U,Y,V))ca+=Y.character,Y.lQa&&(aa=!0);else break}U=new P.a(null,U.source,U.Hj,U.yg,U.runId,U.iJ,ca,U.Blb,!0,aa,U.Mba,U.CEa,U.ZRa,U.xF,U.Yt);X.add(U)}}k.a.instance.Ta(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
X.dr());return X}static lro(J,V,X){return J.runId===V.runId&&J.iJ.equals(V.iJ)&&(J.Mba===V.Mba||J.CEa===V.CEa)&&J.xF.BA(V.xF)&&(!X||!!J.Yt&&J.Yt.equals(V.Yt))}static Xko(J,V,X,W,U,Y,ca,aa,fa,pa,ra,la,qa,La,Pa,Ka){J.setPropertyString(X.wm,l.a.mo,U);J.setPropertyUint32(X.wm,f.a.Lc,W);J.setPropertyUint32s(X.wm,f.a.jq,Y);J.setPropertyUint32s(X.wm,f.a.$s,ca);J.setPropertyObjectIds(X.wm,l.a.Hn,fa);J.hasProperty(X.wm,f.a.sj)&&J.setPropertyUint32(X.wm,f.a.sj,M.$Il());V&&V(10)&&J.setPropertyObjectIds(X.wm,
f.a.Cv,Ka);W=!1;for(U=0;U<pa.length;U++)if(pa.J(U)){W=!0;break}W&&J.setPropertyBools(X.wm,f.a.GQf,pa);M.MPk(V,J,X,ra,la,qa,La);M.NPk(J,X,Pa);X.qC(l.a.mo);X.qC(f.a.Lc);X.qC(f.a.jq);X.qC(f.a.$s);X.qC(l.a.Hn);X.qC(f.a.GQf);X.qC(l.a.zm);X.qC(l.a.$ob);X.qC(f.a.jPa);X.qC(f.a.IGa);X.qC(l.a.mxa);X.qC(f.a.Cv);J.hasProperty(X.wm,f.a.sj)&&X.qC(f.a.sj);0<aa.length?J.setPropertyUint32s(X.wm,l.a.zm,aa):X.wm.removeProperty(l.a.zm)}static MPk(J,V,X,W,U,Y,ca){if(J(99)){J=W.contains(!0,(aa,fa)=>fa);M.fbg(V,X,l.a.mxa,
J?W:null);M.fbg(V,X,l.a.$ob,M.idj(W,U));M.fbg(V,X,f.a.jPa,M.idj(W,Y));W=!1;for(U=0;U<ca.length;U++)0!==ca.J(U)&&(W=!0);W?V.setPropertyUint32s(X.wm,f.a.IGa,ca):X.wm.removeProperty(f.a.IGa)}}static NPk(J,V,X){const W=ca=>ca;var U=Object(u.a)(J,J.setPropertyBools,"setPropertyBools");M.aNa(V,X.ajb,W,U,f.a.ZEa);M.aNa(V,X.xfb,W,U,f.a.Yfa);M.aNa(V,X.d5a,W,U,f.a.HGa);U=ca=>0<ca.length;var Y=Object(u.a)(J,J.setPropertyStrings,"setPropertyStrings");M.aNa(V,X.$ib,U,Y,f.a.$Ea);M.aNa(V,X.wfb,U,Y,f.a.wDa);M.aNa(V,
X.Zmb,U,Y,f.a.nIa);U=ca=>!!ca;Y=Object(u.a)(J,J.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");M.aNa(V,X.bjb,U,Y,f.a.aFa);M.aNa(V,X.I_a,U,Y,f.a.xDa);M.aNa(V,X.anb,U,Y,f.a.oIa);X.d5a.any(W)?M.aNa(V,X.$mb,()=>!0,Object(u.a)(J,J.setPropertyObjectIds,"setPropertyObjectIds"),f.a.Zya):V.wm.removeProperty(f.a.Zya)}static idj(J,V){const X=new a.a;let W=!1;for(let U=0;U<J.length;U++){const Y=V.J(U)&&!J.J(U);X.add(Y);W=Y||W}return W?X:null}static fbg(J,V,X,W){W?J.setPropertyBools(V.wm,X,W):
V.wm.removeProperty(X)}static $Il(){return x.a.tF()}static Xbi(J,V){return J.runtime.zu.lz(V,J.runtime.sk.J(V)||J.runtime.Iq.get(V))}static COc(J,V,X,W,U){let Y;Y=new a.a;const ca=!!X&&X(10);if(J.runtime.Xb.isFeatureEnabled(76)){var aa=M.a0k(W,ca);var fa=M.jFh(W,ca);aa.length!==fa.length&&J.runtime.Xb.uz(76)}else aa=M.jFh(W,ca);fa=0;let pa="",ra=new a.a,la=new a.a,qa=new a.a,La=new a.a,Pa=new a.a,Ka=new a.a,Na=new a.a,sa=new a.a,wa=new a.a;const ja=new L.a;let ha=new a.a;var va=aa.J(aa.length-1);
if(2!==va.type&&4!==va.type)return k.a.instance.Ta(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",va.type),J.logger.Og(Object.assign(new I.a,{qj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",va.type)})),{returnValue:!1,B9d:Y};var xa=0;for(va=0;va<aa.length;va++){var ma=aa.J(va),Ja=null;if(1===ma.type||3===ma.type)Ja=ma,pa+=Ja.text;else if(4===ma.type){ma=M.Xbi(J,
ma.Hj);ma=new N.a(ma);Y.add(ma);continue}Ja?(ra.add(Ja.runId),la.add(Ja.yg),xa+=Ja.text.length,qa.add(xa),La.add(Ja.iJ),Pa.add(Ja.Blb),Ka.add(Ja.lQa),Na.add(Ja.Mba),sa.add(Ja.CEa),wa.add(Ja.ZRa),ja.ajb.add(Ja.xF.Hpm),ja.xfb.add(Ja.xF.kpm),ja.d5a.add(Ja.xF.kqm),ja.$ib.add(Ja.xF.insertion.author),ja.wfb.add(Ja.xF.deletion.author),ja.Zmb.add(Ja.xF.GGa.author),ja.bjb.add(Ja.xF.insertion.ZYc),ja.I_a.add(Ja.xF.deletion.ZYc),ja.anb.add(Ja.xF.GGa.ZYc),ja.$mb.add(Ja.xF.GGa.s_f),ca&&ha.add(Ja.Yt)):ra.length||
(ra.add(0),la.add(0),qa.add(0),La.add(y.a.nil),Pa.add(!1),Ka.add(!1),Na.add(!1),sa.add(!1),wa.add(0),ja.ajb.add(!1),ja.xfb.add(!1),ja.d5a.add(!1),ja.$ib.add(""),ja.wfb.add(""),ja.Zmb.add(""),ja.bjb.add(0),ja.I_a.add(0),ja.anb.add(0),ja.$mb.add(y.a.nil));if(2===ma.type){xa=ma;ma=xa.Lc;qa.lG(qa.length-1);Ja=U.J(fa);if(!Ja)return k.a.instance.Ta(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
fa,U.length,W.length,va,aa.length),J.logger.Og(Object.assign(new I.a,{qj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.sja(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",U.dr()),k.a.instance.sja(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",W.dr()),k.a.instance.sja(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",aa.dr()),{returnValue:!1,B9d:Y};if(Ja=M.Xbi(J,Ja))Ja=new N.a(Ja.IK()),M.Xko(V,X,Ja,xa.Lc,
pa,ra,la,qa,La,Pa,Ka,Na,sa,wa,ja,ha),Y.add(Ja);k.a.instance.Ta(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",xa.Hj,ma,ra.dr(),la.dr(),qa.dr(),Ka.dr(),Na.dr(),sa.dr(),La.dr(),"",wa.dr());fa++;pa="";ra=new a.a;la=new a.a;qa=new a.a;La=new a.a;Pa=new a.a;Ka=new a.a;Na=new a.a;sa=new a.a;wa=new a.a;ja.reset();xa=0;ha=
new a.a}}return{returnValue:!0,B9d:Y}}static u5n(J,V){const X=J.runtime.fn.J(z.a.xL),W=V.getPropertyObjectIds(X.wm,f.a.p1);for(let U=0;U<W.length;U++)J.runtime.fn.remove(W.J(U));V.setPropertyObjectIds(X.wm,f.a.p1,new a.a);V.setPropertyString(X.wm,f.a.bUa,y.a.nil.toString());X.qC(f.a.p1);X.qC(f.a.bUa)}static yzm(J,V){if(J.runtime.fn.nb(z.a.xL))return null;const X=new N.a(J.runtime.sk.J(z.a.xL).IK());V.setPropertyString(X.wm,f.a.bUa,J.output.KM.last().id.toString());V.setPropertyObjectIds(X.wm,f.a.p1,
new a.a);X.qC(f.a.p1);X.qC(f.a.bUa);J.runtime.fn.Z(z.a.xL,X);return X}static Erf(J){const V=new a.a;J.forEach(X=>{V.add(X.id);return!0});return V}static Wcc(J,V,X,W){let U=0;X.forEach(Y=>{H.a(Y,V+U++,1);393230===Y.Qc&&J.getPropertyObjectIds(Y,l.a.Hn).forEach(ca=>{W.add(ca);return!0});return!0})}static V1m(J,V){const X=new n.a;let W=0;V.forEach(U=>{if(X.contains(U))return!0;X.add(U);if(({index:W}=M.jKf("BaseFormatting_",W,U,Y=>J.runtime.sk.J(Y))).returnValue||({index:W}=M.jKf("FavoredFormatting_",
W,U,Y=>J.runtime.zu.J(Y))).returnValue||({index:W}=M.jKf("ConflictingFormatting_",W,U,Y=>J.runtime.Iq.J(Y))).returnValue)return!0;W++;return!0})}static jKf(J,V,X,W){if(X=W(X))if(H.a(X,J+V,1),1179649===X.Qc)return V++,{returnValue:!0,index:V};return{returnValue:!1,index:V}}static Lff(J){return!!J.runtime.sk.J(z.a.xL)}static aNa(J,V,X,W,U){V.any(X)?(W(J.wm,U,V),J.qC(U)):J.wm.removeProperty(U)}static pmj(J,V){const X=new a.a;X.add(0);const W=J?J.length:0;for(let U=0;U<W;U++)X.insert(U+1,J.eg(U));X.insert(X.length,
V);return X}}Object(E.a)(M,"ParagraphMergeUtils",null,[])},1579:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(223);class f{constructor(a,k,x){this.Bm=null;this.Ck=a;this.source=k;this.Hj=x}get type(){return this.Ck}get f7a(){return!1}get rKm(){return 1===(this.source&1)}get sKm(){return 2===(this.source&2)}get tKm(){return 4===(this.source&4)}s4(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.dNl(),this.W6b())}dNl(){let a="";this.rKm&&(a+="Base");this.sKm&&
(a+="FavoredUpdate");this.tKm&&(a+="UnfavoredUpdate");return a}W6b(){return""}BA(a){return this.type===a.type}S8c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(E.a)(f,"AMergeBlock",null,[110,111])},1580:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1579);class l extends c.a{constructor(f,a,k){super(2,f,a);this.Lc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Lc,this.Hj)}W6b(){return"Eop"}clone(){return new l(this.source,
this.Hj,this.Lc)}BA(f,a,k,x=!1,y=!0){return super.BA(f,a,k,x)?y?f.Lc===this.Lc:f.Hj===this.Hj&&f.Lc===this.Lc:!1}get length(){return 1}}Object(E.a)(l,"EopMergeBlock",c.a,[])},1581:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(365);class f{constructor(){this.detail=new l.a}}Object(E.a)(f,"AMergeFailureDetail",null,[1027])},1582:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1531);class l extends c.a{constructor(){super()}get lga(){return"ParagraphMerge"}}Object(E.a)(l,
"ParagraphMergeFailureDetail",c.a,[])},1583:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1531);class l extends c.a{constructor(){super()}get lga(){return"RdOpLcs"}}Object(E.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1584:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1531);class l extends c.a{constructor(){super()}get lga(){return"TableMerge"}}Object(E.a)(l,"TableMergeFailureDetail",c.a,[])},1590:function(E,K,c){E=c(0);class l{constructor(){this.u$c=this.vSc=null;this.mMf=
this.score=this.BYc=0}$Xf(G,H,L){this.score=G.J(H);++H;this.vSc=G.J(H)?L.zna(G.J(H)):null;++H;this.u$c=G.J(H)?L.zna(G.J(H)):null;++H;this.BYc=G.J(H);++H;this.mMf=G.J(H);++H;return H}}Object(E.a)(l,"TokenStringGeneratorInit",null,[]);class f{constructor(G,H,L,I,N){this.Ggb=G;this.count=H;this.hMd=L;this.uO=I;this.depth=N}}Object(E.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=c(1645),k=c(1731);class x{constructor(G=null,H=0,L=0,I=0){this.ymk=G||new k.a;this.rva=H;this.uO=L;this.depth=I}get F5(){return this.ymk}getKey(){return this.F5.Hx.toString()+
":"+this.rva.toString()}}Object(E.a)(x,"TrieBookmark",null,[]);class y{constructor(G,H){this.UQa=G;this.tLf=H}N7m(G){if(null==G)throw Error.argumentNull("prefix");let H={};var L=H[""]=new x;this.qVd(L,H);for(L=0;L<G.length;++L){const I=G.charCodeAt(L),N={};for(let P in H)this.Wzk(I,H[P],N);H=N}return this.GLo(H)}qVd(G,H){if(!(G.uO>=this.tLf)&&(G=new x(a.a.D7e(G.F5),G.rva,G.uO+1,G.depth),G.F5.DF&a.a.E8a&&(G.rva+=1),this.UQa.lQb(G.F5))){G.depth+=1;let L=!0;for(;L;)y.Ane(G,H),this.qVd(G,H),G.rva+=this.UQa.i7b(G.F5,
!0)+(G.F5.DF&a.a.E8a?1:0),L=this.UQa.T$c(G.F5)}}Wzk(G,H,L){H.uO+1<=this.tLf&&(H.uO+=1,y.Ane(H,L),--H.uO);H.F5.DF&a.a.E8a&&(H.rva+=1);if(this.UQa.lQb(H.F5)){H.depth+=1;let I=!0;for(;I;)H.F5.nRb===G?(y.Ane(H,L),this.qVd(H,L)):H.uO+1<=this.tLf&&(H.uO+=1,y.Ane(H,L),this.qVd(H,L),--H.uO),H.rva+=this.UQa.i7b(H.F5,!0)+(H.F5.DF&a.a.E8a?1:0),I=this.UQa.T$c(H.F5)}}GLo(G){const H=[];for(var L in G){const I=G[L];if(!I.F5.Hx)continue;const N=!!(I.F5.DF&a.a.E8a),P=this.UQa.i7b(I.F5,!1)+(N?1:0);Array.add(H,new f(I.rva,
P,N,I.uO,I.depth))}H.sort((I,N)=>{let P=I.Ggb-N.Ggb;return P||(P=-(I.count-N.count))?P:P=I.depth-N.depth});if(2>H.length)return H;G=[];for(L=0;L<H.length;)L+=y.yAj(L,H,G);return G}static Ane(G,H){const L=G.getKey();L in H?(H=H[L],H.uO=Math.min(H.uO,G.uO)):H[L]=new x(a.a.D7e(G.F5),G.rva,G.uO,G.depth)}static yAj(G,H,L){const I=H[G];let N=I.Ggb;const P=N+I.count;let M=1,J=I.hMd;for(;G+M<H.length&&H[G+M].Ggb<P;){const V=H[G+M];V.Ggb>N&&(Array.add(L,new f(N,V.Ggb-N,J,I.uO,I.depth)),J=!1);M+=y.yAj(G+M,
H,L);N=V.Ggb+V.count}N<P&&Array.add(L,new f(N,P-N,J,I.uO,I.depth));return M}}Object(E.a)(y,"ErrorTolerantTrieLookupEngine",null,[1614]);class n extends l{constructor(G,H,L){super();this.opi=this.eYi=!1;this.NWh=null;if(G){var I=0;try{I=this.$Xf(G,I,H);this.eYi=1===G.J(I);++I;this.opi=1===G.J(I);++I;const N=G.J(I);this.NWh=this.Hzn(L,N)}catch(N){throw Error.argument("initData");}}}Hzn(G,H){return new y(G,H)}}Object(E.a)(n,"FuzzyMatchTokenStringGeneratorInit",l,[]);class u extends l{constructor(G,H){super();
this.query=this.name=null;if(G){this.annotations=H.annotations;var L=0;try{L=this.$Xf(G,L,H),this.name=H.QD(G.J(L)),++L,this.query=H.UK(G.J(L))}catch(I){throw Error.argument("initData");}}}}Object(E.a)(u,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(G,H){super();if(G)try{this.$Xf(G,0,H)}catch(L){throw Error.argument("initData");}}}Object(E.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var w=c(1516);c.d(K,"a",function(){return F});class F{constructor(G){this.jLf=G}get vSc(){return this.jLf.vSc}get u$c(){return this.jLf.u$c}get BYc(){return this.jLf.BYc}static create(G,
H,L){const {SurfaceStringTokenStringGenerator:I}=c(1871),{QueryTokenStringGenerator:N}=c(1872),{FuzzyMatchTokenStringGenerator:P}=c(1873);let M=0;try{if(G.J(M)!==F.Yzb)throw Error.argument("initData","Input does not represent a token string generator");++M;const J=G.J(M);++M;const V=new w.a;V.Rgb(G,M,G.count-M);switch(J){case I.uFc:return new I(new z(V,H));case N.uFc:return new N(new u(V,H));case P.uFc:return new P(new n(V,H,L));default:throw Error.argument("initData");}}catch(J){throw Error.argument("initData");
}}static Xoh(G,H,L,I,N,P){G=G.SJo.getId(H,null);if(0>G)return++P,P;F.Yoh(G,L,I,N);return P}static Yoh(G,H,L,I){Array.add(I.ngg,G);Array.add(I.Fvj,H);++I.wlc[L]}}F.Yzb=1099767983;Object(E.a)(F,"TokenStringGenerator",null,[1591])},1626:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(223);K=c(1579);var f=c(1542);class a extends K.a{constructor(k,x,y){super(k,x,y)}Jzo(k){let x;x=null;if(!this.text||!this.f7a||0>=k||k>=this.length)return{returnValue:!1,$tj:x};x=new l.a;const y=this.clone();
y.z7c(f.a.jpb(this.text,0,k));const n=this.clone();n.z7c(f.a.jpb(this.text,k,this.length-k));x.add(y);x.add(n);return{returnValue:!0,$tj:x}}s4(){return!0}get length(){return this.text.length}}Object(E.a)(a,"ATextMergeBlock",K.a,[])},1627:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(168);class f{M0e(a,k){return a+("[Block: "+k+"] ")}static QRl(a,k,x,y,n,u,z){const {ParagraphMergeBlockCreator:w}=c(1965),{TableMergeBlockCreator:F}=c(1968);if(393230===k.Qc)return new w(a,k,x,n,u,y(10),
z);if(393250===k.Qc)return new F(k,x);l.a.instance.Ta(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Qc);return null}}Object(E.a)(f,"MergeBlockCreator",null,[])},1628:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(6),f=c(58);K=c(1626);var a=c(1548);class k extends K.a{constructor(x,y,n,u,z,w,F,G,H,L,I,N,P,M){super(y,n,u);this.yg=z;this.runId=w;this.Blb=G;this.e3j=F;this.nse=x;this.lQa=H;this.Mba=L;this.CEa=I;this.ZRa=N;this.xF=P;this.Yt=M}get XDc(){return this.nse}get iJ(){return this.e3j}get tDb(){return this.XDc(this.iJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.yg,this.runId,this.Blb,this.Hj,this.iJ.toString(),this.Yt?this.Yt.toString():"NULL")}BA(x,y,n,u=!1){if(!super.BA(x,y,n,u))return!1;if(u)return!0;if(!this.xF.BA(x.xF)||this.Yt&&!this.Yt.equals(x.Yt))return!1;if(this.iJ.equals(x.iJ)||this.iJ.equals(f.a.nil)||x.iJ.equals(f.a.nil))return!0;x=new a.a(this.tDb,x.tDb);y=y.$Kh(this.tDb,n);return x.KTc(y.tae)?!1:!0}get kFm(){return this.s4()&&"\ufffc"===this.text&&this.tDb?this.tDb.hasProperty(l.a.gt)||1179725!==this.tDb.Qc?!0:!1:!1}}
Object(E.a)(k,"AUserRunMergeBlock",K.a,[])},1629:function(E,K,c){c.d(K,"a",function(){return f});var l=c(168);const f=(a,k,x=4)=>{a?l.a.instance.sja(4273285,x,4,k,a.n$c()):l.a.instance.Ta(4293845,x,1,k,"{0}: Node was null.",k)}},1630:function(E,K,c){c.d(K,"e",function(){return y});c.d(K,"a",function(){return n});c.d(K,"d",function(){return u});c.d(K,"b",function(){return z});c.d(K,"c",function(){return w});var l=c(6),f=c(15),a=c(58),k=c(1035),x=c(1558);const y=(H,L,I)=>{const N=new k.a;let P=a.a.nil;
L=N.getPropertyObjectId(L,l.a.spb);L.equals(a.a.nil)||(H=H.runtime.sk.J(L),I&&(H=I.lz(L,H)),H&&(P=N.getPropertyObjectId(H,l.a.spb)));return P},n=(H,L,I,N,P)=>{const M=new k.a;let J=null;var V=M.getPropertyObjectId(I,l.a.spb);V!==a.a.nil&&(J=H.runtime.sk.J(V),L&&(J=L.lz(V,J)));if(J){V=M.getPropertyObjectIds(J,f.a.ef);for(P=0;P<V.length&&!V.J(P).equals(I.id);P++);P===V.length&&(P=-1)}I=y(H,I,L);if(!I.equals(a.a.nil)&&(H=H.runtime.sk.J(I),L&&(H=L.lz(I,H)),H)){L=M.getPropertyObjectIds(H,f.a.ef);for(N=
0;N<L.length&&!L.J(N).equals(J.id);N++);N===L.length&&(N=-1)}return{rowIndex:N,K2b:P}},u=(H,L,I,N,P)=>{var M=new k.a;let J=null;var V=H.runtime.sk.J(I);L&&(V=L.lz(I,V));if(!V)return null;V=M.getPropertyObjectIds(V,f.a.ef);I=null;N<V.length&&(N=V.J(N),I=H.runtime.sk.J(N),L&&(I=L.lz(N,I)));I&&(M=M.getPropertyObjectIds(I,f.a.ef),P<M.length&&(P=M.J(P),J=H.runtime.sk.J(P),L&&(J=L.lz(P,J))));return J},z=(H,L,I)=>{let N,P;P=N=-1;const M=(new k.a).getPropertyObjectId(I,l.a.spb);var J=y(H,I,L);if(J.equals(a.a.nil)||
M.equals(a.a.nil))return{rowIndex:N,K2b:P};L=H.runtime.Ahg;var V=L.J(J);if(!V){V=F(H,J);if(!V)return{rowIndex:N,K2b:P};L.Z(J,V)}for(J=0;J<V.length;J++)if(V.J(J).equals(M)){N=J;break}V=L.J(M);if(!V){V=G(H,M);if(!V)return{rowIndex:N,K2b:P};L.Z(M,V)}for(H=0;H<V.length;H++)if(V.J(H).equals(I.id)){P=H;break}return{rowIndex:N,K2b:P}},w=(H,L,I,N)=>{if(0>I||0>N)return a.a.nil;new k.a;const P=H.runtime.Ahg;let M=P.J(L);if(!M){M=F(H,L);if(!M)return a.a.nil;P.Z(L,M)}if(I<M.length)L=M.J(I);else return a.a.nil;
I=P.J(L);if(!I){I=G(H,L);if(!I)return a.a.nil;P.Z(L,I)}if(N<I.length)H=I.J(N);else return a.a.nil;return H},F=(H,L)=>{var I=new k.a;const N=H.runtime.sk.J(L);if(N){var P=H.runtime.zu.lz(L,N);H=H.runtime.Iq.lz(L,N);L=I.getPropertyObjectIds(N,f.a.ef);P=I.getPropertyObjectIds(P,f.a.ef);I=I.getPropertyObjectIds(H,f.a.ef);return L.Zp(P,(M,J)=>M.equals(J))?I:L.Zp(I,(M,J)=>M.equals(J))?P:x.a(L,P,I,(M,J)=>M.equals(J))}return(P=H.runtime.zu.J(L))?I.getPropertyObjectIds(P,f.a.ef):(P=H.runtime.Iq.J(L))?I.getPropertyObjectIds(P,
f.a.ef):null},G=(H,L)=>{var I=new k.a;const N=H.runtime.sk.J(L);if(N){var P=H.runtime.zu.lz(L,N);H=H.runtime.Iq.lz(L,N);L=I.getPropertyObjectIds(N,f.a.ef);P=I.getPropertyObjectIds(P,f.a.ef);I=I.getPropertyObjectIds(H,f.a.ef);return L.Zp(P,(M,J)=>M.equals(J))?I:L.Zp(I,(M,J)=>M.equals(J))?P:null}return(P=H.runtime.zu.J(L))?I.getPropertyObjectIds(P,f.a.ef):(P=H.runtime.Iq.J(L))?I.getPropertyObjectIds(P,f.a.ef):null}},1631:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1497);class l extends c.a{constructor(f,
a,k,x,y=null){super(f,a,y,null,k);this.id=x}}Object(E.a)(l,"TryQueryResultBinding",c.a,[])},1632:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f){this.Ab=f}get v4a(){return this.Ab.v4a}get YDo(){return 4!==this.Ab.style}get $Do(){return!0}get trie(){return this.Ab.trie}getId(f,a){if(!this.YDo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ab.style){case 0:return this.VYl(f,a);default:throw Error.notImplemented();}}QD(f){if(!this.$Do)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>f||f>=this.v4a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ab.style){case 0:return this.Ocm(f);case 4:return this.Ncm(f);default:throw Error.notImplemented();}}VYl(f,a){f=this.Ab.trie.yKi(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.Klc||f.Klc>=this.Ab.v4a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ab.U$c?this.Ab.k3c.Dy(this.Ab.U$c+4*f.Klc,4):f.Klc}Ocm(f){if(this.Ab.U$c){let a=0;for(;a<this.Ab.v4a&&this.Ab.k3c.Dy(this.Ab.U$c+
4*a,4)!==f;++a);if(a>=this.Ab.v4a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ab.trie.ugi(a)}return this.Ab.trie.ugi(f)}Ncm(f){const a=this.Ab.k3c.Dy(this.Ab.Cvj+4*f,4);f=this.Ab.k3c.Dy(this.Ab.Dvj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({Ftm:f}=this.NOn(f)).returnValue;return String.fromCharCode.apply(null,k)}NOn(f){let a=0;for(let k=0;3>k;++k){const x=
this.Ab.k3c.J(this.Ab.OBh+f)^182;++f;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,Ftm:f}}}Object(E.a)(l,"StringTable",null,[1576])},1633:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(1645);class f{constructor(a){this.trie=null;this.OBh=this.Cvj=this.Dvj=this.U$c=0;if(a){this.k3c=a;var k=0;if(a.Dy(k,4)!==f.Yzb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.v4a=a.Dy(k,4);k+=4;this.style=a.Dy(k,4);k+=4;switch(this.style){case 0:const x=1===
a.Dy(k,4);k+=4;x||(this.U$c=k,k+=4*this.v4a);a.Dy(k,4);this.trie=this.gAn(a,k+4);break;case 4:this.Dvj=k;this.Cvj=k+=4*this.v4a;k+=4*this.v4a;a.Dy(k,4);this.OBh=k+4;break;default:throw Error.argument("bytes");}}}gAn(a,k){return new l.a(a,k)}}f.Yzb=1025118440;Object(E.a)(f,"StringTableInit",null,[])},1634:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.Answer=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.WolframAnswer=3]="WolframAnswer";f[f.Assistance=
4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.TryQuery=7]="TryQuery";f[f.FindInDocument=8]="FindInDocument";f[f.HelpAction=9]="HelpAction";f[f.Insights=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";f[f.FirstRunResult=13]="FirstRunResult";f[f.NoCommandsFoundResult=14]="NoCommandsFoundResult";f[f.TestResult=15]="TestResult";f[f.AppsForOffice_Installed=16]="AppsForOffice_Installed";f[f.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";f[f.AppsForOffice_Query=
18]="AppsForOffice_Query";f[f.Notes_Onenote=19]="Notes_Onenote";f[f.Notes_Samsung=20]="Notes_Samsung";f[f.Notes_Sticky=21]="Notes_Sticky";f[f.Learning=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.ActionAI=25]="ActionAI";f[f.ActionAICommand=26]="ActionAICommand";f[f.Addin=27]="Addin";f[f.OfficeScript=28]="OfficeScript";f[f.AddinStoreEntry=29]="AddinStoreEntry";f[f.GenerateSlides=30]="GenerateSlides";f[f.SummarizeDeck=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(l||
(l={}));Object(E.b)("ResultType",l)},1642:function(E,K,c){E=c(0);var l=c(6),f=c(602),a=c(168),k=c(223),x=c(58),y=c(365),n=c(73),u;(function(eb){eb[eb.none=0]="none";eb[eb.mergeConflict=1]="mergeConflict";eb[eb.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";eb[eb.failedToApplyHints=3]="failedToApplyHints";eb[eb.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";eb[eb.other=5]="other"})(u||(u={}));Object(E.b)("ParagraphMergeUsingHintsFailureReason",u);var z=c(1035),
w=c(236),F=c(896);const G=eb=>{const Ib=new k.a;eb.forEach(Xa=>{Ib.add(Xa);return!0});return Ib};var H=c(1580),L=c(1558),I=c(1583);const N=(eb,Ib)=>{if(eb.length!==Ib.length)return!1;for(let Xa=0;Xa<eb.length;Xa++)eb.J(Xa).Bm=Ib.J(Xa),Ib.J(Xa).Bm=eb.J(Xa);return!0},P=(eb,Ib,Xa)=>{let Ra,gb,Bb;Ra=0;gb=!1;Bb=0;var $b;if(!({idx:$b}=W(eb,Ib)).returnValue)return a.a.instance.Ta(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Ib,eb.dr()),{returnValue:!1,
$Pc:Ra,wlb:gb,uZc:Bb};if(!Xa&&2===eb.J($b).type)return{returnValue:!0,$Pc:$b,wlb:gb,uZc:Bb};if(!eb.J($b).s4())return a.a.instance.Ta(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",$b,Xa,eb.dr()),{returnValue:!1,$Pc:Ra,wlb:gb,uZc:Bb};let Qb=!1,Ac=0;for(;$b<eb.length&&eb.J($b).Hj.equals(Ib);$b++){if(Xa===Ac){Qb=!0;break}if(Xa>Ac&&Xa<Ac+eb.J($b).length){gb=Qb=!0;Bb=Xa-Ac;break}Ac+=eb.J($b).length}Qb||Xa!==Ac||(Qb=!0);Qb&&(Ra=
$b);return{returnValue:Qb,$Pc:Ra,wlb:gb,uZc:Bb}},M=(eb,Ib,Xa)=>{let Ra,gb,Bb;Bb=gb=0;Ra=!1;let $b=0,Qb=!1;for(;gb<eb.length;gb++){if(Ib===$b){Qb=!0;break}if(Ib>$b&&Ib<$b+eb.J(gb).length){Ra=Qb=!0;Bb=Ib-$b;break}$b+=eb.J(gb).length}Qb||Ib!==$b||(Qb=!0);Qb||(eb=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",eb.length,$b,Ib),a.a.instance.Ta(573178201,1,2,eb),Xa.Og(Object.assign(new I.a,{eventId:"8k6fz",info:eb})));return{returnValue:Qb,wlb:Ra,bwh:gb,awh:Bb}},
J=(eb,Ib,Xa)=>{let Ra;if(eb.J(Ib).s4()&&({$tj:Ra}=eb.J(Ib).Jzo(Xa)).returnValue)return eb.RC(Ib+1,Ra),eb.lG(Ib),!0;a.a.instance.Ta(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Ib,Xa,eb.dr());return!1},V=(eb,Ib,Xa)=>{let Ra,gb;if(!({$Pc:Xa,wlb:gb,uZc:Ra}=P(eb,Ib,Xa)).returnValue)return{returnValue:!1,index:0};if(!gb)return{returnValue:!0,index:Xa};if(J(eb,Xa,Ra))return{returnValue:!0,index:Xa+1};a.a.instance.Ta(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
Ib,Ra,eb.dr());return{returnValue:!1,index:0}},X=(eb,Ib,Xa)=>{let Ra;if(!({wlb:Ra,bwh:Ib,awh:Xa}=M(eb,Ib,Xa)).returnValue)return{returnValue:!1,index:0};if(!Ra)return{returnValue:!0,index:Ib};if(J(eb,Ib,Xa))return{returnValue:!0,index:Ib+1};a.a.instance.Ta(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Xa,eb.dr());return{returnValue:!1,index:0}},W=(eb,Ib)=>{let Xa;Xa=0;for(let Ra=0;Ra<eb.length;Ra++)if(eb.J(Ra).Hj.equals(Ib))return Xa=Ra,{returnValue:!0,
idx:Xa};a.a.instance.Ta(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Ib,eb.dr());return{returnValue:!1,idx:Xa}},U=(eb,Ib)=>{let Xa;Xa=-1;for(let Ra=Ib;Ra<eb.length;Ra++)if(2===eb.J(Ra).type)return Xa=Ra,{returnValue:!0,jga:Xa};a.a.instance.Ta(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Ib,eb.dr());return{returnValue:!1,jga:Xa}},Y=(eb,Ib,Xa)=>{let Ra;Ra=-1;for(let gb=Xa;gb<eb.length;gb++)if(2===
eb.J(gb).type&&eb.J(gb).Hj.equals(Ib))return Ra=gb,{returnValue:!0,jga:Ra};a.a.instance.Ta(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",Ib,Xa,eb.dr());return{returnValue:!1,jga:Ra}},ca=(eb,Ib)=>{let Xa;Xa=0;var Ra;if(!({idx:Ra}=W(eb,Ib)).returnValue)return a.a.instance.Ta(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ib,eb),{returnValue:!1,length:Xa};for(;Ra<eb.length;Ra++)if(6!==eb.J(Ra).type){if(2===eb.J(Ra).type)return{returnValue:!0,
length:Xa};a.a.instance.shipAssertTag(17342617,1,eb.J(Ra).s4(),"We found something other than text with type "+eb.J(Ra).type);a.a.instance.shipAssertTag(17877021,1,eb.J(Ra).Hj.equals(Ib),"Unexpected GraphNodeId {0} for ParaId {1}",eb.J(Ra).Hj,Ib);Xa+=eb.J(Ra).length}a.a.instance.Ta(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ib,eb);return{returnValue:!1,length:Xa}},aa=eb=>{const Ib=new k.a;for(let Xa=0;Xa<eb.length;Xa++)Ib.add(eb.J(Xa).clone());return Ib};var fa=c(1582),pa=
c(1542);class ra{constructor(eb,Ib,Xa=null,Ra=null){this.Hj=eb;this.type=Ib;this.text=Xa;this.Lc=Ra}isEqual(eb){return eb.Hj.equals(this.Hj)&&this.type===eb.type&&this.Lc===eb.Lc&&pa.a.guh(this.text,eb.text)}toString(){let eb=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Hj,this.Lc,this.type);this.text&&(eb+=String.format(" [TextLength: {0}]",this.text.length));return eb}}Object(E.a)(ra,"MergeBlockValidationState",null,[]);var la=c(110),qa=c(940),La=c(859),Pa=c(532),
Ka=c(464),Na=c(939),sa=c(858),wa=c(1531),ja=c(1721),ha;(function(eb){eb[eb.base=1]="base";eb[eb.favoredUpdate=2]="favoredUpdate";eb[eb.unfavoredUpdate=4]="unfavoredUpdate";eb[eb.min=1]="min";eb[eb.max=7]="max"})(ha||(ha={}));Object(E.b)("MergeBlockSource",ha);class va{constructor(eb,Ib,Xa,Ra){this.yg=eb;this.cp=Ib;this.iBd=Xa;this.cbd=Ra}}Object(E.a)(va,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var xa=c(1579);class ma extends xa.a{constructor(eb,Ib){super(6,eb,Ib);this.Lc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.Hj)}W6b(){return"Selection"}clone(){return new ma(this.source,this.Hj)}BA(){return!1}get length(){return 0}}Object(E.a)(ma,"SelectionMergeBlock",xa.a,[]);var Ja;(function(eb){eb[eb.success=0]="success";eb[eb.selfSplit=1]="selfSplit";eb[eb.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";eb[eb.unexpected=3]="unexpected"})(Ja||(Ja={}));Object(E.b)("SplitTwinListResult",Ja);var oa=c(1626);class za extends oa.a{constructor(eb,Ib,Xa,Ra){super(5,eb,Ib);this._text=null;this.z7c(Xa);
this.ank=Ra}get text(){return this._text}z7c(eb){this._text=eb}get Kad(){return this.ank}clone(){return new za(this.source,this.Hj,this.text,this.Kad)}get f7a(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(E.a)(za,"UpdateHintTextMergeBlock",oa.a,[]);class Fa{constructor(eb,Ib,Xa,Ra){this.z2=!1;this.Ybb=new y.a;this.Yd=eb;this.Ejh=Ra;this.wNg=Xa;this._base=Ib;this.Axe=aa(Ib);if(!N(this.base,this.Pe))throw a.a.instance.Ta(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),
eb.logger.Og(Object.assign(new wa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Pe(){return this.Axe}get mergeConflict(){return this.z2}A1e(eb,Ib){switch(eb.type){case 1:return this.WDk(eb,Ib);case 2:return this.Z0e(eb,Ib);case 3:return this.WEk(eb,Ib);case 4:return this.qEk(eb);case 5:return this.lDk(eb,Ib);case 6:return this.X0e(eb);default:return!1}}z1e(eb,Ib){switch(eb.type){case 1:return this.c1e(eb,Ib);case 2:return this.Y0e(eb,
Ib);case 3:return this.VEk(eb,Ib);case 4:return this.pEk(eb);case 5:return this.kDk(eb,Ib);case 6:return this.W0e(eb);default:return{returnValue:!1,nu:null}}}WDk(eb,Ib){let Xa;const Ra=({Yga:Xa}=this.OHa(eb.yg,Ib,!1,eb.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Ra&&1!==Ra)return 3!==Ra&&(a.a.instance.Ta(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",ha[Ib],Ja[Ra]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vv"}))),!1;this.z2=!1;Ib=new za(Ib,eb.yg,eb.text,eb.id);this.eAf(eb,Xa,Ib);return!0}Z0e(eb,Ib){let Xa,Ra=({Yga:Xa}=this.OHa(eb.yg,Ib,!1,eb.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==Ra&&1!==Ra)return 3!==Ra&&(a.a.instance.Ta(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",ha[Ib],Ja[Ra]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;
let gb;({Yga:gb,returnValue:Ra}=this.OHa(eb.yg,Ib,!1,eb.cp+eb.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Ra&&1!==Ra)return 3!==Ra&&(a.a.instance.Ta(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",ha[Ib],Ja[Ra]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.z2=!1;this.idf(eb,Xa,gb);return!0}WEk(eb,Ib){let Xa;const Ra=({yyf:Xa}=this.k$h(eb,Ib,!1)).returnValue;
if(0!==Ra&&1!==Ra)return 3!==Ra&&(a.a.instance.Ta(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",ha[Ib],Ja[Ra]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.z2=!1;Ib=new H.a(Ib,eb.Ut,eb.yta);this.eAf(eb,Xa,Ib);return!0}qEk(eb){let Ib;if(!({wVd:Ib}=this.l$h(eb,this.Pe,"Derived")).returnValue)return!1;this.idf(eb,Ib,Ib+1);return!0}lDk(eb,Ib){let Xa;if(!({EMf:Ib,xyf:Xa}=
this.Yai(eb,!1,Ib)).returnValue)return!1;this.eAf(eb,Xa,Ib);return!0}X0e(eb){let Ib;if(!({vVd:Ib}=this.c$h(eb,this.Pe,"Derived")).returnValue)return!1;this.idf(eb,Ib,Ib+1);return!0}rth(eb,Ib,Xa){const Ra=({Yga:Ib}=this.OHa(eb,Xa,!1,Ib,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==Ra&&1!==Ra)return 3!==Ra&&(a.a.instance.Ta(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",ha[Xa],Ja[Ra]),this.Yd.logger.Og(Object.assign(new ja.a,
{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.z2=!1;eb=new ma(Xa,eb);this.Pe.insert(Ib,eb);return!0}c1e(eb,Ib){var Xa=null;if(Fa.dwi(eb.text.length))return{returnValue:!1,nu:Xa};let Ra,gb,Bb;var $b=({Yga:Ra,lwa:gb,Qfa:Bb}=this.OHa(eb.yg,Ib,!0,eb.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==$b&&2!==$b)return 3!==$b&&(a.a.instance.Ta(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[Ib],
Ja[$b]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,nu:Xa};this.z2=!1;({jga:$b}=U(this.Pe,gb));$b=this.Pe.J($b).Hj;Xa=new za(Ib,eb.yg,eb.text,eb.id);Ib=new za(Ib,$b,eb.text,eb.id);Xa.Bm=Ib;Ib.Bm=Xa;this.base.insert(Ra,Xa);this.Pe.insert(gb,Ib);Xa=new k.a;Xa.add(new Ka.a($b,Bb,eb.text,eb.id,eb.Du));return{returnValue:!0,nu:Xa}}Y0e(eb,Ib){let Xa;Xa=null;if(Fa.dwi(eb.text.length))return{returnValue:!1,nu:Xa};let Ra;var gb,Bb=({Yga:Ra,
lwa:$b,Qfa:gb}=this.OHa(eb.yg,Ib,!0,eb.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Bb){if(2!==Bb)return 3!==Bb&&(a.a.instance.Ta(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",ha[Ib],Ja[Bb]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,nu:Xa};var $b=0;for({idx:gb}=W(this.base,eb.yg);gb<this.base.length&&$b<eb.cp;gb++)$b+=
this.base.J(gb).length;$b-=this.base.J(gb-1).length;({lwa:$b,Qfa:gb,returnValue:Bb}=this.OHa(eb.yg,Ib,!0,$b,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Bb)return 3!==Bb&&(a.a.instance.Ta(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",ha[Ib],Ja[Bb]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,nu:Xa};this.z2=!1}var Qb,Ac;({Yga:Qb,
lwa:Ac,Qfa:Db,returnValue:Bb}=this.OHa(eb.yg,Ib,!0,eb.cp+eb.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Bb){if(2!==Bb)return 3!==Bb&&(a.a.instance.Ta(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",ha[Ib],Ja[Bb]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,nu:Xa};var Db=0;for({idx:Ac}=W(this.base,eb.yg);Ac<this.base.length&&
Db<eb.cp+eb.text.length;Ac++)Db+=this.base.J(Ac).length;({lwa:Ac,Qfa:Db,returnValue:Bb}=this.OHa(eb.yg,Ib,!0,Db,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Bb)return 3!==Bb&&(a.a.instance.Ta(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",ha[Ib],Ja[Bb]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,nu:Xa};this.z2=!1}Ib="";Xa=new k.a;
for(--Ac;Ac>=$b;Ac--)if(6!==this.Pe.J(Ac).type)if(this.Pe.J(Ac).Bm)Ib=this.Pe.J(Ac).text+Ib,this.Pe.lG(Ac);else{if(5===this.Pe.J(Ac).type)Bb=Db-Ib.length;else if(2===this.Pe.J(Ac).type){if(Bb=0,!({length:Db}=ca(this.Pe,this.Pe.J(Ac).Hj)).returnValue)return a.a.instance.Ta(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,nu:Xa}}else return a.a.instance.Ta(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,nu:Xa};if(!({jga:dc}=U(this.Pe,Ac+1)).returnValue)return a.a.instance.Ta(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,nu:Xa};var dc=this.Pe.J(dc).Hj;Xa.add(new Pa.DeleteTextUpdateHint(dc,
Bb,Ib));Ib=""}for(--Qb;Qb>=Ra;Qb--)this.base.lG(Qb);if(!({jga:dc}=U(this.Pe,$b)).returnValue)return a.a.instance.Ta(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,nu:Xa};dc=this.Pe.J(dc).Hj;Ib&&Ib.length&&Xa.add(new Pa.DeleteTextUpdateHint(dc,gb,Ib,eb.id,eb.Du));return{returnValue:!0,nu:Xa}}VEk(eb,Ib){var Xa=null;let Ra,gb,Bb;var $b=({yyf:Ra,soi:gb,Qfa:Bb}=
this.k$h(eb,Ib,!0)).returnValue;if(0!==$b)return 3!==$b&&(a.a.instance.Ta(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[Ib],Ja[$b]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,nu:Xa};var Qb;if(!({jga:Qb}=U(this.Pe,gb)).returnValue)return a.a.instance.Ta(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,nu:Xa};$b=this.Pe.J(Qb).Hj;const Ac=this.Pe.J(Qb).Lc;let Db,dc,Pb;({Ut:Qb,v7:Db,yta:dc,Maa:Pb}=this.y3l(eb,Qb));this.JBh(this.Pe,Qb,Db,Pb,gb);Xa=new H.a(Ib,eb.Ut,eb.yta);Ib=new H.a(Ib,Qb,dc);Xa.Bm=Ib;Ib.Bm=Xa;this.base.insert(Ra,Xa);this.Pe.insert(gb,Ib);Xa=new k.a;Xa.add(new sa.a($b,Ac,Bb,Qb,dc,Db,Pb,eb.id,eb.Du));return{returnValue:!0,nu:Xa}}pEk(eb){let Ib;Ib=null;let Xa,Ra;var gb;if(!({wVd:Xa}=this.l$h(eb,this.base,"Base")).returnValue)return{returnValue:!1,nu:Ib};if(!this.base.J(Xa).Bm||
!({jga:Ra}=Y(this.Pe,this.base.J(Xa).Bm.Hj,0)).returnValue)return a.a.instance.Ta(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.z2=!0,{returnValue:!1,nu:Ib};if(!({jga:gb}=U(this.Pe,Ra+1)).returnValue)return a.a.instance.Ta(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.z2=!0,{returnValue:!1,nu:Ib};let Bb,$b,Qb,Ac,Db,dc;({i4a:gb,j4a:Qb,yQf:Bb,Ofn:Ac,wfn:$b,xfn:Db}=this.mSl(eb,Ra,gb));if(!({length:dc}=ca(this.Pe,gb)).returnValue)return{returnValue:!1,nu:Ib};this.IBh(this.Pe,gb,Qb,Ra);this.Pe.lG(Ra);this.base.lG(Xa);Ib=new k.a;Ib.add(new Na.MergeParagraphUpdateHint(Bb,Ac,dc,$b,Db,gb,Qb,eb.id,eb.Du));return{returnValue:!0,nu:Ib}}kDk(eb,Ib){var Xa=null;let Ra,gb,Bb;
if(!({EMf:Bb,xyf:Ra}=this.Yai(eb,!0,Ib)).returnValue)return{returnValue:!1,nu:Xa};if(!({Dib:gb}=this.rOc(this.base,this.Pe,Ra,!0)).returnValue)return a.a.instance.Ta(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,nu:Xa};if(0<gb&&2!==this.Pe.J(gb-1).type)return a.a.instance.Ta(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Yd.logger.Og(Object.assign(new ja.a,
{qj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.z2=!0,{returnValue:!1,nu:Xa};let $b;if(!({Ut:$b}=this.X2h(gb)).returnValue)return{returnValue:!1,nu:Xa};Ib=new H.a(Ib,eb.yg,eb.Lc);Xa=Bb;Xa.Bm=Ib;Ib.Bm=Xa;this.base.insert(Ra,Bb);this.Pe.insert(gb,Ib);Xa=new k.a;Xa.add(new qa.AddParagraphUpdateHint(eb.yg,eb.Lc,$b,eb.id,eb.Du));return{returnValue:!0,nu:Xa}}W0e(eb){let Ib;Ib=null;let Xa;var Ra;if(!({vVd:Ra}=this.c$h(eb,this.base,"Base")).returnValue)return{returnValue:!1,nu:Ib};if(!this.base.J(Ra).Bm||
!this.base.J(Ra).Bm.Hj.equals(eb.yg))return a.a.instance.Ta(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.z2=!0,{returnValue:!1,nu:Ib};if(!({Dib:Xa}=this.rOc(this.base,this.Pe,Ra,!0)).returnValue)return a.a.instance.Ta(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,nu:Ib};if(0<Xa&&2!==this.Pe.J(Xa).type)return a.a.instance.Ta(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.z2=!0,{returnValue:!1,nu:Ib};const gb=this.Pe.J(Xa).Hj,Bb=this.Pe.J(Xa).Lc;this.Pe.lG(Xa);this.base.lG(Ra);({Ut:Ra}=this.X2h(Xa));0<Xa&&6===this.Pe.J(Xa-1).type&&this.QDn(Xa-1,Ra);Ib=new k.a;Ib.add(new La.a(gb,Bb,Ra,eb.id,
eb.Du));return{returnValue:!0,nu:Ib}}qth(eb,Ib,Xa){let Ra;var gb=({Yga:Ib,lwa:Ra}=this.OHa(eb,Xa,!0,Ib,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==gb)return 3!==gb&&(a.a.instance.Ta(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[Xa],Ja[gb]),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({jga:gb}=U(this.Pe,Ra));gb=this.Pe.J(gb).Hj;
eb=new ma(Xa,eb);Xa=new ma(Xa,gb);eb.Bm=Xa;Xa.Bm=eb;this.base.insert(Ib,eb);this.Pe.insert(Ra,Xa);return!0}mSl(eb,Ib,Xa){let Ra,gb,Bb;Ra=eb.i4a.equals(eb.yg)?this.Pe.J(Ib).Hj:this.Pe.J(Xa).Hj;eb=eb.j4a===eb.Lc?this.Pe.J(Ib).Lc:this.Pe.J(Xa).Lc;gb=this.Pe.J(Ib).Hj;Ib=this.Pe.J(Ib).Lc;Bb=this.Pe.J(Xa).Hj;Xa=this.Pe.J(Xa).Lc;return{i4a:Ra,j4a:eb,yQf:gb,Ofn:Ib,wfn:Bb,xfn:Xa}}y3l(eb,Ib){let Xa;var Ra=eb.yg.equals(eb.Ut)?eb.v7:eb.Ut;const gb=eb.Lc===eb.yta?eb.Maa:eb.yta;eb.yg.equals(eb.Ut)?Xa=this.Pe.J(Ib).Hj:
(Xa=Ra,Ra=this.Pe.J(Ib).Hj);eb.Lc===eb.yta?(eb=this.Pe.J(Ib).Lc,Ib=gb):(eb=gb,Ib=this.Pe.J(Ib).Lc);return{Ut:Xa,v7:Ra,yta:eb,Maa:Ib}}KBh(eb,Ib,Xa,Ra){for(;Ra<eb.length;Ra++){if(!eb.J(Ra).s4()&&6!==eb.J(Ra).type&&2!==eb.J(Ra).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+eb.J(Ra).type);break}eb.J(Ra).Hj=Ib;if(2===eb.J(Ra).type){eb.J(Ra).Lc=Xa;break}}}JBh(eb,Ib,Xa,Ra,gb){this.KBh(eb,Xa,Ra,gb);Fa.LBh(eb,Ib,gb)}IBh(eb,Ib,Xa,Ra){this.KBh(eb,Ib,Xa,Ra+1);Fa.LBh(eb,Ib,Ra)}l$h(eb,
Ib,Xa){let Ra,gb=-1;if(!({jga:Ra}=Y(Ib,eb.yg,0)).returnValue)return a.a.instance.Ta(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Xa+"for GraphNodeId "+eb.yg),{returnValue:!1,wVd:Ra};if(!({jga:gb}=U(Ib,Ra+1)).returnValue||!Ib.J(gb).Hj.equals(eb.v7))return a.a.instance.Ta(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Ra+1+" in "+Xa+" of length "+Ib.length),{returnValue:!1,wVd:Ra};this.IBh(Ib,eb.i4a,eb.j4a,Ra);return{returnValue:!0,wVd:Ra}}k$h(eb,Ib,Xa){let Ra;
const gb=Xa?this.base:this.Pe,Bb=Xa?"Base":"Derived",$b=({Yga:Ib,lwa:Xa,Qfa:Ra}=this.OHa(eb.yg,Ib,Xa,eb.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===$b||2===$b)return a.a.instance.Ta(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Bb),{returnValue:$b,yyf:Ib,soi:Xa,Qfa:Ra};this.JBh(gb,eb.Ut,eb.v7,eb.Maa,Ib);return{returnValue:$b,yyf:Ib,soi:Xa,Qfa:Ra}}c$h(eb,Ib,Xa){return({idx:eb}=W(Ib,eb.yg)).returnValue?2!==Ib.J(eb).type?(a.a.instance.Ta(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
Xa),{returnValue:!1,vVd:-1}):{returnValue:!0,vVd:eb}:(a.a.instance.Ta(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Xa),{returnValue:!1,vVd:-1})}QDn(eb,Ib){var Xa=this.Pe.J(eb);if(Ib){let Ra;({jga:Ra}=Y(this.Pe,Ib,0));Xa=Xa.clone();Xa.Hj=Ib;this.Pe.lG(eb);this.Pe.insert(Ra,Xa)}else this.Pe.length>eb&&(this.Pe.J(eb+1).s4()||2===this.Pe.J(eb+1).type)&&(Xa.Hj=this.Pe.J(eb+1).Hj)}Yai(eb,Ib,Xa){var Ra=Ib?this.base:this.Pe;Ib=Ib?"Base":"Derived";Xa=new H.a(Xa,eb.yg,eb.Lc);if(eb.Ut){if(!({jga:Ra}=
Y(Ra,eb.Ut,0)).returnValue)return a.a.instance.Ta(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",eb.Ut,Ib),{returnValue:!1,EMf:Xa,xyf:Ra};Ra+=1}else Ra=0;return{returnValue:!0,EMf:Xa,xyf:Ra}}X2h(eb){let Ib;Ib=null;let Xa=eb-1;if(-1===Xa)return{returnValue:!0,Ut:Ib};6===this.Pe.J(Xa).type&&Xa--;if(2===this.Pe.J(Xa).type||4===this.Pe.J(Xa).type)return Ib=this.Pe.J(Xa).Hj,{returnValue:!0,Ut:Ib};a.a.instance.Ta(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Pe.J(eb-1).type);return{returnValue:!1,Ut:Ib}}rOc(eb,Ib,Xa,Ra){let gb,Bb=!0;gb=-1;if(Xa>eb.length)return a.a.instance.Ta(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Dib:gb};if(Xa<eb.length){if(-1<Xa&&Xa<eb.length&&!eb.J(Xa).Bm){Bb=!1;for(var $b=Xa+1;$b<eb.length;$b++)if(eb.J($b).Bm){Xa=$b;Bb=!0;break}}if(!Bb)return{returnValue:!1,Dib:gb};Bb=!1;for($b=0;eb.J(Xa)&&$b<Ib.length;$b++)if(Ib.J($b).Bm===eb.J(Xa)){gb=$b;Bb=!0;break}if(!Bb)return{returnValue:!1,
Dib:gb}}else gb=Ib.length;if(0<gb&&Ra&&!Ib.J(gb-1).Bm){for(eb=gb-1;0<=eb&&!Ib.J(eb).Bm;eb--);gb=eb+1;6===Ib.J(gb).type&&5!==this.Yd.input.source&&gb++}return{returnValue:!0,Dib:gb}}OHa(eb,Ib,Xa,Ra,gb,Bb){let $b;var Qb;let Ac;var Db=this.base;let dc=this.Pe,Pb=!1;Xa||(Db=this.Pe,dc=this.base);Ac=Qb=$b=0;let Ub,rb,Yb=0;if(!({$Pc:Ra,wlb:Ub,uZc:rb}=P(Db,eb,Ra)).returnValue)return a.a.instance.Ta(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,Yga:$b,lwa:Qb,Qfa:Ac};0<=Ra&&Ra<Db.length&&!Db.J(Ra).Bm&&Ub&&!gb&&(a.a.instance.Ta(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",Bb),this.z2=!0,Yb=Ib===Db.J(Ra).source?1:2,Pb=!0);gb&&!Db.J(Ra)&&Ra--;gb&&Ub&&!Db.J(Ra).Bm&&(Ub=!1,rb=0);if(!Xa&&!({idx:eb}=W(dc,eb)).returnValue&&!Ub)return{returnValue:0,Yga:Ra,lwa:Qb,Qfa:Ac};if(!({Dib:eb}=this.rOc(Db,dc,Ra,Xa&&!Ub)).returnValue&&!Pb&&(Ib=
!1,1===this.Ejh&&0<Ra&&!rb&&(Ra--,{Dib:eb,returnValue:Ib}=this.rOc(Db,dc,Ra,Xa&&!Ub),Ib&&(Ra++,eb<dc.length-1?eb++:Ib=!1)),!Ib))return a.a.instance.Ta(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.Yd.logger.Og(Object.assign(new ja.a,{qj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.z2=!0,{returnValue:3,Yga:$b,lwa:Qb,Qfa:Ac};if(Ub&&(!J(Db,Ra,rb)||!Pb&&!J(dc,eb,rb)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Yga:$b,lwa:Qb,Qfa:Ac};$b=Ra;Qb=eb;Ub&&($b=Ra+1,Pb||(Qb=Db.J(Ra),Xa=dc.J(eb),Qb.Bm=Xa,Xa.Bm=Qb,Db=Db.J(Ra+1),Qb=dc.J(eb+1),Db.Bm=Qb,Qb.Bm=Db,Qb=eb+1));if(Qb>=dc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Qb+" secondaryList length was "+dc.length),{returnValue:3,Yga:$b,lwa:Qb,Qfa:Ac};
for(Db=0;Db<Qb;Db++)dc.J(Db).Hj.equals(dc.J(Qb).Hj)&&(Ac+=dc.J(Db).length);return{returnValue:Yb,Yga:$b,lwa:Qb,Qfa:Ac}}idf(eb,Ib,Xa){this.wNg.contains(eb.id)&&this.Ybb.Z(eb.id,new k.a);for(--Xa;Xa>=Ib;Xa--)this.wNg.contains(eb.id)?this.Ybb.J(eb.id).insert(this.Ybb.J(eb.id).length,this.Pe.J(Xa)):this.Pe.J(Xa).Bm&&(this.Pe.J(Xa).Bm.Bm=null),this.Pe.lG(Xa)}eAf(eb,Ib,Xa){if(this.Ybb.nb(eb.Du)){const Ra=this.Ybb.J(eb.Du);for(let gb=0;gb<Ra.length;gb++)Ra.J(gb).Hj=Xa.Hj,Object(la.a)(H.a,Xa)&&Object(la.a)(H.a,
Ra.J(gb))&&(Ra.J(gb).Lc=Xa.Lc);this.Pe.RC(Ib,this.Ybb.J(eb.Du));this.Ybb.remove(eb.Du)}else this.Pe.insert(Ib,Xa)}Agm(eb){let Ib,Xa;Xa=Ib=-1;if(!eb.Bm)return{returnValue:!1,x4b:Ib,Edf:Xa};var Ra;let gb=0,Bb=!1;if(!({idx:Ra}=W(this.Pe,eb.Bm.Hj)).returnValue)return{returnValue:!1,x4b:Ib,Edf:Xa};for(;Ra<this.Pe.length;Ra++){if(eb.Bm===this.Pe.J(Ra)){Ib=Ra;Xa=gb;Bb=!0;break}gb+=this.Pe.J(Ra).length}return{returnValue:Bb,x4b:Ib,Edf:Xa}}Zjf(eb){let Ib;Ib=new k.a;let Xa=0,Ra=0;for(;Xa<eb.length;){if(Ra>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,fmc:Ib};if(eb.J(Xa).length>this.base.J(Ra).length){if(!J(eb,Xa,this.base.J(Ra).length))return a.a.instance.Ta(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Xa,this.base.J(Ra).length),{returnValue:!1,fmc:Ib}}else if(eb.J(Xa).length<this.base.J(Ra).length){var gb=
!!this.base.J(Ra).Bm,Bb=0;if(gb&&!({Dib:Bb}=this.rOc(this.base,this.Pe,Ra,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Ra),{returnValue:!1,fmc:Ib};if(!J(this.base,Ra,eb.J(Xa).length)||gb&&!J(this.Pe,Bb,eb.J(Xa).length))return a.a.instance.Ta(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,fmc:Ib};if(gb){gb=this.base.J(Ra);var $b=this.Pe.J(Bb);gb.Bm=$b;$b.Bm=gb;gb=this.base.J(Ra+1);Bb=this.Pe.J(Bb+1);gb.Bm=Bb;Bb.Bm=gb}}if(this.base.J(Ra).Bm&&5!==this.base.J(Ra).type&&this.base.J(Ra).s4()&&(Bb=this.base.J(Ra),gb=eb.J(Xa),!Bb.iJ.equals(gb.iJ)||!Bb.xF.BA(gb.xF))){let Qb;if(!({x4b:$b,Edf:Qb}=this.Agm(this.base.J(Ra))).returnValue)return{returnValue:!1,fmc:Ib};Ib.add(new va(this.Pe.J($b).Hj,Qb,Bb,gb))}Xa++;Ra++}return{returnValue:!0,fmc:Ib}}static LBh(eb,Ib,Xa){for(--Xa;0<=
Xa;Xa--){if(!eb.J(Xa).s4()&&6!==eb.J(Xa).type){a.a.instance.shipAssertTag(17311187,1,2===eb.J(Xa).type||4===eb.J(Xa).type,"Found merge block of type "+eb.J(Xa).type);break}eb.J(Xa).Hj=Ib}}static dwi(eb){return eb?!1:(a.a.instance.Ta(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(E.a)(Fa,"ParagraphMergeUsingHintsTwinList",null,[1002]);var kb=c(1719),fb=c(1720),lb=c(1716),sb=c(1718),ab=c(1717);class Ga{constructor(eb,Ib,
Xa,Ra){this.cp=eb;this.length=Ib;this.iBd=Xa;this.cbd=Ra}}Object(E.a)(Ga,"UpdateFormattingIdsPosInfo",null,[]);class Ua{constructor(eb,Ib,Xa){this.z2=!1;this.Ybb=new y.a;this.j6g=!1;this.Yd=eb;this.Ejh=Xa;this._base=Ib;this.Axe=aa(Ib);if(!N(this.base,this.Pe))throw a.a.instance.Ta(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),eb.logger.Og(Object.assign(new I.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.Yd.runtime.Xb.$hb(1000010)&&(this.j6g=!0)}get base(){return this._base}get Pe(){return this.Axe}get mergeConflict(){return this.z2}A1e(eb,
Ib){switch(eb.type){case 11:return this.UDk(eb,Ib);case 8:return this.Z0e(eb,Ib);case 10:return this.X0e(eb);default:return!1}}z1e(eb,Ib){switch(eb.type){case 11:return this.TDk(eb,Ib);case 8:return this.Y0e(eb,Ib);case 10:return this.W0e(eb);default:return{returnValue:!1,nu:null}}}rth(){a.a.instance.Ta(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}qth(){a.a.instance.Ta(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Zjf(eb){let Ib;Ib=new k.a;let Xa=0,Ra=0,gb=0;for(;Xa<eb.length;){if(Ra>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,bbd:Ib};if(eb.J(Xa).length>this.base.J(Ra).length){if(!J(eb,Xa,this.base.J(Ra).length))return a.a.instance.Ta(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,bbd:Ib}}else if(eb.J(Xa).length<this.base.J(Ra).length&&!this.W6a(gb+eb.J(Xa).length,!0).returnValue)return a.a.instance.Ta(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,bbd:Ib};if(this.base.J(Ra).Bm&&5!==this.base.J(Ra).type&&this.base.J(Ra).s4()){const Bb=this.base.J(Ra),$b=eb.J(Xa);if(!Bb.iJ.equals($b.iJ)||!Bb.xF.BA($b.xF)){let Qb,Ac;if(({x4b:Qb,oQh:Ac}=this.Bgm(this.base.J(Ra))).returnValue)Ib.add(new Ga(Ac,this.Pe.J(Qb).length,Bb,$b));else return a.a.instance.Ta(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,bbd:Ib}}}gb+=this.base.J(Ra).length;Xa++;Ra++}return{returnValue:!0,bbd:Ib}}UDk(eb,Ib){let Xa;if(!({yDa:Xa}=this.W6a(eb.cp,!0)).returnValue)return a.a.instance.Ta(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let gb=0;gb<eb.K_.length;gb++)switch(eb.K_.J(gb).type){case 7:var Ra=eb.K_.J(gb);this.Pe.insert(Xa,new za(Ib,null,Ra.text,Ra.id));break;case 9:Ra=eb.K_.J(gb);this.Pe.insert(Xa,new H.a(Ib,Ra.yg,Ra.Lc));break;default:return a.a.instance.Ta(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Z0e(eb,Ib){let Xa,Ra;if(!({yDa:Xa}=this.W6a(eb.cp,!0)).returnValue||!({yDa:Ra}=this.W6a(eb.cp+
eb.text.length,!1)).returnValue)return a.a.instance.Ta(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(eb=Ra;eb>=Xa;eb--)this.Pe.J(eb).source!==Ib&&this.XHd(this.Pe,eb);return!0}X0e(eb){let Ib;if(!({yDa:Ib}=this.W6a(eb.cp,!0)).returnValue)return a.a.instance.Ta(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.ldf(this.Pe,eb,Ib);return!0}TDk(eb,Ib){let Xa;Xa=null;let Ra,gb;if(!({Fzb:Ra,yDa:gb}=this.W6a(eb.cp,!0)).returnValue)return a.a.instance.Ta(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,nu:Xa};var Bb=this.Iof(this.Pe,gb-1);Bb=new ab.a(Bb);for(let $b=0;$b<eb.K_.length;$b++)switch(eb.K_.J($b).type){case 7:Bb.K_.add(this.c1e(eb.K_.J($b),Ib,Ra,gb));break;
case 9:Bb.K_.add(this.VDk(eb.K_.J($b),Ib,Ra,gb));break;default:return a.a.instance.Ta(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,nu:Xa}}Xa=new k.a;Xa.add(Bb);return{returnValue:!0,nu:Xa}}c1e(eb,Ib,Xa,Ra){const gb=new za(Ib,eb.yg,eb.text,eb.id);Ib=new za(Ib,eb.yg,eb.text,eb.id);gb.Bm=Ib;Ib.Bm=gb;this.base.insert(Xa,gb);this.Pe.insert(Ra,Ib);Xa=new sb.a(eb.yg,eb.text);Xa.id=eb.id;return Xa}VDk(eb,
Ib,Xa,Ra){const gb=new H.a(Ib,eb.yg,eb.Lc);Ib=new H.a(Ib,eb.yg,eb.Lc);gb.Bm=Ib;Ib.Bm=gb;this.base.insert(Xa,gb);this.Pe.insert(Ra,Ib);return new lb.a(eb.yg,eb.Lc)}Y0e(eb){let Ib;Ib=new k.a;let Xa;var Ra;let gb;if(!({Fzb:Xa,yDa:Ra}=this.W6a(eb.cp,!0)).returnValue||!({Fzb:gb,yDa:Bb}=this.W6a(eb.cp+eb.text.length,!1)).returnValue)return a.a.instance.Ta(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,nu:Ib};this.Yd.runtime.Xb.eTd(1000010);for(eb=Bb;eb>=Ra;eb--)if(this.Pe.J(eb).Bm){var Bb=eb;const $b=({tQf:eb}=this.IBl(eb,Ra)).returnValue;$b&&(Ib.add($b),this.XHd(this.Pe,eb,Bb))}for(Ra=gb;Ra>=Xa;Ra--)this.XHd(this.base,Ra);return{returnValue:!0,nu:Ib}}W0e(eb){let Ib;Ib=null;let Xa,Ra;if(!({Fzb:Xa,yDa:Ra}=this.W6a(eb.cp,!0)).returnValue)return a.a.instance.Ta(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyDeleteParaHintToBaseAndDerived",
eventId:"8ps6z"})),{returnValue:!1,nu:Ib};if(!this.ldf(this.base,eb,Xa))return a.a.instance.Ta(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,nu:Ib};this.ldf(this.Pe,eb,Ra)&&(Ib=new k.a,Ib.add(new kb.a(this.Iof(this.Pe,Ra-1),eb.yg,eb.Lc)));return{returnValue:!0,nu:Ib}}W6a(eb,Ib){var Xa;var Ra=Xa=-1;let gb,Bb;if(!({wlb:Bb,bwh:eb,awh:gb}=M(this.base,eb,this.Yd.logger)).returnValue)return{returnValue:!1,
Fzb:Xa,yDa:Ra};const $b=eb>=this.base.length;$b&&eb--;if(this.base.J(eb).Bm){const Qb=this.eDl(this.Pe,this.base.J(eb));if(Bb){if(0>Qb||!J(this.base,eb,gb)||!J(this.Pe,Qb,gb))return a.a.instance.Ta(575706444,1,2,"SplitTwinListAndFindIdx"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,Fzb:Xa,yDa:Ra};Xa=this.base.J(eb);Ra=this.Pe.J(Qb);Xa.Bm=Ra;Ra.Bm=Xa;Xa=this.base.J(eb+1);Ra=this.Pe.J(Qb+1);Xa.Bm=Ra;Ra.Bm=Xa;Xa=Ib?eb+1:eb;Ra=Ib?Qb+1:Qb}else Ib?
(Xa=$b?eb+1:eb,Ra=$b?Qb+1:Qb):(Xa=$b?eb:eb-1,Ra=$b?Qb:Qb-1)}else if(Bb){if(J(this.base,eb,gb))Xa=Ib?eb+1:eb;else return a.a.instance.Ta(575706445,1,2,"SplitTwinListAndFindIdx"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,Fzb:Xa,yDa:Ra};Ib?(Ra=({fGb:Ra}=this.e6b(this.base,this.Pe,eb,!1)).returnValue?Ra+1:0,Ra=Ra>=this.Pe.length?this.Pe.length-1:Ra):(Ra=({fGb:Ra}=this.e6b(this.base,this.Pe,eb,!0)).returnValue?Ra-1:this.Pe.length-1,Ra=0>Ra?
0:Ra)}else Ib?(({fGb:Ra}=this.e6b(this.base,this.Pe,eb,!0)).returnValue||(({fGb:Ra}=this.e6b(this.base,this.Pe,eb,!1)).returnValue?Ra+=1:(Ra=$b?this.Pe.length-1:0,Ra=0>Ra?0:Ra)),Xa=$b?eb+1:eb):(({fGb:Ra}=this.e6b(this.base,this.Pe,eb,!1)).returnValue||(({fGb:Ra}=this.e6b(this.base,this.Pe,eb,!0)).returnValue?--Ra:(Ra=eb?this.Pe.length-1:0,Ra=0>Ra?0:Ra)),Xa=$b?eb:eb-1);return{returnValue:!0,Fzb:Xa,yDa:Ra}}e6b(eb,Ib,Xa,Ra){let gb=null;if(Ra)for(;Xa<eb.length;Xa++){if(eb.J(Xa).Bm){gb=eb.J(Xa).Bm;break}}else for(;0<=
Xa;Xa--)if(eb.J(Xa).Bm){gb=eb.J(Xa).Bm;break}if(gb)for(eb=0;eb<Ib.length;eb++)if(Ib.J(eb)===gb)return Ib=eb,{returnValue:!0,fGb:Ib};return{returnValue:!1,fGb:-1}}eDl(eb,Ib){for(let Xa=0;Xa<eb.length;Xa++)if(eb.J(Xa).Bm===Ib)return Xa;return-1}XHd(eb,Ib,Xa=-1){for(Xa=0>Xa?Ib:Xa;Xa>=Ib;Xa--)eb.J(Xa).Bm&&(eb.J(Xa).Bm.Bm=null),eb.lG(Xa)}Iof(eb,Ib){let Xa=0;for(;0<=Ib;Ib--)Xa+=eb.J(Ib).length;return Xa}Sem(eb){eb=Object(n.a)(oa.a,eb);eb||(a.a.instance.Ta(575706448,1,2,"GetTextBlock"),this.Yd.logger.Og(Object.assign(new I.a,
{qj:"GetTextBlock",eventId:"8ujvq"})));return eb}IBl(eb,Ib){let Xa="",Ra=eb;for(;Ra>=Ib&&this.Pe.J(Ra).Bm&&2!==this.Pe.J(Ra).type;)Xa=this.Sem(this.Pe.J(Ra)).text+Xa,Ra--;Ib=0>Ra?0:this.Iof(this.Pe,Ra);return!this.j6g||Ra<eb?(eb=Ra+1,{returnValue:new fb.a(Ib,Xa),tQf:eb}):{returnValue:null,tQf:Ra}}Bgm(eb){let Ib,Xa,Ra=!1;Xa=Ib=0;if(!eb.Bm)return{returnValue:!1,x4b:Ib,oQh:Xa};for(Ib=0;Ib<this.Pe.length;Ib++){if(this.Pe.J(Ib).Bm===eb){Ra=!0;break}Xa+=this.Pe.J(Ib).length}return{returnValue:Ra,x4b:Ib,
oQh:Xa}}ldf(eb,Ib,Xa){Xa=Xa===eb.length?--Xa:Xa;Xa>eb.length-1&&(a.a.instance.Ta(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"DeleteEopInList",eventId:"8ffwf"})));if(2===eb.J(Xa).type){const Ra=eb.J(Xa);if(Ra.Hj!==Ib.yg||Ra.Lc!==Ib.Lc)return!1;this.XHd(eb,Xa);return!0}return!1}}Object(E.a)(Ua,"ParagraphMergeUsingHintsTwinListLcs",null,[1002]);var wb=c(1564),cc=c(1532),zb=c(1715);c.d(K,"a",function(){return nb});class nb{constructor(eb,Ib,Xa,Ra,gb,
Bb,$b=null,Qb=null,Ac=null){this.dQ=this.rta=this.hKa=this.ura=null;this._initialized=!1;this.Yd=eb;this.EF=Ib;this.MBa=Ra;this.sAa=Xa;this.Xra=gb;this.vte=new f.a;for(eb=0;eb<this.EF.length;eb++)this.vte.add(this.EF.J(eb).id);this.mUg=new f.a;for(eb=0;eb<this.sAa.length;eb++)this.mUg.add(this.sAa.J(eb).id);this.rjh=new f.a;for(eb=0;eb<this.MBa.length;eb++)this.rjh.add(this.MBa.J(eb).id);this.Mg=Bb;this.fWe=$b||F.a.instance;this.rI=Qb;this.EW=Ac;this.Fub=1===(this.rI&&this.EW&&1===this.rI.EIa&&1===
this.EW.EIa?1:0);this.Wra=0}get P7f(){return 1!==this.Wra}xzm(){var eb=!0;if(this.rI&&this.EW)return eb;if(this.rI||this.EW)return a.a.instance.Ta(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.Yd.runtime.zu.nb(w.a.xL)&&(eb=this.Yd.runtime.zu.J(w.a.xL),eb=this.Yng(eb,this.Yd.runtime.VCa.id,"favored")&&({updateHints:this.rI}=this.zqi(eb,
this.vte,this.mUg,this.Yd.runtime.zu,"favored")).returnValue);eb&&this.Yd.runtime.Iq.nb(w.a.xL)&&(eb=this.Yd.runtime.Iq.J(w.a.xL),eb=this.Yng(eb,this.Yd.runtime.VCa.id,"unfavored")&&({updateHints:this.EW}=this.zqi(eb,this.vte,this.rjh,this.Yd.runtime.Iq,"unfavored")).returnValue);this.rI=this.rI?this.rI:new zb.a(new k.a,0);this.EW=this.EW?this.EW:new zb.a(new k.a,0);eb&&this.Yd.input.hGb&&(eb=this.Yd.input.f$.last().i1a(w.a.xL),eb=this.Yng(eb,this.Yd.input.f$.last().UW.id,"alreadyMerged"));return eb}Exm(){const eb=
new f.a;if(this.Fub)return eb;const Ib=this.rI?this.rI.updateHints.k5():new k.a;let Xa=0;for(;Xa<Ib.length-1;){const Ra=Ib.J(Xa);let gb,Bb=!1;for(gb=Xa+1;gb<Ib.length;gb++){const $b=Ib.J(gb);if(Ra.Gxi($b)){eb.add(Ra.id);Ib.lG(gb);Ib.lG(Xa);Bb=!0;break}}Bb||Xa++}return eb}Yng(eb,Ib,Xa){eb=this.Mg.getPropertyString(eb,l.a.bUa);eb=x.a.Ff(eb);return Ib.equals(eb)?!0:(this.W6c(2),a.a.instance.Ta(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",
this.Yd.runtime.VCa.id,eb,Xa),!1)}zqi(eb,Ib,Xa,Ra,gb){let Bb;Bb=new zb.a(new k.a,0);eb=this.Mg.getPropertyObjectIds(eb,l.a.p1).k5();for(let Qb=0;Qb<eb.length;Qb++){if(!Ra.nb(eb.J(Qb)))return a.a.instance.Ta(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",eb.J(Qb),gb),{returnValue:!1,updateHints:Bb};const Ac=Ra.J(eb.J(Qb));var $b=x.a.Ff(this.Mg.getPropertyString(Ac,l.a.zja));if(Ib.contains($b)||Xa.contains($b)){$b=
this.fWe.JPc(Ac);if(!$b)return a.a.instance.Ta(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Ac.id,gb),{returnValue:!1,updateHints:Bb};Bb.updateHints.add($b)}}0<eb.length&&a.a.instance.Ta(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",gb,eb.dr(),Bb.updateHints.dr());return{returnValue:!0,
updateHints:Bb}}Iym(){return({EK:this.ura,xLc:this.hKa,wad:this.rta}=wb.a.yLh(this.Yd,this.Mg,this.EF,this.sAa,this.MBa,this.Xra,!0,!0)).returnValue?!0:!1}vzm(eb){const Ib=wb.a.EGd(this.Mg,Xa=>this.Yd.runtime.sk.J(Xa),this.EF,1,this.Xra,!0,!0).returnValue;if(!Ib)return a.a.instance.Ta(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.dQ=this.Fub?new Ua(this.Yd,Ib,1):new Fa(this.Yd,Ib,eb,this.rI?this.rI.EIa:0);return!0}initialize(){if(this._initialized)return!1;
this._initialized=!0;if(!this.xzm()||!this.Iym())return!1;const eb=this.Exm();return this.vzm(eb)?!0:!1}$ai(eb){const Ib=new k.a;let Xa="";for(let Ra=0;Ra<eb.length;Ra++){const gb=eb.J(Ra);gb.s4()?Xa+=eb.J(Ra).text:2===gb.type?(Ib.add(new ra(gb.Hj,gb.type,Xa,gb.Lc)),Xa=""):4===gb.type&&(Ib.add(new ra(gb.Hj,gb.type)),Xa="")}return Ib}validateUpdateHintsAreComplete(eb,Ib,Xa){Ib=this.$ai(Ib);eb=this.$ai(eb);let Ra=Ib.length===eb.length;if(Ra)for(let gb=0;gb<Ib.length;gb++)if(!Ib.J(gb).isEqual(eb.J(gb))){Ra=
!1;break}Ra||(this.W6c(4),a.a.instance.Ta(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Xa,eb.dr(),Ib.dr()));return Ra}Xth(eb,Ib,Xa){(Ib=({S7a:eb}=this.EFk(eb,Ib,Xa)).returnValue)||this.W6c(this.dQ.mergeConflict?1:3);return{returnValue:Ib,S7a:eb}}EFk(eb,Ib,Xa){let Ra;Ra=new k.a;let gb=!0;var Bb=0;let $b=null,Qb=this.rI?this.rI.updateHints.length:0;for(var Ac=0;Ac<Qb&&gb;Ac++)$b=
this.rI.updateHints.J(Ac),Bb<this.EW.updateHints.length&&$b.id.equals(this.EW.updateHints.J(Bb).id)&&5!==this.Yd.input.source?({returnValue:gb}=this.dQ.z1e($b,2),Bb++):gb=this.dQ.A1e($b,2);if(!gb)return a.a.instance.Ta(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",$b.toString()),{returnValue:!1,S7a:Ra};if(!this.validateUpdateHintsAreComplete(this.dQ.Pe,this.hKa,"Favored"))return{returnValue:!1,S7a:Ra};if(eb&&1===this.Yd.input.Oha&&!this.dQ.rth(Ib,Xa,2))return a.a.instance.Ta(17409920,
1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Ib,Xa),{returnValue:!1,S7a:Ra};gb=!0;Ac=new k.a;for(Qb=this.EW?this.EW.updateHints.length:0;Bb<Qb&&gb;Bb++){$b=this.EW.updateHints.J(Bb);let Db;({nu:Db,returnValue:gb}=this.dQ.z1e($b,4));gb&&Db&&Ac.RC(Ac.length,Db)}return gb?this.validateUpdateHintsAreComplete(this.dQ.base,this.rta,"Unfavored")?eb&&2===this.Yd.input.Oha&&!this.dQ.qth(Ib,Xa,4)?(a.a.instance.Ta(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Ib,Xa),{returnValue:!1,S7a:Ra}):{returnValue:!0,S7a:Ac}:{returnValue:!1,S7a:Ra}:(a.a.instance.Ta(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",$b.id,$b.type),{returnValue:!1,S7a:Ra})}e2l(){let eb,Ib=0;let Xa=0,Ra=x.a.nil;for(eb=new y.a;Xa<this.dQ.base.length;){const $b=this.dQ.base.J(Xa);Ra.equals($b.Hj)||(Ib=0,Ra=$b.Hj);if(5===$b.type){var gb=Ib+$b.length;var Bb=void 0;let Qb;const Ac=aa(this.rta);if(!({index:Bb}=V(Ac,$b.Hj,Ib)).returnValue||!({index:Qb}=
V(Ac,$b.Hj,gb)).returnValue)return a.a.instance.Ta(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",$b.Kad),{returnValue:!1,rNi:eb};for(gb=new k.a;Bb<Qb;Bb++)gb.add(Ac.J(Bb));eb.Z($b.Kad,gb)}Ib+=$b.length;Xa++}return{returnValue:!0,rNi:eb}}f2l(){let eb;eb=new y.a;let Ib=0;for(let Ra=0;Ra<this.dQ.base.length;Ra++){const gb=this.dQ.base.J(Ra);if(5===gb.type){var Xa=void 0;let Bb;const $b=aa(this.rta);
if(!({index:Xa}=X($b,Ib,this.Yd.logger)).returnValue||!({index:Bb}=X($b,Ib+gb.length,this.Yd.logger)).returnValue)return a.a.instance.Ta(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,sNi:eb};const Qb=new k.a;for(;Xa<Bb;Xa++)Qb.add($b.J(Xa));eb.Z(gb.Kad,Qb)}Ib+=gb.length}return{returnValue:!0,sNi:eb}}rEk(eb){let Ib;Ib=new k.a;let Xa;if(this.Fub){if(!({sNi:Xa}=this.f2l()).returnValue)return{returnValue:!1,XYc:Ib}}else if(!({rNi:Xa}=this.e2l()).returnValue)return{returnValue:!1,
XYc:Ib};let Ra;Ra=this.Fub?new Ua(this.Yd,aa(this.hKa),1):new Fa(this.Yd,aa(this.hKa),new f.a,this.rI?this.rI.EIa:0);for(var gb=0;gb<eb.length;gb++)if(!Ra.A1e(eb.J(gb),4))return{returnValue:!1,XYc:Ib};for(eb=Ra.Pe.length-1;0<=eb;eb--)5===Ra.Pe.J(eb).type&&(gb=Ra.Pe.J(eb).Kad,Ra.Pe.lG(eb),Ra.Pe.RC(eb,Xa.J(gb)));this.Fub&&(this.BOh(Ra.Pe),this.BOh(this.dQ.Pe));if(!this.validateUpdateHintsAreComplete(this.dQ.Pe,Ra.Pe,"Merged"))return{returnValue:!1,XYc:Ib};Ib=Ra.Pe;return{returnValue:!0,XYc:Ib}}BOh(eb){const Ib=
new y.a;for(let Xa=eb.length-1;0<=Xa;Xa--){const Ra=Object(n.a)(H.a,eb.J(Xa));Ra&&(Ib.nb(Ra.Lc)?Ib.J(Ra.Lc).source!==Ra.source&&eb.lG(Xa):Ib.add(Ra.Lc,Ra))}}DFk(eb){let Ib;if(!({bbd:Ib}=this.dQ.Zjf(aa(this.rta))).returnValue)return!1;for(let Ra=0;Ra<Ib.length;Ra++){const gb=Ib.J(Ra);let Bb,$b;if(!({index:Bb}=X(eb,gb.cp,this.Yd.logger)).returnValue||!({index:$b}=X(eb,gb.cp+gb.length,this.Yd.logger)).returnValue)return a.a.instance.Ta(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),
this.Yd.logger.Og(Object.assign(new I.a,{qj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Xa=!1;for(let Qb=Bb;Qb<$b&&!Xa;Qb++)Xa=!gb.iBd.iJ.equals(eb.J(Qb).iJ);if(!Xa){for(Xa=Bb;Xa<$b;Xa++)eb.lG(Bb);eb.insert(Bb,gb.cbd)}}return!0}CFk(eb){let Ib;if(!({fmc:Ib}=this.dQ.Zjf(aa(this.rta))).returnValue)return!1;for(let gb=0;gb<Ib.length;gb++){var Xa=Ib.J(gb);let Bb,$b;if(({index:Bb}=V(eb,Xa.yg,Xa.cp)).returnValue&&({index:$b}=V(eb,Xa.yg,Xa.cp+Xa.cbd.length)).returnValue){var Ra=!1;for(let Qb=
Bb;Qb<$b&&!Ra;Qb++)Ra=!Xa.iBd.iJ.equals(eb.J(Qb).iJ)||!Xa.iBd.xF.BA(eb.J(Qb).xF);if(Ra){if(this.rI&&1===this.rI.EIa||this.EW&&1===this.EW.EIa)return!1}else{for(Ra=Bb;Ra<$b;Ra++)eb.lG(Bb);eb.insert(Bb,Xa.cbd)}}else if(Xa=Xa.cbd.kFm,a.a.instance.Ta(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Xa),Xa||this.rI&&1===this.rI.EIa||this.EW&&1===this.EW.EIa)return!1}return!0}g7l(eb){let Ib,Xa;Xa=new k.a;
Ib=this.Yd.runtime.fn.J(w.a.xL);let Ra;({MMf:Ra}=nb.u3h(this.Yd,this.Mg));const gb=new k.a;for(let $b=0;$b<eb.length;$b++){if(Ra.contains(eb.J($b).id,(Ac,Db)=>Ac.equals(Db)))continue;if(this.Yd.runtime.fn.nb(eb.J($b).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",eb.J($b).id),{returnValue:!1,D9d:Ib,C9d:Xa};gb.add(eb.J($b).id);var Bb=eb.J($b).n1a();const Qb=new cc.a(Bb);Bb=Bb.Hl();for(const Ac of Bb)Qb.qC(Ac);Xa.add(Qb)}eb=this.Mg.getPropertyObjectIds(Ib.wm,
l.a.p1);eb.RC(eb.length,gb);this.Mg.setPropertyObjectIds(Ib.wm,l.a.p1,eb);return{returnValue:!0,D9d:Ib,C9d:Xa}}TOd(eb){return String.format("Name: {0}, Message: {1}, Stack: {2}",eb.name,eb.message,eb.stack)}W6c(eb){0===this.Wra&&(this.Wra=eb)}Rlc(){let eb;eb=null;let Ib,Xa;var Ra;try{if({fn:eb,D9d:Ib,C9d:Xa,returnValue:Ra}=this.YMo(),Ra){if(Ib&&Xa){this.Yd.runtime.fn.Z(Ib.wm.id,Ib);for(Ra=0;Ra<Xa.length;Ra++){const Qb=Xa.J(Ra);this.Yd.runtime.fn.Z(Qb.wm.id,Qb)}const gb=Ib.wm,Bb=this.Mg.getPropertyObjectIds(gb,
l.a.p1),$b=this.Mg.getPropertyString(gb,l.a.bUa);a.a.instance.Ta(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Bb.dr(),$b)}else a.a.instance.Ta(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,fn:eb}}}catch(gb){a.a.instance.Ta(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.TOd(gb))}this.W6c(5);a.a.instance.Ta(17409922,
1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Wra,this.P7f);this.S3a();this.rI&&1===this.rI.EIa&&this.Yd.logger.Og(Object.assign(new fa.a,{eventId:"bc04c",qj:"ParagraphMergeUsingHints.TryDoMerge",info:u[this.Wra]+"/LCS"}));return{returnValue:!1,fn:eb}}YMo(){let eb,Ib,Xa;Xa=Ib=eb=null;let Ra;Ra=this.initialize();this.Yd.logger.EU("PMUH Initialize");let gb=null;Ra=Ra&&({S7a:gb}=this.Xth(!1,x.a.nil,0)).returnValue;this.Yd.logger.EU("PMUH ApplyUpdateHints");
let Bb=new k.a;Ra=Ra&&({XYc:Bb}=this.rEk(gb)).returnValue;this.Yd.logger.EU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Ra=this.Fub?Ra&&this.DFk(Bb):Ra&&this.CFk(Bb);this.Yd.logger.EU("PMUH ApplyUnfavoredFormattingChanges");this.Fub&&!this.v7n(Bb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Yd.logger.Og(Object.assign(new I.a,{qj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Ra=!1);const $b=this.MQd(Bb);Ra=Ra&&({B9d:eb}=wb.a.COc(this.Yd,this.Mg,
this.Xra,Bb,$b)).returnValue;this.Yd.logger.EU("PMUH GetMergeableObjectsFromMergeBlocks");this.rI&&1===this.rI.EIa&&this.EW&&1===this.EW.EIa||(Ra=Ra&&({D9d:Ib,C9d:Xa}=this.g7l(G(gb))).returnValue,this.Yd.logger.EU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Ra,mergeConflict:!!this.dQ&&this.dQ.mergeConflict,fn:eb,D9d:Ib,C9d:Xa}}MQd(eb){const Ib=new k.a;for(let Xa=0;Xa<eb.length;Xa++)2===eb.J(Xa).type&&Ib.add(eb.J(Xa).Hj);return Ib}Apf(eb){const Ib=new k.a;for(let Xa=0;Xa<eb.length;Xa++)2===
eb.J(Xa).type&&Ib.add(eb.J(Xa));return Ib}v7n(eb){var Ib=this.Apf(this.ura),Xa=this.Apf(this.hKa),Ra=this.Apf(this.rta),gb=this.MQd(Ib),Bb=this.MQd(Xa),$b=this.MQd(Ra);Bb=L.b(gb,Bb,$b);gb=new k.a;for($b=0;$b<Bb.length;$b++)gb.RC(gb.length,Bb.J($b).gDl());Bb=this.lDl(eb);Ib=this.hDl(Bb,gb,Ib,Xa,Ra);Xa=0;Ra=new f.a;for(gb=0;gb<eb.length;gb++)if(Bb=eb.J(gb),2===Bb.type)if(Ra.contains(Bb.Hj))if(Xa<Ib.length)eb.lG(gb),eb.insert(gb,Ib.J(Xa)),Xa++;else return!1;else Ra.add(Bb.Hj);0<eb.length&&2!==eb.J(eb.length-
1).type&&Xa<Ib.length&&eb.insert(eb.length,Ib.J(Xa));return!0}lDl(eb){const Ib=new f.a;for(let Xa=0;Xa<eb.length;Xa++)2===eb.J(Xa).type&&Ib.add(eb.J(Xa).Hj);return Ib}hDl(eb,Ib,Xa,Ra,gb){const Bb=new k.a;for(let $b=0;$b<Ib.length;$b++){const Qb=Ib.J($b);if(!eb.contains(Qb)){let Ac;(({block:Ac}=this.Rjf(Ra,Qb)).returnValue||({block:Ac}=this.Rjf(gb,Qb)).returnValue||({block:Ac}=this.Rjf(Xa,Qb)).returnValue)&&Ac&&Bb.add(Ac)}}return Bb}Rjf(eb,Ib){for(let Xa=0;Xa<eb.length;Xa++)if(2===eb.J(Xa).type&&eb.J(Xa).Hj===
Ib)return eb=eb.J(Xa),{returnValue:!0,block:eb};return{returnValue:!1,block:null}}S3a(){const eb=new k.a;wb.a.Wcc(this.Mg,"BaseObjects_",this.EF,eb);wb.a.Wcc(this.Mg,"FavoredObjects_",this.sAa,eb);wb.a.Wcc(this.Mg,"ConflictObjects_",this.MBa,eb)}NQk(){let eb,Ib;eb=x.a.nil;Ib=-1;let Xa=0;for(let Ra=0;Ra<this.dQ.Pe.length;Ra++){const gb=this.dQ.Pe.J(Ra);if(gb.s4())Xa+=gb.length;else if(6!==gb.type)Xa=0;else return eb=gb.Hj,Ib=Xa,{returnValue:!0,objectId:eb,cp:Ib}}a.a.instance.Ta(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");
return{returnValue:!1,objectId:eb,cp:Ib}}Gad(eb,Ib){let Xa,Ra;Ra=Ib;Xa=eb;try{let gb=this.initialize();if(gb=(gb=gb&&this.Xth(!0,eb,Ib).returnValue)&&({objectId:Xa,cp:Ra}=this.NQk()).returnValue)return a.a.instance.Ta(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Xa,Ra),{returnValue:!0,R5a:Xa,Ypa:Ra}}catch(gb){a.a.instance.Ta(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.TOd(gb))}this.W6c(5);
a.a.instance.Ta(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Wra,this.P7f);this.S3a();return{returnValue:!1,R5a:Xa,Ypa:Ra}}static u3h(eb,Ib){let Xa;Xa=new k.a;if(!eb.input.hGb)return{returnValue:!0,MMf:Xa};eb=eb.input.f$.last().i1a(w.a.xL);Xa=Ib.getPropertyObjectIds(eb,l.a.p1);return{returnValue:!0,MMf:Xa}}static yEn(eb){if(!wb.a.Lff(eb))return!0;const Ib=new z.a;eb.runtime.fn.Z(w.a.xL,wb.a.yzm(eb,
Ib));return!0}static dEn(eb){if(!eb.runtime.fn.nb(w.a.xL)||!eb.runtime.Iq.nb(w.a.xL))return!0;const Ib=new z.a,Xa=eb.runtime.fn.J(w.a.xL);var Ra=Ib.getPropertyString(Xa.wm,l.a.bUa);if(x.a.Ff(Ra).equals(x.a.nil))return!0;Ra=Ib.getPropertyObjectIds(Xa.wm,l.a.p1);const gb=Ib.getPropertyObjectIds(eb.runtime.Iq.J(w.a.xL),l.a.p1);let Bb;({MMf:Bb}=nb.u3h(eb,Ib));for(let $b=0;$b<gb.length;$b++)Ra.contains(gb.J($b),(Qb,Ac)=>Qb.equals(Ac))||Bb.contains(gb.J($b),(Qb,Ac)=>Qb.equals(Ac))||(Ra.add(gb.J($b)),eb.runtime.fn.Z(gb.J($b),
new cc.a(eb.runtime.Iq.J(gb.J($b)).IK())));Ib.setPropertyObjectIds(Xa.wm,l.a.p1,Ra);return!0}}Object(E.a)(nb,"ParagraphMergeUsingHints",null,[967])},1645:function(E,K,c){E=c(0);class l{constructor(n){this.gQi=n;this.succeeded=!1;this.Klc=n?n.Klc:0;this.KSm=!1;this.length=this.lGo=0}}Object(E.a)(l,"TrieResult",null,[]);class f{constructor(n,u,z){this.clb=new l(null);this.o8m=n;this.mYc=u;this.YKi=u+z-1}get result(){return this.clb}rbi(){let n;return this.mYc<=this.YKi?(n=this.o8m.charAt(this.mYc),
++this.mYc,{returnValue:!0,ch:n}):{returnValue:!1,ch:"\x00"}}n4f(n,u,z){n&&(this.clb.KSm=!0,this.clb.lGo=u);this.clb.length=this.mYc;this.clb.succeeded=!0;this.clb.Klc=z;this.mYc!==this.YKi+1&&(this.clb=new l(this.clb))}}Object(E.a)(f,"LookUpStringVisitor",null,[1590]);var a=c(1731);class k{constructor(){this.pBh=this.Myh=this.Oyh=this.Lyh=this.Nyh=this.T4e=this.R4e=this.V4e=this.Q4e=0}}Object(E.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.symbol=this.QZc=0}}Object(E.a)(x,"TrieSymbol",null,
[]);c.d(K,"a",function(){return y});class y{constructor(n,u){this.u4=null;this.c3d=this.mLi=this.kLi=this.oLi=this.gLi=this.nLi=this.lLi=this.pLi=this.hLi=0;this.DJ=n;if(n.Dy(u,4)!==y.Yzb)throw Error.argument("Input does not represent a trie");u+=4;this.$Ki=1===n.Dy(u,4);u+=4;this.l8m=1===n.Dy(u,4);u+=4;this.h8m=n.Dy(u,4);u+=4;if(n.Dy(u,4)){n=u+4;this.u4=this.WOn(n);this.hLi=u=n+y.iPk;this.pLi=u+=y.$Bd*(this.u4.Q4e+(this.u4.Q4e%2?1:0));this.lLi=u+=y.$Bd*(this.u4.V4e+(this.u4.V4e%2?1:0));this.nLi=
u+=y.$Bd*(this.u4.R4e+(this.u4.R4e%2?1:0));this.gLi=u+=y.$Bd*(this.u4.T4e+(this.u4.T4e%2?1:0));this.oLi=u+=y.X4e*this.u4.Lyh;this.kLi=u+=y.Y4e*this.u4.Oyh;this.mLi=u+=y.Y4e*this.u4.Myh;u+=y.Y4e*this.u4.Nyh;if(u!==n+this.u4.pBh)throw Error.argument("Corrupted trie binary");this.c3d=u}else this.u4=null}yKi(n,u,z,w){n=new f(n,u,z);this.zJj(n,w);return n.result}ugi(n){if(this.$Ki)if(n)--n;else return"";if(!this.u4)throw Error.argument("Invalid trieID");const u=new a.a;u.DF=0;this.lQb(u);const z=[];for(;;){if(u.DF&
y.E8a)if(n)--n;else return Array.add(z,u.nRb),String.fromCharCode.apply(null,z);const w=!!(u.DF&y.Iqe),F=this.i7b(u,!0);if(w||n<F){if(Array.add(z,u.nRb),!this.lQb(u))throw Error.argument("Invalid trieID");}else if(n-=F,!this.T$c(u))throw Error.argument("Invalid trieID");}}zJj(n,u){let z=0;this.$Ki&&(n.n4f(this.l8m,this.h8m,0),++z);if(this.u4){var w=new a.a;w.DF=0;if(this.lQb(w))for(;;){var F=void 0;if(!({ch:F}=n.rbi()).returnValue)break;u&&(F=u(F));F=F.toString().charCodeAt(0);let G=!1;for(;!G;){const H=
!!(w.DF&y.E8a);if(w.nRb===F){if(G=!0,H&&n.n4f(!!(w.DF&y.uug),w.Lke,z),!this.lQb(w))return}else if(z+=this.i7b(w,!0),!this.T$c(w))return;H&&++z}}}}lQb(n){if(!n.DF)return this.jkg(n),!0;if(!(n.DF&y.Hqe))return!1;n.CPa=0;n.Hx=n.Cib;this.jkg(n);return!0}T$c(n){if(n.DF&y.Iqe)return!1;this.jkg(n);return!0}i7b(n,u){return n.DF&y.tug?n.ZBd:n.DF&y.Hqe?!u&&n.DF&y.Iqe?this.CRl(n):1:0}CRl(n){n=y.D7e(n);if(!this.lQb(n))return 0;let u=0;do n.DF&y.E8a&&++u,u+=this.i7b(n,!1);while(this.T$c(n));return u}jkg(n){n.DF||
(n.CPa=0,n.Hx=this.c3d);var u=this.EHd(this.hLi,n.Hx),z=u.symbol;n.Hx+=u.QZc;u=this.DJ.Dy(this.gLi+y.X4e*z,y.X4e);n.nRb=u&65535;n.DF=u>>16;n.DF&y.tug&&(n.ZBd=this.Jgl(n));n.DF&y.uug&&(u=this.EHd(this.pLi,n.Hx),z=u.symbol,n.Hx+=u.QZc,n.Lke=this.DJ.Dy(this.oLi+4*z,4));n.DF&y.TRj?(n.Cib=this.c3d+((this.DJ.J(n.Hx)<<8|this.DJ.J(n.Hx+1))<<8|this.DJ.J(n.Hx+2)),n.Hx+=3):n.DF&y.URj?(n.Cib=n.Hx,n.CPa=n.Cib):n.DF&y.VRj?(u=this.EHd(this.lLi,n.Hx),z=u.symbol,n.Hx+=u.QZc,n.Cib=this.c3d+this.DJ.Dy(this.kLi+4*z,
4)):n.DF&y.Hqe&&(u=this.EHd(this.nLi,n.Hx),z=u.symbol,n.Hx+=u.QZc,n.CPa||(n.CPa=n.Hx),n.CPa+=this.DJ.Dy(this.mLi+4*z,4),n.Cib=n.CPa)}EHd(n,u){const z=new x;let w=0;for(;;){w+=this.DJ.J(u);++u;++z.QZc;const F=this.DJ.Dy(n,2);if(w<F)break;z.symbol+=F;w-=F;n+=2;w<<=8}z.symbol+=w;return z}Jgl(n){let u=this.DJ.J(n.Hx);192<=u?(u=(u&63)<<15|(this.DJ.J(n.Hx+1)&127)<<8,u|=this.DJ.J(n.Hx+2),n.Hx+=3):128<=u?(u=(u&127)<<8|this.DJ.J(n.Hx+1),n.Hx+=2):n.Hx+=1;return u}WOn(n){const u=new k;u.Q4e=this.DJ.Dy(n+12,
2);u.V4e=this.DJ.Dy(n+14,2);u.R4e=this.DJ.Dy(n+16,2);u.T4e=this.DJ.Dy(n+18,2);u.Nyh=this.DJ.Dy(n+24,4);u.Lyh=this.DJ.Dy(n+28,4);u.Oyh=this.DJ.Dy(n+32,4);u.Myh=this.DJ.Dy(n+36,4);u.pBh=this.DJ.Dy(n+40,4);return u}static D7e(n){const u=new a.a;u.nRb=n.nRb;u.DF=n.DF;u.ZBd=n.ZBd;u.Hx=n.Hx;u.Cib=n.Cib;u.CPa=n.CPa;u.Lke=n.Lke;return u}}y.Yzb=1654263084;y.iPk=48;y.$Bd=2;y.Y4e=4;y.X4e=4;y.E8a=1;y.Iqe=2;y.tug=4;y.uug=8;y.Hqe=16;y.URj=64;y.VRj=128;y.TRj=256;Object(E.a)(y,"Trie",null,[1588])},1647:function(E,
K,c){c.r(K);E=c(0);c(1496);var l=c(1514);class f{}f.marketPlace=0;f.catalog=1;f.privateCatalog=10;Object(E.a)(f,"AppsForOfficeStoreType",null,[]);var a=c(1494),k=c(2),x=c(91),y=c(13);class n{constructor(){this.TSe=0}k1f(I,N){this.TSe=window.performance.now();this.sUa(()=>{const P=window.performance.now(),M={},J=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);N.bzk&&(M.callback=V=>{I(V,f.marketPlace,P)},J&&(M.storeType=f.marketPlace),
k.AFrameworkApplication.va.Qb(y.a.ZLb,2,M));N.czk&&(M.callback=V=>{I(V,f.privateCatalog,P)},J?M.storeType=f.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?M.storeType=10:M.storeType=f.privateCatalog,k.AFrameworkApplication.va.Qb(y.a.ZLb,2,M))},0,()=>{if(a.TellMeActor.instance.Oe)a.TellMeActor.instance.Oe.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.TSe)+
" ms")})}sUa(I,N=0,P=null){2!==k.AFrameworkApplication.va.processAction(y.a.ZLb,1)?(a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.JA(l.a.azk,window.performance.now()-this.TSe),I()):N<n.zan?k.AFrameworkApplication.pc.Wb(new x.a(2,1,n.S1o,()=>{this.sUa(I,N+1,P)})):P&&P()}static get instance(){n._instance||(n._instance=new n);return n._instance}}n._instance=null;n.zan=20;n.S1o=500;Object(E.a)(n,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=this.id=this.displayName=null;
this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.EHf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(E.a)(u,"AddinInfo",null,[]);var z=c(1497),w=c(1501),F=c(1500),G=c(1493),H=c(127);c.d(K,"AddinResultsProvider",function(){return L});class L{constructor(I){this.ZOe=[];this.fc=I;this.Knn=(N,P,M)=>{if(N){const J=N.errorCode;if(a.TellMeActor.instance.Oe){const V={};V.StoreType=P;V.ErrorCode=J;V.AddinCount=N.value?N.value.length:
0;a.TellMeActor.instance.Oe.JA(l.a.CKl,window.performance.now()-M,V)}if(0===J&&N.value){L.nzb=L.nzb||{};N=N.value;for(const V of N)N=new u,N.displayName=V[0],N.id=V[1],N.description=V[2],N.targetType=V[3],N.appVersion=4<V.length?V[4]:"",N.assetId=5<V.length?V[5]:"",N.assetStoreId=6<V.length?V[6]:"",N.width=7<V.length?V[7]:0,N.height=8<V.length?V[8]:0,N.iconUrl=9<V.length?V[9]:"",N.providerName=10<V.length?V[10]:"",N.storeId=11<V.length?V[11]:"",N.storeType=12<V.length?V[12]:"",N.EHf=this.H_l(N),L.nzb[N.id]=
N,0<N.iconUrl.length&&(P="AddinIcon_"+N.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.A8i(P,N.iconUrl):appChrome.addInApi.registerAddinIcon(P,N.iconUrl))}}};n.instance.k1f(this.Knn,this.fc)}aL(){return"Add-ins"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(I,N,P,M,J=null){P=new F.a(I);J&&!Array.contains(J,27)||G.a.cR(I)||(J=new w.a(27),J.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.h_l(I.Dg,J),P.Uu(J));
N.resultsUpdated(P)}h_l(I,N){if((I=this.Cao(I))&&0<I.length){let P=0;I.forEach(M=>{if(!(3<++P)){var J="AddinSuggestion"+P,V={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var X="AddinIcon_"+M.id;0>Array.indexOf(this.ZOe,X)&&0<M.iconUrl.length&&this.A8i(X,M.iconUrl);V["default"]=0<=Array.indexOf(this.ZOe,X)?X:"AppForOfficeLogo_20"}else V["default"]=0<M.iconUrl.length?"AddinIcon_"+M.id:"AppForOfficeLogo_20";X=[];X.push(appChrome.actions.setControlLabel(J,
M.displayName));X.push(appChrome.actions.setControlIconSet(J,V));X.push(appChrome.actions.setCompoundButtonCommandValueId(J,M.id));X.push(appChrome.actions.updateCompoundButtonDescription(J,M.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(V=window.performance.now(),X.push(appChrome.actions.updateControlEnabledDisabledState(J,!1)),a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.JA(l.a.htl,window.performance.now()-
V));appChrome.api.dispatch(X);J=new z.a(J,27,void 0,void 0,1);J.KI=Telemetry.PrivacyRules.GetPrivacyCompliantId(M.id,M.storeType,M.assetId,null,null,M.storeId);N.Nw(J)}})}}A8i(I,N){H.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(I,N),Array.add(this.ZOe,I))}Cao(I){if(!L.nzb)return null;const N=[],P=L.nzb;for(let J in P){var M=P[J];M&&L.y$m(I,M)&&Array.add(N,M)}return N}H_l(I){return L.kAo(I.displayName)}static y$m(I,N){if(!N.EHf)return!1;for(const P of I.split(" ")){I=
!1;for(const M of N.EHf)if(M.toLowerCase().startsWith(P.toLowerCase())){I=!0;break}if(!I)return!1}return!0}static kAo(I){const N=[];for(const P of I.split(" ")){I=0;for(let M=0;M<P.length;M++){const J=P.charAt(M);J.toString().toUpperCase()===J.toString()&&M>I&&(Array.add(N,P.substring(I,M)),I=M)}Array.add(N,P.substring(I,P.length));I&&Array.add(N,P.substring(0,P.length))}return N}}L.nzb=null;Object(E.a)(L,"AddinResultsProvider",null,[942])},1713:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);
var l=c(223);class f{constructor(){this.$mb=this.anb=this.I_a=this.bjb=this.Zmb=this.wfb=this.$ib=this.d5a=this.xfb=this.ajb=null;this.reset()}reset(){this.ajb=new l.a;this.xfb=new l.a;this.d5a=new l.a;this.$ib=new l.a;this.wfb=new l.a;this.Zmb=new l.a;this.bjb=new l.a;this.I_a=new l.a;this.I_a=new l.a;this.anb=new l.a;this.$mb=new l.a}w0o(a){return this.rPa(this.ajb,a)&&this.rPa(this.xfb,a)&&this.rPa(this.d5a,a)&&this.rPa(this.$ib,a)&&this.rPa(this.wfb,a)&&this.rPa(this.Zmb,a)&&this.rPa(this.bjb,
a)&&this.rPa(this.I_a,a)&&this.rPa(this.anb,a)&&this.rPa(this.$mb,a)}rPa(a,k){return!a||!a.length||a.length===k}}Object(E.a)(f,"MergeableTrackedChangesProperties",null,[])},1714:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(223),f=c(602);class a{constructor(){this.fJa=new l.a;this.gKa=new l.a;this.yMa=new l.a}get Dzb(){return this.fJa}get kjf(){return this.gKa}get cqb(){return this.yMa}get isEmpty(){return!this.fJa.length&&!this.gKa.length&&!this.yMa.length}get hlb(){return Math.max(Math.max(this.fJa.length,
this.gKa.length),this.yMa.length)}get Xcn(){return Math.min(Math.min(this.fJa.length,this.gKa.length),this.yMa.length)}mAd(k){this.fJa.add(k)}oAd(k){this.gKa.add(k)}sAd(k){this.yMa.add(k)}gDl(){const k=new f.a,x=new l.a;let y=0;for(;y<this.fJa.length||y<this.gKa.length||y<this.yMa.length;)y<this.fJa.length&&!k.contains(this.fJa.J(y))&&(x.add(this.fJa.J(y)),k.add(this.fJa.J(y))),y<this.gKa.length&&!k.contains(this.gKa.J(y))&&(x.add(this.gKa.J(y)),k.add(this.gKa.J(y))),y<this.yMa.length&&!k.contains(this.yMa.J(y))&&
(x.add(this.yMa.J(y)),k.add(this.yMa.J(y))),y++;return x}}Object(E.a)(a,"ObjectCollection",null,[])},1715:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.EIa=a;this.updateHints=f}}Object(E.a)(l,"UpdateHintCollection",null,[])},1716:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1559);class l extends c.a{constructor(f,a){super();this.yg=f;this.Lc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,
this.type,this.yg,this.Lc)}}Object(E.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1717:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(223);c=c(1559);class f extends c.a{constructor(a){super();this.K_=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let k=0;k<this.K_.length;k++)a+=String.format("({0}), ",this.K_.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(E.a)(f,"LcsInsertUpdateHint",c.a,[])},1718:function(E,K,c){c.d(K,"a",function(){return l});
E=c(0);c=c(1559);class l extends c.a{constructor(f,a){super();this.text=a;this.yg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.yg,this.text)}}Object(E.a)(l,"LcsInsertTextUpdateHint",c.a,[])},1719:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1559);class l extends c.a{constructor(f,a,k){super();this.cp=f;this.yg=a;this.Lc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.yg,this.Lc)}}Object(E.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1720:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1559);class l extends c.a{constructor(f,a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(E.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1721:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1531);class l extends c.a{constructor(){super()}get lga(){return"Conflict"}}
Object(E.a)(l,"ConflictMergeFailureDetail",c.a,[])},1722:function(E,K,c){c.r(K);c.d(K,"InsightsMenuItemFactory",function(){return k});E=c(0);var l=c(1493),f=c(160),a=c(19);class k{constructor(x=null){this.F6j=x||CommonUIStrings.l_InsightsButtonText}get fNb(){return 10}Tfa(x){var y=x.aD;x=l.a.sha()?l.a.JNa(y,1):l.a.uBb(y);y=String.format(this.F6j,y);return this.SIl(x,y)}SIl(x,y){return f.a(k.Sri,l.a.sha()?"1914896509":"3317204163",a.a.Af(y),l.a.GAf,null,a.a.Af(x),a.a.Af(y),null,null)}}k.Sri="bInsights";
Object(E.a)(k,"InsightsMenuItemFactory",null,[1437])},1723:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(160),f=c(19);class a{constructor(k,x,y,n,u){this.KQe=k;this.JQe=x;this.Alk=y;this.f5j=n;this.OYg=u}get fNb(){return 4}Tfa(k,x=null){x=x.sessionId+"|"+x.noa+"|"+k.aD;if(this.OYg||this.f5j){let y=this.OYg||f.a.VA(CommonUIStrings.l_HelpTooltip)===f.a.VA(k.aD.trim());if(this.Alk&&2<k.aD.length){const n=k.aD;";"===n.charAt(0)&&";"===n.charAt(n.length-1)&&n.substring(1,n.length-1)===
a.yxf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.aD);return this.H2h(x,f.a.Af(k),y)}return this.H2h(x,f.a.Af(String.format(CommonUIStrings.l_TextWithQuotation,k.aD)),!1)}H2h(k,x,y){return l.a(a.yxf,y?this.JQe:this.KQe,x,"OfficeAssistant_16x16x32","A0",f.a.Af(k),x,null,null)}}a.yxf="bSearchHelp";Object(E.a)(a,"AssistanceMenuItemFactory",null,[1437])},1724:function(E,K,c){c.d(K,"a",function(){return x});E=c(0);var l=c(2),f=c(160),a=
c(88),k=c(19);class x{get fNb(){return 13}Tfa(){return x.GMk()}static GMk(){return f.b(x.z_h,"798637440",k.a.Af(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Vs,a.getImageClass("Info_32x32x32"),null,null,k.a.Af(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,k.a.Af(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.z_h="bTellMeFirstRun";Object(E.a)(x,"FirstRunMenuItemFactory",null,[1437])},1725:function(E,K,c){c.d(K,"a",function(){return k});
E=c(0);var l=c(2),f=c(160),a=c(19);class k{constructor(x=null,y=null){this.v7g=x;this.nbk=y||CommonUIStrings.l_LookupNoResultsDescription}get fNb(){return 14}Tfa(x){x=String.format(this.nbk,x.aD);return this.uNk(x)}uNk(x){return f.b(k.uQi,"798637440",a.a.Af(CommonUIStrings.l_LookupNoResultsTitle),this.v7g?l.AFrameworkApplication.Vs:null,this.v7g,null,null,a.a.Af(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Af(x),null,null)}}k.uQi="lookupNoResults";Object(E.a)(k,"NoCommandsFoundMenuItemFactory",
null,[1437])},1726:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(E.a)(l,"LabelFormatted",null,[])},1727:function(E,K,c){c.d(K,"a",function(){return y});E=c(0);c(1496);var l=c(1497),f=c(1501),a=c(1500),k=c(1493),x=c(19);class y{constructor(n){this.fc=n}aL(){return"Assistance"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:this.fc.b0c?3:2}QH(n,u,z=!1,w,F=null){w=new a.a(n);if((!F||Array.contains(F,
8))&&!k.a.cR(n)){F=new f.a(8);if(z){z=x.a.VA(CommonUIStrings.l_HelpTooltip)===x.a.VA(n.Dg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Dg);const G=[];this.fc.q3a&&(this.fc.Zhe||G.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.Kbi(n.Dg));const H="||"+n.Dg;G.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));G.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));
appChrome.api.dispatch(G);n=new l.a("GetHelpFromTellMe",4,n.Dg,null,1)}else n=new l.a("bSearchHelp",4,n.Dg,null,1);F.Nw(n);F.displayName=CommonUIStrings.l_HelpButtonTitle;w.Uu(F)}u.resultsUpdated(w)}hib(n,u=null){const z=new f.a(8),w=x.a.VA(CommonUIStrings.l_HelpTooltip)===x.a.VA(n.Dg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Dg);for(let G=0;G<u.length&&2>G;G++){var F=void 0;F=[];let H="GetHelpWithDescriptionFromTellMe"+(G+1).toString(),
L=4;if(this.fc.O7c)F.push(appChrome.actions.setControlLabel(H,w)),F.push(appChrome.actions.setCompoundButtonCommandValueId(H,n.Dg)),F.push(appChrome.actions.updateCompoundButtonDescription(H,this.Yuf(u.length)));else if(this.fc.P7c){let I=this.dii(u[G]);H="GetHelpFromTellMe"+(G+1).toString();this.fc.q3a&&(I=this.Kbi(I));L=9;F.push(appChrome.actions.setControlLabel(H,I));F.push(appChrome.actions.setButtonCommandValueId(H,this.Pfm(u[G])))}appChrome.api.dispatch(F);F=new l.a(H,L,null,null,0);F.label=
this.dii(u[G]);F.description=this.Ofm(u[G]);z.Nw(F);if(this.fc.P7c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}Yuf(n){return 1===n?String.format(CommonUIStrings.l_SearchResultText,n):String.format(CommonUIStrings.l_SearchResultsText,n)}Kbi(n){return this.fc.eGf?k.a.bqf(n,CommonUIStrings.l_HelpScopedButtonText):n+CommonUIStrings.l_HelpScopedButtonText}dii(n){return n.name?n.name:""}Ofm(n){return n.description?n.description:""}Pfm(n){return n.id?"AssetID="+n.id:""}}Object(E.a)(y,
"AssistanceResultsProvider",null,[942])},1728:function(E,K,c){c.d(K,"a",function(){return n});E=c(0);c(1496);var l=c(1497),f=c(1501),a=c(1500),k=c(1494),x=c(1493),y=c(1530);class n{constructor(u){this.fc=u}aL(){return"Image"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:3===this.fc.dv?3:2}QH(u,z,w,F,G=null){w=new a.a(u);(!G||Array.contains(G,19))&&x.a.cR(u)&&this.fc.sP&&this.hib(u,w,1);z.resultsUpdated(w)}hib(u,z,w,F=null){var G=[];let H;k.TellMeActor.instance.DO()&&k.TellMeActor.instance.DO().q3a?
(H=this.fc.eGf?x.a.bqf(u.Dg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Dg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.fc.Zhe||G.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.fc.sP?x.a.cR(u)?this.fc.Gdb?x.a.chb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.fc.Gdb?x.a.chb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Dg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Dg):this.fc.pjc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Dg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.fc.Yva?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",H)),G=x.a.JNa(u.Dg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",G))):(G.push(appChrome.actions.setControlLabel("ImageForSearch",
H)),u=x.a.JNa(u.Dg,9,Object.assign(new y.a,{landingTab:"Image"})),G.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(G));w=new l.a("ImageForSearch",12,null,null,w);F&&(w.score=F.ConfidenceScore);F=new f.a(19,this.fc.pjc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);F.Nw(w);z.Uu(F)}}Object(E.a)(n,"ImageResultsProvider",null,[942])},1729:function(E,K,c){c.d(K,"a",function(){return y});E=c(0);c(1496);var l=c(1497),f=c(1501),a=c(1500),
k=c(1493),x=c(2);class y{constructor(n){this.fc=n}aL(){return"Template"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:3}QH(n,u){n=new a.a(n);u.resultsUpdated(n)}hib(n,u,z){var w=[];let F;F=this.fc.sP?this.fc.Gdb?k.a.chb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,n.Dg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,n.Dg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,n.Dg);w.push(appChrome.actions.setControlLabel("TemplateForSearch",F));w.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(x.AFrameworkApplication.K.jb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,n.Dg)));appChrome.api.dispatch(w);n=new f.a(23);n.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;w=new l.a("TemplateForSearch",24,null,null,0);w.label=z[0].Title?z[0].Title:"";w.description=z[0].Description?z[0].Description:"";n.Nw(w);u.Uu(n)}}Object(E.a)(y,"TemplateResultsProvider",null,[942])},1730:function(E,K,c){c.d(K,"a",function(){return z});E=c(0);c(1496);var l=c(1533),f=c(1497),
a=c(1501),k=c(1500),x=c(1631),y=c(1494),n=c(1493),u=c(19);class z{constructor(w,F,G,H){this.A2=w;this.Tcb=F;this.bjh=H;this.C2j=G;this.fc=y.TellMeActor.instance.DO()}aL(){return"EmptyQuery"}eU(){return 1===this.fc.dv?1:0}QH(w,F,G=!1,H,L=null){H=new k.a(w);if((!L||Array.contains(L,5)||Array.contains(L,6)||Array.contains(L,4))&&n.a.cR(w)){this.A2.DNc().length||!this.C2j||this.bjh||(w=new a.a(6),L=new f.a(null,13,void 0,void 0,1),w.Nw(L),H.Uu(w));w=new a.a(4);if(0<this.A2.DNc().length){w.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;L=this.A2.DNc();var I=[];for(var N of L)I.push(N.Id);l.CommandResultsUtility.Cad(I,this.fc);for(var P of L)l.CommandResultsUtility.yTc(P.Id)&&w.Nw(new f.a(P.Id,5,null,null,2));H.Uu(w)}if(this.bjh&&0<this.Tcb.length&&this.A2.DNc().length<z.maxResults){N=new a.a(5);N.displayName=CommonUIStrings.l_TellMeTryQueryTitle;P=z.maxResults-w.results.length;w=[];for(L=0;L<this.Tcb.length&&L<P;++L){if(G){I=n.a.Okg+(L+1);const M=this.Tcb[L].key,J=u.a.replaceAll(M,'"',"");
w.push(appChrome.actions.setControlLabel(I,M));w.push(appChrome.actions.setButtonCommandValueId(I,J));I=new x.a(M,7,0,J,I)}else I=new x.a(this.Tcb[L].key,7,0,this.Tcb[L].value);N.Nw(I)}0<w.length&&appChrome.api.dispatch(w);H.Uu(N)}}F.resultsUpdated(H)}}z.maxResults=5;Object(E.a)(z,"EmptyQueryResultsProvider",null,[942])},1731:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.Lke=this.CPa=this.Cib=this.Hx=this.ZBd=this.DF=this.nRb=0}}Object(E.a)(l,"TRIESCAN",null,[])},
1733:function(E,K,c){c.d(K,"a",function(){return G});E=c(0);var l=c(2),f=c(403),a=c(698),k=c(398),x=c(719);c.n(x);var y=c(736);c.n(y);var n=c(98),u=c(1085),z=c(368),w=c(331),F=c(7);c=c(255);class G extends c.a{constructor(H,L){super("SummaryGenerationCondition");this.Bgg=-1;this.Cij=()=>{if(!G.Ogg&&this.Soe.jy>G.$cn){const I=a.a.getAugLoopRuntimeManager(),N=this.lNd();this.Bgg=Date.now();I.submitOperation(Object.assign(new w.a,{operation:N}))}};this.Dij=()=>{this.Cij();this.Soe.jde(this.Dij)};this.nmb=
I=>{I=I.items[0];x.TextSummaryAnnotation.typeGuard(I.body)||x.GptSummaryAnnotation.typeGuard(I.body)||y.TextAbstractiveSummaryAnnotation.typeGuard(I.body)?(G.Ogg=I.body,"Success"!==G.Ogg.status?this.Sg(!1):(this.Sg(!0),this.v3m())):(F.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${n.a.getTypeNameFor(I.body)}`),this.Sg(!1))};this.Soe=L.getInstance(0);this.In=H.In}static get summary(){return G.Ogg}initialize(){super.initialize();k.a.$k().then(()=>{const H=a.a.getAugLoopRuntimeManager();
let L;L=this.Rxi()?x.GptSummaryAnnotation.getTypeName():this.mTc()?y.TextAbstractiveSummaryAnnotation.getTypeName():x.TextSummaryAnnotation.getTypeName();H.activateAnnotation(Object.assign(new f.a,{annotationType:L,handler:this.nmb}))});-1===this.Soe.jy?this.Soe.izb(this.Dij):this.Cij()}Md(){super.Md()}mTc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}Rxi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",
!1)}lNd(){return this.Rxi()?Object.assign(new u.l,{parentPath:["Signal",x.GptSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new x.GptSummarySignal})]}):this.mTc()?Object.assign(new u.l,{parentPath:["Signal",y.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new y.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new u.l,{parentPath:["Signal",x.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new z.a,
{body:new x.GenerateTextSummarySignal})]})}Sg(H){super.Sg(H);F.ULS.sendTraceTag(508944769,3028,50,this.wT(this.In,H))}v3m(){if(-1!==this.Bgg){var H=Date.now()-this.Bgg;F.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",H)}}}G.$cn=300;Object(E.a)(G,"SummaryGenerationCondition",c.a,[])},1751:function(E,K,c){c.r(K);var l=c(0),f=c(1496),a=c(1543),k=c(1514),x=c(1497),y=c(1501),n=c(1500),u=c(1494),z=c(1493),w=c(1530);class F{constructor(cb){this.fc=
cb}aL(){return"ActionAI"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb,ac=!1,Ec,Lc=null){Ec=new n.a(cb);if(!Lc||Array.contains(Lc,24))if(this.vso()||!z.a.cR(cb)){Lc=new y.a(24);var kd=z.a.cR(cb);ac&&(ac=null,z.a.sha()&&(ac=z.a.JNa(kd?"":cb.Dg,1,Object.assign(new w.a,{landingTab:"ActionAI"}))),this.fc.Yva?ac&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",ac)):(cb=[],ac&&cb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
ac)),appChrome.api.dispatch(cb)));Lc.Nw(new x.a("ActionAIFromTellMe",25,null,null,1));Ec.Uu(Lc)}Jb.resultsUpdated(Ec)}vso(){return z.a.sha()&&this.fc.gXd}}Object(l.a)(F,"ActionAIResultsProvider",null,[942]);var G=c(1647);class H{constructor(cb,Jb){this.Bza=cb;this.Ok=Jb}resultsUpdated(cb){this.Bza.qlo(this.Ok,cb)}}Object(l.a)(H,"AggregatorResultsProviderCallback",null,[1439]);class L{constructor(cb){this.nra=null;this.fc=cb;this.fc.uzb&&(this.nra=null)}aL(){return"AppsForOffice"}eU(){return 0===this.fc.dv?
0:1===this.fc.dv?1:2}QH(cb,Jb,ac,Ec,Lc=null){ac=new n.a(cb);if(!Lc||Array.contains(Lc,1))Lc=new y.a(1),this.nra.mbp(Lc,cb.Dg),ac.Uu(Lc);Jb.resultsUpdated(ac)}}Object(l.a)(L,"AppsForOfficeRecommendationResultsProvider",null,[942]);var I=c(1727),N=c(1489),P=c(1509),M=c(110);class J{constructor(cb,Jb){this.Ab=cb;this.k8m=Jb}isMatch(cb,Jb){if(!Object(M.a)(1550,cb))throw Error.argument("objToTest","Expected feature bundle");let ac;return({value:ac}=cb.Hq(this.Ab.Sta)).returnValue?this.Ab.$ng.isMatch(ac,
Jb):this.k8m}}Object(l.a)(J,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1582]);class V{constructor(cb,Jb){this.Ab=cb;this.pLf=Jb}isMatch(cb){if(!Object(M.a)(1550,cb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.pLf^cb.Hq(this.Ab.Sta).returnValue)}}Object(l.a)(V,"AnnotatedWithAnnotationFilter",null,[1582]);class X{constructor(cb){this.Ab=cb}isMatch(cb,Jb){if(!Object(M.a)(1553,cb))throw Error.argument("objToTest","Expected struct value");return this.Ab.$ng.isMatch(cb.shb(this.Ab.rOa),
Jb)}}Object(l.a)(X,"FieldValueMatchesStructFilter",null,[1582]);class W{constructor(cb,Jb){cb&&(this.rOa=cb.J(0),this.$ng=Jb.zna(cb.J(1)))}}Object(l.a)(W,"FieldValueMatchesStructFilterInit",null,[]);class U{constructor(cb){this.pLf=cb}isMatch(cb){if(!Object(M.a)(1550,cb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.pLf^cb.Mwf)}}Object(l.a)(U,"HasAnnotationsAnnotationFilter",null,[1582]);class Y{constructor(cb,Jb){this.Ab=cb;this.b9=Jb}isMatch(cb,Jb){if(!Object(M.a)(1552,
cb))throw Error.argument("objToTest","Expected list value");switch(this.b9){case 0:for(const ac of cb.items)if(this.Ab.filter.isMatch(ac,Jb))return!0;return!1;case 1:for(const ac of cb.items)if(!this.Ab.filter.isMatch(ac,Jb))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Y,"ItemTestListFilter",null,[1582]);class ca{constructor(cb){this.Ab=cb}isMatch(cb,Jb){if(!Object(M.a)(1552,cb))throw Error.argument("objToTest","Expected list value");return this.Ab.filter.isMatch(cb.items.length,
Jb)}}Object(l.a)(ca,"LengthMatchesListFilter",null,[1582]);class aa{constructor(cb,Jb){this.Ab=cb;this.b9=Jb}isMatch(cb,Jb,ac=null){let Ec=0===this.b9;for(const Lc of this.Ab.XCh)if((Ec=Lc.isMatch(cb,Jb,ac))?1===this.b9:0===this.b9)return Ec;2===this.b9&&(Ec=!Ec);return Ec}}Object(l.a)(aa,"NonterminalFilter",null,[1582]);class fa{constructor(cb,Jb){if(cb){var ac=cb.J(0);this.XCh=Array(ac);for(let Ec=0;Ec<ac;++Ec)this.XCh[Ec]=Jb.zna(cb.J(1+Ec))}}}Object(l.a)(fa,"NonterminalFilterInit",null,[]);class pa{constructor(cb,
Jb){this.Ab=cb;this.b9=Jb}isMatch(cb,Jb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected number value");let ac=this.Ab.number;if(this.Ab.query){Jb=this.Ab.query.Et(null,Jb);if("number"!==typeof Jb)throw Error.invalidOperation("Query did not return number");ac+=Jb}switch(this.b9){case 0:return cb===ac;case 1:return cb<ac;case 2:return cb<=ac;case 3:return cb>ac;case 4:return cb>=ac;default:throw Error.notImplemented();}}}Object(l.a)(pa,"NumberFilter",null,[1582]);class ra{constructor(cb,
Jb){cb&&(this.number=cb.J(0),this.query=cb.J(1)?Jb.UK(cb.J(1)):null)}}Object(l.a)(ra,"NumberFilterInit",null,[]);class la{constructor(cb,Jb,ac){this.WOd=this.tVl;this.q8m=cb;this.dLi=Jb;this.cLi=ac}l6e(cb){this.dLi=cb}tVl(cb){if(!cb)throw Error.argument("name","Invalid named feature bundle reference");const Jb=cb.substr(1);return 1===cb.charCodeAt(0)&&Jb===this.q8m?this.dLi:this.cLi?this.cLi.WOd(cb):null}}Object(l.a)(la,"SimpleNamedFeatureBundleResolver",null,[1595]);class qa{constructor(cb){this.Ab=
cb}isMatch(cb,Jb){if(!Object(M.a)(1550,cb))throw Error.argument("objToTest","Expected feature bundle");cb=this.Ab.query.Et(null,new la(this.Ab.soe,cb,Jb));if("boolean"!==typeof cb)throw Error.invalidOperation("Query did not return bool");return cb}}Object(l.a)(qa,"PredicateAnnotationFilter",null,[1582]);class La{constructor(cb,Jb){cb&&(this.soe=Jb.QD(cb.J(0)),this.query=Jb.UK(cb.J(1)))}}Object(l.a)(La,"PredicateAnnotationFilterInit",null,[]);class Pa{constructor(cb){this.Ab=cb}isMatch(cb,Jb){if("boolean"!==
typeof cb)throw Error.argument("objToTest","Expected bool value");Jb=this.Ab.query.Et(null,Jb);if("boolean"!==typeof Jb)throw Error.invalidOperation("Query did not return bool");return cb===Jb}}Object(l.a)(Pa,"QueryBooleanFilter",null,[1582]);class Ka{constructor(cb,Jb){this.Ab=cb;this.b9=Jb}isMatch(cb,Jb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected integer");Jb=this.Ab.query.Et(null,Jb);if("number"!==typeof Jb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.b9){case 0:return cb===Jb;case 1:return 0!==(cb&Jb);case 2:return cb===(cb&Jb);case 3:return Jb===(cb&Jb);default:throw Error.notImplemented();}}}Object(l.a)(Ka,"QueryEnumFilter",null,[1582]);class Na{constructor(cb,Jb){cb&&(this.qZd=1===cb.J(0),this.query=Jb.UK(cb.J(1)))}}Object(l.a)(Na,"QueryEnumFilterInit",null,[]);class sa{constructor(cb,Jb){this.Ab=cb;this.b9=Jb}isMatch(cb,Jb){if(!Object(M.a)(1552,cb))throw Error.argument("objToTest","Expected list value");Jb=this.Ab.query.Et(null,
Jb);if(!Object(M.a)(1552,Jb))throw Error.invalidOperation("Query did not return list value");if(cb.x4!==Jb.x4)return!1;switch(this.b9){case 0:return N.Annotations.xqb(N.Annotations.r1l(cb.x4),cb,Jb);case 1:for(const ac of cb.items)for(const Ec of Jb.items)if(N.Annotations.xqb(cb.x4,ac,Ec))return!0;return!1;case 2:for(const ac of cb.items)for(const Ec of Jb.items)if(!N.Annotations.xqb(cb.x4,ac,Ec))return!1;return!0;case 3:for(const ac of Jb.items)for(const Ec of cb.items)if(!N.Annotations.xqb(cb.x4,
ac,Ec))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(sa,"QueryListFilter",null,[1582]);class wa{constructor(cb,Jb){this.Ab=cb;this.b9=Jb}isMatch(cb,Jb){if("string"!==typeof cb)throw Error.argument("objToTest","Expected string");Jb=this.Ab.query.Et(null,Jb);if("string"!==typeof Jb)throw Error.invalidOperation("Query did not return string");this.Ab.IBf&&(cb=cb.toUpperCase(),Jb=Jb.toUpperCase());switch(this.b9){case 0:return cb===Jb;case 1:return 0<=cb.indexOf(Jb);case 2:return cb.startsWith(Jb);
case 3:return cb.endsWith(Jb);case 4:return 0<=Jb.indexOf(cb);case 5:return Jb.startsWith(cb);case 6:return Jb.endsWith(cb);default:throw Error.notImplemented();}}}Object(l.a)(wa,"QueryStringFilter",null,[1582]);class ja{constructor(cb,Jb){cb&&(this.query=Jb.UK(cb.J(0)),this.IBf=1===cb.J(1))}}Object(l.a)(ja,"QueryStringFilterInit",null,[]);class ha{constructor(cb){this.Ab=cb}isMatch(cb,Jb){if(!Object(M.a)(1553,cb))throw Error.argument("objToTest","Expected struct value");Jb=this.Ab.query.Et(null,
Jb);if(!Object(M.a)(1553,Jb))throw Error.invalidOperation("Query did not return struct value");return cb.isEqual(cb)}}Object(l.a)(ha,"QueryStructFilter",null,[1582]);class va{constructor(cb){this.Ab=cb}isMatch(cb,Jb){cb=this.Ab.query.Et(null,Jb);if("boolean"!==typeof cb)throw Error.invalidOperation("Query did not return bool");return cb}}Object(l.a)(va,"QueryWhereConstraintFilter",null,[1582]);class xa{constructor(cb){this.Ab=cb}isMatch(cb){if("string"!==typeof cb)throw Error.argument("objToTest",
"Expected string");return this.Ab.E3f.test(cb)}}Object(l.a)(xa,"RegexStringFilter",null,[1582]);class ma{constructor(cb,Jb){cb&&(this.E3f=Jb.n8b(cb.J(0)))}}Object(l.a)(ma,"RegexStringFilterInit",null,[]);class Ja{constructor(cb,Jb){cb&&(this.filter=Jb.zna(cb.J(0)))}}Object(l.a)(Ja,"SingleFilterFilterInit",null,[]);class oa{constructor(cb,Jb){cb&&(this.query=Jb.UK(cb.J(0)))}}Object(l.a)(oa,"SingleQueryFilterInit",null,[]);class za{constructor(cb){this.Ab=cb}isMatch(cb){if("boolean"!==typeof cb)throw Error.argument("objToTest",
"Expected bool value");return cb===this.Ab.value}}Object(l.a)(za,"StoredValueBooleanFilter",null,[1582]);class Fa{constructor(cb){cb&&(this.value=1===cb.J(0))}}Object(l.a)(Fa,"StoredValueBooleanFilterInit",null,[]);class kb{constructor(cb,Jb){this.Ab=cb;this.b9=Jb}isMatch(cb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected integer");switch(this.b9){case 0:return this.Ab.qZd?this.Ab.value?!!(cb&this.Ab.value):!cb:cb===this.Ab.value;case 1:return this.Ab.qZd?(cb&this.Ab.value)===
this.Ab.value:32>cb&&(1<<cb&this.Ab.value)===this.Ab.value;case 2:return this.Ab.qZd?!!(cb&this.Ab.value):32>cb&&!!(1<<cb&this.Ab.value);default:throw Error.notImplemented();}}}Object(l.a)(kb,"StoredValueEnumFilter",null,[1582]);class fb{constructor(cb){cb&&(this.qZd=1===cb.J(0),this.value=cb.J(1))}}Object(l.a)(fb,"StoredValueEnumFilterInit",null,[]);class lb{constructor(){this.mzn=null;this.W4e=this.eGb=0}}Object(l.a)(lb,"WHEREConstraintData",null,[]);class sb{constructor(cb){this.Ab=cb}isMatch(cb,
Jb){if(!Object(M.a)(lb,cb))throw Error.argument("objToTest","Expected WHERE constraint data");let ac=-1,Ec=-1;const Lc=cb.mzn;switch(this.Ab.U5e){case 4:ac=Lc.dMc;Ec=Lc.bfg;break;case 5:ac=cb.eGb;Ec=Lc.dMc-cb.eGb;break;case 6:ac=Lc.dMc+Lc.bfg;Ec=cb.eGb+cb.W4e-ac;break;case 1:case 2:case 3:let kd=!1;for(let Vd=Lc.dcp;Vd;Vd=Vd.next)if(this.Ab.c_o===Vd.name){kd=!0;1===this.Ab.U5e?(ac=Vd.dMc,Ec=Vd.bfg):2===this.Ab.U5e?(ac=cb.eGb,Ec=Vd.dMc-cb.eGb):(ac=Vd.dMc+Vd.bfg,Ec=cb.eGb+cb.W4e-ac);break}if(!kd)return!1;
break;case 7:ac=cb.eGb;Ec=cb.W4e;break;default:throw Error.notImplemented();}return null!==this.Ab.mAo.rfp(Lc.jmp,ac,Ec,ac,!0,2,Jb)}}Object(l.a)(sb,"SubSreWhereConstraintFilter",null,[1582]);class ab{constructor(cb,Jb){if(cb){var ac=Jb.QD(cb.J(0));this.U5e=ac.charCodeAt(0);this.c_o=ac.substr(1);this.mAo=Jb.lam(cb.J(1))}}}Object(l.a)(ab,"SubSreWhereConstraintFilterInit",null,[]);class Ga{constructor(cb){this.Ab=cb}isMatch(cb,Jb,ac=null){if(!Object(M.a)(1550,cb))throw Error.argument("objToTest","Expected feature bundle");
if(null==ac)throw Error.argumentNull("parentTextForSpan");if(this.Ab.Krh&&!this.Ab.Krh.isMatch(cb,Jb))return!1;if(this.Ab.Dig){let Ec;if(({value:Ec}=cb.Hq(this.Ab.ezo)).returnValue){if(!this.Ab.Dig.isMatch(Ec,Jb))return!1}else{let Lc,kd;if(!({value:Lc}=cb.Hq(this.Ab.Btj)).returnValue||!({value:kd}=cb.Hq(this.Ab.Atj)).returnValue||0>Lc||0>kd||Lc+kd>ac.length||!this.Ab.Dig.isMatch(ac.substr(Lc,kd),Jb))return!1}}if(this.Ab.uuj){let Ec;if(!({value:Ec}=cb.Hq(this.Ab.Btj)).returnValue||!this.Ab.uuj.isMatch(Ec,
Jb))return!1}if(this.Ab.lFi){let Ec;if(!({value:Ec}=cb.Hq(this.Ab.Atj)).returnValue||!this.Ab.lFi.isMatch(Ec,Jb))return!1}return!0}}Object(l.a)(Ga,"TextSpanFilter",null,[1582]);class Ua{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.Btj=cb.J(0),this.Atj=cb.J(1),this.ezo=cb.J(2),this.Dig=cb.J(3)?Jb.zna(cb.J(3)):null,this.Krh=cb.J(4)?Jb.zna(cb.J(4)):null,this.uuj=cb.J(5)?Jb.zna(cb.J(5)):null,this.lFi=cb.J(6)?Jb.zna(cb.J(6)):null)}}Object(l.a)(Ua,"TextSpanFilterInit",null,[]);class wb{constructor(cb,
Jb){cb&&(this.annotations=Jb.annotations,this.Sta=cb.J(0),this.$ng=cb.J(1)?Jb.zna(cb.J(1)):null)}}Object(l.a)(wb,"ValueFilterAnnotationFilterInit",null,[]);var cc=c(1516);class zb{zna(cb,Jb){const ac=cb.J(0),Ec=new cc.a;Ec.Rgb(cb,1,cb.count-1);switch(ac){case 1:return new aa(new fa(Ec,Jb),0);case 2:return new aa(new fa(Ec,Jb),1);case 3:return new aa(new fa(Ec,Jb),2);case 101:return new xa(new ma(Ec,Jb));case 103:return new wa(new ja(Ec,Jb),0);case 104:return new wa(new ja(Ec,Jb),1);case 105:return new wa(new ja(Ec,
Jb),2);case 106:return new wa(new ja(Ec,Jb),3);case 107:return new wa(new ja(Ec,Jb),4);case 108:return new wa(new ja(Ec,Jb),5);case 109:return new wa(new ja(Ec,Jb),6);case 201:return new za(new Fa(Ec));case 202:return new Pa(new oa(Ec,Jb));case 301:return new pa(new ra(Ec,Jb),0);case 302:return new pa(new ra(Ec,Jb),1);case 303:return new pa(new ra(Ec,Jb),2);case 304:return new pa(new ra(Ec,Jb),3);case 305:return new pa(new ra(Ec,Jb),4);case 401:return new kb(new fb(Ec),0);case 402:return new kb(new fb(Ec),
1);case 403:return new kb(new fb(Ec),2);case 404:return new Ka(new Na(Ec,Jb),0);case 405:return new Ka(new Na(Ec,Jb),1);case 406:return new Ka(new Na(Ec,Jb),2);case 407:return new Ka(new Na(Ec,Jb),3);case 501:return new X(new W(Ec,Jb));case 502:return new ha(new oa(Ec,Jb));case 601:return new Y(new Ja(Ec,Jb),0);case 602:return new Y(new Ja(Ec,Jb),1);case 603:return new ca(new Ja(Ec,Jb));case 604:return new sa(new oa(Ec,Jb),0);case 605:return new sa(new oa(Ec,Jb),1);case 606:return new sa(new oa(Ec,
Jb),2);case 607:return new sa(new oa(Ec,Jb),3);case 701:return new U(!1);case 702:return new U(!0);case 703:return new V(new wb(Ec,Jb),!1);case 704:return new V(new wb(Ec,Jb),!0);case 705:return new J(new wb(Ec,Jb),!1);case 706:return new J(new wb(Ec,Jb),!0);case 707:return new qa(new La(Ec,Jb));case 901:return new Ga(new Ua(Ec,Jb));case 1002:return new va(new oa(Ec,Jb));case 1001:return new sb(new ab(Ec,Jb));default:throw Error.argument("initData");}}}Object(l.a)(zb,"FilterFactory",null,[1549]);
var nb=c(1495);class eb{constructor(cb){this.Ab=cb}get UD(){return this.Ab.UD}get Z4(){return this.Ab.Z4}get kke(){return this.Ab.kke}get TXd(){return this.Ab.TXd}load(cb,Jb){return this.Et(cb,cb?new la("root",cb,Jb):Jb)}store(cb,Jb,ac){this.kkc(cb,Jb,cb?new la("root",cb,ac):ac,null)}Et(cb,Jb){if(!this.TXd&&!this.Ab.annotations.Iac(this.UD,cb))throw Error.argument("input","Input value not of expected type");let ac=this.Ab.F_h;for(;ac;)cb=ac.load(cb,Jb),ac=ac.next;return cb}kkc(cb,Jb,ac,Ec){if(!this.kke)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.TXd&&!this.Ab.annotations.Iac(this.UD,cb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ab.annotations.Iac(this.Z4,Jb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ab.F_h.store(cb,Jb,ac,Ec)}static YEh(cb,Jb,ac,Ec){if(ac===Ec)return Jb;if(N.Annotations.gI(ac)&&N.Annotations.gI(Ec)){ac=N.Annotations.h1a(ac);Ec=N.Annotations.h1a(Ec);const Lc=new nb.a(cb,Ec);for(const kd of Jb.items)Array.add(Lc.items,eb.YEh(cb,kd,ac,Ec));return Lc}if(ac===
N.Annotations.xIa){if(Ec===N.Annotations.Rqa)return Jb;if(Ec===N.Annotations.g$)return Jb.toString()}else if(ac===N.Annotations.Rqa){if(Ec===N.Annotations.xIa)return Math.floor(Jb);if(Ec===N.Annotations.g$)return Jb.toString()}else if(ac===N.Annotations.g$){if(Ec===N.Annotations.xIa)return parseInt(Jb);if(Ec===N.Annotations.Rqa)return parseFloat(Jb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(eb,"AnnotationQuery",null,[1585]);class Ib{constructor(){this.Z4=
this.UD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}m1a(cb){if(this.next)return{returnValue:this.next,QHa:cb};if(cb){const Jb=cb.jIh;cb=cb.D2i;return{returnValue:Jb,QHa:cb}}return{returnValue:null,QHa:cb}}}Object(l.a)(Ib,"AnnotationQueryStep",null,[1603]);class Xa extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){Jb=this.Ab.query.Et(cb,Jb);if(N.Annotations.gI(this.UD)){var ac=N.Annotations.h1a(this.UD);let Lc=new nb.a(this.Ab.annotations,ac);if(N.Annotations.gI(this.Ab.query.Z4)){if(cb.items.length!==
Jb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let kd=0,Vd=cb.items.length;kd<Vd;++kd)Array.add(Lc.items,this.fCd(cb.items[kd],Jb.items[kd],ac===N.Annotations.Rqa))}else for(var Ec of cb.items)Array.add(Lc.items,this.fCd(Ec,Jb,ac===N.Annotations.Rqa));return Lc}if(N.Annotations.gI(this.Ab.query.Z4)){Ec=new nb.a(this.Ab.annotations,this.UD);for(ac of Jb.items)Array.add(Ec.items,this.fCd(cb,ac,this.UD===N.Annotations.Rqa));return Ec}return this.fCd(cb,
Jb,this.UD===N.Annotations.Rqa)}fCd(cb,Jb,ac){cb=this.W1b(cb,Jb);return ac?cb:Math.floor(cb)}}Object(l.a)(Xa,"NumericAnnotationQueryStep",Ib,[]);class Ra extends Xa{constructor(cb){super(cb)}W1b(cb,Jb){return cb+Jb}}Object(l.a)(Ra,"AddAnnotationQueryStep",Xa,[]);class gb extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){if(this.UD===N.Annotations.$ya&&this.Ab.query.Z4===N.Annotations.$ya){let Lc;if(({result:Lc}=this.xAh(cb)).returnValue)return Lc}if(N.Annotations.gI(this.UD)){var ac=new nb.a(this.Ab.annotations,
N.Annotations.$ya);Jb=this.Ab.query.Et(cb,Jb);if(N.Annotations.gI(this.Ab.query.Z4)){if(cb.items.length!==Jb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Lc=0,kd=cb.items.length;Lc<kd;++Lc)Array.add(ac.items,this.dHc(Jb.items[Lc],cb.items[Lc]))}else for(var Ec of cb.items)Array.add(ac.items,this.dHc(Jb,Ec));return ac}Ec=this.Ab.query.Et(cb,Jb);if(N.Annotations.gI(this.Ab.query.Z4)){Jb=new nb.a(this.Ab.annotations,N.Annotations.$ya);for(ac of Ec.items)Array.add(Jb.items,
this.dHc(ac,cb));return Jb}return this.dHc(Ec,cb)}}Object(l.a)(gb,"BinaryBooleanAnnotationQueryStep",Ib,[]);class Bb extends gb{constructor(cb){super(cb)}xAh(cb){return{returnValue:!cb,result:!1}}dHc(cb,Jb){return cb&&Jb}}Object(l.a)(Bb,"AndAnnotationQueryStep",gb,[]);class $b{constructor(cb){cb&&(this.annotations=cb)}}Object(l.a)($b,"AnnotationsOnlyQueryStepInit",null,[]);class Qb extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){Jb=this.Ab.query.Et(cb,Jb);cb=cb.clone();N.Annotations.gI(this.Ab.query.Z4)?
Array.addRange(cb.items,Jb.items):Array.add(cb.items,Jb);return cb}}Object(l.a)(Qb,"AppendAnnotationQueryStep",Ib,[]);class Ac extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){if(this.UD===N.Annotations.pV)return this.iLc(cb,Jb);const ac=new nb.a(this.Ab.annotations,N.Annotations.pV);for(const Ec of cb.items)Array.add(ac.items,this.iLc(Ec,Jb));return ac}iLc(cb,Jb){const ac=new P.a(this.Ab.annotations);ac.i_a(cb);cb=new P.a(this.Ab.annotations);this.Ab.script.hOa(null,new la("Input",ac,new la("Output",
cb,Jb)));return cb}}Object(l.a)(Ac,"ApplyAnnotationQueryStep",Ib,[]);class Db extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){if(this.UD===N.Annotations.pV)return Jb=this.iLc(cb,Jb),Jb.Hq(this.Ab.Irh).returnValue||new nb.a(this.Ab.annotations,N.Annotations.pV),Jb;const ac=new nb.a(this.Ab.annotations,N.Annotations.pV);for(const Ec of cb.items)if(cb=this.iLc(Ec,Jb),({value:cb}=cb.Hq(this.Ab.Irh)).returnValue)for(const Lc of cb.items)Array.add(ac.items,Lc);return ac}iLc(cb,Jb){const ac=new P.a(this.Ab.annotations);
ac.i_a(cb);cb=new P.a(this.Ab.annotations);this.Ab.script.hOa(null,new la("Input",ac,new la("Output",cb,Jb)));return cb}}Object(l.a)(Db,"ApplyExpandAnnotationQueryStep",Ib,[]);class dc{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.script=Jb.DDb(cb.J(0)),this.Irh=cb.J(1))}}Object(l.a)(dc,"ApplyExpandQueryStepInit",null,[]);class Pb{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.script=Jb.DDb(cb.J(0)))}}Object(l.a)(Pb,"ApplyQueryStepInit",null,[]);class Ub extends Ib{constructor(cb){super();
this.Ab=cb}load(cb){if(this.UD===N.Annotations.pV)return this.$1d(cb);const Jb=new nb.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.Sta));for(const ac of cb.items)Array.add(Jb.items,this.$1d(ac));return Jb}store(cb,Jb,ac,Ec){if(this.UD===N.Annotations.pV){var Lc=Jb,kd=({QHa:Ec}=this.m1a(Ec)).returnValue;kd&&(Lc=kd.store(N.Annotations.oT(this.$1d(cb)),Jb,ac,Ec));cb.Fy(this.Ab.Sta,Lc)}else{var Vd=Jb;if(Lc=({QHa:Ec}=this.m1a(Ec)).returnValue){Vd=new nb.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.Sta));
for(kd of cb.items)Array.add(Vd.items,this.$1d(kd));Vd=Lc.store(Vd,Jb,ac,Ec)}Jb=Vd;if(Jb.items.length!==cb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let se=0,He=cb.items.length;se<He;++se)ac=cb.items[se],ac.isReadOnly&&(ac=ac.clone(),cb.items[se]=ac),ac.Fy(this.Ab.Sta,Jb.items[se])}return cb}$1d(cb){({value:cb}=cb.Hq(this.Ab.Sta)).returnValue||(cb=this.Ab.annotations.tMl(this.Ab.Sta));return cb}}Object(l.a)(Ub,"AttrAnnotationQueryStep",Ib,
[]);class rb{constructor(cb,Jb){cb&&(this.annotations=Jb,this.Sta=cb.J(0))}}Object(l.a)(rb,"AttrQueryStepInit",null,[]);class Yb extends Ib{constructor(cb){super();this.Ab=cb}load(cb){const Jb=new P.a(this.Ab.annotations);Jb.i_a(cb);return this.Ab.module.execute(Jb)}}Object(l.a)(Yb,"CallModuleAnnotationQueryStep",Ib,[]);class Ya{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.module=Jb.Jrf(cb.J(0)))}}Object(l.a)(Ya,"CallModuleQueryStepInit",null,[]);class Ob extends Ib{constructor(cb){super();
this.Ab=cb}load(cb,Jb){if(N.Annotations.gI(this.UD)){var ac=this.Ab.query.Et(cb,Jb);Jb=new nb.a(this.Ab.annotations,N.Annotations.g$);let kd="string"===typeof ac;for(var Ec of cb.items)if(kd)Array.add(Jb.items,Ec+ac);else for(var Lc of ac.items)Array.add(Jb.items,Ec+Lc);return Jb}Ec=this.Ab.query.Et(cb,Jb);if("string"===typeof Ec)return cb+Ec;Lc=new nb.a(this.Ab.annotations,N.Annotations.g$);for(ac of Ec.items)Array.add(Lc.items,cb+ac);return Lc}}Object(l.a)(Ob,"ConcatAnnotationQueryStep",Ib,[]);
class vc extends Ib{constructor(cb){super();this.Ab=cb}load(cb){return eb.YEh(this.Ab.annotations,cb,this.UD,this.Z4)}}Object(l.a)(vc,"ConvertAnnotationQueryStep",Ib,[]);class Sa extends Ib{constructor(){super()}load(cb){return cb.items.length}}Object(l.a)(Sa,"CountAnnotationQueryStep",Ib,[]);class Ab extends Xa{constructor(cb){super(cb)}W1b(cb,Jb){return cb/Jb}}Object(l.a)(Ab,"DivideAnnotationQueryStep",Xa,[]);class Fb extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){Jb=new la(this.Ab.soe,
null,Jb);for(const ac of cb.items)if(Jb.l6e(ac),this.Ab.query.Et(ac,Jb))return!0;return!1}}Object(l.a)(Fb,"ExistsAnnotationQueryStep",Ib,[]);class Va extends Xa{constructor(cb){super(cb)}W1b(cb,Jb){return Math.pow(cb,Jb)}}Object(l.a)(Va,"ExpAnnotationQueryStep",Xa,[]);class Wa{constructor(cb,Jb){cb&&(this.pOa=Jb.QD(cb.J(0)))}}Object(l.a)(Wa,"FeatureBundleNameQueryStepInit",null,[]);class jb extends Ib{constructor(cb){super();this.Ab=cb}load(cb){if(N.Annotations.gI(this.UD)){const Jb=new nb.a(this.Ab.annotations,
this.Ab.annotations.fFb(N.Annotations.h1a(this.UD),this.Ab.rOa));for(const ac of cb.items)Array.add(Jb.items,ac.shb(this.Ab.rOa));return Jb}return cb.shb(this.Ab.rOa)}store(cb,Jb,ac,Ec){if(N.Annotations.gI(this.UD)){var Lc=Jb,kd=({QHa:Ec}=this.m1a(Ec)).returnValue;if(kd){Lc=new nb.a(this.Ab.annotations,this.Ab.annotations.fFb(N.Annotations.h1a(this.UD),this.Ab.rOa));for(var Vd of cb.items)Array.add(Lc.items,Vd.shb(this.Ab.rOa));Lc=kd.store(Lc,Jb,ac,Ec)}Jb=Lc;if(Jb.items.length!==cb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let se=0,He=cb.items.length;se<He;++se)ac=cb.items[se],ac.isReadOnly&&(ac=ac.clone(),cb.items[se]=ac),ac.hag(this.Ab.rOa,Jb.items[se])}else kd=Jb,(Vd=({QHa:Ec}=this.m1a(Ec)).returnValue)&&(kd=Vd.store(N.Annotations.oT(cb.shb(this.Ab.rOa)),Jb,ac,Ec)),cb.hag(this.Ab.rOa,kd);return cb}}Object(l.a)(jb,"FieldAnnotationQueryStep",Ib,[]);class mc{constructor(cb,Jb){cb&&(this.annotations=Jb,this.rOa=cb.J(0))}}Object(l.a)(mc,"FieldQueryStepInit",null,[]);class yb extends Ib{constructor(cb){super();this.Ab=
cb}load(cb,Jb){for(const ac of cb.items)if(this.Ab.filter.isMatch(ac,Jb))return ac;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(cb,Jb,ac,Ec){let Lc=Jb,kd=-1;for(let se=0,He=cb.items.length;se<He;se++)if(this.Ab.filter.isMatch(cb.items[se],ac)){kd=se;break}if(0>kd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Vd=({QHa:Ec}=this.m1a(Ec)).returnValue;Vd&&(Lc=Vd.store(N.Annotations.oT(cb.items[kd]),Jb,ac,Ec));
cb.items[kd]=Lc;return cb}}Object(l.a)(yb,"FirstItemMatchingAnnotationQueryStep",Ib,[]);class Oa extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){Jb=new la(this.Ab.soe,null,Jb);for(const ac of cb.items)if(Jb.l6e(ac),!this.Ab.query.Et(ac,Jb))return!1;return!0}}Object(l.a)(Oa,"ForAllAnnotationQueryStep",Ib,[]);class Gb extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){cb=Jb?Jb.WOd(this.Ab.pOa):null;if(!cb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.pOa+
'"');return cb}store(cb,Jb,ac,Ec){cb=ac?ac.WOd(this.Ab.pOa):null;if(!cb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.pOa+'"');let Lc=Jb;const kd=({QHa:Ec}=this.m1a(Ec)).returnValue;kd&&(Lc=kd.store(cb,Jb,ac,Ec));cb!==Lc&&cb.i_a(Lc);return cb}}Object(l.a)(Gb,"GetAnnotationQueryStep",Ib,[]);class Wb{constructor(cb,Jb){this.b_j=cb;this.$ek=Jb}get jIh(){return this.b_j}get D2i(){return this.$ek}}Object(l.a)(Wb,"AnnotationQueryStoreContinuation",null,[1609]);class kc extends Ib{constructor(cb){super();
this.Ab=cb}load(cb,Jb){return this.Ab.cle.Et(cb,Jb)?this.Ab.oBj.Et(cb,Jb):this.Ab.mLd?this.Ab.mLd.Et(cb,Jb):cb}store(cb,Jb,ac,Ec){var Lc=this.Ab.cle.Et(cb,ac);this.next&&(Ec=new Wb(this.next,Ec));if(Lc)return this.Ab.oBj.kkc(cb,Jb,ac,Ec);if(this.Ab.mLd)return this.Ab.mLd.kkc(cb,Jb,ac,Ec);Lc=Jb;let kd=null;Ec&&(kd=Ec.jIh,Ec=Ec.D2i);kd&&(Lc=kd.store(N.Annotations.oT(cb),Jb,ac,Ec));return Lc}}Object(l.a)(kc,"IfAnnotationQueryStep",Ib,[]);class Mb{constructor(cb,Jb){cb&&(this.cle=Jb.UK(cb.J(0)),this.oBj=
Jb.UK(cb.J(1)),this.mLd=cb.J(2)?Jb.UK(cb.J(2)):null)}}Object(l.a)(Mb,"IfQueryStepInit",null,[]);class Qc{constructor(cb,Jb){cb&&(this.Xvm=Jb.UK(cb.J(0)),this.sDi=Jb.UK(cb.J(1)))}}Object(l.a)(Qc,"IndexAndItemQueryStepInit",null,[]);class Ic extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){const ac=this.Ab.Xvm.Et(cb,Jb);Jb=this.Ab.sDi.Et(cb,Jb);cb=cb.clone();if(0>ac||ac>cb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(N.Annotations.gI(this.Ab.sDi.Z4))for(let Ec=
0;Ec<Jb.items.length;++Ec)Array.insert(cb.items,ac+Ec,Jb.items[Ec]);else Array.insert(cb.items,ac,Jb);return cb}}Object(l.a)(Ic,"InsertAtAnnotationQueryStep",Ib,[]);class Ed extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){return!(!Jb||!Jb.WOd(this.Ab.pOa))}}Object(l.a)(Ed,"IsDefinedAnnotationQueryStep",Ib,[]);class me extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){Jb=this.kJ(cb,Jb);return cb.items[Jb]}store(cb,Jb,ac,Ec){const Lc=this.kJ(cb,ac);let kd=Jb;const Vd=({QHa:Ec}=this.m1a(Ec)).returnValue;
Vd&&(kd=Vd.store(N.Annotations.oT(cb.items[Lc]),Jb,ac,Ec));cb.items[Lc]=kd;return cb}kJ(cb,Jb){Jb=this.Ab.query.Et(cb,Jb);if(0>Jb||Jb>=cb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Jb}}Object(l.a)(me,"ItemAnnotationQueryStep",Ib,[]);class Be extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){const ac=new nb.a(this.Ab.annotations,N.Annotations.h1a(this.UD));for(const Ec of cb.items)this.Ab.filter.isMatch(Ec,Jb)&&Array.add(ac.items,Ec);return ac}}
Object(l.a)(Be,"ItemsMatchingAnnotationQueryStep",Ib,[]);class ad extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){Jb=this.kJ(cb,Jb);return cb.items[cb.items.length-Jb-1]}store(cb,Jb,ac,Ec){const Lc=this.kJ(cb,ac);let kd=Jb;const Vd=({QHa:Ec}=this.m1a(Ec)).returnValue;Vd&&(kd=Vd.store(N.Annotations.oT(cb.items[cb.items.length-Lc-1]),Jb,ac,Ec));cb.items[cb.items.length-Lc-1]=kd;return cb}kJ(cb,Jb){Jb=this.Ab.query?this.Ab.query.Et(cb,Jb):0;if(0>Jb||Jb>=cb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Jb}}Object(l.a)(ad,"LastItemAnnotationQueryStep",Ib,[]);class Nc extends Ib{constructor(cb){super();this.Ab=cb}load(cb){if(N.Annotations.gI(this.UD)){const Jb=new nb.a(this.Ab.annotations,N.Annotations.xIa);for(const ac of cb.items)Array.add(Jb.items,ac.length);return Jb}return cb.length}}Object(l.a)(Nc,"LengthAnnotationQueryStep",Ib,[]);class Sc extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){if(N.Annotations.gI(this.UD)){const ac=new nb.a(this.Ab.annotations,N.Annotations.$ya);
for(const Ec of cb.items)Array.add(ac.items,this.Ab.filter.isMatch(Ec,Jb));return ac}return this.Ab.filter.isMatch(cb,Jb)}}Object(l.a)(Sc,"MatchesAnnotationQueryStep",Ib,[]);class Gc extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){return this.Ab.filter.isMatch(cb,Jb)}}Object(l.a)(Gc,"MatchesAsListAnnotationQueryStep",Ib,[]);class ie extends Xa{constructor(cb){super(cb)}W1b(cb,Jb){return cb%Jb}}Object(l.a)(ie,"ModuloAnnotationQueryStep",Xa,[]);class cf extends Xa{constructor(cb){super(cb)}W1b(cb,
Jb){return cb*Jb}}Object(l.a)(cf,"MultiplyAnnotationQueryStep",Xa,[]);class Ge extends Ib{constructor(cb){super();this.Ab=cb}load(cb){if(N.Annotations.gI(this.UD)){const Jb=new nb.a(this.Ab.annotations,N.Annotations.$ya);for(const ac of cb.items)Array.add(Jb.items,!ac);return Jb}return!cb}}Object(l.a)(Ge,"NotAnnotationQueryStep",Ib,[]);class gf extends gb{constructor(cb){super(cb)}xAh(cb){return{returnValue:cb,result:!0}}dHc(cb,Jb){return cb||Jb}}Object(l.a)(gf,"OrAnnotationQueryStep",gb,[]);class Ie extends Ib{constructor(cb){super();
this.Ab=cb}load(cb,Jb){const ac=this.Ab.Ufg.Et(cb,Jb);cb=this.Ab.PHc.Et(cb,Jb);Jb=new nb.a(this.Ab.annotations,N.Annotations.xIa);for(let Ec=0;Ec<cb;++Ec)Array.add(Jb.items,ac+Ec);return Jb}}Object(l.a)(Ie,"RangeAnnotationQueryStep",Ib,[]);class zf{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.filter=Jb.zna(cb.J(0)))}}Object(l.a)(zf,"SingleFilterQueryStepInit",null,[]);class uc{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.query=cb.J(0)?Jb.UK(cb.J(0)):null)}}Object(l.a)(uc,
"SingleOptionalQueryQueryStepInit",null,[]);class Rc{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.query=Jb.UK(cb.J(0)))}}Object(l.a)(Rc,"SingleQueryQueryStepInit",null,[]);class Dd{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.Ufg=Jb.UK(cb.J(0)),this.PHc=cb.J(1)?Jb.UK(cb.J(1)):null)}}Object(l.a)(Dd,"StartAndCountOrLengthQueryStepInit",null,[]);class Id extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){let ac;({startIndex:Jb,length:ac}=this.RRd(cb,Jb));const Ec=
new nb.a(this.Ab.annotations,cb.x4);for(let Lc=0;Lc<ac;++Lc)Array.add(Ec.items,cb.items[Jb+Lc]);return Ec}store(cb,Jb,ac,Ec){let Lc,kd;({startIndex:Lc,length:kd}=this.RRd(cb,ac));var Vd=Jb;const se=({QHa:Ec}=this.m1a(Ec)).returnValue;if(se){Vd=new nb.a(this.Ab.annotations,cb.x4);for(let He=0;He<kd;++He)Array.add(Vd.items,cb.items[Lc+He]);Vd=se.store(Vd,Jb,ac,Ec)}Jb=Vd;for(ac=0;ac<kd;++ac)Array.removeAt(cb.items,Lc);for(let He=0,wf=Jb.items.length;He<wf;++He)Array.insert(cb.items,Lc+He,Jb.items[He]);
return cb}RRd(cb,Jb){let ac;ac=this.Ab.Ufg.Et(cb,Jb);if(0>ac)throw Error.invalidOperation("Invalid start index in Sublist() query step");Jb=this.Ab.PHc?this.Ab.PHc.Et(cb,Jb):cb.items.length-ac;if(0>Jb||ac+Jb>cb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:ac,length:Jb}}}Object(l.a)(Id,"SublistAnnotationQueryStep",Ib,[]);class Kd extends Ib{constructor(cb){super();this.Ab=cb}load(cb,Jb){if(N.Annotations.gI(this.UD)){const ac=
new nb.a(this.Ab.annotations,N.Annotations.g$);for(let Ec=0,Lc=cb.items.length;Ec<Lc;++Ec)Array.add(ac.items,this.Hgi(cb.items[Ec],Jb));return ac}return this.Hgi(cb,Jb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}Hgi(cb,Jb){let ac;({startIndex:Jb,length:ac}=this.RRd(cb,Jb));return cb.substr(Jb,ac)}RRd(cb,Jb){let ac;ac=this.Ab.Ufg.Et(cb,Jb);if(0>ac)throw Error.invalidOperation("Invalid start index in Substring() query step");Jb=this.Ab.PHc?this.Ab.PHc.Et(cb,
Jb):cb.length-ac;if(0>Jb||ac+Jb>cb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:ac,length:Jb}}}Object(l.a)(Kd,"SubstringAnnotationQueryStep",Ib,[]);class af extends Xa{constructor(cb){super(cb)}W1b(cb,Jb){return cb-Jb}}Object(l.a)(af,"SubtractAnnotationQueryStep",Xa,[]);class Dg extends Ib{constructor(cb){super();this.Ab=cb}load(cb){const Jb=new nb.a(this.Ab.annotations,N.Annotations.g$);for(let ac=0;ac<cb.length;++ac)Array.add(Jb.items,
cb.charAt(ac).toString());return Jb}}Object(l.a)(Dg,"ToCharListAnnotationQueryStep",Ib,[]);class oi extends Ib{constructor(cb){super();this.Ab=cb}load(cb){const Jb=new nb.a(this.Ab.annotations,this.UD);Array.add(Jb.items,cb);return Jb}}Object(l.a)(oi,"ToListAnnotationQueryStep",Ib,[]);class zg extends Ib{constructor(cb){super();this.Ab=cb}load(){return this.Ab.value}}Object(l.a)(zg,"ValueAnnotationQueryStep",Ib,[]);class ec{constructor(cb,Jb){if(cb){var ac=cb.J(0),Ec=1;this.value=({Xga:Ec}=Jb.QNa(ac,
cb,Ec,null,null,null)).returnValue;N.Annotations.ZIb(this.value)}}}Object(l.a)(ec,"ValueQueryStepInit",null,[]);class Bc{constructor(cb,Jb){cb&&(this.soe=Jb.QD(cb.J(0)),this.query=Jb.UK(cb.J(1)))}}Object(l.a)(Bc,"VarNameAndQueryQueryStepInit",null,[]);class Vc{constructor(cb,Jb){this.dVg=null;if(cb){this.annotations=Jb.annotations;var ac=0;this.UD=cb.J(ac);++ac;this.Z4=cb.J(ac);++ac;this.kke=1===cb.J(ac);++ac;this.TXd=1===cb.J(ac);++ac;var Ec=cb.J(ac);++ac;if(Ec){var Lc=ac,kd=ac+Ec,Vd=ac+2*Ec;ac+=
3*Ec;var se=cb.count-ac,He=null;for(let fc=0;fc<Ec;++fc){var wf=ac+cb.J(Vd+fc);const hf=(fc===Ec-1?se:cb.J(Vd+fc+1))-cb.J(Vd+fc),Fk=new cc.a;Fk.Rgb(cb,wf,hf);wf=Vc.A3l(cb.J(kd+fc),Fk,Jb);wf.UD=cb.J(Lc+fc);wf.Z4=fc===Ec-1?this.Z4:cb.J(Lc+fc+1);He?He.next=wf:this.dVg=wf;He=wf}}}}get F_h(){return this.dVg}static A3l(cb,Jb,ac){switch(cb){case 1:return new Gb(new Wa(Jb,ac));case 2:return new Ed(new Wa(Jb,ac));case 3:return new Ub(new rb(Jb,ac.annotations));case 4:return new jb(new mc(Jb,ac.annotations));
case 5:return new kc(new Mb(Jb,ac));case 6:return new Sc(new zf(Jb,ac));case 43:return new Gc(new zf(Jb,ac));case 45:return new Ac(new Pb(Jb,ac));case 49:return new Db(new dc(Jb,ac));case 46:return new zg(new ec(Jb,ac.annotations));case 51:return new Yb(new Ya(Jb,ac));case 52:return new Ie(new Dd(Jb,ac));case 53:return new vc(new $b(ac.annotations));case 13:return new me(new Rc(Jb,ac));case 14:return new ad(new uc(Jb,ac));case 15:return new Sa;case 18:return new yb(new zf(Jb,ac));case 16:return new Oa(new Bc(Jb,
ac));case 17:return new Fb(new Bc(Jb,ac));case 22:return new Ic(new Qc(Jb,ac));case 24:return new Qb(new Rc(Jb,ac));case 26:return new Id(new Dd(Jb,ac));case 27:return new Be(new zf(Jb,ac));case 30:return new oi(new $b(ac.annotations));case 31:return new Kd(new Dd(Jb,ac));case 32:return new Ob(new Rc(Jb,ac));case 47:return new Nc(new $b(ac.annotations));case 48:return new Dg(new $b(ac.annotations));case 34:return new Ra(new Rc(Jb,ac));case 35:return new af(new Rc(Jb,ac));case 36:return new cf(new Rc(Jb,
ac));case 37:return new Ab(new Rc(Jb,ac));case 38:return new ie(new Rc(Jb,ac));case 39:return new Va(new Rc(Jb,ac));case 40:return new Bb(new Rc(Jb,ac));case 41:return new gf(new Rc(Jb,ac));case 42:return new Ge(new $b(ac.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(Vc,"AnnotationQueryInit",null,[]);class xd{constructor(cb){this.Ab=cb}execute(cb,Jb){this.hOa(cb,cb?new la("root",cb,Jb):Jb)}hOa(cb,Jb){for(const ac of this.Ab.commands)Jb=ac.execute(cb,Jb)}}Object(l.a)(xd,
"AnnotationScript",null,[1584]);class ee{constructor(cb){this.Ab=cb}execute(cb,Jb){const ac=this.Ab.aAm.Et(cb,Jb),Ec=this.Ab.hxn.Et(cb,Jb);this.Ab.script.hOa(cb,new la("Input",ac,new la("Output",Ec,Jb)));return Jb}}Object(l.a)(ee,"ApplyAnnotationScriptCommand",null,[1598]);class Me{constructor(cb,Jb){cb&&(this.aAm=Jb.UK(cb.J(0)),this.hxn=Jb.UK(cb.J(1)),this.script=Jb.DDb(cb.J(2)))}}Object(l.a)(Me,"ApplyScriptCommandInit",null,[]);class De{constructor(cb){this.Ab=cb}execute(cb,Jb){const ac=this.Ab.F8f.Et(cb,
Jb);this.Ab.U2d.kkc(cb,ac,Jb,null);return Jb}}Object(l.a)(De,"AssignAnnotationScriptCommand",null,[1598]);class oe{constructor(cb){this.Ab=cb}execute(cb,Jb){const ac=this.Ab.U2d.Et(cb,Jb);cb=this.Ab.F8f.Et(cb,Jb);ac!==cb&&ac.i_a(cb);return Jb}}Object(l.a)(oe,"CopyAnnotationScriptCommand",null,[1598]);class nf{constructor(cb){this.Ab=cb}execute(cb,Jb){let ac=this.Ab.uJf.Et(cb,Jb);if(this.Ab.uJf.kke){ac=N.Annotations.oT(ac);var Ec=new la(this.Ab.pOa,null,Jb);for(let kd=0,Vd=ac.items.length;kd<Vd;++kd){var Lc=
this.jXh(cb,ac.items[kd],Ec);if(0>this.Ab.Xde)ac.items[kd]=Lc;else if(({value:Lc}=Lc.Hq(this.Ab.Xde)).returnValue)ac.items[kd]=Lc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ab.uJf.kkc(cb,ac,Jb,null)}else{Ec=new la(this.Ab.pOa,null,Jb);for(let kd=0,Vd=ac.items.length;kd<Vd;++kd)this.jXh(cb,ac.items[kd],Ec)}return Jb}jXh(cb,Jb,ac){let Ec;0>this.Ab.Xde?Ec=N.Annotations.oT(Jb):(Ec=new P.a(this.Ab.annotations),Ec.Fy(this.Ab.Xde,Jb));ac.l6e(Ec);
this.Ab.lKk.hOa(cb,ac);return Ec}}Object(l.a)(nf,"EnumerateAnnotationScriptCommand",null,[1598]);class Qe{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.pOa=Jb.QD(cb.J(0)),this.uJf=Jb.UK(cb.J(1)),this.lKk=Jb.DDb(cb.J(2)),this.Xde=cb.J(3))}}Object(l.a)(Qe,"EnumerateScriptCommandInit",null,[]);class of{constructor(cb){this.Ab=cb}execute(cb,Jb){this.Ab.cle.Et(cb,Jb)?this.Ab.EMo.hOa(cb,Jb):this.Ab.mYh&&this.Ab.mYh.hOa(cb,Jb);return Jb}}Object(l.a)(of,"IfAnnotationScriptCommand",null,[1598]);
class mf{constructor(cb,Jb){cb&&(this.cle=Jb.UK(cb.J(0)),this.EMo=Jb.DDb(cb.J(1)),this.mYh=cb.J(2)?Jb.DDb(cb.J(2)):null)}}Object(l.a)(mf,"IfScriptCommandInit",null,[]);class jg{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.U2d=Jb.UK(cb.J(0)),this.F8f=Jb.UK(cb.J(1)))}}Object(l.a)(jg,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class pf{constructor(cb){this.Ab=cb}execute(cb,Jb){const ac=this.Ab.F8f.Et(this.Ab.U2d.Et(cb,Jb),Jb);this.Ab.U2d.kkc(cb,ac,Jb,null);return Jb}}Object(l.a)(pf,
"ModifyAnnotationScriptCommand",null,[1598]);class xb{constructor(cb){this.Ab=cb}execute(cb,Jb){const ac=new P.a(this.Ab.annotations);this.Ab.query&&ac.i_a(this.Ab.query.Et(cb,Jb));return Jb=new la(this.Ab.pOa,ac,Jb)}}Object(l.a)(xb,"NewAnnotationScriptCommand",null,[1598]);class Tb{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.pOa=Jb.QD(cb.J(0)),this.query=cb.J(1)?Jb.UK(cb.J(1)):null)}}Object(l.a)(Tb,"NewScriptCommandInit",null,[]);class Xc{constructor(cb){this.Ab=cb}execute(cb,Jb){cb=
this.Ab.query.Et(cb,Jb);if(this.Ab.query.Z4===N.Annotations.pV)cb.qSa(this.Ab.Sta);else for(const ac of cb.items)ac.qSa(this.Ab.Sta);return Jb}}Object(l.a)(Xc,"RemoveAnnotationScriptCommand",null,[1598]);class Fd{constructor(cb,Jb){cb&&(this.annotations=Jb.annotations,this.query=Jb.UK(cb.J(0)),this.Sta=cb.J(1))}}Object(l.a)(Fd,"RemoveScriptCommandInit",null,[]);class Se{constructor(cb,Jb){if(cb){var ac=0,Ec=cb.J(ac);++ac;if(Ec){var Lc=ac,kd=ac+Ec;ac+=2*Ec;var Vd=cb.count-ac;this.commands=Array(Ec);
for(let se=0;se<Ec;++se){const He=ac+cb.J(kd+se),wf=(se===Ec-1?Vd:cb.J(kd+se+1))-cb.J(kd+se),fc=new cc.a;fc.Rgb(cb,He,wf);this.commands[se]=Se.q3l(cb.J(Lc+se),fc,Jb)}}}}static q3l(cb,Jb,ac){switch(cb){case 1:return new De(new jg(Jb,ac));case 2:return new pf(new jg(Jb,ac));case 3:return new Xc(new Fd(Jb,ac));case 6:return new xb(new Tb(Jb,ac));case 7:return new nf(new Qe(Jb,ac));case 8:return new of(new mf(Jb,ac));case 9:return new oe(new jg(Jb,ac));case 10:return new ee(new Me(Jb,ac));default:throw Error.argument("initData");
}}}Object(l.a)(Se,"AnnotationScriptInit",null,[]);var pd=c(1645);class lf{constructor(cb){this.G1=cb;this.Vx=0}C9(){const cb=this.G1.Dy(this.Vx,4);this.Vx+=4;return cb}get rfa(){return this.G1}get offset(){return this.Vx}set offset(cb){this.Vx=cb}}Object(l.a)(lf,"ByteArrayReader",null,[]);class Ze{constructor(){this.DJ=null;this.iLi=this.tca=0}J(cb){if(0>cb||cb>=this.tca)throw Error.argumentOutOfRange("index");return this.DJ.Dy(this.iLi+4*cb,4)}get count(){return this.tca}static l$k(cb,Jb,ac){const Ec=
new Ze;Ec.DJ=cb;Ec.iLi=Jb;Ec.tca=ac;return Ec}}Object(l.a)(Ze,"ReadOnlyListOverByteArray",null,[1577]);class Vg{constructor(cb,Jb){this.bLi=this.aLi=!1;this.tw=this.UQa=this.eLf=this.eLi=null;try{this.tw=Jb.annotations;const ac=Jb.dhb(cb.J(0)),Ec=new lf(ac);if(-914743053!==Ec.C9())throw Error.argument("Input does not represent a flat lexicon");this.aLi=1===Ec.C9();this.bLi=1===Ec.C9();const Lc=Ec.C9();Ec.offset+=Lc;const kd=Ec.C9();this.eLf=Vg.rzn(Ec,kd,this.tw);const Vd=Ec.C9();this.eLi=Vg.Izn(Ec,
Vd);const se=Ec.C9();this.UQa=new pd.a(Ec.rfa,Ec.offset);Ec.offset+=se}catch(ac){throw Error.argument("initData");}}get trie(){return this.UQa}nOl(cb){return"i"===cb&&this.bLi?"\u0130":cb.toUpperCase()}IBf(){return this.aLi}HLl(cb){let Jb;Jb=new nb.a(this.tw,N.Annotations.pV);if(1!==cb)if(0===cb)cb=new P.a(this.tw),Array.add(Jb.items,cb);else if(cb&1073741824){cb=this.eLi[cb&-1073741825];for(let Ec=0;Ec<cb.length;++Ec){var ac=cb[Ec];ac=0===ac?new P.a(this.tw):this.eLf[ac-2];Array.add(Jb.items,ac)}}else Array.add(Jb.items,
this.eLf[cb-2]);return{returnValue:!0,EYm:Jb}}static rzn(cb,Jb,ac){if(Jb%4)throw Error.argument("reader");const Ec=Ze.l$k(cb.rfa,cb.offset,Jb/4);cb.offset+=Jb;cb=[];for(Jb=0;Jb<Ec.count;){const Lc=({Xga:Jb}=ac.QNa(N.Annotations.pV,Ec,Jb,null,null,null)).returnValue;Array.add(cb,Lc)}return cb}static Izn(cb,Jb){Jb=cb.offset+Jb;const ac=[];for(;cb.offset<Jb;){const Ec=cb.C9(),Lc=Array(Ec);for(let kd=0;kd<Ec;++kd){const Vd=cb.C9();Lc[kd]=Vd}Array.add(ac,Lc)}return ac}}Object(l.a)(Vg,"RawFlatLexicon",
null,[1583]);var Pi=c(1632),Sh=c(1633);class wh{constructor(cb){if(null==cb)throw Error.argumentNull("base64String");const Jb=cb.length;if(Jb%4)throw Error.argument("base64String's length must be a multiple of 4");this.tca=.75*Jb;this.iJb=Array(Math.ceil(this.tca/4));cb.endsWith("==")?this.tca-=2:cb.endsWith("=")&&--this.tca;let ac=0;for(let Ec=0;Ec<Jb;Ec+=4){const Lc=wh.Mee[cb.charCodeAt(Ec)-43]<<18|wh.Mee[cb.charCodeAt(Ec+1)-43]<<12|wh.Mee[cb.charCodeAt(Ec+2)-43]<<6|wh.Mee[cb.charCodeAt(Ec+3)-43];
let kd=Lc>>16&255;this.iJb[Math.floor(ac/4)]|=kd<<ac%4*8;++ac;kd=Lc>>8&255;this.iJb[Math.floor(ac/4)]|=kd<<ac%4*8;++ac;kd=Lc&255;this.iJb[Math.floor(ac/4)]|=kd<<ac%4*8;++ac}}get length(){return this.tca}J(cb){if(0>cb||cb>=this.tca)throw Error.argumentOutOfRange("i");return this.A4h(cb)}Dy(cb,Jb){if(0>cb||0>Jb||cb+Jb>this.tca)throw Error.argument("Bad range");let ac=0;for(let Ec=0;Ec<Jb;++Ec)ac|=this.A4h(cb+Ec)<<8*Ec;return ac}ZOn(cb,Jb){let ac=0,Ec=0,Lc=Math.floor(cb/8);for(cb%=8;Ec<Jb;){const kd=
8-cb>Jb-Ec?Jb-Ec:8-cb,Vd=this.J(Lc);ac|=(Vd>>cb&~(255<<kd))<<Ec;Ec+=kd;++Lc;cb=0}return ac}A4h(cb){return this.iJb[Math.floor(cb/4)]>>cb%4*8&255}}wh.Mee=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(wh,"ByteArray",null,[]);class rm{constructor(cb,Jb,ac){this.YD=cb;this.m8m=Jb;this.p8m=ac;this.qLi=Array(cb.b?cb.b.length:
0);this.CLf=new Pi.a(new Sh.a(this.dhb(this.YD.s)));this.Z8=Array(cb.t.length);this.nD=new N.Annotations(this.bhb(0),this)}get annotations(){return this.nD}get Pql(){return this.YD.d}L2l(){if(!(""in this.YD.m))throw Error.argument("name","Unrecognized module");return this.Jrf(this.YD.m[""])}dhb(cb){if(0>cb||!this.YD.b||cb>=this.YD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.qLi[cb]||(this.qLi[cb]=new wh(this.YD.b[cb]))}QD(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.Z8[cb]){const Jb=this.bhb(cb).J(0);this.Z8[cb]=this.CLf.QD(Jb)}return this.Z8[cb]}n8b(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.Z8[cb]){var Jb=this.bhb(cb);const ac=this.QD(Jb.J(0));Jb=1===Jb.J(1);this.Z8[cb]=new RegExp(ac,Jb?"i":"")}return this.Z8[cb]}lam(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Jrf(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an NL module");return this.Z8[cb]||(this.Z8[cb]=this.p8m.f3l(this.bhb(cb),this))}UK(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.Z8[cb]||(this.Z8[cb]=new eb(new Vc(this.bhb(cb),this)))}DDb(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.Z8[cb]||(this.Z8[cb]=new xd(new Se(this.bhb(cb),this)))}zna(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a filter");return this.Z8[cb]||(this.Z8[cb]=
this.m8m.zna(this.bhb(cb),this))}w9l(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.Z8[cb]||(this.Z8[cb]=new Vg(this.bhb(cb),this))}bhb(cb){const Jb=this.YD.n[cb];cb=(cb<this.YD.t.length-1?this.YD.n[cb+1]:this.YD.n.length)-Jb;if(0>Jb||0>cb||Jb+cb>this.YD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Jb+","+cb+")");const ac=new cc.a;
ac.Vlf(this.YD.n,Jb,cb);return ac}}Object(l.a)(rm,"ObjectFetcher",null,[1548]);class xf{constructor(cb,Jb,ac){if(!cb)throw Error.argumentNull("prediction");if(!Jb)throw Error.argumentNull("fieldNames");if(!ac)throw Error.argumentNull("values");if(Jb.length!==ac.length)throw Error.argument("values","fieldNames and values do not have same length");this.Pek=cb;this.jJb=Jb;this.qYc=ac}get prediction(){return this.Pek}get MYh(){return this.jJb.length}Ipf(cb){return 0<=cb&&cb<this.jJb.length?this.jJb[cb]:
null}getValue(cb){return 0<=cb&&cb<this.qYc.length?this.qYc[cb]:null}}Object(l.a)(xf,"PredictionData",null,[]);class lg{constructor(cb,Jb){if(!cb)throw Error.argumentNull("predictions");if(!Jb)throw Error.argumentNull("tokenAttributes");this.s8m=cb;this.w8m=Jb}Qsf(){return this.s8m}s3h(){return this.w8m}}Object(l.a)(lg,"PredictionDataWithTokenAttributes",null,[]);class nd{constructor(cb,Jb){this.prediction=null;this.score=0;this.prediction=cb;this.score=Jb}}Object(l.a)(nd,"PredictionWithScore",null,
[]);class ud{constructor(cb,Jb){if(!cb)throw Error.argumentNull("predictions");if(!Jb)throw Error.argumentNull("attributes");this.Qek=cb;this.jWj=Jb}Qsf(){return this.Qek}s3h(){return this.jWj}}Object(l.a)(ud,"PredictionsWithTokenAttributes",null,[]);class Bd{constructor(cb,Jb,ac){if(!cb)throw Error.argumentNull("attributeName");if(!Jb)throw Error.argumentNull("fieldNames");if(!ac)throw Error.argumentNull("values");if(Jb.length!==ac.length)throw Error.argument("values","fieldNames and values do not have same length");
this.iWj=cb;this.jJb=Jb;this.qYc=ac}get attributeName(){return this.iWj}get MYh(){return this.jJb.length}Ipf(cb){return 0<=cb&&cb<this.jJb.length?this.jJb[cb]:null}getValue(cb){return 0<=cb&&cb<this.qYc.length?this.qYc[cb]:null}}Object(l.a)(Bd,"TokenAttributes",null,[]);var kl=c(55),fi=c(129);class ji{constructor(cb,Jb,ac,Ec,Lc){this.ncd=0;this.Ppg=null;this.ocd=this.rnc=0;this.upe=this.uRb=this.ira=this.snc=null;this.Qpg=0;this.CKe=this.gC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.eS=cb;this.wLj=this.ALj=Jb;this.vLj=this.yLj=ac;this.lcd=this.xLj=Ec;this.mcd=this.zLj=Lc}BLj(){this.ocd=0;return this.Npg}Npg(){if(!(this.ocd<this.lcd))return this.Opg;this.snc=this.wLj.items[this.ocd+this.vLj];this.ira=new P.a(this.eS.Ab.annotations);1!==this.lcd&&this.eS.Ab.uTc||this.ira.i_a(this.snc);if(0<=this.eS.Ab.K4d){({value:this.uRb}=this.ira.Hq(this.eS.Ab.K4d)).returnValue?this.uRb=this.uRb.oT():this.uRb=new nb.a(this.eS.Ab.annotations,
N.Annotations.pV);this.upe=this.mcd.items;this.Qpg=this.upe.length;for(this.ncd=0;this.ncd<this.Qpg;++this.ncd)this.Ppg=this.upe[this.ncd],Array.add(this.uRb.items,this.Ppg);this.ira.Fy(this.eS.Ab.K4d,this.uRb)}else 0<=this.eS.Ab.Oeg?this.ira.Fy(this.eS.Ab.Oeg,this.mcd.items[0]):0<=this.eS.Ab.A3e?this.ira.Fy(this.eS.Ab.A3e,!0):this.eS.Ab.hzi?this.mcd.items[0].MMd((cb,Jb)=>this.ira.Fy(cb,Jb)):(this.ira.i_a(this.mcd.items[0]),1!==this.lcd&&this.eS.Ab.uTc||(({value:this.rnc}=this.snc.Hq(this.eS.Ab.h3)).returnValue&&
this.ira.Fy(this.eS.Ab.h3,this.rnc),({value:this.rnc}=this.snc.Hq(this.eS.Ab.s7)).returnValue&&this.ira.Fy(this.eS.Ab.s7,this.rnc),this.snc.Hq(this.eS.Ab.Ldb).returnValue&&this.ira.Fy(this.eS.Ab.Ldb,this.rnc)));this.gC=this.ira;this._state=2;return this.DLj}Opg(){this._state=3}CLj(){this.ocd++;return this.Npg}DLj(){return 1<this.lcd&&this.eS.Ab.uTc?this.Opg:this.CLj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new ji(this.eS,this.ALj,this.yLj,this.xLj,this.zLj)).getEnumerator()}[Symbol.iterator](){return Object(fi.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.CKe=this.BLj());for(;1===this._state;)this.CKe=this.CKe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.gC}}Object(l.a)(ji,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,74,81]);class wi{constructor(cb,Jb,ac){this.nYc=this.jLi=0;this.fdc=null;this.DLf=this.kLf=this.ddc=this.a3d=this.nLf=
0;this.b3d=!1;this.xLf=cb;this.FLf=Jb;this.r8m=ac}rbi(){null===this.fdc&&({byj:this.fdc,koi:this.nLf,length:this.a3d,Ryl:cb}=this.xLf.aii(this.FLf.items[this.nYc],this.r8m),this.b3d=cb||this.b3d);if(this.ddc<this.a3d){var cb=this.fdc.charAt(this.nLf+this.ddc);++this.ddc;return{returnValue:!0,ch:cb}}if(this.nYc===this.FLf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.nYc;this.ddc=0;this.fdc=null;return{returnValue:!0,ch:" "}}n4f(cb,Jb){this.ddc===this.a3d&&this.fdc&&(this.DLf=Jb,this.kLf=
this.nYc-this.jLi+1)}o5n(cb){if(0>cb||cb>=this.FLf.items.length)throw Error.argumentOutOfRange("iToken");this.nYc=this.jLi=cb;this.fdc=null;this.kLf=this.ddc=this.a3d=this.nLf=0;this.DLf=-1;this.b3d=!1}J1l(){return{gPk:this.kLf,TVm:this.DLf,Qyl:this.b3d}}}Object(l.a)(wi,"TriePrefixVisitor",null,[1590]);class xl{constructor(cb){this.Ab=cb}execute(cb){if(!({value:ac}=cb.Hq(this.Ab.UMa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Jb;({value:Jb}=cb.Hq(this.Ab.mZa)).returnValue||
(Jb=null);var ac=this.MKl(ac,Jb);cb=N.Annotations.oT(cb);cb.Fy(this.Ab.UMa,ac);return cb}MKl(cb,Jb){let ac=null;const Ec=this.Ab.flatLexicon.trie,Lc=new wi(this,cb,Jb);let kd=null;this.Ab.flatLexicon.IBf()&&(kd=Object(kl.a)(this.Ab.flatLexicon,this.Ab.flatLexicon.nOl,"getCaseInsensitiveForm"));let Vd=0,se;var He;let wf;for(;Vd<cb.items.length;){const fc=cb.items[Vd];Lc.o5n(Vd);Ec.zJj(Lc,kd);({gPk:se,TVm:He,Qyl:wf}=Lc.J1l());if(0<se){({EYm:He}=this.Ab.flatLexicon.HLl(He));for(let hf of this.kbl(cb,
Vd,se,He)){1<se&&this.Ab.uTc&&this.bcl(cb,Jb,Vd,fc,se,wf,hf);if(!ac)for(ac=new nb.a(this.Ab.annotations,N.Annotations.pV),He=0;He<Vd;++He)Array.add(ac.items,cb.items[He]);Array.add(ac.items,hf)}Vd+=se}else ac&&Array.add(ac.items,fc),++Vd}return ac||cb}bcl(cb,Jb,ac,Ec,Lc,kd,Vd){if(kd)kd=!0;else if(this.Ab.Syi){kd=!1;var se=-1;for(var He=0;He<Lc;He++){var wf=cb.items[ac+He];let Mh;var fc=void 0;if(!({value:Mh}=wf.Hq(this.Ab.h3)).returnValue||!({value:fc}=wf.Hq(this.Ab.s7)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<He){if(Mh>se+1){kd=!0;break}if(0>se||null===Jb||se>=Jb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Jb.charAt(se)){kd=!0;break}}se=Mh+fc}}else kd=!1;if(kd){fc=new Sys.StringBuilder;for(kd=0;kd<Lc;++kd)({byj:se,koi:He,length:wf}=this.aii(cb.items[ac+kd],Jb)),0<kd&&fc.append(" "),fc.append(se.substr(He,wf));Vd.Fy(this.Ab.Ldb,fc.toString())}cb=cb.items[ac+Lc-1];let hf,Fk;({value:Ec}=Ec.Hq(this.Ab.h3)).returnValue&&
({value:hf}=cb.Hq(this.Ab.h3)).returnValue&&({value:Fk}=cb.Hq(this.Ab.s7)).returnValue?(Vd.Fy(this.Ab.h3,Ec),Vd.Fy(this.Ab.s7,hf+Fk-Ec)):(Vd.qSa(this.Ab.h3),Vd.qSa(this.Ab.s7))}kbl(cb,Jb,ac,Ec){return new ji(this,cb,Jb,ac,Ec)}aii(cb,Jb){let ac,Ec;if(({value:ac}=cb.Hq(this.Ab.Ldb)).returnValue)Ec=!0,Jb=0,cb=ac.length;else{Ec=!1;if(null===Jb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");ac=Jb;if(!({value:Jb}=cb.Hq(this.Ab.h3)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:cb}=cb.Hq(this.Ab.s7)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Jb||0>cb||Jb+cb>ac.length)throw Error.argument("Token start/length values out of range","token");}return{byj:ac,koi:Jb,length:cb,Ryl:Ec}}}Object(l.a)(xl,"FlatLexiconNLModule",null,[1578]);class Fl{constructor(cb,Jb){this.A3e=this.K4d=this.Oeg=this.Ldb=this.s7=this.h3=this.mZa=this.UMa=0;this.hzi=this.Syi=this.uTc=!1;this.flatLexicon=null;this.annotations=Jb.annotations;
let ac=0;try{this.UMa=cb.J(ac),++ac,this.mZa=cb.J(ac),++ac,this.h3=cb.J(ac),++ac,this.s7=cb.J(ac),++ac,this.Ldb=cb.J(ac),++ac,this.Oeg=cb.J(ac),++ac,this.K4d=cb.J(ac),++ac,this.A3e=cb.J(ac),++ac,this.uTc=1===cb.J(ac),++ac,this.Syi=1===cb.J(ac),++ac,this.hzi=1===cb.J(ac),++ac,this.flatLexicon=Jb.w9l(cb.J(ac))}catch(Ec){throw Error.argument("initData");}}}Object(l.a)(Fl,"FlatLexiconNLModuleInit",null,[]);class di{constructor(){this.sRc=0;this.Ljf=null;this.S5c=0}}Object(l.a)(di,"FeatureGenStackRec",
null,[]);class Xi{constructor(cb){this.Bjg=Array(cb);this.wlc=Array(cb);this.ngg=[];this.Fvj=[]}}Object(l.a)(Xi,"TokenStringLattice",null,[]);const Yi=(cb,Jb,ac)=>{for(let Ec=0;Ec<cb.length;Ec++)ac=Jb(ac,cb[Ec]);return ac},sm=(cb,Jb)=>{const ac=Array(cb.length);for(let Ec=0;Ec<cb.length;Ec++)ac[Ec]=Jb(cb[Ec]);return ac},Fg=(cb,Jb)=>{Jb=Array(Math.min(Jb,cb.length));for(let ac=0;ac<Jb.length;ac++)Jb[ac]=cb[ac];return Jb},$f=(cb,Jb)=>{const ac=[];for(const Ec of cb)Jb(Ec)&&Array.add(ac,Ec);return ac};
class Qi{constructor(cb,Jb){this.key=cb;this.value=Jb}}Object(l.a)(Qi,"KeyValuePair",null,[]);const em=(cb,Jb)=>({returnValue:Jb in cb,value:cb[Jb]}),Zi=cb=>{const Jb=[];for(let ac in cb){const Ec=new Qi(ac,cb[ac]);Array.add(Jb,Ec)}return Jb};class Tg{constructor(cb){this.$hi=this.Efm;this.Ab=cb;this.e3d=this.uLf=this.vLf=0;for(const Jb of this.Ab.tLd)this.vLf=Math.max(this.vLf,Jb.RZf),this.uLf=Math.max(this.uLf,Jb.MZf),this.e3d=Math.max(this.e3d,Jb.Wob.length)}get fBl(){return this.Ab.Nle.trie}execute(cb){if(!cb)throw Error.argumentNull("input");
let Jb,ac;({tokens:Jb,aXm:ac}=this.Ffm(cb));let Ec=null,Lc=null,kd={};if(this.Ab.bUc){Jb=N.Annotations.oT(Jb);for(var Vd=0;Vd<Jb.items.length;++Vd)Jb.items[Vd]=N.Annotations.oT(Jb.items[Vd])}else({uYh:Lc,returnValue:Ec}=this.mci(cb,kd));Vd=Array(this.e3d);const se=Array(this.e3d);for(var He=0;He<se.length;++He)se[He]=new di;for(He=-this.vLf;He<Jb.items.length+this.uLf;++He){let wf=null;this.Ab.bUc&&(wf=Jb.items[He],kd={},{uYh:Lc,returnValue:Ec}=this.mci(wf,kd));for(const fc of this.Ab.tLd){if(0>He&&
-He>fc.RZf||He>=Jb.items.length&&He-Jb.items.length+1>fc.MZf)continue;let hf=!0;for(let Fk=0;Fk<fc.Wob.length;++Fk){const Mh=He+fc.Wob[Fk];Vd[Fk]=Mh;if(0>Mh?0>this.Ab.SZf:Mh>=Jb.items.length?0>this.Ab.NZf:!ac.wlc[Mh]){hf=!1;break}}hf&&({wfl:Ec,xfl:Lc}=this.zCm(fc,ac,Ec,Lc,kd,se,Vd))}this.Ab.bUc&&(wf.Fy(this.Ab.S2a?this.Ab.i1b:this.Ab.g1b,Ec),this.Ab.S2a&&wf.Fy(this.Ab.h1b,Lc))}cb=N.Annotations.oT(cb);this.Ab.bUc?cb.Fy(this.Ab.UMa,Jb):(cb.Fy(this.Ab.S2a?this.Ab.i1b:this.Ab.g1b,Ec),this.Ab.S2a&&cb.Fy(this.Ab.h1b,
Lc));return cb}Ffm(cb){let Jb,ac;if(!cb||!({value:Jb}=cb.Hq(this.Ab.UMa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ec;({value:Ec}=cb.Hq(this.Ab.mZa)).returnValue||(Ec="");ac=new Xi(Jb.items.length);const Lc=$f(this.Ab.Ejg,kd=>!kd.vSc||kd.vSc.isMatch(cb,null));for(let kd=0;kd<Jb.items.length;++kd){const Vd=Jb.items[kd];let se=null;ac.Bjg[kd]=ac.ngg.length;let He=ac.wlc[kd]=0;for(const wf of Lc)0<wf.BYc&&ac.wlc[kd]+He>=wf.BYc||wf.u$c&&!wf.u$c.isMatch(Vd,
null)||({w$c:se,tFc:He}=wf.apply(this,Vd,kd,ac,Ec,se,He))}return{tokens:Jb,aXm:ac}}zCm(cb,Jb,ac,Ec,Lc,kd,Vd){let se=0;kd[0].sRc=-1;for(kd[0].Ljf=cb.Pej;;){var He=Vd[se],wf=0>He||He>=Jb.wlc.length?1:Jb.wlc[He];let Fk=!1;for(;kd[se].sRc<wf-1;){++kd[se].sRc;var fc=void 0,hf=void 0;0>He?(fc=this.Ab.SZf,hf=1):He>=Jb.Bjg.length?(fc=this.Ab.NZf,hf=1):(hf=Jb.Bjg[He]+kd[se].sRc,fc=Jb.ngg[hf],hf=Jb.Fvj[hf]);kd[se].S5c=hf*(se?kd[se-1].S5c:cb.score);if(({value:fc}=em(kd[se].Ljf,fc.toString())).returnValue){se===
cb.Wob.length-1?(He=fc,kd[se].S5c&&(({value:wf}=em(Lc,He.toString())).returnValue||(wf=-1),0>wf&&(ac=N.Annotations.oT(ac),Array.add(ac.items,He)),this.Ab.S2a&&(Ec=N.Annotations.oT(Ec),0>wf?Array.add(Ec.items,kd[se].S5c):Ec.items[wf]+=kd[se].S5c),0>wf&&(this.Ab.GCi||this.Ab.S2a)&&(Lc[He.toString()]=ac.items.length-1))):(++se,kd[se].sRc=-1,kd[se].Ljf=fc);Fk=!0;break}}if(!Fk&&(--se,0>se))break}return{wfl:ac,xfl:Ec}}mci(cb,Jb){let ac;if(({value:ac}=cb.Hq(this.Ab.S2a?this.Ab.i1b:this.Ab.g1b)).returnValue)for(let Ec=
0;Ec<ac.items.length;++Ec)Jb[ac.items[Ec].toString()]=Ec;else ac=new nb.a(this.Ab.annotations,N.Annotations.xIa);if(this.Ab.S2a){if(({value:Jb}=cb.Hq(this.Ab.h1b)).returnValue||(Jb=new nb.a(this.Ab.annotations,N.Annotations.Rqa)),Jb.items.length!==ac.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ab.annotations.Gda(N.Annotations.pV,cb));}else Jb=null;return{returnValue:ac,uYh:Jb}}get SJo(){return this.Ab.Nle}Efm(cb,
Jb){var ac;if(({value:ac}=Jb.Hq(this.Ab.Ldb)).returnValue)cb=ac;else{if(!({value:ac}=Jb.Hq(this.Ab.h3)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Jb}=Jb.Hq(this.Ab.s7)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>ac||0>Jb||ac+Jb>cb.length)throw Error.argument("Token indices are out of range");cb=cb.substr(ac,Jb)}return cb}}Object(l.a)(Tg,"NGramNLModule",null,[1578,1581]);class Ri{constructor(cb){this.Wob=null;this.score=this.MZf=this.RZf=
0;this.Pej=null;if(cb){var Jb=0;try{if(cb.J(Jb)!==Ri.Yzb)throw Error.argument("initData","Input does not represent a feature template");++Jb;const ac=cb.J(Jb);++Jb;this.Wob=Array(ac);for(let Ec=0;Ec<ac;++Ec)this.Wob[Ec]=cb.J(Jb),++Jb;this.RZf=cb.J(Jb);++Jb;this.MZf=cb.J(Jb);++Jb;this.score=cb.J(Jb);++Jb;this.Pej=({eoi:Jb}=Ri.v6i(cb,Jb)).returnValue}catch(ac){throw Error.argument("initData");}}}static v6i(cb,Jb){const ac=cb.J(Jb);++Jb;const Ec={};for(let Lc=0;Lc<ac;++Lc){const kd=cb.J(Jb);++Jb;cb.J(Jb)?
Ec[kd.toString()]=({eoi:Jb}=Ri.v6i(cb,Jb)).returnValue:(++Jb,Ec[kd.toString()]=cb.J(Jb),++Jb)}return{returnValue:Ec,eoi:Jb}}}Ri.Yzb=240803228;Object(l.a)(Ri,"FeatureTemplate",null,[1592]);var cj=c(1590);class Fh{constructor(cb,Jb){this.S2a=this.GCi=this.bUc=!1;this.Ldb=this.s7=this.h3=this.UMa=this.mZa=this.h1b=this.i1b=this.g1b=0;this.Nle=null;this.NZf=this.SZf=0;this.tLd=this.Ejg=null;if(cb){this.annotations=Jb.annotations;var ac=0;try{this.bUc=1===cb.J(ac);++ac;this.GCi=1===cb.J(ac);++ac;this.S2a=
1===cb.J(ac);++ac;this.g1b=cb.J(ac);++ac;this.i1b=cb.J(ac);++ac;this.h1b=cb.J(ac);++ac;this.mZa=cb.J(ac);++ac;this.UMa=cb.J(ac);++ac;this.h3=cb.J(ac);++ac;this.s7=cb.J(ac);++ac;this.Ldb=cb.J(ac);++ac;this.Nle=this.bAn(Jb.dhb(cb.J(ac)));++ac;this.SZf=cb.J(ac);++ac;this.NZf=cb.J(ac);++ac;const Ec=cb.J(ac);++ac;this.Ejg=Array(Ec);for(let kd=0;kd<Ec;++kd){const Vd=cb.J(ac);++ac;const se=this.Nle.trie,He=new cc.a;He.Rgb(cb,ac,Vd);this.Ejg[kd]=this.fAn(He,Jb,se);ac+=Vd}const Lc=cb.J(ac);++ac;this.tLd=Array(Lc);
for(Jb=0;Jb<Lc;++Jb){const kd=cb.J(ac);++ac;const Vd=new cc.a;Vd.Rgb(cb,ac,kd);this.tLd[Jb]=this.Jzn(Vd);ac+=kd}}catch(Ec){throw Error.argument("initData");}}}bAn(cb){return new Pi.a(new Sh.a(cb))}fAn(cb,Jb,ac){return cj.a.create(cb,Jb,ac)}Jzn(cb){return new Ri(cb)}}Object(l.a)(Fh,"NGramNLModuleInit",null,[]);class Kh{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");cb=cb.clone();this.Ab.script.execute(cb,null);return cb}}Object(l.a)(Kh,"ScriptNLModule",null,[1578]);
class Ok{constructor(cb,Jb){cb&&(this.script=Jb.DDb(cb.J(0)))}}Object(l.a)(Ok,"ScriptNLModuleInit",null,[]);const uj=cb=>{cb=sm(cb,Jb=>Jb*Jb);return Math.sqrt(Yi(cb,(Jb,ac)=>Jb+ac,0))},tl=cb=>Yi(cb,(Jb,ac)=>Jb>ac?Jb:ac,cb[0]);class Lj{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");var Jb=[],ac=[];this.x_k(cb,Jb,ac);this.qzk(Jb,ac);const Ec={};for(let kd=0;kd<Jb.length;++kd){var Lc=Jb[kd];const Vd=this.Ab.vsi.J(Lc);Lc=this.Ab.wsi.J(Lc);for(let se=0;se<Lc;++se){const He=
this.Ab.E7.J(this.Ab.fDh.J(Vd+se)),wf=this.Ab.gDh.J(Vd+se);let fc;({value:fc}=em(Ec,He)).returnValue||(fc=0);Ec[He]=fc+ac[kd]*wf}}ac=Zi(Ec);ac.sort((kd,Vd)=>{var se=kd.value,He=Vd.value;(se=-(se>He?1:se<He?-1:0))||(se=kd.key.localeCompare(Vd.key));return se});Jb=new nb.a(this.Ab.annotations,N.Annotations.pV);for(const kd of Fg(ac,this.Ab.M$m))ac=new P.a(this.Ab.annotations),ac.Fy(this.Ab.qHk,kd.key),ac.Fy(this.Ab.sHk,kd.value),Array.add(Jb.items,ac);cb.Fy(this.Ab.rHk,Jb);return cb}x_k(cb,Jb,ac){if(({value:cb}=
cb.Hq(this.Ab.pHk)).returnValue){let Ec;if(({value:Ec}=cb.Hq(this.Ab.i1b)).returnValue){let Lc;if(!({value:Lc}=cb.Hq(this.Ab.h1b)).returnValue||Ec.items.length!==Lc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.hEd(Ec,Lc,Jb,ac)}if(({value:Ec}=cb.Hq(this.Ab.uHk)).returnValue){let Lc;if(!({value:Lc}=cb.Hq(this.Ab.vHk)).returnValue||Ec.items.length!==Lc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.hEd(Ec,Lc,Jb,ac)}({value:Ec}=cb.Hq(this.Ab.g1b)).returnValue&&this.hEd(Ec,null,Jb,ac);({value:Ec}=cb.Hq(this.Ab.tHk)).returnValue&&this.hEd(Ec,null,Jb,ac)}}hEd(cb,Jb,ac,Ec){for(let kd=0;kd<cb.items.length;++kd){var Lc=void 0;cb.x4===N.Annotations.g$?({value:Lc}=em(this.Ab.YTh,cb.items[kd])).returnValue||(Lc=-1):(Lc=cb.items[kd],Lc=Lc>=this.Ab.cNf&&Lc<=this.Ab.san?this.Ab.VQf?this.Ab.VQf.J(Lc-this.Ab.cNf)-1:Lc-this.Ab.cNf:-1);if(0<=Lc){let Vd;Vd=Jb?Jb.items[kd]:1;0<Vd&&(Array.add(ac,Lc),Array.add(Ec,
Vd))}}}qzk(cb,Jb){if(cb.length){switch(this.Ab.mKn){case 0:break;case 1:for(var ac=0;ac<Jb.length;++ac)Jb[ac]=1+Math.log(Jb[ac]);break;case 2:ac=tl(Jb);for(let Ec=0;Ec<Jb.length;++Ec)Jb[Ec]=.5+Jb[Ec]/ac*.5;break;case 3:for(ac=0;ac<Jb.length;++ac)Jb[ac]=1;break;default:throw Error.notImplemented();}if(this.Ab.OWd)for(ac=0;ac<Jb.length;++ac)Jb[ac]*=this.Ab.OWd.J(cb[ac]);cb=uj(Jb);for(ac=0;ac<Jb.length;++ac)Jb[ac]/=cb}}}Object(l.a)(Lj,"TfIdfRankerNLModule",null,[1578]);class yl{constructor(cb,Jb=0){if(!cb)throw Error.argumentNull("byteArray");
this.f3d=Jb;if(604662927!==cb.Dy(this.f3d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.aj=cb.Dy(this.f3d+4,4);this.TKi=cb.Dy(this.f3d+8,4);this.f8m=cb}J(cb){if(0>cb||cb>=this.count)throw Error.argumentOutOfRange("index");return this.f8m.ZOn(8*this.f3d+96+cb*this.TKi,this.TKi)}get count(){return this.aj}}Object(l.a)(yl,"CompactIntArray",null,[1577]);const Lh=(cb,Jb)=>{Jb=Array(Jb);for(let kd=0;kd<Jb.length;kd++){var ac=kd,Ec=cb.C9(),Lc=1===(Ec>>31&1)?-1:
1;const Vd=Ec&8388607;Ec=Ec>>23&255;256===Ec+1?Lc=Vd?Number.NaN:1===Lc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Ec?(Ec-=127,Lc=Lc*Ck(Vd,1)*Math.pow(2,Ec)):Lc=Lc*Ck(Vd,0)*Math.pow(2,-126);Jb[ac]=Lc}return Jb},Ck=(cb,Jb)=>{let ac=0;for(let Ec=0;23>Ec;Ec++)ac+=(cb>>22-Ec&1)/Math.pow(2,Ec+1);return Jb+ac};class lk{constructor(cb,Jb){this.VQf=null;this.nRi=0;this.wsi=this.vsi=this.OWd=null;this.mRi=0;this.gDh=this.fDh=null;this.annotations=Jb.annotations;let ac=0;this.tHk=cb.J(ac);++ac;this.g1b=
cb.J(ac);++ac;this.uHk=cb.J(ac);++ac;this.vHk=cb.J(ac);++ac;this.i1b=cb.J(ac);++ac;this.h1b=cb.J(ac);++ac;this.pHk=cb.J(ac);++ac;this.rHk=cb.J(ac);++ac;this.qHk=cb.J(ac);++ac;this.sHk=cb.J(ac);++ac;var Ec=cb.J(ac);++ac;var Lc=Array(Ec);for(var kd=0;kd<Ec;++kd)Lc[kd]=Jb.QD(cb.J(ac)),++ac;this.E7=cc.a.Vaf(Lc);this.M$m=cb.J(ac);++ac;this.mKn=cb.J(ac);++ac;Ec=cb.J(ac);++ac;this.YTh={};for(Lc=0;Lc<Ec;++Lc){kd=Jb.QD(cb.J(ac));++ac;const Vd=cb.J(ac);++ac;this.YTh[kd]=Vd}this.cNf=cb.J(ac);++ac;this.san=cb.J(ac);
++ac;Ec=cb.J(ac);++ac;0<Ec&&(Ec=Jb.dhb(cb.J(ac)),++ac,this.VQf=this.t9d(new lf(Ec)));++ac;cb=Jb.dhb(cb.J(ac));this.Qzn(cb)}t9d(cb){return new yl(cb.rfa,cb.offset)}Qzn(cb){try{const Jb=new lf(cb);this.nRi=Jb.C9();1===Jb.C9()?this.OWd=cc.a.Vaf(Lh(Jb,this.nRi)):this.OWd=null;const ac=Jb.C9();this.vsi=this.t9d(Jb);Jb.offset+=ac;const Ec=Jb.C9();this.wsi=this.t9d(Jb);Jb.offset+=Ec;this.mRi=Jb.C9();const Lc=Jb.C9();this.fDh=this.t9d(Jb);Jb.offset+=Lc;this.gDh=cc.a.Vaf(Lh(Jb,this.mRi))}catch(Jb){throw Error.argument("byteReader");
}}}Object(l.a)(lk,"TfIdfRankerNLModuleInit",null,[]);class Pk{constructor(cb,Jb,ac,Ec){this.YXf=cb;this.q_h=ac;this.tokens=Ec;this.Fma=Jb;this.sic=-1;this.Afe=0}}Object(l.a)(Pk,"TokenizerData",null,[]);class Fm{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");if(!({value:Ec}=cb.Hq(this.Ab.mZa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Jb;({value:Jb}=cb.Hq(this.Ab.h3)).returnValue||(Jb=0);let ac;({value:ac}=
cb.Hq(this.Ab.s7)).returnValue||(ac=Ec.length-Jb);if(0>Jb||Jb>Ec.length)throw Error.argument("input","Start index out of range");if(0>ac||ac>Ec.length)throw Error.argument("input","Length out of range");if(Jb+ac>Ec.length)throw Error.argument("input","Bad start-length range");var Ec=new Pk(Ec,Jb,Jb+ac,new nb.a(this.Ab.annotations,N.Annotations.pV));this.TJo(Ec);cb=cb.isReadOnly?cb.clone():cb;cb.Fy(this.Ab.UMa,Ec.tokens);return cb}TJo(cb){for(;cb.Fma<cb.q_h;){if(this.Ab.$vf){var Jb=this.Ab.$vf.yKi(cb.YXf,
cb.Fma,cb.q_h-cb.Fma,null);!Jb.succeeded&&Jb.gQi&&(Jb=Jb.gQi);if(Jb.succeeded){this.gVi(cb,Jb.length,this.Ab.lki);cb.Fma+=Jb.length;continue}}Jb=cb.YXf.substr(cb.Fma);let ac=-1,Ec=-1,Lc=-1;for(let kd=0;kd<this.Ab.Bee.length;++kd){const Vd=this.Ab.Bee[kd].exec(Jb);Vd&&0<Vd[1].length&&(0>ac||Vd[0].length>Ec)&&(ac=kd,Ec=Vd[0].length,Lc=Vd[1].length)}0<=ac?(this.gVi(cb,Lc,this.Ab.B8f[ac]),cb.Fma+=Lc):cb.Fma+=1}}gVi(cb,Jb,ac){if(this.Ab.WAi)ac!==Fm.pPk&&(0>cb.sic&&(cb.sic=cb.Fma),cb.Afe=cb.Fma+Jb-cb.sic,
ac===Fm.oPk&&(0<=cb.sic&&0<cb.Afe&&(Jb=new P.a(this.Ab.annotations),Jb.Fy(this.Ab.h3,cb.sic),Jb.Fy(this.Ab.s7,cb.Afe),Jb.Fy(this.Ab.p2e,Fm.qPk),Jb.Fy(this.Ab.mZa,cb.YXf),Array.add(cb.tokens.items,Jb)),cb.sic=-1,cb.Afe=0));else{let Ec=new P.a(this.Ab.annotations);Ec.Fy(this.Ab.h3,cb.Fma);Ec.Fy(this.Ab.s7,Jb);Ec.Fy(this.Ab.p2e,ac);Array.add(cb.tokens.items,Ec)}}}Fm.pPk="GAP";Fm.oPk="EOS_CHUNK";Fm.qPk="SENTENCE";Object(l.a)(Fm,"TokenizerNLModule",null,[1578]);class fm{constructor(cb,Jb){this.s7=this.h3=
this.p2e=this.UMa=this.mZa=0;this.WAi=!1;this.B8f=this.Bee=this.lki=this.$vf=null;if(cb){this.annotations=Jb.annotations;var ac=0;try{this.mZa=cb.J(ac);++ac;this.UMa=cb.J(ac);++ac;this.p2e=cb.J(ac);++ac;this.h3=cb.J(ac);++ac;this.s7=cb.J(ac);++ac;this.WAi=1===cb.J(ac);++ac;var Ec=cb.J(ac);++ac;0<Ec&&(this.$vf=Jb.Jrf(Ec).fBl);this.lki=cb.J(ac)?Jb.QD(cb.J(ac)):"";++ac;const Lc=cb.J(ac);++ac;this.Bee=Array(Lc);this.B8f=Array(Lc);for(Ec=0;Ec<Lc;++Ec)this.Bee[Ec]=new RegExp(Jb.QD(cb.J(ac))),++ac,this.B8f[Ec]=
Jb.QD(cb.J(ac)),++ac}catch(Lc){throw Error.argument("initData");}}}}Object(l.a)(fm,"TokenizerNLModuleInit",null,[]);class gm{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");let Jb;if(!({value:Jb}=cb.Hq(this.Ab.evh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const ac of this.Ab.Ffg)Jb=ac.apply(Jb);cb=N.Annotations.oT(cb);cb.Fy(this.Ab.fvh,Jb);return cb}static y1e(cb,Jb){const ac=new Sys.StringBuilder;for(let Ec=
0;Ec<cb.length;++Ec)ac.append(Jb(cb.substr(Ec,1)));return ac.toString()}}Object(l.a)(gm,"TransliteratorNLModule",null,[1578]);class kg{constructor(cb){cb&&(this.style=cb.J(0))}apply(cb){return gm.y1e(cb,Jb=>kg.LTk(Jb,this.style))}static LTk(cb,Jb){switch(Jb){case 0:return cb.toLowerCase();case 1:return"I"===cb?"\u0131":cb.toLowerCase();case 2:return cb.toUpperCase();case 3:return"i"===cb?"\u0130":cb.toUpperCase();default:throw Error.invalidOperation();}}}kg.Zzb=0;Object(l.a)(kg,"ChangeCaseTransliterationStage",
null,[1589]);class $k{apply(cb){return gm.y1e(cb,$k.pLo)}static pLo(cb){const Jb=cb.charCodeAt(0);return 65281<=Jb&&65374>=Jb?String.fromCharCode(Jb-65248):cb}}$k.Zzb=4;Object(l.a)($k,"LatinFullWidthToHalfWidthTransliterationStage",null,[1589]);class am{constructor(cb,Jb){cb&&(this.E3f=Jb.n8b(cb.J(0)),this.Y2n=Jb.QD(cb.J(1)))}apply(cb){return cb.replace(this.E3f,this.Y2n)}}am.Zzb=1;Object(l.a)(am,"RegexReplaceTransliterationStage",null,[1589]);class bg{constructor(cb,Jb){if(cb){var ac=cb.J(0),Ec=
Jb.QD(cb.J(1)),Lc=new yl(Jb.dhb(cb.J(2)));cb=0>cb.J(3)?null:new yl(Jb.dhb(cb.J(3)));this.Ggg={};for(Jb=0;Jb<ac;++Jb)this.Ggg[Ec.charAt(Jb).toString()]=Ec.substr(Lc.J(Jb),cb?cb.J(Jb):1)}}apply(cb){return gm.y1e(cb,Jb=>Jb in this.Ggg?this.Ggg[Jb]:Jb)}}bg.Zzb=2;Object(l.a)(bg,"SingleCharSubstitutionsTransliterationStage",null,[1589]);class Hd{constructor(cb,Jb){this.fvh=this.evh=0;this.Ffg=null;if(cb){this.annotations=Jb.annotations;var ac=0;try{this.evh=cb.J(ac);++ac;this.fvh=cb.J(ac);++ac;const Ec=
cb.J(ac);++ac;this.Ffg=Array(Ec);for(let Lc=0;Lc<Ec;++Lc){const kd=cb.J(ac);++ac;const Vd=cb.J(ac);++ac;const se=new cc.a;se.Rgb(cb,ac,Vd);ac+=Vd;this.Ffg[Lc]=this.aAn(kd,se,Jb)}}catch(Ec){throw Error.argument("initData");}}}aAn(cb,Jb,ac){switch(cb){case kg.Zzb:return new kg(Jb);case am.Zzb:return new am(Jb,ac);case bg.Zzb:return new bg(Jb,ac);case $k.Zzb:return new $k;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(Hd,"TransliteratorNLModuleInit",
null,[]);class zd{f3l(cb,Jb){const ac=cb.J(0),Ec=new cc.a;Ec.Rgb(cb,1,cb.count-1);switch(ac){case 0:return new Kh(new Ok(Ec,Jb));case 2:return new Fm(new fm(Ec,Jb));case 3:return new Tg(new Fh(Ec,Jb));case 5:return new xl(new Fl(Ec,Jb));case 9:return new gm(new Hd(Ec,Jb));case 10:return new Lj(new lk(Ec,Jb));default:throw Error.notImplemented();}}}Object(l.a)(zd,"NLModuleFactory",null,[1556]);class vf{constructor(cb){this.mPk=";";if(!cb)throw Error.argumentNull("resource");this.Jha=new rm(cb,new zb,
new zd);this.xLf=this.Jha.L2l();this.SKi=this.Jha.annotations.bNc("Text.Text");this.QKi=this.Jha.annotations.bNc("Classification.Predictions");this.iLf=this.Jha.annotations.bNc("Classification.PredictionString");this.RKi=this.Jha.annotations.bNc("Classification.Probability");this.e8m=this.Jha.annotations.bNc("NLMod.Tokens");if(0>this.SKi||0>this.QKi||0>this.iLf||0>this.RKi)throw Error.argument("resourceObj","Resource does not represent a ranker");}PMl(){const cb=[];this.yif(void 0,this.d4h(cb),null);
return cb}RMl(cb,Jb){const ac=[],Ec=[];this.yif(cb,this.d4h(ac),(Lc,kd)=>{const Vd=this.Jha.annotations.R3h(Lc),se=[],He=[];Jb&&Jb.length&&-1===Array.indexOf(Jb,Vd)||(Lc=this.Jha.annotations.getAttributeType(Lc),this.w1i(Lc,kd,se,He),kd=new Bd(Vd,se,He),Array.add(Ec,kd))});return new ud(ac,Ec)}QMl(cb){const Jb=[];this.yif(cb,ac=>{let Ec;if(({value:Ec}=ac.Hq(this.iLf)).returnValue){let Lc;({value:Lc}=ac.Hq(this.RKi)).returnValue&&Array.add(Jb,new nd(Ec,Lc))}},null);return Jb}yif(cb,Jb,ac){var Ec=new P.a(this.Jha.annotations);
Ec.Fy(this.SKi,cb);cb=this.xLf.execute(Ec);if(({value:Ec}=cb.Hq(this.QKi)).returnValue)for(const Lc of Ec.items)Jb(Lc);if(ac&&({value:Jb}=cb.Hq(this.e8m)).returnValue)for(const Lc of Jb.items)Lc.MMd(ac)}w1i(cb,Jb,ac,Ec){if(N.Annotations.gI(cb))for(var Lc of Jb.items)this.w1i(Jb.x4,Lc,ac,Ec);else if(N.Annotations.MCj(cb)){Lc=this.Jha.annotations.Rbi(cb);for(let kd=0;kd<Lc;kd++)Array.add(ac,this.Jha.annotations.wgi(cb,kd)),Array.add(Ec,this.Jha.annotations.Gda(this.Jha.annotations.fFb(cb,kd),Jb.shb(kd)))}else Array.add(ac,
"VALUE"),Array.add(Ec,this.Jha.annotations.Gda(cb,Jb))}d4h(cb){return Jb=>{let ac;({value:ac}=Jb.Hq(this.iLf)).returnValue&&Array.add(cb,this.X7l(ac))}}X7l(cb){const Jb=cb.indexOf(this.mPk);return 0>Jb?cb:cb.substring(0,Jb)}}Object(l.a)(vf,"Ranker",null,[]);var cg=c(1533),og=c(1544),be=c(2);class jd{constructor(cb,Jb){this.B3g="";this.BOe=null;this.COe=!1;this.nra=null;this.lWj=["TellMe.TellMeParamCollection"];this.fc=cb;this.hXa=Jb;this.fc.uzb&&(this.nra=null)}get hbe(){if(!this.BOe&&!this.COe){let cb=
null;try{cb=window.TellMeModel}catch(Jb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("QueryRanker","TellMeModel not found. Exception: "+Jb)}if(cb){try{this.BOe=new vf(cb)}catch(Jb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Jb)}this.COe=!0}else if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("QueryRanker","Classifier model not found")}return this.BOe}aL(){return"Command"}eU(){return 0===
this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb,ac=!1,Ec=f.a.tellMe,Lc=null){const kd=new n.a(cb);if((!Lc||Array.contains(Lc,0))&&!z.a.cR(cb)){if(!this.hbe&&this.COe){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.fc.uzb&&this.nra&&this.nra.initialize();if(cg.CommandResultsUtility.QBf(cb.Dg)&&(Lc=cg.CommandResultsUtility.I5h(cb.Dg),0<Lc.results.length)){Lc.displayName=
"Classifier Debug";kd.Uu(Lc);Jb.resultsUpdated(kd);return}Lc=cb?this.B3g=cb.Dg:this.B3g;if(be.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Lc=this.Z7l(Lc);var Vd=this.bOd(Lc.Qsf());Lc=Lc.s3h()}else Lc=this.Y7l(Lc),Vd=this.SPl(Lc),Lc=[];cg.CommandResultsUtility.p2d(Vd,!1,"Classifier","TFIDF");Vd=cg.CommandResultsUtility.lPc(cb,Vd,this.fc,this.nra,this.hXa,Lc,0,1);0<Vd.results.length&&Ec!==f.a.contextMenu&&(Vd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ac||Vd.results.length||
this.fc.Q_||this.fc.S6a||(cb=new x.a("lookupNoResults",14,cb.Dg,null,1),Vd.Nw(cb));0<Vd.results.length&&kd.Uu(Vd);kd.attributes=Lc}Jb.resultsUpdated(kd)}Qsf(){let cb=[];try{cb=this.hbe.PMl()}catch(Jb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictions","Exception: "+Jb)}return cb}Y7l(cb){let Jb=[];try{Jb=this.hbe.QMl(cb)}catch(ac){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictionsWithScore","Exception: "+ac)}return Jb}Z7l(cb){try{return this.hbe.RMl(cb,
this.lWj)}catch(Jb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictionsWithTokenAttributes","Exception: "+Jb)}return new ud([],[])}bOd(cb){const Jb=[];if(cb)for(const ac of cb)Jb.push(new og.a(ac,-99999));return Jb}SPl(cb){const Jb=[];if(cb)for(const ac of cb)Jb.push(new og.a(ac.prediction,ac.score));return Jb}}Object(l.a)(jd,"CommandResultsProvider",null,[942]);var ak=c(1730);class sh{constructor(cb){this.fc=cb}aL(){return"Feedback"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?
1:2}QH(cb,Jb,ac,Ec,Lc=null){cb=new n.a(cb);if(!Lc||Array.contains(Lc,21))Lc=[],Lc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Lc),Lc=new y.a(22),Lc.displayName="",Lc.Nw(new x.a("TellMeFeedback",23,null,null,1)),cb.Uu(Lc);Jb.resultsUpdated(cb)}}Object(l.a)(sh,"FeedbackResultsProvider",null,[942]);class pg{constructor(cb,Jb,ac,Ec){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=cb;this.CommandId=Jb;
this.CommandValueId=ac;this.InputText=Ec}}Object(l.a)(pg,"FindInDocumentProp",null,[]);var ul=c(19);class jh{constructor(cb){this.vJe=2;this.xvb=[];this.kbb=[];this.fc=cb;jh.RDa=cb.Vjf;jh.JZh="FindInDocumentSuggestion";jh.K0i="FindInDocumentSuggestion3";this.mIe=Object.assign(new w.a,{landingTab:"Indoc",data:null});this.tik=this.fc.Job||!!be.AFrameworkApplication.ta&&be.AFrameworkApplication.ta.Nb.Job}aL(){return"FindInDocument"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:3===this.fc.dv?this.fc.Xsj?
2:3:2}QH(cb,Jb,ac=!1,Ec,Lc=null){const kd=new n.a(cb);if(Lc&&!Array.contains(Lc,2))Jb.resultsUpdated(kd);else if(Array.clear(this.xvb),z.a.cR(cb)){if(ac&&this.kqj()){ac=new y.a(2);ac.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Lc=1;Ec="";if(0<this.kbb.length&&!this.fc.pjc)for(var Vd of this.kbb)if(""!==Vd.Label.toLowerCase()){if(Lc>=this.vJe)break;this.GGj(ac,Vd.Label,Vd.CommandValueId,jh.JZh+Lc,Vd.InputText);Lc++}Vd="";this.fc.sP?(kd.Uu(ac),ac=new y.a(3),Vd=this.fc.Gdb?z.a.chb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Vd=CommonUIStrings.l_TellMeOpenFindPaneText;Ec=this.H5h("");this.GGj(ac,Vd,Ec,jh.K0i,"");kd.Uu(ac)}Jb.resultsUpdated(kd)}else Vd="",ac&&(ac=this.H5h(cb.Dg),Ec=[],this.fc.q3a?(this.fc.Zhe&&Ec.push(appChrome.actions.setControlIconSet(jh.RDa,{"default":"FindInDocument_20"})),Vd=this.fc.eGf?z.a.bqf(cb.Dg,CommonUIStrings.l_FindInDocumentScopedButtonText):cb.Dg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.fc.sP?(Vd=this.fc.Gdb?z.a.chb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
cb.Dg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,cb.Dg),Ec.push(appChrome.actions.setControlIconSet(jh.RDa,{"default":"FindInDocument_20"}))):Vd=this.fc.pjc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,cb.Dg),this.fc.Yva?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(jh.RDa,Vd)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(jh.RDa,ac))):(Ec.push(appChrome.actions.setControlLabel(jh.RDa,
Vd)),Ec.push(appChrome.actions.setButtonCommandValueId(jh.RDa,ac)),appChrome.api.dispatch(Ec)),this.Clj(Vd,jh.RDa,ac,cb.Dg)),this.fc.Xsj?(Vd=new x.a(jh.RDa,8,cb.Dg),ac=new y.a(2),ac.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,ac.Nw(Vd),kd.Uu(ac),Jb.resultsUpdated(kd)):this.fc.aPd(cb.Dg).then(se=>{const He=new x.a(jh.RDa,8,cb.Dg,null,1);He.count=se;se=new y.a(2);se.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;se.Nw(He);kd.Uu(se);Jb.resultsUpdated(kd)},se=>{u.TellMeActor.instance.Oe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+se);se=new x.a(jh.RDa,8,cb.Dg,null,1);const He=new y.a(2);He.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;He.Nw(se);kd.Uu(He);Jb.resultsUpdated(kd)})}kqj(){return!!this.fc&&this.fc.She}GGj(cb,Jb,ac,Ec,Lc=null){const kd=[];Jb&&kd.push(appChrome.actions.setControlLabel(Ec,Jb));this.fc.sP&&kd.push(appChrome.actions.setControlIconSet(Ec,{"default":"FindInDocument_20"}));kd.push(appChrome.actions.setButtonCommandValueId(Ec,ac));appChrome.api.dispatch(kd);
this.Clj(Jb,Ec,ac,"");cb.Nw(new x.a(Ec,8,Lc,null,1,-99999))}H5h(cb){return this.tik?z.a.JNa(cb,15,this.mIe):ul.a.Af(cb)}Clj(cb,Jb,ac,Ec){this.kqj()&&this.xvb.length<this.vJe&&(cb=new pg(cb,Jb,ac,Ec),Array.add(this.xvb,cb))}Ajo(cb){for(let Jb=0;Jb<this.xvb.length;Jb++)if(this.xvb[Jb].CommandId===cb){const ac=this.xvb[Jb].Label;let Ec=!1;if(0<this.kbb.length){let Lc=0;for(const kd of this.kbb){if(kd.Label===ac){Array.removeAt(this.kbb,Lc);Ec=!0;break}Lc++}}!Ec&&this.kbb.length>=this.vJe-1&&Array.removeAt(this.kbb,
1);Array.insert(this.kbb,0,this.xvb[Jb])}}}jh.RDa=null;jh.JZh=null;jh.K0i=null;Object(l.a)(jh,"FindInDocumentResultsProvider",null,[942]);var ag=c(1728);class Uf{constructor(cb){this.fc=cb}aL(){return"Insights"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb,ac=!1,Ec,Lc=null){Ec=new n.a(cb);if(!Lc||Array.contains(Lc,13))if(this.Kso()||!z.a.cR(cb)){Lc=new y.a(13);var kd=""===cb.Dg.trim(),Vd=kd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",se=new x.a(Vd,10,cb.Dg,null,1);ac&&(ac=null,
z.a.sha()?kd?kd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(kd=this.fc.pjc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,cb.Dg),ac=z.a.JNa(cb.Dg,1)):(kd=String.format(CommonUIStrings.l_InsightsButtonText,cb.Dg),ac=z.a.uBb(cb.Dg)),this.fc.Yva?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Vd,kd)),ac&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ac))):
(cb=[],cb.push(appChrome.actions.setControlLabel(Vd,kd)),ac&&cb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ac)),appChrome.api.dispatch(cb)),se.label=kd);Lc.Nw(se);Ec.Uu(Lc)}Jb.resultsUpdated(Ec)}Kso(){return z.a.sha()&&this.fc.ZGo&&!this.fc.dga}}Object(l.a)(Uf,"InsightsResultsProvider",null,[942]);var Dk=c(1726);class ve{constructor(cb){this.fc=cb}aL(){return"Learning"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb,ac,Ec,Lc=null){ac=new n.a(cb);Lc&&!Array.contains(Lc,
21)||!z.a.cR(cb)||(Lc=[],Ec=this.fc.mYm,Lc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Ec)),Ec=ve.gXl(Ec),Lc.push(appChrome.actions.setControlLabel("LearningForSearch",Ec)),appChrome.api.dispatch(Lc),cb=new x.a("LearningForSearch",22,cb.Dg,null,1),Lc=new y.a(21),Lc.Nw(cb),ac.Uu(Lc));Jb.resultsUpdated(ac)}static gXl(cb){const Jb=[];Array.add(Jb,new Dk.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Jb,new Dk.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Jb,new Dk.a(600,cb));Array.add(Jb,new Dk.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));cb={};cb.parts=Jb;return JSON.stringify(cb)}}Object(l.a)(ve,"LearningProvider",null,[942]);var Hf=c(603);class ej{constructor(cb,Jb){this.rWb=this.n_b=this.Kbb=this.Pod=null;this.ux=!1;this.aXb=cb;this.B_j=Jb;cb&&this.WXh(cb)}ume(){this.aXb.ume()&&this.WXh(this.aXb)}getSuggestions(cb){let Jb=[];var ac=[];cb=ej.Lgn(cb);var Ec="";Array.clear(ac);for(let Lc=0;Lc<cb.length;Lc++){const kd=cb.charAt(Lc);
-1!==" ".indexOf(kd)?(Ec.length&&Array.add(ac,Ec),Ec=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(kd)?(Ec.length&&Array.add(ac,Ec),Ec=kd,Array.add(ac,Ec),Ec=""):Ec+=kd}Ec.length&&Array.add(ac,Ec);for(cb=0;cb<ac.length;cb++)Ec=this.RPl(ac[cb]),Ec=this.m6k(Ec),Jb=ej.ubn(Jb,Ec);return Jb=this.Atk(Jb)}qEf(){this.ux||this.ume();return this.ux}DHd(cb){return this.Pod[cb.toString()]}Atk(cb){for(let Jb=0;Jb<cb.length;Jb++){const ac=this.Kbb[Jb];if(cb[Jb].commandId!==this.DHd(ac[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Ec;(Ec=cb[Jb]).score=Ec.score+ac[1]}return cb}m6k(cb){const Jb=[];for(var ac=0;ac<this.Kbb.length;ac++)Jb.push(new og.a(this.DHd(this.Kbb[ac][0]),-5));ac=new Hf.a;for(var Ec=0;Ec<cb.length;Ec++)ac.add(this.DHd(cb[Ec][0]));for(Ec=0;Ec<Jb.length;Ec++){const kd=Jb[Ec];for(let Vd=0;Vd<cb.length;Vd++){var Lc=cb[Vd];const se=this.DHd(Lc[0]);Lc=Lc[1];if(se===kd.commandId){kd.score=Lc;ac.remove(se);break}}if(!ac.count)break}return Jb}RPl(cb){const Jb=1>cb.length;for(let Vd=0;2>=Vd;Vd++){const se=this.rWb;
for(let He in se){var ac=se[He],Ec=cb,Lc=He;const wf=Lc.length+1,fc=Array((Ec.length+1)*wf);for(var kd=0;kd<=Ec.length;kd++)fc[kd*wf]=kd;for(kd=0;kd<=Lc.length;kd++)fc[kd]=kd;for(kd=0;kd<Lc.length;kd++)for(let hf=0;hf<Ec.length;hf++)fc[(hf+1)*wf+(kd+1)]=Ec.charAt(hf)===Lc.charAt(kd)?fc[hf*wf+kd]:Math.min(Math.min(fc[hf*wf+(kd+1)]+1,fc[(hf+1)*wf+kd]+1),fc[hf*wf+kd]+1);Ec=fc[Ec.length*wf+Lc.length];if((!Ec||!Jb)&&Ec<=Vd)return ac}}return this.n_b}WXh(cb){this.Pod=cb.Irf();this.Kbb=cb.I8l();this.n_b=
cb.Ngm();this.rWb=cb.J_l();if(this.ux=!!this.Pod&&!!this.Kbb&&!!this.rWb&&!!this.n_b)this.ux=0<this.Kbb.length&&ej.vBf(this.Kbb);this.ux&&(this.ux=0<this.n_b.length&&ej.vBf(this.n_b));this.ux&&(this.rWb=ej.Chm(this.rWb));this.ux||(this.rWb=this.n_b=this.Kbb=this.Pod=null)}Qfm(cb){cb=this.getSuggestions(cb);return this.QAl(cb,this.B_j)}QAl(cb,Jb){let ac=[];for(let Ec=0;Ec<cb.length;Ec++)cb[Ec].score>=Jb&&ac.push(cb[Ec]);ac.sort((Ec,Lc)=>Ec.score<Lc.score?1:Ec.score>Lc.score?-1:0);0<ac.length-10&&(ac=
ac.slice(0,10));return ac}static ubn(cb,Jb){if(!cb.length)return Jb;if(cb.length!==Jb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let ac=0;ac<cb.length;ac++){if(cb[ac].commandId!==Jb[ac].commandId)throw Error.create("Incorrect CommandId");let Ec;(Ec=cb[ac]).score=Ec.score+Jb[ac].score}return cb}static Lgn(cb){return ul.a.Ug(cb)}static vBf(cb){for(let Jb=0;Jb<cb.length;Jb++)if(2!==cb[Jb].length)return!1;return!0}static Chm(cb){const Jb=
{};for(let Lc in cb){var ac=Lc,Ec=cb[Lc];const kd=Ec;kd.length&&ej.vBf(kd)&&(Jb[ac]=Ec)}return Jb}}Object(l.a)(ej,"NaiveBayesClassifierModel",null,[]);class vj{constructor(cb,Jb){this.nra=null;this.fc=cb;this.jxc=new ej(Jb,cb.g3l);this.fc.uzb&&(this.nra=null)}aL(){return"NBCommand"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb,ac=!1,Ec=f.a.tellMe,Lc=null){const kd=new n.a(cb);if((!Lc||Array.contains(Lc,0))&&!z.a.cR(cb)){if(cg.CommandResultsUtility.QBf(cb.Dg)&&(Lc=cg.CommandResultsUtility.I5h(cb.Dg),
0<Lc.results.length)){Lc.displayName="Classifier Debug";kd.Uu(Lc);Jb.resultsUpdated(kd);return}if(!this.jxc.qEf()){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.fc.uzb&&this.nra&&this.nra.initialize();Lc=this.jxc.Qfm(cb.Dg);cg.CommandResultsUtility.p2d(Lc,!1,"Classifier","NaiveBayesian");Lc=cg.CommandResultsUtility.lPc(cb,Lc,this.fc,this.nra,
null,null,0,1);0<Lc.results.length&&Ec!==f.a.contextMenu&&(Lc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ac||Lc.results.length||this.fc.Q_||this.fc.S6a||(cb=new x.a("lookupNoResults",14,cb.Dg,null,1),Lc.Nw(cb));0<Lc.results.length&&kd.Uu(Lc)}Jb.resultsUpdated(kd)}}Object(l.a)(vj,"NaiveBayesCommandProvider",null,[942]);class Xh{constructor(){this.uvb=null;this.ux=!1;this.ume()}ume(){this.ux||(this.uvb=window.NBCRM)&&4===this.uvb.length&&(this.ux=!0);return this.ux}I8l(){return this.ux?
this.uvb[1]:null}Ngm(){return this.ux?this.uvb[2]:null}J_l(){return this.ux?this.uvb[3][0]:null}Irf(){return this.ux?this.uvb[0][0]:null}}Object(l.a)(Xh,"NaiveBayesModelAdapter",null,[1455]);var dg=c(191);class ll{constructor(cb){this.fc=cb}aL(){return"OfficeScript"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb){const ac=new n.a(cb);if(!z.a.cR(cb)){cb=dg.d(cb.Dg);var Ec=new y.a(28);Ec.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Ec=this.zoh(cb,ll.TPo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Ec);Ec=this.zoh(cb,ll.THl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Ec);ac.Uu(Ec)}Jb.resultsUpdated(ac)}zoh(cb,Jb,ac,Ec,Lc,kd){const Vd=[];for(const se of Jb)if(dg.a(cb,se)){this.fc.Yva?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ac,Lc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ac,Ec))):(Vd.push(appChrome.actions.setControlLabel(ac,
Lc)),Vd.push(appChrome.actions.setButtonCommandValueId(ac,Ec)),appChrome.api.dispatch(Vd));kd.Nw(new x.a(ac,28,null,null,1));break}return kd}}ll.TPo="unhide row rows col cols column columns".split(" ");ll.THl=["freeze","selection","pane","panes"];Object(l.a)(ll,"OfficeScriptsSamplesProvider",null,[942]);var gi=c(74),Gm=c(344),An=c(1561),qg=c(1524),xk=c(1560),Gj=c(35),Of=c(135),hm=c(25);class fe{constructor(cb){this.eQ=null;this.U1=-1;this.nMf=14;this.pMf=12;this.attributes=this.SVe=this.query=null;
this.fbc=!1;this.mYb=[];this.Yf=be.AFrameworkApplication.Ne;be.AFrameworkApplication.K&&(this.nMf=be.AFrameworkApplication.K.mc("TellMeMaxTermedResults",this.nMf),this.pMf=be.AFrameworkApplication.K.mc("TellMeMaxZeroTermResults",this.pMf));this.pR=cb}get lo(){return this.mYb}get Yme(){return this.SVe}Uu(cb){let Jb=!1;for(let ac=0;ac<this.lo.length;ac++)if(30!==this.lo[ac].groupType&&this.lo[ac].groupType===cb.groupType){this.jZe(this.lo[ac],cb);Jb=!0;break}Jb||this.lo.push(cb)}jZe(cb,Jb){for(let ac=
0;ac<Jb.results.length;ac++)cb.Nw(Jb.results[ac])}G$i(cb){const Jb=[];for(const ac of this.lo)ac.groupType!==cb&&Jb.push(ac);this.lo.length!==Jb.length&&(this.mYb=Jb)}vZn(cb){let Jb=null,ac=null,Ec=null;for(let Lc=0;Lc<cb.length;Lc++){const kd=cb[Lc];if(kd&&kd.lo&&kd.lo.length)for(const Vd of kd.lo)if(17===Vd.groupType||18===Vd.groupType)Jb=Vd;else if(0===Vd.groupType||16===Vd.groupType)ac=Vd,Ec=kd}Jb&&ac&&0<ac.results.length&&(17===Jb.groupType&&({GYe:ac,xZe:Jb}=cg.CommandResultsUtility.esk(ac,Jb,
this.pR.DO()?this.pR.DO().lPl:-.6)),Ec.G$i(ac.groupType))}Gyo(){this.pR&&(new gi.a,this.K8c(this.pR.xLi))}QVc(cb,Jb){return this.query.Dg.length>this.pR.DO().r9l&&this.nPm(cb,Jb)||this.query.Dg.length>this.pR.DO().s9l&&this.aSm(cb,Jb)?!0:!1}aSm(cb,Jb){return cb&&cb.length&&Jb&&Jb.length?-1===Jb.toLowerCase().indexOf(cb.toLowerCase())?!1:!0:!1}nPm(cb,Jb){return cb&&cb.length&&Jb&&Jb.length?Jb.toLowerCase().startsWith(cb.toLowerCase()):!1}cBl(cb){const Jb=[];for(const ac of this.pR.DO().sP?this.Yme:
this.lo)cb.contains(ac.groupType)||Jb.push(ac);this.pR.DO().sP?this.SVe=Jb:this.mYb=Jb}cXo(cb,Jb){const ac=[];for(const Ec of this.lo){const Lc=Ec;if(13!==Lc.groupType||24!==Lc.groupType){const kd=cb[qg.a[Lc.groupType].toLowerCase()];let Vd="False";kd<Jb&&(Vd="True");Lc.displayName=Lc.displayName+" ("+Vd+": "+kd+")"}ac.push(Lc)}this.mYb=ac}K8c(cb,Jb=!1,ac=null){if(this.pR.DO().sP){if(!Jb)for(this.SVe=Array(this.lo.length),Jb=0;Jb<this.lo.length;Jb++)this.Yme[Jb]=this.lo[Jb];this.pR.DLi.K8c(this.lo,
this.Yme,this.query,cb,ac)}else{for(ac=new gi.a;this.lo.length;){Jb=this.lo.pop();const Ec=qg.a[Jb.groupType].toLowerCase(),Lc=cb[Ec];if(hm.c(Lc))throw Error.create("GroupId "+Ec+" missed from group SortingOrder");ac.add(new Gm.a(Lc,Jb))}ac.Sc((Ec,Lc)=>Ec.key<Lc.key?-1:1);for(cb=0;cb<ac.count;cb++)Jb=ac.J(cb).value,this.lo.push(Jb)}}Hyo(){var cb=!1;let Jb=!1,ac=!1;for(let Lc=0;Lc<this.lo.length;Lc++){var Ec=this.lo[Lc];const kd=Ec.groupType;if(8===kd||15===kd||14===kd){Ec=Ec.results;for(let Vd=0;Vd<
Ec.length;Vd++){if(8===kd&&this.QVc(this.query.Dg,Ec[Vd].label)){cb=!0;break}if(15===kd&&this.QVc(this.query.Dg,Ec[Vd].label)){Jb=!0;break}if(14===kd){if(this.QVc(this.query.Dg,Ec[Vd].label)||this.QVc(this.query.Dg,Ec[Vd].description)){ac=!0;break}const se=Ec[Vd].label.split(" ");for(const He of se)if(this.QVc(this.query.Dg,He)){ac=!0;break}}}}}cb=this.pR.gam(cb,Jb,ac);this.K8c(cb)}JKb(cb,Jb,ac,Ec,Lc,kd){if(Lc===this.eQ){var Vd=cb.data.we;Lc=null;try{Lc=Gj.b(Vd)}catch(wj){u.TellMeActor.instance.Oe.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+wj);return}if("RankerResults"in Lc&&Lc.RankerResults){this.NCa();var se=Lc.RankerResults,He=new gi.a,wf=new gi.a;Vd=0;for(var fc of se){se=fc.ProviderId;var hf=fc.Score;Vd+=hf;He.add(new Gm.a(se,hf))}He.Sc((Yd,$g)=>Yd.value>$g.value?-1:1);hf=kd?kd.Kfi:1E-6;fc={};se={};let wj=0;for(var Fk=0;Fk<He.count;Fk++){let Yd=parseInt(He.J(Fk).key),$g=He.J(Fk).value/Vd;1===Yd&&(se.answer=wj++,se.entity=wj++,se.definition=wj++,se.wolframanswer=
wj++,$g<hf&&(wf.add(9),wf.add(11),wf.add(10),wf.add(12)),fc.answer=$g,fc.entity=$g,fc.definition=$g,fc.wolframanswer=$g);2===Yd&&(se.assistance=wj++,$g<hf&&wf.add(8),fc.assistance=$g);3===Yd&&(se.classifier=wj++,se.serviceclassifier=wj++,$g<hf&&(wf.add(0),wf.add(17)),fc.classifier=$g,fc.serviceclassifier=$g);4===Yd&&(se.people=wj++,$g<hf&&wf.add(14),fc.people=$g);5===Yd&&(se.document=wj++,$g<hf&&wf.add(15),fc.document=$g);6===Yd&&(se.findindocument=wj++,$g<hf&&wf.add(2),fc.findindocument=$g);7===
Yd&&(se.notes=wj++,$g<hf&&wf.add(20),fc.notes=$g);8===Yd&&(se.image=wj++,$g<hf&&wf.add(19),fc.image=$g)}He=new gi.a;He.add("classifier");He.add("serviceclassifier");He.add("appsforoffice");He.add("addin");He.add("findindocument");He.add("assistance");He.add("document");He.add("people");He.add("answer");He.add("wolframanswer");He.add("definition");He.add("entity");He.add("image");He.add("template");He.add("officescript");for(Fk=0;Fk<He.count;Fk++)He.J(Fk)in se||(se[He.J(Fk)]=wj++);se.learning=wj++;
se.insights=wj++;se.actionai=wj++;se.actionaicommand=wj++;se.feedback=wj++;kd&&kd.Ayi&&this.cXo(fc,hf);kd&&kd.Byi&&this.cBl(wf);wf={};for(var Mh in fc)wf[Mh]=fc[Mh]*Vd;this.K8c(se,!0,wf)}if(kd.f_d&&"Intents"in Lc&&Lc.Intents){Mh=Lc.Intents;for(var mm of Mh)if(this.RGf(mm)&&"Serplet"===mm.GroupType&&mm.ConfidenceScore>mm.ConfidenceThreshold){Mh=!1;Lc=0;if(kd.g_d){Vd=new x.a("",32);for(wf=0;wf<this.lo.length;wf++)if((He=this.lo[wf].results)&&0<He.length){Lc=wf;Vd=He[0];break}2===Vd.groupType&&(Mh=!0)}Vd=
new y.a(13);Mh&&kd.g_d&&(Vd=new y.a(13,CommonUIStrings.l_TellMeWebTitle));wf=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Dg,null,0);He=[];fc=null;fc=z.a.sha()?z.a.JNa(this.query.Dg,1):z.a.uBb(this.query.Dg);He.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",fc));fc=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Dg);He.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",fc));appChrome.api.dispatch(He);
Vd.Nw(wf);wf=[];if(Mh&&kd.g_d)for(wf.push(this.lo[Lc]),wf.push(Vd),Mh=Lc+1;Mh<this.lo.length;Mh++)(Lc=this.lo[Mh].results)&&0<Lc.length&&wf.push(this.lo[Mh]);else for(wf.push(Vd),Mh=0;Mh<this.lo.length;Mh++)(Lc=this.lo[Mh].results)&&0<Lc.length&&wf.push(this.lo[Mh]);this.mYb=wf}}if(kd.aWc&&!kd.sP){mm=Mh=-1;for(Lc=0;Lc<this.lo.length;Lc++)switch(this.lo[Lc].groupType){case 23:Mh=Lc;break;case 0:case 17:case 2:-1===mm&&(mm=Lc)}if(-1!==Mh){mm=-1===mm?0:Mh>mm?mm+1:mm;Mh=this.lo[Mh];Lc=Array(this.lo.length);
Vd=0;for(wf=0;wf<Lc.length;wf++)wf===mm?Lc[wf]=Mh:(23===this.lo[Vd].groupType&&Vd++,Lc[wf]=this.lo[Vd],Vd++);this.mYb=Lc}}Ec.resultsUpdated(this);Ec=u.TellMeActor.instance.Oe;Ec.v0(Jb.length,"RankerInference",cb.data.Qe.toString(),Math.round(window.performance.now()-ac),xk.a.Lxj,!0,An.a.zPa);this.fbc&&Ec&&(cb=this.query.gnb,Jb=Ec.Cgd,kd.w_d&&cb>Jb&&!kd.sP&&(Ec.DKf(this.query.Dg),Ec.Z$f(cb)))}}RGf(cb){if("GroupType"in cb&&cb.GroupType&&"ConfidenceScore"in cb&&"ConfidenceThreshold"in cb)return!0;u.TellMeActor.instance.Oe.onError("IsValidIntentGroup",
"Invalid intents found");return!1}qKb(cb,Jb,ac,Ec,Lc){Ec===this.eQ&&(this.NCa(),u.TellMeActor.instance.Oe.v0(Jb.length,"RankerInference",cb.data.Qe.toString(),Math.round(window.performance.now()-ac),xk.a.Lxj,!1,An.a.zPa));Lc.resultsUpdated(this)}NCa(){-1!==this.U1&&(window.clearTimeout(this.U1),this.U1=-1)}Iyo(cb){let Jb;Jb=this.pR.DO().sP?u.TellMeActor.instance.Oe.juf(this.Yme,this.query.Dg):u.TellMeActor.instance.Oe.juf(this.lo,this.query.Dg);var ac=this.pR.DO().Jfi;""!==ac&&(ac="_"+ac);let Ec=
"";this.pR.DO().nZd&&(Ec="RankerInference"+ac+",");this.pR.DO().f_d&&(Ec+="SerpletClassifier");","===Ec.charAt(Ec.length-1)&&(Ec=Ec.substring(0,Ec.length-1));ac=u.TellMeActor.instance.Oe.xhi(Ec);const Lc=this.eQ=Of.a.create().toString();ac["Client-Request-Id"]=Lc;const kd=window.performance.now(),Vd=this.pR.DO()?this.pR.DO().Lfi:600;this.NCa();this.U1=window.setTimeout(()=>{if(Lc===this.eQ){this.eQ="";this.U1=-1;cb.resultsUpdated(this);const se={};se[a.a.provider]="Ranker";se[a.a.aMb]=this.query.gnb;
u.TellMeActor.instance.Oe.JA(k.a.timedOut,Vd,se)}},Vd);this.Yf.tj(u.TellMeActor.instance.Oe.yhi(),2,Jb,ac,!1,0,se=>{this.JKb(se,this.query.Dg,kd,cb,Lc,this.pR.DO())},se=>{this.qKb(se,this.query.Dg,kd,Lc,cb)},null,null,!1,4E3,6E3)}sMo(){var cb=0,Jb=new gi.a,ac=this.pR.vLi,Ec=this.pR.wLi;for(var Lc=0;Lc<this.lo.length;Lc++){var kd=this.lo[Lc],Vd=qg.a[kd.groupType].toLowerCase(),se=ac[Vd];cb+=kd.results.length;kd.results.length>se&&(Vd=Ec[Vd],hm.c(Vd)||Jb.add(new Gm.a(Vd,kd)))}Ec=!this.query||""===this.query.Dg.trim();
Lc=cb-(Ec?this.pMf:this.nMf);if(!(0>=Lc)){Ec=window.performance.now();cb=cb.toString()+" total,"+Lc.toString()+" to remove.";if(0<Jb.count)for(Jb.Sc((He,wf)=>He.key>wf.key?-1:1),kd=0;kd<Jb.count&&0<Lc;kd++){Vd=Jb.J(kd).value;se=qg.a[Vd.groupType].toLowerCase();let He=Vd.results.length-ac[se];He>Lc&&(He=Lc);0<He&&(Vd.j5f(He),cb+=se+": "+He.toString()+" results removed.",Lc-=He)}if(0<Lc){cb+=Lc.toString()+" results left after trimming.";Jb=new gi.a;ac=this.pR.ALi;for(kd=0;kd<this.lo.length;kd++)Vd=
this.lo[kd],se=ac[qg.a[Vd.groupType].toLowerCase()],hm.c(se)||Jb.add(new Gm.a(se,Vd));Jb.Sc((He,wf)=>He.key<wf.key?-1:1);for(ac=0;0<Lc;)kd=Jb.J(ac++).value,Lc>=kd.results.length?(Array.remove(this.lo,kd),cb+=qg.a[kd.groupType]+": "+kd.results.length.toString()+" results force removed.",Lc-=kd.results.length):(kd.j5f(Lc),cb+=qg.a[kd.groupType]+": "+Lc.toString()+" results force removed.",Lc=0)}u.TellMeActor.instance.Oe&&(Jb={},Jb[a.a.message]=cb,u.TellMeActor.instance.Oe.JA("ShowOptimal",window.performance.now()-
Ec,Jb))}}}Object(l.a)(fe,"CombineResultsUpdatedEventArgs",null,[1421]);class Ti{constructor(cb,Jb,ac,Ec=!1,Lc=""){this.eNe=this.GPe=!1;this.pv=cb;this.bxb=[];this.kbh=Jb.length;this.fc=u.TellMeActor.instance.DO();this.Pmd=Ec;this.Yea=Lc;this.GZb={};for(cb=0;cb<Jb.length;++cb)this.GZb[cb.toString()]=ac?0:Jb[cb].eU()}qlo(cb,Jb){Jb&&Jb.query&&Jb.query.gnb<u.TellMeActor.instance.Tsa||(this.bxb[cb]=Jb,this.eNe?this.GPe=!0:(!this.fc||3!==this.fc.dv||3!==this.GZb[cb.toString()]||this.pRh())&&this.XWd())}LAn(){this.eNe=
!0}jQo(){this.eNe=!1;this.GPe&&(this.GPe=!1,this.XWd())}pRh(){if(this.bxb.length<this.kbh)return!1;for(let cb=0;cb<this.kbh;++cb)if(!this.bxb[cb])return!1;return!0}XWd(){var cb=this.pRh();const Jb=window.performance.now(),ac=new fe(u.TellMeActor.instance.$Wg);ac.vZn(this.bxb);for(var Ec=0;Ec<this.bxb.length;++Ec){var Lc=this.bxb[Ec];if(Lc&&Lc.lo&&Lc.lo.length&&(ac.query=Lc.query,Lc.attributes&&0<Lc.attributes.length&&(ac.attributes=Lc.attributes),Lc&&Lc.lo&&(cb||this.$Vk(Ec,this.bxb))))for(const kd of Lc.lo)ac.Uu(kd)}ac.lo&&
ac.lo.length&&(ac.fbc=cb,this.fc&&this.fc.dme&&ac.sMo(),this.fc&&this.fc.EQm&&ac.query.Dg&&0<ac.query.Dg.length?ac.Hyo():ac.Gyo(),this.fc&&(this.fc.nZd||this.fc.f_d)&&this.Pmd&&ac.query.Dg&&0<ac.query.Dg.length&&ac.fbc&&this.Yea!==f.a.contextMenu?(3===this.fc.dv&&cb||this.pv.resultsUpdated(ac),ac.Iyo(this.pv)):this.pv.resultsUpdated(ac),cb=u.TellMeActor.instance.Oe,ac.fbc&&cb&&(Ec=ac.query.gnb,Lc=cb.Cgd,ac.query.Dg&&0<ac.query.Dg.length&&this.Pmd&&this.fc.w_d&&this.Yea!==f.a.contextMenu&&Ec>Lc&&!this.fc.nZd&&
!this.fc.sP&&(cb.DKf(ac.query.Dg),cb.Z$f(Ec)),cb.JA(k.a.F6n,window.performance.now()-Jb)))}$Vk(cb,Jb){if(!(this.GZb&&cb.toString()in this.GZb)||Jb.length<=cb||!Jb[cb])return!1;if(!Jb[cb].lo.length)return!0;const ac=this.GZb[cb.toString()];if(0===ac)return!0;const Ec=this.GZb;for(let kd in Ec){var Lc=Ec[kd];const Vd=Number.parseInvariant(kd);if(Vd!==cb&&Lc===ac&&!(Jb.length>Vd&&Jb[Vd]))return!1}return!0}}Object(l.a)(Ti,"ResultsAggregator",null,[]);var Ek=c(1761);class rg{constructor(){this.plc=this.qlc=
this.olc=this.logCount=this.logRank=this.invertedRank=0}Nrk(cb,Jb){switch(cb){case 1:this.invertedRank=Jb;break;case 3:this.logRank=Jb;break;case 2:this.logCount=Jb;break;case 5:this.olc=Jb;break;case 4:this.qlc=Jb;break;case 6:this.plc=Jb}}}Object(l.a)(rg,"CommandFeatures",null,[]);class Vf{constructor(cb){this.rUg=0;this.SAa=cb;this.QYj={}}get modelId(){return this.SAa}get featureIntercept(){return this.rUg}get DGc(){return this.QYj}Lqk(cb,Jb,ac){0===Jb?this.rUg=ac:(this.DGc[cb]||(this.DGc[cb]=
new rg),this.DGc[cb].Nrk(Jb,ac))}}Object(l.a)(Vf,"CoefficientsModel",null,[]);const lh=(cb,Jb)=>Math.pow(10,-Jb/(60*Math.LN10/Math.LN2*cb));class qj{constructor(cb,Jb){this.aj=1;this.Aid=new rg;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=cb?1/cb:0;this.features.logRank=2/Math.pow(2,cb);this.features.olc=lh(10,Jb);this.features.qlc=lh(2,Jb);this.features.plc=lh(1,Jb)}get count(){return this.aj}get features(){return this.Aid}spi(){this.aj=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}RWo(cb){const Jb=2/Math.pow(2,cb);this.features.invertedRank=Math.max(this.features.invertedRank,cb?1/cb:0);this.features.logRank=Math.max(this.features.logRank,Jb)}mYo(cb){const Jb=lh(10,cb),ac=lh(2,cb);cb=lh(1,cb);this.features.olc=Math.max(this.features.olc,Jb);this.features.qlc=Math.max(this.features.qlc,ac);this.features.plc=Math.max(this.features.plc,cb)}}Object(l.a)(qj,"CommandModel",null,[]);class lm{constructor(cb){this.Ypc=null;if(!cb&&u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("PredictionEngine",
"IModelAdapter can't be null");this.aXb=cb;this.Ood=this.EJf()}EJf(){const cb=this.aXb.D2l(),Jb=this.aXb.Irf();if(void 0===cb||null===cb||void 0===Jb||null===Jb)return!1;try{window.performance.now();this.Ypc={};for(let ac=0;ac<cb.length;ac++){const Ec=cb[ac],Lc=Jb[Ec[0].toString()].trim(),kd=Ec[1],Vd=0!==kd?Jb[Ec[2].toString()].trim():"",se=Ec[3];Lc in this.Ypc||(this.Ypc[Lc]=new Vf(Lc));this.Ypc[Lc].Lqk(Vd,kd,se)}}catch(ac){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("LoadModelData",
"Error Loading Suggestions Model: "+ac);return!1}return!0}RIl(){const cb=this.aXb.$Zl(),Jb={};if(!cb)return Jb;let ac=1;for(let Ec=0;Ec<cb.length;Ec++){const Lc=cb[Ec];Lc.Id in Jb?(Jb[Lc.Id].spi(),Jb[Lc.Id].RWo(ac),Jb[Lc.Id].mYo(Lc.TimeElapsedSinceClick)):Jb[Lc.Id]=new qj(ac,Lc.TimeElapsedSinceClick);ac++}return Jb}qEf(){this.Ood||(this.Ood=this.EJf());return this.Ood}W7l(){let cb=[];if(!this.Ood){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictedCommands","IModelAdapter returned no data");
return cb}const Jb=this.RIl(),ac=this.Ypc;for(let Lc in ac){const kd=ac[Lc],Vd=kd.modelId;let se=0;for(let He in Jb){var Ec=He;const wf=Jb[He].features;(Ec=Ec in kd.DGc?kd.DGc[Ec]:null)&&(se+=wf.invertedRank*Ec.invertedRank+wf.logRank*Ec.logRank+wf.logCount*Ec.logCount+wf.olc*Ec.olc+wf.qlc*Ec.qlc+wf.plc*Ec.plc)}se+=kd.featureIntercept;cb.push(new og.a(Vd,se))}cb.sort((Lc,kd)=>Lc.score<kd.score?1:Lc.score>kd.score?-1:0);0<cb.length-10&&(cb=cb.slice(0,10));return cb}}Object(l.a)(lm,"PredictionEngine",
null,[]);class Nd{constructor(){this.oeh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}bOd(cb,
Jb){return Jb&&"word"===Jb.application.toLowerCase()&&cb in this.oeh?this.oeh[cb]:[]}}Object(l.a)(Nd,"SuggestionResultsUtility",null,[]);class Un{constructor(cb,Jb,ac){this.fc=Jb;this.jxc=new lm(cb);this.A2=ac;this.ehh=new Nd}aL(){return"Suggestion"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:2}QH(cb,Jb,ac,Ec=f.a.tellMe,Lc=null){ac=new n.a(cb);u.TellMeActor.instance.obd=!1;if((!Lc||Array.contains(Lc,16))&&z.a.cR(cb)){if(!this.jxc.qEf()){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.$Zd()&&0<this.ehh.bOd(u.TellMeActor.instance.oHd,this.fc).length){const Vd=this.ehh.bOd(u.TellMeActor.instance.oHd,this.fc);Lc=[];for(var kd of Vd)this.fc.She&&"Find"===kd||Lc.push(new og.a(kd,0));u.TellMeActor.instance.obd=!0}else Lc=this.jxc.W7l();cg.CommandResultsUtility.p2d(Lc,!0,"Recommended","LRE");kd=[];for(const Vd of Lc)this.A2&&this.A2.k9e(Vd.commandId)||
kd.push(Vd);cb=cg.CommandResultsUtility.lPc(cb,kd,this.fc,null,null,null,16,1);0<cb.results.length&&Ec!==f.a.contextMenu&&(cb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<cb.results.length&&ac.Uu(cb)}Jb.resultsUpdated(ac)}$Zd(){return!!this.fc&&(this.fc.$Zd||this.fc.PUm)}}Object(l.a)(Un,"SuggestionResultsProvider",null,[942]);class Ad{$Zl(){return u.TellMeActor.instance.wve}D2l(){return window.TellMeSuggestionModel}Irf(){return window.CoefficientModelIdMap}}Object(l.a)(Ad,"SuggestionsModelAdapter",
null,[1454]);var ml=c(1776),Pf=c(1729);c.d(K,"AggregatorResultsProvider",function(){return sg});class sg{constructor(cb=!1){this.aYb={};this.aYb[f.a.tellMe]=[];this.aYb[f.a.contextMenu]=[];this.Pmd=cb}rDi(cb,Jb,ac,Ec,Lc=null){let kd;var Vd=!1;switch(Ec){case f.a.contextMenu:kd=this.aYb[f.a.contextMenu];Vd=!0;break;default:kd=this.aYb[f.a.tellMe]}Jb=new Ti(Jb,kd,Vd,this.Pmd,Ec);Jb.LAn();for(let se=0;se<kd.length;++se){const He=window.performance.now(),wf=new H(Jb,se);(Vd=u.TellMeActor.instance.DO())&&
Vd.tLk?window.setTimeout(()=>{kd[se].QH(cb,wf,ac,Ec,Lc);if(u.TellMeActor.instance.Oe){const fc={};fc[a.a.provider]=kd[se].aL();fc[a.a.aMb]=cb.gnb;u.TellMeActor.instance.Oe.JA(k.a.QH,window.performance.now()-He,fc)}},0):(kd[se].QH(cb,wf,ac,Ec,Lc),u.TellMeActor.instance.Oe&&(Vd={},Vd[a.a.provider]=kd[se].aL(),Vd[a.a.aMb]=cb.gnb,u.TellMeActor.instance.Oe.JA(k.a.QH,window.performance.now()-He,Vd)))}Jb.jQo()}aL(){return"Aggregator"}eU(){return 0}QH(cb,Jb,ac=!1,Ec=f.a.tellMe,Lc=null){if(u.TellMeActor.instance.jdn)this.rDi(cb,
Jb,ac,Ec,Lc);else{const kd=window.performance.now();u.TellMeActor.instance.P1o.then(()=>{u.TellMeActor.instance.Oe&&u.TellMeActor.instance.Oe.JA(k.a.kdn,window.performance.now()-kd);this.rDi(cb,Jb,ac,Ec,Lc);return!0})}}EE(cb,Jb){this.aYb[Jb].push(cb)}Csk(cb){switch(cb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Jb=this.aYb[f.a.tellMe];for(const ac of Jb)if("FindInDocument"===ac.aL()){ac.Ajo(cb);break}}}static createInstance(cb,Jb,ac,Ec){const Lc=
Jb.dga;var kd=Ec&&z.a.Lcg(Jb),Vd=kd&&Jb.wWf&&!Lc;const se=Jb.yGf&&!z.a.zbc()&&!Lc,He=Jb.EEf&&!Lc,wf=new sg(kd);if(Jb.Lso&&!Lc){var fc=new ve(Jb);wf.EE(fc,f.a.tellMe)}fc=Jb.$q?be.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):be.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const hf=!fc&&be.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");wf.EE(new ak.a(cb,Jb.nOo,hf,!1),f.a.tellMe);fc&&!Lc&&wf.EE(new Un(new Ad,Jb,cb),f.a.tellMe);cb=be.AFrameworkApplication.ta.Nb.ZBi?
new vj(Jb,new Xh):new jd(Jb,ac);wf.EE(cb,f.a.contextMenu);(kd&&Jb.xWf||Vd)&&wf.EE(ml.a.QMh(Jb,!0),f.a.tellMe);wf.EE(cb,f.a.tellMe);!Jb.FZh||Lc||"Word"===Jb.application&&Jb.OLd||wf.EE(new jh(Jb),f.a.tellMe);Jb.uzb&&!Lc&&(Vd=new L(Jb),wf.EE(Vd,f.a.tellMe),wf.EE(Vd,f.a.contextMenu));!Jb.zzb||Jb.P7c||Jb.O7c||Lc||wf.EE(new I.a(Jb),f.a.tellMe);Ec&&(Jb.Q_||z.a.sha())&&(Vd=new Uf(Jb),wf.EE(Vd,f.a.tellMe),wf.EE(Vd,f.a.contextMenu));kd&&wf.EE(ml.a.QMh(Jb,!1),f.a.tellMe);Ec&&!Jb.Igg&&z.a.Kcg(Jb)&&!Lc&&(wf.EE(new Ek.a(Jb),
f.a.tellMe),Jb.awj&&wf.EE(new Ek.a(Jb),f.a.contextMenu));se&&wf.EE(new sh(Jb),f.a.tellMe);!Jb.ujc&&!Jb.sP||Lc||wf.EE(new ag.a(Jb),f.a.tellMe);Jb.aWc&&!Lc&&wf.EE(new Pf.a(Jb),f.a.tellMe);Jb.gXd&&(kd=new F(Jb),wf.EE(kd,f.a.tellMe),wf.EE(kd,f.a.contextMenu));Ec&&Jb.kXd&&!Lc&&wf.EE(new G.AddinResultsProvider(Jb),f.a.tellMe);He&&"Excel"===Jb.application&&!Lc&&wf.EE(new ll(Jb),f.a.tellMe);return wf}}Object(l.a)(sg,"AggregatorResultsProvider",null,[942])},1754:function(E,K,c){E=c(0);var l=c(15),f=c(6),a=
c(168),k=c(223),x=c(365),y=c(58),n=c(73),u=c(940),z=c(859),w=c(532);c(464);var F=c(1719),G=c(1720),H=c(1716),L=c(1718),I=c(1717),N=c(939),P=c(858);class M{constructor(qa,La,Pa){this.jIl=qa;this.NIk=La;this.cUk=Pa}}Object(E.a)(M,"BacktraceAndMakeUpdateHintsInput",null,[]);var J=c(1542),V;(function(qa){qa[qa.EOP=0]="EOP";qa[qa.character=1]="character";qa[qa.embeddedMarker=2]="embeddedMarker"})(V||(V={}));Object(E.b)("LCSBlockType",V);class X{toString(){return String.format("[Type: {0}]",V[this.type])}}
Object(E.a)(X,"ALCSBlock",null,[]);class W extends X{constructor(qa,La){super();this.Gue=La;this.PMe=qa}get type(){return 1}get character(){return this.Gue}get Pv(){return this.PMe}BA(qa){return 1===qa.type&&J.a.huh(qa.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(E.a)(W,"CharacterLCSBlock",X,[]);class U extends X{constructor(qa,La,Pa){super();this.PMe=qa;this.lXe=La;this.mwc=Pa}get type(){return 0}get Lc(){return this.lXe}get length(){return this.mwc}get Pv(){return this.PMe}BA(qa){return 0!==
qa.type?!1:qa.Pv===this.Pv&&qa.Lc===this.Lc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.Pv.toString(),this.Lc,this.length)}}Object(E.a)(U,"EOPLCSBlock",X,[]);class Y extends W{constructor(qa,La,Pa){super(qa,"\ufffc");this.X$j=La;this.mjd=Pa}get type(){return 2}get xg(){return this.X$j}get Qj(){return this.mjd}BA(qa){return 2!==qa.type?!1:qa.xg===this.xg&&this.Qj.equals(qa.Qj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.xg,this.Qj)}}Object(E.a)(Y,"EmbeddedMarkerLCSBlock",W,[]);class ca{constructor(qa,La){this.x=qa;this.y=La}equals(qa){return qa.x===this.x&&qa.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(E.a)(ca,"IntPair",null,[1028]);var aa=c(1582),fa=c(1564),pa=c(1583),ra=c(1715);c.d(K,"a",function(){return la});class la{constructor(qa,La){this.Mg=qa;this.Yd=La}aNh(qa,La,Pa,Ka,Na,sa,wa){return this.mel(qa,La,Pa,Ka,Na,sa,wa)}mel(qa,La,Pa,Ka,Na,sa,wa){let ja;ja=null;({returnValue:qa}=this.UPd(qa,
La));if(!qa)return a.a.instance.Ta(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Yd.logger.EU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ja};({returnValue:Pa}=this.UPd(Pa,Ka));if(!Pa)return a.a.instance.Ta(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Yd.logger.EU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ja};this.Yd.logger.EU("GetLCSBlocksFromObject");ja=this.lel(qa,Pa,Na,sa,wa);return ja?{returnValue:!0,updateHints:ja}:(a.a.instance.Ta(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ja})}uZh(qa,La,Pa,Ka){({returnValue:qa}=this.UPd(qa,La));if(!qa)return-1;({returnValue:Pa}=this.UPd(Pa,Ka));if(!Pa)return-1;({tcf:Pa}=this.yZh(qa,Pa));return Pa}UPd(qa,La){let Pa;const Ka=new k.a;Pa=new k.a;if(!qa.length)return a.a.instance.Ta(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Yd.logger.Og(Object.assign(new aa.a,{qj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,eif:Pa};for(let wa=0;wa<
qa.length;wa++)if(this.Yd.runtime.SG("GetLCSBlocksFromObject: paraObjs#"+wa),393230===qa.J(wa).Qc){const ja=this.Mg.getPropertyString(qa.J(wa),l.a.mo),ha=this.Mg.getPropertyUint32(qa.J(wa),f.a.Lc);if(null==ha)return a.a.instance.Ta(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Yd.logger.Og(Object.assign(new aa.a,{qj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,eif:Pa};let va=this.Mg.getPropertyUint32s(qa.J(wa),l.a.zm);va=fa.a.pmj(va,ja.length);const xa=this.Mg.getPropertyObjectIds(qa.J(wa),
l.a.Hn);let ma;for(ma=0;ma<va.length-1;ma++){var Na=La(xa.eg(ma)),sa=void 0;sa=Na?(sa=this.Mg.getPropertyBool(Na,l.a.e$))?sa:!1:!1;if(sa)Ka.add(this.K9k(qa.J(wa).id,Na));else for(Na=va.eg(ma);Na<va.eg(ma+1);Na++)Ka.add(new W(qa.J(wa).id,J.a.charAt(ja,Na)))}Ka.add(new U(qa.J(wa).id,ha,va.J(ma)));Pa.add(Ka.length-1)}else return a.a.instance.Ta(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",qa.J(wa).Qc),this.Yd.logger.Og(Object.assign(new aa.a,{qj:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,eif:Pa};this.Yd.runtime.SG("LCS: GetLCSBlocks for base");return{returnValue:Ka,eif:Pa}}K9k(qa,La){const Pa=null==this.Mg.getPropertyInt32(La,f.a.gt)?0:this.Mg.getPropertyInt32(La,f.a.gt);return new Y(qa,Pa,La.id)}lel(qa,La,Pa,Ka,Na){Ka=({tcf:Pa}=this.yZh(qa,La,Pa,Ka,Na)).returnValue;this.Yd.logger.EU("FindFurthestPaths");qa=new M(Ka,qa,La);qa=new ra.a(this.CIk(qa,Pa),1);this.Yd.logger.EU("BacktraceAndMakeUpdateHints");return qa}yZh(qa,La,Pa=-1,Ka=-1,Na=-1){let sa;
if(-1===Pa||-1===Ka||-1===Na)Na=Ka=Pa=-1;sa=-1;const wa=new x.a;wa.Z(new ca(-1,1),new ca(0,-1));if(-1!==Pa){wa.Z(new ca(0,0),new ca(Pa,Pa));var ja=1}else ja=0,Ka=qa.length,Na=La.length;for(Pa=0;ja<=qa.length+La.length;ja++){let ha=!1;for(let va=-ja;va<=ja;va+=2){let xa,ma;va===-ja?(xa=wa.J(new ca(ja-1,va+1)).x,ma=wa.J(new ca(ja-1,va+1)).y+1):va===ja?(xa=wa.J(new ca(ja-1,va-1)).x+1,ma=wa.J(new ca(ja-1,va-1)).y):wa.J(new ca(ja-1,va-1)).x>=wa.J(new ca(ja-1,va+1)).x?(xa=wa.J(new ca(ja-1,va-1)).x+1,ma=
wa.J(new ca(ja-1,va-1)).y):(xa=wa.J(new ca(ja-1,va+1)).x,ma=wa.J(new ca(ja-1,va+1)).y+1);for(;xa<Ka&&ma<Na&&qa.J(xa).BA(La.J(ma));)xa++,ma++;wa.Z(new ca(ja,va),new ca(xa,ma));if(xa===Ka&&ma===Na){ha=!0;sa=ja;Pa=va;break}}if(ha)break;this.Yd.runtime.SG("LCS FindFurthestPaths")}if(Pa!==Ka-Na)return{returnValue:null,tcf:sa};wa.Z(new ca(sa,Pa),new ca(Ka+1,Na+1));a.a.instance.Ta(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",qa.length,La.length,
sa);return{returnValue:wa,tcf:sa}}CIk(qa,La){const Pa=qa.jIl,Ka=qa.NIk;qa=qa.cUk;const Na=new k.a;let sa=Ka.length,wa=qa.length;for(;0<sa||0<wa;){var ja=sa-1,ha=wa-1;if(this.KAn(Pa,La,sa,wa)){ja=qa.J(ha);if(1===ja.type||2===ja.type)this.iCm(Na,sa,ja);else if(0===ja.type)this.HBm(Na,sa,ja);else return a.a.instance.Ta(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ja.type),this.Yd.logger.Og(Object.assign(new pa.a,{qj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;wa--;
La--}else if(this.JAn(Pa,La,sa,wa)){ha=Ka.J(ja);if(1===ha.type||2===ha.type)this.Pjl(Na,ja,ha);else if(0===ha.type)this.vjl(Na,ja,ha);else return a.a.instance.Ta(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",ha.type),this.Yd.logger.Og(Object.assign(new pa.a,{qj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;sa--;La--}else if(sa&&wa&&Ka.J(ja).BA(qa.J(ha)))sa--,wa--;else return a.a.instance.Ta(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Yd.logger.Og(Object.assign(new pa.a,
{qj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Yd.runtime.SG("LCS: CreateUpdateHintsFromLCSBlocks");return Na}JAn(qa,La,Pa,Ka){La=new ca(La-1,Pa-Ka-1);return qa.nb(La)&&qa.J(La).x===Pa-1&&qa.J(La).y===Ka}KAn(qa,La,Pa,Ka){La=new ca(La-1,Pa-Ka+1);return qa.nb(La)&&qa.J(La).x===Pa&&qa.J(La).y===Ka-1}addPara(qa,La,Pa,Ka,Na,sa){var wa=null;Pa.block?wa=Pa.block.Pv:0<=Na&&0===qa.J(Na).type&&(wa=qa.J(Na).Pv);Pa=qa=sa.Pv;if(Ka.G0b.contains(qa))for(Na=0,qa=y.a.Ff("{00000000-0000-0000-0000-000000000000}{"+
Na+"}");Ka.G0b.contains(qa);)Na++,qa=y.a.Ff("{00000000-0000-0000-0000-000000000000}{"+Na+"}");wa=new u.AddParagraphUpdateHint(qa,sa.Lc,wa);wa.Awn=Pa;La.updateHints.add(wa);Ka.Pv=qa;Ka.Lc=sa.Lc;Ka.G0b.add(qa);Ka.JRa=0}HBm(qa,La,Pa){Pa=new H.a(Pa.Pv,Pa.Lc);let Ka=!1;if(0<qa.length&&11===qa.eg(qa.length-1).type){const Na=qa.eg(qa.length-1);Na.cp===La&&(Ka=!0,Na.K_.add(Pa))}Ka||(La=new I.a(La),La.K_.add(Pa),qa.add(La))}splitPara(qa,La,Pa,Ka,Na,sa,wa,ja){qa=this.uCl(sa.Pv,qa,La,Ka);if(!qa)return!1;La=
new P.a(sa.Pv,sa.Lc,sa.JRa,qa.Pv,qa.Lc,wa.Pv,wa.Lc);Pa.updateHints.add(La);sa.Lc=qa.Lc;qa!==ja?(Na.block=qa,Na.Jcp=sa.JRa,Na=new u.AddParagraphUpdateHint(ja.Pv,ja.Lc,qa.Pv),Pa.updateHints.add(Na),sa.Pv=ja.Pv,sa.Lc=ja.Lc,sa.G0b.add(ja.Pv),sa.JRa=0):sa.G0b.add(wa.Pv);return!0}iCm(qa,La,Pa){var Ka=!1;if(0<qa.length&&11===qa.eg(qa.length-1).type){const Na=qa.eg(qa.length-1);Na.cp===La&&((Ka=Object(n.a)(L.a,Na.K_.J(Na.K_.length-1)))?Ka.text=Pa.character.toString()+Ka.text:Na.K_.add(new L.a(Pa.Pv,Pa.character.toString())),
Ka=!0)}Ka||(La=new I.a(La),La.K_.add(new L.a(Pa.Pv,Pa.character.toString())),qa.add(La))}deletePara(qa,La,Pa,Ka,Na,sa){let wa=-1;for(let ja=0;ja<Na.length;ja++)if(Na.J(ja)===sa){0<ja&&(wa=ja-1);break}sa=null;0<=wa&&(sa=Ka.J(Na.J(wa)));Ka=new z.a(Pa.Pv,Pa.Lc,sa?sa.Pv:null);qa.updateHints.add(Ka);sa&&La.Pv.equals(Pa.Pv)&&(La.JRa=sa.length,La.Pv=sa.Pv,La.Lc=sa.Lc);La.G0b.remove(Pa.Pv)}vjl(qa,La,Pa){La=new F.a(La,Pa.Pv,Pa.Lc);qa.add(La)}mergePara(qa,La,Pa){qa.updateHints.add(new N.MergeParagraphUpdateHint(Pa.Pv,
Pa.Lc,Pa.length,La.Pv,La.Lc,Pa.Pv,La.Lc));La.JRa=Pa.length;La.G0b.remove(La.Pv);La.Pv=Pa.Pv}deleteText(qa,La,Pa){let Ka=!1;if(0<qa.updateHints.length&&2===qa.updateHints.eg(qa.updateHints.length-1).type){const Na=qa.updateHints.eg(qa.updateHints.length-1);Na.yg.equals(La.Pv)&&Na.cp===La.JRa&&(Na.cp=La.JRa-1,Na.text=Pa.character.toString()+Na.text,Ka=!0)}Ka||qa.updateHints.add(new w.DeleteTextUpdateHint(La.Pv,La.JRa-1,Pa.character.toString()));--La.JRa}Pjl(qa,La,Pa){let Ka=!1;if(0<qa.length&&8===qa.eg(qa.length-
1).type){const Na=qa.eg(qa.length-1);Na.cp===La+1&&(Na.text=Pa.character.toString()+Na.text,--Na.cp,Ka=!0)}Ka||qa.add(new G.a(La,Pa.character.toString()))}uCl(qa,La,Pa,Ka){for(;0<=Ka;){var Na=La.J(Pa.J(Ka));if(0!==Na.type)break;if(Na.Pv.equals(qa))return Na;Ka--}return null}}Object(E.a)(la,"LCSUpdateHintGenerator",null,[])},1760:function(E,K,c){c.r(K);E=c(0);var l=c(15),f=c(6),a=c(168),k=c(365),x=c(602),y=c(223),n=c(58),u=c(55),z=c(1531);class w extends z.a{constructor(){super()}get lga(){return"ChildNodeListMerge"}}
Object(E.a)(w,"ChildNodeListMergeFailureDetail",z.a,[]);class F{$pb(ca,aa,fa){return aa.lz(ca,fa.J(ca))}KBj(ca,aa,fa,pa){let ra;return({value:ra}=aa.Dc(ca)).returnValue||({value:ra}=fa.Dc(ca)).returnValue?ra:pa.J(ca)}}Object(E.a)(F,"ChildNodeListMergeUtils",null,[997]);var G=c(1558),H=c(1775),L=c(1629);class I{constructor(ca,aa){this.classId=ca;this.OOo=aa}}Object(E.a)(I,"NodeChildrenTransformation",null,[]);var N=c(800),P=c(1548);class M{constructor(ca,aa,fa){this.KE=ca;this.Uqa=fa;this.e8=aa}sae(ca){let aa,
fa;return({a4i:aa}=this.PBj(this.Uqa,ca)).returnValue&&aa.bY||({a4i:fa}=this.PBj(this.e8,ca)).returnValue&&fa.bY}PBj(ca,aa){let fa;return{returnValue:({value:fa}=(new P.a(this.KE,ca)).Mpa.Dc(N.a.yb(aa))).returnValue,a4i:fa}}}Object(E.a)(M,"NodeTriplet",null,[]);var J=c(1714);class V{constructor(ca,aa,fa){this.Yd=ca;this.Mg=aa;this.c7=fa;this.$gh=!0}get iq(){return this.Yd}get Zd(){return this.Mg}get mza(){return this.c7}get success(){return this.$gh}f7l(){a.a.instance.Ta(4220310,1,5,"Evaluating ParentObjects");
const ca=new k.a;this.B4e(ca,aa=>this.iq.runtime.sk.J(aa));this.B4e(ca,aa=>this.mza.$pb(aa,this.iq.runtime.zu,this.iq.runtime.sk));this.B4e(ca,aa=>this.mza.$pb(aa,this.iq.runtime.Iq,this.iq.runtime.sk));return ca}B4e(ca,aa){const fa=aa(c(1760).ChildNodeListMerge.W8d);this.Zd.getPropertyObjectIds(fa,l.a.ef).forEach(pa=>{this.Zd.getPropertyObjectIds(aa(pa),l.a.ef).forEach(ra=>{ca.nb(ra)&&!pa.equals(ca.J(ra))&&(this.$gh=!1,a.a.instance.Ta(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
ra,pa,ca.J(ra)));ca.Z(ra,pa);return!0});return!0})}}Object(E.a)(V,"OutlineGroupParentFinder",null,[]);var X=c(1532),W=c(1584),U=c(1630);c.d(K,"ChildNodeListMerge",function(){return Y});class Y{constructor(ca,aa=null,fa=null,pa=null,ra=null){this.Mg=ca;this.Zyn=aa||H.a.jCj;this.j5d=fa||this.i4l();this.mza=pa||new F;this.vNi=ra||this.g2l()}get Zd(){return this.Mg}i4l(){return[new I(393227,Object(u.a)(this,this.Jxn,"pageContentNodeThreewayChildMerge")),new I(1073872968,Object(u.a)(this,this.P5o,"wordSectionNodeThreewayChildMerge")),
new I(393241,Object(u.a)(this,this.N8d,"outlineElementContainerThreewayChildMerge")),new I(393252,Object(u.a)(this,this.nFo,"tableCellThreewayChildMergev2")),new I(1074135125,Object(u.a)(this,this.N8d,"outlineElementContainerThreewayChildMerge")),new I(1074135123,Object(u.a)(this,this.N8d,"outlineElementContainerThreewayChildMerge")),new I(1074135127,Object(u.a)(this,this.N8d,"outlineElementContainerThreewayChildMerge"))]}g2l(){return[Object(u.a)(this,this.lFn,"prepareObjectGroupings"),Object(u.a)(this,
this.Imm,"handleInterOutlineGroupMerge"),Object(u.a)(this,this.nBn,"performThreewayChildMerge")]}tbn(ca){let aa=0;for(;aa<this.vNi.length;aa++)if(!(0,this.vNi[aa])(ca))return a.a.instance.Ta(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",aa),ca.logger.y2d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",aa),!1;return!0}lFn(ca){const aa=new k.a,fa=new k.a,pa=new x.a;ca.runtime.zu.forEach((ra,la)=>Y.M_i(la,aa));ca.runtime.Iq.forEach((ra,la)=>Y.M_i(la,fa));for(let ra=0;ra<this.j5d.length;ra++){const la=
this.j5d[ra].classId;ca.runtime.Elb.Z(la,new k.a);aa.nb(la)&&aa.J(la).forEach(qa=>{var La=ca.runtime.sk.J(qa.id);La&&(La=new M(La,qa,ca.runtime.Iq.lz(qa.id,La)),ca.runtime.Elb.J(la).add(qa.id,La),pa.add(qa.id));return!0});fa.nb(la)&&fa.J(la).forEach(qa=>{if(pa.contains(qa.id))return!0;const La=ca.runtime.sk.J(qa.id);La&&ca.runtime.Elb.J(la).add(qa.id,new M(La,La,qa));return!0})}ca.runtime.SG("PrepareObjectGroupings");ca.logger.Gha("PrepareObjectGroupings");return!0}nBn(ca){let aa=!0;for(let fa=0;aa&&
fa<this.j5d.length;fa++){const pa=this.j5d[fa];ca.runtime.SG("Before function#"+fa);const ra=pa.classId;ca.runtime.Elb.J(ra).forEach((la,qa)=>{ca.runtime.iNa.contains(qa.KE.id)||(aa=pa.OOo(ca,qa)&&aa);aa||(a.a.instance.Ta(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ra,qa.KE.id),ca.logger.Og(Object.assign(new w,{qj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return aa});ca.runtime.SG("PerformThreewayChildMerge"+fa)}ca.logger.Gha("PerformThreewayChildMerge");
return aa}Jxn(ca,aa){if(aa.sae(l.a.ef)){var fa=this.Zd.getPropertyObjectIds(aa.KE,l.a.ef);const pa=this.Zd.getPropertyObjectIds(aa.e8,l.a.ef);aa=this.Zd.getPropertyObjectIds(aa.Uqa,l.a.ef);fa=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",fa.length,pa.length,aa.length,ca.input.source);a.a.instance.Ta(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",fa);ca.logger.Og(Object.assign(new w,{qj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:fa}));return!1}return!0}P5o(ca,aa){if(aa.sae(l.a.ef)){const Pa=new x.a,Ka=new x.a,Na=new x.a,sa=new x.a;var fa=this.Zd.getPropertyObjectIds(aa.KE,l.a.ef),pa=fa.TG(),ra,la=({zJh:ra}=this.iJj(aa.e8,pa,Pa,"Favored")).returnValue,qa=({zJh:La}=this.iJj(aa.Uqa,pa,Ka,"Unfavored")).returnValue;if(!la||!qa)return fa=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
pa.count,Pa.count,Ka.count,ra,La),ca.logger.Og(Object.assign(new w,{qj:"WordSectionNodeThreewayChildMerge",info:fa})),!1;fa.forEach(wa=>{Pa.contains(wa)||Na.add(wa);Ka.contains(wa)||sa.add(wa);return!0});aa=aa.KE.IK();pa=new y.a;for(ra=0;ra<fa.length;ra++){var La=fa.eg(ra);if(Na.contains(La)||sa.contains(La)){if(ca.runtime.iNa.add(La),pa.length&&(la=pa.eg(pa.length-1),la=ca.runtime.Elb.J(393241).J(la),qa=ca.runtime.Elb.J(393241).J(La),la&&qa))Na.contains(La)?sa.contains(La)||(la.KE=la.KE.IK(),la.Uqa=
la.Uqa.IK(),this.nAd(la.KE,qa.KE),this.nAd(la.Uqa,qa.Uqa)):(la.KE=la.KE.IK(),la.e8=la.e8.IK(),this.nAd(la.KE,qa.KE),this.nAd(la.e8,qa.e8))}else pa.add(La)}this.Zd.setPropertyObjectIds(aa,l.a.ef,pa);fa=new X.a(aa);fa.qC(l.a.ef);ca.runtime.fn.Z(aa.id,fa)}return!0}nAd(ca,aa){const fa=this.Zd.getPropertyObjectIds(ca,l.a.ef);aa=this.Zd.getPropertyObjectIds(aa,l.a.ef);const pa=fa.k5();aa.forEach(ra=>{pa.add(ra);return!0});this.Zd.setPropertyObjectIds(ca,l.a.ef,pa)}iJj(ca,aa,fa,pa){let ra=0,la=!0;this.Zd.getPropertyObjectIds(ca,
l.a.ef).forEach(qa=>{aa.contains(qa)?fa.add(qa):(la=!1,a.a.instance.Ta(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",pa,qa),ra++);return!0});return{returnValue:la,zJh:ra}}Imm(ca){let aa=!0;ca.runtime.Elb.J(393241).forEach((fa,pa)=>{if(this.VLm(pa)){a.a.instance.Ta(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",pa.KE.id);let ra;const la=new V(ca,this.Zd,this.mza);if(({YYi:fa,UKj:ra}=this.iNo(ca,la.f7l(),pa)).returnValue)return a.a.instance.Ta(4220303,1,
4,"Merging WordSection {0} as a unit.",ra),aa=la.success&&this.jcn(ca,ra,fa)&&aa,aa||(a.a.instance.Ta(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",pa.KE.id,la.success),ca.logger.Og(Object.assign(new w,{qj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",la.success)}))),aa}return!0});return aa}VLm(ca){if(!ca.sae(l.a.ef))return!1;const aa=this.Zd.getPropertyObjectIds(ca.KE,l.a.ef).J(0),
fa=this.Zd.getPropertyObjectIds(ca.e8,l.a.ef);ca=this.Zd.getPropertyObjectIds(ca.Uqa,l.a.ef);return!fa.contains(aa,(pa,ra)=>pa.equals(ra))||!ca.contains(aa,(pa,ra)=>pa.equals(ra))}iNo(ca,aa,fa){aa=aa.J(fa.KE.id);a.a.instance.Ta(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",fa.KE.id,aa);if(ca.runtime.iNa.contains(aa))return a.a.instance.Ta(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
aa),{returnValue:!1,YYi:null,UKj:aa};const pa=new J.a;fa=ca.runtime.sk.J(aa);this.Zd.getPropertyObjectIds(fa,l.a.ef).forEach(ra=>{pa.mAd(ra);return!0});fa=this.mza.$pb(aa,ca.runtime.zu,ca.runtime.sk);this.Zd.getPropertyObjectIds(fa,l.a.ef).forEach(ra=>{pa.oAd(ra);return!0});ca=this.mza.$pb(aa,ca.runtime.Iq,ca.runtime.sk);this.Zd.getPropertyObjectIds(ca,l.a.ef).forEach(ra=>{pa.sAd(ra);return!0});return{returnValue:!0,YYi:pa,UKj:aa}}h_f(ca,aa,fa,pa,ra){let la=!0;ca.forEach(qa=>{const La=aa(qa);this.Zd.getPropertyObjectIds(La,
l.a.ef).forEach(Pa=>{fa.add(Pa);if(pa.nb(Pa))return(la=pa.J(Pa).equals(qa)&&la)||a.a.instance.Ta(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ra,Pa,qa,pa.J(Pa)),la;pa.Z(Pa,qa);return!0});return!0});return la}v5l(ca,aa){let fa,pa,ra,la;fa=new y.a;pa=new y.a;ra=new y.a;la=new k.a;const qa=ca.runtime.sk;return this.h_f(aa.Dzb,La=>qa.J(La),fa,la,"Base")&&this.h_f(aa.kjf,La=>this.mza.$pb(La,ca.runtime.zu,qa),pa,la,"Favored")&&
this.h_f(aa.cqb,La=>this.mza.$pb(La,ca.runtime.Iq,qa),ra,la,"Unfavored")?{returnValue:!0,Jvh:fa,oYh:pa,eDj:ra,BRi:la}:{returnValue:!1,Jvh:fa,oYh:pa,eDj:ra,BRi:la}}qDl(ca,aa,fa,pa){let ra=!0;const la=ca.runtime.sk,qa=ca.runtime.zu,La=ca.runtime.Iq,Pa=ca.runtime.fn,Ka=new y.a,Na=new k.a;fa.forEach(sa=>{const wa=pa.J(sa);if(!wa)return a.a.instance.Ta(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",sa),ca.logger.Og(Object.assign(new w,{qj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),ra=!1;wa.equals(Ka.last())||(Ka.add(wa),Na.add(wa,new y.a));Na.J(wa).add(sa);ca.runtime.iNa.add(sa);return!0});if(!ra)return!1;Na.forEach((sa,wa)=>{const ja=this.mza.KBj(sa,qa,La,la).IK();this.Zd.setPropertyObjectIds(ja,l.a.ef,wa);Pa.Z(sa,new X.a(ja));Pa.J(sa).qC(l.a.ef);ca.runtime.iNa.add(sa);return ra});fa=this.mza.KBj(aa,qa,La,la).IK();this.Zd.setPropertyObjectIds(fa,l.a.ef,Ka);Pa.Z(aa,new X.a(fa));Pa.J(aa).qC(l.a.ef);ca.runtime.iNa.add(aa);return ra}jcn(ca,aa,fa){let pa,ra;
if(!({Jvh:la,oYh:pa,eDj:ra,BRi:fa}=this.v5l(ca,fa)).returnValue)return!1;var la=G.b(la,pa,ra);la=this.RWf(ca,la);return!!la&&this.qDl(ca,aa,la,fa)}N8d(ca,aa){return this.UYi(ca,aa)}UYi(ca,aa){if(aa.sae(l.a.ef)){var fa=this.r5l(aa);fa=this.RWf(ca,fa);if(!fa)return a.a.instance.Ta(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.KE.id),ca.logger.Og(Object.assign(new w,
{qj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),L.a(aa.KE,"OutlineElementContainerThreewayChildMerge_Base",1),L.a(aa.e8,"OutlineElementContainerThreewayChildMerge_Favored",1),L.a(aa.Uqa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var pa=this.Zd.getPropertyObjectIds(aa.KE,l.a.ef);const ra=fa.TG();pa.forEach(la=>{ra.contains(la)||(la=this.Zd.getPropertyObjectIds(aa.KE,l.a.KK),0<la.length&&ca.runtime.BXf.add(la.J(0)));return!0});pa=aa.e8.IK();this.Zd.setPropertyObjectIds(pa,
l.a.ef,fa);ca.runtime.fn.Z(pa.id,new X.a(pa));ca.runtime.fn.J(pa.id).qC(l.a.ef)}return!0}ZHb(ca){if(!ca)return a.a.instance.Ta(573957964,1,2,"Feature helper is null"),!1;ca.uz(105);return ca.isFeatureEnabled(105)}nFo(ca,aa){if(!this.ZHb(ca.runtime.Xb))return this.xhg(ca,aa);var fa=aa.KE.id,pa=U.e(ca,aa.KE,null);if(pa.equals(n.a.nil))return a.a.instance.Ta(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",fa),ca.logger.Og(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),
!1;var ra=ca.runtime.MAb.J(pa);if(ra&&(ra=ra.J(fa)))if(ra.hg)aa=aa.e8.IK(),aa.removeProperty(l.a.ef),this.Zd.setPropertyBool(aa,f.a.ghostCell,!0),null!=ra.colSpan?this.Zd.setPropertyUint32(aa,f.a.colSpan,ra.colSpan):aa.removeProperty(f.a.colSpan),ca.runtime.fn.Z(aa.id,new X.a(aa)),ca.runtime.fn.J(aa.id).qC(l.a.ef),ca.runtime.fn.J(aa.id).qC(f.a.ghostCell),ca.runtime.fn.J(aa.id).qC(f.a.colSpan);else{let la,qa;({gBd:pa,oLd:la,Sme:qa}=this.f1l(ca,aa,ra,pa));if(!la.length&&!qa.length)return a.a.instance.Ta(573957966,
1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",fa),ca.logger.Og(Object.assign(new W.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;la.length?qa.length?(fa=G.b(pa,la,qa),fa=this.RWf(ca,fa)):fa=la:fa=qa;if(!fa)return a.a.instance.Ta(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.KE.id),ca.logger.Og(Object.assign(new w,
{qj:"TableCellThreewayChildMergev2",eventId:"8n426"})),L.a(aa.KE,"TableCellThreewayChildMergev2_Base",1),L.a(aa.e8,"TableCellThreewayChildMergev2_Favored",1),L.a(aa.Uqa,"TableCellThreewayChildMergev2_Unfavored",1),!1;aa=aa.e8.IK();this.Zd.setPropertyObjectIds(aa,l.a.ef,fa);aa.removeProperty(f.a.ghostCell);fa=ra.rowSpan;ra=ra.colSpan;null!=fa&&null!=ra&&(1<fa||1<ra)?(this.Zd.setPropertyUint32(aa,f.a.rowSpan,fa),this.Zd.setPropertyUint32(aa,f.a.colSpan,ra)):(aa.removeProperty(f.a.rowSpan),aa.removeProperty(f.a.colSpan));
ca.runtime.fn.Z(aa.id,new X.a(aa));ca.runtime.fn.J(aa.id).qC(l.a.ef);ca.runtime.fn.J(aa.id).qC(f.a.ghostCell);ca.runtime.fn.J(aa.id).qC(f.a.rowSpan);ca.runtime.fn.J(aa.id).qC(f.a.colSpan)}else return this.xhg(ca,aa);ca.logger.Gha("TableCellThreewayChildMergev2");return!0}f1l(ca,aa,fa,pa){let ra,la;({gBd:aa,oLd:ra,Sme:la}=this.H7h(aa));aa||(aa=new y.a);ra||(ra=new y.a);la||(la=new y.a);var qa=aa.TG(),La=ra.TG(),Pa=la.TG(),Ka=fa.K5d;if(Ka)for(var Na=0;Na<Ka.length;Na++){var sa=Ka.J(Na),wa=ca.runtime.sk.J(sa);
!qa.contains(sa)&&wa&&(qa.add(sa),aa.add(sa));!La.contains(sa)&&ca.runtime.zu.lz(sa,wa)&&(La.add(sa),ra.add(sa));!Pa.contains(sa)&&ca.runtime.Iq.lz(sa,wa)&&(Pa.add(sa),la.add(sa))}ca.logger.Gha("OENodesAddedToChildrenList");if(Ka=fa.Hvf)for(Na=0;Na<Ka.length;Na++)if(sa=Ka.J(Na),wa=ca.runtime.sk.J(sa)){var ja=this.Zd.getPropertyObjectIds(wa,l.a.ef);if(ja)for(var ha=0;ha<ja.length;ha++){var va=ja.J(ha);qa.contains(va)||(qa.add(va),aa.add(va))}ja=ca.runtime.zu.lz(sa,wa);if(ja=this.Zd.getPropertyObjectIds(ja,
l.a.ef))for(ha=0;ha<ja.length;ha++)va=ja.J(ha),La.contains(va)||(La.add(va),ra.add(va));sa=ca.runtime.Iq.lz(sa,wa);if(sa=this.Zd.getPropertyObjectIds(sa,l.a.ef))for(wa=0;wa<sa.length;wa++)ja=sa.J(wa),Pa.contains(ja)||(Pa.add(ja),la.add(ja))}ca.logger.Gha("GhostCellOENodesAddedToChildrenList");if(fa=fa.WQf)for(qa=0;qa<fa.length;qa++)if(La=fa.J(qa),La=ca.runtime.MAb.J(pa).J(La))if(La=La.K5d){La=La.TG();Pa=new y.a;for(Ka=0;Ka<aa.length;Ka++)La.contains(aa.J(Ka))||Pa.add(aa.J(Ka));aa=Pa;Pa=new y.a;for(Ka=
0;Ka<ra.length;Ka++)La.contains(ra.J(Ka))||Pa.add(ra.J(Ka));ra=Pa;Pa=new y.a;for(Ka=0;Ka<la.length;Ka++)La.contains(la.J(Ka))||Pa.add(la.J(Ka));la=Pa}ca.logger.Gha("NonGhostCellsOENodesRemovedFromChildrenList");return{gBd:aa,oLd:ra,Sme:la}}xhg(ca,aa){let fa=aa.e8.hasProperty(l.a.ef),pa=aa.Uqa.hasProperty(l.a.ef);fa&&(fa=!!this.Zd.getPropertyObjectIds(aa.e8,l.a.ef).length);pa&&(pa=!!this.Zd.getPropertyObjectIds(aa.Uqa,l.a.ef).length);if(fa!==pa)if(this.zSm(ca.runtime.Xb))ca.logger.yIi(Object.assign(new W.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return ca.logger.Og(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.UYi(ca,aa)}r5l(ca){let aa,fa;({gBd:ca,oLd:aa,Sme:fa}=this.H7h(ca));return G.b(ca,aa,fa)}RWf(ca,aa){a.a.instance.Ta(4220309,1,5,"Considering {0} OutlineElement collections for merge.",aa.length);const fa=new y.a;let pa=!0;aa.forEach(ra=>{if(!ra)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
ca.logger.Og(Object.assign(new w,{qj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),pa=!1;if(1===ra.Xcn&&1===ra.hlb){const ja=ra.Dzb.J(0),ha=ra.kjf.J(0),va=ra.cqb.J(0);if(ja&&ja.equals(ha)&&ja.equals(va))return fa.add(ja),!0;if(1!==aa.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ja,ha,va,aa.length),
ca.logger.Og(Object.assign(new w,{qj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),pa=!1}const la=new k.a,qa=new y.a,La=new y.a,Pa=new y.a,Ka=new y.a,Na=new y.a,sa=new y.a,wa=ca.runtime.sk;ra.Dzb.forEach(ja=>pa=this.c0f(ca,ja,ha=>wa.J(ha),qa,Ka,la,"Base"));if(!pa)return a.a.instance.Ta(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ca.logger.Og(Object.assign(new w,{qj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),
!1;ra.kjf.forEach(ja=>pa=this.c0f(ca,ja,ha=>this.mza.$pb(ha,ca.runtime.zu,wa),La,Na,la,"Favored"));if(!pa)return a.a.instance.Ta(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),ca.logger.Og(Object.assign(new w,{qj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ra.cqb.forEach(ja=>pa=this.c0f(ca,ja,ha=>this.mza.$pb(ha,ca.runtime.Iq,wa),Pa,sa,la,"Unfavored"));if(!pa)return a.a.instance.Ta(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
ca.logger.Og(Object.assign(new w,{qj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ca.runtime.Xb&&ca.runtime.Xb.$hb(1000005)&&(Na.length&&this.mzl(Na,ca.runtime.zu)?(this.Woh(Na,ca,fa,la),this.nzd(ca,la,sa)):this.Woh(sa,ca,fa,la));if(qa.length){ra=null;if(!({fn:ra}=this.Zyn(ca,qa,La,Pa,ra)).returnValue||!ra)return pa=!1;ra.forEach(ja=>{0<ja.c_b.count&&ca.runtime.fn.Z(ja.wm.id,ja);fa.add(la.J(ja.wm.id));return!0})}return!0});return pa?fa:null}mzl(ca,aa){for(let fa=0;fa<ca.length;fa++)if(aa.get(ca.eg(fa).id))return!0;
return!1}nzd(ca,aa,fa){fa.length&&(fa.forEach(pa=>{ca.runtime.Vjc.add(pa.id);ca.runtime.Vjc.add(aa.J(pa.id));return!0}),H.a.nzd(ca,this.Zd,fa.J(0)))}Woh(ca,aa,fa,pa){ca.forEach(ra=>{const la=new X.a(ra.IK());aa.runtime.fn.Z(ra.id,la);fa.add(pa.J(ra.id));return!0})}c0f(ca,aa,fa,pa,ra,la,qa){var La=fa(aa);if(!La)return a.a.instance.Ta(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",qa,aa),ca.logger.Og(Object.assign(new w,{qj:"ProcessOutlineElement",eventId:"aqwkb",
info:String.format("[Revision: {0}] Failed to find OutlineElement",qa)})),!1;const Pa=this.Zd.getPropertyObjectIds(La,l.a.KK);if(!Pa||!Pa.length)return a.a.instance.Ta(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",qa,aa),ca.logger.Og(Object.assign(new w,{qj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",qa)})),L.a(La,"ProcessOutlineElement_"+qa,1),!1;La=Pa.eg(0);fa=fa(La);if(!fa)return a.a.instance.Ta(4285059,
1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",qa,La,aa),ca.logger.Og(Object.assign(new w,{qj:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",qa)})),!1;if((qa=this.Zd.getPropertyString(fa,f.a.jN))&&""!==qa&&ca.runtime.Xb&&(ca.runtime.Xb.eTd(1000005),ca.runtime.Xb.$hb(1000005)))return ra.add(fa),la.add(La,aa),ca.runtime.iNa.add(La),!0;pa.add(fa);
la.add(La,aa);ca.runtime.iNa.add(La);return!0}H7h(ca){let aa,fa;aa=this.Zd.getPropertyObjectIds(ca.KE,l.a.ef);fa=this.Zd.getPropertyObjectIds(ca.e8,l.a.ef);ca=this.Zd.getPropertyObjectIds(ca.Uqa,l.a.ef);return{gBd:aa,oLd:fa,Sme:ca}}zSm(ca){if(!ca)return a.a.instance.Ta(51422868,1,2,"Feature Helper is null"),!1;ca.uz(104);return ca.isFeatureEnabled(104)}static M_i(ca,aa){aa.nb(ca.Qc)||aa.Z(ca.Qc,new y.a);aa.J(ca.Qc).add(ca);return!0}}Y.W8d=n.a.Ff("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(E.a)(Y,
"ChildNodeListMerge",null,[970])},1761:function(E,K,c){E=c(0);var l=c(1496),f=c(1623),a=c(1543),k=c(1514),x=c(1705),y=c(1561);class n{constructor(aa,fa){this.DimensionValue=this.DimensionName=null;this.DimensionName=aa;this.DimensionValue=fa}}Object(E.a)(n,"Dimension",null,[]);class u{constructor(aa,fa,pa,ra,la){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=aa;this.Query=fa;this.From=pa;this.Size=ra;la&&(this.Filter=la)}}Object(E.a)(u,"EntityRequest",null,
[]);class z{constructor(aa){this.QueryString=null;this.QueryString=aa}}Object(E.a)(z,"Query",null,[]);var w=c(1497);class F{constructor(aa,fa){this.Dimensions=this.Name=null;this.Name=aa;this.Dimensions=fa}}Object(E.a)(F,"Scenario",null,[]);var G=c(1501),H=c(1500);class L{constructor(aa,fa,pa,ra){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=aa;this.TimeZone=fa;this.Cvid=pa;this.Scenario=ra}}Object(E.a)(L,"SubstrateBody",null,[]);var I=c(1560),N=c(1494),P=c(1493),
M=c(2),J=c(1698),V=c(1697),X=c(1530),W=c(35),U=c(19),Y=c(135);c.d(K,"a",function(){return ca});class ca{constructor(aa){this.fyc=this.icb=this.mpd=this.Xsc=this.Syc=0;this.B7g=this.bah=this.eQ=null;this.dIe=0;this.U1=-1;this.BBc="";this.oBe=!1;this.Yf=M.AFrameworkApplication.Ne;this.fc=aa;this.jvd=this.kuf();this.kxb=new f.a;this.R5g=this.fc.dme?3:2;this.kUe=this.fc.dme&&this.fc.Nrj?5:3;this.AXe=this.fc.She?2:3;this.ylh=1;this.rod=this.fc.Ubi;this.igh=this.fc.JRm;this.Qzc=aa.$fi;M.AFrameworkApplication.K&&
(this.bah=M.AFrameworkApplication.K.jb("AppCatalogUrl")+M.AFrameworkApplication.K.jb("SearchPersonaPhotoBaseUrl"),this.oBe=this.fc.dga||this.fc.NJd);this.fc.dga&&(this.AXe=this.kUe=5)}aL(){return"Substrate"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:3}QH(aa,fa,pa,ra=l.a.tellMe,la=null){const qa=new H.a(aa);if(!la||Array.contains(la,14)||Array.contains(la,15)||Array.contains(la,20))if(!this.dIe||window.performance.now()-this.dIe>=P.a.t7a)if(pa=this.kxb.Fgi())this.dIe=window.performance.now(),pa.then(La=>
{La&&""!==La?(this.BBc=La,""!==this.eQ&&this.Egi(aa,ra,this.BBc,fa,la)):(N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),fa.resultsUpdated(qa))},La=>{N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+La);fa.resultsUpdated(qa)});else{if(N.TellMeActor.instance.Oe)N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");fa.resultsUpdated(qa)}else this.BBc&&
""!==this.BBc?this.Egi(aa,ra,this.BBc,fa,la):(fa.resultsUpdated(qa),N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else fa.resultsUpdated(qa)}O5a(){this.icb=this.fyc=this.mpd=this.Xsc=this.Syc=0}Egi(aa,fa,pa,ra,la){this.O5a();const qa=new H.a(aa),La=this.eQ=Y.a.create().toString();this.NCa();this.U1=window.setTimeout(()=>{if(La===this.eQ){this.eQ="";this.U1=-1;ra.resultsUpdated(qa);const Na={};Na[a.a.provider]=this.aL();Na[a.a.aMb]=aa.gnb;N.TellMeActor.instance.Oe.JA(k.a.timedOut,
this.Qzc,Na)}},this.Qzc);const Pa={"Content-Type":"application/json",Accept:"application/json"};Pa.Authorization="Bearer "+pa;Pa["X-Office-Version"]=M.AFrameworkApplication.buildVersion;Pa["X-Office-Application"]=M.AFrameworkApplication.K.jb("Application");Pa["X-Office-Platform"]="WAC";Pa["X-TellMe-SessionId"]=N.TellMeActor.instance.oSd();Pa["X-TellMe-Culture"]=M.AFrameworkApplication.uiCulture;Pa["X-TellMe-ProcessSessionId"]=M.AFrameworkApplication.userSessionId;Pa["Client-Request-Id"]=La;const Ka=
window.performance.now();this.Yf.tj(this.idm(),2,this.jdm(aa.Dg,this.fc.application,N.TellMeActor.instance.oSd(),P.a.cR(aa)),Pa,!1,0,Na=>{this.JKb(Na,aa,ra,La,Ka,fa,la)},Na=>{this.qKb(Na,aa,ra,La,Ka)},null,null,!1,4E3,6E3)}NCa(){-1!==this.U1&&(window.clearTimeout(this.U1),this.U1=-1)}JKb(aa,fa,pa,ra,la,qa,La){N.TellMeActor.instance.Oe.v0(fa.Dg.length,this.jvd.join(","),aa.data.Qe.toString(),Math.round(window.performance.now()-la),I.a.substrate,!0,y.a.zPa);const Pa=P.a.cR(fa),Ka=new H.a(fa);if(ra===
this.eQ){this.NCa();aa=W.b(aa.data.we);if(aa.Groups){aa=aa.Groups;for(const Na of aa)"People"===Na.Type&&this.fc.W9c&&(La?Array.contains(La,14):1)?(aa=this.hdi(Na.Suggestions,Pa,qa),0<aa.results.length&&Ka.Uu(aa)):"File"===Na.Type&&this.fc.U9c&&(La?Array.contains(La,15):1)?(aa=this.Lpf(Na.Suggestions,Pa,qa),0<aa.results.length&&(this.CYd()&&(ra=new w.a("GenerateSlidesFromTellMe",30,"",null,1),aa.Nw(ra)),Ka.Uu(aa))):"Notes"===Na.Type&&this.fc.kkb&&qa!==l.a.contextMenu&&(La?Array.contains(La,20):1)&&
(aa=this.Qbi(Na.Suggestions,Pa,fa),0<aa.results.length&&Ka.Uu(aa))}pa.resultsUpdated(Ka);N.TellMeActor.instance.Oe.v0(fa.Dg.length,this.jvd.join(","),"",Math.round(window.performance.now()-la),"",!0,y.a.provider)}else pa.resultsUpdated(Ka)}Qbi(aa,fa,pa){const ra=new G.a(20);ra.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const la of aa)this.$Tm(la)&&(aa=la.NotesType,aa=U.a.Ug(aa),aa=this.w4l(aa,la.LastModifiedTime,la.BodyPreview,la.Subject,fa,pa,la))&&(aa.groupType=20,ra.Nw(aa));return ra}hdi(aa,
fa,pa){const ra=new G.a(14);ra.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const qa of aa)if(this.aUm(qa)){var la=qa.Id.split("@")[0];aa=qa.EmailAddresses[0];let La=qa.Type;if(void 0===La||null===La)La="User";if(la=this.t7l(La,qa.DisplayName,qa.JobTitle,aa,la,pa,fa))la.description=aa,aa=qa.JobTitle,"Department"in qa&&"CompanyName"in qa&&(aa+="@"+qa.Department+"@"+qa.CompanyName),la.KI=aa,ra.Nw(la)}return ra}Lpf(aa,fa,pa){const ra=new G.a(15);ra.displayName=CommonUIStrings.l_TellMeFileProviderTitle;
for(const Na of aa)if(this.QTm(Na)){var la=Na.FileName;aa=Na.FileExtension;var qa=la;la.length>aa.length&&qa.endsWith(aa)&&(qa=la.substr(0,la.length-aa.length-1));var La=void 0,Pa=0;"DateCreated"in Na&&Na.DateCreated?(Pa=P.a.Ruf(Na.DateCreated),La=P.a.Uhi(Na.DateCreated),La=String.format(CommonUIStrings.l_CreatedTimeFormatString,Na.Author,La)):La=Na.Author;var Ka=Na.AccessUrl+"?web=1";const sa=U.a.C9b(Ka);la=String.format('<a href="{0}">{1}</a>',sa,U.a.RX(la));if(pa!==l.a.contextMenu||U.a.yU(Ka))if(qa=
this.HVl(qa,pa===l.a.contextMenu?la:Ka,La,Na.FileExtension,Na.Text,fa))qa.description=Na.Author,qa.Szd=Pa,ra.Nw(qa),this.oBe&&(Pa=Na.AccessUrl,la=P.a.$Od(aa),La=Na.DateModified?Na.DateModified:Na.DateCreated,Ka=Na.Size?Na.Size:Na.FileSize,this.Ero()&&(Pa=Pa.replace(RegExp("%20","g")," "),la=P.a.fcm(aa)),aa=new x.a(la,Pa,Na.SPWebUrl,Na.Id,Ka,La),N.TellMeActor.instance.Zlg(!1,qa.value,aa))}return ra}qKb(aa,fa,pa,ra,la){ra===this.eQ&&(this.NCa(),N.TellMeActor.instance.Oe.v0(fa.Dg.length,this.jvd.join(","),
aa.data.Qe.toString(),Math.round(window.performance.now()-la),I.a.substrate,!1,y.a.zPa));aa=new H.a(fa);pa.resultsUpdated(aa)}t7l(aa,fa,pa,ra,la,qa,La){La=La?this.ylh:this.R5g;if(!window.LPC&&!P.a.vCf()||this.Syc===La)return null;this.Syc+=1;La="PeopleSuggestion"+this.Syc.toString();var Pa=this.bah+"?size=1&accountName="+ra;aa=Object.assign(new J.a,{PersonaType:aa,Smtp:ra,ProfilePictureUrl:Pa,AadObjectId:la});const Ka=Object.assign(new V.a,{identifiers:aa,displayName:fa});aa=qa===l.a.contextMenu;
this.fc.Yva?(N.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(La,Ka,fa,pa)),qa===l.a.contextMenu&&(pa=P.a.xMh(fa,ra,la),N.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(La,pa))),N.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(La,aa))):(Pa=[],Pa.push(appChrome.actions.setPersonaButtonCoauthor(La,Ka,fa,pa)),qa===l.a.contextMenu&&(pa=P.a.xMh(fa,ra,la),Pa.push(appChrome.actions.setButtonCommandValueId(La,
pa))),Pa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(La,aa)),appChrome.api.dispatch(Pa));return new w.a(La,11,fa,ra,0)}w4l(aa,fa,pa,ra,la,qa,La){if(la&&!this.fc.cCi||this.mpd===this.rod||this.fyc===this.rod||this.icb===this.rod)return null;var Pa=null;this.mpd+=1;la="";const Ka=[],Na={};La.type="Notes";this.B7g=Object.assign(new X.a,{landingTab:"Notes",data:La});qa=P.a.JNa(qa.Dg,33,this.B7g);if("onenotepagepreviews"===aa){if(!("ClickthroughUrl"in La&&La.ClickthroughUrl)||""===
La.ClickthroughUrl)return null;this.fyc+=1;la="OnenoteNotesSuggestion"+this.fyc.toString();Na["default"]="SaveAsonetoc2_20";Pa=La.ClickthroughUrl;Ka.push(appChrome.actions.setControlIconSet(la,Na));Ka.push(appChrome.actions.setCompoundButtonCommandValueId(la,Pa));Pa=new w.a(la,19,null,null,0)}else if("stickynote"===aa){if(!this.igh)return null;this.icb+=1;la="NotesSuggestion"+this.icb.toString();Na["default"]="ShowAllNotes_20";Ka.push(appChrome.actions.setControlIconSet(la,Na));Ka.push(appChrome.actions.setCompoundButtonCommandValueId(la,
qa));Pa=new w.a(la,21,null,null,0)}else if("samsung"===aa){if(!this.igh)return null;this.icb+=1;la="NotesSuggestion"+this.icb.toString();Na["default"]="CategoryCollapsed_20";Ka.push(appChrome.actions.setControlIconSet(la,Na));Ka.push(appChrome.actions.setCompoundButtonCommandValueId(la,qa));Pa=new w.a(la,20,null,null,0)}""!==la&&(aa=P.a.Uhi(fa),aa=String.format(CommonUIStrings.l_LastModifiedString,aa),Pa.label=ra,Pa.Szd=P.a.Ruf(fa),Ka.push(appChrome.actions.setControlLabel(la,ra)),Ka.push(appChrome.actions.updateCompoundButtonDescription(la,
aa)),Ka.push(appChrome.actions.setControlCustomTooltip(la,pa)),appChrome.api.dispatch(Ka));return Pa}HVl(aa,fa,pa,ra,la,qa){if(this.Xsc===(qa?this.AXe:this.kUe)||this.oBe&&"Word"!==P.a.$Od(ra))return null;this.Xsc+=1;qa="FileSuggestion"+this.Xsc.toString();const La=[],Pa={};Pa["default"]=P.a.TYl(ra);this.fc.Yva?(N.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa,aa)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(qa,Pa)),N.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa,
pa)),N.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa,fa)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(qa,la))):(La.push(appChrome.actions.setControlLabel(qa,aa)),La.push(appChrome.actions.setControlIconSet(qa,Pa)),La.push(appChrome.actions.updateCompoundButtonDescription(qa,pa)),La.push(appChrome.actions.setCompoundButtonCommandValueId(qa,fa)),La.push(appChrome.actions.setControlCustomTooltip(qa,la)),appChrome.api.dispatch(La));
return new w.a(qa,6,aa,pa,0)}kuf(){const aa=[];this.fc.W9c&&Array.add(aa,"People");this.fc.U9c&&Array.add(aa,"File");this.fc.kkb&&Array.add(aa,"Notes");return aa}jdm(aa,fa,pa,ra){var la=new z(aa);aa=new u("File",la,0,ra?this.AXe:this.kUe,null);ra=new u("People",la,0,ra?this.ylh:this.R5g,P.a.YAn);la=new u("Notes",la,0,this.rod,null);this.fc.NJd&&"powerpoint"===fa.toLowerCase()&&(fa="word");fa=new n("app",fa.toLowerCase());var qa=[];Array.add(qa,fa);fa=new F("tellmesearch",qa);qa=[];this.fc.U9c&&Array.add(qa,
aa);this.fc.W9c&&Array.add(qa,ra);this.fc.kkb&&Array.add(qa,la);pa=new L(qa,"UTC",pa,fa);return W.c(pa)}idm(){let aa=this.fc.vDo;this.fc.kkb&&(aa+="?&setflight=NotesFrom3S");""!==this.fc.Ggi&&(aa=aa+"&"+this.fc.Ggi);return aa}aUm(aa){return"DisplayName"in aa&&"Id"in aa&&"EmailAddresses"in aa&&!!aa.Id&&!!aa.EmailAddresses}QTm(aa){return"FileExtension"in aa&&!!aa.FileExtension&&"FileName"in aa&&!!aa.FileName&&""!==aa.FileName&&"AccessUrl"in aa&&!!aa.AccessUrl&&""!==aa.AccessUrl}$Tm(aa){return"Id"in
aa&&!!aa.Id&&"NotesType"in aa&&!!aa.NotesType&&"Subject"in aa&&!!aa.Subject&&""!==aa.Subject}CYd(){return!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Ero(){return!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(E.a)(ca,"SubstrateResultsProvider",null,[942])},1762:function(E,K,c){E=c(0);var l=c(41),
f=c(6),a=c(15),k=c(168),x=c(83),y=c(182),n=c(223),u=c(602),z=c(58),w=c(365),F=c(2),G=c(1451),H=c(956);class L{constructor(qa,La=0){this.laf=null;this.gYf=0;this.KM=qa;this.Qbn=La}}Object(E.a)(L,"GraphMergerResponse",null,[]);var I=c(55),N=c(1),P=c(119),M=c(871),J=c(1531),V=c(1581);class X extends V.a{constructor(){super();this.iuj=null;this.eKj=!1}get lga(){return"Crash"}fEb(){this.detail.Z("Type",this.lga);this.detail.Z("Trace",this.FMo(this.iuj));this.detail.Z("Continue",this.eKj);return this.detail}FMo(qa){qa=
qa.split("\n");const La=4<qa.length?4:qa.length,Pa=new Sys.StringBuilder;for(let Ka=0;Ka<La;Ka++)Ka===La-1?Pa.append(String.format("{0}...",qa[Ka])):Pa.append(String.format("{0}\n",qa[Ka]));return Pa.toString()}}Object(E.a)(X,"CrashMergeFailureDetail",V.a,[]);var W=c(1961),U=c(1548),Y=c(1642),ca=c(1532);class aa{constructor(){this.zKk=new w.a;this.h1k=new w.a;this.z4k=new w.a}}Object(E.a)(aa,"RangeMarkers",null,[]);class fa{constructor(){this.colSpan=this.rowSpan=null;this.hg=!1;this.LBe=new n.a;
this.IKe=new n.a;this.bLe=new n.a}get Hvf(){return this.LBe.k5()}set Hvf(qa){qa||(this.LBe=new n.a);this.LBe=qa.k5()}get WQf(){return this.IKe.k5()}set WQf(qa){qa||(this.IKe=new n.a);this.IKe=qa.k5()}get K5d(){return this.bLe.k5()}set K5d(qa){qa||(this.bLe=new n.a);this.bLe=qa.k5()}}Object(E.a)(fa,"TableCellStructureInfo",null,[]);var pa=c(1584),ra=c(1630);c.d(K,"a",function(){return la});class la{constructor(){this.dTd=0;this.SWg=this.T$a=this.ZWb=this.Mg=this.$ch=this.oYb=null;this.P5g=0;this.y2g=
50;this.qUg=this.eOg=null}get iee(){return this.oYb}get G7n(){return this.$ch}get Zd(){return this.Mg}get jlb(){return this.ZWb}get fki(){return this.T$a}get hkm(){return this.SWg}get qdc(){return this.P5g}get YCh(){return this.eOg}get yLc(){return this.qUg}xdc(qa,La,Pa,Ka,Na,sa,wa){Pa=this.Ral(qa,La,Ka,Na,sa,wa,this.yLc);Ka=0;const ja=Pa.runtime.Whe;let ha=null;try{this.V3m(ja,Pa,wa,qa,La,Na,sa);for(qa=1;Ka<this.jlb.length;Ka++)if(!(0,this.jlb[Ka])(Pa)){qa=2;Pa.logger.y2d("GraphMerger.GetMergeFunctions()",
Ka);break}return ha=new L(Pa.output.KM,qa)}catch(va){const xa=!Pa.output.timeout;Pa.output.crash=xa;const ma=this.TOd(va),Ja=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",xa?"Crashed":"Timed Out",Pa.input.wJb,!!Pa.output.KM,ma);xa?(k.a.instance.Ta(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Ja),Pa.logger.Og(Object.assign(new X,{iuj:ma,eKj:!!Pa.output.KM}))):k.a.instance.Ta(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Ja);if(Pa.output.KM)return ha=new L(Pa.output.KM,
2);throw va;}finally{Pa.output.succeeded?this.S3m(ja,Pa,Ka):Pa.output.timeout?this.U3m(Pa,Ka):Pa.output.crash?Pa.output.KM?this.T3m(Pa,Ka):this.R3m(Pa,Ka):this.Q3m(Pa,Ka);Pa.logger.P3m();k.a.instance.sja(42350232,1,Pa.output.succeeded?4:2,"MergeLogger",Pa.logger.j2l());Pa.logger.yYc.ami()&&k.a.instance.sja(559015903,1,2,"MarkerInfo",Pa.logger.yYc.toString());if(Pa.runtime.Xb&&Pa.runtime.Xb.isFeatureEnabled(73))try{this.y0m(Pa)}catch(va){k.a.instance.Ta(571619421,1,4,"Error logging references: {0}",
va.toString())}this.A5m(Pa);ha.gYf|=(Pa.output.succeeded?2:1)<<2*(wa-1);if(ha)try{ha.laf=this.SEn(Pa)}catch(va){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",va)}}}A5m(qa){if(!qa.output.succeeded){qa=qa.output.timeout?"Timeout":qa.logger.k4i?qa.logger.k4i.lga:"Unknown";const La=new P.a;x.Health.instance.recordQosError(qa,["MergeFailure"],!0,!0,!1,!1,La)}}y0m(qa){const La=Na=>{const sa=this.cEa()-qa.input.sTa>this.qdc;if(0<this.qdc&&sa)throw k.a.instance.Ta(571619422,
1,2,"Timed out while calculating added and deleted nodes: {0}",Na),y.a.invalidOperation(Na);};let Pa=qa.runtime.zu.keys,Ka=Na=>qa.runtime.zu.J(Na);this.VJf(qa,La,Pa,Ka,"Favored");Pa=qa.runtime.Iq.keys;Ka=Na=>qa.runtime.Iq.J(Na);this.VJf(qa,La,Pa,Ka,"Unfavored");Pa=qa.runtime.fn.keys;Ka=Na=>{const sa=qa.runtime.fn.J(Na);return sa?sa.wm:qa.runtime.zu.J(Na)};this.VJf(qa,La,Pa,Ka,"Merged")}VJf(qa,La,Pa,Ka,Na){var sa=new n.a;const wa=new n.a;for(let ja=0;ja<Pa.length;ja++){La("LogAddedAndDeletedNodes");
const ha=Ka(Pa.J(ja));if(4325465===ha.Qc)continue;const va=qa.runtime.sk.J(ha.id);va&&this.z0m(sa,wa,ha,va)}this.xJi(wa,ja=>qa.runtime.sk.J(ja),La);this.xJi(sa,Ka,La);La=new Sys.StringBuilder;for(Pa=0;Pa<sa.length;Pa++)La.append(sa.J(Pa).toString()+",");sa=new Sys.StringBuilder;for(Pa=0;Pa<wa.length;Pa++)sa.append(wa.J(Pa).toString()+",");k.a.instance.sja(571619423,1,4,Na+" revision: Added references",La.toString());k.a.instance.sja(571619424,1,4,Na+" revision: Deleted references",sa.toString())}z0m(qa,
La,Pa,Ka){const Na=Pa.Hl();for(let wa=0;wa<Na.length;wa++){const ja=Na[wa];if(this.Kti(ja)){var sa=this.Zd.getPropertyObjectIds(Pa,ja);this.I2m(qa,La,Ka,ja,sa)}else this.Yyi(ja)&&(sa=this.Zd.getPropertyObjectId(Pa,ja),this.H2m(qa,La,Ka,ja,sa))}}xJi(qa,La,Pa){Pa("LogNestedReferences");Pa=new n.a;const Ka=new u.a;for(let Na=0;Na<qa.length;Na++){const sa=qa.J(Na);this.yKf(sa,Pa,Ka,La)}for(La=0;La<Pa.length;La++)qa.add(Pa.J(La))}yKf(qa,La,Pa,Ka){const Na=Ka(qa);if(Na){const wa=Na.Hl();for(let ja=0;ja<
wa.length;ja++){var sa=wa[ja];if(this.Kti(sa)){sa=this.Zd.getPropertyObjectIds(Na,sa);for(let ha=0;ha<sa.length;ha++)Pa.contains(sa.J(ha))||(La.add(sa.J(ha)),Pa.add(sa.J(ha)),this.yKf(sa.J(ha),La,Pa,Ka))}else this.Yyi(sa)&&(sa=this.Zd.getPropertyObjectId(Na,sa),Pa.contains(sa)||(La.add(sa),Pa.add(sa),this.yKf(qa,La,Pa,Ka)))}}}I2m(qa,La,Pa,Ka,Na){if(this.Zd.hasProperty(Pa,Ka)){Pa=this.Zd.getPropertyObjectIds(Pa,Ka);const sa=Pa.TG();Ka=Na.TG();for(let wa=0;wa<Na.length;wa++)sa.contains(Na.J(wa))||qa.add(Na.J(wa));
for(qa=0;qa<Pa.length;qa++)Ka.contains(Pa.J(qa))||La.add(Pa.J(qa))}else for(La=0;La<Na.length;La++)qa.add(Na.J(La))}H2m(qa,La,Pa,Ka,Na){Na&&(this.Zd.hasProperty(Pa,Ka)?(Pa=this.Zd.getPropertyObjectId(Pa,Ka),Na.equals(Pa)||(qa.add(Na),La.add(Pa))):qa.add(Na))}O3m(qa){k.a.instance.Ta(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",qa.input.wJb,qa.output.crash,qa.output.timeout)}V3m(qa,La,Pa,Ka,Na,sa,wa){if(qa){qa=Ka.length?Ka.eg(Ka.length-1):null;var ja=Na.length?Na.eg(Na.length-
1):null;Pa=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",La.input.wJb,Ka.length,qa?qa.id:z.a.nil,qa?qa.UW?qa.UW.id:z.a.nil:z.a.nil,Na.length,ja?ja.id:z.a.nil,ja?ja.UW?ja.UW.id:z.a.nil:z.a.nil,sa,wa,this.qdc,Pa);switch(La.input.source){case 5:k.a.instance.Ta(51663493,1,4,Pa);break;default:k.a.instance.Ta(4051606,
1,4,Pa)}}}S3m(qa,La,Pa){if(qa)switch(qa=this.RNc(La,Pa,"Succeeded"),La.input.source){case 5:k.a.instance.Ta(51663494,1,4,qa);break;default:k.a.instance.Ta(4059162,1,4,qa)}}U3m(qa,La){La=this.RNc(qa,La,"Timeout");switch(qa.input.source){case 5:k.a.instance.Ta(51663495,1,4,La);break;default:k.a.instance.Ta(4059163,1,2,La)}}Q3m(qa,La){La=this.RNc(qa,La,"Rejection");switch(qa.input.source){case 5:k.a.instance.Ta(51663496,1,4,La);break;default:k.a.instance.Ta(4059164,1,2,La)}}T3m(qa,La){La=this.RNc(qa,
La,"Crash - Rejection");switch(qa.input.source){case 5:k.a.instance.Ta(51663497,1,4,La);break;default:k.a.instance.Ta(4059165,1,2,La)}}R3m(qa,La){La=this.RNc(qa,La,"Crash - Failed");switch(qa.input.source){case 5:k.a.instance.Ta(51663498,1,4,La);break;default:k.a.instance.Ta(4059166,1,2,La)}}RNc(qa,La,Pa){const Ka=qa.output.KM,Na=Ka&&Ka.length?Ka.eg(Ka.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
qa.input.wJb,Pa,this.cEa()-qa.input.sTa,La,Ka?Ka.length:0,Na?Na.id:z.a.nil,Na?Na.UW?Na.UW.id:z.a.nil:z.a.nil,qa.input.source)}Ral(qa,La,Pa,Ka,Na,sa,wa){const ja=new W.a,ha=ja.input;ha.f$=qa;ha.zUa=La;ha.nm=Pa;ha.Oha=Ka;ha.hGb=Na;ha.source=sa;ha.yLc=wa;ha.sTa=this.cEa();ja.logger.tmo(ha.sTa);qa=ja.runtime;qa.X7c=k.a.instance.W9(1,5);qa.Whe=k.a.instance.W9(1,4);let va="";qa.SG=xa=>{if(this.qdc){var ma=this.cEa()-ha.sTa,Ja=ma>this.qdc;va+=String.format(" ({0}: {1})",xa,ma);Ja&&(ja.output.timeout=!0,
xa=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ha.wJb,this.qdc,xa,ma,va),k.a.instance.Ta(528061012,1,2,xa),this.qIo(xa))}};return ja}BOc(){return[Object(I.a)(this,this.Fwn,"otherAuthorsHaveChangesToMerge"),Object(I.a)(this,this.LLm,"isInputValid"),Object(I.a)(this,this.Oym,"initializeOutputMergeState"),Object(I.a)(this,this.iWd,"initializeRuntimeMergeState"),Y.a.yEn,Object(I.a)(this,this.xEn,"preProcessTableStructure"),
Object(I.a)(this.YCh,this.YCh.tbn,"mergeChildNodeLists"),Object(I.a)(this,this.eOo,"tryObjectMerge"),Y.a.dEn,Object(I.a)(this,this.kBl,"finalizeObjectMerge"),Object(I.a)(this,this.l0o,"validateMarkers"),Object(I.a)(this,this.Fsk,"addMergeResultsToOutput")]}Fwn(qa){const La=qa.input.f$;qa=qa.output;return La?La.length?!0:(k.a.instance.Ta(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),qa.KM=La,qa.succeeded=!0,!1):(k.a.instance.Ta(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
qa.KM=La,qa.succeeded=!0,!1)}LLm(qa){var La=qa.input;const Pa=La.f$,Ka=La.zUa,Na=La.nm,sa=La.Oha;La=La.hGb;qa=qa.output;if(!Ka||!Ka.length)return k.a.instance.Ta(42350233,1,5,"IsInputValid: No local changes to merge."),qa.KM=Pa,qa.succeeded=!0,!1;let wa=!0;if(2!==sa&&1!==sa)return qa.KM=Pa,!1;Na&&Na!==z.a.nil||(wa=!1);Pa.length<(La?2:1)&&(k.a.instance.Ta(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
La),wa=!1);wa||(qa.KM=2===sa?Pa:Ka);return wa}iWd(qa){var La=qa.input,Pa=La.f$,Ka=La.zUa,Na=La.Oha,sa;let wa;({Sig:sa,Lpg:wa,VCa:La}=this.brf(qa,Pa,Ka,La.hGb));if(!La)return k.a.instance.Ta(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",sa.id,wa.id),qa.logger.Og(Object.assign(new J.a,{qj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.VJi(sa,Pa.length,"TheirChanges"),this.VJi(wa,Ka.length,
"YourChanges"),qa.output.KM=2===Na?Pa:Ka,!1;qa.runtime.VCa=La;({NPo:Pa,nzl:Ka}=this.Jll(Na,sa,wa));({OPo:La,ozl:Na,QIk:sa}=this.H2l(qa,Pa,Ka,La));qa.runtime.sk=sa;qa.runtime.Iq=La;qa.runtime.zu=Na;qa.runtime.fn=new w.a;qa.runtime.pLd=Ka.id;qa.runtime.Tme=Pa.id;qa.runtime.Elb=new w.a;qa.runtime.iNa=new u.a;qa.runtime.ddf=new w.a;qa.runtime.MAb=new w.a;qa.runtime.Ahg=new w.a;qa.runtime.ece=new aa;qa.runtime.X3d=new n.a;qa.runtime.BXf=new u.a;qa.runtime.Vjc=new n.a;qa.runtime.Xb=qa.input.yLc(qa);qa.runtime.Xb.FDc(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.mHo);qa.runtime.Xb.FDc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",l.a.rJo);qa.runtime.Xb.FDc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.Xyl);qa.runtime.Xb.FDc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.MYn);qa.runtime.Xb.FDc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix",
"79ee6190;i588c310",l.a.Hbn);qa.runtime.Cqi=!0;F.AFrameworkApplication.K&&(this.y2g=F.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}VJi(qa,La,Pa){const Ka=new n.a;for(;qa;)Ka.add(qa),qa=qa.UW;const Na=new Sys.StringBuilder;Na.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Pa,La,Ka.length));let sa=Ka.length,wa=0;Ka.forEach(ja=>({joi:sa,uKi:wa}=this.ruk(Na,ja,Ka,sa,wa)).returnValue);k.a.instance.Ta(4273302,1,4,Na.toString())}ruk(qa,
La,Pa,Ka,Na){qa.append(String.format(" [{0} {1} {2}]",Ka,La.Nwa?"S":"B",La.id));Ka--;Na++;return 50<Na&&Pa.length!==Na?(qa.append(" ...Truncated."),{returnValue:!1,joi:Ka,uKi:Na}):{returnValue:!0,joi:Ka,uKi:Na}}brf(qa,La,Pa,Ka){La=La.eg(La.length-1-(Ka?1:0));Pa=Pa.eg(Pa.length-1);Ka=La.M0a(Pa);qa.runtime.SG("GetCommonBase");qa.logger.Gha("GetCommonBase");return{Sig:La,Lpg:Pa,VCa:Ka}}H2l(qa,La,Pa,Ka){let Na,sa;({result:Na}=La.ydc(Ka));qa.runtime.SG("GetUnfavoredChanges");qa.logger.Gha("GetUnfavoredChanges");
({result:sa}=Pa.ydc(Ka));5===qa.input.source&&(qa.runtime.rzl=M.a.Fei(Pa),qa.runtime.QPo=M.a.Fei(La));qa.runtime.SG("GetFavoredChanges");qa.logger.Gha("GetFavoredChanges");La=new G.a(Object(I.a)(Ka,Ka.i1a,"getMergeableObject"));qa.runtime.SG("GetModifiedObjects");qa.logger.Gha("GetModifiedObjects");return{OPo:Na,ozl:sa,QIk:La}}Jll(qa,La,Pa){2===qa?(qa=La,La=Pa):qa=Pa;return{NPo:La,nzl:qa}}Oym(qa){const La=qa.input,Pa=La.f$,Ka=La.zUa;qa.output.KM=(2===La.Oha?Pa:Ka).k5();qa.runtime.SG("InitializeOutputMergeState");
qa.logger.Gha("InitializeOutputMergeState");return!0}Fsk(qa){var La=qa.input.nm;const Pa=qa.runtime.fn,Ka=qa.output.KM;La=this.Sal(qa,Ka.eg(Ka.length-1),La,z.a.create());this.GAl(qa,La,Pa);Ka.add(La);return qa.output.succeeded=!0}Sal(qa,La,Pa,Ka){qa.runtime.Whe&&k.a.instance.Ta(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Pa,Ka);qa=this.G7n(Ka);qa.oJk(La,Pa);return qa}GAl(qa,La,Pa){qa.runtime.Whe&&k.a.instance.Ta(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",
Pa.count);Pa.forEach((Ka,Na)=>{La.Wtk(Na.wm);return!0})}ZHb(qa){if(!qa)return k.a.instance.Ta(573957952,1,2,"Feature helper is null"),!1;qa.uz(105);return qa.isFeatureEnabled(105)}xEn(qa){if(!this.ZHb(qa.runtime.Xb))return!0;const La=qa.runtime.zu,Pa=qa.runtime.Iq,Ka=qa.runtime.sk;let Na=!0;La.forEach((sa,wa)=>{393252===wa.Qc&&(Na=this.T1i(qa,sa,wa,Ka,La));return Na});if(!Na)return!1;Pa.forEach((sa,wa)=>{393252===wa.Qc&&(Na=this.T1i(qa,sa,wa,Ka,Pa));return Na});qa.logger.Gha("PreProcessTableStructure");
return Na}T1i(qa,La,Pa,Ka,Na){const sa=null==this.Zd.getPropertyBool(Pa,f.a.ghostCell)?!1:this.Zd.getPropertyBool(Pa,f.a.ghostCell),wa=null==this.Zd.getPropertyUint32(Pa,f.a.rowSpan)?1:this.Zd.getPropertyUint32(Pa,f.a.rowSpan),ja=null==this.Zd.getPropertyUint32(Pa,f.a.colSpan)?1:this.Zd.getPropertyUint32(Pa,f.a.colSpan);if(sa)return!0;var ha=Ka.J(La);if(ha){Ka=null==this.Zd.getPropertyBool(ha,f.a.ghostCell)?!1:this.Zd.getPropertyBool(ha,f.a.ghostCell);var va=null==this.Zd.getPropertyUint32(ha,f.a.rowSpan)?
1:this.Zd.getPropertyUint32(ha,f.a.rowSpan);var xa=null==this.Zd.getPropertyUint32(ha,f.a.colSpan)?1:this.Zd.getPropertyUint32(ha,f.a.colSpan);Ka=Ka!==sa;va=va!==wa;xa=xa!==ja}else xa=va=Ka=!0;const ma=ra.e(qa,Pa,Na);if(ma.equals(z.a.nil))return k.a.instance.Ta(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",La),qa.logger.Og(Object.assign(new pa.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Ja=qa.runtime.MAb.J(ma);Ja||(qa.runtime.MAb.Z(ma,
new w.a),Ja=qa.runtime.MAb.J(ma));let oa=Ja.J(La),za=new n.a;const Fa=new n.a,kb=new n.a;Ka&&(oa||(za=this.Zd.getPropertyObjectIds(Pa,a.a.ef)));if(va||xa)if(oa){if(oa.hg)return k.a.instance.Ta(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),qa.logger.Og(Object.assign(new pa.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=oa.rowSpan&&wa!==oa.rowSpan||null!=oa.colSpan&&ja!==oa.colSpan)return k.a.instance.Ta(573957962,1,
4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),qa.logger.Og(Object.assign(new pa.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var fb;({rowIndex:Pa,K2b:fb}=ra.b(qa,Na,Pa));if(-1===Pa||-1===fb)return k.a.instance.Ta(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",La),qa.logger.Og(Object.assign(new pa.a,{info:"Table cell location could not be found"})),!1;for(var lb=Pa;lb<Pa+wa;lb++)for(var sb=fb;sb<
fb+ja;sb++){var ab=ra.c(qa,ma,lb,sb);if(ab.equals(z.a.nil))return k.a.instance.Ta(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),qa.logger.Og(Object.assign(new pa.a,{info:"Ghost cell not found in the table bounds"})),!1;var Ga=Na.lz(ab,qa.runtime.sk.J(ab));if(!Ga)return k.a.instance.Ta(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),qa.logger.Og(Object.assign(new pa.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),
!1;if(!ab.equals(La)){if(null==this.Zd.getPropertyBool(Ga,f.a.ghostCell)||!this.Zd.getPropertyBool(Ga,f.a.ghostCell))return k.a.instance.Ta(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),qa.logger.Og(Object.assign(new pa.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var Ua=Ja.J(ab);if(Ua)return k.a.instance.Ta(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),qa.logger.Og(Object.assign(new pa.a,
{info:"Ghost cell is already merged with some other cell"})),!1;Fa.add(ab);Ua=new fa;Ua.hg=!0;Ga=this.Zd.getPropertyUint32(Ga,f.a.colSpan);null!=Ga&&(Ua.colSpan=Ga);Ja.Z(ab,Ua)}}if(ha&&(null==this.Zd.getPropertyBool(ha,f.a.ghostCell)||!this.Zd.getPropertyBool(ha,f.a.ghostCell))&&(Na=null==this.Zd.getPropertyUint32(ha,f.a.rowSpan)?1:this.Zd.getPropertyUint32(ha,f.a.rowSpan),Pa=null==this.Zd.getPropertyUint32(ha,f.a.colSpan)?1:this.Zd.getPropertyUint32(ha,f.a.colSpan),Na>wa||Pa>ja)){lb=fb=-1;({rowIndex:fb,
K2b:lb}=ra.a(qa,null,ha,fb,lb));if(-1===fb||-1===lb)return k.a.instance.Ta(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",La),qa.logger.Og(Object.assign(new pa.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ha=Fa.TG();for(sb=fb;sb<fb+Na;sb++)for(ab=lb;ab<lb+Pa;ab++){Ua=ra.d(qa,null,ma,sb,ab);if(!Ua)return k.a.instance.Ta(573957960,1,2,"Table cell could not be found within table bounds"),qa.logger.Og(Object.assign(new pa.a,
{info:"Ghost cell not found in the table bounds"})),!1;Ua.id.equals(La)||ha.contains(Ua.id)||kb.add(Ua.id)}}}!oa&&(Ka||va||xa)&&(k.a.instance.Ta(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",La),oa=new fa,oa.rowSpan=wa,oa.colSpan=ja,oa.hg=sa,oa.K5d=za,oa.Hvf=Fa,oa.WQf=kb,Ja.add(La,oa));return!0}eOo(qa){return this.fCj(qa,!1)}kBl(qa){return this.fCj(qa,!0)}fCj(qa,La){const Pa=qa.runtime,Ka=Pa.sk,Na=Pa.zu,sa=La?Pa.ddf:Pa.Iq,wa=Pa.fn;let ja=
!0;const ha=qa.runtime.X7c;let va=0,xa=0,ma=0;sa.forEach((Ja,oa)=>{ha&&k.a.instance.Ta(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",Ja,oa.Qc,La);xa++;this.y2g===xa&&(va++,qa.runtime.SG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",va,ma,La)),xa=0);if(qa.runtime.Xb&&qa.runtime.Xb.$hb(1000005)&&qa.runtime.Vjc.contains(oa.id,(kb,fb)=>kb.equals(fb))||this.Sxo(oa.Qc))return!0;if(!La&&this.oil(oa.Qc,qa.runtime.Xb))return Pa.ddf.Z(Ja,oa),!0;var za=
Na.get(Ja);if(!za)return wa.nb(Ja)?wa.J(Ja).DNi(oa):wa.Z(Ja,new ca.a(oa,!1)),!0;if(!Ka.J(Ja)&&!this.icn(za.Qc)){var Fa=!!qa.input.f$&&!!qa.input.f$.last()&&qa.input.f$.last().m4(Ja);const kb=!!qa.input.zUa&&!!qa.input.zUa.last()&&qa.input.zUa.last().m4(Ja),fb=new U.a(za,oa);if(!fb.bY)return wa.Z(Ja,new ca.a(za,!1)),!0;k.a.instance.Ta(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
Ja,oa.Qc,La,Fa,kb,!fb.bY,qa.input.source);qa.logger.Og(Object.assign(new J.a,{qj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ja=!1}Fa=wa.lz(Ja,new ca.a(Ka.J(Ja)));({Uk:za,returnValue:ja}=this.hkm.merge(qa,this.fki,this.Zd,Fa,za,oa));ma++;ja&&(qa.runtime.SG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Ja,oa.Qc,ma,va,La)),za&&(wa.nb(za.wm.id)?wa.J(za.wm.id).DNi(za.wm):wa.Z(za.wm.id,za)));return ja});qa.logger.Gha("ObjectMerge");ha&&
k.a.instance.Ta(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",sa.count,ma,La);return ja}l0o(qa){try{for(let La=0;La<qa.runtime.X3d.length;La++){const Pa=qa.runtime.X3d.J(La);if(qa.runtime.fn.J(Pa)){if(!this.VMm(qa,Pa))return!1}else k.a.instance.Ta(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");qa.runtime.SG("Validate markers taking too long")}}catch(La){k.a.instance.Ta(559535579,1,2,"ValidateMerge threw an exception: {0}",La)}return qa.logger.yYc.ami()?
!1:!0}$so(qa){return 38===qa||39===qa||40===qa||41===qa||44===qa||45===qa||33===qa||34===qa?!1:!0}V1l(qa){switch(qa){case 38:case 39:case 40:case 41:return f.a.ke;case 44:case 45:return f.a.yBd;case 33:case 34:return f.a.Xj}return H.CommonProperties.nil}k0o(qa,La){const Pa=this.Zd.getPropertyUint32(qa,f.a.gt);if(!Pa||this.$so(Pa))return!0;qa=this.Zd.getPropertyObjectId(qa,this.V1l(Pa));return la.x7b(La,qa)?!0:(La.logger.yYc.QWd=Pa,!1)}VMm(qa,La){if(qa.runtime.BXf.contains(La))return!1;if(La=la.x7b(qa,
La)){La=this.Zd.getPropertyObjectIds(La,a.a.Hn);for(let Pa=0;Pa<La.length;Pa++){const Ka=la.x7b(qa,La.eg(Pa));if(Ka&&!this.k0o(Ka,qa))return!1}}return!0}Sxo(qa){switch(qa){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}oil(qa,La){let Pa=!1;if(1074135145===qa)return!0;La&&La.uz(123);La&&La.isFeatureEnabled(123)&&1074135153===qa&&(Pa=!0);return Pa}icn(qa){switch(qa){case 1074135162:return!0}return!1}edl(qa,La){const Pa=new n.a,Ka=new n.a,Na=
new n.a;var sa=qa.runtime.VCa;const wa=sa?sa.id:z.a.nil;this.vJf(sa).forEach(ja=>{Pa.add(La(ja));return!0});sa=qa.input.f$.eg(qa.input.f$.length-1);this.vJf(sa,wa).forEach(ja=>{Ka.add(La(ja));return!0});qa=qa.input.zUa.eg(qa.input.zUa.length-1);this.vJf(qa,wa).forEach(ja=>{Na.add(La(ja));return!0});return{PIk:Pa,THo:Ka,y6o:Na}}vJf(qa,La=null){const Pa=new n.a;La||(La=z.a.nil);for(;qa&&!La.equals(qa.id);)Pa.add(qa),qa=qa.UW;Pa.reverse();return Pa}ZDo(qa){const La=3===this.dTd;let Pa=!1;!qa.output.succeeded&&
(2===this.dTd||qa.output.crash&&1===this.dTd)&&(Pa=!0);let Ka=!1;qa.input.f$&&0<qa.input.f$.length&&(La||Pa)&&qa.runtime.zu&&qa.runtime.sk&&qa.runtime.Xb&&(Ka=qa.runtime.Xb.isFeatureEnabled(51));return Ka}Kti(qa){return 9===N.a.Shb(N.a.Ylf(qa))}Yyi(qa){return 8===N.a.Shb(N.a.Ylf(qa))}static yXl(qa){return qa.output.crash?2:qa.output.succeeded?3:1}static x7b(qa,La){if(!La||La===z.a.nil)return null;const Pa=qa.runtime.fn.J(La);return Pa?Pa.wm:qa.runtime.sk.J(La)}}la.bTd=z.a.Ff("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(E.a)(la,"GraphMergerBase",null,[901])},1773:function(E,K,c){E=c(0);var l=c(223),f=c(1628),a=c(182),k=c(1542);class x extends f.a{constructor(n,u,z,w,F,G,H,L,I,N,P,M,J,V){super(n,3,u,z,w,F,G,L,I,N,P,M,J,V);this.Gue=H}get character(){return this.Gue}get text(){return this.character.toString()}z7c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}W6b(){return"CharRun"}clone(){return new x(this.XDc,this.source,this.Hj,this.yg,this.runId,this.iJ,this.character,
this.Blb,this.lQa,this.Mba,this.CEa,this.ZRa,this.xF,this.Yt)}BA(n,u,z,w=!1){return super.BA(n,u,z,w)?n.character===this.character?!0:k.a.huh(n.character,this.character):!1}}Object(E.a)(x,"CharRunMergeBlock",f.a,[]);c.d(K,"a",function(){return y});class y extends f.a{constructor(n,u,z,w,F,G,H,L,I,N,P,M,J,V,X){super(n,1,u,z,w,F,G,L,N,P,M,J,V,X);this._text=H;this.BTe=I}get text(){return this._text}z7c(n){this._text=n}get f7a(){return this.BTe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.BTe)}W6b(){return"TextRun"}clone(){return new y(this.XDc,this.source,this.Hj,this.yg,this.runId,this.iJ,this._text,this.Blb,this.BTe,this.lQa,this.Mba,this.CEa,this.ZRa,this.xF,this.Yt)}BA(n,u,z,w=!1){return super.BA(n,u,z,w)?k.a.guh(this._text,n._text):!1}S8c(){const n=new l.a;for(let z=0;z<this.text.length;z++){var u=k.a.charAt(this._text,z);if(k.a.pSm(k.a.cJo(u))){let w="";w+=u;u=k.a.charAt(this._text,++z);w+=u;u=new y(this.XDc,this.source,this.Hj,this.yg,this.runId,this.iJ,
w,this.Blb,!1,this.lQa,this.Mba,this.CEa,this.ZRa,this.xF,this.Yt);n.add(u)}else u=new x(this.XDc,this.source,this.Hj,this.yg,this.runId,this.iJ,u,this.Blb,this.lQa,this.Mba,this.CEa,this.ZRa,this.xF,this.Yt),n.add(u)}return n}}Object(E.a)(y,"TextRunMergeBlock",f.a,[])},1774:function(E,K,c){E=c(0);var l=c(1013),f=c(15),a=c(365),k=c(223);c(58);c(800);var x=c(602),y=c(168),n=c(182),u=c(1035),z;(function(L){L[L.none=0]="none";L[L.browser=1]="browser";L[L.serverPutChanges=2]="serverPutChanges";L[L.syncDiff=
3]="syncDiff";L[L.docxMerge=4]="docxMerge";L[L.undo=5]="undo"})(z||(z={}));Object(E.b)("GraphMergeSource",z);var w=c(1760),F=c(1558),G=c(1754);c.d(K,"a",function(){return H});class H{constructor(L){this.eB=new u.a;this.dW=new a.a;this.xih=new a.a(0);this.Odd=new k.a;this.cYg=new k.a;this.Z6g=new k.a;this.n4g=new k.a;this.i6g="";this.SVa=null;this.Yr=this.OHe=0;this.Eqd=new a.a(0);this.eAe=this.v$g=this.tnd=0;const {MarkerValidation:I}=c(1869);this._state=L;this.Y$j=new I}get yYc(){return this.Y$j}get k4i(){return this.SVa}tmo(L){this.OHe=
L}y2d(L,I){this.i6g=String.format("{0}-{1}",L,I)}Kge(L){this.uXk();this.eAe=L}Qag(){this.eAe=0}uXk(){this.SVa&&this.Odd.add(this.SVa);this.SVa=null}Og(L){this.SVa||(this.SVa=L);switch(this.eAe){case 1:this.cYg.add(L);break;case 2:this.Z6g.add(L);break;case 3:this.n4g.add(L);break;default:this.SVa&&this.Odd.add(L)}}yIi(L){this.Odd.add(L)}P3m(){this.Yr=this.cEa();this.Gha("MergeEnd")}Gha(L){const I=this.cEa();this.xih.Z(L,I-this.OHe);this.OHe=I}tko(){this.tnd=this.cEa();this.v$g++}EU(L){const I=this.cEa();
let N;({value:N}=this.Eqd.Dc(L)).returnValue?(N+=I-this.tnd,this.Eqd.Z(L,N)):this.Eqd.Z(L,I-this.tnd);this.tnd=I}j2l(){this.dW.Z("Id",this._state.input.wJb.toString());this.dW.Z("Source",z[this._state.input.source]);this.dW.Z("RevSummary",H.xUa(this.y$l()));this.dW.Z("NodesRolledBackIfFailed",H.xUa(this.o4l()));if(!this._state.output.succeeded){let L,I,N,P,M;({RIk:L,pzl:I,PPo:N,WIk:P,RPo:M}=this.pBl(this._state.runtime));this.dW.Z("CharactersLost",this.TOl(L,I,N));this.dW.Z("CharactersLostInComments",
this.XPl());this.dW.Z("CharactersLostInTables",this.yLl(M,P))}this.dW.Z("FuncStep",this.i6g);this.dW.Z("FailureDetail",H.xUa(this.fEb()));this.dW.Z("FailDetailHints",this.VOd(this.cYg));this.dW.Z("FailDetailNaiveMerge",this.VOd(this.Z6g));this.dW.Z("FailDetailLcs",this.VOd(this.n4g));this.dW.Z("ExtraDetails",this.VOd(this.Odd));this.dW.Z("Timeline",H.xUa(this.xih));this.dW.Z("ParagraphMergesCount",this.v$g);this.dW.Z("ParagraphMergeDurations",H.xUa(this.Eqd));this.dW.Z("MarkerInfo",H.xUa(this.yYc.j7h()));
this.dW.Z("Result",H.xUa(this.l2l()));return JSON.stringify(H.xUa(this.dW))}cEa(){return(new Date).getTime()}y$l(){const L=new a.a;let I,N,P;({Sig:I,Lpg:N,VCa:P}=this.brf(this._state,this._state.input.f$,this._state.input.zUa,this._state.input.hGb));L.Z("hasBase",P?"true":"false");if(P){let M=0,J=0;for(;I&&!I.id.equals(P.id);)M++,I=I.UW;for(;N&&!N.id.equals(P.id);)J++,N=N.UW;L.Z("lenToBaseTheirs",I?M:-1);L.Z("lenToBaseYours",N?J:-1)}return L}brf(L,I,N,P){L=I.eg(I.length-1-(P?1:0));I=(N=N.eg(N.length-
1))&&L?L.M0a(N):null;return{Sig:L,Lpg:N,VCa:I}}o4l(){if(!this._state.runtime.Cqi)return null;const L=this._state.runtime.Iq,I=new a.a(0);L.forEach((N,P)=>{({value:N}=I.Dc(P.Qc.toString()));I.Z(P.Qc.toString(),N+1);return!0});return I}TOl(L,I,N){let P=null,M=null,J=null;const V=this._state.runtime.Iq;let X=0;try{J=new G.a(this.eB,this._state);P=F.b(L,I,N);M=new x.a;for(L=0;L<P.length;L++)if(!P.J(L).Dzb.Zp(P.J(L).cqb,(W,U)=>W.equals(U))){const W=this.sRh(P.J(L),J);X+=W;M.add(P.J(L))}P&&V.forEach((W,
U)=>{if(393230===U.Qc){U=null;for(let Y=0;Y<P.length;Y++)if(!M.contains(P.J(Y))&&P.J(Y).cqb.contains(W,(ca,aa)=>ca===aa)){U=P.J(Y);break}U&&(W=this.sRh(U,J),M.add(U),X+=W)}return!0});return X}catch(W){return y.a.instance.Ta(579190992,1,2,"Exception in GetCharactersLost: "+W.toString()),-1}}pBl(L){let I,N,P,M,J;L.SG=X=>{if(750<this.cEa()-this._state.input.sTa)throw y.a.instance.Ta(579190991,1,2,"Timed out while calculating characters lost: {0}",X),n.a.invalidOperation(X);};I=new k.a;N=new k.a;P=new k.a;
M=new k.a;const V=new k.a;J=new k.a;try{if(L.sk){const X=L.sk.J(w.ChildNodeListMerge.W8d);let W,U;W=L.zu.J(w.ChildNodeListMerge.W8d)||X;U=L.Iq.J(w.ChildNodeListMerge.W8d)||X;this.Pjf(X,Y=>L.sk.J(Y),I,M);this.Pjf(W,Y=>L.zu.J(Y)||L.sk.J(Y),N,V);this.Pjf(U,Y=>L.Iq.J(Y)||L.sk.J(Y),P,J)}}catch(X){y.a.instance.Ta(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+X.toString())}return{RIk:I,pzl:N,PPo:P,WIk:M,RPo:J}}yLl(L,I){try{let P=0;const M=this._state.runtime;var N=X=>M.Iq.J(X)||M.sk.J(X);const J=
new x.a,V=this.aDl(L,M,N,J);for(L=0;L<V.count;L++){let X=V.keys.J(L);const W=V.J(X);if(!J.contains(X)){let U=this.Sgi(M,N,J,X,W);if(-1!==U)P+=U;else return y.a.instance.Ta(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(N=0;N<I.length;N++){let X=I.J(0);if(!J.contains(X)){let W=this.rSd(M.sk.J(X));if(-1===W)return y.a.instance.Ta(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;P+=W}}return P}catch(P){return y.a.instance.Ta(573089735,
1,2,"Exception in GetAllTablesCharactersLost: "+P.toString()),-1}}Sgi(L,I,N,P,M){L.SG("GetTableCharactersLost");let J=0;M=this.eB.getPropertyObjectIds(M,f.a.ef);for(let Y=0;Y<M.length;Y++){var V=I(M.J(Y));V=this.eB.getPropertyObjectIds(V,f.a.ef);for(let ca=0;ca<V.length;ca++){var X=I(V.J(ca));if(L.sk.J(M.J(Y))&&L.sk.J(V.J(ca))){var W=L.sk.J(V.J(ca));if(!W)return y.a.instance.Ta(573089737,1,2,"Base cell unexpectedly null"),-1;X=this.eB.getPropertyObjectIds(W,f.a.ef);var U=L.zu.J(V.J(ca))||L.sk.J(V.J(ca));
U=this.eB.getPropertyObjectIds(U,f.a.ef);W=this.eB.getPropertyObjectIds(W,f.a.ef);X=F.b(X,U,W);for(W=0;W<X.length;W++){U=X.J(W);const aa=this.lem(L,I,N,U);if(-1===aa)return y.a.instance.Ta(573089738,1,2,"Error getting characters lost for parition {0}",U.toString()),-1;J+=aa}}else{W=this.Wem(I,X,N);if(-1===W)return y.a.instance.Ta(573089736,1,2,"Error getting text length of cell {0}",X.id.toString()),-1;J+=W}}}N.add(P);return J}lem(L,I,N,P){let M=0;var J=new k.a,V=new k.a;const X=new a.a;new a.a;for(var W=
0;W<P.Dzb.length;W++){var U=L.sk.J(P.Dzb.J(W));U=this.eB.getPropertyObjectIds(U,f.a.KK);if(1!==U.length)return y.a.instance.Ta(573089739,1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;var Y=L.sk.J(U.J(0));393230===Y.Qc?J.add(Y):393250===Y.Qc&&X.add(U.J(0),Y)}for(W=0;W<P.cqb.length;W++){U=I(P.cqb.J(W));U=this.eB.getPropertyObjectIds(U,f.a.KK);if(1!==U.length)return y.a.instance.Ta(573089740,1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;Y=I(U.J(0));if(393230===Y.Qc)V.add(Y);else if(393250===
Y.Qc){Y=this.Sgi(L,I,N,U.J(0),Y);if(-1===Y)return y.a.instance.Ta(573089741,1,2,"Error diffing table {0}",U.J(0).toString()),-1;M+=Y}}W=new G.a(this.eB,this._state);if(0<J.length&&0<V.length){J=W.uZh(J,ca=>L.sk.J(ca),V,ca=>I(ca));if(-1===J)return y.a.instance.Ta(573089742,1,2,"Problem diffing parition {0} with LCS",P.toString()),-1;M+=J}else if(0<J.length)for(P=0;P<J.length;P++)M+=this.eB.getPropertyString(J.J(P),f.a.mo).length+1;else if(0<V.length)for(P=0;P<V.length;P++)M+=this.eB.getPropertyString(V.J(P),
f.a.mo).length+1;for(P=0;P<X.count;P++)if(J=X.keys.J(P),!N.contains(J)){V=this.rSd(X.J(J));if(-1===V)return y.a.instance.Ta(573089743,1,2,"Error getting length of table {0}",J.toString()),-1;M+=V}return M}Wem(L,I,N){let P=0;I=this.eB.getPropertyObjectIds(I,f.a.ef);for(let V=0;V<I.length;V++){var M=L(I.J(V));M=this.eB.getPropertyObjectIds(M,f.a.KK);if(1!==M.length)return y.a.instance.Ta(573089744,1,2,"Unexpected number of ContentNodes: {0}",M.length),-1;var J=L(M.J(0));if(393230===J.Qc)P+=this.eB.getPropertyString(J,
f.a.mo).length+1;else if(393250===J.Qc){J=this.rSd(J);if(-1===J)return y.a.instance.Ta(573089745,1,2,"Problem finding text length of table {0}",M.J(0).toString()),-1;P+=J;N.add(M.J(0))}}return P}rSd(L){this._state.runtime.SG("GetTextLengthOfTable");let I=0;const N=X=>this._state.runtime.Iq.J(X)||this._state.runtime.sk.J(X);L=this.eB.getPropertyObjectIds(L,f.a.ef);for(let X=0;X<L.length;X++){var P=N(L.J(X));P=this.eB.getPropertyObjectIds(P,f.a.ef);for(let W=0;W<P.length;W++){var M=N(P.J(W));M=this.eB.getPropertyObjectIds(M,
f.a.ef);for(let U=0;U<M.length;U++){var J=N(M.J(U));J=this.eB.getPropertyObjectIds(J,f.a.KK);if(1!==J.length)return y.a.instance.Ta(573089746,1,2,"Unexpected number of ContentNodes: {0}",J.length),-1;var V=N(J.J(0));if(393230===V.Qc)I+=this.eB.getPropertyString(V,f.a.mo).length+1;else if(393250===V.Qc){V=this.rSd(V);if(-1===V)return y.a.instance.Ta(573089747,1,2,"Error finding the text length of table {0}",J.J(0)),-1;I+=V}}}}return I}aDl(L,I,N,P){const M=new a.a;for(let J=0;J<L.length;J++){let V=
!1;I.Iq.J(L.J(J))&&(V=!0);const X=N(L.J(J)),W=this.eB.getPropertyObjectIds(X,f.a.ef);if(!V)for(let U=0;U<W.length;U++)if(I.Iq.J(W.J(U))){V=!0;break}V?M.add(L.J(J),X):P.add(L.J(J))}return M}sRh(L,I){return this.rRh(L.Dzb,L.cqb,I)}rRh(L,I,N){const P=new k.a;for(var M=0;M<L.length;M++)P.add(this._state.runtime.sk.J(L.J(M)));L=new k.a;for(M=0;M<I.length;M++)L.add(this._state.runtime.Iq.J(I.J(M))||this._state.runtime.sk.J(I.J(M)));return N.uZh(P,J=>this._state.runtime.sk.J(J),L,J=>this._state.runtime.Iq.J(J)||
this._state.runtime.sk.J(J))}Pjf(L,I,N,P){if(393227===L.Qc){L=this.eB.getPropertyObjectIds(L,f.a.ef);for(let M=0;M<L.length;M++){const J=this.eB.getPropertyObjectIds(I(L.J(M)),f.a.ef);for(let V=0;V<J.length;V++){const X=this.eB.getPropertyObjectIds(I(J.J(V)),f.a.ef);for(let W=0;W<X.length;W++){const U=this.eB.getPropertyObjectIds(I(X.J(W)),f.a.KK);if(1!==U.length)return;const Y=I(U.J(0));393230===Y.Qc?N.add(U.J(0)):393250===Y.Qc?P.add(U.J(0)):y.a.instance.Ta(573089748,1,2,"Unsupported class id in GetCharactersLost: "+
l.a[Y.Qc])}}}}}Qjf(L,I){L=this.eB.getPropertyObjectIds(L,f.a.ef);const N=new k.a;for(let P=0;P<L.length;P++){const M=this.eB.getPropertyObjectIds(I(L.J(P)),f.a.KK);if(1!==M.length)return null;N.add(M.J(0))}return N}XPl(){let L=0;const I=this._state.runtime,N=I.Iq,P=J=>I.Iq.J(J)||I.sk.J(J);let M=null;I.SG=J=>{if(750<this.cEa()-this._state.input.sTa)throw y.a.instance.Ta(573089749,1,2,"Timed out while calculating comment characters lost: {0}",J),n.a.invalidOperation(J);};try{N.forEach((J,V)=>{if(1074135127===
V.Qc){J=this.Qjf(V,P);var X=I.sk.J(V.id);if(X)X=this.Qjf(X,U=>I.sk.J(U)),M||(M=new G.a(this.eB,this._state)),L+=this.rRh(X,J,M);else for(X=0;X<J.length;X++)L+=this.eB.getPropertyString(I.Iq.J(J.J(X)),f.a.mo).length+1}if(1074135126===V.Qc&&(J=this.eB.getPropertyObjectIds(V,f.a.ef).TG(),V=I.sk.J(V.id)))for(V=this.eB.getPropertyObjectIds(V,f.a.ef),X=0;X<V.length;X++)if(!J.contains(V.J(X))){var W=I.sk.J(V.J(X));W=this.Qjf(W,U=>I.sk.J(U));for(let U=0;U<W.length;U++)L+=this.eB.getPropertyString(I.sk.J(W.J(U)),
f.a.mo).length+1}return!0})}catch(J){return y.a.instance.Ta(573089750,1,2,"Exception in GetCommentCharactersLost: "+J.toString()),-1}return L}fEb(){return this.SVa?this.SVa.fEb():null}VOd(L){const I=new k.a;L.forEach(N=>{I.add(H.xUa(N.fEb()));return!0});return I.toArray()}l2l(){const L=new a.a;L.Z("Succeeded",this._state.output.succeeded);L.Z("Timeout",this._state.output.timeout);L.Z("Crash",this._state.output.crash);L.Z("MergedRevisions",this._state.output.KM?this._state.output.KM.length:-1);L.Z("Duration",
this.Yr-this._state.input.sTa);return L}static xUa(L){if(!L)return null;const I={};L.forEach((N,P)=>{I[N.toString()]=P;return!0});return I}}Object(E.a)(H,"MergeLogger",null,[])},1775:function(E,K,c){E=c(0);var l=c(243),f=c(15),a=c(6),k=c(116),x=c(800),y=c(168),n=c(223),u=c(365),z=c(1488);class w{constructor(H,L,I){this.position=H;this.leader=L;this.val=I}equals(H){return this.position===H.position&&this.leader===H.leader&&this.val===H.val}toString(){return this.position.toString()}}Object(E.a)(w,
"TabStop",null,[]);var F=c(1870);c.d(K,"a",function(){return G});class G extends z.a{constructor(){super()}get Mn(){return 20}get kA(){return 0}uk(){const H=super.uk();H.Z(x.a.yb(f.a.mo),1);H.Z(x.a.yb(f.a.Hn),1);H.Z(x.a.yb(f.a.zm),1);H.Z(x.a.yb(a.a.$s),1);H.Z(x.a.yb(a.a.jq),1);H.Z(x.a.yb(a.a.Lc),1);H.Z(x.a.yb(f.a.$ob),1);H.Z(x.a.yb(a.a.jPa),1);H.Z(x.a.yb(a.a.IGa),1);H.Z(x.a.yb(f.a.mxa),1);H.Z(x.a.yb(a.a.ZEa),1);H.Z(x.a.yb(a.a.Yfa),1);H.Z(x.a.yb(a.a.$Ea),1);H.Z(x.a.yb(a.a.wDa),1);H.Z(x.a.yb(a.a.aFa),
1);H.Z(x.a.yb(a.a.xDa),1);H.Z(x.a.yb(a.a.HGa),1);H.Z(x.a.yb(a.a.nIa),1);H.Z(x.a.yb(a.a.oIa),1);H.Z(x.a.yb(a.a.Zya),1);H.Z(x.a.yb(a.a.Cv),1);H.Z(x.a.yb(a.a.wz),1);H.Z(x.a.yb(a.a.xz),1);H.Z(x.a.yb(a.a.uw),1);H.Z(x.a.yb(k.a.CJ),6);H.Z(x.a.yb(k.a.tUa),6);H.Z(x.a.yb(a.a.AAb),7);H.Z(x.a.yb(k.a.CJ),6);H.Z(x.a.yb(a.a.ctj),2);H.Z(x.a.yb(k.a.c4k),2);H.Z(x.a.yb(k.a.Jyn),2);H.Z(x.a.yb(a.a.Hlc),2);H.Z(x.a.yb(a.a.O$c),2);H.Z(x.a.yb(a.a.kQb),2);H.Z(x.a.yb(a.a.y7a),2);H.Z(x.a.yb(a.a.P$c),2);H.Z(x.a.yb(a.a.Q$c),2);
H.Z(x.a.yb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);H.Z(x.a.yb(a.a.listID),3);H.Z(x.a.yb(a.a.listLevel),3);return H}aC(H,L){if(L===x.a.yb(f.a.mo)||L===x.a.yb(f.a.Hn)||L===x.a.yb(f.a.zm)||L===x.a.yb(a.a.$s)||L===x.a.yb(a.a.jq)||L===x.a.yb(a.a.Lc)||L===x.a.yb(f.a.$ob)||L===x.a.yb(a.a.jPa)||L===x.a.yb(a.a.IGa)||L===x.a.yb(f.a.mxa)||L===x.a.yb(a.a.ZEa)||L===x.a.yb(a.a.Yfa)||L===x.a.yb(a.a.$Ea)||L===x.a.yb(a.a.wDa)||L===x.a.yb(a.a.aFa)||L===x.a.yb(a.a.xDa)||L===x.a.yb(a.a.HGa)||L===
x.a.yb(a.a.nIa)||L===x.a.yb(a.a.oIa)||L===x.a.yb(a.a.Zya)||L===x.a.yb(a.a.Cv)||L===x.a.yb(a.a.jN)){var I=H.vn.value.Ku,N=H.vn.value.yf;L=H.Ng.value.yf;if(H.iq.runtime.iNa.contains(I.id))return y.a.instance.Ta(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",I.id),!0;if(H.iq.runtime.Xb.$hb(1000005)&&this.$xo(H,L,N))return H.Uk=L.IK(),G.Rnh(H),G.nzd(H.iq,H.Zd,N),!0;const P=new n.a;P.add(I);I=new n.a;I.add(N);N=new n.a;
N.add(L);if(!({fn:L}=G.jCj(H.iq,P,N,I)).returnValue)return H.Fog=!0,H.Uk=null,!1;G.Rnh(H);H.Uk=L.eg(0).wm;return!0}return L===x.a.yb(a.a.wz)||L===x.a.yb(a.a.xz)||L===x.a.yb(a.a.uw)?(this.TMo(H),H.sg.add(x.a.yb(a.a.wz)),H.sg.add(x.a.yb(a.a.xz)),H.sg.add(x.a.yb(a.a.uw)),!0):!1}$xo(H,L,I){L=H.Zd.getPropertyString(L,a.a.jN);H=H.Zd.getPropertyString(I,a.a.jN);return L||H?!0:!1}TMo(H){const L=H.Zd,I=H.Uk;var N=H.vn.value.yf,P=H.Ng.value.yf;H=this.Xof(H.vn.value.Ku,L);P=this.Xof(P,L);N=this.Xof(N,L);({lcn:N,
mcn:H,ncn:P}=this.n2l(H,P,N));N.length?(L.setPropertyUint32s(I,a.a.uw,N),L.setPropertyUint32s(I,a.a.wz,H),L.setPropertyUint32s(I,a.a.xz,P)):this.yYn(I)}Xof(H,L){const I=L.getPropertyUint32s(H,a.a.uw),N=L.getPropertyUint32s(H,a.a.wz);H=L.getPropertyUint32s(H,a.a.xz);L=new n.a;if(!I)return L;for(let P=0;P<I.length;++P)L.add(new w(I.J(P),N.J(P),H.J(P)));return L}n2l(H,L,I){({PYi:L,QYi:J,RYi:M}=this.U6h(H,L));let N,P;({PYi:I,QYi:N,RYi:P}=this.U6h(H,I));H=this.Klm(H,J,M,N,P);var M=this.Jlm(H,L,I);H=new n.a;
L=new n.a;var J=new n.a;for(I=0;I<M.length;++I)H.add(M.J(I).position),L.add(M.J(I).leader),J.add(M.J(I).val);return{lcn:H,mcn:L,ncn:J}}U6h(H,L){let I,N,P;I=new n.a;N=new u.a;P=new u.a;let M,J;for(M=J=0;M<H.length&&J<L.length;)H.J(M).position===L.J(J).position?(H.J(M).equals(L.J(J))||P.Z(H.J(M).position,L.J(J)),++M,++J):H.J(M).position<L.J(J).position?(N.Z(H.J(M).position,H.J(M)),++M):(I.add(L.J(J)),++J);for(;M<H.length;)N.Z(H.J(M).position,H.J(M)),++M;for(;J<L.length;)I.add(L.J(J)),++J;return{PYi:I,
QYi:N,RYi:P}}Klm(H,L,I,N,P){const M=new n.a;for(let J=0;J<H.length;++J){const V=H.J(J).position;L.nb(V)||(I.nb(V)?M.add(I.J(V)):N.nb(V)||(P.nb(V)?M.add(P.J(V)):M.add(H.J(J))))}return M}Jlm(H,L,I){L=this.BNi(L,I);return this.BNi(H,L)}BNi(H,L){const I=new n.a;let N,P;for(N=P=0;N<H.length&&P<L.length;)H.J(N).position<=L.J(P).position?(I.add(H.J(N)),H.J(N).position===L.J(P).position&&++P,++N):I.add(L.J(P++));for(;N<H.length;)I.add(H.J(N++));for(;P<L.length;)I.add(L.J(P++));return I}yYn(H){H.removeProperty(a.a.uw);
H.removeProperty(a.a.wz);H.removeProperty(a.a.xz)}static kh(){return new G}static get instance(){return G.Lg.value}static Rnh(H){H.sg.add(x.a.yb(f.a.mo));H.sg.add(x.a.yb(f.a.Hn));H.sg.add(x.a.yb(f.a.zm));H.sg.add(x.a.yb(a.a.$s));H.sg.add(x.a.yb(a.a.jq));H.sg.add(x.a.yb(a.a.Lc));H.sg.add(x.a.yb(f.a.$ob));H.sg.add(x.a.yb(a.a.jPa));H.sg.add(x.a.yb(a.a.IGa));H.sg.add(x.a.yb(f.a.mxa));H.sg.add(x.a.yb(a.a.ZEa));H.sg.add(x.a.yb(a.a.Yfa));H.sg.add(x.a.yb(a.a.$Ea));H.sg.add(x.a.yb(a.a.wDa));H.sg.add(x.a.yb(a.a.aFa));
H.sg.add(x.a.yb(a.a.xDa));H.sg.add(x.a.yb(a.a.HGa));H.sg.add(x.a.yb(a.a.nIa));H.sg.add(x.a.yb(a.a.oIa));H.sg.add(x.a.yb(a.a.Zya));H.sg.add(x.a.yb(a.a.Cv));H.sg.add(x.a.yb(a.a.jN))}static jCj(H,L,I,N){return(new F.a(H,L,I,N)).Rlc()}static nzd(H,L,I){I=L.getPropertyObjectIds(I,f.a.Hn);for(let P=0;P<I.length;P++){var N=H.runtime.Iq.J(I.eg(P));if(N&&(N=L.getPropertyObjectId(N,a.a.ke))){H.runtime.Vjc.add(N);break}}}}G.Lg=new l.a(G.kh);Object(E.a)(G,"ParagraphNodeComplexMerge",z.a,[])},1776:function(E,
K,c){E=c(0);var l=c(74),f=c(1496),a=c(1623),k=c(1543),x=c(1514),y=c(1561),n=c(1497),u=c(1501),z=c(1500),w=c(1494),F=c(1493);class G{constructor(Y){this.fc=Y;this.jvd=this.kuf()}aL(){return"Add-ins"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:3}QH(Y,ca){Y=new z.a(Y);ca.resultsUpdated(Y)}hib(Y,ca,aa){let fa;fa=this.fc.sP?new u.a(29):new u.a(27);fa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;aa&&this.Ewo(Y.Dg,ca,fa)}Ewo(Y,ca,aa){const fa=[];let pa;pa=this.fc.DEm?this.fc.sP&&this.fc.Gdb?
F.a.chb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):this.fc.EEm?this.fc.sP&&this.fc.Gdb?F.a.chb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.fc.sP&&this.fc.Gdb?F.a.chb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,
Y);this.fc.Yva?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",pa)),w.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y))):(fa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",pa)),fa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(fa));aa.Nw(new n.a("LaunchAddinDialogFromTellMe",29));ca.Uu(aa)}kuf(){const Y=[];this.fc.kXd&&
Array.add(Y,"Addin");return Y}}Object(E.a)(G,"AddinStoreResultsProvider",null,[942]);var H=c(1727),L=c(1533),I=c(1544),N=c(1728),P=c(1761),M=c(1729),J=c(1560),V=c(2),X=c(35),W=c(135);c.d(K,"a",function(){return U});class U{constructor(Y,ca,aa){this.xcb=this.XAc=this.YAc=this.rud=!1;this.eQ=null;this.U1=-1;this.fYa=this.QBc=this.Yea=this.Mxb=null;this.N3g=this.W3g=0;this.fc=Y;const fa=F.a.sha();this.w$a=ca||[];this.Yf=V.AFrameworkApplication.Ne;this.Ffh=Y.xWf;this.ZAc=Y.wWf;this.pud=fa&&this.MOb();
this.qud=fa&&this.NOb();this.Hfh=fa&&this.OOb();this.tud=this.QOb();this.PRe=this.ujc();if((ca=Y.Igg&&F.a.Kcg(Y))||Y.dga)this.Mxb=new P.a(Y),this.rud=Y.U9c;ca&&(this.YAc=Y.W9c,this.XAc=Y.kkb,this.xcb=this.rud&&this.gx("File")||this.YAc&&this.gx("People")||this.XAc&&this.gx("Notes"));this.oud=this.xso();this.aBc=Y.b0c;this.sud=this.Rso();this.ORe=this.wso();this.eZb=this.Rhe();this.r$=this.Oem();this.CLg=new H.a(Y);this.Z5j=new N.a(Y);this.ylk=new M.a(Y);this.RUj=new G(Y);this.Qzc=aa;this.kxb=new a.a;
this.aBc&&(this.CLg=new H.a(Y));Y.dga&&(this.ORe=this.sud=this.aBc=this.xcb=this.XAc=this.YAc=this.PRe=this.tud=this.Hfh=this.qud=this.pud=this.ZAc=!1,V.AFrameworkApplication.K&&this.gx("File")&&this.Bqj()||this.eZb)&&(Y=this.kxb.Uuf("Search",V.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")),this.ALc(Y,"TellMeService",!0),Y=this.kxb.Uuf("SmartLookup",V.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")),this.ALc(Y,"Shredder",!1));V.AFrameworkApplication.K&&this.xcb&&
this.gx("File")&&this.Bqj()&&(Y=this.kxb.Uuf("Search",V.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")),this.ALc(Y,"TellMeService",!0))}gx(Y){return Array.contains(this.w$a,Y)?!0:!1}aL(){return"TellMeService"}eU(){return 0===this.fc.dv?0:1===this.fc.dv?1:this.gx("Command")||this.gx("Recommended")?2:3}Lem(Y){let ca="";if(!Y&&this.gx("Command")&&this.fc.sEf){ca+="CommandSearch_DLIS,";var aa=this.fc.Pxj;0<aa.length&&(ca+=aa+",")}Y&&this.gx("Recommended")&&this.ZAc&&(aa=this.Yim(),0<
aa.length&&(ca+=aa+","));!Y&&this.gx("Help")&&(Y=this.fc.Oxj,0<Y.length&&(ca+=Y+","));this.fc.dga&&this.fYa&&0<this.fYa.length&&(ca+="IsRecallEnabled_true,");(this.fc.NJd||this.fc.dga)&&this.xcb&&(ca+="IsGenerateSlidesEnabled_true,");0<ca.length&&(ca=ca.substr(0,ca.length-1));return ca}ALc(Y,ca,aa){const fa=aa?this.W3g:this.N3g;if(!fa||window.performance.now()-fa>=F.a.t7a)if(Y)aa?this.W3g=window.performance.now():this.N3g=window.performance.now(),Y.then(pa=>{aa?this.QBc=pa:(this.fYa=pa,w.TellMeActor.instance.Eeg=
pa)},pa=>{w.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+ca,"tellMeServiceToken promise rejected: "+pa)});else if(w.TellMeActor.instance.Oe)w.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+ca,"undefined token promise")}QH(Y,ca,aa,fa=f.a.tellMe,pa=null){const ra=new z.a(Y);aa=F.a.cR(Y);this.gx("File")&&(this.xcb||this.fc.dga)&&this.ALc(this.kxb.Pem(),"TellMeService",!0);(this.gx("File")&&this.fc.dga||this.gx("ActionAI")&&this.eZb)&&this.ALc(this.kxb.Tbm(),
"Shredder",!1);var la=this.xcb&&!!this.QBc;const qa=this.fc.dga&&!!this.fYa;var La=la||qa||aa&&this.gx("Recommended")&&this.ZAc;la=la||qa||!aa&&(this.Ffh&&this.gx("Command")||this.pud&&this.gx("Answer")||this.qud&&this.gx("Definition")||this.PRe&&this.gx("Image")||this.aBc&&this.gx("Help")||this.tud&&this.gx("WolframAnswer")||this.sud&&this.gx("Template")||this.ORe&&this.gx("Addin"));if(La||la)if(this.Yea=fa,fa={"Content-Type":"application/json",Accept:"application/json"},fa["X-Office-Version"]=V.AFrameworkApplication.buildVersion,
fa["X-Office-Application"]=V.AFrameworkApplication.K.jb("Application"),fa["X-Office-Platform"]="WAC",fa["X-TellMe-SqmUserId"]=V.AFrameworkApplication.K.jb("LoggableUserId")||"",fa["X-TellMe-SessionId"]=w.TellMeActor.instance.oSd(),this.QBc&&(fa.Authorization="Bearer "+this.QBc),this.fYa&&0<this.fYa.length&&(fa["X-TellMe-ShredderToken"]="Bearer "+this.fYa),La=this.Lem(aa),0<La.length&&(fa["X-TellMe-Flights"]=La),La=[],!aa&&this.gx("Answer")&&this.pud&&(pa?Array.contains(pa,9):1)&&Array.add(La,"Answer"),
!aa&&this.gx("Command")&&this.Ffh&&!L.CommandResultsUtility.QBf(Y.Dg)&&(pa?Array.contains(pa,17):1)&&Array.add(La,"Command"),!aa&&this.gx("Definition")&&this.qud&&(pa?Array.contains(pa,10):1)&&Array.add(La,"Definition"),!aa&&this.gx("Help")&&this.aBc&&(pa?Array.contains(pa,8):1)&&Array.add(La,"Help"),!aa&&this.gx("WolframAnswer")&&this.tud&&(pa?Array.contains(pa,12):1)&&Array.add(La,"WolframAnswer"),aa&&this.gx("Recommended")&&this.ZAc&&!w.TellMeActor.instance.obd&&(pa?Array.contains(pa,18):1)&&Array.add(La,
"Recommended"),!aa&&this.gx("Image")&&this.PRe&&(pa?Array.contains(pa,19):1)&&Array.add(La,"Image"),this.QBc&&this.xcb&&(pa?Array.contains(pa,14)||Array.contains(pa,15)||Array.contains(pa,20):1)&&(this.Mxb.O5a(),this.rud&&this.gx("File")&&Array.add(La,"File"),this.YAc&&this.gx("People")&&Array.add(La,"People"),this.XAc&&this.gx("Notes")&&Array.add(La,"Notes")),this.fYa&&0<this.fYa.length&&this.fc.dga&&(pa?Array.contains(pa,15):1)&&(this.Mxb.O5a(),this.gx("File")&&Array.add(La,"File")),!aa&&this.gx("Template")&&
this.sud&&(pa?Array.contains(pa,23):1)&&Array.add(La,"Template"),!aa&&this.gx("Addin")&&this.ORe&&(pa?Array.contains(pa,27):1)&&Array.add(La,"Addin"),!aa&&this.gx("ActionAI")&&this.eZb&&(pa?Array.contains(pa,25):1)&&Array.add(La,"ActionAI"),La.length){fa["X-TellMe-SuggestionTypes"]=La.join(",");fa["X-TellMe-Culture"]=V.AFrameworkApplication.uiCulture;fa["X-TellMe-ProcessSessionId"]=V.AFrameworkApplication.userSessionId;var Pa=this.eQ=W.a.create().toString();fa["Client-Request-Id"]=Pa;var Ka=window.performance.now();
this.NCa();this.U1=window.setTimeout(()=>{if(Pa===this.eQ){this.eQ="";this.U1=-1;ca.resultsUpdated(ra);const Na={};Na[k.a.provider]=this.aL();Na[k.a.aMb]=Y.gnb;w.TellMeActor.instance.Oe.JA(x.a.timedOut,this.Qzc,Na)}},this.Qzc);this.Yf.tj(this.r$,2,this.Nem(Y.Dg),fa,!1,0,Na=>{this.JKb(Na,Y,ca,Pa,Ka,pa)},Na=>{this.qKb(Na,Y,ca,Pa,Ka)},null,null,!1,4E3,this.eZb?3E4:6E3)}else w.TellMeActor.instance.Oe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ca.resultsUpdated(ra);
else ca.resultsUpdated(ra)}NCa(){-1!==this.U1&&(window.clearTimeout(this.U1),this.U1=-1)}JKb(Y,ca,aa,fa,pa,ra){const la=new z.a(ca);if(fa===this.eQ){this.NCa();w.TellMeActor.instance.Oe.v0(ca.Dg.length,this.w$a.join(","),Y.data.Qe.toString(),Math.round(window.performance.now()-pa),J.a.tellMe,!0,y.a.zPa);fa=Y.data.we;Y=null;try{Y=X.b(fa)}catch(sa){w.TellMeActor.instance.Oe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+sa);return}fa=F.a.cR(ca);if("Groups"in Y&&Y.Groups){var qa=
Y.Groups;for(var La of qa)if("GroupType"in La&&"Suggestions"in La&&La.Suggestions)if("Commands"===La.GroupType&&(ra?Array.contains(ra,17):1)||"Recommended"===La.GroupType&&(ra?Array.contains(ra,18):1)){var Pa=(qa="Recommended"===La.GroupType)?"DLIS":"NaiveBayes";"Source"in La&&La.Source&&(Pa=La.Source);var Ka=La.Suggestions;new l.a;var Na=[];for(const sa of Ka)this.JTm(sa)&&(Ka=sa.Type,("Command"===Ka||qa&&"Recommended"===Ka)&&Na.push(new I.a(sa.CommandId,sa.Score)));L.CommandResultsUtility.p2d(Na,
!ca.Dg.trim().length,La.GroupType,Pa);Pa=w.TellMeActor.instance.A2;Ka=[];for(const sa of Na)qa&&Pa&&Pa.k9e(sa.commandId)||Ka.push(sa);Na=L.CommandResultsUtility.lPc(ca,Ka,this.fc,null,null,null,qa?18:17,0);0<Na.results.length&&(this.Yea!==f.a.contextMenu&&(Na.displayName=qa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),la.Uu(Na))}else if("Answer"===La.GroupType){Ka=La.Suggestions;qa=null;Na=2147483647;Pa="";for(const sa of Ka)if(this.ITm(sa))if(Pa=sa.Type,Ka=
this.pRd(Pa),"Answer"===Pa&&this.pud){qa=this.nMh(Pa,sa,ca.Dg);break}else Ka&&Ka<Na&&(Na=Ka,qa=this.nMh(Pa,sa,ca.Dg));Na=F.a.E6n(ca.Dg,Pa);qa&&(ra?Array.contains(ra,qa.type):1)&&(Pa=[],this.oud?this.fc.Yva?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa.value,qa.aD)),w.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa.value,qa.description)),w.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa.value,
Na))):(Pa.push(appChrome.actions.setControlLabel(qa.value,qa.aD)),Pa.push(appChrome.actions.updateCompoundButtonDescription(qa.value,qa.description)),Pa.push(appChrome.actions.setCompoundButtonCommandValueId(qa.value,Na)),appChrome.api.dispatch(Pa)):this.fc.Yva?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa.value,qa.aD+" - "+qa.description)),w.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(qa.value,Na))):(Pa.push(appChrome.actions.setControlLabel(qa.value,
qa.aD+" - "+qa.description)),Pa.push(appChrome.actions.setButtonCommandValueId(qa.value,Na)),appChrome.api.dispatch(Pa)),Na=this.kdl(qa.type),Na.Nw(qa),la.Uu(Na))}else"Help"===La.GroupType&&La.Suggestions.length&&(ra?Array.contains(ra,8):1)?this.aBc&&(qa=this.CLg.hib(ca,La.Suggestions))&&0<qa.results.length&&la.Uu(qa):"Template"===La.GroupType&&(ra?Array.contains(ra,23):1)?(qa=La.Suggestions)&&0<qa.length&&this.ylk.hib(ca,la,qa):"Addin"===La.GroupType&&(ra?Array.contains(ra,27):1)?(qa=La.Suggestions)&&
0<qa.length&&this.RUj.hib(ca,la,qa):"ActionAI"===La.GroupType&&(ra?Array.contains(ra,25):1)?(Na=La.Suggestions,qa=[],new u.a(25),Na&&1===Na.length&&(Pa=Na[0])&&Pa.CommandId&&(Na=Pa.CommandId,qa.push(new I.a(Na,"Score"in Pa?Pa.Score:0)),qa=L.CommandResultsUtility.lPc(ca,qa,this.fc,null,null,null,25,0),qa.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,la.Uu(qa))):"Substrate"===La.GroupType&&this.xcb&&"Type"in La?"File"===La.Type&&this.rud&&(ra?Array.contains(ra,15):1)?(qa=this.Mxb.Lpf(La.Suggestions,
fa,this.Yea))&&0<qa.results.length&&(this.CYd()&&(Na=new n.a("GenerateSlidesFromTellMe",30,"",null,1),qa.Nw(Na)),la.Uu(qa)):"People"===La.Type&&this.YAc&&(ra?Array.contains(ra,14):1)?(qa=this.Mxb.hdi(La.Suggestions,fa,this.Yea))&&0<qa.results.length&&la.Uu(qa):"Notes"===La.Type&&this.XAc&&(ra?Array.contains(ra,14):1)&&(qa=this.Mxb.Qbi(La.Suggestions,fa,ca))&&0<qa.results.length&&la.Uu(qa):"Recall"===La.GroupType&&this.fc.dga&&"Type"in La&&"IntentService"===La.Type&&(ra?Array.contains(ra,15):1)&&(qa=
this.Mxb.Lpf(La.Suggestions,fa,this.Yea))&&0<qa.results.length&&(this.CYd()&&(Na=new n.a("GenerateSlidesFromTellMe",30,"",null,1),qa.Nw(Na)),la.Uu(qa));else w.TellMeActor.instance.Oe.onError("OnSuccessCallBack","GroupType"in La?"Invalid group suggestions found for "+La.GroupType:"Invalid group found")}if(Y.Intents){La=Y.Intents;for(const sa of La)this.RGf(sa)&&("Image"===sa.GroupType&&sa.ConfidenceScore>sa.ConfidenceThreshold&&(ra?Array.contains(ra,19):1)?this.Z5j.hib(ca,la,0,sa):"Commands"===sa.GroupType&&
sa.ConfidenceScore<sa.ConfidenceThreshold&&(ra?Array.contains(ra,17):1)&&(La=new u.a(17),la.Uu(La)))}aa.resultsUpdated(la);w.TellMeActor.instance.Oe.v0(ca.Dg.length,this.w$a.join(","),"",Math.round(window.performance.now()-pa),"",!0,y.a.provider)}}qKb(Y,ca,aa,fa,pa){const ra=new z.a(ca);fa===this.eQ&&(this.NCa(),w.TellMeActor.instance.Oe.v0(ca.Dg.length,this.w$a.join(","),Y.data.Qe.toString(),Math.round(window.performance.now()-pa),J.a.tellMe,!1,y.a.zPa));aa.resultsUpdated(ra)}pRd(Y){switch(Y){case "Entity":return this.Hfh?
3:0;case "Definition":return this.qud?5:0;case "WolframAnswer":return this.tud?2:0;default:return 0}}nMh(Y,ca,aa){switch(Y){case "Answer":return new n.a(this.oud?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ca.Title?aa:ca.Title,ca.Description,0);case "Entity":return new n.a(this.oud?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ca.Title?aa:ca.Title,ca.Description,0);case "Definition":return new n.a(this.oud?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ca.Title?aa:ca.Title,ca.Description,
0);case "WolframAnswer":return new n.a("WolframForSearch",3,""===ca.Title?aa:ca.Title,ca.Description,0);default:return null}}kdl(Y){switch(Y){case 0:return new u.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.fc.pjc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}ITm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}JTm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&""!==Y.CommandId&&"Score"in Y&&!!Y.Score}RGf(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in Y)return!0;w.TellMeActor.instance.Oe.onError("IsValidIntentGroup","Invalid intents found");return!1}Nem(Y){const ca=F.a.mBi(Y),aa={};aa.Query=Y;ca&&this.ZAc&&(this.CNm()?
aa.UserActionEvents=w.TellMeActor.instance.fkh:(aa.CommandClickedEvents=w.TellMeActor.instance.wve,aa.CommandActionEvents=w.TellMeActor.instance.POg),aa.TellMeCommandClickMruEvents=w.TellMeActor.instance.R6g,aa.ContentType=w.TellMeActor.instance.oHd);this.sud&&(Y={},Y.Application=this.fc.application,aa.TemplateInfo=Y);return X.c(aa)}MOb(){return!!this.fc&&this.fc.MOb||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Nb.MOb}NOb(){return!!this.fc&&this.fc.NOb||!!V.AFrameworkApplication.ta&&
V.AFrameworkApplication.ta.Nb.NOb}OOb(){return!!this.fc&&this.fc.OOb||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Nb.OOb}QOb(){return!!this.fc&&this.fc.QOb||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Nb.QOb}ujc(){return!!this.fc&&(this.fc.ujc||this.fc.sP)}xso(){return!!this.fc&&!this.fc.q3a}Rso(){return!!this.fc&&this.fc.aWc}wso(){return!!this.fc&&this.fc.FEm&&this.fc.CEm}Rhe(){return!!this.fc&&this.fc.Rhe}$Bi(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}aCi(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}CNm(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}CYd(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Bqj(){return!!V.AFrameworkApplication.K&&
V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}Yim(){return V.AFrameworkApplication.K?V.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}Oem(){if(!V.AFrameworkApplication.K)return"";if(this.aCi())return V.AFrameworkApplication.K.jb("TellMeServiceProdEndpointForSearch");if(this.$Bi())return V.AFrameworkApplication.K.jb("TellMeServiceEdogEndpointForSearch");if(F.a.vCf())return V.AFrameworkApplication.K.jb("TellMeServiceIntEndpointForSearch");
let Y=V.AFrameworkApplication.K.jb("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=V.AFrameworkApplication.Nxj);return Y}static QMh(Y,ca){if(ca)return new U(Y,["Command","Recommended"],Y.qVl);ca=F.a.sha()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new U(Y,ca,Y.$fi)}}Object(E.a)(U,"TellMeServiceProvider",null,[942])},1869:function(E,K,c){c.r(K);c.d(K,"MarkerValidation",
function(){return a});E=c(0);var l=c(365),f=c(1774);class a{constructor(){this.QWd=this.Isi=this.Hsi=this.Gsi=0}j7h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.Gsi);k.Z("InvalidComments",this.Hsi);k.Z("InvalidContentControls",this.Isi);0!==this.QWd&&k.Z("InvalidMarkerType",this.QWd);return k}ami(){return 0<this.Gsi||0<this.Hsi||0<this.Isi||0!==this.QWd?!0:!1}toString(){return JSON.stringify(f.a.xUa(this.j7h()))}}Object(E.a)(a,"MarkerValidation",null,[])},1870:function(E,K,c){c.d(K,"a",function(){return y});
E=c(0);var l=c(168),f=c(1035),a=c(236),k=c(1642),x=c(1564);class y{constructor(n,u,z,w,F=null,G=null,H=null,L=null){this.Yd=n;this.EF=u;this.sAa=z;this.MBa=w;this.xak=F;this.a2j=G;this.Qmk=H;this.Xra=L||this.V$e()}V$e(){return n=>!!this.Yd.runtime.Xb&&this.Yd.runtime.Xb.isFeatureEnabled(n)}Y9k(){return()=>this.Yd.runtime.Xb}Lff(){return!!this.Yd.runtime.sk.J(a.a.xL)}wtj(){let n;if(1===this.Yd.input.source||2===this.Yd.input.source)n=80;else if(4===this.Yd.input.source||3===this.Yd.input.source)n=
40;else if(5===this.Yd.input.source)n=118;else return!1;return this.Lff()&&this.Xra(n)}Bvj(n,...u){return String.format.apply(null,[n].concat(u))}PQd(n){const {ParagraphMerge:u}=c(1962);let z=this.Yd,w=this.sAa,F=this.MBa;n||(z=this.xak||this.Yd,w=this.a2j||w,F=this.Qmk||F);var G=x.a.Erf(this.EF);const H=x.a.Erf(w),L=x.a.Erf(F);G=this.Bvj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.VCa.id,z.runtime.pLd,z.runtime.Tme,G.dr(),H.dr(),L.dr());return n?{returnValue:new k.a(z,this.EF,w,F,this.V$e(),new f.a),dr:G}:{returnValue:new u(z,this.EF,w,F,this.V$e(),this.Y9k(),new f.a),dr:G}}Rlc(){this.Yd.logger.tko();var n=this.wtj();var u=({dr:w}=this.PQd(n)).returnValue;l.a.instance.Ta(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",n,w);this.Yd.logger.EU("ParagraphMergeSelector initialization");n?this.Yd.logger.Kge(1):this.Yd.logger.Kge(2);
let z=({fn:u}=u.Rlc()).returnValue;this.Yd.logger.Qag();var w=!z;n=!!this.Yd.runtime.sk.J(a.a.xL)&&(n&&!z||!n);w&&({dr:w,returnValue:u}=this.PQd(!1),{fn:u,returnValue:z}=u.Rlc(),l.a.instance.Ta(18994390,1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,w));n&&(w=new f.a,x.a.u5n(this.Yd,w));this.Yd.logger.EU("ParagraphMergeSelector finalization");return{returnValue:z,fn:u}}Gad(n,u){let z,w,F;const G=this.wtj()&&this.Xra(119);let H=({dr:F}=this.PQd(G)).returnValue,L=({R5a:z,
Ypa:w}=H.Gad(n,u)).returnValue;l.a.instance.Ta(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",G,F);G&&!L&&H.P7f&&({dr:F,returnValue:H}=this.PQd(!1),{R5a:z,Ypa:w,returnValue:L}=H.Gad(n,u),l.a.instance.Ta(18994392,1,L?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",L,F));return{returnValue:L,R5a:z,Ypa:w}}}Object(E.a)(y,"ParagraphMergeSelector",null,[967])},1871:function(E,K,c){c.r(K);c.d(K,"SurfaceStringTokenStringGenerator",
function(){return f});E=c(0);var l=c(1590);class f extends l.a{constructor(a){super(a);this.Ab=a}apply(a,k,x,y,n,u,z){null==u&&(u=a.$hi(n,k));z=l.a.Xoh(a,u,this.Ab.score,x,y,z);return{w$c:u,tFc:z}}}f.uFc=0;Object(E.a)(f,"SurfaceStringTokenStringGenerator",l.a,[])},1872:function(E,K,c){c.r(K);c.d(K,"QueryTokenStringGenerator",function(){return a});E=c(0);var l=c(1590),f=c(1489);class a extends l.a{constructor(k){super(k);this.Ab=k}apply(k,x,y,n,u,z,w){x=this.Ab.query.load(x,null);u=0;let F=null;this.Ab.query.Z4===
f.Annotations.$ya?x&&(F=this.Ab.name):((F=this.Ab.name)&&(F+="_"),F+=this.Ab.annotations.Gda(this.Ab.query.Z4,x));null!=F&&(u=l.a.Xoh(k,F,this.Ab.score,y,n,u));return{w$c:z,tFc:w+u}}}a.uFc=1;Object(E.a)(a,"QueryTokenStringGenerator",l.a,[])},1873:function(E,K,c){c.r(K);c.d(K,"FuzzyMatchTokenStringGenerator",function(){return f});E=c(0);var l=c(1590);class f extends l.a{constructor(a){super(a);this.Ab=a}apply(a,k,x,y,n,u,z){null==u&&(u=a.$hi(n,k));a=this.Ab.NWh.N7m(u);if(this.Ab.eYi)for(var w of a)if(!w.uO&&
w.hMd)return{w$c:u,tFc:z};w=0;for(const F of a)if(F.uO&&!({U4e:w}=this.Zth(F,!0,x,y,w)).returnValue)return{w$c:u,tFc:z};if(this.Ab.opi)for(const F of a)if(!({U4e:w}=this.Zth(F,!1,x,y,w)).returnValue)break;return{w$c:u,tFc:z}}Zth(a,k,x,y,n){let u;k?(k=0,u=a.hMd?1:0):(k=a.hMd?1:0,u=a.count-k);for(let z=0;z<u;++z)if(l.a.Yoh(a.Ggb+k+z,this.Ab.score,x,y),++n,0<this.Ab.mMf&&n>=this.Ab.mMf)return{returnValue:!1,U4e:n};return{returnValue:!0,U4e:n}}}f.uFc=2;Object(E.a)(f,"FuzzyMatchTokenStringGenerator",l.a,
[])},1952:function(E,K,c){E=c(0);var l=c(6),f=c(42),a=c(243),k=c(1488);class x extends k.a{constructor(){super()}get Mn(){return 2}get kA(){return 7}static kh(){return new x}static get instance(){return x.Lg.value}}x.Lg=new a.a(x.kh);Object(E.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(15),n=c(800),u=c(168),z=c(1532);class w extends k.a{constructor(){super()}get Mn(){return 3}get kA(){return 7}uk(){const Va=super.uk();Va.Z(n.a.yb(y.a.jR),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(y.a.jR)){const mc=
Va.Uk;var jb=Va.Zd;u.a.instance.Ta(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.Qc,Wa);Wa=jb.getPropertyMilliseconds(Va.Ng.value.yf,y.a.jR);jb=jb.getPropertyMilliseconds(Va.vn.value.yf,y.a.jR);Wa<jb&&this.xQl(Va);Va.sg.add(n.a.yb(y.a.jR));return!0}u.a.instance.Ta(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}xQl(Va){this.u2n(Va.vn.value.yf,
Va.Uk);this.nof(Va,l.a.G0e);this.nof(Va,l.a.ash);this.nof(Va,l.a.Qrh)}nof(Va,Wa){var jb=Va.Zd,mc=Va.Uk;if(jb.hasProperty(mc,Wa)&&(Wa=jb.getPropertyObjectIds(mc,Wa))&&Wa.length)for(jb=Va.iq.runtime.Iq,Va=Va.iq.runtime.fn,mc=0;mc<Wa.length;mc++){const yb=Wa.J(mc);if(!jb.nb(yb))continue;const Oa=jb.J(yb).IK();Va.add(yb,new z.a(Oa,!1))}}static kh(){return new w}static get instance(){return w.Lg.value}}w.Lg=new a.a(w.kh);Object(E.a)(w,"AppNodeComplexMerge",k.a,[]);class F extends k.a{constructor(){super()}get Mn(){return 4}get kA(){return 7}static kh(){return new F}static get instance(){return F.Lg.value}}
F.Lg=new a.a(F.kh);Object(E.a)(F,"AppPropNodeComplexMerge",k.a,[]);class G extends k.a{constructor(){super()}get Mn(){return 5}get kA(){return 7}static kh(){return new G}static get instance(){return G.Lg.value}}G.Lg=new a.a(G.kh);Object(E.a)(G,"AppRefNodeComplexMerge",k.a,[]);var H=c(365),L=c(602),I=c(223),N=c(19);class P{constructor(Va,Wa){this.id=Va;this.BAo=Wa}}Object(E.a)(P,"IdAndTime",null,[]);class M extends k.a{constructor(){super()}get Mn(){return 6}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.gZa),
1);return Va}aC(Va,Wa){if(Wa===n.a.yb(l.a.gZa)){const jb=Va.Uk,mc=Va.Zd;u.a.instance.Ta(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",jb.id,jb.Qc,Wa);Wa=mc.getPropertyObjectIds(Va.Ng.value.Ku,l.a.gZa);const yb=mc.getPropertyObjectIds(Va.Ng.value.yf,l.a.gZa),Oa=mc.getPropertyObjectIds(Va.vn.value.yf,l.a.gZa);Wa=this.ibn(Va,Wa,yb,Oa);0<Wa.length?mc.setPropertyObjectIds(jb,l.a.gZa,Wa):jb.removeProperty(l.a.gZa);Va.sg.add(n.a.yb(l.a.gZa));
return!0}u.a.instance.Ta(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}ibn(Va,Wa,jb,mc){const yb=this.XFa(Wa,jb,mc),Oa=Wa.TG(),Gb=jb.TG(),Wb=mc.TG();Wa=k.a.filter(yb,Qc=>!Oa.contains(Qc)&&Gb.contains(Qc));jb=k.a.filter(yb,Qc=>!Oa.contains(Qc)&&Wb.contains(Qc));if(!Wa.length||!jb.length)return yb;const kc=new H.a;Wa.forEach(Qc=>{const Ic=new P(Qc,this.O3h(Va,Qc,!1));this.K3h(Va,Qc,!1).forEach(Ed=>
{kc.add(Ed,Ic);return!0});return!0});const Mb=new L.a;jb.forEach(Qc=>{const Ic=this.O3h(Va,Qc,!0);this.K3h(Va,Qc,!0).forEach(Ed=>kc.nb(Ed)?(Mb.add(kc.J(Ed).BAo>=Ic?Qc:kc.J(Ed).id),!1):!0);return!0});return k.a.filter(yb,Qc=>!Mb.contains(Qc))}O3h(Va,Wa,jb){return(Wa=this.Gna(Va,Wa,jb))?Va.Zd.getPropertyMilliseconds(Wa,y.a.jR):0}Gna(Va,Wa,jb){Va=jb?Va.iq.runtime.Iq:Va.iq.runtime.zu;return Va.nb(Wa)?Va.J(Wa):null}K3h(Va,Wa,jb){const mc=new I.a,yb=new L.a,Oa=Va.Zd;Wa=this.Gna(Va,Wa,jb);var Gb=this.wei(Oa,
Wa);if(Gb)for(mc.add(Gb),yb.add(Gb),Wa=Oa.getPropertyObjectIds(Wa,l.a.G0e),Gb=0;Wa&&Gb<Wa.length;Gb++){const Wb=this.wei(Oa,this.Gna(Va,Wa.J(Gb),jb));if(!Wb)break;yb.contains(Wb)||(mc.add(Wb),yb.add(Wb))}return mc}wei(Va,Wa){if(!Va.hasProperty(Wa,l.a.Adb)||!Va.hasProperty(Wa,l.a.R0b)||!Va.hasProperty(Wa,l.a.S0b))return null;const jb=Va.getPropertyString(Wa,l.a.Adb),mc=Va.getPropertyString(Wa,l.a.R0b);Va=Va.getPropertyString(Wa,l.a.S0b);return N.a.VA(jb+";"+mc+";"+Va)}static kh(){return new M}static get instance(){return M.Lg.value}}
M.Lg=new a.a(M.kh);Object(E.a)(M,"AppsNodeComplexMerge",k.a,[]);class J extends k.a{constructor(){super()}get Mn(){return 36}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.Ylg),1);Va.Z(n.a.yb(l.a.cbg),1);return Va}aC(Va,Wa){u.a.instance.Ta(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Wa);if(Wa===n.a.yb(l.a.Ylg)||Wa===n.a.yb(l.a.cbg)){const Oa=n.a.wX(Wa);var jb=Va.Ng.value.yf,mc=Va.vn.value.yf;const Gb=Va.Uk;var yb=Va.Zd.getPropertyStrings(Va.Ng.value.Ku,Oa);jb=Va.Zd.getPropertyStrings(jb,
Oa);mc=Va.Zd.getPropertyStrings(mc,Oa);yb=this.XFa(yb,jb,mc);Va.Zd.setPropertyStrings(Gb,Oa,yb);Va.sg.add(Wa);return!0}return!1}static kh(){return new J}static get instance(){return J.Lg.value}}J.Lg=new a.a(J.kh);Object(E.a)(J,"AutoSaveParametersNodeComplexMerge",k.a,[]);class V extends k.a{constructor(){super()}get Mn(){return 44}uk(){const Va=super.uk();Va.Z(n.a.yb(y.a.ef),1);return Va}aC(Va,Wa){const jb=Va.iq.runtime.Xb;if(Wa===n.a.yb(y.a.ef))return u.a.instance.Ta(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Va.Uk.id,Va.Uk.Qc,Wa),jb.uz(123),jb.isFeatureEnabled(123)?this.lbn(Va,Wa):this.Ibn(Va,Wa),!0;u.a.instance.Ta(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}lbn(Va,Wa){const jb=n.a.wX(Wa),mc=Va.Zd;var yb=mc.getPropertyObjectIds(Va.Ng.value.Ku,jb),Oa=mc.getPropertyObjectIds(Va.Ng.value.yf,jb),Gb=mc.getPropertyObjectIds(Va.vn.value.yf,jb);Gb=V.Lgm(Va,Oa,Gb);yb=this.XFa(yb,Oa,
Gb);Oa=Va.Uk;0<yb.length?mc.setPropertyObjectIds(Oa,jb,yb):Oa.removeProperty(jb);Va.sg.add(Wa)}static kh(){return new V}static get instance(){return V.Lg.value}static Lgm(Va,Wa,jb){const mc=new I.a,yb=new H.a;Wa.forEach(Oa=>{const Gb=Va.iq.runtime.zu.J(Oa);Gb&&yb.add(Gb.EX(l.a.rt).toString(),Oa);return!0});jb.forEach(Oa=>{var Gb=Va.iq.runtime.Iq.J(Oa);Gb?(Gb=Gb.EX(l.a.rt).toString(),yb.nb(Gb)&&yb.get(Gb)!==Oa?u.a.instance.Ta(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
mc.add(Oa)):mc.add(Oa);return!0});return mc}}V.Lg=new a.a(V.kh);Object(E.a)(V,"BookmarkContainerNodeComplexMerge",k.a,[]);class X extends k.a{constructor(){super()}get Mn(){return 41}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.Ozb),1);Va.Z(n.a.yb(l.a.rt),1);return Va}aC(Va,Wa){return Wa===n.a.yb(l.a.Ozb)?(Va.sg.add(n.a.yb(l.a.Ozb)),!0):Wa===n.a.yb(l.a.rt)?(Va.sg.add(n.a.yb(l.a.rt)),!0):!1}jf(Va){return Va&&Va.length?!1:!0}static kh(){return new X}static get instance(){return X.Lg.value}}X.Lg=new a.a(X.kh);
Object(E.a)(X,"BookmarkNodeComplexMerge",k.a,[]);class W extends k.a{constructor(){super();this.JXd=!1}get Mn(){return 7}uk(){const Va=super.uk();Va.Z(n.a.yb(y.a.ef),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(y.a.ef)){const yb=Va.Uk,Oa=Va.Zd;var jb=Va.iq.runtime.Xb;jb&&(this.JXd=jb.isFeatureEnabled(74));u.a.instance.Ta(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",yb.id,yb.Qc,Wa);Wa=Oa.getPropertyObjectIds(Va.Ng.value.Ku,y.a.ef);
jb=Oa.getPropertyObjectIds(Va.Ng.value.yf,y.a.ef);var mc=Oa.getPropertyObjectIds(Va.vn.value.yf,y.a.ef);Wa=this.vbn(Wa,jb,mc);if(this.JXd&&0<Wa.length){jb=new Sys.StringBuilder;for(mc=0;mc<Wa.length;mc++)jb.append(Wa.J(mc).toString()+",");u.a.instance.Ta(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",yb.id,jb.toString())}0<Wa.length?Oa.setPropertyObjectIds(yb,y.a.ef,Wa):yb.removeProperty(y.a.ef);Va.sg.add(n.a.yb(y.a.ef));return!0}u.a.instance.Ta(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Va.Ng.value.yf.id,Wa);return!1}vbn(Va,Wa,jb){const mc=new I.a,yb=new H.a(0);this.EAl(Va,jb,mc,yb);return this.xll(Wa,yb,mc)}EAl(Va,Wa,jb,mc){Va=Va||new I.a;Wa=Wa||new I.a;Va.forEach(yb=>{mc.Z(yb,1);return!0});Wa.forEach(yb=>{mc.Dc(yb).returnValue?mc.Z(yb,2):(mc.Z(yb,0),jb.add(yb));return!0})}xll(Va,Wa,jb){Va=Va||new I.a;const mc=new I.a,yb=new I.a,Oa=new I.a;Va.forEach(Gb=>{let Wb=!0,kc;({value:kc}=Wa.Dc(Gb)).returnValue&&(0===kc?Wa.Z(Gb,2):1===kc&&(Wb=!1));Wb?mc.add(Gb):this.JXd&&yb.add(Gb);return!0});
jb.forEach(Gb=>{let Wb=!1,kc;({value:kc}=Wa.Dc(Gb)).returnValue?0===kc&&(Wb=!0,Wa.Z(Gb,2)):u.a.instance.Ta(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Gb);Wb?mc.add(Gb):this.JXd&&Oa.add(Gb);return!0});this.RJi(yb,"Favored");this.RJi(Oa,"Unfavored");return mc}RJi(Va,Wa){if(Va.length){var jb=new Sys.StringBuilder;for(let mc=0;mc<Va.length;mc++)jb.append(Va.J(mc).toString()+",");u.a.instance.Ta(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Wa,jb.toString())}}static kh(){return new W}static get instance(){return W.Lg.value}}W.Lg=new a.a(W.kh);Object(E.a)(W,"CommentContentNodeComplexMerge",k.a,[]);var U;(function(Va){Va[Va.addAuthorInfoOnPutChanges=0]="addAuthorInfoOnPutChanges";Va[Va.addUpdateHintsToGraph=1]="addUpdateHintsToGraph";Va[Va.addThemeColorValues=2]="addThemeColorValues";Va[Va.adjustStyles=3]="adjustStyles";Va[Va.agaveRangeEnhancement=4]="agaveRangeEnhancement";
Va[Va.allowIdenticalRevisionMergeWithoutBase=5]="allowIdenticalRevisionMergeWithoutBase";Va[Va.annotationIgnorePersistence=6]="annotationIgnorePersistence";Va[Va.basicRichTextInComments_deprecated=7]="basicRichTextInComments_deprecated";Va[Va.blobFormatting=8]="blobFormatting";Va[Va.bookmarksFloatie=9]="bookmarksFloatie";Va[Va.catchUpActivity=10]="catchUpActivity";Va[Va.chartsPasteFromXLO=11]="chartsPasteFromXLO";Va[Va.clientSideImageTransform=12]="clientSideImageTransform";Va[Va.clientSideNumbering=
13]="clientSideNumbering";Va[Va.commentReactionMergeImprovement=14]="commentReactionMergeImprovement";Va[Va.commentBackReferenceRemoval=15]="commentBackReferenceRemoval";Va[Va.contentApp=16]="contentApp";Va[Va.contentControlAdjustUnsupportedBlockContentControl=17]="contentControlAdjustUnsupportedBlockContentControl";Va[Va.contentControlAroundTableFix=18]="contentControlAroundTableFix";Va[Va.contentControlContainerNodeMerge=19]="contentControlContainerNodeMerge";Va[Va.contentControlCustomizedPlaceholder=
20]="contentControlCustomizedPlaceholder";Va[Va.contentControlDataModelEnhancement=21]="contentControlDataModelEnhancement";Va[Va.contentControlEditing=22]="contentControlEditing";Va[Va.contentControlPlainTextAdding=23]="contentControlPlainTextAdding";Va[Va.contentControlPlainTextMultilineSupport=24]="contentControlPlainTextMultilineSupport";Va[Va.contentControlRead=25]="contentControlRead";Va[Va.contentControlRendering=26]="contentControlRendering";Va[Va.contentControlSetPlaceholderText=27]="contentControlSetPlaceholderText";
Va[Va.contentControlTextVanish=28]="contentControlTextVanish";Va[Va.contentControlTrackedChangesFix=29]="contentControlTrackedChangesFix";Va[Va.contentControlTrackedFormattingFix=30]="contentControlTrackedFormattingFix";Va[Va.contentControlTuningUnsupportedCases=31]="contentControlTuningUnsupportedCases";Va[Va.contentControlWrite=32]="contentControlWrite";Va[Va.createNewStyleUI=33]="createNewStyleUI";Va[Va.customFontReadModePDF=34]="customFontReadModePDF";Va[Va.deleteFontStyles=35]="deleteFontStyles";
Va[Va.deleteStyleInternalAPI=36]="deleteStyleInternalAPI";Va[Va.docReplays=37]="docReplays";Va[Va.docPartObjectSdtSupport=38]="docPartObjectSdtSupport";Va[Va.doNotDeleteLastOG=39]="doNotDeleteLastOG";Va[Va.docxMergeUsingUpdateHints=40]="docxMergeUsingUpdateHints";Va[Va.embeddedFonts=41]="embeddedFonts";Va[Va.endOfParagraphFormatting=42]="endOfParagraphFormatting";Va[Va.fixContentControlAdvanceIndex_Deprecated=43]="fixContentControlAdvanceIndex_Deprecated";Va[Va.fontSlotsImprovement=44]="fontSlotsImprovement";
Va[Va.forceLokiFallbackToACLPToken=45]="forceLokiFallbackToACLPToken";Va[Va.gc2InCanvasCore=46]="gc2InCanvasCore";Va[Va.gc2InCanvasPictures=47]="gc2InCanvasPictures";Va[Va.gc2InCanvasShapes=48]="gc2InCanvasShapes";Va[Va.graphicsEditor=49]="graphicsEditor";Va[Va.graphicsServiceDarkTraffic=50]="graphicsServiceDarkTraffic";Va[Va.graphMergeReplaysPrompt=51]="graphMergeReplaysPrompt";Va[Va.graphStoredFeatures=52]="graphStoredFeatures";Va[Va.hyperlinkColorBugFix=53]="hyperlinkColorBugFix";Va[Va.isProgressiveStyleEnabled=
54]="isProgressiveStyleEnabled";Va[Va.ignoreFormattingConflictsOnParagraphMerge=55]="ignoreFormattingConflictsOnParagraphMerge";Va[Va.imageOverflow=56]="imageOverflow";Va[Va.imageRotate=57]="imageRotate";Va[Va.includeCommentsInMergeIgnoreFmtEnabled=58]="includeCommentsInMergeIgnoreFmtEnabled";Va[Va.increaseMaxWebFriendlyDimensionTo1600=59]="increaseMaxWebFriendlyDimensionTo1600";Va[Va.initializeTrackedRunState=60]="initializeTrackedRunState";Va[Va.intelligenceV2Schema=61]="intelligenceV2Schema";Va[Va.intentSuggestion_Deprecated=
62]="intentSuggestion_Deprecated";Va[Va.keepTogether=63]="keepTogether";Va[Va.labelingPolicies=64]="labelingPolicies";Va[Va.latentStylesSupportOnClient=65]="latentStylesSupportOnClient";Va[Va.lcsMergeReducedOps=66]="lcsMergeReducedOps";Va[Va.listDefinitionPropertyMergeFailure=67]="listDefinitionPropertyMergeFailure";Va[Va.listDocumentMetricsTelemetry=68]="listDocumentMetricsTelemetry";Va[Va.listIdAndListLevelOnParaNode=69]="listIdAndListLevelOnParaNode";Va[Va.listMergeTableCells=70]="listMergeTableCells";
Va[Va.listNumberingFix=71]="listNumberingFix";Va[Va.lockNotFullySupportedParagraphInBlockContentControl=72]="lockNotFullySupportedParagraphInBlockContentControl";Va[Va.logAddedAndDeletedReferences=73]="logAddedAndDeletedReferences";Va[Va.logRemovedCommentObjectIds=74]="logRemovedCommentObjectIds";Va[Va.mergeLogUnmatchedMarkers=75]="mergeLogUnmatchedMarkers";Va[Va.mergeMissingEopFix=76]="mergeMissingEopFix";Va[Va.mergePropertyValidationEnabled=77]="mergePropertyValidationEnabled";Va[Va.mergeStrategyForUpdateFieldAutoSaveParameters=
78]="mergeStrategyForUpdateFieldAutoSaveParameters";Va[Va.mergeStyleToggleProperties=79]="mergeStyleToggleProperties";Va[Va.mergeUsingUpdateHints=80]="mergeUsingUpdateHints";Va[Va.modifyStylesInternalApi=81]="modifyStylesInternalApi";Va[Va.nestedFieldsAdjustFix=82]="nestedFieldsAdjustFix";Va[Va.newStyleModel=83]="newStyleModel";Va[Va.numberedBulletFormatting=84]="numberedBulletFormatting";Va[Va.objectDataBlobIdMappedByHash=85]="objectDataBlobIdMappedByHash";Va[Va.outlineElementBasedCommentNavigation=
86]="outlineElementBasedCommentNavigation";Va[Va.pageBackgroundColor=87]="pageBackgroundColor";Va[Va.persistedAnnotationCoauthFix=88]="persistedAnnotationCoauthFix";Va[Va.pictureBorders=89]="pictureBorders";Va[Va.preserveEopFormattingReader=90]="preserveEopFormattingReader";Va[Va.qoESingleLevelListSupport=91]="qoESingleLevelListSupport";Va[Va.readListInfoFromParaNodeInsteadOfListNode=92]="readListInfoFromParaNodeInsteadOfListNode";Va[Va.readOnlyRecommended=93]="readOnlyRecommended";Va[Va.removalOfListNode=
94]="removalOfListNode";Va[Va.removeEditedImageUrlFromIgnoredProperties=95]="removeEditedImageUrlFromIgnoredProperties";Va[Va.removePersonalInformation=96]="removePersonalInformation";Va[Va.replaceFollowUpsWithComments=97]="replaceFollowUpsWithComments";Va[Va.resendCurrentRevision=98]="resendCurrentRevision";Va[Va.saveProofingInfo=99]="saveProofingInfo";Va[Va.setStyleOnParagraphNodeDesignerProof=100]="setStyleOnParagraphNodeDesignerProof";Va[Va.shapeEditingInlineCanvas=101]="shapeEditingInlineCanvas";
Va[Va.stylesFlatteningOnClient=102]="stylesFlatteningOnClient";Va[Va.syntheticListNode=103]="syntheticListNode";Va[Va.tableCellMergeWithoutOENode=104]="tableCellMergeWithoutOENode";Va[Va.tableMergeReliabilityImprovement=105]="tableMergeReliabilityImprovement";Va[Va.tableNodeNormalization=106]="tableNodeNormalization";Va[Va.tableOfContentCreateAndDelete_Deprecated=107]="tableOfContentCreateAndDelete_Deprecated";Va[Va.tableOfContentRender=108]="tableOfContentRender";Va[Va.tableOfContentUpdate=109]=
"tableOfContentUpdate";Va[Va.tableRowFormatTrackChanges_Deprecated=110]="tableRowFormatTrackChanges_Deprecated";Va[Va.tableStyle=111]="tableStyle";Va[Va.tableStyleMargin=112]="tableStyleMargin";Va[Va.tableStyleCellSpacing=113]="tableStyleCellSpacing";Va[Va.tableStyleCellVerticalAlignment=114]="tableStyleCellVerticalAlignment";Va[Va.tasks=115]="tasks";Va[Va.touchImprovement=116]="touchImprovement";Va[Va.trackChangeSettingNotificationInCurrentLocale_Deprecated=117]="trackChangeSettingNotificationInCurrentLocale_Deprecated";
Va[Va.undoMergeUsingUpdateHints=118]="undoMergeUsingUpdateHints";Va[Va.updateCpUsingUpdateHints=119]="updateCpUsingUpdateHints";Va[Va.updateTOCInWeb=120]="updateTOCInWeb";Va[Va.useImagePropertySet=121]="useImagePropertySet";Va[Va.useNSIDInLists=122]="useNSIDInLists";Va[Va.userBookmarks=123]="userBookmarks";Va[Va.userBookmarksHighlight=124]="userBookmarksHighlight";Va[Va.wordBookmarks=125]="wordBookmarks";Va[Va.wordTestFeature=126]="wordTestFeature"})(U||(U={}));Object(E.b)("WordEditorFeature",U);
class Y extends k.a{constructor(){super()}get Mn(){return 8}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.Waa),3);Va.Z(n.a.yb(l.a.XE),3);Va.Z(n.a.yb(l.a.RGc),2);Va.Z(n.a.yb(l.a.commentId),2);Va.Z(n.a.yb(l.a.XFh),2);Va.Z(n.a.yb(l.a.SCa),2);Va.Z(n.a.yb(l.a.uNa),1);Va.Z(n.a.yb(l.a.pib),1);Va.Z(n.a.yb(l.a.pjb),1);Va.Z(n.a.yb(l.a.F7),1);Va.Z(n.a.yb(l.a.DG),1);Va.Z(n.a.yb(l.a.QGc),2);Va.Z(n.a.yb(l.a.qEd),2);Va.Z(n.a.yb(l.a.N2b),2);Va.Z(n.a.yb(l.a.r8e),2);Va.Z(n.a.yb(l.a.iM),1);Va.Z(n.a.yb(y.a.ef),0);Va.Z(n.a.yb(l.a.zH),
0);return Va}aC(Va,Wa){if(Wa===n.a.yb(l.a.iM)){var jb=Va.Zd.getPropertyString(Va.vn.value.yf,l.a.iM);this.jf(jb)?Va.Uk.removeProperty(l.a.iM):Va.Uk.YSa(l.a.iM,jb);return!0}if(Wa!==n.a.yb(l.a.uNa)&&Wa!==n.a.yb(l.a.pib)&&Wa!==n.a.yb(l.a.pjb)&&Wa!==n.a.yb(l.a.DG)&&Wa!==n.a.yb(l.a.F7))return!1;var mc=Va.Ng.value.yf,yb=Va.vn.value.yf;jb=Va.Uk;if(Wa===n.a.yb(l.a.uNa)){mc=Va.Zd.getPropertyString(mc,l.a.uNa);yb=Va.Zd.getPropertyString(yb,l.a.uNa);yb=this.jf(mc)?yb:this.jf(yb)?mc:null;if(this.jf(yb))return!0;
Va.Zd.setPropertyString(jb,l.a.uNa,yb);Va.sg.add(n.a.yb(l.a.uNa));return!0}if(Wa===n.a.yb(l.a.pjb))return mc=Va.Zd.getPropertyBool(mc,l.a.pjb),yb=Va.Zd.getPropertyBool(yb,l.a.pjb),mc=null!=mc?mc:!1,mc=(null!=yb?yb:!1)||mc,Va.Zd.setPropertyBool(jb,l.a.pjb,mc),Va.sg.add(n.a.yb(l.a.pjb)),!0;if(Wa===n.a.yb(l.a.pib)){mc=Va.Zd.getPropertyBool(mc,l.a.pib);yb=Va.Zd.getPropertyBool(yb,l.a.pib);if(mc===yb)return!0;mc=null!=mc?mc:!1;mc=(null!=yb?yb:!1)||mc;Va.Zd.setPropertyBool(jb,l.a.pib,mc);return!0}if(Wa===
n.a.yb(l.a.DG)){mc=Va.Zd.getPropertyBool(mc,l.a.DG);yb=Va.Zd.getPropertyBool(yb,l.a.DG);if(mc===yb)return!0;mc=null!=mc?mc:!1;mc=(null!=yb?yb:!1)||mc;Va.Zd.setPropertyBool(jb,l.a.DG,mc);Va.sg.add(n.a.yb(l.a.DG));return!0}if(Wa===n.a.yb(l.a.F7)){Wa=Va.iq.runtime.Xb;Wa.uz(U.n1k);if(!Wa.isFeatureEnabled(U.n1k))return!1;mc=Va.Zd.getPropertyString(mc,l.a.F7);yb=Va.Zd.getPropertyString(yb,l.a.F7);if(mc===yb)return!0;Va.Zd.setPropertyString(jb,l.a.F7,yb||mc);Va.sg.add(n.a.yb(l.a.F7));return!0}return!1}jf(Va){return Va&&
Va.length?!1:!0}static kh(){return new Y}static get instance(){return Y.Lg.value}}Y.Lg=new a.a(Y.kh);Object(E.a)(Y,"CommentNodeComplexMerge",k.a,[]);class ca extends k.a{constructor(){super()}get Mn(){return 46}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.contentControlNode),1);Va.Z(n.a.yb(y.a.lastModifiedTime),0);Va.Z(n.a.yb(l.a.rHc),2);return Va}aC(Va,Wa){if(Wa===n.a.yb(l.a.contentControlNode))return u.a.instance.Ta(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Va.Uk.id,Va.Uk.Qc,Wa),k.a.GMf(Va,this,l.a.contentControlNode);u.a.instance.Ta(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}static kh(){return new ca}static get instance(){return ca.Lg.value}}ca.Lg=new a.a(ca.kh);Object(E.a)(ca,"ContentControlContainerNodeComplexMerge",k.a,[]);var aa=c(58),fa=c(1762);class pa extends k.a{constructor(){super()}get Mn(){return 37}uk(){const Va=
super.uk();Va.Z(n.a.yb(l.a.I7),1);Va.Z(n.a.yb(l.a.Ppb),1);Va.Z(n.a.yb(l.a.qFd),2);Va.Z(n.a.yb(l.a.h3b),2);Va.Z(n.a.yb(l.a.contentControlNode),1);Va.Z(n.a.yb(l.a.F8),1);Va.Z(n.a.yb(l.a.Lfa),1);Va.Z(n.a.yb(l.a.k3b),1);Va.Z(n.a.yb(l.a.Reb),1);Va.Z(n.a.yb(l.a.Peb),1);Va.Z(n.a.yb(l.a.Oeb),1);Va.Z(n.a.yb(l.a.c_a),2);Va.Z(n.a.yb(l.a.UAb),1);Va.Z(n.a.yb(l.a.rFd),1);Va.Z(n.a.yb(l.a.H7),1);this.Xb.isFeatureEnabled(29)&&(Va.Z(n.a.yb(l.a.rU),2),Va.Z(n.a.yb(l.a.Qua),2),Va.Z(n.a.yb(l.a.Lma),2),Va.Z(n.a.yb(l.a.h4),
1),Va.Z(n.a.yb(l.a.loa),1),Va.Z(n.a.yb(l.a.moa),1));return Va}aC(Va,Wa){var jb=Va.Ng.value.yf,mc=Va.vn.value.yf;const yb=Va.Uk;if(Wa===n.a.yb(l.a.contentControlNode))return k.a.GMf(Va,this,l.a.contentControlNode);if(Wa===n.a.yb(l.a.F8)){Wa=Va.Zd.getPropertyBool(jb,l.a.F8);mc=Va.Zd.getPropertyBool(mc,l.a.F8);if(null!=Wa&&Wa||null!=mc&&mc)Va.Zd.setPropertyBool(yb,l.a.F8,!0),Va.sg.add(n.a.yb(l.a.F8));return!0}if(Wa===n.a.yb(l.a.Lfa))return Wa=Va.Zd.getPropertyBool(jb,l.a.Lfa),mc=Va.Zd.getPropertyBool(mc,
l.a.Lfa),Va.Zd.setPropertyBool(yb,l.a.Lfa,null!=Wa&&!!Wa&&null!=mc&&!!mc),Va.sg.add(n.a.yb(l.a.Lfa)),!0;if(Wa===n.a.yb(l.a.k3b))return Wa=Va.Zd.getPropertyUint32(mc,l.a.k3b),null!=Wa&&(Va.Zd.setPropertyUint32(yb,l.a.k3b,Wa),Va.sg.add(n.a.yb(l.a.k3b))),!0;if(Wa===n.a.yb(l.a.Reb)||Wa===n.a.yb(l.a.Peb)||Wa===n.a.yb(l.a.Oeb))return(mc=Va.Zd.getPropertyString(mc,n.a.wX(Wa)))&&0<mc.length&&(Va.Zd.setPropertyString(yb,n.a.wX(Wa),mc),Va.sg.add(Wa)),!0;if(Wa===n.a.yb(l.a.UAb)||Wa===n.a.yb(l.a.rFd)){jb=Va.Zd.getPropertyObjectId(jb,
n.a.wX(Wa));if(fa.a.x7b(Va.iq,jb))return!0;if((mc=Va.Zd.getPropertyObjectId(mc,n.a.wX(Wa)))&&mc!==aa.a.nil)return Va.Zd.setPropertyObjectId(yb,n.a.wX(Wa),mc),Va.sg.add(Wa),!0;yb.removeProperty(n.a.wX(Wa));Va.sg.add(Wa);return!0}if(Wa===n.a.yb(l.a.H7)){jb=Va.Zd.getPropertyObjectId(jb,l.a.H7);if((jb=fa.a.x7b(Va.iq,jb))&&Va.Zd.getPropertyObjectIds(jb,l.a.contentControlNode).TG().contains(Va.Uk.id))return!0;mc=Va.Zd.getPropertyObjectId(mc,l.a.H7);return(jb=fa.a.x7b(Va.iq,mc))&&Va.Zd.getPropertyObjectIds(jb,
l.a.contentControlNode).TG().contains(Va.Uk.id)?(Va.Zd.setPropertyObjectId(yb,l.a.H7,mc),Va.sg.add(Wa),!0):!1}if(Wa===n.a.yb(l.a.I7))return Wa=Va.Zd.getPropertyBool(mc,l.a.I7),null==Wa||Wa||(Va.Zd.setPropertyBool(yb,l.a.I7,!1),Va.sg.add(n.a.yb(l.a.I7))),!0;if(Wa===n.a.yb(l.a.Ppb)){Wa=Va.Zd.getPropertyObjectId(jb,l.a.Ppb);mc=Va.Zd.getPropertyObjectId(mc,l.a.Ppb);if(Wa&&!Wa.equals(mc))return!1;if(Wa=Wa||mc)Va.Zd.setPropertyObjectId(yb,l.a.Ppb,Wa),Va.sg.add(n.a.yb(l.a.Ppb));return!0}!this.Xb.isFeatureEnabled(29)||
Wa!==n.a.yb(l.a.h4)&&Wa!==n.a.yb(l.a.loa)&&Wa!==n.a.yb(l.a.moa)||u.a.instance.Ta(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Wa);return!1}static kh(){return new pa}static get instance(){return pa.Lg.value}}pa.Lg=new a.a(pa.kh);Object(E.a)(pa,"ContentControlNodeComplexMerge",k.a,[]);class ra extends k.a{constructor(){super()}get Mn(){return 10}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.customXmlPartNode),1);return Va}aC(Va,
Wa){if(Wa===n.a.yb(l.a.customXmlPartNode)){Wa=Va.Uk;const mc=Va.Zd;var jb=mc.getPropertyObjectIds(Va.Ng.value.Ku,l.a.customXmlPartNode);const yb=mc.getPropertyObjectIds(Va.Ng.value.yf,l.a.customXmlPartNode),Oa=mc.getPropertyObjectIds(Va.vn.value.yf,l.a.customXmlPartNode);jb=this.Abn(jb,yb,Oa);0<jb.length?mc.setPropertyObjectIds(Wa,l.a.customXmlPartNode,jb):Wa.removeProperty(l.a.customXmlPartNode);Va.sg.add(n.a.yb(l.a.customXmlPartNode));return!0}return!1}Abn(Va,Wa,jb){return this.XFa(Va,Wa,jb)}static kh(){return new ra}static get instance(){return ra.Lg.value}}
ra.Lg=new a.a(ra.kh);Object(E.a)(ra,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class la extends k.a{constructor(){super()}get Mn(){return 9}get kA(){return 0}static kh(){return new la}static get instance(){return la.Lg.value}}la.Lg=new a.a(la.kh);Object(E.a)(la,"CustomXmlPartNodeComplexMerge",k.a,[]);class qa extends k.a{constructor(){super()}get Mn(){return 29}get kA(){return 3}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.embeddedFontNode),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(l.a.embeddedFontNode)){Wa=
Va.Zd;var jb=Wa.getPropertyObjectIds(Va.Ng.value.Ku,l.a.embeddedFontNode),mc=Wa.getPropertyObjectIds(Va.Ng.value.yf,l.a.embeddedFontNode);const yb=Wa.getPropertyObjectIds(Va.vn.value.yf,l.a.embeddedFontNode);jb=this.XFa(jb,mc,yb);mc=Va.Uk;0<jb.length?Wa.setPropertyObjectIds(mc,l.a.embeddedFontNode,jb):mc.removeProperty(l.a.embeddedFontNode);Va.sg.add(n.a.yb(l.a.embeddedFontNode));return!0}return!1}static kh(){return new qa}static get instance(){return qa.Lg.value}}qa.Lg=new a.a(qa.kh);Object(E.a)(qa,
"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class La extends k.a{constructor(){super()}get Mn(){return 30}get kA(){return 3}static kh(){return new La}static get instance(){return La.Lg.value}}La.Lg=new a.a(La.kh);Object(E.a)(La,"EmbeddedFontNodeComplexMerge",k.a,[]);class Pa extends k.a{constructor(){super()}get Mn(){return 11}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.K3),4);Va.Z(n.a.yb(l.a.y0a),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(l.a.y0a)){const jb=Va.Uk,mc=Va.Zd;u.a.instance.Ta(4063307,1,4,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",jb.id,jb.Qc,Wa);Wa=mc.getPropertyObjectIds(Va.Ng.value.Ku,l.a.y0a);const yb=mc.getPropertyObjectIds(Va.Ng.value.yf,l.a.y0a),Oa=mc.getPropertyObjectIds(Va.vn.value.yf,l.a.y0a);Wa=this.zNi(Wa,yb,Oa,(Gb,Wb)=>Gb.equals(Wb));0<Wa.length?mc.setPropertyObjectIds(jb,l.a.y0a,Wa):jb.removeProperty(l.a.y0a);Va.sg.add(n.a.yb(l.a.y0a));return!0}u.a.instance.Ta(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Va.Ng.value.yf.id,Wa);return!1}static kh(){return new Pa}static get instance(){return Pa.Lg.value}}Pa.Lg=new a.a(Pa.kh);Object(E.a)(Pa,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class Ka extends k.a{constructor(){super()}get Mn(){return 12}get kA(){return 3}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.nna),1);return Va}aC(Va,Wa){const jb=Va.Uk,mc=Va.Zd;if(Wa===n.a.yb(l.a.nna)){let yb=-1;u.a.instance.Ta(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
jb.id,jb.Qc,Wa);const Oa=mc.getPropertyInt32(Va.Ng.value.yf,l.a.nna),Gb=mc.getPropertyInt32(Va.vn.value.yf,l.a.nna);null!=Oa&&-1!==Oa?yb=Oa:null!=Gb&&(yb=Gb);mc.setPropertyInt32(jb,l.a.nna,yb);Va.sg.add(Wa);return!0}u.a.instance.Ta(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.Ku.id,Wa);return!1}static kh(){return new Ka}static get instance(){u.a.instance.Ta(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return Ka.Lg.value}}Ka.Lg=new a.a(Ka.kh);Object(E.a)(Ka,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class Na extends k.a{constructor(){super()}get Mn(){return 47}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.glossaryPageContentNode),1);return Va}aC(Va,Wa){return Wa===n.a.yb(l.a.glossaryPageContentNode)?(u.a.instance.Ta(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Va.Uk.id,Va.Uk.Qc,Wa),k.a.GMf(Va,this,l.a.glossaryPageContentNode)):
!1}static kh(){return new Na}static get instance(){return Na.Lg.value}}Na.Lg=new a.a(Na.kh);Object(E.a)(Na,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class sa extends k.a{constructor(){super()}get Mn(){return 13}get kA(){return 3}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.Mia),4);return Va}static kh(){return new sa}static get instance(){return sa.Lg.value}}sa.Lg=new a.a(sa.kh);Object(E.a)(sa,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class wa extends k.a{constructor(){super()}get Mn(){return 14}get kA(){return 3}uk(){const Va=
super.uk();Va.Z(n.a.yb(l.a.runId),3);Va.Z(n.a.yb(l.a.Lc),3);Va.Z(n.a.yb(l.a.zti),3);Va.Z(n.a.yb(l.a.mU),1);Va.Z(n.a.yb(f.a.O_),1);Va.Z(n.a.yb(y.a.imageAltText),1);Va.Z(n.a.yb(l.a.UX),1);Va.Z(n.a.yb(y.a.Mca),1);Va.Z(n.a.yb(f.a.j8a),1);Va.Z(n.a.yb(l.a.dZa),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(y.a.imageAltText)||Wa===n.a.yb(l.a.UX)||Wa===n.a.yb(l.a.mU)||Wa===n.a.yb(l.a.VX)||Wa===n.a.yb(y.a.Bib)||Wa===n.a.yb(y.a.Mca)||Wa===n.a.yb(f.a.O_)||Wa===n.a.yb(f.a.j8a)||Wa===n.a.yb(l.a.dZa)){const mc=Va.Uk;var jb=
Va.Zd;u.a.instance.Ta(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.Qc,Wa);const yb=jb.getPropertyInt32(Va.Ng.value.yf,f.a.O_);jb=jb.getPropertyInt32(Va.vn.value.yf,f.a.O_);if(null!=yb&&(0===yb||2===yb))return!0;if(null!=jb&&(0===jb||2===jb))return Wa=Va.vn.value.yf,this.Xeb(Wa,mc,y.a.imageAltText),this.Xeb(Wa,mc,l.a.UX),this.Xeb(Wa,mc,l.a.VX),Wa.hasProperty(l.a.mU)&&this.Xeb(Wa,mc,l.a.mU),this.Xeb(Wa,mc,y.a.Bib),this.Xeb(Wa,
mc,y.a.Mca),this.Xeb(Wa,mc,f.a.O_),this.Xeb(Wa,mc,f.a.j8a),Va.sg.add(n.a.yb(y.a.imageAltText)),Va.sg.add(n.a.yb(l.a.UX)),Va.sg.add(n.a.yb(l.a.VX)),Va.sg.add(n.a.yb(l.a.mU)),Va.sg.add(n.a.yb(y.a.Bib)),Va.sg.add(n.a.yb(y.a.Mca)),Va.sg.add(n.a.yb(f.a.O_)),Va.sg.add(n.a.yb(f.a.j8a)),Va.sg.add(n.a.yb(l.a.dZa)),!0}u.a.instance.Ta(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.Ku.id,Wa);return!1}static kh(){return new wa}static get instance(){return wa.Lg.value}}
wa.Lg=new a.a(wa.kh);Object(E.a)(wa,"ImageNodeComplexMerge",k.a,[]);class ja extends k.a{constructor(){super()}get Mn(){return 40}get kA(){return 0}static kh(){return new ja}static get instance(){return ja.Lg.value}}ja.Lg=new a.a(ja.kh);Object(E.a)(ja,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class ha extends k.a{constructor(){super()}get Mn(){return 32}get kA(){return 0}static kh(){return new ha}static get instance(){return ha.Lg.value}}ha.Lg=new a.a(ha.kh);Object(E.a)(ha,"IntelligenceContentLocatorNodeComplexMerge",
k.a,[]);class va extends k.a{constructor(){super()}get Mn(){return 34}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.djb),1);return Va}aC(Va,Wa){const jb=Va.Uk,mc=Va.Zd;if(Wa===n.a.yb(l.a.djb)){Wa=mc.getPropertyObjectIds(Va.Ng.value.Ku,l.a.djb);const yb=mc.getPropertyObjectIds(Va.Ng.value.yf,l.a.djb),Oa=mc.getPropertyObjectIds(Va.vn.value.yf,l.a.djb);Wa=this.XFa(Wa,yb,Oa);mc.setPropertyObjectIds(jb,l.a.djb,Wa);Va.sg.add(n.a.yb(l.a.djb));return!0}return!1}static kh(){return new va}static get instance(){return va.Lg.value}}
va.Lg=new a.a(va.kh);Object(E.a)(va,"IntelligenceRegionNodeComplexMerge",k.a,[]);class xa extends k.a{constructor(){super()}get Mn(){return 35}get kA(){return 0}static kh(){return new xa}static get instance(){return xa.Lg.value}}xa.Lg=new a.a(xa.kh);Object(E.a)(xa,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class ma extends k.a{constructor(){super()}get Mn(){return 39}get kA(){return 0}static kh(){return new ma}static get instance(){return ma.Lg.value}}ma.Lg=new a.a(ma.kh);Object(E.a)(ma,"IntelligenceReviewedNodeComplexMerge",
k.a,[]);class Ja extends k.a{constructor(){super()}get Mn(){return 33}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.SSc),1);Va.Z(n.a.yb(l.a.GWd),1);Va.Z(n.a.yb(l.a.JAf),1);Va.Z(n.a.yb(l.a.LAf),1);return Va}aC(Va,Wa){const jb=Va.Uk,mc=Va.Zd;if(Wa===n.a.yb(l.a.SSc)||Wa===n.a.yb(l.a.GWd)||Wa===n.a.yb(l.a.JAf)||Wa===n.a.yb(l.a.LAf)){Wa=Wa===n.a.yb(l.a.SSc)?l.a.SSc:l.a.GWd;var yb=mc.getPropertyObjectIds(Va.Ng.value.Ku,Wa);const Oa=mc.getPropertyObjectIds(Va.Ng.value.yf,Wa),Gb=mc.getPropertyObjectIds(Va.vn.value.yf,
Wa);yb=this.XFa(yb,Oa,Gb);mc.setPropertyObjectIds(jb,Wa,yb);Va.sg.add(n.a.yb(Wa));return!0}return!1}static kh(){return new Ja}static get instance(){return Ja.Lg.value}}Ja.Lg=new a.a(Ja.kh);Object(E.a)(Ja,"IntelligenceRootNodeComplexMerge",k.a,[]);class oa extends k.a{constructor(){super()}get Mn(){return 42}get kA(){return 0}static kh(){return new oa}static get instance(){return oa.Lg.value}}oa.Lg=new a.a(oa.kh);Object(E.a)(oa,"IntelligenceSettingNodeComplexMerge",k.a,[]);class za extends k.a{constructor(){super()}get Mn(){return 45}get kA(){return 0}static kh(){return new za}static get instance(){return za.Lg.value}}
za.Lg=new a.a(za.kh);Object(E.a)(za,"IntelligenceWorkflowNodeComplexMerge",k.a,[]);class Fa extends k.a{constructor(){super()}get Mn(){return 15}get kA(){return 3}static kh(){return new Fa}static get instance(){return Fa.Lg.value}}Fa.Lg=new a.a(Fa.kh);Object(E.a)(Fa,"NumberListNodeComplexMerge",k.a,[]);var kb=c(116);class fb extends k.a{constructor(){super()}get Mn(){return 16}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.tzb),1);Va.Z(n.a.yb(kb.a.z8e),7);Va.Z(n.a.yb(kb.a.x8e),7);return Va}aC(Va,
Wa){const jb=Va.Uk,mc=Va.Zd;if(Wa===n.a.yb(l.a.tzb))return this.wHf(mc,Va.Ng.value.yf,Va.vn.value.yf,jb,l.a.tzb),Va.sg.add(Wa),!0;u.a.instance.Ta(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.Ku.id,Wa);return!1}static kh(){return new fb}static get instance(){return fb.Lg.value}}fb.Lg=new a.a(fb.kh);Object(E.a)(fb,"OutlineElementNodeComplexMerge",k.a,[]);class lb extends k.a{constructor(){super()}get Mn(){return 17}uk(){const Va=
super.uk();Va.Z(n.a.yb(l.a.tzb),1);Va.Z(n.a.yb(l.a.Tma),1);Va.Z(n.a.yb(kb.a.hJ),1);Va.Z(n.a.yb(kb.a.qcc),1);Va.Z(n.a.yb(kb.a.dia),8);return Va}aC(Va,Wa){const jb=Va.Uk,mc=Va.Zd;if(Wa===n.a.yb(l.a.tzb))return this.wHf(mc,Va.Ng.value.yf,Va.vn.value.yf,jb,l.a.tzb),Va.sg.add(Wa),!0;if(Wa===n.a.yb(l.a.Tma)){var yb=mc.getPropertyBool(Va.Ng.value.yf,l.a.Tma),Oa=mc.getPropertyBool(Va.vn.value.yf,l.a.Tma);mc.setPropertyBool(jb,l.a.Tma,null==yb?!1:yb&&null==Oa?!1:Oa);Va.sg.add(Wa);return!0}if(Wa===n.a.yb(kb.a.qcc))return this.wHf(mc,
Va.Ng.value.yf,Va.vn.value.yf,jb,kb.a.qcc),Va.sg.add(Wa),!0;if(Wa===n.a.yb(kb.a.hJ))return yb=mc.getPropertyBool(Va.Ng.value.yf,kb.a.hJ),Oa=mc.getPropertyBool(Va.vn.value.yf,kb.a.hJ),mc.setPropertyBool(jb,kb.a.hJ,null==yb?!0:yb||null==Oa?!0:Oa),Va.sg.add(Wa),!0;u.a.instance.Ta(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.Ku.id,Wa);return!1}static kh(){return new lb}static get instance(){return lb.Lg.value}}
lb.Lg=new a.a(lb.kh);Object(E.a)(lb,"OutlineGroupNodeComplexMerge",k.a,[]);var sb=c(41),ab=c(55);class Ga extends k.a{constructor(){super()}get Mn(){return 18}get kA(){return 2}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.DUd),3);Va.Z(n.a.yb(y.a.OU),this.kA);Va.Z(n.a.yb(l.a.fu),1);Va.Z(n.a.yb(l.a.n9),1);Va.Z(n.a.yb(l.a.Bq),1);Va.Z(n.a.yb(sb.a.yJ),1);Va.Z(n.a.yb(sb.a.u4a),1);return Va}aC(Va,Wa){const jb=Va.Zd;if(Va.iq.runtime.Xb.isFeatureEnabled(71)){if(Wa===n.a.yb(l.a.fu)||Wa===n.a.yb(l.a.n9)||Wa===n.a.yb(sb.a.u4a)||
Wa===n.a.yb(l.a.Bq)||Wa===n.a.yb(sb.a.yJ))return this.HOo(jb,Va)}else if(Wa===n.a.yb(l.a.fu)||Wa===n.a.yb(l.a.Bq)){let mc,yb;({gHc:Wa,N2a:mc,C2a:yb}=this.F6e(Object(ab.a)(jb,jb.getPropertyUint32s,"getPropertyUint32s"),Va.Ng.value.Ku,Va.Ng.value.yf,Va.vn.value.yf,l.a.fu,null));if(!yb&&!mc)return u.a.instance.Ta(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Va.Ng.value.yf.id,n.a.yb(l.a.fu)),!0;let Oa,Gb,Wb;({gHc:Oa,
N2a:Gb,C2a:Wb}=this.F6e(Object(ab.a)(jb,jb.getPropertyObjectIds,"getPropertyObjectIds"),Va.Ng.value.Ku,Va.Ng.value.yf,Va.vn.value.yf,l.a.Bq,null));if(!Gb&&!Wb)return u.a.instance.Ta(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Va.Ng.value.yf.id,n.a.yb(l.a.Bq)),!0;const kc=Gb&&!Wb;if((mc&&!yb)!==kc)return u.a.instance.Ta(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Va.Ng.value.yf.id,n.a.yb(l.a.fu),n.a.yb(l.a.Bq)),!1;kc&&(jb.setPropertyObjectIds(Va.Uk,l.a.Bq,Oa),jb.setPropertyUint32s(Va.Uk,l.a.fu,Wa));u.a.instance.Ta(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Va.Ng.value.yf.id,n.a.yb(l.a.fu),mc,yb,n.a.yb(l.a.Bq),Gb,Wb);Va.sg.add(n.a.yb(l.a.Bq));Va.sg.add(n.a.yb(l.a.fu));
return!0}u.a.instance.Ta(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}Cmi(Va,Wa,jb,mc){let yb;({gHc:Wa,N2a:mc,C2a:yb}=this.F6e(Wa,jb.Ng.value.Ku,jb.Ng.value.yf,jb.vn.value.yf,Va,mc));return yb||mc?{returnValue:!0,V8e:Wa,N2a:mc,C2a:yb}:(u.a.instance.Ta(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
jb.Ng.value.yf.id.toString(),n.a.yb(Va)),{returnValue:!1,V8e:Wa,N2a:mc,C2a:yb})}Fli(Va,Wa,jb,mc,yb){let Oa;let Gb,Wb,kc,Mb;({V8e:Oa,N2a:Qc,C2a:Gb,returnValue:kc}=this.Cmi(Va,Object(ab.a)(jb,jb.getPropertyUint32s,"getPropertyUint32s"),mc,null));({V8e:jb,N2a:yb,C2a:Wb,returnValue:Mb}=this.Cmi(Wa,Object(ab.a)(jb,jb.getPropertyObjectIds,"getPropertyObjectIds"),mc,yb));var Qc=Qc&&!Gb;return kc&&Mb?Qc!==(yb&&!Wb)?(u.a.instance.Ta(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
mc.Ng.value.yf.id.toString(),n.a.yb(Va),n.a.yb(Wa)),{returnValue:2,XEd:Oa,WEd:jb,Mke:Qc}):{returnValue:0,XEd:Oa,WEd:jb,Mke:Qc}:{returnValue:1,XEd:Oa,WEd:jb,Mke:Qc}}OCf(Va){let Wa=!0;Va.forEach(jb=>jb!==aa.a.nil?Wa=!1:!0);return Wa}hVl(Va,Wa,jb){return this.OCf(Va)&&this.OCf(Wa)&&this.OCf(jb)?!0:!1}HOo(Va,Wa){let jb,mc,yb,Oa,Gb,Wb;var kc=({XEd:Oa,WEd:Gb,Mke:mc}=this.Fli(sb.a.u4a,l.a.Bq,Va,Wa,null)).returnValue;if(2===kc||1===kc)return!0;({XEd:yb,WEd:Wb,Mke:jb,returnValue:kc}=this.Fli(l.a.fu,l.a.n9,
Va,Wa,Object(ab.a)(this,this.hVl,"getExtendedGuidEquivalence")));if(2===kc||1===kc)return!0;let Mb;({gHc:kc,N2a:Qc,C2a:Mb}=this.UUk(Object(ab.a)(Va,Va.getPropertyDictionary,"getPropertyDictionary"),Wa.Ng.value.Ku,Wa.Ng.value.yf,Wa.vn.value.yf,sb.a.yJ));if(!Mb&&!Qc)return u.a.instance.Ta(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Wa.Ng.value.yf.id.toString(),n.a.yb(sb.a.yJ)),!0;var Qc=Qc&&!Mb;if(jb!==mc||jb!==
Qc)return u.a.instance.Ta(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Wa.Ng.value.yf.id.toString(),n.a.yb(l.a.fu),n.a.yb(sb.a.u4a),n.a.yb(sb.a.yJ),mc,jb,Qc),!0;jb&&(Va.setPropertyObjectIds(Wa.Uk,l.a.Bq,Gb),Va.setPropertyUint32s(Wa.Uk,sb.a.u4a,Oa),Va.setPropertyObjectIds(Wa.Uk,
l.a.n9,Wb),Va.setPropertyUint32s(Wa.Uk,l.a.fu,yb),Va.setPropertyDictionary(Wa.Uk,sb.a.yJ,kc));u.a.instance.Ta(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Wa.Ng.value.yf.id.toString(),mc,jb,Qc);Wa.sg.add(n.a.yb(sb.a.u4a));Wa.sg.add(n.a.yb(l.a.Bq));Wa.sg.add(n.a.yb(l.a.fu));Wa.sg.add(n.a.yb(l.a.n9));Wa.sg.add(n.a.yb(sb.a.yJ));return!0}static kh(){return new Ga}static get instance(){return Ga.Lg.value}}
Ga.Lg=new a.a(Ga.kh);Object(E.a)(Ga,"PageContentNodeComplexMerge",k.a,[]);class Ua extends k.a{constructor(){super()}get Mn(){return 19}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.AHa),1);Va.Z(n.a.yb(l.a.appsNode),2);Va.Z(n.a.yb(l.a.customXmlPartContainerNode),2);Va.Z(n.a.yb(l.a.intelligenceRootNode),1);return Va}aC(Va,Wa){const jb=Va.Zd;if(Wa===n.a.yb(l.a.AHa)){var mc=jb.getPropertyObjectIds(Va.Ng.value.Ku,l.a.AHa),yb=jb.getPropertyObjectIds(Va.Ng.value.yf,l.a.AHa),Oa=jb.getPropertyObjectIds(Va.vn.value.yf,
l.a.AHa);if((mc=this.Pbn(mc,yb,Oa,(Gb,Wb)=>Gb.equals(Wb),Gb=>{let Wb;({value:Wb}=Va.iq.runtime.Iq.Dc(Gb)).returnValue?Va.iq.runtime.fn.Z(Gb,new z.a(Wb,!1)):u.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Va.iq))&&0<mc.length)return jb.setPropertyObjectIds(Va.Uk,l.a.AHa,mc),Va.sg.add(n.a.yb(l.a.AHa)),!0}if(Wa===n.a.yb(l.a.intelligenceRootNode))return mc=jb.getPropertyObjectIds(Va.Ng.value.Ku,l.a.intelligenceRootNode),
yb=jb.getPropertyObjectIds(Va.Ng.value.yf,l.a.intelligenceRootNode),Oa=jb.getPropertyObjectIds(Va.vn.value.yf,l.a.intelligenceRootNode),mc=this.XFa(mc,yb,Oa),jb.setPropertyObjectIds(Va.Uk,l.a.intelligenceRootNode,mc),Va.sg.add(Wa),!0;u.a.instance.Ta(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}static kh(){return new Ua}static get instance(){return Ua.Lg.value}}Ua.Lg=new a.a(Ua.kh);
Object(E.a)(Ua,"PageManifestNodeComplexMerge",k.a,[]);class wb extends k.a{constructor(){super()}get Mn(){return 43}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.Rla),0);Va.Z(n.a.yb(l.a.pLb),0);Va.Z(n.a.yb(l.a.RHb),0);Va.Z(n.a.yb(l.a.Qna),1);Va.Z(n.a.yb(l.a.sessionId),3);Va.Z(n.a.yb(l.a.buildVersion),3);Va.Z(n.a.yb(l.a.eR),1);Va.Z(n.a.yb(l.a.Pwi),1);Va.Z(n.a.yb(l.a.kv),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(l.a.eR)||Wa===n.a.yb(l.a.Pwi)||Wa===n.a.yb(l.a.kv)){var jb=Va.vn.value.yf,mc=Va.Ng.value.yf,yb=n.a.wX(Wa);
mc=Va.Zd.getPropertyBool(mc,yb);jb=Va.Zd.getPropertyBool(jb,yb);Va.Zd.setPropertyBool(Va.Uk,yb,null==mc?!1:mc&&null==jb?!1:jb);Va.sg.add(Wa);return!0}if(Wa===n.a.yb(l.a.Qna)){Wa=Va.Zd;jb=Va.Ng.value.Ku;mc=Va.vn.value.yf;yb=Va.Ng.value.yf;jb=jb?Wa.getPropertyObjectId(jb,l.a.Qna):null;mc=mc?Wa.getPropertyObjectId(mc,l.a.Qna):null;yb=yb?Wa.getPropertyObjectId(yb,l.a.Qna):null;u.a.instance.Ta(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",jb?jb.toString():
"NULL",mc?mc.toString():"NULL",yb?yb.toString():"NULL");if(mc){if(yb&&mc.equals(yb))return Va.sg.add(n.a.yb(l.a.Qna)),Wa.setPropertyObjectId(Va.Uk,l.a.Qna,mc),!0;if(fa.a.bTd.equals(mc))return Va.sg.add(n.a.yb(l.a.Qna)),Wa.setPropertyObjectId(Va.Uk,l.a.Qna,fa.a.bTd),!0}if(yb&&fa.a.bTd.equals(yb))return Va.sg.add(n.a.yb(l.a.Qna)),Wa.setPropertyObjectId(Va.Uk,l.a.Qna,fa.a.bTd),!0;u.a.instance.Ta(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",jb?jb.toString():
"NULL",mc?mc.toString():"NULL",yb?yb.toString():"NULL")}return!1}static kh(){return new wb}static get instance(){return wb.Lg.value}}wb.Lg=new a.a(wb.kh);Object(E.a)(wb,"PageMetadataNodeComplexMerge",k.a,[]);var cc=c(1775),zb=c(145);class nb extends k.a{constructor(){super()}get Mn(){return 31}uk(){const Va=super.uk();Va.Z(n.a.yb(zb.a.GA),1);Va.Z(n.a.yb(l.a.listID),3);Va.Z(n.a.yb(l.a.listLevel),1);Va.Z(n.a.yb(l.a.He),3);Va.Z(n.a.yb(l.a.t1b),3);Va.Z(n.a.yb(l.a.runId),3);Va.Z(n.a.yb(l.a.wKd),3);Va.Z(n.a.yb(y.a.fontColor),
3);Va.Z(n.a.yb(l.a.UGh),3);Va.Z(n.a.yb(l.a.Lc),1);Va.Z(n.a.yb(zb.a.EXd),3);Va.Z(n.a.yb(zb.a.kHf),3);Va.Z(n.a.yb(zb.a.yUc),3);Va.Z(n.a.yb(l.a.dGl),3);Va.Z(n.a.yb(kb.a.JDj),3);for(let Wa=0;Wa<nb.K3a.length;Wa++)Va.Z(nb.K3a[Wa],1);return Va}aC(Va,Wa){var jb=Va.Zd;const mc=Va.Uk;n.a.wX(Wa);if(Wa===n.a.yb(l.a.Lc)){jb=Va.Zd.getPropertyInt32(Va.vn.value.yf,l.a.Lc);if(null==jb||!jb)return!0;Va.Zd.setPropertyInt32(mc,l.a.Lc,jb);Va.sg.add(Wa);return!0}if(Wa===n.a.yb(zb.a.GA)){const yb=jb.getPropertyUint32(Va.Ng.value.yf,
zb.a.GA),Oa=jb.getPropertyUint32(Va.vn.value.yf,zb.a.GA);if(null!=yb&&null!=Oa&&yb===Oa)return jb.setPropertyUint32(mc,zb.a.GA,yb),Va.sg.add(Wa),!0;if(null==yb&&null==Oa)return mc.removeProperty(zb.a.GA),Va.sg.add(n.a.yb(zb.a.GA)),!0;if(null!=yb&&null==Oa)return jb.setPropertyUint32(mc,zb.a.GA,yb),Va.sg.add(Wa),!0;if(null==yb&&null!=Oa)return jb.setPropertyUint32(mc,zb.a.GA,Oa),Va.sg.add(Wa),!0}else{if(Wa===n.a.yb(l.a.listLevel))return this.ZNo(jb,Va);if(Array.contains(nb.K3a,Wa))return this.YNo(Va)}return!1}YNo(Va){let Wa=
!0,jb=!0,mc,yb;({uJm:Wa,OGm:jb,qzl:mc,c3k:yb}=this.VUk(Va));u.a.instance.Ta(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Va.Ng.value.yf.id.toString(),Wa,jb);return Wa&&!jb?(this.pOi(yb,Va),!0):Wa?!1:(this.pOi(mc,Va),!0)}VUk(Va){let Wa,jb,mc,yb;const Oa=Va.vn.value;let Gb;const Wb=Va.Ng.value;let kc;jb=Wa=!0;mc=new H.a;yb=new H.a;for(let Mb=0;Mb<nb.K3a.length;Mb++){const Qc=nb.K3a[Mb],Ic=({value:Gb}=
Oa.Mpa.Dc(Qc)).returnValue;({value:kc}=Wb.Mpa.Dc(Qc)).returnValue&&(Wa=this.OBj(Va.Ng,mc,kc,Qc)&&Wa);Ic&&(jb=this.OBj(Va.vn,yb,Gb,Qc)&&jb)}return{uJm:Wa,OGm:jb,qzl:mc,c3k:yb}}OBj(Va,Wa,jb,mc){const yb=n.a.wX(mc);Va=Va.value.yf;Wa.Z(mc,Va.hasProperty(yb)?Va.EX(yb):null);return!jb.bY}pOi(Va,Wa){const jb=Wa.Uk;for(let yb=0;yb<nb.K3a.length;yb++){var mc=nb.K3a[yb];const Oa=n.a.wX(mc);(mc=Va.J(mc))?jb.YSa(Oa,mc):jb.removeProperty(Oa)}for(Va=0;Va<nb.K3a.length;Va++)Wa.sg.add(nb.K3a[Va]);u.a.instance.Ta(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Wa.Ng.value.yf.id.toString())}ZNo(Va,Wa){const jb=Wa.Uk,mc=Va.getPropertyInt32(Wa.Ng.value.yf,l.a.listLevel),yb=Va.getPropertyInt32(Wa.vn.value.yf,l.a.listLevel);return null!=mc&&null!=yb&&mc===yb?(Va.setPropertyInt32(jb,l.a.listLevel,mc),Wa.sg.add(n.a.yb(l.a.listLevel)),!0):null==mc&&null==yb?(jb.removeProperty(l.a.listLevel),Wa.sg.add(n.a.yb(l.a.listLevel)),!0):null!=mc&&null==yb?(Va.setPropertyInt32(jb,l.a.listLevel,
mc),Wa.sg.add(n.a.yb(l.a.listLevel)),!0):null==mc&&null!=yb?(Va.setPropertyInt32(jb,l.a.listLevel,yb),Wa.sg.add(n.a.yb(l.a.listLevel)),!0):!1}static kh(){return new nb}static get instance(){return nb.Lg.value}}nb.Lg=new a.a(nb.kh);nb.K3a=[n.a.yb(l.a.$d),n.a.yb(l.a.at),n.a.yb(y.a.B4),n.a.yb(l.a.rca),n.a.yb(l.a.lv),n.a.yb(l.a.Sr),n.a.yb(y.a.h0),n.a.yb(l.a.O2e),n.a.yb(y.a.font),n.a.yb(kb.a.Vkb),n.a.yb(f.a.paragraphStyle)];Object(E.a)(nb,"PersistablePropertySetComplexMerge",k.a,[]);class eb extends k.a{constructor(){super()}get Mn(){return 21}get kA(){return 0}static kh(){return new eb}static get instance(){return eb.Lg.value}}
eb.Lg=new a.a(eb.kh);Object(E.a)(eb,"RevisionMetadataNodeComplexMerge",k.a,[]);class Ib extends k.a{constructor(){super()}get Mn(){return 48}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.K2i),3);return Va}static kh(){return new Ib}static get instance(){return Ib.Lg.value}}Ib.Lg=new a.a(Ib.kh);Object(E.a)(Ib,"ShadowNumberListNodeComplexMerge",k.a,[]);class Xa extends k.a{constructor(){super()}get Mn(){return 22}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.B3a),7);Va.Z(n.a.yb(l.a.fVc),2);return Va}static kh(){return new Xa}static get instance(){return Xa.Lg.value}}
Xa.Lg=new a.a(Xa.kh);Object(E.a)(Xa,"SharedPersistablePropertySetComplexMerge",k.a,[]);class Ra extends k.a{constructor(){super()}get Mn(){return 38}get kA(){return 3}static kh(){return new Ra}static get instance(){return Ra.Lg.value}}Ra.Lg=new a.a(Ra.kh);Object(E.a)(Ra,"StylePropertySetComplexMerge",k.a,[]);var gb=c(1584),Bb=c(1630);class $b extends k.a{constructor(){super()}get Mn(){return 23}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(y.a.ef),4);Va.Z(n.a.yb(l.a.rowSpan),1);Va.Z(n.a.yb(l.a.colSpan),
1);Va.Z(n.a.yb(l.a.ghostCell),1);Va.Z(n.a.yb(sb.a.vMerge),1);Va.Z(n.a.yb(sb.a.gridSpan),1);Va.Z(n.a.yb(l.a.z7a),2);Va.Z(n.a.yb(l.a.Vpb),2);Va.Z(n.a.yb(l.a.XHa),2);Va.Z(n.a.yb(l.a.spb),5);return Va}ZHb(Va){if(!Va)return u.a.instance.Ta(573957923,1,2,"Feature helper is null"),!1;Va.uz(105);return Va.isFeatureEnabled(105)}Swa(Va){if(!Va)return u.a.instance.Ta(540120285,1,2,"Feature helper is null"),!1;Va.uz(106);return Va.isFeatureEnabled(106)}aC(Va,Wa){Va.iq.runtime.SG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
Wa);var jb=Wa===n.a.yb(l.a.rowSpan)||Wa===n.a.yb(l.a.colSpan)||Wa===n.a.yb(l.a.ghostCell);this.Swa(Va.iq.runtime.Xb)&&(jb=jb||Wa===n.a.yb(sb.a.vMerge)||Wa===n.a.yb(sb.a.gridSpan));if(!this.ZHb(Va.iq.runtime.Xb))return!jb;var mc=Va.vn.value.Ku,yb=Bb.e(Va.iq,mc,null);if(yb.equals(aa.a.nil))return u.a.instance.Ta(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",mc.id),Va.iq.logger.Og(Object.assign(new gb.a,{info:"Table node ID could not be found for table cell"})),
!1;var Oa=Va.iq.runtime.MAb.J(yb).J(mc.id);if(!Oa)return!jb;mc=Va.Uk;yb=Va.Zd;if(Wa===n.a.yb(l.a.ghostCell))return yb.setPropertyBool(mc,l.a.ghostCell,Oa.hg),Va.sg.add(n.a.yb(l.a.ghostCell)),!0;if(Wa===n.a.yb(l.a.rowSpan))return Wa=Oa.rowSpan,Oa=Oa.colSpan,null!=Wa&&null!=Oa&&(1<Wa||1<Oa)?yb.setPropertyUint32(mc,l.a.rowSpan,Wa):mc.removeProperty(l.a.rowSpan),Va.sg.add(n.a.yb(l.a.rowSpan)),!0;if(Wa===n.a.yb(l.a.colSpan))return Wa=Oa.rowSpan,jb=Oa.colSpan,Oa=Oa.hg,null!=Wa&&null!=jb&&(1<Wa||1<jb)?yb.setPropertyUint32(mc,
l.a.colSpan,jb):Oa&&null!=jb?yb.setPropertyUint32(mc,l.a.colSpan,jb):mc.removeProperty(l.a.colSpan),Va.sg.add(n.a.yb(l.a.colSpan)),!0;u.a.instance.Ta(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",Wa);Va.iq.logger.Og(Object.assign(new gb.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!jb}static kh(){return new $b}static get instance(){return $b.Lg.value}}
$b.Lg=new a.a($b.kh);Object(E.a)($b,"TableCellNodeComplexMerge",k.a,[]);class Qb extends k.a{constructor(){super()}get Mn(){return 24}ZHb(Va){if(!Va)return u.a.instance.Ta(573845782,1,2,"Feature helper is null"),!1;Va.uz(105);return Va.isFeatureEnabled(105)}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(y.a.ef),1);Va.Z(n.a.yb(y.a.$0),1);Va.Z(n.a.yb(y.a.Qya),1);Va.Z(n.a.yb(l.a.Dkc),1);Va.Z(n.a.yb(l.a.d$),1);Va.Z(n.a.yb(l.a.z7a),2);Va.Z(n.a.yb(l.a.Vpb),2);Va.Z(n.a.yb(l.a.XHa),2);return Va}aC(Va,
Wa){Va.iq.runtime.SG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Wa);if(Wa===n.a.yb(y.a.ef)||Wa===n.a.yb(y.a.$0)||Wa===n.a.yb(l.a.Dkc)||Wa===n.a.yb(l.a.d$)||Wa===n.a.yb(y.a.Qya)){const yb=Va.Uk;var jb=Va.Zd;u.a.instance.Ta(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",yb.id,yb.Qc,Wa);if(this.Tol(Va))return!1;var mc=jb.getPropertyObjectIds(Va.Ng.value.Ku,y.a.ef);const Oa=jb.getPropertyObjectIds(Va.Ng.value.yf,y.a.ef),
Gb=jb.getPropertyObjectIds(Va.vn.value.yf,y.a.ef);mc=this.zNi(mc,Oa,Gb,(Wb,kc)=>Wb.equals(kc));if(0<mc.length)return jb.setPropertyObjectIds(yb,y.a.ef,mc),jb.setPropertyInt32(yb,y.a.Qya,mc.length),this.ZHb(Va.iq.runtime.Xb)&&({value:Wa}=Va.vn.value.Mpa.Dc(n.a.yb(y.a.$0)),{value:jb}=Va.Ng.value.Mpa.Dc(n.a.yb(y.a.$0)),Wa.bY?yb.YSa(y.a.$0,Wa.newValue):yb.YSa(y.a.$0,jb.newValue)),Va.sg.add(n.a.yb(y.a.ef)),Va.sg.add(n.a.yb(y.a.$0)),Va.sg.add(n.a.yb(y.a.Qya)),Va.sg.add(n.a.yb(l.a.Dkc)),Va.sg.add(n.a.yb(l.a.d$)),
!0}u.a.instance.Ta(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}Tol(Va){const Wa=Va.vn.value,jb=Va.Ng.value;let mc,yb;({value:mc}=Wa.Mpa.Dc(n.a.yb(y.a.$0)));({value:yb}=jb.Mpa.Dc(n.a.yb(y.a.$0)));return mc.bY||yb.bY?mc.bY&&yb.bY?(u.a.instance.Ta(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
mc.oldValue,yb.newValue,mc.newValue),Va.iq.logger.Og(Object.assign(new gb.a,{qj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Qb.sSh(Va.iq,mc,jb,"BaseConflict")||Qb.sSh(Va.iq,yb,Wa,"BaseFavored")?!0:!1:!1}static kh(){return new Qb}static get instance(){return Qb.Lg.value}static sSh(Va,Wa,jb,mc){return Wa.bY&&({value:Wa}=jb.Mpa.Dc(n.a.yb(y.a.ef)),Wa.bY)?(u.a.instance.Ta(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
mc),Va.logger.Og(Object.assign(new gb.a,{qj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Qb.Lg=new a.a(Qb.kh);Object(E.a)(Qb,"TableNodeComplexMerge",k.a,[]);class Ac extends k.a{constructor(){super()}get Mn(){return 25}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.Lc),3);Va.Z(n.a.yb(y.a.ef),4);Va.Z(n.a.yb(l.a.z7a),2);Va.Z(n.a.yb(l.a.Vpb),2);Va.Z(n.a.yb(l.a.XHa),2);Va.Z(n.a.yb(sb.a.Hhg),2);Va.Z(n.a.yb(sb.a.Ghg),2);Va.Z(n.a.yb(l.a.spb),5);return Va}static kh(){return new Ac}static get instance(){return Ac.Lg.value}}
Ac.Lg=new a.a(Ac.kh);Object(E.a)(Ac,"TableRowNodeComplexMerge",k.a,[]);class Db extends k.a{constructor(){super()}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.DGo),2);Va.Z(n.a.yb(y.a.ef),1);return Va}aC(Va,Wa){if(Wa===n.a.yb(y.a.ef)){const mc=Va.Uk,yb=Va.Zd;u.a.instance.Ta(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.Qc,Wa);var jb=yb.getPropertyObjectIds(Va.Ng.value.Ku,y.a.ef);const Oa=yb.getPropertyObjectIds(Va.Ng.value.yf,
y.a.ef),Gb=yb.getPropertyObjectIds(Va.vn.value.yf,y.a.ef);if(jb=this.$bn(jb,Oa,Gb))return 0<jb.length?yb.setPropertyObjectIds(mc,y.a.ef,jb):mc.removeProperty(y.a.ef),Va.sg.add(n.a.yb(y.a.ef)),!0}u.a.instance.Ta(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa);return!1}$bn(Va,Wa,jb){const mc=new H.a(0);Va.forEach(Oa=>{mc.Z(Oa,0);return!0});Wa.forEach(Oa=>{mc.nb(Oa)?mc.Z(Oa,1):mc.Z(Oa,3);return!0});
jb.forEach(Oa=>{let Gb;({value:Gb}=mc.Dc(Oa)).returnValue?1===Gb?mc.Z(Oa,5):3===Gb?(u.a.instance.Ta(42754253,1,2,"TaskNode was found added by both sides of merge"),mc.Z(Oa,3)):mc.Z(Oa,2):mc.Z(Oa,4);return!0});const yb=new I.a;mc.forEach((Oa,Gb)=>{0!==Gb&&2!==Gb&&1!==Gb&&yb.add(Oa);return!0});return yb}static kh(){return new Db}static get instance(){return Db.Lg.value}}Db.Lg=new a.a(Db.kh);Object(E.a)(Db,"TaskContentNodeComplexMerge",k.a,[]);class dc{equals(Va,Wa){return Va&&Wa?Va.UserId===Wa.UserId&&
Va.Provider===Wa.Provider&&Va.DisplayName===Wa.DisplayName&&Va.Email===Wa.Email:!Va&&!Wa}sM(){return 0}}Object(E.a)(dc,"CommentTaskPersonComparer",null,[141]);class Pb{equals(Va,Wa){return Va&&Wa?Va.startDate?Va.endDate?Va.startDate.getTime()===Wa.startDate.getTime()&&Va.endDate.getTime()===Wa.endDate.getTime():!Wa.endDate:!Wa.startDate:!Va&&!Wa}sM(){return 0}}Object(E.a)(Pb,"CommentTaskScheduleEqualityComparer",null,[141]);class Ub{equals(Va,Wa){if(!Va||!Wa)return!Va&&!Wa;if(!Va.extensions&&!Wa.extensions)return!0;
if(!Va.extensions||!Wa.extensions||Va.extensions.count!==Wa.extensions.count)return!1;let jb=!0;Va.extensions.forEach((mc,yb)=>{let Oa;return({value:Oa}=Wa.extensions.Dc(mc)).returnValue&&yb===Oa?!0:jb=!1});return jb}sM(){return 0}}Object(E.a)(Ub,"ExtensionListEqualityComparer",null,[141]);class rb{hwl(Va,Wa){return Va&&Wa?Va.recordId===Wa.recordId&&rb.aPg.equals(Va.user,Wa.user)&&rb.aPg.equals(Va.assignee,Wa.assignee)&&Va.type===Wa.type&&Va.title===Wa.title&&Va.priority===Wa.priority&&Va.isLossy===
Wa.isLossy&&Va.completion===Wa.completion&&Va.commentId===Wa.commentId&&Va.time===Wa.time&&rb.dZj.equals(Va.schedule,Wa.schedule):!Va&&!Wa}equals(Va,Wa){return this.hwl(Va,Wa)}sM(){return 0}}rb.aPg=new dc;rb.dZj=new Pb;new Ub;Object(E.a)(rb,"HistoryRecordEqualityComparer",null,[141]);var Yb=c(2069),Ya=c(1548);class Ob extends k.a{constructor(Va){super();this.qMa=Va}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.LPb),5);Va.Z(n.a.yb(l.a.taskId),2);Va.Z(n.a.yb(l.a.qGo),2);Va.Z(n.a.yb(l.a.uGo),2);Va.Z(n.a.yb(l.a.Sya),
1);return Va}Hkg(Va){if(!Va.vn.value.Ku&&!Va.Ng.value.Ku){const Wa=Va.Ng.value.yf.IK();Wa.removeProperty(l.a.Sya);const jb=Va.Ng.value.yf,mc=Va.vn.value.yf;Va.Ng=new a.a(()=>new Ya.a(Wa,jb));Va.vn=new a.a(()=>new Ya.a(Wa,mc))}return super.Hkg(Va)}aC(Va,Wa){if(Wa!==n.a.yb(l.a.Sya))return u.a.instance.Ta(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Va.Ng.value.yf.id,Wa),!1;const jb=Va.Uk,mc=Va.Zd;u.a.instance.Ta(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",jb.id,jb.Qc,Wa);Wa=mc.getPropertyString(Va.Ng.value.Ku,l.a.Sya);const yb=mc.getPropertyString(Va.Ng.value.yf,l.a.Sya),Oa=mc.getPropertyString(Va.vn.value.yf,l.a.Sya);Wa=this.Zbn(Wa,yb,Oa);if(!Wa)return!1;0<Wa.length?mc.setPropertyString(jb,l.a.Sya,Wa):jb.removeProperty(l.a.Sya);Va.sg.add(n.a.yb(l.a.Sya));return!0}Zbn(Va,Wa,jb){Va=this.qMa.y4b(Va);Wa=this.qMa.y4b(Wa);jb=this.qMa.y4b(jb);if(!Ob.Lzi(Va,
Wa))return u.a.instance.Ta(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!Ob.Lzi(Va,jb))return u.a.instance.Ta(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;jb=Ob.b0k(Va.length,Wa,jb);return this.qMa.n$f(jb)}static kh(){const Va=new Yb.a;return new Ob(Va)}static get instance(){return Ob.Lg.value}static b0k(Va,Wa,jb){const mc=new I.a;for(let yb=0;yb<Wa.length;yb++)mc.add(Wa.J(yb));for(;Va<jb.length;Va++)mc.add(jb.J(Va));
return mc}static Lzi(Va,Wa){const jb=Va.length;if(jb>Wa.length)return!1;for(let mc=0;mc<jb;mc++)if(!Ob.l5j.equals(Wa.J(mc),Va.J(mc)))return Wa.J(mc).recordId===Va.J(mc).recordId&&u.a.instance.Ta(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}Ob.Lg=new a.a(Ob.kh);Ob.l5j=new rb;Object(E.a)(Ob,"TaskSingleNodeComplexMerge",k.a,[]);class vc extends k.a{constructor(){super()}get Mn(){return 26}uk(){const Va=super.uk();Va.Z(n.a.yb(y.a.ef),
1);return Va}aC(Va,Wa){const jb=y.a.ef;if(Wa===n.a.yb(jb)){Wa=Va.Uk;const yb=Va.Zd;var mc=yb.getPropertyObjectIds(Va.Ng.value.Ku,jb);const Oa=yb.getPropertyObjectIds(Va.Ng.value.yf,jb),Gb=yb.getPropertyObjectIds(Va.vn.value.yf,jb);mc=this.fcn(mc,Oa,Gb);yb.setPropertyObjectIds(Wa,jb,mc);Va.sg.add(n.a.yb(jb));return!0}return!1}fcn(Va,Wa,jb){return this.XFa(Va,Wa,jb)}static kh(){return new vc}static get instance(){return vc.Lg.value}}vc.Lg=new a.a(vc.kh);Object(E.a)(vc,"VectorClockContainerNodeComplexMerge",
k.a,[]);class Sa extends k.a{constructor(){super()}get Mn(){return 27}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.cS),1);return Va}aC(Va,Wa){const jb=l.a.cS;if(Wa===n.a.yb(jb)){Wa=Va.Uk;const mc=Va.Zd,yb=mc.getPropertyUint32(Va.Ng.value.yf,jb)||0,Oa=mc.getPropertyUint32(Va.vn.value.yf,jb)||0;mc.setPropertyUint32(Wa,jb,this.$1l(yb,Oa));Va.sg.add(n.a.yb(jb));return!0}return!1}$1l(Va,Wa){return Va>Wa?Va:Wa}static kh(){return new Sa}static get instance(){return Sa.Lg.value}}Sa.Lg=new a.a(Sa.kh);Object(E.a)(Sa,
"VectorClockNodeComplexMerge",k.a,[]);class Ab extends k.a{constructor(){super()}get Mn(){return 28}get kA(){return 0}uk(){const Va=super.uk();Va.Z(n.a.yb(l.a.OSh),3);Va.Z(n.a.yb(l.a.Lc),3);Va.Z(n.a.yb(l.a.PSh),5);Va.Z(n.a.yb(l.a.JNi),5);Va.Z(n.a.yb(l.a.Mia),5);return Va}static kh(){return new Ab}static get instance(){return Ab.Lg.value}}Ab.Lg=new a.a(Ab.kh);Object(E.a)(Ab,"WordSectionNodeComplexMerge",k.a,[]);c.d(K,"a",function(){return Fb});class Fb{$Kh(Va,Wa){switch(Va.Qc){case 131073:return Va.hasProperty(l.a.imageType)||
Va.hasProperty(f.a.O_)?this.ep(wa.instance,Wa):this.ep(nb.instance,Wa);case 1074135140:return this.ep(x.instance,Wa);case 1074135137:return this.ep(w.instance,Wa);case 1074135139:return this.ep(F.instance,Wa);case 1074135138:return this.ep(G.instance,Wa);case 1074135136:return this.ep(M.instance,Wa);case 1074135157:return this.ep(J.instance,Wa);case 1074135152:return this.ep(V.instance,Wa);case 1074135153:return this.ep(X.instance,Wa);case 1074135126:return this.ep(W.instance,Wa);case 1074135127:return this.ep(Y.instance,
Wa);case 1074135145:return this.ep(pa.instance,Wa);case 1074135144:return this.ep(ca.instance,Wa);case 1074135142:return this.ep(ra.instance,Wa);case 1074135143:return this.ep(la.instance,Wa);case 1074135163:return this.ep(qa.instance,Wa);case 1074135164:return this.ep(La.instance,Wa);case 1074135124:return this.ep(Pa.instance,Wa);case 1074135125:return this.ep(Ka.instance,Wa);case 1074135122:return this.ep(sa.instance,Wa);case 393233:return this.ep(wa.instance,Wa);case 1073872970:return this.ep(wa.instance,
Wa);case 1074135170:return this.ep(ja.instance,Wa);case 1074135168:return this.ep(ha.instance,Wa);case 1074135166:return this.ep(va.instance,Wa);case 1074135167:return this.ep(xa.instance,Wa);case 1074135169:return this.ep(ma.instance,Wa);case 1074135165:return this.ep(Ja.instance,Wa);case 393234:return this.ep(Fa.instance,Wa);case 393229:return this.ep(fb.instance,Wa);case 393241:return this.ep(lb.instance,Wa);case 393227:return this.ep(Ga.instance,Wa);case 131120:return this.ep(wb.instance,Wa);
case 393271:return this.ep(Ua.instance,Wa);case 393230:return this.ep(cc.a.instance,Wa);case 131140:return this.ep(eb.instance,Wa);case 1179649:return this.ep(Xa.instance,Wa);case 1073872969:return this.ep(Ra.instance,Wa);case 393252:return this.ep($b.instance,Wa);case 393250:return this.ep(Qb.instance,Wa);case 393251:return this.ep(Ac.instance,Wa);case 1074135154:return this.ep(vc.instance,Wa);case 1074135161:return this.ep(Db.instance,Wa);case 1074135162:return this.ep(Ob.instance,Wa);case 1074135155:return this.ep(Sa.instance,
Wa);case 1073872968:return this.ep(Ab.instance,Wa);case 1074135172:return this.ep(za.instance,Wa);case 1074135171:return this.ep(oa.instance,Wa);case 1074135149:return this.ep(Na.instance,Wa);case 1074135151:return this.ep(Ib.instance,Wa)}return this.ep(k.a.instance,Wa)}ep(Va,Wa){Va.Xb=Wa?Wa():null;return Va}}Object(E.a)(Fb,"GraphNodeComplexMergeFactory",null,[969])},1959:function(E,K,c){c.r(K);E=c(0);var l=c(1524),f=c(74),a=c(344),k=c(73),x=c(1501);class y{constructor(I,N,P,M=0){this.tki=I;this.groupType=
N;this.cwf=M;this.j5c=P}}Object(E.a)(y,"SortingGroup",null,[]);class n{constructor(I,N,P,M){this.order=I;this.t8=N;this.Ekm=P;this.groupType=M}}Object(E.a)(n,"SortingProp",null,[]);var u=c(1494),z=c(1496),w=c(1493),F=c(25);class G{constructor(I,N){this.zLi={};this.yLi={};this.uLi=this.GLi=1;this.kyh(I,N)}Jyo(I,N,P){var M=w.a.cR(P)?this.zLi:this.yLi;P=new f.a;for(var J of N)N=Object(k.a)(n,M[l.a[J.groupType].toLowerCase()]),F.c(N)||P.add(new a.a(N,J));P.Sc((X,W)=>X.key.order<W.key.order?-1:1);Array.clear(I);
J=u.TellMeActor.instance.OZ;for(N=0;N<P.count;){M=P.J(N).key.t8;var V=P.J(N).value;const X=new x.a(P.J(N).key.groupType);F.c(J)||J.Location===z.a.contextMenu||(X.displayName=P.J(N).key.Ekm);for(const W of V.results)X.Nw(W);for(V=++N;V<P.count&&P.J(V).key.t8===M;)this.jZe(X,P.J(V).value),V=++N;I.push(X)}}BXo(I,N){this.uLi=this.GLi=1;this.kyh(I,N)}kyh(I,N){this.stj(I);for(var P=0;P<I.length;P++){let M=I[P];for(const J of M.j5c)this.csk(J,P,M.tki,M.groupType)}this.stj(N);for(I=0;I<N.length;I++){P=N[I];
for(const M of P.j5c)this.bsk(M,I,P.tki,P.groupType)}}stj(I){I.sort((N,P)=>Object(k.a)(y,N).cwf>Object(k.a)(y,P).cwf?-1:1)}csk(I,N,P,M){this.zLi[l.a[I].toLowerCase()]=new n(this.GLi++,N,P,M)}bsk(I,N,P,M){this.yLi[l.a[I].toLowerCase()]=new n(this.uLi++,N,P,M)}jZe(I,N){for(let P=0;P<N.results.length;P++)I.Nw(N.results[P])}}Object(E.a)(G,"BaseGroupingSorter",null,[]);class H{constructor(){this.l3d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.g3d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13,24]),new y("",22,[22])];this.fLi=new G(this.l3d,this.g3d)}K8c(I,N,P,M=null,J=null){let V=!1;if(M){for(const X of w.a.cR(P)?
this.l3d:this.g3d)this.aOn(X,M);V=!0}if(J){for(const X of w.a.cR(P)?this.l3d:this.g3d)this.CXo(N,X,J);V=!0}V&&this.fLi.BXo(this.l3d,this.g3d);this.fLi.Jyo(I,N,P)}aOn(I,N){const P=new f.a;for(var M of I.j5c){const J=N[l.a[M].toLowerCase()];P.add(new a.a(F.c(J)?Number.MAX_VALUE:J,M))}if(P.count){P.Sc((J,V)=>J.key<V.key?-1:1);N=Array(P.count);for(M=0;M<P.count;M++)N[M]=P.J(M).value;I.j5c=N}}CXo(I,N,P){let M=0;for(const J of N.j5c)if(l.a[J].toLowerCase()in P&&P[l.a[J].toLowerCase()])for(const V of I)if(V.groupType===
J){M+=P[l.a[J].toLowerCase()];break}N.cwf=M}}Object(E.a)(H,"SimplifiedGroupingSorter",null,[]);c.d(K,"GroupsPlacementInfo",function(){return L});class L{constructor(I){this.xLi={};this.vLi={};this.wLi={};this.ALi={};this.ALf={};this.BLi=this.y8m=this.t8m=this.v8m=1;this.DLi=null;this.Ov=I;this.gOk();this.wDn();this.TNk();this.VMk();I.sP&&(this.DLi=new H)}DE(I){this.xLi[l.a[I].toLowerCase()]=this.v8m++}uH(I,N){this.vLi[l.a[I].toLowerCase()]=N}FMa(I){this.wLi[l.a[I].toLowerCase()]=this.t8m++}Z2(I){this.ALi[l.a[I].toLowerCase()]=
this.y8m++}pC(I){this.ALf[l.a[I].toLowerCase()]=this.BLi++}gOk(){const I=!!this.Ov&&this.Ov.q3a,N=!!this.Ov&&this.Ov.b0c,P=!!this.Ov&&this.Ov.kkb,M=!!this.Ov&&this.Ov.yGf&&!w.a.zbc(),J=!!this.Ov&&this.Ov.aWc,V=!!this.Ov&&this.Ov.kXd,X=!!this.Ov&&this.Ov.EEf,W=!!this.Ov&&this.Ov.gXd;this.Ov&&(this.Ov.dga||this.Ov.NJd)&&this.DE(26);W&&this.DE(24);this.DE(4);this.DE(18);this.DE(16);this.DE(7);this.DE(17);this.DE(0);this.DE(1);X&&this.DE(28);J&&this.DE(23);I||this.DE(2);I&&!N||this.DE(8);this.DE(15);
P&&this.DE(20);this.DE(14);this.DE(9);this.DE(12);this.DE(10);this.DE(11);I&&this.DE(2);I&&!N&&this.DE(8);this.DE(19);V&&this.DE(27);this.DE(21);this.DE(13);M&&this.DE(22);this.DE(30)}wDn(){this.uH(21,1);this.uH(4,3);this.uH(18,3);this.uH(16,3);this.uH(7,3);this.uH(17,5);this.uH(0,5);this.uH(1,1);this.uH(28,2);this.uH(2,1);this.uH(8,2);this.uH(15,3);this.uH(14,2);this.uH(27,3);this.uH(9,1);this.uH(12,1);this.uH(10,1);this.uH(11,1);this.uH(19,1);this.uH(23,1);this.uH(13,1);this.uH(24,1);this.uH(25,
1);this.uH(20,2);this.uH(22,1);this.uH(26,1)}TNk(){this.FMa(4);this.FMa(0);this.FMa(17);this.FMa(7);this.FMa(16);this.FMa(18);this.FMa(15);this.FMa(20);this.FMa(8);this.FMa(14)}VMk(){this.Z2(14);this.Z2(10);this.Z2(12);this.Z2(9);this.Z2(11);this.Z2(20);this.Z2(15);this.Z2(8);this.Z2(2);this.Z2(1);this.Z2(27);this.Z2(7);this.Z2(18);this.Z2(16);this.Z2(17);this.Z2(0);this.Z2(4)}l5n(){this.ALf={};this.BLi=1}gam(I,N,P){this.l5n();const M=!!this.Ov&&this.Ov.q3a,J=!!this.Ov&&this.Ov.b0c,V=!!this.Ov&&this.Ov.kkb,
X=!!this.Ov&&this.Ov.yGf&&!w.a.zbc(),W=!!this.Ov&&this.Ov.aWc,U=!!this.Ov&&this.Ov.kXd,Y=!!this.Ov&&this.Ov.EEf,ca=!!this.Ov&&this.Ov.gXd,aa=!!this.Ov&&this.Ov.Rhe;I=I&&J;aa&&this.pC(25);this.pC(4);this.pC(18);this.pC(16);this.pC(7);this.pC(17);this.pC(0);this.pC(1);Y&&this.pC(28);W&&this.pC(23);M&&!J||!I||this.pC(8);N&&this.pC(15);M||this.pC(2);U&&this.pC(27);P&&this.pC(14);M&&!J||I||this.pC(8);N||this.pC(15);V&&this.pC(20);P||this.pC(14);this.pC(9);this.pC(12);this.pC(10);this.pC(11);M&&this.pC(2);
M&&!J&&this.pC(8);this.pC(19);this.pC(21);ca&&this.pC(24);this.pC(13);X&&this.pC(22);return this.ALf}DO(){return this.Ov}}Object(E.a)(L,"GroupsPlacementInfo",null,[])},1961:function(E,K,c){E=c(0);var l=c(1774),f=c(58);class a{constructor(){this.source=0;this.nm=this.zUa=this.f$=null;this.Oha=0;this.hGb=!1;this.mode=this.sTa=0;this.yLc=null;this.wJb=f.a.create()}}Object(E.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.KM=null}}Object(E.a)(k,"OutputState",
null,[]);class x{constructor(){this.Cqi=this.Whe=this.X7c=!1;this.Xb=this.X3d=this.BXf=this.ece=this.Ahg=this.MAb=this.iNa=this.SG=this.Elb=this.Vjc=this.QPo=this.rzl=this.fn=this.ddf=this.Iq=this.zu=this.sk=this.Tme=this.pLd=this.VCa=null}}Object(E.a)(x,"RuntimeState",null,[]);c.d(K,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(E.a)(y,"MergeState",null,[])},1962:function(E,K,c){c.r(K);E=c(0);var l=c(602),f=
c(223),a=c(168),k=c(110),x=c(1628),y=c(1721),n=c(1754),u=c(6),z=c(1952);class w{constructor(P,M){this.start=P;this.end=M}}Object(E.a)(w,"MergeDiffIdx",null,[]);class F{constructor(P,M,J,V=!1,X=null,W=null,U=!0){this.lhd=this.khd=this.URg=this.exc=0;this.p_b=this.ute=null;this.T$a=X||new z.a;this.Mg=J;this.ura=P.k5();this.hnk=M.k5();this.LP=new w(0,0);this.dT=new w(0,0);this.nDe=V;this.quc=U;this.Yra=W;this.dQk();this.Fjo()}get EK(){return this.ura}get ZJ(){return this.hnk}get vz(){return this.exc}get lA(){return this.URg}get Tua(){return this.khd}get Nma(){return this.lhd}get yml(){const P=
new f.a;for(let M=this.ute.start;M<this.ute.end;M++)P.add(this.EK.eg(M));return P}get zef(){const P=new f.a;for(let M=this.p_b.start;M<this.p_b.end;M++)P.add(this.ZJ.eg(M));return P}Kff(P){if(this.lA<P.lA){if(this.lA+this.Tua>P.lA)return!0}else if(this.lA>P.lA){if(P.lA+P.Tua>this.lA)return!0}else if(2===this.vz&&3===P.vz||3===this.vz&&2===P.vz||2===this.vz&&2===P.vz||3===this.vz&&3===P.vz)return!0;return!1}Fbj(P,M,J,V){P.lG(M);P.RC(M,J);return V+=J.length-1}Otj(P,M,J,V,X){let W=this.EK.eg(P),U=this.ZJ.eg(M);
if(!W||!U||!W.f7a&&!U.f7a)return{returnValue:!1,sCa:V,DIa:X};let Y=new f.a,ca=new f.a;W.f7a&&(Y=W.S8c(),W=Y.eg(J?0:Y.length-1));U.f7a&&(ca=U.S8c(),U=ca.eg(J?0:ca.length-1));if(!W.BA(U,this.T$a,this.Yra,this.nDe,this.quc))return{returnValue:!1,sCa:V,DIa:X};Y.length&&(V=this.Fbj(this.EK,P,Y,V));ca.length&&(X=this.Fbj(this.ZJ,M,ca,X));return{returnValue:!0,sCa:V,DIa:X}}XBl(P,M,J,V,X,W){for(;X<=J&&W<=V;){const U=P.eg(X),Y=M.eg(W);if(!U.BA(Y,this.T$a,this.Yra,this.nDe,this.quc))break;this.LP.start+=U.length;
this.dT.start+=Y.length;X++;W++}return{N2e:X,Qlg:W}}VBl(P,M,J,V,X,W){for(;X>=J&&W>=V;){const U=P.eg(X),Y=M.eg(W);if(!U.BA(Y,this.T$a,this.Yra,this.nDe,this.quc))return{returnValue:!0,sCa:X,DIa:W};X--;W--}return{returnValue:!1,sCa:X,DIa:W}}WBl(P,M,J,V){let X=!1;do({N2e:P,Qlg:M}=this.XBl(this.EK,this.ZJ,J,V,P,M)),{sCa:J,DIa:V,returnValue:X}=this.Otj(P,M,!0,J,V);while(X);return{N2e:P,Qlg:M,sCa:J,DIa:V}}UBl(P,M,J,V){let X=!1;do{if(!({sCa:J,DIa:V}=this.VBl(this.EK,this.ZJ,P,M,J,V)).returnValue)break;({sCa:J,
DIa:V,returnValue:X}=this.Otj(J,V,!1,J,V))}while(X);return{sCa:J,DIa:V}}dQk(){var P=0,M=0,J=this.EK.length-1,V=this.ZJ.length-1;0<=J&&this.EK.eg(J);0<=V&&this.ZJ.eg(V);({N2e:P,Qlg:M,sCa:J,DIa:V}=this.WBl(P,M,J,V));if(P<J||M<V)({sCa:J,DIa:V}=this.UBl(P,M,J,V));J++;V++;this.ute=new w(P,J);this.p_b=new w(M,V);this.LP.end=this.LP.start;this.dT.end=this.dT.start;for(var X=P;X<J;X++){var W=this.EK.eg(X);this.LP.end+=W.length}for(X=M;X<V;X++)W=this.ZJ.eg(X),this.dT.end+=W.length;a.a.instance.Ta(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",P,J,M,V);a.a.instance.Ta(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.LP.start,this.LP.end,this.dT.start,this.dT.end);this.LP.start<=this.LP.end&&this.dT.start<=this.dT.end&&(P=this.EK.eg(P),M=this.ZJ.eg(M),X=this.EK.eg(J),W=this.ZJ.eg(V),J=this.EK.eg(J-1),V=this.ZJ.eg(V-1),a.a.instance.Ta(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",P,X,M,W,J,V))}Fjo(){this.URg=this.LP.start;this.khd=this.lhd=0;this.LP.start===this.LP.end&&this.dT.start===this.dT.end?this.exc=0:this.LP.start===this.LP.end&&this.dT.start<this.dT.end?(this.exc=1,this.lhd=this.dT.end-this.dT.start):this.dT.start===this.dT.end&&this.LP.start<this.LP.end?(this.exc=2,this.khd=this.LP.end-this.LP.start):(this.exc=
3,this.khd=this.LP.end-this.LP.start,this.lhd=this.dT.end-this.dT.start);a.a.instance.Ta(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.vz,this.lA,this.Tua,this.Nma)}aNm(P,M){return P.s4()&&M.s4()?P.runId===M.runId&&P.yg===M.yg:!1}hSm(P){if(!P.s4()||"\ufffc"!==P.text)return!1;P=P.tDb;return P?P.hasProperty(u.a.Xj)||P.hasProperty(u.a.yBd)||P.hasProperty(u.a.mgf)||P.hasProperty(u.a.K3)||P.hasProperty(u.a.imageType)||P.hasProperty(u.a.tQa)||
P.hasProperty(u.a.VHb)||P.hasProperty(u.a.gt)&&(P=this.Mg.getPropertyInt32(P,u.a.gt))&&(36===P||35===P||24===P||23===P||33===P||34===P||44===P||45===P||42===P||43===P)?!0:!1:!1}GUc(P){return P.s4()&&!this.hSm(P)}JRk(){if(2===this.vz)return!1;var P=this.p_b.start;if(!P)return!1;let M=null;for(var J=this.p_b.start;J<this.p_b.end;J++){const V=this.ZJ.eg(J);if(this.GUc(V)){M=V;break}}if(!M)return!1;--P;for(J=this.ZJ.eg(P);J&&!this.GUc(J);)P--,J=this.ZJ.eg(P);return J&&this.aNm(J,M)?!0:!1}e9h(P){const M=
new f.a;for(let J=0;J<P.length;J++)P.J(J).f7a?M.RC(M.length,P.J(J).S8c()):M.insert(M.length,P.J(J));return M}cNm(){if(3!==this.vz||this.Tua!==this.Nma)return!1;const P=this.e9h(this.yml),M=this.e9h(this.zef);if(P.length!==M.length)return!1;for(let J=0;J<P.length;J++)if(!P.J(J).BA(M.J(J),this.T$a,this.Yra,!0,this.quc))return!1;return!0}bNm(){if(0!==this.vz&&3!==this.vz||this.EK.length!==this.ZJ.length)return!1;let P=!1;for(let M=0;M<this.EK.length;M++){if(!this.EK.J(M).BA(this.ZJ.J(M),this.T$a,this.Yra,
!0,this.quc))return!1;if(3===this.EK.J(M).type||1===this.EK.J(M).type){const J=this.EK.J(M),V=this.ZJ.J(M);P=J.runId!==V.runId||J.yg!==V.yg||P}}return P}}Object(E.a)(F,"MergeBlockDiff",null,[]);var G=c(1582);class H{constructor(P,M){this.id=P;this.index=M}}Object(E.a)(H,"ParagraphStartIndex",null,[]);var L=c(1642),I=c(1564);c.d(K,"ParagraphMerge",function(){return N});class N{constructor(P,M,J,V,X,W,U){this.nYb=this.gwb=this.Uo=this.px=null;this.Ah=!1;this.sjh=this.nUg=this.dMg=this.rta=this.hKa=
this.ura=null;this.Yd=P;this.EF=M;this.MBa=V;this.sAa=J;this.Xra=X;this.Yra=W;this.Mg=U}Eei(P){const M=new l.a;P.EK.forEach(J=>{2===J.type&&M.add(J.Hj);return!0});P.ZJ.forEach(J=>{2===J.type&&M.remove(J.Hj);return!0});return M}abi(P){const M=new f.a;P.ZJ.forEach(J=>{2===J.type&&M.add(J.Hj);return!0});return M}GGh(P){const M=new f.a;let J=0,V=0;P.ZJ.forEach(X=>{2===X.type&&(M.add(new H(X.Hj,J<P.lA?J:J<P.lA+P.Nma?P.lA:J-P.Nma+P.Tua)),J=V);V+=X.length;return!0});return M}C2k(P,M){var J=this.GGh(P);const V=
this.GGh(M);P=this.Eei(P);const X=this.Eei(M);M=new f.a;const W=new l.a;let U=0;for(let Y=0;Y<J.length;Y++){const ca=J.J(Y);if(U<V.length){let aa=V.J(U);for(;U<V.length&&aa.index<=ca.index;){if(aa.id.equals(ca.id)){U++;break}P.contains(aa.id)||W.contains(aa.id)||(M.add(aa.id),W.add(aa.id));U++;aa=V.J(U)}}X.contains(ca.id)||(M.add(ca.id),W.add(ca.id))}for(;U<V.length;)J=V.J(U),P.contains(J.id)||W.contains(J.id)||(M.add(J.id),W.add(J.id)),U++;return M}initialize(){if(this.Ah){const P=!!this.px&&!!this.Uo;
this.Yd.logger.Og(Object.assign(new G.a,{qj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return P}this.Ah=!0;if(!({EK:this.ura,xLc:this.hKa,wad:this.rta,jBd:this.dMg,qLd:this.nUg,Ume:this.sjh}=I.a.yLh(this.Yd,this.Mg,this.EF,this.sAa,this.MBa,this.Xra,!1,!1)).returnValue)return!1;this.px=new F(this.ura,this.hKa,this.Mg,void 0,void 0,this.Yra);this.Uo=new F(this.ura,this.rta,this.Mg,void 0,void 0,this.Yra);a.a.instance.Ta(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.px.Tua,this.px.Nma,this.Uo.Tua,this.Uo.Nma));return!0}rIa(){a.a.instance.Ta(593826836,1,4,"Attempting to merge with LCS");let P=!1;const M=new n.a(this.Mg,this.Yd);let J=null,V=null;var X=null;const W=Y=>this.Yd.runtime.sk.J(Y),U=Y=>this.Yd.runtime.Iq.J(Y)||this.Yd.runtime.sk.J(Y);this.px=new F(this.ura,this.hKa,this.Mg,void 0,void 0,this.Yra,!1);this.Uo=new F(this.ura,this.rta,this.Mg,void 0,void 0,this.Yra,!1);({updateHints:J}=M.aNh(this.EF,W,this.sAa,Y=>this.Yd.runtime.zu.J(Y)||this.Yd.runtime.sk.J(Y),
this.px.lA,this.px.lA+this.px.Tua,this.px.lA+this.px.Nma)).returnValue&&({updateHints:V}=M.aNh(this.EF,W,this.MBa,U,this.Uo.lA,this.Uo.lA+this.Uo.Tua,this.Uo.lA+this.Uo.Nma)).returnValue&&(P=!0);P||(a.a.instance.Ta(593826835,1,2,"Failed to create update hints with LCS"),P=!1);P&&(X=new L.a(this.Yd,this.EF,this.sAa,this.MBa,Y=>this.Yd.runtime.Xb?this.Yd.runtime.Xb.isFeatureEnabled(Y):!1,this.Mg,null,J,V),({fn:X}=X.Rlc()).returnValue||(a.a.instance.Ta(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.Yd.logger.Og(Object.assign(new G.a,{qj:"TryLCSMerge",eventId:"9zrqs"})),P=!1));a.a.instance.Ta(593826833,1,P?4:2,"TryLCSMerge: [Success: {0}]",P);return{returnValue:P,fn:X}}Rlc(){let P;P=null;if(!this.initialize())return this.Yd.logger.EU("ParagraphMerge Initialize"),this.S3a(),{returnValue:!1,fn:P};this.Yd.logger.EU("ParagraphMerge Initialize");let M;this.Yd.logger.Kge(2);let J=({rIa:M}=this.kpl()).returnValue;J=J&&({fn:P,rIa:M}=this.COc(this.Yd,this.Mg,this.Xra,this.nYb,this.gwb)).returnValue;
this.Yd.logger.Qag();if(!J){this.Yd.logger.EU("ParagraphMerge DoMergeInteral");if(M){this.Yd.logger.Kge(3);({fn:P,returnValue:J}=this.rIa());this.Yd.logger.Qag();if(J)return{returnValue:!0,fn:P};this.S3a();return{returnValue:!1,fn:P}}this.S3a();return{returnValue:!1,fn:P}}if(!({fn:P,rIa:M}=this.COc(this.Yd,this.Mg,this.Xra,this.nYb,this.gwb)).returnValue)return this.Yd.logger.EU("ParagraphMerge DoMergeInteral"),this.S3a(),{returnValue:!1,fn:P};this.Yd.logger.EU("ParagraphMerge DoMergeInteral");return{returnValue:!0,
fn:P}}COc(){let P;if(!({B9d:P}=I.a.COc(this.Yd,this.Mg,this.Xra,this.nYb,this.gwb)).returnValue)return this.Yd.logger.EU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.S3a(),{returnValue:!1,fn:P,rIa:!0};this.Yd.logger.EU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,fn:P,rIa:!1}}S3a(P=!1){a.a.instance.sja(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+P+"] BaseRevisionMergeBlocksList: {0}",this.dMg);a.a.instance.sja(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.nUg);a.a.instance.sja(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.sjh);P=new f.a;I.a.Wcc(this.Mg,"BaseObjects_",this.EF,P);I.a.Wcc(this.Mg,"FavoredObjects_",this.sAa,P);I.a.Wcc(this.Mg,"ConflictObjects_",this.MBa,P);I.a.V1m(this.Yd,P)}Gzh(P){let M,J;J=M=0;if(0===this.px.vz)M=this.Uo.lA;else if(1===this.px.vz)M=this.Uo.lA<this.px.lA?this.Uo.lA:this.Uo.lA===this.px.lA?P||1!==this.Uo.vz?this.Uo.lA+this.px.Nma:this.Uo.lA:this.Uo.lA+this.px.Nma;else if(2===this.px.vz||3===this.px.vz)M=
this.Uo.lA<=this.px.lA?this.Uo.lA:this.Uo.lA+(this.px.Nma-this.px.Tua);if(2===this.Uo.vz||3===this.Uo.vz)J=M+this.Uo.Tua;return{dki:M,Xjm:J}}MZh(P,M){let J;J=0;if(!M)return{returnValue:!0,LZc:J};let V=0,X=0;for(;V<P.length;){let W;for(let U=V;U<P.length;U++){V=U;W=P.J(U);const Y=W.length;X+=Y;if(!(X<M)){if(X>M)if(W.f7a)P.lG(V),P.RC(V,W.S8c()),X-=Y;else return a.a.instance.Ta(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
M),this.Yd.logger.Og(Object.assign(new G.a,{qj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,LZc:J};break}}if(X===M)return V++,J=V,{returnValue:!0,LZc:J}}a.a.instance.Ta(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",M);this.Yd.logger.Og(Object.assign(new G.a,{qj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,LZc:J}}dFk(P,M,J){let V=0;var X=0,W=!1;const U=this.Uo.zef.k5();
if(this.Uo.JRk())for(--M;0<=M;M--){let Y=P.J(M);if(this.Uo.GUc(Y)){X=P.J(M);V=X.runId;X=X.yg;W=!0;break}}W||((X=P.J(J))&&this.Uo.GUc(X)?(V=X.runId,X=X.yg):X=V=0);for(P=0;P<U.length;P++)J=U.J(P),J.s4()&&(W=J,this.Uo.GUc(J)?(W.runId=V,W.yg=X):(W.runId=0,W.yg=0));return U}azi(P){if(2===P.length){const M=1===P.J(0).type?P.J(0):null;P=2===P.J(1).type;if(M&&P&&""===M.text)return!0}return!1}kpl(){const P=this.px.bNm();if(!P&&0===this.px.vz)return this.nYb=this.Uo.ZJ.k5(),this.gwb=this.abi(this.Uo),{returnValue:!0,
rIa:!1};if(0===this.Uo.vz)return this.nYb=this.px.ZJ.k5(),this.gwb=this.abi(this.px),{returnValue:!0,rIa:!1};(this.azi(this.px.ZJ)||this.azi(this.Uo.ZJ))&&this.Yd.logger.yIi(Object.assign(new G.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!P){var M=this.px.Kff(this.Uo);M&&this.Xra(55)&&(a.a.instance.Ta(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.px=new F(this.ura,this.hKa,this.Mg,!0,void 0,this.Yra),this.Uo=
new F(this.ura,this.rta,this.Mg,!0,void 0,this.Yra),M=this.px.Kff(this.Uo));if(M)return a.a.instance.Ta(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Yd.logger.Og(Object.assign(new y.a,{qj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,rIa:!0}}var J;M=0;this.gwb=this.C2k(this.px,this.Uo);({dki:J,Xjm:X}=this.Gzh(!1));const V=this.px.ZJ.k5();if(!({LZc:J}=this.MZh(V,J)).returnValue||(2===this.Uo.vz||3===this.Uo.vz)&&!({LZc:M}=
this.MZh(V,X)).returnValue)return{returnValue:!1,rIa:!1};if(2===this.Uo.vz||3===this.Uo.vz){this.zic(V,M);this.zic(V,J-1);var X=null;for(var W=M-1;W>=J;W--)2===V.J(W).type&&(X=V.J(W)),V.lG(W);0<V.length&&(W=V.J(V.length-1),2!==W.type&&4!==W.type&&X&&(this.Yd.runtime.Xb.uz(76),this.Yd.runtime.Xb.isFeatureEnabled(76)&&(V.add(X),this.gwb.add(X.Hj))));a.a.instance.Ta(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",M-J-1,J)}if(1===this.Uo.vz||3===this.Uo.vz)X=this.Uo.zef,
P&&(X=this.dFk(V,J,M)),this.zic(V,J-1),this.zic(V,J),this.zic(X,0),this.zic(X,X.length-1),V.RC(J,X),a.a.instance.Ta(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",J,P,X.dr());this.nYb=V;return{returnValue:!0,rIa:!1}}zic(P,M){0>M||M>=P.length||(P=P.J(M),Object(k.a)(x.a,P)&&(P.lQa=!0))}Gad(P,M){let J;J=M;if(!this.initialize())return{returnValue:!1,R5a:P,Ypa:J};if(this.Uo.Kff(this.px))return this.S3a(!0),this.Yd.logger.Og(Object.assign(new y.a,
{qj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,R5a:P,Ypa:J};if(0===this.Uo.vz||3===this.Uo.vz&&this.Uo.cNm())return{returnValue:!0,R5a:P,Ypa:M};let V;({dki:V}=this.Gzh(!0));M<V||M===V&&(1!==this.Uo.vz||1===this.Uo.vz&&1===this.px.vz&&M===this.px.lA+this.px.Nma)?J=M:(J=M+this.Uo.Nma-this.Uo.Tua,J<V&&(J=V));return{returnValue:!0,R5a:P,Ypa:J}}}Object(E.a)(N,"ParagraphMerge",null,[967])},1963:function(E,K,c){c.r(K);E=c(0);var l=c(1649),f=c(1561),a=c(1524),k=c(1776),x=c(1560);class y{constructor(L=
"",I="",N="",P=-99999,M=-1,J=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=I?I:"";this.Type=N?N:"";this.Score=P;this.Age=M;this.Count=J}}Object(E.a)(y,"Suggestion",null,[]);class n{constructor(L,I){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=I}}Object(E.a)(n,"SuggestionGroup",null,[]);class u{}u.help="help";u.answer="answer";u.commands="commands";u.qeo="servicecommands";u.template="template";Object(E.a)(u,
"SuggestionGroupType",null,[]);var z=c(1494),w=c(1493),F=c(2),G=c(35);c.d(K,"InteractionLogger",function(){return H});class H{constructor(L,I,N){this.Vye=0;this.hUe=this.hwc=null;this.ye=L;this.lSe=this.iwe=this.NDe=!1;this.f_j=I;this.Yf=F.AFrameworkApplication.Ne;this.fc=N;this.Cgd=this.VMe=0}get Rpa(){return this.ye.Rpa}Uge(L){this.ye.Uge(L)}SJi(){if(this.hwc){var L=0;for(const I of this.hwc)this.ye.M5m(I,L++);this.hwc=null}}beginQuery(L,I,N){this.ye.B5m(L,I,N)}cmb(L,I){this.ye.iJk(L,I);this.NDe=
!0;this.lSe=!1}uxa(){this.NDe=!1;this.iwe||(this.SJi(),this.ye.qVh(this.Vye))}C5m(L,I){this.ye.D5m(L,I)}qln(L,I,N,P,M){for(const J of this.f_j)if(L.startsWith(J)){this.lSe=!0;break}this.ye.d1m(L,I,N,P,M)}Xln(L){this.iwe=!1;this.Vye=L;this.NDe||this.lSe||(this.SJi(),this.ye.qVh(this.Vye,!1))}Wln(L,I){this.ye.j1m(L,I);this.iwe=!0}nmf(L,I){if(!L.count)return"";let N="";const P=Date.now();for(let M of L)L=(P-M.timeStamp)/1E3,L=w.a.ime(L),0<N.length&&(N+=";"),N+=I?M.commandId:M.controlId,N+=":",N+=L.toString();
return N}F4a(){var L=this.nmf(l.a.instance.uNc(),!1);0<L.length&&this.ye.b1m(L);L=this.nmf(l.a.instance.Wgb(),!0);0<L.length&&this.ye.u0m(L);L=this.nmf(l.a.instance.Ysc,!0);0<L.length&&this.ye.i2m(L);L=z.TellMeActor.instance.S6g;0<L.length&&this.ye.z5m(G.c(L))}g6m(L){this.ye.J0m(L)}v0(L,I,N,P,M,J,V,X=null){this.ye.u3m(L,I,N,P,M,J,V,X)}AKf(L,I,N,P){this.ye.AKf(L,I,N,P)}JA(L,I,N=null){this.ye.EG(L,I,N)}onError(L,I,N=null){this.ye.MFa(L,I,N)}Rio(L){this.hwc=L}ndm(L){const I=[];if(!L)return I;for(let N=
0;N<L.length;N++){const P=a.a[L[N].groupType].toLowerCase(),M=[],J=L[N].results;if(J){for(let V=0;V<J.length;V++)"findindocument"===P?Array.add(M,new y("","",P,J[V].score,J[V].Szd,J[V].count)):Array.add(M,new y(J[V].label,J[V].description,P,J[V].score,J[V].Szd,J[V].count));"answer"===P||"definition"===P||"wolframanswer"===P||"entity"===P?Array.add(I,new n(M,u.answer)):"classifier"===P||"appsforoffice"===P?Array.add(I,new n(M,u.commands)):"serviceclassifier"===P?Array.add(I,new n(M,u.qeo)):"assistance"===
P?Array.add(I,new n(M,u.help)):("document"===P||"people"===P||"findindocument"===P||"notes"===P||"image"===P||"template"===P)&&Array.add(I,new n(M,P))}}return I}juf(L,I){const N={};N.Query=I;N.SuggestionGroups=G.c(this.ndm(L));return G.c(N)}xhi(L){const I={"Content-Type":"application/json",Accept:"application/json"};I["X-Office-Version"]=F.AFrameworkApplication.buildVersion;I["X-Office-Application"]=F.AFrameworkApplication.K.jb("Application");I["X-Office-Platform"]="WAC";I["X-TellMe-SqmUserId"]=F.AFrameworkApplication.K.jb("LoggableUserId")||
"";I["X-TellMe-SessionId"]=this.ye.Rpa.noa;I["X-TellMe-SuggestionTypes"]="Ranker";I["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;I["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;I["X-TellMe-Flights"]=L;I["X-TellMe-PartialQueryIndex"]=this.VMe;return I}JKb(L,I,N){this.v0(I.length,"RankerLogging",L.data.Qe.toString(),Math.round(window.performance.now()-N),x.a.Mxj,!0,f.a.zPa)}qKb(L,I,N){this.v0(I.length,"RankerLogging",L.data.Qe.toString(),Math.round(window.performance.now()-
N),x.a.Mxj,!1,f.a.zPa)}yhi(){this.hUe||(this.hUe=new k.a(this.fc,null,6E3));return this.hUe.r$}DKf(L){const I=this.juf(this.hwc,L),N=this.xhi("RankerLogging"),P=window.performance.now();this.Yf.tj(this.yhi(),2,I,N,!1,0,M=>{this.JKb(M,L,P)},M=>{this.qKb(M,L,P)},null,null,!1,4E3,6E3);this.VMe++}b5n(){this.VMe=0}Z$f(L){this.Cgd=L}}Object(E.a)(H,"InteractionLogger",null,[])},1965:function(E,K,c){c.r(K);E=c(0);var l=c(15),f=c(6),a=c(168),k=c(223),x=c(58),y=c(1713),n=c(1627),u=c(1580),z=c(1564);class w{constructor(L,
I,N=null){this.author=L;this.ZYc=I;this.s_f=N||x.a.nil}BA(L){return L?this.author===L.author&&this.ZYc===L.ZYc&&this.s_f===L.s_f:!1}}Object(E.a)(w,"RunMergeBlockTrackedChangeAttribute",null,[]);class F{constructor(L,I,N){this.insertion=L||F.Ygf;this.deletion=I||F.Ygf;this.GGa=N||F.Ygf}get Hpm(){return 0<this.insertion.author.length}get kpm(){return 0<this.deletion.author.length}get kqm(){return 0<this.GGa.author.length}BA(L){return L?this.insertion.BA(L.insertion)&&this.deletion.BA(L.deletion)&&this.GGa.BA(L.GGa):
!1}}F.Ygf=new w("",0);Object(E.a)(F,"RunMergeBlockTrackedChangeInfo",null,[]);var G=c(1773);c.d(K,"ParagraphMergeBlockCreator",function(){return H});class H extends n.a{constructor(L,I,N,P,M,J,V){super();this.maxValue=Number.MAX_VALUE;this.fB=new y.a;this.QSb=null;this.QN=0;this.i0g=!1;this.dxc="";this.nse=L;this.Js=I;this.qu=N;this.Jjk=P;this.hjd=M;this.s_g=J;this.Mg=V;if(this.Mg.hasProperty(this.Js,l.a.mo))if(this.Mg.hasProperty(this.Js,f.a.Lc))if(this.Mg.hasProperty(this.Js,f.a.jq))if(this.Mg.hasProperty(this.Js,
f.a.$s))if(this.Mg.hasProperty(this.Js,l.a.Hn))if(this.B2=this.Mg.getPropertyString(this.Js,l.a.mo),this.lXe=this.Mg.getPropertyUint32(this.Js,f.a.Lc),this.$r=this.Mg.getPropertyUint32s(this.Js,f.a.jq),this.yqd=this.Mg.getPropertyUint32s(this.Js,f.a.$s),this.YAe=this.Mg.getPropertyObjectIds(this.Js,l.a.Hn),this.B2||""===this.B2)if(this.B2.length||1!==this.YAe.length||(this.$r.length||(this.$r.add(0),a.a.instance.Ta(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.yqd.length||(this.yqd.add(0),a.a.instance.Ta(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.fbk=this.HNd(this.Js,f.a.GQf,this.$r.length),this.Oyc=this.HNd(this.Js,l.a.mxa,this.$r.length),this.nla=this.HNd(this.Js,l.a.$ob,this.$r.length),this.yka=this.HNd(this.Js,f.a.jPa,this.$r.length),this.Xka=this.Fgm(this.Js,f.a.IGa,this.$r.length),this.fxm(),L=this.Mg.hasProperty(this.Js,l.a.zm)?this.Mg.getPropertyUint32s(this.Js,l.a.zm):new k.a,this.ntd=
z.a.pmj(L,this.B2.length),this.$r.length!==this.yqd.length)a.a.instance.Ta(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",I.id);else if(this.$r.length!==this.YAe.length)a.a.instance.Ta(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",I.id);else{this.s_g&&(this.Mg.hasProperty(this.Js,f.a.Cv)?this.QSb=this.Mg.getPropertyObjectIds(this.Js,f.a.Cv):(a.a.instance.Ta(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
I.id),this.QSb=this.l_(this.$r.length,x.a.nil)),this.$r.length!==this.QSb.length&&(a.a.instance.Ta(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",I.id,this.$r.length,this.QSb.length),this.QSb=this.l_(this.$r.length,x.a.nil)));if(this.$r.length!==this.Oyc.length||this.$r.length!==this.nla.length||this.$r.length!==this.yka.length||this.$r.length!==this.Xka.length)this.$r.length===this.Oyc.length||this.hjd||a.a.instance.Ta(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",I.id,this.$r.length,this.Oyc.length),this.$r.length===this.nla.length||this.hjd||a.a.instance.Ta(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",I.id,this.$r.length,this.nla.length),this.$r.length===this.yka.length||this.hjd||a.a.instance.Ta(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",I.id,this.$r.length,this.yka.length),this.$r.length===this.Xka.length||this.hjd||a.a.instance.Ta(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",I.id,this.$r.length,this.Xka.length),L=this.Mg.getPropertyBool(this.Js,l.a.q9e),a.a.instance.Ta(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",I.id,M,null==L?!1:L),this.Oyc=this.l_(this.$r.length,!0),this.nla=this.l_(this.$r.length,!1),this.yka=this.l_(this.$r.length,!1),this.Xka=this.l_(this.$r.length,0),this.Mg.setPropertyBool(this.Js,l.a.q9e,!1);this.fB.w0o(this.$r.length)?(this.ntd.length!==this.$r.length+1&&a.a.instance.Ta(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
I.id,this.$r.length,this.ntd.length),this.j9j=!0):a.a.instance.Ta(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",I.id)}else a.a.instance.Ta(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",I.id)}fxm(){this.Mg.hasProperty(this.Js,f.a.ZEa)?this.fB.ajb=this.Mg.getPropertyBools(this.Js,f.a.ZEa):this.fB.ajb=this.l_(this.$r.length,!1);this.Mg.hasProperty(this.Js,f.a.Yfa)?this.fB.xfb=this.Mg.getPropertyBools(this.Js,f.a.Yfa):
this.fB.xfb=this.l_(this.$r.length,!1);this.Mg.hasProperty(this.Js,f.a.$Ea)?this.fB.$ib=this.Mg.getPropertyStrings(this.Js,f.a.$Ea):this.fB.$ib=this.l_(this.$r.length,"");this.Mg.hasProperty(this.Js,f.a.wDa)?this.fB.wfb=this.Mg.getPropertyStrings(this.Js,f.a.wDa):this.fB.wfb=this.l_(this.$r.length,"");this.Mg.hasProperty(this.Js,f.a.aFa)?this.fB.bjb=this.Mg.getPropertyListOfMilliseconds(this.Js,f.a.aFa):this.fB.bjb=this.l_(this.$r.length,0);this.Mg.hasProperty(this.Js,f.a.xDa)?this.fB.I_a=this.Mg.getPropertyListOfMilliseconds(this.Js,
f.a.xDa):this.fB.I_a=this.l_(this.$r.length,0);this.Mg.hasProperty(this.Js,f.a.HGa)?this.fB.d5a=this.Mg.getPropertyBools(this.Js,f.a.HGa):this.fB.d5a=this.l_(this.$r.length,!1);this.Mg.hasProperty(this.Js,f.a.nIa)?this.fB.Zmb=this.Mg.getPropertyStrings(this.Js,f.a.nIa):this.fB.Zmb=this.l_(this.$r.length,"");this.Mg.hasProperty(this.Js,f.a.oIa)?this.fB.anb=this.Mg.getPropertyListOfMilliseconds(this.Js,f.a.oIa):this.fB.anb=this.l_(this.$r.length,0);this.Mg.hasProperty(this.Js,f.a.Zya)?this.fB.$mb=this.Mg.getPropertyObjectIds(this.Js,
f.a.Zya):this.fB.$mb=this.l_(this.$r.length,x.a.nil)}HNd(L,I,N){return this.Mg.hasProperty(L,I)?this.Mg.getPropertyBools(L,I):this.l_(N,!1)}Fgm(L,I,N){return this.Mg.hasProperty(L,I)?this.Mg.getPropertyUint32s(L,I):this.l_(N,0)}l_(L,I){const N=new k.a;for(let P=0;P<L;P++)N.add(I);return N}Vem(L){const I=this.ntd.eg(L);L=this.ntd.eg(L+1);return this.B2.substring(I,L)}pbi(){if(this.i0g)return null;var L=this.QN<this.$r.length?this.$r.eg(this.QN):this.maxValue;if(L===this.maxValue||this.Jjk&&!this.B2.length)return this.i0g=
!0,L=new u.a(this.qu,this.Js.id,this.lXe),this.dxc=this.M0e(this.dxc,L.toString()),L;const I=this.yqd.eg(this.QN),N=this.YAe.eg(this.QN),P=this.fbk.eg(this.QN),M=this.Oyc.eg(this.QN),J=this.nla.eg(this.QN),V=this.yka.eg(this.QN),X=this.Xka.eg(this.QN),W=this.s_g?this.QSb.eg(this.QN):null;var U=null;this.fB.ajb.eg(this.QN)&&(U=new w(this.fB.$ib.eg(this.QN)||"",this.fB.bjb.eg(this.QN)));var Y=null;this.fB.xfb.eg(this.QN)&&(Y=new w(this.fB.wfb.eg(this.QN)||"",this.fB.I_a.eg(this.QN)));var ca=null;this.fB.d5a.eg(this.QN)&&
(ca=new w(this.fB.Zmb.eg(this.QN)||"",this.fB.anb.eg(this.QN),this.fB.$mb.eg(this.QN)));U=new F(U,Y,ca);Y=this.Vem(this.QN);this.QN++;ca=Y.startsWith("\ufddfHYPERLINK ");L=new G.a(this.nse,this.qu,this.Js.id,I,L,N,Y,P,!ca,M,J,V,X,U,W);this.dxc=this.M0e(this.dxc,L.toString());return L}Zai(){let L;L=null;var I="";if(!this.j9j)return{FMf:L,h4a:I};if(I=this.pbi())L=new k.a,L.add(I);for(;I=this.pbi();)L.add(I);I=this.dxc;return{FMf:L,h4a:I}}}Object(E.a)(H,"ParagraphMergeBlockCreator",n.a,[])},1968:function(E,
K,c){c.r(K);E=c(0);var l=c(223),f=c(1627),a=c(1579);class k extends a.a{constructor(y,n){super(4,y,n)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Hj)}W6b(){return"Table"}clone(){return new k(this.source,this.Hj)}BA(y,n,u,z=!1){return super.BA(y,n,u,z)?this.Hj.equals(y.Hj):!1}get length(){return 1}}Object(E.a)(k,"TableMergeBlock",a.a,[]);c.d(K,"TableMergeBlockCreator",function(){return x});class x extends f.a{constructor(y,n){super();this.nMg=new k(n,y.id)}Zai(){let y;
y=new l.a;y.add(this.nMg);return{FMf:y,h4a:this.M0e("",this.nMg.toString())}}}Object(E.a)(x,"TableMergeBlockCreator",f.a,[])},2052:function(E,K,c){c.r(K);var l=c(2),f=c(0),a=c(55),k=c(174);class x extends k.a{constructor(S){super(!1,!1,!0);this.udd=S}start(){const S={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.udd.kyf}};this.Yh("",Object(a.a)(this,this.C7f,"resultHandler"),S)}C7f(S,Ba){1===S&&(this.udd.kyf=Ba.tooltipPersistenceEnabled)}}Object(f.a)(x,
"AccessibilitySettingsDialog",k.a,[]);var y=c(67),n=c(13);class u{constructor(S,Ba){this.ga=S;this.udd=Ba}Tb(){this.ga.qa(n.a.Xto,y.a.frame,Object(a.a)(this,this.Yto,"showAccessibilitySettingsDialogHandler"))}Yto(){(new x(this.udd)).start();return 32}}Object(f.a)(u,"AccessibilitySettingsDialogActor",null,[1147]);var z=c(458);const w=S=>{const Ba=new z.a;l.AFrameworkApplication.Ne.tj(F(S),1,null,null,!0,2,ib=>{200===ib.data.Qe?Ba.zg("true"===ib.data.we.toLowerCase()):Ba.zg(!1)},()=>{Ba.zg(!1)},null,
void 0,void 0,void 0,void 0,"7");return Ba.task},F=S=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",S,l.AFrameworkApplication.hm);var G=c(127);class H{constructor(){this.qVb=null}get kyf(){return!!this.qVb}set kyf(S){S!==this.qVb&&(this.qVb=S,G.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(S),this.AAi()&&l.AFrameworkApplication.Ne.tj(F("saveHoverableRibbonTooltipIsEnabled"),
2,S.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}q_m(){const S=new z.a;if(this.qVb)S.zg(this.qVb);else if(this.AAi()){const Ba=w("getHoverableRibbonTooltipIsEnabled");Ba.continueWith(()=>{this.qVb=Ba.result;G.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Ba.result);S.zg(Ba.result)},8)}else S.zg(!1)}AAi(){const S=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),Ba=l.AFrameworkApplication.K.$("IsAnonymousUser");return S&&
!Ba}}Object(f.a)(H,"AccessibilitySettingsInfo",null,[1146]);var L=c(179),I=c(34);class N{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}xc(S){this.W=S;this.W.register(H,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Rd(()=>new H).singleInstance();this.W.register(u,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Rd(()=>
new u(l.AFrameworkApplication.va,this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const S=this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Ba=this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");S&&Ba?(Ba.Tb(),S.q_m()):I.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){L.a.instance.Fc(new N)}}
Object(f.a)(N,"AccessibilitySettingsPackage",null,[1,2]);var P=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},M=c(80);class J extends Sys.EventArgs{constructor(S,Ba){super();this.rle=S;this.actualValue=Ba}}Object(f.a)(J,"CpuMeterMonitorThresholdExceededEventArgs",
Sys.EventArgs,[]);class V{constructor(){this.nTb=[];this.ZPg=this.xwe=0;this.si=null;this.ra=new M.a}init(S,Ba,ib){this.si=S;this.xwe=Ba;this.ZPg=ib;this.si.XZe(Object(a.a)(this,this.j6d,"onCpuMeterFrameAvailable"));this.Qwk(Object(a.a)(this,this.I7k,"cpuPercentThresholdExceeded"))}j6d(S,Ba){Ba.RPi&&(Array.enqueue(this.nTb,Ba.RPi.CP),this.nTb.length>this.ZPg&&(Array.dequeue(this.nTb),this.BUk()))}BUk(){var S=this.nTb.length;let Ba=0;for(let ib=0;ib<S;ib++){const Sb=Array.dequeue(this.nTb);Ba+=Sb;
Array.enqueue(this.nTb,Sb)}S=Ba/S;S>this.xwe&&this.ra.raiseEvent("CPTTE",new J(this.xwe,S))}I7k(S,Ba){I.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.sGd(Ba.rle,Ba.actualValue))}Qwk(S){this.ra.addHandler("CPTTE",S)}sGd(S,Ba){const ib={};ib.ThresholdValue=S;ib.ActualValue=Ba;return ib}}Object(f.a)(V,"CpuMeterMonitor",null,[1149]);class X{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(X,"ProfileInformation",null,[]);var W=c(11),U=c(38),Y=c(239),ca=c(82);class aa{constructor(S=
0,Ba=0){this.bub=!1;this.xtb={};this.god=S;this.yod=Ba;this.OVe=0;U.a.addHandler(window.self,W.a.drh,()=>{this.bub=!0});U.a.addHandler(window.self,W.a.erh,()=>{this.bub=!1})}grh(S,Ba,ib){const Sb=aa.generateKey(Ba,ib);Sb in this.xtb?Ba=this.xtb[Sb]:(Ba=new X,Ba.S=ib?1:0,this.xtb[Sb]=Ba,this.OVe++);Ba.C++;Ba.M=S>Ba.M?S:Ba.M;Ba.T+=S}gCa(S,Ba){this.grh(S,Ba,!1);this.bub&&this.grh(S,Ba,!0)}getData(){if(0<this.yod&&this.OVe>this.yod)return this.aSl();const S=0<this.god,Ba={},ib=this.xtb;for(let yc in ib){var Sb=
yc;const ed=ib[yc];this.Yej(ed);S&&ed.T>=this.god&&(Ba[Sb]=ed)}return S?ca.a.jf(Ba)?null:Ba:this.xtb}aSl(){var S=0<this.god,Ba=[];const ib=this.xtb;for(let Sb in ib){const yc={key:Sb,value:ib[Sb]};let ed=yc.value;(!S||ed.T>=this.god)&&Array.add(Ba,yc)}if(Ba.length>this.yod)Ba.sort((Sb,yc)=>yc.value.T-Sb.value.T),Ba=Ba.slice(0,this.yod);else if(!Ba.length)return null;S={};for(const Sb of Ba)Ba=Sb.value,this.Yej(Ba),S[Sb.key]=Ba;return S}Yej(S){S.M=Y.a.YU(S.M,0);S.T=Y.a.YU(S.T,0)}reset(){this.xtb={};
this.OVe=0}static generateKey(S,Ba){return Ba?S+" [it]":S}}Object(f.a)(aa,"FunctionCallAggregator",null,[1139]);var fa=c(1078);class pa{}Object(f.a)(pa,"CpuMeterFrame",null,[]);class ra extends Sys.EventArgs{constructor(S){super();this.RPi=S}}Object(f.a)(ra,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class la{}Object(f.a)(la,"MiniTaskItemInfo",null,[]);class qa{}Object(f.a)(qa,"TaskItemInfo",null,[]);var La=c(1039),Pa=c(1403),Ka=c(189);class Na{constructor(S,Ba,ib,Sb,yc){this.Ixb=0;this.DZ=
null;this.qtd=this.Dgh=0;this.Idh=!1;this.FUb=0;this.jvc=!1;this.Fsa=null;this.nld=0;this.qLe=new M.a;this.Nvd=[];this.Oz=S;this.jJe=Ba;this.dBe=ib;this.x5g=Sb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.bcc();this.M1j=yc;this.eBe=new aa(100);this.S$j=La.a.cF(1,5,new Pa.a)}XZe(S){this.qLe.addHandler("OnCpuMeterFrameAvailable",S)}uaj(S){this.qLe.removeHandler("OnCpuMeterFrameAvailable",S)}bnb(S,Ba,ib,Sb=null){ib=Sb?Sb.priority:7;const yc=this.Oz();
this.start(Ba,ib);try{S()}finally{this.stop(Ba,Sb),S=this.Oz()-yc,this.x5g.track(S,Ba)}}he(S,Ba){const ib=this.Oz();try{S()}finally{S=this.Oz()-ib,this.dBe.gCa(S,Ba),0<this.Ixb&&this.eBe.gCa(S,Ba),this.x5g.track(S,Ba)}}NVf(S){const Ba=new qa;Ba.TN=S.VKf;Ba.TP=S.priority;this.Q5i(1,Ba)}kdc(S){this.nld|=S}start(S,Ba){if(!this.Ixb){this.eBe.reset();const ib=this.PCi(S);ib&&this.w3d(1);this.DZ=new qa;this.DZ.TN=S;this.DZ.TP=Ba;this.DZ.ST=(new Date).toISOString();this.DZ.STS=Y.a.YU(this.Oz(),2);ib?this.DZ.UI=
1:this.iNm(S)?this.DZ.UI=2:this.DZ.UI=0}this.Ixb++}w3d(S){this.FUb|=S}wDd(S=!0,Ba=0){this.FUb=S?0:this.FUb&~Ba}stop(S,Ba=null){let ib;this.Ixb--;0>=this.Ixb&&this.DZ&&(ib=this.Oz()-this.DZ.STS,this.qtd+=ib,this.jJe.gCa(ib,S),this.PCi(S)&&this.wDd(!1,1),this.DZ.TRT=Y.a.YU(ib,2),Ba&&(this.DZ.TQT=Y.a.YU(Ba.fMn,2),this.DZ.TDT=Y.a.YU(Ba.$Di,2)),this.M1j&&(this.Q5i(0,this.DZ),this.A3n()),this.Ixb=0);0<=S.indexOf(fa.a.XOo)&&this.kdc(2);0<=S.indexOf(fa.a.Lbj)&&this.kdc(4);1===(this.FUb&1)&&this.kdc(1);2===
(this.FUb&2)&&this.kdc(8)}A3n(){var S=this.DZ.TRT;if(750<S){let ib=this.eBe.getData();if(ib){const Sb={};for(let yc in ib){var Ba=ib[yc];const ed=yc;ed.startsWith("SiOp_")||ed.endsWith("[it]")||(Sb[ed]=Math.round(100*Ba.T/S))}ib=Sb}S=Object.assign(new la,{B:this.DZ.STS,T:S,S:ib});this.S$j.track(S,this.DZ.TN)}}xyo(){var S=this.Oz()-this.Dgh,Ba=Y.a.YU(this.qtd/S*100,2);S=new pa;S.CP=Ba;S.II=this.nld;Ba=this.jJe.getData();ca.a.count(Ba)&&(S.LRT=Ba);Ba=this.dBe.getData();ca.a.count(Ba)&&(S.FP=Ba);this.qLe.raiseEvent("OnCpuMeterFrameAvailable",
new ra(S));this.tuj()}tuj(){this.jJe.reset();this.dBe.reset();this.qtd=this.Ixb=0;this.Dgh=this.Oz();this.nld=0;this.DZ=null}run(){this.Idh?this.xyo():(this.tuj(),this.Idh=!0);this.Fsa?this.Fsa(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}Lyd(S,Ba,ib){const Sb=Array(2);Sb[0]=Ba;Sb[1]=ib;this.Nvd[S]||(this.Nvd[S]=[]);this.Nvd[S].push(Sb)}Q5i(S,Ba){S=this.Nvd[S];if(!Ka.a.jf(S))for(let Sb=0;Sb<S.length;Sb++){var ib=S[Sb];const yc=ib[0];ib=ib[1];yc&&!yc(Ba)||
ib(Ba)}}bcc(){if(!this.jvc){const S=window.setTimeout;this.Fsa=(Ba,ib)=>S(Ba,ib);this.jvc=!0}}PCi(S){return S.startsWith("key")||S.startsWith("input")}iNm(S){return S.startsWith("click")||S.startsWith("mouse")||S.startsWith("pointer")}}Object(f.a)(Na,"CpuMeter",null,[129]);class sa{constructor(S){this.Dqc=null;this.Xp=new z.a;this.Oz=S}initialize(S,Ba,ib,Sb=!1){this.Dqc||(this.Dqc=new Na(this.Oz,S,Ba,ib,Sb),this.Xp.zg(this.Dqc));return this.Dqc}}Object(f.a)(sa,"CpuMeterProvider",null,[1148]);var wa=
c(167);class ja{constructor(S=1){this.zD=[];this.dhd=[];this.aj=S}gCl(){let S=0;for(let Ba=0;Ba<this.zD.length;Ba++)this.zD[Ba]<this.zD[S]&&(S=Ba);return S}gCa(S,Ba){S=Y.a.YU(S,2);if(this.zD.length<this.aj)Array.add(this.zD,S),Array.add(this.dhd,Ba);else{var ib=this.gCl();S>this.zD[ib]&&(this.zD[ib]=S,this.dhd[ib]=Ba)}}getData(){return this.zD.length?{["Vals"]:this.zD,["Desc"]:this.dhd}:null}reset(){this.zD=[];this.dhd=[]}}Object(f.a)(ja,"MaxDataAggregator",null,[1139]);var ha=c(39),va=c(22);class xa{get name(){return"Common.App.CpuMeter"}xc(S){S.register(sa,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Rd(()=>new sa(ha.a.Ze));S.register(V,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Rd(()=>new V)}init(){const S=l.AFrameworkApplication.K;if(S.$("CpuMeterIsEnabled")){const Ba=va.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");wa.a.instance.iAd.continueWith(()=>{xa.Rxm(S,Ba)})}}dispose(){}static Rxm(S,Ba){const ib=La.a.cF(10,5,new aa(S.mc("TaskManagerLoggingThreshold",
0),S.mc("CpuMeterMaximumEntriesToLog",0)));Ba=Ba.initialize(new ja(5),new aa,ib,S.$("CPUMeterExposeTaskDetailsIsEnabled"));S.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(Ba.run(),S.$("CpuMeterMonitorIsEnabled")&&va.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ba,S.YT("CpuMeterAverageCpuPercentThreshold",80),S.mc("CpuMeterRollingAverageFramesCount",15)));I.b(16827671,306,50,"Initializing CpuMeter")}static main(){L.a.instance.Fc(new xa)}}Object(f.a)(xa,"CpuMeterPackage",
null,[1,2]);var ma=c(7),Ja=c(83),oa=c(1066),za=c(1045),Fa=c(20),kb=c(1404);class fb{constructor(){this.Lsa=this.Aoc=null;this.E_b=!0;this.uvc=!1}xc(S){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&S.register(1123,"Common.IEventTimingMeter").singleInstance().Rd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var S=new za.a(l.AFrameworkApplication.K.mc("EventTimingMeterEventSamplingPercent",0)/100);S=new oa.a(Object(a.a)(S,S.AOb,"shouldBeInSample"));
const Ba=La.a.cF(16,1,S);this.Lsa=new kb.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.YT("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.YT("AshaVetoForTypingThresholdPercentile",95),this.E_b);(this.uvc=!Fa.a.k3a)&&l.AFrameworkApplication.dI(()=>{this.K6e()});this.Aoc=ib=>{ib=ib.rawEvent.detail;for(const Sb of ib)Ba.track(Sb,"EventTimingData"),"false"!==Sb.metadata.altPressed.toString()||"false"!==Sb.metadata.ctrlPressed.toString()||"false"!==Sb.metadata.repeat.toString()||
"CharacterKey"!==Sb.metadata.key.toString()&&"Space"!==Sb.metadata.key.toString()||!this.uvc||this.Lsa.Zxa(Sb.timeToRequestAnimationFrameMs)};U.a.addHandler(window.self,W.a.crh,this.Aoc)}dispose(){this.Aoc&&(U.a.removeHandler(window.self,W.a.crh,this.Aoc),this.Aoc=null)}K6e(){this.Lsa.hSa();this.Lsa.aZi&&(ma.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Ja.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){L.a.instance.Fc(new fb)}}
Object(f.a)(fb,"EventTimingMeterPackage",null,[1,2]);var lb=c(74),sb=c(73),ab=c(35);class Ga{constructor(S,Ba,ib,Sb=null,yc=null){this.RL=S;this.Gtb=Ba;this.xtc=ib;this.qah=Sb;this.bzc=yc}SKd(S){const Ba=new Sys.StringBuilder(this.RL.x5c);Ba.append("RoamingServiceHandler.ashx?action=");Ba.append("getFirstRunExperienceSettings");Ba.append("&");Ba.append(this.Ysf(S));Ba.append("&");Ba.append(l.AFrameworkApplication.hm);l.AFrameworkApplication.Ne.tj(Ba.toString(),1,null,null,!0,2,Object(a.a)(this,this.wEa,
"getRequestSuccessCallback"),Object(a.a)(this,this.Gba,"getRequestFailureCallback"),null)}N5b(S){var Ba=new Sys.StringBuilder(this.RL.x5c);Ba.append("RoamingServiceHandler.ashx?action=");Ba.append("saveFirstRunExperienceSettings");Ba.append("&");Ba.append(l.AFrameworkApplication.hm);Ba=Ba.toString();S=ab.c(S);l.AFrameworkApplication.Ne.tj(Ba,2,S,null,!0,4,Object(a.a)(this,this.gEn,"postRequestSuccessCallback"),Object(a.a)(this,this.Oca,"postRequestFailureCallback"),null)}wEa(S){let Ba=!1,ib=null;
try{if(0<S.data.we.length){const Sb=Object(sb.a)(Object,ab.a(S.data.we)),yc=Sb?Sb[this.RL.D0e]:null;yc&&(ib=Object(sb.a)(Object,ab.a(yc.toString())))}Ba=!0}catch(Sb){this.Gba(null)}Ba&&this.Gtb&&this.Gtb(S.data,ib)}Gba(S){this.xtc&&this.xtc(S?S.data:null)}gEn(S){this.qah&&this.qah(S?S.data:null)}Oca(S){this.bzc&&this.bzc(S?S.data:null)}Ysf(S){const Ba=new Sys.StringBuilder("requestedsettings=");for(let ib=0;ib<S.count;ib++)Ba.append(S.J(ib)),ib<S.count-1&&Ba.append(";");return Ba.toString()}}Object(f.a)(Ga,
"FirstRunExperienceRequestHandler",null,[]);var Ua=c(262);class wb{constructor(){this.gtc=this.Uid=this.RL=null}bvo(S){S?(this.RL=S,this.fNm()&&(ma.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),S=new lb.a,S.add(this.RL.D0e),this.Uid=new Ga(this.RL,Object(a.a)(this,this.wEa,"getRequestSuccessCallback"),Object(a.a)(this,this.Gba,"getRequestFailureCallback"),null,Object(a.a)(this,this.Oca,"postRequestFailureCallback")),this.Uid.SKd(S)),
(this.RL.eCi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Vdg()):ma.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}fNm(){try{if(this.RL.eCi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.RL.SHm||this.RL.Ibc||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const S=
l.AFrameworkApplication.K.jb("FlightId");return-1!==(S?S.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(S){ma.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",S?S.toString():null)}return!1}Sfj(S){const Ba={},ib={};ib.FREDisplayedDate=(new Date).toUTCString();ib.VersionDisplayed=S;ib.RemindMeLater=!1;Ba[this.RL.D0e]=ab.c(ib);ma.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Uid&&this.Uid.N5b(Ba)}wEa(S,
Ba){S=S?+S.rT-+S.MH:-1;S>this.RL.Iej?ma.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",S,this.RL.Iej):Ba?this.Uto(Ba)?(ma.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.RL.ZNi),this.Vdg()):(this.Yef(!1),ma.ULS.sendTraceTag(51675537,
306,100,"Current user has already seen this version of the FRE. No further action required.")):(ma.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Vdg())}Gba(S){this.Yef(!1);ma.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",S?S.Qe:-1)}Oca(S){ma.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",S?S.Qe:
-1)}Vdg(){this.Yef(!0);var S=va.a.instance.Na("Common.ISystemInitiatedFeedback");S?this.irj(S):(ma.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((S=va.a.instance.Sa("Common.ISystemInitiatedFeedback"))?S.execute(Ba=>{this.irj(Ba)}):ma.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}irj(S){if(S){var Ba=this.RL.LEl;
Ba&&(l.AFrameworkApplication.Dn(Ba),l.AFrameworkApplication.Fha(Ba));ma.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ba);S.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.gtc=Object(a.a)(this,this.mnn,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.gtc,!0),window.addEventListener("FRELaunchedEvent",this.gtc,!0)):(ma.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.Sfj(this.RL.currentVersion))}else ma.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}mnn(S){if(S){var Ba=S.detail;S=S.type;var ib=this.RL&&this.RL.fAh?this.RL.fAh.split("-")[0]:null;if("FRELaunchedEvent"===S||ib&&Ba&&Ba.id&&-1!==Ba.id.indexOf(ib))Ba.success&&(ma.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Sfj(this.RL.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.gtc,
!0),window.removeEventListener("FRELaunchedEvent",this.gtc,!0))}}Uto(S){if("RemindMeLater"in S&&"FREDisplayedDate"in S){if("true"===S.RemindMeLater.toString()&&(+new Date-+new Date(S.FREDisplayedDate.toString()))/36E5>this.RL.ZNi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in S&&S.VersionDisplayed<this.RL.currentVersion)return ma.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Yef(S){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Ua.a.dispatch("FREDecisionEvent",{["show"]:S})}}Object(f.a)(wb,"FirstRunExperienceLauncher",null,[1121]);class cc{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}xc(S){this.W=S;this.W.register(1121,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Rd(()=>new wb)}init(){}dispose(){}static main(){L.a.instance.Fc(new cc)}}Object(f.a)(cc,"FirstRunExperienceLauncherPackage",null,[1,2]);class zb{constructor(){this.y=this.x=0}}Object(f.a)(zb,
"HammerPoint",null,[]);class nb{constructor(S,Ba,ib,Sb,yc){this.C3g=this.kWa=this.$kd=1;this.Zwd=this.uCc=this.AYa=0;this.DKe=this.AJa=null;this.irb=this.pAe=this.Lrd=!1;this.mj=S;this.dMa=Ba;this.jxb=ib;this.ga=Sb;yc&&(this.Lrd=yc.$("PromoteLayerPinchToZoomIsEnabled"),this.pAe=yc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.irb=yc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get pL(){return this.dMa}wKm(){return!!this.mj.instance}Jnn(S){this.ga&&this.ga.processAction(n.a.Fuj,2);const Ba=this.mj.instance;
this.Lrd&&Ba.F5i();this.kWa=Ba.hj;this.$kd=S.KMc.scale;this.C3g=1;this.DKe=this.Kzh();this.AJa=this.dMa.getBounds();if(!this.AJa)return ma.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;S=this.sdi(S);this.irb?this.Mlj(this.dMa.scrollWidth,this.AJa.width,S,this.kWa,Ba):this.AYa=this.dMa.scrollWidth>this.AJa.width?this.zFc(this.jxb.scrollLeft,S.x,this.kWa):null;this.Zwd=this.dMa.scrollHeight>this.AJa.height?this.zFc(this.jxb.scrollTop,S.y,this.kWa):null;return!0}g7f(){this.AYa=null;this.uCc=
0}Mlj(S,Ba,ib,Sb,yc){S>Ba?this.AYa?(S=yc.ZIf,S!==this.uCc&&(this.AYa-=this.uCc-S,this.uCc=S)):(this.AYa=this.zFc(this.jxb.scrollLeft,ib.x,Sb),this.uCc=yc.ZIf):this.g7f()}Inn(S){const Ba=this.sdi(S);if(!Ba)return ma.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;S=this.iho(S.KMc.scale/this.$kd)*this.kWa;this.pXo(Ba,S);this.qXo(Ba,S);return!0}pXo(S,Ba){const ib=this.dMa.scrollWidth,Sb=this.AJa.width;this.irb?this.Mlj(ib,Sb,S,Ba,this.mj.instance):!this.AYa&&ib>Sb&&(this.AYa=this.zFc(this.jxb.scrollLeft,
S.x,Ba));if(S=this.Szh(S.x,this.AYa,ib,Sb,Ba))this.jxb.scrollLeft=S}qXo(S,Ba){const ib=this.dMa.scrollHeight,Sb=this.AJa.height;!this.Zwd&&ib>Sb&&(this.Zwd=this.zFc(this.jxb.scrollTop,S.y,Ba));if(S=this.Szh(S.y,this.Zwd,ib,Sb,Ba))this.jxb.scrollTop=S}Szh(S,Ba,ib,Sb,yc){return ib<=Sb||!Ba||!Sb?null:Math.max(0,Math.min(Ba*yc-S,ib-Sb))}zFc(S,Ba,ib){return(S+Ba)/ib}Hnn(S){S=S.KMc.scale;this.pAe&&(S/=this.$kd);this.kZh(S);this.Lrd&&this.mj.instance.t2f();this.ga&&this.ga.processAction(n.a.ohf,2);this.irb&&
this.g7f()}Gnn(S){S=S.KMc.scale;this.pAe&&(S/=this.$kd);this.kZh(S,!0);this.Lrd&&this.mj.instance.t2f();this.ga&&this.ga.processAction(n.a.ohf,2);this.irb&&this.g7f()}iho(S){const Ba=this.mj.instance,ib=new Date>=this.DKe;ib&&(this.DKe=this.Kzh());Math.abs(S-this.C3g)>=.01*S&&Ba.Xno(S*this.kWa,ib);return Ba.hj/this.kWa}kZh(S,Ba=!1){S*=this.kWa;this.mj.instance.Wbg(S,!1);const ib={};ib.initialScale=this.kWa;ib.finalScale=S;ib.cancelled=Ba;ma.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",
ib)}sdi(S){return(S=S.KMc.center)&&this.AJa?Object.assign(new zb,{x:S.x-this.AJa.x,y:S.y-this.AJa.y}):null}Kzh(){const S=(new Date).getTime();return new Date(S+1E3)}}Object(f.a)(nb,"PinchZoomAdapter",null,[1176]);class eb{constructor(S){this._element=S}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)(eb,"ScrollContainerElement",null,[1175]);var Ib=c(130);class Xa{constructor(S,
Ba,ib,Sb,yc,ed){this.fTe=this.Q$a=null;this.W=S;this.ge=Ba;this.nmd=ib;this.w1g=Sb;this.x8j=yc;this.jVb=ed;this.Mfd=new lb.a}register(S,Ba){this.nmd&&(4===l.AFrameworkApplication.ta.Nb.Sl&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Ib.a.get_instance().xk(8,()=>{this.rdj(S,Ba)}):this.rdj(S,Ba))}rdj(S,Ba){this.W.Sa("Common.IGestureInputManager").execute(ib=>{this.qBo();this.Q$a=ib;this.Mfd.add(S);if(this.w1g){if(this.x8j&&0!==ib.uXl()){this.lvj();
return}var Sb=this.W.Sa("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const yc=new eb(S);Sb=new nb(Sb,yc,Ba,l.AFrameworkApplication.va,l.AFrameworkApplication.K);ib.LUn(S,Sb)}this.lvj()})}unregister(){if(this.Q$a&&this.Mfd){if(this.w1g){for(let S of this.Mfd)this.Q$a.AQo(S);this.Mfd.clear()}this.Q$a=null}}qBo(){this.jVb&&(this.ge?this.fTe=this.ge.$f("Task","Register"):ma.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}lvj(){this.jVb&&(this.fTe?this.fTe.stop():
ma.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(Xa,"GestureInputRegistrar",null,[1122]);class Ra{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInput"}init(){this.Ah||(this.W.resolve("Common.IGestureInputRegistrar"),this.Ah=!0)}dispose(){}xc(S){this.W=S;S.register(1122,"Common.IGestureInputRegistrar").singleInstance().Rd(()=>new Xa(S,l.AFrameworkApplication.ta.Gq,l.AFrameworkApplication.LUc(),l.AFrameworkApplication.Hzi(),!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){L.a.instance.Fc(new Ra)}}Object(f.a)(Ra,"GestureInputPackage",null,[1,2]);var gb=c(404),Bb=c(77);class $b{constructor(){this.lnb=this.U2h=null}}Object(f.a)($b,"GestureAdapterInfo",null,[]);var Qb=c(527),Ac=c(289);class Db{constructor(){this.ysb=null}yJf(){if(!this.ysb){var S="hammer.min.js";l.AFrameworkApplication.K.Sw("IsServerFlavorDebug")&&
(S=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");S=l.AFrameworkApplication.Bz(String.format("{0}",S),5);S=Ac.a.create(S,null,null);Qb.a.rX(S);this.ysb=S.N3a}return this.ysb}static get instance(){Db._instance||(Db._instance=new Db);return Db._instance}}Db._instance=null;Object(f.a)(Db,"HammerJsDependencyLoader",null,[1185]);const dc=(S,Ba,ib=null)=>{if(void 0===Ba||null===Ba)throw ma.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Sb=null;switch(S){case W.a.pinch:Sb=new Hammer.Pinch(ib);break;case W.a.pan:Sb=new Hammer.Pan(ib)}Sb&&(Sb.manager=Ba);return Sb};var Pb;(function(S){S[S.none=-1]="none";S[S.pinch=0]="pinch";S[S.pan=1]="pan";S[S.swipe=2]="swipe"})(Pb||(Pb={}));Object(f.b)("GestureEvent",Pb);var Ub=c(69);class rb extends Ub.a{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe){super(S,ib,Sb,ed);this.Tpc=Ba;this.dYa=Ud;this.Hra=Xe;this.o3j=yc}get shiftKey(){return this.dYa}get ctrlKey(){return this.Hra}get clientPoint(){return this.Tpc}get KMc(){return this.o3j}static create(S,
Ba,ib,Sb,yc,ed){if(ib.rawEvent)if(ed){var Ud=ib.rawEvent;Ud=new Sys.UI.Point(Ud.clientX,Ud.clientY)}else Ud=Ub.a.RNd(ib);else Ud=new Sys.UI.Point(ib.clientX,ib.clientY);return new rb(S,Ud,Ba,ib,Sb,yc,ib.shiftKey,ib.ctrlKey,ed)}}Object(f.a)(rb,"GestureEventArgs",Ub.a,[]);class Yb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Yb,"GestureManagerData",null,[]);class Ya{}Ya.hRj=2;Ya.iRj=4;Ya.jRj=8;Ya.kRj=8;Object(f.a)(Ya,"HammerConstants",null,[]);var Ob=c(93),vc=c(112),Sa=c(19),Ab=c(102);class Fb extends U.a{constructor(S,Ba){super();this.OKa=gb.a.OJl;this.yNe=!!window.PointerEvent;this.Kih=window.hasOwnProperty("ontouchstart");this.Atb=this.Vxc=null;this.AKa=
!1;this.Wka=new Bb.a;this.$yc=new Bb.a;this.jWg=new lb.a;this.X9a=null;this.HSb=this.jVb=this.UNg=this.Kue=this.XIe=this.Cch=this.kOg=this.CCc=!1;this.Xwc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.gTe=null;this.ng=Ob.EventHandlerManager.instance;this.yNe?(ma.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Vxc=Object(a.a)(this,this.w7d,"onPointerEvent"),this.Atb=W.a.QJl):this.Kih?(ma.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Vxc=Object(a.a)(this,
this.qmb,"onTouchEvent"),this.Atb=W.a.touchEvents):(ma.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Vxc=Object(a.a)(this,this.i7d,"onMouseEvent"),this.Atb=W.a.PJl);this.ge=Ba;this.b2=S;l.AFrameworkApplication.K&&(this.CCc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.kOg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.Cch=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.XIe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Kue=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.UNg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.jVb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.HSb=this.CCc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}uXl(){return this.yNe?0:this.Kih?1:2}gv(S){super.gv(S);this.ng.SEa(this.Atb,S,0,this.Vxc)}Xu(S){super.Xu(S);
this.ng.G_a(S,this.Atb)}LUn(S,Ba){l.AFrameworkApplication.LUc()?Db.instance.yJf().continueWith(ib=>{this.pBo();if(ib.Ci||ib.zo)ma.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",ib.status);else{ma.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",ib.status);if(this.UNg){ib=window.Hammer;if("undefined"===typeof ib){ma.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Kje();return}if("undefined"===typeof ib.inputHandler){ma.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.Kje();return}}if(!S)throw this.Kje(),Error.argumentNull("source element can not be null");ib=vc.a.Db(S,this.OKa);if(void 0===ib||null===ib)ib=new Bb.a,vc.a.Kl(S,this.OKa,ib),this.MUn(S);if(!ib.nb(Pb[0])){var Sb=Object.assign(new $b,{lnb:dc(Pb[0],this,null),U2h:Ba});ib.add(Pb[0],Sb)}}this.Kje()}):ma.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}pBo(){this.jVb&&(this.ge?this.gTe=this.ge.$f("Task",
"RegisterGestureAdapterAfterLoad"):ma.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Kje(){this.jVb&&(this.gTe?this.gTe.stop():ma.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}AQo(S){ma.ULS.sendTraceTag(42256223,310,S?100:10,"source element {0} ",S.id);const Ba=vc.a.Db(S,this.OKa);void 0!==Ba&&null!==Ba&&(Ba.remove(Pb[0]),Ba.count||(vc.a.UU(S,this.OKa),this.curRecognizer=null,this.BQo(S)))}MUn(S){this.jWg.add(S);this.ng.SEa(this.Atb,S,
0,this.Vxc)}BQo(S){this.jWg.remove(S);this.ng.G_a(S,this.Atb)}recognize(S){var Ba=Array(S.pointers.length);for(var ib=0;ib<S.pointers.length;ib++)Ba[ib]=S.pointers[ib].target;ib=null;for(this.X9a=this.L1l(Ba);void 0!==this.X9a&&null!==this.X9a&&(ib=vc.a.Db(this.X9a,this.OKa),void 0===ib||null===ib);this.X9a=this.X9a.parentNode);if(void 0!==ib&&null!==ib){this.curRecognizer&&this.curRecognizer.state===Ya.kRj&&(this.curRecognizer=null);Ba=ib.keys;for(let Sb of Ba){Ba=ib.J(Sb);void 0!==Ba&&null!==Ba&&
void 0!==Ba.lnb&&null!==Ba.lnb&&(void 0===this.curRecognizer||null===this.curRecognizer||Ba.lnb===this.curRecognizer||Ba.lnb.canRecognizeWith(this.curRecognizer))&&Ba.lnb.recognize(S);const yc=Ba.lnb.state;this.curRecognizer||Ya.hRj!==yc&&Ya.iRj!==yc&&Ya.jRj!==yc||(this.curRecognizer=Ba.lnb)}}}emit(S,Ba){if("hammer.input"!==S){this.AKa=!1;Ba=rb.create(S,this.X9a,Ba.srcEvent,Ba,3,this.yNe);var ib=vc.a.Db(this.X9a,this.OKa);if(this.$Om(S))var Sb=0;else if(this.zOm(S))Sb=1;else if(this.sSm(S))Sb=2;else{ma.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:ib}=ib.Dc(Pb[Sb]));void 0!==ib&&null!==ib&&((ib=ib.U2h,ib.wKm())?S.endsWith("start")?this.AKa=ib.Jnn(Ba):S.endsWith("end")?(ib.Hnn(Ba),this.AKa=!0):S.endsWith("cancel")?(ib.Gnn(Ba),this.AKa=!0):S.endsWith("move")&&(this.AKa=ib.Inn(Ba)):ma.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",S))}}get(S){return Object(sb.a)(Hammer.Recognizer,S)}L1l(S){if(1>S.length)return null;if(1===S.length)return S[0];
var Ba=S[0],ib=!0;for(let Sb=1;Sb<S.length;Sb++){if(!S[Sb])return null;if(Ba!==S[Sb]){ib=!1;break}}if(ib)return Ba;Ba=this.w3h(S[0]);ib=0;for(const Sb of S){S=this.w3h(Sb);if(Ba.J(Ba.count-1)!==S.J(S.count-1))return null;for(let yc=Ba.count-2,ed=S.count-2;yc>=ib&&0<=ed;yc--,ed--)if(Ba.J(yc)!==S.J(ed)){ib=yc+1;break}}return Ba.J(ib)}w3h(S){const Ba=new lb.a;for(;void 0!==S&&null!==S;S=S.parentNode)Ba.add(S);return Ba}s$h(S){switch(S){case W.a.zP:case W.a.Szb:return 1;case W.a.yP:case W.a.o4e:return 2;
case W.a.VJ:case W.a.Tzb:return 4;case W.a.Sle:case W.a.n4e:return 8}return 0}qmb(S,Ba,ib){S=this.s$h(S);Ba=this.ZZl(ib);Hammer.inputHandler(this,S,Ba);this.AKa&&ib.preventDefault();return this.AKa}Ali(){return 1<this.Wka.count}wCd(){ma.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.CCc)for(let S of this.Wka)this.C$i(S.key);else this.Wka=new Bb.a;this.session=null}dtk(S,Ba,ib){ma.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",S);if(!this.$yc.nb(S)){try{Ba.setPointerCapture(S)}catch(Sb){ma.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Sb)}this.$yc.add(S,Ba)}this.Wka.Z(S,ib);this.HSb&&1<this.Wka.count&&this.b2&&!this.b2.KFc&&(this.b2.KFc=!0)}C$i(S){ma.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",S);if(this.$yc.nb(S)){try{this.$yc.J(S).releasePointerCapture(S)}catch(Ba){ma.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Ba)}this.$yc.remove(S)}else ma.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",S);this.Wka.remove(S);this.HSb&&
1>=this.Wka.count&&this.b2&&this.b2.KFc&&(this.b2.KFc=!1)}w7d(S,Ba,ib){var Sb=ib.rawEvent.pointerType.toString();const yc=ib.rawEvent.pointerId.toString();if("touch"!==Sb)return!1;S=this.s$h(S);if(1!==S&&!this.Wka.nb(yc))return!1;this.kOg&&1===S&&ib.rawEvent.isPrimary&&this.Wka.count&&(ma.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.wCd());this.CCc?this.dtk(yc,Ba,ib):this.Wka.Z(yc,ib);this.XIe&&2===S&&(!this.Kue||this.Kue&&"function"===typeof ib.rawEvent.getCoalescedEvents)&&
(Ba=ib.rawEvent.getCoalescedEvents())&&this.Ali()&&(this.Xwc=Math.max(this.Xwc,Ba.length));this.Cch&&(this.AKa=!1);Sb=this.YZl(this.Wka,ib,Sb);Hammer.inputHandler(this,S,Sb);if(4===S||8===S)this.CCc?this.C$i(yc):this.Wka.remove(yc),this.Wka.count||(this.session=null,this.XIe&&-1!==this.Xwc&&(ma.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Xwc),this.Xwc=-1));this.AKa&&ib.preventDefault();return this.AKa}i7d(){return!1}ZZl(S){const Ba=new Yb;var ib=S.rawEvent;const Sb=
ib.touches;ib=ib.changedTouches;Ba.pointers=Array.clone(Sb);Ba.pointers=Array.clone(0<Sb.length?Sb:ib);Ba.changedPointers=Array.clone(ib);Ba.srcEvent=S;Ba.pointerType="touch";return Ba}YZl(S,Ba,ib){const Sb=new Yb;Sb.pointers=Ab.toArray(S.values);Sb.changedPointers=[Ba];Sb.pointerType=ib;Sb.srcEvent=Ba;return Sb}$Om(S){return Sa.a.startsWith(S,W.a.pinch)}zOm(S){return Sa.a.startsWith(S,W.a.pan)}sSm(S){return Sa.a.startsWith(S,W.a.swipe)}}Object(f.a)(Fb,"GestureInputManager",U.a,[1150,1151]);var Va=
c(296);class Wa{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInputManager"}xc(S){S.register(Fb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Rd(()=>new Fb(Va.a.instance,l.AFrameworkApplication.ta.Gq));this.W=S}init(){this.Ah||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Ah=!0)}dispose(){}static main(){L.a.instance.Fc(new Wa)}}Object(f.a)(Wa,"GestureInputManagerPackage",null,[1,2]);var jb=c(243),
mc=c(57),yb=c(1552);class Oa{constructor(S,Ba,ib){this.zRe=this.yRe=null;this.bZb=new z.a;this.Yf=S;this.Nxc=ib;this.Ela=Ba.appSettings[Oa.i2o]||""}get upo(){return this.bZb.task}get sQ(){return this.Yf.value}c4n(){const S={};S[Oa.Oom]=l.AFrameworkApplication.hm;S["Content-Type"]="application/json; charset=utf-8";ma.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Ba=mc.a.lp(this.Ela+Oa.vpo,Oa.Kin,l.AFrameworkApplication.ta.Nb.Sl.toString());
this.sQ.tj(Ba,1,"",S,!0,2,Object(a.a)(this,this.KKb,"onSuccessCallback"),Object(a.a)(this,this.rKb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}f4m(S){try{const Ba={};Ba.FlightName=S.FlightName;Ba.SessionID=S.SessionID;ma.ULS.sendTraceTag(594883776,215,50,ab.c(Ba))}catch(Ba){ma.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}KKb(S){if((S=S.data.we)&&S.length)try{const Ba=ab.a(S);this.yRe=Ba.NavBarDataJson;ma.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.yRe?({Yu:this.zRe}=ab.d(Ba.NavBarDataJson)).returnValue?(this.f4m(this.zRe),this.bZb.zg(this.zRe)):(ma.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:yb.a.Y$c(this.yRe)}),this.bZb.bda()):(ma.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.bZb.bda())}catch(Ba){ma.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.bZb.bda()}else ma.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}rKb(){this.bZb.bda();
ma.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Oa._instance||(Oa._instance=Oa.CDb())}static CDb(){return new Oa(new jb.a(()=>l.AFrameworkApplication.Ne),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Nb.Sl)}}Oa.Oom="X-qs";Oa.Kin="at";Oa.vpo="O365ShellServiceProxy.ashx";Oa._instance=null;Oa.i2o="ShellWebServiceBase";Object(f.a)(Oa,"O365ShellActor",null,[1145]);class Gb{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}xc(S){this.W=
S;this.W.register(Oa,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Rd(()=>new Oa(new jb.a(()=>l.AFrameworkApplication.Ne),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Nb.Sl))}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){l.AFrameworkApplication.ung&&l.AFrameworkApplication.ta.Nb.wJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").c4n()}dispose(){}static main(){L.a.instance.Fc(new Gb)}}
Object(f.a)(Gb,"PackageManager",null,[1,2]);class Wb{LQa(){}init(){}dispose(){}}Object(f.a)(Wb,"NoOpOfflineLogger",null,[1205,10]);var kc=c(781);class Mb{}Mb.hAd=0;Object(f.a)(Mb,"OfflineLoggerConstants",null,[]);var Qc=c(91),Ic=c(244),Ed=c(304);class me{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.$Ie=this.Nwc=null;this.tWa=!1;this.J6=null;this.Qqc=this.wWb=this.msb=0;this.rK=this.Zab=this.bfd=this.Nqd=this.QS=null;this.$l=!1;this.XAa=ib;this.KBa=Sb;this.yBa=yc;this.Yf=Ba;this.Hb=S;this.uVa=ed;Ud?(this.bfd=
new me(S,Ba,ib,Sb,yc,ed,!1),this.bfd.Nqd=this,this.Nwc="OfflineLoggerManifest|"+this.uVa,this.$Ie="OfflineLog|"+this.uVa+"|"):(this.Nwc="OfflineLoggerManifest",this.$Ie="OfflineLog|")}init(){this.hcg();this.v_m();this.tWa=!1;this.Yf.g0b(this);this.QS=new Qc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Hb.Wb(this.QS);this.bfd&&this.bfd.init()}nFc(S){return this.$Ie+S}v_m(){const S=this.XAa.getItem(this.Nwc);void 0!==S&&null!==S&&0<S.length&&(this.J6=me.gad(S));this.J6||
(this.J6={});if(void 0===this.J6.end||null===this.J6.end)this.J6.end=0;if(void 0===this.J6.offset||null===this.J6.offset)this.J6.offset=0;this.msb=this.J6.offset;isFinite(this.msb)||(this.msb=0);this.wWb=this.J6.end;isFinite(this.wWb)||(this.wWb=0);this.Qqc=this.wWb}hcg(){this.Zab=new Ed.a;this.rK=new Ic.a;this.Nqd||(this.KBa.Gph(Object(a.a)(this,this.cWf,"onUlsReadyToBeSent")),this.KBa.kqh(Object(a.a)(this,this.eWf,"onUlsSentSuccessfully")),this.KBa.jqh(Object(a.a)(this,this.dWf,"onUlsSentFailed")));
this.KBa.xph(Object(a.a)(this,this.fSf,"onAfterUlsHostDisposed"))}cWf(S,Ba){if(void 0!==Ba&&null!==Ba&&void 0!==Ba.args&&null!==Ba.args){S=!1;if(!this.Zab.nb(Ba.args.tag)){if(!this.Zab.nb(Mb.hAd))return;S=!0}this.Zab.remove(S?Mb.hAd:Ba.args.tag);this.rK.nb(Ba.uploadId)||this.rK.Z(Ba.uploadId,new lb.a);this.rK.J(Ba.uploadId).add(Ba.args)}}eWf(S,Ba){this.rK.remove(Ba.uploadId)}dWf(S,Ba){if(void 0!==Ba&&null!==Ba&&this.rK.nb(Ba.uploadId)){S=this.rK.J(Ba.uploadId);for(let ib=0,Sb=S.count;ib<Sb;++ib)Ba=
me.serialize(S.J(ib),this.yBa),this.had(this.nFc(this.Qqc++),Ba)}}fSf(){this.dispose()}had(S,Ba){try{return this.XAa.setItem(S,Ba),!0}catch(ib){return ma.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",ib.message),!1}}sendOfflineLogs(){if(!this.tWa){for(var S=this.msb,Ba=new lb.a,ib=null;S<this.wWb&&5>=Ba.count;++S){var Sb=this.nFc(S);const yc=this.XAa.getItem(Sb);this.XAa.removeItem(Sb);if(void 0===yc||null===yc)continue;const ed=({sessionId:Sb}=me.deserialize(yc)).returnValue;
if(ed){if(!ib)ib=Sb;else if(Sb!==ib)break;Ba.add(ed)}else ma.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",yc)}0<Ba.count&&this.KBa.Scj(this,Ab.toArray(Ba),ib);this.msb=S;S>=this.wWb&&(this.Hb.We(this.QS),this.QS=null)}}LQa(S,Ba,ib){!this.$l&&ma.ULS.W9(Ba,ib)&&(this.Nqd?this.Nqd.LQa(S,Ba,ib):this.Zab.Z(S,!0))}dispose(){if(!this.$l){this.QS&&this.Hb.We(this.QS);var S=Ab.toArray(this.rK.keys);S.sort();for(const Ba of S){S=this.rK.J(Ba);for(let ib=0,Sb=S.count;ib<Sb;++ib){const yc=
me.serialize(S.J(ib),this.yBa);this.had(this.nFc(this.Qqc++),yc)}}this.msb<this.Qqc?(this.J6.end=this.Qqc,this.J6.offset=this.msb,this.had(this.Nwc,JSON.stringify(this.J6))):this.XAa.removeItem(this.Nwc)}this.$l=!0}kRa(){this.tWa=!0}xlb(){this.tWa=!1}static serialize(S,Ba){const ib={};ib.t=S.tag;ib.c=S.category;ib.l=S.level;ib.m=S.message;ib.lt=S.logType;ib.s=Ba;ib.ts=S.timestamp;ib.o=S.isMinified;ib.a=S.args;return JSON.stringify(ib)}static deserialize(S){return(S=me.gad(S))?{returnValue:new kc.a(S.ts,
S.c,S.t,S.l,S.m,S.lt,S.o,S.a),sessionId:S.s}:{returnValue:null,sessionId:null}}static gad(S){try{return JSON.parse(S)}catch(Ba){ma.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",Ba.message)}return null}}Object(f.a)(me,"OfflineLoggerImpl",null,[1205,10,139]);class Be{constructor(S,Ba,ib,Sb){this.sessionId=S;this.version=Ba;this.ZAd=ib;this.NWf=Sb;this.cxa=new lb.a}}Object(f.a)(Be,"CachedLogUpload",null,[]);class ad{constructor(S){S.name&&(this.n=S.name);
S.stack&&(this.s=S.stack);S.message&&(this.m=S.message);S.file&&(this.f=S.file);null!=S.line&&(this.l=S.line);null!=S.column&&(this.c=S.column)}}Object(f.a)(ad,"LoggingExceptionArgsLocalStorage",null,[]);class Nc{constructor(S){this.t=S.tag;this.c=S.category;this.l=S.level;this.m=S.message;this.lt=S.logType;this.ts=S.timestamp;this.o=S.isMinified;this.a=S.args;S.exceptionArgs&&(this.e=new ad(S.exceptionArgs))}}Object(f.a)(Nc,"LoggingArgsLocalStorage",null,[]);var Sc=c(475);class Gc{constructor(S,
Ba,ib,Sb,yc,ed,Ud){this.t=S;this.m=Ba;this.s=ib;this.v=Sb;this.i=yc;this.a=ed;this.d=Ud;this.op="Log"}}Object(f.a)(Gc,"LoggingKeyLocalStorage",null,[]);var ie=c(135);const cf=(S,Ba,ib,Sb,yc)=>!(void 0===S||null===S)&&!(void 0===S.i||null===S.i)&&!(void 0===S.t||null===S.t)&&!(void 0===S.s||null===S.s)&&"Log"===S.op&&S.t===Ba&&isFinite(S.t)&&ie.a.isValid(S.s)&&(void 0===S.m||null===S.m||S.m===ib)&&(!yc||void 0===S.d||null===S.d||S.d===Sb);class Ge{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg,Vh,Jh){this.tWa=
this.h5g=this.W4g=this.X4g=!1;this.rK=this.Zab=this.J6=this.QS=null;this.$l=!1;this.Jub=[];this.qWb=[];this.XAa=ib;this.KBa=Sb;this.yBa=yc;this.Yf=Ba;this.Hb=S;this.Nxc=ed;this.cLe=Ud;this.Mch=Xe;this.MWa=Ue;this.y$j=Kf;this.wGe=Bg;this.uVa=Vh;this.N_g=Jh}get manifest(){return this.J6}get KXc(){return this.Zab}get NQa(){return this.rK}init(){this.hcg();this.tWa=!1;this.Yf.g0b(this);this.QS=new Qc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Hb.Wb(this.QS)}determineLogsToSendAtBoot(){this.NQh(!0)}determineLogsToSendOnReconnect(){this.NQh(!1)}NQh(S){this.qKd();
this.Jub=[];S&&(this.qWb=[]);for(var Ba=0;Ba<this.XAa.length;Ba++){const ib=this.XAa.key(Ba),Sb=Ge.kCj(ib,!1);cf(Sb,this.Nxc,this.cLe,this.uVa,this.N_g)&&(Sb.s===this.yBa?Array.add(this.Jub,ib):S&&Array.add(this.qWb,ib))}if(this.Jub.length||S&&this.qWb.length)if(Ba=this.wGe?Object(a.a)(this,this.Byo,"sortDescendKeysToUpload"):Object(a.a)(this,this.Eyo,"sortKeysToUpload"),this.Jub.sort(Ba),S&&this.qWb.sort(Ba),0<this.Jub.length||0<this.qWb.length)this.QS=new Qc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,
"sendOfflineLogs"),105),this.Hb.Wb(this.QS)}Eyo(S){return S.s!==S.s?S.s.localeCompare(S.s):S.i-S.i}Byo(S){return S.s!==S.s?S.s.localeCompare(S.s):S.i-S.i}nFc(S,Ba,ib,Sb){S=new Gc(this.Nxc,this.cLe,Ba,ib,S,Sb,this.uVa);return JSON.stringify(S)}hcg(){this.Zab=new Ed.a;this.rK=new Ic.a;this.KBa.Gph(Object(a.a)(this,this.cWf,"onUlsReadyToBeSent"));this.KBa.kqh(Object(a.a)(this,this.eWf,"onUlsSentSuccessfully"));this.KBa.jqh(Object(a.a)(this,this.dWf,"onUlsSentFailed"));this.KBa.xph(Object(a.a)(this,this.fSf,
"onAfterUlsHostDisposed"))}cWf(S,Ba){if(void 0!==Ba&&null!==Ba&&void 0!==Ba.args&&null!==Ba.args){if(this.KXc.nb(Ba.args.tag))this.KXc.remove(Ba.args.tag);else if(this.KXc.nb(Mb.hAd))this.KXc.remove(Mb.hAd);else if(!(this.y$j&&50>Ba.args.level))return;({value:S}=this.NQa.Dc(Ba.uploadId)).returnValue||(S=new Be(Ba.sessionId,Ba.version,Ba.ZAd,Ba.NWf),this.NQa.Z(Ba.uploadId,S));this.NQa.J(Ba.uploadId).cxa.add(Ba.args)}}eWf(S,Ba){this.NQa.remove(Ba.uploadId)}dWf(S,Ba){void 0!==Ba&&null!==Ba&&this.NQa.nb(Ba.uploadId)&&
this.wOi(Ba.uploadId)&&!this.h5g&&(this.h5g=!0,ma.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}wOi(S){let Ba=!1;if(({value:Sb}=this.NQa.Dc(S)).returnValue&&Sb&&0<Sb.cxa.count){if(Sb.ZAd>=this.MWa)return!1;var ib=Sb.cxa;const yc=Array(ib.count);for(let ed=0,Ud=ib.count;ed<Ud;++ed)yc[ed]=new Nc(ib.J(ed));ib=Ge.serialize(yc);var Sb=this.nFc(Sb.NWf,Sb.sessionId,Sb.version,Sb.ZAd);this.had(Sb,ib)&&(this.NQa.remove(S),Ba=!0)}return Ba}fSf(){this.dispose()}had(S,Ba){try{return this.XAa.setItem(S,
Ba),!0}catch(ib){return ma.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",ib.message),!1}}sendOfflineLogs(){if(!this.tWa){var S=0<this.Jub.length?this.Jub:this.qWb,Ba=S.length;if(Ba)for(;0<Ba;){l.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");Ba--;var ib=this.wGe?S.pop():S[0];this.wGe||Array.removeAt(S,0);const ed=Ge.kCj(ib,!0);if(cf(ed,this.Nxc,this.cLe,this.uVa,this.N_g)){var Sb=this.XAa.getItem(ib);
this.XAa.removeItem(ib);if(void 0!==Sb&&null!==Sb)if(ed.a>this.MWa)ma.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",ed.a,this.MWa);else if(ib=Ge.gad(Sb,!0),void 0!==ib&&null!==ib&&isFinite(ib.length))if(ib.length){Sb=ib[ib.length-1];var yc=(new Date).getTime()-Sb.ts;if(yc<-Ge.Eyj)ma.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Sb.ts);else if(yc>this.Mch*Ge.Eyj)ma.ULS.sendTraceTag(37290079,
222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.Mch,Sb.ts);else{ed.s===this.yBa?this.X4g||(this.X4g=!0,ma.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.W4g||(this.W4g=!0,ma.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",ed.s));Ba=Array(ib.length);for(Sb=0;Sb<ib.length;Sb++){S=Sb;a:{yc=ib[Sb];if(void 0===yc||null===yc){yc=null;break a}let Ud=null;yc.e&&(Ud=new Sc.a(null),Ud.name=
yc.e.n,Ud.stack=yc.e.s,Ud.message=yc.e.m,Ud.file=yc.e.f,Ud.line=yc.e.l,Ud.column=yc.e.c);yc=new kc.a(yc.ts,yc.c,yc.t,yc.l,yc.m,yc.lt,yc.o,yc.a,Ud)}Ba[S]=yc}this.KBa.Scj(this,Ba,ed.s,ed.v,ed.a+1,ed.i);break}}else ma.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Sb);else ma.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Sb)}}else this.qKd()}}LQa(S,Ba,ib){!this.$l&&ma.ULS.W9(Ba,ib)&&this.KXc.Z(S,!0)}dispose(){if(!this.$l){this.QS&&
this.Hb.We(this.QS);var S=Ab.toArray(this.NQa.keys);for(const Ba of S)this.wOi(Ba)}this.$l=!0}kRa(){this.tWa=!0;this.qKd()}xlb(){this.tWa=!1;this.qKd();this.QS&&this.Hb.We(this.QS);this.QS=new Qc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Hb.Wb(this.QS)}qKd(){this.QS&&(this.Hb.We(this.QS),this.QS=null)}static serialize(S){return JSON.stringify(S)}static kCj(S,Ba){(S=Ge.gad(S,Ba))&&void 0===S.d&&(S=new Gc(S.t,S.m,S.s,S.v,S.i,S.a,0));
return S}static gad(S,Ba){try{return JSON.parse(S)}catch(ib){Ba&&ma.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",ib.message)}return null}}Ge.Eyj=864E5;Object(f.a)(Ge,"OfflineLoggerImplV2",null,[1205,10,139]);class gf{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(S){return this.handleError("Length",S),-1}}key(S){try{return localStorage.key(S)}catch(Ba){return this.handleError("Key",
Ba),null}}getItem(S){try{return localStorage.getItem(S)}catch(Ba){return this.handleError("GetItem",Ba),null}}setItem(S,Ba){try{return localStorage.setItem(S,Ba)}catch(ib){return this.handleError("SetItem",ib),null}}removeItem(S){try{localStorage.removeItem(S)}catch(Ba){this.handleError("RemoveItem",Ba)}}clear(){try{localStorage.clear()}catch(S){this.handleError("Clear",S)}}handleError(S,Ba){ma.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",S,Ba.message)}}
Object(f.a)(gf,"OfflineStorage",null,[1204]);class Ie{create(S){var Ba=null;try{void 0!==localStorage&&null!==localStorage&&(Ba=new gf)}catch(Sb){ma.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Sb.message)}Object.getType(ma.ULS.host).implementsInterface(1174)&&Ba||(ma.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Ba?"supported":"not supported",Object.getType(ma.ULS.host).implementsInterface(1174)?"supported":
"not supported"),S=0);const ib=l.AFrameworkApplication.K;1===S?Ba=new me(l.AFrameworkApplication.pc,l.AFrameworkApplication.Ne,Ba,ma.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.mOh,ib.$("OfflineLoggerDataBoundarySupportIsEnabled")):2===S?(S=l.AFrameworkApplication.ta.Nb,Ba=new Ge(l.AFrameworkApplication.pc,l.AFrameworkApplication.Ne,Ba,ma.ULS.host,l.AFrameworkApplication.userSessionId,S.Sl,S.Sha,ib.mc("OfflineLoggerRetentionInDays",30),ib.mc("OfflineLoggerMaxAttempts",5),
ib.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),ib.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.mOh,ib.$("OfflineLoggerDataBoundarySupportIsEnabled"))):Ba=new Wb;Ba.init();return Ba}}Object(f.a)(Ie,"OfflineLoggerFactory",null,[]);class zf{xc(){}get name(){return"Common.App.OfflineLogger"}init(){const S=l.AFrameworkApplication.K;let Ba=0;S.$("OneNoteOfflineLoggerIsEnabled")?Ba=1:S.$("OfflineLoggerV2IsEnabled")&&(Ba=2);0!==Ba&&(l.AFrameworkApplication.Rig=(new Ie).create(Ba))}dispose(){}}
Object(f.a)(zf,"OfflineLoggerPackage",null,[1,2]);var uc=c(44),Rc=c(1377);class Dd{constructor(S){this.sLi=null;ma.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.pYc=l.AFrameworkApplication.K.jb("PhoneLinkServiceEndpoint");(this.a9=S)||ma.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.pYc&&this.pYc.length||ma.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}Uzl(S){S&&(this.pYc="https://dcg-df.microsoft.com/",
ma.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.Tzl()}Tzl(){ma.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.sLi)ma.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.sLi=new Date;var S=new Date;this.a9.PY("BayBridge",this.pYc).then(Ba=>{const ib=+new Date-+S;Ba.IsSuccess?(ma.ULS.sendTraceTag(527574723,306,
50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ib),this.Kzl(Ba.Token,this.bMl())):ma.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",ib,Ba.ErrorCode,Ba.ErrorMessage)}).catch(Ba=>{ma.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Ba,+new Date-+S)})}}Kzl(S,Ba){const ib={};ib.Authorization=
"Bearer "+S;ib["Authorization-Type"]="AAD";ib.Accept="application/json";ib["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.Ne.tj(Ba,1,null,ib,!1,2,Object(a.a)(this,this.Kcm,"getStatusSucceeded"),Object(a.a)(this,this.Icm,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");uc.a("FetchAccountLinkedStatus")}cOl(){const S=Rc.a.instance.getItem("AccountLinkedStatusCache");return S&&S.length?"true"===S.toLowerCase()?!0:!1:!1}bMl(){return this.pYc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Icm(){ma.ULS.sendTraceTag(527214156,
306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Kcm(S){ma.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");S=ab.a(S.data.we).state+"";Rc.a.instance.setItem("AccountLinkedStatusCache",S)}}Object(f.a)(Dd,"PhoneLinkManager",null,[1120]);class Id{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}xc(S){this.W=S;this.W.register(1120,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Rd(()=>new Dd(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Po(()=>
{this.h2a()})}h2a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){L.a.instance.Fc(new Id)}}Object(f.a)(Id,"PhoneLinkPackage",null,[1,2]);const Kd=S=>{try{return ab.a(S)}catch(Ba){}return null};class af{constructor(S,Ba,ib,Sb,yc,ed){this.tZ=!1;this.Cl=null;this.mNe=!1;this.ga=S;this.Yf=Ba;this.Nk=ib;this.i4g=Sb;this.Ma=yc;this.c$j=ed}init(S,Ba){Ba&&S.Sa("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.D2e,"awaitRtc"))}D2e(S){const Ba=S.sOc();Ba.continueWith(()=>
{this.Cl=Ba.result;this.mNe&&(this.Cl.aN(2,null,!0),this.mNe=!1);this.Cl.c3((ib,Sb)=>{2===Sb.type&&this.oc.processAction(n.a.fileNameUpdate,2)});this.Cl.Fta((ib,Sb)=>{2===Sb.newState&&this.oc.processAction(n.a.fileNameUpdate,2)});2===this.Cl.connectionState&&this.oc.processAction(n.a.fileNameUpdate,2)})}iOa(S){this.vXh(S,!0)}vXh(S,Ba){const ib=this.LNk(S.Usj),Sb={};Sb[af.bIh]=af.cIh;this.Gcj.tj(ib,2,"",Sb,!1,2,Object(a.a)(this,this.Hec,"onRefreshFilenameSuccess"),Ba?Object(a.a)(this,this.Grn,"onRefreshFilenameFailureRetry"):
Object(a.a)(this,this.gWi,"onRefreshFilenameFailureNoRetry"),S)}Hec(S){this.tZ=!1;const Ba=Kd(S.data.we);S.data.state.onSuccess(Ba,this.i4g.value)}Grn(S){5!==S.data.status||this.tZ?this.gWi(S):(this.tZ=!0,this.vXh(S.data.state,!1))}gWi(S){S.data.state.onFailure(-1)}LCb(S){this.wXh(S,!0)}wXh(S,Ba){const ib=this.MNk(),Sb={};Sb[af.bIh]=af.cIh;Sb[af.Mom]=Sa.a.Nj(S.Ncj);Sb[af.Kom]=this.c$j.value.UZk;this.Gcj.tj(ib,2,"",Sb,!1,2,Object(a.a)(this,this.S_c,"onRenameFileSuccess"),Ba?Object(a.a)(this,this.Mrn,
"onRenameFileFailureRetry"):Object(a.a)(this,this.iWi,"onRenameFileFailureNoRetry"),S)}MNk(){return this.jyh()}LNk(S){let Ba=this.jyh();return Ba=mc.a.lp(Ba,af.Qom,S?"2":"1")}jyh(){let S=(this.Ma.value.appSettings.RenameWebServiceBase||"")+af.Lom;S=mc.a.lp(S,af.Nom,Sa.a.Nj(l.AFrameworkApplication.hm));this.wn&&this.wn.$Cf&&(S=mc.a.lp(S,af.Pom,"1"));return S}S_c(S){this.tZ=!1;const Ba=Kd(S.data.we);S.data.state.onSuccess(Ba,this.i4g.value);this.XQi()}XQi(){this.Cl?this.Cl.aN(2,null,!0):this.mNe=!0}Mrn(S){5!==
S.data.status||this.tZ?this.iWi(S):(this.tZ=!0,this.wXh(S.data.state,!1))}iWi(S){S.data.state.onFailure(-1)}get oc(){return this.ga.value}get Gcj(){return this.Yf.value}get wn(){return this.Nk.value}static get instance(){return af._instance||(af._instance=af.CDb())}static CDb(){return new af(new jb.a(()=>l.AFrameworkApplication.va),new jb.a(()=>l.AFrameworkApplication.Ne),new jb.a(()=>l.AFrameworkApplication.wn),new jb.a(()=>va.a.instance.resolve("Postmessage.IHostPostmessenger")),new jb.a(()=>l.AFrameworkApplication.K),
new jb.a(()=>va.a.instance.resolve("Common.IRenameProps")))}}af.bIh="Content-Type";af.cIh="application/json; charset=utf-8";af.Lom="renamehandler.ashx";af.Nom="qs";af.Mom="n";af.Pom="sl";af.Kom="X-CoauthLockId";af.Qom="u";af._instance=null;Object(f.a)(af,"ExecuteRenameFileHandler",null,[]);class Dg{constructor(){this.onFailure=this.onSuccess=null;this.Usj=!1}}Object(f.a)(Dg,"ExecuteRefreshFilenameData",null,[]);class oi{constructor(){this.onFailure=this.onSuccess=this.Ncj=null}}Object(f.a)(oi,"ExecuteRenameFileData",
null,[]);class zg{constructor(){this.W=null;this.Sze=af.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}xc(S){this.W=S}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){l.AFrameworkApplication.vVc()&&(af.instance.init(this.W,l.AFrameworkApplication.s4c),l.AFrameworkApplication.LCb=Object(a.a)(this,this.LCb,"executeRenameFile"),l.AFrameworkApplication.iOa=Object(a.a)(this,this.iOa,"executeRefreshFilename"),l.AFrameworkApplication.n6c=Object(a.a)(this,
this.n6c,"sendFileNameAndLocationUpdateNotification"))}LCb(S,Ba,ib){const Sb=new oi;Sb.Ncj=S;Sb.onSuccess=Ba;Sb.onFailure=ib;this.Sze.LCb(Sb)}iOa(S,Ba,ib){const Sb=new Dg;Sb.onSuccess=S;Sb.onFailure=Ba;Sb.Usj=ib;this.Sze.iOa(Sb)}n6c(){this.Sze.XQi()}dispose(){}}Object(f.a)(zg,"PackageManager",null,[1,2]);var ec=c(175);class Bc{constructor(S,Ba,ib){this.geg=this.heg=this.ieg=!1;this.yeg=!S&&!Ba;this.zeg=!S&&!ib;this.yeg||this.zeg||(this.ieg=!S,this.heg=!Ba,this.geg=!ib)}}Object(f.a)(Bc,"RenameDisabledDialogInfo",
null,[]);class Vc extends ec.StandardDialog{constructor(S,Ba,ib,Sb,yc){super();this.yig=[];this.qea=new Bc(S,Ba,ib);this.cdb=Sb;this.Fab=yc;this.wg="RenameDisabledDialog";this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose);this.Ymo();this.K1n()}Ymo(){this.qea.yeg?this.q8c(this.cdb?this.Fab?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.qea.zeg?this.q8c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.Bsk();this.qDc(this.yig)}q8c(S){Array.add(this.yig,S)}Bsk(){const S=[];this.qea.ieg||Array.add(S,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.qea.heg||Array.add(S,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.qea.geg||Array.add(S,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<S.length&&Array.add(this.yig,S)}}Object(f.a)(Vc,"ReactRenameDisabledDialogBase",ec.StandardDialog,[]);class xd extends Vc{constructor(S,Ba,ib,Sb,yc){super(S,Ba,ib,Sb,yc)}K1n(){this.llb(CommonUIStrings.l_RenameFileRenameDisabledTitle,
null,null,null,null,null)}}Object(f.a)(xd,"ReactRenameDisabledDialog",Vc,[]);class ee{static get Xg(){return k.a.qA(ee.Lm,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}ee.Lm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(ee,"RenameDisabledDialogHtml",null,[]);class Me extends k.a{constructor(S,Ba,ib,Sb,yc){super();this.qea=new Bc(S,Ba,ib);this.cdb=Sb;this.Fab=yc;this.wg="RenameDisabledDialog";this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose);this.Xg=ee.Xg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.e5("RenameRow")}f9(){if(this.qea.yeg){let S;S=this.cdb?this.Fab?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Me.q8c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),S)}else this.qea.zeg?Me.q8c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.$rm()}$rm(){this.qea.ieg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.qea.heg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.qea.geg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static q8c(S,Ba,ib){S.style.display="none";Ba.innerText=ib}}Object(f.a)(Me,"RenameDisabledDialog",k.a,[]);class De{constructor(S,Ba){this.qvb=0;this.ga=S;this.TJa=Ba}initialize(S){if(!this.ga||!this.TJa)return!1;this.qvb=S;this.Tb();return!0}Tb(){this.ga.qa(n.a.A8e,y.a.frame,Object(a.a)(this,this.A8e,"commitNewDocumentTitle"))}A8e(S,Ba,ib,Sb,yc){if(1===ib)return this.ga.processAction(n.a.renameFile,
1);S=Sa.a.jJ(this.TJa.az);yc=(0,yc.getNewDocumentTitle)();yc.length>this.qvb&&(yc=yc.substr(0,this.qvb));if(32!==this.ga.Qb(n.a.renameFile,2,yc))return this.wmc(S),8;this.wmc(yc);return 32}wmc(S){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(S))}static Rl(){return new De(l.AFrameworkApplication.va,l.AFrameworkApplication.us)}}Object(f.a)(De,"ReactRenameUIHandler",null,[1206]);var oe=c(215),nf=c(1059),Qe=c(526),of=c(96),mf=c(161),jg=c(26);class pf{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,
Ue,Kf,Bg,Vh){this._initialized=!1;this._element=null;this.qvb=0;this.YQe=this.pDe=!1;this.ga=S;this.Qja=Ba;this.ae=ib;this.Zr=Sb;this.TJa=yc;this.Odh=ed;this.Gtd=Ud;this.dve=Xe;this.Z$a=Ue;this.n1g=Kf;this.vi=Bg;this.XEe=Vh}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(S,Ba,ib){if(!(this.ga&&this.TJa&&this.Odh&&this.Gtd&&this.dve&&Ba)||0>=S)return!1;this._element=Ba;this._element.title=ib;this._element.setAttribute(jg.a.qh,jg.a.f3);this._element.setAttribute("Unselectable",
"on");this.qvb=S;this.QB();return this._initialized=!0}QB(){this.Qja&&(this.Qja.mb(W.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Qja.mb(W.a.paste,this._element,Object(a.a)(this,this.K_c,"onPaste")));this.ae.mb(W.a.fi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Zr.mb(W.a.pointerDown,this._element,Object(a.a)(this,this.$C,"onPointerDown"));this.Zr.mb(W.a.VM,this._element,Object(a.a)(this,this.yxa,"onPointerUp"))}onBlur(){this.isActive&&!this.pDe&&(this.n1g||
this.dve(this._element),this.gGh(),this.Gcf(!1));return this.pDe=!1}K_c(){ma.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(S){return this.isActive?this.Von(S):this.Won(S)}Von(S){let Ba=!1;switch(S.Gb.keyCode){case Sys.UI.Key.enter:this.gGh();this.Gcf(this.vi||this.XEe);Ba=!0;break;case Sys.UI.Key.tab:this.n1g&&this.dve(this._element);break;case Sys.UI.Key.esc:this.x7f(),this.Gcf(this.vi||this.XEe),Ba=!0}return Ba}Won(S){let Ba=!1;switch(S.Gb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.pBj(this.XEe),
this.isActive&&this.Gtd(this._element),Ba=!0}return Ba}$C(){this.isActive||(this.pBj(!1),this.isActive&&(this._element.focus(),this.Gtd(this._element),this.YQe=!0));return!1}yxa(){return this.YQe?(this.Gtd(this._element),this.YQe=!1,!0):!1}kbc(){return 32===this.ga.processAction(n.a.renameFile,1)}gGh(){const S=Sa.a.jJ(this.TJa.az);let Ba=this._element.innerText.trim();Ba.length>this.qvb&&(Ba=Ba.substr(0,this.qvb));Ba!==S&&""!==Ba?32!==this.ga.Qb(n.a.renameFile,2,Ba)?this.x7f():this.wmc(Ba):this.x7f()}x7f(){this.wmc(Sa.a.jJ(this.TJa.az))}wmc(S){this._initialized&&
(this._element.innerText=S,this.Odh())}pBj(S){this.kbc()?this.isActive||(S&&(this.pDe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(jg.a.qh,jg.a.Huh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,oe.CuiHelper.fUh),this.Z$a&&this.Z$a.execute(Ba=>{Ba.I5i(!0)}),S&&this._element.focus(),ma.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(n.a.Mjc,
2)}Gcf(S){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(jg.a.qh,jg.a.f3);Sys.UI.DomElement.removeCssClass(this._element,oe.CuiHelper.fUh);this.Z$a&&this.Z$a.execute(Ba=>{Ba.I5i(!1)});S&&(this._element.blur(),this._element.focus())}static tya(){nf.a.tya(l.AFrameworkApplication.isRtl)}static Rl(){return new pf(l.AFrameworkApplication.va,Qe.a.instance,of.KeyInputManager.instance,mf.a.instance,l.AFrameworkApplication.us,pf.tya,
ha.a.bbo,ha.a.XDh,va.a.instance.Sa("Common.App.Header.HeaderEventSource"),Fa.a.l4,Fa.a.ui,Fa.a.jj)}}Object(f.a)(pf,"RenameUIHandler",null,[1206]);class xb{static get instance(){return l.AFrameworkApplication.ta.Nb.wJ?xb._instance||(xb._instance=De.Rl()):xb._instance||(xb._instance=pf.Rl())}}xb._instance=null;Object(f.a)(xb,"RenameUIHandlerFactory",null,[]);var Tb=c(150);class Xc{constructor(){this.pQf=this.Bfn=this.zfl=null}}Object(f.a)(Xc,"RenameMruEntryProperties",null,[]);var Fd=c(162),Se=c(85),
pd=c(1551),lf;(function(S){S[S.unknown=-1]="unknown";S[S.success=0]="success";S[S.renameInvalidFileName=1]="renameInvalidFileName";S[S.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";S[S.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";S[S.permissionDenied=4]="permissionDenied";S[S.serverCommunicationFailure=5]="serverCommunicationFailure";S[S.fileNameTooLong=6]="fileNameTooLong"})(lf||(lf={}));Object(f.b)("CommonOperationResult",lf);class Ze{constructor(S,Ba,ib,Sb,yc,ed,
Ud,Xe,Ue,Kf,Bg,Vh){this.G1g=S;this.ga=Ba;this.Nk=ib;this.KL=Sb;this.Zub=yc;this.wnk=ed;this.cdb=Ud;this.Jjh=Xe;this.lgk=Ue;this.Fab=Kf;this.Ma=Bg;this.kgk=Vh}Tb(){l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.wJ||this.oc.qa(n.a.e$b,y.a.frame,Object(a.a)(this,this.e$b,"initializeRenameUIHandler"));this.oc.qa(n.a.Mjc,y.a.frame,Object(a.a)(this,this.Mjc,"showRenameDisabledDialog"));this.oc.qa(n.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.oc.fb(n.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.RSn,"refreshFilename"),64);this.oc.fb(n.a.C4d,y.a.frame,Object(a.a)(this,this.C4d,"moveToFolderCompleteByHost"),64);this.oc.qa(n.a.DJb,y.a.frame,Object(a.a)(this,this.DJb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ta&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.PO().execute(S=>{S.Av(Se.a.TOi);S.OB(Se.a.TOi,Ze.nPn);S.Av(Se.a.xjf);S.OB(Se.a.xjf,Ze.lPn)})}kbc(){return 0===this.kgk.Gei()?32:8}a_o(){return this.wn?this.cdb?this.wn.kTh:this.wn.$gb:!0}e$b(){return xb.instance.initialize(l.AFrameworkApplication.CLd,l.AFrameworkApplication.bTh,l.AFrameworkApplication.Taj||CommonUIStrings.l_RenameFileTooltip)?32:8}Mjc(){const S=this.a_o(),Ba=this.wnk();ma.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Zub,Ba,S,this.cdb);l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.lF&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new xd(this.Zub,!Ba,!S,this.cdb,this.Fab()):new Me(this.Zub,!Ba,!S,this.cdb,this.Fab());return 32}renameFile(S,Ba,ib,Sb,yc){if(1===ib)return this.kbc();if(!l.AFrameworkApplication.LCb)return 8;if(8===this.kbc())return this.oc.processAction(n.a.Mjc,2),8;ma.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.LCb(yc,Object(a.a)(this,
this.S_c,"onRenameFileSuccess"),Object(a.a)(this,this.Lrn,"onRenameFileFailure"));l.AFrameworkApplication.Saj=!0;return 32}S_c(S,Ba){S?0!==S.OperationResult?this.Mki(S.OperationResult):(this.Sco(Ba,S.NewName),this.XRo(S,Object(a.a)(l.AFrameworkApplication.ta.Nb,l.AFrameworkApplication.ta.Nb.ZFj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ta.updateCommandUI(),this.lgk.ODj()):this.Mki(5)}Sco(S,Ba){const ib={};ib[Fd.a.wAl]=
Ba;S.sendMessage(Se.a.xjf,ib)}XRo(S,Ba){this.kSo(S);l.AFrameworkApplication.zId=S.DirectInvokeDavUrl;Ba=Ba(S.EditDocInClientUrl);const ib=new Xc;ib.pQf=this.KL.az;ib.zfl=Ba;ib.Bfn=S.EditDocInClientUrl;this.oc.Qb(n.a.Uaj,2,ib)}Mki(S){switch(S){case 1:S=new ec.StandardDialog,S.Ad=0,S.fV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Edj()}}kSo(S){this.KL.az=Ze.FCk(this.KL.az,S.NewName);S.BreadcrumbFolderName&&(this.KL.breadcrumbFolderName=S.BreadcrumbFolderName);
S.BreadcrumbFolderUrl&&(this.KL.breadcrumbFolderUrl=S.BreadcrumbFolderUrl);this.Jjh(S.NewName)}Lrn(S){const Ba=new ec.StandardDialog;Ba.Ad=0;switch(S){case 1:ma.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Ba.cja(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ma.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Ba.cja(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:ma.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:S}),Ba.cja(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.PO().execute(ib=>{ib.sendMessage(Se.a.vAl,{["FailureMessage"]:lf[S]})});this.Edj()}RSn(S,Ba,ib){if(1===ib)return this.kbc();if(!l.AFrameworkApplication.iOa)return 8;l.AFrameworkApplication.iOa(Object(a.a)(this,this.Hec,"onRefreshFilenameSuccess"),Object(a.a)(this,this.A7d,"onRefreshFilenameFailure"),
!1);return 32}DJb(S,Ba,ib,Sb,yc){if(1===ib)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===ib){const ed={};S=l.AFrameworkApplication.mkb;Ba=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");S=(!S||S&&Ba)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ed[Fd.a.IDo]=S;yc&&yc.MoveButtonClickedTime&&(ed[Fd.a.Mdn]=yc.MoveButtonClickedTime.getTime());l.AFrameworkApplication.PO().execute(Ud=>{Ud.sendMessage(Se.a.DJb,
ed)});if(yc&&yc.MoveButtonClickedTime){if(S=Tb.a.fG())yc=(new Date).getTime()-yc.MoveButtonClickedTime.getTime(),S.set("MovePostDuration",yc.toString());Ja.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",S)}return 32}return 8}C4d(S,Ba,ib,Sb,yc){if(1===ib)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.kbc():8;if(2===ib){if(!l.AFrameworkApplication.n6c)return Ja.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!yc)return Ja.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(yc[Fd.a.AHm])if(yc[Fd.a.GHj])if(S=yc[Fd.a.GHj].toLowerCase(),Ba=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),ib=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Ba&&l.AFrameworkApplication.mkb&&ib){const ed={};ed[Fd.a.Mgc]="1";ed[Fd.a.documentUrl]=S;ed[Fd.a.reason]=pd.a.L8f;Ja.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.PO().execute(Ud=>{Ud.sendMessage(Se.a.iCb,ed)})}else if(!l.AFrameworkApplication.mkb&&ib)Ja.Health.instance.recordKpiSuccess("MoveToFolder",null),ha.a.om(S,ha.a.dra(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ja.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ja.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.iOa(Object(a.a)(this,this.Hec,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.A7d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.n6c(),Ja.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}wto(S,Ba){return S&&Ba?S!==this.KL.breadcrumbFolderName||Ba!==this.KL.breadcrumbFolderUrl:!1}Hec(S,Ba){S&&(S.NewName!==Sa.a.jJ(this.KL.az)||this.wto(S.BreadcrumbFolderName,S.BreadcrumbFolderUrl))&&this.S_c(S,Ba)}A7d(){}Edj(){this.Jjh(Sa.a.jJ(this.KL.az))}get oc(){return this.ga.value}get wn(){return this.Nk.value}static get instance(){return Ze._instance||
(Ze._instance=Ze.CDb())}static CDb(){return new Ze(l.AFrameworkApplication.vVc,new jb.a(()=>l.AFrameworkApplication.va),new jb.a(()=>l.AFrameworkApplication.wn),l.AFrameworkApplication.us,l.AFrameworkApplication.Woa,()=>l.AFrameworkApplication.Eng,l.AFrameworkApplication.s4c,Object(a.a)(xb.instance,xb.instance.wmc,"updateTitle"),va.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.kv,l.AFrameworkApplication.K,va.a.instance.resolve("Common.IRenameProps"))}static FCk(S,
Ba){S=Sa.a.Ega(S);return Ba+S}static nPn(S){const Ba=S.Values[Fd.a.kNm];ma.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Ba);Ba?l.AFrameworkApplication.va.Qb(n.a.C4d,2,S.Values):Ja.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static lPn(S){l.AFrameworkApplication.va.Qb(n.a.renameFile,2,S.Values.NewName)}}Ze._instance=null;Object(f.a)(Ze,"RenameActor",null,[]);var Vg=c(177),Pi=c(1383),Sh=c(566),wh=c(397);class rm{constructor(S,
Ba){this.ga=S;this.Brc=Ba}Tb(){this.ga.qa(n.a.teg,y.a.frame,Object(a.a)(this,this.owo,"showRenameDialogAction"))}owo(S,Ba,ib){S=32;if(1===ib)return wh.SessionStatusManager.instance.Aj||l.AFrameworkApplication.yoa?8:32;2===ib&&(32!==this.ga.processAction(n.a.renameFile,1)?(this.ga.processAction(n.a.Mjc,2),Vg.a.instance.Yb(Pi.a.gna,{["Reason"]:Sh.a.a1n}),S=8):32===this.ga.processAction(n.a.Njc,1)?this.ga.processAction(n.a.Njc,2):this.Brc.value.create().jTa());return S}}Object(f.a)(rm,"RenameDialogActor",
null,[1180]);class xf{constructor(S,Ba,ib){this.dialog=null;this.ga=S;this.KL=Ba;this.H$a=ib}W9l(){const S={};S.nameInputProps={["type"]:"AppInputProps",["id"]:xf.S4b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Sa.a.jJ(this.KL.az),["maxLength"]:this.H$a};return S}jTa(){const S={["id"]:"RenameDialog",["bodyControls"]:this.W9l()};this.dialog=new k.a(!1,!1,!0);this.dialog.Ad=1;this.dialog.wg="RenameDialog";this.dialog.Yh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.R5f,"renameDialogHandler"),
S)}R5f(S,Ba){if(Ba&&1===S){if(Ba[xf.S4b]&&(S=Sa.a.jJ(this.KL.az),Ba=(Ba[xf.S4b]||"").trim(),Ba!==S&&""!==Ba)){this.ga.Qb(n.a.renameFile,2,Ba);return}Vg.a.instance.Yb(Pi.a.O4b,{["Reason"]:Sh.a.XYh})}}}xf.S4b="txtDocumentName";Object(f.a)(xf,"ReactRenameDialog",null,[1207]);class lg{static get Xg(){return k.a.qA(lg.Lm,CommonUIStrings.l_RenameDialogLabel)}}lg.Lm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(lg,"RenameDialogHtml",null,[]);class nd extends k.a{constructor(S,Ba,ib){super();this.ga=S;this.KL=Ba;this.H$a=ib;this.wg="RenameDialog";this.Xg=lg.Xg}jTa(){var S={["txtDocumentName"]:Sa.a.jJ(this.KL.az)};this.Yh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.R5f,"renameDialogHandler"),S);S=document.getElementById(nd.S4b);0<this.H$a&&(S.maxLength=this.H$a);S.focus()}R5f(S,Ba){if(1===S&&(S=Sa.a.jJ(this.KL.az),Ba=(Ba[nd.S4b]||"").trim(),Ba!==S&&""!==Ba)){this.ga.Qb(n.a.renameFile,
2,Ba);return}Vg.a.instance.Yb(Pi.a.O4b,{["Reason"]:Sh.a.XYh})}}nd.S4b="txtDocumentName";Object(f.a)(nd,"RenameDialog",k.a,[1207]);class ud{constructor(S){this.TJa=null;this.H$a=0;this.ga=S;this._initialized=!1}initialize(S,Ba){this.TJa=S;this.H$a=Ba;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.lF&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new xf(this.ga,this.TJa,this.H$a):new nd(this.ga,this.TJa,this.H$a):null}}Object(f.a)(ud,
"RenameDialogFactory",null,[1181]);var Bd=c(166),kl=c(106);class fi{constructor(S,Ba){this.ga=S;this.Ub=Ba}Tb(){this.ga.qa(n.a.Njc,y.a.frame,Object(a.a)(this,this.pwo,"showRenameFlyoutAction"))}iSk(){return G.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ta.Nb.wJ}pwo(S,Ba,ib){if(1===ib)return this.iSk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}puk(){fi.BRm&&l.AFrameworkApplication.uJ&&kl.a.instance.Wb(new Qc.a(5,1,5E3,()=>{32===this.ga.processAction(n.a.Njc,
1)&&this.Ub&&this.Ub.currentScope.name===Bd.AFrame.Pn&&(uc.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(n.a.Njc,2))}))}static get BRm(){fi.Imd&&null!=fi.Imd||(l.AFrameworkApplication.te("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),fi.Imd=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return fi.Imd}}fi.Imd=null;Object(f.a)(fi,"RenameFlyoutActor",
null,[1179]);class ji{constructor(S,Ba,ib,Sb,yc){this.UZk=null;this.Nk=yc;this.H1g=ib;this.G1g=Sb;this.ynk=S;this.Fab=Ba}get wn(){return this.Nk.value}Gei(){if(!this.G1g())return 5;if(this.Fab())return 1;if(this.wn){if(this.H1g&&!this.wn.kTh)return 3;if(!this.H1g&&!this.wn.$gb)return 4}return this.ynk()?0:2}}Object(f.a)(ji,"RenameProps",null,[1178]);class wi{constructor(S,Ba,ib,Sb,yc,ed){this.Hs=!1;this.VHe=new Bb.a;this.eUb=Ba;this.Oz=ib;this.cTb=Sb;this.Ma=yc;this.rla=ed}enable(){this.Hs||(this.ODj(),
this.Vfg(),this.Hs=!0)}generateKey(S,Ba,ib){return String.format("{0}/{1}/{2}",ib,S,Ba)}E_l(){const S=Sa.a.jJ(this.eUb().az);return this.generateKey(this.eUb().breadcrumbFolderName,this.eUb().breadcrumbFolderUrl,S)}F_l(S,Ba,ib){return S&&Ba?this.generateKey(S,Ba,ib):ib}wml(S,Ba,ib){return S&&S!==this.eUb().breadcrumbFolderName||Ba&&Ba!==this.eUb().breadcrumbFolderUrl?!0:ib!==Sa.a.jJ(this.eUb().az)}ODj(){const S=this.E_l();this.VHe.Z(S,new Date)}OYf(S){this.Fro(S)&&this.bmh(S)}Fro(S){const Ba=this.cTb();
return Ba?this.rla&&this.rla.Ao||!Ba.$Cf||!l.AFrameworkApplication.iOa?(this.ovj(S),this.Hs=!1):!0:!1}fXi(S,Ba,ib,Sb){const yc=this.wml(S,Ba,ib);S=this.F_l(S,Ba,ib);Ba=this.VHe.Dc(S).returnValue;yc&&!Ba&&(this.Oki(Sb),ma.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.wKf));yc||this.VHe.Z(S,this.Oz())}}Object(f.a)(wi,"ARenamedFileChecker",null,[1144]);class xl extends wi{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe){super(S,Ba,ib,Sb,yc,ed);this.yK=yc;this.jgk=Ud;this.SCe=Xe}get wKf(){return"RenamedFileCheckerUsingSettingsRefresh"}Vfg(){this.yK.LDc(Object(a.a)(this,
this.lli,"handleSettingsRefresh"))}lli(S,Ba){Ba&&Ba.NJb&&Ba.VRi&&(Ba.rQa("BreadcrumbDocName")||Ba.rQa("BreadcrumbFolderName")||Ba.rQa("BreadcrumbFolderUrl")||Ba.rQa("DirectInvokeDAVUrl")||Ba.rQa("EditDocInClientUrl"))&&(ma.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.wKf),this.OYf(Ba))}ovj(){this.yK.I5f(Object(a.a)(this,this.lli,"handleSettingsRefresh"))}bmh(S){if(S&&S.NJb){const Ba=S.NJb;this.fXi(Ba.jb("BreadcrumbFolderName"),Ba.jb("BreadcrumbFolderUrl"),Ba.jb("BreadcrumbDocName"),
S)}}Oki(S){const Ba={OperationResult:0,classId:1};S=S.NJb;Ba.BreadcrumbFolderName=S.jb("BreadcrumbFolderName");Ba.BreadcrumbFolderUrl=S.jb("BreadcrumbFolderUrl");Ba.DirectInvokeDavUrl=S.jb("DirectInvokeDAVUrl");Ba.EditDocInClientUrl=S.jb("EditDocInClientUrl");S=S.jb("BreadcrumbDocName");Ba.NewName=l.AFrameworkApplication.WId?S:Sa.a.jJ(S);this.SCe.execute(ib=>{this.ZDm(Ba,ib)})}ZDm(S,Ba){this.jgk().S_c(S,Ba)}}Object(f.a)(xl,"RenamedFileCheckerUsingSettingsRefresh",wi,[]);class Fl extends wi{constructor(S,
Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf){super(S,ib,Sb,yc,ed,Ue);this.Hzc=this.il=null;this.yek=Ba;this.ga=Ud;this.Hb=Xe;Kf&&Kf.execute(Bg=>{this.iXn(Bg)})}get wKf(){return"RenamedFileCheckerUsingTask"}iXn(S){this.il=S;this.il.ZYa(Object(a.a)(this,this.IX,"handleVisibilityChange"))}IX(S,Ba){!this.Hs||0!==Ba.newState&&1!==Ba.newState||this.Hzc||(this.Vfg(),this.OYf(this.Hzc))}Vfg(){this.Hzc=new Qc.a(3,2,this.yek(),Object(a.a)(this,this.OYf,"performRenameFileCheckTick"),89);this.Hb.Wb(this.Hzc)}ovj(S){this.Hb.We(S)}bmh(S){this.il&&
2===this.il.rC?this.YYn(S):l.AFrameworkApplication.iOa(Object(a.a)(this,this.Hec,"onRefreshFilenameSuccess"),Object(a.a)(this,this.A7d,"onRefreshFilenameFailure"),!0)}YYn(S){this.Hb.We(S);this.Hzc=null}Hec(S){S&&this.fXi(S.BreadcrumbFolderName,S.BreadcrumbFolderUrl,S.NewName,null)}Oki(){this.ga.processAction(n.a.fileNameUpdate,2)}A7d(){}}Object(f.a)(Fl,"RenamedFileCheckerUsingTask",wi,[]);var di=c(65);class Xi{constructor(){this.Ma=this.W=null}get name(){return"Common.App.RenameFile"}xc(S){this.W=
S;this.Ma=l.AFrameworkApplication.K;this.W.register(rm,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Rd(()=>new rm(l.AFrameworkApplication.va,this.W.Ue("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(ud,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Rd(()=>new ud(l.AFrameworkApplication.va)).singleInstance();this.W.register(1144,"Common.App.Rename.IRenamedFileChecker").Rd(()=>this.xcl()).singleInstance();
this.W.register(fi,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Rd(()=>new fi(l.AFrameworkApplication.va,di.FocusManager.instance())).singleInstance()}xcl(){if(this.Ma.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const S=this.W.Na("Common.IRefreshableAppSettings");if(S&&S.oAi)return new xl(()=>S.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.us,()=>new Date,()=>l.AFrameworkApplication.wn,S,this.W.Na("Common.ISessionStatus"),()=>
Ze.instance,this.W.Sa("Postmessage.IHostPostmessenger"))}return new Fl(()=>this.Ma.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ma.mc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.us,()=>new Date,()=>l.AFrameworkApplication.wn,l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.pc,this.W.Na("Common.ISessionStatus"),this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ma.Po(Object(a.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){const S=
l.AFrameworkApplication.ta.Nb.wJ;l.AFrameworkApplication.vVc()&&xb.instance.initialize(l.AFrameworkApplication.CLd,S?null:l.AFrameworkApplication.bTh,S?null:l.AFrameworkApplication.Taj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(ji,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Rd(()=>new ji(()=>l.AFrameworkApplication.Eng,()=>l.AFrameworkApplication.kv,l.AFrameworkApplication.s4c,l.AFrameworkApplication.vVc,new jb.a(()=>l.AFrameworkApplication.wn))).singleInstance(),Ze.instance.Tb(),
this.Ma.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.us,l.AFrameworkApplication.CLd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Tb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Tb(),l.AFrameworkApplication.s4c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").puk())}dispose(){}}Object(f.a)(Xi,"PackageManager",null,[1,2]);class Yi{static get Xg(){return k.a.qA(Yi.Lm,
CommonUIStrings.l_SaveACopyFileName)}}Yi.Lm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(f.a)(Yi,"FileNameDialogHtml",null,[]);class sm extends k.a{constructor(S,Ba,ib,Sb){super();this.bjd=this.pKa=null;
this.ga=S;this.ora=Ba;this.zCc=ib;this.Ee(1,CommonUIStrings.l_SaveButtonLabel);this.Xg=Yi.Xg;this.wg="FileNameDialog-SaveACopy";this.Um=Sb}DDa(S,Ba,ib){this.bjd=S;this.pKa=ib;S={["txtFileName"]:Sa.a.jJ(l.AFrameworkApplication.us.az),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Ba)};this.Yh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.BLd,"fileNameDialogHandler"),S);ma.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}BLd(S,
Ba){1!==S?ma.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(S=Ba.txtFileName.trim(),ma.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Ba=Sa.a.Ega(l.AFrameworkApplication.fileName),S&&""!==S&&""!==Ba&&(S+=Ba),this.zCc.PHa(this.bjd,this.pKa,S,this.Um))}}Object(f.a)(sm,"FileNameDialog",k.a,[1182]);class Fg{constructor(S,Ba,ib){this.ga=S;this.ora=Ba;this.zCc=ib}create(S){return new sm(this.ga,this.ora,this.zCc,S)}}Object(f.a)(Fg,
"FileNameDialogFactory",null,[1153]);class $f extends ec.StandardDialog{constructor(S){super();this.Ad=1;this.Ee(1,CommonUIStrings.l_RetryButtonLabel);this.Ee(0,CommonUIStrings.l_DialogClose);this.ga=S}sO(S){ma.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",S);this.mx(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.N7f,"retryDialogHandler"))}N7f(S){1===S?(ma.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(n.a.Rhc,
2)):ma.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(f.a)($f,"RetryDialog",ec.StandardDialog,[1152]);var Qi=c(220);class em{constructor(S,Ba,ib,Sb){this.Qsd=null;this.Ahk=S;this.Ma=ib;this.q9g=Ba;this.B4g=new z.a;this.ge=Sb}Ibc(){return this.Ma.$("SaveToCloudStorageUIIsEnabled")}Xgb(){return n.a.U8f}gCd(){Qb.a.C3c(Object(a.a)(this,this.dgj,"saveToCloudActionDispatcher"));Qb.a.KKc([new Qi.a(n.a.U8f,y.a.frame,0)],this.q9g.V7b())}Tb(){const S=this.q9g.V7b();S?(S.UZ(()=>{this.B4g.zg(!0)}),
this.gCd()):ma.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}c7i(){ma.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}dgj(S,Ba,ib,Sb,yc){return Ba.contextId!==y.a.frame||S!==this.Xgb()?2:this.Ibc()?1===ib?wh.SessionStatusManager.instance.Aj||l.AFrameworkApplication.yoa?8:32:2===ib?(this.c7i(),yc&&yc.FileDownloadUrl&&ma.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.ge&&
(this.Qsd=this.ge.$f("DialogShown","SaveToOneDriveReponseTime")),this.B4g.task.continueWith(()=>{this.Qsd&&(this.Qsd.stop(),this.Qsd=null);this.Ahk.start(yc)}),32):8:8}}Object(f.a)(em,"SaveToCloudStorageActor",null,[1159]);class Zi extends em{constructor(S,Ba,ib,Sb){super(S,Ba,ib,Sb);this.bdk=Ba}Ibc(){return this.Ma.$("SaveACopyBrsIsEnabled")}Xgb(){return n.a.Rhc}gCd(){Qb.a.C3c(Object(a.a)(this,this.dgj,"saveToCloudActionDispatcher"));Qb.a.KKc([new Qi.a(n.a.Rhc,y.a.frame,0)],this.bdk.V7b())}c7i(){l.AFrameworkApplication.te("CreateCopy_cf;CreateCopy_tf");
ma.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(Zi,"SaveACopyActor",em,[]);class Tg{}Tg.default=0;Object(f.a)(Tg,"SaveToCloudErrorCodes",null,[]);class Ri{constructor(S,Ba,ib,Sb,yc,ed){this.Um=null;this.sjk=S;this.$sa=Ba;this.zCc=ib;this.Ma=Sb;this.pSb=yc;this.gH=ed}start(S){this.Um=S;if("SharePointOnlineConsumer"===this.Ma.jb("FileSource")){const Ba=va.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(Ba){Ba.start(null,
S);return}}this.$sa.jTc?(ma.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.gRk()):(ma.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.ywo())}ywo(){this.sjk.create().DDa()}zp(){this.gH().sO(Tg.default)}gRk(){try{ma.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let S={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.pSb||2===this.pSb)S={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId};
WL.init(S);ma.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Sl?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(S){ma.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",S,S.stack),this.zp()}}onSuccess(S){ma.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");S&&S.data&&S.data.folders&&this.zCc.PHa(S.data.folders[0].id,S.data.folders[0].urls.viewInBrowser,null,this.Um)}onFailure(S){if(S&&S.error){if("user_canceled"===S.error.code){ma.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ma.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",S.error.code,S.error.message)}else ma.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.zp()}}Object(f.a)(Ri,"SaveToCloudManager",null,[1160]);class cj extends Ri{constructor(S,Ba,ib,Sb,yc,ed,Ud){super(Ba,ib,Sb,yc,ed,Ud);this.i2j=S}onSuccess(S){S&&S.data&&S.data.folders?(ma.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.i2j.create(this.Um).DDa(S.data.folders[0].id,S.data.folders[0].name,S.data.folders[0].urls.viewInBrowser)):(ma.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.zp())}onFailure(S){S&&S.error&&"user_canceled"===S.error.code&&ma.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(S)}zp(){ma.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.zp()}}Object(f.a)(cj,"SaveACopyManager",Ri,[]);var Fh=c(197);class Kh{constructor(S,Ba,ib,Sb,yc){this.pKa=this.Bk=this.Bpc=null;this.tZ=!1;this.Um=this.DYa=null;this.mWe=S;this.uXa=Ba;this.gH=ib;this.Ti=Sb;this.ge=yc}P6a(){this.Ti&&1===
this.Ti.state||(this.Bk=this.uXa(),this.Bk.message=CommonUIStrings.l_CommentProgressTooltip,this.Bk.Ad=5,this.Bk.yt=!1,this.Bk.rL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Pma(){this.Bk&&(this.Bk.close(),this.Bk=null)}m5(){1!==l.AFrameworkApplication.ta.state&&this.gH().sO(Tg.default)}yMb(){ma.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");ha.a.om(this.pKa,ha.a.dra(3),void 0,"UploadToCloudManager.RedirectToFolder")}xMb(S){let Ba=!1,ib=!1;l.AFrameworkApplication.K&&(Ba=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),
ib=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ma.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Sl?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",S,Ba);if(Ba&&ib){ma.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Sb={};Sb[Fd.a.Mgc]="1";Sb[Fd.a.documentUrl]=S;l.AFrameworkApplication.PO().execute(yc=>{yc.sendMessage(Se.a.iCb,
Sb)})}else ha.a.om(S,ha.a.dra(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}PHa(S,Ba,ib=null,Sb=null){ma.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.ge&&(this.DYa=this.ge.$f("DialogShown","SaveToOneDriveUploadTime"));this.P6a();this.pKa=Ba;this.Bpc=this.mWe.create(S,ib,Sb);this.Um=Sb;this.kga()}kga(){ma.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Bpc.execute(Object(a.a)(this,this.Asn,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.zsn,"onSaveToCloudUploadFailed"))}Asn(S){this.Pma();
this.tZ=!1;if(S&&S.data&&S.data.we){var Ba;if(({Yu:Ba}=ab.d(S.data.we)).returnValue)if(S=Ba,S.StatusCode!==Fh.a.Jy&&S.StatusCode!==Fh.a.zIc)ma.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.m5();else{ma.ULS.sendTraceTag(6590603,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Sl?15:50,"UploadToCloudManager upload success.");try{S.NewDocumentUrl&&""!==S.NewDocumentUrl?this.xMb(S.NewDocumentUrl):
this.yMb()}catch(ib){ma.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ib.toString())}this.j1c()}else ma.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:yb.a.Y$c(S.data.we)}),this.m5()}else ma.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.m5()}zsn(S){5!==S.data.status&&12!==S.data.status||this.tZ?(ma.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",S.data.status),
this.Pma(),this.m5(),this.j1c()):(ma.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.tZ=!0,this.kga())}j1c(){this.DYa&&(this.DYa.stop(),this.DYa=null)}}Object(f.a)(Kh,"UploadToCloudManager",null,[1156]);class Ok extends Kh{constructor(S,Ba,ib,Sb,yc,ed){super(Ba,ib,Sb,yc,ed);this.ga=S}HFf(){return!!this.Um&&!!this.Um.SaveEntryPoint&&"VersionHistory"===this.Um.SaveEntryPoint.toString()}m5(){ma.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.HFf()&&
this.ga.Qb(n.a.Gde,2,{["FailureReason"]:"Unknown"});super.m5()}yMb(){ma.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.HFf()&&this.ga.processAction(n.a.N4c,2);super.yMb()}xMb(S){ma.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",S);this.HFf()&&this.ga.processAction(n.a.N4c,2);super.xMb(S)}kga(){this.Um&&"true"===this.Um.SkipSaveToHost?super.kga():32!==this.ga.processAction(n.a.ANb,1)?(ma.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.kga()):this.ga.Qb(n.a.ANb,2,[()=>{ma.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Kh.prototype.kga.call(this)},()=>{ma.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.m5()}])}}Object(f.a)(Ok,"SaveACopyUploadToCloudManager",Kh,[]);var uj=c(745),tl=c(1198);class Lj{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Mx,
"onFullAppSettingsReady"))}Mx(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Tb()}dispose(){}xc(S){this.W=S;this.W.register(Ok,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Rd(()=>new Ok(l.AFrameworkApplication.va,S.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new tl.a).create(),()=>new $f(l.AFrameworkApplication.va),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Gq)).singleInstance();this.W.register(Fg,
"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Rd(()=>new Fg(l.AFrameworkApplication.va,l.AFrameworkApplication.ta.Nb,S.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();this.W.register(Zi,"Common.App.SaveACopy.SaveACopyActor").Rd(()=>new Zi(S.resolve("Common.App.SaveACopy.SaveACopyManager"),S.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Gq)).singleInstance();
this.W.register(cj,"Common.App.SaveACopy.SaveACopyManager").Rd(()=>new cj(S.resolve("Common.App.SaveACopy.FileNameDialogFactory"),S.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),uj.a.instance,S.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.a8,()=>new $f(l.AFrameworkApplication.va))).singleInstance()}static main(){L.a.instance.Fc(new Lj)}}Object(f.a)(Lj,"PackageManager",null,[1,2]);var yl=c(50);class Lh extends ec.StandardDialog{constructor(S,
Ba){super();this.uXb=!1;this.DN=null;this.ga=S;this.Msc=Ba;this.FHa=!1}sO(S,Ba,ib){this.DN=Ba;this.uXb=ib;ma.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",S,ib);S=this.C6e(S);0===S?(this.Ad=6,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Ee(1,CommonUIStrings.l_DialogClose));0===S&&ma.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.mx(yl.a.O9n,this.vTl(S),this.uTl(S,Ba),Object(a.a)(this,this.N7f,"retryDialogHandler"),!0)}N7f(S){1===
S?(ma.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.DN?this.ga.Qb(n.a.O5c,2,[this.DN,this.uXb]):this.ga.processAction(n.a.O5c,2)):ma.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}C6e(S){return 0>S||6<S?(ma.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",S),0):S}uTl(S,Ba){S=this.C6e(S);return this.Msc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,Ba),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][S]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Ba),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][S]}vTl(S){S=this.C6e(S);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][S]}}Object(f.a)(Lh,"ErrorRetryDialog",ec.StandardDialog,[1184]);class Ck{constructor(S,Ba){this.Ma=S;this.ga=Ba;this.Msc=this.Ma.$("SaveToHostWithExtraCharsInFileName")}create(){return new Lh(this.ga,this.Msc)}}Object(f.a)(Ck,"ErrorRetryDialogFactory",null,[1155]);class lk extends k.a{constructor(S,Ba,ib,Sb,yc,ed,Ud=null){super();
this.q6=null;this.ga=Ba;this.ora=Sb;this.EYa=ed;this.Ma=S;this.gH=yc;this.Ti=ib;this.Msc=this.Ma.$("SaveToHostWithExtraCharsInFileName");this.Um=Ud;this.Ee(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Ti}IRh(S,Ba){this.hqa(1,!!S&&S!==Ba);this.q6=document.getElementById(lk.WYh);U.a.addHandler(this.q6,"change",Object(a.a)(this,this.B6d,"onFileNameChange"));U.a.addHandler(this.q6,"input",Object(a.a)(this,this.B6d,"onFileNameChange"));this.q6.focus()}VYh(S){return this.Msc?(new RegExp("["+
this.OWh('\\/:*?"<>|')+"]")).test(S):(new RegExp("["+this.OWh('\\/:*?"<>|#{}%~&')+"]")).test(S)}OWh(S){return S.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}owf(){const S=Sa.a.jJ(l.AFrameworkApplication.us.az);this.hqa(1,!!this.q6&&""!==this.q6.value&&this.q6.value!==S)}B6d(){this.q6&&window.setTimeout(()=>{this.owf()},0)}BLd(S,Ba){if(1!==S)ma.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{S=Ba[lk.WYh];Ba=lk.hZi in Ba?Ba[lk.hZi]:!1;ma.ULS.sendTraceTag(23881883,
216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Sa.a.C7i(S),Ba);const ib=Sa.a.Ega(l.AFrameworkApplication.fileName);(S=S?S.trim():null)&&""!==S&&""!==ib||1===this.ta.state?this.VYh(S)?this.gH.create().sO(1,S,Ba):this.EYa.PHa(S+ib,Ba,this.Um):this.gH.create().sO(2,S,Ba)}}dispose(){this.q6&&(U.a.removeHandler(this.q6,"change",Object(a.a)(this,this.B6d,"onFileNameChange")),U.a.removeHandler(this.q6,"input",Object(a.a)(this,this.B6d,"onFileNameChange")),this.q6=
null);super.dispose()}}lk.WYh="txtFileName";lk.hZi="chkOverwrite";Object(f.a)(lk,"FileNameDialogBase",k.a,[]);class Pk{static get Xg(){return k.a.qA(Pk.Lm,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Pk.Lm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(Pk,"FileNameDialogHtml",null,[]);class Fm extends lk{constructor(S,Ba,ib,Sb,yc,ed){super(S,Ba,ib,Sb,yc,ed);this.Xg=Pk.Xg;this.wg="FileNameDialog-SaveAsToHost"}DDa(S,Ba){const ib=Sa.a.jJ(l.AFrameworkApplication.us.az);Ba={["txtFileName"]:S||ib,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Ba};this.Yh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.BLd,"fileNameDialogHandler"),Ba);this.IRh(S,ib)}}Object(f.a)(Fm,"FileNameDialog",lk,[1183]);class fm{constructor(S,Ba,
ib,Sb,yc,ed){this.ga=Ba;this.Ma=S;this.ora=Sb;this.EYa=ed;this.gH=yc;this.Ti=ib}create(){return new Fm(this.Ma,this.ga,this.Ti,this.ora,this.gH,this.EYa)}}Object(f.a)(fm,"FileNameDialogFactory",null,[1154]);class gm{constructor(S,Ba,ib){this.EYa=ib;this.nAe=Ba;this.Ma=S}Tb(){2===l.AFrameworkApplication.ta.Nb.Sl?l.AFrameworkApplication.va.fb(n.a.O5c,y.a.frame,Object(a.a)(this,this.Mfj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.va.qa(n.a.O5c,y.a.frame,Object(a.a)(this,this.Mfj,"saveAsToHostActionDispatcher"))}Mfj(S,
Ba,ib,Sb,yc){return Ba.contextId!==y.a.frame||S!==n.a.O5c?2:this.Ma.$("SaveAsToHostBrsIsEnabled")?1===ib?wh.SessionStatusManager.instance.Aj||l.AFrameworkApplication.yoa?8:32:2===ib?(ma.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),S=this.nAe.create(),yc&&Object.getType(yc)===Array&&2===yc.length?S.DDa(yc[0],!!yc[1]):S.DDa(null,!1),32):8:8}}Object(f.a)(gm,"SaveAsToHostActor",null,[]);class kg{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe){this.Bk=null;this.uXb=this.tZ=
!1;this.DYa=this.Um=this.DN=null;this.Ma=Ba;this.Ela=this.Ma.appSettings.SaveAsToHostWebServiceBase;this.l_g=Sb;this.uXa=yc;this.Yf=ib;this.gH=ed;this.ge=Xe;this.Ti=Ud;this.ga=S;this.dWa=Ba.jb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}P6a(){1!==this.Ti.state&&(this.Bk=this.uXa(),this.Bk.message=CommonUIStrings.l_CommentProgressTooltip,this.Bk.Ad=5,this.Bk.yt=!1,this.Bk.rL(CommonUIStrings.l_DefaultDialogTitle,null,null))}m5(S=0){1!==this.Ti.state&&this.gH.create().sO(S,Sa.a.jJ(this.DN),
this.uXb)}yMb(){const S=this.Ma.appSettings.BreadcrumbFolderUrl;ma.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ha.a.om(S,ha.a.dra(3),void 0,"UploadToHostManager.RedirectToFolder")}xMb(S){let Ba=!1,ib=!1;this.Ma&&(Ba=this.Ma.$("SaveACopyIsEnabledForUiHost"),ib=this.Ma.$("UiHostSupportsDocRebootFeatures"));ma.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",S,Ba,ib);if(Ba&&ib){ma.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Sb={};Sb[Fd.a.Mgc]="1";Sb[Fd.a.documentUrl]=S;Sb[Fd.a.reason]=pd.a.L8f;l.AFrameworkApplication.PO().execute(yc=>{yc.sendMessage(Se.a.iCb,Sb)})}else Ba&&!ib&&l.AFrameworkApplication.zU?ha.a.om(S,ha.a.dra(4),void 0,"UploadToHostManager.RedirectToEditUrl"):ha.a.om(S,ha.a.dra(3),void 0,"UploadToHostManager.RedirectToEditUrl")}PHa(S,Ba,ib=null){ma.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.l_g&&
!this.l_g()&&this.Yf&&(this.ge&&(this.DYa=this.ge.$f("DialogShown","SaveAsToHostUploadTime")),this.P6a(),this.uXb=Ba,this.DN=S,(this.Um=ib)&&"true"===this.Um.SkipSaveToHost?this.NKd():this.kga())}kga(){32!==this.ga.processAction(n.a.ANb,1)?(ma.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.NKd()):this.ga.Qb(n.a.ANb,2,[()=>{ma.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.NKd()},(S,Ba)=>
{ma.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.m5(Ba)}])}Iun(S){this.Pma();this.tZ=!1;if(S&&S.data&&S.data.we)if(({Yu:Ba}=ab.d(S.data.we)).returnValue)if(S=Ba,S.StatusCode!==Fh.a.Jy&&S.StatusCode!==Fh.a.zIc){ma.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Ba={};Ba.FailureReason=S.StatusCode.toString();Ba.ExtraInfo=S.ExtraInfo;this.xSa(Ba);this.m5(parseInt(S.ExtraInfo))}else{ma.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.L6f();try{S.NewDocumentUrl&&""!==S.NewDocumentUrl?this.xMb(S.NewDocumentUrl):this.yMb()}catch(ib){ma.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ib.toString())}this.j1c()}else ma.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:yb.a.Y$c(S.data.we)}),this.xSa({["FailureReason"]:"Failed to deserialize response"}),this.m5();else ma.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.xSa({["FailureReason"]:"null response"}),this.m5()}Hun(S){5!==S.data.status&&12!==S.data.status||this.tZ?(ma.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:S.data.status,["HttpStatus"]:S.data.Qe}),this.xSa({["FailureReason"]:S.data.Qe.toString()}),this.Pma(),this.m5(),this.j1c()):(ma.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.tZ=!0,this.Um&&"true"===this.Um.SkipSaveToHost?this.NKd():this.kga())}Pma(){this.Bk&&
(this.Bk.close(),this.Bk=null)}j1c(){this.DYa&&(this.DYa.stop(),this.DYa=null)}L6f(){this.Um&&"VersionHistory"===this.Um.SaveEntryPoint&&this.ga.processAction(n.a.N4c,2)}xSa(S){this.Um&&"VersionHistory"===this.Um.SaveEntryPoint&&this.ga.Qb(n.a.Gde,2,S)}NKd(){let S=this.Ela+this.dWa;S=mc.a.lp(S,"qs",Sa.a.Nj(l.AFrameworkApplication.hm));S=mc.a.lp(S,"n",Sa.a.Nj((new Date).getTime().toString()));S=mc.a.lp(S,"ov",Sa.a.Nj(this.uXb.toString()));S=mc.a.lp(S,"fn",Sa.a.Nj(this.DN));this.Um&&this.Um.FileDownloadUrl&&
(S=mc.a.lp(S,"furl",Sa.a.Nj(this.Um.FileDownloadUrl)));this.Yf.tj(S,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.Iun,"onUploadFinished"),Object(a.a)(this,this.Hun,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(kg,"UploadToHostManager",null,[1143]);class $k{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Tb()}xc(S){this.W=S;this.W.register(Ck,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Rd(()=>new Ck(l.AFrameworkApplication.K,l.AFrameworkApplication.va)).singleInstance();this.W.register(kg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Rd(()=>new kg(l.AFrameworkApplication.va,l.AFrameworkApplication.K,l.AFrameworkApplication.Ne,
()=>l.AFrameworkApplication.Lk,()=>(new tl.a).create(),S.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Gq)).singleInstance();this.W.register(fm,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Rd(()=>new fm(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Nb,S.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),S.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(gm,"Common.App.SaveAsToHost.SaveAsToHostActor").Rd(()=>new gm(l.AFrameworkApplication.K,S.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),S.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){L.a.instance.Fc(new $k)}}Object(f.a)($k,"SaveAsToHostPackage",null,[1,2]);class am extends ec.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}sO(S){this.mx(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(f.a)(am,"ErrorDialog",ec.StandardDialog,[1152]);var bg=c(201);class Hd extends ec.StandardDialog{constructor(S,Ba,ib){super();this.ga=S;this.$sa=Ba;this.ora=ib;this.L$=!1;this.Ad=1;this.cV(1);this.Ee(1,CommonUIStrings.l_SignIn);this.Ee(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}DDa(){this.$sa.iph(Object(a.a)(this,this.cXi,"onSignIn"));this.Ju(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.Xzm,"inputHandler"))}Xzm(S){0===
S?(ma.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Sl?15:50,"User dismissed SignIn Dialog."),this.hide()):this.R9d()}uUk(){let S="2";if(this.ora)switch(this.ora.Sl){case 3:S="0";break;case 2:S="3";break;case 1:S="1"}return S}hide(){this.$sa.L_n(Object(a.a)(this,this.cXi,"onSignIn"));super.hide()}R9d(){var S=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";S=new bg.QueryStringBuilder(S);
S.Ce("prompt","1");S.Ce("cbcxt",this.uUk());l.AFrameworkApplication.dfa(S);ha.a.om(S.toString(),"LoginWindow",void 0,"SignInDialog")}cXi(){this.tha&&this.hide();ma.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Sl?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(n.a.U8f,2)}}Object(f.a)(Hd,"SignInDialog",ec.StandardDialog,[1187]);class zd{constructor(S,Ba,ib){this.ga=S;this.$sa=
Ba;this.ora=ib}create(){return new Hd(this.ga,this.$sa,this.ora)}}Object(f.a)(zd,"SignInDialogFactory",null,[1158]);class vf{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.Ela=S;this.DN=Ba;this.MUb=ib;this.bjd=Sb;this.vOe=yc;this.dWa=ed;this.Um=Ud}execute(S,Ba){if(!l.AFrameworkApplication.Lk&&l.AFrameworkApplication.Ne){var ib=this.Ela+this.dWa;ib=mc.a.lp(ib,"fo",Sa.a.Nj(this.bjd));ib=mc.a.lp(ib,"fn",Sa.a.Nj(this.DN));ib=mc.a.lp(ib,"qs",Sa.a.Nj(this.vOe));ib=mc.a.lp(ib,"n",Sa.a.Nj((new Date).getTime().toString()));
this.Um&&this.Um.FileDownloadUrl&&(ib=mc.a.lp(ib,"furl",Sa.a.Nj(this.Um.FileDownloadUrl)));this.MUb&&(ib=mc.a.lp(ib,"fnn",Sa.a.Nj(this.MUb)));l.AFrameworkApplication.Ne.tj(ib,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,S,Ba,null)}}}Object(f.a)(vf,"SkyDriveUploadCaller",null,[1186]);class cg{constructor(S){this.Ma=S;this.Fyb=S.appSettings.SkyDriveUploadWebServiceBase;this.DN=S.appSettings.FileName;this.dWa=S.jb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(S,Ba,ib){return new vf(this.Fyb,
this.DN,Ba,S,l.AFrameworkApplication.hm,this.dWa,ib)}}Object(f.a)(cg,"SkydriveUploadCallerFactory",null,[1157]);class og{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Tb()}dispose(){}xc(S){this.W=S;this.W.register(zd,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Rd(()=>
new zd(l.AFrameworkApplication.va,uj.a.instance,l.AFrameworkApplication.ta.Nb)).singleInstance();this.W.register(cg,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Rd(()=>new cg(l.AFrameworkApplication.K)).singleInstance();this.W.register(em,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Rd(()=>new em(S.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),S.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Gq)).singleInstance();this.W.register(Kh,"Common.App.SaveToCloudStorage.UploadToCloudManager").Rd(()=>new Kh(S.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new tl.a).create(),()=>new am,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Gq)).singleInstance();this.W.register(Ri,"Common.App.SaveToCloudStorage.SaveToCloudManager").Rd(()=>new Ri(S.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),uj.a.instance,
S.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.a8,()=>new am)).singleInstance()}static main(){L.a.instance.Fc(new og)}}Object(f.a)(og,"PackageManager",null,[1,2]);class be extends ec.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}sO(S,Ba){this.dSh(S,Ba,yl.a.Q9n)}dSh(S,Ba,ib){ma.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",ib);this.mx(ib,S,Ba,null)}fff(S,Ba){ma.ULS.sendTraceTag(25235986,
216,15,"Show warning dialog of Picker related issue.");this.mx(yl.a.S9n,S,Ba,null,!0)}}Object(f.a)(be,"ErrorDialog",ec.StandardDialog,[1167]);class jd{static get Xg(){return k.a.qA(jd.Lm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}jd.Lm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(jd,"FileNameDialogHtml",null,[]);var ak=c(79);class sh extends lk{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe){super(S,Ba,ib,Sb,yc,ed,Xe);this.kab=this.CQe=this.hQ=null;this.aPk=CommonUIStrings.l_SaveToAnotherFolder;this.Xg=jd.Xg;this.wg="FileNameDialog-SaveToSharePoint";this.qAc=Ud;this.odk=Xe}DDa(S){const Ba=Sa.a.jJ(l.AFrameworkApplication.us.az),ib=l.AFrameworkApplication.breadcrumbFolderName,Sb=l.AFrameworkApplication.breadcrumbBrandName,yc={["txtFileName"]:S||Ba};let ed=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ta.Nb.Sl&&(ed=CommonUIStrings.L_SaveACopy);this.Yh(ed,Object(a.a)(this,this.BLd,"fileNameDialogHandler"),yc);this.IRh(S,Ba);this.Xdf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.hQ=document.getElementById("anotherFolder"),S=document.getElementById("folderLocation"),this.CQe=jg.a.osh(S,this.hQ,"anotherFolderDescribedBy"),this.hQ.className=
"WACButton WACDialogButtonNormal",S=!1,ib&&ib.length?(this.$mh(this.hQ,this.CQe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Sb,ib)),S=this.sqk(Sb,ib)):this.$mh(this.hQ,this.CQe,CommonUIStrings.l_CurrentOnlineFolder),this.jsk(this.hQ),this.uqk(this.hQ),S?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.hQ,"SaveToAnotherLocationTwo"),ma.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.hQ,
"SaveToAnotherLocationOne"),U.a.addHandler(this.hQ,W.a.click,Object(a.a)(this,this.zVf,"onSaveToAnotherLocationClick")),U.a.addHandler(this.hQ,W.a.fi,Object(a.a)(this,this.JWi,"onSaveToAnotherLocationKeyDown")))}sqk(S,Ba){let ib;ib=!1;const Sb=document.getElementById("currentLocation");Sb.innerText="";const yc=this.kbi(Sb,S),ed=this.kbi(Sb,Ba);let Ud=255,Xe=255;255<yc+ed&&(Ud=Math.max(238,408-yc),Xe=Math.max(170,408-ed),ib=!0);this.suk(Sb,S,Xe,Ba,Ud);return ib}kbi(S,Ba){const ib=document.createElement("div");
ib.innerText=Ba;ib.style.visibility="hidden";S.appendChild(ib);Ba=ib.clientWidth;S.removeChild(ib);return Ba}suk(S,Ba,ib,Sb,yc){Ba&&(this.Zmh(S,Ba,ib),this.luk(S));Sb&&this.Zmh(S,Sb,yc)}Zmh(S,Ba,ib){const Sb=document.createElement("div");Sb.innerText=Ba;Sb.title=Ba;Sb.className="SaveToAnotherFolderBreadcrumb";Sb.style.maxWidth=ib.toString()+"px";S.appendChild(Sb)}luk(S){const Ba=document.createElement("span");Ba.id="FolderSeparator";const ib=document.createElementNS("http://www.w3.org/2000/svg","svg");
ib.setAttribute("class","SeparatorCaret");const Sb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Sb.setAttribute("points","1 4 1 11 5 7.5");ib.appendChild(Sb);Ba.appendChild(ib);S.appendChild(Ba)}$mh(S,Ba,ib){ib=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ib);Ba&&(Ba.innerText=ib);S.tabIndex=0;S.setAttribute(jg.a.qh,jg.a.f3)}uqk(S){const Ba=document.createElement("span");Ba.id="anotherFolderText";Ba.innerText=this.aPk;Ba.className="AnotherFolderTextSpan";
S.appendChild(Ba)}jsk(S){const Ba=document.createElement("span");Ba.className="cui-img-cont-float cui-img-16by16 ";this.kab=document.createElementNS("http://www.w3.org/2000/svg","svg");this.kab.setAttribute("class","FolderIconSVG");const ib=document.createElementNS("http://www.w3.org/2000/svg","path");ib.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.kab.appendChild(ib);Ba.appendChild(this.kab);S.appendChild(Ba)}JWi(S){!S||
S.keyCode!==ak.a.Bs&&S.keyCode!==ak.a.noe||this.zVf(S)}zVf(){if(this.q6){const S=Sa.a.Ega(l.AFrameworkApplication.fileName);let Ba=this.q6.value;this.hide();Ba&&""!==Ba&&""!==S||1===this.ta.state?(""!==S&&(Ba+=S),this.VYh(Ba)?this.gH.create().sO(1,Ba,!1):this.qAc.start(Ba,this.odk)):this.gH.create().sO(2,Ba,!1)}}$Tk(S){this.hQ&&this.kab&&(S?(this.hQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.hQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.kab,"DisabledFolderIconSVG")):(this.hQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.hQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.kab,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.hQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.kab,"DisabledFolderIconSVG"))))}owf(){super.owf();this.$Tk(!!this.q6&&""!==this.q6.value)}dispose(){this.hQ&&(U.a.removeHandler(this.hQ,W.a.click,Object(a.a)(this,this.zVf,"onSaveToAnotherLocationClick")),U.a.removeHandler(this.hQ,W.a.fi,Object(a.a)(this,this.JWi,
"onSaveToAnotherLocationKeyDown")),this.hQ=null);super.dispose()}}Object(f.a)(sh,"FileNameDialog",lk,[1192]);var pg=c(498),ul=c(355),jh=c(1547),ag=c(1672);class Uf{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(Uf,"SaveAsDialogInput",null,[]);class Dk{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(Dk,"SaveLocation",null,[]);var ve=c(119);class Hf{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue){this.qIe=
null;this.DN="";this.qAc=S;this.gH=Ba;this.Um=Ue;this.EYa=ib;this.Ti=yc;this.KL=Sb;this.ryb=Ud;this.$Yb=Xe;ed&&(this.qIe=new jb.a(()=>new jh.a(ed.value,null)))}lSl(){const S=new pg.a(ul.a.ai());S.Z("type","currentHost");return Object.assign(new Dk,{folderName:this.KL.breadcrumbFolderName,friendlyPath:this.KL.breadcrumbBrandName,properties:S})}yRm(S){return!!S&&"ClassicMru"===S.type&&!!S.service_info&&!!S.service_info.service_id&&-1!==S.service_info.service_id.indexOf("SHAREPOINT")}Mbm(){if(!this.qIe||
!this.ryb)return null;var S=this.qIe.value.Yj("SaveAsToSharePointDialog",!1);if(!S||3!==S.state||!S.aPi)return null;S=S.aPi;const Ba=new lb.a;let ib=0,Sb=0;for(var yc=0;yc<S.length;yc++){var ed=S[yc];if(!this.yRm(ed))continue;ib++;if(!ed.sharepoint_info)continue;const Ud=ed.url,Xe=ed.sharepoint_info.site_url,Ue=ed.title;ed=ag.b(ed,l.AFrameworkApplication.isRtl);if(!(Ud&&Xe&&Ue&&ed))continue;Sb++;const Kf=new pg.a(ul.a.ai());Kf.Z("type","SharePoint");Kf.Z("siteUrl",Xe);Kf.Z("folderUrl",Ud);Sb++;Ba.add(Object.assign(new Dk,
{folderName:Ue,friendlyPath:ed,properties:Kf}))}yc=new Map;yc.set("NumPlaces",S.length.toString());yc.set("NumSharepointPlaces",ib.toString());yc.set("placesWithMetadata",Sb.toString());Ja.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",yc);0<ib&&(Sb?.5>1*Sb/ib&&Ja.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ja.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ba}tTl(){const S=
new lb.a;S.add(this.lSl());const Ba=this.Mbm();Ba&&S.addRange(Ba);return Object.assign(new Uf,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.DN,extension:Sa.a.Ega(this.KL.az),saveLocations:S.toArray(),scenario:"SaveToSharePoint"})}gpf(){const S=Object(a.a)(this,this.tTl,"getDialogInput"),Ba={};Ba.inputPropsCallback=S;return Ba}DDa(S){this.DN=S;this.DN||(this.DN=String.format(CommonUIStrings.l_SaveACopy_Filename,Sa.a.jJ(this.KL.az)));S={["id"]:"SaveAsDialog",
["bodyControls"]:this.gpf()};let Ba=CommonUIStrings.L_SaveAs;2===this.Ti.Nb.Sl&&(Ba=CommonUIStrings.L_SaveACopy);const ib=new k.a(!1,!1,!0);ib.Ad=1;ib.wg="SaveAsDialog";ib.Ee(1,CommonUIStrings.l_SaveButtonLabel);ib.Yh(Ba,Object(a.a)(this,this.M9n,"saveAsDialogHandler"),S)}Lvo(S,Ba){S&&""!==S&&""!==Ba||1===this.Ti.state?this.xRm()?this.H_m(S,Ba):(""!==Ba&&(S+=Ba),this.qAc.start(S,this.Um)):(ma.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.gH.create().sO(2,
S,!1))}H_m(S,Ba){Ja.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const ib=this.$Yb.kaf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.$Yb.ZOd(ib).then(Sb=>{if(Sb&&0<Sb.length){const yc=Sb[0][Fd.a.MBn];Sb=Sb[0][Fd.a.NBn];if(""!==yc&&""!==Sb)this.ryb.PHa(Sb,S+Ba,yc,this.Um),Ja.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.gH.create().sO(0,S,!1);const ed=Tb.a.fG();ed&&(ed.set("SiteUrlAvailable",
""===yc?"false":"true"),ed.set("FolderUrlAvailable",""===Sb?"false":"true"));Ja.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new ve.a,{extendedProperties:ed}))}}else this.gH.create().sO(0,S,!1),Ja.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Sb=>{"Canceled"===Sb?((Sb=Tb.a.fG())&&Sb.set("IsCanceled","true"),Ja.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new ve.a,{extendedProperties:Sb}))):
Ja.Health.instance.recordKpiFailure("SaveACopySFP",Sb,!1,!1,null)})}xRm(){return this.$Yb?this.$Yb.RFf():(ma.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}M9n(S,Ba){if(Ba&&1===S){S=Ba.fileName;var ib=Sa.a.Ega(this.KL.az);Ba.moreLocationsSelected&&this.Lvo(S,ib);if(Ba.locationCallback){var Sb=Ba.locationCallback();Sb?Sb.properties&&"currentHost"===Sb.properties.J("type")?this.EYa.PHa(S+ib,!1,this.Um):Sb.properties&&"SharePoint"===Sb.properties.J("type")?(Ba=Sb.properties.J("siteUrl"),
Sb=Sb.properties.J("folderUrl"),this.ryb.PHa(Sb,S+ib,Ba,this.Um)):ma.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ma.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ma.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(Hf,"ReactSaveAsDialog",null,[1192]);class ej{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe=null,Ue=null,Kf=null){this.ga=Ba;this.Ma=S;this.ora=Sb;this.EYa=ed;this.gH=yc;this.Ti=ib;this.Mdh=Ud;this.W9j=Xe;this.ryb=Ue;this.$Yb=
Kf}create(S){return this.Ti&&this.Ti.Nb.lF?new Hf(this.Mdh,this.gH,this.EYa,l.AFrameworkApplication.us,this.Ti,this.W9j,this.ryb,this.$Yb,S):new sh(this.Ma,this.ga,this.Ti,this.ora,this.gH,this.EYa,this.Mdh,S)}}Object(f.a)(ej,"FileNameDialogFactory",null,[1166]);class vj{constructor(S,Ba,ib,Sb){this.Ew=this.dyc=null;this.ktb=S;this.Ti=ib;this.xek=Sb;this.bWa=new jb.a(()=>new jh.a(Ba.value,Object(a.a)(this,this.FEb,"getMoreInfoEventReceived")))}get aYi(){this.dyc||(this.bWa.value.Yj("Save As",!0),
this.Ew&&this.Ew.Lca&&this.Ew.Lca.length&&(this.dyc=this.S4l(this.Ew.Lca)));return this.dyc}start(S){if(!this.aYi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.dyc=l.AFrameworkApplication.breadcrumbFolderUrl;else return ma.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Ew),!1;const Ba=this.xek();Ba.Zvo();const ib=
Ba.A7l();if(!ib)return ma.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ktb.start((Sb,yc)=>{Ba.hide();S(Sb,yc)},()=>{this.fKb(Ba)},ib,this.dyc);return!0}fKb(S){S.hide();ma.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}S4l(S){S=S.toLowerCase();S.endsWith("/")||(S+="/");const Ba=S.indexOf("/documents/");return-1!==Ba?S.substring(0,Ba+1)+"_layouts/15/onedrive.aspx":""}FEb(S){this.Ew||3!==S.state||(this.Ew=S)}}Object(f.a)(vj,"OneDriveFilePickerHelper",
null,[1165]);class Xh extends k.a{constructor(){super()}Zvo(){this.Zqc="FilePickerDialog";this.Xg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.wg="PickerDialog-MsoSp";this.showDialog("",null)}A7l(){return document.getElementById("FilePickerDiv")}tL(){}Qca(){}}Object(f.a)(Xh,"PickerDialog",k.a,[1164]);class dg{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.Ma=S;this.nAe=ib;this.ga=Ba;this.qAc=Sb;this.ktb=yc;this.cyc=ed;this.ZXj=Ud}Tb(){const S=this.ktb.V7b();S?Fa.a.voa||this.Ma.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(n.a.Thc,y.a.frame,Object(a.a)(this,this.ggj,"saveToSharePointActionDispatcher"),64):(S.N3a.continueWith(Ba=>{Ba.Ci&&this.ktb.nUf(Ba)}),this.gCd()):ma.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}gCd(){Qb.a.C3c(Object(a.a)(this,this.ggj,"saveToSharePointActionDispatcher"));Qb.a.KKc([new Qi.a(n.a.Thc,y.a.frame,0)],this.ktb.V7b())}get Ibc(){return this.Ma.$("SaveToAnotherFolderBrsIsEnabled")}get BAh(){return this.Ma.$("UserCanWriteRelative")}ggj(S,
Ba,ib,Sb,yc){return Ba.contextId!==y.a.frame||S!==n.a.Thc?2:this.Ibc&&(this.cyc.aYi||this.BAh)?1===ib?wh.SessionStatusManager.instance.Aj||l.AFrameworkApplication.yoa?8:this.ZXj()?32:8:2===ib?(ma.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(yc&&yc.SaveEntryPoint&&"VersionHistory"===yc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.BAh?(ma.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.nAe.create(yc).DDa(null)):(ma.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.qAc.start(null,yc)),32):8:8}}Object(f.a)(dg,"SaveToSharePointActor",null,[]);class ll{constructor(S,Ba,ib,Sb){this.Um=this.i7g=null;this.ryb=S;this.gH=Ba;this.cyc=ib;this.Ti=Sb}start(S,Ba){ma.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.i7g=S;this.Um=Ba;this.cyc.start((ib,Sb)=>{this.processResponse(ib,Sb)})||this.neg()}processResponse(S,Ba){if(S)this.onSuccess(Ba);else this.onFailure(Ba)}neg(){1!==
this.Ti.state&&this.gH().fff(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(S){ma.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(S&&S.data&&S.data.value&&S.data.value.length&&S.data.value[0].sharePoint){const Ba=S.data.value[0].sharePoint.url;S=S.data.value[0].sharePoint.listUrl;let ib=null;if(Ba&&(ib=S?this.Zbm(S):this.Ybm(Ba))){this.ryb.PHa(Ba,this.i7g,ib,this.Um);return}ma.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Ba,!ib)}ma.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.neg()}Ybm(S){S.endsWith("/")||(S+="/");let Ba=0;for(let ib=0;ib<S.length;ib++)if("/"===S.charAt(ib)&&5===++Ba)return S.substr(0,ib);return null}Zbm(S){S.endsWith("/")&&(S=S.substring(0,S.length-1));const Ba=S.lastIndexOf("/");return-1!==Ba?S.substring(0,Ba):null}onFailure(S){ma.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");S&&S.error?ma.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",S.error.errorCode,S.error.message):ma.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.neg()}}Object(f.a)(ll,"SaveToSharePointManager",null,[1163]);class gi{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe){this.Ela=S;this.DN=Ba;this.MUb=Sb;this.vOe=ed;this.pKa=ib;this.Gjk=yc;this.dWa=Ud;this.Um=Xe}execute(S,Ba){if(!l.AFrameworkApplication.Lk&&
l.AFrameworkApplication.Ne){var ib=this.Ela+this.dWa;ib=mc.a.lp(ib,"fu",Sa.a.Nj(this.pKa));ib=mc.a.lp(ib,"su",Sa.a.Nj(this.Gjk));ib=mc.a.lp(ib,"fn",Sa.a.Nj(this.DN));ib=mc.a.lp(ib,"n",Sa.a.Nj((new Date).getTime().toString()));this.Um&&this.Um.FileDownloadUrl&&(ib=mc.a.lp(ib,"furl",Sa.a.Nj(this.Um.FileDownloadUrl)));ib=ib+"&"+this.vOe;this.MUb&&this.MUb.length?ib=mc.a.lp(ib,"fnn",Sa.a.Nj(this.MUb)):ma.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ma.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.Ne.tj(ib,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,S,Ba,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(gi,"SharePointSaveAsCaller",null,[1188]);class Gm{constructor(S){this.Fyb=S.appSettings.SaveAsToHostWebServiceBase;this.DN=S.appSettings.FileName;this.dWa=S.jb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(S,Ba,ib,Sb){return new gi(this.Fyb,this.DN,S,Ba,ib,l.AFrameworkApplication.hm,
this.dWa,Sb)}}Object(f.a)(Gm,"SharePointUploadCallerFactory",null,[1162]);var An=c(1379);class qg{constructor(S,Ba,ib,Sb,yc){this.Bk=this.Bpc=null;this.sse=!1;this.wQe=this.pKa=null;this.mWe=Ba;this.uXa=ib;this.gH=Sb;this.Ti=yc;this.ga=S}PHa(S,Ba,ib,Sb){this.sse=!1;ma.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.P6a();this.pKa=S;Sb&&Sb.SaveEntryPoint&&(this.wQe=Sb.SaveEntryPoint);this.Bpc=this.mWe.create(S,Ba,ib,Sb);Sb&&"true"===Sb.SkipSaveToHost?
this.kga():this.IGl()}IGl(){const S=()=>{ma.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.kga()};32!==this.ga.Qb(n.a.ANb,2,[()=>{ma.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.kga()},S])&&S()}kga(){ma.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Bpc.execute(Object(a.a)(this,this.Csn,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.Bsn,
"onSaveToSharePointUploadFailed"))}Csn(S){if(S&&S.data&&S.data.we){var Ba;if(({Yu:Ba}=ab.d(S.data.we)).returnValue)if(Ba.StatusCode!==Fh.a.Jy&&Ba.StatusCode!==Fh.a.zIc)ma.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",S.data.status,Ba.StatusCode),Ba.StatusCode!==Fh.a.Q6f&&this.LSh(S.data.status)||(this.xSa(Ba.StatusCode.toString()),this.Uuo(Ba.StatusCode));else{ma.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.L6f();try{Ba.NewDocumentUrl?this.xMb(Ba.NewDocumentUrl):this.yMb()}catch(ib){ma.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ib.toString())}}else ma.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:yb.a.Y$c(S.data.we)}),this.RId()||(this.xSa("Failed to deserialize response"),this.x8c())}else ma.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.RId()||(this.xSa("Unknown"),this.x8c())}Bsn(S){S&&S.data?this.LSh(S.data.status)||
(ma.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.xSa(An.a[S.data.status]),this.x8c()):(ma.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.RId()||(this.xSa("Unknown"),this.x8c()))}RId(){if(!this.sse)return ma.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.sse=!0,this.kga(),!0;ma.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}LSh(S){ma.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
S);return this.RId()}yMb(){ma.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ha.a.om(this.pKa,ha.a.dra(3),void 0,"UploadToSharePointManager.RedirectToFolder")}xMb(S){let Ba=!1,ib=!1;l.AFrameworkApplication.K&&(Ba=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),ib=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ma.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",S,Ba);if(Ba&&ib){ma.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Sb={};Sb[Fd.a.Mgc]="1";Sb[Fd.a.documentUrl]=S;Sb[Fd.a.reason]=pd.a.L8f;l.AFrameworkApplication.PO().execute(yc=>{yc.sendMessage(Se.a.iCb,Sb)})}else ha.a.om(S,ha.a.dra(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}P6a(){this.Ti&&1===this.Ti.state||(this.Bk=this.uXa(),this.Bk.message=CommonUIStrings.l_CommentProgressTooltip,this.Bk.Ad=5,this.Bk.yt=!1,this.Bk.rL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Pma(){this.Bk&&(this.Bk.close(),this.Bk=null)}x8c(){this.zp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}Mvo(){this.zp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}$uo(){const S=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.zp(CommonUIStrings.l_SaveAsFileTooLargeTitle,S,yl.a.N9n)}zp(S,Ba,ib=yl.a.R9n){ma.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",S,Ba);this.Pma();1!==this.Ti.state&&this.gH().dSh(S,Ba,ib)}Uuo(S){ma.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
S);switch(S){case Fh.a.Mme:this.Mvo();break;case Fh.a.Q6f:this.$uo();break;default:this.x8c()}}L6f(){"VersionHistory"===this.wQe&&this.ga.processAction(n.a.N4c,2)}xSa(S){"VersionHistory"===this.wQe&&this.ga.Qb(n.a.Gde,2,{["FailureReason"]:S})}}Object(f.a)(qg,"UploadToSharePointManager",null,[1161]);var xk=c(626),Gj=c(128);class Of{constructor(){this.ucb=this.kKe=this.bKe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}xc(S){this.W=S;this.bKe=xk.a.Bp(S.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.kKe=xk.a.Bp(S.Sa("Common.IEventEmitter<Common.IMruResult>"));this.ucb=xk.a.Bp(S.Sa("Common.App.SharedFilePicker.ISharedFilePicker"));Gj.Task.WAA.call(null,this.bKe,this.kKe,this.ucb).continueWith(()=>{this.mTn()})}mTn(){this.W.register(Gm,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Rd(()=>new Gm(l.AFrameworkApplication.K)).singleInstance();this.W.register(qg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Rd(()=>
new qg(l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new tl.a).create(),()=>new be,l.AFrameworkApplication.ta)).singleInstance();this.W.register(ll,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Rd(()=>new ll(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new be,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ta)).singleInstance();
this.W.register(vj,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Rd(()=>new vj(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new jb.a(()=>this.bKe.result),l.AFrameworkApplication.ta,()=>new Xh)).singleInstance();this.W.register(ej,"Common.App.SaveToSharePoint.FileNameDialogFactory").Rd(()=>new ej(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Nb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new jb.a(()=>this.kKe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.ucb?this.ucb.result:null)).singleInstance();this.W.register(dg,"Common.App.SaveToSharePoint.SaveToSharePointActor").Rd(()=>new dg(l.AFrameworkApplication.K,l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ta.tSk)).singleInstance();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Tb()}static main(){L.a.instance.Fc(new Of)}}Object(f.a)(Of,"PackageManager",null,[1,2]);class hm{}
Object(f.a)(hm,"StringDifference",null,[1168]);class fe{constructor(S,Ba){this.charCode=S;this.description=Ba}}Object(f.a)(fe,"UBTableEntry",null,[]);class Ti{}new fe(8,"C0 Controls 1");new fe(9,"Horizontal tab (HT)");new fe(10,"Line feed (LF)");new fe(12,"C0 Controls 2");new fe(13,"Carriage return (CR)");new fe(31,"C0 Controls 3");new fe(32,"Space");new fe(47,"ASCII Punctuation and Symbols 1");new fe(57,"ASCII Digits");new fe(64,"ASCII Punctuation and Symbols 2");new fe(90,"Uppercase Latin Alphabet");
new fe(96,"ASCII Punctuation and Symbols 3");new fe(122,"Lowercase Latin Alphabet");new fe(127,"U+0000..U+007F Basic Latin");new fe(159,"C1 Controls");new fe(160,"NB Space");new fe(191,"Latin-1 Punctuation and Symbols");new fe(255,"U+0080..U+00FF Latin-1 Supplement");new fe(383,"U+0100..U+017F Latin Extended-A");new fe(591,"U+0180..U+024F Latin Extended-B");new fe(687,"U+0250..U+02AF IPA Extensions");new fe(767,"U+02B0..U+02FF Spacing Modifier Letters");new fe(879,"U+0300..U+036F Combining Diacritical Marks");
new fe(1023,"U+0370..U+03FF Greek and Coptic");new fe(1279,"U+0400..U+04FF Cyrillic");new fe(1327,"U+0500..U+052F Cyrillic Supplement");new fe(1423,"U+0530..U+058F Armenian");new fe(1535,"U+0590..U+05FF Hebrew");new fe(1791,"U+0600..U+06FF Arabic");new fe(1871,"U+0700..U+074F Syriac");new fe(1919,"U+0750..U+077F Arabic Supplement");new fe(1983,"U+0780..U+07BF Thaana");new fe(2047,"U+07C0..U+07FF NKo");new fe(2111,"U+0800..U+083F Samaritan");new fe(2143,"U+0840..U+085F Mandaic");new fe(2303,"U+08A0..U+08FF Arabic Extended-A");
new fe(2431,"U+0900..U+097F Devanagari");new fe(2559,"U+0980..U+09FF Bengali");new fe(2687,"U+0A00..U+0A7F Gurmukhi");new fe(2815,"U+0A80..U+0AFF Gujarati");new fe(2943,"U+0B00..U+0B7F Oriya");new fe(3071,"U+0B80..U+0BFF Tamil");new fe(3199,"U+0C00..U+0C7F Telugu");new fe(3327,"U+0C80..U+0CFF Kannada");new fe(3455,"U+0D00..U+0D7F Malayalam");new fe(3583,"U+0D80..U+0DFF Sinhala");new fe(3711,"U+0E00..U+0E7F Thai");new fe(3839,"U+0E80..U+0EFF Lao");new fe(4095,"U+0F00..U+0FFF Tibetan");new fe(4255,
"U+1000..U+109F Myanmar");new fe(4351,"U+10A0..U+10FF Georgian");new fe(4607,"U+1100..U+11FF Hangul Jamo");new fe(4991,"U+1200..U+137F Ethiopic");new fe(5023,"U+1380..U+139F Ethiopic Supplement");new fe(5119,"U+13A0..U+13FF Cherokee");new fe(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new fe(5791,"U+1680..U+169F Ogham");new fe(5887,"U+16A0..U+16FF Runic");new fe(5919,"U+1700..U+171F Tagalog");new fe(5951,"U+1720..U+173F Hanunoo");new fe(5983,"U+1740..U+175F Buhid");new fe(6015,"U+1760..U+177F Tagbanwa");
new fe(6143,"U+1780..U+17FF Khmer");new fe(6319,"U+1800..U+18AF Mongolian");new fe(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new fe(6479,"U+1900..U+194F Limbu");new fe(6527,"U+1950..U+197F Tai Le");new fe(6623,"U+1980..U+19DF New Tai Lue");new fe(6655,"U+19E0..U+19FF Khmer Symbols");new fe(6687,"U+1A00..U+1A1F Buginese");new fe(6831,"U+1A20..U+1AAF Tai Tham");new fe(7039,"U+1B00..U+1B7F Balinese");new fe(7103,"U+1B80..U+1BBF Sundanese");new fe(7167,"U+1BC0..U+1BFF Batak");
new fe(7247,"U+1C00..U+1C4F Lepcha");new fe(7295,"U+1C50..U+1C7F Ol Chiki");new fe(7375,"U+1CC0..U+1CCF Sundanese Supplement");new fe(7423,"U+1CD0..U+1CFF Vedic Extensions");new fe(7551,"U+1D00..U+1D7F Phonetic Extensions");new fe(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new fe(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new fe(7935,"U+1E00..U+1EFF Latin Extended Additional");new fe(8191,"U+1F00..U+1FFF Greek Extended");new fe(8303,"U+2000..U+206F General Punctuation");
new fe(8351,"U+2070..U+209F Superscripts and Subscripts");new fe(8399,"U+20A0..U+20CF Currency Symbols");new fe(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new fe(8527,"U+2100..U+214F Letterlike Symbols");new fe(8591,"U+2150..U+218F Number Forms");new fe(8703,"U+2190..U+21FF Arrows");new fe(8959,"U+2200..U+22FF Mathematical Operators");new fe(9215,"U+2300..U+23FF Miscellaneous Technical");new fe(9279,"U+2400..U+243F Control Pictures");new fe(9311,"U+2440..U+245F Optical Character Recognition");
new fe(9471,"U+2460..U+24FF Enclosed Alphanumerics");new fe(9599,"U+2500..U+257F Box Drawing");new fe(9631,"U+2580..U+259F Block Elements");new fe(9727,"U+25A0..U+25FF Geometric Shapes");new fe(9983,"U+2600..U+26FF Miscellaneous Symbols");new fe(10175,"U+2700..U+27BF Dingbats");new fe(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new fe(10239,"U+27F0..U+27FF Supplemental Arrows-A");new fe(10495,"U+2800..U+28FF Braille Patterns");new fe(10623,"U+2900..U+297F Supplemental Arrows-B");
new fe(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new fe(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new fe(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new fe(11359,"U+2C00..U+2C5F Glagolitic");new fe(11391,"U+2C60..U+2C7F Latin Extended-C");new fe(11519,"U+2C80..U+2CFF Coptic");new fe(11567,"U+2D00..U+2D2F Georgian Supplement");new fe(11647,"U+2D30..U+2D7F Tifinagh");new fe(11743,"U+2D80..U+2DDF Ethiopic Extended");new fe(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new fe(11903,"U+2E00..U+2E7F Supplemental Punctuation");new fe(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new fe(12255,"U+2F00..U+2FDF Kangxi Radicals");new fe(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new fe(12351,"U+3000..U+303F CJK Symbols and Punctuation");new fe(12447,"U+3040..U+309F Hiragana");new fe(12543,"U+30A0..U+30FF Katakana");new fe(12591,"U+3100..U+312F Bopomofo");new fe(12687,"U+3130..U+318F Hangul Compatibility Jamo");new fe(12703,"U+3190..U+319F Kanbun");new fe(12735,
"U+31A0..U+31BF Bopomofo Extended");new fe(12783,"U+31C0..U+31EF CJK Strokes");new fe(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new fe(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new fe(13311,"U+3300..U+33FF CJK Compatibility");new fe(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new fe(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new fe(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new fe(42127,"U+A000..U+A48F Yi Syllables");new fe(42191,"U+A490..U+A4CF Yi Radicals");
new fe(42239,"U+A4D0..U+A4FF Lisu");new fe(42559,"U+A500..U+A63F Vai");new fe(42655,"U+A640..U+A69F Cyrillic Extended-B");new fe(42751,"U+A6A0..U+A6FF Bamum");new fe(42783,"U+A700..U+A71F Modifier Tone Letters");new fe(43007,"U+A720..U+A7FF Latin Extended-D");new fe(43055,"U+A800..U+A82F Syloti Nagri");new fe(43071,"U+A830..U+A83F Common Indic Number Forms");new fe(43135,"U+A840..U+A87F Phags-pa");new fe(43231,"U+A880..U+A8DF Saurashtra");new fe(43263,"U+A8E0..U+A8FF Devanagari Extended");new fe(43311,
"U+A900..U+A92F Kayah Li");new fe(43359,"U+A930..U+A95F Rejang");new fe(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new fe(43487,"U+A980..U+A9DF Javanese");new fe(43615,"U+AA00..U+AA5F Cham");new fe(43647,"U+AA60..U+AA7F Myanmar Extended-A");new fe(43743,"U+AA80..U+AADF Tai Viet");new fe(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new fe(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new fe(44031,"U+ABC0..U+ABFF Meetei Mayek");new fe(55215,"U+AC00..U+D7AF Hangul Syllables");new fe(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new fe(56191,"U+D800..U+DB7F High Surrogates");new fe(56319,"U+DB80..U+DBFF High Private Use Surrogates");new fe(57343,"U+DC00..U+DFFF Low Surrogates");new fe(63743,"U+E000..U+F8FF Private Use Area");new fe(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new fe(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new fe(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new fe(65039,"U+FE00..U+FE0F Variation Selectors");new fe(65055,"U+FE10..U+FE1F Vertical Forms");new fe(65071,"U+FE20..U+FE2F Combining Half Marks");
new fe(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new fe(65135,"U+FE50..U+FE6F Small Form Variants");new fe(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new fe(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new fe(65535,"U+FFF0..U+FFFF Specials");new fe(65663,"U+10000..U+1007F Linear B Syllabary");new fe(65791,"U+10080..U+100FF Linear B Ideograms");new fe(65855,"U+10100..U+1013F Aegean Numbers");new fe(65935,"U+10140..U+1018F Ancient Greek Numbers");new fe(65999,"U+10190..U+101CF Ancient Symbols");
new fe(66047,"U+101D0..U+101FF Phaistos Disc");new fe(66207,"U+10280..U+1029F Lycian");new fe(66271,"U+102A0..U+102DF Carian");new fe(66351,"U+10300..U+1032F Old Italic");new fe(66383,"U+10330..U+1034F Gothic");new fe(66463,"U+10380..U+1039F Ugaritic");new fe(66527,"U+103A0..U+103DF Old Persian");new fe(66639,"U+10400..U+1044F Deseret");new fe(66687,"U+10450..U+1047F Shavian");new fe(66735,"U+10480..U+104AF Osmanya");new fe(67647,"U+10800..U+1083F Cypriot Syllabary");new fe(67679,"U+10840..U+1085F Imperial Aramaic");
new fe(67871,"U+10900..U+1091F Phoenician");new fe(67903,"U+10920..U+1093F Lydian");new fe(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new fe(68095,"U+109A0..U+109FF Meoritic Cursive");new fe(68191,"U+10A00..U+10A5F Kharoshthi");new fe(68223,"U+10A60..U+10A7F Old South Arabian");new fe(68415,"U+10B00..U+10B3F Avestan");new fe(68447,"U+10B40..U+10B5F Inscriptional Parthian");new fe(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new fe(68687,"U+10C00..U+10C4F Old Turkic");new fe(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new fe(69759,"U+11000..U+1107F Brahmi");new fe(69839,"U+11080..U+110CF Kaithi");new fe(69887,"U+110D0..U+110FF Sora Sompeng");new fe(69967,"U+11100..U+1114F Chakma");new fe(70111,"U+11180..U+111DF Sharada");new fe(71375,"U+11680..U+116CF Takri");new fe(74751,"U+12000..U+123FF Cuneiform");new fe(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new fe(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new fe(92735,"U+16800..U+16A3F Bamum Supplement");new fe(94111,"U+16F00..U+16F9F Miao");new fe(110847,
"U+1B000..U+1B0FF Kana Supplement");new fe(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new fe(119295,"U+1D100..U+1D1FF Musical Symbols");new fe(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new fe(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new fe(119679,"U+1D360..U+1D37F Counting Rod Numerals");new fe(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new fe(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new fe(127023,"U+1F000..U+1F02F Mahjong Tiles");
new fe(127135,"U+1F030..U+1F09F Domino Tiles");new fe(127231,"U+1F0A0..U+1F0FF Playing Cards");new fe(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new fe(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new fe(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new fe(128591,"U+1F600..U+1F64F Emoticons");new fe(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new fe(128895,"U+1F700..U+1F77F Alchemical Symbols");new fe(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new fe(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new fe(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new fe(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new fe(917631,"U+E0000..U+E007F Tags");new fe(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new fe(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new fe(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Ti,"UnicodeBlocks",null,[1141]);class Ek{constructor(){this.W=
null}xc(S){this.W=S;this.W.register(hm,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(Ti,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){L.a.instance.Fc(new Ek)}}
Object(f.a)(Ek,"SensitiveLoggingPackage",null,[1,2]);var rg;(function(S){S[S.myFiles=0]="myFiles";S[S.recent=1]="recent";S[S.currentFolder=2]="currentFolder";S[S.yourPhone=3]="yourPhone"})(rg||(rg={}));Object(f.b)("SharedFilePickerLandingLocation",rg);class Vf{constructor(S){this.$Fb=this.igc=null;this._initialized=!1;this.dyf=S}hgb(S){this._initialized||(S.Av(Se.a.C6i),S.OB(Se.a.C6i,Object(a.a)(this,this.Brn,"onReceivedPickerResponse")),this._initialized=!0)}ZOd(S){return this.$Fb=new Promise((Ba,
ib)=>{const Sb={};Sb[Fd.a.LBn]=S;this.igc=(yc,ed)=>{""===ed?(ma.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ba(yc)):("Canceled"===ed?ma.ULS.sendTraceTag(572548164,306,50,ed):ma.ULS.sendTraceTag(556901065,306,10,ed),ib(ed))};this.dyf.execute(yc=>{this.hgb(yc);yc.sendMessage(Se.a.gwn,Sb)})})}Brn(S){this.igc(S.Values[Fd.a.Dbo],void 0===S.Values[Fd.a.SYf]||null===S.Values[Fd.a.SYf]?"":S.Values[Fd.a.SYf])}RFf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}kaf(S,
Ba,ib,Sb,yc,ed,Ud,Xe,Ue=null){const Kf={};Kf[Fd.a.dbo]=S;Kf[Fd.a.titleText]=Ba;Kf[Fd.a.TAk]=ib;Kf[Fd.a.UAk]=Sb;Kf[Fd.a.WAk]=yc;Kf[Fd.a.jol]=!0;Kf[Fd.a.AAl]=ed;Kf[Fd.a.PBn]=Ud;Kf[Fd.a.OBn]=rg[Xe];G.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Kf[Fd.a.QBn]="Dark");Ue&&(null!=Ue.I0b&&(Kf[Fd.a.I0b]=Ue.I0b),null!=Ue.U9b&&(Kf[Fd.a.U9b]=Ue.U9b));return Kf}}Object(f.a)(Vf,"SharedFilePickerManager",null,[1138]);class lh{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}xc(S){this.W=
S;S.register(Vf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Rd(()=>new Vf(S.Sa("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Po(()=>{this.h2a()})}h2a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){L.a.instance.Fc(new lh)}}Object(f.a)(lh,"SharedFilePickerPackage",null,[1,2]);class qj extends Sys.EventArgs{constructor(){super()}}Object(f.a)(qj,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class lm{}Object(f.a)(lm,"TypingSpeedMeterWindow",null,[]);class Nd{constructor(S,Ba){new M.a;this.Oz=S;this.si=Ba;this.si.XZe(Object(a.a)(this,this.j6d,"onCpuMeterFrameAvailable"))}j6d(){}dispose(){this.si.uaj(Object(a.a)(this,this.j6d,"onCpuMeterFrameAvailable"))}}Object(f.a)(Nd,"TypingSpeedMeter",null,[1171]);class Un{constructor(S){this.Rwd=null;this.Xp=new z.a;this.Oz=S}initialize(S,Ba,ib,Sb){this.Rwd||(this.Rwd=new Nd(this.Oz,S,Ba,ib,Sb),this.Xp.zg(this.Rwd));return this.Rwd}}
Object(f.a)(Un,"TypingSpeedMeterProvider",null,[1137]);class Ad{constructor(){this.IVe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const S=va.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),Ba=xk.a.Bp(va.a.instance.Sa("Common.ICpuMeterProvider"));Ba.continueWith(()=>{const ib=Ba.result.Xp.task;var Sb=new za.a(l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowSamplingPercent",0)/100);Sb=new oa.a(Object(a.a)(Sb,
Sb.AOb,"shouldBeInSample"));const yc=La.a.cF(12,1,Sb),ed=l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowTimeoutMs",5E3),Ud=l.AFrameworkApplication.K.mc("TypingSpeedMeterMaxKeystrokesPerWindow",5);ib.CWR(()=>this.IVe=S.initialize(ib.result,yc,ed,Ud))})}}dispose(){this.IVe&&this.IVe.dispose()}xc(S){S.register(Un,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Rd(()=>new Un(ha.a.Ze))}static main(){L.a.instance.Fc(new Ad)}}Object(f.a)(Ad,
"TypingSpeedMeterPackage",null,[1,2]);class ml{constructor(){this.events=[];this.N6f=!1}static DHf(S){return S.ctrlKey&&"Control"!==S.key||S.altKey&&"Alt"!==S.key||!!ml.PVm[S.key]}static lNk(S,Ba){let ib;ib=ml.DHf(S)?S.key:" "===S.key?"Space":"CharacterKey";return null!=Ba?(Ba.altPressed=(!!S.altKey).toString(),Ba.ctrlPressed=(!!S.ctrlKey).toString(),Ba.key=ib,Ba.repeat=(!!S.repeat).toString(),Ba.shiftPressed=(!!S.shiftKey).toString(),Ba):{["altPressed"]:(!!S.altKey).toString(),["ctrlPressed"]:(!!S.ctrlKey).toString(),
["key"]:ib,["repeat"]:(!!S.repeat).toString(),["shiftPressed"]:(!!S.shiftKey).toString()}}static Ezi(S){return window.performance&&window.performance.now&&S.timeStamp<performance.now()}static $Wh(S){return!!S&&ml.Ezi(S)&&ml.DHf(S)}static aXh(S){return!!S&&ml.Ezi(S)&&!ml.DHf(S)}keyPressedEventHandlerStart(S,Ba){ml.aXh(S)&&this.Nuj(S,Ba)}keyPressedEventHandlerEnd(S){ml.aXh(S)&&this.svj(S)}keyDownEventHandlerStart(S,Ba){ml.$Wh(S)&&this.Nuj(S,Ba)}keyDownEventHandlerEnd(S){ml.$Wh(S)&&this.svj(S)}Nuj(S,
Ba){S={["metadata"]:ml.lNk(S,Ba),["timeStamp"]:this.Qlc(S.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Qlc(performance.now()-S.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(S);this.sWn()}svj(S){if(0!==this.events.length){var Ba=this.Qlc(S.timeStamp);for(let ib=this.events.length-1;0<=ib;--ib){const Sb=this.events[ib];if(Sb.timeStamp===Ba){Sb.timeToHandlerFinishMs=this.Qlc(performance.now()-S.timeStamp);Sb.eventDurationMs=this.Qlc(Sb.timeToHandlerFinishMs-
Sb.timeToHandlerStartMs);break}}}}Qlc(S){return Number(S.toFixed(2))}sWn(){if(!this.N6f){const S=document.createEvent("CustomEvent");S.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(S);requestAnimationFrame(()=>{this.N6f=!1;const Ba=performance.now();this.events.forEach(Sb=>{Sb.timeToRequestAnimationFrameMs=this.Qlc(Ba-Sb.timeStamp)});var ib=document.createEvent("CustomEvent");ib.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(ib);this.events=
[];ib=document.createEvent("CustomEvent");ib.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(ib)});this.N6f=!0}}}ml.PVm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Pf{constructor(){this.Hde=this.g4a=this.FQa=this.pdc=null;this.Bbc=!1;this.fhc=null;this.xMc=[];this.Nad=()=>{Pf.yOm()&&null==this.g4a?(this.FQa=null,this.g4a=requestAnimationFrame(this.HYc)):
null!=this.g4a&&(cancelAnimationFrame(this.g4a),this.g4a=null)};this.HYc=S=>{if(null!=this.FQa){const Ba=S-this.FQa;if(null==this.pdc||this.pdc<Ba)this.pdc=Ba;for(let ib=0;ib<Pf.ranges.length;++ib)if(Ba<Pf.ranges[ib]){++this.xMc[ib];break}}this.FQa=S;this.g4a=requestAnimationFrame(this.HYc)};this.ccj=()=>{if(null!=this.pdc){var S={};for(var Ba=0;Ba<Pf.ranges.length;++Ba)S[Pf.ranges[Ba]]=this.xMc[Ba],this.xMc[Ba]=0;Ba=performance.now();S={["intervalStart"]:this.fhc,["intervalEnd"]:Ba,["maxFrameLengthMs"]:this.pdc,
["frameData"]:S};var ib=document.createEvent("CustomEvent");ib.initCustomEvent("reportframetiming",!1,!1,S);dispatchEvent(ib);this.pdc=null;this.fhc=Ba}}}static WEf(){return!!window.performance&&!!window.performance.now}start(S){!this.Bbc&&Pf.WEf()&&(this.soo(),this.Hde=setInterval(this.ccj,1E3*S),this.fhc=performance.now(),this.Nad(),document.addEventListener("visibilitychange",this.Nad),this.Bbc=!0)}stop(){this.Bbc&&(document.removeEventListener("visibilitychange",this.Nad),null!=this.Hde&&(clearInterval(this.Hde),
this.Hde=null),null!=this.g4a&&(cancelAnimationFrame(this.g4a),this.g4a=null),this.ccj(),this.Bbc=!1)}get AVc(){return this.Bbc}soo(){this.xMc=[];for(let S=0;S<Pf.ranges.length;++S)this.xMc.push(0)}}Pf.yOm=()=>"visible"===document.visibilityState;Pf.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class sg{create(S){return new za.a(S)}}Object(f.a)(sg,"RandomSamplerFactory",null,[1218]);var cb=c(9),Jb=c(1411);class ac{constructor(S,Ba,ib,Sb,yc){S.Zph(()=>{Sb.G4c()});S.hqh((ed,
Ud)=>{Sb.E4c(Ud.revisionId,Ud.B4a)});S.xzd((ed,Ud)=>{Sb.pvm(Ud.mej,Ud.B4a,Ud.Oyj)});S.oxk(()=>{Sb.C6f()});Ba.Oxk((ed,Ud)=>{Sb.FIo(Ud.Qbj,Ud.rle,Ud.actualValue)});Ba.Awk((ed,Ud)=>{Sb.EIo(Ud.Qbj,Ud.rle,Ud.actualValue)});yc.KDc(()=>{Sb.uad()});ib.c3((ed,Ud)=>{6===Ud.type&&Sb.Khc(Ud.wL)})}}Object(f.a)(ac,"EventForwarder",null,[]);class Ec{constructor(S,Ba,ib){this.Bbk=S;this.vN=ib;this.SZb=Ba}create(S,Ba){return new ac(this.Bbk,this.SZb,S,Ba,this.vN)}}Object(f.a)(Ec,"EventForwarderFactory",null,[]);var Lc=
c(439);class kd{}kd.ZOo="TypingToOutboundReplicationStart";kd.Own="OutboundReplicationStartToOutboundReplicationEnd";kd.hfj="RtcNotificationToInboundReplicationEnd";kd.PCj="TypingToInboundReplicationEnd";Object(f.a)(kd,"PerfTrackerPhases",null,[]);class Vd{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue=null){this.V4g=!1;this.XKe=5;this.u6g=50;this.yJe=20;this.ZHe=this.iJe=this.Bza=null;this.Mqc=this.Cqc=0;this.SSe=this.aUe=!1;this.Mvd=Array(7);this.boc=null;this.pXg=!1;this.Mue=null;this.lia={};this.Tkd=S;
this.rVa=Ba;this.cak=ib;this.kZg=Sb.create(kd.hfj,yc,ed,20,!1);this.Swd=Sb.create(kd.PCj,Ud,Xe,20,!0);if(this.Ma=l.AFrameworkApplication.K)this.V4g=this.Ma.$("LogSteppedInboundFrameIsEnabled"),this.yJe=this.Ma.mc("InboundFrameMaxNumberOfLongRunningTasks",20),this.u6g=this.Ma.mc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.XKe=this.Ma.mc("InboundFrameNumberOfLastShortTasks",5);this.Trb=Ue}get xVk(){null==this.Mue&&(this.Mue=!!this.Ma&&this.Ma.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.Mue}initialize(S){this.Bza=S}e3n(S,Ba,ib=null){this.nDh();ma.ULS.shipAssertTag(8229761,324,0<S.length);let Sb=!1;for(const ed of S){const Ud=ed.toString();if(Ud in this.lia){var yc=this.lia[Ud];if(!yc.vic){yc.Tij(S,Ba,ib);if(Sb)this.$Ji(ed.toString(),yc,null,null,this.Mvd,null);else{const Xe=this.Myl(),Ue=this.GJl(this.boc);Sb=!0;this.$Ji(ed.toString(),yc,Xe,this.ZHe,this.Mvd,Ue)}delete this.lia[Ud]}}else yc=this.Tkd.create(this.kZg,this.Swd),yc.Tij(S,Ba),this.lia[Ud]=yc}this.SSe=!1}Khc(S){ma.ULS.shipAssertTag(8257930,
304,S.ZCi,"Expected data not sent on the wire");if(S.ZCi){if(S.jee in this.lia){var Ba=this.lia[S.jee];Ba.yee||(Ba.Khc(S.revisionId,S.SYi,S.eqj,S.B4a),delete this.lia[S.jee])}else Ba=this.Tkd.create(this.kZg,this.Swd),Ba.Khc(S.revisionId,S.SYi,S.eqj,S.B4a),this.lia[S.jee]=Ba;this.nDh()}}bxm(){this.aUe||(this.iJe=Array(this.yJe),this.ZHe=Array(this.XKe),this.Mqc=this.Cqc=0,this.Mvd=[0,0,0,0,0,0,0,0],this.boc=Array(3),this.boc[1]=[0,0],this.boc[2]=[0,0],this.aUe=!0)}mso(S){return!S.TP&&S.TN===fa.a.Lbj&&
(S=Lc.a(this.lia))&&S[0]?!0:!1}cmn(S){this.aUe=!1;const Ba=Lc.a(this.lia);Ba&&Ba[0]&&(S.TRT>=this.u6g&&this.Cqc<this.yJe?this.iJe[this.Cqc++]=S:(this.ZHe[this.Mqc]=S,this.Mqc=this.Mqc<this.XKe-1?this.Mqc+1:0),this.t6m(S),this.N6m(S))}bmn(){this.bxm();this.SSe=!0}t6m(S){this.Mvd[S.TP]++}N6m(S){if(S&&S.UI){const Ba=this.boc[S.UI];Ba[0]+=1;Ba[1]+=S.TRT}}GJl(S){const Ba={};S&&(S[1]&&(Ba.Typing=S[1]),S[2]&&(Ba.Clicking=S[2]));return Ba}Myl(){return this.Cqc?this.iJe.slice(0,this.Cqc-1):null}nDh(){var S=
Lc.a(this.lia);if(S&&(this.pXg||this.z7m(S),S.length>this.cak))for(const Ba of S){S=this.lia[Ba];const ib=S.createdTime,Sb=this.rVa();6E4<Sb-ib&&(I.b(8438528,304,50,"{0}",{["Not Received"]:S.vic?"RtcNotification":"ServerRevision",["Duration"]:Sb-ib}),S.vic||I.b(42075798,304,15,"{0}",{["RevisionId"]:Ba,["Duration"]:Sb-ib}),delete this.lia[Ba])}}z7m(S){if(this.xVk&&this.Trb)for(const Ba of S)if(S=this.lia[Ba],S.yee&&!S.vic&&(S=S.createdTime,2E3<this.rVa()-S)){let ib=null;cb.App.xa&&cb.App.xa.hb&&cb.App.xa.hb.Uc&&
(ib=cb.App.xa.hb.Uc.contentReplicator);this.Trb.execute(Sb=>{Sb.flush(ib,1)});this.pXg=!0}}$Ji(S,Ba,ib,Sb,yc,ed){this.V4g&&(Ba=Ba.oJl())&&(Ba.RevisionId=S,Ba.LRTWR=ib,Ba.LSTWR=Sb,Ba.TSD=yc,Ba.UIWR=ed,this.Bza&&this.Bza.track(Ba))}}Object(f.a)(Vd,"InboundMonitor",null,[1210]);class se{constructor(S,Ba,ib,Sb){this.rD=Ba;this.Tkd=ib;this.Zlk=Sb}create(S,Ba,ib,Sb,yc=null){return new Vd(this.Tkd,this.rD,50,this.Zlk,S,Ba,ib,Sb,yc)}}Object(f.a)(se,"InboundMonitorFactory",null,[1190]);var He=c(372);class wf{}
wf.hoe="UserCount";wf.E7n="RevisionChainLength";Object(f.a)(wf,"PerfTrackerPivotNames",null,[]);class fc{}Object(f.a)(fc,"PerfTrackingContext",null,[]);const hf=S=>5>=S?"5AndFewer":10>=S?"6To10":15>=S?"11To15":20>=S?"15To20":25>=S?"21To25":30>=S?"26To30":"31AndAbove";class Fk{}Object(f.a)(Fk,"SteppedInboundFrame",null,[]);class Mh{constructor(S,Ba,ib,Sb,yc){this.Dbb=this.Vkd=null;this.fZg=500;this.Ukd=this.osa=this.cub=this.xVb=this.mdd=-1;this.Dvg=null;this.Feh=this.ydh=!1;this.bdh=null;this.V9g=
this.tLa=0;this.KXb=S;this.createdTime=Ba();this.mud=!1;this.kMe=0;this.Ivb=ib;this.k6j=Sb;this.Swd=yc;l.AFrameworkApplication.K&&(this.fZg=l.AFrameworkApplication.K.mc("InboundFrameSamplingMinimalTotalTimeMs",500))}get yee(){return this.ydh}get vic(){return this.Feh}get nej(){return this.bdh}get B4a(){return this.tLa}get Nwn(){return this.V9g}get tCb(){return this.Ivb()}Khc(S,Ba,ib,Sb){this.yee||(this.mud=ib,this.kMe=Ba,this.mdd=Y.a.YU(ha.a.Ze(),2),this.Dvg=(new Date).toISOString(),this.Dbb=S,this.V9g=
Sb,this.ydh=!0,this.vic?this.CVh():(this.Ouj(),wa.a.instance.Zy(S.toString()+"Start"),He.a.instance.w3d(2)))}Tij(S,Ba,ib=null){this.vic||(this.tLa=Ba,this.Feh=!0,this.bdh=S,this.Ukd=Y.a.YU(ha.a.Ze(),2),this.yee&&(wa.a.instance.Zy(this.Dbb.toString()+"End"),ib&&(this.xVb=ib.l4n,this.cub=ib.L5a,this.osa=ib.f3n),He.a.instance.wDd(),this.CVh()))}oJl(){if(!(0<this.mdd&&0<this.xVb&&0<this.cub&&0<this.osa&&0<this.Ukd))return null;const S=new Fk;S.TT=Y.a.YU(this.Ukd-this.mdd,2);if(S.TT<this.fZg)return null;
S.ST=this.Dvg;S.UC=this.tCb;S.RS=Y.a.YU(this.xVb-this.mdd,2);S.SR=Y.a.YU(this.cub-this.xVb,2);S.RRS=Y.a.YU(this.osa-this.cub,2);S.RP=Y.a.YU(this.Ukd-this.osa,2);S.ResponseLanded=Y.a.YU(this.cub,2);0<S.RS?(wa.a.instance.pY("RTCToRequestSent",this.Dbb.toString()+"Start","RequestInvoked"+this.xVb),wa.a.instance.pY("RequestSentToResponseReceived","RequestInvoked"+this.xVb,"RequestCompleted"+this.cub),wa.a.instance.pY("ResponseReceivedToReplicationStart","RequestCompleted"+this.cub,"ReplicationStart"+
this.osa)):wa.a.instance.pY("RTCToReplicationStart",this.Dbb.toString()+"Start","ReplicationStart"+this.osa);wa.a.instance.pY("Replication","ReplicationStart"+this.osa,this.Dbb.toString()+"End");return S}Ouj(){this.Vkd=this.KXb.create();this.Vkd.start(kd.hfj,kd.PCj)}CVh(){this.Vkd||this.Ouj();const S=this.Vkd.end(this.mud,this.Zbl());this.k6j.Fde(S);this.Swd.Fde(S+this.kMe)}Zbl(){const S={};S[wf.hoe]=hf(this.tCb);var Ba=this.nej.length;S[wf.E7n]=9>=Ba?Ba.toString():"10AndAbove";return Object.assign(new fc,
{P:S,FC:this.B4a,CFC:this.Nwn+this.B4a,ID:this.Dbb.toString(),CD:this.kMe,UC:this.tCb,RCL:this.nej.length})}}Object(f.a)(Mh,"InboundOperation",null,[1209]);class mm{constructor(S,Ba,ib){this.fKa=S;this.rVa=Ba;this.Ivb=ib}create(S,Ba){return new Mh(this.fKa,this.rVa,this.Ivb,S,Ba)}}Object(f.a)(mm,"InboundOperationFactory",null,[1189]);class wj{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue){this.nud=!0;this.T$g=this.Yqd=null;this.aN=Kf=>{this.fj.aN(6,Kf)};this.iMe=S;this.v1j=Ba;this.wek=ib;this.fj=Sb;this.JVe=
yc.create("TypingToOutboundReplicationStart",ed,Ud,20,!1);this.kPe=yc.create("OutboundReplicationStartToOutboundReplicationEnd",Xe,Ue,20,!1)}get yYf(){return this.Yqd}get K9d(){return this.T$g}uad(){!this.yYf&&this.nud&&(this.nud=this.v1j())&&(this.Yqd=this.iMe.create(this.aN,this.wek(),this.JVe,this.kPe),this.yYf.uad())}G4c(){this.nud=!0;this.T$g=this.yYf;this.K9d&&(this.Yqd=null,this.K9d.G4c())}C6f(){this.Yqd=null}E4c(S,Ba){this.K9d&&this.K9d.E4c(S,Ba)}}Object(f.a)(wj,"OutboundMonitor",null,[]);
class Yd{constructor(S,Ba){this.iMe=S;this.tdk=Ba}create(S,Ba,ib,Sb,yc,ed,Ud){return new wj(this.iMe,S,Ba,ib,this.tdk,Sb,yc,ed,Ud)}}Object(f.a)(Yd,"OutboundMonitorFactory",null,[]);var $g=c(58);class fg{constructor(S){this.Rbb=S}get fOn(){return this.Rbb}nb(S){return!!this.Rbb&&S in this.Rbb}get ZCi(){return this.nb(fg.tJd)&&this.nb(fg.lNb)&&this.nb(fg.ldg)}get revisionId(){if(this.nb(fg.lNb))return $g.a.Ff(this.Rbb[fg.lNb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get jee(){if(this.nb(fg.lNb))return this.Rbb[fg.lNb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get SYi(){if(this.nb(fg.tJd))return Number.parseInvariant(this.Rbb[fg.tJd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get eqj(){if(this.nb(fg.lNb))return Boolean.parse(this.Rbb[fg.ldg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get B4a(){if(this.nb(fg.tRf))return Number.parseInvariant(this.Rbb[fg.tRf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static n$k(S){return new fg(S)}static s$k(S,Ba,ib,Sb){const yc={};yc[fg.tJd]=S.toString();yc[fg.lNb]=Ba.toString();yc[fg.ldg]=ib.toString();yc[fg.tRf]=Sb.toString();return new fg(yc)}}fg.lNb="RevisionID";fg.tJd="Duration";fg.ldg="ShouldSample";fg.tRf="NumSequentialFailures";Object(f.a)(fg,"ReplicationNotificationMessage",null,[1202]);class Eo{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.Yr=this.ii=0;this.Wvb=this.rCc=
null;this.Sre=[];this.Uah=null;this.kid={};this.tLa=0;this.KXb=S;this.Vhk=Ba;this.rVa=ib;this.Ivb=Sb;this.Cfh=yc;this.Dbb=null;this.kid.TypingStartStage=null;this.kid.ReplicationStartStage="TypingStartStage";this.kid.ReplicationEndStage="ReplicationStartStage";this.Zjh=1<this.tCb;this.JVe=ed;this.kPe=Ud}get tCb(){return this.Ivb()}uad(){this.A6e("TypingStartStage")&&(this.r3f("TypingStartStage"),ma.ULS.shipAssertTag(8257931,324,!this.Wvb&&!this.Yr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.ii=this.rVa(),this.rCc=this.KXb.create(),this.Euj(this.rCc,kd.ZOo))}G4c(){if(this.A6e("ReplicationStartStage")){this.r3f("ReplicationStartStage");ma.ULS.shipAssertTag(8257932,324,!!this.rCc,"TypingStart not called");if(this.rCc){const S=this.xVh(this.rCc,this.Dbb);this.JVe.Fde(S)}this.Wvb=this.KXb.create();this.Euj(this.Wvb,kd.Own)}}E4c(S,Ba){this.A6e("ReplicationEndStage")&&(this.r3f("ReplicationEndStage"),this.Yr=this.rVa(),this.tLa=Ba,ma.ULS.shipAssertTag(8257933,324,!!this.Wvb,"ReplicationStart not called"),
this.Wvb&&(ma.ULS.shipAssertTag(8193425,324,!!this.Wvb,"ReplicationStart not called"),Ba=this.xVh(this.Wvb,S),this.kPe.Fde(Ba)),ma.ULS.shipAssertTag(8257934,324,!!this.ii,"StartTime not set. No message sent to other editors."),this.ii&&(S=fg.s$k(this.Yr-this.ii,S,this.Cfh,this.tLa),this.Vhk(S.fOn)))}A6e(S){if(this.kid[S]===this.Uah)return!0;ma.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.Opk()});return!1}Opk(){const S=new Sys.StringBuilder;S.append("Actual Phase:");for(let Ba=
0;Ba<this.Sre.length;Ba++)S.append(" "+this.Sre[Ba]);return S.toString()}r3f(S){this.Sre.push(S);this.Uah=S}Euj(S,Ba){this.Zjh&&S.start(Ba)}xVh(S,Ba){if(!this.Zjh)return-1;const ib={};ib[wf.hoe]=hf(this.tCb);Ba=Object.assign(new fc,{P:ib,FC:this.tLa,CFC:0,ID:Ba?Ba.toString():"",CD:0,UC:this.tCb,RCL:0});return S.end(this.Cfh,Ba)}}Object(f.a)(Eo,"OutboundOperation",null,[1203]);class Fo{constructor(S,Ba,ib){this.KXb=S;this.rVa=Ba;this.Ivb=ib}create(S,Ba,ib,Sb){return new Eo(this.KXb,S,this.rVa,this.Ivb,
Ba,ib,Sb)}}Object(f.a)(Fo,"OutboundOperationFactory",null,[1172]);class Da{constructor(S,Ba){this.kPg=this._name=this.M2=null;this.ge=S;this.Bza=Ba}start(S,Ba=null){this.M2=this.ge.$f("UserAction",S);this._name=S;this.kPg=Ba}end(S,Ba){let ib=-1;S&&(ib=this.M2.ti,Ba.D=ib,Ba.CN=this.kPg,Ba.CD+=ib,this.Bza.track(Ba,this._name));return ib}}Object(f.a)(Da,"PerfTracker",null,[1201]);class pb{constructor(S,Ba){this.ge=S;this.Bza=Ba}create(){return new Da(this.ge,this.Bza)}}Object(f.a)(pb,"PerfTrackerFactory",
null,[1170]);class oc{constructor(S,Ba,ib){this.myc=null;this.rdk=S;this.jZg=Ba;this.rbh=ib}init(S,Ba,ib,Sb,yc,ed,Ud){Ba=this.rbh.create(Ba/100);ib=this.rbh.create(ib/100);this.myc=this.rdk.create(Object(a.a)(Ba,Ba.AOb,"shouldBeInSample"),Object(a.a)(ib,ib.AOb,"shouldBeInSample"),S,Sb,yc,ed,Ud)}uad(){this.myc.uad()}G4c(){this.myc.G4c()}C6f(){this.myc.C6f()}E4c(S,Ba){this.myc.E4c(S,Ba)}pvm(S,Ba,ib=null){this.jZg.e3n(S,Ba,ib)}Khc(S){S=fg.n$k(S);this.jZg.Khc(S);wa.a.instance.Zy(S.revisionId+"Start")}FIo(S,
Ba,ib){I.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.sGd(S,Ba,ib))}EIo(S,Ba,ib){I.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.sGd(S,Ba,ib))}sGd(S,Ba,ib){const Sb={};Sb.PhaseName=S;Sb.ThresholdValue=Ba;Sb.ActualValue=ib;return Sb}}Object(f.a)(oc,"ReplicationTelemetryManager",null,[]);var Mc=c(942);class $c extends Mc.a{constructor(S,Ba){super(S,Ba);this.aj=this.kvd=0}Zxa(S){this.kvd+=S;this.aj++}getValue(){return this.aj?this.kvd/
this.aj:0}ASa(){this.aj=this.kvd=0}}Object(f.a)($c,"AverageMetric",Mc.a,[]);class $d extends Mc.a{constructor(S,Ba){super(S,Ba);this.M6=0}Zxa(S){S>this.M6&&(this.M6=S)}getValue(){return this.M6}ASa(){this.M6=0}}Object(f.a)($d,"MaxMetric",Mc.a,[]);var jc=c(1874);class $e extends Mc.a{constructor(S,Ba,ib=100){super(S,Ba);this.tod=this.iXb=this.EZb=0;this.btd=ib;this.aQe=new jc.a(this.btd)}Zxa(S){if(this.iXb===this.btd){const Ba=this.aQe.dequeue();this.EZb-=Ba;this.iXb--}this.aQe.enqueue(S);this.EZb+=
S;this.iXb++;S=this.EZb/this.iXb;S>this.tod&&this.iXb===this.btd&&(this.tod=S)}getValue(){return this.tod}ASa(){this.tod=0;this.aQe=new jc.a(this.btd);this.iXb=this.EZb=0}}Object(f.a)($e,"MaxRollingAverageMetric",Mc.a,[]);class Wc extends Mc.a{constructor(S,Ba){super(S,Ba);this.aj=0}Zxa(){this.aj++}getValue(){return this.aj}ASa(){this.aj=0}}Object(f.a)(Wc,"CounterMetric",Mc.a,[]);class Ng{constructor(S,Ba){this.E_b=Ba;this.kte=new $c(S+"-AverageValue","Milliseconds");this.wJe=new $d(S+"-MaxValue",
"Milliseconds");this.DJe=new $e(S+"-MaxRollingAverageValue","Milliseconds");this.vwe=new Wc(S+"-NumberOfEvents","Count");this.Lsa=new kb.a(S+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.YT("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.YT("CoAuthLatencySlowThresholdPercentile",95),this.E_b);this.qNe=new kb.a(S+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.YT("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.YT("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.E_b)}G0(S){this.kte.Zxa(S);this.wJe.Zxa(S);this.DJe.Zxa(S);this.vwe.Zxa(S);this.Lsa.Zxa(S);this.qNe.Zxa(S)}jce(){this.kte.hSa();this.wJe.hSa();this.DJe.hSa();this.vwe.hSa();this.Lsa.hSa();this.qNe.hSa();this.kte.ASa();this.wJe.ASa();this.DJe.ASa();this.vwe.ASa();this.Lsa.ASa();this.qNe.ASa()}}Object(f.a)(Ng,"ReplicationLatencyMetrics",null,[]);class Re{constructor(){this.lIe=new Bb.a}q7i(S,Ba,ib){if(!(0>Ba)){if(!({value:Sb}=this.lIe.Dc(S,Sb)).returnValue){var Sb=new Ng(S,ib);this.lIe.Z(S,
Sb)}Sb.G0(Ba)}}jce(){for(const S of this.lIe.values)S.jce()}}Object(f.a)(Re,"ReplicationTelemetryMetricsManager",null,[1134]);class Ah{q7i(){}jce(){}}Object(f.a)(Ah,"ReplicationTelemetryMetricsManagerStub",null,[1134]);class hi{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.sYa=this.Bwd=0;this.Cak=S;this.tNe=ib;this.hih=Sb;this.$Lg=yc;this.SZb=Ba;this.Dak=ed;this.E_b=Ud}Fde(S){this.Cak.q7i(this.tNe,S,this.E_b);S>this.hih&&this.SZb.nIo(this.tNe,this.hih,S);this.Bwd+=S;this.sYa++;this.Bwd/this.sYa>this.$Lg&&
this.sYa>this.Dak&&this.SZb.rIk(this.tNe,this.$Lg,this.Bwd/this.sYa)}}Object(f.a)(hi,"TimeSpanVerifier",null,[1169]);class Sj{constructor(S,Ba){this.Bgk=S;this.SZb=Ba}create(S,Ba,ib,Sb,yc){return new hi(this.Bgk,this.SZb,S,Ba,ib,Sb,yc)}}Object(f.a)(Sj,"TimeSpanVerifierFactory",null,[1133]);class al extends Sys.EventArgs{constructor(S,Ba,ib){super();this.Qbj=S;this.rle=Ba;this.actualValue=ib}}Object(f.a)(al,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class fj{constructor(){this.ra=new M.a}nIo(S,
Ba,ib){this.ra.raiseEvent("TSVTE",new al(S,Ba,ib))}rIk(S,Ba,ib){this.ra.raiseEvent("TSVATE",new al(S,Ba,ib))}Oxk(S){this.ra.addHandler("TSVTE",S)}Awk(S){this.ra.addHandler("TSVATE",S)}}Object(f.a)(fj,"TimeSpanVerifierNotifier",null,[1132]);class yk{constructor(){this.W=this.Ma=null}get name(){return"Box4.ReplicationTelemetry"}xc(S){this.Ma=S.resolve("Common.IAppSettingsManager");this.W=S;if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){S.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new pb(cb.App.xa.Gq,
La.a.cF(20,1,new Pa.a))).singleInstance();S.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new fj).singleInstance();this.Ma.$("Box4ReplicationTelemetryMetricsIsEnabled")?S.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Re).singleInstance():S.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Ah).singleInstance();S.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Sj(S.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),S.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();
S.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new Fo(S.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),yk.E7h)).singleInstance();S.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Yd(S.resolve("ReplicationTelemetry.OutboundOperationFactory"),S.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();S.ha("ReplicationTelemetry.InboundOperationFactory",()=>new mm(S.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),
yk.E7h)).singleInstance();var Ba=new se(S.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),S.resolve("ReplicationTelemetry.InboundOperationFactory"),S.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),ib=this.Ma.$("ComponentStateLoggingPackageIsEnabled")?this.W.Sa("Common.IComponentStateLogManager"):null;S.ha("ReplicationTelemetry.IInboundMonitor",()=>Ba.create(this.Ma.mc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ma.mc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Ma.mc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ma.mc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),ib)).singleInstance();S.ha("Common.IRandomSamplerFactory",()=>new sg).singleInstance();S.ha("ReplicationTelemetry.ReplicationTelemetryManager",()=>new oc(S.resolve("ReplicationTelemetry.OutboundMonitorFactory"),S.resolve("ReplicationTelemetry.IInboundMonitor"),S.resolve("Common.IRandomSamplerFactory"))).singleInstance();S.ha("ReplicationTelemetry.EventForwarderFactory",
()=>new Ec(Jb.a.instance,S.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),S.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){var S=this.Ma.mc("Box4ReplicationTelemetrySamplePercent",0),Ba=this.Ma.mc("Box4ReplicationTelemetryPhaseSamplePercent",0),ib=this.Ma.mc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Sb=this.Ma.mc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),yc=this.Ma.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),ed=this.Ma.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Ud=this;this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(Ue=>{Ue.OD().continueWith(()=>{const Kf=Ue.OD().result,Bg=Ud.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Bg.init(Kf,S,Ba,ib,Sb,yc,ed);Ud.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Kf,Bg);if(Ud.Ma.$("LogSteppedInboundFrameIsEnabled")){const Vh=xk.a.Bp(Ud.W.Sa("Common.ICpuMeterProvider"));Vh.continueWith(()=>
{const Jh=Ud.W.resolve("ReplicationTelemetry.IInboundMonitor");var ij=new oa.a(()=>!0);ij=La.a.cF(19,1,ij);Jh.initialize(ij);const gk=Vh.result.Xp.task;gk.continueWith(()=>{gk.result.Lyd(0,()=>Jh.SSe,Yh=>{Jh.cmn(Yh)});gk.result.Lyd(1,Yh=>Jh.mso(Yh),()=>{Jh.bmn()})})})}ma.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var Xe=this;l.AFrameworkApplication.dI(()=>{Xe.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").jce()})}}dispose(){}static E7h(){const S=cb.App.qd;
return S?S.nUh:0}}Object(f.a)(yk,"ReplicationTelemetryPackage",null,[1,2]);var dn=c(945),Ji=c(12),nm=c(133),Lg=c(3),sf=c(84),ne=c(60),ke=c(212),We=c(17),de=c(23),vl=c(8),Um=c(2038);class Th{static get Xg(){return k.a.qA(Th.Lm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Th.Lm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(Th,"InsertSymbolsDialogHtml",null,[]);class Gk extends Um.a{constructor(S,Ba,ib){super();this.uWb=this.pMa=this.Icb=null;this.fEe=0;this.WBm=Sb=>{1===Sb?(this.cUf("symbol_d_"+Gk.awc),this.Ub.nL(this.TK,!0),this.Ub.Ss().Zj.Iy(this.aH),this.aH.focus()):this.hide()};this.Gwj=Sb=>{if(Sb.target!==this.uWb){const yc=this.Ub.Ss();yc&&yc.Zj&&(yc.Zj.Iy(Sb.target),this.uWb=Sb.target)}this.Rsn(Sb.target.id)};this.FEo=Sb=>{const yc=Sb.zf;if("a"!==yc.tagName.toLowerCase())return!1;Sb.eventName===W.a.oB&&
this.cUf(yc.id);this.Ub.nL(this.TK,!0);this.Ub.Ss().Zj.Iy(yc);yc.focus();return!0};this.HEo=Sb=>{var yc=Sb.zf;if("a"!==yc.tagName.toLowerCase())return!1;const ed=parseInt(yc.id.substr(yc.id.lastIndexOf("_")+1));if(Sb.Gb.ctrlKey||Sb.Gb.altKey||Sb.Gb.keyCode>=ak.a.MRb&&Sb.Gb.keyCode<=ak.a.NRb)return!1;if(Sb.eventName===W.a.fi){Sb=Sb.Gb.keyCode;let Ud=-1;Sb===Sys.UI.Key.enter?(this.cUf(yc.id),this.Ub.nL(this.TK,!0),this.Ub.Ss().Zj.Iy(yc),yc.focus()):Sb===Sys.UI.Key.up?Ud=ed-15:Sb===Sys.UI.Key.down?Ud=
ed+15:Sb===Sys.UI.Key.left?Ud=l.AFrameworkApplication.isRtl?ed+1:ed-1:Sb===Sys.UI.Key.right&&(Ud=l.AFrameworkApplication.isRtl?ed-1:ed+1);0<=Ud&&(yc=this.nuf("symbol_d_"+Ud))&&yc.focus()}return!0};this.ga=S;this.Ub=Ba;this.Jcb=ib;this.Ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ee(0,CommonUIStrings.l_DialogClose);this.L$=!1;this.Xg=Th.Xg;this.wg="InsertSymbolsDialog"}dispose(){0<Gk.gVe&&ma.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.fEe,Gk.gVe);Gk.BRg++;ma.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Gk.BRg);this.ga=this.Jcb=null;super.dispose()}jTa(){this.Yh(Box4Intl.Box4Strings.L_SymbolSingle,this.WBm,null);this.fEe=0;Gk.HRg++;ma.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Gk.HRg);const S=this.nuf("symbol_d_"+Gk.awc);S&&S.focus()}hide(){var S=document.getElementById("symbolsContainer");if(S&&(S=S.getElementsByTagName("a")))for(let Ba=0;Ba<S.length;Ba++)U.a.removeHandler(S[Ba],
W.a.focus,this.Gwj);super.hide()}get Dkb(){return Gk.gwc}set Dkb(S){Gk.gwc=S}get zkb(){return Gk.Uvc}set zkb(S){Gk.Uvc=S}f9(){super.f9();var S=document.getElementById("symbolsContainer");if(S&&(S.innerHTML=this.Jcb.RMk(),S=S.getElementsByTagName("a")))for(let Ba=0;Ba<S.length;Ba++)U.a.addHandler(S[Ba],W.a.focus,this.Gwj)}Zla(){const S=document.getElementById("symbolsContainer");S&&(this.Icb||(this.Icb=this.FEo,this.Lq.mb(W.a.click,S,this.Icb),this.Lq.mb(W.a.oB,S,this.Icb)),this.pMa||(this.pMa=this.HEo,
this.ae.mb(W.a.fi,S,this.pMa),this.ae.mb(W.a.eu,S,this.pMa),this.ae.mb(W.a.uh,S,this.pMa)));super.Zla()}Bfb(){const S=document.getElementById("symbolsContainer");S&&(this.Icb&&(this.Lq.uc(W.a.click,S,this.Icb),this.Lq.uc(W.a.oB,S,this.Icb),this.Icb=null),this.pMa&&(this.ae.uc(W.a.fi,S,this.pMa),this.ae.uc(W.a.eu,S,this.pMa),this.ae.uc(W.a.uh,S,this.pMa),this.pMa=null));super.Bfb()}get jxf(){return!0}Rsn(S){this.Nmj("symbol_d_"+Gk.awc,!1);Gk.awc=parseInt(S.substr(S.lastIndexOf("_")+1));this.Nmj(S,
!0);if(S=document.getElementById("SymbolNameValueLabel")){const Ba=this.bSd(Gk.awc);S.innerText=Ba.altText}}bSd(S){const Ba=this.Jcb.uke.jhg.value,ib=Lc.a(Ba);return Ba[ib[S]]}cUf(S){this.fEe++;Gk.gVe++;S=parseInt(S.substr(S.lastIndexOf("_")+1));const Ba=this.bSd(S),ib={};ib.SourceControlId="symbol_"+S+"_"+Ba.ske;this.ga.Qb(Lg.a.Zib,2,ib);ma.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",S)}nuf(S){const Ba=document.getElementById("symbolsContainer");return Ba?Ba.querySelector("#"+
S):null}Nmj(S,Ba){if(S=this.nuf(S))Ba?(S.setAttribute("selected","true"),S.setAttribute("aria-selected","true"),S.tabIndex=0):(S.removeAttribute("selected"),S.setAttribute("aria-selected","false"),S.tabIndex=-1)}}Gk.awc=0;Gk.gwc=null;Gk.Uvc=null;Gk.HRg=0;Gk.BRg=0;Gk.gVe=0;Object(f.a)(Gk,"InsertSymbolsDialog",Um.a,[]);class Ye{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.Adm=()=>this.Jcb.INk();this.S4i=(Xe,Ue,Kf,Bg,Vh)=>{if(1===Kf)return 32;Xe=this.Jcb.H_i(Vh);Xe=String.format(this.Jcb.GEo,Xe.character);
Vh[dn.a.InnerHTML]=Xe;Vh[dn.a.On]=!1;return 32};this.LPa=(Xe,Ue,Kf,Bg,Vh)=>{if(({ie:Xe,selected:Kf,LPa:gk}=this.UIc(Ue,Kf)).returnValue)return gk;var Jh=We.SelectionEditor.gf(Kf);let ij=!0;Kf=8;var gk=this.Gc.Oc(15);gk.Cb(Xe.Yc);Jh||(Kf=this.ga.Of(Ue,Lg.a.Kma,2,!0,Bg,null),Ue=32===Kf,ma.ULS.shipAssertTag(6407387,348,Ue,"DeleteForReplace did not succeed. Response is {0}",Kf),ij=Ue);ij&&(Ue=Xe.lb.tg,Jh=We.SelectionEditor.gf(Ue),ma.ULS.shipAssertTag(6407388,348,Jh,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
Ue.contextId),Kf=8,Jh&&(Kf=this.ga.Of(Ue,Lg.a.Zib,2,!1,Bg,Vh),ma.ULS.shipAssertTag(6407389,348,32===Kf,"Insertion at IP context did not succeed. Response is {0}",Kf),32===Kf&&di.FocusManager.instance().mg(Xe.gJ)));gk.dispose();return Kf};this.VBm=(Xe,Ue,Kf,Bg,Vh)=>{if(1===Kf)return 32;if(We.SelectionEditor.A2a(Ue))return 2;Xe=this.Jcb.H_i(Vh);Bg.ns=Xe.index;Bg=this.Wc.Wf(Ue.node);Kf=Bg.zb(11);ma.ULS.shipAssertTag(6379466,324,Kf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
nm.a[Ue.node.type]);Kf=this.Gc.Oc(15);Kf.ku(Bg);Ye.characterPropertiesEditor.replaceTextRange(Ue,Xe.character,!0,!1);Ue=de.SelectionFactory.ue(Bg.currentNode,Ue.cpBegin+1);this.ib.setSelection(Ue);Kf.dispose();return 32};this.yLb=(Xe,Ue,Kf,Bg,Vh)=>{if(1===Kf)return 32;Vh.MenuItems=this.Jkk.value;return 32};this.Hwj=(Xe,Ue,Kf)=>{({LPa:Xe}=this.UIc(Ue,Kf));return Xe};this.Arj=(Xe,Ue,Kf)=>{2===Kf&&(new Gk(this.ga,di.FocusManager.instance(),va.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).jTa();
return 32};this.y1f=()=>32;this.ga=S;this.Wc=Ba;this.Jkk=new jb.a(this.Adm);this.Gc=ib;this.Jcb=Sb;this.Ik=yc;this.ib=ed;this.Tm=Ud}Tb(){this.ga.fb(Lg.a.y1f,Ji.a.application,this.y1f,96);this.ga.qa(Lg.a.yLb,Ji.a.view,this.yLb);this.ga.qa(Lg.a.tke,Ji.a.view,this.Hwj);this.ga.qa(Lg.a.rbe,Ji.a.view,this.S4i);this.ga.qa(Lg.a.Zib,Ji.a.view,this.LPa);this.ga.qa(Lg.a.yLb,Ji.a.Tc,this.yLb);this.ga.qa(Lg.a.tke,Ji.a.Tc,this.Hwj);this.ga.qa(Lg.a.rbe,Ji.a.Tc,this.S4i);this.ga.qa(Lg.a.Zib,Ji.a.Tc,this.VBm);this.ga.Vc(Lg.a.yLb,
1124);this.ga.Vc(Lg.a.tke,1036);this.ga.Vc(Lg.a.rbe,1124);this.ga.Vc(Lg.a.Zib,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(Lg.a.GSc,Ji.a.view,this.Arj),this.ga.qa(Lg.a.GSc,Ji.a.Tc,this.Arj),this.ga.Vc(Lg.a.GSc,1124))}UIc(S,Ba){let ib,Sb=null;S.view.qe&&(Sb=S.view);ib=null;if(!Sb||!Sb.lb)return I.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",S.toString()),
{returnValue:!0,ie:Sb,selected:ib,LPa:8};ib=Sb.lb.tg;if(!ib)return{returnValue:!0,ie:Sb,selected:ib,LPa:2};if(this.Ik.j_(ib)||this.Ik.nha(ib))return{returnValue:!0,ie:Sb,selected:ib,LPa:8};if(Sb.lb.gb.vJ||this.Tm&&this.Tm.instance&&this.Tm.instance.tU(ib)||We.SelectionEditor.A2a(S.$j))return{returnValue:!0,ie:Sb,selected:ib,LPa:2};if(Ye.Wg.qza(vl.ParagraphReader.oU,ib))return S=8,Ye.Ic.Yb(sf.a.kf,{["Reason"]:ne.a.hO}),{returnValue:!0,ie:Sb,selected:ib,LPa:S};S=32;return 1===Ba?{returnValue:!0,ie:Sb,
selected:ib,LPa:S}:{returnValue:!1,ie:Sb,selected:ib,LPa:S}}static get characterPropertiesEditor(){return Ye.Kd||(Ye.Kd=va.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(S){Ye.Kd=S}static get Wg(){return ke.ContextSetEditor.instance}static get Ic(){return Vg.a.instance}}Ye.Kd=null;Object(f.a)(Ye,"SymbolsActor",null,[1116]);class rf{constructor(S,Ba){this.ske=S;this.altText=Ba}}Object(f.a)(rf,"Symbol",null,[]);class Dp{constructor(){this.JTe=null;this.uhh=
new jb.a(Dp.kbf)}get jhg(){return this.uhh}S$h(S){this.JTe||(this.JTe=Lc.a(this.uhh.value));return Array.indexOf(this.JTe,S)}static kbf(){const S={};S["\u2022"]=new rf("\u2022",Box4Intl.Box4Strings.L_Bullet);S["\u20ac"]=new rf("\u20ac",Box4Intl.Box4Strings.L_EuroSign);S["\u00a3"]=new rf("\u00a3",Box4Intl.Box4Strings.L_PoundSign);S["\u00a5"]=new rf("\u00a5",Box4Intl.Box4Strings.L_YenSign);S["\u00a9"]=new rf("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);S["\u00ae"]=new rf("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);
S["\u2122"]=new rf("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);S["\u00b1"]=new rf("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);S["\u2260"]=new rf("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);S["\u2264"]=new rf("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);S["\u2265"]=new rf("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);S["\u00f7"]=new rf("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);S["\u00d7"]=new rf("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);S["\u221e"]=new rf("\u221e",
Box4Intl.Box4Strings.L_Infinity);S["\u00b5"]=new rf("\u00b5",Box4Intl.Box4Strings.L_MicroSign);S["\u03b1"]=new rf("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);S["\u03b2"]=new rf("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);S["\u03c0"]=new rf("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);S["\u03a9"]=new rf("\u03a9",Box4Intl.Box4Strings.L_OhmSign);S["\u03a3"]=new rf("\u03a3",Box4Intl.Box4Strings.L_NArySummation);S["\u00b0"]=new rf("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);
S["\u0394"]=new rf("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);S["\u263a"]=new rf("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);S["\u2665"]=new rf("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);S["\u20b9"]=new rf("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);S["\u00bf"]=new rf("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);S["\u00a1"]=new rf("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);S["\u2014"]=new rf("\u2014",Box4Intl.Box4Strings.L_EmDash);S["\u2026"]=new rf("\u2026",
Box4Intl.Box4Strings.L_HorizontalEllipsis);S["\u00c0"]=new rf("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);S["\u00c1"]=new rf("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);S["\u00c2"]=new rf("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);S["\u00c3"]=new rf("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);S["\u00c4"]=new rf("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);S["\u00c5"]=new rf("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);
S["\u00c6"]=new rf("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);S["\u00c7"]=new rf("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);S["\u00c8"]=new rf("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);S["\u00c9"]=new rf("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);S["\u00ca"]=new rf("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);S["\u00cb"]=new rf("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);S["\u00cc"]=
new rf("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);S["\u00cd"]=new rf("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);S["\u00ce"]=new rf("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);S["\u00cf"]=new rf("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);S["\u00d1"]=new rf("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);S["\u00d2"]=new rf("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);S["\u00d3"]=new rf("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);S["\u00d4"]=new rf("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);S["\u00d5"]=new rf("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);S["\u00d6"]=new rf("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);S["\u00d9"]=new rf("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);S["\u00da"]=new rf("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);S["\u00db"]=new rf("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);
S["\u00dc"]=new rf("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);S["\u00df"]=new rf("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);S["\u00e0"]=new rf("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);S["\u00e1"]=new rf("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);S["\u00e2"]=new rf("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);S["\u00e3"]=new rf("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);S["\u00e4"]=new rf("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);S["\u00e5"]=new rf("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);S["\u00e6"]=new rf("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);S["\u00e7"]=new rf("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);S["\u00e8"]=new rf("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);S["\u00e9"]=new rf("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);S["\u00ea"]=new rf("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
S["\u00eb"]=new rf("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);S["\u00ec"]=new rf("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);S["\u00ed"]=new rf("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);S["\u00ee"]=new rf("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);S["\u00ef"]=new rf("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);S["\u00f1"]=new rf("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);S["\u00f2"]=new rf("\u00f2",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);S["\u00f3"]=new rf("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);S["\u00f4"]=new rf("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);S["\u00f5"]=new rf("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);S["\u00f6"]=new rf("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);S["\u00f9"]=new rf("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);S["\u00fa"]=new rf("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);
S["\u00fb"]=new rf("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);S["\u00fc"]=new rf("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);S["\u00ff"]=new rf("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);S["\u011e"]=new rf("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);S["\u011f"]=new rf("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);S["\u0130"]=new rf("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);S["\u0131"]=
new rf("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);S["\u0152"]=new rf("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);S["\u0153"]=new rf("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);S["\u015e"]=new rf("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);S["\u015f"]=new rf("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);S["\u0178"]=new rf("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return S}}Object(f.a)(Dp,"SymbolsLoader",
null,[1115]);var Hk=c(399),ch=c(336),ar=c(206),ah=c(641),Mg=c(1470),ue=c(160),Pe=c(88);class Eb{constructor(S){this.uke=S}get GEo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}H_i(S){S=S.SourceControlId.split("_");const Ba={};2===S.length?(Ba.character=S[1],Ba.index=this.uke.S$h(Ba.character)):(Ba.character=S[2],Ba.index=parseInt(S[1]));return Ba}INk(){return this.Ogi()}build(){return this.Bdm()}RMk(){const S=new Sys.StringBuilder;S.append('<table class="moreSymbolsTable">');
const Ba=this.uke.jhg.value,ib=Lc.a(Ba);let Sb=0;for(;Sb<ib.length;){Sb%15||S.append('<tr role="presentation">');const yc=Ba[ib[Sb]];S.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',"symbol_d_"+Sb,Sa.a.RX(yc.ske),Sa.a.RX(yc.altText)));Sb++;Sb%15&&Sb!==ib.length||S.append("</tr>")}S.append("</table>");return S.toString()}Bdm(){const S=
this.Ogi();return ue.o(S)}Ogi(){const S=Object.assign(new Hk.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});S.MenuSectionList.push(this.Euk());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&S.MenuSectionList.push(this.Nsk());return S}Nsk(){const S=Object.assign(new ch.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),Ba=Object.assign(new ar.a,{Id:"btnMoreSymbols",Command:Lg.a.GSc.toString(),LabelText:Sa.a.Af(Box4Intl.Box4Strings.L_InsertMoreSymbols),
Alt:Sa.a.Af(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Vs,Image16by16Class:Pe.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});S.ControlList.push(Ba);return S}Euk(){const S=Object.assign(new ch.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),Ba=Object.assign(new ah.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",
GalleryItems:[]}),ib=this.uke.jhg.value,Sb=Lc.a(ib),yc=Math.min(25,Sb.length);for(let Ud=0;Ud<yc;Ud++){var ed=ib[Sb[Ud]];ed=Object.assign(new Mg.a,{Id:String.format("{0}{1}_{2}","symbol_",Ud,ed.ske),Character:ed.ske,Command:Lg.a.Zib.toString(),QueryCommand:Lg.a.rbe.toString(),Alt:Sa.a.Af(ed.altText)});Ba.GalleryItems.push(ed)}S.ControlList.push(Ba);return S}}Object(f.a)(Eb,"SymbolsUiBuilder",null,[1114]);var co=c(46),bl=c(235),xi=c(538),Ml=c(369);class Bn{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&
this.W.resolve("Box4.Symbols.ISymbolsActor").Tb()}dispose(){}xc(S){this.W=S;this.W.register(Dp,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new Eb(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();this.W.ha("Box4.Symbols.SymbolsActor",()=>new Ye(l.AFrameworkApplication.va,new xi.a,new Ml.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),bl.a.instance,co.a.instance,
this.W.Sa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){L.a.instance.Fc(new Bn)}}Object(f.a)(Bn,"Box4SymbolsPackage",null,[1,2]);var Cn=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},
iq=c(1626),jq=c(1579),br=c(1564),Nn=c(1952),Hq=c(230),Ep=c(400);class om{constructor(){this.YIa=null}xc(S){this.container=S}init(){this.YIa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.YIa&&this.YIa.dispose()}}Object(f.a)(om,"ALiveBooksAccessibilityCheckPackageManager",null,[1,2]);class Gl{get Q4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get R4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get S4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Kwn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get ofc(){return CommonUIStrings.l_AccCheckerPaneTitle}get kAn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(f.a)(Gl,"AccessibilityCheckStringsProvider",null,[53]);class eo{constructor(){this.nfj=this.contentId=null}}Object(f.a)(eo,"ResultIds",null,[]);class Wi{constructor(S,Ba){this._element=null;this.ig=Ba;this.ae=S}get element(){this._element||(this._element=this.E9k(),this.zz());return this._element}Ybg(S){this._element=S}dispose(){this.element&&(this.h$(),this.Ybg(null))}zz(){this.ig&&this.ae?(this.ig.mb(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ae.mb(W.a.fi,this.element,
Object(a.a)(this,this.GG,"onKeyPress"))):ma.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}h$(){this.ig&&this.ae&&(this.ig.uc(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ae.uc(W.a.fi,this.element,Object(a.a)(this,this.GG,"onKeyPress")))}onClick(){this.yUi();return!0}GG(S){return this.lMm(S.Gb.keyCode)?(this.yUi(),!0):!1}lMm(S){return S===ak.a.noe||S===ak.a.Bs}}
Object(f.a)(Wi,"AInteractivePaneElement",null,[233,10]);var ki=c(444),mb=c(54);class pc extends Wi{constructor(S,Ba,ib){super(S,Ba);this.sLe=ib}hide(){this.element.removeAttribute(jg.a.qh);jg.a.gr(this.element,jg.a.gA,jg.a.np);this.element.style.display="none"}show(){jg.a.gr(this.element,jg.a.gA,jg.a.fM);jg.a.gr(this.element,jg.a.qh,jg.a.P1e);this.element.style.display="block"}E9k(){const S=ki.b("div",this.PQi,"AccCheckerNotification");jg.a.gr(S,jg.a.quh,jg.a.np);jg.a.gr(S,jg.a.qfa,this.cRf);S.tabIndex=
0;const Ba=ki.b("span",this.OQi,"AccCheckerNotificationIcon");var ib=Pe.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Ba.appendChild(ib);ib=ki.b("span",this.cRf,"AccCheckerNotificationText");mb.a.Gy(ib,this.QQi);S.appendChild(Ba);S.appendChild(ib);return S}yUi(){this.sLe()}}Object(f.a)(pc,"APopupNotification",Wi,[232,233,10]);class dd extends pc{constructor(S,Ba,ib,Sb){super(S,Ba,ib);this.dta=Sb}get PQi(){return"AccCheckerOutOfSyncNotificationId"}get OQi(){return"AccCheckerOutOfSyncNotificationIconId"}get cRf(){return"AccCheckerOutOfSyncNotificationTextId"}get QQi(){return this.dta.Kwn}}
Object(f.a)(dd,"OutOfSyncNotification",pc,[]);class Zb extends pc{constructor(S,Ba,ib,Sb){super(S,Ba,ib);this.dta=Sb}get PQi(){return"AccCheckerPartialResultNotificationId"}get OQi(){return"AccCheckerPartialResultNotificationIconId"}get cRf(){return"AccCheckerPartialResultNotificationTextId"}get QQi(){return this.dta.kAn}}Object(f.a)(Zb,"PartialResultNotification",pc,[]);var Ne=c(185),uf=c(31),Rf=c(173);class cd{constructor(S,Ba,ib,Sb=null,yc=null,ed=null,Ud=null){this.Jch=this.YL=this.ae=this.YIa=
null;this.b0=Sb;this.ig=S;this.Ub=Ba;this.fp=ib;this.dta=Ud||new Gl;this.gMe=yc||new dd(this.b0,this.ig,Object(a.a)(this,this.Jml,"dimissOutOfSyncNotification"),this.dta);this.XMe=ed||new Zb(this.b0,this.ig,Object(a.a)(this,this.Kml,"dimissPartialResultNotification"),this.dta)}show(){}hide(){}get b0(){return this.ae||(this.ae=l.AFrameworkApplication.ta.iD)}set b0(S){this.ae=S}sKh(){}Wna(){}dispose(){}L7a(){}UDm(S){var Ba=this.Jch[S];S=Ba.contentId;if((Ba=Ba.nfj+"")&&Ba.length){const ib=[];Array.add(ib,
Object.assign(new uf.a,{name:"RuleID",string:Ba}));Ne.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:String.format("{0}.{1}",cd.fig,"ViolationSelected"),dataFields:ib}))}this.bfn(S)}bfn(S){S&&this.YIa.oho(S)||(this.Ub.nL(Bd.AFrame.Ilh,!1),this.vuo())}Jml(){this.i8c(!1)}Kml(){this.srj(!1)}vuo(){const S=Object.assign(new ec.StandardDialog(!0),{yt:l.AFrameworkApplication.$ba,Ad:1,FHa:!1});S.cV(1);S.Ee(1,this.dta.Q4k);S.Ee(0,CommonUIStrings.l_DialogCancel);S.fV(this.dta.S4k,this.dta.R4k,Ba=>{1===Ba&&
this.hBf()})}PNk(S){let Ba=null;if(S.Results&&0<S.Results.length){Ba={};let ib=0;for(const Sb of S.Results)Sb.ResultId=cd.Rok+ ++ib,S=new eo,S.contentId=Sb.ContentId,S.nfj=Sb.RuleId,Ba[Sb.ResultId]=S}return Ba}k6m(){Ne.a.addNamespaceMapping(cd.fig,cd.WGo);Ne.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:String.format("{0}.{1}",cd.fig,"ShowTaskpane")}))}}cd.Rok="AccCheckResult";cd.fig="Office.UX.AccChecker";cd.WGo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)(cd,
"BaseAccessibilityCheckPane",null,[54,10]);class ei{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(ei,"AccCheckerTaskPaneProps",null,[]);var fh=c(1393),wc=c(1407),xj=c(1049),xh=c(176);class $h extends cd{constructor(S,Ba,ib,Sb,yc=null,ed=null,Ud,Xe=null,Ue=null){super(Ba,
ib,Sb,ed,void 0,void 0,Xe);this.gKg=null;this.wbh=this.WMe=this.hqd=this.vtd=this.Rsd=!1;this.gWe=null;this.dUe=!!l.AFrameworkApplication.ta&&!!l.AFrameworkApplication.ta.Nb&&l.AFrameworkApplication.ta.Nb.wGf;this.ftc=this.P5=null;this.Rtc=0;this.ckd=null;this.XY=yc;Ue&&(this.P5=Ue.qyd,this.ftc=Ue.Jep,this.Rtc=Ue.Ufp);this.gB=new wc.a}get isVisible(){return this.wbh}fTa(S){this.wbh=S}dff(S){S&&(this.gKg=S,S.IsSuccess&&(this.Jch=this.PNk(S),S.IsPartialResult&&this.srj(!0)),this.Rsd=!0,this.vtd=!1,
this.Cm())}i8c(S){this.isVisible&&S!==this.hqd&&(this.hqd=S,this.Cm())}srj(S){this.WMe=S;this.Cm()}qP(){this.vtd||xh.UISurfaces.Bu().then(S=>{wa.a.instance.Zy($h.Zqb+":PaneOpen:Start");S.showTaskPane($h.Zqb,this.jA());this.hBf();return null});this.isVisible?xh.UISurfaces.Bu().then(S=>{S.setSelectedTaskPane($h.Zqb);return null}):this.k6m()}Cm(){xh.UISurfaces.Bu().then(S=>{S.updateTaskPane($h.Zqb,this.jA());return null})}jA(){var S=new ei;this.gB.qob(S);S=Object.assign(new xj.a,{title:this.dta.ofc,
hideHeader:!1,width:320,location:2,contentProps:S,onOpen:()=>{this.M9();this.fTa(!0);l.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.eda();this.fTa(!1);this.vtd=this.Rsd=!1;this.Cm();l.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.dUe&&(S.enableResize=!0,S.minResizeWidth=268,S.maxResizeWidth=920);return S}initialize(S){const Ba=this.Ub.fe($h.Zqb);Ba.parent=Bd.AFrame.vp;Ba.TH=!0;this.YIa=S;this.Spk()}dispose(){this.L7a();this.gMe&&(this.gMe.dispose(),this.gMe=null);
this.XMe&&(this.XMe.dispose(),this.XMe=null);super.dispose()}Spk(){this.gB.oL(this.onRecheckExecute());this.gB.oL(this.ZJl());this.gB.oL(this.n$l());this.gB.oL(this.onInvokeNavigateExecute());this.gB.oL(this.uYl());this.gB.oL(this.p5l());this.gB.oL(this.h7l());this.gB.oL(this.updateLastScanTime());this.gB.oL(this.showHelpPane())}onRecheckExecute(){return S=>{S.onRecheckExecute=()=>{this.hBf()}}}ZJl(){return S=>{S.accessibilityCheckResultCollection=this.gKg}}n$l(){return S=>{S.resultsReady=this.Rsd}}onInvokeNavigateExecute(){return S=>
{S.onInvokeNavigateExecute=Ba=>{this.UDm(Ba)}}}uYl(){return S=>{S.helpLink=this.lyl}}p5l(){return S=>{S.outOfSync=this.hqd}}h7l(){return S=>{S.partialResult=this.WMe}}updateLastScanTime(){return S=>{S.updateLastScanTime=Ba=>{this.gWe=Ba}}}showHelpPane(){return S=>{S.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.PK||this.buh()?this.ckd?this.ckd():this.P5.value&&this.ftc&&
this.Rtc&&this.P5.value.Qb(this.Rtc,2,this.ftc):this.rsj():this.buh()?this.ckd?this.ckd():this.P5.value&&this.ftc&&this.Rtc&&this.P5.value.Qb(this.Rtc,2,this.ftc):this.rsj()}}}buh(){return!this.XY||!this.XY.value}rsj(){const S=this.XY.value;if(S){var Ba={};Ba.query=$h.Ffk+$h.e5j;Ba=Object.assign(new fh.a,{vR:Ba});S.n5($h.BCe,Ba)}}hBf(){this.WMe=this.hqd=this.Rsd=!1;this.gWe&&this.gWe();this.Cm();this.vtd=!0;this.YIa.dln()}M9(){this.Ub.mg($h.Zqb)}eda(){this.p3a()&&this.Ub.mg(this.Ub.yT)}p3a(){return!!this.Ub.currentScope&&
this.Ub.currentScope.name===$h.Zqb}}$h.Zqb="AccessibilityCheckerPane";$h.e5j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";$h.BCe="FA000000012";$h.Ffk="AssetID=";Object(f.a)($h,"ReactAccessibilityCheckPane",cd,[]);class Nf extends $h{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue=null){super(S,Ba,ib,Sb,yc,ed,void 0,Ue);this.P1j=Xe;this.R2=Ud}get lyl(){return this.P1j}qP(){this.R2.INa();super.qP()}}Object(f.a)(Nf,"ReactLiveBooksAccessibilityCheckPane",$h,[]);var Wh=c(1141),mk=c(137),Hj=c(152),Gh=c(61),nh=c(157),lc=
c(500),Sd;(function(S){S[S.error=0]="error";S[S.warning=1]="warning";S[S.tip=2]="tip";S[S.intelligentService=3]="intelligentService"})(Sd||(Sd={}));Object(f.b)("AccessibilityRuleCategory",Sd);class Yf{constructor(S,Ba,ib=null){this.sre=null;this.Q0g=this.z_g=!1;this.EMa=S;this.tdd=Ba;this.ga=ib;this.oc.qa(n.a.rZk,y.a.frame,Object(a.a)(this,this.K7e,"closePane"))}get oc(){return this.ga||(this.ga=l.AFrameworkApplication.va)}set oc(S){this.ga=S}tul(){this.z_g||(this.EMa.initialize(this),this.tdd.initialize(this),
this.z_g=!0)}dln(){I.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.tdd.R8n()}qP(S,Ba,ib){if(1===ib)return wh.SessionStatusManager.instance.Aj?8:32;this.EMa.isVisible||this.tul();this.Yvo();return 32}K7e(S,Ba,ib){1!==ib&&this.EMa.Wna();return 32}dsn(){this.EMa.i8c(!0)}dff(S){if(S){if(S.AccessibilityRules&&Object.keys(S.AccessibilityRules).length){const ib=S.AccessibilityRules;for(let Sb in ib){var Ba=Sb;const yc=ib[Sb].RuleId+"";Ba!==yc&&I.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
Ba,yc)}this.sre=ib}else!this.sre&&S.Results&&0<S.Results.length?(I.b(18993251,200,15,"No accessibility rule definitions available"),S.IsSuccess=!1):S.AccessibilityRules=this.sre;S.IsSuccess||I.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.pZn(S);this.W5m(S);this.EMa.dff(S)}}pZn(S){const Ba=S.AccessibilityRules;if(S=S.Results)for(let ib=S.length-1;0<=ib;ib--){const Sb=S[ib];let yc="";const ed=Sb.RuleId;Sb.ContentName||(yc+="Result does not have content name. ");ed in Ba||(yc+=String.format("No accessibility check rule exists for ID {0}.",
ed));0<yc.length&&(I.b(36214999,200,15,"Omitting invalid accessibility check result: "+yc),Array.removeAt(S,ib))}}vam(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):va.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Pz.loadScript("accessibility-checker-pane-strings")}Yvo(){this.Q0g?this.EMa.qP():this.vam().then(()=>{this.Q0g=!0;this.EMa.qP()}).catch(S=>ma.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
S))}W5m(S){var Ba={};const ib={};var Sb=S.Results,yc=[];Array.add(yc,Object.assign(new uf.a,{name:"FinalViolationCount",int64:0}));Array.add(yc,Object.assign(new uf.a,{name:"FinalErrorCount",string:"0"}));Array.add(yc,Object.assign(new uf.a,{name:"FinalWarningCount",string:"0"}));Array.add(yc,Object.assign(new uf.a,{name:"FinalTipCount",string:"0"}));Array.add(yc,Object.assign(new uf.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Sb){for(const Xe of Sb)if(S.AccessibilityRules){var ed=S.AccessibilityRules[Xe.RuleId];
if(ed){if(Ba[Sd[ed.Category]]){let Ue=Ba[Sd[ed.Category]];Ba[Sd[ed.Category]]=++Ue}else Ba[Sd[ed.Category]]=1;ib[Xe.RuleId]?(ed=ib[Xe.RuleId],ib[Xe.RuleId]=++ed):ib[Xe.RuleId]=1}}yc[0].int64=Sb.length;for(var Ud in Ba)switch(S=Ba[Ud],Sb=Ud,Sb="Final"+Sb.charAt(0).toUpperCase()+Sb.substring(1,Sb.length)+"Count",Sb){case "FinalErrorCount":yc[1].string=S.toString();break;case "FinalWarningCount":yc[2].string=S.toString();break;case "FinalTipCount":yc[3].string=S.toString();break;case "FinalIntelligentServiceCount":yc[4].string=
S.toString()}}Ne.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:yc}));for(let Xe in ib)Ba=Xe,yc=ib[Xe],Ud=[],Array.add(Ud,Object.assign(new uf.a,{name:"RuleID",string:Ba})),Array.add(Ud,Object.assign(new uf.a,{name:"FinalViolationCount",string:yc.toString()})),Ne.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Ud}))}dispose(){this.EMa&&
this.EMa.dispose();this.tdd&&this.tdd.dispose()}}Object(f.a)(Yf,"AAccessibilityCheckManager",null,[49,10]);var bk=c(307);const yj=[12,14,22,19,30,43,44];class Vm extends Yf{constructor(S,Ba,ib,Sb,yc,ed){super(Ba,ib,S);this.oc.qa(n.a.Gdg,y.a.frame,this.qP.bind(this));this.oc.fb(n.a.OLn,y.a.frame,this.U4i.bind(this),96);this.graph=yc;this.Sak=Sb;this.o8j=ed;this.Oec=()=>{this.dsn()};this.QVn()}U4i(S,Ba,ib,Sb,yc){if(1===ib)return 32;yc[bk.a.On]=this.EMa.isVisible;return 32}oho(S){if(this.o8j)return ma.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;ma.ULS.shipAssertTag(20272215,334,!!S);return this.Sak.Wen(S)}QVn(){for(const S of yj){const Ba=this.graph.Ye(S);Ba.Go(this.Oec);Ba.Vt(this.Oec);Ba.Ow(this.Oec)}}LQo(){for(const S of yj){const Ba=this.graph.Ye(S);Ba.WU(this.Oec);Ba.VU(this.Oec);Ba.Dia(this.Oec)}}dispose(){super.dispose();this.LQo()}}Object(f.a)(Vm,"WordAccessibilityCheckManager",Yf,[]);var yh=c(75),mh=c(28),fo=c(121),Wm=c(18),Fp=c(165),zl=c(6),Cf=c(16),Gd=c(468);class Ve{constructor(S,
Ba,ib,Sb,yc,ed,Ud){this.sm=null;this.EBb=0;this.Wc=Ba;this.Yz=ib;this.ib=Sb;this.ga=yc;this.fd=ed;this.St=S;this.ud=Ud}get XR(){if(!this.sm){const S=this.Wc.Wf(this.St.Uc);this.Yz.Jkg(S);if(S.zb(7)||S.jd(7))this.sm=yh.a.Qs(S,S.origin)}return this.sm}Wen(S){if(!S||!S.yg||0>=S.yg.length)return ma.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Ba=Array(S.yg.length);let ib=7,Sb=null;for(let ed=0;ed<S.yg.length;ed++)if(Sb=this.rCl(S.yg[ed])){if(7===ib)ib=this.EBb;else if(ib!==
this.EBb)return ma.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var yc=this.ud.MRa(Sb.characterData,Sb.pa);const Ud=S.cpBegin?this.ud.eBb(yc,S.cpBegin):-1;yc=S.cpEnd?this.ud.eBb(yc,S.cpEnd):-1;if(-1>Ud||-1>yc)return ma.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Ba[ed]=mh.a.nO(Ud,yc,!1,Sb);switch(S.contentType){case 5:if(!fo.HyperlinkReader.Zli(Ba[ed],!1))return!1;break;case 6:if(!Wm.ImageReader.g4(Ba[ed]))return!1;
break;case 7:Ba[ed]=mh.a.nO(-1,-1,!1,Sb)}}else return!1;Ba=new Fp.Selection(Ba,!1);return this.dmo(Sb,Ba,S.contentType)}rCl(S){if(this.XR)for(this.XR.reset(),this.EBb=7;this.XR.moveNext();){var Ba=this.XR.currentNode.type;if(38===Ba||36===Ba||23===Ba)this.EBb=Ba;else if(12===Ba){Ba=this.XR.currentNode;const ib=Ba.ia(zl.a.Lc,0);if(S===ib)return Ba}}return null}ghg(S){this.ga.processAction(Cf.a.BT,2);this.ga.processAction(Cf.a.z3,2);let Ba=2;switch(this.EBb){case 23:Ba=32;break;case 38:Ba=this.ga.Qb(Cf.a.J4a,
2,new Gd.a(S));break;case 36:Ba=this.ga.Qb(Cf.a.Ekb,2,new Gd.a(S));break;default:ma.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.EBb)}if(32===Ba)return!0;ma.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.EBb);return!1}dmo(S,Ba,ib){if(this.ghg(S)){S=this.St.tu;const Sb=this.ib.gb.kb;Sb&&Sb.equals(Ba)&&this.fd.ida(S,null);this.fd.ida(S,Ba);switch(ib){case 0:case 1:this.ga.processAction(Lg.a.JNb,2);break;case 2:this.ga.processAction(Lg.a.a6c,
2);break;case 3:this.ga.processAction(Lg.a.xya,2)}return!0}return!1}}Object(f.a)(Ve,"WordAccessibilityCheckNavigateManager",null,[1128]);class un{constructor(S){this.YIa=null;this.pWg=S}get fileId(){return this.pWg?this.pWg():null}initialize(S){this.YIa=S}NSi(S){this.YIa.dff(S)}}Object(f.a)(un,"AAccessibilityCheckService",null,[55,10]);class Nl{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(S){S=Sys.Serialization.JavaScriptSerializer.deserialize(S);
const Ba=S.AccessibilityRules,ib={};if(Ba)for(let Sb=0;Sb<Ba.length;++Sb){const yc=Ba[Sb];ib[yc.Key]=yc.Value}S.AccessibilityRules=ib;return S}}Object(f.a)(Nl,"AccessibilityCheckResultCollection",null,[]);class Xm extends un{constructor(S){super(S);this.onFailure=(Ba,ib)=>{ma.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",ib);Ba=Object.assign(new Nl,{IsSuccess:!1});this.NSi(Ba)};this.onSuccess=Ba=>{Ba=Xm.l$l(Ba);let ib=null;if(Ba)try{ib=this.hkl(Ba)}catch(Sb){ma.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Sb.message),ib=Object.assign(new Nl,{IsSuccess:!1})}else ma.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),ib=Object.assign(new Nl,{IsSuccess:!1});this.NSi(ib)}}dispose(){}static l$l(S){let Ba=null;S&&S.Dj&&(Ba=S.Dj[0]);return Ba?Ba.Body:null}}Object(f.a)(Xm,"ALiveBooksAccessibilityCheckService",un,[]);var nl=c(990),lo=c(231);class go extends lo.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}al(){return 56}static construct(S,
Ba){const ib=new go;ib.FileId=S;ib.IsCoauthorable=Ba;return ib}}Object(f.a)(go,"WordAccessibilityCheckRequest",lo.a,[]);class gj{}Object(f.a)(gj,"AccessibilityCheckRule",null,[]);var rc=c(182);class Ym{static parse(S){switch(Sa.a.Ug(S)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw S=String.format("Invalid Accessibility result category: {0}",S),rc.a.argument(S);}}}Object(f.a)(Ym,"AccessibilityRuleCategoryParser",null,[]);class Pc{constructor(){this.Category=
this.Text=this.Id=null}static aJo(S){const Ba=new gj;Ba.RuleId=S.Id;Ba.RuleName=S.Text;Ba.Category=Ym.parse(S.Category);return Ba}}Object(f.a)(Pc,"WordAccessibilityCheckRule",null,[]);class tm{}Object(f.a)(tm,"AccessibilityCheckResult",null,[]);class nk{constructor(){this.cpEnd=this.cpBegin=this.yg=null;this.contentType=0}}Object(f.a)(nk,"WordAccessibilityCheckContentId",null,[]);const Ol=S=>{switch(Sa.a.Ug(S)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Go=c(1593);class zj{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static ZIo(S){const Ba=new tm;Ba.RuleId=S.RuleId;Ba.ContentName=S.Label;const ib=new nk;ib.yg=S.ParaId;ib.cpBegin=Go.b(S.OS);ib.cpEnd=Go.b(S.OE);ib.contentType=Ol(S.ContentType);Ba.ContentId=ib;return Ba}}Object(f.a)(zj,"WordAccessibilityViolation",null,
[]);class ip{constructor(){this.Violations=this.Rules=null}static $Io(S){const Ba=new Nl;try{var ib={};if(S.Rules){for(let Sb=0;Sb<S.Rules.length;++Sb){const yc=Pc.aJo(S.Rules[Sb]);ib[yc.RuleId]=yc}Ba.AccessibilityRules=ib}if(S.Violations){const Sb=Array(S.Violations.length);for(ib=0;ib<S.Violations.length;++ib)Sb[ib]=zj.ZIo(S.Violations[ib]);Ba.Results=Sb}Ba.IsPartialResult=!1;Ba.IsSuccess=!0}catch(Sb){ma.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Sb.message),Ba.IsSuccess=!1}return Ba}}Object(f.a)(ip,"WordAccessibilityCheckResult",null,[]);class Mj extends Xm{constructor(S,Ba,ib){super(S);this.ttb=Ba;this.vab=ib}R8n(){const S=Object.assign(new nl.a,{Dq:go.construct(this.fileId,this.vab),status:1,HG:"AccessibilityCheck"});this.ttb(12,!1,this.onSuccess,this.onFailure,S,null,S)}hkl(S){S=ab.b(S);return ip.$Io(S)}}Object(f.a)(Mj,"WordAccessibilityCheckService",Xm,[]);class Ug extends om{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}xc(S){super.xc(S);
S.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Nf(l.AFrameworkApplication.va,Hq.a.instance,di.FocusManager.instance(),Ep.a.instance,S.Ue("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),of.KeyInputManager.instance,Wh.a.instance,l.AFrameworkApplication.K.jb("AccessibilityCheckerHelpUrl"))).singleInstance();S.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Mj(()=>l.AFrameworkApplication.rootQuerySignature,lc.a.LQ,mk.PageReader.instance.OPd(cb.App.xa.hb.Uc))).singleInstance();
S.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Ve(cb.App.xa.hb,S.resolve("Box4.Graph.IGraphIteratorFactory"),Hj.PageNavigator.instance,S.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.va,Gh.InteractiveViewManager.instance,S.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();S.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Vm(l.AFrameworkApplication.va,S.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
S.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),S.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),cb.App.Tj.zl,nh.App.QUc)).singleInstance()}init(){this.container.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{om.prototype.init.call(this)})}}Object(f.a)(Ug,"WordAccCheckerPackageManager",om,[]);class jp{constructor(S,Ba){this.phh=!1;this.oMo=()=>{this.nMo()};this.Nk=S;this.DI=Ba}E4a(S){S.AM.Cyk(this.oMo)}nMo(){!this.phh&&this.Nk&&(this.Nk.FFa?
this.DI?this.DI.execute(S=>{S.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ma.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.phh=!0)}}Object(f.a)(jp,"CoauthSurveyManager",null,[1111]);class ol{constructor(){this.St=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){cb.App.xa&&(this.St=cb.App.xa.hb)&&(this.St.vwa?this.eja():this.St.ifa(()=>{this.eja()}))}eja(){var S=this.St.Uc;S&&(S=S.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").E4a(S)}dispose(){}xc(S){this.W=S;S.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new jp(S.resolve("WordEditor.IWordEditorCoauthManager"),S.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&L.a.instance.Fc(new ol)}}Object(f.a)(ol,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var ld;(function(S){S[S.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";S[S.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";S[S.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(ld||(ld={}));Object(f.b)("ComponentLoggingScenario",ld);var Om=c(1452);class zo{flush(S,Ba){const ib=this.rTl(S);ib.LoggingScenario=ld[Ba];Lc.a(ib).length?ma.ULS.sendTraceTag(594571986,3013,15,"{0}",ib):ma.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
Om.a[S.YZa])}rTl(S){const Ba={};if(!S)return Ba;const ib=new jc.a;for(ib.enqueue(S);!ib.isEmpty;){S=ib.dequeue();const Sb=Om.a[S.YZa];try{Ba[Sb]=S.sA()}catch(yc){ma.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Sb.toString(),{["Kind"]:"Exception",["Stack"]:yc.stack,["Message"]:yc.message,["FileName"]:yc.fileName,["LineNumber"]:yc.lineNumber})}if((S=S.QEd)&&S.length)for(const yc of S)!yc||Om.a[yc.YZa]in Ba||ib.enqueue(yc)}return Ba}}
Object(f.a)(zo,"ComponentStateLogManager",null,[870]);class mo{flush(){}}Object(f.a)(mo,"NoOpComponentStateLogManager",null,[870]);class Qk{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}xc(S){this.W=S;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?S.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new zo).as("Common.IComponentStateLogManager").singleInstance():
S.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new mo).as("Common.IComponentStateLogManager").singleInstance()}static main(){L.a.instance.Fc(new Qk)}}Object(f.a)(Qk,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Ho=c(2039);class Iq{constructor(S,Ba,ib){this.Yf=S;this.Eud=Ba;this.ubh=ib}tj(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf=null,Bg=!1,Vh=null,Jh=null,ij=null,gk=null,Yh=!1){return this.ubh?this.Eud.tj(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg,Jh,ij):this.Yf.tj(S,Ba,ib,Sb,yc,ed,Ud,
Xe,Ue,Kf,Bg,Vh,Jh,ij,gk,Yh)}p8b(S){return this.ubh?this.Eud.p8b():this.Yf.p8b(S)}}Object(f.a)(Iq,"ClientRequestAdapter",null,[1265]);var kq=c(229),Ik=c(251),no=c(219),rj=c(1402),mg=c(311),Jk=c(1413),cl=c(2040),Ff=c(51),Xo=c(725),Kk=c(590),qf=c(107),Aj=c(568),ka=c(603),bb;(function(S){S[S.none=0]="none";S[S.getCells=1]="getCells";S[S.hotStoreStatus=2]="hotStoreStatus";S[S.saveMonitor=3]="saveMonitor";S[S.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";S[S.kickoutExecutor=5]="kickoutExecutor"})(bb||
(bb={}));Object(f.b)("MostRecentRevisionIdOrigin",bb);class ub extends Sys.EventArgs{constructor(S,Ba,ib,Sb){super();this.RWc=S;this.httpStatusCode=ib;this.VH=Sb}}Object(f.a)(ub,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Xb{constructor(){this.U6=0}get isEmpty(){return!this.U6}EDc(S){this.U6|=S}wVc(S){return!!(this.U6&S)}clear(){this.U6=0}JFc(){return!1}}Object(f.a)(Xb,"DocxSaveMonitorRetryAttemptOnce",null,[]);class tc{constructor(S,Ba=3){this.U6=0;this.Usd=new Map;this.iak=S;this.Wgk=
Ba}get isEmpty(){return!this.U6}EDc(S){this.U6|=S;let Ba=this.Usd.get(S)||0;this.Usd.set(S,++Ba)}wVc(S){return!!(this.U6&S)}clear(){this.U6=0;this.Usd.clear()}JFc(S){return this.Wgk&S?(this.Usd.get(S)||0)<this.iak:!1}}Object(f.a)(tc,"DocxSaveMonitorRetryAttemptMany",null,[]);class Tc{static create(S=!1,Ba=3,ib=0){return S?new tc(Ba,ib):new Xb}}Object(f.a)(Tc,"DocxSaveMonitorRetryAttemptFactory",null,[]);var Md=c(1712),le;(function(S){S[S.nip=-1]="noResultYet";S[S.tnp=0]="upToDate";S[S.$kp=1]="sessionLost";
S[S.znp=2]="userSignedOut";S[S.Ojp=3]="previousRequestPending";S[S.Ide=4]="requestFailed";S[S.ulp=5]="shuttingDown";S[S.sip=6]="nullResponseData";S[S.Bgp=7]="invalidResponseData";S[S.Dep=8]="failedRevisionLookup";S[S.Fkp=9]="savedWithinThreshold";S[S.pip=10]="notSavedWarning";S[S.Ugp=11]="kickoutThreshold";S[S.enp=12]="unknownRevision";S[S.Fcp=13]="contentNotYetLoaded";S[S.sessionExpired=14]="sessionExpired";S[S.canaryError=15]="canaryError";S[S.timeout=16]="timeout";S[S.Vgp=17]="kickoutThreshold_Offline";
S[S.Idp=18]="dssSessionDeleted";S[S.Jdp=19]="dssSessionExpired";S[S.Gnp=20]="waitingForSessionTokenRefresh";S[S.Kdp=21]="dssSessionNotFound"})(le||(le={}));Object(f.b)("SaveMonitorResult",le);class md{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg,Vh,Jh,ij,gk,Yh,bq,gr,Ko,Ao,Lp,cq,vq,Yn,Hn,Cd=null,Aa){this.kxc=0;this.bWb=!1;this.Pzc=null;this.Tvc=this.MN=-1;this.TNe=null;this.trd=0;this.urd=!1;this.Mvb=null;this.Sxc=0;this.DQe=this.tih=null;this.nS=this.K3g=this.Yrc=0;this.hIe=null;this.T0g=!1;this.il=
null;this.Fud=0;this.jwd=void 0;this.ufh=!1;this.Uch=0;this.xfh=this.zfh=!1;this.xDl=()=>{var Qa;ma.ULS.sendTraceTag(524871194,md.Qm,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.fR,["AppVisibilityState"]:rj.a[null===(Qa=this.il)||void 0===Qa?void 0:Qa.rC]});try{if(this.ufh&&this.vtc){var Ca=this.vtc();ma.ULS.sendTraceTag(509367249,md.Qm,50,"Additional Details: {0}",Ca)}}catch(ya){Qa=ab.c({["Kind"]:"Exception",["Stack"]:ya.stack,["Message"]:ya.message,["FileName"]:ya.fileName,["LineNumber"]:ya.lineNumber}),
ma.ULS.sendTraceTag(509367062,md.Qm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Qa)}Qa=this.Uub;this.Uub=this.Oz();if(this.T$())this.Wz.event(5),this.stop("session has shut down");else if(this.uab===md.Zdj&&this.fza(this.htb),Ca=this.Dtc())if(this.xGe()&&l.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.fR)this.Wz.event(0);else if(this.fWb())this.Wz.event(1),this.stop("session is lost"),
l.AFrameworkApplication.te("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.T0g&&!this.mMm()&&(ma.ULS.sendTraceTag(554726995,md.Qm,10,"DocxSaveMonitor: Session lost but not kicked out"),this.XC(Ff.a.hTh));else if(this.xGe())20!==this.Wz.currentState?(this.Wz.event(20),this.tih=this.Oz(),ma.ULS.sendTraceTag(593510691,md.Qm,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.uih)):this.Oz().getTime()-this.tih.getTime()>this.uih&&
(this.Wz.event(14),this.h0d(20,Ff.a.fJd,"TokenExpired"));else if(this.h9j())if(this.Uub=Qa,this.bWb)this.Wz.event(3),this.Oz().getTime()-this.Pzc.getTime()>this.rHe&&(Qa=this.ive.p8b(this.MN),ma.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.MN,An.a[Qa]),this.Gsd&&this.Gsd.log(),this.stop("stuck on previousRequestPending"),this.XC());else if(Qa=Kk.b(Md.a.construct(Ca)),this.bWb=!0,this.Pzc=this.Ggk(),this.MN=this.ive.tj(md.serviceUrl,
2,Qa,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.PVk,this.OVk,null,void 0,void 0,this.Ifk,this.iRe,void 0,void 0,!0),0>=this.MN)this.bWb=!1,ma.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.MN.toString());else{Qa=this.ive.p8b(this.MN);Ca=100;if(Qa&&1!==Qa||this.qZg)Ca=50;ma.ULS.sendTraceTag(19161612,md.Qm,Ca,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.MN,["Status"]:An.a[Qa]});this.Gsd&&this.Gsd.start(this.MN)}else this.Wz.event(2);
else this.Wz.event(13)};this.OVk=Qa=>{this.nS=this.ZEd+1;let Ca=this.bWb=!1,ya=!1;Qa=Qa.data;Fa.a.fl&&l.AFrameworkApplication.Fha("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");Qa?(ma.ULS.sendTraceTag(22552773,md.Qm,15,"Request failed {0}",{["Status"]:Qa.status,["HttpStatus"]:Qa.Qe,["Correlation"]:Qa.wj?Qa.wj[mg.a.L7]:"",["Id"]:Qa.id,["ConsecutiveErrors"]:this.ZEd,["Request.InvokedTime"]:Qa.MH,["Request.EnqueueTime"]:Qa.cOa,["Request.CompletedTime"]:Qa.rT}),ya=7===Qa.status||
13===Qa.status,this.JFc(2)&&ya?(this.lVa.EDc(2),Ca=!0,this.Tvc=Qa.Qe,this.Wz.event(16)):this.JFc(1)&&5===Qa.status?(this.lVa.EDc(1),Ca=!0,this.Tvc=Qa.Qe,this.Wz.event(15)):(this.Wz.event(4),this.Tvc=Qa.Qe)):(this.Wz.event(4),ma.ULS.sendTraceTag(23425240,md.Qm,15,"RequestFailed and event data is null"));if(!Ca&&(this.lVa.clear(),ya?this.h0d(17,Ff.a.wql,"while offline"):this.h0d(11,Ff.a.Jff,"while online")))return;this.fza(Ca?this.CMl(ya):this.htb)};this.PVk=Qa=>{this.nS=this.ZEd+1;this.bWb=!1;var Ca=
{};this.lVa.clear();if(Qa=Qa.data){var ya=Qa.wj?Qa.wj[mg.a.L7]:"";Ca.HttpStatus=Qa.Qe;Ca.Correlation=ya;Ca.Id=Qa.id;ma.ULS.sendTraceTag(23425242,md.Qm,this.qZg?50:100,"Request succeeded at the HTTP level {0}",Ca);this.Tvc=Qa.Qe}else ma.ULS.sendTraceTag(23425241,md.Qm,15,"Request succeeded with null response data");if(this.T$()||!this.gJd)this.Wz.event(5),this.stop("session has shut down");else if(!this.pRm())if(Qa&&Qa.we)if(Qa=this.Rua(Qa.we))if(this.w2.dUa(Qa),Qa.StatusCode)this.hWm(Qa,Ca)||this.Wz.event(8,
Ca);else{this.nS=0;this.Uub=this.Oz();this.JPe.clear();Ca={["LastSavedRevisionId"]:Qa.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Qa.RevisionSequenceNumber};Qa=qf.b(Qa.LastSavedRevisionId);this.mob(Qa,3);var $a=this.Dof().store.getRevision(Qa);if($a){Qa=null;ya=this.ohb();$a=($a=$a.M0a(ya))?$a.id:$g.a.nil;let Cb=ya;for(;Cb&&!Cb.id.equals($a);)Qa=Cb,Cb=Cb.im;this.znm(Qa,Ca,ya)||this.Wz.event(9)}else this.imm()||this.Wz.event(12,Ca);this.fza(this.DZb)&&ma.ULS.sendTraceTag(22552774,md.Qm,
50,"Received response from server -- going back to normal interval")}else this.Wz.event(7),this.IHf("invalid response",Ca);else this.Wz.event(6),this.IHf("null response",Ca)};this.D6n=(Qa,Ca)=>{Qa={};Qa.DocxSaveMonitorState=le[Ca.newState];Qa.PreviousState=le[Ca.u_f];Qa.PreviousStateHits=Ca.v_f;Qa.PreviousStateTransitionTime=Ca.w_f.toISOString();Qa.LastHttpStatus=this.Tvc;Qa.LastSuccessTime=this.Uub.toISOString();this.Pzc&&(Qa.LastRequestStartTime=this.Pzc.toISOString());Qa.LastSavedRevisionID=this.m4d.toString();
Qa.LastSavedRevisionIdOrigin=this.kxc;Qa.LastSavedRevisionIdSetTime=this.DQe?this.DQe.toISOString():null;Qa.IsViable=this.$e.Wwa;Qa.IsNetworkConnected=this.$e.OH;Qa.IsExpired=this.$e.cca;Qa.HasEmergencyViewModeBeenDeployed=this.$e.Aj;Qa["Navigator.Online"]=window.navigator.onLine;const ya=Ca.GBo;ya&&md.xNi(Qa,ya);Ca=Ca.newState;switch(Ca){case 13:ma.ULS.sendTraceTag(5830086,md.Qm,50,"{0}",Qa);break;case 1:ma.ULS.sendTraceTag(5884125,md.Qm,50,"{0}",Qa);break;case 0:ma.ULS.sendTraceTag(5830087,md.Qm,
50,"{0}",Qa);break;case 2:ma.ULS.sendTraceTag(5830088,md.Qm,50,"{0}",Qa);break;case 3:ma.ULS.sendTraceTag(5830089,md.Qm,50,"{0}",Qa);break;case 4:ma.ULS.sendTraceTag(5884126,md.Qm,50,"{0}",Qa);break;case 5:ma.ULS.sendTraceTag(5884127,md.Qm,50,"{0}",Qa);break;case 6:ma.ULS.shipAssertTag(5830090,md.Qm,!1,"{0}",Qa);break;case 7:ma.ULS.shipAssertTag(5830091,md.Qm,!1,"{0}",Qa);break;case 8:ma.ULS.sendTraceTag(5830092,md.Qm,15,"{0}",Qa);break;case 10:ma.ULS.sendTraceTag(5830094,md.Qm,15,"{0}",Qa);break;
case 9:ma.ULS.sendTraceTag(5884128,md.Qm,50,"{0}",Qa);break;case 11:ma.ULS.sendTraceTag(5830096,md.Qm,15,"{0}",Qa);break;case 17:ma.ULS.sendTraceTag(37835678,md.Qm,15,"{0}",Qa);break;case 12:ma.ULS.sendTraceTag(5830095,md.Qm,15,"{0}",Qa);break;case 18:ma.ULS.sendTraceTag(38122832,md.Qm,15,"{0}",Qa);break;case 19:ma.ULS.sendTraceTag(38122833,md.Qm,15,"{0}",Qa);break;case 21:ma.ULS.sendTraceTag(0,md.Qm,15,"{0}",Qa);break;case 14:ma.ULS.sendTraceTag(6575508,md.Qm,15,"{0}",Qa);break;case 15:ma.ULS.sendTraceTag(36739287,
md.Qm,50,"{0}",Qa);break;case 16:ma.ULS.sendTraceTag(36767649,md.Qm,15,"{0}",Qa);break;case 20:ma.ULS.sendTraceTag(593510690,md.Qm,15,"{0}",Qa);break;default:ma.ULS.shipAssertTag(5884129,md.Qm,!1,"Bad state:{0} logInfo:{1}",Ca,Qa)}};this.DZb=S;this.htb=Ba;this.uab=S;this.Okh=ib;this.Rik=Sb;this.Ifk=ed;this.iRe=Ud;this.kXb=Xe;this.qSg=Ue;this.ive=Kf;this.F6=Bg;this.w2=Vh;this.Dtc=Jh;this.h9j=ij;this.fWb=gk;this.xGe=Yh;this.T$=bq;this.Oz=gr;this.Ggk=Ko;this.T0g=Hn;this.lVa=Tc.create(Aa.isEnabled,Aa.maxRetries,
cq.U6);this.JPe=new ka.a;this.vtc=vq;this.Wz=new Jk.a(-1);this.$e=Cd;this.Wz.r_e(this.D6n);this.Gsd=Ao;this.Uub=gr();this.qZg=Lp;this.jVj=Aa.isEnabled?null:cq;this.Trb=Yn;this.uih=this.Okh;this.dKe=$g.a.nil;this.ra=new M.a;va.a.instance.Sa("Common.App.VisibilityManagement.IVisibilityManager").execute(Qa=>{this.il=Qa;this.il.ZYa((Ca,ya)=>{this.IX(Ca,ya)});this.dOe=Qa.rC});this.$e&&this.$e.WZe((Qa,Ca)=>{this.bKb(Qa,Ca)});this.rHe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
yc):yc;this.Uch=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.htb):this.htb;this.ufh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.zfh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldOnlyKickoutWhenVisible",!1):!1;this.xfh=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.Xgk=Aa}bKb(S,Ba){ma.ULS.sendTraceTag(528577692,md.Qm,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",cl.a[Ba.SRf],cl.a[Ba.AZc]);1!==Ba.AZc&&3!==Ba.AZc&&(ma.ULS.sendTraceTag(528566343,md.Qm,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.lVa.wVc(1),this.lVa.wVc(2)),this.lVa.clear())}get gJd(){return this.Yrc}get m4d(){return this.dKe}get fR(){const S=
!this.ohb()||this.m4d.equals(this.ohb().id);S||ma.ULS.sendTraceTag(521413851,md.Qm,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.ohb().id.toString(),this.m4d.toString());return S}get Sxi(){return this.Oz().getTime()-this.Uub.getTime()>this.rHe}get ZEd(){return this.nS}get YZa(){return 3}get QEd(){let S=null;cb.App.xa&&cb.App.xa.hb&&cb.App.xa.hb.Uc&&(S=cb.App.xa.hb.Uc.contentReplicator);return[S,nh.App.e1]}IX(S,Ba){var ib,Sb,yc;S={["VisibilityState"]:rj.a[this.il.rC],
["IsVisible"]:this.il.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.bWb,["KickoutIntervalElapsed"]:this.Sxi,["LastSuccessfulIterationTime"]:null!==(ib=this.Uub)&&void 0!==ib?ib:"null",["RequestStartTime"]:null!==(Sb=this.Pzc)&&void 0!==Sb?Sb:"null",["SkippedKickouts"]:this.Fud,["LastSkippedKickoutAt"]:null!==(yc=this.P3g)&&void 0!==yc?yc:"null"},["IsViable"]:this.$e.Wwa,["IsNetworkConnected"]:this.$e.OH,["IsExpired"]:this.$e.cca,["HasEmergencyViewModeBeenDeployed"]:this.$e.Aj,["Navigator.Online"]:window.navigator.onLine};
ma.ULS.sendTraceTag(539874775,md.Qm,50,ab.c(S));this.dOe!=this.il.rC&&(0==Ba.oldState||1==Ba.oldState||0!==Ba.newState&&1!==Ba.newState||this.fza(this.Uch),0===this.il.rC?(uc.c(Cf.a.FLk,void 0,void 0,void 0,void 0,void 0,S),this.jwd&&uc.b("AvgTimeSpentOutsideOfWord",Date.now()-this.jwd,1),this.jwd=void 0):0===this.dOe&&(uc.c(Cf.a.GLk,void 0,void 0,void 0,void 0,void 0,S),this.jwd=Date.now()),this.dOe=this.il.rC)}start(){this.Yrc=this.qSg.hfb(this.xDl,this.uab)}fza(S){if(!this.gJd||this.uab===S)return!1;
const Ba=this.uab;this.uab=S;this.stop("changing save monitor interval from "+Ba+"ms to "+S+"ms");this.start();return!0}mob(S,Ba){if(Ba>=this.kxc&&S&&!$g.a.nil.equals(S)){var ib=!this.dKe.equals(S);this.kxc=Ba;this.dKe=S;const Sb=this.Oz();this.DQe=Sb;const yc=this.fR;ib&&(Ba={["Id"]:S.toString(),["IsUpToDate"]:yc,["Origin"]:bb[Ba]},this.hIe&&(Ba.LastUpToDateTime=this.hIe.toISOString()),(ib=this.Dof())&&ib.store&&(S=ib.store.getRevision(S))&&(Ba.LastSavedCreationTime=S.creationTime.toISOString()),
ma.ULS.sendTraceTag(557320151,md.Qm,50,"Updating Last Saved Revision: {0}",Ba));yc&&(this.hIe=Sb)}else Ba<this.kxc?ma.ULS.sendTraceTag(572051800,md.Qm,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.kxc,Ba):ma.ULS.sendTraceTag(572051801,md.Qm,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Ba)}stop(S){this.We(S)}We(S){this.gJd&&(ma.ULS.sendTraceTag(5830084,md.Qm,50,"Stopping DocxSaveMonitor because {0}!",S),this.qSg.We(this.gJd),this.Yrc=0)}imm(){if(0>=this.kXb)return!1;
var S=this.K4l();if(!S)return this.TNe=null,this.trd=0,this.urd=!1;this.Mvb=S.dMd;this.Mvb===this.TNe?this.trd++:(this.TNe=this.Mvb,this.trd=1,this.urd=!1);if(this.trd<md.Scn)return!1;this.Sxc=+this.Oz()-+this.Mvb;if(this.Sxc<=this.kXb)return!1;if(!this.urd)return this.urd=!0,this.J5i(),!1;if(this.Trb)this.Trb.execute(Ba=>{Ba.flush(this,0)});else{S="";try{this.vtc&&(S=this.vtc())}catch(Ba){S=ab.c({["Kind"]:"Exception",["Stack"]:Ba.stack,["Message"]:Ba.message,["FileName"]:Ba.fileName,["LineNumber"]:Ba.lineNumber}),
ma.ULS.sendTraceTag(50426817,md.Qm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",S)}ma.ULS.sendTraceTag(50426818,md.Qm,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Mvb.toISOString(),this.Sxc,this.kXb,S)}this.kXb=-1;this.stop("Exceeded oldest allowed local revision");this.XC(Ff.a.xql);return!0}K4l(){let S=null,Ba=this.ohb();for(;Ba&&!Ba.Nwa;)S=Ba,Ba=Ba.im;return S}pRm(){return this.fWb()?
(this.Wz.event(1),this.stop("session is lost"),!0):this.xGe()?(this.Wz.event(14),ma.ULS.sendTraceTag(20029718,md.Qm,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.XC(Ff.a.fJd),!0):!1}Dof(){const S=this.Dtc();return S?S.Jc:null}ohb(){const S=this.Dof();return S?S.jm:null}JFc(S){return this.Xgk.isEnabled?this.lVa.JFc(S):this.jVj.wVc(S)&&!this.lVa.wVc(S)}CMl(S){return S?md.SIo:md.Zdj}h0d(S,Ba,ib){if(this.Sxi)if(this.il&&!this.il.isVisible)ma.ULS.sendTraceTag(540669727,md.Qm,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.Fud+=1,this.P3g=this.Oz();else return this.Wz.event(S,{}),this.stop("request failed after kickout interval "+ib),this.Trb&&this.Trb.execute(Sb=>{Sb.flush(this,2)}),this.XC(Ba),!0;return!1}hWm(S,Ba){const ib=S.StatusCode;return 88===ib||89===ib||236===ib?(Ba.KickoutDiagnostics=this.vtc(),88===ib?(Ba.Result="deleted DSS session",this.Wz.event(18,Ba),this.stop("deleted DSS session"),this.XC(Ff.a.localCobaltDeletedSessionFault)):89===ib?(Ba.Result="expired DSS session",this.Wz.event(19,Ba),this.stop("expired DSS session"),
this.XC(Ff.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.Dn("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(S=qf.b(S.LastSavedRevisionId),this.mob(S,4)),Ba.Result="DSS session not found",this.Wz.event(21,Ba),this.stop("DSS session not found"),this.XC(Ff.a.localCobaltSessionNotFound)),!0):14===ib?(this.stop("DSS returned an unspecified failure"),
this.XC(Ff.a.Z_m),!0):104===ib?(this.stop("this operation is disabled on the server"),!0):this.IHf("unrecognized OperationResult: "+ib,Ba)}IHf(S,Ba){if(!this.JPe.contains(S))this.JPe.add(S);else if(this.h0d(11,Ff.a.Jff,S))return Ba.ConsecutiveErrors=this.ZEd,Ba.Reason=S,ma.ULS.sendTraceTag(41997899,md.Qm,15,"DocxSaveMonitor kickout. {0}",Ba),!0;this.fza(this.htb);return!1}znm(S,Ba,ib){let Sb=!1;if(S){const yc=this.Oz().getTime()-S.creationTime.getTime();yc>=this.Okh&&(Sb=!0,md.xNi(Ba,this.w$l(S,yc,
ib)),yc>=this.rHe&&10===this.Wz.currentState?(this.Wz.event(11,Ba),this.stop("didn't save in time"),this.XC()):(this.Wz.event(10,Ba),this.J5i(),this.zlf()))}return Sb}vxk(S){this.ra.addHandler(md.Q1i,S)}Wwk(S){this.ra.addHandler(md.Glf,S)}Aaj(S){this.ra.removeHandler(md.Glf,S)}J5i(){this.ra.raiseEvent(md.Q1i)}Rua(S){let Ba;return({group:Ba}=Aj.a.l1(S)).returnValue?Ba.Responses[0]:null}w$l(S,Ba,ib){const Sb={};Sb.FirstUnsavedRevisionId=S.id.toString();Sb.FirstUnsavedRevisionLengthToRoot=S.mR;Sb.UnsavedTimeInMs=
Ba;Sb.CurrentRevisionId=ib.id.toString();Sb.CurrentRevisionLengthToRoot=ib.mR;return Sb}zlf(){lc.a.Alf(8)}XC(S=Ff.a.Jff){this.Rik?this.xfh?(ma.ULS.sendTraceTag(509146274,md.Qm,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",S,this.l7h()),0==this.Yrc&&this.start()):this.zfh&&this.il&&!this.il.isVisible?(ma.ULS.sendTraceTag(509146273,md.Qm,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",S,this.l7h()),0==this.Yrc&&
this.start()):(this.stop(md.iWm),S===Ff.a.fJd?this.F6.value.XC(S,Object.assign(new Xo.a,{zfa:4,XW:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,m3:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.F6.value.XC(S,new Xo.a)):ma.ULS.sendTraceTag(19247383,md.Qm,50,"Kickout disabled")}l7h(){const S={};var Ba=va.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");S.HasDataloss=!Ba.fR;S.UnSavedRevisionsCount=Ba.I7a;S.OldestUnsavedRevisionCreationTime=Ba.fR?
"":Ba.ZDb().toString();S.RevisionsWithOutServerRevisionSequenceNumbers=Ba.t3b();S.RevisionsWithServerRevisionSequenceNumbers=Ba.cGd();S.RSNManager_Diagnostics=Ba.sA();if(Ba=va.a.instance?va.a.instance.Na("WordEditor.RunawayDataLossMonitor"):null)S.RunawayDataLossMonitor_Diagnostics=Ba.Cfj;S.DocxSaveMonitor_Diagnostics=this.sA();(Ba=va.a.instance?va.a.instance.Na("WordEditor.ILastSavedToHostDetailsManager"):null)&&(S.LastSavedToHostDetailsManager_Diagnostics=Ba.sA());this.il&&(S.VisibilityState=rj.a[this.il.rC]);
return S}sA(){const S={};this.Mvb&&(S.ORT=this.Mvb.toISOString());0<this.Sxc&&(S.AA=this.Sxc);0<this.kXb&&(S.MAA=this.kXb);0<this.Fud&&(S.LSKO=this.P3g.toISOString());this.Wz&&0<=this.Wz.currentState&&(S.SMS=le[this.Wz.currentState]);const Ba={};l.AFrameworkApplication.Joa&&(Ba.S=1);cb.App.lostSession&&(Ba.LS=1);this.$e&&(this.$e.Ao&&(Ba.KO=1),this.$e.cca&&(Ba.TE=1));this.il&&(Ba.VS=rj.a[this.il.rC]);window.navigator&&(Ba.NW=!window.navigator.onLine);S.AMD=Ba;return S}cYl(){const S={"Content-Type":"application/json; charset=utf-8",
"X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(S["X-OfficeVersion"]=Sa.a.$Q(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(S["X-AccessToken"]=Sa.a.$Q(l.AFrameworkApplication.accessToken),S["X-AccessTokenTtl"]=l.AFrameworkApplication.DMa.toString());l.AFrameworkApplication.canary&&(S["X-Key"]=Sa.a.$Q(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(S["X-UserType"]=Sa.a.$Q(l.AFrameworkApplication.userType));const Ba=l.AFrameworkApplication.Ne.SY;
Ba&&(S["X-WacCluster"]=Sa.a.$Q(Ba));l.AFrameworkApplication.userSessionId&&(S["X-UserSessionId"]=Sa.a.$Q(l.AFrameworkApplication.userSessionId));return S}QGl(){var S=this.$e?this.$e.networkState:null;if(1===S||3===S)ma.ULS.sendTraceTag(558158790,md.Qm,15,"Not sending request because we dont have network.");else if(S=this.Dtc()){var Ba=new Sys.Net.WebRequest;Ba.set_httpVerb("POST");Ba.set_url(md.serviceUrl);var ib={};ib.body=Kk.b(Md.a.construct(S));ib.headers=this.cYl();ib.method=Ba.get_httpVerb();
try{"function"===typeof window.fetch?window.fetch(Ba.getResolvedUrl(),ib).then(Sb=>{ma.ULS.sendTraceTag(561551382,md.Qm,50,"Request succeeded at the HTTP level {0}",Sb.statusText);this.K3g=Sb.status;return Sb.json()},Sb=>{ma.ULS.sendTraceTag(561551383,md.Qm,15,"Request failed at the HTTP level {0}",Sb);return null}).then(Sb=>{Sb=JSON.stringify(Sb);this.FVk(Sb,this.K3g);return Sb},()=>{ma.ULS.sendTraceTag(561551385,md.Qm,15,"Request succeeded with null response data");return""}):ma.ULS.sendTraceTag(561002076,
md.Qm,15,"Browser does not support Fetch.")}catch(Sb){ma.ULS.sendTraceTag(561551386,md.Qm,15,String.format("Exception when attempting to get last revision save id : {0}",Sb))}}else ma.ULS.sendTraceTag(540079457,md.Qm,15,"Target node is null, not sending last saved revision request.")}FVk(S,Ba){let ib=$g.a.nil,Sb=!1,yc=-1;Ba===Fh.a.Jy&&((S=this.Rua(S))?(ib=qf.b(S.LastSavedRevisionId),S.StatusCode||(Sb=!0,yc=S.StatusCode)):ma.ULS.sendTraceTag(561002077,md.Qm,50,"Response is null when attempting to get last revision save id"));
this.ra.raiseEvent(md.Glf,new ub(ib,Sb,Ba,yc))}static xNi(S,Ba){for(const ib in Ba)S[ib]=Ba[ib]}mMm(){return wh.SessionStatusManager.instance.Ao}}md.Zdj=0;md.serviceUrl=cb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";md.iWm="kickout";md.Q1i="PS";md.Glf="FLSR";md.Qm=343;md.Scn=5;md.SIo=5E4;Object(f.a)(md,"DocxSaveMonitor",null,[1042,120]);class Ee{hfb(S,Ba){return window.setInterval(S,Ba)}We(S){window.clearInterval(S)}}Ee.instance=new Ee;Object(f.a)(Ee,"DocxSaveMonitorTaskManager",
null,[869]);class ef{constructor(S){this.MN=0;this.cta=S}start(S){this.cta&&(this.MN=S,this.cta.reset())}log(){if(this.cta){var S={};S.RequstId=this.MN;S.InvokeCount=this.cta.bTc;S.InvokeFailedCount=this.cta.cTc;S.NoOpenConnectionCount=this.cta.EZc;S.SynchronousNotificationCount=this.cta.F9c;S.ResponseNotAvailable=this.cta.c5c;ma.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",S)}}}Object(f.a)(ef,"RequestLifeCycleTelemetryManager",null,[868]);class Wf{constructor(){this.W=
this.zQe=null;this.Wcl=()=>{var S=l.AFrameworkApplication.K;if(!S.$("DocxSaveMonitorEnabled"))return null;var Ba=S.$("DocxSaveMonitorKickoutEnabled");const ib=S.mc("DocxSaveMonitorIntervalMs",6E4),Sb=S.mc("DocxSaveMonitorFailureIntervalMs",5E3),yc=S.mc("DocxSaveMonitorWarningTimeMs",12E4),ed=S.mc("DocxSaveMonitorKickoutTimeMs",36E4),Ud=S.mc("DocxSaveMonitorQueueTimeoutMs",6E4),Xe=S.mc("DocxSaveMonitorSentTimeoutMs",12E4),Ue=S.mc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Kf=S.$("DocxSaveMonitorTelemetryInfoEnabled");
const Bg=S.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Vh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Jh=S.$("DocxSaveMonitorRawWebRequestsEnabled")||Vh;Vh=S.$("ComponentStateLoggingPackageIsEnabled");S=S.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var ij=l.AFrameworkApplication.Ne,gk=Jh?new Ho.a(l.AFrameworkApplication.userSessionId,ij.SY,ij.kPh):
null;gk=new Iq(ij,gk,Jh);Kf=Kf&&ij&&!Jh?new ef(ij.wda):null;Jh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;ij=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Yh=Tc.create(Jh,ij);Yh.EDc(1);Yh.EDc(2);Vh=Vh?this.W.Sa("Common.IComponentStateLogManager"):null;Ba=new md(ib,Sb,yc,Ba,ed,Ud,Xe,
Ue,Ee.instance,gk,va.a.instance.Ue("Box4.IKickoutExecutor"),Ik.a.instance,this.G8b,()=>!l.AFrameworkApplication.V4d||uj.a.instance.jTc,()=>cb.App.lostSession,Object(a.a)(kq.a.instance,kq.a.instance.KCa,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Lk,()=>new Date,()=>new Date,Kf,Bg,Yh,this.GKl,Vh,S,va.a.instance.Na("Common.ISessionStatus")||wh.SessionStatusManager.instance,{isEnabled:Jh,maxRetries:ij});Ba.start();ma.ULS.sendTraceTag(5884131,md.Qm,50,"SaveMonitor initialized");return Ba};
this.G8b=()=>{const S=cb.App.xa.hb.rc;return S?S.Yc:null};this.GKl=()=>{const S={};l.AFrameworkApplication.pc&&(S.TM=l.AFrameworkApplication.pc.sA());no.WoncaApp.BF&&(S.RS=no.WoncaApp.BF.sA());nh.App.e1&&(S.CRS=nh.App.e1.sA());cb.App.xa&&cb.App.xa.hb&&cb.App.xa.hb.Uc&&cb.App.xa.hb.Uc.contentReplicator&&(S.GSR=cb.App.xa.hb.Uc.contentReplicator.sA());l.AFrameworkApplication.Joa&&(S.S=1);cb.App.lostSession&&(S.LS=1);cb.App.qd&&cb.App.qd.ZB.Ao&&(S.KO=1);S.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(S)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(cb.App.hs||
cb.App.vm)this.zQe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.zQe&&this.zQe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}xc(S){this.W=S;(cb.App.hs||cb.App.vm)&&S.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.Wcl).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){L.a.instance.Fc(new Wf)}}Object(f.a)(Wf,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Ag=c(851);class Dh{constructor(S,Ba){this.nn=S;this.jao=Object(Ag.c)(Ba)}async loadChunk(S){return this.nn.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk(S):(await this.jao).Pz.loadScript(S)}}Object(f.a)(Dh,"WordOnlineChunksLoader",null,[]);class gh{constructor(){this.name="WordEditor.EditorAi.Entry"}xc(S){S.ha("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new Dh(l.AFrameworkApplication.K,S.Sa("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){L.a.instance.Fc(new gh)}}Object(f.a)(gh,"EditorAiEntryPackage",null,[1,2]);var gl=c(981);class Al{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.eJd=S;this.Noi=Ba;
this.Hum=ib;this.$Wf=Sb;this.WJc=yc;this.oc=ed;this.wH=Ud;this.gtn=(Xe,Ue,Kf)=>{switch(Kf){case 1:if(!Object(Ag.d)(Ue)||!this.xJ)return 8;this.WJc.Guj();break;case 2:this.WJc.D5e?this.$qj():this.Qob()}return 32};this.npn=(Xe,Ue,Kf)=>{2===Kf&&this.$Wf.xul().catch(Bg=>{ma.ULS.eD(508965832,3041,10,Bg,"Failed to initialize Copilot integration package")});return 32};this.KXi=(Xe,Ue)=>{Ue.KY&&(Object(uc.a)("AiMakerInitializationTriggered"),this.eJd.Vca(this.KXi),this.eJd.Md(),this.WJc.Guj(),this.wH.xk(19,
()=>{this.WJc.D5e&&this.$qj()}))};this.nun=async(Xe,Ue)=>{Ue.KY&&this.Hum.execute(Kf=>{Kf.findImageAndRegisterHandler()})};this.xJ=nh.App.Woe.xJ}initialize(){this.eJd.b3(this.KXi);this.eJd.initialize();this.Noi.b3(this.nun);this.Noi.initialize();this.oc.fb(Cf.a.MFd,Ji.a.view,this.gtn,4);this.oc.fb(Cf.a.VFi,Ji.a.application,this.npn,1028)}$qj(){this.WJc.show().catch(S=>{ma.ULS.eD(508965831,3041,10,S,"Failed to show document wizard")})}Qob(){(new gl.a).r8d(0)}}Object(f.a)(Al,"AiMakerInitializer",null,
[]);var Pm=c(1732),ck=c(935);class Zf extends ck.a{constructor(S){var Ba;super("BooleanFeatureGateConditionId");this.In=S.In;this.n0a=S.n0a;this.defaultValue=null!==(Ba=S.defaultValue)&&void 0!==Ba?Ba:!1}initialize(){super.initialize();const S=l.AFrameworkApplication.K;S.Po(()=>{const Ba=S.getBooleanFeatureGate(this.n0a,this.defaultValue);this.Sg(Ba)})}Sg(S){super.Sg(S);ma.ULS.sendTraceTag(512369937,3028,50,this.wT(this.In,S,`featureGate=${this.n0a}`))}}Object(f.a)(Zf,"BooleanFeatureGateCondition",
ck.a,[]);var qk=c(696);class vn extends ck.a{constructor(S){super(S.MGh);this.X6f=S}initialize(){super.initialize();l.AFrameworkApplication.K.Po(()=>{var S,Ba,ib,Sb,yc;const ed=null!==(Ba=null===(S=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===S?void 0:S.WACDatacenter)&&void 0!==Ba?Ba:"unknown";S=null!==(Sb=null===(ib=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===ib?void 0:ib.Ring)&&void 0!==Sb?Sb:"unknown";ib=null===(yc=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===yc?void 0:yc.Host;yc=this.sBf(ed,S,ib);this.Sg(yc);ma.ULS.sendTraceTag(509747520,3028,50,this.wT(this.X6f.In,yc,`datacenter=${ed}`))})}sBf(S,Ba,ib){if("1"===Ba||"unknown"===S||this.X6f.fXh.includes(ib))return!0;const Sb=S.toUpperCase();return!this.X6f.MRh.some(yc=>Sb.includes(yc))}}Object(f.a)(vn,"EditorAiDatacenterCondition",ck.a,[]);class zh extends ck.a{constructor(S,Ba,ib){super("AiMakerConsentGroupConditionId");this.In=S;this.nfa=Ba;this.defaultValue=ib}initialize(){super.initialize();
this.nfa.execute(S=>{var Ba;S.isFeatureEnabled("AiMaker",null!==(Ba=this.defaultValue)&&void 0!==Ba?Ba:!1).then(ib=>{this.Sg(ib);return null})})}Sg(S){super.Sg(S);ma.ULS.sendTraceTag(509752010,3028,50,this.wT(this.In,S))}}Object(f.a)(zh,"AiMakerConsentGroupCondition",ck.a,[]);class Qm extends ck.a{constructor(S){super("RegionComposerEnabledConditionId");this.In=S.In}initialize(){super.initialize();this.Sg(nh.App.Woe.xJ)}Sg(S){super.Sg(S);ma.ULS.sendTraceTag(508965830,3028,50,this.wT(this.In,S))}}
Object(f.a)(Qm,"RegionComposerEnabledCondition",ck.a,[]);const Hl="CH DE FR EU UK NO SE NL PIE".split(" ");class en extends qk.a{constructor(S,Ba,ib){const Sb=new Zf({In:16,n0a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});S=new Pm.a(16,S,Ba,{zNb:!0,VO:!1,W9b:!1,V9b:!1,UO:!1});Ba=new vn({MGh:"AiMakerDocumentWizardDatacenterConditionId",In:16,MRh:Hl,fXh:["Exchange Online Consumer","OneDriveWOPI"]});ib=new zh(16,ib);const yc=new Qm({In:16});super(16,new lb.a([Sb,S,Ba,ib,yc]),null,3028,"AiMakerDocumentWizardTriggered")}}
Object(f.a)(en,"AiMakerDocumentWizardTriggerModel",qk.a,[]);var mi=c(934);class um extends ck.a{constructor(S){super("AiImageInsertedConditionId");this.R5e=S;this.isInitialized=!1;this.kSi=()=>{this.Sg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.R5e.execute(S=>{var Ba;null===(Ba=S.add_onImageWasInsertedHandler)||void 0===Ba?void 0:Ba.call(S,this.kSi)}))}Md(){this.isInitialized&&(this.R5e.execute(S=>{var Ba;null===(Ba=S.remove_onImageWasInsertedHandler)||void 0===
Ba?void 0:Ba.call(S,this.kSi)}),this.isInitialized=!1,super.Md())}}Object(f.a)(um,"AiImageInsertedCondition",ck.a,[]);class fn extends qk.a{constructor(S){const Ba=new Zf({In:19,n0a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),ib=new um(S);super(19,new lb.a([Ba,ib]),null,3028,"OnTriggerAiImageRemakeEventKey");this.R5e=S;this.dqi=!1;this.tsk()}I1a(S){super.I1a(S);super.Wzd()&&super.fib("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==S||this.dqi||(this.lZn(),this.dqi=!0)}tsk(){l.AFrameworkApplication.va.fb(Cf.a.NFd,
Ji.a.view,()=>8,1028)}lZn(){l.AFrameworkApplication.va.Qv(Cf.a.NFd,Ji.a.view,()=>8)}}Object(f.a)(fn,"AiImageRemakeTriggerModel",qk.a,[]);class im{constructor(S){this.Bon=async()=>{const Ba=await this.dGi.value;await this.lSc(Ba);return Ba};this.xxn=L.a.instance;this.dGi=new jb.a(S);this.Dym=new jb.a(this.Bon)}async E3(){await this.dGi.value}async hgb(){return await this.Dym.value}async lSc(S){L.a.instance.Fc(S);return new Promise(Ba=>{this.xxn.registerOnPackageInit(S.name,Ba)})}}Object(f.a)(im,"LazyLoadedPackage",
null,[]);class Vp{constructor(){this.fTh=new im(()=>Promise.all([c.e(2),c.e(5),c.e(11)]).then(c.bind(null,2059)).then(S=>S.instance));this.L6k=new im(()=>Promise.all([c.e(2),c.e(5),c.e(29)]).then(c.bind(null,2068)).then(S=>S.instance))}async zul(){await this.fTh.hgb()}async xul(){await this.fTh.hgb();await this.L6k.hgb()}}Object(f.a)(Vp,"AiMakerPackageManager",null,[]);var vm=c(290),Il={get sql(){var S=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;
if(!S)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return S}};class Fi{constructor(S){this.container=S}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(f.a)(Fi,"AiMakerDocumentWizardDependenciesImpl",null,[]);class oo{constructor(S,Ba,ib,Sb,yc){this.jpg=S;this.$Wf=Ba;this.zk=ib;this.rc=Sb;this.D2o=yc;this.fyi=!1;this.Con=async()=>{this.fyi=!0;await Promise.all([this.$Wf.zul(),this.jpg.loadChunk("aiMakerDocumentWizardUx")]);return Il.sql};this.sIj=new jb.a(this.Con)}get D5e(){return this.zk.Xla(this.rc.Yc,{VO:!1,Tba:!1,doa:!1,UO:!1})}Guj(){this.fyi||this.sIj.value.catch(S=>{ma.ULS.eD(508965829,3041,10,S,"Failed to load document wizard UX interop")})}async show(){const S=
await this.sIj.value;this.D5e?(this.bsh||(this.bsh=this.Gdn(S)),this.bsh.open()):ma.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}Gdn(S){const Ba=this.mountApp(S);return Ba?Ba:new Rm(this.D2o,()=>this.mountApp(S))}mountApp(S){const Ba=Object(vm.a)("EditorContainer");return S.mountApp(Ba,new Fi(va.a.instance))}}Object(f.a)(oo,"AiMakerDocumentWizardUx",null,[]);class Rm{constructor(S,Ba){this.controller=S;this.Rpn=Ba;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(S){this.controller.isOpen=
S}open(){this.isOpen||(this.isOpen=!0,this.Rpn())}close(){this.isOpen=!1}}Object(f.a)(Rm,"AiMakerDocumentWizardCompatAppRef",null,[]);class lq{constructor(){this.isOpen=!1}}Object(f.a)(lq,"AiMakerDocumentWizardControllerImpl",null,[]);class po extends mi.a{get name(){return"WordEditor.AiMaker.Entry"}U7(S){this.container=S;S.ha("WordEditor.AiMaker.AiMakerPackageManager",()=>new Vp).singleInstance();S.ha("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new lq).singleInstance();
S.ha("WordEditor.AiMaker.AiMakerDocumentWizardUx",()=>new oo(S.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),S.resolve("WordEditor.AiMaker.AiMakerPackageManager"),S.resolve("Box4.IParagraphReader"),cb.App.xa.hb.rc,S.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).singleInstance()}W7(){(new Al(new en(this.container.resolve("Box4.IParagraphReader"),cb.App.xa.hb.rc,this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new fn(this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")),
this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),l.AFrameworkApplication.va,Ib.a.get_instance())).initialize()}V7(){}static main(){L.a.instance.Fc(new po)}}Object(f.a)(po,"AiMakerEntryPackage",mi.a,[]);var pl={get interop(){var S=aiInserterUx.interop;if(!S)throw Error("aiInserterUx chunk is accessed before loading");return S}};class ht{constructor(S,
Ba){this.U8d=S;this.T5c=Ba;this.wGa=async(ib,Sb)=>{Sb.KY&&(Object(uc.a)("AiInserterInitializationTriggered"),this.U8d.Vca(this.wGa),this.U8d.Md(),[,ib]=await Promise.all([this.T_m(),Promise.all([c.e(2),c.e(5),c.e(17)]).then(c.bind(null,2060))]),ib.main(pl.interop))}}initialize(){this.U8d.b3(this.wGa);this.U8d.initialize()}async T_m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(Ag.c)(this.T5c)).Pz.loadScript("aiInserterUx")}}
Object(f.a)(ht,"AiInserterInitializer",null,[]);class rr extends ck.a{constructor(S,Ba){super("AiInserterConsentGroupConditionId");this.nfa=S;this.defaultValue=Ba}initialize(){super.initialize();this.nfa.execute(S=>{S.isFeatureEnabled("AiInserter",!!this.defaultValue).then(Ba=>{this.Sg(Ba);return null})})}Sg(S){super.Sg(S)}}Object(f.a)(rr,"AiInserterConsentGroupCondition",ck.a,[]);const Hr="CH DE FR EU UK NO SE NL PIE".split(" ");class cr extends ck.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
l.AFrameworkApplication.K.Po(()=>{var S,Ba,ib,Sb;const yc=null!==(Ba=null===(S=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===S?void 0:S.WACDatacenter)&&void 0!==Ba?Ba:"unknown";S=null!==(Sb=null===(ib=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===ib?void 0:ib.Ring)&&void 0!==Sb?Sb:"unknown";ib=this.sBf(yc,S);this.Sg(ib)})}sBf(S,Ba){if("1"===Ba||"unknown"===S)return!0;const ib=S.toUpperCase();return!Hr.some(Sb=>ib.includes(Sb))}}Object(f.a)(cr,"AiInserterDatacenterCondition",
ck.a,[]);class Wp extends qk.a{constructor(S){const Ba=new Zf({In:17,n0a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"});S=new rr(S);const ib=new cr;super(17,new lb.a([Ba,S,ib]),null,3028,"AiInserterAppTriggered")}}Object(f.a)(Wp,"AiInserterTriggerModel",qk.a,[]);class Xr extends mi.a{get name(){return"WordEditor.AiInserter.Entry"}U7(S){this.container=S}W7(){(new ht(new Wp(this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}V7(){}static main(){L.a.instance.Fc(new Xr)}}
Object(f.a)(Xr,"AiInserterEntryPackage",mi.a,[]);const Sm="CH DE FR EU UK NO SE NL PIE".split(" ");class $i extends qk.a{constructor(){const S=new Zf({In:18,n0a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),Ba=new vn({MGh:"AiRewriteDatacenterConditionId",In:18,MRh:Sm,fXh:["Exchange Online Consumer","OneDriveWOPI"]});super(18,new lb.a([S,Ba]),null,3028,"AiRewriteTriggered")}}Object(f.a)($i,"AiRewriteTriggerModel",qk.a,[]);var Eh={get interop(){var S=null===aiRewriteUx||void 0===aiRewriteUx?void 0:
aiRewriteUx.interop;if(!S)throw Error("aiRewriteUx chunk is accessed before loading");return S}};class kh{constructor(S,Ba){this.Uzd=S;this.T5c=Ba;this.wGa=async(ib,Sb)=>{Sb.KY&&(Object(uc.a)("AiRewriteInitializationTriggered"),this.Uzd.Vca(this.wGa),this.Uzd.Md(),[,ib]=await Promise.all([this.NZm(),Promise.all([c.e(2),c.e(5),c.e(12)]).then(c.bind(null,2063))]),ib.main(Eh.interop))}}initialize(){this.Uzd.b3(this.wGa);this.Uzd.initialize()}async NZm(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("aiRewriteUx"):(await Object(Ag.c)(this.T5c)).Pz.loadScript("aiRewriteUx")}}Object(f.a)(kh,"AiRewriteInitializer",null,[]);class ql extends mi.a{get name(){return"WordEditor.AiRewrite.Entry"}U7(S){this.container=S}W7(){(new kh(new $i,this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}V7(){}static main(){L.a.instance.Fc(new ql)}}Object(f.a)(ql,"AiRewriteEntryPackage",mi.a,[]);var ho;(function(S){S[S.version0=0]="version0";S[S.version1=1]="version1"})(ho||
(ho={}));Object(f.b)("FirstRunExperienceVersion",ho);class Jl{get D0e(){return"Word"}get fAh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return ho.version0}get currentVersion(){return ho.version1}get SHm(){return Jl.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Ibc(){return Jl.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get eCi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get LEl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get ZNi(){return 24}get Iej(){return 4E3}get x5c(){return""}static isEnabled(){const S=
l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==S&&"Automation"!==S}}Object(f.a)(Jl,"FirstRunExperienceLauncherSettings",null,[903]);class wp{constructor(S){this.bVg=S}avo(S){this.bVg&&this.bVg.bvo(S)}}Object(f.a)(wp,"FirstRunExperienceManager",null,[902]);class Qo{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}xc(S){this.W=S;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new wp(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const S=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");S&&S.avo(new Jl)}dispose(){}}Object(f.a)(Qo,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class gn{constructor(S,Ba){this.EHa=(ib,Sb,yc,ed,Ud)=>{var Xe,Ue;if(1===yc)return Ud=null===(Ue=null===(Xe=Sb.view.lb)||void 0===Xe?void 0:Xe.gb)||void 0===Ue?void 0:Ue.kb,(null===Ud||void 0===Ud?
0:Ud.NH)||ib===Cf.a.h8c&&(null===Ud||void 0===Ud?0:Ud.J2a)?32:8;if(2===yc){Xe=this.iab.gj.isVisible;this.iab.WB(!0,1===Ud);Ue=0;switch(ib){case Cf.a.nrj:Ud=1;break;case Cf.a.orj:Ud=2;break;case Cf.a.mie:Ud=2;Ue=1;break;case Cf.a.nie:Ud=1;Ue=2;break;case Cf.a.h8c:Ud=1;Ue=3;break;case Cf.a.Ele:Ud=this.iab.f4b;break;default:Ue=Ud=0}Xe&&ib===Cf.a.EHa||this.iab.Jho(Ud,Ue);return 32}return 8};this.XUd=(ib,Sb,yc,ed,Ud)=>{this.toggleButton(Ud,!1);return this.CZk(yc)};this.Ele=(ib,Sb,yc,ed,Ud)=>this.iab.gj.isVisible?
this.XUd(ib,Sb,yc,ed,Ud):this.EHa(ib,Sb,yc,ed,Ud);this.ga=S;this.iab=Ba}dispose(){this.iab&&this.iab.dispose()}Tb(){this.ga.qa(Cf.a.Ele,Ji.a.view,this.Ele);this.ga.fb(Cf.a.EHa,Ji.a.view,this.EHa,4);this.ga.qa(Cf.a.XUd,Ji.a.view,this.XUd);this.ga.fb(Cf.a.mie,Ji.a.view,this.EHa,4);this.ga.qa(Cf.a.nie,Ji.a.view,this.EHa);this.ga.qa(Cf.a.h8c,Ji.a.view,this.EHa)}CZk(S){if(1===S)return 32;this.iab.WB(!1);return 32}toggleButton(S,Ba){S&&(S[bk.a.On]=Ba)}}Object(f.a)(gn,"FormatPictureActor",null,[10]);class Bl{constructor(S){this.Yxb=
!1;this.gj=S}get f4b(){return this.gj.Cfl}Jho(S,Ba){switch(S){case 0:case 1:this.gj.$vo(Ba);break;case 2:this.gj.lwo(Ba)}}WB(S,Ba=!1){this.Yxb||this.Szf();S?this.gj.qP(Ba):this.gj.Wna()}dispose(){this.gj.dispose()}Szf(){this.Yxb||(this.gj.initialize(),this.Yxb=!0)}}Object(f.a)(Bl,"FormatPictureManager",null,[867,10]);var On=c(354),Cl=c(145),yi=c(271);class lj{}lj.vP=yi.a.$Md;lj.nfc=1;lj.ofc=WordEditorIntl.WordEditorStrings.L_FormatPicture;lj.Mua="FormatPictureTaskPaneData";Object(f.a)(lj,"FormatPicturePaneConstants",
null,[]);class mq{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(mq,"FormatPictureTaskPaneProps",null,[]);class ng{constructor(S,Ba,ib,Sb){this.NQe=0;this.xrc=this.Ala=null;this.gtd=this.Ysd=this.Pnd=this.Fed=
this.zwd=0;this.Is=this.ZTb=!1;this.Kwe=0;this.Zsn=()=>{this.Bkj()};this.xm=()=>{let yc=!1;yc=this.EKn()||yc;yc=this.l5a()||yc;yc=this.k5a()||yc;yc=this.ogc()||yc;(yc=this.AKn()||yc)&&this.Cm()};this.R2=S;this.R9j=Ba;this.oIe=ib;this.ig=Sb}initialize(){this.d_();this.aja()}get isVisible(){return this.Is}qP(S){this.p8c(S)}Wna(){this.eda();this.Srm()}$vo(S){this.Omj(S,1)}lwo(S){this.Omj(S,2)}Omj(S,Ba){this.Kwe=Ba;this.NQe=S}get Cfl(){return this.Kwe}dispose(){}d_(){this.R2.INa();this.NQe=this.Kwe=0}get focusManager(){return this.R9j.value}get oc(){return this.oIe.value}p3a(){return!!this.focusManager.currentScope&&
this.focusManager.currentScope.name===lj.vP}Bkj(){this.focusManager.mg(lj.vP)}aja(){const S=this.focusManager.fe(lj.vP);S.parent=Bd.AFrame.vp;S.ffa(this.Zsn)}eda(){this.p3a()&&this.focusManager.mg(this.focusManager.yT)}p8c(S){xh.UISurfaces.Bu().then(Ba=>{Ba.showTaskPane(lj.vP,this.jA(S));this.isVisible&&S&&this.focusManager.mg(lj.vP);return null})}Cm(){xh.UISurfaces.Bu().then(S=>{S.updateTaskPane(lj.vP,this.jA(!1));return null})}Srm(){xh.UISurfaces.Bu().then(S=>{S.hideTaskPane(lj.vP,2);return null})}jA(){const S=
new mq;this.Loo(S);return Object.assign(new xj.a,{title:lj.ofc,hideHeader:!1,width:320,location:2,contentProps:S,onOpen:Ba=>{this.Is=!0;cb.App.xa.XYa(this.xm);cb.App.xa.updateCommandUI();this.Bkj();this.ig.$_b(lj.vP,Ba)},onClose:()=>{this.eda();this.Is=!1;cb.App.xa.ahc(this.xm);cb.App.xa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}Loo(S){const Ba=G.e().numberFormatInfo;S.section=this.NQe;S.numberFormatInfo="object"===typeof Ba?Ba:null;S.title=this.Ala;
S.description=this.xrc;S.topCrop=this.zwd;S.bottomCrop=this.Fed;S.leftCrop=this.Pnd;S.rightCrop=this.Ysd;S.rotationAngle=this.gtd;S.onTitleChange=this.onTitleChange();S.onDescriptionChange=this.onDescriptionChange();S.onCropSpinButtonChange=this.onCropSpinButtonChange();S.onRotationSpinButtonChange=this.onRotationSpinButtonChange();S.disabled=this.ZTb}onTitleChange(){return S=>{if(S!==this.Ala){this.Ala=S;var Ba=new On.DictionaryPropertySet;Ba.setValue(Cl.a.Eib,S);this.oc.Qb(Lg.a.Q6c,2,Ba);this.Cm()}}}onDescriptionChange(){return S=>
{if(S!==this.xrc){var Ba=new On.DictionaryPropertySet;Ba.setValue(Cl.a.UX,S);this.xrc=S;this.oc.Qb(Lg.a.ZNb,2,Ba);this.Cm()}}}onCropSpinButtonChange(){return(S,Ba)=>{const ib=new On.DictionaryPropertySet;switch(Ba){case 0:this.zwd=S;ib.setValue(Cl.a.Jib,S);this.oc.Qb(Cf.a.IRc,2,ib);break;case 1:this.Fed=S;ib.setValue(Cl.a.Gib,S);this.oc.Qb(Cf.a.BRc,2,ib);break;case 2:this.Pnd=S;ib.setValue(Cl.a.Hib,S);this.oc.Qb(Cf.a.CRc,2,ib);break;case 3:this.Ysd=S,ib.setValue(Cl.a.Iib,S),this.oc.Qb(Cf.a.DRc,2,
ib)}this.Cm()}}onRotationSpinButtonChange(){return S=>{this.gtd=S;const Ba=new On.DictionaryPropertySet;Ba.setValue(Cl.a.PRc,0);Ba.setValue(Cl.a.qJ,S);this.oc.Qb(Lg.a.imageRotate,2,Ba);this.Cm()}}EKn(){const S=2===this.oc.Qb(Lg.a.Q6c,1,null),Ba=S!==this.ZTb;this.ZTb=S;return Ba}l5a(){var S=new On.DictionaryPropertySet;this.oc.Qb(Lg.a.l5a,2,S);S=S.ia(Cl.a.Eib,"");const Ba=S!==this.Ala;this.Ala=S;return Ba}k5a(){var S=new On.DictionaryPropertySet;this.oc.Qb(Lg.a.k5a,2,S);S=S.ia(Cl.a.UX,"");const Ba=
S!==this.xrc;this.xrc=S;return Ba}ogc(){var S=new On.DictionaryPropertySet;this.oc.Qb(Cf.a.x2c,2,S);const Ba=S.ia(Cl.a.Jib,0),ib=S.ia(Cl.a.Gib,0),Sb=S.ia(Cl.a.Hib,0);S=S.ia(Cl.a.Iib,0);const yc=Ba!==this.zwd||ib!==this.Fed||Sb!==this.Pnd||S!==this.Ysd;this.zwd=Ba;this.Fed=ib;this.Pnd=Sb;this.Ysd=S;return yc}AKn(){var S=new On.DictionaryPropertySet;this.oc.Qb(Lg.a.dMb,2,S);S=S.ia(Cl.a.qJ,0);const Ba=S!==this.gtd;this.gtd=S;return Ba}}Object(f.a)(ng,"ReactFormatPicturePane",null,[866,10]);class qo{constructor(){this.jjd=
this.W=null}get name(){return"WordEditor.FormatPicture"}xc(S){this.W=S;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new Bl(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new ng(Wh.a.instance,new jb.a(()=>di.FocusManager.instance()),new jb.a(()=>l.AFrameworkApplication.va),Hq.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new gn(l.AFrameworkApplication.va,
this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).singleInstance()}init(){if(nh.App.bpg||nh.App.HKj)this.jjd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.jjd.Tb(),cb.App.xa.updateCommandUI()}dispose(){this.jjd&&this.jjd.dispose()}static main(){L.a.instance.Fc(new qo)}}Object(f.a)(qo,"WordEditorFormatPicturePackage",null,[1,2]);var Ir=c(1476),hn=c(510);class Hm extends lo.a{constructor(){super();this.Prompt=0;this.FileId=null}al(){return 100}static construct(S,
Ba){const ib=new Hm;ib.FileId=S;ib.Prompt=Ba;return ib}}Object(f.a)(Hm,"GraphMergeConsentChangedRequest",lo.a,[]);var Ih=c(582);class dr extends Ih.a{constructor(){super();this.Location=this.FileId=null}al(){return 34}static construct(S,Ba){const ib=new dr;ib.FileId=S;ib.Location=Ba;return ib}}Object(f.a)(dr,"PlayGraphMergeReplayRequest",Ih.a,[]);class Io{constructor(S,Ba,ib,Sb,yc,ed=null,Ud=null){this.$l=!1;this.GN=null;this.xeh=this.VGe=!1;this.a9e=()=>{if(this.Kza.JUd)this.VGe=!0;else if(this.VGe=
!1,!this.Wdo){this.xeh=!0;var Xe=this.yJa.Txa;ma.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===Xe);if(100===Xe||400===Xe)Xe=Hm.construct(this.YP(),Xe),this.Rv(Xe)}};this.cli=(Xe,Ue)=>{Ue&&Ue.JMf&&Ue.JMf.laf&&!this.Kza.iCi&&(this.Kza.NDj(),this.Kza.JUd=!0,this.Rv(Ue.JMf.laf))};this.ali=(Xe,Ue)=>{Ue&&Ue.Pbd&&this.Kza.NDj()};this.bli=(Xe,Ue)=>{Ue&&(Ue.ShowMergePrompt&&this.yJa.Ccj(this.a9e),l.AFrameworkApplication.Kg&&(l.AFrameworkApplication.Kg.SessionMergeInfo|=Ue.PartMergeInfo))};
this.YP=S;this.Uxd=ib;this.Kza=Sb;this.yJa=yc;this.Uxd&&this.Uxd.axk(this.cli);this.w2=ed||Ik.a.instance;if(!Ud){const Xe=new hn.a;Ud=Ue=>Xe.wga(0,Ue)}this.PWj=Ud}get sUm(){return this.VGe}get Wdo(){return this.xeh}Rv(S){const Ba=new nl.a;Ba.Dq=S;Ba.status=1;Ba.HG="GraphMerge";const ib=this.PWj(()=>{this.b5c(Ba,33===S.al())});ib.HI(Ba);ib.DT()}b5c(S,Ba){this.$l||(Ba&&(this.Kza.JUd=!1),2===S.statusCode&&!Ka.a.uHb(S.Dj)&&1===S.Dj.length&&S.Dj[0]?(S=S.Dj[0],S.StatusCode?this.Kza.bbg():Ba&&this.yJa.Ccj(this.a9e),
this.w2.dUa(S),this.sUm&&this.a9e()):this.Kza.bbg())}E4a(S){this.GN=S;this.GN.u0b(this.ali);this.GN.v0b(this.bli)}dispose(){this.$l||(this.Uxd&&this.Uxd.m0n(this.cli),this.GN&&(this.GN.OMb(this.ali),this.GN.n4c(this.bli)),this.$l=!0)}}Object(f.a)(Io,"GraphMergeBackupManager",null,[907,10]);class hl{constructor(S,Ba=null,ib=null,Sb=null){this.qte=0;this.QFe=!1;this.U2g=new Date(0);this.JUd=!1;this.yJa=S;this.Oz=Ba||(()=>new Date);ib||(ib=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupDelayInMs",
12E4):12E4);this.Eak=ib;Sb||(Sb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxBackups",1):1);this.I5g=Sb}get bTm(){return+this.Oz()-+this.U2g<this.Eak}get iCi(){return 500===this.yJa.Txa?!1:100===this.yJa.Txa?!0:this.QFe||this.JUd||this.bTm}NDj(){this.U2g=this.Oz();this.qte++;this.qte>=this.I5g&&this.bbg()}bbg(){this.QFe||(this.QFe=!0,ma.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.qte,
this.I5g))}}Object(f.a)(hl,"GraphMergeBackupThrottler",null,[904]);class Og{constructor(S,Ba,ib=null){this.kXg=!1;this.EV=S;this.d2j=Ba;null==ib&&(ib=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.jOe=ib?500:300}get Txa(){return this.jOe}Ccj(S){if(!this.kXg&&300===this.Txa){var Ba=this.d2j.value;Ba&&Ba.isFeatureEnabled(51)&&(this.kXg=!0,this.EV.execute(ib=>{ib.lvo(()=>{this.p3k(S)},()=>{this.consentDenied(S)})}))}}consentDenied(S){300===this.Txa&&
(ma.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.jOe=100,S());this.W9i()}p3k(S){300===this.Txa&&(ma.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.jOe=400,S());this.W9i()}W9i(){this.EV.execute(S=>{S.Lrm()})}}Object(f.a)(Og,"GraphMergeCollectionConsentManager",null,[905]);class Vn extends Sys.EventArgs{constructor(S){super();this.JMf=S}}Object(f.a)(Vn,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Wn=c(822),
bm=c(871),Jr=c(1035),nq=c(615),ro=c(1762),Gp=c(1760),Dn=c(223),Hp=c(168);class oq{constructor(S,Ba,ib,Sb,yc,ed){this.I0f=this.sg=null;this.RVc=this.Fog=!1;this.Uk=null;this.X7c=S.runtime.X7c;this.iq=S;this.Zd=Ba;this.Ng=ib;this.vn=Sb;this.a3k=yc;this.graphNodeComplexMerge=ed}}Object(f.a)(oq,"GraphNodeComplexMergeState",null,[]);var sr=c(1548),Sk=c(1532);class En{constructor(S,Ba=null){this.Mg=S;this.ZWb=Ba||this.BOc()}get jlb(){return this.ZWb}get Zd(){return this.Mg}BOc(){return[Object(a.a)(this,
this.Hxo,"simpleMerge"),Object(a.a)(this,this.n2k,"complexMerge")]}Qoo(S,Ba,ib,Sb,yc,ed){Ba=new oq(S,ib,new jb.a(()=>new sr.a(Sb?Sb.wm:null,yc)),new jb.a(()=>new sr.a(Sb?Sb.wm:null,ed)),new jb.a(()=>new sr.a(ed,yc)),Ba.$Kh(yc,()=>S.runtime.Xb));Ba.sg=Sb.c_b;Ba.I0f=new Dn.a;return Ba}merge(S,Ba,ib,Sb,yc,ed){Ba=this.Qoo(S,Ba,ib,Sb,yc,ed);ib=!0;for(Sb=0;Sb<this.jlb.length&&ib;Sb++)(ib=(0,this.jlb[Sb])(Ba))||S.logger.y2d("GraphNodeMerge.GetMergeFunctions()",Sb);if(S=Ba.RVc&&Ba.Uk?new Sk.a(Ba.Uk,!1):null)switch(S.jno(Ba.sg),
(S?S.wm:yc).Qc){case 1074135145:Ba.iq.runtime.ece.z4k.Z(S.wm.id,S.wm);break;case 1074135153:Ba.iq.runtime.ece.zKk.Z(S.wm.id,S.wm);break;case 1074135127:Ba.iq.runtime.ece.h1k.Z(S.wm.id,S.wm);break;case 393230:Ba.iq.runtime.X3d.add(S.wm.id)}return{returnValue:Ba.RVc,Uk:S}}Hxo(S){if(S.iq.runtime.Xb&&S.iq.runtime.Xb.$hb(1000005)&&0<S.sg.count)return!0;var Ba=S.graphNodeComplexMerge.tae;return S.vn.value.KTc(Ba)&&S.a3k.value.KTc(Ba)?S.Ng.value.KTc(Ba)?!0:(Ba=S.vn.value.yf,S.RVc=!0,S.Uk=Ba.IK(),!1):(S.RVc=
!0,!1)}n2k(S){const Ba=S.vn.value.yf;S.X7c&&Hp.a.instance.Ta(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",Ba.id,Ba.Qc);const ib=S.graphNodeComplexMerge.Hkg(S);S.RVc=ib;Hp.a.instance.Ta(4018184,1,ib?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",ib?"Succeeded":"Failed",Ba.id,Ba.Qc,!!S.Uk);return ib}}Object(f.a)(En,"GraphNodeMerge",null,[968]);class rh extends lo.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=
this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Prompt=this.Reason=this.Source=0}al(){return 33}static construct(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg){const Vh=new rh;Vh.FileId=S;Vh.BaseRevisions=Ba;Vh.TheirRevisions=ib;Vh.YourRevisions=Sb;Vh.IgnoreConflictsInLastServerRevision=yc;Vh.MergeHint=ed;Vh.ObjectSpaceId=Ud?qf.a(Ud):null;Vh.RequestId=Xe?qf.a(Xe):null;Vh.Source=Ue;Vh.Reason=Kf;Vh.Prompt=Bg;return Vh}}Object(f.a)(rh,
"CreateGraphMergeReplayRequest",lo.a,[]);var Td=c(810),Pn=c(236),Zr=c(15),cm=c(1870),Ks=c(1961);class Xp{constructor(S,Ba=null,ib=null){this.tpl=(Sb,yc)=>{let ed=Sb;var Ud=yc,Xe=this.ibb.get(Sb);if(!Xe)return{dHa:ed,gNb:Ud};Ud=new Dn.a;Ud.add(Xe);var Ue=this.vvb.get(Sb)||this.EF.J(Sb);Xe=new Dn.a;Xe.add(Ue);Ue=new Dn.a;Ue.add(this.EF.J(Sb));ma.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.mH.Vvf,
this.mH.Oha,this.Kai(Xe),this.Kai(Ud));var Kf=this.bbi(this.mH.Oha);this.fEl(Kf,Sb,Ud);Xe=new cm.a(Kf,Ue,1===Kf.input.Oha?Xe:Ud,1===Kf.input.Oha?Ud:Xe,this.bbi(1),Xe,Ud);Ud=new Dn.a;for(Ue=0;Ue<yc.length;Ue++){this.mH.SG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Bg=({R5a:ed,Ypa:Kf}=Xe.Gad(Sb,yc.J(Ue))).returnValue;Ud.add(Kf);Bg?ma.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",
Sb,yc.J(Ue),ed,Kf):ma.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Sb)}return{dHa:ed,gNb:Ud}};this.mH=S;this.EF=S.sk;this.ibb=S.UHo;this.vvb=S.z6o;this.B$j=S.Y_m;this.Mg=Ba||new Jr.a;this.dek=ib||this.tpl}PJc(S){const Ba=new Dn.a;for(let ib=0;ib<S.length;ib++){const Sb=this.lpl(S.J(ib));Ba.add(Sb)}return Ba}OJc(S,Ba,ib){const Sb=S.lu===S.kz&&S.startCp===S.endCp;Ba&&({dHa:S.lu,Ypa:S.startCp}=
this.gUa(S.lu,S.startCp,S.lu),Sb&&(S.kz=S.lu,S.endCp=S.startCp));ib&&!Sb&&({dHa:S.kz,Ypa:S.endCp}=this.gUa(S.kz,S.endCp,S.kz));return S}lpl(S){if(S.lu===S.kz){var Ba=new Dn.a;Ba.add(S.startCp);Ba.add(S.endCp);({dHa:S,gNb:Ba}=this.Qmg(S.lu,Ba));return new Td.a(S,Ba.J(0),S,Ba.J(1))}Ba=new Dn.a;var ib=new Dn.a;let Sb;Ba.add(S.startCp);({dHa:Ba,gNb:Sb}=this.Qmg(S.lu,Ba));ib.add(S.endCp);({dHa:S,gNb:ib}=this.Qmg(S.kz,ib));return new Td.a(Ba,Sb.J(0),S,ib.J(0))}Qmg(S,Ba){let ib=S,Sb=Ba;if(!this.EF.J(S))return ma.ULS.sendTraceTag(4339675,
318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",S),{dHa:ib,gNb:Sb};if(this.ibb.get(S))({dHa:ib,gNb:Sb}=this.dek(S,Ba,ib,Sb));else if(this.mH.hzf&&!this.mH.hzf.J(this.mH.hzf.length-1).m4(S)){Sb=new Dn.a;for(let yc=0;yc<Ba.length;yc++){let ed;({dHa:ib,Ypa:ed}=this.gUa(S,Ba.J(yc),ib));Sb.add(ed)}}return{dHa:ib,gNb:Sb}}Kai(S){let Ba="";S.forEach(ib=>{Ba+=ib.n$c();Ba+=" ";return!0});return Ba}bbi(S){const Ba=va.a.instance.Na("Box4.IFeatureHelper"),
ib=new Ks.a;ib.input.source=this.mH.Vvf;ib.input.Oha=this.mH.Oha;ib.input.yLc=()=>Ba;ib.runtime.sk=this.EF;ib.runtime.VCa=this.mH.K1k;1===S?(ib.runtime.zu=this.vvb,ib.runtime.Iq=this.ibb,ib.runtime.pLd=this.mH.dEi,ib.runtime.Tme=this.mH.uEi):2===S&&(ib.runtime.zu=this.ibb,ib.runtime.Iq=this.vvb,ib.runtime.pLd=this.mH.uEi,ib.runtime.Tme=this.mH.dEi);ib.runtime.Xb=Ba;return ib}fEl(S,Ba,ib){if(S.runtime.zu.nb(Pn.a.xL)){var Sb=S.runtime.zu.J(Pn.a.xL);Sb=this.Mg.getPropertyObjectIds(Sb,zl.a.p1);if(1===
Sb.length&&(Sb=Sb.J(0),S.runtime.zu.nb(Sb)&&(Sb=S.runtime.zu.J(Sb),3===this.Mg.getPropertyInt32(Sb,zl.a.jqb)))){const yc=this.Mg.getPropertyString(Sb,zl.a.zja),ed=this.Mg.getPropertyString(Sb,zl.a.EQb);Ba.toString()===yc&&yc===ed&&(Ba=this.Mg.getPropertyObjectId(Sb,zl.a.Jad),S.runtime.zu.nb(Ba)&&ib.add(S.runtime.zu.J(Ba)))}}}v6l(S,Ba){let ib=0;for(let Sb=0;Sb<S.length;Sb++)if(Ba.equals(S.J(Sb)))return ib=Sb,{returnValue:!0,idx:ib};return{returnValue:!1,idx:ib}}gUa(S,Ba){const ib=this.B$j&&!!this.vvb.J(S)&&
!this.EF.J(S);let Sb=S,yc=Ba,ed=!1,Ud=!1;(ib?this.vvb:this.ibb).forEach((Xe,Ue)=>{this.mH.SG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.KEf(Ue.Qc)&&this.EF.J(Xe)){Ue=null;if(ib){Ue=this.WOc(Bg=>this.vvb.J(Bg)||this.EF.J(Bg),Xe);var Kf=this.sZd(Ue,S)}else Kf=this.WOc(Bg=>this.EF.J(Bg),Xe),Kf=this.sZd(Kf,S);if(Kf&&(Ud=!0,Ue||(Ue=this.WOc(Bg=>this.vvb.J(Bg)||this.EF.J(Bg),Xe)),Xe=this.WOc(Bg=>this.ibb.J(Bg)||this.EF.J(Bg),Xe),Kf=0,({idx:Kf}=this.v6l(Ue,S)).returnValue)){for(let Bg=
Kf+1;Bg<Ue.length;Bg++)if(this.sZd(Xe,Ue.J(Bg)))return yc=0,Sb=Ue.J(Bg),ed=!0,!1;for(--Kf;0<=Kf;Kf--)if(this.sZd(Xe,Ue.J(Kf)))return yc=Number.MAX_VALUE,Sb=Ue.J(Kf),ed=!0,!1}}return!0});ed||(ma.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",S,Ba,ib,Ud),5===this.mH.Vvf&&(ma.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",
Sb),({u_h:Ba}=this.nWl()).returnValue?(Sb=Ba,yc=0,ma.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Sb)):ma.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Sb)));return{dHa:Sb,Ypa:yc}}nWl(){let S=$g.a.nil,Ba=new Dn.a;this.ibb.forEach((ib,Sb)=>
{this.mH.SG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.KEf(Sb.Qc)?(Ba=this.WOc(yc=>this.ibb.J(yc)||this.EF.J(yc),ib),!1):!0});return 0<Ba.length?(S=Ba.J(0),{returnValue:!0,u_h:S}):{returnValue:!1,u_h:S}}KEf(S){return 393241===S||393250===S||393251===S||393252===S}WOc(S,Ba){var ib=S(Ba);Ba=new Dn.a;if(!this.KEf(ib.Qc))return Ba;ib=this.Mg.getPropertyObjectIds(ib,Zr.a.ef);for(let Sb=0;Sb<ib.length;Sb++){const yc=new Dn.a;this.ysf(S,ib.J(Sb),yc);Ba.RC(Ba.length,
yc)}return Ba}ysf(S,Ba,ib){var Sb=S(Ba);if(Sb)if(393230===Sb.Qc)ib.add(Ba);else if(393229===Sb.Qc)Ba=this.Mg.getPropertyObjectIds(Sb,Zr.a.KK).eg(0),this.ysf(S,Ba,ib);else if(393250===Sb.Qc||393251===Sb.Qc||393252===Sb.Qc)for(Ba=this.Mg.getPropertyObjectIds(Sb,Zr.a.ef),Sb=0;Sb<Ba.length;Sb++)this.ysf(S,Ba.J(Sb),ib)}sZd(S,Ba){for(let ib=0;ib<S.length;ib++)if(Ba.equals(S.J(ib)))return!0;return!1}}Object(f.a)(Xp,"GraphMergeSelectionRecordUpdater",null,[]);class er extends ro.a{constructor(S=null,Ba=null,
ib=null,Sb=null,yc=null,ed=null,Ud=null,Xe=null,Ue=null,Kf=null,Bg=null){var Vh;super();this.yMh=Jh=>{const ij=Jh.UW,gk=cb.App.xa.hb.Uc;return new Wn.a(Jh,ij,gk.od,gk.fileId,gk.tnb,gk.contextId,ij?ij.id:$g.a.nil,this.iee,!1,!0)};this.YP=S||(()=>l.AFrameworkApplication.rootQuerySignature);Ba||(Ba=Jh=>new bm.a(Jh));this.$ch=Ba;this.Mg=ib||new Jr.a;this.eOg=Ud||new Gp.ChildNodeListMerge(this.Zd);this.oYb=Xe;this.iee||(this.oYb=(Jh,ij,gk)=>new nq.a(Jh,ij,gk));this.ZWb=Sb||this.BOc();this.T$a=yc||new Nn.a;
this.SWg=ed||new En(this.Zd);this.P5g=(null===(Vh=l.AFrameworkApplication.K)||void 0===Vh?void 0:Vh.mc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.Kza=Ue;this.yJa=Kf;this.dTd=this.qll(Bg);this.qUg=()=>va.a.instance.Na("Box4.IFeatureHelper")}qll(S){S||(S=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupCasesBrowser",0):0);return S}cEa(){return(new Date).getTime()}Bvj(S,...Ba){return String.format.apply(null,[S].concat(Ba))}qIo(S){throw rc.a.invalidOperation(S);
}TOd(S){return String.format("Name: {0}, Message: {1}, Stack: {2}",S.name,S.message,S.stack)}SEn(S){if(this.Kza&&this.Kza.iCi||!this.ZDo(S))return null;this.O3m(S);let Ba;({PIk:Sb,THo:yc,y6o:Ba}=this.edl(S,this.yMh));const ib=ro.a.yXl(S);var Sb=rh.construct(this.YP(),Sb.Wya(),yc.Wya(),Ba.Wya(),S.input.hGb,S.input.Oha,S.input.nm,S.input.wJb,S.input.source,ib,this.yJa.Txa);var yc=S.output.KM;3===ib&&0<yc.length&&(Sb.MergedRevision=this.yMh(S.output.KM.last()));return Sb}PJc(S,Ba){return(new Xp(S)).PJc(Ba)}OJc(S,
Ba,ib,Sb){return(new Xp(S)).OJc(Ba,ib,Sb)}}Object(f.a)(er,"GraphMerger",ro.a,[]);class Im extends er{constructor(S,Ba=null,ib=null){super(S,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ba,ib);this.ra=new M.a}get Txa(){return this.yJa?this.yJa.Txa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(S){}axk(S){this.ra.addHandler(Im.Uvf,S)}m0n(S){this.ra.removeHandler(Im.Uvf,S)}Zcg(){return!1}xdc(S,Ba,ib,Sb,yc,ed,Ud){(S=super.xdc(S,Ba,ib,Sb,yc,ed,Ud))&&this.ra.raiseEvent(Im.Uvf,new Vn(S));
return S}}Im.Uvf="GMC";Object(f.a)(Im,"WordEditorGraphMerger",er,[899,900,901]);class Ip{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}xc(S){this.W=S;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Og(this.W.Sa("WordEditor.IBusinessBarController"),new jb.a(()=>S.Na("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new hl(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();
this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Im(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Io(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){cb.App.VR||(cb.App.VR=Ir.a.M7());const S=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");cb.App.VR.HJk(S);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let S=this.W.Na("Box4.IGraphMergeBackupManager");S&&S.dispose()}}Object(f.a)(Ip,"GraphMergePackage",null,[1,2]);var pq=c(282);class Pl{constructor(S){this.yve=
"FontPicker";this.tFe=null;this.W8a=S;this.yid=this.W8a.eya(pq.a.JIb,Object(a.a)(this,this.VCb,"featureStateChangeCallback"));this.W8a.isFeatureEnabled(pq.a.JIb,!1).then(Ba=>{this.tFe=Ba})}get isLicensed(){return this.tFe}VCb(S){this.tFe=S.isEnabled;S=appChrome.actions.updateFontPickerLicenseState(this.yve,S.isEnabled);appChrome.api.dispatch(S)}dispose(){this.W8a.Vgc(pq.a.JIb,this.yid)}}Object(f.a)(Pl,"ModernFontPickerFeatureHelper",null,[1417,10]);var hj=c(474),Yp=c(643),lp=c(1666);class wl{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(wl,"FontInfoTaskPaneProps",null,[]);class so{constructor(S,Ba,ib,Sb=null){this.AVe=this.UV=this.yid=null;this._state=this.vWb=0;this.oIe=S;this.W8a=Ba;this.NWj=ib;this.Ub=Sb}get oc(){return this.oIe.value}initialize(){this.oc.qa(n.a.R6f,y.a.frame,Object(a.a)(this,this.R6f,"requestFontInfo"));this.yid=this.W8a.eya(pq.a.JIb,Object(a.a)(this,this.VCb,
"featureStateChangeCallback"));this.aja()}qP(S=!1){const Ba=xh.UISurfaces.Bu(),ib=this.W8a.isFeatureEnabled(pq.a.JIb,!1),Sb=[];Sb.push(Ba);Sb.push(ib);Promise.all(Sb).then(yc=>{yc[0].showTaskPane(lp.a.pDb,this.jA(yc[1]));S&&this.WJ()})}sWo(S){xh.UISurfaces.Bu().then(Ba=>{Ba.updateTaskPane(lp.a.pDb,this.jA(S));return null})}VCb(S){this.sWo(S.isEnabled)}R6f(S,Ba,ib,Sb,yc){this.UV=yc.CommandValueId;this.AVe=yc.Trigger;this.vWb=yc.InputMethod;this.qP(2===this._state&&1===this.vWb);return 32}jA(S){const Ba=
new wl;Ba.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");Ba.fontName=this.UV;Ba.isLicensed=S;Ba.trigger=this.AVe;Ba.helpArticleUrl=this.C3k();Ba.paneId=lp.a.pDb;S=this.cxm();S.contentProps=Ba;return S}cxm(){return Object.assign(new xj.a,{title:lp.a.ofc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}aja(){if(this.Ub){var S=this.Ub.fe(lp.a.pDb);S.parent=Bd.AFrame.vp;S.TH=!0}}onOpen(){this._state=2;this.WJ()}onShow(S){0!==this._state&&(this._state=2,1===S&&(this.vWb=S),this.WJ())}onClose(){this.vWb=this._state=0;this.blur()}onHide(){this._state=1;this.vWb=0}WJ(){this.Ub&&1===this.vWb&&this.Ub.mg(lp.a.pDb)}blur(){this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name===lp.a.pDb&&this.Ub.mg(this.Ub.yT)}onUpsellButtonClicked(){this.W8a.launchUpsellExperience(lp.a.experienceId)}dispose(){this.W8a.Vgc(pq.a.JIb,
this.yid)}C3k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.NWj,this.tYl(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}tYl(){switch(this.AVe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return so.cMk(this.UV)}static cMk(S){let Ba="hlpFontInfo";for(let ib=0;ib<S.length;++ib){const Sb=Sa.a.charAt(S,
ib);if(255<S.charCodeAt(ib)||Sa.a.oXd(Sb))Ba+=Sb}return Ba}}Object(f.a)(so,"FontInfoPane",null,[1293,10]);class Bj extends so{constructor(S,Ba,ib,Sb,yc){super(S,Ba,Sb.jb("FontInfoHelpBaseUrl"),yc);this.R2=ib}qP(S){this.d_();super.qP(S)}VCb(S){super.VCb(S);cb.App.xa.updateCommandUI()}d_(){this.R2.INa()}}Object(f.a)(Bj,"WordEditorFontInfoPane",so,[]);class Jq{constructor(){this.WUb=this.Iod=this.jtc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}xc(S){this.W=S;S.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Pl(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();S.ha("Common.ModernFontPicker.IFontInfoPane",()=>new Bj(new jb.a(()=>l.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Wh.a.instance,l.AFrameworkApplication.K,di.FocusManager.instance())).singleInstance()}init(){this.Iod=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.jtc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.jtc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.WUb=this.W.Na(Yp.a))?this.WUb.initialize():ma.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));cb.App.xa.updateCommandUI()}dispose(){this.jtc&&(this.jtc.dispose(),this.jtc=null);this.Iod&&(this.Iod.dispose(),this.Iod=null);this.WUb&&(this.WUb.LCa(),this.WUb=null)}static main(){Object(hj.a)()&&L.a.instance.Fc(new Jq)}}Object(f.a)(Jq,"ModernFontPickerPackage",null,[1,2]);var Ro=c(131),Jm=c(5),
io=c(246),wm=c(36),Xj=c(1098);class Ql{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg,Vh=null){this.YY=ib;this.Wc=S;this.Gc=Ba;this.nh=yc;this.gJa=ed;this.FV=Ud;this.KNg=Xe;this.JNg=Ue;this.Sx=Kf;this.j_j=Vh||Ql.jw}get gh(){return this.Sx?this.Sx.gh:!1}Yqi(S){return this.XEa(S,0)}iAm(S){return this.XEa(S,1)}XEa(S,Ba){let ib=null;if(this.gh&&this.FV&&(this.JNg.instance&&this.JNg.instance.tIa(S),Ba?1===Ba&&(ib=this.FV.Oai(S.node)):ib=this.FV.zof(S.node,S.cpBegin,S.Eb),ib&&!ib.ia(zl.a.F8,!1)))return ma.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Sb=Jm.GraphIterator.vX(this.Wc.yk());Sb.set(S.node);Sb.zb(10);const yc=this.Gc.Oc(15);yc.ku(Sb);Ba?wm.OutlineElementNavigator.Vd(Sb):(this.splitParagraph(Sb,S),this.YY.amc(S.node,ak.a.Bs));S=vl.ParagraphReader.kl(Sb.currentNode);this.zBm(Sb);this.gh&&ib&&this.KNg&&(Ba=new lb.a,Ba.add(Sb.currentNode),this.KNg.Vmh(Ba,ib.id));this.Fio(S);yc.dispose();return 32}Fio(S){S=de.SelectionFactory.ue(S,0);co.a.instance.setSelection(S)}zBm(S){this.nh.yA(S,
!0,!0,null,!1,!1);S=wm.OutlineElementNavigator.Ge(S);this.jAm(S)}splitParagraph(S,Ba){const ib=wm.OutlineElementNavigator.Vd(S);if(Ba.cpBegin||this.gh&&(!this.gh||-1!==Ba.Eb)){cb.App.qd.Qo&&Ba.cpBegin!==vl.ParagraphReader.textLength(Ba.node)&&cb.App.qd.Qp.QF(Ba.node);this.nh.yA(S,!1,!0,null,!1,!0);var Sb=Jm.GraphIterator.vX(this.Wc.yk());Sb.set(ib);this.nh.X9(Sb,S,Ba,!0,!0,!0)}}jAm(S){S=this.j_j(S);this.gJa.xri(S)}static WE(){return new Ql(new xi.a,new Ml.a,va.a.instance.resolve("Box4.IAutoCorrectScheduler"),
Xj.a.instance,va.a.instance.resolve("Box4.IOutlineElementEditor"),va.a.instance.resolve("Box4.IBlobEditor"),va.a.instance.Na("Box4.IContentControlReader"),va.a.instance.Na("Box4.IContentControlEditor"),va.a.instance.Sa("Box4.IContentControlConverter"),va.a.instance.Na("Box4.ContentControlConfigSettings"),va.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=Ql.eCg?Ql.eCg:Ql.eCg=Ql.WE()}static jw(S){return mh.a.jw(S)}}Object(f.a)(Ql,"PageBreakInserter",null,[916]);class wn{constructor(S,
Ba,ib,Sb,yc,ed,Ud,Xe){this.CBm=(Ue,Kf,Bg,Vh)=>{var Jh=Kf.view,ij=Jh.lb.tg;if(!ij)return 2;if(!this.y6e(Kf))return 8;if(1===Bg)return 32;let gk=!0;Bg=8;const Yh=this.uGe(ij);ij=this.Gc.Oc(15);ij.Cb(Jh.Yc);ij.fk=Ue;Yh||(Bg=this.ga.Of(Kf,Lg.a.Kma,2,!0,Vh,null),Ue=32===Bg,ma.ULS.shipAssertTag(4208012,314,Ue),gk=Ue);gk&&(Jh=Jh.lb.tg,Ue=this.uGe(Jh),ma.ULS.shipAssertTag(4208013,314,Ue,"{0}",{["ContextId"]:Kf.contextId}),Bg=8,Ue&&(Bg=this.gEe.Yqi(Jh),ma.ULS.shipAssertTag(4208014,314,32===Bg)));ij.dispose();
32===Bg&&this.Sd.Ls(10);return Bg};this.BBm=(Ue,Kf,Bg)=>{if(!Kf||Kf.contextId!==Ji.a.Tc)return 8;if(1===Bg)return Kf.contextId===Ji.a.Tc?32:8;if(2===Bg){if(!this.y6e(Kf))return 8;Ue=this.gEe.Yqi(Kf);32===Ue&&this.Sd.Ls(10);return Ue}return 32};this.ABm=(Ue,Kf,Bg)=>{if(!Kf||Kf.contextId!==Ji.a.table)return 8;if(1===Bg)return 32;if(2===Bg){if(!this.y6e(Kf))return 8;Ue=this.gEe.iAm(Kf);32===Ue&&this.Sd.Ls(10);return Ue}return 32};this.ga=S;this.gEe=Ba;this.Gc=ib;this.Tm=Sb;this.uGe=yc;this.Ik=ed;this.f8j=
Ud;this.Sd=Xe}Tb(){this.ga.qa(Cf.a.XEa,Ji.a.view,this.CBm);this.ga.qa(Cf.a.XEa,Ji.a.Tc,this.BBm);this.ga.qa(Cf.a.XEa,Ji.a.table,this.ABm);this.ga.Vc(Cf.a.XEa,4)}W4(){const S=di.FocusManager.instance().fe(Ro.AppFrame.YE);Bd.AFrame.Ai(S,of.KeyInputManager.kc(ak.a.Bs,of.KeyInputManager.Sh),Cf.a.XEa)}gMm(S){return this.ex(S.iterator)}MPm(S){S=S.J(0);const Ba=We.SelectionEditor.xj(S,!0,!1);if(this.ex(Ba.Oa.iterator))return!0;S=We.SelectionEditor.xj(S,!1,!1);return this.ex(S.Oa.iterator)}ex(S){return S.zb(14)}y6e(S){let Ba=
null,ib=S;if(ib.contextId===Ji.a.view){Ba=ib.view;if(!Ba.features.Ygg)return!1;ib=Ba.lb.tg;if(!ib)return!1}else{const Sb=Jm.GraphIterator.$a(ib.node);if(Sb.zb(36)||Sb.zb(38)||Sb.zb(40)||Sb.zb(14))return!1}return io.a.kha(S)?!1:ib.contextId===Ji.a.table?this.Ik.RLm(ib.node):!this.Ik.PLm(ib)||this.Tm&&this.Tm.instance&&this.Tm.instance.tU(ib)?!1:((S=this.uGe(ib))?this.gMm(ib):this.MPm(Ba.lb.gb))||S&&this.f8j(ib,!0)?!1:!0}static WE(){return new wn(l.AFrameworkApplication.va,Ql.instance,new Ml.a,va.a.instance.Sa("Box4.IExternalSelectionManager"),
We.SelectionEditor.gf,bl.a.instance,fo.HyperlinkReader.Ewa,va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=wn.ZAg?wn.ZAg:wn.ZAg=wn.WE()}}Object(f.a)(wn,"PageBreakActor",null,[898]);class qq{constructor(){this.vMe=this.W=null}get name(){return"WordEditor.PageBreak"}xc(S){this.W=S}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}jn(){this.vMe=wn.instance;this.vMe.Tb();this.vMe.W4();cb.App.xa.updateCommandUI()}dispose(){}}
Object(f.a)(qq,"PackageManager",null,[1,2]);var Zp=c(1478),Tk=c(1479),Uk=c(272),Qp=c(188),ti=c(245),xm=c(276),to=c(441);class Gg{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.pwb=null;this.ra=new M.a;this.Pwe=1;this.rnd=-1;this.fXa=null;this.opa=()=>{this.c5e()};this.ib=Ba;this.Hb=ib;this.vhd=Sb;this.yI=yc;this.Ly=ed;this.Sea=Ud;this.enable()}get lHd(){return this.Pwe}Gnj(S){this.Pwe!==S&&(this.Pwe=S,this.ra.raiseEvent("X"),this.PEf&&this.zmg())}get PEf(){const S=va.a.instance.Na("WordEditor.Pagination.IPageEndMarkers");
return S?S.PEf:!0}get lf(){return this.yI.value}get Jk(){return He.a.instance}cwk(S){this.ra.addHandler("X",S)}zmg(){this.Jk.he(()=>{this.Sea.RU(to.a.sZi)},"CPC:UPN")}enable(){this.ib.Pw(this.opa);this.c5e()}c5e(){if(!this.fXa||1>=this.fXa.count)this.Gnj(1);else{var S=this.ib.gb.kb;if(S){var Ba=S.Nf?S.Pc:S.Oa;!Ba||0>Ba.cpBegin||(S=Ba.node)&&vl.ParagraphReader.Vb(S)&&this.yLm(S)&&(this.pwb&&(this.Hb.We(this.pwb),this.pwb=null),this.pwb=new Qc.a(2,1,400,ib=>{this.findCurrentPageFromIp(ib,Ba)},62),this.Hb.Wb(this.pwb))}}}yLm(S){S=
Jm.GraphIterator.$a(S);return S.zb(35)||S.zb(37)||S.zb(39)?!1:!0}jGj(S){this.fXa=S;this.IEj()}IEj(){if(-1!==this.rnd){var S=this.DBl(this.rnd);-1!==S&&this.Gnj(S)}}findCurrentPageFromIp(S,Ba){this.pwb===S&&(this.pwb=null,this.rnd=this.TJl(Ba),-1!==this.rnd&&this.IEj())}DBl(S){if(!this.fXa)return-1;for(let Ba=0;Ba<this.fXa.count;Ba++){const ib=this.fXa.J(Ba);if(S>ib.Hlh&&S<ib.Hlh+ib.height)return ib.Eh}return-1}TJl(S){var Ba=this.N6l(S);if(!Ba||!Ba.htmlElement)return-1;const ib=Ba.getBounds();S=this.DRl(S,
Ba);if(!S)return-1;Ba=ha.a.s1a(this.vhd.Q4a,Ba.htmlElement).y;return S.y+Math.floor(S.height/2)-ib.y+Ba}N6l(S){return S.node.De(this.lf.ic)}DRl(S,Ba){S=this.Ly?this.Ly.cba(S,!0):S.cpBegin;return xm.a.Rq(Ba,S)}disable(){this.ib.DY(this.opa)}}Object(f.a)(Gg,"CurrentPageCalculator",null,[941,935]);class jn{constructor(S){jn.kZ=S}get Ybf(){return jn.kZ}get lHd(){return this.Ybf.lHd}ntl(){this.Ybf.enable()}Qml(){this.Ybf.disable()}}jn.kZ=null;Object(f.a)(jn,"CurrentPageManager",null,[939]);var qn=c(116);
class uo extends Sys.EventArgs{constructor(S,Ba){super();this.OPi=Ba}}Object(f.a)(uo,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class fr extends Sys.EventArgs{constructor(S,Ba,ib){super();this.delta=S;this.OPi=ib}}Object(f.a)(fr,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class Oj{static get BZa(){if(null!=Oj.cwg)var S=Oj.cwg;else{var Ba;S=!(null===(Ba=l.AFrameworkApplication.K)||void 0===Ba||!Ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));S=Oj.cwg=S}return S}constructor(S,Ba,ib){this.Mah=this.Drd=-1;this.qyc=null;this.ra=new M.a;this.yKe=!1;this.qXf=(Sb,yc)=>{this.yKe=this.WUk();yc.xmb||this.Qsc.value.measure(this.RUk)};this.RUk=()=>{const Sb=this.Q4a.clientHeight;this.QUk(Sb);this.ZUk(Sb)};this.TWf=(Sb,yc)=>{yc.property===qn.a.hJ&&(Sb=yc.node)&&Sb.ia(qn.a.hJ,!1)&&(Sb=Sb.De(this.lf.ic))&&(Sb=Sb.htmlElement)&&this.cXa.add(Sb)};this.yI=S;this.Qsc=Ba;this.cXa=new lb.a;Oj.BZa||this.lf.UZe(this.qXf);this.Sxf();this.Aca=this.Aca.bind(this);
ib.gzb(this.Aca);Oj.BZa&&0===ib.Wu&&this.XM()}XM(){this.lf.UZe(this.qXf)}cza(){this.lf.paj(this.qXf)}get lf(){return this.yI.value}Aca(S,Ba){this.qyc=null;Oj.BZa&&(1===Ba.Alb?this.cza():0===Ba.Alb&&this.XM())}get Q4a(){this.qyc||(this.qyc=this.lf.Yc.De(this.lf.ic).Q4a,ma.ULS.shipAssertTag(34136386,336,!!this.qyc));return this.qyc}pxk(S){this.ra.addHandler("OnPageContentSizeChangeKey",S)}QUk(S){S!==this.Mah&&(this.ra.raiseEvent("OnDocumentBottomChangeKey",new uo(S,this.yKe)),this.Mah=S)}ZUk(S){S!==
this.Drd&&(-1!==this.Drd&&this.ra.raiseEvent("OnPageContentSizeChangeKey",new fr(S-this.Drd,S,this.yKe)),this.Drd=this.Q4a.clientHeight)}WUk(){let S=!1;for(let Ba=this.cXa.count-1;0<=Ba;Ba--)this.cXa.J(Ba).hasChildNodes()&&(this.cXa.removeAt(Ba),S=!0);return S}Sxf(){cb.App.Tj.zl.Ye(23).Go(this.TWf)}}Object(f.a)(Oj,"DocumentSizeManager",null,[]);var Fn=c(53),Yo=c(247);class rl{constructor(S){this.yI=S}get lf(){const S=this.yI.value;ma.ULS.shipAssertTag(37820298,336,S.Vi,"OutlineManager.PageView is not a PageView.");
return S}Pge(S,Ba){const ib=Fn.a.Mi(rl.Tf.wB(S),1);Ba+=ib;S.De(this.lf.ic).htmlElement.firstChild.style.minHeight=Ba+"px"}F8h(){const S=Jm.GraphIterator.$a(this.lf.Yc);S.Ep();S.Qd();ma.ULS.shipAssertTag(37820299,336,10===S.Nn.type);return S.Nn}fai(){const S=Jm.GraphIterator.$a(this.lf.Yc);S.Ep();S.F_();ma.ULS.shipAssertTag(37820300,336,10===S.Nn.type);return S.Nn}E8l(S){const Ba=Jm.GraphIterator.$a(this.lf.Yc);Ba.Ep();Ba.Qd();let ib=Ba.Nn,Sb=null;for(;S!==ib&&Ba.Rj();)Sb=ib,ib=Ba.Nn;ma.ULS.shipAssertTag(37820301,
336,10===Ba.Nn.type);return Sb}static get Tf(){return Yo.a.instance}}Object(f.a)(rl,"OutlineManager",null,[938]);class Zm{constructor(S){this.PAa=0;this.J1=null;this.Idg=Ba=>{for(const ib of Ba.customData)this.showAdornmentText(ib)};this.Hb=S}q8d(){this.J1||(this.J1=this.lIc())}TDd(){this.J1&&0<Zm.dNc(this.J1).length&&this.Hb.Wb(this.J1);this.J1=null}lIc(){return Object.assign(new Qc.a(3,1,250,this.Idg,166),{customData:[]})}Pag(S){this.PAa=S}e8c(S){if(S){S.style.width=this.PAa+"px";if(this.J1)var Ba=
this.J1;else Ba=this.lIc(),this.Hb.Wb(Ba);Zm.dNc(Ba).push(S)}}WQc(S){S&&(S.style.width="0px",this.Bxf(S))}Aad(S,Ba){Ba?this.e8c(S):this.WQc(S)}showAdornmentText(S){S.style.width===this.PAa+"px"&&(this.qNc(S).style.visibility="visible")}Bxf(S){S&&(this.qNc(S).style.visibility="hidden")}qNc(S){S=S.childNodes;ma.ULS.shipAssertTag(24958351,336,1===S.length,"Expected 1 child div in the page adornment, found "+S.length);return S[0]}static dNc(S){return S.customData}}Object(f.a)(Zm,"PageAdornmentAnimationManager",
null,[936]);class Ij{constructor(S){this.am=S;this.baa=new Ic.a;this.caa=new Ic.a}WCa(S){S=Jm.GraphIterator.$a(S);if(S.Ep()&&S.xq()){S.Qd();do 10===S.Ve&&this.xZf(S.currentNode),S.xt();while(8!==S.Ve)}}FOb(S){const Ba=S.Eh;var ib=this.cFb(S.cQb);if(!this.baa.nb(ib))return ma.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+ib),!1;S=this.baa.J(ib);ma.ULS.shipAssertTag(24958353,336,this.caa.nb(ib),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
ib=this.caa.J(ib);return this.vxf(S,Ba,ib)}EOb(S){const Ba=S.Eh;var ib=this.cFb(S.cQb);if(!this.baa.nb(ib))return ma.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+ib),!1;S=this.baa.J(ib);ma.ULS.shipAssertTag(24958355,336,this.caa.nb(ib),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");ib=this.caa.J(ib);return this.klf(S,Ba,ib)}Cuf(S){if(!S)return ma.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var Ba=S.FBd;if(!Ba)return ma.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",S.Eh)),0;Ba=this.am.iEb(Ba);if(!Ba)return ma.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;Ba=this.am.Qga(Ba);const ib=1===S.Eh;S=!(S.Eh%2);return 1===Ba?1:2===Ba?ib?2:1:3===Ba?S?3:4:ib?2:S?3:4}xZf(S){if(10===S.type){var Ba=new Ic.a,ib=this.am.iEb(S);
ma.ULS.shipAssertTag(24958356,336,!!ib,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Sb=this.am.Qga(ib);S=this.cFb(S);this.Omg(S,Sb);this.Nmg(S,Ba);ib=Jm.GraphIterator.$a(ib);if(ib.xq()){ib.Qd();do S=ib.currentNode,Sb=this.am.kOc(S),S=this.am.Qmi(S),Ba.add(Sb,S),ib.xt();while(36===ib.Ve)}}}Omg(S,Ba){this.caa.nb(S)?this.caa.Z(S,Ba):this.caa.add(S,Ba)}Nmg(S,Ba){this.baa.nb(S)?this.baa.Z(S,Ba):this.baa.add(S,Ba)}cFb(S){ma.ULS.shipAssertTag(24958358,
336,10===S.type,"Expected node of type Outline but received node of type "+S.type);return S.ia(zl.a.Mia,0)}vxf(S,Ba,ib){const Sb=1===Ba;Ba=!(Ba%2);switch(ib){case 2:if(Sb){if(S.nb(2))return S.J(2)}else if(S.nb(0))return S.J(0);break;case 3:if(Ba){if(S.nb(1))return S.J(1)}else if(S.nb(0))return S.J(0);break;case 4:if(Sb){if(S.nb(2))return S.J(2)}else if(Ba){if(S.nb(1))return S.J(1)}else if(S.nb(0))return S.J(0);break;case 1:if(S.nb(0))return S.J(0)}return!1}klf(S,Ba,ib){const Sb=1===Ba;Ba=!(Ba%2);
switch(ib){case 2:if(Sb){if(S.nb(5))return S.J(5)}else if(S.nb(3))return S.J(3);break;case 3:if(Ba){if(S.nb(4))return S.J(4)}else if(S.nb(3))return S.J(3);break;case 4:if(Sb){if(S.nb(5))return S.J(5)}else if(Ba){if(S.nb(4))return S.J(4)}else if(S.nb(3))return S.J(3);break;case 1:if(S.nb(3))return S.J(3)}return!1}}Object(f.a)(Ij,"PageAdornmentContentManager",null,[937]);var vh=c(1155);class mp{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue){this.Sng(S,Ba,ib,ed,Ud,Xe,Ue);this.Eh=S;this.Qq=Ba;this.Gs=ib;this.cQb=
Sb;this.FBd=yc;this.Meb=ed;this.o9b=Ud;this.t6b=Xe;this.EZi=Ue}get top(){return this.Qq}get height(){return this.Gs}q7c(S){this.Qq!==S&&(this.Meb.style.top=S+"px",this.Qq=S)}rag(S){this.height!==S&&(this.Meb.style.height=S+"px",this.Gs=S)}Sng(S,Ba,ib,Sb,yc,ed,Ud){ma.ULS.shipAssertTag(37244961,336,0<S,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",S);ma.ULS.shipAssertTag(37244962,336,0<=Ba,"PageAdornmentContainer: top parameter value {0} is unexpected value.",Ba);ma.ULS.shipAssertTag(37244963,
336,0<=ib,"PageAdornmentContainer: height parameter value {0} is unexpected value.",ib,Ba);ma.ULS.shipAssertTag(37244992,336,!!Sb,"PageAdornmentContainer: containerDomElement parameter is null.");ma.ULS.shipAssertTag(37244993,336,!!yc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ma.ULS.shipAssertTag(37244994,336,!!ed,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ma.ULS.shipAssertTag(37244995,336,!!Ud,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(f.a)(mp,"PageAdornmentContainer",null,[966]);class aj{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg,Vh,Jh){this.JXg="headerFooterTab";this.Svd=null;this.Is=!0;this.vCe=0;this.GHe=null;this.Q1a=!1;this.uKb=ij=>{this.pjn(ij.Qw);return!0};this.LB=()=>!0;this.QFb=()=>{this.u$e()&&(this.Q1a=!1,this.ORo(),this.GHe=new Date)};this.yKb=ij=>{this.Q1a||this.zV.e8c(ij.Qw);return!0};this.xKb=ij=>{this.Q1a||(ij=ij.Qw,this.pdg(ij)||this.zV.WQc(ij));return!0};this.dUn=()=>{let ij=Array.dequeue(this.WOe);for(;ij;)this.XM(ij),
ij=Array.dequeue(this.WOe);this.Svd=null};this.yI=S;this.ig=Ba;this.oE=ib;this.Qja=Sb;this.ga=yc;this.qk=ed;this.zV=Ud;this.$za=Xe;this.EKa=Ue;this.Hb=Kf;this.Ma=Bg;this.WOe=[];this.F1=new Map;this.vI=Vh;this.rx=Jh;this.EKa.vzd(this.QFb);this.Jw=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.xJ;if(this.Lld=(this.sEe=!!this.Ma&&this.Ma.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ma&&this.Ma.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===cb.App.xa.GI.getLayoutBreakpoint()&&
(this.Is=!1),cb.App.xa.GI.registerLayoutBreakpointChanged(this.JXg,ij=>{switch(ij){case "Small":this.mni();break;default:this.Rrj()}})}get lf(){return this.yI.value}Rrj(){try{this.Tvo()}catch(S){ma.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",S.message,S.stack)}}mni(){try{this.Orm()}catch(S){ma.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",S.message,S.stack)}}LZn(){for(const S of this.F1.keys())this.Lce(S)}WCa(){try{this.z2k()}catch(S){ma.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",S.message,S.stack)}}jGj(S){try{this.mWo(S)}catch(Ba){ma.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",Ba.message)}}dispose(){try{this.nQo(),this.UQo(),this.EKa&&this.EKa.xaj(this.QFb)}catch(S){ma.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",S.message,S.stack)}}pjn(S){const Ba=this.hUc(S),ib=this.V5h(S);ib?(uc.b("OpenHeaderFooterFromWebViewAdornment"),
S=this.$za.Cuf(ib),this.ga.Qb(Ba?Cf.a.Aoe:Cf.a.Ebd,2,S),this.Q1a=!0):(ma.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+S.id),this.ga.processAction(Cf.a.qWd,2))}nQo(){this.F1.forEach(S=>{this.cza(S)})}UQo(){this.Jw&&(this.Lld&&(cb.App.xa.GI.unregisterLayoutBreakpointChanged(this.JXg),this.Lld=!1),this.Jw=!1)}cza(S){if(S){var Ba=S.o9b;S=S.t6b;mb.a.Vwa(Ba)&&mb.a.Vwa(S)?(this.qk.uc(W.a.rR,Ba,this.yKb),this.qk.uc(W.a.rR,S,this.yKb),this.qk.uc(W.a.hL,
Ba,this.xKb),this.qk.uc(W.a.hL,S,this.xKb),this.ig.uc(W.a.click,Ba,this.uKb),this.ig.uc(W.a.click,S,this.uKb),this.oE.uc(Ba,aj.kKb),this.oE.uc(S,aj.kKb),this.Qja.uc(W.a.Lx,Ba,this.LB),this.Qja.uc(W.a.Lx,S,this.LB)):ma.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}XLn(S){this.WOe.push(S);this.Svd||(this.Svd=new Qc.a(2,1,50,this.dUn),this.Hb.Wb(this.Svd))}XM(S){if(S){var Ba=S.o9b;S=S.t6b;mb.a.Vwa(Ba)&&mb.a.Vwa(S)?(this.qk.mb(W.a.rR,
Ba,this.yKb),this.qk.mb(W.a.rR,S,this.yKb),this.qk.mb(W.a.hL,Ba,this.xKb),this.qk.mb(W.a.hL,S,this.xKb),this.ig.mb(W.a.click,Ba,this.uKb),this.ig.mb(W.a.click,S,this.uKb),this.oE.mb(Ba,aj.kKb),this.oE.mb(S,aj.kKb),this.Qja.mb(W.a.Lx,Ba,this.LB),this.Qja.mb(W.a.Lx,S,this.LB)):ma.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Tvo(){if(!this.Is){for(const S of this.F1.values())S.Meb.style.display="block";this.Is=!0}}Orm(){this.Is&&
(this.F1.forEach(S=>{S.Meb.style.display="none"}),this.Is=!1)}z2k(){this.$za.WCa(this.lf.Yc)}mWo(S){this.zV.q8d();var Ba=0;const ib=new lb.a;this.WCa();const Sb=this.T_l();for(var yc of S)S=yc.Eh,this.Fxn(yc)||this.Lce(yc.Eh),this.F1.has(S)?this.bTo(yc):this.Z8k(yc),Ba=S,ib.add(S);for(yc=1;yc<=Ba;yc++)ib.contains(yc)||this.Lce(yc);for(Ba+=1;Ba<=Sb;Ba++)this.Lce(Ba);this.zV.TDd()}Fxn(S){return this.F1.has(S.Eh)?this.F1.get(S.Eh).cQb.id===S.cQb.id:!1}T_l(){let S=0;this.F1.forEach((Ba,ib)=>{ib>S&&(S=
ib)});return S}Z8k(S){const Ba=S.cQb.De(this.lf.ic);if(Ba){var ib=S.Eh;S=this.XHc(ib,S.top,S.height,Ba.kba,S.cQb,S.FBd);this.XLn(S);this.Dlg(S);this.dng(S);this.Lld&&!this.Is&&(S.Meb.style.display="none");this.F1.set(ib,S)}}XHc(S,Ba,ib,Sb,yc,ed){const Ud=ki.b("div","","PageAdornmentContainer");Ud.style.top=Ba+"px";Ud.style.height=ib+"px";Sb.appendChild(Ud);this.d5e(Ud,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Sb=this.Paf(S);Ud.appendChild(Sb);const Xe=this.oaf(S);
Ud.appendChild(Xe);const Ue=this.eaf(S);Ud.appendChild(Ue);l.AFrameworkApplication.isRtl&&(Ud.classList.add("Rtl"),Xe.classList.add("Rtl"),Ue.classList.add("Rtl"));return new mp(S,Ba,ib,yc,ed,Ud,Xe,Ue,Sb)}oaf(S){S=ki.b("div","h"+S,this.rx?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.vI&&(this.rx?S.classList.add("PageAdornmentHeaderFooterBorderThemed"):S.style.borderColor=vh.a.Poe);const Ba=ki.b("span","","");Ba.innerText=WordEditorIntl.WordEditorStrings.l_Header;Ba.style.whiteSpace=
"nowrap";S.appendChild(Ba);return S}eaf(S){S=ki.b("div","f"+S,this.rx?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.vI&&(this.rx?S.classList.add("PageAdornmentHeaderFooterBorderThemed"):S.style.borderColor=vh.a.Poe);const Ba=ki.b("span","","");Ba.innerText=WordEditorIntl.WordEditorStrings.l_Footer;Ba.style.whiteSpace="nowrap";S.appendChild(Ba);return S}Paf(S){const Ba=ki.b("div","","PageAdornmentNumberLabel");Ba.innerText=S.toString();return Ba}d5e(S,Ba,ib){if(!this.vCe){const Sb=
ki.b("p","","");Sb.innerText=Ba;Sb.style.whiteSpace="nowrap";Sb.style.visibility="hidden";S.appendChild(Sb);Ba=ki.b("p","","");Ba.innerText=ib;Ba.style.whiteSpace="nowrap";Ba.style.visibility="hidden";S.appendChild(Ba);this.vCe=S.clientWidth;this.zV.Pag(this.vCe);S.removeChild(Sb);S.removeChild(Ba)}}Lce(S){if(this.F1.has(S)){var Ba=this.F1.get(S);this.cza(Ba);mb.a.jx(Ba.Meb);this.F1.delete(S)}}bTo(S){if(this.F1.has(S.Eh)){var Ba=this.F1.get(S.Eh);Ba.q7c(S.top);Ba.rag(S.height);this.Dlg(Ba);this.dng(Ba)}else ma.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}ORo(){this.zV.q8d();this.WCa();this.F1.forEach(S=>{this.Dlg(S);this.dng(S)});this.zV.TDd()}Dlg(S){const Ba=S.o9b,ib=S.t6b,Sb=this.$za.FOb(S),yc=this.$za.EOb(S);this.uYo(S,Sb,yc);this.zV.Aad(Ba,Sb);this.zV.Aad(ib,yc)}uYo(S,Ba=!0,ib=!0){const Sb=S.o9b;S=S.t6b;3!==l.AFrameworkApplication.va.mode?(Sb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,S.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Sb.title=
Ba?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,S.title=ib?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}pdg(S){const Ba=this.V5h(S);return Ba?this.hUc(S)?this.$za.FOb(Ba):this.$za.EOb(Ba):(ma.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}V5h(S){S=S.id;S=S.substring(1,S.length);S=Number.parseInvariant(S);return this.F1.has(S)?this.F1.get(S):(ma.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+S),null)}hUc(S){return S.id.length?"h"===S.id.substring(0,1):(ma.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}dng(S){const Ba=S.height;Ba<aj.bdn?(S.o9b.classList.add(aj.tib),S.t6b.classList.add(aj.tib)):(S.o9b.classList.remove(aj.tib),S.t6b.classList.remove(aj.tib));Ba<aj.cdn?(S.EZi.classList.add(aj.tib),S.Meb.classList.add(aj.tib)):(S.EZi.classList.remove(aj.tib),S.Meb.classList.remove(aj.tib))}u$e(){return!this.GHe||
Y.a.oxf(this.GHe,500)}static kKb(){return!0}}aj.tib="Hidden";aj.bdn=120;aj.cdn=50;Object(f.a)(aj,"PageAdornmentManager",null,[934,10,935]);class Z{constructor(S,Ba){this.Y8d=new lb.a;this.Y8d.add(S);this.Y8d.add(Ba)}}Object(f.a)(Z,"PageElementManagerList",null,[]);var na=c(59);class qb{constructor(S,Ba,ib){this.Wm=S;this.wXb=[];this.uK=Ba;this.vI=ib}o9i(){for(let S=0,Ba=this.wXb.length;S<Ba;S++)mb.a.jx(this.wXb[S]);Array.clear(this.wXb)}y7h(S,Ba,ib,Sb,yc,ed){let Ud=Math.min(Sb.x-ed.x,yc.x-ed.x);Sb=
Math.min(ed.x+ed.width-(Sb.x+Sb.width),ed.x+ed.width-(yc.x+yc.width));Ba+=yc.y-ed.y;({fia:Ba,leftMargin:Ud,rightMargin:Sb}=this.Izk(Ba,Ud,Sb));S=this.O5l(S,Ud,Sb,Ud,Sb,ib);S.style.top=Ba+"px";S.style.zIndex="0";this.wXb.push(S);na.d(S,!0);return S}IQd(S){return S?S.querySelector(".PageBreakBorderSpan"):null}O5l(S,Ba,ib,Sb,yc,ed){return S?this.kem(Ba,ib,Sb,yc,ed):this.h6l(Sb,yc,ed)}Izk(S,Ba,ib){Ba/=this.Wm.instance.hj;ib/=this.Wm.instance.hj;S/=this.Wm.instance.hj;return{fia:S,leftMargin:Ba,rightMargin:ib}}JKm(S){return this.TCi(S)&&
this.yZi(S)?(S=this.REb(S))&&S.offsetParent?!1:!0:!1}IKm(S){return!this.TCi(S)||this.yZi(S)?!1:!0}nR(){}REb(S){if(!S.XXf)return null;let Ba=null;S.Ajb&&!S.jca?(S=this.IQd(S.XXf))&&(Ba=S):Ba=S.XXf;return Ba}TCi(S){return S.Ajb&&!S.jca&&S.paragraphNode?!0:!1}yZi(S){S=S.paragraphNode;return!!S&&!!S.anchor}Qzh(S,Ba){S=ha.a.ZDa(S);Ba=ha.a.ZDa(Ba);return(S-Ba)/this.Wm.instance.hj}i5e(S,Ba){S=ha.a.ZDa(S);Ba=ha.a.ZDa(Ba);return(S-Ba)/this.Wm.instance.hj}p3d(){this.lGj(!1)}o3d(){this.lGj(!0)}lGj(S){for(let Ba=
0,ib=this.wXb.length;Ba<ib;Ba++){const Sb=this.wXb[Ba];"PageEndMarker.Para"===Sb.id?qb.pGj(Sb,S):"PageEndMarker.Table"===Sb.id&&qb.iHj(Sb,S)}}h6l(S,Ba,ib){if(!qb.u_b){qb.u_b=ki.b("div","PageEndMarker.Para","PageEndMarker");var Sb=ki.b("div","","Current FullWidth");this.vI&&(Sb.style.borderTopColor=this.uK.Mva());qb.u_b.appendChild(Sb);Sb=ki.b("div","","Stale LeftWing");const yc=ki.b("div","","Stale RightWing");this.vI&&(Sb.style.borderTopColor=this.uK.Mva(),yc.style.borderTopColor=this.uK.Mva());
qb.u_b.appendChild(Sb);qb.u_b.appendChild(yc)}Sb=qb.u_b.cloneNode(!0);Sb.childNodes[1].style.width=S-10+"px";Sb.childNodes[2].style.width=Ba-10+"px";qb.pGj(Sb,ib);return Sb}kem(S,Ba,ib,Sb,yc){if(!qb.qyb){qb.qyb=ki.b("div","PageEndMarker.Table","PageEndMarker");var ed=ki.b("div","","Current LeftWing"),Ud=ki.b("div","","Current RightWing");this.vI&&(ed.style.borderTopColor=this.uK.Mva(),Ud.style.borderTopColor=this.uK.Mva());qb.qyb.appendChild(ed);qb.qyb.appendChild(Ud);ed=ki.b("div","","Stale LeftWing");
Ud=ki.b("div","","Stale RightWing");this.vI&&(ed.style.borderTopColor=this.uK.Mva(),Ud.style.borderTopColor=this.uK.Mva());qb.qyb.appendChild(ed);qb.qyb.appendChild(Ud)}ed=qb.qyb.cloneNode(!0);ed.childNodes[0].style.width=S+"px";ed.childNodes[1].style.width=Ba+"px";ed.childNodes[2].style.width=ib-10+"px";ed.childNodes[3].style.width=Sb-10+"px";qb.iHj(ed,yc);return ed}static pGj(S,Ba){Ba?qb.X8m(S):qb.Y8m(S)}static Y8m(S){S.childNodes[0].style.display="none";S.childNodes[1].style.display="block";S.childNodes[2].style.display=
"block"}static X8m(S){S.childNodes[0].style.display="block";S.childNodes[1].style.display="none";S.childNodes[2].style.display="none"}static iHj(S,Ba){Ba?qb.c9m(S):qb.d9m(S)}static d9m(S){S.childNodes[0].style.display="none";S.childNodes[1].style.display="none";S.childNodes[2].style.display="block";S.childNodes[3].style.display="block"}static c9m(S){S.childNodes[0].style.display="block";S.childNodes[1].style.display="block";S.childNodes[2].style.display="none";S.childNodes[3].style.display="none"}}
qb.u_b=null;qb.qyb=null;Object(f.a)(qb,"PageEndDOMHelper",null,[]);class gc{constructor(S,Ba){this.zwb=this.Tah=null;this.Wm=S;this.si=Ba}kgg(S,Ba){try{this.GCo(S,Ba)}catch(ib){ma.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",ib.message)}}W1k(S,Ba,ib,Sb,yc,ed){this.si.he(()=>{try{this.X1k(S,Ba,ib,Sb,yc,ed)}catch(Ud){ma.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Ud.message)}},"PEMPC:CP")}GCo(S,Ba){this.Tah=S;this.zwb=Ba}X1k(S,Ba,ib,Sb,yc,ed){var Ud=this.Tah;if(Ud&&S){var Xe=Ud.count,Ue=S.count;if(Xe&&Ue){var Kf=this.fCl(Ud,S);if(Kf.count){var Bg=this.Wm.hj,Vh=this.Z2b(Kf)/Bg,Jh=this.HGh(Kf)/Bg;S=this.ZLd(Ud,S);if(S.count){Ud=this.Z2b(S)/Bg;Bg=this.HGh(S)/Bg;var ij=!0;for(var gk=0;gk<Kf.count;gk++)if(Kf.J(gk)){ij=!1;break}var Yh=gk=0;this.zwb&&Ba&&(gk=this.QPk(this.zwb,Ba),Yh=Ba.count-this.zwb.count);ma.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Sb,
["EstimatedPageCount"]:Xe,["CalculatedPageCount"]:Ue,["InOrderAverageDelta"]:Vh,["InOrderStandardDeviation"]:Jh,["ShortestAverageDelta"]:Ud,["ShortestStandardDeviation"]:Bg,["PositionsShouldBeUpdated"]:ib,["DocumentHeightChanged"]:yc,["DeltasAllZero"]:ij,["HeaderFooterOpenSinceLastResponse"]:ed,["DeltaInViewport"]:gk,["ChangeInViewportMarkerCount"]:Yh});yc||ed||ij||(ma.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
Ba=Kf.toArray().toString(),ib=S.toArray().toString(),ma.ULS.sendTraceTag(35726603,336,50,"{0} {1}",Ba,ib))}}}}else ma.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}QPk(S,Ba){const ib=new lb.a;for(const Sb of S)ib.add(Sb.top);if(!ib.count)return-1;S=new lb.a;for(const Sb of Ba)S.add(Sb.top);if(!S.count)return-1;Ba=this.ZLd(ib,S);return this.Z2b(Ba)/this.Wm.hj}Z2b(S){if(!S.count)return 0;let Ba=0;for(let ib=
0;ib<S.count;ib++)Ba+=S.J(ib);return Ba/S.count}HGh(S){if(!S.count)return 0;const Ba=this.Z2b(S);let ib=0;for(let Sb=0;Sb<S.count;Sb++){const yc=S.J(Sb)-Ba;ib+=yc*yc}return Math.sqrt(ib/S.count)}fCl(S,Ba){const ib=new lb.a;if(!S.count||!Ba.count)return ib;S.Sc((yc,ed)=>yc-ed);Ba.Sc((yc,ed)=>yc-ed);const Sb=Math.min(S.count,Ba.count);for(let yc=0;yc<Sb;yc++){const ed=Math.abs(S.J(yc)-Ba.J(yc));ib.add(ed)}return ib}ZLd(S,Ba){const ib=new lb.a;if(!S.count||!Ba.count)return ib;var Sb=S.count<=Ba.count;
const yc=Sb?S:Ba;S=Sb?Ba:S;for(Ba=0;Ba<yc.count;Ba++){Sb=yc.J(Ba);let Ud=Math.abs(Sb-S.J(0)),Xe=0;for(let Ue=1;Ue<S.count;Ue++){var ed=S.J(Ue);ed=Math.abs(Sb-ed);ed<Ud&&(Ud=ed,Xe=Ue)}ib.add(Ud);S.removeAt(Xe)}return ib}}Object(f.a)(gc,"PageEndMarkerPositionComparer",null,[913]);var zc=c(392),Yc=c(585);class td{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf){this.Qq=S;this._pageNumber=Ba;this.Ajb=ib;this.jca=Sb;this.XXf=yc;this.outlineNode=ed;this.outlineGroupNode=Ud;this.Y9g=Xe;this.paragraphNode=Ue;this.PU=
Kf}get top(){return this.Qq}get Eh(){return this._pageNumber}get axn(){return this.Y9g}q7c(S){this.Qq=S}Qge(S){this._pageNumber=S}Olj(S){this.Y9g=S}}Object(f.a)(td,"PageEndMarker",null,[]);class Jd{constructor(){this.qf=null;this.WPi=0}}Object(f.a)(Jd,"PageEndMarkerToRestore",null,[]);class sc{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.TWf=(Xe,Ue)=>{Ue.property===qn.a.hJ&&(Xe=Ue.node)&&Xe.ia(qn.a.hJ,!1)&&this.Hxd.contains(Xe.id)&&(Ue=Xe.De(this.lf.ic))&&(Ue=Ue.htmlElement)&&(this.Hxd.remove(Xe.id),this.cXa.add(Ue))};
this.yI=S;this.Wm=Ba;this.ALa=ib;this.Xx=Sb;this.zMe=yc;this.BZ=ed;this.Vp=Ud;this.Rt=new lb.a;this.xXb=new lb.a;this.pyb=new Ic.a;this.Hxd=new Yc.a(new zc.a);this.cXa=new lb.a;this.AXb=!!yc;this.Sxf()}get lf(){const S=this.yI.value;ma.ULS.shipAssertTag(37052750,336,S.Vi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return S}Mad(S){try{this.OVo(S)}catch(Ba){this.Xx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
Ba.message)}}Ltk(S){try{this.Mtk(S)}catch(Ba){this.Xx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",Ba.message)}}OQk(S){try{return this.PQk(S)}catch(Ba){this.Xx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",Ba.message)}return!1}x6n(){try{this.y6n()}catch(S){this.Xx.nR(S.message+" "+S.stack),ma.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",S.message)}}iPc(){try{return this.Z9l()}catch(S){return this.Xx.nR(S.message+" "+S.stack),ma.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",S.message),null}}Mmg(){try{this.rXo()}catch(S){this.Xx.nR(S.message+" "+S.stack),ma.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
S.message)}}N6e(){try{return this.tWk()}catch(S){return this.Xx.nR(S.message+" "+S.stack),ma.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",S.message),!1}}rBm(S){try{this.sBm(S)}catch(Ba){this.Xx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",Ba.message)}}OVo(S){if(S){this.$Xk();for(let Ba=0;Ba<S.length;Ba++){const ib=
Ba+1,Sb=this.L3k(S[Ba],ib);this.Rt.add(Sb);this.pyb.add(ib,Sb)}}}sBm(S){let Ba=!1;for(const ib of S)if(ib)if(0<ib.By)for(const Sb of ib.EAf)Ba=this.dzd(Sb,ib.outlineGroupNode)||Ba;else if(0>ib.By){Ba=!0;for(const Sb of ib.iId)this.ujl(Sb.Eh)}Ba&&this.m6f()}Mtk(S){const Ba=this.Z5h(S.paragraphNode);this.dzd(S,Ba)&&this.m6f()}ujl(S){const Ba=S-1;0>Ba||this.Rt.count<=Ba||(this.Rt.removeAt(Ba),this.pyb.nb(S)&&this.pyb.remove(S))}Z9l(){const S=new lb.a;for(const Ba of this.Rt)this.Zac(Ba)&&S.add(Ba);return S}dzd(S,
Ba){if(!S)return ma.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;Ba=this.J3k(S,Ba);S=S.oGm?-1:S.Eh;let ib=!1,Sb;this.pyb.nb(S)?(Sb=this.pyb.J(S).Eh,Ba.Qge(Sb),this.Rt.Z(Sb-1,Ba),this.pyb.remove(S)):(Sb=Ba.Eh,this.Rt.insert(Sb-1,Ba),ib=!0);return ib}L3k(S,Ba){return new td(0,Ba,S.HardBreak,!1,null,null,null,0,null,null)}J3k(S,Ba){const ib=S.Cmb,Sb=S.Eh,yc=S.PU,ed=!!yc&&yc.HardBreak,Ud=S.jca,Xe=S.paragraphNode,Ue=this.sci(Ba),
Kf=S.outlineNode;var Bg=this.qsf(Kf);if(!Bg)return ma.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Vh=null;ed&&(Vh=this.Xx.IQd(S.Cmb));S=this.Xx.Qzh(Vh||ib,Ue);Bg=this.Xx.i5e(Vh||ib,Bg);return new td(Bg,Sb,ed,Ud,ib,Kf,Ba,S,Xe,yc)}PQk(S){this.xXb=new lb.a;this.AXb&&this.zMe.reset();this.FYn();this.Fyo();this.Jzk();this.DQk(S);return 0<this.xXb.count}FYn(){for(let S=0;S<this.Rt.count;S++){const Ba=this.Rt.J(S);this.Xx.JKm(Ba)?
this.p7m(Ba):(this.Xx.IKm(Ba)||this.Zac(Ba)&&!this.qsf(Ba.outlineNode))&&this.x$i(Ba)}}Jzk(){let S=0,Ba=null;var ib=0;let Sb=0;for(let yc=0;yc<this.Rt.count;yc++){const ed=this.Rt.J(yc);this.Zac(ed)&&(ed.Ajb&&(Sb+=this.Nzh(ed,ib,Sb)),Ba&&Ba.id===ed.outlineNode.id||(Ba=ed.outlineNode,Sb=S=0),ed.Ajb&&!ed.jca&&(S=this.BQk(ed)),ib=ed.top+S+Sb,ed.q7c(ib))}this.Nzh(null,ib,Sb);this.xYn()}Nzh(S,Ba,ib){let Sb=null;this.AXb&&(Sb=this.zMe.EQk(S,Ba,ib));return Sb?Sb.delta:0}y6n(){if(this.xXb){for(let S=0;S<
this.xXb.count;S++){const Ba=this.xXb.J(S);mb.a.Ngo(Ba.qf,Ba.WPi)}this.AXb&&this.zMe.u6n()}}rXo(){if(!this.AXb){var S=this.ALa.fai();if(this.Rt.count){var Ba=this.ALa.F8h();for(let yc=0;yc<this.Rt.count;yc++){var ib=this.Rt.J(yc);if(this.Zac(ib)&&ib.jca){ib=this.ALa.E8l(ib.outlineNode);var Sb=0<yc?this.Rt.J(yc-1).outlineNode:Ba;Sb=yc&&ib.id===Sb.id?this.Rt.J(yc-1).top:0;this.ALa.Pge(ib,Sb)}}Ba=this.Rt.J(this.Rt.count-1);Ba.jca?this.ALa.Pge(S,0):this.ALa.Pge(S,Ba.top)}else this.ALa.Pge(S,0)}}Fyo(){this.Rt.Sc((S,
Ba)=>S.Eh-Ba.Eh)}m6f(){for(let S=0;S<this.Rt.count;S++)this.Rt.J(S).Qge(S+1)}BQk(S){return S?this.Pzh(S)-S.top:(ma.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}MQk(S){if(!S)return 0;const Ba=this.sci(S.outlineGroupNode);return Ba?this.Xx.Qzh(this.Xx.REb(S),Ba):0}Pzh(S){if(!S)return 0;const Ba=this.Xx.REb(S);S=this.qsf(S.outlineNode);return S?this.Xx.i5e(Ba,S):(ma.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}xYn(){let S=0,Ba=!1,ib=null,Sb=!1;for(let yc=this.Rt.count-1;0<=yc;yc--){const ed=this.Rt.J(yc);this.Zac(ed)&&(ib&&ib.id===ed.outlineNode.id||(Ba=!ib,ib=ed.outlineNode,S=this.y5l(ib)),ed.Ajb?(Ba=!1,S=ed.top):this.AXb&&Ba||!(ed.top>S)||(this.x$i(ed),mb.a.jx(this.Xx.REb(ed)),Sb=!0))}Sb&&this.m6f()}x$i(S){this.Rt.contains(S)&&(this.AXb&&this.BZ.MZn(S),this.Rt.remove(S))}Zac(S){return S?(S=this.Xx.REb(S))&&S.offsetParent?!0:!1:(ma.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}tWk(){let S=!1;for(let Ba=this.cXa.count-1;0<=Ba;Ba--)this.cXa.J(Ba).hasChildNodes()&&(this.cXa.removeAt(Ba),S=!0);return S}p7m(S){(S=this.Z5h(S.paragraphNode))&&(this.Hxd.contains(S.id)||this.Hxd.add(S.id))}Sxf(){this.Vp&&this.Vp.Ye(23).Go(this.TWf)}DQk(S){for(let Ba=this.Rt.count-1;0<=Ba;Ba--){const ib=this.Rt.J(Ba);this.Zac(ib)&&this.CQk(ib,S)}}CQk(S,Ba){const ib=this.Pzh(S),Sb=this.MQk(S);S.Ajb?(S.q7c(ib),S.Olj(Sb)):(Ba=Ba?ib-S.top:Sb-S.axn,S.q7c(ib-Ba),S.Olj(Sb-Ba),1<Math.abs(Ba)&&this.plo(this.Xx.REb(S),
Ba))}qsf(S){if(!S)return null;S=S.De(this.lf.ic);return S?S.htmlElement:(ma.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}sci(S){return S?(S=S.De(this.lf.ic))?S.htmlElement:null:null}Z5h(S){S=Jm.GraphIterator.$a(S);return S.zb(23)?S.jd(23):null}x5l(S){if(!S)return null;S=S.De(this.lf.ic);return S?ha.a.getElementBounds(S.htmlElement):(ma.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}y5l(S){return(S=
this.x5l(S))?S.height/this.Wm.hj:0}plo(S,Ba){Ba=(mb.a.zUl(S)-Ba)*this.Wm.hj;this.xXb.add(Object.assign(new Jd,{qf:S,WPi:Ba}))}$Xk(){this.Rt=new lb.a;this.pyb=new Ic.a}}Object(f.a)(sc,"PageEndMarkerPositionUpdater",null,[912]);var eg=c(365),hg=c(32),eh=c(350),Rg=c(21);class Sg{constructor(S,Ba,ib,Sb,yc,ed,Ud=!1,Xe=!1,Ue=!1,Kf=!1,Bg=!1){this.Sng(Ba,ib,Sb,yc,ed,Ue,Bg);this.position=S;this.Eh=Ba;this.paragraphNode=ib;this.PU=Sb;this.Cmb=yc;this.outlineNode=ed;this.b3a=Ud;this.pCi=Xe;this.oGm=Ue;this.jca=
Kf;this.GZd=Bg}Qge(S){this.Eh=S}Sng(S,Ba,ib,Sb,yc,ed,Ud){Ud||(ma.ULS.shipAssertTag(38326881,336,!!yc,"PageEndDetails: outlineNode parameter value is null."),ma.ULS.shipAssertTag(24126528,336,0<=S,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",S),ma.ULS.shipAssertTag(24126529,336,!!Ba||ed,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ma.ULS.shipAssertTag(24126530,336,!!ib||ed,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ma.ULS.shipAssertTag(24126531,336,!!Sb||ed,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static Z$k(S,Ba){return Sg.M$e(0,S,null,Ba,!0,!1)}static $$k(S){return Sg.M$e(0,0,null,S,!1,!0)}static M$e(S,Ba,ib,Sb,yc,ed){return new Sg(S,Ba,null,null,ib,Sb,yc,ed,!0)}static J3b(S,Ba){return new Sg(0,S,null,Ba,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(Sg,"PageEndDetails",null,[]);class uh{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe,Ue,Kf,Bg,Vh,Jh,ij,gk,Yh,bq,
gr,Ko,Ao){this.Isa=!0;this.swe=0;this.vqd=this.wCe=this.xCe=this.uye=this.xMe=this.gCe=!1;this.vsd=this.Wwb=null;this.LFe=!0;this.jKb=()=>{this.p3d()};this.OTf=()=>{this.xCe=!1};this.PTf=()=>{this.wCe=this.xCe=!0};this.qqn=(Lp,cq)=>{1>=Math.abs(cq.delta)||(this.uye=!0,this.kGj(!cq.OPi))};this.xSn=Lp=>{Lp===this.Wwb&&(this.Wwb=null);if(this.Isa){var cq=Lp.customData;if(Lp=this.dXa.get(cq.id))for(this.dXa.Z(cq.id,new lb.a),ma.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
Lp.count,cq.id),this.daa&&this.daa.WCa(),cq=0;cq<Lp.count;cq++){const vq=Lp.J(cq),Yn=vq.PU;Yn.HardBreak||(mb.a.jx(vq.Cmb),this.Z5f(Yn))}}};this.wSn=()=>{this.vsd=null;this.Isa&&this.gia&&0<this.gia.count&&(ma.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.Mad(this.gia.toArray(),this.Isa))};this.yI=S;this.oi=Ba;this.daa=ib;this.KN=Sb;this.f$g=yc;this.zbb=ed;uh.Xx=Xe;this.BWg=Ue;this.CI=Kf;this.Hb=Bg;this.N3j=Vh;this.ge=ij;this.BZ=Yh;this.BMe=bq;this.CXb=
gr;this.kZ=Ko;this.fXb=new eg.a;this.yXb=new lb.a;this.gia=new lb.a;this.dXa=new eg.a;this.vN=Jh;this.IS=Ao;this.d9d=this.d9d.bind(this);this.f9d=this.f9d.bind(this);this.sce=this.sce.bind(this);this.Aca=this.Aca.bind(this);this.vN.KDc(this.jKb);this.yMe=!1;gk&&(gk.dqh(this.PTf),gk.vzd(this.OTf));Ud&&Ud.pxk(this.qqn);this.IS.gzb(this.Aca)}get PEf(){return this.LFe}get lf(){return this.yI.value}get vj(){return this.oi.value}Mad(S,Ba){const ib=this.ge.$f("Task","UpdateMarkers");this.ECo();this.Isa=
Ba;uh.Xx.o9i();this.fXb=new eg.a;this.yXb.clear();this.gia.clear();this.dXa=new eg.a;this.LFe=this.gCe=!1;this.KN&&this.KN.Mad(S);this.ovl();this.swe=S.length;this.BZ&&this.BZ.reset(S);this.daa&&this.daa.WCa();for(const Sb of S)this.gia.add(Sb),this.Z5f(Sb);Ba&&this.KN&&this.BMe&&this.BMe.isEnabled&&(S=this.KN.iPc(),this.BMe.BCa(S));this.V1k();this.uye=this.xMe=!1;this.wCe=this.xCe;no.WoncaApp.instance.Kib&&uh.Myf&&this.KN.Mmg();this.zbb.lWo(this.KN.iPc(),this.gia.count);this.LFe=!0;this.kZ.zmg();
ib.stop();ma.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:ib.ti,["RenderedLineCount"]:this.swe,["AvgDurationPerPageInMs"]:ib.ti/this.Aci()})}Cci(){const S=this.KN.iPc();if(!S)return null;const Ba=mb.a.HX(),ib=new lb.a;for(const Sb of S)this.wOm(Sb,Ba)&&ib.add(Sb);return ib}wOm(S,Ba){if(!S)return!1;S=uh.Xx.REb(S);if(!S)return!1;S=ha.a.ZDa(S);return 0<=S&&S<=Ba}Y2h(){const S=new lb.a;if(!this.dXa)return ma.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
S;const Ba=this.dXa.keys;for(let yc=0;yc<Ba.length;yc++){var ib=Ba.J(yc);if(ib=this.dXa.J(ib))for(let ed=0;ed<ib.count;ed++){var Sb=ib.J(ed);Sb.PU.HardBreak||Sb.Cmb.classList.contains("Hidden")||(Sb=ha.a.ZDa(Sb.Cmb),S.add(Sb))}}return S}ECo(){const S=this.Y2h(),Ba=this.Cci();this.f$g.kgg(S,Ba);this.CXb&&this.CXb.isEnabled&&this.CXb.kgg(Ba)}V1k(){if(!(25<this.Aci())){var S=this.Y2h(),Ba=this.Cci();this.f$g.W1k(S,Ba,this.xMe,this.gCe,this.uye,this.wCe);this.CXb&&this.CXb.isEnabled&&this.CXb.BCa(Ba)}}Aca(){this.daa.LZn();
this.IQh()}IQh(){this.vqd&&(this.lf.paj(this.d9d),this.lf.I0n(this.f9d),this.lf.n0n(this.sce),this.vqd=!1)}ovl(){this.vqd||(this.lf.UZe(this.d9d),this.lf.Wxk(this.f9d),this.lf.Xph(this.sce),this.vqd=!0)}Z5f(S){if(this.yMe)return!0;S=this.F1n(S);if(!S)return!1;this.BZ&&this.BZ.inm(S);this.KN&&(this.KN.Ltk(S),this.zbb.gGj(this.KN.iPc()),no.WoncaApp.instance.Kib&&uh.Myf&&this.KN.Mmg());return!0}F1n(S){let Ba=this.NO(S.ParaId);if(!Ba)return null;if(!Ba.anchor||!Ba.pj)return this.Voh(S,Ba),null;let ib,
Sb;if(S.HardBreak){var yc=vl.ParagraphReader.jg(Ba,!0,!0,!0);this.Kyn(yc)&&(Ba=yc);if(!({fia:yc,outlineGroupNode:ib,Amb:Sb}=this.wNo(S,Ba)).returnValue)return null;this.gCe=!0}else if(!({Z8d:yc,outlineGroupNode:ib,Amb:Sb}=this.G1n(S,Ba)).returnValue)return null;return this.dzd(Ba,S,yc,ib,Sb)}Kyn(S){return S?(S=S.De(this.lf.ic))?!!uh.Xx.IQd(S.htmlElement):!1:!1}G1n(S,Ba){var ib=S.PageEndType;let Sb,yc=0,ed=null;if(!ib){if(!({fia:S,GXf:Sb}=this.Dci(S,Ba)).returnValue)return{returnValue:!1,Z8d:yc,outlineGroupNode:ed,
Amb:null}}else if(!({fia:S,Hke:Sb}=this.P5l(S,Ba)).returnValue)return{returnValue:!1,Z8d:yc,outlineGroupNode:ed,Amb:null};var Ud=Jm.GraphIterator.$a(Ba);Ud.vd();ed=Ud.jd(23);Ba=ed.De(this.lf.ic).getBounds();Ud=Ud.HSa().De(this.lf.ic);if(!Ud)return ma.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.lf.ic),{returnValue:!1,Z8d:yc,outlineGroupNode:ed,Amb:null};const Xe=Ud.getBounds();yc=S-Ba.y;ib=uh.Xx.y7h(ib,yc,this.Isa,Sb,Ba,Xe);Ud.kba.appendChild(ib);return{returnValue:!0,
Z8d:yc,outlineGroupNode:ed,Amb:ib}}wNo(S,Ba){let ib=null;const Sb=Ba.De(this.lf.ic);var yc=0;let ed=null;if(this.V_d(S,Sb,Ba))return{returnValue:!1,fia:yc,outlineGroupNode:ib,Amb:ed};ib=uh.vPi(Ba);const Ud=ib.De(this.lf.ic);if(!Ud)return ma.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.lf.ic),{returnValue:!1,fia:yc,outlineGroupNode:ib,Amb:ed};yc=Ud.getBounds();yc=xm.a.Rq(Sb,S.CP).y-yc.y;ed=this.UXl(Ba);return{returnValue:!0,fia:yc,outlineGroupNode:ib,Amb:ed}}UXl(S){return S.De(this.lf.ic).htmlElement}NO(S){const Ba=
this.CI.Ihb(S);if(Ba!==$g.a.nil){const ib=this.vj.Db(Ba);if(ib)return ib}ma.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",S,Ba);return null}Dci(S,Ba){const ib=S.CP;let Sb=0,yc=null;const ed=Ba.De(this.lf.ic);if(this.V_d(S,ed,Ba))return{returnValue:!1,fia:Sb,GXf:yc};yc=ed.getBounds();Sb=ib?this.BWg(Object(sb.a)(134,ed),ib):yc.y-this.N3j(ed);return{returnValue:!0,fia:Sb,GXf:yc}}P5l(S,Ba){let ib=null,Sb=0;var yc=S.PageEndType;let ed=Jm.GraphIterator.$a(Ba);
ed.vd();if(!hg.TableReader.ex(ed))return ma.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",S.ParaId),{returnValue:({fia:Sb,GXf:ib}=this.Dci(S,Ba)).returnValue,fia:Sb,Hke:ib};if(1===yc){Rg.returnToContainingRow(ed);yc=ed.currentNode.De(this.lf.ic);if(this.V_d(S,yc,Ba))return{returnValue:!1,fia:Sb,Hke:ib};Sb=yc.getBounds().y}else{yc=Ba.De(this.lf.ic);if(this.V_d(S,yc,Ba))return{returnValue:!1,fia:Sb,Hke:ib};Sb=this.BWg(Object(sb.a)(134,
yc),S.CP)}--Sb;Ba=null;do S=Ba,Ba=ed.jd(14);while(Ba);ed=Jm.GraphIterator.$a(S);ed.vd();Rg.moveToFirstRow(ed);ib=ed.currentNode.De(this.lf.ic).getBounds();return{returnValue:!0,fia:Sb,Hke:ib}}V_d(S,Ba,ib){if(!Ba||Ba.gxa(16))return this.Voh(S,ib),!0;Ba=Ba.getBounds();return Ba.width||Ba.height?!1:(this.goh(S),!0)}goh(S){this.yXb.contains(S)||this.yXb.add(S)}Voh(S,Ba){Ba=Ba.id;let ib;({value:ib}=this.fXb.Dc(Ba)).returnValue||(ib=new lb.a,this.fXb.Z(Ba,ib));ib.add(S)}d9d(){const S=new lb.a;for(let Ba=
this.yXb.count-1;0<=Ba;Ba--){const ib=this.yXb.J(Ba);this.Z5f(ib)||S.add(ib)}this.yXb=S;this.N6e()}N6e(){this.KN&&this.KN.N6e()&&this.kGj(!1)}kGj(S){this.KN&&(this.KN.OQk(S)&&(this.xMe=!0),this.KN.x6n(),this.zbb.gGj(this.KN.iPc()),no.WoncaApp.instance.Kib&&uh.Myf&&this.KN.Mmg())}f9d(S,Ba){try{const ib=Ba.id;if(this.fXb.nb(ib)){const Sb=this.fXb.J(ib);for(S=0;S<Sb.count;S++)this.goh(Sb.J(S));this.fXb.remove(ib)}}catch(ib){}}p3d(){this.Isa&&(this.Isa=!1,uh.Xx.p3d())}o3d(){this.Isa||(this.Isa=!0,uh.Xx.o3d())}Uvo(){this.yMe=
!1;this.gia&&this.Mad(this.gia.toArray(),this.Isa);this.daa&&this.daa.Rrj()}Prm(){this.yMe=!0;uh.Xx.o9i();this.daa&&this.daa.mni();this.BZ&&this.BZ.Qrm()}dzd(S,Ba,ib,Sb,yc){const ed=this.gia.indexOf(Ba)+1;if(0>ed)return null;const Ud=ti.WordSectionNavigator.instance.EJ(S),Xe=this.jca(Ba,S);S=new Sg(ib,ed,S,Ba,yc,Ud,!S||!Ba||!yc,!1,!1,Xe);this.dXa.nb(Sb.id)||this.dXa.Z(Sb.id,new lb.a);this.dXa.J(Sb.id).add(S);return S}jca(S,Ba){if(!S||!S.HardBreak)return!1;S=Jm.GraphIterator.$a(Ba);S.zb(7);if(S.nJ())return!1;
S.jd(23);return S.nJ()?!1:!0}H7i(S){this.Isa&&(S.anchor&&S.pj?!(S=uh.vPi(S))||this.Wwb&&this.Wwb.customData&&this.Wwb.customData.id===S.id||(this.Wwb=Object.assign(new Qc.a(3,1,500,this.xSn),{customData:S}),this.Hb.Wb(this.Wwb)):ma.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}sce(){this.Isa&&!this.vsd&&this.gia&&0<this.gia.count&&(this.vsd=new Qc.a(3,1,500,this.wSn),this.Hb.Wb(this.vsd))}dispose(){this.lf&&this.IQh();this.IS.F5f(this.Aca);
this.vN.fde(this.jKb)}static get Myf(){null==uh.xDe&&(uh.xDe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return uh.xDe}static QXl(S){let Ba=0;try{const ib=S.htmlElement,Sb=mb.a.UM(ib.firstChild.style.marginTop);S=0;const yc=uh.Vsf(ib.parentNode);if(yc){const ed=yc.firstChild;ed&&ed.classList.contains("ParaWrappingDiv")&&(S=mb.a.UM(ed.firstChild.style.marginBottom))}Ba=Math.max(Sb,S)/2}catch(ib){}return Ba}static Vsf(S){let Ba=S.previousSibling;if(!Ba){var ib=S.parentNode;mb.a.eEf(ib)&&
(ib=ib.parentNode)&&(Ba=ib.previousSibling)}if(!Ba&&(S=S.parentNode,S.classList.contains("OutlineGroup")||ma.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",S.tagName,S.className),(S=S.previousSibling)&&S.hasChildNodes())){Ba=S.lastChild;do{if(Ba.classList.contains("OutlineElement")||mb.a.eEf(Ba)&&Ba.classList.contains(eh.a.Jcc))break;Ba=Ba.previousSibling}while(Ba)}if(Ba){if(Ba.classList.contains(eh.a.Jcc))return Ba.lastChild.lastChild;if(mb.a.eEf(Ba))return Ba.lastChild}return Ba}static vPi(S){S=
Jm.GraphIterator.$a(S);return S.zb(23)?S.jd(23):null}Aci(){return this.swe+1}}uh.Xx=null;uh.xDe=null;Object(f.a)(uh,"PageEndMarkers",null,[910,911,10]);var yf=c(141);class Xg{constructor(S,Ba,ib){this.Ywn=".Outline";this.yI=S;this.Wm=Ba;this.Xx=ib}get lf(){const S=this.yI.value;ma.ULS.shipAssertTag(38416594,336,S.Vi,"Invalid PageView.");return S}f7b(S){return(S=S.outlineNode)?this.qci(S):(ma.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}qci(S){let Ba,ib;return(Ba=S.De(this.lf.ic))&&
(ib=Ba.htmlElement)?ib.querySelector(this.Ywn):(ma.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}Y5h(S){S=wm.OutlineElementNavigator.Gl(S.paragraphNode);let Ba;return S&&(Ba=S.De(this.lf.ic))?Ba.htmlElement:(ma.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}Ezh(S,Ba){const ib=this.sim(S);return this.IQk(S,Ba)-ib}s7h(S){return this.wci(S.outlineNode,S.Eh)}wci(S,Ba){if(!S)return-1;var ib=S.ia(zl.a.nv,-1);ib=Fn.a.Mi(ib,1);var Sb=S.ia(zl.a.marginTop,
-1);Sb=Fn.a.Mi(Sb,1);S=S.ia(zl.a.marginBottom,-1);S=Fn.a.Mi(S,1);return 1===Ba?ib-S:ib-(Sb+S)}sjl(S){S&&mb.a.jx(S.Cmb)}Psf(S){if(S.pCi||S.jca)return 0;if(S.b3a)return S=this.f7b(S),ha.a.getElementBounds(S).height/this.Wm.hj;const Ba=this.f7b(S);return this.Xx.i5e(this.Bci(S),Ba)}L8k(S,Ba,ib){ib=ib.De(this.lf.ic).getBounds();S=S.De(this.lf.ic);const Sb=S.getBounds();ib.y=Sb.y;Ba=this.Xx.y7h(0,Ba*this.Wm.hj,!1,ib,ib,Sb);S.kba.appendChild(Ba);return Ba}Pri(S,Ba){if(S&&!S.GZd)if(S.b3a){if(S=this.f7b(S))S.style.paddingBottom=
Ba+"px"}else if(S.PU&&S.PU.HardBreak)if(S.jca){if(S=this.Rdi(S))S.style.paddingBottom=Ba+"px"}else{if(S=this.Y5h(S))S.style.paddingTop=Ba+"px"}else ma.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Uqh(S,Ba){Ba=this.f7b(Ba);S=this.f7b(S);return ha.a.ZDa(Ba)-ha.a.ZDa(S)}Sdi(S){S=Jm.GraphIterator.$a(S.outlineNode);S.zb(7);return S.nJ()}jzi(S){if(!S||S.GZd)return!1;if(S.b3a||S.pCi)return!0;S=this.Bci(S);return!!S&&mb.a.Y7(S)}nR(S){this.Xx.nR(S)}Rdi(S){return(S=
this.Sdi(S))?(S=S.Gj(this.lf.ic).htmlElement,S?S:(ma.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}Bci(S){return S.PU&&S.PU.HardBreak&&!S.jca?this.Xx.IQd(S.Cmb):S.Cmb}sim(S){if(S.b3a){S=this.f7b(S);if(!S)return ma.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;S=yf.a.uB(S);return mb.a.Oga(S.paddingBottom)}if(S.PU&&S.PU.HardBreak){if(S.jca)return(S=this.Rdi(S))?mb.a.Oga(S.style.paddingBottom):-1;S=this.Y5h(S);return S?mb.a.Oga(S.style.paddingTop):(ma.ULS.shipAssertTag(38336529,
336,!0,"Containing outline element Dom is null."),-1)}return 0}IQk(S,Ba){return this.Psf(S)-Ba}}Object(f.a)(Xg,"PageFullHeightDOMHelper",null,[]);class Pj{constructor(){this.delta=this.$Jj=this.By=0;this.eia=null;this.kOa=this.x2i=0;this.outlineGroupNode=null;this.YCa=0;this.EAf=new lb.a;this.iId=new lb.a;this.Lfn=new lb.a}}Object(f.a)(Pj,"PageFullHeightInfo",null,[]);class dk{constructor(S,Ba){this.dBa=S;this.Yx=Ba}Ozh(S,Ba){try{return this.FQk(S,Ba)}catch(ib){return this.Yx.nR(ib.message+" "+ib.stack),
ma.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",ib.message),null}}FQk(S,Ba){ma.ULS.shipAssertTag(38416596,336,S.b3a||S.PU.HardBreak);const ib=this.Yx.Psf(S),Sb=this.Yx.Ezh(S,Ba),yc=this.dBa.Bzh(S,Sb);S=Object.assign(new Pj,{YCa:Sb,kOa:yc,eia:S});this.ZUo(S);S.$Jj=S.kOa-S.YCa;S.delta=Ba+yc+S.delta-ib;return S}ZUo(S){S.YCa>S.kOa?this.$Uo(S):0>S.YCa&&this.nmg(S)}nmg(S){let Ba=S.eia.Eh;for(;0>S.YCa;)S.By--,S.delta-=this.dBa.UNc(Ba),S.YCa+=this.dBa.UNc(Ba-
1),Ba--;S.kOa=this.dBa.UNc(Ba)}$Uo(S){const Ba=this.Yx.s7h(S.eia);S.By=Math.floor((S.YCa-S.kOa)/Ba)+1;S.delta=S.By*Ba;S.YCa-=S.kOa+(S.By-1)*Ba;S.kOa=Ba}}Object(f.a)(dk,"PageFullHeightInfoCalculator",null,[]);class Vk{constructor(S,Ba,ib,Sb){this.tYa=0;this.AMa=null;this.dBa=S;this.bwb=Ba;this.IW=ib;this.Yx=Sb;this.ech=new lb.a}get EY(){return this.ech}inm(S){try{this.xwf(S)}catch(Ba){this.Yx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",
Ba.message)}}reset(S){try{this.P4n(S)}catch(Ba){this.Yx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",Ba.message)}}Qrm(){try{this.Rrm()}catch(S){this.Yx.nR(S.message+" "+S.stack),ma.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",S.message)}}tBm(S){try{this.uBm(S)}catch(Ba){this.Yx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",
Ba.message)}}MZn(S){try{this.NZn(S)}catch(Ba){this.Yx.nR("Pagination: "+Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",Ba.message)}}fym(){var S=this.IW.Qpf(),Ba=this.IW.Y$h();S=Sg.$$k(S);Ba=Sg.Z$k(this.tYa,Ba);this.EY.Z(0,S);this.xwf(Ba)}T4n(){var S=ti.WordSectionNavigator.instance.Y$h();(S=this.Yx.qci(S).parentNode)&&""!==S.style.minHeight&&(S.style.minHeight="")}dzm(S){this.ech=new lb.a;this.EY.add(null);
for(let Ba=0;Ba<S.length;Ba++){const ib=Sg.J3b(Ba+1,S[Ba]);this.EY.add(ib)}this.EY.add(Sg.J3b(S.length+1,null))}Pym(S){this.dBa.$4n(S)}y5n(){if(this.EY)for(const S of this.EY)S&&this.bxi(S)&&this.Yx.Pri(S,0)}xwf(S){const Ba=this.y8l(S);if(this.Yx.jzi(Ba)){let ib=this.Yx.Psf(Ba);S.outlineNode!==Ba.outlineNode&&(ib+=this.Yx.Uqh(S,Ba));this.OPk(S,ib);this.bxi(S)&&this.$5f(S,ib)}else this.AMa.add(S),20<this.AMa.count&&ma.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.AMa.count);
this.EY.Z(S.Eh,S);this.$mm(S)}Rrm(){this.y5n()}P4n(S){this.tYa=S.length+1;this.AMa=new lb.a;this.dzm(S);this.Pym(this.tYa);this.fym();this.T4n()}uBm(S){this.dBa.oWo(S);for(const Ba of S){if(!Ba){ma.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<Ba.By){S=Ba.eia.Eh;for(const ib of Ba.EAf)this.EY.insert(S,ib),S++}else if(0>Ba.By)for(const ib of Ba.iId)this.EY.remove(ib),this.AMa.contains(ib)&&this.AMa.remove(ib)}this.Bbj()}NZn(S){S=S.Eh;this.dBa.OZn(S);this.EY.removeAt(S);for(const Ba of this.AMa)Ba.Eh===
S&&this.AMa.remove(Ba);this.Bbj()}OPk(S,Ba){Ba=this.Yx.Ezh(S,Ba);this.dBa.Bzh(S,Ba)}$5f(S,Ba){S.PU&&S.PU.HardBreak||this.bwb.$5f(S,Ba)}$mm(S){S=S.Eh+1;for(const Ba of this.AMa)if(Ba&&Ba.Eh===S){this.xwf(Ba);this.AMa.remove(Ba);break}}Bbj(){for(let S=0;S<this.EY.count;S++){const Ba=this.EY.J(S);Ba&&Ba.Qge(S)}}bxi(S){S=this.I5l(S);return 2===S||1===S}y8l(S){return this.EY.J(S.Eh-1)}I5l(S){return S.b3a?2:S.PU&&S.PU.HardBreak?1:0}}Object(f.a)(Vk,"PageFullHeightManager",null,[925]);class tg{constructor(S,
Ba,ib,Sb){this.bwb=S;this.dBa=Ba;this.IW=ib;this.Yx=Sb}create(){return new Vk(this.dBa,this.bwb,this.IW,this.Yx)}}Object(f.a)(tg,"PageFullHeightManagerFactory",null,[]);var Nh=c(1091),ym=c(592);class ok{constructor(S,Ba,ib,Sb,yc){this.zXb=null;this.BZ=S;this.KN=Ba;this.syc=ib;this.bwb=Sb;this.Yx=yc}reset(){this.zXb=new lb.a}EQk(S,Ba,ib){try{return this.GQk(S,Ba,ib)}catch(Sb){return ma.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",
Sb.message),null}}u6n(){try{this.v6n()}catch(S){ma.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",S.message)}}GQk(S,Ba,ib){if(!this.BZ.EY.count)return null;const Sb=this.N5l(S,!S);if(!Sb||Sb.GZd)return ma.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Sb.PU&&Sb.PU.HardBreak)return null;var yc=this.BZ.EY.J(Sb.Eh-1);return this.Yx.jzi(yc)&&(Ba-=ib,Sb.outlineNode!==yc.outlineNode&&
(Ba+=this.Yx.Uqh(Sb,yc)),(yc=this.syc.Ozh(Sb,Ba))&&1<Math.abs(yc.delta))?(yc.x2i=Ba,yc.outlineGroupNode=this.w5l(S,Sb),this.zXb.add(yc),this.nmg(yc),yc):null}w5l(S,Ba){return Ba&&Ba.b3a?(S=Object(sb.a)(ym.a,vl.ParagraphReader.PD(Ba.outlineNode)),S=Jm.GraphIterator.$a(S),S.Ep(),Object(sb.a)(Nh.a,S.jd(23))):S&&S.Ajb?S.outlineGroupNode:null}v6n(){this.zXb.Sc((S,Ba)=>Ba.eia.Eh-S.eia.Eh);for(const S of this.zXb)this.bwb.nbj(S);this.rWo()}rWo(){this.KN.value.rBm(this.zXb);this.BZ.tBm(this.zXb)}N5l(S,Ba){return Ba?
this.BZ.EY.J(this.BZ.EY.count-1):this.BZ.EY.J(S.Eh)}nmg(S){let Ba=S.eia.Eh;const ib=-S.By;for(let Sb=0;Sb<ib;Sb++)Ba--,S.iId.add(this.BZ.EY.J(Ba))}}Object(f.a)(ok,"PageFullHeightPositionUpdater",null,[924]);class Gi{constructor(S,Ba,ib,Sb,yc){this.BZ=S;this.KN=Ba;this.syc=ib;this.bwb=Sb;this.Yx=yc}create(){return new ok(this.BZ,this.KN,this.syc,this.bwb,this.Yx)}}Object(f.a)(Gi,"PageFullHeightPositionUpdaterFactory",null,[]);class Rp{constructor(S,Ba){this.Yx=S;this.syc=Ba}$5f(S,Ba){try{this.J1n(S,
Ba)}catch(ib){this.Yx.nR(ib.message+" "+ib.stack),ma.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",ib.message)}}nbj(S){try{this.I1n(S)}catch(Ba){this.Yx.nR(Ba.message+" "+Ba.stack),ma.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",Ba.message)}}J1n(S,Ba){ma.ULS.shipAssertTag(38285913,336,S.b3a||S.PU.HardBreak);S=this.syc.Ozh(S,Ba);this.nbj(S)}I1n(S){this.H1n(S);this.A1n(S)}A1n(S){0<S.By?this.DBm(S):0>S.By&&
this.tjl(S)}H1n(S){this.Yx.Pri(S.eia,S.$Jj)}DBm(S){let Ba=S.x2i+S.kOa;for(let Sb=0;Sb<S.By;Sb++){var ib=S.eia.Eh+Sb;const yc=S.eia.jca?this.Yx.Sdi(S.eia):S.eia.outlineNode;ib=this.K8k(yc,S.outlineGroupNode,Ba,ib);S.EAf.add(ib);S.Lfn.add(Ba);Ba+=S.kOa}}tjl(S){for(const Ba of S.iId)this.Yx.sjl(Ba)}K8k(S,Ba,ib,Sb){Ba=this.Yx.L8k(S,ib,Ba);return Sg.M$e(ib,Sb,Ba,S,!1,!1)}}Object(f.a)(Rp,"PageFullHeightRenderer",null,[]);class Qn{constructor(S){this.z2f=S}}Object(f.a)(Qn,"PageHeightDeltaResult",null,[923]);
class Xn{constructor(S,Ba,ib){this.pq=null;this.Yx=S;this.si=Ba;ib.execute(Sb=>{Sb.register(this)})}get YYc(){return"PageHeightDelta"}get result(){return this.pq}get XQf(){return 1}get f9f(){return 500}get isEnabled(){return!0}fRf(){this.pq=null}BCa(S){this.si.he(()=>{try{this.AFc(S)}catch(Ba){ma.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",Ba.message)}},"PHDM:C")}AFc(S){this.pq=null;S=this.BFc(S);-1!==S&&(this.pq=new Qn(S))}BFc(S){if(!S.count)return-1;
let Ba=0,ib=0;for(const Sb of S)S=this.HQk(Sb),-1!==S&&(Ba+=S,ib++);return ib?Ba/ib:-1}HQk(S){if(!S.oJm)return-1;const Ba=this.Yx.wci(S.FBd,S.Eh);return-1===Ba?-1:Math.abs(S.height-Ba)}}Object(f.a)(Xn,"PageHeightDeltaMetric",null,[906]);class Rn{constructor(S){this.RVa=null;this.Yx=S}UNc(S){return this.RVa.J(S-1)}$4n(S){this.RVa=new lb.a;for(let Ba=0;Ba<S;Ba++)this.RVa.add(-1)}Bzh(S,Ba){if(this.xOm(S))return this.RVa.J(S.Eh-1);Ba=this.gQk(S,Ba);this.FCo(S,Ba);return Ba}oWo(S){for(const Ba of S)this.nWo(Ba)}FCo(S,
Ba){this.RVa.Z(S.Eh-1,Ba)}OZn(S){this.RVa.removeAt(S-1)}nWo(S){if(S)if(0<S.By){var Ba=S.eia.Eh;for(var ib=0;ib<S.By;ib++)this.RVa.insert(Ba,S.kOa)}else if(0>S.By)for(Ba=-S.By,S=S.eia.Eh-Ba,ib=0;ib<Ba;ib++)this.RVa.removeAt(S)}xOm(S){return-1!==this.RVa.J(S.Eh-1)}gQk(S,Ba){if(S.b3a||S.PU.HardBreak)S=this.Yx.s7h(S),Ba=Ba<S?S:Ba;return Ba}}Object(f.a)(Rn,"PageHeightStorage",null,[]);var Jp=c(110);class Dl{constructor(S){this.z2f=S}}Object(f.a)(Dl,"PageLevelDeltaResult",null,[923]);class $r{constructor(S,
Ba,ib,Sb){this.pq=null;this.yI=S;this.jta=Ba;this.si=ib;Sb.execute(yc=>{yc.register(this)})}get lf(){const S=this.yI.value;ma.ULS.shipAssertTag(39081438,336,S.Vi,"PageLevelDeltaMetric.PageView is not a PageView.");return S}get YYc(){return"PageLevelDelta"}get result(){return this.pq}get XQf(){return 0}get f9f(){return 60}get isEnabled(){return!0}fRf(){this.pq=null}BCa(S){this.si.he(()=>{try{this.AFc(S)}catch(Ba){ma.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",
Ba.message)}},"PLDM:C")}AFc(S){this.pq=null;S=this.BFc(S);-1!==S&&(this.pq=new Dl(S))}BFc(S){if(!S.count)return-1;let Ba=0,ib=0;for(const Sb of S)S=this.JQk(Sb),-1!==S&&(Ba+=S,ib++);return ib?Ba/ib:-1}JQk(S){if(S.Ajb)return-1;var Ba=S.PU.CP;S=S.paragraphNode;ma.ULS.shipAssertTag(39081441,336,!!S);S=S.De(this.lf.ic);ma.ULS.shipAssertTag(39081442,324,Object(Jp.a)(134,S));let ib;({BJh:Ba,gFi:S,Bej:ib}=this.wQk(S,mb.a.tA(S.htmlElement).length,Ba));return S&&ib?Math.min(Ba.x-S.x,ib.x-Ba.x):(ma.ULS.sendTraceTag(39081443,
336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}wQk(S,Ba,ib){let Sb,yc,ed,Ud=yc=ib,Xe=ed=Sb=null;if(ib>Ba)return ma.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{BJh:Xe,nYm:Ud,gFi:ed,d8n:yc,Bej:Sb};Xe=this.jta.Rq(S,ib);for(var Ue=0,Kf=ib;Ue<=Kf;){const Bg=Math.floor((Ue+Kf)/2),Vh=this.jta.Rq(S,Bg);if(Ue===Kf){Ud=Bg;ed=Vh;break}Vh.y+Vh.height<=Xe.y?Ue=Bg+1:Kf=Bg}for(;ib<=
Ba;){Ue=Math.ceil((ib+Ba)/2);Kf=this.jta.Rq(S,Ue);if(ib===Ba){yc=Ue;Sb=Kf;break}Kf.y>=Xe.y+Xe.height?Ba=Ue-1:ib=Ue}return{BJh:Xe,nYm:Ud,gFi:ed,d8n:yc,Bej:Sb}}}Object(f.a)($r,"PageLevelDeltaMetric",null,[906]);class as{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.Eh=S;this.top=Ba;this.Hlh=ib;this.height=Sb;this.cQb=yc;this.FBd=ed;this.oJm=Ud}}Object(f.a)(as,"Page",null,[]);class Sn{constructor(S,Ba,ib,Sb,yc){this.tXb=null;this.thh=0;this.yI=S;this.vhd=Ba;this.e$g=ib;this.ALa=Sb;this.g$g=yc;this.fXa=new lb.a}get lf(){const S=
this.yI.value;ma.ULS.shipAssertTag(37007393,336,S.Vi,"PageManager.PageView is not a PageView.");return S}get Vk(){return this.fXa}gGj(S){S=this.H6i(S);this.iGj(S)}lWo(S,Ba){this.thh=Ba;S=this.H6i(S);this.iGj(S);this.g$g.isEnabled&&this.g$g.BCa(S)}H6i(S){this.fXa=new lb.a;this.tXb=new eg.a(0);const Ba=new lb.a;if(!S)return this.Vk;var ib=0,Sb=null;for(let yc=0;yc<S.count;yc++){const ed=S.J(yc);ib=ed.Eh;Sb=this.IGd(ib,Sb,ed);this.Vk.add(Sb);!Sn.xKe&&0>Sb.height&&Ba.add(Sb);Sb=ed}S=this.IGd(ib+1,Sb,
null);this.Vk.add(S);!Sn.xKe&&0>S.height&&Ba.add(S);for(const yc of Ba)Sn.xKe=!0,ma.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+yc.Eh);return this.Vk}IGd(S,Ba,ib){const Sb=Ba?Ba.outlineNode:this.ALa.F8h(),yc=ib?ib.outlineNode:this.ALa.fai();var ed=this.xci(Sb);const Ud=this.xci(yc),Xe=Ba?this.Lzh(Ba):0;ed=Xe+ed;const Ue=ib?this.Lzh(ib):this.vhd.Q4a.clientHeight-Ud;return new as(S,Xe,ed,Sb.id===yc.id?Ue-Xe:Ue+Ud-ed,Sb,yc,(ib?ib.Eh:this.thh+1)===(Ba?Ba.Eh:
0)+1)}Lzh(S){return S.jca?0:S.top}iGj(S){if(this.e$g.Y8d)for(const Ba of this.e$g.Y8d)Ba&&Ba.jGj(S)}xci(S){this.tXb||(this.tXb=new eg.a(0));if(this.tXb.nb(S.id))return this.tXb.J(S.id);var Ba=S.De(this.lf.ic);if(!Ba)return ma.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;Ba=ha.a.s1a(this.vhd.Q4a,Ba.htmlElement).y;this.tXb.Z(S.id,Ba);return Ba}}Sn.xKe=!1;Object(f.a)(Sn,"PageManager",null,[908]);var mn=c(619);class Bh{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.Ing=
this.R4a=!1;this.ga=S;this.Sea=Ba;this.ATb=ib;this.Rt=Sb;this.Ti=yc;this.i$g=ed;this.JN=Ud;this.R4a=0===this.JN.Wu?!0:!1;this.iSf=this.iSf.bind(this);this.JN.Aph(this.iSf)}Tb(){this.ga.fb(Cf.a.W2c,Ji.a.application,this.W2c.bind(this),96);this.ga.fb(Cf.a.ybe,Ji.a.application,this.ybe.bind(this),96);this.ga.fb(Cf.a.Jle,Ji.a.application,this.Jle.bind(this),96);this.ga.fb(Cf.a.Gle,Ji.a.application,this.Gle.bind(this),8)}Jle(S,Ba,ib){return 1===ib?32:this.ga.processAction(Cf.a.r7a,2)}Gle(S,Ba,ib,Sb){if(1===
ib)return 0===this.JN.Wu?32:8;this.R4a?(this.ERh(),this.Ing=!0):(this.gVh(),this.Ing=!1);this.Ti.updateCommandUI();Sb.ns=this.R4a?1:0;return 32}W2c(S,Ba,ib,Sb,yc){if(1===ib)return 32;S=this.i$g.O8b();-1===S?S="":this.R4a||1===this.JN.Wu?(Ba=this.i$g.pSl(),Ba>S&&(S=Ba),S=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,Ba,S)):S=1===S?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,S):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,S);yc[mn.a.Visible]=
!0;yc[mn.a.LabelText]=S;return 32}ybe(S,Ba,ib,Sb,yc){if(1===ib)return 32;yc[bk.a.On]=this.R4a;return 32}iSf(S,Ba){0!==Ba.Alb||this.Ing?this.ERh():this.gVh()}gVh(){this.R4a||(this.ATb.ntl(),this.Rt.Uvo(),this.R4a=!0)}ERh(){this.R4a&&(this.ATb.Qml(),this.Rt.Prm(),this.R4a=!1)}}Object(f.a)(Bh,"PaginationActor",null,[]);class Gn{constructor(S){this.z2f=S}}Object(f.a)(Gn,"PaginationDeltaResult",null,[923]);class $p{constructor(S,Ba){this.zwb=this.Cid=null;this.si=S;Ba.execute(ib=>{ib.register(this)})}get YYc(){return"PaginationDelta"}get result(){return this.Cid}get XQf(){return 1}get f9f(){return 200}get isEnabled(){return!0}fRf(){this.Cid=
null}BCa(S){this.si.he(()=>{try{this.AFc(S)}catch(Ba){ma.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",Ba.message)}},"PDM:C")}kgg(S){this.zwb=S}AFc(S){this.Cid=null;S=this.BFc(this.zwb,S);-1!==S&&(this.Cid=new Gn(S))}BFc(S,Ba){if(!(S&&Ba&&S.count&&Ba.count))return-1;const ib=new lb.a;for(const Sb of S)ib.add(Sb.top);S=new lb.a;for(const Sb of Ba)S.add(Sb.top);Ba=this.ZLd(ib,S);return this.Z2b(Ba)}Z2b(S){if(!S.count)return 0;let Ba=0;for(let ib=
0;ib<S.count;ib++)Ba+=S.J(ib);return Ba/S.count}ZLd(S,Ba){const ib=new lb.a;if(!S.count||!Ba.count)return ib;var Sb=S.count<=Ba.count;const yc=Sb?S:Ba;S=Sb?Ba:S;for(Ba=0;Ba<yc.count;Ba++){Sb=yc.J(Ba);let Ud=Math.abs(Sb-S.J(0)),Xe=0;for(let Ue=1;Ue<S.count;Ue++){var ed=S.J(Ue);ed=Math.abs(Sb-ed);ed<Ud&&(Ud=ed,Xe=Ue)}ib.add(Ud);S.removeAt(Xe)}return ib}}Object(f.a)($p,"PaginationDeltaMetric",null,[906]);var ig=c(382),vo=c(1401),oj=c(2032);class Jo extends ig.a{constructor(S,Ba,ib,Sb,yc,ed,Ud,Xe=null){super();
this.GN=null;this.rwe=0;this.tYa=-1;this.Ltb=!1;this.tY=()=>{ma.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.GRh()};this.KTf=()=>{if(0==this.IS.Wu){var Ue=this.GN.Bt;$g.a.Zp(Ue,this.CWb)||(this.CWb=Ue,this.apn(this.bLa,this.CWb))}};this.IS=S;this.Aca=this.Aca.bind(this);this.IS.gzb(this.Aca);this.ga=Ba;this.Rt=ib;this.kZ=Sb;this.bla=yc;this.vIe=Xe||Ik.a.instance;this.CWb=this.bLa=$g.a.nil;this.P9j=Ud;ed.CWR(()=>ed.result.ZB.NMa(this.tY));this.E4b();
this.ek=new vo.a(1E3);this.ek.E_a();this.bla.register(this)}get Pha(){return"Pagination"}get Dff(){return this.P9j.value}get $Wm(){return this.bLa}get iIa(){return this.tYa}loo(S){this.tYa!==S&&(this.tYa=S,this.kZ.zmg())}Aca(){this.bLa=this.CWb=$g.a.nil;this.E4b()}E4a(S){this.GN=S;this.GN.u0b(this.KTf);this.d0b(this.GN.node)}apn(S,Ba){$g.a.Zp(S,Ba)?(this.Rt.o3d(),this.E4b()):(this.Rt.p3d(),this.sBo())}wtl(){this.enabled=2}E4b(){this.enabled=0}sBo(){this.rwe=0;this.wtl();this.aF(null,null,null)}Sna(){return cb.App.lostSession||
cb.App.qd.ZB.Ao?!1:!!(this.enabled&2)&&this.ek.KX()}aF(){this.ek.Ngb();this.bla.ZU()}forceOutbound(){}V3(){return 0===this.enabled?!1:this.ee&&2===this.ee.status?!0:this.Sna()}wSa(){if(1===this._state)this.ee.Dq=oj.a.Zaa(l.AFrameworkApplication.rootQuerySignature,this.bLa),this.ee.HG="Pagination",this.ee.status=1,this._state=3;else if(3===this._state&&this.ee&&2===this.ee.status)if(l.AFrameworkApplication.Lk)this._state=4;else if(this.ek.q1(),this.ek.x8(),this._state=1,this.rwe++,2!==this.ee.statusCode)this.F4b();
else if(1!==(this.ee.Dj?this.ee.Dj.length:0))this.F4b();else{var S=this.ee.Dj[0];this.vIe.dUa(S);104===S.StatusCode?this.GRh():101===S.StatusCode?this.F4b():3===S.StatusCode?this.F4b():S.StatusCode?this.F4b():S.PageEnds?(this.loo(S.PageEnds.length+1),this.bLa=qf.b(S.LastKnownPaginationRevision),ma.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.tYa,this.bLa),this.Rt.Mad(S.PageEnds,
$g.a.Zp(this.bLa,this.CWb)),this.Dff.gia=S.PageEnds,this.kZ.c5e(),ma.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.tYa,this.bLa),this.$ml()):this.F4b()}}GRh(){this.GN&&this.GN.OMb(this.KTf);this.E4b()}F4b(){60<this.rwe&&this.E4b()}$ml(){$g.a.Zp(this.bLa,this.CWb)&&this.E4b()}dispose(){this.GN&&(this.GN.OMb(this.KTf),this.GN.node&&this.Z3c(this.GN.node),this.GN=null);this.IS.F5f(this.Aca)}d0b(S){S&&
(S.addListener(this),this.Ltb=!0)}Z3c(S){this.Ltb&&S&&(S.removeListener(this),this.Ltb=!1)}tKb(S){this.Z3c(S)}onBeforeLoadContent(){}onAfterLoadContent(S){(S=S.od.jm)&&this.Sln(this.bLa,S.id)}onAfterFirstSaveContent(){}Sln(S,Ba){$g.a.Zp(S,Ba)&&this.Rt.o3d()}}Object(f.a)(Jo,"PaginationReplicator",ig.a,[897,10,91]);class rq{constructor(){this.daa=this.Rt=this.kZ=this.ATb=this.xv=null;this.xsa=!1;this.mCk=()=>{this.Wrh()}}get name(){return"WordEditor.Pagination"}xc(S){this.W=S;this.ld=this.W.resolve("Box4.IFeatureHelper");
this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new Z(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new rl(new jb.a(()=>cb.App.xa.hb.rc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new Sn(new jb.a(()=>cb.App.xa.hb.rc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();this.W.ha("WordEditor.IPaginationReplicator",()=>new Jo(this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),nh.App.e1,
cb.App.Pna(),new jb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new jn(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new $r(new jb.a(()=>cb.App.xa.hb.rc),this.W.resolve("Box4.ITextMetricsAdapter"),He.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",
()=>new Xn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),He.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",()=>new $p(He.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new Rn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",
()=>new Xg(new jb.a(()=>cb.App.xa.hb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new dk(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Rp(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),
this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Gi(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Ue("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new sc(new jb.a(()=>cb.App.xa.hb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
cb.App.Tj.zl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new tg(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),ti.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();
this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new gc(this.W.resolve("Common.IZoomManager"),He.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();this.W.ha("WordEditor.Pagination.PaginationActor",()=>new Bh(l.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),
this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new Oj(new jb.a(()=>cb.App.xa.hb.rc),Zp.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new Gg(l.AFrameworkApplication.va,co.a.instance,kl.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new jb.a(()=>cb.App.xa.hb.rc),this.W.Na("Box4.CpConversionManagerImpl"),
this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.Rt=new uh(new jb.a(()=>cb.App.xa.hb.rc),new jb.a(()=>cb.App.xa.hb.Uc.od),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),xm.a.QOc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),kl.a.instance,uh.QXl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Tk.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();
this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new qb(this.W.Sa("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!cb.App.instance&&cb.App.instance.WC)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new Zm(l.AFrameworkApplication.pc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Ij(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();
this.W.ha("WordEditor.Pagination.PageAdornmentManager",()=>this.daa=new aj(new jb.a(()=>cb.App.xa.hb.rc),Hq.a.instance,Uk.a.instance,Qe.a.instance,l.AFrameworkApplication.va,Qp.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),kl.a.instance,l.AFrameworkApplication.K,!!cb.App.instance&&cb.App.instance.WC,!!cb.App.instance&&cb.App.instance.Doa)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.ld.Lp.continueWith(()=>
{this.jn()})}jn(){const S=cb.App.xa.hb;S.vwa?this.Wrh():S.ifa(this.mCk)}Wrh(){this.xsa||(this.xsa=!0,this.ATb=va.a.instance.resolve("WordEditor.ICurrentPageManager"),this.kZ=va.a.instance.resolve("Common.ICurrentPageCalculator"),this.xv=va.a.instance.resolve("WordEditor.IPaginationReplicator"),va.a.instance.resolve("WordEditor.Pagination.PaginationActor").Tb())}dispose(){this.daa&&(this.daa.dispose(),this.daa=null);this.Rt&&(this.Rt.dispose(),this.Rt=null);this.xv&&(this.xv.dispose(),this.xv=null);
this.kZ&&(this.kZ.disable(),this.kZ=null);this.ATb&&(this.ATb=null)}}Object(f.a)(rq,"PackageManager",null,[1,2]);class Kq{constructor(){this.W=null}xc(S){this.W=S||va.a.instance}dispose(){}}Object(f.a)(Kq,"TellMePackage",null,[1,2]);var sq=c(1494),aq=c(1496),tq=c(344),rn=c(1493),Zo=c(1389);class Ha{constructor(S=null,Ba=null,ib=null,Sb,yc=null){this.$re=null;this.EKg=!1;this.OUg=this.rSb=null;this.ijk=this.sfh=this.PVj=this.PUg=!1;this.bgd=null;this.cWj=null==Ba?l.AFrameworkApplication.zzb:Ba;this.G6j=
null==ib?l.AFrameworkApplication.Q_:ib;this.Rjk=null==yc?l.AFrameworkApplication.S6a:yc;this.g5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.Blk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.joo(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.slk=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.$Vc;this.tlk=!rn.a.voa()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.rlk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.f2j=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.GOb;this.ulk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.Oik=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.fdk=this.P7c||this.O7c;this.ddk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.edk=this.sEf;this.R8j=!!l.AFrameworkApplication.K&&this.JTa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.E3j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.j4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.s3j=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.O8j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.c7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&rn.a.sha();
this.eZb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.zkk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.o4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.Pik=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.Cjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.ejk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.sP;this.a9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.p8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.H8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.Y8j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.l9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.QVj=this.JTa&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.N4j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",
!1);this.Ijk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==l.AFrameworkApplication.K.jb("Application"));this.tXj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.qnk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.f7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.j7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.i4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.$8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.QSm;this.h7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.i7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.g7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.q1j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.r1j=
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.vlk=this.bCi&&(this.wWf||this.xWf||this.b0c||this.JTa&&rn.a.sha()&&!!l.AFrameworkApplication.K&&(this.ujc||this.MOb||this.NOb||this.OOb||this.QOb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.PUj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.qCa;this.QUj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.Qxm(S||{});this.KQe="2918242107";this.JQe="1454393937";this.kwb={};this.Tcb=[];this.C5k=[rn.a.yme]}get application(){return this.rSb}get zzb(){return this.cWj}get Eao(){return this.KQe}get Dao(){return this.JQe}get Vjf(){return this.OUg}get FZh(){return this.PUg}get Q_(){return this.G6j}get S6a(){return this.Rjk}get uzb(){return this.PVj}get wrm(){return this.g5j}get kHo(){return this.Blk}get bCi(){return!0}get aHo(){return this.vlk}get fro(){return this.sfh}joo(S){this.sfh=
S}get JTa(){return this.slk}get W9c(){return this.tlk}get U9c(){return this.rlk}get fAl(){return this.f2j}get ZGo(){return this.ulk}get dme(){return!1}get b0c(){return this.fdk}get wWf(){return this.ddk}get xWf(){return this.edk}get q3a(){return!1}get w_d(){return!1}get eGf(){return this.R8j}get Zhe(){return this.ijk}get ujc(){return!1}get Lso(){return!1}get mYm(){return""}get Crf(){return 2}get r9l(){return 4}get s9l(){return 5}get Jfi(){return""}get qVl(){return this.E3j}get $fi(){return this.j4j}get Lfi(){return 1E3}get Kfi(){return 1E-6}get vDo(){return this.zkk}get Igg(){return!1}get awj(){return!1}get EQm(){return this.H8j}get f_d(){return!1}get g_d(){return!1}get Byi(){return!1}get Ayi(){return!1}get QSm(){return!1}get cCi(){return!1}get OLd(){return!1}get Job(){return!1}get MOb(){return!1}get NOb(){return!1}get OOb(){return!1}get QOb(){return!1}get P7c(){return this.Oik}get pjc(){return this.Pik}get O7c(){return!1}get Gof(){return null}get $Zd(){return!1}get She(){return this.ejk}get Ubi(){return 0}get lPl(){return this.s3j}get Ggi(){return this.o4j}get JRm(){return this.O8j}get gXd(){return this.c7j}get Rhe(){return this.eZb}get g3l(){return-3.9}get sP(){return this.Cjk}get aWc(){return this.a9j}get EEf(){return this.p8j}get yGf(){return this.Y8j}get Gdb(){return this.QVj}get PUm(){return this.l9j}get Yva(){return this.N4j}get Xsj(){return this.Ijk}get tLk(){return this.tXj}get doe(){return this.qnk}get kXd(){return this.f7j}get FEm(){return this.j7j}get dv(){return this.i4j}get kkb(){return this.$8j}get DEm(){return this.h7j}get EEm(){return this.i7j}get CEm(){return this.g7j}get bzk(){return this.PUj}get czk(){return this.QUj}get dga(){return this.q1j}get NJd(){return this.r1j}get PHb(){return!!l.AFrameworkApplication.ta&&
l.AFrameworkApplication.ta.Nb.$q}get $q(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.$q}get lNm(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.sjc}get ggn(){return Pe.getImageClass("OfficeAssistant_32x32x32")}aPd(){return Promise.reject("GetFindMatchCount method is not overridden")}M_d(S){return Array.contains(appChrome.selectors.getVisibleControlIds(),S)}VXd(){return!1}get nZd(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get Oxj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.jb("TellMeServiceHelpClassifierModelName"):""}get sEf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get PFb(){return"NoOpHeaderUi"}get v5k(){return this.bgd}get parameterData(){return this.kwb}get nOo(){return this.Tcb}Rvl(){if(this.$re&&!this.EKg&&(this.EKg=!0,this.Aob(this.$re),this.$q)){var S=va.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");S=(new Zo.a(S)).rNd(this.$re.UG);appChrome.api.dispatch(S)}}get o9f(){return""}Aob(){}Hll(S){const Ba=
[];for(let ib=0;ib<S.length;++ib)S[ib].Gto?Ba.push(new tq.a(S[ib].alternate,rn.a.nCj+ib.toString())):Ba.push(new tq.a(S[ib].standard,rn.a.yme+ib.toString()));return Ba}Qxm(S){const Ba={};for(let ib in S){const Sb=ib,yc=S[ib];for(let ed in yc){const Ud=ed,Xe=yc[ed];(Ba[Ud]||(Ba[Ud]={}))[Sb]=Xe}}this.bgd=Ba}get Pxj(){return""}get Nrj(){return!1}}Object(f.a)(Ha,"TellMeApplicationData",null,[1420]);class Hb{constructor(S,Ba=null,ib=!1){this.standard=S;this.alternate=Ba;this.Gto=ib}}Object(f.a)(Hb,"TryQuerySet",
null,[]);class ic{constructor(){this.H6g=this.I6g=null}get Edn(){return this.H6g}Tfa(S){this.I6g=S;return this.Gaf(S)}nhn(){this.H6g=this.I6g}VPd(S){return 8===S.type?String.format(CommonUIStrings.l_FindInDocumentText,S.aD):S.aD}fof(S){return S.aD}}Object(f.a)(ic,"ParameterizedCommand",null,[]);class Hc extends ic{constructor(S){super();this.LVc=S}get commandId(){return this.LVc?"DefinitionsParameterized":"DefinitionButton"}get UXf(){return"Definition"}Gaf(S){const Ba=Sa.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
S.aD));return ue.a(rn.a.vbf(S.value),n.a.Ycf.toString(),Ba,rn.a.GAf,null,Sa.a.Af(rn.a.uBb(S.aD)),Ba,null,null)}VPd(S){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,S.aD)}fof(S){return rn.a.uBb(S.aD)}}Object(f.a)(Hc,"DefinitionsParameterizedCommand",ic,[]);class id extends ic{constructor(S){super();this.LVc=S}get commandId(){return this.LVc?l.AFrameworkApplication.ta.Nb.DJm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get UXf(){return"Find"}Gaf(S){const Ba=
Sa.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,S.aD));return ue.a(rn.a.vbf(S.value),n.a.findInDocument.toString(),Ba,"Find_16x16x32",null,Sa.a.Af(S.aD),Ba,null,null)}VPd(S){return String.format(CommonUIStrings.l_TextWithQuotation,S.aD)}}Object(f.a)(id,"FindParameterizedCommand",ic,[]);class ae extends ic{constructor(S){super();this.LVc=S}get commandId(){return this.LVc?"SynonymsParameterized":"SynonymButton"}get UXf(){return"Synonym"}Gaf(S){const Ba=Sa.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
S.aD));return ue.a(rn.a.vbf(S.value),n.a.Ycf.toString(),Ba,rn.a.GAf,null,Sa.a.Af(rn.a.uBb(S.aD)),Ba,null,null)}VPd(S){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,S.aD)}fof(S){return rn.a.uBb(S.aD)}}Object(f.a)(ae,"SynonymsParameterizedCommand",ic,[]);var bf=c(2041),re=c(1955),Ef=c(2072),Bf=c(2036),ii=c(2037),Jg=c(1578);class Ia extends bf.a{constructor(){super(...arguments);this.NN=null;this.qYa=re.FindManager.createInstance(this,Ef.a.instance,Jg.a.instance,
!0,!0)}static get instance(){return Ia._instance}d6b(){this.NN(this.qYa.Kj.qja);this.qYa.DZa(!0)}aPd(S){const Ba=new Promise((ib,Sb)=>{this.NN=ib;setTimeout(()=>{Sb("Find manager execution timed out");this.qYa.DZa(!0)},500)});S=Bf.a.createQuery(S,ii.a.none);this.qYa.find(S);return Ba}}Ia._instance=new Ia;Object(f.a)(Ia,"TellMeFindStatusSpy",bf.a,[]);class Za extends Ha{constructor(S){super({});this.rSb="Word";this.R3j=S;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.PUg=!0,this.OUg=
this.OLd?"FindWithMatchesParameterized":"FindParameterized");S=new Hc(this.PHb);const Ba=new ae(this.PHb);this.parameterData[S.commandId]=S;this.parameterData[Ba.commandId]=Ba;S=new id(this.PHb);this.parameterData[S.commandId]=S;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(S=[new Hb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Hb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Hb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Hb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Hb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.Tcb=this.Hll(S))}aPd(S){return Ia.instance.aPd(S)}get W5a(){return Ro.AppFrame.aqa}get PFb(){return Ro.AppFrame.vPa}get o9f(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Aob(S){var Ba=l.AFrameworkApplication.K;S=S.UG;S.WordCountFlyout=!this.R3j();S.SelectAllButton=!Ba.$("TellMeSelectAllResultIsEnabled");const ib=Ba.$("TellMeDesktopUpSellIsEnabled");let Sb=l.AFrameworkApplication.x_d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Sb));Sb=!1;S.TextBoxUpSellButton=!ib||Sb;S.TableOfContentsUpSellButton=!ib||Sb;S.SmartArtUpSellButton=!ib||Sb;S.WordArtUpSellButton=!ib||Sb;S.MultiColumnLayoutUpSellButton=!ib||Sb;S.InsertEquationUpSellButton=!ib||Sb;S.TrackChangesUpSellButton=!ib||Sb;S.ShapesUpSellButton=!ib||Sb;S.LabelsUpSellButton=!ib||Sb;S.InsertCitationUpSellButton=!ib||Sb;S.TextBoxUpSellButtonEnterprise=!ib||!Sb;S.TableOfContentsUpSellButtonEnterprise=
!ib||!Sb;S.SmartArtUpSellButtonEnterprise=!ib||!Sb;S.WordArtUpSellButtonEnterprise=!ib||!Sb;S.MultiColumnLayoutUpSellButtonEnterprise=!ib||!Sb;S.InsertEquationUpSellButtonEnterprise=!ib||!Sb;S.TrackChangesUpSellButtonEnterprise=!ib||!Sb;S.ShapesUpSellButtonEnterprise=!ib||!Sb;S.LabelsUpSellButtonEnterprise=!ib||!Sb;S.InsertCitationUpSellButtonEnterprise=!ib||!Sb;Ba=!Ba.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.Q_;S.SynonymButton=Ba;S.DefinitionButton=Ba}get Pxj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get Igg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get Oxj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get ujc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get sEf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get Crf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Nrj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get w_d(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get nZd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get f_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get g_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get Lfi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get Kfi(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get Byi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get Ayi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get Jfi(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get cCi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get Ubi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get bCi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get dme(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get q3a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Zhe(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get awj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get $Zd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get MOb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get NOb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get OOb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get QOb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Gof(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(Za,"WordEditorTellMeApplicationData",Ha,[]);var tb=c(1530),nc;(function(S){S[S.none=0]="none";S[S.waitAll=1]="waitAll";S[S.synchronizeFast=2]="synchronizeFast";S[S.synchronizeSlow=3]="synchronizeSlow"})(nc||(nc={}));Object(f.b)("ProviderSynchronizationType",nc);var Cc;(function(S){S[S.immediate=0]="immediate";S[S.waitAll=1]="waitAll";S[S.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";S[S.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Cc||
(Cc={}));Object(f.b)("MenuUpdatePolicy",Cc);var Zc=c(1500),wd=c(1497),Rd=c(1634),Ke=c(1501),Df=c(1524),Oh=c(111),rk=c(288);class xg extends bf.a{constructor(S){super();this.rok=S}d6b(){this.rok.update()}}Object(f.a)(xg,"TellMeFindStatusManager",bf.a,[]);class Hi{constructor(S){this.Mcb=this.gNg=null;this.ii=0;this.old="TellMeWAC.";const Ba=S.Vjf;this.fc=S;this.Kid=Ba;this.mIe=Object.assign(new tb.a,{landingTab:"Indoc",data:null});S=new xg(this);this.qYa=re.FindManager.createInstance(S,Ef.a.instance,
Jg.a.instance,!0,!0)}aL(){return"WordFindInDocument"}eU(){return this.fc.Crf?this.fc.Crf===Cc.waitAll?nc.waitAll:nc.synchronizeSlow:nc.none}QH(S,Ba){this.bUm(S)?(this.Mcb=S,this.gNg=Ba,S=Bf.a.createQuery(S.Dg,ii.a.none),this.ii=window.performance.now(),this.qYa.find(S)):Ba.resultsUpdated(new Zc.a(S))}update(){this.Ado(Math.round(window.performance.now()-this.ii));var S=String.format(CommonUIStrings.l_TextWithQuotation,this.Mcb.Dg);var Ba=l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.Job?
rn.a.JNa(this.Mcb.Dg,15,this.mIe):Sa.a.Af(this.Mcb.Dg);const ib=[];ib.push(appChrome.actions.setControlLabel(this.Kid,S));ib.push(appChrome.actions.setCompoundButtonCommandValueId(this.Kid,Ba));ib.push(appChrome.actions.updateCompoundButtonDescription(this.Kid,this.Yuf()));appChrome.api.dispatch(ib);S=new wd.a(this.Kid,Rd.a.FindInDocument,this.Mcb.Dg,this.qYa.Kj.qja.toString());Ba=new Ke.a(Df.a.FindInDocument);Ba.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Ba.Nw(S);const Sb=new Zc.a(this.Mcb);
Sb.Uu(Ba);window.requestAnimationFrame(()=>{this.gNg.resultsUpdated(Sb)});this.qYa.DZa(!0);this.Cdo(Math.round(window.performance.now()-this.ii))}Yuf(){const S=this.qYa.Kj.qja.toString();return"1"===S?String.format(CommonUIStrings.l_SearchResultText,S):String.format(CommonUIStrings.l_SearchResultsText,S)}bUm(S){return!!S&&!!S.Dg&&""!==S.Dg.trim()}Ado(S){const Ba={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.Mcb.Dg.length};this.sendActivityEvent(Ba,S)}Cdo(S){const Ba={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Mcb.Dg.length};this.sendActivityEvent(Ba,S)}sendActivityEvent(S,Ba){S=Oh.a.yC(S);Ne.a.pHa(Object.assign(new rk.a,{name:"Latency",dataFields:S,durationMs:Ba}),this.old)}}Object(f.a)(Hi,"WordFindInDocumentWithMatchesProvider",null,[942]);class Qj{constructor(S,Ba){this.oc=S;this.KWd=
Ba}q2a(S,Ba,ib){return this.KWd.q2a(0,S,Ba,ib)}insertHtmlText(S){return S?32===this.iAf(S):!1}iAf(S){return this.executeCommand(Lg.a.nCa,S)}executeCommand(S,Ba){const ib=new On.DictionaryPropertySet;ib.setValue(Cl.a.jP,Ba);ib.setValue(Cl.a.Nia,!1);Ba=this.oc.processAction(S,1);32===Ba&&(Ba=this.oc.Qb(S,2,ib));return Ba}}Object(f.a)(Qj,"WordInsertContentHandler",null,[896]);class ek extends Kq{constructor(){super();this.Mx=()=>{if(l.AFrameworkApplication.lig){var S=cb.App.xa.Nb.Qtf(n.a.tellMe);S.NTc?
this.g1i():S.UZ(this.kao);var Ba=new Za(()=>!1);sq.TellMeActor.instance.initialize(Ba,null,null,null,null,null,Object(a.a)(cb.App.xa,cb.App.xa.XMd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"));sq.TellMeActor.instance.hTn(S);sq.TellMeActor.instance.iVn(new Qj(l.AFrameworkApplication.va,this.W.Na("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
Ba.FZh&&Ba.OLd&&sq.TellMeActor.instance.EE(new Hi(Ba),aq.a.tellMe)}};this.kao=()=>{this.g1i()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Po(this.Mx)}g1i(){cb.App.xa.updateCommandUI()}}Object(f.a)(ek,"WordEditorTellMePackage",Kq,[]);class tf{constructor(){this.W=null;this.Rxj=(S,Ba,ib)=>{2===ib&&(S=new ec.StandardDialog,S.Ad=0,S.cja(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>
{this.jn()})}dispose(){}jn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(126)){l.AFrameworkApplication.va.fb(Cf.a.wordTestFeature,Ji.a.view,this.Rxj,96);var S=di.FocusManager.instance().fe(Ro.AppFrame.YE);Bd.AFrame.Ai(S,of.KeyInputManager.kc(ak.a.G8a,5|of.KeyInputManager.Sh),Cf.a.wordTestFeature)}}xc(S){this.W=S}static main(){L.a.instance.Fc(new tf)}}Object(f.a)(tf,"WordEditorTestFeaturePackage",null,[1,2]);var Te=c(104);class df{constructor(S,Ba){this.ifj=S;this.oc=Ba;this.yfe=(ib,
Sb,yc,ed,Ud)=>{if(1===yc)return 32;this.ifj.aN(9,Ud,!1);return 32};this.x0=(ib,Sb)=>{if(9===Sb.type){var yc;(ib=Sb.wL)?("string"===typeof ib?yc=ib:"data"===ib.type&&(yc=Te.a.zMh(ib.RFn,ib.newState,ib.moo)),yc&&df.CDc(yc)):ma.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.B3c()}B3c(){this.oc.qa(Cf.a.yfe,y.a.frame,this.yfe);this.ifj.c3(this.x0)}dispose(){}static CDc(S){S=cb.App.xa.notificationBar.Ama(S,!1);S.image=5;S.aoa="CoAuth_AuthorStatus_16x16x32";
cb.App.xa.notificationBar.fA(S)}}Object(f.a)(df,"TrackChangeNotificationActor",null,[]);class yg{constructor(){this.fj=this.tVe=this.W=null;this.U_c=()=>{if(this.fj=cb.App.QSd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new df(this.fj,l.AFrameworkApplication.va)).singleInstance(),this.tVe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}xc(S){this.W=S}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>
{this.jn()})}jn(){cb.App.QSd().continueWith(this.U_c)}dispose(){this.tVe&&this.tVe.dispose()}}Object(f.a)(yg,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var wg=c(97),fk=c(1474),Ui=c(2030);class Uh{}Uh.tlg="UnsavedChanges";Uh.ulg="UnsavedChangesThemed";Uh.A$n="SavedChanges";Uh.wDj="UnsavedChangesOpenPipe";Uh.lRo="UnsavedChangesOpenPipeCssClassNameThemed";Uh.vDj="UnsavedChangesClosePipe";Uh.iRo="UnsavedChangesClosePipeThemed";Uh.jRo="UnsavedChanges";Uh.kRo="UnsavedChangesThemed";
Uh.vlg="UnsavedChangesIndicatorPositionRef";Object(f.a)(Uh,"UnsavedChangesHighlightUtils",null,[]);class Bi extends fk.a{constructor(S,Ba){super();this.mea=S;this.rx=Ba;this.o2=[this.rx?new Ui.a(Uh.ulg,Uh.kRo):new Ui.a(Uh.tlg,Uh.jRo)]}get Oba(){return!0}get yib(){return 4}get X1a(){return this.o2}rGa(S,Ba){if(this.mea){var ib=this.mea.mNf;if(ib&&ib.count&&ib.contains(S.id))for(S=Ba.LGa("span"),Ba=0;Ba<S.length;Ba++)ib=S[Ba],Ba||ib.classList.add(this.rx?Uh.lRo:Uh.wDj),Ba===S.length-1&&ib.classList.add(this.rx?
Uh.iRo:Uh.vDj),ib.classList.add(this.rx?Uh.ulg:Uh.tlg)}}p1a(){}}Object(f.a)(Bi,"UnsavedChangesHighlightActor",fk.a,[]);var dl=c(1038);class Lq{constructor(S){this.Rwe=null;this.mea=S;this.rFe=!1}get key(){return"UnsavedChangesHighlight"}get Uw(){return"UnsavedChanges"}reset(S){if(this.mea){S=S.node;if(vl.ParagraphReader.Vb(S)){const Ba=this.mea.mNf;if(Ba&&Ba.contains(S.id)){this.rFe=!0;this.Rwe=S.id;return}}this.rFe=!1;this.Rwe=$g.a.nil}}qIa(){let S=null;return this.rFe?(S=Object.assign(new dl.a,
{LG:this.key,contentObject:this.Rwe,description:null}),{returnValue:!0,RF:S}):{returnValue:!1,RF:S}}}Object(f.a)(Lq,"UnsavedChangesHighlightCpContentDetailsProvider",null,[567,568]);class bs{constructor(S,Ba,ib,Sb,yc,ed,Ud){this.F6g=null;this.Z5=S;this.$e=Ba;this.sW=ib;this.B6=Sb;this.Fih=yc;this.yYb=ed;this.rx=Ud;this.$e.NMa(this.tY.bind(this))}get mNf(){return this.F6g}lsm(){if(this.Z5){if(1===this.Z5.a8e){if(0===this.Z5.dIf&&this.Z5.dYi()){this.F6g=this.Z5.k4d;const S=this.Z5.yad;this.Z5.B$n.forEach(this.Fml.bind(this));
S.forEach(this.msm.bind(this));0<S.length&&this.qol(this.sW);return 0}return this.YOn(this.Z5.dIf)}return 2}return 1}YOn(S){switch(S){case 0:return this.Z5.ymi()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}tni(S,Ba,ib){if(Ba)if(ib){ib=Ba.querySelectorAll("span");for(let Sb=0;Sb<ib.length;Sb++){const yc=ib[Sb];Sb||yc.classList.add(Uh.wDj);Sb===ib.length-1&&yc.classList.add(Uh.vDj);yc.classList.add(this.rx?Uh.ulg:Uh.tlg)}Ba.classList.add(Uh.vlg);S&&this.B6.pmc(S)}else Ba.classList.add(Uh.A$n)}u9b(S,
Ba){const ib=this.Ifm(S);if(S&&(S=S.De(nh.App.xa.hb.rc.ic)))if(S.Qg&&S.Qg.Qi&&0!==S.Qg.Qi.count)for(const Sb of S.Qg.Qi)this.tni(ib,Sb,Ba);else this.tni(ib,S.htmlElement,Ba)}Ifm(S){return this.Fih&&(S=this.Fih.GPc(S))&&S&&(S=S.De(nh.App.xa.hb.rc.ic))?S:null}msm(S){this.u9b(S,!0);return!0}Fml(S){this.u9b(S,!1);return!0}qol(S){S&&S.continueWith(()=>{S.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}tY(S,Ba){Ba===Sys.EventArgs.Empty?ma.ULS.sendTraceTag(572364513,
306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Ba&&Ba.errorCode?this.yYb.fR||(S=this.lsm(),ma.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",S),Ja.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==S&&4!==S&&this.XKo(S)):ma.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Ba?"Error Code":"Kickout Event Args")}XKo(S){let Ba;const ib=new ve.a;ib.extendedProperties=new Map;ib.extendedProperties.set("HighlightUnsavedChangesResult",
S.toString());ib.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(S){case 1:case 2:case 6:Ba="HighlightInternalError";break;case 5:Ba="ChangeOutsideCanvas"}6!==S&&5!==S||ib.extendedProperties.set("UnsavedChangesCollectionResult",this.Z5.dIf.toString());Ba&&(Ja.Health.instance.recordQosError(Ba,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,ib),Ja.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Ba,!0,!0,ib))}dispose(){this.$e.PMb(this.tY.bind(this))}}Object(f.a)(bs,"UnsavedChangesHighlighter",
null,[10]);var cs=c(499),Mq=c(459),Wu=c(1472);class Kr extends Wu.a{constructor(S,Ba){super();this.mea=S;this.rx=Ba}Hob(S){if(!this.mea)return!1;const Ba=this.mea.mNf;return Ba?Ba.contains(S.Bb.id)||S.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}uQk(S,Ba){Ba=S.nwa?S.nwa[Ba]?S.nwa[Ba].style?S.nwa[Ba].style.marginLeft:null:null:null;var ib=S.leftMargin;S=1440<=ib?-(ib/1440*96):S.geb(0,96,this.zoom);ib=0;Ba&&(Ba=Ba.match(/^(\d+)px/))&&Ba[1]&&(ib=Number(Ba[1]));return S-ib}ZQk(S,Ba,ib){return Sys.UI.DomElement.getBounds(S).y-
ib.Vba[Ba].y}kQk(S){return Sys.UI.DomElement.getBounds(S).height}ULh(S,Ba,ib,Sb){let yc;yc=this.uQk(ib,Ba);Ba=this.ZQk(S,Ba,ib);S=this.kQk(S);Sb=cs.a.createElement(Sb,Mq.a.div);Sb.className=this.rx?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Sb.style.left=yc+"px";Sb.style.top=Ba+"px";Sb.style.height=S+"px";return Sb}iLh(S,Ba,ib,Sb){const yc=[],ed=S.querySelectorAll("."+Uh.vlg);if(0===ed.length&&S.classList.contains(Uh.vlg))ib=this.ULh(S,Ba,ib,Sb),ib.Ifa=Ba,yc.push(ib);else for(S=0;S<
ed.length;S++){const Ud=this.ULh(ed[S],Ba,ib,Sb);Ud.Ifa=Ba;yc.push(Ud)}return yc}bfb(S){let Ba=[];var ib=S.M4;const Sb=ib.fh.ownerDocument;if(ib.Cj){let yc=0;for(const ed of ib.Qg.Qi)(ib=this.iLh(ed,yc,S,Sb))&&(Ba=Ba.concat(ib)),yc+=1}else Ba=this.iLh(ib.htmlElement,0,S,Sb);return Ba}}Object(f.a)(Kr,"UnsavedChangesIndicatorActor",Wu.a,[]);class fw{constructor(){this.YV=this.wv=this.tKa=this.B6=this.Zkd=this.mea=null}get name(){return"WordEditor.UnsavedChangesHighlight"}xc(){}init(){this.B6=va.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;
this.mea=new bs(va.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),wh.SessionStatusManager.instance,xk.a.Bp(va.a.instance.Sa("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.B6,va.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),va.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!cb.App.instance&&cb.App.instance.Doa);this.tKa=va.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager");this.YV=va.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;
this.Zkd=new Kr(this.mea,!!cb.App.instance&&cb.App.instance.Doa);this.B6.x5a(this.Zkd);this.tKa&&this.tKa.execute(S=>{S.V4(new Lq(this.mea))});this.wv=new Bi(this.mea,!!cb.App.instance&&cb.App.instance.Doa);this.YV.w5a(this.wv)}dispose(){this.B6&&this.Zkd&&this.B6.$me(this.Zkd);this.YV&&this.wv&&this.YV.olg(this.wv);wg.a.VB(this.mea)}static main(){L.a.instance.Fc(new fw)}}Object(f.a)(fw,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var Cu=c(126);class Wk{constructor(S,Ba,ib){this.ga=S;
this.Wm=Ba;this.Ma=ib}Tb(){this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(n.a.Qjc,y.a.frame,Object(a.a)(this.Wm,this.Wm.Qjc,"showZoomDialog")),this.ga.fb(n.a.ULn,y.a.frame,Object(a.a)(this.Wm,this.Wm.bWi,"onQueryZoomText"),96),this.ga.qa(n.a.gcd,y.a.frame,Object(a.a)(this.Wm,this.Wm.rLj,"zoomDialogTabFocusHandler")),this.ga.qa(n.a.fcd,y.a.frame,Object(a.a)(this.Wm,this.Wm.rLj,"zoomDialogTabFocusHandler")));this.Ma.$("ZoomSliderIsEnabled")&&(this.ga.fb(n.a.b5i,y.a.frame,Object(a.a)(this.Wm,this.Wm.trn,
"onQueryZoomPercentage"),96),this.ga.fb(n.a.tLj,y.a.frame,Object(a.a)(this.Wm,this.Wm.fvn,"onZoomToPercentage"),96),this.ga.qa(n.a.P6o,y.a.frame,Cu.ActionManager.Pf))}}Object(f.a)(Wk,"CommonZoomActor",null,[1289]);class tv extends Wk{constructor(S,Ba,ib){super(S,Ba,ib);this.bfa=Ba}Tb(){super.Tb();this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(Cf.a.Mpg,y.a.frame,Cu.ActionManager.Pf),this.ga.qa(Cf.a.tpe,y.a.frame,Object(a.a)(this.bfa,this.bfa.O6o,"zoomTo100")));this.ga.qa(Cf.a.zoomToPageWidth,y.a.frame,
Object(a.a)(this.bfa,this.bfa.zoomToPageWidth,"zoomToPageWidth"));this.ga.qa(n.a.Mib,y.a.frame,Object(a.a)(this.bfa,this.bfa.Mib,"increaseZoom"));this.ga.qa(n.a.sfb,y.a.frame,Object(a.a)(this.bfa,this.bfa.sfb,"decreaseZoom"));this.ga.qa(Cf.a.D9f,y.a.frame,Object(a.a)(this.bfa,this.bfa.Yno,"setZoomLevelFromRibbon"));this.ga.fb(Cf.a.fnb,y.a.frame,Object(a.a)(this.bfa,this.bfa.bWi,"onQueryZoomText"),96);this.ga.fb(Cf.a.Fbe,Ji.a.application,Object(a.a)(this.bfa,this.bfa.srn,"onQueryZoomLevelLabelText"),
96);this.ga.qa(Lg.a.BNh,y.a.frame,Cu.ActionManager.Pf);this.ga.qa(Lg.a.ANh,y.a.frame,Cu.ActionManager.Pf);this.ga.qa(Lg.a.FNh,y.a.frame,Cu.ActionManager.Pf);this.ga.qa(Lg.a.CNh,y.a.frame,Cu.ActionManager.Pf);this.ga.qa(Cf.a.Cja,y.a.frame,Cu.ActionManager.Pf)}}Object(f.a)(tv,"WordEditorZoomActor",Wk,[]);class ds{constructor(S,Ba){this.zoom=S;this.ZAk=Ba}}Object(f.a)(ds,"SetCustomZoomArgs",null,[]);var Xw=c(1148);class So{constructor(S,Ba){this.chl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,
"200%","150%","100%","75%","50%"];this.dhl=[So.aef,So.wId,"200","150","100","75","50"];this.Hma=3;this.yN=0;this.delta=.1;this.ZIf=0;this.hd=new M.a;this.ei=null;this.K=S;this.oc=Ba;this.Inj(1)}get hj(){return this.yN}Inj(S){this.yN=S}get KIc(){return Math.round(100*this.hj)}get Vfn(){return Math.floor(this.KIc/10)/10+this.delta}get Ufn(){return Math.ceil(this.KIc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.va}Oyk(S){this.hd.addHandler("ZoomChanged",S)}V0n(S){this.hd.removeHandler("ZoomChanged",
S)}H0(S){this.Oyk(S)}H5a(S){this.V0n(S)}H8i(){}B$i(){}G8i(){}A$i(){}hcd(S){this.sLj(S,this.hj)}sLj(S,Ba){null!==S&&yf.a.rmj(S,Ba)}Wbg(S,Ba=!0){let ib=S*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(ib=new ds(S,Ba));this.ekj(ib)}Xno(S,Ba=!1){this.Cja(S,3|(Ba?0:4))}dvn(S,Ba,ib){if(1===S)return 32;S=ib/100;S<this.aZc?S=this.aZc:S>this.FYc&&(S=this.FYc);this.Cja(S,1);Ba&&(Ba.ns=Math.floor(100*S));return 32}bWi(S,Ba,ib,Sb,yc){if(1===ib)return 32;S=Sa.a.YDa(this.KIc,6,l.AFrameworkApplication.numberFormat);
yc.Value=S;yc.LabelText=S;return 32}fvn(S,Ba,ib,Sb,yc){return 1===ib?32:this.dvn(ib,Sb,yc.value)}trn(S,Ba,ib,Sb,yc){yc.MinValue=100*this.aZc;yc.MaxValue=100*this.FYc;yc.value=this.KIc;return 32}iji(){return this.chl}jji(){return this.dhl}wSl(){let S=Math.floor(100*this.hj).toString();1===this.Hma?S=So.aef:2===this.Hma&&(S=So.wId);return S}Mib(S,Ba,ib){if(1===ib)return 32;this.eYc(this.oc?this.oc.AD:0,"IncreaseZoom");this.Hma=0;this.Cja(this.Vfn);return 32}sfb(S,Ba,ib){if(1===ib)return 32;this.eYc(this.oc?
this.oc.AD:0,"DecreaseZoom");this.Hma=0;this.Cja(this.Ufn);return 32}Yno(S,Ba,ib,Sb,yc){if(1===ib)return 32;this.eYc(this.oc?this.oc.AD:0,"SetZoomLevelFromRibbon");S=yc.Value;if(S.toLowerCase().startsWith("fit"))return S=new Qc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),kl.a.instance.Wb(S),32;S=parseInt(S)/100;if(isNaN(S))return 2;this.Hma=0;this.Cja(S);return 32}eYc(S,Ba){ma.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",
S,Ba,l.AFrameworkApplication.ta.Nb.$q)}Qjc(S,Ba,ib){if(1===ib)return 32;ma.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const S=this.wSl();this.ei=new Xw.a(this.iji(),this.jji(),Object(a.a)(this,this.Iom,"handleZoomDialogResult"),di.FocusManager.instance(),!0);this.ei.Qjc(CommonUIStrings.l_ZoomDialogTitle,S)}mIm(S){return S.toLowerCase()===So.aef.toLowerCase()}nIm(S){return S.toLowerCase()===So.wId.toLowerCase()}Iom(S){if(S){if(this.mIm(S)){this.Hma=
1;var Ba=32}else if(this.nIm(S))this.Hma=2,Ba=this.zoomToPageWidth(0,null,2,null,null);else if(Ba=Number.parseInvariant(S)){this.Hma=0;let ib=Ba;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(ib=new ds(Ba,!0));Ba=this.ekj(ib)}else Ba=8;32===Ba?ma.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:S}):ma.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:S})}else ma.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:S})}WNn(){this.hd.raiseEvent("ZoomChanged",
null)}F5i(){}t2f(){}rLj(S){if(!this.ei)return 2;var Ba=this.ei.focusManager.Ss().Zj.u3;if(Ba===this.ei.Mz&&S===n.a.gcd||Ba===this.ei.aH&&S===n.a.fcd)this.ei.Syb||this.ei.kbo(),this.ei.focusManager.Ss().Zj.Iy(this.ei.Syb);else if(Ba.id.startsWith(this.ei.b3c)||Ba.className.startsWith(this.ei.j5i))Ba=null,S===n.a.gcd?Ba=this.ei.aH:S===n.a.fcd&&(Ba=this.ei.Mz),this.ei.focusManager.Ss().Zj.Iy(Ba),Sys.UI.DomElement.removeCssClass(this.ei.Syb.parentNode,this.ei.i2f);else if(S===n.a.gcd)this.ei.focusManager.Ss().Kdc();
else if(S===n.a.fcd)this.ei.focusManager.Ss().Idc();else return 2;return 32}}So.aef="FullPage";So.wId="PageWidth";Object(f.a)(So,"ZoomManager",null,[865]);var xp;(function(S){S[S.manual=0]="manual";S[S.fitToFullPage=1]="fitToFullPage";S[S.fitWidth=2]="fitWidth";S[S.onBoot=3]="onBoot"})(xp||(xp={}));Object(f.b)("ZoomStatus",xp);c(1061);var Kp;(function(S){S[S.normal=0]="normal";S[S.quiet=1]="quiet";S[S.disableScrollUpdate=2]="disableScrollUpdate";S[S.disableUiControlUpdate=4]="disableUiControlUpdate"})(Kp||
(Kp={}));Object(f.b)("ZoomUpdateFlags",Kp);var yp=c(241),it=c(326),uq=c(1199);class Ut extends So{constructor(S,Ba,ib,Sb,yc,ed,Ud){super(S,Ba);this.n3o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.o3o=[So.wId,"200","150","125","100","75","50"];this.lWe=this.odj=!1;this.TLg="AutoFitForAdaptiveLayout";this.D2j="FitPageWidthFailure";this.fnk="UpdateZoomFailure";this.Dok="wwf";this.BXe=null;this.L7i=()=>{this.Hma===xp.fitWidth&&this.zkf()};this.sfl=Xe=>{if(Xe.ctrlKey){l.AFrameworkApplication.va.processAction(Lg.a.CNh,
2);Xe=Xe.q2o;if(!Xe)return!1;this.Cja(this.hj-(0<Xe?.1:-.1));this.eYc(6,"CtrlScroll");return!0}return!1};this.evn=()=>{ma.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.IW=ib;this.qk=Sb;this.Ub=yc;this.ig=ed;this.ytc=Ud;this.D2g=S.$("KeepViewAfterZoomIsEnabled");this.Eok=S.$("ZoomShortCutIsEnabled");this.unk=S.$("DoNotAutoScrollAfterPinchIsEnabled");this.q7j=(this.sEe=S.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&S.$("AutoFitForSmallScreenModeIsEnabled");
this.L0j=S.$("DoNotProcessUpdateZoomActionIsEnabled");this.Fok=S.$("ZoomSliderIsEnabled");this.zz()}get appName(){return"WordEditor"}get FYc(){return 4}get aZc(){return.1}get tfl(){return wacBoot.CtrlWheelMetrics}cyk(S){this.hd.addHandler("PinchStart",S)}L0n(S){this.hd.removeHandler("PinchStart",S)}byk(S){this.hd.addHandler("PinchEnd",S)}K0n(S){this.hd.removeHandler("PinchEnd",S)}get RJ(){return null!=this.yGg?this.yGg:this.yGg=va.a.instance.Na("WordEditor.IStatusBarUser")}vHj(S){S=!(S&Kp.disableUiControlUpdate);
const Ba=Ib.a.get_instance().isCompleted(7);return S&&Ba?(S={SelectZoomOption:"ComboBoxModel"},cb.App.xa&&cb.App.xa.WG(S),this.LYo(),!0):!1}Cja(S,Ba=Kp.normal){let ib=!0;this.L0j||l.AFrameworkApplication.va.processAction(Cf.a.Cja,2);if(this.hj===S)return this.lWe||(this.lWe=this.vHj(Ba)),ib;S>this.FYc?S=this.FYc:S<this.aZc&&(S=this.aZc);var Sb=!!(Ba&Kp.quiet);1===S||Sb||l.AFrameworkApplication.va.processAction(Cf.a.Mpg,2);try{Sb=null;cb.App.xa&&Object(Jp.a)(uq.PageView,cb.App.xa.hb.rc)&&(Sb=cb.App.xa.hb.rc);
let yc=-1,ed=-1,Ud=-1;const Xe=!(Ba&Kp.disableScrollUpdate);this.D2g&&Xe&&(yc=We.SelectionEditor.Qhm(co.a.instance.gb.kb,Sb),ed=Sb.pL.scrollLeft,Ud=Sb.pL.scrollTop);const Ue=this.hj;this.Inj(S);this.WNn();this.lWe=this.vHj(Ba);Xe&&this.oXo(Sb,yc,ed,Ud,Ue)}catch(yc){ib=!1,ma.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",yc)}return ib}oXo(S,Ba,ib,Sb,yc){S&&S.isActive?this.D2g?0<=Ba&&100>=Ba?S.Ns.b5(100-Ba,!0,!0):S.Ns.HVm(ib,Sb,yc,this.hj):S.Ns.b5():ma.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}O6o(S,
Ba,ib){2===ib&&(this.eYc(this.oc?this.oc.AD:0,"ZoomTo100"),this.Hma=xp.manual,this.Cja(1));return 32}ekj(S){this.Hma=xp.manual;let Ba,ib=!0;if(this.unk){if(!Object(Jp.a)(ds,S))return ma.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Ba=S.zoom/100;ib=S.ZAk}else Ba=Number.parseInvariant(String.format("{0}",S))/100;ma.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Ba);S=Kp.normal;ib||(S=Kp.disableScrollUpdate);this.Cja(Ba,S);return 32}zoomToPageWidth(S,
Ba,ib){if(1===ib)return 32;ma.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(uc.a)("ZoomToPageWidth",!0);this.Hma=xp.fitWidth;this.wvl();return this.zkf()}srn(S,Ba,ib,Sb,yc){if(1===ib)return 32;S=Sa.a.YDa(this.KIc,6,l.AFrameworkApplication.numberFormat);yc[yp.a.labelText]=S;return 32}iji(){return this.n3o}jji(){return this.o3o}wvl(){this.odj||(cb.App.xa?(cb.App.xa.VZ(this.L7i),this.odj=!0):ma.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}zkf(){var S=
cb.App.xa?cb.App.xa.hb.rc:null;if(S&&cb.App.xa.lD){var Ba=null;(S=this.sSl(S))&&(Ba=this.IW.EJ(S));Ba||(Ba=this.IW.Qpf());if(null!==Ba)return Ba=Yo.a.instance.$t(Ba),Ba=Fn.a.Mi(Ba,0),S=this.ytc(),Ba+=S&&S.Dhe()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,Ba+=2*it.a.kpg,this.Cja(cb.App.xa.lD.offsetWidth/Ba),32;ma.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ma.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");
return 8}sSl(S){return S&&S.lb&&S.lb.gb.kb&&S.lb.gb.kb.Oa&&S.lb.gb.kb.Oa.node?S.lb.gb.kb.Oa.node:null}LYo(){this.RJ&&(this.Fok?(this.RJ.RU(to.a.J6o),this.RJ.RU(to.a.L6o)):this.RJ.RU(to.a.M6o))}dCo(S){S||(S=window.self.CtrlWheelMetrics);if(S){var Ba=S.ctrlWheelOccurred;if("boolean"!==typeof Ba)ma.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ma.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Ba);try{S.stop()}catch(ib){ma.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",
ib)}}}else ma.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}zz(){this.dCo(this.tfl);if(this.qk){var S=document.getElementById(Ro.AppFrame.aJd);S&&this.qk.mb(W.a.plb,S,this.sfl)}this.Ub&&(S=this.Ub.fe(Ro.AppFrame.YE),this.Eok&&(S.bindAction(of.KeyInputManager.kc(ak.a.Mmc,of.KeyInputManager.Sh),n.a.Mib),S.bindAction(of.KeyInputManager.kc(ak.a.tbd,of.KeyInputManager.Sh),n.a.Mib),S.bindAction(of.KeyInputManager.kc(ak.a.Nmc,of.KeyInputManager.Sh),n.a.sfb),S.bindAction(of.KeyInputManager.kc(ak.a.Pmc,
of.KeyInputManager.Sh),n.a.sfb),S.bindAction(of.KeyInputManager.kc(ak.a.ddd,of.KeyInputManager.Sh),Cf.a.tpe)));this.ig&&(this.BXe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ig.mb(W.a.click,this.BXe,this.evn);this.q7j&&(cb.App.xa.GI.registerLayoutBreakpointChanged("canvas",Ba=>{this.y2e(Ba)}),cb.App.xa.GI.registerBoundingWindowRectsChanged("canvas",()=>{this.y2e(cb.App.xa.GI.getLayoutBreakpoint())}))}y2e(S){let Ba=!0,ib="";if(this.Hma!==xp.onBoot)return Ba;Ja.Health.instance.recordKpiUsage(this.TLg,
0,this.Dok,null);switch(S){case "Small":8===this.zkf()&&(ib=this.D2j,Ba=!1);break;default:1===this.hj||this.Cja(1)||(ib=this.fnk,Ba=!1)}Ba||Ja.Health.instance.recordKpiFailure(this.TLg,ib,!0,!0,null);return Ba}H8i(S){this.cyk(S)}B$i(S){this.L0n(S)}G8i(S){this.byk(S)}A$i(S){this.K0n(S)}F5i(){this.hd.raiseEvent("PinchStart",null)}t2f(){this.hd.raiseEvent("PinchEnd",null)}}Object(f.a)(Ut,"WordEditorZoomManager",So,[864,865]);class uv{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const S=
this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),Ba=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");S.Tb();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&Ba&&Ib.a.get_instance().xk(4,()=>{Ba.y2e(cb.App.xa.GI.getLayoutBreakpoint())||ma.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}xc(S){this.W=S;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&
(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new Ut(l.AFrameworkApplication.K,l.AFrameworkApplication.va,ti.WordSectionNavigator.instance,Qp.a.instance,di.FocusManager.instance(),Hq.a.instance,()=>S.Na("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new tv(l.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).singleInstance())}static main(){L.a.instance.Fc(new uv)}}
Object(f.a)(uv,"ZoomPackage",null,[1,2]);var Yw=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",
ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",
Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",
attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",
attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",
LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",
QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",
MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},
children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class Lr extends ck.a{constructor(S){var Ba;super("DocumentOwnerConditionId");this.In=S.In;this.Acg=null!==(Ba=S.Acg)&&void 0!==Ba?Ba:!0}initialize(){super.initialize();const S=l.AFrameworkApplication.K;S.Po(()=>{const Ba=S.$("IsDocumentOwner");this.Sg(Ba===this.Acg)})}Sg(S){super.Sg(S);ma.ULS.sendTraceTag(508958623,3028,50,this.wT(this.In,S))}}Object(f.a)(Lr,"DocumentOwnerCondition",ck.a,
[]);var tr=c(1733);class Vt extends qk.a{constructor(S){const Ba=new Zf({In:23,n0a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"}),ib=new Zf({In:23,n0a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),Sb=new Lr({In:23,Acg:!1});S=new tr.a({In:23},S);super(23,new lb.a([Ba,ib,Sb,S]),null,3028,"CopilotSummarySkittleInitTriggered")}}Object(f.a)(Vt,"CopilotSummarySkittleInitTriggerModel",qk.a,[]);var To={get interop(){var S=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:
copilotSummarySkittleUx.interop;if(!S)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return S}};class vv{constructor(S,Ba){this.OFd=S;this.T5c=Ba;this.wGa=async(ib,Sb)=>{if(Sb.KY){Object(uc.a)("CopilotSummarySkittleInitializationTriggered");this.OFd.Vca(this.wGa);this.OFd.Md();try{const [,yc]=await Promise.all([this.K_m(),Promise.all([c.e(2),c.e(27)]).then(c.bind(null,2066))]);yc.main(To.interop)}catch(yc){ma.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.OFd.b3(this.wGa);
this.OFd.initialize()}async K_m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Ag.c)(this.T5c)).Pz.loadScript("copilotSummarySkittleUx")}}Object(f.a)(vv,"CopilotSummarySkittleInitializer",null,[]);class np extends mi.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}U7(S){this.container=S}W7(){(new vv(new Vt(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}V7(){}static main(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&L.a.instance.Fc(new np)}}Object(f.a)(np,"CopilotSummarySkittleEntryPackage",mi.a,[]);var Du=c(1769),Eu=c(1763);class gw{static get isEnabled(){return Object(Ag.b)("Microsoft.Office.WordOnline.IsCopilotComposeEnabled")}}Object(f.a)(gw,"CopilotComposeFeatureCondition",null,[]);const $m=new im(()=>Promise.all([c.e(5),c.e(28)]).then(c.bind(null,2067)).then(S=>S.instance));class wv{constructor(S){this.jpg=S}initialize(){this.dpl().catch(S=>{ma.ULS.eD(508913495,3041,10,S,"Failed to initialize CopilotCompose")})}async dpl(){await Promise.all([$m.E3(),
this.jpg.loadChunk("copilotComposeUx")]);await $m.hgb()}}Object(f.a)(wv,"CopilotComposeInitializer",null,[]);class Hg extends mi.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}U7(){}W7(){(new wv(va.a.instance.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"))).initialize()}V7(){}static main(){gw.isEnabled&&L.a.instance.Fc(new Hg)}}Object(f.a)(Hg,"CopilotComposeEntryPackage",mi.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");
Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");
Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Bn.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");P;Type.registerNamespace("CACPU");xa.main();Type.registerNamespace("CAEventTimingMeter");fb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");
cc.main();Type.registerNamespace("Common.App.GestureInput");Ra.main();Type.registerNamespace("Common.App.GestureManager");Wa.main();Type.registerNamespace("Common.ModernFontPicker");null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),L.a.instance.Fc(new zf));Type.registerNamespace("Common.App.O365Shell");Gb.main();Type.registerNamespace("Common.App.PhoneLink");Id.main();
Type.registerNamespace("Common.App.SensitiveLogging");Ek.main();Type.registerNamespace("Common.App.Rename");L.a.instance.Fc(new Xi,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");L.a.instance.Fc(new zg);Type.registerNamespace("Common.App.SaveAsToHost");$k.main();Type.registerNamespace("Common.App.SaveToCloudStorage");og.main();Type.registerNamespace("Common.App.SaveACopy");Lj.main();Type.registerNamespace("Common.App.SaveToSharePoint");Of.main();Type.registerNamespace("Common.App.SharedFilePicker");
lh.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");Ad.main();Cn;L.a.instance.Fc(new rq);Wf.main();Yw;qo.main();L.a.instance.Fc(new Qo);Jq.main();iq.a.prototype.toString=jq.a.prototype.toString;br.a.fki=new Nn.a;L.a.instance.Fc(new Ip);uv.main();L.a.instance.Fc(new Ug);L.a.instance.Fc(new qq);L.a.instance.Fc(new ek);
tf.main();ol.main();Qk.main();fw.main();Type.registerNamespace("NLRT");L.a.instance.Fc(new yk);Type.registerNamespace("Common.App.AccessibilitySettings");N.main();L.a.instance.Fc(new yg);gh.main();po.main();Xr.main();ql.main();np.main();Hg.main();null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchRDLMToSliceTwo",!1)&&Du.a.main();null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchLSTHMToSliceTwo",
!1)&&Eu.a.main();window.EventTiming={EventTimingMeter:ml,FrameTimingMeter:Pf}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19660862/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll2.js.map