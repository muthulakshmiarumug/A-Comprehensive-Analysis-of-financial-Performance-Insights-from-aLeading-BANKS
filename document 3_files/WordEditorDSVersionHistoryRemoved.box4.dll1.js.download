'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1052:function(E,K,c){function l(M,J=self){J.addEventListener("message",function W(X){if(X&&X.data){var {id:U,type:Y,path:ca}=Object.assign({path:[]},X.data),aa=(X.data.puh||[]).map(n);try{const pa=ca.slice(0,-1).reduce((la,qa)=>la[qa],M),ra=ca.reduce((la,qa)=>la[qa],M);switch(Y){case "GET":var fa=ra;break;case "SET":pa[ca.slice(-1)[0]]=n(X.data.value);fa=!0;break;case "APPLY":fa=ra.apply(pa,aa);break;case "CONSTRUCT":const la=
new ra(...aa);fa=Object.assign(la,{[w]:!0});break;case "ENDPOINT":const {port1:qa,port2:La}=new MessageChannel;l(M,La);fa=x(qa,[qa]);break;case "RELEASE":fa=void 0;break;default:return}}catch(pa){fa={value:pa,[H]:0}}Promise.resolve(fa).catch(pa=>({value:pa,[H]:0})).then(pa=>{const [ra,la]=y(pa);J.postMessage(Object.assign(Object.assign({},ra),{id:U}),la);"RELEASE"===Y&&(J.removeEventListener("message",W),"MessagePort"===J.constructor.name&&J.close())})}});J.start&&J.start()}function f(M){if(M)throw Error("Proxy has been released and is not useable");
}function a(M,J=[],V=function(){}){let X=!1;const W=new Proxy(V,{get(U,Y){f(X);if(Y===G)return()=>u(M,{type:"RELEASE",path:J.map(ca=>ca.toString())}).then(()=>{"MessagePort"===M.constructor.name&&M.close();X=!0});if("then"===Y){if(0===J.length)return{then:()=>W};U=u(M,{type:"GET",path:J.map(ca=>ca.toString())}).then(n);return U.then.bind(U)}return a(M,[...J,Y])},set(U,Y,ca){f(X);const [aa,fa]=y(ca);return u(M,{type:"SET",path:[...J,Y].map(pa=>pa.toString()),value:aa},fa).then(n)},apply(U,Y,ca){f(X);
U=J[J.length-1];if(U===F)return u(M,{type:"ENDPOINT"}).then(n);if("bind"===U)return a(M,J.slice(0,-1));const [aa,fa]=k(ca);return u(M,{type:"APPLY",path:J.map(pa=>pa.toString()),puh:aa},fa).then(n)},construct(U,Y){f(X);const [ca,aa]=k(Y);return u(M,{type:"CONSTRUCT",path:J.map(fa=>fa.toString()),puh:ca},aa).then(n)}});return W}function k(M){M=M.map(y);return[M.map(J=>J[0]),Array.prototype.concat.apply([],M.map(J=>J[1]))]}function x(M,J){N.set(M,J);return M}function y(M){for(const [J,V]of I)if(V.pAh(M)){const [X,
W]=V.serialize(M);return[{type:"HANDLER",name:J,value:X},W]}return[{type:"RAW",value:M},N.get(M)||[]]}function n(M){switch(M.type){case "HANDLER":return I.get(M.name).deserialize(M.value);case "RAW":return M.value}}function u(M,J,V){return new Promise(X=>{const W=z();M.addEventListener("message",function ca(Y){Y.data&&Y.data.id&&Y.data.id===W&&(M.removeEventListener("message",ca),X(Y.data))});M.start&&M.start();M.postMessage(Object.assign({id:W},J),V)})}function z(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}E=c(0);const w=Symbol("Comlink.proxy"),F=Symbol("Comlink.endpoint"),G=Symbol("Comlink.releaseProxy"),H=Symbol("Comlink.thrown"),L=M=>"object"===typeof M&&null!==M||"function"===typeof M,I=new Map([["proxy",{pAh:M=>L(M)&&M[w],serialize(M){const {port1:J,port2:V}=new MessageChannel;l(M,J);return[V,[V]]},deserialize(M){M.start();return a(M,[],void 0)}}],["throw",{pAh:M=>L(M)&&H in M,serialize({value:M}){return[M instanceof Error?
{WPa:!0,value:{message:M.message,name:M.name,stack:M.stack}}:{WPa:!1,value:M},[]]},deserialize(M){if(M.WPa)throw Object.assign(Error(M.value.message),M.value);throw M.value;}}]]),N=new WeakMap;c.d(K,"a",function(){return P});class P{static CTj(M){P.y$a=M;P.yok=a(M,[],void 0)}static get Endpoint(){return P.y$a}static get DTj(){return P.yok}}Object(E.a)(P,"WorkerUtils",null,[])},1067:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}Object(E.a)(l,"WaterlineOverrideSettings",null,[])},
1068:function(E,K,c){E=c(0);var l=c(412),f=c(521),a=c(568),k=c(231);class x extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}al(){return 97}static Zaa(F,G,H){const L=new x;L.FileId=F;L.HighWaterline=G;L.LowWaterline=H;return L}}Object(E.a)(x,"GetActivitiesRequest",k.a,[]);class y extends k.a{constructor(F,G,H){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=F;this.Waterline=G;this.Settings=H}al(){return 107}static Zaa(F,G,H){return new y(F,
G,H)}}Object(E.a)(y,"GetRelevantActivitiesRequest",k.a,[]);class n extends k.a{constructor(F,G){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=F;this.WaterlineOverrideSettings=G}al(){return 96}static Zaa(F,G){return new n(F,G)}}Object(E.a)(n,"GetWywaActivitiesRequest",k.a,[]);class u{}Object(E.a)(u,"RelevantActivitiesSettings",null,[]);class z extends k.a{constructor(){super();this.FileId=null}al(){return 109}static Zaa(F){const G=new z;G.FileId=F;return G}}Object(E.a)(z,"UpdateWaterlineRequest",
k.a,[]);c.d(K,"a",function(){return w});class w{constructor(F,G,H,L,I){this.Yak=F;this.etd=G;this.pPe=H;this.Joc=L;this.INg=I}requestWYWAActivities(F){F=n.Zaa(this.etd(),F);return l.a.then(this.mba(F,"wywa"),G=>G)}requestActivities(F,G){F=x.Zaa(this.etd(),F,G);return l.a.then(this.mba(F,"activities"),H=>H)}g4n(){const F=z.Zaa(this.etd());return l.a.then(this.mba(F,"waterline"),G=>G)}requestRelevantActivities(F,G){G=Object.assign(new u,{FirstDocumentOpen:G,MockDataEnabled:!1});F=y.Zaa(this.etd(),F,
G);return l.a.then(this.mba(F,"relevant"),H=>H)}updateActivityState(F){return l.a.e$c(this.INg,G=>G.JRo(F.itemIds,F.activityStatesToSet,F.activityStatesToReset,F.resetUnseenCount))}requestActivityFeed(){return l.a.e$c(this.INg,F=>F.getActivityFeed(null))}mba(F,G){const H={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.e$c(this.Yak,L=>L.Rv(this.pPe,H,f.a.dHh(F,this.Joc),G)),L=>{if(!(L&&L.args&&L.args.data&&L.args.data.we))return null;({group:L}=a.a.l1(L.args.data.we));return L&&
L.Responses&&L.Responses.length?L.Responses[0]:null})}}Object(E.a)(w,"SharedActivityRepository",null,[])},1410:function(E,K,c){c.d(K,"a",function(){return f});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.P8o=1]="Inference"})(l||(l={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.aap=1]="VoiceDictationBadge";a[a.bap=2]="VoiceDictationPhrase"})(f||(f={}))},1512:function(E,K,c){c.r(K);c.d(K,"Box4PasteSteward",function(){return ca});E=c(0);var l=c(22),f=c(2),a=c(19),k=c(123),x=c(53),y=c(6),n=c(7),
u=c(34),z=c(74),w=c(9),F=c(103),G=c(121),H=c(8),L=c(3),I=c(86),N=c(5),P=c(140),M=c(36),J=c(81),V=c(40),X=c(56),W=c(28),U=c(442),Y=c(1756);class ca extends Y.a{constructor(aa,fa,pa,ra,la,qa,La,Pa=null,Ka=null){super(aa,La,Pa,Ka);this._formatting=null;this.rKa=!1;this.Utb=null;this.rVb=-1;this.Bvb=0;this.JBc=new z.a;this.aan=4294967295;u.a(4223754,307,V.OutlineElementReader.Dh(aa));this.$tb=fa;this.$tb.r1b(this);this.ZL=pa;this.ZL.r1b(this);this.gq=ra;this.Un=la;this.dNe=F.ListItemReader.Ig(this.Ec);
ca.Sym();ca.Eym();ca.ozm()}get twa(){return null!=this.BCg?this.BCg:this.BCg=l.a.instance.Na("Box4.IInternalLinkManager")}get iHd(){return this._formatting}get q3b(){return this.dNe&&!this.ZL.pDa}get KBb(){return 0<this.Bvb}reset(){super.reset();this._formatting=this.bpf(!1)}N0e(aa){var fa;u.a(4223762,307,V.OutlineElementReader.Dh(this.Ec)||J.OutlineReader.fx(this.Ec));this.Mdc(!1);var pa=new N.GraphIterator;pa.Zc(this.Ec);aa=Y.a.lg.YI(this.Ec,this.FOc(aa));this.CAd(pa,!1);u.a(4223763,307,aa===this.Ec.currentNode);
u.a(4223764,307,H.ParagraphReader.Vb(aa));-1!==this._formatting.rw&&ca.paragraphEditor.gE(aa,this._formatting.rw);if(ca.paragraphEditor.gq&&!this.$Y.tqj&&this._formatting.textIndent&&({unit:la,returnValue:ra}=ca.v9d(this._formatting.textIndent),pa=!1,ra)){if(0>ra){pa=!0;var ra=-1*ra}var la=ca.g$e(ra,la);pa?ca.paragraphEditor.gq.job(aa,la):ca.paragraphEditor.gq.dda(aa,la)}(ca.Ld.rg||I.a.instance.J(1)&&w.App.Bv.jQb)&&aa.setValue(y.a.hQa,!0);this._formatting.lineSpacing&&ca.paragraphEditor.fD(aa,this._formatting.lineSpacing);
f.AFrameworkApplication.te("702j5362;7g13g664");this._formatting.BR&&(null===(fa=f.AFrameworkApplication.K)||void 0===fa?0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(n.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),ca.paragraphEditor.dob(aa,this._formatting.BR.afterSpacing),ca.paragraphEditor.eob(aa,this._formatting.BR.beforeSpacing));if(this._formatting.Bkc){fa=[];
pa=[];la=[];ra=this._formatting.Bkc.split(" ");let La=1,Pa=0;for(let Ka=0;Ka<ra.length;Ka++){var qa=ca.r6k(ra[Ka]);const Na=ca.q6k(ra[Ka]);if(-1!==qa)La=qa;else if(-1!==Na)Pa=Na;else{const {unit:sa,returnValue:wa}=ca.v9d(ra[Ka]);qa=ca.g$e(wa,sa);if(0<=qa&&qa<=this.aan)fa.push(qa),pa.push(La),la.push(Pa);else{u.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.Bkc+" index: "+Ka);break}La=1;Pa=0}}0<fa.length&&ca.paragraphEditor.nrk(aa,fa,pa,la)}this._formatting.paragraph=aa;
this.rKa=!0}CAd(aa,fa){u.a(8128518,307,!fa);this.QU&&(0<this.QU&&this.gq.iJc(aa,this.QU),0>this.QU&&this.gq.XRa(aa,this.QU,0));aa&&this.Un.Fge(aa,this.KBb);this.QU=0}N$c(aa){this.JBc.add(aa)}f7e(){this.QU=0}Eca(aa,fa=null){u.a(4223772,307,H.ParagraphReader.sh(this.Ec));const pa=this.Ec.currentNode;this._formatting.tkg(pa);if(!this.$Y.Ckg(this.Ec,fa,!1)){var ra=pa.pa.last,la=W.a.jw(pa);this.rKa&&(ra.formatting=this._formatting.MQ.Ef(ra),pa.Xl(),this.rKa=!1);aa=this.$Y.zwf(aa,fa);this.$Y.Q9(this.Ec.currentNode,
this._formatting.Kca,fa);this.characterPropertiesEditor.replaceTextRange(la,aa,void 0,void 0,L.a.paste)}}Dca(aa){this.$Y.EZd&&this.$Y.wYd(aa)?(this.oF(),this.aE(aa)):(u.a(4223773,307,H.ParagraphReader.sh(this.Ec)),aa=W.a.jw(this.Ec.currentNode),this.characterPropertiesEditor.Zga(aa,fa=>new U.a(fa)))}omb(){this.$Y.Gwf(this.Ec)}txa(aa){if(ca.Cql(aa)){const fa=this.Ec.currentNode;H.ParagraphReader.Vb(fa)&&(fa.Efc=aa.Zif)}else this.$tb.txa(aa)}kGa(aa){this._formatting=aa;this.rKa=!0}tRa(aa){u.a(4223774,
307,H.ParagraphReader.sh(this.Ec));u.a(4223775,307,!this.Utb);u.a(4223776,307,0>this.rVb);this.Utb=aa;this.rVb=H.ParagraphReader.textLength(this.Ec.currentNode)}sRa(){u.a(4223777,307,H.ParagraphReader.sh(this.Ec));u.a(4223778,307,!!this.Utb);u.a(4223779,307,0<=this.rVb);let aa=W.a.createTextRange(this.Ec.currentNode,this.rVb,H.ParagraphReader.textLength(this.Ec.currentNode)),fa="",pa="";this.twa&&({s4f:fa,wDb:pa}=this.twa.vkg(G.HyperlinkReader.ePa(this.Utb))).returnValue&&(this.Utb=fa,pa&&(this.characterPropertiesEditor.replaceTextRange(aa,
pa),aa=W.a.createTextRange(this.Ec.currentNode,this.rVb,H.ParagraphReader.textLength(this.Ec.currentNode))));ca.hyperlinkEditor.hG(aa,this.Utb,!1);this.rKa=!0;this.Utb=null;this.rVb=-1}aE(aa){this.N0e(aa);this._formatting.kme(this.Ec.currentNode);this.$Y.Q9(this.Ec.currentNode,this._formatting.Kca,aa,this._formatting.marginLeft,this._formatting.textIndent)}oF(){u.a(4223808,307,H.ParagraphReader.sh(this.Ec));ca.hyperlinkEditor.Yul(this.Ec.currentNode);M.OutlineElementNavigator.Vd(this.Ec)}jmb(){}imb(){}yRa(){}G4a(){}xxa(){u.a(4223809,
307,V.OutlineElementReader.Dh(this.Ec)||J.OutlineReader.fx(this.Ec));let aa=!1;this.KBb||(aa=this.q3b||!0);aa||(this.QU+=1);this.Bvb++}vxa(){this.Bvb--;let aa=!1;this.KBb||(aa=this.q3b||!0,this.Un.o$i(this.JBc));aa||--this.QU}pGa(aa){u.a(4223810,307,V.OutlineElementReader.Dh(this.Ec)||J.OutlineReader.fx(this.Ec));u.a(4223811,307,!!aa.listStyleType);this.Un.Ege(this.kZm(aa))}wxa(){u.a(4223813,307,V.OutlineElementReader.Dh(this.Ec))}I4a(aa){this.$tb.I4a(aa)}k9(aa){this.ZL.k9(aa)}i9(){this.ZL.i9()}K4(aa){this.ZL.K4(aa)}j9(){this.ZL.j9()}h9(aa){this.ZL.h9(aa)}g9(){this.ZL.g9()}static get paragraphEditor(){return null!=
ca.eFg?ca.eFg:ca.eFg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ca.CAg?ca.CAg:ca.CAg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ld(){return null!=ca.sIg?ca.sIg:ca.sIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get EJj(){return null!=ca.hJg?ca.hJg:ca.hJg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get wkc(){return ca.wTe}static set wkc(aa){ca.wTe=aa}static get Vn(){return P.a.getInstance()}static Sym(){ca.T4a[1]=
X.StyleReader.wordStyleIdHeading1;ca.T4a[2]=X.StyleReader.wordStyleIdHeading2;ca.T4a[3]=X.StyleReader.wordStyleIdHeading3;ca.T4a[4]=X.StyleReader.l8a;ca.T4a[5]=X.StyleReader.m8a;ca.T4a[6]=X.StyleReader.n8a;ca.T4a[7]=null}static Eym(){ca.Zwa.unspecified=0;ca.Zwa.defaultUnordered=1;ca.Zwa.defaultOrdered=1;ca.Zwa.none=0;ca.Zwa.disc=1;ca.Zwa.circle=2;ca.Zwa.square=3;ca.Zwa.decimal=1;ca.Zwa.lowerAlpha=2;ca.Zwa.lowerRoman=3;ca.Zwa.upperAlpha=4;ca.Zwa.upperRoman=5}static ozm(){ca.wTe=ca.EJj.Mr()}static r6k(aa){let fa=
-1;if(!aa)return fa;aa=aa.toLowerCase();switch(aa){case "left":fa=1;break;case "center":fa=3;break;case "right":fa=4;break;case "decimal":fa=6;break;case "bar":fa=7}return fa}static q6k(aa){let fa=-1;if(!aa)return fa;aa=aa.toLowerCase();switch(aa){case "blank":fa=0;break;case "dotted":fa=1;break;case "dashed":fa=2;break;case "lined":fa=3}return fa}static $Ab(aa){const fa=a.a.substring(aa,0,2),pa=a.a.substring(aa,2,4);return a.a.substring(aa,4,6)+pa+fa}static v9d(aa){let fa=0;const pa=aa.length;var ra=
a.a.substring(aa,0,pa-2);ra=parseFloat(ra);aa=a.a.substr(aa,pa-2,2);switch(aa){case "in":fa=3;break;case "px":fa=7;break;case "cm":fa=1;break;case "pt":fa=5;break;default:n.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",aa),ra=0}return{returnValue:ra,unit:fa}}static g$e(aa,fa){let pa=0;switch(fa){case 3:pa=k.a.Hv(aa);break;case 7:pa=x.a.Cy(aa,0);break;case 1:pa=k.a.i6e(aa);break;case 5:pa=k.a.Hv(k.a.iZf(aa));break;default:n.ULS.sendTraceTag(8208451,
307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",aa,fa)}return pa}static Cql(aa){return!!aa&&!!aa.Zif&&""!==aa.Zif}}ca.T4a=Array(8);ca.Zwa={};ca.wTe=null;Object(E.a)(ca,"Box4PasteSteward",Y.a,[])},1546:function(E,K,c){E=c(0);var l=c(2),f=c(2025),a=c(7);const k=(y,n)=>{const u={};let z=null;switch(y){case 0:z="HtmlProcessor";var w=n.a;null!=w&&(u.SessionID=w);var F=n.b.toString();null!=F&&(u.Elements=F);var G=n.c.toString();null!=G&&(u.PrunedElements=
G);var H=n.d.toString();null!=H&&(u.TransparentElements=H);var L=n.e.toString();null!=L&&(u.VoidElements=L);var I=n.f.toString();null!=I&&(u.UnknownElements=I);break;case 1:z="WordConverter";var N=n.a;null!=N&&(u.SessionID=N);var P=n.b.toString();null!=P&&(u.BulletsConverted=P);var M=n.c.toString();null!=M&&(u.NumberedConverted=M);break;case 2:z="FormattingSteward";var J=n.a;null!=J&&(u.SourceApp=J);var V=n.b;null!=V&&(u.Browser=V);var X=n.c;null!=X&&(u.OperationId=X);var W=n.d.toString();null!=W&&
(u.Lang=W);var U=n.e.toString();null!=U&&(u.TextDir=U);var Y=n.f.toString();null!=Y&&(u.Bold=Y);var ca=n.g.toString();null!=ca&&(u.Math=ca);var aa=n.h.toString();null!=aa&&(u.Italics=aa);var fa=n.i.toString();null!=fa&&(u.Underline=fa);var pa=n.j.toString();null!=pa&&(u.Strikethrough=pa);var ra=n.k.toString();null!=ra&&(u.Subscript=ra);var la=n.l.toString();null!=la&&(u.Superscript=la);var qa=n.m.toString();null!=qa&&(u.Fontsize=qa);var La=n.n.toString();null!=La&&(u.Fontface=La);var Pa=n.o.toString();
null!=Pa&&(u.GrowFontsize=Pa);var Ka=n.p.toString();null!=Ka&&(u.ShrinkFontsize=Ka);var Na=n.q.toString();null!=Na&&(u.FontColor=Na);var sa=n.r.toString();null!=sa&&(u.FontHighlight=sa);var wa=n.s.toString();null!=wa&&(u.ParagraphStyle=wa);var ja=n.t.toString();null!=ja&&(u.TextAlign=ja);var ha=n.u.toString();null!=ha&&(u.TextIndent=ha);var va=n.v.toString();null!=va&&(u.MarginLeft=va);var xa=n.w.toString();null!=xa&&(u.ParagraphSpaceBefore=xa);var ma=n.x.toString();null!=ma&&(u.ParagraphSpaceAfter=
ma);var Ja=n.y.toString();null!=Ja&&(u.LineSpace=Ja);var oa=n.z.toString();null!=oa&&(u.CellShadingColor=oa);var za=n.ba.toString();null!=za&&(u.StyleDefinition=za);var Fa=n.bb.toString();null!=Fa&&(u.TabStops=Fa);break;case 3:z="SemanticEvents";var kb=n.a;null!=kb&&(u.SessionID=kb);var fb=n.b.toString();null!=fb&&(u.Text=fb);var lb=n.c.toString();null!=lb&&(u.LineBreak=lb);var sb=n.d.toString();null!=sb&&(u.Image=sb);var ab=n.e.toString();null!=ab&&(u.File=ab);var Ga=n.f.toString();null!=Ga&&(u.FormattingChange=
Ga);var Ua=n.g.toString();null!=Ua&&(u.Anchor=Ua);var wb=n.h.toString();null!=wb&&(u.Paragraph=wb);var cc=n.i.toString();null!=cc&&(u.Math=cc);var zb=n.j.toString();null!=zb&&(u.List=zb);var nb=n.k.toString();null!=nb&&(u.ListItem=nb);var eb=n.l.toString();null!=eb&&(u.RenderAugmentation=eb);var Ib=n.m.toString();null!=Ib&&(u.Span=Ib);break;case 4:z="SemanticTableEvents";var Xa=n.a;null!=Xa&&(u.SessionID=Xa);var Ra=n.b.toString();null!=Ra&&(u.Tables=Ra);var gb=n.c.toString();null!=gb&&(u.TableRow=
gb);var Bb=n.d.toString();null!=Bb&&(u.TableCell=Bb);var $b=n.e.toString();null!=$b&&(u.TablePart=$b);break;case 5:z="HtmlEvents";var Qb=n.a;null!=Qb&&(u.OperationId=Qb);var Ac=n.b;null!=Ac&&(u.SourceApp=Ac);var Db=n.c;null!=Db&&(u.Browser=Db);var dc=null==n.d?null:n.d.toString();null!=dc&&(u.Text=dc);var Pb=null==n.e?null:n.e.toString();null!=Pb&&(u.A=Pb);var Ub=null==n.f?null:n.f.toString();null!=Ub&&(u.Abbr=Ub);var rb=null==n.g?null:n.g.toString();null!=rb&&(u.Acronym=rb);var Yb=null==n.h?null:
n.h.toString();null!=Yb&&(u.Address=Yb);var Ya=null==n.i?null:n.i.toString();null!=Ya&&(u.Applet=Ya);var Ob=null==n.j?null:n.j.toString();null!=Ob&&(u.Area=Ob);var vc=null==n.k?null:n.k.toString();null!=vc&&(u.B=vc);var Sa=null==n.l?null:n.l.toString();null!=Sa&&(u.Base=Sa);var Ab=null==n.m?null:n.m.toString();null!=Ab&&(u.Basefont=Ab);var Fb=null==n.n?null:n.n.toString();null!=Fb&&(u.Bdo=Fb);var Va=null==n.o?null:n.o.toString();null!=Va&&(u.Big=Va);var Wa=null==n.p?null:n.p.toString();null!=Wa&&
(u.Blockquote=Wa);var jb=null==n.q?null:n.q.toString();null!=jb&&(u.Body=jb);var mc=null==n.r?null:n.r.toString();null!=mc&&(u.Br=mc);var yb=null==n.s?null:n.s.toString();null!=yb&&(u.Button=yb);var Oa=null==n.t?null:n.t.toString();null!=Oa&&(u.Caption=Oa);var Gb=null==n.u?null:n.u.toString();null!=Gb&&(u.Center=Gb);var Wb=null==n.v?null:n.v.toString();null!=Wb&&(u.Cite=Wb);var kc=null==n.w?null:n.w.toString();null!=kc&&(u.Code=kc);var Mb=null==n.x?null:n.x.toString();null!=Mb&&(u.Col=Mb);var Qc=
null==n.y?null:n.y.toString();null!=Qc&&(u.Colgroup=Qc);var Ic=null==n.z?null:n.z.toString();null!=Ic&&(u.Dd=Ic);var Ed=null==n.ba?null:n.ba.toString();null!=Ed&&(u.Del=Ed);var me=null==n.bb?null:n.bb.toString();null!=me&&(u.Dfn=me);var Be=null==n.bc?null:n.bc.toString();null!=Be&&(u.Dir=Be);var ad=null==n.bd?null:n.bd.toString();null!=ad&&(u.Div=ad);var Nc=null==n.be?null:n.be.toString();null!=Nc&&(u.Dl=Nc);var Sc=null==n.bf?null:n.bf.toString();null!=Sc&&(u.Dt=Sc);var Gc=null==n.bg?null:n.bg.toString();
null!=Gc&&(u.Em=Gc);var ie=null==n.bh?null:n.bh.toString();null!=ie&&(u.Fieldset=ie);var cf=null==n.bi?null:n.bi.toString();null!=cf&&(u.Font=cf);var Ge=null==n.bj?null:n.bj.toString();null!=Ge&&(u.Form=Ge);var gf=null==n.bk?null:n.bk.toString();null!=gf&&(u.Frame=gf);var Ie=null==n.bl?null:n.bl.toString();null!=Ie&&(u.Frameset=Ie);var zf=null==n.bm?null:n.bm.toString();null!=zf&&(u.H=zf);var uc=null==n.bn?null:n.bn.toString();null!=uc&&(u.Head=uc);var Rc=null==n.bo?null:n.bo.toString();null!=Rc&&
(u.Hr=Rc);var Dd=null==n.bp?null:n.bp.toString();null!=Dd&&(u.Html=Dd);var Id=null==n.bq?null:n.bq.toString();null!=Id&&(u.I=Id);var Kd=null==n.br?null:n.br.toString();null!=Kd&&(u.Iframe=Kd);var af=null==n.bs?null:n.bs.toString();null!=af&&(u.Img=af);var Dg=null==n.bt?null:n.bt.toString();null!=Dg&&(u.Input=Dg);var oi=null==n.bu?null:n.bu.toString();null!=oi&&(u.Ins=oi);var zg=null==n.bv?null:n.bv.toString();null!=zg&&(u.Isindex=zg);var ec=null==n.bw?null:n.bw.toString();null!=ec&&(u.Kbd=ec);var Bc=
null==n.bx?null:n.bx.toString();null!=Bc&&(u.Label=Bc);var Vc=null==n.by?null:n.by.toString();null!=Vc&&(u.Legend=Vc);var xd=null==n.bz?null:n.bz.toString();null!=xd&&(u.Li=xd);var ee=null==n.ca?null:n.ca.toString();null!=ee&&(u.Link=ee);var Me=null==n.cb?null:n.cb.toString();null!=Me&&(u.Map=Me);var De=null==n.cc?null:n.cc.toString();null!=De&&(u.Math=De);var oe=null==n.cd?null:n.cd.toString();null!=oe&&(u.Menu=oe);var nf=null==n.ce?null:n.ce.toString();null!=nf&&(u.Meta=nf);var Qe=null==n.cf?null:
n.cf.toString();null!=Qe&&(u.Noframes=Qe);var of=null==n.cg?null:n.cg.toString();null!=of&&(u.Noscript=of);var mf=null==n.ch?null:n.ch.toString();null!=mf&&(u.Object=mf);var jg=null==n.ci?null:n.ci.toString();null!=jg&&(u.Ol=jg);var pf=null==n.cj?null:n.cj.toString();null!=pf&&(u.Optgroup=pf);var xb=null==n.ck?null:n.ck.toString();null!=xb&&(u.Option=xb);var Tb=null==n.cl?null:n.cl.toString();null!=Tb&&(u.P=Tb);var Xc=null==n.cm?null:n.cm.toString();null!=Xc&&(u.Param=Xc);var Fd=null==n.cn?null:n.cn.toString();
null!=Fd&&(u.Pre=Fd);var Se=null==n.co?null:n.co.toString();null!=Se&&(u.Q=Se);var pd=null==n.cp?null:n.cp.toString();null!=pd&&(u.S=pd);var lf=null==n.cq?null:n.cq.toString();null!=lf&&(u.Samp=lf);var Ze=null==n.cr?null:n.cr.toString();null!=Ze&&(u.Script=Ze);var Vg=null==n.cs?null:n.cs.toString();null!=Vg&&(u.Select=Vg);var Pi=null==n.ct?null:n.ct.toString();null!=Pi&&(u.Small=Pi);var Sh=null==n.cu?null:n.cu.toString();null!=Sh&&(u.Span=Sh);var wh=null==n.cv?null:n.cv.toString();null!=wh&&(u.Strike=
wh);var rm=null==n.cw?null:n.cw.toString();null!=rm&&(u.Strong=rm);var xf=null==n.cx?null:n.cx.toString();null!=xf&&(u.Style=xf);var lg=null==n.cy?null:n.cy.toString();null!=lg&&(u.Sub=lg);var nd=null==n.cz?null:n.cz.toString();null!=nd&&(u.Sup=nd);var ud=null==n.da?null:n.da.toString();null!=ud&&(u.Tables=ud);var Bd=null==n.db?null:n.db.toString();null!=Bd&&(u.Tbody=Bd);var kl=null==n.dc?null:n.dc.toString();null!=kl&&(u.Td=kl);var fi=null==n.dd?null:n.dd.toString();null!=fi&&(u.Textarea=fi);var ji=
null==n.de?null:n.de.toString();null!=ji&&(u.Tfoot=ji);var wi=null==n.df?null:n.df.toString();null!=wi&&(u.Th=wi);var xl=null==n.dg?null:n.dg.toString();null!=xl&&(u.Thead=xl);var Fl=null==n.dh?null:n.dh.toString();null!=Fl&&(u.Title=Fl);var di=null==n.di?null:n.di.toString();null!=di&&(u.Tr=di);var Xi=null==n.dj?null:n.dj.toString();null!=Xi&&(u.Tt=Xi);var Yi=null==n.dk?null:n.dk.toString();null!=Yi&&(u.U=Yi);var sm=null==n.dl?null:n.dl.toString();null!=sm&&(u.Ul=sm);var Fg=null==n.dm?null:n.dm.toString();
null!=Fg&&(u.Var=Fg);var $f=null==n.dn?null:n.dn.toString();null!=$f&&(u.Unknown=$f);break;case 6:z="List";var Qi=n.a;null!=Qi&&(u.SessionID=Qi);var em=n.b.toString();null!=em&&(u.MaxListLevel=em)}u.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(u)};c.d(K,"a",function(){return x});class x{static get xoa(){null==x.xub&&(x.xub=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.xub}static get oyi(){null==x.zFe&&(x.zFe=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return x.zFe}static i0(y){a.ULS.sendTraceTag(524038472,307,50,y)}static K9h(y){const n={};n.a=y;n.b=0;n.c=0;n.d=0;n.e=0;n.f=0;return n}static Q2m(y){x.xoa||x.i0(k(0,y))}static Z4h(y){const n={};n._sessionID=y;return n}static $ii(y){const n={};n.a=y;n.b=0;n.c=0;return n}static A7m(y){x.xoa||x.i0(k(1,y))}static J9h(y,n){const u={};u.c=f.a[y];u.a=n;return u}static P2m(y,n){x.oyi&&y&&(y.b=n,x.i0(k(5,y)))}static Efi(y){const n={};n.a=y;n.b=
0;n.c=0;n.d=0;n.e=0;n.f=0;n.g=0;n.h=0;n.i=0;n.j=0;n.k=0;n.l=0;n.m=0;return n}static a6m(y){x.xoa||x.i0(k(3,y))}static Ffi(y){const n={};n.a=y;n.b=0;n.c=0;n.d=0;n.e=0;return n}static b6m(y){x.xoa||x.i0(k(4,y))}static dqf(y,n){const u={};u.b=f.a[y];u.c=n;u.d=0;u.e=0;u.f=0;u.g=0;u.h=0;u.i=0;u.j=0;u.k=0;u.l=0;u.m=0;u.n=0;u.o=0;u.p=0;u.q=0;u.r=0;u.s=0;u.t=0;u.w=0;u.x=0;u.y=0;u.z=0;u.u=0;u.v=0;u.ba=0;u.bb=0;return u}static t2m(y,n){x.oyi&&y&&(y.a=n,x.i0(k(2,y)))}static s1l(y){const n={};n.a=y;n.b=-1;return n}static x3m(y){!x.xoa&&
y&&0<=y.b&&x.i0(k(6,y))}}x.xub=null;x.zFe=null;Object(E.a)(x,"UsageEditor",null,[])},1555:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(2),f=c(5);class a{static get Epb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static khb(k,x=!1){const y=f.GraphIterator.$a(k);y.vd();return(x?y.Sb(4):y.Tga(4))?4:f.GraphIterator.$a(k).zb(36)?16:f.GraphIterator.$a(k).zb(14)?2:f.GraphIterator.$a(k).zb(38)?32:1}}Object(E.a)(a,"ConstructTypeHelper",
null,[])},1570:function(E,K,c){c.d(K,"a",function(){return Pa});E=c(0);var l=c(22),f=c(53),a=c(123),k=c(2);K=c(82);var x=c(6),y=c(15),n=c(7),u=c(110),z=c(73),w=c(706),F=c(186),G=c(32),H=c(5),L=c(205),I=c(81),N=c(27),P=c(76),M=c(21),J=c(334),V=c(1512),X=c(212),W=c(257),U=c(704),Y=c(12),ca=c(43),aa=c(36),fa=c(114),pa=c(40),ra=c(270),la=c(143),qa=c(560),La=c(44);class Pa{static get gtm(){return Pa.x5j}static get ptm(){return Pa.B5j}static get ntm(){return Pa.A5j}static get Wg(){return null!=Pa.jxg?Pa.jxg:
Pa.jxg=X.ContextSetEditor.instance}static get vk(){return null!=Pa.hHg?Pa.hHg:Pa.hHg=l.a.instance.resolve("Box4.ITableEditor")}static get gD(){return null!=Pa.$Gg?Pa.$Gg:Pa.$Gg=l.a.instance.Na("Box4.Styles.ITableCellspacingReader")}static KHn(Ka,Na){const sa=Ka.currentNode;M.forEachCell(Ka,Na.rowSpan,Na.colSpan,(wa,ja,ha)=>{const va=wa.currentNode;va!==sa&&(va.hg=!0,Pa.GQh(wa),!ha&&1<=Na.colSpan&&(va.colSpan=Na.colSpan),Pa.Kkj(wa,Na.lja,ja,ha,Na.rowSpan,Na.colSpan))})}static tIn(Ka,Na){M.forEachCell(Ka,
Na.rowSpan,Na.colSpan,sa=>{Pa.REk(sa);Pa.GQh(sa)})}static REk(Ka){Ka=Ka.currentNode;Ka.hg=!0;Ka.q4=!0;Ka.Mob=!0}static GQh(Ka){Ka&&(Ka.Sb(1),Object(u.a)(w.a,Ka.currentNode)&&Ka.Cg())}static HFk(Ka,Na,sa){0<Na&&(Ka=Object(z.a)(F.TableCellNode,Ka.currentNode))&&(Ka.width=sa?Na:f.a.Tl(Na,0))}static SDk(Ka,Na,sa){if(Ka=Object(z.a)(J.TableNode,Ka.currentNode))0<Na&&(Ka.$d=f.a.Cy(Na,0)),0<sa&&(Ka.hu=f.a.Cy(sa,0))}static FFk(Ka,Na){void 0!==Na&&null!==Na&&Ka.currentNode.properties.setValue(x.a.Gqa,Pa.ptm[Na+
""])}static QEk(Ka,Na){void 0!==Na&&null!==Na&&""!==Na&&(Na=parseInt(V.Box4PasteSteward.$Ab(Na),16),Ka.currentNode.properties.setValue(y.a.yH,Na))}static vzk(Ka){if(Ka){if(n.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(La.a)("AdjustingColumnWidthAfterPaste",!0),16==Ka.type){var Na=new H.GraphIterator;Na.set(Ka);if(Na.zb(14)){var sa=P.a(Na),wa=N.TableCellReader.FO(Ka);if(Na.jd(14)){Ka=Na.currentNode;var ja=G.TableReader.yga(Na);if(ja){var ha=Array.clone(ja);Na=G.TableReader.tQd(Na);
var va=0,xa=0;for(var ma=0;ma<ja.length;ma++)ma>=sa&&ma<sa+wa?Na[ma]>ja[ma]&&(va+=Na[ma]-ja[ma],ha[ma]=Na[ma]):xa+=ja[ma]>Na[ma]?ja[ma]-Na[ma]:0;(null==xa||0>=xa||isNaN(xa))&&n.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==va||0>=va||isNaN(va))&&n.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(xa<va)for(sa=0;sa<ja.length;sa++)ha[sa]=Na[sa];else for(ma=0;ma<ja.length;ma++)if((ma<sa||ma>=sa+wa)&&ja[ma]>Na[ma]){const Ja=(ja[ma]-Na[ma])/xa;ha[ma]-=Ja*
va;(null==ha[ma]||0>=ha[ma]||isNaN(ha[ma]))&&n.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Ja)}sa=la.a.sda+(Pa.gD?Pa.gD.Pva(Ka):0);for(ja=0;ja<ha.length;ja++)if(null==ha[ja]||0>=ha[ja]||isNaN(ha[ja]))n.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),ha[ja]=f.a.Tl(sa,0);Ka.eG=ha}else n.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else n.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static dhm(Ka){var Na=
new H.GraphIterator;Na.Zc(Ka);if((Ka=L.OutlineNavigator.T7f(Na))&&I.OutlineReader.fx(Na)){Na=Ka.Hf(x.a.Bo);const sa=Ka.Hf(x.a.marginLeft);Ka=Ka.Hf(x.a.marginRight);return Na-sa-Ka}return 0}static eQm(Ka){return!(void 0===Ka||null===Ka||1===Ka)}static Cic(Ka,Na,sa,wa,ja){if(void 0===Na||null===Na||""!==Na){switch(Na){case "thin":Na=a.a.k$d(.25);break;case "initial":case "medium":Na=a.a.k$d(.5);break;case "thick":Na=a.a.k$d(1);break;default:Na=Pa.Lcm(Na,sa,wa)}ja.currentNode.properties.setValue(Ka,
Na)}}static Bic(Ka,Na,sa){void 0!==Na&&null!==Na&&Na&&sa.currentNode.properties.setValue(Ka,Pa.ntm[Na+""])}static rfo(Ka,Na,sa){void 0!==Na&&null!==Na&&""!==Na&&(Na=parseInt(V.Box4PasteSteward.$Ab(Na),16),sa.currentNode.properties.setValue(Ka,Na))}static Lcm(Ka,Na,sa){let wa=0;const ja=({unit:Ka}=V.Box4PasteSteward.v9d(Ka)).returnValue;switch(Ka){case 5:wa=a.a.k$d(ja);break;case 1:wa=a.a.ITk(ja);break;case 3:wa=a.a.npi(ja);break;case 7:wa=f.a.gCn(ja,sa)}if(6===Na||7===Na||10===Na)wa/=3;return Math.round(wa)}static Mcm(Ka,
Na){let sa=0;const wa=({unit:Ka}=V.Box4PasteSteward.v9d(Ka)).returnValue;switch(Ka){case 5:sa=a.a.Pxa(wa);break;case 1:sa=a.a.h6e(wa);break;case 3:sa=a.a.kwa(wa);break;case 7:sa=f.a.Tl(wa,Na)}return sa}static Lfe(Ka,Na,sa,wa,ja,ha,va){if(ja&&(!va||16===ja.Ve||va||14!==ja.Ve)&&12!==sa){if(va)switch(wa){case 5:wa=x.a.Fqa;var xa=x.a.Xa;var ma=x.a.Wa;var Ja=0;break;case 4:wa=x.a.Eqa;xa=x.a.rb;ma=x.a.qb;Ja=1;break;case 0:wa=x.a.Cqa;xa=x.a.Va;ma=x.a.Ua;Ja=0;break;case 3:wa=x.a.Dqa;xa=x.a.pb;ma=x.a.ob;Ja=
1;break;default:return}else switch(wa){case 5:wa=x.a.GPb;xa=x.a.wpb;ma=x.a.Hkc;Ja=0;break;case 4:wa=x.a.FPb;xa=x.a.vpb;ma=x.a.Gkc;Ja=1;break;case 0:wa=x.a.DPb;xa=x.a.tpb;ma=x.a.Ekc;Ja=0;break;case 3:wa=x.a.EPb;xa=x.a.upb;ma=x.a.Fkc;Ja=1;break;default:return}void 0!==ja.currentNode&&null!==ja.currentNode&&(Pa.eQm(sa)?(Pa.rfo(wa,Ka,ja),Pa.Bic(xa,sa,ja),Pa.Cic(ma,Na,sa,Ja,ja)):ha||va||ja.currentNode.properties.setValue(xa,"nil"))}}static Kkj(Ka,Na,sa,wa,ja,ha){wa||(Pa.tth(Na,Ka,!1,!1),Pa.o1e(Na,Ka,!0,
!1));wa===ha-1&&Pa.o1e(Na,Ka,!0,!1);sa||Pa.Tth(Na,Ka,!0,!1);sa===ja-1&&Pa.Zsh(Na,Ka,!0,!1)}static Ysh(Ka,Na,sa,wa){Ka&&(Pa.Tth(Ka,Na,sa,wa),Pa.o1e(Ka,Na,sa,wa),Pa.Zsh(Ka,Na,sa,wa),Pa.tth(Ka,Na,sa,wa))}static Tth(Ka,Na,sa,wa){Pa.Lfe(Ka.borderTopColor,Ka.borderTopWidth,Ka.borderTopStyle,5,Na,sa,wa)}static o1e(Ka,Na,sa,wa){Pa.Lfe(Ka.borderRightColor,Ka.borderRightWidth,Ka.borderRightStyle,4,Na,sa,wa)}static Zsh(Ka,Na,sa,wa){Pa.Lfe(Ka.borderBottomColor,Ka.borderBottomWidth,Ka.borderBottomStyle,0,Na,sa,
wa)}static tth(Ka,Na,sa,wa){Pa.Lfe(Ka.borderLeftColor,Ka.borderLeftWidth,Ka.borderLeftStyle,3,Na,sa,wa)}static Mfe(Ka,Na,sa){if(sa&&16===sa.Ve&&""!==Ka){switch(Na){case 3:Na=x.a.WHa;var wa=0;break;case 2:Na=x.a.QR;wa=1;break;case 0:Na=x.a.UHa;wa=0;break;case 1:Na=x.a.uP;wa=1;break;default:return}(Ka=Pa.Mcm(Ka,wa))&&sa.currentNode.properties.setValue(Na,Ka)}}static mDk(Ka,Na){Na&&(Pa.yFk(Na,Ka),Pa.JEk(Na,Ka),Pa.tDk(Na,Ka),Pa.cEk(Na,Ka))}static yFk(Ka,Na){Pa.Mfe(Ka.CTk,3,Na)}static JEk(Ka,Na){Pa.Mfe(Ka.BTk,
2,Na)}static tDk(Ka,Na){Pa.Mfe(Ka.zTk,0,Na)}static cEk(Ka,Na){Pa.Mfe(Ka.ATk,1,Na)}static zDk(Ka,Na,sa,wa){var ja=0;const ha=Array(Ka.length);var va=0;wa&&(va=(va=a.a.qad(Pa.dhm(Na)))?va:1);for(wa=0;wa<Ka.length;wa++)ha[wa]=0<va?va/100*Ka[wa]:f.a.Tl(Ka[wa],0),ja+=ha[wa];Ka=sa.getValue(y.a.Fz);wa=new H.GraphIterator;wa.Zc(Na);Na=0;if(N.TableCellReader.Z_(wa)){if(Ka=M.returnToContainingCell(wa))Na=Ka.width;va=P.a(wa);wa=M.returnToContainingTable(wa);if(-1!==va&&va<=wa.eG.length){let xa=0;for(let ma=
va;ma<va+Ka.colSpan&&ma<wa.eG.length;ma++)xa+=wa.eG[ma];Na=Math.min(Na,xa);Na===xa&&(Na-=f.a.Tl(Pa.qfn,0))}}else if(Ka)for(va=0;va<Ka.length;va++)Na+=Ka[va];if(0<Na&&ja>Na&&ja)for(ja=Na/ja,Na=0;Na<ha.length;Na++)ha[Na]*=ja;sa.setValue(y.a.Fz,ha)}static KEk(Ka,Na){Ka.currentNode.setValue(x.a.a1,f.a.Tl(Na,1))}static $lo(Ka){var Na,sa;n.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(La.a)("SettingTableSelectionBounds",!0);var wa=Ka.gb,ja=Ka.tg;Ka=Pa.Wg.NQ(ja,16);if(ja=
Pa.Wg.mT(ja,14))if(ja=ja.node,!ja||14!==ja.type)n.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Ka)n.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(sa=null===(Na=null===wa||void 0===wa?void 0:wa.kb)||void 0===Na?void 0:Na.Me)||void 0===sa?0:sa.Oa)&&wa.kb.Me.Oa.contextId===Y.a.Z0&&W.TableBorderSelectionCache.hPa()&&0<W.TableBorderSelectionCache.hPa().length)){W.TableBorderSelectionCache.nSc(ja);Na=W.TableBorderSelectionCache.I9;Na.leftMostColumnSelected=
Number.MAX_SAFE_INTEGER;Na.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;Na.topMostRowSelected=Number.MAX_SAFE_INTEGER;Na.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(sa=0;sa<Ka.length;sa++){if(Ka.getContext(sa).contextId!==Y.a.tableCell)return;wa=Ka.getContext(sa).node;if(!N.TableCellReader.Qr(wa)){var ha=new H.GraphIterator;ha.set(wa);if(ha.zb(14)&&M.getContainingTable(ha)===ja){ha.jd(14);ha=N.TableCellReader.$Da(ha,wa);if(!ha)return;Array.add(W.TableBorderSelectionCache.hPa(),new U.a(wa,
ha.rowIndex,ha.wo,wa.rowSpan,wa.colSpan));Na.leftMostColumnSelected=Math.min(Na.leftMostColumnSelected,ha.wo);Na.rightMostColumnSelected=Math.max(Na.rightMostColumnSelected,ha.wo);Na.topMostRowSelected=Math.min(Na.topMostRowSelected,ha.rowIndex);Na.bottomMostRowSelected=Math.max(Na.bottomMostRowSelected,ha.rowIndex)}}}W.TableBorderSelectionCache.I9=Na}}else n.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static jgj(Ka){var Na;if(Ka&&14===Ka.type){n.ULS.sendTraceTag(520890258,3022,
50,"Scaling Column Width");Object(La.a)("ScalingColumnWidthForCCP",!0);var sa=new H.GraphIterator;sa.set(Ka);if(sa.vd()&&G.TableReader.ex(sa)){var wa=Ka.eG,ja=G.TableReader.tQd(sa),ha=M.returnToContainingCell(sa),va=M.getContainingTable(sa);if(ha&&va){var xa=P.a(sa),ma=N.TableCellReader.FO(ha);if(sa.jd(14)){var Ja=G.TableReader.yga(sa);sa=0;for(let oa=xa;oa<xa+ma;oa++)sa+=Ja[oa];xa=la.a.xM(ha,va,x.a.uP,x.a.za,0);ha=la.a.xM(ha,va,x.a.QR,x.a.Aa,0);sa-=f.a.Tl(xa+ha,0);(null==sa||0>=sa||isNaN(sa))&&n.ULS.sendTraceTag(521187332,
3022,50,"Containing cell width is invalid for cell margins {0} & {1}",xa,ha);ha=0;for(va=0;va<wa.length;va++)ha+=wa[va];va=sa/ha;(null==va||0>=va||isNaN(va))&&n.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");xa=0;for(ma=0;ma<wa.length;ma++)Ja=wa[ma],wa[ma]*=va,wa[ma]<ja[ma]&&(wa[ma]=ja[ma],1>va&&(null===(Na=k.AFrameworkApplication.K)||void 0===Na?0:Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(va=(sa-ja[ma])/(ha-Ja))),xa+=wa[ma];xa>sa&&(wa=
Array.clone(ja));Na=la.a.sda+(Pa.gD?Pa.gD.Pva(Ka):0);for(ja=0;ja<wa.length;ja++)if(null==wa[ja]||0>=wa[ja]||isNaN(wa[ja]))n.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),wa[ja]=f.a.Tl(Na,0);Na=new ca.GraphTransaction(4);Na.Cb(Ka);Ka.eG=wa;Na.dispose()}}}else n.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else n.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static S2n(Ka){if(!Ka||!G.TableReader.sGf(Ka)||1!=Ka.xq())return n.ULS.sendTraceTag(525361986,
3022,50,"Outline iterator should contain a single table"),null;n.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(La.a)("ReplaceTableContentForExternalPaste",!0);let Na=new H.GraphIterator;Na.set(Ka.currentNode);Na.zb(14);aa.OutlineElementNavigator.Ge(Na);const sa=new H.GraphIterator;sa.set(Ka.currentNode);sa.zb(14);if(!sa.jd(14)||!Na||14!=Na.currentNode.type)return null;if(Ka=M.getContainingTableCell(Na))if(Ka=N.TableCellReader.$Da(sa,Ka)){if(W.TableBorderSelectionCache.QPc())var wa=
this.Zam();else{wa=G.TableReader.fg(Na.currentNode)-(G.TableReader.fg(sa.currentNode)-Ka.rowIndex);var ja=G.TableReader.Yg(Na.currentNode)-(G.TableReader.Yg(sa.currentNode)-Ka.wo);this.$tk(sa,wa,ja);wa=new ra.a(Ka.wo,G.TableReader.Yg(sa.currentNode)-1,Ka.rowIndex,G.TableReader.fg(sa.currentNode)-1)}if(!wa)return null;ja=wa.bottomMostRowSelected-wa.topMostRowSelected+1;var ha=wa.rightMostColumnSelected-wa.leftMostColumnSelected+1;ja=Math.min(ja,G.TableReader.fg(Na.currentNode));ha=Math.min(ha,G.TableReader.Yg(Na.currentNode));
for(let va=0;va<ja;va++){M.moveToCell(sa,va+wa.topMostRowSelected,wa.leftMostColumnSelected);M.moveToCell(Na,va,0);for(let xa=0;xa<ha;xa++)va==Ka.rowIndex-wa.topMostRowSelected&&xa==Ka.wo-wa.leftMostColumnSelected||this.LOi(Na,sa),M.moveToNextColumn(sa),M.moveToNextColumn(Na);sa.Ht(14);Na.Ht(14)}M.moveToCell(sa,Ka.rowIndex,Ka.wo);Ka.rowIndex-wa.topMostRowSelected<G.TableReader.fg(Na.currentNode)&&Ka.wo-wa.leftMostColumnSelected<G.TableReader.Yg(Na.currentNode)?M.moveToCell(Na,Ka.rowIndex-wa.topMostRowSelected,
Ka.wo-wa.leftMostColumnSelected):Na=null;this.LOi(Na,sa);sa.Ht(14);M.moveToCell(sa,wa.topMostRowSelected,wa.leftMostColumnSelected);sa.Qd();return sa.currentNode}}static AAn(Ka){if(Ka&&G.TableReader.sGf(Ka)&&1==Ka.xq()){n.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(La.a)("PasteTableBelowTable",!0);var Na=new H.GraphIterator;Na.set(Ka.currentNode);Ka=fa.a.$a(Ka.currentNode);Na.Ep()&&Ka.Ep()&&(aa.OutlineElementNavigator.q0(Ka,!1,!0),pa.OutlineElementReader.Dh(Ka)&&1==Ka.xq()&&
(aa.OutlineElementNavigator.Ge(Na),aa.OutlineElementNavigator.Ge(Ka),Na&&Ka&&Na.currentNode!=Ka.currentNode&&G.TableReader.isTable(Na)&&G.TableReader.isTable(Ka)&&this.Ybn(Na,Ka)&&(n.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),Na.Cg(),Na.Cg())))}else n.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static LOi(Ka,Na){if(Na&&N.TableCellReader.isTableCell(Na)){var sa=Na.xq();if(Ka&&N.TableCellReader.isTableCell(Ka)&&Ka.wA())for(;Ka.wA();)Ka.Qd(),
Na.Jf(Ka.currentNode,Ka.role),Ka.Cg();else sa--;for(;0<sa--;)Na.Qd(),Na.Cg()}}static Ybn(Ka,Na){if(!G.TableReader.isTable(Ka)||!G.TableReader.isTable(Na))return!1;var sa=G.TableReader.Yg(Ka.currentNode),wa=G.TableReader.Yg(Na.currentNode);if(sa!=wa)return n.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;sa=G.TableReader.fg(Ka.currentNode);wa=G.TableReader.fg(Na.currentNode);const ja=new ca.GraphTransaction(4);ja.Cb(Na.currentNode);Na.currentNode.setValue(y.a.Qya,
sa+wa);for(ja.dispose();Ka.wA();){Ka.Qd();Na.Jf(Ka.currentNode,1);sa=new H.GraphIterator;sa.set(Ka.currentNode);Ka.Cg();sa.Qd();do sa.currentNode&&16==sa.currentNode.type&&(sa.currentNode.QE=Na.currentNode);while(sa.xt())}return!0}static $tk(Ka,Na,sa){n.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(La.a)("AddRowAndColumnForExternalCCP",!0);Pa.wAa=qa.a.P7b;0<Na&&(M.moveToLastRow(Ka),n.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+Na),this.vk.insertRows(Ka,
!1,Na,this.wAa),n.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Ka.jd(14));0<sa&&(n.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+sa),this.vk.insertColumns(Ka,G.TableReader.Yg(Ka.currentNode),!1,sa,this.wAa),n.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static Zam(){return W.TableBorderSelectionCache?W.TableBorderSelectionCache.I9:null}}Pa.qfn=8;Pa.Cgn="Normal Table";Pa.nPh="Table Grid";Pa.wAa=null;Pa.x5j=K.a.B5("MsoNormalTable","Normal Table",
"MsoTableGrid",Pa.nPh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4",
"MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1",
"Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5",
"Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful",
"MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1",
"MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3",
"List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6",
"List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3",
"List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5",
"MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6",
"MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");Pa.B5j=K.a.B5("0","center","1","top","2","center","3",
"bottom");Pa.A5j=K.a.B5("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(E.a)(Pa,"Box4TableStewardHelper",null,[])},1574:function(E,K,c){c.d(K,"a",function(){return X});E=c(0);var l=c(74),f=c(177),a=c(22),k=c(171),x=c(2),y=c(239),n=c(6),u=c(84),z=c(60),w=c(9),F=c(43),G=c(589),H=c(212),L=c(235),I=c(8),N=c(246),P=c(18),M=c(12),J=c(280),V=c(3);class X{static get Wg(){return H.ContextSetEditor.instance}static get Xf(){return L.a.instance}static get Ic(){return f.a.instance}static Zw(){return X.Tm||
(X.Tm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get MA(){return null!=X.gFg?X.gFg:X.gFg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static wfm(){this.VN||(this.VN=new l.a,this.VN.add(V.a.RA),this.VN.add(V.a.font),this.VN.add(V.a.HY),this.VN.add(V.a.bua),this.VN.add(V.a.bold),this.VN.add(V.a.setItalic),this.VN.add(V.a.superscript),this.VN.add(V.a.subscript),this.VN.add(V.a.IZa),this.VN.add(V.a.$ta),this.VN.add(V.a.HCa),this.VN.add(V.a.k6e),this.VN.add(V.a.ICa),this.VN.add(V.a.HZa),
this.VN.add(V.a.G_),this.VN.add(V.a.U0),this.VN.add(V.a.clearFormatting),this.VN.add(V.a.veb),this.VN.add(V.a.mGc));return this.VN}static R$b(W){return X.wfm().contains(W)?!0:!1}static dw(W,U,Y,ca,aa){var fa=!0;if(!U.view.qe)return 2;var pa=U.view,ra=pa.lb;ra&&ra.gb.kb||(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.noSelection}),fa=!1);X.Wg.$Ca(P.ImageReader.oUc,pa.lb.tg)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.r9e}),fa=!1);if(X.Wg.$Ca(P.ImageReader.x2a,pa.lb.tg))return X.Ic.Yb(u.a.kf,{["Reason"]:z.a.lHc}),8;var la=!X.R$b(W);
X.Xf.V$b(pa.lb.tg,la)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.RE}),fa=!1);X.Wg.$Ca(P.ImageReader.rYd,pa.lb.tg)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.m9e}),fa=!1);X.Wg.$Ca(J.c,pa.lb.tg)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.n9e}),fa=!1);X.Wg.$Ca(N.a.eDf,pa.lb.tg)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.l9e}),fa=!1);X.Wg.qza(I.ParagraphReader.oU,pa.lb.tg)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.hO}),fa=!1);X.Zw()&&X.Zw().instance&&X.Zw().instance.tU(pa.lb.tg)&&(X.Ic.Yb(u.a.kf,{["Reason"]:z.a.externalSelection}),fa=!1);var qa=null;
ra&&ra.gb.kb&&(qa=ra.gb.kb);if(1===Y||!fa||!qa)return fa?32:8;fa=W===V.a.Ecc||W===V.a.p2b||W===V.a.Ehc||W===V.a.H6b;pa=W===V.a.QLb||W===V.a.XBb||W===V.a.Wgc;la=W===V.a.bTa||W===V.a.cTa||W===V.a.fD;const La=new F.GraphTransaction(15);La.Cb(qa.Oa.node);qa=new l.a;let Pa=!1;if(fa||pa||la)k.a.mark(7121),U=X.Wg.f2h(U.$j);else{k.a.mark(7119);U=G.OutlineElementGeneralizer.qna(ra.gb,!0);if(!U)return X.Ic.Yb(u.a.gna,{["Reason"]:z.a.hLd}),La.dispose(),8;ra=W===V.a.f2a||W===V.a.Nib;U.$w&&ra&&(Pa=X.Qpm(qa,U))}(W===
V.a.leftJustify||W===V.a.Ecc||W===V.a.centerJustify||W===V.a.p2b||W===V.a.rightJustify||W===V.a.Ehc||W===V.a.fullJustify||W===V.a.H6b)&&U.$w&&1<U.length&&X.Rpm(U)&&(aa||(aa={}),Object.getType(aa)===Object&&(aa.InContextSet=!0));x.AFrameworkApplication.va.Of(U,W,Y,!0,ca,aa);Pa&&X.Ign(qa,U,aa);La.dispose();w.App.xa.updateCommandUI();fa||pa||la?k.a.mark(7122):k.a.mark(7120);return 32}static Qpm(W,U){if(!U.$w)return!1;let Y=!1,ca=!1;for(let fa=0;fa<U.length;fa++)if(U.getContext(fa).el){var aa=U.getContext(fa).node;
aa&&(aa=X.MA.Ahb(aa),2===aa.specialIndentType?(Y=!0,W.add(fa)):1!==aa.specialIndentType&&aa.specialIndentType||(ca=!0))}return ca&&Y}static Ign(W,U,Y){if(U.$w)for(let aa=0;aa<W.count;aa++){var ca=U.getContext(W.J(aa));if(!ca.el)continue;ca=ca.node;const fa=X.MA.Ahb(ca);2!==fa.specialIndentType||y.a.ywa(Y.value,fa.zB)||ca.setValue(n.a.$d,fa.zB-fa.mda)}}static Ncg(W,U){let Y=!0;U.contextId!==M.a.paragraph?Y=!1:X.Xf.i3a(U)?(X.Ic.Yb(u.a.hn,{["Reason"]:z.a.RE}),Y=!1):X.Zw()&&X.Zw().instance&&X.Zw().instance.tU(U)?
(X.Ic.Yb(u.a.hn,{["Reason"]:z.a.externalSelection}),Y=!1):U.el&&(U=U.node,I.ParagraphReader.Vb(U)&&U.wQ&&(X.Ic.Yb(u.a.hn,{["Reason"]:z.a.hO}),Y=!1));return{returnValue:1!==W&&Y,gy:Y?32:8}}static Rpm(W){if(!W.$w)return!1;let U=1;for(let ca=0;ca<W.length;ca++){var Y=W.getContext(ca);if(Y&&Y.el&&Y.contextId===M.a.paragraph&&(Y=Y.node))if(Y=I.ParagraphReader.Ex(Y),!ca)U=Y;else if(Y!==U)return!0}return!1}}X.Tm=null;X.VN=null;Object(E.a)(X,"FormattingActionHelper",null,[])},1577:function(E,K,c){c.d(K,"a",
function(){return f});c.d(K,"b",function(){return a});var l=c(2);const f=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?
void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1588:function(E,K,c){c.r(K);E=c(0);var l=c(2),f=c(126),a=c(22),k=c(53),x=c(354),y=c(43),n=c(5);class u{odf(Fb,Va,Wa){return 1===Wa?32:u.rjl(Va.node)}static rjl(Fb){const Va=new n.GraphIterator;Va.set(Fb);Va.Ep();Fb=new y.GraphTransaction(7);Fb.ku(Va);Va.Cg();Fb.dispose();return 32}}Object(E.a)(u,"DeleteOutlineLevelContentStrategy",null,[]);var z=c(145),w=c(152),F=c(79),G=c(212),H=c(17),L=c(23),I=c(8),N=
c(101),P=c(36),M=c(205),J=c(81),V=c(28);class X{constructor(Fb){this.Jm=null;this.Cla=Fb}get Bzb(){return null!=this.Vvg?this.Vvg:this.Vvg=a.a.instance.Na("Box4.IAutoCorrectRules")}get SW(){return null!=this.Xvg?this.Xvg:this.Xvg=a.a.instance.Na("Box4.IAutoCorrectScheduler")}get RM(){return null!=this.LEg?this.LEg:this.LEg=a.a.instance.Na("Box4.Pages.IPageContentEditor")}get lL(){return null!=this.iEg?this.iEg:this.iEg=a.a.instance.Na("Box4.IOutlineEditor")}get Pg(){return this.Jm||(this.Jm=this.Cla())}eFi(Fb,
Va,Wa){if(this.lL&&X.Sn){var jb=G.ContextSetEditor.$qf(Va);Fb=jb.node;H.SelectionEditor.Gk(jb)&&(jb=V.a.Rc(Fb,I.ParagraphReader.textLength(Fb)));var mc=N.FormattingReader.language(N.FormattingReader.Kr(jb));jb=n.GraphIterator.$a(Wa.Yc);X.vh.m5c(jb);var yb=Fb=null;if(jb)for(let Oa=jb.Sb(1);Oa&&!yb;Oa=jb.xi(1))J.OutlineReader.Jwa(Oa)&&(yb=Oa);if(jb&&!yb){if(!this.RM||!this.lL)return;Fb=new y.GraphTransaction(7);Fb.ku(jb);yb=this.RM.HGd(jb);this.lL.o7(jb,!0);mc&&(P.OutlineElementNavigator.Ge(jb),jb=
V.a.Rc(jb.currentNode,0),X.Sn.xge(N.FormattingReader.Kr(jb),mc))}mc=L.SelectionFactory.ho(yb,!0);Wa.lb.setSelection(mc);H.SelectionEditor.gf(Va)&&(Wa=n.GraphIterator.$a(Va.node),Wa.Ep(),M.OutlineNavigator.T7f(Wa),this.Bzb&&this.SW&&J.OutlineReader.EA(Wa,Va,!0)&&(Va=this.Bzb.Tjf(Va,-1,!1,F.a.Aw))&&this.SW.wgj(Va));this.Pg&&this.Pg.iF();Fb&&Fb.dispose()}}static get Sn(){return null!=X.Tzg?X.Tzg:X.Tzg=a.a.instance.Na("Box4.IFormattingEditor")}static get instance(){return null!=X.zCg?X.zCg:X.zCg=X.Rl()}static Rl(){return new X(()=>
a.a.instance.Na("Box4.IUndoManager"))}static get vh(){return w.PageNavigator.instance}}Object(E.a)(X,"TitleViewEditor",null,[]);var W=c(46),U=c(466),Y=c(634),ca=c(21),aa=c(12),fa=c(280),pa=c(3);class ra{constructor(){this.b0j=new u;this.odf=(Fb,Va,Wa,jb,mc)=>this.b0j.odf(Fb,Va,Wa,jb,mc)}Tb(Fb){const Va=this.iQh.ydf.bind(this.iQh),Wa=this.odf,jb=this.ZPh.wjl.bind(this.ZPh);this.L3f(Fb,Va,Wa,jb);Fb.qa(pa.a.backspace,aa.a.Tc,jb);Fb.qa(pa.a.backspace,aa.a.Hd,jb);Fb.qa(pa.a.backspace,aa.a.endOfParagraph,
f.ActionManager.FQ);Fb.qa(pa.a.backspace,aa.a.outline,Wa);Fb.qa(pa.a.backspace,aa.a.view,Va);Fb.Vc(pa.a.backspace,1124);Fb.qa(pa.a.Oua,aa.a.Tc,f.ActionManager.FQ);Fb.qa(pa.a.Oua,aa.a.Hd,jb);Fb.qa(pa.a.Oua,aa.a.endOfParagraph,f.ActionManager.FQ);Fb.qa(pa.a.Oua,aa.a.outline,Wa);Fb.qa(pa.a.Oua,aa.a.view,Va);Fb.fb(pa.a.dHd,aa.a.view,Va,1124);Fb.qa(pa.a.CH,aa.a.Tc,jb);Fb.qa(pa.a.CH,aa.a.Hd,jb);Fb.qa(pa.a.CH,aa.a.endOfParagraph,f.ActionManager.FQ);Fb.qa(pa.a.CH,aa.a.outline,Wa);Fb.qa(pa.a.CH,aa.a.view,
Va);Fb.Vc(pa.a.CH,1124);Fb.fb(pa.a.Kbf,aa.a.view,Va,1124);Fb.fb(pa.a.Kma,aa.a.view,ra.Kma,1028)}L3f(){}static get vh(){return w.PageNavigator.instance}static get lg(){return null!=ra.lEg?ra.lEg:ra.lEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get RM(){return null!=ra.IEg?ra.IEg:ra.IEg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get lL(){return null!=ra.hEg?ra.hEg:ra.hEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Xb(){return null!=ra.$yg?ra.$yg:ra.$yg=a.a.instance.Na("Box4.IFeatureHelper")}static Kma(Fb,
Va,Wa,jb,mc){jb=Va.view;if(!jb.lb||!jb.lb.gb.kb||H.SelectionEditor.km(jb.lb.gb.kb))return 8;if(1===Wa)return 32;Wa=jb.lb.gb;const yb=Wa.kb;var Oa=yb.Oa,Gb=null,Wb=!1;if(Wa.vJ){if(Oa.contextId===aa.a.outline&&1===Wa.length){for(Fb=n.GraphIterator.$a(Oa.node);Fb.Qd();)Fb.Cg();ra.lL.o7(Fb,!0);P.OutlineElementNavigator.Ge(Fb);Fb=L.SelectionFactory.ue(Fb.currentNode,0);jb.lb.setSelection(Fb);return 32}var kc=Oa.node;Gb=null;if(fa.c(Oa)){var Mb=kc.De(jb.ic);Mb&&(Mb=Mb.dkp)&&0<=Mb.width&&0<=Mb.height&&(Gb=
new U.a(k.a.Tl(Mb.x,0),k.a.Tl(Mb.y,1)));Gb||(Gb=Y.a(kc))}else Gb=Y.a(Oa.node);Oa=n.GraphIterator.$a(Oa.node);Oa.Ep();ra.vh.m5c(Oa);kc=ra.RM.HGd(Oa);Y.b(kc,Gb.x,Gb.y);ra.lL.o7(Oa,!0);Gb=L.SelectionFactory.ho(kc,!0)}else if(1===Wa.length){Wb=Wa.last;Oa=W.a.mBb(Wb);if(ra.Xb&&ra.Xb.isFeatureEnabled(25)&&G.ContextSetEditor.instance.Feg(Oa).returnValue)return 2;Wb=Wb.Pc;Wb=!Wa.qw&&(H.SelectionEditor.Gk(Wb)||I.ParagraphReader.lm(Wb)||H.SelectionEditor.G8(Wb))}Wb&&(Wb=H.SelectionEditor.xj(yb,!1,!1,void 0,
!1),jb.lb.setSelection(Wb),l.AFrameworkApplication.va.Of(Va,pa.a.newLine,2,!1,null,mc),Gb=jb.lb.gb.kb,jb.lb.setSelection(yb));mc||(mc=new x.DictionaryPropertySet);mc.setValue(z.a.QJc,!0);l.AFrameworkApplication.va.Of(Va,pa.a.CH,2,!0,null,mc);if(Gb&&Gb.Oa.isValid)return jb.lb.setSelection(Gb),32;Wa.vJ&&X.instance.eFi(Fb,Va.$j,jb);H.SelectionEditor.km(jb.lb.gb.kb)||l.AFrameworkApplication.va.Of(Va,pa.a.newLine,2,!1,null,mc);return 32}static qjl(Fb,Va){if(1===Va)return 32;Va=new y.GraphTransaction(7);
Va.Cb(Fb);ra.lg.WGa(Fb);Va.dispose();return 32}}Object(E.a)(ra,"ADeleteActor",null,[]);var la=c(9),qa=c(235),La=c(256),Pa=c(1508),Ka=c(58),Na=c(19),sa=c(110),wa=c(73),ja=c(116),ha=c(691),va=c(48);class xa{get Xf(){return qa.a.instance}wjl(Fb,Va,Wa,jb,mc){jb=null===mc||void 0===mc?void 0:mc.jbd;if(1===Wa)return 32;var yb=Fb===pa.a.backspace;if(this.Xf.gh){if(this.Xf.Zwi(Va)&&xa.Mfa&&(Wa=Va.clone(),Wa.Rb+=1,--Wa.Eb,this.Xf.Ebc(Wa)))return xa.Mfa.d9i([Wa]),32;if(this.Xf.jEf(Va,yb))return 2}if(xa.Zw()&&
xa.Zw().instance&&xa.Zw().instance.tU(Va))return 4;var Oa=Va.node;let Gb=Va.cpBegin;Wa=Va.cpEnd;let Wb=Va.Eb,kc=Va.Rb;const Mb=I.ParagraphReader.text(Oa),Qc=Mb.length;let Ic=!1;if(Gb===Wa){if(yb&&!Gb||!yb&&Gb===Qc)return 2;yb?({cp:Gb,returnValue:Ic}=this.Xf.JOi(Oa,Gb),Ic||({cp:Gb,hma:Wb,returnValue:Ic}=this.Xf.IOi(Va,Gb,Wb)),Ic||(Gb--,Na.a.pz(Mb,Gb)&&Gb--),Fb=pa.a.H2e):({cp:Wa,returnValue:Ic}=this.Xf.aen(Oa,Wa),Ic||({cp:Wa,hma:kc,returnValue:Ic}=this.Xf.$dn(Va,Wa,kc)),Ic||(Wa++,Na.a.pz(Mb,Wa)&&Wa++),
Fb=pa.a.HPh)}Va=Gb===Wa?V.a.Rc(Oa,Gb):V.a.createTextRange(Oa,Gb,Wa);Ic&&this.Xf.gh&&(yb?Va.Eb=Wb:Va.Rb=kc);if(!this.Xf.Ebc(Va))return 2;this.N_b(Oa);yb=new y.GraphTransaction(15);yb.fk=Fb;yb.Cb(Oa);Oa=Object(sa.a)(ha.a,mc)&&mc.z0a;if(!xa.Ld.rg||Oa||va.a.pr&&xa.FCa.b_d(W.a.instance.gb.kb))this.$Ph(Va,jb);else{Oa=xa.Ld.oZa();try{const Ed=xa.Fh.O8c(Va);let me;if(({type:me}=Ed.DSd()).returnValue){const Be=Object(wa.a)(112,mc);Be&&Be.ia(ja.a.sCf,!1)||!va.a.pr&&4===me?xa.Ld.Y4a=me:xa.Ld.Ls(me)}mc=0;for(let Be=
Ed.length-1;0<=Be;--Be){let ad;const Nc=({F_d:ad}=Ed.getContext(Be)).returnValue;ad?(xa.hyperlinkEditor.Flb(Nc,null),mc+=xa.lj.zob(Nc,2),xa.lj.gGd=Wa+mc):this.$Ph(Nc,jb)}}finally{Oa&&Oa.dispose()}}yb.dispose();return 32}N_b(){}static get Ld(){return null!=xa.aIg?xa.aIg:xa.aIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lj(){return null!=xa.MHg?xa.MHg:xa.MHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Fh(){return null!=
xa.wIg?xa.wIg:xa.wIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=xa.DAg?xa.DAg:xa.DAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static Zw(){return xa.Tm||(xa.Tm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Mfa(){xa.ytb||(xa.ytb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return xa.ytb.instance}static get FCa(){return null!=xa.iwg?xa.iwg:xa.iwg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}
xa.Tm=null;xa.ytb=null;Object(E.a)(xa,"ADeleteParagraphContentStrategy",null,[]);var ma=c(169),Ja=c(802),oa=c(216),za=c(227),Fa=c(78),kb=c(74),fb=c(77);class lb extends xa{constructor(){super()}get characterPropertiesEditor(){return null!=this.pwg?this.pwg:this.pwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Tq(){return null!=this.fwg?this.fwg:this.fwg=a.a.instance.Sa("Box4.ContentControlConfigSettings")}get Gdc(){return null!=this.VDg?this.VDg:this.VDg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get fX(){return null!=
this.Owg?this.Owg:this.Owg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get qOa(){return null!=this.mzg?this.mzg:this.mzg=a.a.instance.resolve("Box4.IFieldEditor")}$Ph(Fb,Va){this.Iil(Fb,Va)}Kzk(Fb,Va,Wa,jb){this.Tq.instance&&this.Tq.instance.gh&&(Fb.cpBegin===Va.cpBegin?Fb.Eb=Va.Eb:Wa&&(Fb.Eb=Wa.Jb&&Wa.Jb.length?0:-1),Fb.Rb=jb)}N_b(Fb){const {DeleteActor:Va}=c(1588);Va.N_b(Fb)}Iil(Fb,Va){var Wa=Fb.node;const jb=za.b([new ma.a(Fb.cpBegin,Fb.cpEnd)],this.Igm(Fb));var mc=new fb.a,yb=[];lb.q_k(Wa,
jb,mc,yb);for(const Oa of mc.keys)1<mc.J(Oa)&&Ja.a.fSi(Ka.a.Ff(Oa));this.DYn(Wa,yb);this.Gdc.oGc(Wa);Wa=Fb.Rb;mc=!!this.Tq.instance&&this.Tq.instance.gh;for(yb=jb.length-1;0<=yb;yb--)Wa=this.deleteRange(Fb,jb[yb],Wa,mc,Va)}Igm(Fb){const Va=[],Wa=Fb.node;var jb=Fa.f(Wa,Oa=>Oa.gma);for(var mc of jb)jb=mc.Ib.cp,Va.push(new ma.a(jb,jb+1));mc=[];oa.a.h8?this.qOa&&(mc=this.qOa.g8h(Wa,Fb)):mc=I.ParagraphReader.TOa(Wa);for(var yb of mc)this.NNm(yb,Fb)&&Va.push(yb);yb=!!this.Tq.instance&&this.Tq.instance.soa;
this.Tq.instance&&this.Tq.instance.gh||!yb||!Wa.Us||(lb.UHh&&lb.UHh.CXn(Fb),this.fX&&Va.push(...this.fX.xof(Wa).toArray()));return za.a(Va)}NNm(Fb,Va){return oa.a.h8?this.qOa?!this.qOa.rvi(Fb,Va):!1:!Fb.NK||!lb.ZCf(Fb,Va)}DYn(Fb,Va){const Wa=new kb.a;for(const jb of Va)for(Va=0;Va<jb.length;){Va=this.g$h(jb,Va,0);if(-1===Va)break;let mc=this.g$h(jb,Va+1,3);if(-1===mc)break;if(jb.J(Va).NK)for(;mc>=Va;){const yb=jb.J(mc);Wa.add(yb.pe);jb.remove(yb);mc--}Va=mc+1}Fb.Upa(Wa)}g$h(Fb,Va,Wa){for(;Va<Fb.length;Va++){const jb=
Fb.J(Va);if(1===jb.nF&&jb.xg===Wa)return Va}return-1}deleteRange(Fb,Va,Wa,jb,mc){const yb=Va.begin,Oa=Va.end;Va=null;jb&&(Va=Fb.node.pa.Qh(yb));yb<Oa&&(jb=V.a.createTextRange(Fb.node,yb,Oa),this.Kzk(jb,Fb,Va,Wa),this.characterPropertiesEditor.replaceTextRange(jb,"",void 0,void 0,pa.a.NEc,!1,mc));return Wa=Va&&Va.Jb&&Va.Jb.length?Va.Jb.length:-1}static get UHh(){return null!=lb.Xwg?lb.Xwg:lb.Xwg=a.a.instance.Na("WordEditor.ContentControl.IContentControlOperator")}static ZCf(Fb,Va){return Fb.begin>=
Va.cpBegin&&Fb.end<=Va.cpEnd}static q_k(Fb,Va,Wa,jb){let mc=0;Fb=Fb.pa;for(const yb of Va)for(;mc<Fb.length;){Va=Fb.J(mc);if(Va.cp>=yb.begin&&Va.cp<yb.end&&(Va.ed&&Va.ed.a4k&&jb.push(Va.ed),Va.Gh))for(let Oa=0;Oa<Va.Gh.length;Oa++){const Gb=Va.Gh.J(Oa).kn.toString();Wa.nb(Gb)?Wa.Z(Gb,Wa.J(Gb)+1):Wa.Z(Gb,1)}++mc}}}Object(E.a)(lb,"DeleteParagraphContentStrategy",xa,[]);class sb{static get XJ(){return La.a.instance}static Rjl(Fb,Va,Wa){if(1===Wa)return 32;Fb=Va.node;return sb.XJ.lCd(Fb)?ra.qjl(Fb,Wa):
32}}Object(E.a)(sb,"DeleteUnsupportedObjectStrategy",null,[]);var ab=c(171),Ga=c(308),Ua=c(177),wb=c(372),cc=c(7),zb=c(1030),nb=c(40),eb=c(114),Ib=c(1613),Xa=c(401),Ra=c(525),gb=c(589),Bb=c(840),$b=c(165),Qb=c(138),Ac=c(202),Db=c(503),dc=c(32),Pb=c(124);class Ub{constructor(Fb,Va,Wa,jb,mc){this.d1o=Fb;this.G9=Wa;this.xd=jb;this.actionId=Va;this.jbd=mc}}Object(E.a)(Ub,"DeleteActionData",null,[]);var rb=c(1010),Yb=c(140),Ya=c(860);class Ob{constructor(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb,kc){this.aQh=Fb;this.Xf=
Va;this.XJ=Wa;this.hyperlinkEditor=jb;this.L_=mc;this.zk=yb;this.l_i=Oa;this.characterPropertiesEditor=Gb;this.Ld=Wb;this.FCa=kc}QKo(Fb){return!H.SelectionEditor.ml(Fb)&&!H.SelectionEditor.Zba(Fb)}pbm(Fb,Va,Wa){var jb;let mc,yb,Oa;if(!Va&&Fb&&Fb.iy&&(jb=Fb.Oa)&&H.SelectionEditor.gf(jb)&&this.zk.Vb(jb.node)&&(mc=jb.node.pa.Qh(jb.cpBegin))&&mc.Pm&&(yb=this.jPl(mc))&&yb.hyperlink.CG&&(Oa=this.dbm(Fb,yb.cp)))return Oa;if(!Fb)return null;if(va.a.Pj&&(jb=this.FOo(Fb,Va)))return jb;if(!Wa)return Fb;Va=H.SelectionEditor.SDa(Fb,
!Va,{OA:!1,ys:!0,GC:!0,jE:!0});return L.SelectionFactory.oA(Fb,Va.Oa,!1)}jPl(Fb){const Va=Fb.paragraph.pa;let Wa=null;Fb=Fb.cp;for(let jb=0;jb<Va.length;jb++){const mc=Va.J(jb);if(mc.cp>=Fb)break;mc.Pm&&(Wa=null);mc.hyperlink&&(Wa=mc)}return Wa}gbm(Fb,Va){var Wa=Fb.Oa.node;if(Va){if(Va=H.SelectionEditor.mTa(Fb.Oa.node,Fb.Oa.cpBegin,!0),Fb=L.SelectionFactory.oA(Fb,V.a.Rc(Fb.Oa.node,Va),!1),Wa=Wa.pa.Qh(Va),Wa.V_||Wa.qU)Fb.Oa.Eb=0}else if(Va=H.SelectionEditor.mTa(Fb.Oa.node,Fb.Oa.cpBegin,!1),Fb=L.SelectionFactory.oA(Fb,
V.a.Rc(Fb.Oa.node,Va),!1),Wa=Wa.pa.Qh(Va),Wa.V_||Wa.qU)Fb.Oa.Eb=Wa.zw+Wa.eN;Fb.sac=!0;return Fb}FOo(Fb,Va){var Wa=Fb.Oa;let jb=null;if(!Fb.iy||!Wa||!H.SelectionEditor.gf(Wa))return null;if(this.zk.Vb(Wa.node)&&(jb=Va?Wa.node.pa.Qh(Wa.cpBegin):Wa.node.pa.thb(Wa.cpBegin-1))&&jb.gR)return this.gbm(Fb,Va);Wa=n.GraphIterator.$a(Fb.Oa.node);if(!Wa.zb(8))return null;P.OutlineElementNavigator.Vd(Wa);let mc=!1;const yb=[];if(Va?jb&&jb.Uh:0===Fb.Oa.cpBegin){do(Fb=Va?P.OutlineElementNavigator.Ur(Wa,!0,!0,!1):
P.OutlineElementNavigator.q0(Wa,!0,!0,!1))&&(null===Fb||void 0===Fb?0:Fb.FPa)?(yb.push(V.a.create(P.OutlineElementNavigator.Ge(Wa))),P.OutlineElementNavigator.Vd(Wa)):mc=!0;while(!mc);if(0<yb.length)return Va=new $b.Selection(Va?yb:yb.reverse(),Va),Va.sac=!0,Va}return null}dbm(Fb,Va){var Wa=H.SelectionEditor.TDa(Fb,{OA:!1,ys:!1,GC:!0,jE:!0});if(!Wa||!Wa.iy||Wa.Oa.node!==Fb.Oa.node)return null;Wa=Wa.Oa;if(Wa.cpBegin!==Wa.cpEnd)return null;const jb=this.zk.text(Wa.node);for(let mc=Wa.cpBegin-1;mc>=
Va;mc--)if(!Na.a.Jv(jb.charCodeAt(mc)))return L.SelectionFactory.oA(Fb,V.a.Rc(Wa.node,mc+1),!1);return L.SelectionFactory.oA(Fb,V.a.Rc(Wa.node,Va),!1)}ydf(Fb,Va,Wa,jb,mc){var yb,Oa;if(1===Wa)return 32;(Wa=null===(Oa=null===(yb=Va.view)||void 0===yb?void 0:yb.lb)||void 0===Oa?void 0:Oa.tg)&&G.ContextSetEditor.instance.COh(Wa).filter(I.ParagraphReader.oU).forEach(Gb=>{var Wb;return null===(Wb=I.ParagraphReader.WOa(Gb.node))||void 0===Wb?void 0:Wb.lhe("delete_selection")});Oa=!1;Fb===pa.a.Kbf?(Fb=pa.a.CH,
Oa=!0):Fb===pa.a.dHd?(Fb=pa.a.backspace,Oa=!0):Fb===pa.a.Oua&&(Va=new Ra.a(la.App.xa.hb.rc));if(!Va.view.qe)return 2;Qb.GrippersManager.instance.WB(!1);yb=Fb===pa.a.CH;Wa=Ac.a.B8h(Va);if(Oa&&this.Xf.gh&&Wa&&H.SelectionEditor.km(Wa)&&this.Xf.jEf(Wa.Oa,!yb,!0))return 2;Oa=this.pbm(Wa,yb,Oa);return this.Tjl(Fb,Va,jb,mc,Oa,yb)}Tjl(Fb,Va,Wa,jb,mc,yb){var Oa;const Gb=Va.view,Wb=Gb.lb;var kc=jb,Mb=jb;Fb===pa.a.Oua&&(Mb=kc=null,mc=new $b.Selection(jb,!0));if(!mc)return 32;const Qc=this.gqo(kc,yb);if(this.Xf.gh&&
Ob.Mfa&&1===Wb.gb.length&&H.SelectionEditor.km(mc)&&mc.iy&&Ob.Mfa.Xao(mc.Oa,yb))return 32;let Ic;yb?ab.a.mark(Ic=5009):ab.a.mark(Ic=5011);kc=new y.GraphTransaction(15);kc.fk=Fb;kc.Cb(Gb.Yc);let Ed=null,me=({C$n:Ed}=this.hRl(Fb,jb,Wb,mc,Ed)).returnValue;var Be=null;({Pie:Be}=G.ContextSetEditor.instance.Feg(me)).returnValue&&(me=Be);if(!me)return kc.dispose(),32;Be=!1;l.AFrameworkApplication.te("b1jb9393;09icj321");if(null===(Oa=l.AFrameworkApplication.K)||void 0===Oa?0:Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))Oa=me.node,Be=null===Oa||void 0===Oa?void 0:Oa.Us;const ad=new Ub(Va,Fb,Wa,Mb,Be);this.Xf.gh&&Ob.Mfa&&(Mb=G.ContextSetEditor.instance.dO(me),Ob.Mfa.d9i(Mb));this.iAj(me);const Nc=this.uNd(me,mc,yb);let Sc=null;yb?Sc=new Bb.a(mc):Nc&&(Sc=new Bb.a(Nc));let Gc=!1;Mb=Ob.Jk;if(H.SelectionEditor.gf(me)){const ie=rb.a.U7b(Gb.Yc,Qc);Mb.he(()=>{this.Dil(Va,Wa,jb,me,yb,Sc,mc,ie,Wb,Qc,ad,Nc)},"DVS:DAIPC")}else!this.Ld.rg||va.a.pr&&this.FCa.b_d(mc)?Mb.he(()=>{Gc=this.z0i(Fb,Gb.Yc,me,Wb,Qc,ad,Sc,Ed)},"DVS:PUD"):
(Mb.he(()=>{this.PKo(Fb,Gb.Yc,me,yb,mc,Wb,Qc,ad,Sc)},"DVS:TCDC"),Gc=!0);this.ZDl(Wb);this.ddj(me);kc.dispose();ab.a.mark(Ic+1);return Fb===pa.a.Oua?Gc?32:8:32}z0i(Fb,Va,Wa,jb,mc,yb,Oa,Gb){Va=rb.a.U7b(Va,mc);this.QKo(Wa)&&Va.x7a(Wa);Fb=Ob.Ic.Ap(Fb);Fb.properties.Z("CountOfParagraphsDeleted",this.zk.v$e(Wa).toString());Wa=this.$nl(Wa,jb,mc,Va,yb,Oa,Gb);Fb.end();return Wa}PKo(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb){var kc=0,Mb=null;const Qc=G.ContextSetEditor.instance.dO(Wa),Ic=Qc[Qc.length-1];if(Ic.contextId===
aa.a.paragraph||Ic.contextId===aa.a.endOfParagraph){var Ed=n.GraphIterator.$a(Ic.node);Ed.vd();P.OutlineElementNavigator.Vd(Ed);P.OutlineElementNavigator.Ur(Ed,!0,!1)&&(Mb=P.OutlineElementNavigator.Ge(Ed))&&(kc=this.zk.textLength(Mb))}else kc=this.zk.textLength(Ic.node)-Ic.cpEnd;Ed=Object(wa.a)(112,Gb.xd);if(Ed=!!Ed&&Ed.ia(ja.a.sCf,!1))this.x0i(Fb,Va,Wa,yb,Oa,Gb,Wb,!1,Ed);else{Ed=this.Ld.oZa();try{this.x0i(Fb,Va,Wa,yb,Oa,Gb,Wb,!0)}finally{Ed&&Ed.dispose()}}if(va.a.Pj&&mc.sac)kc=this.uNd(Wa,mc,jb),
this.zk.Vb(kc.Oa.node)&&W.a.instance.setSelection(kc);else{if(jb){if(Wa.$w){Fb=Qc.length-1;do mc=Qc[Fb],Fb--;while(!mc.node.isConnected&&0<=Fb)}else mc=Wa;if(!this.zk.Vb(mc.node))return;switch(Ic.contextId){case aa.a.paragraph:case aa.a.endOfParagraph:kc=Mb&&Mb.isConnected?0:kc;break;case aa.a.Tc:case aa.a.Hd:break;default:kc=0}kc=L.SelectionFactory.ue(mc.node,this.zk.textLength(mc.node)-kc);mc.oj===kc.Oa.cpBegin&&(kc.Oa.Eb=mc.Eb)}else{kc=mc.Oa.node;if(!this.zk.Vb(kc))return;Mb=mc.Oa.contextId===
aa.a.paragraph?0:mc.Oa.contextId===aa.a.endOfParagraph?this.zk.textLength(kc):mc.Oa.cpBegin;kc=L.SelectionFactory.ue(kc,Mb)}W.a.instance.setSelection(kc)}}x0i(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb=!1){Wa=this.tIl(jb,Wa);Wa=Ob.Fh.O8c(Wa);({type:Mb}=Wa.DSd()).returnValue&&(Gb&&4!==Mb?this.Ld.Ls(Mb):va.a.pr||(this.Ld.Y4a=Mb));for(Gb=Wa.length-1;0<=Gb;--Gb){var kc=void 0;var Mb=({F_d:kc}=Wa.getContext(Gb)).returnValue;kc?(kc=Wb&&Mb.contextId===aa.a.endOfParagraph&&Gb===Wa.length-1,this.hyperlinkEditor.Flb(Mb,2),
kc||Ob.lj.zob(Mb,2)):this.z0i(Fb,Va,Mb,jb,mc,yb,Oa,null)}}tIl(Fb,Va){if(Object(sa.a)(Xa.a,Va)){Fb=gb.OutlineElementGeneralizer.qna(Fb.gb,!0);for(let Wa=0;Wa<Fb.length;Wa++)if(Fb.getContext(Wa).contextId===aa.a.table)return Fb}return Va}hRl(Fb,Va,Wa,jb,mc){Fb===pa.a.Oua?(Fb=Ga.a.hDa(Va),mc=Db.SelectionReferenceFactory.instance.rBb()):(mc=null,Fb=1===Wa.gb.length?W.a.mBb(jb):Wa.tg);return{returnValue:Fb,C$n:mc}}PRk(Fb){return!Fb.el||Fb.contextId!==aa.a.paragraph||!this.zk.Vb(Fb.node)||this.Ld.rg||this.Xf.DZd(Fb)?
!1:!0}iAj(Fb){if(Fb.$w)for(let Va=0;Va<Fb.length;Va++)this.iAj(Fb.getContext(Va));else this.PRk(Fb)&&(Fb.node.mCd=!0)}ddj(Fb){if(Fb.$w)for(let Va=0;Va<Fb.length;Va++)this.ddj(Fb.getContext(Va));else Fb.el&&(Fb=Fb.node)&&this.zk.Vb(Fb)&&(Fb.mCd=!1)}uNd(Fb,Va,Wa){if(Fb.el&&H.SelectionEditor.gf(Fb)&&!Wa){const jb=Fb.node;let mc=Fb.cpBegin,yb=-1;if(({cp:mc}=this.Xf.JOi(jb,mc)).returnValue)return L.SelectionFactory.ue(jb,mc);if(({cp:mc,hma:yb}=this.Xf.IOi(Fb,mc,yb)).returnValue)return Va=L.SelectionFactory.ue(jb,
mc),Va.Oa.Eb=yb,Va.Oa.Rb=yb,Va}Va=va.a.Pj?H.SelectionEditor.SDa(Va,!Wa,{OA:!Va.sac||Va.iy,ys:!1,GC:!1,jE:!0,aua:H.SelectionEditor.km(Va)}):H.SelectionEditor.SDa(Va,!Wa,{OA:!0,ys:!1,GC:!1,jE:!0});this.Xf.gh&&H.SelectionEditor.ml(Fb)&&(Va.Oa.Rb=Va.Oa.Eb=Wa?Fb.Rb:Fb.Eb);return Va}Dil(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb,kc,Mb,Qc){const Ic=Ob.Jk;!H.SelectionEditor.EA(jb.node,jb,mc)||this.Xf.gh&&this.Xf.Zwi(jb)?Ic.he(()=>{this.ijl(jb,mc,yb,Oa,Gb,Wb,kc,Mb)},"DVS:IPM"):Ic.he(()=>{const {response:Ed,JY:me}=this.hjl(Fb,
Va,Wa,jb,mc,Oa,Gb,Wb,Mb,Qc);Ob.HQi(Gb,32===Ed);me&&Ob.Xpa(Wb,yb)},"DVS:ISE")}Smm(Fb,Va){Yb.a.eY&&(Va.xd||(Va.xd=new x.DictionaryPropertySet),Va.xd.setValue(ja.a.Xoa,"delete"),Va.xd.setValue(ja.a.Aha,"backspace"));var Wa=Fb.VI;const jb=Ob.Gd.DX(Wa),mc=Ib.a.VWm;if(null===mc||void 0===mc?0:mc.YPm(Wa,jb)){Yb.a.eY&&Va.xd.setValue(ja.a.Aha,"backspace-autocorrect");Wa=mc.UAj+" ";const yb=V.a.Rc(Fb,0);this.characterPropertiesEditor.replaceTextRange(yb,Wa);Fb=L.SelectionFactory.ue(Fb,Wa.length);W.a.instance.setSelection(Fb);
cc.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",mc.UAj)}return l.AFrameworkApplication.va.Of(Va.d1o,jb.qz?pa.a.uL:pa.a.kD,2,!1,Va.G9,Va.xd)}qmm(Fb,Va,Wa,jb,mc){let yb=!1;0<this.l_i.R3(Fb).Lt&&(mc=l.AFrameworkApplication.va.Of(Va,pa.a.Wgc,2,!1,Wa,jb),yb=!0);return{hU:yb,response:mc}}xmm(Fb,Va,Wa,jb,mc){let yb=!1;0<this.l_i.vG(Fb).Lt&&(mc=l.AFrameworkApplication.va.Of(Va,pa.a.$3c,2,!1,Wa,jb),yb=!0);return{hU:yb,response:mc}}Anm(Fb,Va,Wa,jb,mc){let yb=!1;Ob.gq.jAb(Fb)&&
(mc=l.AFrameworkApplication.va.Of(Va,pa.a.JG,2,!1,Wa,jb),yb=!0);return{hU:yb,response:mc}}$km(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb,kc){const Mb=new eb.a;Mb.Zc(Va);let Qc=!1;if(P.OutlineElementNavigator.aGa(Mb,!1,!Fb,!1)){kc=!0;Wb=32;Qc=!0;(new n.GraphIterator).Zc(Mb);P.OutlineElementNavigator.Ge(Mb);const Ed=Mb.currentNode;I.ParagraphReader.qua(Ed)&&I.ParagraphReader.WOa(Ed).lhe("delete_ip");var Ic=new n.GraphIterator;Ic.set(Oa);(Ic=this.zk.isEmpty(Ic))&&mc&&H.SelectionEditor.G8(mc.Oa)?(Wa.x7a(yb),P.OutlineElementNavigator.Ge(Va),
Ob.lg.WGa(Va.currentNode)):Ed.tJ?(Wa.x7a(yb),P.OutlineElementNavigator.Vd(Mb),Mb.Cg()):Fb&&Ic?this.Xf.tzi(Oa)&&!({JY:kc}=this.n3i(Fb,Oa,Ed,mc,kc)).returnValue&&(Wa.x7a(yb),Ob.Un.Sca(Va),this.aQh.ZEn(Oa),Va.Cg()):dc.TableReader.isTable(Mb)?(Wa.x7a(yb),Fb&&(ca.moveToFirstRow(Mb),ca.moveToFirstColumn(Mb),M.OutlineNavigator.c9(Mb),P.OutlineElementNavigator.Ge(Mb),Gb.setSelection((new Bb.a(L.SelectionFactory.ue(Mb.currentNode,0))).restore())),Wb=2,kc=!1):this.zk.Vb(Ed)&&(1==this.zk.textLength(Ed)&&(Gb=
Fa.e(Ed),1==Gb.length&&8==Gb[0].Bh&&(Gb=V.a.createTextRange(Ed,0,1),this.characterPropertiesEditor.replaceTextRange(Gb,"",void 0,void 0,pa.a.NEc))),({JY:kc}=this.n3i(Fb,Oa,Ed,mc,kc)).returnValue||(jb.actionId==pa.a.backspace&&Wa.Glc(Oa),this.aQh.Eil(Fb,Wa,yb,Va,Oa,Mb)))}return{hU:Qc,response:Wb,JY:kc}}n3i(Fb,Va,Wa,jb,mc){if(this.Ld.rg){if(Ob.sua){const yb=Object(sa.a)(Pb.AParagraphNode,Wa)?Ob.sua.YUc(Wa):!1,Oa=Object(sa.a)(Pb.AParagraphNode,Va)?Ob.sua.YUc(Va):!1;if(yb!==Oa)return{returnValue:!1,JY:mc};
if(!va.a.pr&&Oa)return this.Xf.gh&&Ob.cGk(Va,Wa,Fb)&&this.Ld.Ls(4),{returnValue:!1,JY:mc}}Fb=Fb?Va:Wa;if(!Object(sa.a)(Pb.AParagraphNode,Fb))return{returnValue:!1,JY:mc};Va=Fb.pa.last;Wa=l.AFrameworkApplication.userName;if(!Va.$i||Va.$i.authorName!==Wa)return Ob.lj.sOb(Fb,2),jb&&(W.a.instance.setSelection(jb),mc=!1),{returnValue:!0,JY:mc}}return{returnValue:!1,JY:mc}}Lmm(Fb,Va,Wa,jb,mc,yb,Oa,Gb){nb.OutlineElementReader.LJm(Va,Fb)||({response:Oa,JY:Gb}=Ob.Vol(Wa,jb,Fb,yb,mc,Oa,Gb));return{hU:!1,response:Oa,
JY:Gb}}hjl(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb,kc){let Mb=!1,Qc=2;const Ic=jb.node;let Ed=void 0,me=!1;const Be=Ob.Jk;if(!mc){if(Ic.VI)return Be.he(()=>{Qc=this.Smm(Ic,Wb)},"DVS:HLOE"),{response:Qc,JY:Mb};Be.he(()=>{({response:Qc,hU:me}=this.qmm(Ic,Fb,Va,Wa,Qc))},"DVS:HIOD");if(me)return{response:Qc,JY:Mb};Be.he(()=>{({response:Qc,hU:me}=this.xmm(Ic,Fb,Va,Wa,Qc))},"DVS:HWPF");if(me)return{response:Qc,JY:Mb};Ed=this.O$h(Ic);Be.he(()=>{({response:Qc,hU:me}=this.Anm(Ed,Fb,Va,Wa,Qc))},"DVS:HPOB");if(me)return{response:Qc,
JY:Mb}}null!==Ed&&void 0!==Ed?Ed:Ed=this.O$h(Ic);Be.he(()=>{({response:Qc,hU:me,JY:Mb}=this.$km(mc,Ed,Oa,Wb,kc,jb,Ic,Gb,Qc,Mb))},"DVS:HAOE");if(me)return{response:Qc,JY:Mb};Be.he(()=>{({response:Qc,hU:me,JY:Mb}=this.Lmm(mc,Ed,Va,Wa,Oa,yb,Qc,Mb))},"DVS:HFLOE");return{response:Qc,JY:Mb}}qqo(Fb){return H.SelectionEditor.ml(Fb)||this.XJ.ICi(Fb)||H.SelectionEditor.Zba(Fb)}gqo(Fb,Va){return Fb&&Fb.hasProperty(z.a.QJc)?!Fb.ia(z.a.QJc,!1):!Va}static get Gd(){return null!=Ob.DDg?Ob.DDg:Ob.DDg=a.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=
Ob.uDg?Ob.uDg:Ob.uDg=a.a.instance.resolve("Box4.List.IListEditor")}static get lg(){return null!=Ob.tEg?Ob.tEg:Ob.tEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get gq(){return zb.a.NEb}static get lj(){return null!=Ob.QHg?Ob.QHg:Ob.QHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Fh(){return null!=Ob.zIg?Ob.zIg:Ob.zIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ic(){return Ua.a.instance}static get Mfa(){Ob.ytb||
(Ob.ytb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return Ob.ytb.instance}static get sua(){return null!=Ob.axg?Ob.axg:Ob.axg=a.a.instance.Na("Box4.IContentControlReader")}static get Jk(){return wb.a.instance}ZDl(Fb){if(1===Fb.gb.length&&(Fb=Fb.gb.J(0),H.SelectionEditor.km(Fb))){var Va=Fb.Oa;Fb=Va.node;Va=Va.cpBegin;var Wa=this.zk.text(Fb);Va<Wa.length&&0<Va&&" "===Wa.charAt(Va-1)&&" "===Wa.charAt(Va)&&this.characterPropertiesEditor.replaceTextRange(V.a.createTextRange(Fb,Va-1,
Va),"\u00a0")}}AIk(Fb,Va){if(!Va.hyperlink.Fjb){const Wa=new y.GraphTransaction(15);try{Wa.Cb(Fb.node),this.L_.HR(Fb,Va)}finally{Wa&&Wa.dispose()}Va.hyperlink.CG&&this.Ld.Ls(2)}}static Vol(Fb,Va,Wa,jb,mc,yb,Oa){if(Wa=H.SelectionEditor.SDa(jb,!Wa,{OA:!1,ys:!1,GC:!1,jE:!0})){jb=L.SelectionFactory.oA(jb,Wa.Oa);yb=32;for(Wa=0;Wa<jb.length;++Wa){mc.x7a(jb.J(Wa));const Gb=l.AFrameworkApplication.va.Of(jb.J(Wa),pa.a.CH,2,!0,Fb,Va);2!==Gb&&(yb=Gb)}32===yb&&(Oa=!0)}return{response:yb,JY:Oa}}$nl(Fb,Va,Wa,jb,
mc,yb,Oa){let Gb=!1;this.rqo(Fb)?(Gb=Ob.Xef(Fb,!0,Va,Wa,jb,mc))&&Ob.GIa(yb,Va,Oa):this.qqo(Fb)?(Gb=Ob.Xef(Fb,!1,Va,Wa,jb,mc))&&Ob.GIa(yb,Va,Oa):(jb.normalize(),Ob.GIa(yb,Va,Oa));return Gb}static GIa(Fb,Va,Wa){Wa&&Wa.Xpa()||Ob.Xpa(Va,Fb)}static Xef(Fb,Va,Wa,jb,mc,yb){var Oa;jb||J.OutlineReader.kQa(Fb)||(Wa=Ob.kad(Wa))&&mc.Imo(Wa);l.AFrameworkApplication.te("b1jb9393;09icj321");if(null===(Oa=l.AFrameworkApplication.K)||void 0===Oa?0:Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))yb.xd?yb.xd.jbd=yb.jbd:yb.xd={jbd:yb.jbd};Oa=Fb instanceof Xa.a?Fb.getContext(0).node:Fb.node;Oa=Ob.t5l(Oa);Fb=32===l.AFrameworkApplication.va.Of(Fb,yb.actionId,2,Va,yb.G9,yb.xd);Ob.HQi(mc,Fb,Oa);return Fb}static get Sn(){return null!=Ob.Wzg?Ob.Wzg:Ob.Wzg=a.a.instance.resolve("Box4.IFormattingEditor")}static get xTa(){return null!=Ob.FGg?Ob.FGg:Ob.FGg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static t5l(Fb){const Va=new Ya.a;if(Fb){let Wa=null;Fb=L.SelectionFactory.ho(Fb,!0);if(!Fb)cc.ULS.sendTraceTag(509645905,
315,10,"Unexpected null selection.");else for(let jb=0;jb<Fb.length;jb++)if(N.FormattingReader.o9e(Fb.J(jb))){Wa=Fb.J(jb);break}Wa&&((Fb=N.FormattingReader.Kr(Wa))&&Fb.cache&&Fb.cache.DB&&(Fb=Fb.Ef(null),Ob.Sn.X4(Fb)),Fb&&(Va.formatting=Fb.Qj,Va.languageId=N.FormattingReader.language(Fb)),Va.cra=Ob.xTa.No(Wa.node))}return Va}static HQi(Fb,Va,Wa){Va?Fb.normalize(Wa):Fb.cancel()}static Xpa(Fb,Va){Va&&Ob.Jk.he(()=>{const Wa=Va.restore();Wa&&Fb.setSelection(Wa)},"DVS:RS")}ijl(Fb,Va,Wa,jb,mc,yb,Oa,Gb){let Wb;
!Va&&({hyperlink:Wb}=this.L_.Dac(Fb)).returnValue?(Wa=new Bb.a(jb),this.AIk(Fb,Wb),mc.normalize(),Ob.Xpa(yb,Wa)):Ob.Xef(Fb,!1,yb,Oa,mc,Gb)&&(Va&&this.Ld.rg?(Va=Ob.lj.gGd)?(yb.setSelection(L.SelectionFactory.ue(Fb.node,Va)),Ob.lj.gGd=null):Ob.Xpa(yb,Wa):Ob.Xpa(yb,Wa))}static cGk(Fb,Va,Wa){Wa?(Wa=Fb,Fb=Va):Wa=Va;Va=Ob.sua.cbc(Wa,!1);Fb=Ob.sua.cbc(Fb,!0);return!(Va&&Fb)}rqo(Fb){return Fb.$w||J.OutlineReader.kQa(Fb)||this.zk.lm(Fb)}static kad(Fb){return(Fb=gb.OutlineElementGeneralizer.qna(Fb.gb,!0))&&
1===Fb.length&&(Fb=Fb.getContext(0).node,dc.TableReader.CU(Fb))?Fb:null}O$h(Fb){const Va=new n.GraphIterator;Va.set(Fb);Va.vd();P.OutlineElementNavigator.Vd(Va);return Va}}Ob.ytb=null;Object(E.a)(Ob,"ADeleteViewStrategy",null,[]);class vc{Eil(Fb,Va,Wa,jb,mc,yb){const Oa=yb.currentNode;P.OutlineElementNavigator.Vd(yb);Fb?(Va.Glc(yb.currentNode),vc.Xf.jyi(Wa,mc,Oa,!1)||vc.lg.merge(jb,yb,!1,!1)):vc.Xf.jyi(Wa,Oa,mc,!0)||vc.lg.merge(yb,jb,!1,!1)}ZEn(Fb){Fb&&I.ParagraphReader.Vb(Fb)&&(Pa.a.U3c(Fb),vc.Crl.I_e(Fb))}static get lg(){return null!=
vc.oEg?vc.oEg:vc.oEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get Crl(){return null!=vc.Nxg?vc.Nxg:vc.Nxg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Xf(){return qa.a.instance}}Object(E.a)(vc,"DeleteParagraphNodeStrategy",null,[759]);class Sa extends Ob{constructor(Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb){super(new vc,Fb,Va,Wa,jb,mc,yb,Oa,Gb,Wb)}}Object(E.a)(Sa,"DeleteViewStrategy",Ob,[]);c.d(K,"DeleteActor",function(){return Ab});class Ab extends ra{constructor(Fb,Va,Wa,jb,mc,
yb,Oa,Gb,Wb,kc,Mb,Qc){super();this.deleteParagraph=(Ic,Ed)=>{Ic=Ed.node;Pa.a.U3c(Ic);this.Wye.I_e(Ic);this.qn&&this.qn.instance&&this.qn.instance.yVi(Ic);Ic.Us&&(this.Zl.BXn(Ic,!this.gh),this.gh&&this.YVg.instance&&this.YVg.instance.zEj(Ic));return 0};this.$Hd=(Ic,Ed,me)=>{2==me&&(Ic=l.AFrameworkApplication.breadcrumbFolderUrl,Ic&&0!=Ic.length||(Ic=l.AFrameworkApplication.breadcrumbBrandUrl),la.App.Jgb(Ic));return 32};this.Cil=(Ic,Ed,me)=>{({DeleteActor:Ic}=c(1588));if(1===me)return 32;me=la.App.xa.Gq.$f("ModelUpdate",
"DeleteAnchoredObject");Ed=Ed.node;const Be=new n.GraphIterator;Be.set(Ed);Be.zb(12);const ad=Be.Xn(12);if(qa.a.instance.WUc(ad))return 2;Ic.N_b(ad);Ic=new y.GraphTransaction(7);Ic.Cb(Ed);Be.Cg();Ic.dispose();me.stop();return 32};this.c0j=new lb;this.d0j=new Sa(qa.a.instance,La.a.instance,yb,Oa,Gb,Wb,kc,Mb,Qc);this.Zl=Fb;this.utc=Va;this.YVg=Wa;this.Wye=jb;this.qn=mc}get gh(){return this.utc.instance?this.utc.instance.gh:!1}get iQh(){return this.d0j}get ZPh(){return this.c0j}L3f(Fb,Va,Wa,jb){const mc=
sb.Rjl,yb=this.Cil;Fb.qa(pa.a.backspace,aa.a.anchoredObject,yb);Fb.qa(pa.a.backspace,aa.a.unsupportedObject,mc);Fb.qa(pa.a.CH,aa.a.anchoredObject,yb);Fb.qa(pa.a.CH,aa.a.unsupportedObject,mc);Fb.qa(pa.a.backspace,aa.a.paragraph,this.deleteParagraph);Fb.qa(pa.a.CH,aa.a.paragraph,this.deleteParagraph);Fb.qa(pa.a.Oua,aa.a.paragraph,this.deleteParagraph);Fb.qa(pa.a.$Hd,aa.a.view,this.$Hd);Fb.Vc(pa.a.Oua,64);super.L3f(Fb,Va,Wa,jb)}static N_b(Fb){var Va;(null===(Va=la.App.qd)||void 0===Va?0:Va.Qo)&&la.App.qd.Qp.QF(Fb)}}
Object(E.a)(Ab,"DeleteActor",ra,[])},1589:function(E,K,c){c.r(K);E=c(0);var l=c(7),f=c(1442),a=c(1602),k=c(911),x=c(1538);class y{constructor(sa){this.Gak=sa}initialize(){return Promise.resolve(0)}W1d(){return Promise.resolve(0)}PY(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.Gak}))}vme(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}lke(){return!1}sPc(){return"MockAuthTokenStrategy"}}Object(E.a)(y,"MockAuthTokenStrategy",null,[585]);var n=c(1651);class u{static get(sa,wa,ja){if(!ja)return sa;let ha=0;return Promise.race([sa,new Promise(va=>{ha=window.setTimeout(()=>{va(wa)},ja)})]).then(va=>{window.clearTimeout(ha);return Promise.resolve(va)}).catch(()=>{window.clearTimeout(ha);return Promise.resolve(wa)})}}Object(E.a)(u,"PromiseWithTimeout",
null,[]);var z=c(2),w=c(743);class F{constructor(sa,wa,ja,ha,va){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=sa;this.scope=wa;this.silentLogin=ja;this.options=ha;this.correlationId=va}}Object(E.a)(F,"TokenRequestParameters",null,[604]);var G=c(20),H=c(22);class L{constructor(){this.Zkh=null;let sa=z.AFrameworkApplication.K.jb(z.AFrameworkApplication.vja),wa=z.AFrameworkApplication.K.jb(z.AFrameworkApplication.Ime);this.zZb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",
sa&&""!==sa?sa:"Unspecified",wa&&""!==wa?wa:"Unspecified")}initialize(){return new Promise(sa=>{H.a.instance.Sa("Common.App.WopiIdentity.IWopiIdentity").execute(wa=>{this.Zkh=wa;sa(0)})})}fe(sa){const wa=["HTTPS:","API:"];let ja=!1;const ha=sa.toLocaleUpperCase();for(const va of wa)if(ha.startsWith(va)){ja=!0;break}return ja||this.GKm(sa)?sa+"/.default":sa}GKm(sa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(sa)}W1d(){return Promise.resolve(0)}PY(sa,
wa,ja,ha,va,xa,ma){if(G.a.uQa){va=w.OAuthManagerSettings.D1o;if(!va)return wa=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(wa);if(!Array.contains(va,sa))return wa=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+sa}),Promise.resolve(wa)}sa=this.fe(ja);ja=new F(ja,sa,!ha,null,z.AFrameworkApplication.userSessionId);return this.Zkh.getAccessToken(ja,wa,ma).then(Ja=>Object.assign(new x.a,
{IsSuccess:!0,Token:Ja.accessToken}),Ja=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Ja}))}vme(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}lke(){return!1}sPc(){return this.zZb}}Object(E.a)(L,"ParentFrameTokenStrategy",null,[585]);var I=c(55),N=c(746),P=c(74);class M{constructor(){this.reject=this.resolve=null;this.startTime=0;this.U3i=
this.Kvh=null}}Object(E.a)(M,"PromiseWrapper",null,[]);class J{constructor(sa=0){this.Vx=0;this.Nyc=!1;this.$x=new P.a;this._timeout=sa}enqueue(sa){return new Promise((wa,ja)=>{this.$x.add(Object.assign(new M,{U3i:sa,resolve:wa,reject:ja}));this.process()})}process(){if(this.Nyc||this.Vx===this.$x.count)return!1;const sa=this.$x.J(this.Vx++);try{this.Nyc=!0,sa.U3i().then(wa=>{this.Nyc=!1;this.J8e(sa,wa,null,!0)}).catch(wa=>{this.Nyc=!1;this.J8e(sa,null,wa,!1)})}catch(wa){this.Nyc=!1,this.J8e(sa,null,
wa,!1)}return!0}J8e(sa,wa,ja,ha){if(ha){const va=()=>{sa.resolve(wa);this.process()};0<this._timeout?window.setTimeout(()=>{va()},this._timeout):va()}else{const va=()=>{sa.reject(ja);this.process()};0<this._timeout?window.setTimeout(()=>{va()},this._timeout):va()}}}Object(E.a)(J,"PromiseQueue",null,[]);class V{constructor(){this.correlationId=this.resolve=null}}Object(E.a)(V,"ResolveWithCorrelation",null,[]);var X=c(73),W=c(174),U=c(943),Y=c(85);class ca extends W.a{constructor(sa,wa,ja,ha,va,xa){super(!1,
!1,!0);this.KRg=this.aAa=null;this.Zsa=sa;this.ffk=ja;this.Mq=ha;this.Cmk=va;this.oub=xa;this.nH=document.createElement("iframe");this.nH.id="SharedAuthInteractiveFrame";this.nH.setAttribute("name","SharedAuthInteractiveFrame");this.nH.setAttribute("title","SharedAuthInteractiveFrame");this.nH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.nH.style.border="0";this.nH.style.height="48px";this.nH.style.width="190px";$addHandler(this.nH,"error",Object(I.a)(this,
this.etn,"onSharedAuthFrameError"));sa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Zsa,wa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",z.AFrameworkApplication.userType);this.nH.src=sa;this.m0j=new Promise(ma=>{this.KRg=ma});this.LRg=!1}jTa(){this.aAa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.ffk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(I.a)(this,
this.k$k,"createFrame"),["resolveDialogStyles"]:this.KRg}};this.Ad=5;this.Yh(CommonUIStrings.l_SignIn,Object(I.a)(this,this.kpo,"sharedAuthConsentDialogHandler"),this.aAa)}EGj(sa=!1,wa=5){this.aAa&&this.aAa.bodyControls&&(!0!==Object(X.a)(Object,this.aAa.bodyControls).frameLoaded&&(Object(X.a)(Object,this.aAa.bodyControls).frameLoaded=!0),sa!==Object(X.a)(Object,this.aAa.bodyControls).frameLoadSuccess&&(Object(X.a)(Object,this.aAa.bodyControls).frameLoadSuccess=sa),wa!==this.aAa.dialogButtonsOption&&
(this.aAa.dialogButtonsOption=null,this.Ad=wa),this.update(this.aAa))}xwo(sa,wa){const ja=new U.a(Y.a.opo);ja.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:sa,["dialogStyles"]:wa};this.Mq.QSa(ja,this.nH.contentWindow,this.Zsa)}h1h(){this.EGj(!1,6)}get noj(){return this.nH}get aml(){return this.m0j.then(sa=>{this.LRg=!0;return sa})}get bml(){return this.LRg}etn(){this.h1h()}k$k(){return this.nH}kpo(sa){0===
sa&&(this.Cmk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.oub(null))}}Object(E.a)(ca,"SharedAuthConsentDialog",W.a,[603]);var aa=c(959),fa=c(83),pa=c(150),ra=c(39),la=c(135),qa=c(119);class La{constructor(){this.nH=null;this.ukd=0;this.VWb=this.h_b=this.dte=this.oub=this.saa=this.ajh=null;this.Mq=new aa.a(null,null);this.zZb="SharedAuthTokenStrategy Unloaded";this.Zsa=w.OAuthManagerSettings.mpo;this.hfh=w.OAuthManagerSettings.lpo;
this.nTg=w.OAuthManagerSettings.enableConsoleLogging;this.u1j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.Kjk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.vnk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Nbb={};this.O6j=new J(1500)}sPc(){return this.zZb}initialize(){var {OAuthManager:sa}=c(1589);
if("loadFrame"in this.Nbb)return this.Nbb.loadFrame.Kvh;if(!this.Zsa)return fa.Health.instance.recordKpiFailure(sa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);sa=this.Nje("loadFrame");this.ukd=ra.a.Ze();var wa=this.Zsa+this.hfh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;
this.vnk&&(wa+="&webworker=1");this.nH=document.createElement("iframe");this.Jzf(this.nH);this.nH.style.cssText="height:0;width:0;display:none;";this.nH.id="SharedAuthFrame";this.nH.setAttribute("name","SharedAuthFrame");this.nH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.nH.setAttribute("title","SharedAuthFrame");this.nH.src=wa;document.body.appendChild(this.nH);wa=ra.a.Ze()-this.ukd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
wa,this.nH.src);return sa}W1d(sa){this.dte=sa;const wa=new U.a(Y.a.qoj);wa.Values=this.qvh(sa);sa=this.Nje("initFrame");this.Mq.QSa(wa,this.nH.contentWindow,this.Zsa);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return sa}PY(sa,wa,ja,ha,va,xa){const ma=new U.a(Y.a.ppo),Ja=this.Kei();ma.Values=this.SBj(sa,wa,ja,ha,va,xa,Ja);sa=this.Nje(Ja);ha&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.O6j.enqueue(()=>new Promise(oa=>{this.INo(xa,ma,oa,Ja)})):(this.Mq.QSa(ma,this.nH.contentWindow,this.Zsa),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",wa));return sa}INo(sa,wa,ja,ha){const va=this.Nbb[ha];va&&(this.h_b=wa,this.oub=Object.assign(new V,{resolve:ja,correlationId:ha}),this.saa=new ca(this.Zsa,this.hfh,sa,this.Mq,va,ja),this.saa.jTa())}Kei(){return la.a.create().toString()}SBj(sa,wa,ja,ha,va,xa,ma){const Ja={};Ja.appName=
sa;Ja.appId=wa;Ja.target=ja;Ja.withPopup=ha;Ja.claims=va;Ja.promptMessage=xa;Ja.messageCorrelationId=ma;return Ja}Jzf(sa){$addHandler(sa,"load",Object(I.a)(this,this.mon,"onIFrameLoaded"));$addHandler(sa,"error",Object(I.a)(this,this.$lb,"onIFrameError"));this.Mq.Daa(this.Zsa);this.Mq.Av(Y.a.toj);this.Mq.OB(Y.a.toj,Object(I.a)(this,this.Gsn,"onScriptLoaded"));this.Mq.Av(Y.a.soj);this.Mq.OB(Y.a.soj,Object(I.a)(this,this.Fsn,"onScriptInitialized"));this.Mq.Av(Y.a.ooj);this.Mq.OB(Y.a.ooj,Object(I.a)(this,
this.Nnn,"onGetTokenResponse"));this.Mq.Av(Y.a.uoj);this.Mq.OB(Y.a.uoj,Object(I.a)(this,this.rpn,"onLoginResponse"));this.Mq.Av(Y.a.roj);this.Mq.OB(Y.a.roj,Object(I.a)(this,this.Mon,"onInteractiveFlowReady"));this.Mq.Av(Y.a.poj);this.Mq.OB(Y.a.poj,Object(I.a)(this,this.Xnn,"onHideDialog"));this.Mq.Av(Y.a.moj);this.Mq.OB(Y.a.moj,Object(I.a)(this,this.TSf,"onCloseDialog"))}Nje(sa){const wa=new M;wa.startTime=ra.a.Ze();const ja=new Promise((ha,va)=>{wa.resolve=ha;wa.reject=va});wa.Kvh=ja;this.Nbb[sa]=
wa;return ja}mon(){const sa=ra.a.Ze()-this.ukd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",sa)}$lb(sa){const {OAuthManager:wa}=c(1589),ja=ra.a.Ze()-this.ukd,ha=Object.assign(new qa.a,{durationMs:ja});fa.Health.instance.recordKpiFailure(wa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ha);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ja,this.nTg?JSON.stringify(sa):"")}Gsn(sa){const {OAuthManager:wa}=c(1589),
ja=this.Nbb.loadFrame;var ha=ra.a.Ze()-ja.startTime,va=sa.Values.AuthLibrary.toString();sa=sa.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",sa,va,ha);va&&(this.zZb="SharedAuthTokenStrategy "+va);va=Boolean.parse(sa);va||(sa=pa.a.fG(),void 0!==sa&&null!==sa&&(sa.set("AuthLibrary",this.sPc()),ha=Object.assign(new qa.a,{durationMs:ha,extendedProperties:sa}),fa.Health.instance.recordKpiFailure(wa.kpiName,
"SharedAuthStrategyInitFailed",!1,!0,ha)));ja.resolve(va?0:1)}Fsn(sa){if(sa.Values.interactive&&this.h_b&&this.h_b.Values.messageCorrelationId){const ja=this.h_b.Values.messageCorrelationId.toString();if(sa.Values.interactive&&this.saa){this.saa.aml.then(ha=>{this.Mq.QSa(this.h_b,this.saa.noj.contentWindow,this.Zsa);this.saa.xwo(ja,ha);this.saa.EGj(!0);this.h_b=null});return}}sa=this.Nbb.initFrame;const wa=ra.a.Ze()-sa.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",
wa);sa.resolve(0)}Nnn(sa){if(sa.Values.messageCorrelationId&&sa.Values.messageCorrelationId.toString()){var wa=sa.Values.messageCorrelationId.toString(),ja=this.Nbb[wa];if(ja){var ha=ra.a.Ze()-ja.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ha);sa.Values.isSuccess&&sa.Values.isSuccess?ja.resolve(sa.Values.response):ja.reject(sa.Values.response);this.qCj(wa)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Mon(){if(this.saa.bml)this.saa.h1h();else if(this.dte&&this.saa){const sa=new U.a(Y.a.qoj);sa.Values=this.qvh(this.dte,!0);this.Mq.QSa(sa,this.saa.noj.contentWindow,this.Zsa)}}Xnn(){this.saa&&this.saa.$Ud()}TSf(sa){sa.Values.cancelled&&sa.Values.cancelled&&sa.Values.messageCorrelationId&&this.qCj(sa.Values.messageCorrelationId.toString());this.saa&&this.saa.hide()}qvh(sa,wa=!1){const ja={};ja.appIds=this.gMl();
ja.upn=sa.loginHint;ja.authority=sa.authority;ja.authorityType=Object(f.a)(k.a,sa.authorityType);ja.tenantId=sa.tenantId;ja.correlationId=z.AFrameworkApplication.userSessionId;ja.enableConsoleLogging=this.nTg;ja.enablePopupFlash=this.u1j;ja.skipUpnCheck=this.Kjk;ja.interactive=wa;return ja}gMl(){const sa=[],wa=w.OAuthManagerSettings.C0e;for(let ha in wa){var ja=wa[ha];Array.contains(sa,ja)||Array.add(sa,ja)}return sa}vme(sa,wa,ja,ha,va,xa){const ma=new U.a(Y.a.npo),Ja=this.Kei();ma.Values=this.SBj(sa,
wa,ja,ha,va,xa,Ja);this.ajh=ma;sa=this.Nje(Ja);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",wa);this.guo();return sa}lke(){return!0}guo(){this.VWb||(this.VWb=new N.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.VWb.id=16,this.VWb.pZd=!1,this.VWb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");
this.Mq.QSa(this.ajh,this.nH.contentWindow,this.Zsa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ta.Nb.Jla(this.VWb,!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}rpn(sa){if(sa.Values.messageCorrelationId&&sa.Values.messageCorrelationId.toString()){var wa=this.Nbb[sa.Values.messageCorrelationId.toString()];if(wa){var ja=ra.a.Ze()-wa.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",
ja);sa.Values.isSuccess&&sa.Values.isSuccess?wa.resolve(sa.Values.response):wa.reject(sa.Values.response)}else l.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}qCj(sa){this.oub&&this.oub.correlationId===sa&&(this.oub.resolve(null),this.oub=null)}}Object(E.a)(La,"SharedAuthTokenStrategy",null,[585]);
class Pa{constructor(sa){this.U6=sa;this.zZb="UnsupportedAuthTokenStrategy Reason="+a.a[this.U6]}initialize(){return Promise.resolve(0)}W1d(){return Promise.resolve(0)}PY(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:a.a[this.U6],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.U6]+"]"}))}vme(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}lke(){return!1}sPc(){return this.zZb}}
Object(E.a)(Pa,"UnsupportedAuthTokenStrategy",null,[585]);var Ka=c(1502);c.d(K,"OAuthManager",function(){return Na});class Na{constructor(sa=null){this.p$=0;this.q$=null;this.Ywb=0;this.v1g=!!window.location.search.match(RegExp("wdpa=1","gi"));const wa=ra.a.Ze();this.u6j=this.ell(sa).then(ja=>ja?this.lwm():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.VK(),Math.floor(ra.a.Ze()-wa)),ja=pa.a.fG(),void 0!==ja&&
null!==ja&&(ja.set("AuthLibrary",this.VK()),ja=Object.assign(new qa.a,{durationMs:Math.floor(ra.a.Ze()-wa),extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,"StrategyPickFailed",!1,!0,ja)),Promise.resolve(1))).then(ja=>0!==ja?Promise.resolve(ja):this.QZm())}fll(){if(this.v1g)this.p$=5,this.q$=new Pa(this.p$);else{var sa=w.OAuthManagerSettings.gdn;sa&&0<sa.length?(this.p$=1,this.q$=new y(sa)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?
z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.p$=2,this.q$=new Pa(this.p$)):(sa=n.a.getAuthContext().loginHint)&&sa.length?w.OAuthManagerSettings.jRc?(this.p$=1,this.q$=new L):(this.p$=1,this.q$=new La):(this.p$=3,this.q$=new Pa(this.p$)):(this.p$=4,this.q$=new Pa(this.p$))}}VK(){return this.q$?this.q$.sPc()||"Unknown":"None"}ell(sa=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const wa=ra.a.Ze();return z.AFrameworkApplication.K.oXl().then(ja=>{ja?(this.fll(),sa&&(this.q$=
sa),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",w.OAuthManagerSettings.clientVersion,w.OAuthManagerSettings.appVersion,w.OAuthManagerSettings.Opl,this.VK(),Math.floor(ra.a.Ze()-wa))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ra.a.Ze()-wa));return Promise.resolve(ja)},()=>
{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ra.a.Ze()-wa));return Promise.resolve(!1)})}lwm(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.VK());const sa=ra.a.Ze();return u.get(this.q$.initialize(),2,w.OAuthManagerSettings.D0f).then(wa=>{if(0===wa)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.VK(),Math.floor(ra.a.Ze()-sa));
else if(1===wa){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.VK(),Math.floor(ra.a.Ze()-sa));var ja=pa.a.fG();void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.VK()),ja=Object.assign(new qa.a,{durationMs:Math.floor(ra.a.Ze()-sa),extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,"StrategyInitFailed",!1,!0,ja))}else 2===wa&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.VK(),Math.floor(ra.a.Ze()-sa)),ja=pa.a.fG(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.VK()),ja=Object.assign(new qa.a,{durationMs:Math.floor(ra.a.Ze()-sa),extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,"StrategyInitTimedOut",!1,!0,ja)));return Promise.resolve(wa)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.VK(),Math.floor(ra.a.Ze()-sa));return Promise.resolve(1)})}QZm(){l.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.VK());const sa=ra.a.Ze();return u.get(this.q$.W1d(n.a.getAuthContext()),2,w.OAuthManagerSettings.D0f).then(wa=>{if(0===wa)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.VK(),Math.floor(ra.a.Ze()-sa));else if(1===wa){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.VK(),Math.floor(ra.a.Ze()-sa));var ja=pa.a.fG();void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.VK()),ja=Object.assign(new qa.a,
{durationMs:Math.floor(ra.a.Ze()-sa),extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,"StrategyLoadFailed",!1,!0,ja))}else 2===wa&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.VK(),Math.floor(ra.a.Ze()-sa)),ja=pa.a.fG(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.VK()),ja=Object.assign(new qa.a,{durationMs:Math.floor(ra.a.Ze()-sa),extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,
"StrategyLoadTimedOut",!1,!0,ja)));return Promise.resolve(wa)},()=>{l.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.VK(),Math.floor(ra.a.Ze()-sa));return Promise.resolve(1)})}PY(sa,wa,ja=null){return this.Wlc(sa,wa,!1,null,"",ja)}TBj(sa,wa,ja,ha,va=null){return this.Wlc(sa,wa,!0,ja,ha,va)}Wlc(sa,wa,ja,ha,va,xa,ma=0){ma+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
sa,this.yNb(sa,wa),this.VK(),ma);var Ja=pa.a.fG();void 0!==Ja&&null!==Ja&&(Ja.set("AuthLibrary",this.VK()),Ja.set("AppName",sa),Ja.set("Target",this.yNb(sa,wa)),fa.Health.instance.recordKpiUsage(Na.kpiName,0,"WacOAuthFC",Ja));if(!w.OAuthManagerSettings.isEnabled||this.v1g){var oa;return this.eKf((oa=new x.a,oa.IsSuccess=!1,oa.Token=null,oa.ErrorCode="NotEnabled",oa.ErrorMessage="OAuthManager is disabled.",oa),sa)}const za=w.OAuthManagerSettings.C0e[sa];if(void 0===za||null===za){l.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",sa);var Fa;return this.eKf((Fa=new x.a,Fa.IsSuccess=!1,Fa.Token=null,Fa.ErrorCode="DisallowedApp",Fa.ErrorMessage="Disallowed appName: "+sa,Fa),sa)}const kb=ra.a.Ze();let fb=kb;const lb=this;Ja=this.u6j.then(Ua=>{fb=ra.a.Ze();return lb.eEm(sa,za,wa,ja,ha,va,xa,Ua)});oa=ja?0:w.OAuthManagerSettings.D0f;let sb;Fa=(sb=new x.a,sb.IsSuccess=!1,sb.Token=null,sb.ErrorCode="authTokenStrategy_timeout",
sb.ErrorMessage="Auth Strategy timed out after ["+oa+"] ms when fetching token",sb);let ab=this,Ga=this;return u.get(Ja,Fa,oa).then(Ua=>ma<=Na.xan&&(Ua.ErrorCode===Na.Pyj||Ua.ErrorCode===Na.LCo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ma,Math.floor(ra.a.Ze()-kb)),ab.Wlc(sa,wa,ja,ha,va,xa,ma)):Ua.ErrorCode===Na.uDi&&!ja&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",
ma,Na.fVh),Na.stl&&ab.q$.lke()&&ab.q$.vme(sa,za,wa,ja,ha,va).then(wb=>Promise.resolve(ab.J2d(wb,sa,wa,za,kb,fb))).catch(()=>{let wb;const cc=(wb=new x.a,wb.IsSuccess=!1,wb.Token=null,wb.ErrorCode="authTokenStrategy_failure",wb.ErrorMessage="LoginPopup failed, GetToken could not be called",wb);return Promise.resolve(ab.J2d(cc,sa,wa,za,kb,fb))}),Na.fVh)?ab.Wlc(sa,wa,!0,ha,va,xa,ma):Promise.resolve(ab.J2d(Ua,sa,wa,za,kb,fb))).catch(()=>{let Ua;const wb=(Ua=new x.a,Ua.IsSuccess=!1,Ua.Token=null,Ua.ErrorCode=
"authTokenStrategy_failure",Ua.ErrorMessage="Auth Strategy failed with an unknown error",Ua);return Promise.resolve(Ga.J2d(wb,sa,wa,za,kb,fb))})}eEm(sa,wa,ja,ha,va,xa,ma,Ja){return 1===Ja||2===Ja?this.eKf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ja?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),sa):this.q$.PY(sa,wa,ja,ha,va,xa,ma).then(oa=>Promise.resolve(this.IQi(oa,!0,sa))).catch(oa=>Promise.resolve(this.IQi(oa,!1,sa)))}J2d(sa,wa,ja,ha,va,xa){const ma=
{},Ja=ra.a.Ze()-xa;ma.IsSuccess=sa.IsSuccess;ma.ErrorCode=sa.IsSuccess?"Success":sa.ErrorCode||"";ma.ErrorMessage=sa.IsSuccess?"Success":this.yNb(wa,sa.ErrorMessage||"");ma.Target=this.yNb(wa,ja||"");ma.TimeInMS=Math.floor(Ja);ma.LoadTimeInMS=Math.floor(xa-va);ma.AuthLibrary=this.VK();ma.AppName=wa;ma.AuthorityType=Object(f.a)(k.a,n.a.GNd());ma.UserType=this.vhm(n.a.getAuthContext());ma.IsAuthSupportedInSession=a.a[this.p$];ma.RequestCount=++this.Ywb;ma.AppId=ha;l.ULS.sendTraceTag(593863640,3E3,50,
JSON.stringify(ma));sa.IsSuccess||(ja=pa.a.fG(),void 0!==ja&&null!==ja&&(ja.set("AppName",wa),ja.set("AuthLibrary",this.VK()),ja.set("ErrorCode",sa.ErrorCode),ja.set("ErrorMessage",this.yNb(wa,sa.ErrorMessage)),wa=Object.assign(new qa.a,{durationMs:Ja,extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,"TryGetTokenFailure",!1,!0,wa)));return sa}eKf(sa,wa){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",wa,this.yNb(wa,
sa.ErrorMessage));const ja=pa.a.fG();void 0!==ja&&null!==ja&&(ja.set("AppName",wa),ja.set("AuthLibrary",this.VK()),ja.set("ErrorCode",sa.ErrorCode),ja.set("ErrorMessage",this.yNb(wa,sa.ErrorMessage)),wa=Object.assign(new qa.a,{extendedProperties:ja}),fa.Health.instance.recordKpiFailure(Na.kpiName,"FailureBeforeGetToken",!1,!0,wa));return Promise.resolve(sa)}Nwi(sa){return sa===Ka.a.qle}yNb(sa,wa){return this.Nwi(sa)&&wa?"REDACTED":wa}vhm(sa){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":
!sa.loginHint||1>sa.loginHint.length?"empty":-1<sa.loginHint.indexOf("guest#")?"guest":-1<sa.loginHint.indexOf("ext#")?"external":0>sa.upn.indexOf("@")?"no-at":"supported"}mFm(){return 1===this.p$}IQi(sa,wa,ja){let ha=null,va=null,xa=null,ma=null;sa?sa.ErrorCode||sa.ErrorMessage?(va=sa.ErrorCode?sa.ErrorCode:Na.dXh,xa=sa.ErrorMessage?sa.ErrorMessage:"No message"):sa.Token?wa?ha=sa.Token:(va=Na.sXn,xa="A rejected promise returned a token."):(va=Na.dXh,xa=JSON.stringify(sa)):(va=Na.fgn,xa="No result came from Auth Token Strategy");
sa&&sa.Telemetry&&!this.Nwi(ja)&&(ma=sa.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ma)));if(va===Na.Bdn||va===Na.QJo)va=Na.Pyj,xa="Auth Library Timed Out";va===Na.AHk&&-1<xa.indexOf(Na.Jok)&&(va=Na.uDi);if(va||xa)ha=null;return Object.assign(new x.a,{IsSuccess:!!ha,Token:ha,ErrorCode:va,ErrorMessage:xa,Telemetry:ma})}static get fVh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get stl(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Na.QJo="token_renewal_error";Na.dXh="Exception";Na.fgn="NoResult";Na.sXn="RejectToken";Na.Bdn="monitor_window_timeout";Na.Pyj="Timeout";Na.LCo="authTokenStrategy_timeout";Na.AHk="login_required";Na.Jok="AADSTS50058";Na.uDi="Cookies Disabled";Na.kpiName="OAuthManager";Na.xan=2;Object(E.a)(Na,"OAuthManager",null,[317])},1592:function(E,K,c){E=c(0);class l{constructor(y,n,u,z){this.a_j=y;this.Tgk=n;this.Rgk=u;this.Ugk=z}get BFd(){return this.a_j}get $de(){return this.Tgk}get Yde(){return this.Rgk}get resultType(){return this.Ugk}}
Object(E.a)(l,"SearchContext",null,[1444]);class f{QGd(y,n,u,z){var w=u-n;let F;if(100<=w)w=n,F=u;else{w=Math.max(0,n+Math.ceil(w/2)-50);F=Math.min(y.length,w+100);w=Math.max(0,F-100);let H;if(w&&" "!==y.charAt(w-1)){H=Math.min(n,w+10);for(var G=w;G<H;++G)if(" "===y.charAt(G)){w=G+1;break}}if(F!==y.length&&" "!==y.charAt(F))for(H=Math.max(u,F-10),G=F-1;G>=H;--G)if(" "===y.charAt(G)){F=G;break}}y=y.substring(w,F);return new l(y,n-w,u-w,z)}RGd(y){return this.QGd(y.nci(),y.begin,y.end,"")}}Object(E.a)(f,
"SearchContextFactory",null,[1431]);var a=c(124),k=c(1577);c.d(K,"a",function(){return x});class x extends f{constructor(){super()}RGd(y){let n=y.begin,u=y.end;const z=({begin:n,end:u}=x.j6l(y,n,u)).returnValue;y=k.a(y.type);return this.QGd(z,n,u,y)}static get instance(){return null!=x.BBg?x.BBg:x.BBg=new x}static j6l(y,n,u){y=y.nci();return x.O9i(y,n,u)}static O9i(y,n,u){const z=a.AParagraphNode.IR(y);if(z.length<y.length){y=y.substring(0,n);const w=a.AParagraphNode.IR(y);y=y.length-w.length;n-=
y;u-=y}return{returnValue:z,begin:n,end:u}}}Object(E.a)(x,"EditorSearchContextFactory",f,[])},1594:function(E,K,c){E=c(0);var l=c(2),f=c(22),a=c(327),k=c(710),x=c(23),y=c(9),n=c(137),u=c(46),z=c(538),w=c(205),F=c(245),G=c(81),H=c(28),L=c(8),I=c(3),N=c(6),P=c(588),M=c(1048);class J{create(){return new M.a}}Object(E.a)(J,"FootnoteEndnoteContainerNodeFactory",null,[395]);var V=c(528);c.d(K,"a",function(){return X});class X{constructor(W,U,Y,ca,aa,fa,pa,ra,la){this.axd=null;X.ga=W;this.sE=Y;this.EMe=
ca;this.CZj=fa;this.Wc=pa;this.ib=aa;this.Tak=ra;this.O_j=la;X.Mh=U}D4d(W,U){this.Qul(W);W.Sb(7);this.sE.Lwi(W,U)||W.vf(7)}Qul(W){if(this.EMe.lzi(W)){var U=!1,Y=!1;if(W.Sb(7)){do{const ca=W.currentNode;if(37===ca.type)switch(ca.getValue(N.a.K3)){case 0:Y=!0;break;case 1:U=!0}}while(W.xi(7))}Y||this.hnh(W,0);U||this.hnh(W,1)}}hnh(W,U){const Y=this.CZj.create(1074135124);Y.setValue(N.a.K3,U);W.Jf(Y,7)}lbo(W){W&&this.thj(W.mna)}thj(W){W&&(W=x.SelectionFactory.ue(W.Ib.paragraph,W.Ib.cp+1),this.ib.setSelection(W))}efn(W){let U=
this.Tak(W);void 0!==U&&null!==U?this.sE.toa(U)&&(U=this.sE.Oci(U)):U=W;return this.O_j(U)}axo(){this.axd?X.Mh.notificationBar.removeEntry(this.axd):this.axd=X.Mh.notificationBar.Ama(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);X.Mh.notificationBar.fA(this.axd)}ODk(W,U){W=this.Wc.Gva(W,37,37);let Y=!1;if(W.Qd()){do{const ca=W.currentNode;this.sE.iGf(ca)?this.jth(ca,U):Y=!0}while(W.Rj())}Y&&this.axo()}jth(W,U){P.e(W,Y=>{X.aHl(Y,U);return!0},12)}ypm(W,U){W=
this.sE.aOc(W,U);return W?(W=this.Wc.Wf(W))?W.wA():!1:!1}r8h(W,U){W=this.sE.aOc(W,U);W=this.Wc.Wf(W);if(W.Qd()){do if(U=W.currentNode,1===U.getValue(N.a.nna))return U;while(W.Rj())}return null}static bOc(){return new X(l.AFrameworkApplication.va,y.App.xa,V.a.instance,n.PageReader.instance,u.a.instance,new J,new z.a,w.OutlineNavigator.$en,F.WordSectionNavigator.Rcf)}static get instance(){return null!=X.LBg?X.LBg:X.LBg=X.bOc()}static get paragraphEditor(){return null!=X.cFg?X.cFg:X.cFg=f.a.instance.resolve("Box4.IParagraphEditor")}static aHl(W,
U){U.mib?X.paragraphEditor.gq.dda(W,G.OutlineReader.xX(W)):X.paragraphEditor.gq.dda(W,0);W=H.a.createTextRange(W,0,L.ParagraphReader.textLength(W));X.ga.Of(W,I.a.font,2,!0,new a.a,new k.a(U.fontName));X.ga.Of(W,I.a.RA,2,!0,new a.a,new k.a(U.fontSize))}}X.ga=null;X.Mh=null;Object(E.a)(X,"FootnoteEndnoteEditor",null,[489])},1602:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.unknown=0]="unknown";f[f.supported=1]="supported";f[f.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
f[f.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";f[f.hostUnsupported=4]="hostUnsupported";f[f.perfAutomation=5]="perfAutomation"})(l||(l={}));Object(E.b)("SupportStatus",l)},1612:function(E,K,c){c.d(K,"a",function(){return L});E=c(0);var l=c(354),f=c(58),a=c(22),k=c(145),x=c(7),y=c(110),n=c(73),u=c(12),z=c(101),w=c(525),F=c(124),G=c(121),H=c(8);class L{constructor(I,N,P,M,J,V=null,X="",W=!0,U=!1){this.q0a=this.yje=this.Knb=this.b4i=this.zde=null;this.rUc=!1;this.jzf=null;this.zRf=0;
this.fle=null;this.context=I;this.ie=I.view;this.xx=N;this.xd=J;this.yR=P;this.G9=M;this.Nia=this.failed=!1;this.H8d=null;this.M2a=this.Xac=!1;this.Qxo=L.N9e(I);this.browserName=X;this.YHj=W;this.dWc=U;this.kUa=!1;this.s3b=0;if(I=Object(y.a)(112,J)?J:null){this.b4i=new l.DictionaryPropertySet;this.b4i.Vw(I);P=I.ia(k.a.e1c,f.a.nil);this.yGc=P!=f.a.nil?P.toString():f.a.create().toString();if(I.ia(k.a.e0i,!1)){this.Xac=!0;this.M2a=I.ia(k.a.M2a,!1);this.H8d=V;for(V=this.ie.lb.tg;V.$w;)V=V.getContext(0);
if(J=Object(n.a)(F.AParagraphNode,V.node)){P=0;M=H.ParagraphReader.textLength(J);switch(V.contextId){case u.a.Hd:P=V.cpBegin;M=V.cpEnd;break;case u.a.endOfParagraph:P=M}this.zde=z.FormattingReader.ePd(V.node,P,V.Eb);x.ULS.shipAssertTag(6305503,307,!!this.zde);J=G.HyperlinkReader.nOc(J);for(const Y of J)Y.cpEnd<=P||Y.cpBegin>=M||L.hyperlinkEditor.HR(V.node,Y.hyperlink)}}this.Nia=I.ia(k.a.Nia,!1);this.kUa=I.ia(k.a.kUa,!1);this.Knb=I.ia(k.a.Knb,null)}else this.yGc=f.a.create().toString();N&64&&(this.Nia=
!0)}static get hyperlinkEditor(){return null!=L.uAg?L.uAg:L.uAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static N9e(I){if(I){if(I.$w){for(let N=0;N<I.length;N++)if(L.N9e(I.getContext(N)))return!0;return!1}if(Object(y.a)(w.a,I))return L.N9e(I.$j);if(H.ParagraphReader.Vb(I.node)&&I.node.iO)return!0}return!1}}Object(E.a)(L,"ClipboardActionArguments",null,[])},1613:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(7),f=c(210),a=c(103);class k{static get VWm(){return k.Hnd}static g8k(x,
y,n){try{k.Hnd=k.$al(x,y,n)}catch(u){k.Hnd=null,l.ULS.eD(539787540,393,10,u,"Error in creating autoTriggerTextContext: {0}",u instanceof Error?u.message:"Unknown Error")}}static adj(){k.Hnd=null}static $al(x,y,n){if(!a.ListItemReader.Ig(y))throw l.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const u=f.a.c1l(y);if(null===u||void 0===u||!u.id)throw l.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),
Error("No list node with id found under outline element");y=n.lw(y);if(!y)throw l.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new k(x,u.id,y)}constructor(x,y,n){this.UAj=x;this.zZm=y;this.x4f={listType:n.listType,listStyle:n.listStyle,rJf:n.Fu}}YPm(x,y){return y&&x&&this.zZm===x.id&&y.listType===this.x4f.listType&&y.listStyle===this.x4f.listStyle&&y.Fu===this.x4f.rJf}}k.Hnd=null;Object(E.a)(k,"AutoTriggerTextContext",
null,[])},1614:function(E,K,c){c.d(K,"a",function(){return N});E=c(0);var l=c(22),f=c(58),a=c(43),k=c(632),x=c(137),y=c(538),n=c(152),u=c(9),z=c(108),w=c(6),F=c(872),G=c(760),H=c(528),L=c(1541),I=c(1594);class N{constructor(P,M,J,V,X,W){this.sE=P;this.qKa=J;this.EMe=V;this.oxe=X;this.Wc=W}iBm(P,M,J){const V=this.M$h(M,P.node),X=P.node.Jc;if(!X)return null;const W=new a.GraphTransaction(15);W.Cb(P.node);W.fk=J;J=this.jBm(V,M);N.kBm(J,X,P,M);W.dispose();return J}M$h(P,M){const J=this.Wc.yk();J.set(M);
J.zb(7);J.jd(7);this.qKa.D4d(J,P);return J}jBm(P,M){const J=G.a.createNode();J.properties.setValue(w.a.K3,M);P.Jf(J,8);this.oxe.n9k(J,M);return J}static get characterPropertiesEditor(){return null!=N.owg?N.owg:N.owg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Kda(){return N.HW||(N.HW=new k.WACStyleSet)}static set Kda(P){N.HW=P}static bOc(){const {FootnoteEndnoteDefaultContentInserter:P}=c(1687);return new N(H.a.instance,L.a.instance,I.a.instance,x.PageReader.instance,P.instance,
new y.a)}static get instance(){return null!=N.qCg?N.qCg:N.qCg=N.bOc()}static get vh(){return N.Yz||(N.Yz=n.PageNavigator.instance)}static set vh(P){N.Yz=P}static kBm(P,M,J,V){u.App.qd.Qo&&u.App.qd.Qp.QF(J.node);const X=new z.a;X.setValue(w.a.u6b,P.id);X.setValue(w.a.K3,V);const W=M.Lu(X,f.a.create());N.characterPropertiesEditor.Zga(J,U=>F.a.getInstance(U,W,P.id),N.X4h(J.node,V))}static X4h(P,M){let J=null;(P=N.vh.Xs(P))&&(P=N.Kda.TQ(P))&&(J=P.Rva(M?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:
Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return J}}N.HW=null;N.Yz=null;Object(E.a)(N,"FootnoteEndnoteInserter",null,[510])},1620:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{static v2n(f,a){l.dMe=f;l.jPe=a}static s2n(f,a){l.hPe=f;l.sYa=a}static Jei(){return l.hPe===l.sYa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.sYa,l.dMe,l.jPe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.hPe,l.sYa,l.dMe,l.jPe)}}l.hPe=0;l.sYa=0;l.dMe=
null;l.jPe=null;Object(E.a)(l,"ReplaceAllContext",null,[])},1643:function(E,K,c){c.r(K);E=c(0);var l=c(2033),f=c(58),a=c(2),k=c(307),x=c(22),y=c(1955),n=c(9),u=c(7),z=c(243),w=c(2035),F=c(13),G=c(16),H=c(1592);class L{constructor(Pb="",Ub="",rb=!1,Yb=!1){this.qNm=rb;this.RQm=Yb;this.actionId=Pb;this.LHa=Ub}}Object(E.a)(L,"SearchEntryPointContext",null,[]);class I{constructor(Pb){this.Qea=null;this.Is=!1;this.qN=Pb}initialize(){this.d_();this.zz();this.A7(0)}zz(){this.Qea.zz()}dispose(){this.qN=null}jPc(){return!1}get jG(){return this.Qea?
this.Qea.jG:0}A7(Pb){this.Qea.A7(Pb)}get isVisible(){return this.Is}oZe(Pb){this.Qea&&this.Qea.jbp(Pb)}N$i(Pb){this.Qea&&this.Qea.ckp(Pb)}TGj(Pb){this.Qea&&this.Qea.vnp(Pb)}xDh(){this.Qea&&this.Qea.rcp()}ffe(Pb){this.Qea&&this.Qea.ffe(Pb)}}Object(E.a)(I,"FindReplacePane",null,[576,10]);var N=c(65),P=c(1407),M=c(1061),J=c(166),V=c(176),X=c(1049),W=c(91),U=c(106),Y=c(83),ca=c(44),aa=c(25),fa=c(398),pa=c(1505),ra=c(330),la=c(1029),qa=c(695),La=c(77),Pa=c(1079);class Ka{constructor(Pb){this.dsk=(Ub,rb)=>
{this.bxd.nb(Ub)?this.bxd.Z(Ub,rb):this.bxd.add(Ub,rb);(Ub=this.SLl(Ub))&&this.dti(rb,Ub,this.rIh(ra.a.getTypeName()))};this.bxd=new La.a;this.AV=new La.a;this.annotationType=pa.RoleDetectionAnnotation.getTypeName();Pb.uTn(this.dsk)}PC(Pb,Ub){let rb;const Yb=Pb.parentPath.substr(Pb.parentPath.lastIndexOf("\\")+1),Ya=Pb.content;if(!Ya||this.xQm(Ya))""!==Yb&&({value:rb}=this.bxd.Dc(Yb,rb)).returnValue&&this.dti(rb,Pb,this.rIh(Ub)),Ub===ra.a.getTypeName()?(Ub=null,({value:Ub}=this.AV.Dc(Yb,Ub)).returnValue?
this.AV.Z(Yb,Pb):this.AV.add(Yb,Pb)):Ub===la.a.getTypeName()&&this.AV.remove(Yb)}dti(Pb,Ub,rb){const Yb=this.p0l(Ub);Ub=this.TLl(Ub);0<Ub&&Pb(rb,Yb,Ub)}TLl(Pb){try{return Number.parseInvariant(Pb.id.substr(2))}catch(Ub){u.ULS.sendTraceTag(554747009,367,10,Ub.toString())}return-1}SLl(Pb){let Ub;return({value:Ub}=this.AV.Dc(Pb,Ub)).returnValue?Ub:null}F1c(Pb){if(Pb)for(const Ub of Pb)this.PC(Ub,"AugLoop_Core_AddOperation")}p0l(Pb){if(Pb=Pb.content)switch(Pb.roleType){case pa.RoleType.Heading1:return 1;
case pa.RoleType.Heading2:return 2;case pa.RoleType.Heading3:return 3;case pa.RoleType.Heading4:return 4;case pa.RoleType.Heading5:return 5;case pa.RoleType.Heading6:return 6;case pa.RoleType.Heading7:return 7;case pa.RoleType.Heading8:return 8;case pa.RoleType.Heading9:return 9}return-1}xQm(Pb){Pb=Pb.roleType;return Pb===pa.RoleType.Heading1||Pb===pa.RoleType.Heading2||Pb===pa.RoleType.Heading3||Pb===pa.RoleType.Heading4||Pb===pa.RoleType.Heading5||Pb===pa.RoleType.Heading6||Pb===pa.RoleType.Heading7||
Pb===pa.RoleType.Heading8||Pb===pa.RoleType.Heading9}rIh(Pb){if(Pb===ra.a.getTypeName()||Pb===qa.a.getTypeName())return Pa.a.YYe;if(Pb===la.a.getTypeName())return Pa.a.cId;throw Error.create("Invalid operation type");}}Object(E.a)(Ka,"RoleDetectionAnnotationHandler",null,[52]);var Na=c(132),sa=c(61),wa=c(1141),ja=c(46),ha=c(74),va=c(55),xa=c(192),ma=c(152),Ja=c(648);class oa extends xa.a{constructor(Pb,Ub){super(Pb,Ub,n.App.yda);this.l0d=null;this.qib=this.x1b=0;this.headingsReady=!1;this.bSa=this.Mdb=
0;this.tKi=!1;this.c7g=this.MXg=this.UTg=null}get W_d(){return!0}get GXh(){return this.UTg}get U4d(){return this.c7g}eJj(){this.headingsReady&&(this.MXg.style.display="none",this.qib||this.x1b?(this.GXh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.GXh.style.display="block"))}get A8(){return super.A8|240}static Yaf(Pb,Ub,rb){var Yb=n.App.xa.hb.Uc;if(Yb&&(Yb=ma.PageNavigator.instance.MO(Yb))){const Ya=new oa(new Ja.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));
Ya.qib=0;Ya.x1b=0;Ya.l0d=null;Ya.Jzb(Pb);Ya.UTg=Ub;Ya.MXg=rb;Ya.JE(Yb);Ya.headingsReady=!0;Ya.eJj();Ya.c7g=null;return Ya}return null}}Object(E.a)(oa,"WordNavigationPaneHeadingsView",xa.a,[588,203,145,10]);class za{constructor(Pb){this.AV=new La.a;this.p8g=Pb}PC(Pb,Ub){Ub===ra.a.getTypeName()?(Ub=null,({value:Ub}=this.AV.Dc(Pb.id,Ub)).returnValue?this.AV.Z(Pb.id,Pb):this.AV.add(Pb.id,Pb)):Ub===la.a.getTypeName()&&this.AV.remove(Pb.id);this.p8g&&this.p8g()}F1c(Pb){if(Pb)for(const Ub of Pb)this.PC(Ub,
ra.a.getTypeName())}R6b(){var Pb;const Ub=[];if(0<(null===(Pb=this.AV)||void 0===Pb?void 0:Pb.count))for(const rb of this.AV.values)Ub.push(rb);return Ub}}Object(E.a)(za,"ContractEntityAnnotationHandler",null,[52]);var Fa=c(3);class kb{constructor(Pb){this.ga=Pb}hln(){this.cancelSearch()}lnn(Pb){this.ga.Qb(G.a.SSd,2,Pb)}Bqn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Fa.a.lAb,2)}Isn(){this.ga.processAction(Fa.a.findOnPage,2)}onSearchQueryChanged(Pb){this.ga.Qb(Fa.a.RLd,2,Pb)}uun(){this.ga.processAction(G.a.replace,
2)}vun(){this.ga.processAction(G.a.replaceAll,2)}oun(){this.ga.processAction(F.a.Yjf,2)}pun(){this.ga.processAction(F.a.mkf,2)}tun(){this.ga.processAction(Fa.a.V$d,2)}qun(){this.ga.processAction(Fa.a.i5d,2)}xgc(Pb){this.ga.Qb(G.a.xgc,2,Pb)}}Object(E.a)(kb,"FindReplaceActions",null,[587]);var fb=c(271);class lb{}lb.vP=fb.a.Dgb;lb.nfc=0;lb.Mua="FindReplaceTaskPaneData";lb.TR=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(E.a)(lb,"FindReplaceConstants",null,[]);var sb=c(756);class ab{MBj(Pb){var Ub,
rb,Yb;return fa.a.Ehb(null===(Yb=null===(rb=null===(Ub=n.App.xa)||void 0===Ub?void 0:Ub.hb)||void 0===rb?void 0:rb.Uc)||void 0===Yb?void 0:Yb.od,Pb)}clearSelection(){if(this.WHe){const Pb=this.MBj(this.WHe);Pb&&Pb.kma()}this.WHe=this.heh=null}cbo(Pb){this.clearSelection();if(Pb){const Ub=this.MBj(Pb.parentPath);if(Ub){const rb=Pb.content;rb&&(this.heh=Pb.id,Ub.WSa([new sb.a(rb.range.start,rb.range.start+rb.range.length)]),Ub.MLf(0,1));this.WHe=Pb.parentPath}}}}Object(E.a)(ab,"RangeAnnotationContentSelector",
null,[]);var Ga=c(1620);class Ua{constructor(Pb){this.d$j=Pb}get Kj(){return this.d$j.value}X3l(Pb){Pb=this.Kj.l1a(Pb);return this.RJm(Pb)?null:Pb}RJm(Pb){return Pb.id===this.Kj.UDa.id}static get instance(){return null!=Ua.fBg?Ua.fBg:Ua.fBg=Ua.WE()}static WE(){const Pb=new z.a(()=>y.FindManager.instance.Kj);return new Ua(Pb)}}Object(E.a)(Ua,"SearchResultOrder",null,[]);var wb=c(8),cc=c(202);class zb{constructor(Pb){this.rIe=Pb}get P0(){return this.rIe.value}getSelectedText(){var Pb=this.P0.I3;if(Pb){const Ub=
Pb.cpBegin,rb=Pb.cpEnd-Ub;if(0<rb&&(Pb=Pb.node,wb.ParagraphReader.Vb(Pb)))return Pb.characterData.substr(Ub,rb)}return null}static getInstance(){return zb.Rl()}static Rl(){const Pb=new z.a(()=>cc.a.instance);return new zb(Pb)}}Object(E.a)(zb,"SelectionHelper",null,[]);var nb=c(31),eb=c(119),Ib=c(331),Xa=c(853),Ra=c(238),gb=c(368),Bb=c(1853),$b=c(369);class Qb extends xa.a{constructor(Pb,Ub,rb){super(Pb,Ub,n.App.yda);this.q5a=rb;this.$li=!1}get W_d(){return!0}get A8(){return super.A8|248}static Yaf(Pb){var Ub=
n.App.xa.hb.Uc;const rb=$b.a.instance.Oc(3);return Ub&&(Ub=ma.PageNavigator.instance.MO(Ub))?(Pb=new Qb(new Ja.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),Pb),rb.u7c(Pb.ic),Pb.JE(Ub),rb.dispose(),Pb.$li=!0,Pb):null}}Object(E.a)(Qb,"WordNavigationPaneReactHeadingsView",xa.a,[203,145,10]);class Ac extends I{constructor(Pb,Ub,rb,Yb,Ya,Ob,vc,Sa,Ab,Fb,Va,Wa,jb){var mc,yb,Oa;super(Pb);this.mtb=lb.vP;this.olk="FindReplaceTaskPaneProps";this.Ub=N.FocusManager.instance();this.fVa=this.YLa=this.zZ=
this.uTe=null;this.xSb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.ied=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Zod=(null===(mc=a.AFrameworkApplication.K)||void 0===mc?void 0:mc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(yb=a.AFrameworkApplication.K)||void 0===yb?void 0:yb.$("NavPaneReactHeadings"));this.Rak=null===(Oa=a.AFrameworkApplication.K)||void 0===Oa?void 0:Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",
!1);this.BFj=()=>{this.isVisible&&this.kHd===w.a.intelligentPlaceholder&&this.Cm()};this.gB=new P.a;this.GWg=Ub;this.LJa=w.a.headings;this.NCc=l.a.initial;this.$ra=new ha.a;this.WP="";this.$sc={matchCase:!1,matchWholeWord:!1};this.iPe="";this.WQe=null;this.R2=rb;this.Sfh=!1;this.ncb=Yb;this.ib=Ya;this.gbk=Ob;this.PBa=vc;this.uI=Sa;this.Spd=!0;this.L6=this.K6=!1;this.Te=Ab;this.jH=Fb;this.Hb=Va;this.yV=Wa;this.EPg=jb;this.Yse&&this.PBa.dXn(()=>{this.Cm()})}get cUe(){return 1}get Yse(){return this.xSb&&
this.ied&&!!this.Te}get Zse(){return this.xSb&&this.Rak&&!!this.Te}get headingsReady(){return this.Zod?this.jH.headingsReady:this.akd?this.akd.headingsReady:!1}set headingsReady(Pb){this.Zod?this.jH.headingsReady=Pb:this.akd&&(this.akd.headingsReady=Pb)}get kHd(){return this.LJa}qrj(){this.LJa=w.a.headings;this.Cm()}yuo(){this.LJa=w.a.contracts;this.Cm()}hrj(){this.LJa=w.a.find;ca.a("NavigationPaneFind");this.Cm()}$rj(){this.LJa=w.a.replace;this.Cm()}Crj(){this.LJa=w.a.intelligentPlaceholder;this.Cm()}i8c(Pb){this.Sfh=
Pb;this.Cm()}jPc(){return this.kHd===w.a.replace}get jG(){return this.NCc}A7(Pb){this.NCc=Pb;this.Cm()}oZe(Pb){this.guk(Pb);this.Cm()}guk(Pb){const Ub=this.gbk(Pb[Pb.length-1]);if(Ub){let rb=-1;for(let Yb=0;Yb<this.$ra.count;Yb++)if(Ub.id===this.$ra.J(Yb).id){rb=Yb;break}-1===rb?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.$ra.RC(rb,this.RIh(Pb))}else this.$ra.addRange(this.RIh(Pb))}N$i(Pb){for(const Ub of Pb)for(Pb=this.$ra.count-1;0<=Pb;Pb--)if(this.$ra.J(Pb).id===
Ub.id){this.$ra.removeAt(Pb);break}this.Cm()}TGj(Pb){for(const Ub of Pb)for(Pb=this.$ra.count-1;0<=Pb;Pb--)if(this.$ra.J(Pb).id===Ub.id){this.$ra.Z(Pb,this.QIh(Ub));break}this.Cm()}xDh(){this.$ra.clear();this.WQe=null;this.Cm()}ffe(Pb){this.WQe=Pb?Pb.id:null;this.Cm()}RIh(Pb){if(!Pb)return new ha.a;const Ub=new ha.a;for(const rb of Pb)Ub.add(this.QIh(rb));return Ub}QIh(Pb){const Ub=this.ncb.RGd(Pb);return{id:Pb.id,searchBeginIndex:Ub.$de,searchEndIndex:Ub.Yde,searchResult:Ub.BFd}}rne(){}SXo(){var Pb=
{};this.qN.xgc(Pb);Pb=Pb[M.a.Value];this.uTe=aa.c(Pb)?"":Pb;this.Cm()}SOa(){return this.WP}YEb(){return this.iPe}iag(Pb){this.WP=Pb;this.Cm()}clearSearch(){}initialize(){this.yud=window.performance.now();const Pb=this.Ub.fe(this.mtb);Pb.parent=J.AFrame.vp;Pb.TH=!0;this.d_();this.A7(l.a.initial)}qP(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),V.UISurfaces.Bu().then(Pb=>{Pb.setSelectedTaskPane(this.mtb,this.cUe);this.M9();this.Spd&&
this.umj(!0);return null}).catch(Pb=>{Ac.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Pb)})):(this.p8c(),this.Spd&&this.umj(!1))}umj(Pb){const Ub=this.GWg();Ub?this.WP=Ub:Pb&&this.WP||(this.WP="");this.qN.onSearchQueryChanged(this.WP)}Wna(){V.UISurfaces.Bu().then(Pb=>{Pb.hideTaskPane(this.mtb,this.cUe);return null}).catch(Pb=>{Ac.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Pb)})}d_(){this.R2.INa();this.zZ=this.R2.Q3b(this.Ub);this.Qrk()}p8c(){V.UISurfaces.Bu().then(Pb=>
{this.yud=window.performance.now();Pb.showTaskPane(this.mtb,this.jA());Pb=[Object.assign(new nb.a,{name:"Tab",string:this.LJa})];const Ub=window.performance.now()-this.yud;ca.a("NavigationPaneOpen",!0,Ub,Pb);return null}).catch(Pb=>{Ac.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Pb)})}Cm(){V.UISurfaces.Bu().then(Pb=>{Pb.updateTaskPane(this.mtb,this.jA());return null}).catch(Pb=>{Ac.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Pb)})}jA(){const Pb=
{activeTab:w.a.initial};this.gB.qob(Pb);return Object.assign(new X.a,{title:lb.TR,hideHeader:!1,width:320,location:this.cUe,contentProps:Pb,onOpen:()=>{this.Is=!0;this.BWn();this.HTn();this.Spd&&this.M9();n.App.xa.updateCommandUI();n.App.xa.XYa(this.BFj)},onClose:()=>{try{const Ub=window.performance.now();this.eda();this.Is=!1;this.rQo();this.VQo();this.qN.Bqn();this.uTe="";this.NCc=l.a.initial;n.App.xa.ahc(this.BFj);n.App.xa.updateCommandUI();const rb=window.performance.now()-Ub;ca.a("NavigationPaneClose",
!0,rb)}catch(Ub){Ac.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ub)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}BWn(){this.Yse&&!this.YLa&&fa.a.$k().then(()=>{this.YLa=new Ka(this.PBa);this.Te.mb(this.YLa,this.YLa.annotationType);this.Te.getAnnotationsByType(this.YLa.annotationType).then(Pb=>{this.YLa.F1c(Pb)})})}VQo(){this.Yse&&this.YLa&&(this.Te.uc(this.YLa,this.YLa.annotationType),this.YLa=null)}VLo(){if(this.Zse){var Pb=new Bb.ContractEntitySignal;
Pb=Object.assign(new Xa.a,{parentPath:["Signal",Ra.a.getTypeNameFor(Pb)],items:[Object.assign(new gb.a,{body:Pb})]});this.yV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ib.a,{operation:Pb}))}}HTn(){this.Zse&&!this.fVa&&fa.a.$k().then(()=>{this.fVa=new za(this.Cm);this.Te.mb(this.fVa,Bb.ContractEntityAnnotation.getTypeName());this.VLo();this.Te.getAnnotationsByType(Bb.ContractEntityAnnotation.getTypeName()).then(Pb=>{this.fVa.F1c(Pb)})})}rQo(){this.Zse&&this.fVa&&(this.Te.uc(this.fVa,
Bb.ContractEntityAnnotation.getTypeName()),this.fVa=null)}Qrk(){this.gB.oL(this.QVl());this.gB.oL(this.SVl());this.gB.oL(this.pYl());this.gB.oL(this.lRl());this.gB.oL(this.k_l());this.gB.oL(this.oKl());this.gB.oL(this.onLinkExecute());this.gB.oL(this.onPivotTabExecute());this.gB.oL(this.Pbm());this.gB.oL(this.Iem());this.gB.oL(this.QZl());this.gB.oL(this.zfm());this.gB.oL(this.a$l())}zfm(){return Pb=>{Pb.autoDetectedHeadingsToggleDisabled=this.PBa?!this.PBa.WHk():!0}}Iem(){return Pb=>{Pb.type=this.olk}}onLinkExecute(){return Pb=>
{Pb.onLinkExecute=()=>{this.qN.Isn()}}}onPivotTabExecute(){return Pb=>{Pb.onPivotTabExecute=Ub=>{switch(Ub){case w.a.headings:this.qrj();break;case w.a.replace:this.$rj();break;case w.a.contracts:this.yuo();break;case w.a.intelligentPlaceholder:this.Crj();break;default:this.hrj()}aa.b(this.WP)&&(this.WP=this.GWg(),this.WP||(this.WP=""),aa.b(this.WP)||(this.qN.onSearchQueryChanged(this.WP),this.Cm()))}}}Pbm(){return Pb=>{Pb.showOutOfSyncNotification=this.Sfh}}SVl(){return Pb=>{Pb.findSearchBoxContent=
{onSearchQueryChanged:Ub=>{this.WP=Ub;this.Cm();this.qN.onSearchQueryChanged(Ub)},findOptions:this.$sc,matchCase:this.K6,matchWholeWord:this.L6,findSearchText:this.WP,onClearButtonExecute:()=>{void 0!==this.WP&&null!==this.WP&&""!==this.WP&&(this.WP="",this.ib.setSelection(null),this.qN.hln())},onMatchCaseExecute:()=>{this.$sc.matchCase=!this.$sc.matchCase;this.K6=!this.K6;this.Cm();this.qN.oun()},onMatchWholeWordExecute:()=>{this.$sc.matchWholeWord=!this.$sc.matchWholeWord;this.L6=!this.L6;this.Cm();
this.qN.pun()},onMenuClose:()=>{if(this.zZ)this.zZ.onMenuClose()},onMenuOpen:()=>{if(this.zZ)this.zZ.onMenuOpen()}}}}oKl(){return Pb=>{Pb.activeTab=this.kHd}}QZl(){return Pb=>{Pb.autoDetectedHeadingsToggleState=this.PBa?this.PBa.x2e:!1;this.jH.jLc=Pb.autoDetectedHeadingsToggleState;!Pb.autoDetectedHeadingsToggleState&&this.PBa&&this.PBa.ulc(!1)}}QVl(){return Pb=>{const Ub={onReplaceAllExecute:()=>{this.qN.vun()},onReplaceExecute:()=>{this.qN.uun()},onReplaceQueryChanged:rb=>{this.iPe=rb;this.Cm()},
replaceSearchText:this.iPe};Pb.findReplaceContent={searchResults:this.$ra.toArray(),replaceSearchBoxContent:Ub,onNextSearchResultExecute:()=>{this.qN.qun()},onPrevSearchResultExecute:()=>{this.qN.tun()},onSearchResultSelected:rb=>{const {FindReplaceUIManager:Yb}=c(1643);this.qN.lnn(rb);Yb.YJi(1)},selectedResultId:this.WQe,summaryLabel:this.uTe,explanationText:this.gVl(this.NCc),haveTooManySearchResults:this.NCc===l.a.tooManyResults}}}gVl(Pb){switch(Pb){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;
case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return Ga.a.Jei();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}a$l(){return Pb=>{Pb.replaceFollowUpsWithCommentsIsEnabled=!0}}k_l(){return Pb=>{var Ub=this.uI.dLl();const rb=[];for(const Yb of Ub)Ub=this.uI.yNd(Yb.Jc,Yb.id),rb.push({id:Yb.id.toString(),intelligentPlaceholderAnchorText:Ub});Pb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:rb,
onIntelligentPlaceholderInputExecute:Yb=>{this.WP=Yb;this.LJa=w.a.find;this.Cm();this.qN.onSearchQueryChanged(Yb)},onSearchResultSelected:Yb=>{this.Cm();Yb=f.a.Ff(Yb);this.uI.mbo(Yb)}}}}pYl(){return Pb=>{let Ub=()=>{};this.PBa&&(Ub=Object(va.a)(this.PBa,this.PBa.ulc,"toggleAutoDetectedHeadings"));Pb.headingsContent={onHeaderInputExecute:rb=>{this.WP=rb;this.LJa=w.a.find;this.Cm();ca.a("NavigationPaneFind");this.qN.onSearchQueryChanged(rb)},renderHeadingContent:(rb,Yb,Ya)=>{this.Hb.Wb(new W.a(0,1,
100,()=>{var Ob=window.performance.now()-this.yud;if(this.Zod){var vc=this.jH.s9;this.headingsReady=!0;this.Cm();Ya.style.display="none";vc.first&&(rb.style.display="block");this.Hb.Wb(new W.a(1,1,0,()=>{Qb.Yaf(this)}))}else this.akd=oa.Yaf(rb,Yb,Ya),this.Cm();vc=window.performance.now()-this.yud;ca.a("NavigationPaneHeadingsLoaded",!0,vc,[Object.assign(new nb.a,{name:"NavPaneReactHeadings",bool:this.Zod})]);Ob=[Object.assign(new nb.a,{name:"HeadingFetchStart",double:Ob}),Object.assign(new nb.a,{name:"HeadingFetchFinished",
double:vc})];ca.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Ob)}))},autoDetectedHeadingsToggle:Ub,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.jH.s9,onHeadingChevronClick:rb=>{this.jH.Dxl(rb);this.Cm()},onClickHeading:rb=>{if(this.Hb.Kv){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",rb);const Yb=window.performance.now();this.Hb.Wb(new W.a(0,1,0,()=>{this.jH.onClickHeading(rb);
this.Cm();const Ya=window.performance.now()-Yb;ca.a("NavigationPaneAsyncOnClickHeadingItem",!0,Ya)}))}else this.jH.onClickHeading(rb),this.Cm()},onClickBookmark:rb=>{if(this.Hb.Kv){u.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",rb);const Yb=window.performance.now();this.Hb.Wb(new W.a(0,1,0,()=>{this.jH.onClickBookmark(rb);this.Cm();const Ya=window.performance.now()-Yb;ca.a("NavigationPaneAsyncOnClickHeadingItem",!0,Ya)}))}else this.jH.onClickBookmark(rb),
this.Cm()},onShareHeadingClick:rb=>{this.jH.onShareHeadingClick(rb)},bookmarkIconUrl:Na.a.vg("BookmarkDefault.png")}}}kRl(){var Pb,Ub=null===(Pb=this.fVa)||void 0===Pb?void 0:Pb.R6b();if(Ub){Pb=Array(Ub.length);let rb=0;for(const Yb of Ub)(Ub=Yb.content)&&(Pb[rb++]={id:Yb.id,type:Ub.type,value:Ub.value});return Pb}return null}lRl(){return Pb=>{Pb.contractsContent={onHeaderInputExecute:Ub=>{this.WP=Ub;this.LJa=w.a.find;this.Cm();ca.a("NavigationPaneFind");this.qN.onSearchQueryChanged(Ub)},contractEntities:this.kRl(),
selectedEntityId:this.EPg.heh,onEntitySelected:Ub=>{var rb;const Yb=null===(rb=this.fVa)||void 0===rb?void 0:rb.R6b();if(Yb)for(const Ya of Yb)if(Ya.id===Ub){this.EPg.cbo(Ya);break}this.Cm()}}}}Klj(Pb){this.Spd=Pb}bWo(Pb){this.Hb.Wb(new W.a(0,1,0,()=>{this.jH.wmg(Pb)&&this.Cm()}))}Ulm(Pb){this.Hb.Wb(new W.a(0,1,0,()=>{const Ub=this.jH.TLb;this.jH.ojl(Pb)?this.Cm():0===this.jH.TLb&&0<Ub&&this.Cm()}))}Elg(Pb,Ub){this.Hb.Wb(new W.a(0,1,0,()=>{const rb=this.jH.TLb;this.jH.Elg(Pb,Ub)?this.Cm():0<this.jH.TLb&&
0===rb&&this.Cm()}))}Gil(Pb){this.Hb.Wb(new W.a(0,1,0,()=>{const Ub=this.jH.TLb;this.jH.Hil(Pb)?this.Cm():0===this.jH.TLb&&0<Ub&&this.Cm()}))}gno(Pb){this.jH.wJo(Pb);this.Cm()}emg(Pb){this.jH.emg(Pb)&&this.Cm()}mdf(Pb){this.jH.mdf(Pb)&&this.Cm()}WJn(){return 0<this.jH.TLb}M9(){this.Ub.mg(this.mtb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}eda(){if(this.p3a()){var Pb;(Pb=sa.InteractiveViewManager.instance.Bd)?(Pb=Pb.gJ,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):
(Pb=this.Ub.yT,u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Ub.mg(Pb)}}p3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===this.mtb}static getInstance(){return Ac.Rl()}static Rl(){return new Ac(new kb(a.AFrameworkApplication.va),Object(va.a)(zb.getInstance(),zb.getInstance().getSelectedText,"getSelectedText"),wa.a.instance,H.a.instance,ja.a.instance,Object(va.a)(Ua.instance,Ua.instance.X3l,"getNextSearchResult"),x.a.instance.Na("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
x.a.instance.Na("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Na("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),U.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new ab)}static recordQosError(Pb,Ub,rb){const Yb=Object.assign(new eb.a,{extendedProperties:new Map});rb&&Yb.extendedProperties.set("exception",rb);Y.Health.instance.recordQosError(Pb,Ub,!1,!0,!1,!1,Yb)}}Object(E.a)(Ac,
"ReactFindReplacePane",I,[575,576,10]);var Db=c(1577);c.d(K,"FindReplaceUIManager",function(){return dc});class dc{constructor(Pb,Ub,rb=null,Yb=null,Ya=null,Ob=null){this.xgd=this.p2=0;this.L6=this.K6=this.Yxb=!1;this.gm=this.D7g=this.Kja=null;this.sFa=this.kGe=!1;this.gj=Pb;this.Rp=rb;this.ncb=Yb;this.j4g=Ya;this.ge=Ob;dc.T1b=new L}get yFf(){return this.kGe}set yFf(Pb){Pb!==this.kGe&&(this.kGe=Pb,this.hCh())}nhe(Pb){this.p2=Pb;this.update();this.p2||this.jG!==l.a.searchComplete&&this.jG!==l.a.tooManyResults?
0<this.p2&&this.jG===l.a.noMatchesFound?this.A7(l.a.searchComplete):this.p2>dc.uzj&&this.jG!==l.a.tooManyResults&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.A7(l.a.tooManyResults)):this.A7(l.a.noMatchesFound)}Gfe(Pb){this.xgd=Pb;this.sFa&&this.update();this.j4g&&!this.j4g.value.B4c&&this.H$f()}reset(){}kkf(){this.ge&&(this.gm=this.ge.$f("UserAction","Find"));if(this.sFa||!this.jG)this.sFa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.A7(l.a.searching)}d6b(){var Pb;
this.sFa=!0;let Ub=this.p2?l.a.searchComplete:l.a.noMatchesFound;if(this.jG!==l.a.tooManyResults&&y.FindManager.instance){const rb=y.FindManager.instance.Kj;0<rb.qja&&(rb.qja>dc.uzj?Ub=l.a.tooManyResults:this.eXo(rb))}this.A7(Ub);this.update();this.gm&&(this.gm.stop(),this.gm=null);dc.Zgj=f.a.create().toString();dc.YJi(0,this.f4b,this.SOa().length,this.p2);Object(Db.b)()&&(null===(Pb=this.gj)||void 0===Pb?0:Pb.isVisible)&&(Pb={},a.AFrameworkApplication.va.Qb(F.a.xbe,2,Pb),Pb[k.a.On]&&a.AFrameworkApplication.va.Qb(F.a.aXd,
2,{CommandValueId:{query:this.SOa(),matchCase:this.K6,matchWholeWordOnly:this.L6,totalResultLimit:-1}}))}eXo(Pb){const Ub=Pb.UDa;let rb=Ub;const Yb=[];do Yb[Yb.length]=rb,rb=Pb.l1a(rb);while(Ub!==rb);this.gj.oZe(Yb);this.Kja&&this.gj.ffe(this.Kja)}update(){this.gj&&this.gj.SXo()}get jG(){return this.gj.jG}get f4b(){return this.gj.kHd}tob(Pb){this.yFf=Pb}hCh(){if(this.yFf)switch(this.jG){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.gj.i8c(!0)}else this.gj.i8c(!1)}A7(Pb){if(this.gj.isVisible){switch(Pb){case l.a.noMatchesFound:case l.a.searchComplete:this.jG===
l.a.tooManyResults&&(Pb=l.a.tooManyResults)}this.gj&&(this.gj.A7(Pb),this.hCh());this.update();this.H$f()}}tOa(Pb,Ub){const rb=this.sFa&&this.jG!==l.a.tooManyResults;switch(Pb){case 0:rb&&this.gj.oZe(Ub);break;case 1:rb&&this.gj.N$i(Ub);break;case 4:rb&&this.gj.TGj(Ub);break;case 2:this.gj.xDh();break;case 3:this.Kja=Ub[0],rb&&0<this.p2&&this.gj.ffe(this.Kja)}}get matchCase(){return this.K6}set matchCase(Pb){this.K6!==Pb&&(this.K6=Pb,this.bFj())}get matchWholeWord(){return this.L6}set matchWholeWord(Pb){this.L6!==
Pb&&(this.L6=Pb,this.bFj())}bFj(){this.gj.rne()}SOa(){return this.gj.SOa()}YEb(){return this.gj.YEb()}iag(Pb){this.gj.iag(Pb)}clearSearch(){this.gj.clearSearch()}get asj(){return 0<this.p2&&this.jG!==l.a.replaceAllInProgress&&this.jG!==l.a.replaceAllComplete}cfo(Pb){let Ub="";Pb?Ub=0<this.p2?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.SOa(),this.YEb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.SOa(),this.YEb()):
Pb||0<this.p2&&(Ub=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.H$f(Ub)}dispose(){this.gj.dispose()}jPc(){return this.gj.jPc()}Ojo(Pb,Ub=!0){Pb!==this.f4b&&(Pb===w.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.gj.qrj()):Pb===w.a.find?this.gj.hrj():Pb===w.a.replace?this.gj.$rj():Pb===w.a.intelligentPlaceholder&&(Ub||this.gj.Klj(Ub),this.gj.Crj()))}WB(Pb,Ub=!0){this.gj.Klj(Ub);Pb?(this.Yxb||this.Szf(),this.gj.qP(),this.p2||this.jG===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.gj.A7(l.a.searchComplete):this.A7(l.a.initial)):this.gj.Wna()}Szf(){this.Yxb||(this.gj.initialize(),this.Yxb=!0)}H$f(Pb=""){var Ub=this.o$l();Ub&&(Pb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Pb,Ub));this.ncb&&Ub&&this.Kja&&this.jG!==l.a.tooManyResults&&this.jG!==l.a.replaceAllInProgress&&(Ub=this.ncb.RGd(this.Kja),Pb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Pb,Ub.BFd));(Ub=this.fVl())&&(Pb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Pb,Ub));this.Rp&&Pb&&this.D7g!==Pb&&(this.D7g=Pb,this.Rp.sendNotification(Pb,!0))}o$l(){let Pb="";switch(this.jG){case l.a.startSearch:Pb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:Pb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.xgd,this.p2);break;case l.a.tooManyResults:this.sFa&&(Pb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.xgd,this.p2));break;case l.a.noMatchesFound:Pb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:Pb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:Pb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Pb}fVl(){let Pb="";switch(this.jG){case l.a.initial:Pb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.KVl());break;case l.a.noMatchesFound:Pb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:Pb=Ga.a.Jei();break;case l.a.tooManyResults:Pb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Pb}KVl(){let Pb="";this.K6&&this.L6?Pb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.K6?Pb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.L6&&(Pb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Pb}static getInstance(Pb){return dc.Rl(Pb)}static Rl(Pb){const Ub=Ac.getInstance();return new dc(Ub,Pb,x.a.instance.resolve("Common.Utils.IAriaNotifier"),H.a.instance,new z.a(()=>y.FindManager.instance.UMb),n.App.xa.Gq)}static YJi(Pb,Ub=-1,rb=-1,Yb=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Pb,["SearchComplete.ResultsCount"]:Yb,
["SearchOpsCorrelation"]:dc.Zgj,["ActionId"]:dc.T1b.actionId,["SourceControlId"]:dc.T1b.LHa,["IsNavPanOpenedAlready"]:dc.T1b.qNm,["IsSearchFromNavPane"]:dc.T1b.RQm,["CurrentTab"]:Ub,["QueryLength"]:rb})}static BPk(Pb,Ub,rb){Ub=void 0!==Ub&&null!==Ub?void 0===Ub.SourceControlId||null===Ub.SourceControlId?"Unknown":Ub.SourceControlId:Pb===G.a.Pob?"FindKeyboardShorcut":Pb===G.a.Rob?"ReplaceKeyboardShorcut":"Unknown";switch(Pb){case G.a.Gjc:Pb="ShowHeadingsPane";break;case G.a.Pob:Pb="ShowFindPane";break;
case G.a.Rob:Pb="ShowReplacePane";break;case G.a.Jjc:Pb="ShowIntelligentPlaceholderPane";break;case G.a.r7a:Pb="ToggleNavigationPane";break;default:Pb="Unknown"}dc.T1b=new L(Pb,Ub,rb,!0)}}dc.uzj=100;dc.Zgj=null;dc.T1b=null;Object(E.a)(dc,"FindReplaceUIManager",null,[532,533,10])},1644:function(E,K,c){c.r(K);E=c(0);var l=c(166),f=c(96),a=c(79),k=c(2),x=c(22),y=c(65),n=c(1082),u=c(131),z=c(9),w=c(7),F=c(16),G=c(271),H=c(468),L=c(1541),I=c(1815),N=c(26),P=c(332),M=c(11),J=c(444),V=c(17),X=c(263),W=c(46),
U=c(528),Y=c(1688);class ca{constructor(ab,Ga,Ua,wb,cc,zb,nb){this.o7g=this.Fah=this.JVg=this.tI=this.K8a=this.SRb=this.PAe=this.Jwe=this.rye=this.VV=this.xea=this.Gea=null;this.fne=()=>{const eb=this.Rsa.v7b(this.tI),Ib=this.Rsa.XWl(this.tI);this.Jwe.innerText=eb.toString();this.PAe.innerText=Ib.toString();I.a.TNb(this.Gea,1===eb?!1:!0);I.a.TNb(this.xea,eb===Ib?!1:!0)};this.pho=()=>{const eb=this.Ub.getRegion(G.a.x0a);let Ib;if(this.VV&&!this.VV.disabled)Ib=this.VV;else if(this.Gea.disabled){if(this.xea.disabled)return;
Ib=this.xea}else Ib=this.Gea;Ib.focus();eb.Zj.Iy(Ib)};this.Lpa=(eb,Ib)=>{(eb=Ib.nl.kb)&&this.VV&&I.a.TNb(this.VV,V.SelectionEditor.km(eb)?!0:!1)};this.u7e=()=>{if(!this.xea.disabled){const eb=this.Rsa.yjb(this.tI)?F.a.P4d:F.a.O4d;this.ga.processAction(eb,2)}return!0};this.v7e=()=>{if(!this.Gea.disabled){const eb=this.Rsa.yjb(this.tI)?F.a.R4d:F.a.Q4d;this.ga.processAction(eb,2)}return!0};this.t7e=()=>{this.VV&&!this.VV.disabled&&this.ga.processAction(F.a.JEi,2);return!0};this.Ub=ab;this.ga=wb;this.ig=
cc;this.ae=zb;this.ib=nb;this.Rsa=Ua;this.K7=document.createElement("div");this.K7.classList.add("FootnoteEndnoteActionBarControl");this.K7.style.zIndex=String(X.a.wJd);this.K7.style.position="relative";this.Trc=document.createElement("div");this.Trc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.K7.appendChild(this.Trc);this.O7k();this.K7.appendChild(this.SRb);this.K7.appendChild(this.K8a);this.sZ=f.KeyInputManager.kc(a.a.t1,0);this.kym();this.jym()}iga(ab){w.ULS.shipAssertTag(4520065,
308,this.Rsa.toa(ab));if(this.tI!==ab){this.tI=ab;this.fne();ab=this.Rsa.yjb(this.tI);this.i$k(ab);this.tI.Rph(this.fne);let Ga="",Ua="";const wb=this.Rsa.v7b(this.tI);-1!==wb&&(Ga=(wb-1).toString(),Ua=(wb+1).toString());ab?(this.xea.title=this.xea.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Ua),this.Gea.title=this.Gea.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,
Ga)):(this.xea.title=this.xea.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,Ua),this.Gea.title=this.Gea.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ga));this.UGa()}}bCb(){this.tI&&(this.VV&&this.VV.parentNode===this.SRb&&this.SRb.removeChild(this.VV),this.xja(),this.tI.l0n(this.fne),this.tI=null)}dispose(){this.Ub.fe(G.a.x0a).ir(this.sZ)}i$k(ab){3===
this.ga.mode&&(ab=ab?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.VV=this.A$e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",ab,null),N.a.gr(this.VV,N.a.pfa,ab),this.SRb.appendChild(this.VV))}O7k(){this.SRb=document.createElement("div");this.SRb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.K8a=document.createElement("div");this.K8a.classList.add("FootnoteEndnoteActionBarButtonHolder",
"FootnoteEndnoteActionBarRightDiv");this.Gea=this.A$e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.K8a.appendChild(this.Gea);this.Jwe=J.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.K8a.appendChild(this.Jwe);this.rye=J.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.rye.innerText=" / ";this.K8a.appendChild(this.rye);this.PAe=J.b("span","FootnoteEndnoteActionBarTotalCount",
"FootnoteEndnoteActionBar");this.K8a.appendChild(this.PAe);this.xea=this.A$e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.K8a.appendChild(this.xea)}A$e(ab,Ga,Ua,wb){ab=I.a.m_a(ab,Ga,Ua,wb,void 0===wb||null===wb);ab.setAttribute(N.a.qh,N.a.f3);return ab}kym(){const ab=this.Ub.fe(G.a.x0a);ab.parent=u.AppFrame.vp;ab.bindAction(this.sZ,F.a.z3);ab.ffa(this.pho)}jym(){var ab=new P.DOMFocusListing(()=>this.K7);ab.Tpa=!1;ab.Xm(2);ab.Xm(1);ab=this.Ub.Wzb(this.K7,
this.Ub.fe(G.a.x0a),ab);ab.oSa();ab.oR=!0}UGa(){this.VV&&(this.ig.mb(M.a.click,this.VV,this.t7e),this.JVg=this.ae.pnb(this.VV,this.t7e,a.a.Bs));this.ig.mb(M.a.click,this.Gea,this.v7e);this.Fah=this.ae.pnb(this.Gea,this.v7e,a.a.Bs);this.ig.mb(M.a.click,this.xea,this.u7e);this.o7g=this.ae.pnb(this.xea,this.u7e,a.a.Bs);this.ib.Pw(this.Lpa)}xja(){this.VV&&(this.ig.uc(M.a.click,this.VV,this.t7e),this.ae.dqb(this.VV,this.JVg));this.ig.uc(M.a.click,this.Gea,this.v7e);this.ae.dqb(this.Gea,this.Fah);this.ig.uc(M.a.click,
this.xea,this.u7e);this.ae.dqb(this.xea,this.o7g);this.ib.DY(this.Lpa)}static SWl(){return ca.TWl()}static TWl(){return new ca(y.FocusManager.instance(),Y.a.instance,U.a.instance,k.AFrameworkApplication.va,z.App.xa.hD,z.App.xa.iD,W.a.instance)}}Object(E.a)(ca,"FootnoteEndnoteActionBarControl",null,[517]);var aa=c(230),fa=c(13),pa=c(1594),ra=c(1777);class la{constructor(ab,Ga,Ua,wb,cc,zb,nb,eb,Ib,Xa,Ra,gb){this.tE=null;this.AS=!1;this.Wv=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.GXb=
ab;this.e5b=Ga;this.ioc=Ua;this.Nck=wb;this.sLe=cc;this.em=zb;this.U$a=nb;this.ig=eb;this.n$g=Ib;this.B0j=Ra;this.Cr=this.GXb.ownerDocument.createElement("div");this.Cr.id="FootnoteEndnoteControlOverlay";this.Cr.className="EditingSurfaceOverlay";this.mI=this.mRl();this.Q0(!1);this.GXb.appendChild(this.Cr);this.GXb.appendChild(this.mI);this.e5b.bind();this.ei=null;this.ga=gb;this.qKa=Xa}a5n(){const ab=this.n$g();ab&&ab.Vi&&(ab.Snb=0,ab.Lzd())}aEj(ab){if(this.LEc){const Ga=this.LEc.mna;Ga&&(Ga.lDf=
ab)}}get ax(){return this.AS}get LEc(){return this.tE}get dialog(){return this.ei}get xo(){return null!=this.cAg?this.cAg:this.cAg=x.a.instance.Sa("Common.IZoomManager")}faf(){this.ei=ra.a.aXl()}U4c(){this.ei=null}show(ab=!0){this.AS||(this.aEj(!0),this.B0j(),this.Q0(!0),this.zz(),ab&&this.setFocus())}setFocus(){this.AS&&(this.e5b.setInitialSelection(),this.Nck())}update(){this.AS&&(this.tE.isConnected?this.ioc.fne():this.dismiss())}dismiss(ab=!1,Ga=!1){this.AS&&(this.aEj(!1),this.h$(),this.a5n(),
this.Q0(!1),this.sLe(Ga),this.ei&&(this.ga.processAction(fa.a.qJc,2),this.ei=null),!ab&&this.tE&&this.tE.isConnected&&this.qKa.lbo(this.tE),this.bCb())}L3n(ab){const Ga=null!==this.xo.instance?this.xo.instance.hj:1;this.mI.style.width=ab.tHh*Ga+"px";this.Wv.style.width=ab.vHc*Ga+"px";this.mI.style.marginLeft=ab.c3b*Ga+"px";this.em?this.Wv.style.marginRight=ab.J9e*Ga+"px":this.Wv.style.marginLeft=ab.m3b*Ga+"px";if(ab=this.n$g())ab=ab.pL,this.mI.style.bottom=ab.offsetHeight-ab.clientHeight+"px"}iga(ab){w.ULS.shipAssertTag(4520073,
308,this.U$a.toa(ab));this.tE!==ab&&(this.tE=ab,this.e5b.iga(ab),this.ioc.iga(this.tE))}dispose(){this.dismiss();this.e5b.dispose();this.ioc.dispose()}zz(){this.ig&&this.ig.mb(M.a.click,this.Cr,this.onClick)}h$(){this.ig&&this.ig.uc(M.a.click,this.Cr,this.onClick)}mRl(){let ab;ab=document.createElement("div");ab.classList.add("FootnoteEndnoteControl");this.Wv=document.createElement("div");this.Wv.classList.add("FootnoteEndnoteContent");this.Wv.appendChild(this.e5b.K7);this.Wv.appendChild(this.ioc.K7);
ab.appendChild(this.Wv);return ab}Q0(ab){ab=(this.AS=ab)?"":"none";this.Cr.style.display=ab;this.mI.style.display=ab}bCb(){this.tE&&(this.e5b.bCb(),this.ioc.bCb(),this.tE=null)}static LQd(){const ab=z.App.xa.hb.rc;return ab&&ab.Vi?ab:null}static WWl(ab,Ga,Ua,wb,cc){return new la(ab,Ga,Ua,wb,cc,k.AFrameworkApplication.isRtl,U.a.instance,aa.a.instance,la.LQd,pa.a.instance,la.Tnl,k.AFrameworkApplication.va)}static Tnl(){k.AFrameworkApplication.va.Qb(fa.a.uib,2,!0)}}Object(E.a)(la,"FootnoteEndnoteControl",
null,[516]);var qa=c(811),La=c(5),Pa=c(205),Ka=c(36),Na=c(8),sa=c(23),wa=c(78),ja=c(1687),ha=c(348),va=c(971),xa=c(576),ma=c(1455),Ja=c(61),oa=c(110);class za extends ha.a{constructor(ab,Ga,Ua,wb,cc,zb,nb,eb,Ib,Xa,Ra,gb,Bb,$b,Qb,Ac,Db){super(G.a.qga,Ua,wb,cc,nb,eb,Ib,Xa,Ra,gb,Bb,$b,Qb,Ac,Db);this.HPg=ab;this.IXa=zb;this.IXa.Q9c=this;Ga(this);this.features.Wgg=!0}get Mwi(){return!0}wvf(){const ab=this.HPg.rmf(this);return va.ViewReference.cF(this,ab)}Sef(ab){Object(oa.a)(za,ab)||this.HPg.Pef()}oPc(){return xa.a.hOi}onResize(){super.onResize();
this.IXa.pWh()}JE(ab,Ga=null){super.JE(ab,Ga);this.IXa.bWh(this.Yc.pj)}detach(){this.IXa.oWh();super.detach()}UMd(){this.onResize()}static k_a(){const {FootnoteEndnoteControlManager:ab}=c(1644);return new za(ab.instance,ma.a.Y8e,z.App.xa.hb,Ja.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.va,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),
x.a.instance.Sa("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Sa("Common.IZoomManager"),x.a.instance.Na("Box4.IContentControlViewElementManager"),x.a.instance.Na("Box4.CpConversionManagerImpl"),x.a.instance.Na("Box4.ContentControlConfigSettings"),x.a.instance.Na("Box4.IContentControlReader"),x.a.instance.Na("Box4.IContentControlBoundaryNavigator"))}}Object(E.a)(za,"FootnoteEndnoteEditView",ha.a,[]);class Fa{constructor(ab,Ga,Ua,wb=!1){this.stb=
null;this.aFe=this.CMg=!1;this.oGl=()=>{const cc=String.format("{0} {1}",this.aFe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.uu.sendNotification(cc,!0)};this.Ub=ab;this.Rsa=Ga;this.hea=Ua();this.tld=wb;this.K7=document.createElement("div");this.K7.classList.add("FootnoteEndnoteEditControl");this.Trc=
document.createElement("div");this.Trc.classList.add("FootnoteEndnoteEditControlDividerElement");this.Ayb=(new qa.a(this.K7,"WACViewPanel_FootnoteEndnoteEditControl")).hI;this.K7.appendChild(this.Trc);this.K7.appendChild(this.Ayb)}get uu(){return null!=this.Mvg?this.Mvg:this.Mvg=x.a.instance.resolve("Common.Utils.IAriaNotifier")}iga(ab){w.ULS.shipAssertTag(4520077,308,this.Rsa.toa(ab));this.stb!==ab&&(this.stb=ab,this.n2e(this.stb),this.aFe=this.Rsa.yjb(this.stb),this.tld?(this.hea.WNb(N.a.MAd),this.Ub.fe(G.a.qga).k7(this.oGl)):
this.hea.okj(this.aFe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,N.a.MAd))}bCb(){const ab=U.a.instance.yjb(this.stb)?"Footnote":"Endnote";w.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:ab,["CalloutHeight"]:this.K7.scrollHeight});this.Cfb();this.stb=null}bind(){this.CMg||(this.hea.Jzb(this.Ayb),this.CMg=!0)}setInitialSelection(){const ab=this.Yam();ab?this.hea.setSelection(ab):this.hea.g7c()}dispose(){this.Cfb()}n2e(ab){this.Cfb();
this.hea.JE(ab,ab.pj)}Cfb(){this.hea.detach()}Yam(){let ab=0;var Ga=null,Ua=La.GraphIterator.$a(this.stb);Pa.OutlineNavigator.c9(Ua);if((Ua=Ka.OutlineElementNavigator.Ge(Ua))&&Na.ParagraphReader.Vb(Ua)){if(Ga=Fa.U_l(Ua)){ab=Ga.Ib.cp+1;Ga=ja.FootnoteEndnoteDefaultContentInserter.lPh;const wb=Ga.length;ab+wb<=Na.ParagraphReader.textLength(Ua)&&Ua.characterData.substr(ab,wb)===Ga&&(ab+=wb)}Ga=sa.SelectionFactory.ue(Ua,ab)}return Ga}static YWl(){return Fa.ZWl()}static ZWl(){return new Fa(y.FocusManager.instance(),
U.a.instance,()=>za.k_a(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static U_l(ab){ab=wa.i(ab,10);return 0<ab.length?ab[ab.length-1]:null}}Object(E.a)(Fa,"FootnoteEndnoteEditControl",null,[513]);var kb=c(1175);class fb{constructor(ab,Ga){this.kBa=ab;this.em=Ga}w8b(ab,Ga){ab=this.kBa.w8b(ab);var Ua=Ga.clientWidth;const wb=Ga.scrollLeft,cc=ab.tHh;let zb=ab.c3b,nb=ab.c3b,eb=fb.WMf,Ib=fb.XMf,Xa=cc,Ra=ab.vHc;this.em?Ib=ab.J9e-nb:eb=ab.m3b-zb;Ua<cc&&(zb=Math.max(zb-
wb,0),Xa=Ua-zb,this.em?(Ua=Ga.scrollWidth-wb-Ua,nb=Ga.scrollWidth-ab.c3b-cc,Ib=Math.max(ab.J9e-Ua-nb,fb.XMf),Ra=Xa-Ib-fb.WMf):(eb=Math.max(ab.m3b-wb-zb,fb.WMf),Ra=Xa-eb-fb.XMf));return new kb.a(zb,Xa,eb,Ib,Ra)}}fb.WMf=25;fb.XMf=50;Object(E.a)(fb,"FootnoteEndnoteViewPositionProvider",null,[]);class lb{constructor(ab,Ga=0,Ua=0){this.clientWidth=ab;this.scrollLeft=Ga;this.scrollWidth=Ua?Ua:ab}}Object(E.a)(lb,"PageViewScrollContainerSizeInfo",null,[]);c.d(K,"FootnoteEndnoteControlManager",function(){return sb});
class sb{constructor(ab,Ga,Ua,wb,cc,zb,nb,eb){this.pE=null;this.M9=()=>{this.fp.FI(G.a.qga);this.fp.FI(G.a.x0a);this.fp.Ww(l.AFrame.Pn);this.Ub.jDc(G.a.qga);this.Ub.mg(G.a.qga)};this.xho=Ib=>{this.fp.Ww(G.a.qga);this.fp.Ww(G.a.x0a);this.fp.FI(l.AFrame.Pn);this.Ub.QIc(G.a.qga);(Ib||this.Ub.currentScope&&(this.Ub.currentScope.name===G.a.qga||this.Ub.currentScope.name===G.a.x0a))&&this.Ub.mg(l.AFrame.Pn)};this.Ub=ab;this.fp=Ga;this.I3j=Ua;this.J3j=wb;this.H3j=cc;this.kBa=zb;this.csa=nb;this.CZ=eb;this.sZ=
f.KeyInputManager.kc(a.a.t1,0);this.Lzf();this.gT()}get control(){return this.pE}get dialog(){return this.control.dialog}get Yui(){return this.control.ax}faf(){this.control.faf()}U4c(){this.control.U4c()}bind(ab){this.z3k(ab)}Ldg(ab){if(this.control.LEc!==ab.e_a)this.control.dismiss();else if(this.Yui)return;this.I4b();this.control.iga(ab.e_a);this.control.show(ab.Ehe)}I4b(){if(this.CZ){const ab=new n.a(!0);this.CZ.PGa(ab)}}GY(){this.control.setFocus()}Fad(){this.control.update()}Pef(ab,Ga=!1){this.I4b();
this.control.dismiss(ab,Ga)}J3n(ab){const Ga=sb.LQd().pL;ab=this.kBa.w8b(ab,new lb(Ga.clientWidth,Ga.scrollLeft,Ga.scrollWidth));this.control.L3n(ab)}dispose(){this.control.dispose();this.Ub.fe(G.a.qga).ir(this.sZ)}rmf(ab){w.ULS.shipAssertTag(4520074,308,!!this.control);w.ULS.shipAssertTag(4520075,308,!!this.control.LEc);return this.smf(this.control.LEc.id,ab)}z3k(ab){const Ga=this.J3j(),Ua=this.H3j();this.pE=this.I3j(ab,Ga,Ua,this.M9,this.xho)}Lzf(){const ab=this.Ub.fe(G.a.qga);ab.parent=3===k.AFrameworkApplication.va.mode?
u.AppFrame.YE:u.AppFrame.Kgc;this.Ub.EYe(G.a.qga);ab.bindAction(this.sZ,F.a.z3)}gT(){this.fp.gT(G.a.qga);this.fp.gT(G.a.x0a)}smf(ab,Ga){return()=>{const Ua=sb.LQd().Yc.Jc.Db(ab);this.csa.D5b();if(!Ua.isConnected)return w.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.Ldg(new H.a(Ua,!0));return Ga}}static Rl(){const ab=new fb(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new sb(y.FocusManager.instance(),
z.App.xa.nx,la.WWl,Fa.YWl,ca.SWl,ab,L.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static LQd(){const ab=z.App.xa.hb.rc;return ab&&ab.Vi?ab:null}static get instance(){return null!=sb.hCg?sb.hCg:sb.hCg=sb.Rl()}}Object(E.a)(sb,"FootnoteEndnoteControlManager",null,[490])},1665:function(E,K,c){c.d(K,"a",function(){return z});E=c(0);var l=c(7),f=c(55),a=c(166),k=c(2),x=c(11),y=c(161),n=c(127),u=c(22);class z{constructor(w,F){this.Pt=
null;this.msd=!1;this.ebb=0;this.T2g="";this.mue={};this.YJe=w;this.Ub=F;this.L8g=Object(f.a)(this,this.CUf,"onModalMouseWheel");this.P1g=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Nb.Ioa;this.Jw=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Nb.xJ}onMenuOpen(){0<this.ebb?this.ebb++:(this.ebb++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(f.a)(this,
this.j4i,"pushTransientFocusScope"),0)}):this.j4i(),this.showModal())}j4i(){this.Ub&&this.Ub.nL(a.AFrame.Ppa,!0)}eOl(){const w=n.f(),F=appChrome.selectors.getShyState();return String.format("{0}{1}",w,this.P1g&&F.isActive&&1===F.state?"_ShyRibbon":"")}Mfm(w){var F=0;if(this.Jw){if(this.mue[w])return this.mue[w];(F=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");F=F?F.offsetTop:0;this.mue[w]=
F}return F}showModal(){if(!this.Pt)if(this.Pt=this.createElement("div"),this.Pt.setAttribute("id","ReactModalDiv"),this.Pt.style.position="absolute",this.Pt.style.bottom="0px",this.Pt.style.left="0px",this.Pt.style.right="0px",this.Pt.style.backgroundColor="white",this.Pt.style.opacity="0.0",this.Jw){var w=document.getElementById("regionComposerRoot");w&&w.appendChild(this.Pt)}else this.YJe.appendChild(this.Pt);w=this.eOl();if(w!==this.T2g){const F=this.Mfm(w),G=appChrome.selectors.getShyState();
this.P1g&&G.isActive&&1===G.state&&n.a("getRibbonHeight")?this.Pt.style.top=String.format("{0}px",F+appChrome.api.getRibbonHeight(n.f())):this.Pt.style.top=String.format("{0}px",F);this.T2g=w}this.Pt.style.display="block";this.Pt.style.visibility="visible";this.Pt.style.zIndex="1000";this.msd||(window.addEventListener("wheel",this.L8g,!0),this.lZd()?y.a.instance.mb(x.a.VM,this.Pt,Object(f.a)(this,this.g7d,"onModalPointerUp")):y.a.instance.mb(x.a.pointerDown,this.Pt,Object(f.a)(this,this.f7d,"onModalPointerDown")),
this.msd=!0)}onMenuClose(){this.ebb--;0<this.ebb||(0>this.ebb?this.ebb=0:this.lni())}SSf(){this.ebb=0;this.FJc();this.lni()}createElement(w){w=document.createElement(w);w.setAttribute("unselectable","on");return w}kni(){this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name===a.AFrame.Ppa&&!k.AFrameworkApplication.pc.Kv&&this.Ub.CR(a.AFrame.Ppa,!1);this.Pt&&(this.Pt.style.zIndex="-1",this.Pt.style.visibility="hidden",this.Pt.style.display="none");this.msd&&(window.removeEventListener("wheel",this.L8g,
!0),this.lZd()?y.a.instance.uc(x.a.VM,this.Pt,Object(f.a)(this,this.g7d,"onModalPointerUp")):y.a.instance.uc(x.a.pointerDown,this.Pt,Object(f.a)(this,this.f7d,"onModalPointerDown")),this.msd=!1)}lni(){this.lZd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.kni()},0)}):this.kni()}f7d(){this.H4b();this.RRh();this.SSf();this.p6a();return!0}g7d(){this.H4b();this.RRh();this.SSf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.p6a()},0)});return!0}p6a(){4===k.AFrameworkApplication.ta.Nb.Sl&&
k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ta.p6a():this.Ub.mg(a.AFrame.Pn)}CUf(w){w.stopPropagation()}H4b(){const w=u.a.instance.Na("Common.IReactContextualUILauncher");w&&w.H4b()}FJc(){const w=u.a.instance.Na("Common.IReactContextualUILauncher");w&&w.FJc()}RRh(){k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Nb.nQa&&(this.lZd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}lZd(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(E.a)(z,"ReactModalDiv",null,[])},1670:function(E,K,c){c.d(K,"a",function(){return f});c.d(K,"b",function(){return a});c.d(K,"c",function(){return k});var l=c(2);const f=(x,y)=>{const n=RegExp("mailto:(.*)").exec(x.url);y.email=n&&2===n.length?n[1]:x.url;y.resolveState=x.ew.charAt(35)===c(1765).ACommentFormatTranslator.$Gk?1:0},a=(x,y)=>{y.contentId=x.ew},k=(x,y,n)=>{y.contentId=x.ew;y.isCurrentUser=n.email===l.AFrameworkApplication.K.jb("UserPrincipalName")}},1671:function(E,K,c){c.d(K,
"a",function(){return a});E=c(0);var l=c(1038),f=c(6);class a{constructor(k,x){this.xN=this.Rxc=null;this.eb=k;this.A9a=x}get key(){return"COMMENT"}get Uw(){return WordEditorIntl.WordEditorStrings.L_Comment}get v3(){return this.xN}reset(k){this.xN=k.node}qIa(k){let x=null;if(this.Rxc&&this.dvi(k,this.v3,this.Rxc))return x=Object.assign(new l.a,{LG:this.key,contentObject:this.Rxc}),{returnValue:!0,RF:x};this.Rxc=null;const y=this.A9a.zaf(this.v3);if(this.A9a.RBf(y)){let n=y.Qd();for(;n;){if(this.dvi(k,
this.v3,n))return this.Rxc=n,x=Object.assign(new l.a,{LG:this.key,contentObject:n,description:this.lhb()}),{returnValue:!0,RF:x};n=y.Rj()}}return{returnValue:!1,RF:x}}dvi(k,x,y){if(this.pqj(y))return!1;const n=this.A9a.A8b(y,!0),u=this.A9a.A8b(y,!1);return n&&u&&this.eb.XUc(x,n,u)&&(x=this.A9a.Ava(n,y.id,!0))&&(n!==this.v3||x.Ib.cp<=k)&&(y=this.A9a.Ava(u,y.id,!1))&&(u!==this.v3||y.Ib.cp>k||y.Ib.cp>=k)?!0:!1}pqj(k){return k.ia(f.a.DG,!1)}lhb(){return null}}Object(E.a)(a,"CommentDetailsProvider",null,
[567,568])},1677:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);K=c(153);var l=c(100);class f extends K.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(E.a)(f,"DocumentTypeClassifierAnnotation",K.a,[])},1681:function(E,K,c){c.d(K,"a",function(){return z});
E=c(0);var l=c(2),f=c(353),a=c(83),k=c(7),x=c(55),y=c(84),n=c(60),u=c(339);class z{constructor(w,F,G,H,L,I){this.YMe=null;this.yah=0;this.J2=!1;this.rd=H;this.Se=F;this.b6=L;this.WCe=G;this.Qpc=l.AFrameworkApplication.ydg();this.Zue=w.appSettings.ChromeClipboardAccessOperationTimeout;this.pI=0;this.AYj=I;this.S1j=w.$("EnableExternalPasteSupportOnMobileIsEnabled");this.Nh=f.a.getInstance(u.a.FZa);this.J2=w.$("ShouldLogCcpExtendedHealthKpis")}get PRa(){return this.b6.PRa}process(w,F){if(!this.pI)return this.xAn(F);
if(1===this.pI)return this.prepareForPaste(w,F);if(2===this.pI)return this.pI=3,this.YMe(w,F);3===this.pI&&this.b6.ymj(w,F);return!1}xAn(w){let F=!0;this.S1j&&(F=!(w.xx&1));this.Se.k4&&F||w.xx&512?(this.YMe=w.xx&2?Object(x.a)(this.b6,this.b6.paste,"paste"):Object(x.a)(this.b6,this.b6.S_i,"pasteInternal"),this.pI=2):(this.Qpc?(this.pI=1,this.yah=Date.now()):this.pI=2,this.YMe=Object(x.a)(this.b6,this.b6.paste,"paste"));u.a.W4m(w);return!0}prepareForPaste(w,F){w=!0;if(this.WCe.value.d2i())this.pI=2;
else{const G=Date.now()-this.yah;G>this.Zue&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",G),this.rd.Yb(y.a.gna,{["Reason"]:n.a.EYi}),F.yR&&(F.yR.fail("Prepare for paste timed out",!1),this.J2?this.Nh.logKpiFailure({kpiName:u.a.eNa,errorName:"PreparePasteTimedOut",optionalVeto:{name:u.a.Nmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",[u.a.Nmb],!1,!0,!0,!1,null)),F.failed=!0,w=!1,this.AYj.q5n())}return w}}
Object(E.a)(z,"ClipboardOperationPasteProcessor",null,[670])},1682:function(E,K,c){c.d(K,"a",function(){return W});E=c(0);K=c(293);var l=c(353),f=c(83),a=c(2),k=c(44),x=c(145),y=c(7),n=c(110),u=c(73),z=c(1442),w=c(55),F=c(86),G=c(3),H=c(84),L=c(60),I=c(1084),N=c(17),P=c(46),M=c(1612),J=c(1683),V=c(339),X=c(119);class W extends K.a{constructor(U,Y,ca,aa,fa,pa,ra,la,qa,La,Pa,Ka,Na,sa,wa,ja,ha,va,xa,ma,Ja,oa,za,Fa,kb,fb,lb,sb=!0){super();this.Uja=this.Mw=null;this.FL=this.Xz=0;this.Lcb=this.XQe=this.Z$=
this.mh=null;this.E6=!1;this.US=!0;this.sXg=!1;this.init(U);this.Jl("ClipboardOperation");this.Qib(qa,Y,fa,pa,ra);this.rd=La;this.Ie=Pa;this.Se=Ka;this.Gc=Na;this.zOg=sa;this.BOg=wa;this.AOg=ja;this.lve=ha;this.$Sb=va;this.mve=xa;this.Qpc=la;this.Dpc=ma;this.jMa=Ja;this.tnk=sb;this.yD=oa;this.Sd=za;this.Jm=Fa;this.CZ=kb;this._context=aa;this.Vea=fb;this.fZb=lb;this.Nh=l.a.getInstance(V.a.FZa);ra&&Object(n.a)(112,ra)&&(this.Z$=Object(u.a)(682,ra.ia(x.a.fua,null)));this.Z$||(this.Z$=this.Vea.$8c());
this.brb=void 0===ca||null===ca?"NotAvailable":Object(z.a)(J.a,ca);this.Z$.RCk(this.brb.split(", "));U=this._context;if(this.fZb){if(!W.mAh(U,this.lve,this.rd,this.Z$,sb)){this.mr=8;this.finish();return}this.mh=U.view;this.E6=3===this.mh.rIb;this.Xz=0;this.FL=ca;this.Lcb=ha.PRa}else{if(!U.view.qe){this.rd.Yb(H.a.kf,{["Reason"]:L.a.SJb});this.Z$.fail("Not in interactive view",!0);this.mr=8;this.finish();return}this.mh=U.view;if(!this.mh.lb){this.rd.Yb(H.a.kf,{["Reason"]:L.a.noSelection});this.Z$.fail("No selection manager",
!0);this.mr=8;this.finish();return}this.E6=3===this.mh.rIb;this.Xz=0;this.FL=ca;this.Lcb=ha.PRa;if(sb&&!(this.Lcb&&this.Lcb.kb&&this.Lcb.length)){this.rd.Yb(H.a.kf,{["Reason"]:L.a.noSelection});this.Z$.fail("No selection when one required",!0);this.mr=8;this.finish();return}}ha=N.SelectionEditor.km(this.Lcb.kb);ha=!(this.FL&16&&ha);ha=xa.rGm(ca,this.tg)&&ha;1!==this.behavior&&ha||(ha||this.Z$.fail("Clipboard operation disabled for selection",!0),this.mr=ha?32:8,this.mqa());!this.sXg&&this.Se.ui&&
(k.b("IPadCCP"),this.sXg=!0)}get tg(){this.XQe||(this.XQe=P.a.N1b(this.Lcb));return this.XQe}Rca(){super.Rca();this.Lcb=null}run(){this.Xz||this.setup();1===this.Xz&&this.process();2===this.Xz&&this.teardownSync();3===this.Xz&&this.teardownAsync();4===this.Xz&&this.finish()}setup(){if(this.FL&256&&this.Qpc){this.uC||this.$Sb.aWk(this,this.FL,this.brb);this.uC.run();if(this.uC.inProgress)return;this.US=this.uC.spa;this.vDd();if(!this.US){this.Z$.fail("No access to system clipboard",!0);this.mr=8;this.Xz=
4;this.r2d();return}}else y.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.FL,this.brb,this.Se.bG,this.actionId);this.FL&32&&!this.Ie.bYd(this.mh.lb.tg)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.rd.Yb(H.a.kf,{["Reason"]:L.a.rcf}),this.Z$.fail("Cut not allowed",!0),this.Dpc.show(),this.mr=8,this.Xz=4):(this.FL&16||this.FL&32)&&F.a.instance.J(1)&&this.yD.c_d(this.mh.lb.gb.kb)?(this.Z$.fail("Selected content deleted in coauthoring",!0),this.Sd.VOb(),
this.mr=8,this.Xz=4):(this.FL&4096&&(this.CZ.Ggc(Object.assign(new I.a,{XTc:!0,zY:this.brb})),this.Jm.undo()),this.mve.fFn(this.FL),this.mh.Yc?(this.Mw=this.Gc.Oc(15),this.Mw.fk=this.actionId,this.Mw.Cb(this.mh.Yc),this.Xz=1):(this.Z$.fail("Interactive view has null target node",!0),this.mr=8,this.Xz=4))}process(){if(!this.uC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.FL,this.brb,this.Se.bG);y.ULS.shipAssertTag(6305507,307,!this.Uja);this.Uja=new M.a(this._context,
this.FL,this.Z$,this.G9,this.EL,void 0,this.Se.bG,this.tnk,this.E6);let U;U=this.FL&65536?Object(w.a)(this.zOg,this.zOg.process,"process"):this.FL&64?Object(w.a)(this.BOg,this.BOg.process,"process"):this.FL&1?Object(w.a)(this.lve,this.lve.process,"process"):Object(w.a)(this.AOg,this.AOg.process,"process");this.FL&16&&this.mh.lb.Vya.e1h();this.jMa.create(this,U,this.Uja).Jl("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.uC);this.uC.run();this.uC.inProgress||(this.vDd(),this.Xz=this.Jh?2:
3)}teardownSync(){this.Uja.Xac&&(this.Mw.fk=G.a.typing);this.Uja.rUc&&this.Mw.TFa(this.Uja.jzf,this.Uja.zRf);this.Mw.dispose();this.mr=this.Uja.failed?8:32;this.Xz=4}teardownAsync(){if(this.uC){if(this.uC.run(),this.uC.inProgress)return}else if(this.Uja.Xac&&(this.Mw.fk=G.a.typing),this.Mw.rHa(this),this.Uja.rUc&&this.Mw.TFa(this.Uja.jzf,this.Uja.zRf),this.Mw.dispose(),this.YXe)return;this.mr=this.Uja.failed?8:32;this.Xz=4}finish(){this.CZ.Ggc(Object.assign(new I.a,{XTc:!1}));this.mqa();32===this.response?
y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.FL,this.brb,this.Se.bG):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.FL,this.brb,this.Se.bG);this.Vea.gga(this.Z$);(W.KPn||W.Vcg)&&this.o1m()}r2d(){const U=!!(this.FL&1),Y=this._context.view;Y&&V.a.r2d(U,Y.lb,this.Se.bG)}o1m(){if(!(this.FL&4||this.FL&64)){var U=new Map;U.set("isCopy",
String.format("{0}",!!(this.FL&16)));U.set("isIPad",String.format("{0}",this.Se.ui));W.Vcg?(U.set("SkipAria","false"),U.set("ErrorLevel","info"),this.Nh.logKpiUsage({kpiName:V.a.LCd,kpiType:0,optionalProperties:{extendedProperties:U},blockFutureEmissionDurationInMs:0})):f.Health.instance.recordKpiUsage(V.a.LCd,0,V.a.MCd,U);this.US||(W.Vcg?(U.set("SkipAria","false"),U.set("ErrorLevel","info"),this.Nh.logKpiFailure({kpiName:V.a.LCd,errorName:V.a.tBh,optionalProperties:{isIntentional:!0,isInternal:!0,
additionalValues:{extendedProperties:U}},blockFutureEmissionDurationInMs:0})):(U=Object.assign(new X.a,{extendedProperties:U}),f.Health.instance.recordKpiFailure(V.a.LCd,V.a.tBh,!0,!0,U)))}}static get KPn(){null==W.OOe&&(W.OOe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return W.OOe}static get Vcg(){null==W.J2&&(W.J2=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return W.J2}static X2f(U,Y,ca,aa){U&&U.Yb(H.a.kf,
{["Reason"]:ca});Y&&Y.fail(aa,!0)}static mAh(U,Y,ca=null,aa=null,fa=!0){return U.view.qe?U.view.lb?!fa||Y.PRa&&Y.PRa.kb&&Y.PRa.length?!0:(W.X2f(ca,aa,L.a.noSelection,"Paste target is invalid"),!1):(W.X2f(ca,aa,L.a.noSelection,"No selection manager"),!1):(W.X2f(ca,aa,L.a.SJb,"Not in interactive view"),!1)}}W.OOe=null;W.J2=null;Object(E.a)(W,"ClipboardOperation",K.a,[])},1683:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.paste=1]="paste";f[f.textOnly=2]="textOnly";f[f.overtype=
4]="overtype";f[f.copy=16]="copy";f[f.deleteSelection=32]="deleteSelection";f[f.move=64]="move";f[f.useSystemClipboard=256]="useSystemClipboard";f[f.forceInternalClipboard=512]="forceInternalClipboard";f[f.reformatPastedContent=4096]="reformatPastedContent";f[f.pasteAsPlainText=8192]="pasteAsPlainText";f[f.showPlaceholderGlossary=65536]="showPlaceholderGlossary";f[f.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste";f[f.noSpacesAdjustment=262144]="noSpacesAdjustment"})(l||
(l={}));Object(E.b)("ClipboardActionFlags",l)},1686:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,
"__esModule",{value:!0});f(c(1844),K);f(c(1845),K);E.exports.IntentIds||Object.defineProperty(E.exports,"IntentIds",{enumerable:!0,get:function(){return E.exports.IntentIds}});E.exports.ObjectSchemaType||Object.defineProperty(E.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return E.exports.ObjectSchemaType}});E.exports.ObjectSemantic||Object.defineProperty(E.exports,"ObjectSemantic",{enumerable:!0,get:function(){return E.exports.ObjectSemantic}});E.exports.SearchSuggestionAnnotation||Object.defineProperty(E.exports,
"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return E.exports.SearchSuggestionAnnotation}});E.exports.SearchSuggestionSignal||Object.defineProperty(E.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return E.exports.SearchSuggestionSignal}});E.exports.SequenceType||Object.defineProperty(E.exports,"SequenceType",{enumerable:!0,get:function(){return E.exports.SequenceType}})},1687:function(E,K,c){c.r(K);c.d(K,"FootnoteEndnoteDefaultContentInserter",function(){return H});
E=c(0);var l=c(22),f=c(58),a=c(2),k=c(36),x=c(538),y=c(28),n=c(6),u=c(15),z=c(55),w=c(1186),F=c(878),G=c(1614);class H{constructor(L,I,N,P,M=null){this.Wc=L;this.sYj=I;this.em=N;H.nh=P;this.eQg=M||H.eal}get lL(){return null!=this.eEg?this.eEg:this.eEg=l.a.instance.resolve("Box4.IOutlineEditor")}n9k(L,I){var N=this.Wc.yk();N.set(L);this.lL.Wib(N,null,!0);H.nh.kOb(N.currentNode,this.em);L=k.OutlineElementNavigator.Ge(N);H.w5.ahe(I?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,
L);N=this.eQg(N.currentNode);H.characterPropertiesEditor.replaceTextRange(N,H.lPh);this.lBm(L,I)}lBm(L,I){var N=this.sYj(131073);N.setValue(n.a.gt,1===I?36:35);N.setValue(n.a.gma,!0);N.setValue(u.a.e$,!0);const P=L.Jc.Lu(N,f.a.create());N=this.eQg(L);H.characterPropertiesEditor.Zga(N,M=>F.a.getInstance(M,P,!0),G.a.X4h(L,I))}static Rl(){return new H(new x.a,Object(z.a)(w.a.instance,w.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get w5(){return null!=
H.zGg?H.zGg:H.zGg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=H.vwg?H.vwg:H.vwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=H.wCg?H.wCg:H.wCg=H.Rl()}static eal(L){return y.a.Rc(L,0)}}H.lPh=" ";H.nh=null;Object(E.a)(H,"FootnoteEndnoteDefaultContentInserter",null,[549])},1688:function(E,K,c){c.d(K,"a",function(){return x});E=c(0);var l=c(538),f=c(528),a=c(1541),k=c(1614);class x{constructor(y,
n){this.csa=n}YSd(y,n,u){return(y=this.csa.sbi(y.node,u?y.cpBegin:y.cpEnd,n))?y.T3():null}Zji(y,n){return(y=this.csa.s8l(y.node,y.cpBegin,n))?y.T3():null}static bOc(){return new x(f.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.TBg?x.TBg:x.TBg=x.bOc()}}Object(E.a)(x,"FootnoteEndnoteNavigator",null,[509])},1700:function(E,K,c){c.d(K,"a",function(){return x});E=c(0);var l=c(1758),f=c(2),a=c(50),k=c(22);class x{constructor(y,n,u,z,w,F){this.Dsa=y;this.Esa=n;this.ZCe=
u;this.aZ=z;this.ghd=w;this.rSb=F}get rrj(){return!this.Esa&&!this.ZCe}get DRi(){return 2===this.rSb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get KWh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get ioi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get rib(){return CommonUIStrings.l_OICErrorHelpLink}get Ymi(){return"OICFailure"}get icon(){return 3}get hyd(){return 2===this.rSb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:
CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}zOn(y){this.ORi(y)}xYm(y){this.ORi(y)}ORi(y){let n=10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").xIf(this.rSb),n=3):2===y&&((!this.ZCe||this.ZCe(this.aZ))&&this.Esa&&l.a.instance.ubl(this.Esa,this.Dsa,this.aZ),n=5);(0===y||1===y)&&this.Dsa&&this.Dsa(this.aZ);f.AFrameworkApplication.J4c(a.a.sYi,this.ghd,n);this.dispose()}dispose(){this.aZ=this.Esa=this.Dsa=null}}Object(E.a)(x,
"AOICErrorDialogWithTrial",null,[10])},1756:function(E,K,c){E=c(0);var l=c(2),f=c(20),a=c(22),k=c(742),x=c(1546),y=c(34);class n{constructor(ma,Ja=null){this.hbk=ma;this.U2=Ja||x.a.dqf(f.a.Rzb,"")}get yy(){return this.hbk}get Kc(){return this.U2}Fag(ma){this.Kc.d++;return this.yy.Fag(ma)}bjc(ma){this.Kc.e++;return this.yy.bjc(ma)}qL(ma){this.Kc.f++;return this.yy.qL(ma)}lob(ma){this.Kc.h++;return this.yy.lob(ma)}j5(ma){this.Kc.i++;return this.yy.j5(ma)}Wia(ma){this.Kc.j++;return this.yy.Wia(ma)}zHa(ma){this.Kc.k++;
return this.yy.zHa(ma)}oqa(ma){this.Kc.l++;return this.yy.oqa(ma)}hge(ma){this.Kc.m++;return this.yy.hge(ma)}VSa(ma,Ja=!1){this.Kc.n++;return this.yy.VSa(ma,Ja)}dwf(){this.Kc.o++;return this.yy.dwf()}Geg(){this.Kc.p++;return this.yy.Geg()}Sv(ma){this.Kc.q++;return this.yy.Sv(ma)}Bya(ma){this.Kc.r++;return this.yy.Bya(ma)}Ric(ma){this.Kc.g++;return this.yy.Ric(ma)}o7c(ma){return this.yy.o7c(ma)}pob(ma){this.Kc.s++;return this.yy.pob(ma)}Sge(ma){this.Kc.s++;return this.yy.Sge(ma)}jbf(ma){this.Kc.ba++;
return this.yy.jbf(ma)}Ofe(ma){this.Kc.s++;return this.yy.Ofe(ma)}nob(ma){this.Kc.s++;return this.yy.nob(ma)}pOb(ma){this.Kc.t++;return this.yy.pOb(ma)}ghe(ma){this.Kc.u++;return this.yy.ghe(ma)}Tia(ma){this.Kc.v++;return this.yy.Tia(ma)}wbg(ma){this.Kc.bb++;return this.yy.wbg(ma)}Q9(ma){return this.yy.Q9(ma)}L9(ma){this.Kc.z++;return this.yy.L9(ma)}f7f(){return this.yy.f7f()}gda(ma,Ja){this.Kc.w++;this.Kc.x++;return this.yy.gda(ma,Ja)}fD(ma){this.Kc.y++;return this.yy.fD(ma)}clearFormatting(){return this.yy.clearFormatting()}clone(){return new n(this.yy.clone(),
this.Kc)}}Object(E.a)(n,"FormattingStewardUsageCollector",null,[718]);class u extends n{constructor(ma,Ja=null){super(ma,Ja)}get e9(){return this.yy}get rw(){return this.e9.rw}set rw(ma){this.e9.rw=ma}get textIndent(){return this.e9.textIndent}get marginLeft(){return this.e9.marginLeft}get Bkc(){return this.e9.Bkc}get BR(){return this.e9.BR}get lineSpacing(){return this.e9.lineSpacing}get q5(){return this.e9.q5}get leftIndent(){return this.e9.leftIndent}get Kca(){return this.e9.Kca}get paragraph(){return this.e9.paragraph}set paragraph(ma){this.e9.paragraph=
ma}get MQ(){return this.e9.MQ}get Lkc(){return this.e9.Lkc}kme(ma){return this.e9.kme(ma)}tkg(ma){return this.e9.tkg(ma)}clone(){const ma=this.yy.clone();return new u(ma,this.Kc)}}Object(E.a)(u,"FormattingStewardUsageCollector",n,[717,718]);var z=c(8),w=c(374),F=c(860),G=c(36),H=c(205),L=c(81),I=c(40),N=c(58),P=c(354),M=c(136),J=c(19),V=c(83),X=c(53),W=c(15),U=c(6),Y=c(42),ca=c(119),aa=c(585),fa=c(355),pa=c(139),ra=c(56),la=c(99),qa=c(183),La=c(1606),Pa=c(148),Ka=c(28),Na=c(1400),sa=c(877);class wa{constructor(ma,
Ja,oa,za,Fa,kb,fb,lb,sb,ab,Ga=null){var Ua;this.nE=this._paragraph=null;this.Hqd=0;this.SNg=this.Iqd=null;this.W$=0;this.jwb=this.Lkc=this.leftIndent=this.q5=this.owc=this.BR=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=ma;this.Be=Ja;this.Ru=oa;this.Uy=za;this.mK=Fa;this.bVb=kb;this.ska=fb;this.KTb=lb;this.NVa=sb;this.qtb=ab;Ga?(y.a(4223818,307,!!Ga.nE),this.nE=Ga.nE.mma(this.paragraph),this.Hqd=Ga.yfc,this.Iqd=Ga.QXf,Ga.BR&&(this.BR=new Na.a,this.BR.afterSpacing.value=Ga.BR.afterSpacing.value,
this.BR.beforeSpacing.value=Ga.BR.beforeSpacing.value,null===(Ua=l.AFrameworkApplication.K)||void 0===Ua?0:Ua.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.BR.afterSpacing.unit=Ga.BR.afterSpacing.unit,this.BR.beforeSpacing.unit=Ga.BR.beforeSpacing.unit),Ga.lineSpacing&&(this.owc=Ga.lineSpacing.clone()),this.W$=Ga.W$,this.Lkc=Ga.Lkc.clone(),this._textIndent=Ga.textIndent,this._marginLeft=Ga.marginLeft,this._tabStops=Ga.Bkc,this.q5=Ga.q5,this.leftIndent=
Ga.leftIndent,Ga.Kca&&(this.jwb=Ga.Kca)):(this.nE=new qa.a(this.paragraph,0),this.nE.formatting=new Pa.a(this.nE,N.a.nil),Ja=Ka.a.jw(ma),Ja=this.mK.Kr(Ja),this.tgo(Ja),this.Lto(ma)?(this.bVb.Nho(this.nE.formatting,Ja),ma.hasProperty(W.a.Kh)?this.W$=ma.getValue(W.a.Kh):this.W$=0):this.W$=-1,this.Hqd=0,this.BR=this.Iqd=null,this.qtb&&(this.BR=this.bVb.qEa(ma),this.owc=this.bVb.BEb(ma),this.q5=this.bVb.z8b(ma),this.leftIndent=this.bVb.$T(ma)),this.Lkc=new P.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(ma){y.a(4223816,
307,!!ma&&z.ParagraphReader.Vb(ma));this._paragraph=ma}get MQ(){return this.nE.formatting}get yfc(){return this.Hqd}get QXf(){return this.Iqd}get hw(){return this.SNg}get rw(){return this.W$}set rw(ma){y.a(4223817,307,1===ma||2===ma||3===ma||6===ma);this.W$=ma}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get Bkc(){return this._tabStops}get lineSpacing(){return this.owc}get Kca(){return this.jwb}get wc(){return this.Uy}tgo(ma){const Ja=this.mK.language(ma);Ja&&
this.Be.Gag(this.nE.formatting,Ja,0,ma.cache.tHb,!1)}Lto(ma){ma=this.wc.pg(this.wc.No(ma));return ma===ra.StyleReader.acd||ma===ra.StyleReader.wordStyleIdNormal||ma===ra.StyleReader.rRb||ma===ra.StyleReader.styleIdNormal}Fag(ma){(ma=k.a.og(ma))&&this.Be.xge(this.nE.formatting,ma.LCID);return!0}bjc(){return!1}qL(ma){this.Be.qL(this.nE.formatting,ma);return!0}lob(ma){this.Be.setItalic(this.nE.formatting,ma);return!0}j5(ma){this.Be.j5(this.nE.formatting,ma);return!0}Wia(ma){this.Be.Wia(this.nE.formatting,
ma);return!0}zHa(ma){this.Be.zHa(this.nE.formatting,ma);return!0}oqa(ma){this.Be.oqa(this.nE.formatting,ma);return!0}hge(ma){if(0>=ma)return!1;this.Be.RA(this.nE.formatting,ma);return!0}VSa(ma,Ja){if(!ma||""===ma)return!1;if(({B0h:oa}=M.FontUtils.yCj(ma)).returnValue)return this.Be.Sia(this.nE.formatting,oa.fontName),!0;var oa=!1;const za=M.FontUtils.oRa(ma);Ja&&this.hkb(za,this.ska)&&(this.ska.Bma(ma),oa=!0);if(this.hkb(za,this.KTb)||this.hkb(za,this.NVa))oa=!0;oa&&this.Be.Sia(this.nE.formatting,
za);return oa}hkb(ma,Ja){return!!Ja&&Ja.isEnabled&&Ja.hkb(ma)}dwf(){this.Be.wki(this.nE.formatting);return!0}Geg(){this.Be.tsj(this.nE.formatting);return!0}Sv(ma){var {Box4PasteSteward:Ja}=c(1512);if(null===ma||""===ma)return!1;ma=Ja.$Ab(ma);Ja=null;this.Kca&&this.Kca.hasOwnProperty(U.a.listLevel.id.toString())&&(Ja=this.Kca[U.a.listLevel.id.toString()]);this.Be.Sv(this.nE.formatting,ma,Ja);return!0}Bya(ma){const {Box4PasteSteward:Ja}=c(1512);if(!ma||""===ma||!wa.Fjm().contains(ma))return!1;this.Be.Bya(this.nE.formatting,
Ja.$Ab(ma));return!0}Ric(ma){this.Be.Ric(this.nE.formatting,ma);return!0}o7c(ma){let Ja=0;switch(J.a.Ug(ma)){case "small-caps":Ja=1;break;case "uppercase":Ja=2}this.Be.Wl(this.nE.formatting,Y.a.capitalization,Ja);return!0}L9(ma){const {Box4PasteSteward:Ja}=c(1512);if(!ma||""===ma)return!1;this.Lkc.setValue(W.a.yH,parseInt(Ja.$Ab(ma),16));return!0}nob(ma){return 0>=ma?!1:this.Sge(this.wc.Agi(ma))}pob(ma){this.clearFormatting();this.Hqd=ma;return!0}jbf(ma){var {Box4PasteSteward:Ja}=c(1512),oa=new Map;
oa.set("Source","CreateStyleCCP_FormattingSteward");V.Health.instance.recordKpiUsage(pa.a.BKj,0,pa.a.sB,oa);oa=la.a.Zcm(ma);ma=[];ma.push(oa);(ma=la.a.Nyd(ma,this.paragraph))?(Ja.wkc=this.wc.Mr(),y.b(593078085,3017,50,"Custom style created via paste.")):(Ja=new Map,Ja.set("Source","CreateStyleCCP_FormattingSteward"),Ja.set("IsStyleNull",(!oa).toString()),Ja=Object.assign(new ca.a,{extendedProperties:Ja}),V.Health.instance.recordKpiFailure(pa.a.BKj,"UnableToCreateStyle",!1,!0,Ja));return ma}Sge(ma){const {Box4PasteSteward:Ja}=
c(1512);return ma&&0<ma.length&&Ja.wkc&&Ja.wkc.Pi(ma)?(this.Iqd=ma,!0):!1}Ofe(ma){const {Box4PasteSteward:Ja}=c(1512);return ma&&0<ma.length&&Ja.wkc&&Ja.wkc.Pi(ma)?(this.SNg=ma,!0):!1}tkg(ma){if(this.hw){ma=this.wc.MC(ma);if(!ma)return y.a(41968715,307,!1),!1;(ma=ma.Pi(this.hw))&&this.Be.D6a(this.nE.formatting,ma);return!0}return!1}gda(ma,Ja){this.BR=new Na.a;this.BR.beforeSpacing=this.wko(ma);this.BR.afterSpacing=this.vko(Ja);return!0}wko(ma){return new sa.a(4,ma)}vko(ma){return new sa.a(4,ma)}fD(ma){if(!ma)return!1;
const Ja=parseFloat(J.a.substring(ma,0,J.a.Ug(ma).indexOf("px")));if(!isNaN(Ja))return this.owc=new sa.a(3,X.a.Cy(Ja,1)),!0;ma=parseFloat(J.a.substring(ma,0,J.a.Ug(ma).indexOf("%")));return isNaN(ma)?!1:(this.owc=new sa.a(2,ma/100),!0)}pOb(ma){let Ja=0;if(!ma||""===ma)return!1;switch(ma){case "left":Ja=1;break;case "center":Ja=2;break;case "right":Ja=3;break;case "justify":Ja=6}if(!Ja)return!1;this.rw=Ja;return!0}ghe(ma){this._textIndent=ma;return!0}Tia(ma){this._marginLeft=ma;return!0}wbg(ma){this._tabStops=
ma;return!0}Q9(ma){this.jwb=JSON.parse(ma);return this.Kca?!0:!1}clearFormatting(){this.nE.formatting=new Pa.a(this.nE,N.a.nil);return!0}f7f(){this.W$=0;return!0}kme(ma){var {Box4PasteSteward:Ja}=c(1512);if(0<this.yfc&&Ja.T4a[this.yfc]){y.a(4223819,307,1<=this.yfc);y.a(4223820,307,7>=this.yfc);Ja=this.wc.MC(ma);if(!Ja)return y.a(4223821,307,!1),!1;Ja=Ja.Pi(c(1512).Box4PasteSteward.T4a[this.yfc]);this.Ru.PJ(Ja,ma,!1);return!0}if(this.QXf){Ja=this.wc.MC(ma);if(!Ja)return y.a(41968716,307,!1),!1;Ja=
Ja.Pi(this.QXf);this.Ru.PJ(Ja,ma,!1);return!0}return!1}clone(){return new wa(this.paragraph,this.Be,this.Ru,this.Uy,this.mK,this.bVb,this.ska,this.KTb,this.NVa,this.qtb,this)}static Fjm(){wa.QZ||(wa.QZ=new aa.a(fa.a.ai()),wa.QZ.add(La.a.yellow),wa.QZ.add(La.a.HYm),wa.QZ.add(La.a.NFk),wa.QZ.add(La.a.bIl),wa.QZ.add(La.a.blue),wa.QZ.add(La.a.red),wa.QZ.add(La.a.jfn),wa.QZ.add(La.a.teal),wa.QZ.add(La.a.green),wa.QZ.add(La.a.purple),wa.QZ.add(La.a.u$m),wa.QZ.add(La.a.bjn),wa.QZ.add(La.a.gray),wa.QZ.add(La.a.myo),
wa.QZ.add(La.a.black));return wa.QZ}}wa.QZ=null;Object(E.a)(wa,"FormattingSteward",null,[717,718]);class ja{Ckg(){return!1}zwf(ma){return ma}Gwf(){}Q9(){}Ege(){}wYd(){return!1}get EZd(){return!1}fD(){}gda(){}Zge(){}get tqj(){return!1}}Object(E.a)(ja,"NoOpPasteStewardBridge",null,[696]);var ha=c(74);class va{constructor(ma,Ja){this.$gn=ma;this.ahn=Ja||"Normal"}}Object(E.a)(va,"NoteTagInfoBox4",null,[]);c.d(K,"a",function(){return xa});class xa{constructor(ma,Ja,oa=null,za=null){this.IFl=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");
this.S$g=0;this.Ec=ma;this.G6=Ja;this.$Y=za||new ja;this.Kc=oa||x.a.dqf(f.a.Rzb,"")}get characterPropertiesEditor(){return null!=this.nwg?this.nwg:this.nwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.uzg?this.uzg:this.uzg=a.a.instance.Na("Box4.IFontService")}get rDa(){return null!=this.sxg?this.sxg:this.sxg=a.a.instance.Na("Box4.CustomFontService")}get Rsl(){return null!=this.Txg?this.Txg:this.Txg=a.a.instance.Na("Box4.IEmbeddedFontService")}reset(){}get XIc(){return this.bpf(!1)}bpf(ma){y.a(4223770,
307,I.OutlineElementReader.Dh(this.Ec));const Ja=G.OutlineElementNavigator.Ge(this.Ec);G.OutlineElementNavigator.Vd(this.Ec);y.a(4223771,307,!!Ja&&z.ParagraphReader.Vb(Ja));ma=new wa(Ja,xa.Sn,xa.ZG,xa.wc,xa.k8,xa.pHl,this.fontService,this.rDa,this.Rsl,this.IFl,void 0,ma);return new u(ma,this.Kc)}Eca(){}Dca(){}omb(){}txa(){}kGa(){}tRa(){}sRa(){}aE(){}oF(){}jmb(){}imb(){}yRa(){}G4a(){}xxa(){}vxa(){}pGa(){}wxa(){}I4a(){}Mdc(ma){I.OutlineElementReader.Dh(this.Ec)?(xa.lg.joa(this.Ec,!0),G.OutlineElementNavigator.Ur(this.Ec,
!1,!1)):L.OutlineReader.fx(this.Ec)?H.OutlineNavigator.c9(this.Ec)?ma?(this.Ec.Cg(),xa.lL.o7(this.Ec,!1)):xa.lg.LMb(this.Ec):xa.lL.o7(this.Ec,!1):y.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ec.Ve)}FOc(ma){let Ja=null;if(ma&&ma.o9&&ma.cultureName)try{Ja=Object.assign(new F.a,{languageId:k.a.og(ma.cultureName).LCID})}catch(oa){y.a(8128526,307,!1,"Setting up culture {0} encountered {1}",ma.cultureName,oa)}Ja||null==this.G6||(Ja=Object.assign(new F.a,{languageId:this.G6}));return Ja}get QU(){return this.S$g}set QU(ma){this.S$g=
ma}CAd(){}N$c(){}f7e(){}get q3b(){return!1}get KBb(){return!1}kZm(ma){var Ja=1;if(ma.byi){var oa=0;switch(ma.listStyleType){case 1:Ja=0;break;case 7:Ja=1;break;case 8:Ja=2;break;case 9:Ja=3;break;case 10:Ja=4;break;case 11:Ja=5}}else switch(oa=1,ma.listStyleType){case 1:Ja=0;break;case 3:Ja=1;break;case 4:Ja=2;break;case 5:Ja=3}var za=w.a,Fa=za.n_,kb=ma.Gxa;const fb=new ha.a;for(const lb of kb)kb=new va(lb.$gn,lb.ahn),fb.add(kb);za=Fa.call(za,oa,Ja,fb,ma.listId,ma.listLevel,ma.levelText,ma.font);
3!==ma.Sr&&(za.H5=ma.Sr);ma.byi&&!ma.Uti&&(za.RB=0<ma.listId&&0<=ma.listLevel&&!ma.Bfc?ma.ekc:ma.Gfl);!za.qz||3!==za.listStyle&&5!==za.listStyle||(za.rw="right");(ma=ma.mJf)&&za.propertySet.Vw(ma);za.E6b=!0;this.$Y.Ege(this.Ec);return za}k9(){}i9(){}K4(){}j9(){}h9(){}g9(){}static get lg(){return null!=xa.vEg?xa.vEg:xa.vEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get lL(){return null!=xa.kEg?xa.kEg:xa.kEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Sn(){return null!=xa.Vzg?
xa.Vzg:xa.Vzg=a.a.instance.resolve("Box4.IFormattingEditor")}static get ZG(){return null!=xa.fJg?xa.fJg:xa.fJg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get wc(){return null!=xa.JJg?xa.JJg:xa.JJg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get k8(){return null!=xa.Zzg?xa.Zzg:xa.Zzg=a.a.instance.resolve("Box4.IFormattingReader")}static get pHl(){return null!=xa.$zg?xa.$zg:xa.$zg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}xa.If=null;Object(E.a)(xa,
"Box4PasteStewardBase",null,[699,298,299])},1758:function(E,K,c){E=c(0);var l=c(55),f=c(7),a=c(2),k=c(50),x=c(460),y=c(22);class n{constructor(P,M,J,V){this.kJe=null;this.ghd=V;this.Dsa=P;this.Esa=M;this.aZ=J;this.yfh=this.mJb.zro;P=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.V$j=P[0];this.U$j=P[1]}get mJb(){return this.kJe||(this.kJe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get rib(){return CommonUIStrings.l_OICErrorHelpLink}get R7c(){return this.yfh}get JLi(){return this.V$j}get ILi(){return this.U$j}get HLi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.yfh?
3:2}get $Kc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get jFd(){return!!this.Esa}get aLc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}D2f(P){this.a_c(P)}aJf(P){this.a_c(P)}a_c(P){let M=10;this.Esa&&1===P&&(this.Esa(this.aZ),M=1);this.Dsa&&this.Dsa(this.aZ);this.YM(M)}XJb(){x.Redirect.showHelp("OICFailure");this.YM(2)}PRf(){this.mJb.LEi();this.YM(4)}YM(P){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.ghd,P);a.AFrameworkApplication.J4c(k.a.qYi,this.ghd,P)}dispose(){this.aZ=this.Dsa=this.Esa=null}}Object(E.a)(n,"AOICErrorDialog",null,[10]);var u=c(38),z=c(175);class w extends n{constructor(P,M,J,V){super(P,M,J,V);this.cbb=this.HF=null;P=document.createElement("span");P.id="errorMessageText";P.innerText=this.errorMessage;P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));this.HF=document.createElement("a");this.HF.href="#";this.HF.innerText=this.rib;P.appendChild(this.HF);
u.a.addHandler(this.HF,"click",Object(l.a)(this,this.XJb,"oicErrorHelpLinkHandler"));M=new z.StandardDialog;M.wg=this.id;this.R7c?(J=document.createElement("span"),V=document.createElement("span"),J.innerText=this.JLi,V.innerText=this.ILi,this.cbb=document.createElement("a"),this.cbb.href="#",this.cbb.innerText=this.HLi,P.appendChild(document.createElement("br")),P.appendChild(J),P.appendChild(this.cbb),P.appendChild(V),u.a.addHandler(this.cbb,"click",Object(l.a)(this,this.PRf,"oicErrorMacOfferLinkHandler"))):
this.jFd&&(P.appendChild(document.createElement("br")),P.appendChild(document.createElement("br")),J=document.createElement("span"),J.innerText=this.$Kc,P.appendChild(J));this.jFd?(M.Ad=1,M.Ee(1,this.aLc)):M.Ad=0;M.Ju(this.dialogTitle,null,this.icon,Object(l.a)(this,this.aJf,"legacyOICErrorDialogHandler"),P);M.e5("errorMessageText")}dispose(){this.HF&&(u.a.removeHandler(this.HF,"click",Object(l.a)(this,this.XJb,"oicErrorHelpLinkHandler")),this.HF=null);this.cbb&&(u.a.removeHandler(this.cbb,"click",
Object(l.a)(this,this.PRf,"oicErrorMacOfferLinkHandler")),this.cbb=null);super.dispose()}}Object(E.a)(w,"OICErrorDialog",n,[]);class F{constructor(P,M,J){this.Dsa=M;this.Esa=P;this.aZ=J}get id(){return"OICErrorDialogWithDownload"}get LWh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get rib(){return CommonUIStrings.l_OICErrorHelpLink}get $Kc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get aLc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}D2f(P){this.a_c(P)}aJf(P){this.a_c(P)}a_c(P){let M=
10;1===P&&(this.Esa(this.aZ),M=1);this.Dsa&&this.Dsa(this.aZ);this.YM(M)}XJb(){x.Redirect.showHelp("OICFailure");this.YM(2)}YM(P){a.AFrameworkApplication.J4c(k.a.rYi,3,P)}dispose(){this.aZ=this.Esa=this.Dsa=null}}Object(E.a)(F,"AOICErrorDialogWithDownload",null,[10]);class G extends F{constructor(P,M,J){super(P,M,J);this.HF=null;P=document.createElement("span");P.id="errorMessageText";P.innerText=this.LWh;P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));this.HF=
document.createElement("a");this.HF.href="#";this.HF.innerText=this.rib;P.appendChild(this.HF);u.a.addHandler(this.HF,"click",Object(l.a)(this,this.XJb,"oicErrorHelpLinkHandler"));P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));M=document.createElement("span");M.innerText=this.$Kc;P.appendChild(M);M=new z.StandardDialog;M.wg=this.id;M.Ad=1;M.Ee(1,this.aLc);M.Ju(this.dialogTitle,null,this.icon,Object(l.a)(this,this.aJf,"legacyOICErrorDialogHandler"),P);M.e5("errorMessageText")}dispose(){this.HF&&
(u.a.removeHandler(this.HF,"click",Object(l.a)(this,this.XJb,"oicErrorHelpLinkHandler")),this.HF=null);super.dispose()}}Object(E.a)(G,"OICErrorDialogWithDownload",F,[]);var H=c(174);class L extends n{constructor(P,M,J,V){super(P,M,J,V);M={["errorMessage"]:this.errorMessage};M.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.rib,["onExecute"]:X=>{this.XJb(X)}};this.R7c?(M.macOfficePreLinkText=this.JLi,M.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.HLi,
["onExecute"]:X=>{this.PRf(X)}},M.macOfficePostText=this.ILi):this.jFd&&(M.errorFileDownloadOffer=this.$Kc);P=new H.a(!1,!1,!0);this.jFd?(P.Ad=1,P.Ee(1,this.aLc)):P.Ad=0;P.wg=this.id;M={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:M};P.Yh(this.dialogTitle,Object(l.a)(this,this.D2f,"reactOICErrorDialogHandler"),M)}}Object(E.a)(L,"ReactOICErrorDialog",n,[]);class I extends F{constructor(P,M,J){super(P,M,J);M={["errorMessage"]:this.LWh,["errorFileDownloadOffer"]:this.$Kc};M.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.rib,["onExecute"]:V=>{this.XJb(V)}};P=new H.a(!1,!1,!0);P.Ad=1;P.Ee(1,this.aLc);P.wg=this.id;M={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:M};P.Yh(this.dialogTitle,Object(l.a)(this,this.D2f,"reactOICErrorDialogHandler"),M)}}Object(E.a)(I,"ReactOICErrorDialogWithDownload",F,[]);c.d(K,"a",function(){return N});class N{constructor(){this.UKa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.lF}tbl(P,M,J){this.UKa?new L(P,M,null,J):new w(P,M,null,
J)}ubl(P,M,J){this.UKa?new I(P,M,J):new G(P,M,J)}vbl(P,M,J,V,X){const {ReactOICErrorDialogWithTrial:W}=c(1859),{OICErrorDialogWithTrial:U}=c(1860);this.UKa?new W(P,M,J,null,V,X):new U(P,M,J,null,V,X)}static get instance(){return N._instance||(N._instance=new N)}}N._instance=null;Object(E.a)(N,"OICErrorDialogFactory",null,[1351])},1759:function(E,K,c){c.r(K);E=c(0);var l=c(307),f=c(1838),a=c(945),k=c(354),x=c(2),y=c(58),n=c(353),u=c(22),z=c(126),w=c(96),F=c(79),G=c(1444),H=c(177),L=c(39),I=c(20),N=
c(266),P=c(145),M=c(7),J=c(243),V=c(110),X=c(73),W=c(304),U=c(12),Y=c(28),ca=c(3),aa=c(9),fa=c(131),pa=c(525),ra=c(46),la=c(1682),qa=c(1681),La=c(339),Pa=c(293);class Ka extends Pa.a{constructor(oa,za,Fa,kb,fb,lb){super();this.init(oa);this.Jl("DummyClipboardOperation");this.Qib(x.AFrameworkApplication.va,za,kb,fb,lb);this._context=Fa;this.mr=8;this.mqa()}run(){this.wab=!0;this.G6c(this._context);this.g5a();this.mr=32}}Object(E.a)(Ka,"DummyClipboardOperation",Pa.a,[]);Pa=c(1572);class Na extends Pa.a{constructor(oa,
za,Fa,kb,fb){super(oa,za,fb);this.hk=Fa;this.DRe=kb}Zlc(oa){let za;if(this.$S&&!oa)return M.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Wua:null};za=null;if(this.DRe&&!this.$S){const Fa=this.properties.ia(P.a.Y_i,"");Fa&&(za=this.hk.Lmb(Fa))}za||(za=this.hk.Lmb(oa));return{returnValue:!0,Wua:za}}}Object(E.a)(Na,"HtmlStringImportStrategy",Pa.a,[]);var sa=c(1839);class wa extends sa.a{constructor(oa,za,Fa,kb,fb){super(oa,za,Fa,kb,fb)}gdi(){return this.properties.ia(P.a.fLb,
"")}Zlc(oa){x.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.Lfh){if(this.hk)return oa=this.hk.dYf(oa,!0),{returnValue:!0,Wua:oa};M.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Zlc(oa)}wXc(oa){oa=super.wXc(oa);return oa.length&&" "!==oa?oa:"\u00a0"}}Object(E.a)(wa,"MultiLinePlainTextImportStrategy",sa.a,[]);class ja extends Pa.a{constructor(oa,za,Fa){super(oa,za,Fa)}Zlc(oa){({ClipboardActor:za}=
c(1759));if(this.$S&&!oa)return M.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Wua:null};var za=za.yAn;za.innerText=oa;return{returnValue:!0,Wua:za}}}Object(E.a)(ja,"PlainTextImportStrategy",Pa.a,[]);var ha=c(84),va=c(60);class xa{constructor(oa){this.p4=this.cFf=!1;this.Tea=oa}d2i(){this.cFf||(this.cFf=!0,this.p4=!1,this.Tea.prepareForPaste(()=>{this.p4=!0}));return this.p4}GBj(){this.cFf=!1;const oa=this.Tea.paste();return oa?oa.hasChildNodes()?{returnValue:!0,uFd:oa}:
(M.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),xa.Ic.Yb(ha.a.n1,{["Reason"]:va.a.Oif}),{returnValue:!1,uFd:oa}):(M.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),xa.Ic.Yb(ha.a.RCb,{["Reason"]:va.a.mhg}),{returnValue:!1,uFd:oa})}static get Ic(){return H.a.instance}}Object(E.a)(xa,"SystemClipboardImportStrategy",null,[678]);var ma=c(246);c.d(K,"ClipboardActor",function(){return Ja});class Ja{get hEi(){return this.$Ka}set hEi(oa){this.$Ka=oa}constructor(oa,za,Fa,kb,fb,lb,
sb,ab,Ga,Ua,wb,cc,zb,nb,eb,Ib,Xa,Ra){this.Med=null;this.$Ka=0;this.Ljd=this.BCc=!1;this.Drb=l.a.On;this.n8c=()=>{const gb=Array(1);gb.push("PasteRecoveryFloatie");var Bb=this.jek.UOa();Bb=Object.assign(new f.a,{x:Bb.x,y:Bb.y});this.HL.showFloatie(Bb,gb,1);return 32};this.UFb=()=>{this.HL.X_&&this.HL.Xw();return 32};this.Q4i=(gb,Bb,$b,Qb,Ac)=>{if(1===$b)return 32;Ac[a.a.On]=!1;return 32};this.jrl=(gb,Bb,$b,Qb,Ac,Db)=>{M.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var dc=Db.DataTransfer;
Db=dc.getData("text/html");dc=dc.getData("text/plain");let Pb=!1;const Ub=new k.DictionaryPropertySet;0<Db.length?(M.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ub.setValue(P.a.jP,Db),Pb=!0):0<dc.length&&(M.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ub.setValue(P.a.fLb,dc),Pb=!0);if(Pb){const rb=this.Qz.J(Bb);return this.PDd.create(gb,Bb,rb,new J.a(()=>this.nJc(rb,Ub)),$b,Qb,Ac,Ub)}return null};this.P1f=(gb,Bb,$b,Qb,Ac)=>{if(Bb=
"object"===typeof Ac?Ac:null)this.gZb?this.vfo(gb,this.$Ka,Bb):gb===ca.a.fbe?(gb=this.$Ka!==ca.a.reformatPastedContent&&this.$Ka!==ca.a.jSa&&this.$Ka!==ca.a.bya,Bb[this.Drb]=this.$Ka===ca.a.reformatPastedContent||gb):gb===ca.a.gbe?Bb[this.Drb]=this.$Ka===ca.a.jSa:gb===ca.a.L1f&&(Bb[this.Drb]=this.$Ka===ca.a.bya);return 32};this.bX=(gb,Bb,$b,Qb,Ac,Db)=>{if((x.AFrameworkApplication.protectFile||x.AFrameworkApplication.KG)&&!x.AFrameworkApplication.ACb||ma.a.kha($b)&&ma.a.kac())return new Ka(gb,Bb,$b,
Qb,Ac,Db);let dc=this.Qz.J(Bb);1!==Qb&&dc&1&&(this.$Ka=Bb);if(1!==Qb){var Pb=Object(V.a)(112,Db)?Db:null;Db?(dc&1&&(this.Med=Pb),Pb=Pb?Pb.ia(P.a.zY,0):0,Bb===ca.a.paste&&Pb===ca.a.CZa?dc=this.Qz.J(ca.a.c_):Bb===ca.a.u9&&Pb===ca.a.fAb&&(dc=this.Qz.J(ca.a.J9d))):!Db&&dc&4096&&(Db=this.Med,Pb=Object(V.a)(112,Db)?Db:null)&&(Pb=Pb.ia(P.a.e1c,y.a.nil),M.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Pb))}return this.PDd.create(gb,Bb,dc,new J.a(()=>this.nJc(dc,Db)),
$b,Qb,Ac,Db)};this.eHn=(gb,Bb,$b,Qb,Ac)=>this.n5e(gb,Bb,$b,Ac);this.dHn=(gb,Bb,$b,Qb,Ac)=>this.n5e(gb,Bb,$b,Ac);this.cHn=(gb,Bb,$b,Qb,Ac)=>this.n5e(gb,Bb,$b,Ac);this.y4d=(gb,Bb,$b,Qb,Ac,Db)=>{Db=Y.a.Rc(ra.a.instance.gb.kb.Oa.node,Db);return this.bX(gb,Bb,$b,Qb,Ac,Db)};this.EYj=oa;this.Tea=za;this.rd=Fa;this.hk=kb;this.ga=lb;this.jfd=Ua;this.$Sb=wb;this.ze=cc;this.gg=zb;this.Ub=Ga;this.fZb=nb;this.gZb=eb;this.jek=Ib;this.HL=Xa;this.YFe=Ra;this.Nh=n.a.getInstance(La.a.FZa);ab&&(this.BCc=ab.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),
this.Ljd=this.gZb&&ab.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Qz=new W.a;this.Qz.Z(ca.a.paste,257);this.Qz.Z(ca.a.u9,8449);this.Qz.Z(ca.a.c_,1);this.Qz.Z(ca.a.l2a,1);this.Qz.Z(ca.a.qzb,1);this.Qz.Z(ca.a.jCa,1);this.Qz.Z(ca.a.PWd,513);this.Qz.Z(ca.a.reformatPastedContent,4097);this.Qz.Z(ca.a.jSa,12289);this.Qz.Z(ca.a.bya,131073);this.Qz.Z(ca.a.hYf,7);this.Qz.Z(ca.a.I9d,1);this.Qz.Z(ca.a.J9d,8193);this.Qz.Z(ca.a.copy,272);this.Qz.Z(ca.a.hFc,16);this.Qz.Z(ca.a.cut,304);this.Qz.Z(ca.a.l4e,
48);this.Qz.Z(ca.a.x4d,64);this.Qz.Z(ca.a.y4d,64);this.Qz.Z(ca.a.showPlaceholderGlossary,65536);this.Qz.Z(ca.a.Zff,1);this.Ljd&&this.Qz.Z(ca.a.Pmb,this.Qz.J(ca.a.J9d))}get DTa(){return null!=this.UGg?this.UGg:this.UGg=u.a.instance.Na("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.oHg?this.oHg:this.oHg=u.a.instance.Na("Common.Utils.Telemetry.ITelemetry")}get PDd(){return this.EYj.value}get XEo(){return this.Tea}Tb(){this.ga.fb(ca.a.MKn,U.a.application,this.Q4i,97);
this.ga.fb(ca.a.NKn,U.a.application,this.Q4i,97);this.ga.fb(ca.a.fbe,U.a.application,this.P1f,97);this.ga.fb(ca.a.gbe,U.a.application,this.P1f,97);this.ga.fb(ca.a.L1f,U.a.application,this.P1f,97);this.ga.fT(ca.a.l4e,U.a.view,this.bX,1028);this.ga.ndb(ca.a.hFc,U.a.view,this.bX);this.ga.fT(ca.a.Zff,U.a.view,this.jrl,1028);this.ga.fT(ca.a.c_,U.a.view,this.bX,1028);this.ga.fT(ca.a.l2a,U.a.view,this.bX,1028);this.ga.fT(ca.a.qzb,U.a.view,this.bX,1028);this.ga.fT(ca.a.jCa,U.a.view,this.bX,1028);this.fZb&&
this.ga.fb(ca.a.CZa,U.a.view,this.cHn,1028);this.gZb&&this.ga.fb(ca.a.fAb,U.a.view,this.dHn,1028);this.ga.fT(ca.a.paste,U.a.view,this.bX,1028);this.ga.fT(ca.a.u9,U.a.view,this.bX,1028);this.ga.fT(ca.a.J9d,U.a.view,this.bX,1028);this.ga.fT(ca.a.I9d,U.a.view,this.bX,1028);this.ga.fT(ca.a.hYf,U.a.view,this.bX,1028);this.ga.fT(ca.a.reformatPastedContent,U.a.view,this.bX,1028);this.ga.fT(ca.a.jSa,U.a.view,this.bX,1028);this.ga.qa(ca.a.ZMb,U.a.view,z.ActionManager.Pf);this.ga.qa(ca.a.d0i,U.a.view,z.ActionManager.Pf);
this.ga.qa(ca.a.a0i,U.a.view,z.ActionManager.Pf);this.ga.qa(ca.a.b0i,U.a.view,z.ActionManager.Pf);this.ga.qa(ca.a.c0i,U.a.view,z.ActionManager.Pf);this.ga.qa(ca.a.$_i,U.a.view,z.ActionManager.Pf);this.ga.ndb(ca.a.x4d,U.a.view,this.bX);this.ga.ndb(ca.a.y4d,U.a.view,this.y4d);this.ga.ndb(ca.a.PWd,U.a.view,this.bX);this.ga.ndb(ca.a.showPlaceholderGlossary,U.a.view,this.bX);this.Ljd&&(this.ga.fb(ca.a.EFc,U.a.view,this.eHn,1028),this.ga.fT(ca.a.Pmb,U.a.view,this.bX,1028));this.ga.qa(ca.a.DNh,U.a.view,
z.ActionManager.Pf);this.ga.qa(ca.a.gOh,U.a.view,z.ActionManager.Pf);this.YFe&&(this.ga.fb(ca.a.n8c,U.a.view,this.n8c,96),this.ga.fb(ca.a.UFb,U.a.view,this.UFb,96))}W4(){if(this.Ub){const oa=this.Ub.fe(fa.AppFrame.YE);this.Ljd&&oa.bindAction(w.KeyInputManager.kc(F.a.Xqb,w.KeyInputManager.Sh|4),ca.a.EFc)}else M.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}vfo(oa,za,Fa){switch(za){case ca.a.jSa:case ca.a.u9:case ca.a.Pmb:za=ca.a.gbe;break;case ca.a.bya:za=
ca.a.L1f;break;default:za=ca.a.fbe}Fa[this.Drb]=oa===za}l7l(){const oa=Object(V.a)(112,this.Med)?this.Med:null;return oa?oa.ia(P.a.e1c,y.a.nil):y.a.nil}n5e(oa,za,Fa,kb){if(1===Fa){if(!Object(V.a)(pa.a,za)||!this.jfd||ma.a.kha(za)&&ma.a.kac())return 8;Fa=new J.a(()=>this.nJc(this.Qz.J(ca.a.c_),kb));const fb=this.jfd.create(Fa,Object(X.a)(112,kb));Fa=new qa.a(x.AFrameworkApplication.K,G.a.instance,Fa,H.a.instance,fb,this.$Sb);return la.a.mAh(za,Fa)?32:8}if(2===Fa){if(this.Aqo(aa.App.LYa))return this.CZa(oa);
aa.App.Pgc(()=>{this.CZa(oa)});return 32}return 2}CZa(oa){if(!this.ze)return M.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var za=this.ze.qhb();if(!za)return M.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;za=za.Qn;if(!za)return M.ULS.sendTraceTag(592454659,307,10,"No document"),8;M.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",oa);this.Nh.logKpiUsage({kpiName:La.a.eNa});this.gg.itl(oa);oa=L.a.KCb(za,"paste");za=this.gg.Mml();M.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",za);if(oa)return M.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.Nh.logKpiSuccess({kpiName:La.a.eNa}),32;this.jmm();M.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.Nh.logKpiFailure({kpiName:La.a.eNa,errorName:"ExecCommandFailed"});return 8}jmm(){this.DTa&&(this.DTa.WOb(),La.a.r2d(!0,ra.a.instance,I.a.bG));if(this.telemetry){const oa=this.telemetry.$8c();oa.X0b("CallExecCommandPasteOperation");oa.fail("call to execCommand('paste') failed",
!0);this.telemetry.gga(oa)}}Aqo(oa){let za=!1;this.Ub?this.Ub.currentScope?za=!this.Ub.GCf(this.Ub.currentScope.name):M.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):M.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(za){M.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Ub.currentScope.name);if(1>oa)return M.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Ub.$kf();return!1}return!0}nJc(oa,za){return oa&256?new xa(this.XEo):oa&2?oa&4096?new Na(za,
this.rd,this.hk,aa.App.instance.lUc,aa.App.instance.hTa):new ja(za,this.rd,aa.App.instance.hTa):za.hasProperty(P.a.fLb)?new wa(za,this.rd,this.hk,this.BCc,aa.App.instance.hTa):new Na(za,this.rd,this.hk,aa.App.instance.lUc,aa.App.instance.hTa)}static get yAn(){return N.a.JRd("Box4PasteScratchPad")}lAh(oa,za,Fa,kb){return!x.AFrameworkApplication.protectFile&&!x.AFrameworkApplication.KG||x.AFrameworkApplication.ACb?(oa=this.bX(null,oa?ca.a.cut:ca.a.copy,za,1,Fa,kb))?oa.response:8:8}}Object(E.a)(Ja,"ClipboardActor",
null,[])},1765:function(E,K,c){c.r(K);E=c(0);var l=c(19),f=c(2027),a=c(1816);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(E.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);class x{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(E.a)(x,"DeltaAttributes",null,[]);var y=c(1607),n=c(8),u=c(68),z=c(15),w=c(7),F=c(1670);c.d(K,"ACommentFormatTranslator",
function(){return G});class G{constructor(H){this.ah=H}SCk(H,L){const I=n.ParagraphReader.text(L);let N=null,P=null,M=null,J=0;var V=0,X=!1;let W="";for(L.pa||I&&I.length&&"\n"!==I||w.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");J<L.pa.length;){const Y=L.pa.J(J),ca=Y.cp;var U=Y.formatting?Y.formatting.yn:null;W+=l.a.substring(I,X?V+1:V,ca);Y.Pm&&N&&(V=new f.a,V.fullName=W.startsWith("@")?W.substr(1):W,F.a(N,V),X=new k,F.c(N,X,V),H.dAf(W,V,X,!0),W=
"",N=null);Y.Pm&&P&&(V=M||new x,V.link=P.url,H.iri(W,V),W="",P=null);N&&P||""===W||(this.ah.Gzb&&M?(H.Cri(W,M),M=null):H.aha(W),W="");Y.hyperlink&&(Y.hyperlink.ew?N=Y.hyperlink:Y.hyperlink.url&&(P=Y.hyperlink));this.ah.Gzb&&U&&(M=new x,M.weight=U.ia(z.a.bold,!1)?y.a.VMf:0,M.italic=U.ia(z.a.italic,!1),M.underline=U.ia(z.a.underline,!1),M.strikethrough=U.ia(z.a.strikethrough,!1),U.hasProperty(z.a.highlight)&&(V=U.getValue(z.a.highlight),M.highlight=u.a.VE(V)),U.hasProperty(z.a.fontColor)&&(U=U.getValue(z.a.fontColor),
M.color=u.a.VE(U)));V=ca;X=!!Y.blob;J++}}}G.ZGk="_@_";G.$Gk="Z";Object(E.a)(G,"ACommentFormatTranslator",null,[584])},1777:function(E,K,c){E=c(0);var l=c(174),f=c(19),a=c(26),k=c(22),x=c(2),y=c(160),n=c(157);class u{static get Xg(){return l.a.qA(u.Lm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.Lm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(E.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(16),w=c(3);c.d(K,"a",function(){return F});class F extends l.a{constructor(G,H,L){super();this.lXg=!1;this.UV=null;this.lGl=I=>{switch(I){case 1:this.ga.processAction(z.a.O0h,2);break;case 2:this.ga.processAction(z.a.P0h,2);break;case 0:this.ga.processAction(z.a.Q0h,2)}};this.ru=H;this.sS=!1;this.XUb=F.TFl;this.Mh=G;this.ga=L;this.wg="FootnoteEndnoteFormattingOptionsDialog";this.Ad=2;this.Xg=u.Xg;this.Ee(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ee(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Yh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.lGl,null);this.mib=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.UV}set fontName(G){this.UV=G;if(G=document.getElementById("FontSizeComboBox"))G.focus(),this.Mh.updateCommandUI()}get fontSize(){return this.XUb}get mib(){return this.lXg}set mib(G){this.lXg=G;this.CCn()}f9(){this.OBd("FontStyleComboBox",
"FontPlaceholder",z.a.IMd.toString(),z.a.A4i.toString(),z.a.x1c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.OBd("FontSizeComboBox","FontPlaceholder",z.a.JMd.toString(),w.a.u2c.toString(),z.a.y1c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const G=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.RX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.RX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.mFc("NoStyle","IndentPlaceholderStyles",
z.a.S0h.toString(),z.a.B4i.toString(),G,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.mFc("FirstLineIndent","IndentPlaceholderStyles",z.a.R0h.toString(),z.a.r1f.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}OBd(G,H,L,I,N,P,M){L=y.c(G,L,!0,!0,I,N,f.a.Af(P),!0,M);this.tGd(G,H,L,"Medium")}mFc(G,H,L,I,N,P,M){L=y.f(G,L,I,f.a.Af(N),f.a.Af(P),M);this.tGd(G,H,L,"Large",P)}tGd(G,H,L,I,N=null){H=document.getElementById(H);
this.ru.QYa(G,L);L=this.ru.$Db(G,I);N&&a.a.pAd(L,String.format("{0}Label",G),N);H.appendChild(L);this.ru.Gpa(G)}CCn(){this.ru.Gpa("NoStyle");this.ru.Gpa("FirstLineIndent")}dispose(){this.sS||(this.ru.CY("FontStyleComboBox"),this.ru.CY("FontSizeComboBox"),this.ru.CY("NoStyle"),this.ru.CY("FirstLineIndent"),this.sS=!0);this.Mh.updateCommandUI();super.dispose()}static get NTa(){return k.a.instance.resolve("Common.IStandaloneRootController").jda}static bXl(){return new F(n.App.un,F.NTa,x.AFrameworkApplication.va)}static aXl(){return F.bXl()}}
F.TFl=-1;Object(E.a)(F,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1805:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.ii=this.Knd=0;this.HWg=a;this.glk=f}vlb(){return this.Knd-this.ii>=this.glk}reset(){this.ii=this.Knd=this.HWg()}update(){this.Knd=this.HWg()}}Object(E.a)(l,"TimeBasedTaskYieldStrategy",null,[735])},1816:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.contentId=""}}Object(E.a)(l,"AtMentionOptionalAttributes",
null,[])},1844:function(E,K){Object.defineProperty(K,"__esModule",{value:!0});K.ObjectSchemaType=K.ObjectSemantic=K.SequenceType=K.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(K.IntentIds||(K.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(K.SequenceType||(K.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(K.ObjectSemantic||(K.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(K.ObjectSchemaType||(K.ObjectSchemaType={}))},1845:function(E,K,c){Object.defineProperty(K,"__esModule",
{value:!0});K.SearchSuggestionAnnotation=K.SearchSuggestionSignal=void 0;const l=c(196);class f{constructor(k){l.SchemaObject.assign(f,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[f.getTypeName()])}}K.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1853:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Jz:n.writable||n.configurable))n={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1854),K);f(c(1855),K);f(c(1856),K);f(c(1857),K);E.exports.ContractEntityAnnotation||Object.defineProperty(E.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return E.exports.ContractEntityAnnotation}});
E.exports.ContractEntitySignal||Object.defineProperty(E.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return E.exports.ContractEntitySignal}})},1854:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1855:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1856:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.ContractEntityAnnotation=void 0;const l=c(196);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1857:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.ContractEntitySignal=void 0;const l=c(196);class f{constructor(a){l.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1859:function(E,K,c){c.r(K);c.d(K,"ReactOICErrorDialogWithTrial",function(){return k});E=c(0);var l=c(55);K=c(1700);var f=c(460),a=c(174);class k extends K.a{constructor(x,y,n,u,z,w){super(x,y,n,u,z,w);y={["errorMessage"]:this.KWh,["offerString"]:this.DRi};x=new a.a(!1,!1,!0);this.rrj?(x.Ad=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.rib,["onExecute"]:()=>{f.Redirect.showHelp(this.Ymi)}}):
(x.Ad=4,x.Ee(2,this.ioi));x.Ee(1,this.hyd);x.wg=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Yh(this.dialogTitle,Object(l.a)(this,this.zOn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(E.a)(k,"ReactOICErrorDialogWithTrial",K.a,[])},1860:function(E,K,c){c.r(K);c.d(K,"OICErrorDialogWithTrial",function(){return a});E=c(0);var l=c(55);K=c(1700);var f=c(175);class a extends K.a{constructor(k,x,y,n,u,z){super(k,x,y,n,u,z);k=document.createElement("span");k.innerText=this.KWh;
k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.DRi;k.appendChild(x);x=new f.StandardDialog;this.rrj?(x.Ad=1,x.KYe(this.rib,this.Ymi)):(x.Ad=4,x.Ee(2,this.ioi));x.Ee(1,this.hyd);x.wg=this.id;x.Ju(this.dialogTitle,null,this.icon,Object(l.a)(this,this.xYm,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(E.a)(a,"OICErrorDialogWithTrial",K.a,[])},1862:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,
k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1863),K);f(c(1864),K);E.exports.SearchProviderAnnotation||Object.defineProperty(E.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return E.exports.SearchProviderAnnotation}});
E.exports.SearchProviderSignal||Object.defineProperty(E.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return E.exports.SearchProviderSignal}})},1863:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1864:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.SearchProviderAnnotation=K.SearchProviderSignal=void 0;const l=c(196);class f{constructor(k){l.SchemaObject.assign(f,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}K.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1951:function(E,
K,c){function l(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?N.WVn():N.main();$f.main(ka);kl.main(ka);z.a.instance.Fc(new Aj,0,ka);z.a.instance.Fc(new Mj,0,ka);go(ka);Nl(ka)}var f=c(0),a=c(7),k=c(1589),x=c(1602),y=c(2),n=c(83),u=c(743),z=c(179),w=c(35),F=c(39),G=c(20),H=c(82),L=c(22),I=c(119);class N{get name(){return"Common.App.OAuth.OAuthPackage"}xc(ka){ka.register(317,"Common.App.OAuth.IOAuthManager").singleInstance().Rd(()=>
new k.OAuthManager)}init(){const ka=L.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.DOo(ka)}DOo(ka){const bb=y.AFrameworkApplication.K.jb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===bb){var ub=u.OAuthManagerSettings.s$e;if(ub&&ub.IsEnabled){var Xb=ub.Application,tc=u.OAuthManagerSettings.authority;if(void 0!==Xb&&null!==Xb&&Xb.length&&void 0!==tc&&null!==tc&&tc.length){var Tc=x.a[ka.p$],Md=G.a.bG,
le=ka.VK();try{var md=new Map;void 0!==md&&null!==md?(md.set("SupportStatus",Tc),md.set("Browser",Md),md.set("AuthStrategy",le)):md=null}catch(ef){md=null}n.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",md);var Ee=F.a.Ze();ka.PY("Core",Xb).then(ef=>{const Wf=Math.floor(F.a.Ze()-Ee);Tc=x.a[ka.p$];Md=G.a.bG;le=ka.VK();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Wf,ef.IsSuccess,Tc,ef.ErrorCode,bb,Md,le);md&&(md.set("SupportStatus",Tc),md.set("Browser",Md),md.set("AuthStrategy",le));var Ag=Object.assign(new I.a,{durationMs:Wf,extendedProperties:md});if(ef.IsSuccess){if(n.Health.instance.recordKpiSuccess("WacCorePFT",Ag),ef="Bearer "+ef.Token,y.AFrameworkApplication.Ne.Aog=ef,Ag=ub.Endpoint){var Dh=F.a.Ze();y.AFrameworkApplication.Ne.k0b(Ag,1,null,{["Authorization"]:ef},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(gh=>{var gl=Math.floor(F.a.Ze()-
Dh),Al=null;gh.zo?gh="Canceled":gh.Ci?gh="Faulted":(Al=gh.result,gh=Al.succeeded?"Completed":"Failed");gl={["TaskResult"]:gh,["BrowserTokenDurationMS"]:Wf,["BrowserValidationDurationMS"]:gl};Al&&(gl.HttpStatus=Al.args.data.Qe,Al.succeeded&&(Al=w.a(Al.args.data.we),gl.ServerValidationDurationMS=Al.ElapsedMilliseconds,gl.ServerValidationResult=Al.ValidatedToken,gl.KMSI=Al.KMSI,gl.Scopes=Al.Scopes,gl.TokenExpirationS=Math.floor(parseInt(Al.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===gh?50:15,H.a.toJSON(gl))})}}else n.Health.instance.recordKpiFailure("WacCorePFT",ef.ErrorCode,!1,!1,Ag)}).catch(ef=>{var Wf=Math.floor(F.a.Ze()-Ee);Wf=Object.assign(new I.a,{durationMs:Wf,extendedProperties:md});n.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+ef.toString(),!1,!1,Wf)})}}}}dispose(){}static main(){z.a.instance.Fc(new N)}static WVn(){z.a.instance.Fc(new N,0,!0)}}Object(f.a)(N,"OAuthPackage",null,[1,2]);var P=c(372),M=c(365),J=c(19);class V{constructor(){this.xtd=
new M.a}qOo(ka,bb){if(!ka)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ka=J.a.Ug(ka);if(this.xtd.nb(ka))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ka),!1;this.xtd.Z(ka,bb);return!0}d6l(ka){if(!ka)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ka=J.a.Ug(ka);return this.xtd.nb(ka)?this.xtd.J(ka):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",
ka),null)}}Object(f.a)(V,"SdxPaneSuppressionManager",null,[]);var X=c(243),W=c(251),U=c(9);class Y{constructor(ka){this.HKe=0;this.tbk=ka}vlb(){return this.HKe>=this.tbk}reset(){this.HKe=0}update(){this.HKe++}}Object(f.a)(Y,"NodeCountBasedTaskYieldStrategy",null,[735]);var ca=c(1805);class aa{constructor(){this.y6c=new Set}EMb(ka){this.y6c.add(ka)}JQo(ka){this.y6c.delete(ka)}Wsn(){return()=>{this.y6c.forEach(ka=>{ka.onSessionClose()})}}Xsn(){return()=>{this.y6c.forEach(ka=>{ka.onSessionConnect()})}}Ysn(){return()=>
{this.y6c.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(f.a)(aa,"AlSessionLifeEventNotifier",null,[312]);var fa=c(1396),pa=c(80),ra=c(91),la=c(58),qa=c(6),La=c(1505),Pa=c(153),Ka=c(330),Na=c(1029),sa=c(695),wa=c(238),ja=c(409),ha=c(669),va=c(416),xa=c(403);class ma{constructor(){this.token=null}}Object(f.a)(ma,"ReleaseAnnotationParameters",null,[]);class Ja{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(Ja,"SetAnnotationMetadataParameters",null,[]);class oa{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(f.a)(oa,"SetAnnotationStateParameters",null,[]);var za=c(585),Fa=c(355),kb=c(74),fb=c(77),lb=c(588),sb=c(1205),ab=c(305),Ga=c(744),Ua=c(8),wb=c(398);class cc extends Sys.EventArgs{constructor(ka,bb){super();this.annotation=ka;this.ydb=bb}}Object(f.a)(cc,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var zb=c(1002);class nb{constructor(ka){this.z0e=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(ka.items&&0<ka.items.length){const bb=nb.WQd(ka.parentPath);this.annotations=Array(ka.items.length);let ub=0;for(const Xb of ka.items){const tc=Object.assign(new zb.a,{id:Xb.id,parentPath:bb,content:Xb.body,annotationType:wa.a.getTypeNameFor(Xb.body),parentRevId:ka.parentRevId});this.annotations[ub++]=tc}this.z0e=wa.a.getTypeNameFor(ka)}}static WQd(ka){return ka?ka.join("\\"):""}}Object(f.a)(nb,"AnnotationOperation",null,[]);class eb extends Sys.EventArgs{constructor(ka,bb){super();this.annotationType=
ka;this.activated=bb}}Object(f.a)(eb,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class Ib extends Sys.EventArgs{constructor(ka,bb){super();this.annotation=ka;this.opType=bb}}Object(f.a)(Ib,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Xa{constructor(){this.newState=this.oldState=0;this.handlers=new kb.a}}Object(f.a)(Xa,"AnnotationResultStateUpdateData",null,[]);var Ra=c(603),gb=c(996);class Bb{constructor(){this.w0e=this.KBk=this.x0e=null}}Object(f.a)(Bb,"AnnotationCallbacks",null,
[]);class $b{constructor(ka,bb,ub,Xb,tc,Tc){this.I_b=null;this.Fyc=new M.a(0);this.XCc=new M.a;this.Ydd=new M.a;this.ard=new Ra.a;this.ZUf=null;this.si=ka;this.RKa=bb;this.IF=ub;this.eC=Xb;this.xI=tc;this.ld=Tc}d2o(ka,bb,ub,Xb){this.eC.D$b(ka)&&this.si.he(()=>{if(!this.I_b){this.I_b=new M.a;var tc=Ua.ParagraphReader.ow(wb.a.getRootNode(),!0,!0);for(const Tc of tc)Tc&&(tc=Tc.ia(qa.a.Lc,0))&&(this.I_b.add(tc,Tc.id),this.Fyc.Z(Tc.id.toString(),tc))}this.RKa.YUf(ka,(Tc,Md)=>{if(Tc){var le=this.eC.Iai(ka);
Tc.contentDescriptor.Lv===le&&((le=this.zXl(Tc))?Tc.xdb?(le=this.F$e(Tc,le))&&(Md?ub(Md,Tc.contentDescriptor):bb(le,Tc.contentDescriptor)):Xb(Tc.contentDescriptor):this.eil(Tc,Object.assign(new Bb,{x0e:bb,KBk:ub,w0e:Xb})))}})},"PAS:FEPAOT")}zXl(ka){if(3===ka.contentDescriptor.Lv){let bb;return({value:bb}=this.I_b.Dc(ka.contentDescriptor.paragraphId)).returnValue?bb:null}if(4===ka.contentDescriptor.Lv)return la.a.nil;a.ULS.sendTraceTag(592525442,$b.Ei,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");
return null}CKm(ka,bb){if(3===ka.contentDescriptor.Lv)return bb=this.xI.value.Db(bb).getValue(qa.a.sj),ka.contentDescriptor.sj===bb;if(4===ka.contentDescriptor.Lv&&bb===la.a.nil)return!0;a.ULS.sendTraceTag(592525443,$b.Ei,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}eil(ka,bb){if(3===ka.contentDescriptor.Lv){const ub=ka.contentDescriptor.paragraphId;this.XCc.nb(ub)||this.XCc.add(ub,new kb.a);this.XCc.J(ub).add(Xb=>{12===Xb.type&&this.I_b.add(ub,Xb.id);ka.xdb?(Xb=this.F$e(ka,
Xb.id))&&bb.x0e(Xb,ka.contentDescriptor):bb.w0e(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Lv)if(ka.xdb){const ub=this.F$e(ka,la.a.nil);ub&&bb.x0e(ub,ka.contentDescriptor)}else bb.w0e(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,$b.Ei,15,"DelayCallbackForAnnotation: Unsupported content type")}F$e(ka,bb){if(this.CKm(ka,bb)){if(bb=this.eC.tgn(ka.xdb,ka.contentDescriptor,bb.toString()))return this.Ydd.Z(bb.id,ka.A5a),bb}else this.ld.isFeatureEnabled(88)&&this.IF.zDc(ka);return null}vGj(ka,
bb){const ub=this.eC.nOd(ka);ub&&(bb===Na.a.getTypeName()?this.VMo(ka,ub):this.HMo(ka,ub))}VMo(ka,bb){this.eC.D$b(ka.annotationType)&&(this.IF.qSa(this.xI.value,bb,ka.annotationType),this.Ydd.remove(ka.id))}HMo(ka,bb){if(this.eC.D$b(ka.annotationType)){bb=Object.assign(new gb.a,{xdb:this.eC.OBk(ka),contentDescriptor:bb,annotationType:ka.annotationType});bb=this.IF.addAnnotation(this.xI.value,bb);this.Ydd.Z(ka.id,bb);const ub=this.eC.gji(ka.annotationType);ub&&this.ard.contains(ub)&&(this.si.he(()=>
{var Xb=Ua.ParagraphReader.ow(wb.a.getRootNode(),!0,!0);if(Xb&&0<Xb.count){const tc=new kb.a;for(const Tc of Xb)(Xb=$b.SQd(Tc))&&tc.add(Xb);0<tc.count&&this.IF.foh(this.xI.value,ub,tc.toArray())}},"PAS:TAOCPA"),this.ard.remove(ub))}}hmb(ka){if(this.I_b)if(ka){var bb=ka.ia(qa.a.Lc,0);if(bb&&(this.Fyc.Z(ka.id.toString(),bb),({value:bb}=this.XCc.Dc(bb)).returnValue))for(const ub of bb)ub(ka)}else a.ULS.sendTraceTag(592525445,$b.Ei,10,"OnParagraphNodeConnected: Invalid node")}AVi(ka,bb){if(ka){var ub=
ka.id.toString();ka=ka.ia(qa.a.Lc,0);var Xb=0;({value:Xb}=this.Fyc.Dc(ub)).returnValue&&(3===bb?(this.XCc.remove(Xb),this.Fyc.remove(ub)):2===bb?this.Fyc.Z(ub,ka):a.ULS.sendTraceTag(592525447,$b.Ei,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,$b.Ei,10,"UpdatePersistedAnnotations: Invalid node")}V9l(ka){let bb;return({value:bb}=this.Ydd.Dc(ka)).returnValue?bb:la.a.nil}KYo(ka,bb,ub){ka?bb?this.RKa.kdi(ka,Xb=>{if(Xb){const Md=
$b.SQd(bb,ub);if(Md){var tc=Array(Xb.length),Tc=!1;for(let le=0;le<Xb.length;le++)if(Tc||Md!==Xb[le])tc[le]=Xb[le];else{const md=$b.SQd(bb);if(!md)return;Tc=!0;tc[le]=md;Xb[le]=md}Tc&&this.IF.foh(this.xI.value,ka,tc)}}}):a.ULS.sendTraceTag(588863697,$b.Ei,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,$b.Ei,10,"UpdateWorkflowParagraphVersion: null workflowType")}Gko(ka){ka?this.ard.add(ka):a.ULS.sendTraceTag(588863698,$b.Ei,10,"SetPendingWorkflow: null workflowType")}ZXk(ka){ka?
this.ard.remove(ka):a.ULS.sendTraceTag(588105731,$b.Ei,10,"ClearPendingWorkflow: null workflowType")}static SQd(ka,bb=0){if(!ka)return null;bb||(bb=ka.ia(qa.a.sj,0));ka=Ua.ParagraphReader.RQ(ka);if(bb&&ka)return String.format("{0}{1}{2}",ka,$b.hzn,bb);a.ULS.sendTraceTag(588091606,$b.Ei,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",bb?"valid":"0",ka?"valid":"0");return null}}$b.Ei=389;$b.hzn="-";Object(f.a)($b,"PersistedAnnotationStorage",null,[732]);class Qb{constructor(){this.config=
this.token=null}}Object(f.a)(Qb,"UpdateAnnotationConfigParameters",null,[]);var Ac=c(120),Db=c(1184),dc=c(335),Pb=c(1406),Ub=c(855),rb=c(202),Yb=c(1088);class Ya{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf=null,Ag){this.ecb=Ag;this.ra=new pa.a;this.Dza=new fb.a;this.S5=new fb.a;this.nD=new fb.a;this.Ese=new fb.a;this.trc=new za.a(Fa.a.ai());this.fMe=new kb.a;this.mSb=new fb.a;this.Ase=new fb.a;this.Zdd=new fb.a;this.nSb=new fb.a;this.Hoc=new fb.a;this.$dd=new fb.a;this.ngd=new fb.a;this.ipd=[];
this.jpd=[];this.Owc=null;this.ubk=new za.a(Fa.a.ai());this.Cse=new Map;this.prc=new Map;this.Rpc=null;this.Nja=new fb.a;this.IIc=null;this.I$g=this.UZg=0;this.RXa=null;this.vfl=()=>{if(this.ipd.length||this.jpd.length)try{0<this.ipd.length&&this.W9m(),0<this.jpd.length&&this.dQo()}finally{this.lYk()}else this.Hb.We(this.Owc),this.Owc=null};this.hYk=()=>{const Dh=new kb.a;for(const gh of this.nD.values)if(Dh.add(gh),Dh.count===Ya.Ebk)break;for(const gh of Dh)this.VBb(gh),this.LNb(gh,Na.a.getTypeName());
this.nD.count||(this.Hb.We(this.Rpc),this.Rpc=null)};this.w_c=(Dh,gh)=>{for(const gl of gh.Ij)Dh=gl.intent,!Dh.type&&this.fqo(Dh.intent,gl.cpBegin,gl.cpEnd,gl.IIb)&&this.VBb(Dh.intent)};this.l7j=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.Uhk=ka.KC("SendReleaseMessageAnnotationList")||[];this.ld=Ee;this.eJa=Wf;this.RKa=Tc;this.IF=Md;this.Fm=ub;this.eC=le;this.gaa=md;this.xI=Xb;this.si=bb;this.Hb=tc;L.a.instance.resolve("Box4.ICharacterPropertiesEditor").$Ze(this.w_c);this.Ts=ef;this.uVj=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.a7j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.N8j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.Y0g=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.ecb&&this.rnm();this.Ty=rb.a.instance}get W8i(){return this.nSb}set W8i(ka){this.nSb=ka}mb(ka,bb){a.ULS.sendTraceTag(41521862,Ya.Ei,50,"New registration for annotation type: {0}.",bb);this.addHandler(ka,
bb);this.TXe(bb).catch(ub=>{a.ULS.sendTraceTag(594396739,Ya.Ei,10,"Failed to activate annotation type {0}: {1}",bb,ub.toString())})}addHandler(ka,bb){if(ka&&bb&&""!==bb){var ub=null;({value:ub}=this.nSb.Dc(bb,ub)).returnValue?ub.add(ka):(ub=new kb.a,ub.add(ka),this.nSb.add(bb,ub))}else a.ULS.sendTraceTag(41521861,Ya.Ei,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!bb,""===bb)}uc(ka,bb){a.ULS.sendTraceTag(41521863,Ya.Ei,50,"Unregister handler for annotation type: {0}.",
bb);let ub=null;({value:ub}=this.nSb.Dc(bb,ub)).returnValue&&(ub.remove(ka),ub.count||(a.ULS.sendTraceTag(41521864,Ya.Ei,50,"Unregister all handlers for annotation type: {0}.",bb),this.nSb.remove(bb),this.Sjn(bb)))}Lmj(ka){this.IIc||(this.IIc=this.Ts.Oc(2),this.IIc.Cb(ka))}lYk(){var ka;null===(ka=this.IIc)||void 0===ka?void 0:ka.dispose();this.IIc=null}fKh(){this.Owc||(this.Owc=new ra.a(4,2,100,this.vfl,141),this.Hb.Wb(this.Owc))}W9m(){let ka;ka=Array.dequeue(this.ipd);const bb=wb.a.IEb(this.xI.value,
ka);if(bb)if(bb.pj){this.Lmj(bb);var ub=null;if(({value:ub}=this.Hoc.Dc(ka,ub)).returnValue){this.Hoc.remove(ka);for(const Xb of ub)this.X9m(bb,Xb)}else a.ULS.sendTraceTag(50663568,Ya.Ei,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.ubk.add(ka);else a.ULS.sendTraceTag(50436127,Ya.Ei,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}X9m(ka,bb){var ub=bb.content.range;ub=new sb.a(0,ub.start,ub.start+ub.length,la.a.create(),bb,Xb=>{this.Ese.Z(bb.id,
Xb.toString())});this.Fm.$Qa(ka,ub);this.ra.u8&&this.ra.raiseEvent(Ya.lec,new Ib(bb,Ka.a.getTypeName()))}fMi(ka){const bb=wb.a.y1a(ka.parentPath);let ub=null;({value:ub}=this.Hoc.Dc(bb,ub)).returnValue||(ub=new kb.a,this.Hoc.add(bb,ub),this.ipd.push(bb));ub.add(ka);this.fKh()}Z9m(ka,bb){this.si.he(()=>{let ub;if(({value:ub}=this.S5.Dc(ka,ub)).returnValue){var Xb=this.Zpj(ka);for(const tc of ub){let Tc;({value:Tc}=this.nD.Dc(tc,Tc)).returnValue&&bb(Tc)&&Ya.LGb(Tc)&&(this.fMi(Tc),Xb&&this.ra.raiseEvent(Ya.lec,
new Ib(Tc,Na.a.getTypeName())))}}},"AS:MIFAT")}eQo(ka,bb){this.si.he(()=>{let ub;if(({value:ub}=this.S5.Dc(ka,ub)).returnValue)for(const Xb of ub){let tc;({value:tc}=this.nD.Dc(Xb,tc)).returnValue&&bb(tc)&&Ya.LGb(tc)&&this.ilg(tc)}},"AS:UIFAT")}Zjn(ka){var bb=wb.a.tM(ka);let ub=null;if(({value:ub}=this.Dza.Dc(bb,ub)).returnValue){bb=0;for(var Xb=new kb.a;ub.count>bb;){var tc=ub.J(bb),Tc=null;({value:Tc}=this.nD.Dc(tc,Tc)).returnValue&&Ya.LGb(Tc)?this.eC.K7c(ka,Tc)?this.VBb(Tc,!this.ld.isFeatureEnabled(88)):
(tc=Tc.content.range,Tc=new sb.a(0,tc.start,tc.start+tc.length,la.a.create(),Tc),Xb.add(Tc),bb++):bb++}0<Xb.count&&this.Fm.x3d(ka,Xb)}}dQo(){let ka="";ka=Array.dequeue(this.jpd);const bb=wb.a.IEb(this.xI.value,ka);if(bb&&12===bb.type){this.Lmj(bb);var ub=null;({value:ub}=this.$dd.Dc(ka,ub)).returnValue?(this.Fm.xad(Xb=>ub.contains(Xb.intent),bb,0),this.$dd.remove(ka)):a.ULS.sendTraceTag(50663570,Ya.Ei,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,
Ya.Ei,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}ilg(ka){let bb;({value:bb}=this.Ese.Dc(ka.id,bb)).returnValue||(bb=wb.a.y1a(ka.parentPath));this.Ese.remove(ka.id);var ub=null;({value:ub}=this.$dd.Dc(bb,ub)).returnValue||(ub=new kb.a,this.$dd.add(bb,ub),this.jpd.push(bb));ub.add(ka);this.fKh();ub=null;({value:ub}=this.Hoc.Dc(bb,ub)).returnValue&&ub.remove(ka)}Psk(ka){const bb=ka.id;var ub=ka.annotationType;const Xb=ka.parentPath;if(this.eC.Ojb(ka)){var tc=wb.a.Ehb(this.xI.value,
Xb);if(tc&&(tc=tc.ia(qa.a.sj,0).toString(),ka.parentRevId&&tc!==ka.parentRevId))return!1}tc=null;({value:tc}=this.S5.Dc(ub,tc)).returnValue||(tc=new kb.a,this.S5.add(ub,tc));tc.add(bb);ub=null;({value:ub}=this.Dza.Dc(Xb,ub)).returnValue||(ub=new kb.a,this.Dza.add(Xb,ub));ub.add(bb);this.nD.add(bb,ka);this.c2o(ka);return!0}c2o(ka){const bb=this.eC.o3h(ka);if(0===bb.length)this.XRh(ka);else{let ub=!1;this.RKa.Oqn(bb,ka.annotationType,(Xb,tc)=>{this.nD.nb(ka.id)?(tc=this.eC.gkb(ka,wb.a.WLl(ka)),!Xb&&
tc?this.smg(ka,10,!1):Xb&&this.smg(ka,Xb),ub||(this.XRh(ka),ub=!0)):tc.iTa=!0})}}XRh(ka){const bb=Ya.LGb(ka);bb&&this.fMi(ka);!bb&&this.ra.u8&&this.ra.raiseEvent(Ya.lec,new Ib(ka,Ka.a.getTypeName()))}TDj(ka,bb,ub,Xb){let tc=!0;this.si.he(()=>{if(Xb.startsWith(wb.a.hCb)){var Tc=ka.id,Md=null;if(bb===Na.a.getTypeName())this.VBb(ka);else if(({value:Md}=this.nD.Dc(Tc,Md)).returnValue)a.ULS.sendTraceTag(41418891,Ya.Ei,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Tc,ka.annotationType),
this.nD.Z(Tc,ka);else if(!this.Psk(ka)){tc=!1;return}ub&&bb===Ka.a.getTypeName()&&Xb!==wb.a.hCb&&this.fMe.add(ka.annotationType)}this.LNb(ka,bb)},"AS:UAS");return tc}ago(ka){if(ka)for(const bb of ka)this.LNb(bb,sa.a.getTypeName()),ka=bb.content,this.ngd.nb(ka.categoryName)?this.ngd.Z(ka.categoryName,bb):this.ngd.add(ka.categoryName,bb);else a.ULS.sendTraceTag(592802119,Ya.Ei,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}wwk(ka){this.ra.addHandler(Ya.lec,ka)}Bph(ka){this.ra.addHandler(Ya.oSi,
ka)}C$b(ka){return this.mSb.nb(ka)}vwk(ka){this.ra.addHandler(Ya.S5d,ka)}Z_n(ka){this.ra.removeHandler(Ya.S5d,ka)}Zpj(ka){return!wb.a.jf(ka)&&Ga.a(ka)&&this.ra.u8}VBb(ka,bb=!0){if(this.nD.nb(ka.id)){var ub=this.nD.J(ka.id);this.nD.remove(ka.id);var Xb=null;({value:Xb}=this.Dza.Dc(ka.parentPath,Xb)).returnValue?(Xb.remove(ka.id),Ya.LGb(ub)&&this.ilg(ub)):a.ULS.sendTraceTag(50734169,Ya.Ei,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Xb=null;({value:Xb}=this.S5.Dc(ka.annotationType,
Xb)).returnValue?Xb.remove(ka.id):a.ULS.sendTraceTag(50734170,Ya.Ei,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.Zpj(ka.annotationType)?this.ra.raiseEvent(Ya.lec,new Ib(ub,Na.a.getTypeName())):this.LNb(ka,Na.a.getTypeName());bb&&this.gaa.vGj(ub,Na.a.getTypeName())}}enf(ka,bb,ub=!1){const Xb=new kb.a;var tc;if(!({value:tc}=this.S5.Dc(ka,tc)).returnValue)return Xb;for(const Tc of tc)this.nD.nb(Tc)?(ka=this.nD.J(Tc),(tc=this.eC.nOd(ka))&&(bb.equals(tc)||
ub&&bb.overlaps(tc))&&Xb.add(ka)):a.ULS.sendTraceTag(577843217,Ya.Ei,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Tc);return Xb}WHd(ka){let bb=null;if(({value:bb}=this.S5.Dc(ka,bb)).returnValue){ka=bb.toArray();for(const ub of ka){let Xb;({value:Xb}=this.nD.Dc(ub,Xb)).returnValue&&this.VBb(Xb)}}}wHm(ka){return wa.a.getTypeNameFor(ka)===dc.a.getTypeName()}evi(ka){var bb,ub;return(null===(ub=null===(bb=this.ecb)||void 0===bb?void 0:bb.Eai)||void 0===ub?void 0:
ub.call(bb))===Db.a.Hnc&&ka&&0===ka.priority?this.ecb.Y9c(ka.context.substr(ka.startInContext,ka.range.length)):!1}D3i(ka,bb){this.si.he(()=>{a.ULS.W9(Ya.Ei,100)&&a.ULS.sendTraceTag(41418894,Ya.Ei,100,"Operation of type {0} with path {1} received",wa.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const ub=new nb(ka);for(const Xb of ub.annotations)if(Xb.annotationType===Ub.FlagResultAnnotation.getTypeName()){const tc=Xb.content.results.map(Tc=>{var Md;const le=null===(Md=Tc.M_)||void 0===Md?void 0:
Md.seq;Md=void 0===le?Xb.id:Xb.id+"_"+le;return{id:Md,body:{...Tc,id:Md},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.D3i({items:tc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},bb)}else ub.z0e===Ka.a.getTypeName()&&this.Uso(Xb)?(y.AFrameworkApplication.te("g8469255;j5hhe441"),this.Y0g&&(this.RXa||(this.RXa=Yb.a.FNd()),this.UZg++,this.RXa.Lmh("AnnotationSkippedDueToInvalidContextCount",this.UZg.toString()))):this.hwf(Xb,bb,ub.z0e,!0)}catch(ub){a.ULS.sendTraceTag(41418898,
Ya.Ei,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",ub.message,ub.stack)}},"AS:PO")}Uso(ka){var bb;y.AFrameworkApplication.te("01dfc961;05c12706");if(this.N8j&&Ga.a(ka.annotationType)){var ub;let tc=ub=null;if(this.Ty){ub=this.Ty.I3;var Xb=null===ub||void 0===ub?void 0:ub.node;ub=wb.a.y1a(ka.parentPath);if(wb.a.IEb(this.xI.value,ub)!==Xb)return!1;ka=ka.content;ub=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);tc=null===(bb=null===Xb||
void 0===Xb?void 0:Xb.characterData)||void 0===bb?void 0:bb.substring(ka.range.start,ka.range.start+ka.range.length);this.Y0g&&ka&&0===ka.priority&&(bb=0<ka.range.start?Xb.characterData.charAt(ka.range.start-1):null,Xb=ka.range.start+ka.range.length<Xb.characterData.length?Xb.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&tc&&ub&&tc===ub&&(bb&&bb.match("[A-Za-z0-9]")||Xb&&Xb.match("[A-Za-z0-9]"))&&(this.RXa||(this.RXa=Yb.a.FNd()),this.I$g++,this.RXa.Lmh("partialWordAnnotationsCount",
this.I$g.toString())))}return tc&&ub&&tc!==ub?!0:!1}return!1}hwf(ka,bb,ub,Xb){if(this.wHm(ka.content)&&this.evi(ka.content))this.dza(ka,70);else{var tc=ka.parentPath;ub!==Na.a.getTypeName()&&Xb||this.I9i(ka);Xb&&ub===Ka.a.getTypeName()&&Ga.a(ka.annotationType)&&ka.content.isHotCritique&&this.a7j?this.prc.set(ka.id,{annotation:ka,time:Date.now()}):(Xb=ka.annotationType,wb.a.jf(Xb)||Xb!==ja.a.getTypeName()?!wb.a.jf(Xb)&&Ga.a(Xb)&&ka.content&&0==ka.content.priority&&Ac.a.n4?(ka=wb.a.y1a(tc))&&ka==Ac.a.nKl()&&
a.ULS.sendTraceTag(539870169,Ya.Ei,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):ub!==Na.a.getTypeName()&&this.trc.contains(tc)?a.ULS.sendTraceTag(41418897,Ya.Ei,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",tc,ka.id):this.RDj(ka,tc,ub,bb):a.ULS.sendTraceTag(595342670,Ya.Ei,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",tc))}}cYn(ka){if(ka&&ka.annotationType&&this.eC.D$b(ka.annotationType)){var bb;
if(({value:bb}=this.S5.Dc(ka.annotationType,bb)).returnValue&&(ka=this.eC.nOd(ka)))for(const ub of bb){let Xb;({value:Xb}=this.nD.Dc(ub,Xb)).returnValue&&(bb=this.eC.nOd(Xb))&&(ka.equals(bb)||ka.overlaps(bb))&&this.VBb(Xb)}}}LNb(ka,bb){this.si.he(()=>{let ub=null;if(({value:ub}=this.W8i.Dc(ka.annotationType,ub)).returnValue)for(const Xb of ub)Xb.PC(ka,bb)},"AS:SATH")}gYk(){a.ULS.sendTraceTag(50860999,Ya.Ei,50,"ClearStorage: Initiated Clearing Storage");this.Rpc||(this.Rpc=new ra.a(4,2,100,this.hYk,
142),this.Hb.Wb(this.Rpc))}activateAnnotation(ka,bb){let ub;if(({value:ub}=this.Zdd.Dc(ka,ub)).returnValue){if(ub.contains(bb))return Promise.resolve(null);ub.add(bb)}else{let Xb;this.Zdd.add(ka,(Xb=new kb.a,Xb.add(bb),Xb))}return this.TXe(ka)}TXe(ka){a.ULS.sendTraceTag(41521865,Ya.Ei,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.mSb.nb(ka))return Promise.resolve(null);var bb=null;if(({value:bb}=this.Ase.Dc(ka,bb)).returnValue)return bb;this.Ipk(ka);bb=null;this.eJa&&(bb=this.eJa());
if(bb){const ub=new xa.a;ub.annotationType=ka;this.uVj&&(this.Nja.nb(ka)||this.Nja.Z(ka,new Xa),ub.stateUpdateHandler=(Xb,tc)=>{this.Nja.J(ka).oldState=Xb;this.Nja.J(ka).newState=tc;for(const Tc of this.Nja.J(ka).handlers)Tc(ka,Xb,tc)});bb=bb.activateAnnotation(ub);this.Ase.add(ka,bb);return bb.then(Xb=>{this.Ase.remove(ka);this.mSb.add(ka,Xb.token);this.SDj(Xb.token,ka);this.ra.raiseEvent(Ya.S5d,new eb(ka,!0));this.pnm(ka);return Xb})}return Promise.reject(Error.create("Error during annotation activation"))}pnm(ka){const bb=
this.eC.gji(ka);bb&&this.RKa.kdi(bb,ub=>{if(this.gaa.ZUf){var Xb=Ua.ParagraphReader.ow(wb.a.getRootNode(),!0,!0);if(Xb&&0<Xb.count){let tc=0;for(const Tc of Xb){Xb=$b.SQd(Tc);if(!Xb)continue;let Md=!1;for(;tc<ub.length;){if(Xb===ub[tc]){Md=!0;break}tc++}if(!Md){this.gaa.ZUf(bb);break}tc++}}}})}Ipk(ka){this.gaa.d2o(ka,(bb,ub)=>{0<this.enf(ka,ub,!0).count||this.TDj(bb,Ka.a.getTypeName(),!0,bb.parentPath)},(bb,ub)=>{if(3!==ub.Lv)a.ULS.sendTraceTag(591541786,Ya.Ei,15,"Annotation moved to unsupported location type: {0}",
ub.Lv);else if(bb.Lv!==ub.Lv)a.ULS.sendTraceTag(591541787,Ya.Ei,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",bb.Lv,ub.Lv);else{bb=this.enf(ka,bb);for(const tc of bb){const Tc=tc.content;bb=wb.a.Ehb(this.xI.value,tc.parentPath);if(!bb){a.ULS.sendTraceTag(591541788,Ya.Ei,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Fm.xad(Md=>Md.intent===Tc,bb,0))break;var Xb=ub.Mta;Xb=new sb.a(0,Xb,Xb+ub.Lta,null,Tc);this.Fm.$Qa(bb,
Xb)}}},bb=>{for(const ub of this.enf(ka,bb))this.VBb(ub,!1)})}releaseAnnotation(ka,bb){let ub;if(({value:ub}=this.Zdd.Dc(ka,ub)).returnValue){ub.contains(bb)&&ub.remove(bb);if(0<ub.count)return Promise.resolve(!1);this.Zdd.remove(ka)}a.ULS.sendTraceTag(593790408,Ya.Ei,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.xij(ka)}Sjn(ka){var bb=null;if(({value:bb}=this.S5.Dc(ka,bb)).returnValue){a.ULS.sendTraceTag(41418899,Ya.Ei,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ka);for(const ub of bb)if(bb=null,({value:bb}=this.nD.Dc(ub,bb)).returnValue){const Xb=bb.parentPath;let tc=null;({value:tc}=this.Dza.Dc(Xb,tc)).returnValue&&(tc.remove(ub),tc.count||this.Dza.remove(Xb));this.nD.remove(ub);Ya.LGb(bb)&&this.ilg(bb)}this.S5.remove(ka)}Array.contains(this.Uhk,ka)&&this.xij(ka)}xij(ka){let bb=null,ub=null;this.eJa&&(ub=this.eJa());if(ub){if(({value:bb}=this.mSb.Dc(ka,bb)).returnValue){const Xb=new ma;Xb.token=bb;this.mSb.remove(ka);this.ra.raiseEvent(Ya.S5d,new eb(ka,
!1));return ub.releaseAnnotation(Xb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}sFi(){this.si.he(()=>{if(this.l7j){var ka=wb.a.getRootNode();if(ka){var bb=new fb.a;lb.e(ka,ub=>{var Xb=wb.a.tM(ub),tc=null;if(({value:tc}=this.Dza.Dc(Xb,tc)).returnValue)for(const Tc of tc)Xb=null,({value:Xb}=this.nD.Dc(Tc,Xb)).returnValue&&(Xb.parent=ub,Xb.AUc=!0,Xb.cLb=2,bb.nb(Xb.annotationType)||bb.Z(Xb.annotationType,new kb.a),bb.J(Xb.annotationType).add(Tc),
tc=null,({value:tc}=this.S5.Dc(Xb.annotationType,tc)).returnValue&&tc.remove(Xb.id));return!0},12);for(const ub of this.S5.keys)if(ka=null,({value:ka}=this.S5.Dc(ub,ka)).returnValue)for(const Xb of ka)if(ka=null,({value:ka}=this.nD.Dc(Xb,ka)).returnValue){let tc=null;ka.parentPath===wb.a.hCb?(ka.cLb=1,ka.parent=null):({value:tc}=this.nD.Dc(ka.parentPath,tc)).returnValue?(ka.cLb=3,ka.parent=tc):(ka.cLb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,Ya.Ei,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ka.id));ka.AUc=!0;bb.nb(ka.annotationType)||bb.Z(ka.annotationType,new kb.a);bb.J(ka.annotationType).add(Xb)}else a.ULS.sendTraceTag(41997840,Ya.Ei,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Xb);else a.ULS.sendTraceTag(41997841,Ya.Ei,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",ub);this.S5=bb;this.fMe.clear()}else a.ULS.sendTraceTag(41554058,Ya.Ei,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Ya.Ei,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}NBk(ka){this.D3i(ka,!0)}Vtn(ka,bb){this.si.he(()=>{const ub=bb?bb+String.format("\\{0}",ka.id):wb.a.tM(ka);a.ULS.sendTraceTag(41418900,Ya.Ei,50,"OnTileDeleted: Tile delete event received for tile {0}.",ub);this.trc.contains(ub)||this.trc.add(ub);var Xb=null;if(({value:Xb}=this.Dza.Dc(ub,Xb)).returnValue){a.ULS.sendTraceTag(41418901,Ya.Ei,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Xb.count,
ub);for(const tc of Xb)Xb=null,({value:Xb}=this.nD.Dc(tc,Xb)).returnValue&&(this.LNb(Xb,Na.a.getTypeName()),this.ra.u8&&this.ra.raiseEvent(Ya.lec,new Ib(Xb,Na.a.getTypeName())),this.nD.remove(tc));this.Dza.remove(ub)}},"AS:OTD")}Utn(ka){ka=wb.a.tM(ka);this.trc.remove(ka)&&a.ULS.sendTraceTag(41418902,Ya.Ei,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}QWo(ka){if(ka){a.ULS.sendTraceTag(50436131,Ya.Ei,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var bb=new fb.a;
for(var ub of ka)ka=null,({value:ka}=bb.Dc(ub.parentPath,ka)).returnValue||(ka=new fb.a,bb.add(ub.parentPath,ka)),ka.Z(ub.id,ub);for(const Xb of bb){bb=wb.a.Ehb(this.xI.value,Xb.key);if(!bb){a.ULS.sendTraceTag(50436160,Ya.Ei,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}ub=new ab.a([0]);for(let tc=0,Tc=bb.pa.length;tc<Tc;tc++)ka=bb.pa.J(tc),ka.Ij&&ub.iUa(ka.Ij,void 0,(Md,le)=>{if(le){var md=null,Ee=le.intent;Ee&&({value:md}=Xb.value.Dc(Ee.id,md)).returnValue&&(Ee=new ha.a,
Ee.start=le.Ib.cp,Ee.length=Md.Ib.cp-Ee.start,md.content.range=Ee,md.gxa=!1)}})}}else a.ULS.sendTraceTag(50436130,Ya.Ei,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,Ya.Ei,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.TXe(ka).then(()=>{const bb=new kb.a;this.si.he(()=>{if(wb.a.jf(ka)||ka!==ja.a.getTypeName()){this.fMe.contains(ka)&&this.sFi();var ub=null;if(({value:ub}=this.S5.Dc(ka,ub)).returnValue){a.ULS.sendTraceTag(41418903,
Ya.Ei,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var Xb=new kb.a;for(const tc of ub)ub=null,({value:ub}=this.nD.Dc(tc,ub)).returnValue&&(ub.gxa&&Xb.add(ub),bb.add(ub));Xb&&0<Xb.count&&Ya.LGb(Xb.J(0))&&this.QWo(Xb)}}else for(Xb of this.ngd.values)bb.add(Xb);bb.count||a.ULS.sendTraceTag(41418904,Ya.Ei,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return bb},bb=>{a.ULS.sendTraceTag(41418905,Ya.Ei,10,"Exception occurred while fetching annotations of type {0}: {1}",
ka,bb);return null})}vga(ka){let bb=null;return({value:bb}=this.nD.Dc(ka,bb)).returnValue?bb:null}C3h(ka){let bb=null;if(this.Dza.nb(ka))for(const ub of this.Dza.J(ka))if(ka=this.vga(ub))bb||(bb=new kb.a),bb.add(ka);return bb}NIb(ka){return(ka=this.vga(ka))?(ka.AUc||this.sFi(),ka):null}dza(ka,bb){this.wmo(ka,bb);this.smg(ka,bb);this.LNb(ka,sa.a.getTypeName())}VRo(ka,bb){this.JVo(ka,bb);this.Ijo(ka,wb.a.VLl(ka));this.LNb(ka,sa.a.getTypeName())}WRo(ka,bb){ka=this.eC.o3h(ka);for(const ub of ka)this.IF.dmg(this.xI.value,
ub,bb)}wmo(ka,bb){let ub=null;this.eJa&&(ub=this.eJa());ub&&(ka=this.XLl(ka,bb))&&ub.setAnnotationState(ka)}smg(ka,bb,ub=!0){if(ka&&Ya.Zti(ka)){var Xb=this.vga(ka.id);!ka.content||Xb&&ka.content===Xb.content||wb.a.setAnnotationState(ka,bb);Xb&&Xb.content&&wb.a.setAnnotationState(Xb,bb);ub&&this.ra.u8&&(70===bb||60===bb)&&this.ra.raiseEvent(Ya.oSi,new cc(ka,bb))}}XLl(ka,bb){let ub=null;ka&&(ub=Object.assign(new oa,{id:ka.id,value:bb}),wb.a.jf(ka.parentPath)||(ub.parentPath=ka.parentPath.split("\\")));
return ub}Ijo(ka,bb){const ub=this.eJa?this.eJa():null;ub&&(ka=this.ULl(ka,bb))&&ub.setAnnotationMetadata(ka)}JVo(ka,bb){if(ka&&Ya.Zti(ka)){var ub=this.vga(ka.id);!ka.content||ub&&ka.content==ub.content||wb.a.ijj(ka,bb);ub&&ub.content&&wb.a.ijj(ub,bb)}}ULl(ka,bb){if(!ka)return null;const ub=new Ja;ub.id=ka.id;ub.value=bb;wb.a.jf(ka.parentPath)||(ub.parentPath=ka.parentPath.split("\\"));return ub}fqo(ka,bb,ub,Xb){const tc=ka.content;if(this.eC.Ojb(ka)&&tc){const Tc=tc.range.start+tc.range.length;if(0<
Xb&&Tc<=ub||0>Xb&&Tc<=ub+Xb)return!1;if(0<Xb&&tc.range.start>=bb||0>Xb&&tc.range.start>=ub)return tc.range.start+=Xb,!1}return!this.ld.isFeatureEnabled(61)&&tc&&tc.M_?(ka=this.eC.gkb(ka,60),!(60===tc.M_.state&&ka)):!0}Qmh(ka,bb){this.Nja.nb(bb)||this.Nja.Z(bb,new Xa);this.Nja.J(bb).handlers.add(ka);ka(bb,this.Nja.J(bb).oldState,this.Nja.J(bb).newState)}q9i(ka,bb){this.Nja.nb(bb)&&this.Nja.J(bb).handlers.contains(ka)&&this.Nja.J(bb).handlers.remove(ka)}static Zti(ka){ka=wa.a.getBaseTypesFor(ka.content);
return Array.contains(ka,Pa.a.getTypeName())}static LGb(ka){if(void 0===ka.content||null===ka.content||""===wb.a.y1a(ka.parentPath))return!1;const bb=wa.a.getBaseTypesFor(ka.content);return Array.contains(bb,va.a.getTypeName())&&ka.annotationType!==La.RoleDetectionAnnotation.getTypeName()}URo(ka){ka?(this.Cse.AugLoop_Text_Critique=ka,ka=this.C$b("AugLoop_Text_Critique")?this.mSb.J("AugLoop_Text_Critique"):null,this.SDj(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Ya.Ei,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}SDj(ka,bb){if(ka&&this.Cse[bb]){const ub=new Qb;ub.token=ka;ub.config=this.Cse[bb];this.eJa&&(this.eJa().updateAnnotationConfig(ub),a.ULS.sendTraceTag(540615553,Ya.Ei,50,"Annotation configuration has been updated for annotation type: {0}.",bb))}}I9i(ka){let bb=null;({value:bb}=this.nD.Dc(ka.id,bb)).returnValue&&(ka.annotationType=bb.annotationType);this.prc.has(ka.id)&&this.prc.delete(ka.id)}RDj(ka,bb,ub,Xb){this.cYn(ka);this.TDj(ka,ub,Xb,bb)&&this.gaa.vGj(ka,ub)}qSa(ka){const bb=
ka.parentPath,ub=Na.a.getTypeName();this.I9i(ka);this.dza(ka,70);this.trc.contains(bb)||this.RDj(ka,bb,ub,!0)}y1l(ka){const bb=new kb.a;ka=this.S5.Dc(ka).value;if(null===ka)return bb;for(const ub of ka)ka=this.nD.Dc(ub).value,null!==ka&&bb.push(ka);return bb}async rnm(){await Object(Pb.b)();this.C9i()}C9i(){const ka=this.y1l(dc.a.getTypeName());for(const bb of ka)this.evi(bb.content)&&this.qSa(bb)}}Ya.Ei=389;Ya.lec="OnAnnotationOperation";Ya.oSi="OnAnnotationLocalStateChange";Ya.S5d="OnAnnotationActivationChange";
Ya.Ebk=20;Object(f.a)(Ya,"AnnotationStorage",null,[733]);class Ob{constructor(){this.bfe=null;this.T7c=!1}}Object(f.a)(Ob,"AugmentationLoopStateManager",null,[731]);var vc=c(197),Sa=c(568),Ab=c(73),Fb=c(102),Va=c(590),Wa=c(231);class jb extends Wa.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}al(){return 102}static construct(ka,bb,ub,Xb,tc,Tc){const Md=new jb;Md.ExpectedEndRevisionId=ka;Md.OriginString=bb;Md.Authorization=ub;Md.AugLoopSeedUrl=Xb;Md.FileId=tc;Md.SeedBatchesInParallelIsEnabled=Tc;Md.AddDocumentKindTypeToPathIsEnabled=!0;Md.CheckOnDemandNodeVersionEnabled=!0;Md.AddSubDocumentKindTypeToPathIsEnabled=!0;return Md}}Object(f.a)(jb,"FullFileAugLoopSeedingRequest",Wa.a,[]);class mc{constructor(){this.authToken=this.url=this.LYi=null}}Object(f.a)(mc,"ReseedingTaskInfo",null,
[]);class yb{constructor(ka,bb,ub,Xb,tc,Tc){this.z$=null;this.VVg=!1;this.TTb=null;this.yPe=0;this.Y1c=(Md,le)=>{Md=le.Paa;this.TTb&&Fb.AT(Md,md=>md===this.TTb)&&(le.httpStatusCode!==vc.a.Jy||le.VH||2!==le.YYf?le.httpStatusCode!==vc.a.Jy||le.VH||1!==le.YYf?this.bej(()=>{a.ULS.sendTraceTag(50861003,yb.Ei,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",le.httpStatusCode,
le.VH,le.YYf,le.Ir)}):(this.RN.T7c=!1,this.z$.OMb(this.Y1c),this.Te.gYk(),a.ULS.sendTraceTag(50861002,yb.Ei,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Md=Object(Ab.a)(mc,this.TTb),this.d5i(le.H7n,Md.LYi,Md.url,Md.authToken)):this.bej(()=>{a.ULS.sendTraceTag(50861001,yb.Ei,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.yAl=Md=>{if(void 0===Md||null===Md||void 0===Md.data||null===Md.data||void 0===Md.data.we||null===Md.data.we)a.ULS.sendTraceTag(41445393,
yb.Ei,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Md.data.Qe!==vc.a.Jy)a.ULS.sendTraceTag(41445394,yb.Ei,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Md.data.Qe);else try{let le;({group:le}=Sa.a.l1(Md.data.we)).returnValue?le.Responses&&le.Responses.length?(Md=null,le&&le.Responses&&le.Responses.length&&(Md=le.Responses[0])?(this.w2.dUa(Md),Md.StatusCode?a.ULS.sendTraceTag(41445398,yb.Ei,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",
Md.StatusCode):a.ULS.sendTraceTag(41445399,yb.Ei,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Md.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,yb.Ei,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,yb.Ei,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):
a.ULS.sendTraceTag(41445395,yb.Ei,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(le){a.ULS.sendTraceTag(41445400,yb.Ei,10,"FileSeedingSuccessCallback: {0}",le.message)}};this.xAl=Md=>{void 0===Md||null===Md||void 0===Md.data||null===Md.data||void 0===Md.data.we||null===Md.data.we?a.ULS.sendTraceTag(41445401,yb.Ei,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,yb.Ei,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",
Md.data.Qe)};this.pWj=ka.$("AugLoopServerSideSeedingIsEnabled");this.nWj=ka.$("AugLoopReseedingIsEnabled");this.oWj=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.U5g=ka.mc("MaxReseedingRetries",1);this.Yf=bb;this.nkd=ub;this.RN=Xb;this.w2=tc;this.Te=Tc;U.App.xa&&U.App.xa.hb&&U.App.xa.hb.Uc&&U.App.xa.hb.Uc.contentReplicator&&(this.z$=U.App.xa.hb.Uc.contentReplicator)}Hzm(ka,bb,ub){if(this.pWj){var Xb=this.RN.bfe;Xb&&Xb.trim().length?this.VVg?this.nWj&&(a.ULS.sendTraceTag(50861E3,yb.Ei,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),
this.yPe=0,this.z$?(this.RN.T7c=!0,this.z$.u0b(this.Y1c),this.TTb=Object.assign(new mc,{LYi:ka,url:bb,authToken:ub}),this.z$.aF(null,null,this.TTb)):a.ULS.sendTraceTag(592814793,yb.Ei,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,yb.Ei,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.d5i(Xb,ka,bb,ub),this.VVg=!0):a.ULS.sendTraceTag(41445391,yb.Ei,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
yb.Ei,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}bej(ka){this.yPe<this.U5g?(a.ULS.sendTraceTag(594384E3,yb.Ei,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.yPe,this.U5g),this.z$.aF(null,null,this.TTb)):(this.RN.T7c=!1,this.z$.OMb(this.Y1c),ka())}d5i(ka,bb,ub,Xb){const tc=jb.construct(ka,bb,Xb,ub,y.AFrameworkApplication.rootQuerySignature,this.oWj);
a.ULS.sendTraceTag(595178454,yb.Ei,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.nkd.i2a.execute(()=>{this.huk(tc)})}huk(ka){a.ULS.sendTraceTag(595178453,yb.Ei,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Yf.tj(U.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Va.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.yAl,this.xAl,ka);a.ULS.sendTraceTag(42016906,
yb.Ei,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}yb.Ei=389;Object(f.a)(yb,"FullFileAugLoopSeedingService",null,[]);class Oa{constructor(){}}Object(f.a)(Oa,"RuntimeManagerInitializationTracker",null,[]);var Gb=c(698);class Wb{getAugLoopRuntimeManager(){return Gb.a.getAugLoopRuntimeManager()}}Object(f.a)(Wb,"AlFactoryWrapper",null,[730]);class kc{$k(){return wb.a.$k()}}Object(f.a)(kc,"UtilsWrapper",null,[729]);var Mb=c(742),Qc=c(53),Ic=c(15),Ed=c(42),me=c(145),Be=c(2024),
ad=c(5),Nc=c(101),Sc=c(214),Gc=c(28),ie=c(351),cf=c(392),Ge=c(92),gf=c(48);class Ie{constructor(ka,bb,ub,Xb,tc){this.Ma=ka;this.If=ub;this.Xo=Xb;this.ve=tc;this.roa=this.Ma.$("WordDesignerCaptionDetectionEnabled")}Mho(ka,bb){ka.listType=this.q1l(bb);ka.outlineLevel=Ua.ParagraphReader.Ena(bb);ka.indentation=Ie.Iqf(this.Xo.$T(bb));ka.alignment=Ie.Rmf(Ua.ParagraphReader.Ex(bb));ka.isInsideTable=this.isInsideTable(bb);ka.isInsideTOC=bb.ur;ka.rightIndentation=Ie.Iqf(this.Xo.t1a(bb));var ub=this.Xo.z8b(bb);
ka.specialIndentType=Ie.kcm(ub);ka.specialIndentBy=Ie.Iqf(ub);ka.listType!==Be.e.NoList&&this.rjo(bb,ka);this.qmo(bb,ka);ub=[];this.roa&&(ub=this.VGn(bb));ka.formattedRanges=this.iXl(bb,ub);this.roa&&null!=ub&&(ka.objectReferences=0<ub.length?ub:void 0)}iXl(ka,bb){var ub=ka.pa?ka.pa.length:0,Xb=Nc.FormattingReader.Kr(Gc.a.create(ka));let tc=Ge.a.kG,Tc=0,Md=Ge.a.nM/2;Xb&&(Md=Nc.FormattingReader.Rn(Xb,Ic.a.fontSize,Ge.a.nM)/2,tc=Nc.FormattingReader.Rn(Xb,Ic.a.font,Ge.a.kG),Tc=Nc.FormattingReader.language(Xb));
Xb="Normal";var le=this.ve.No(ka);le&&(Xb=le.getValue(Ed.a.ka)||"Normal",le.hasProperty(Ic.a.font)&&(tc=le.getValue(Ic.a.font)));if(ub){--ub;le=[];let gh=null,gl=void 0,Al=null;this.roa&&ka.hasProperty(Ic.a.Hn)&&(Al=ka.getValue(Ic.a.Hn));const Pm=ka.properties.ia(qa.a.Yfa,null);for(let ck=0;ck<ub;ck++){var md=ka.pa.J(ck),Ee=ka.Jc,ef=null;this.roa&&(ef=Ie.Kuf(ka,Al,ck));md.tf&&(gh=Ie.qTo(Ee,md.tf,gh));md.hyperlink&&md.hyperlink.url?gl=md.hyperlink.url:md.Pm&&(gl=void 0);var Wf=ka.pa.J(ck+1).cp-1;Ee=
md.cp;Wf=Wf-md.cp+1;let Zf=!1,qk=!1,vn=!1,zh=Md,Qm=0,Hl=0,en=Xb,mi=void 0,um=Tc,fn=tc,im;if(md.formatting){var Ag=md.formatting;Zf=Nc.FormattingReader.Rn(Ag,Ic.a.bold,!1);qk=Nc.FormattingReader.Rn(Ag,Ic.a.italic,!1);vn=Nc.FormattingReader.Rn(Ag,Ic.a.underline,!1);zh=Nc.FormattingReader.Rn(Ag,Ic.a.fontSize,2*Md)/2;Qm=Nc.FormattingReader.Rn(Ag,Ed.a.capitalization,0);Hl=Nc.FormattingReader.Rn(Ag,Ic.a.fontColor,0);um=Nc.FormattingReader.language(Ag)||Tc;fn=Nc.FormattingReader.Rn(Ag,Ic.a.font,tc);en=Xb;
var Dh=Ag.yn;Dh&&(Dh=Dh.ia(Ed.a.hw,null))&&!Dh.equals(la.a.nil)&&Ag.paragraph.Jc&&(Ag=Ag.paragraph.Jc.Db(Dh))&&(en=(new Sc.a(Ag)).getValue(Ed.a.ka))}this.roa&&(im=this.fsf(ef),null!=im&&this.Soh(bb,ef,im,le.length,Be.b.Inline));gh&&(mi=0<gh.count);md={isDeleted:this.WHm(Pm,md,ck,gl),fontFamily:fn,fontWeight:Zf?Be.d.Bold:Be.d.Normal,fontSize:zh,italic:qk,underline:vn?Be.h.SingleLine:Be.h.None,capitalization:Ie.NIh(Qm),color:Hl,styleName:en,isFollowUp:mi,languageId:Ie.DIh(um),start:Ee,length:Wf,link:gl,
isReference:Ie.isReference(md)?!0:void 0,objectType:null!==im&&void 0!==im?im:void 0};ef=0<le.length?le[le.length-1]:void 0;Ie.fSk(ef,md)?ef.length+=md.length:le.push(md)}return le}return[{fontFamily:tc,fontWeight:Be.d.Normal,fontSize:Md,italic:!1,underline:Be.h.None,capitalization:Ie.NIh(0),color:0,styleName:Xb,isFollowUp:void 0,languageId:Ie.DIh(Tc),start:0,length:ka.characterData.length}]}WHm(ka,bb,ub,Xb){if(this.AB()){if(bb.blob||bb.formatting&&bb.formatting.cache&&bb.formatting.cache.tHb||Xb)return!0;
if(ka&&ub<ka.length)return ka[ub]}return gf.a.Pj&&bb.gR?!0:bb.gi?!0:!1}AB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static fSk(ka,bb){return!!ka&&!!bb&&ka.start+ka.length===bb.start&&ka.isDeleted===bb.isDeleted&&ka.fontFamily===bb.fontFamily&&ka.fontWeight===bb.fontWeight&&ka.fontSize===bb.fontSize&&ka.italic===bb.italic&&ka.underline===bb.underline&&ka.capitalization===bb.capitalization&&ka.color===
bb.color&&ka.highlightColor===bb.highlightColor&&ka.styleName===bb.styleName&&void 0===ka.link&&void 0===bb.link&&ka.languageId===bb.languageId&&!ka.isReference&&!bb.isReference&&!ka.isFollowUp&&!bb.isFollowUp&&void 0===ka.objectType&&void 0===bb.objectType}q1l(ka){const bb=new ad.GraphIterator;bb.set(ka);bb.zb(11);bb.jd(11);return(ka=this.If.lw(bb))?Ie.u6k(ka.listType):Be.e.NoList}rjo(ka,bb){var ub=this.If.LC(ka);ub&&(ub.hasProperty(qa.a.listID)&&(bb.listId=ub.getValue(qa.a.listID).toString()),ub=
this.rai(ka,Ic.a.font),ka=this.rai(ka,Ic.a.fontSize),ub&&(bb.bulletAndNumberFontFamily=ub),ka&&(bb.bulletAndNumberFontSize=ka))}isInsideTable(ka){const bb=new ad.GraphIterator;bb.set(ka);return bb.zb(14)}qmo(ka,bb){bb.spacingBeforeParagraph=this.egi(ka,qa.a.R4,qa.a.xY,qa.a.Ji);bb.spacingAfterParagraph=this.egi(ka,qa.a.Q4,qa.a.wY,qa.a.sa);bb.lineSpacing=this.BEb(ka)}egi(ka,bb,ub,Xb){if(Ua.ParagraphReader.Rn(ka,bb,!1))return 0;bb=Ua.ParagraphReader.Rn(ka,ub,-1);if(0<=bb)return bb*ie.a.XKb/100;ka=Ua.ParagraphReader.Rn(ka,
Xb,-1);return 0<=ka?ka/20:0}rai(ka,bb){ka=this.oUl(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(bb)}oUl(ka){var bb;ka=null===(bb=ka.pa)||void 0===bb?void 0:bb.last;return null!=ka&&ka.Uh?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}BEb(ka){const bb=Ua.ParagraphReader.Rn(ka,qa.a.ya,ie.a.ya);ka=Ua.ParagraphReader.Rn(ka,qa.a.ua,ie.a.lineSpacing);switch(bb){case 0:return ka/240;case 1:return ka/20;default:return 0}}static qTo(ka,
bb,ub){for(let Xb=0;Xb<bb.length;Xb++){const tc=bb.J(Xb),Tc=tc.Xj,Md=ka.Db(Tc);Md&&Md.ia(qa.a.DG,!1)&&(ub||(ub=new za.a(new cf.a)),tc.Mc?ub.add(Tc):ub.remove(Tc))}return ub}static DIh(ka){return(ka=Mb.a.og(ka))&&ka.name?ka.name.toLowerCase():void 0}static Iqf(ka){return ka?2===ka.unit?Math.floor(Qc.a.sAb(ka.value)/20):Math.floor(ka.value/20):0}static kcm(ka){if(!ka)return Be.g.Initial;switch(ka.specialIndentType){case 1:return Be.g.FirstLine;case 2:return Be.g.Hanging;default:return Be.g.Initial}}static NIh(ka){switch(ka){case 2:return Be.c.AllCaps;
case 1:return Be.c.SmallCaps;default:return Be.c.NoCaps}}static Rmf(ka){switch(ka){case 1:return Be.a.Left;case 3:return Be.a.Right;case 2:return Be.a.Center;case 6:return Be.a.Justified;case 0:return Be.a.None;default:return Be.a.Other}}static u6k(ka){switch(ka){case 15:return Be.e.Any;case 1:return Be.e.Bullet;case 42:return Be.e.Invalid;case 13:return Be.e.Lim;case 14:return Be.e.Nil;case 16:return Be.e.NoList;case 0:return Be.e.Numbered;default:return Be.e.Invalid}}static isReference(ka){return ka.blob&&
(7===ka.blob.Bh||10===ka.blob.Bh)||ka.Gh&&0<ka.Gh.length||ka.tf&&0<ka.tf.length||ka.Jb&&0<ka.Jb.length?!0:!1}static Kuf(ka,bb,ub){return null==bb?null:bb[ub]&&!bb[ub].equals(la.a.nil)&&ka.Jc?ka.Jc.Db(bb[ub]):null}fsf(ka){if(null==ka)return null;if(ka.hasProperty(qa.a.gt)){var bb=ka.getValue(qa.a.gt);if(Ie.Y0i.has(bb))return Ie.Y0i.get(bb)}if(ka.hasProperty(qa.a.u6b)&&null!=ka.getValue(qa.a.u6b))return Be.f.FootnoteEndnote;if(ka.hasProperty(qa.a.pageBreak)&&ka.getValue(qa.a.pageBreak))return Be.f.PageBreak;
if(ka.hasProperty(qa.a.YHb)&&ka.getValue(qa.a.YHb))return Be.f.Tab;bb=!1;ka.hasProperty(me.a.e4)?bb=ka.getValue(me.a.e4):ka.hasProperty(qa.a.lha)&&(bb=ka.getValue(qa.a.lha));return bb&&ka.hasProperty(qa.a.imageType)&&1==ka.getValue(qa.a.imageType)?Be.f.Image:null}static MKm(ka){return ka.hasProperty(qa.a.m9b)&&0<=ka.getValue(qa.a.m9b)?!0:!1}CBi(ka){return Ie.QDo.has(ka)}SLh(ka,bb,ub,Xb){return null==ka||null==bb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),
null):Xb===Be.b.Inline&&null==ub?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Xb===Be.b.Floating&&null!=ub?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>ub?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Ie.MKm(ka)?null:this.CBi(bb)?{referencedPath:["session",
"doc","main",ka.id.toString()],formattedRangeIndex:ub,anchorMode:null!==Xb&&void 0!==Xb?Xb:Be.b.Unspecified,anchoredObjectType:Xb==Be.b.Floating?bb:void 0}:null}Soh(ka,bb,ub,Xb,tc){bb=this.SLh(bb,ub,Xb,tc);null!=bb&&null!=ka&&ka.push(bb)}VGn(ka){const bb=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),bb;let ub=null;ka.hasProperty(qa.a.m7)&&(ub=ka.getValue(qa.a.m7));if(null!=ub)for(let Xb=0;Xb<ub.length;++Xb){const tc=Ie.Kuf(ka,
ub,Xb),Tc=this.fsf(tc);null!=Tc&&this.Soh(bb,tc,Tc,null,Be.b.Floating)}return bb}EHh(ka){if(null==ka||!ka.hasProperty(Ic.a.Hn))return!1;const bb=ka.getValue(Ic.a.Hn);for(let Xb=0;Xb<bb.length;Xb++){var ub=Ie.Kuf(ka,bb,Xb);ub=this.fsf(ub);if(this.CBi(ub))return!0}return!1}}Ie.Y0i=new Map([[5,Be.f.Image],[11,Be.f.TextBox],[7,Be.f.Chart],[6,Be.f.SmartArt],[10,Be.f.Drawing],[2,Be.f.EquationObject],[4,Be.f.Ink],[19,Be.f.PageBreak],[23,Be.f.FootnoteEndnote],[24,Be.f.FootnoteEndnote],[35,Be.f.FootnoteEndnoteReferenceMark],
[36,Be.f.FootnoteEndnoteReferenceMark],[0,Be.f.Other]]);Ie.QDo=new Set([Be.f.Image,Be.f.TextBox,Be.f.Chart,Be.f.SmartArt,Be.f.Drawing,Be.f.Ink]);Object(f.a)(Ie,"FormattingExtractor",null,[728]);var zf=c(1211);class uc extends Sys.EventArgs{constructor(ka){super();this.h9b=ka}}Object(f.a)(uc,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Rc extends Sys.EventArgs{constructor(ka){super();this.H8=ka}}Object(f.a)(Rc,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Dd{constructor(ka,bb,ub){this.IZc=
ka;this.graphNode=bb;this.fullPath=ub}}Object(f.a)(Dd,"NodeEvent",null,[743]);class Id{constructor(){this.BEe=this.lCe=!1;this.Rub=null;this.ra=new pa.a;this.Y$=new M.a(0);this.P$a=new zf.a(Fa.a.ai());this.Dvb=new zf.a(Fa.a.ai());this.hpd=[]}qph(ka){this.ra.addHandler("IsCollectingNodeEventsChangedKey",ka)}NXk(){this.Y$=new M.a(0);this.h9b=!1}get h9b(){return this.lCe}set h9b(ka){this.lCe!==ka&&(this.lCe=ka,this.ra.raiseEvent("HasNodeEventsChangedKey",new uc(ka),this))}get H8(){return this.BEe}set H8(ka){this.BEe!==
ka&&(this.BEe=ka,this.ra.raiseEvent("IsCollectingNodeEventsChangedKey",new Rc(ka),this))}BNb(ka,bb){this.P$a.nb(ka)||this.P$a.Z(ka,bb)}j$n(ka,bb){this.Dvb.Z(ka,bb)}OLl(ka){let bb=null;this.Dvb.nb(ka)&&(bb=this.Dvb.J(ka),this.Dvb.remove(ka));return bb}oce(ka,bb){if(ka)if(this.H8){var ub=3!==bb&&4!==bb&&5!==bb||!this.P$a.nb(String.format("{0}",ka.id))?wb.a.tM(ka):this.P$a.J(String.format("{0}",ka.id));if(({value:Xb}=this.Y$.Dc(ub)).returnValue)if(Xb||3!==bb)if(5===Xb&&3===bb){if(ka=ub.split("\\").pop(),
this.Dvb.nb(ka)){var Xb=this.Dvb.J(ka);Xb===ub?(this.TKf(ub,bb),this.Y$.add(ub,bb)):(this.Dvb.Z(ka,ub),this.P$a.Z(ka,Xb),this.qKi(ub),this.Y$.remove(ub),this.TKf(ub,bb),this.Y$.add(Xb,5))}}else Xb&&(4!==Xb||0!==bb&&3!==bb&&5!==bb)&&(this.TKf(ub,bb),this.Y$.add(ub,bb));else this.qKi(ub),this.Y$.remove(ub);else this.C7m(ub,bb),this.hpd.push(ka),this.Y$.add(ub,bb);this.h9b=0<this.Y$.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,
389,15,"node is null.")}C7m(ka,bb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,bb)}TKf(ka,bb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,bb)}qKi(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}N3k(){let ka=null;var bb=!1;let ub=null;for(;this.hpd.length&&!bb;){ub=Array.dequeue(this.hpd);if(!ub)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.P$a.nb(String.format("{0}",ub.id))?(ka=this.P$a.J(String.format("{0}",ub.id)),this.P$a.remove(String.format("{0}",ub.id)),this.hpd.push(ub)):ka=wb.a.tM(ub);bb=this.Y$.nb(ka)}if(!bb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.NXk(),null;bb=this.Y$.J(ka);this.Y$.remove(ka);this.h9b=0<this.Y$.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,bb);return new Dd(bb,ub,ka)}xRn(ka){this.Rub=ka}O3k(){if(!this.Rub)return null;
for(var ka=0;ka<this.Rub.length;ka++){var bb=this.Rub.J(ka);bb=wb.a.tM(bb.node);if(this.Y$.nb(bb))return null}ka=this.Rub;this.Rub=null;return ka}eYk(){this.Rub=null}JAo(){this.H8=!0}mJm(ka){return this.Y$.nb(ka.id.toString())}}Object(f.a)(Id,"NodeEventsCollection",null,[727]);var Kd=c(1477),af=c(1405),Dg=c(286),oi=c(107);class zg extends af.a{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef){super();this.Dkd=new Kd.a;this.A$a=!1;this.fsc=null;this.Yha=(Wf,Ag)=>{(Wf=Ag.node)&&this.H6a(Wf)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),wb.a.Qro(Wf,this.Rka.H8,this.xSb,this.Jhk)&&(this.Rka.oce(Wf,0),this.WEj(Wf)));this.Rka.H8&&this.gaa.hmb(Wf)};this.zSi=(Wf,Ag)=>{Wf=Ag.node;this.Rka.BNb(String.format("{0}",Wf.id),wb.a.tM(Wf))};this.CKb=(Wf,Ag)=>{(Wf=Ag.node)&&this.H6a(Wf)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Rka.H8&&this.Rka.oce(Wf,3));this.Rka.H8&&this.gaa.AVi(Wf,3)};this.uY=(Wf,Ag)=>{Wf=Ag.node;Ag=Ag.property;Wf&&this.LVj.has(Ag)&&this.H6a(Wf)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.Rka.H8&&(this.Rka.oce(Wf,2),Ag===qa.a.sj&&this.WEj(Wf)));this.Rka.H8&&Ag===qa.a.Lc&&this.gaa.AVi(Wf,2)};this.ASi=(Wf,Ag)=>{(Wf=Ag.node)&&Ua.ParagraphReader.Vb(Wf)&&!this.Jrc.has(Wf)&&!this.yze.has(Wf)&&(this.Jrc.add(Wf),this.rY())};this.CVi=(Wf,Ag)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Wf=Ag.node)&&this.Te.Zjn(Wf)};this.UQf=()=>{this.V7c()?this.XM():this.A$a&&!this.Rka.H8&&this.cza()};this.mC=bb;this.Rka=ub;this.Jhk=oi.b(Xb.bfe);
this.xSb=ka.$("AugLoopOperationsAreEnabled");this.Te=tc;this.gaa=Tc;this.eC=Md;this.Hb=le;this.Fm=md;this.IF=Ee;this.Jrc=new Set;this.yze=new Set;ef.gqa(this,7);this.LVj=new Set([Ic.a.mo,Ic.a.bold,Ic.a.italic,Ic.a.underline,Ic.a.font,Ic.a.fontSize,Ic.a.fontColor,Ed.a.capitalization,Ic.a.Kh,Ic.a.Hn,qa.a.R4,qa.a.xY,qa.a.Ji,qa.a.Q4,qa.a.wY,qa.a.sa,qa.a.ya,qa.a.ua,qa.a.listID,qa.a.SM,qa.a.$d,qa.a.iia,qa.a.hu,qa.a.sj])}get index(){return 7}get R_c(){return this.fsc}set R_c(ka){this.fsc=ka;this.gaa.ZUf=
ka?()=>{this.fsc()}:null}init(){this.V7c()&&this.XM();this.Rka.qph(this.UQf)}XM(){this.mC?(this.A$a=!0,this.mC.Vt(this.Yha),this.mC.hT(this.zSi),this.mC.Ow(this.CKb),this.mC.Go(this.uY),this.mC.Yph(this.CVi),this.mC.Iwk(this.ASi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}cza(){this.mC?(this.A$a=!1,this.mC.VU(this.Yha),this.mC.Tca(this.zSi),this.mC.Dia(this.CKb),this.mC.WU(this.uY),this.mC.Daj(this.CVi),this.mC.e0n(this.ASi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}zVd(ka){ka&&this.Dkd.add(ka.id,ka.ia(qa.a.sj,0))}WEj(ka){this.Dkd.nb(ka.id)?(this.gaa.KYo(fa.a.Xie,ka,this.Dkd.J(ka.id)),this.Dkd.remove(ka.id)):(this.gaa.ZXk(fa.a.Xie),this.R_c&&this.R_c())}H6a(ka){const bb=U.App.xa.hb.rc;return!!bb&&bb.hv&&!!bb.Yc&&!!bb.Yc.Jc&&!!ka&&!!ka.Jc&&ka.Jc.id===bb.Yc.Jc.id}run(){if(0!==this.Jrc.size){var ka=[];for(const bb of this.Jrc)ka.push(bb),this.yze.add(bb),100<=ka.length&&(this.FVh(ka),
ka=[]);0<ka.length&&this.FVh(ka);this.Jrc.clear()}}FVh(ka){const bb=new ra.a(4,1,500,()=>{for(const ub of ka)this.yze.delete(ub),this.updateAnnotationRangeData(ub)},158);this.Hb.Wb(bb)}updateAnnotationRangeData(ka){var bb=this.Fm.$Oa(ka,0,Xb=>this.vto(Xb.intent));if(0<bb.count)for(const Xb of bb){bb=this.gaa.V9l(Xb.intent.id);var ub=ka.Wma;const tc=Ua.ParagraphReader.RQ(ka);Xb.end<Xb.begin||(ub=Dg.a.pIc(tc,ub,Xb.begin,Xb.end-Xb.begin,Xb.begin,Xb.end-Xb.begin,ka),this.IF.z4f(ka.Jc,bb,ub))}}vto(ka){return!!ka&&
this.eC.Ojb(ka)&&!!ka.content}V7c(){return!this.A$a&&this.Rka.H8}}Object(f.a)(zg,"ParagraphNodeEventHandler",af.a,[723]);var ec=c(1008),Bc=c(397),Vc=c(450),xd=c(100);class ee extends Vc.a{constructor(){super();this.H_=Object.assign(new xd.a,{T_:ee.getTypeName(),B_:ee.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(f.a)(ee,"DeltaUpdateOperation",Vc.a,[]);var Me=c(368);class De{constructor(){this.referencedPath=
null}}Object(f.a)(De,"ItemReference",null,[]);class oe extends Me.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(f.a)(oe,"ItemWithPath",Me.a,[]);var nf=c(980);class Qe extends nf.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new xd.a,{T_:Qe.getTypeName(),B_:Qe.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(f.a)(Qe,
"MoveOperation",nf.a,[]);var of=c(440);class mf extends of.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new xd.a,{T_:mf.getTypeName(),B_:mf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(mf,"SelectionSignal",of.a,[]);class jg extends mf{constructor(){super();this.content=null;this.H_=Object.assign(new xd.a,{T_:jg.getTypeName(),B_:jg.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(f.a)(jg,"SelectionContentSignal",mf,[]);class pf{constructor(){this.range=this.tileReference=null}}Object(f.a)(pf,"TextTileRange",null,[]);var xb=c(1664),Tb=c(331),Xc=c(36),Fd=c(17);class Se{constructor(ka,bb,ub,Xb,tc,Tc,Md,le){this._augLoopRuntimeManager=this.Oid=null;this.MRe=!1;this.jla=this.YHe=this.Otd=null;this.wDl=()=>{if(U.App.lostSession||Bc.SessionStatusManager.instance&&Bc.SessionStatusManager.instance.Ao)y.AFrameworkApplication.te("a596e684;c81e6109"),
y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(Gb.a.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Hb.We(this.Oid));this.si.he(()=>{var md;const Ee=rb.a.instance.I3;this.AB()&&this.n4n();for(this.PBc.reset();this.UWa.h9b&&!this.PBc.vlb();){let Ag;Ag=this.UWa.N3k();if(!Ag||!Ag.graphNode){a.ULS.sendTraceTag(41719901,389,15,
"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.PBc.update();continue}if(!this.wro(Ag)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",Ag.graphNode.id);this.PBc.update();continue}const Dh=Ag.graphNode.id.toString();var ef=-1,Wf=!0;Ee&&Fd.SelectionEditor.gf(Ee)&&Dh==Ee.node.id.toString()&&(ef=Ee.cpBegin,Wf=!1);let gh=null;if(this.lxb.contains(Dh))switch(Ag.IZc){case 3:this.lxb.remove(Dh);gh=3;break;default:gh=
Ag.IZc}else switch(Ag.IZc){case 0:case 1:this.lxb.add(Dh);gh=0;break;case 2:this.lxb.add(Dh);gh=0;break;case 3:this.lxb.remove(Dh);gh=3;break;default:gh=Ag.IZc}if(null!=gh){ef=this.kci(Ag.graphNode,Ag.fullPath,gh,ef,Wf);if(4==gh||5==gh){if(ef.prevParentPath.join()!==ef.parentPath.join()){Wf=Object.assign(new Na.a,{parentPath:ef.prevParentPath,items:ef.items});const gl=Object.assign(new Ka.a,{parentPath:ef.parentPath,items:ef.items,prevId:ef.prevId,nextId:ef.nextId});Dh!==ef.prevId&&Dh!==ef.nextId||
a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",gh,Dh,ef.prevId,ef.nextId,Ag.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:Wf}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:gl}));14===Ag.graphNode.type&&this.hij(Ag.graphNode,ef.parentPath).forEach(Al=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,
{operation:Al}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:ef}));if(this.wed&&this.jla&&this.jla[0]==Dh)switch(gh){case 3:this.jla=null;break;case 0:case 1:case 2:case 4:case 5:this.jla[1]=null===(md=this.Fvb.KEb(Ag.graphNode))||void 0===md?void 0:md.zNc(Ag.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",wa.a.getTypeNameFor(ef),Dh);switch(gh){case 0:case 4:case 5:this.Te.Utn(Ag.graphNode);
break;case 3:this.Te.Vtn(Ag.graphNode,ef.parentPath.join("\\"))}}this.PBc.update()}(md=this.UWa.O3k())&&this.gcj(md)},"TV:FPEFO")};this.Lpa=(md,Ee)=>{var ef;if(Ee.nl&&Ee.nl.length){if(this.wed)if(md=wb.a.j4l(Ee.nl),!md)this.jla=null;else if(!this.jla||this.jla[0]!=md.id.toString()){const Wf=this.UWa.mJm(md)?null:null===(ef=this.Fvb.KEb(md))||void 0===ef?void 0:ef.zNc(md);this.jla=[md.id.toString(),Wf]}this.MRe&&this.UWa.xRn(Ee.nl.kb)}};this.Ma=ka;this.UWa=bb;this.Hb=ub;this.PBc=Xb;this.mWj=this.Ma.$("AugLoopOperationsAreEnabled");
this.lxb=new za.a(Fa.a.ai());this.Te=tc;this.si=Tc;this.Fvb=Md;this.ib=le;this.wed=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.Pw(this.Lpa);wb.a.$k().then(()=>{this._augLoopRuntimeManager=Gb.a.getAugLoopRuntimeManager();y.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ma.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new xb.a,
{handler:md=>{this.Te.NBk(md)}}));this.mWj&&this.UWa.JAo();this.ABo()}).catch(()=>{})}n4n(){const ka=this.Te.prc.entries();for(let bb=0;bb<this.Te.prc.size;bb++){const ub=ka.next();2E3<=Date.now()-ub.value[1].time&&this.Te.hwf(ub.value[1].annotation,!0,Ka.a.getTypeName(),!1)}}wro(ka){return 3===ka.IZc||wb.a.yqj(ka.graphNode)}ABo(){!this.Oid&&this.UWa.H8&&(this.Oid=new ra.a(4,2,this.Ma.mc("NodeEventsFiringInterval",500),this.wDl,131),this.Hb.Wb(this.Oid))}hij(ka,bb){var ub,Xb=[];const tc=ad.GraphIterator.$a(ka),
Tc=tc.xq();for(var Md=0;Md<Tc;Md++){let le=tc.zG(Md);11===le.type&&(le=Xc.OutlineElementNavigator.Ge(tc));const md=le.id.toString(),Ee=null===(ub=this.Fvb.KEb(le))||void 0===ub?void 0:ub.ZAb(le);Xb.push(Object.assign(new Me.a,{body:Ee,id:md,revId:wb.a.Quf(le)}));tc.jd(ka.type)}bb.push(ka.id.toString());ub=[];ub.push(Object.assign(new Ka.a,{parentPath:bb.slice(),items:Xb,prevId:null}));for(Xb=0;Xb<Tc;Xb++)Md=tc.zG(Xb),11===Md.type&&(Md=Xc.OutlineElementNavigator.Ge(tc)),0<tc.xq()&&(ub=ub.concat(this.hij(Md,
bb))),tc.jd(ka.type);bb.pop();return ub}dPa(ka){return ka.split("\\").slice(0,-1)}kci(ka,bb,ub,Xb=-1,tc=!0){var Tc;let Md=null,le=null;const md=ka.id.toString();var Ee=null;3!==ub&&(Ee=wb.a.xOk(ka));if(Ee)for(let ef=0;ef<Ee.length;ef++)if(Ee[ef]===md){le=ef+1<Ee.length?Ee[ef+1]:null;Md=ef?Ee[ef-1]:null;break}md!==Md&&md!==le||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",ub,md,Md,le,
ka.type);Ee=null===(Tc=this.Fvb.KEb(ka))||void 0===Tc?void 0:Tc.ZAb(ka,Xb,tc);Xb=[Object.assign(new Me.a,{body:Ee,id:md,revId:wb.a.Quf(ka)})];switch(ub){case 0:case 1:return Object.assign(new Ka.a,{parentPath:this.dPa(bb),items:Xb,prevId:Md,nextId:le});case 4:return Object.assign(new Qe,{parentPath:this.dPa(wb.a.tM(ka)),prevParentPath:this.dPa(bb),items:Xb,prevId:Md,nextId:le});case 5:return ub=this.UWa.OLl(md),Object.assign(new Qe,{parentPath:this.dPa(null!==ub&&void 0!==ub?ub:wb.a.tM(ka)),prevParentPath:this.dPa(bb),
items:Xb,prevId:Md,nextId:le});case 2:return Object.assign(new sa.a,{parentPath:this.dPa(bb),items:Xb});case 3:return Object.assign(new Na.a,{parentPath:this.dPa(bb),items:Xb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",ub,md),Object.assign(new nf.a,{parentPath:this.dPa(bb),items:Xb,prevId:Md,nextId:le})}}bgm(ka){return this.jla&&this.jla[0]===ka?this.jla[1]:null}Hdo(ka){var bb;if(!this.wed)return a.ULS.sendTraceTag(545552581,
389,10,"sendTile: autoreplace is not enabled"),!1;if(!wb.a.yqj(ka))return!1;const ub=ka.id.toString();var Xb=this.lxb.contains(ub)?2:0;Xb=this.kci(ka,wb.a.tM(ka),Xb);this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:Xb}));this.lxb.add(ub);this.jla=[ub,null===(bb=this.Fvb.KEb(ka))||void 0===bb?void 0:bb.zNc(ka)];return!0}uco(ka,bb){var ub;if(this.wed){var Xb=ka.id.toString(),tc=this.dPa(wb.a.tM(ka));bb=[Object.assign(new oe,{id:Xb,revId:wb.a.Quf(ka),parentPath:tc,delta:bb})];
tc=Object.assign(new ee,{parentPath:tc,items:bb});this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:tc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Xb);this.jla=[Xb,null===(ub=this.Fvb.KEb(ka))||void 0===ub?void 0:ub.zNc(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}nGk(ka,bb){if(ka.tileReference.referencedPath.length!==bb.tileReference.referencedPath.length||ka.range.start!==bb.range.start||ka.range.length!==
bb.range.length)return!1;for(let ub=0;ub<ka.tileReference.referencedPath.length;ub++)if(ka.tileReference.referencedPath[ub]!==bb.tileReference.referencedPath[ub])return!1;return!0}iGk(ka,bb){if(ka.selectedRanges.length!==bb.selectedRanges.length||ka.content!==bb.content)return!1;for(let ub=0;ub<ka.selectedRanges.length;ub++)if(!this.nGk(ka.selectedRanges[ub],bb.selectedRanges[ub]))return!1;return!0}gcj(ka){var bb;if(ka){var ub=new kb.a,Xb="";for(let Md=0;Md<ka.length;Md++){var tc=ka.J(Md),Tc=(null===
(bb=this.Fvb.KEb(tc.node))||void 0===bb?void 0:bb.ZAb(tc.node)).content;Xb+=Tc;Tc=tc.cpBegin<Tc.length?tc.cpBegin:-1;Tc=Object.assign(new ha.a,{start:Tc,length:tc.cpEnd-tc.cpBegin});const le=tc.node.id.toString();tc=this.dPa(wb.a.tM(tc.node));tc.push(le);ub.add(Object.assign(new pf,{range:Tc,tileReference:Object.assign(new De,{referencedPath:tc})}))}ka=Object.assign(new jg,{selectedRanges:ub.toArray(),content:Xb});this.YHe&&this.iGk(ka,this.YHe)||(bb=this.Otd?this.Otd:la.a.create().toString(),ub=
[Object.assign(new Me.a,{body:ka,id:bb})],this.Otd?bb=Object.assign(new sa.a,{parentPath:["session","doc"],items:ub}):(this.Otd=bb,bb=Object.assign(new Ka.a,{parentPath:["session","doc"],items:ub})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:bb})),this.YHe=ka)}}jmo(ka){(this.MRe=ka)?this.gcj(this.ib.gb.kb):this.UWa.eYk()}AB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}
Object(f.a)(Se,"TileView",null,[726]);var pd=c(41),lf=c(98);class Ze{constructor(ka){lf.a.assign(Ze,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return lf.a.matchesTypesFor(ka,[Ze.getTypeName()])}}Ze.H_={T_:Ze.getTypeName(),B_:Ze.getBaseTypes()};class Vg{constructor(ka){lf.a.assign(Vg,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return lf.a.matchesTypesFor(ka,[Vg.getTypeName()])}}
Vg.H_={T_:Vg.getTypeName(),B_:Vg.getBaseTypes()};class Pi{constructor(ka){lf.a.assign(Pi,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return lf.a.matchesTypesFor(ka,[Pi.getTypeName()])}}Pi.H_={T_:Pi.getTypeName(),B_:Pi.getBaseTypes()};class Sh{constructor(ka){lf.a.assign(Sh,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return lf.a.matchesTypesFor(ka,
[Sh.getTypeName()])}}Sh.H_={T_:Sh.getTypeName(),B_:Sh.getBaseTypes()};class wh{constructor(ka){lf.a.assign(wh,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ka){return lf.a.matchesTypesFor(ka,[wh.getTypeName()])}}wh.H_={T_:wh.getTypeName(),B_:wh.getBaseTypes()};var rm;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(rm||(rm={}));var xf;(function(ka){ka[ka.none=
0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.noHBand=512]="noHBand";ka[ka.noVBand=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.defaultLook=1184]="defaultLook"})(xf||(xf={}));Object(f.b)("TableLookFlags",xf);class lg{ZAb(ka){if(ka)switch(ka.type){case 14:return this.Ldl(ka);case 15:return new Ze;case 16:return this.Kdl(ka)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}Ldl(ka){var bb=ka.eG||[];let ub=0;for(let Xb=0;Xb<bb.length;Xb++)ub+=bb[Xb];bb=bb.map((Xb,tc)=>({columnId:tc.toString(),widthPercent:0!=ub?100*Xb/ub:0}));return new Sh({columnDefs:bb,tableLook:ka.properties.ia(qa.a.tableLook,xf.defaultLook),complexTable:ka.properties.ia(qa.a.complexTable,!1),floatingTable:ka.properties.ia(qa.a.Fwi,!1)})}Kdl(ka){return new Vg({rowspan:ka.properties.ia(qa.a.rowSpan,1),colspan:ka.properties.ia(qa.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ia(qa.a.GPb,
0),size:ka.properties.ia(qa.a.Hkc,4),style:ka.properties.ia(qa.a.wpb,"single")},leftBorder:{color:ka.properties.ia(qa.a.EPb,0),size:ka.properties.ia(qa.a.Fkc,4),style:ka.properties.ia(qa.a.upb,"single")},rightBorder:{color:ka.properties.ia(qa.a.FPb,0),size:ka.properties.ia(qa.a.Gkc,4),style:ka.properties.ia(qa.a.vpb,"single")},bottomBorder:{color:ka.properties.ia(qa.a.DPb,0),size:ka.properties.ia(qa.a.Ekc,4),style:ka.properties.ia(qa.a.tpb,"single")}},verticalAlignment:ka.properties.ia(qa.a.Gqa,rm.Top),
ghostCell:ka.properties.ia(qa.a.ghostCell,!1),renderCell:ka.properties.ia(qa.a.renderCell,!1),skippedCell:ka.properties.ia(qa.a.skippedCell,!1),fillColor:ka.properties.ia(Ic.a.yH,0),verticalMerge:ka.properties.ia(pd.a.vMerge,null)})}zNc(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(f.a)(lg,"TableElementNodeToTileConverter",null,[724]);class nd{constructor(ka,bb,ub){this.Oo=bb;this.Pya=ub;this.EKd=!1;this.fsc=null;this.uXi=(Xb,tc)=>{this.$xa(tc.node,0)};this.qXi=(Xb,tc)=>{Xb=tc.node;
this.Pya.BNb(Xb.id.toString(),wb.a.tM(Xb))};this.vXi=(Xb,tc)=>{this.$xa(tc.node,3)};this.a8d=(Xb,tc)=>{this.$xa(tc.node,2)};this.xXi=(Xb,tc)=>{this.$xa(tc.node,0)};this.yXi=(Xb,tc)=>{this.$xa(tc.node,3)};this.wXi=(Xb,tc)=>{Xb=tc.node;this.Pya.BNb(Xb.id.toString(),wb.a.tM(Xb))};this.b8d=(Xb,tc)=>{this.$xa(tc.node,2)};this.sXi=(Xb,tc)=>{this.$xa(tc.node,0)};this.rXi=(Xb,tc)=>{Xb=tc.node;this.Pya.BNb(Xb.id.toString(),wb.a.tM(Xb))};this.tXi=(Xb,tc)=>{this.$xa(tc.node,3)};this.Z7d=(Xb,tc)=>{var Tc;Xb=
tc.node;if(tc.property===qa.a.ghostCell){if(tc=Xb.hg?Xb:null===(Tc=Xb.exa)||void 0===Tc?void 0:Tc.controlCell){Tc=ad.GraphIterator.$a(tc);var Md=Tc.xq();for(var le=0;le<Md;le++){Tc.zG(le);var md=Xc.OutlineElementNavigator.Ge(Tc);this.Pya.BNb(md.id.toString(),String.format("{0}\\{1}",wb.a.tM(tc),md.id));this.$xa(md,4);Tc.jd(16)}}}else if(tc.property===Ic.a.ef){tc=ad.GraphIterator.$a(Xb);Tc=tc.xq();let Ee=null;Md=[];for(le=0;le<Tc;le++){tc.zG(le);md=Xc.OutlineElementNavigator.Ge(tc);this.Pya.j$n(md.id.toString(),
String.format("{0}\\{1}",wb.a.tM(Xb),md.id));if(14!==md.type){if(Ee=wb.a.tM(md))this.Pya.BNb(md.id.toString(),Ee),this.$xa(md,5)}else Md.push(md);tc.jd(16)}Ee&&Md.forEach(ef=>{this.Pya.BNb(ef.id.toString(),String.format("{0}\\{1}",Ee.split("\\").slice(0,-1).join("\\"),ef.id));this.$xa(ef,5)})}this.$xa(Xb,2)};this.UQf=()=>{this.V7c()?this.XM():this.EKd&&!this.Pya.H8&&this.cza()};this.xSb=ka.$("AugLoopOperationsAreEnabled")}get R_c(){return this.fsc}init(){this.V7c()&&this.XM();this.Pya.qph(this.UQf)}XM(){const {jxj:ka,
Ike:bb,Ywj:ub}=this.U7h();if(ka&&bb&&ub){this.EKd=!0;var Xb=this.qXi,tc=this.vXi,Tc=this.a8d;ka.Vt(this.uXi);ka.hT(Xb);ka.Ow(tc);ka.Go(Tc);Xb=this.wXi;tc=this.yXi;Tc=this.b8d;bb.Vt(this.xXi);bb.hT(Xb);bb.Ow(tc);bb.Go(Tc);Xb=this.rXi;tc=this.tXi;Tc=this.Z7d;ub.Vt(this.sXi);ub.hT(Xb);ub.Ow(tc);ub.Go(Tc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}cza(){const {jxj:ka,Ike:bb,Ywj:ub}=this.U7h();if(ka&&bb&&ub){this.EKd=!1;var Xb=this.qXi,tc=
this.vXi,Tc=this.a8d;ka.VU(this.uXi);ka.Tca(Xb);ka.Dia(tc);ka.WU(Tc);Xb=this.wXi;tc=this.yXi;Tc=this.b8d;bb.VU(this.xXi);bb.Tca(Xb);bb.Dia(tc);bb.WU(Tc);Xb=this.rXi;tc=this.tXi;Tc=this.Z7d;ub.VU(this.sXi);ub.Tca(Xb);ub.Dia(tc);ub.WU(Tc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}$xa(ka,bb){ka&&this.H6a(ka)&&this.Pya.H8&&this.xSb&&this.Pya.oce(ka,bb)}U7h(){return{jxj:this.Oo.Ye(14),Ike:this.Oo.Ye(15),Ywj:this.Oo.Ye(16)}}H6a(ka){const bb=
U.App.xa.hb.rc;return!!bb&&bb.hv&&!!bb.Yc&&!!bb.Yc.Jc&&!!ka&&!!ka.Jc&&ka.Jc.id===bb.Yc.Jc.id}V7c(){return!this.EKd&&!!this.Pya.H8}}Object(f.a)(nd,"TableNodeEventHandler",null,[723]);class ud{constructor(ka,bb){this.n_i=ka;this.zFo=bb}KEb(ka){return ka?14===ka.type||15===ka.type||16===ka.type?this.zFo:12===ka.type?this.n_i:null:null}}Object(f.a)(ud,"NodeToTileConverterHolder",null,[722]);var Bd=c(369);class kl{get name(){return"Box4.AugmentationLoop"}xc(ka){this.W=ka;const bb=this.W.resolve("Common.IAppSettingsManager"),
ub=bb.$("AugLoopTaskUseTimeBasedYieldStrategy"),Xb=new Id,tc=ub?new ca.a(bb.mc("AugLoopTaskAllowedRunTimeBeforeYielding",10),F.a.Ze):new Y(bb.mc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>P.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new Ob).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new zg(bb,U.App.Tj.zl.Ye(12),Xb,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.pc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();wb.a.Ihe()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",
()=>new nd(bb,U.App.Tj.zl,Xb)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new V).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new Ie(this.W.resolve("Common.IAppSettingsManager"),this.W.Na("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>
new fa.a(new X.a(()=>U.App.xa.hb.Uc.od),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new $b(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new X.a(()=>U.App.xa.hb.Uc.od),ka.resolve("Box4.IFeatureHelper"))).singleInstance();const Tc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",
()=>new Ya(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new X.a(()=>U.App.xa.hb.Uc.od),y.AFrameworkApplication.pc,this.W.Na("Box4.IIntelligenceReader"),this.W.Na("Box4.IIntelligenceEditor"),this.W.Na("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Na("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ka.resolve("Box4.IFeatureHelper"),Bd.a.instance,()=>{try{return Gb.a.getAugLoopRuntimeManager()}catch(Md){return a.ULS.sendTraceTag(50935320,
389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Md),null}},Tc)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new ud(new ec.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new lg)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new Se(bb,Xb,y.AFrameworkApplication.pc,tc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new kc).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new Wb).singleInstance()}init(){if(y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",
!1)&&y.AFrameworkApplication.ZF.BootFailed)a.ULS.sendTraceTag(512624089,389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ka=new yb(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.Ne,U.App.A5,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),W.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),
bb=new aa;this.W.register(312,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().l_o(()=>bb);y.AFrameworkApplication.te("b8afb343;bjdjj400");y.AFrameworkApplication.te("72af9564;82jf1647");const ub=wb.a.OZm(this.W.resolve("Common.IDynamicScriptLoaderProvider").Pz,this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),bb);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Oa(ub)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();
wb.a.Ihe()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){z.a.instance.Fc(new kl,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(kl,"Box4AugmentationLoopPackage",null,[1,2]);var fi=c(602),ji=c(43),wi=c(12),xl=c(407),Fl=c(1134);class di{constructor(ka,
bb,ub,Xb=null,tc=null,Tc=null){this.kO=new Fl.a(bb,Xb,tc,Tc);this.Ib=ka;this.Mc=ub}get type(){return this.kO.type}get id(){return this.kO.id}get intent(){return this.kO.intent}Ef(ka){return new di(ka,this.type,this.Mc,this.id,this.intent,this.kO.rxa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.kO,this.Mc)}}Object(f.a)(di,"IntentObject",null,[188]);var Xi=c(472),Yi=c(149),sm=c(244);class Fg{constructor(){this.Zsc=new Yi.a}Vyd(ka,bb,ub,Xb,tc=null,Tc=null,Md=null){ka=ka.u_(bb,
ka.pa.QMo(bb));ka.Ij||(ka.Ij=new Xi.a(ka));ka.Ij.add(new di(ka,ub,Xb,tc,Tc,Md));ka.isFromErrorRangeSplit=!0}g$i(ka){return ka.Ib&&ka.Ib.Ij&&ka.Ib.Ij.l4c(bb=>bb===ka,[ka.type])?!0:!1}h$i(ka,bb){if(ka.type===bb.type&&ka.Mc&&!bb.Mc&&ka.Ib&&ka.Ib.Ij&&ka.Ib.Ij.contains(ka)&&bb.Ib&&bb.Ib.Ij&&bb.Ib.Ij.contains(bb)){var ub=[ka.type];ka.Ib.Ij.l4c(Xb=>Xb===ka,ub);bb.Ib.Ij.l4c(Xb=>Xb===bb,ub)}}f0o(ka,bb,ub){if(!bb)return!1;ub=new ab.a([ub]);for(let Xb=0;Xb<ka.length;Xb++){const tc=ka.J(Xb);if(!tc.Ij)continue;
let Tc=!0;ub.iUa(tc.Ij,void 0,Md=>{Md.id&&bb.equals(Md.id)&&(Tc=!1)});if(!Tc)return!1}return!0}bFn(ka,bb,ub,Xb){let tc=null,Tc=null;bb=new ab.a([bb]);const Md=ka.pa;for(let le=0;le<Md.length;le++){const md=Md.J(le);if(!md.Ij)continue;let Ee=!0;bb.iUa(md.Ij,void 0,(ef,Wf)=>{if(Wf){var Ag=Wf.Ib.cp<ub,Dh=ef.Ib.cp>Xb;Ag&&ef.Ib.cp<=ub||Wf.Ib.cp>=Xb&&Dh||(Ag&&Dh?Ee=!1:Ag?tc=ef:Dh?Tc=Wf:this.h$i(Wf,ef))}});if(!Ee)return!1}if(tc){if(!this.g$i(tc))return!1;this.Vyd(ka,ub,tc.type,tc.Mc,tc.id,tc.intent,tc.kO.rxa)}if(Tc){if(!this.g$i(Tc))return!1;
this.Vyd(ka,Xb,Tc.type,Tc.Mc,Tc.id,Tc.intent,Tc.kO.rxa)}return!0}Wcg(ka){let bb;return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:bb}=this.Zsc.Dc(ka.type,bb)).returnValue?bb.Wcg(ka):!0}Y9m(ka,bb){if(this.Wcg(bb)){var ub=bb.id,Xb=bb.type,tc=bb.begin,Tc=bb.end;if(({cpEnd:Tc}=Fg.SIj(ka,tc,Tc)).returnValue){if(xl.a(Xb)){if(!this.f0o(ka.pa,ub,Xb))return}else if(!this.bFn(ka,Xb,tc,Tc))return;this.Vyd(ka,tc,Xb,!0,ub,bb.intent,bb.kO.rxa);this.Vyd(ka,
Tc,Xb,!1,ub,bb.intent,bb.kO.rxa)}}}l1c(ka,bb){U.App.xa.xhf(ka,()=>{const ub=new ji.GraphTransaction(2);try{ub.Cb(ka);const Xb=ka.NY();try{const tc=ka.q_();try{bb()}finally{tc&&tc.dispose()}}finally{Xb&&Xb.dispose()}}finally{ub&&ub.dispose()}})}$Qa(ka,bb){this.l1c(ka,()=>{this.Y9m(ka,bb)})}$9m(ka,bb){if(bb.count){var ub=new Ra.a,Xb=new sm.a;for(var tc of bb){var Tc=tc.value;xl.a(tc.key)||Tc.Sc((le,md)=>le.begin!==md.begin?le.begin-md.begin:le.end-md.end);if(Fg.j0o(Tc))for(var Md of Tc)Tc=Md.end,({cpEnd:Tc}=
Fg.SIj(ka,Md.begin,Tc)).returnValue&&(Tc=Tc!==Md.end?new sb.a(Md.type,Md.begin,Tc,Md.id,Md.intent,Md.kO.rxa):Md,ub.add(Tc.begin),ub.add(Tc.end),Fg.usk(Xb,Tc))}ka.aKd(ub);ka=ka.pa;for(ub=0;ub<ka.length;ub++){tc=ka.J(ub);if(Md=tc.Ij)for(const md of bb.keys)Md.aaj(md);let le;({value:le}=Xb.Dc(tc.cp,le)).returnValue||(le=null);if(le){Md||(Md=tc.Ij=new Xi.a(tc));for(const md of le)Md.add(md.Ef(tc))}tc.isFromErrorRangeSplit=!0}}}x3d(ka,bb){const ub=new Yi.a;for(const Xb of bb){let tc;({value:tc}=ub.Dc(Xb.type,
tc)).returnValue||(tc=new kb.a,ub.Z(Xb.type,tc));tc.add(Xb)}this.l1c(ka,()=>{this.$9m(ka,ub)})}fQo(ka,bb,ub){ka=ka.pa;const Xb=new ab.a([8]);bb===ub&&(ub+=1);for(let tc=0;tc<ka.length;tc++){const Tc=ka.J(tc);Tc.Ij&&Xb.iUa(Tc.Ij,void 0,(Md,le)=>{le&&Math.max(le.Ib.cp,bb)<Math.min(Md.Ib.cp,ub)&&this.h$i(le,Md)})}}jlg(ka,bb,ub){this.l1c(ka,()=>{this.fQo(ka,bb,ub)})}hQo(ka,bb){ka=ka.pa;for(let ub=0;ub<ka.length;ub++){const Xb=ka.J(ub);Xb.Ij&&Xb.Ij.aaj(bb)}}$Ta(ka,bb){this.l1c(ka,()=>{this.hQo(ka,bb)})}gQo(ka,
bb,ub){let Xb=!1;bb=bb.pa;ub=[ub];for(let tc=0;tc<bb.length;tc++){const Tc=bb.J(tc);Tc.Ij&&(Xb=Tc.Ij.l4c(ka,ub)||Xb)}return Xb}xad(ka,bb,ub){let Xb=!1;this.l1c(bb,()=>{Xb=this.gQo(ka,bb,ub)});return Xb}LPd(ka,bb,ub,Xb){return!ka||0>ub||Xb>ka.characterData.length||ub>Xb?new kb.a:this.$Oa(ka,bb,tc=>Math.max(tc.begin,ub)<=Math.min(tc.end,Xb))}$Oa(ka,bb,ub){return Fg.n_l(ka,bb,ub)}static n_l(ka,bb,ub){const Xb=new kb.a;ka=ka.pa;bb=new ab.a([bb]);if(!ka)return Xb;for(let tc=0;tc<ka.length;tc++){const Tc=
ka.J(tc);Tc.Ij&&bb.iUa(Tc.Ij,void 0,(Md,le)=>{le&&(Md=new sb.a(le.type,le.Ib.cp,Md.Ib.cp,le.id,le.intent,le.kO.rxa),ub(Md)&&Xb.add(Md))})}return Xb}uOc(ka,bb){const ub=new kb.a;if(!Fg.LTm(ka.contextId))return ub;let Xb;const tc=ka.node;ka.contextId!==wi.a.paragraph?(Xb=ka.cpBegin,ka=ka.cpEnd):(Xb=0,ka=tc.characterData.length);ub.addRange(this.LPd(tc,bb,Xb,ka));return ub}mVn(ka){this.Zsc.nb(0)||this.Zsc.Z(0,ka)}static SIj(ka,bb,ub){ka=Ua.ParagraphReader.textLength(ka);if(bb>=ka)return{returnValue:!1,
cpEnd:ub};ub>ka&&(ub=ka);return{returnValue:!0,cpEnd:ub}}static j0o(ka){if(!ka.count)return!0;const bb=new fi.a,ub=ka.J(0).type,Xb=xl.a(ub);let tc=-1;for(const Tc of ka){if(Tc.type!==ub||(xl.c(Tc.type)?Tc.begin>Tc.end:Tc.begin>=Tc.end))return!1;if(Xb){ka=Tc.id;if(!ka||ka.equals(la.a.nil)||bb.contains(ka))return!1;bb.add(ka)}else if(-1===tc)tc=Tc.end;else if(tc>Tc.begin)return!1}return!0}static usk(ka,bb){let ub;({value:ub}=ka.Dc(bb.begin,ub)).returnValue||(ub=new kb.a,ka.Z(bb.begin,ub));ub.add(new di(null,
bb.type,!0,bb.id,bb.intent,bb.kO.rxa));({value:ub}=ka.Dc(bb.end,ub)).returnValue||(ub=new kb.a,ka.Z(bb.end,ub));ub.add(new di(null,bb.type,!1,bb.id,bb.intent,bb.kO.rxa))}static LTm(ka){return ka===wi.a.Hd||ka===wi.a.Tc||ka===wi.a.paragraph}}Object(f.a)(Fg,"IntentRangeEditor",null,[318]);class $f{constructor(){this.W=null}get name(){return"Box4.Intent"}xc(ka){this.W=ka;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new Fg).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){z.a.instance.Fc(new $f,
0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(f.a)($f,"PackageManager",null,[1,2]);var Qi=c(1022),em=c(110),Zi=c(1409);class Tg{constructor(ka){this.n8m=ka;this.j8m=[]}get handler(){return this.n8m}get ena(){return this.j8m}}Object(f.a)(Tg,"RegisteredListener",null,[]);class Ri{constructor(ka,bb){this.type=0;this.payload=null;this.type=ka;this.payload=bb}}Object(f.a)(Ri,"OfficeSharedCommentsEvent",null,[1135]);class cj{constructor(){this.eventType=0;this.newViewContainer=
null;this.viewContainerVisibilityState=1}}Object(f.a)(cj,"ViewContainerEvent",null,[1135]);var Fh=c(575);class Kh{constructor(ka){this.qLf=!1;this.cpa=new kb.a;this.k3d=ka}JUn(ka){ka=new Tg(ka);this.cpa.add(ka)}pDj(ka){for(let bb=0;bb<this.cpa.count;++bb)if(this.cpa.J(bb).handler===ka){this.cpa.removeAt(bb);break}}MSa(ka=!1){const bb=()=>{if(y.AFrameworkApplication.Lk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let tc=0;tc<this.cpa.count;++tc){const Tc=
this.cpa.J(tc);for(;0<Tc.ena.length;){var ub=Array.dequeue(Tc.ena);if(Object(em.a)(cj,ub)){var Xb=Tc.handler;Xb(ub)}else Object(em.a)(Ri,ub)&&(Xb=Tc.handler,Xb(ub.type,ub.payload))}}};ka?bb():this.qLf||(this.qLf=!0,Fh.a.a3(this.k3d,()=>{bb();this.qLf=!1},Zi.a.gFl))}}Object(f.a)(Kh,"GenericEventHost",null,[]);class Ok{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=
this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(Ok,"BasicEventPayload",null,[1232]);class uj{constructor(ka){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(f.a)(uj,"CommentContextDetails",null,[]);class tl{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=
0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(f.a)(tl,"ContextChangeWithSelectedThreadIndex",null,[1232]);class Lj{constructor(){this.tasks=this.comments=null}}Object(f.a)(Lj,"LoadCommentsNoVirtualization",null,[1232]);class yl extends Kh{constructor(ka){super(ka);this.gdh=0}vlo(){this.gdh=1656}tVn(ka,bb,ub,Xb,tc,Tc){ka=new Tg(ka);Tc&&Array.enqueue(ka.ena,this.F8k(Tc,this.gdh));Tc=bb?bb.length:0;Array.enqueue(ka.ena,this.qKh(Tc,ub,Xb,0));Tc&&Array.enqueue(ka.ena,this.sLh(bb,
tc));this.cpa.add(ka);this.MSa()}yQb(ka){this.pDj(ka)}pco(ka,bb,ub,Xb=0){this.AGb(this.qKh(ka,bb,ub,Xb));this.MSa()}qco(ka,bb,ub){this.AGb(this.d9k(ka,bb,ub));this.MSa()}Oco(ka,bb){this.AGb(this.sLh(ka,bb));this.MSa()}selectComment(ka){this.AGb(this.rMh(ka,6));this.MSa()}highlightComment(ka){this.AGb(this.rMh(ka,7));this.MSa()}xmg(ka,bb){this.AGb(this.lbl(ka,bb));this.MSa()}GZf(ka,bb){this.AGb(this.ndl(ka,bb));this.MSa()}F8k(ka,bb=0){const ub=new Ok;ub.modelCapabilityFlags=ka;ub.richTextCapabilityFlags=
bb;return new Ri(12,ub)}qKh(ka,bb,ub,Xb){const tc=new Ok;tc.numberOfComments=ka;tc.numberOfThreads=bb;tc.contextDetails=Object.assign(new uj(ub),{nextPopulatedContextDetails:Xb});tc.contextDrafts=null;tc.rehydrationDrafts=null;return new Ri(0,tc)}d9k(ka,bb,ub){const Xb=new Ok;Xb.comments=ka;Xb.numberOfThreads=bb;Xb.tasks=ub;return new Ri(2,Xb)}sLh(ka,bb){const ub=new Lj;ub.comments=ka;ub.tasks=bb;return new Ri(1,ub)}rMh(ka,bb){const ub=new Ok;ub.commentId="";ka&&(ub.commentId=ka);return new Ri(bb,
ub)}lbl(ka,bb){const ub=new Ok;ub.changes=[];ub.contextDetails=Object.assign(new uj(bb),{nextPopulatedContextDetails:ka});return new Ri(10,ub)}ndl(ka,bb){const ub=new Ok;ub.commentId=ka;ub.smartReplies=bb;return new Ri(15,ub)}AGb(ka){for(let bb=0;bb<this.cpa.count;++bb)Array.enqueue(this.cpa.J(bb).ena,ka)}}Object(f.a)(yl,"OfficeSharedCommentsEventHost",Kh,[1221]);var Lh=c(230),Ck=c(188),lk=c(272);class Pk{constructor(){this.vRe=this.qKg=!1;this.DI=this.pn=this.zZg=this.I4g=this.Axd=this.JXb=this.Mhh=
this.XOg=this.Pz=this.PAc=null}initialize(ka,bb,ub,Xb=null,tc=null,Tc=null,Md=null,le=null,md=null,Ee=null){this.Pz=ka;this.XOg=bb;this.Mhh=ub;this.JXb=Xb;this.Axd=tc;this.I4g=Tc;this.zZg=Md;this.pn=le;this.qKg=!0;this.DI=md;this.PAc=Ee}DWd(ka=null,bb=null){if(!this.qKg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((ub,Xb)=>{Xb(Fh.a.FD(-2130915313))});if(this.vRe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.PAc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.PAc=appResourceLoader.loadChunk("sharedComments"):this.PAc=this.Pz.loadScript("sharedComments"));return this.PAc.then(()=>{ka&&ka();this.vRe||(this.DI&&this.DI.execute(ub=>{ub.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),bb&&bb(),sharedComments.instantiate(this.XOg,this.Mhh,this.JXb,this.Axd,this.I4g,this.zZg,this.pn));this.vRe=!0})}}Object(f.a)(Pk,
"CommentActivationManager",null,[1263]);class Fm extends Kh{constructor(ka){super(ka)}hXn(ka){this.JUn(ka)}cRo(ka){this.pDj(ka)}wnj(ka){ka=this.$8k(ka);for(let bb=0;bb<this.cpa.count;++bb)Array.enqueue(this.cpa.J(bb).ena,ka);this.MSa(!0)}$8k(ka){const bb=new cj;bb.eventType=3;bb.viewContainerVisibilityState=ka;return bb}EFl(){const ka=this.wel();for(let bb=0;bb<this.cpa.count;++bb)Array.enqueue(this.cpa.J(bb).ena,ka);this.MSa(!0)}wel(){const ka=new cj;ka.eventType=2;return ka}}Object(f.a)(Fm,"ViewContainerEventHost",
Kh,[1119]);var fm=c(55);class gm{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(gm,"CommentUIActionPayload",null,[]);var kg=c(304);class $k{constructor(ka,bb){this.ga=ka;this.arb=bb;this.loc=new kg.a;for(let ub of this.arb)this.loc.Z(ub.value.canvasActionId,ub.key),ka=ub.value,ka.delayActionsUntilRegistration||this.qa(ka)}qa(ka){ka.withFlags?this.ga.fb(ka.canvasActionId,ka.canvasContextId,Object(fm.a)(this,this.hmh,"actionHandler"),97):this.ga.qa(ka.canvasActionId,ka.canvasContextId,
Object(fm.a)(this,this.hmh,"actionHandler"))}lSa(ka,bb){this.arb.nb(ka)&&(this.arb.J(ka).delayActionsUntilRegistration&&this.qa(this.arb.J(ka)),this.arb.J(ka).registeredCallback=bb)}hmh(ka,bb,ub,Xb,tc){if(this.loc.nb(ka)){var Tc=this.loc.J(ka);if(!this.arb.nb(Tc))return 8;const Md=this.arb.J(Tc);if(Md.preCallback){const le=Md.preCallback(ka,bb,ub,Xb,tc);if(2!==le)return le}if(!Md.registeredCallback)return 1===ub?8:2;Tc=Object.assign(new gm,{actionType:Tc});1===ub&&(Tc.actionBehavior=1);Tc=Md.registeredCallback(Tc);
return Md.postCallback?Md.postCallback(Tc,ka,bb,ub,Xb,tc):Tc?32:8}return 2}}Object(f.a)($k,"OfficeSharedCommentsActionHost",null,[1223]);var am=c(1812),bg=c(65),Hd=c(130),zd=c(1461),vf=c(13),cg=c(27),og=c(538),be=c(1141),jd=c(131),ak=c(306),sh=c(46),pg=c(21),ul=c(1040),jh=c(1033),ag=c(1569),Uf=c(166),Dk=c(11),ve=c(37),Hf=c(694),ej=c(467),vj=c(16),Xh=c(2030);class dg{constructor(ka){this.YV=ka;this.Kfc=new M.a;this.W1a=new M.a;this.wym();this.ism=[new Xh.a(ve.a.IFh,ve.a.J0k),new Xh.a(ve.a.zEd,ve.a.I0k),
new Xh.a(ve.a.zFh,ve.a.x0k),new Xh.a(ve.a.rEd,ve.a.w0k),new Xh.a(ve.a.JFh,ve.a.L0k),new Xh.a(ve.a.AEd,ve.a.K0k)]}pSa(ka){this.YV.pSa(ka);this.qYn(ka)}JEf(ka,bb){return!!ka&&!!ka.objectId&&bb.contains(la.a.Ff(ka.objectId))}wQa(ka){ka=Object(Ab.a)(560,ka);return!!ka&&!!ka.objectId}qYn(ka){for(const bb of this.ism)ka.classList.remove(bb.className,bb.eQc);ka.classList.remove(ve.a.gZf,ve.a.CEd,ve.a.AFh,ve.a.BEd,dg.xrg)}wym(){const ka=new M.a,bb=new M.a;ka.add(0,null);ka.add(1,ve.a.zEd);ka.add(2,ve.a.IFh);
ka.add(3,ve.a.CEd);bb.add(0,null);bb.add(1,ve.a.rEd);bb.add(2,ve.a.zFh);bb.add(3,ve.a.AFh);this.W1a.Z(1,ka);this.W1a.Z(2,bb);this.W1a.Z(3,bb);this.Kfc.add(0,null);this.Kfc.add(1,ve.a.AEd);this.Kfc.add(2,ve.a.JFh);this.Kfc.add(3,ve.a.BEd)}}dg.xrg="CommentImportant";Object(f.a)(dg,"CommentHighlightUtils",null,[]);class ll{constructor(){this.DJd=0;this.IAb=null}}Object(f.a)(ll,"CommentGuidsInElementInfo",null,[]);class gi{constructor(){this.bmi=!1;this.rma=this.NKb=null;this.SRa=this.YFb=0}}Object(f.a)(gi,
"HighlightInfoForElement",null,[]);class Gm{constructor(){this.Api=this.Cpi=this.Bpi=-1;this.uni=[];this.O2b=[];this.aSc=this.bSc=-1;this.Bui=!1}}Object(f.a)(Gm,"HighlightInfoForElementsInPara",null,[]);class An{constructor(){this.glg=this.DUf=null}}Object(f.a)(An,"OnAnchorMouseOutData",null,[]);var qg=c(1499);class xk{constructor(ka,bb,ub,Xb,tc,Tc,Md,le){this.Fve=ka;this.u$=bb;this.qk=ub;this.b2=Xb;this.ga=tc;this.Hb=Tc;this.Yi=Md;this.ZWa=this.Xi=null;this.uln=md=>{if(!this.Xi||this.b2.MYd)return!0;
if(md=md.Ro){if(this.Xi.Cz&&md[0].toString()===this.Xi.Cz.objectId)return!0;this.ZWa&&md[0].equals(this.ZWa.glg[0])?this.Hb.We(this.ZWa.DUf):(this.ZWa&&(this.Hb.We(this.ZWa.DUf),this.ga.Qb(vf.a.DEd,2,this.ZWa.glg)),this.Xi.Jo.Cui(md[0])&&!this.Yi.$m||this.ga.Qb(vf.a.o8e,2,md));this.ZWa=null}return!0};this.tln=md=>{if(this.b2.MYd)return!0;const Ee=md.Ro;Ee&&(md=new ra.a(2,1,0,()=>{this.ga.Qb(vf.a.DEd,2,Ee);this.ZWa=null}),this.Hb.Wb(md),this.ZWa=Object.assign(new An,{DUf:md,glg:Ee}));return!0};this.XSi=
md=>{const Ee=new ra.a(2,1,0,()=>{if(this.Xi&&!this.Xi.Jo.oy){var ef=md.Ro;if(!ef)ef=U.App.xa.Dp.currentScope,this.Xi.Cz&&(!ef||ef.name!==Uf.AFrame.rM&&ef.name!==Uf.AFrame.Gr)&&this.Xi.clearSelection();else if(!this.Xi.Cz||ef.toString()!==this.Xi.Cz.objectId)if(ef=this.Xi.Jo.x_(ef.toString()))ef=Object.assign(new zd.a,{commentId:ef.id,LR:!1,K9:1}),this.ga.Qb(vj.a.selectComment,2,ef)}});this.Hb.Wb(Ee);return!1};le.execute(md=>{this.Xi=md})}Sxh(ka,bb,ub,Xb){const tc=new Gm,Tc=[],Md=this.u$.wQa(bb)?
bb.objectId:null;for(let Ee=0,ef=ka.length;Ee<ef;Ee++){var le=ka[Ee],md=qg.g(le);const Wf=qg.d(le);le=new fi.a;const Ag=new gi;if(md){const Dh=new ej.a(qg.c);md=this.fZh(md,Md,Dh);0<md.length&&(this.DUo(md,ub,le,Ag,Md,Xb),Tc.push(Object.assign(new ll,{DJd:Ee,IAb:Dh})))}Wf&&(md=this.fZh(Wf,Md),0<md.length&&(this.FUo(md,ub,le,Ag,tc,Md,Xb,Ee),this.YSo(Tc,md,Ee,Ag)));0<ub.count&&this.GUo(bb,ub,Ag,Xb);this.WSo(Tc,Ag);tc.uni.push(Ag)}return tc}nth(ka,bb,ub){let Xb=!1;for(let tc=0,Tc=ka.length;tc<Tc;tc++){const Md=
ka[tc],le=bb.uni[tc],md=Hf.a(Md);if(1!==md&&2!==md&&3!==md)continue;const Ee=3===md||2===md&&-1!==Md.className.indexOf(ve.a.DPa);this.u$.pSa(Md);this.ttk(Md,le,Ee,Xb);this.fsk(Md,tc,md,le,bb,ub);this.gsk(Md,tc,bb,le);Xb=Ee}}fZh(ka,bb,ub=null){const Xb=[];for(let tc=0;tc<ka.length;tc++)this.Fve.Woj(ka[tc],ka[tc].toString()===bb)&&(Xb.push(ka[tc]),ub&&ub.add(ka[tc]));return Xb}DUo(ka,bb,ub,Xb,tc,Tc){var Md;let le=!1,md=!1;for(const ef of ka){bb.add(ef);ub.add(ef);var Ee=ef.toString();Ee===tc?(Ee=Tc?
1:2,Xb.SRa=Ee,Xb.YFb=Ee):this.JEf(this.Xi.Cz,bb)&&(Ee===(null===(Md=this.Xi.Cz)||void 0===Md?void 0:Md.objectId)&&(md=!0),le=!0)}0<ka.length&&!Xb.SRa&&(Xb.SRa=md?1:3,Xb.YFb=le?1:3)}FUo(ka,bb,ub,Xb,tc,Tc,Md,le){var md,Ee;const ef=new ej.a(qg.c);Md=Md?1:2;let Wf=!1;for(const Ag of ka){const Dh=Ag.toString();bb.contains(Ag)||(Dh===Tc?tc.Api=le:(tc.Bpi=le,Xb.SRa=3,(null===(md=this.Xi.Cz)||void 0===md?void 0:md.objectId)===Dh&&(tc.Cpi=le,Xb.SRa=1)),ef.add(Ag));Dh===(null===(Ee=this.Xi.Cz)||void 0===Ee?
void 0:Ee.objectId)&&(Wf=!0);bb.remove(Ag);ub.contains(Ag)&&this.EUo(Xb,Ag,Dh,Tc,Md);Dh===Tc&&(Xb.SRa=Md)}0<ka.length&&!Xb.SRa&&(Xb.SRa=Wf?1:3);0<ef.count&&tc.O2b.push(Object.assign(new ll,{DJd:le,IAb:ef}))}YSo(ka,bb,ub,Xb){0!==ka.length&&(bb.forEach(tc=>{for(let Tc=ka.length-1;0<=Tc;Tc--){const Md=ka[Tc];if(Md.IAb.contains(tc)){Md.DJd===ub&&(Xb.rma?Xb.rma.push(tc):Xb.rma=[tc]);Md.IAb.remove(tc);break}}}),ka=ka.filter(tc=>0<tc.IAb.count))}GUo(ka,bb,ub,Xb){var tc,Tc;this.JEf(ka,bb)?ub.YFb=Xb?1:2:ub.YFb||
(ub.YFb=null!=(null===(tc=this.Xi.Cz)||void 0===tc?void 0:tc.objectId)&&bb.contains(la.a.Ff(null===(Tc=this.Xi.Cz)||void 0===Tc?void 0:Tc.objectId))?1:3);ub.NKb||(ub.NKb=[]);for(const Md of bb)ub.NKb.push(Md)}WSo(ka,bb){if(0<ka.length){bb.rma||(bb.rma=[]);for(const ub of ka[ka.length-1].IAb)bb.rma.push(ub)}}EUo(ka,bb,ub,Xb,tc){ka.bmi=!0;ka.NKb||(ka.NKb=[]);ka.NKb.push(bb);ub===Xb&&(ka.YFb=tc)}JEf(ka,bb){return!!ka&&!!ka.objectId&&bb.contains(la.a.Ff(ka.objectId))}ttk(ka,bb,ub,Xb){!bb.SRa||ub||Xb||
((ub=this.u$.Kfc.J(bb.SRa))&&ka.classList.add(ub),bb.bmi&&ka.classList.add(ve.a.gZf))}fsk(ka,bb,ub,Xb,tc,Tc){Xb=this.u$.W1a.J(ub).J(Xb.YFb);bb<tc.Api?Xb=Tc?this.u$.W1a.J(ub).J(1):this.u$.W1a.J(ub).J(2):bb<tc.Bpi&&!Xb&&(Xb=bb<tc.Cpi?this.u$.W1a.J(ub).J(1):this.u$.W1a.J(ub).J(3));Xb&&(bb=tc.Bui,ka.classList.add(Xb),bb&&ka.classList.add(dg.xrg))}gsk(ka,bb,ub,Xb){Xb.rma||(Xb.rma=this.fQl(bb,ub)||Xb.NKb);bb=null;Xb.rma&&0<Xb.rma.length&&(this.qk.mb(Dk.a.p0,ka,this.uln,Xb.rma),this.qk.mb(Dk.a.fxa,ka,this.tln,
Xb.rma),bb=Xb.rma[0]);this.qk.mb(Dk.a.click,ka,this.XSi,bb);this.qk.mb(Dk.a.VJ,ka,this.XSi,bb)}fQl(ka,bb){for(;0<bb.O2b.length&&bb.O2b[0].DJd===ka;)bb.O2b.splice(0,1);if(0<bb.O2b.length){ka=[];for(const ub of bb.O2b[0].IAb)ka.push(ub);return ka}return null}}Object(f.a)(xk,"AllMarkupModeHighlightChangeHandler",null,[554]);var Gj=c(1471);class Of extends Gj.a{constructor(ka){super(100,25);this.joc=new M.a(0);this.YUj=6E4;this.cFl=()=>{const bb=this.joc.keys;if(bb.length){var ub="";for(let Xb=0;Xb<bb.length;Xb++)ub+=
bb.J(Xb)+":"+this.joc.J(bb.J(Xb))+";";this.Rpa(ub);this.joc=new M.a(0)}};this.krb=new kb.a;this.krb.add(1);this.krb.add(6);this.krb.add(2);this.krb.add(4);this.krb.add(10);this.krb.add(11);this.ah=ka;ka.Y2f&&window.setInterval(this.cFl,this.YUj)}SGa(ka){this.ah.VOo&&this.ah.Y2f&&(this.krb.contains(ka)?this.xPn(ka):this.Rpa(ka+""))}xPn(ka){this.joc.Z(ka,this.joc.lz(ka,0)+1)}}Object(f.a)(Of,"CommentActionInTypingRecorder",Gj.a,[569]);var hm=c(1607),fe=c(239);class Ti{static DZn(ka){ka&&ka.atmention&&
delete ka.atmention.isCurrentUser;return ka}}Object(f.a)(Ti,"DeltaFormatHelpers",null,[]);class Ek{constructor(){this.optional=this.attributes=null}}Object(f.a)(Ek,"Operation",null,[]);class rg extends Ek{constructor(){super();this.insert=null}}Object(f.a)(rg,"DeltaOperation",Ek,[]);class Vf{constructor(){this.ops=null}}Object(f.a)(Vf,"Delta",null,[]);var lh=c(135),qj=c(183),lm=c(148),Nd=c(56),Un=c(68),Ad=c(121),ml=c(489),Pf=c(1186),sg=c(1765);class cb extends sg.ACommentFormatTranslator{constructor(ka,
bb){super(ka);this.ve=bb}jjg(ka){const bb=new hm.a;for(let ub=0;ub<ka.length;ub++){const Xb=ka[ub];Xb.YGb=!0;this.SCk(bb,Xb);bb.aha("\n")}return[bb.LNc()]}jJo(ka,bb){ka=hm.a.bEb(ka[0]);ka=this.AFn(ka);const ub=new kb.a;let Xb=0,tc=null,Tc=null;for(;Xb<ka.ops.length;){const Md=ka.ops[Xb];tc||(tc=Pf.a.instance.createInstance(393230),tc.YGb=!0,tc.Zg(qa.a.Lc,fe.a.tF()),bb(tc),tc.pa.clear(),tc.jqa(""));"\n"===Md.insert?(Tc=this.zJf(tc,Tc),this.Tno(tc),ub.add(tc),tc=null):Tc=this.R_m(tc,Md,Tc);Xb++}return ub.toArray()}Tno(ka){const bb=
ka.Czh();for(let ub=0;ub<bb;ub++)ka.xe.jq.Z(ub,cb.Mfn),ka.xe.$s.Z(ub,cb.yQf)}zJf(ka,bb){var ub=ka.$Jd();ub.cp===ka.characterData.length?ub.Uh=!0:(ub=Object.assign(new qj.a(ka,ka.characterData.length),{Uh:!0}),ka.pa.add(ub));ub=ka.pa.last;if(bb){bb=!!bb.ew;const Xb=this.cHh(ka,ub,!bb,bb,null);ub.formatting=Xb;bb&&(ka=this.aHh(ka,ub),ub.lU=ka.Qj);ub.Pm=!0;bb=null}ub.cp||ub.formatting||(ub.formatting=new lm.a(ub,la.a.nil));return bb}R_m(ka,bb,ub){const Xb=ka.$Jd(),tc=!!bb.attributes&&!!bb.attributes.link,
Tc=!!bb.attributes&&!!bb.attributes.atmention,Md=this.cHh(ka,Xb,tc,Tc,bb);Xb.formatting=Md;ub&&(ub.ew&&(ub=this.aHh(ka,Xb),Xb.lU=ub.Qj),Xb.Pm=!0,ub=null);if(tc||Tc)this.r_m(Xb,ka,bb),ub=Xb.hyperlink;ka.jqa(ka.characterData+bb.insert);return ub}aHh(ka,bb){bb=new lm.a(bb,la.a.create());let ub=this.KGd();ub.setValue(qa.a.VHb,!0);ub=ka.Jc.GR(ub);bb.Qj=ub.id;return bb}cHh(ka,bb,ub,Xb,tc){bb=new lm.a(bb,la.a.create());let Tc=Pf.a.instance.createInstance(1179649);if(ub||Xb)Tc.setValue(Ic.a.DB,!0),Tc.setValue(Ic.a.j4,
!0),ub&&this.Hfo(ka,Tc);this.ah.Gzb&&tc&&tc.attributes&&this.wlo(tc.attributes,Tc);Tc=ka.Jc.GR(Tc);bb.Qj=Tc.id;return bb}Hfo(ka,bb){(ka=this.ve.MC(ka))&&(ka=ka.Pi(Nd.StyleReader.qRb))&&bb.setValue(Ed.a.hw,ka.id)}wlo(ka,bb){this.fOb(ka.weight>=hm.a.VMf,bb,Ic.a.bold,!0);this.fOb(ka.italic,bb,Ic.a.italic,!0);this.fOb(ka.underline,bb,Ic.a.underline,!0);this.fOb(ka.underline,bb,Ic.a.underlineType,Ge.a.uQb);this.fOb(ka.strikethrough,bb,Ic.a.strikethrough,!0);if(Un.a.rWc(ka.highlight)){var ub=Un.a.EEa(ka.highlight);
this.fOb(!!ka.highlight,bb,Ic.a.highlight,Un.a.a5(ub))}Un.a.rWc(ka.color)&&(ub=Un.a.EEa(ka.color),this.fOb(!!ka.color,bb,Ic.a.fontColor,Un.a.a5(ub)))}fOb(ka,bb,ub,Xb){ka&&bb.setValue(ub,Xb)}r_m(ka,bb,ub){if(ub.attributes&&ub.attributes.atmention){var Xb=Ad.HyperlinkReader.ePa(ub.attributes.atmention.email);ub=ub.optional&&ub.optional.atmention&&ub.optional.atmention.contentId?ub.optional.atmention.contentId:cb.ZIl(1===ub.attributes.atmention.resolveState);Xb=new ml.a(ka,Xb,!0,void 0,void 0,void 0,
ub);this.W7k(Xb,bb.Jc);ka.hyperlink=Xb}else bb=Ad.HyperlinkReader.ePa(ub.attributes.link),Xb=this.D$k(ka.paragraph.pa.first),ka.hyperlink=new ml.a(ka,bb,!1,Xb.Qj)}D$k(ka){let bb=this.jMh();bb=ka.paragraph.Jc.GR(bb);ka=new lm.a(ka,la.a.nil);ka.Qj=bb.id;return ka}W7k(ka,bb){var ub=String.format(' HYPERLINK "{0}"',ka.url),Xb=ka.ew;const tc=this.KGd();tc.setValue(qa.a.gt,15);tc.setValue(qa.a.ew,Xb);tc.setValue(qa.a.tQa,!0);tc.setValue(qa.a.fieldInstruction,ub);ka.Eta(bb.GR(tc).id);Xb=this.KGd();Xb.setValue(qa.a.gt,
47);Xb.setValue(qa.a.fieldInstruction,ub);ka.Eta(bb.GR(Xb).id);ub=this.KGd();ub.setValue(qa.a.gt,16);ka.Eta(bb.GR(ub).id)}jMh(){const ka=Pf.a.instance.createInstance(1179649);ka.setValue(Ic.a.DB,!0);ka.setValue(Ic.a.j4,!0);ka.setValue(Ic.a.isHidden,!0);return ka}KGd(){const ka=this.jMh();ka.setValue(Ic.a.e$,!0);return ka}AFn(ka){const bb=new kb.a;for(let ub=0;ub<ka.ops.length;ub++){const Xb=ka.ops[ub];Xb.optional=Ti.DZn(Xb.optional);if(-1!==Xb.insert.indexOf("\n")&&"\n"!==Xb.insert){const tc=Xb.insert.split("\n");
for(let Tc=0;Tc<tc.length;Tc++)if(ub!==ka.ops.length-1||Tc!==tc.length-1||tc[Tc])bb.add(Object.assign(new rg,{insert:tc[Tc],attributes:Xb.attributes,optional:Xb.optional})),Tc!==tc.length-1&&bb.add(Object.assign(new rg,{insert:"\n"}))}else bb.add(Xb)}return Object.assign(new Vf,{ops:bb.toArray()})}static ZIl(ka){return sg.ACommentFormatTranslator.ZGk+lh.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}cb.Mfn=0;cb.yQf=0;Object(f.a)(cb,"CommentDeltaFormatTranslator",sg.ACommentFormatTranslator,
[]);var Jb=c(1671),ac=c(1550);class Ec{get userPrincipalName(){return this.K.jb("UserPrincipalName")}constructor(ka,bb,ub){this.yj=ka;this.K=bb;this.OI=ub}LD(ka){return this.yj.LD(ka)}FGm(ka){ka=this.yj.LD(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}OTc(ka){return this.yj.OTc(ka)}isCurrentUserMentioned(ka){var bb,ub;ka=this.yj.VPl(ka);for(const Xb of ka){if(!Xb.text||0===Xb.text.length)continue;ka=hm.a.bEb(Xb.text[0]);let tc=0;for(;ka.ops&&
tc<ka.ops.length;){const Tc=null===(ub=null===(bb=ka.ops[tc])||void 0===bb?void 0:bb.attributes)||void 0===ub?void 0:ub.atmention;if(Tc&&Tc.email===this.userPrincipalName)return!0;tc++}}return!1}z_c(){this.OI.T4("OnContentFilterUpdate")}}Object(f.a)(Ec,"CommentFilterActor",null,[566]);var Lc=c(96),kd=c(2026),Vd=c(886),se=c(593);class He{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md){this.$h=ka;this.Hb=bb;this.si=ub;this.IUa=Xb;this.Yi=tc;this.P1=Tc;this.xh=Md;this.pT=le;this.cN=md;this.ptb=null;this.GUe=
0;this.Smd=!1;this.vrd=0;this.JQb=this.z8c=this.bOg=this.xvc=this.Byb=!1;this.updateViewportInfo=()=>{this.pT.wdg()&&this.xh.updateViewportInfo(this.Smd,this.oWf)};this.Olb=()=>{this.xh.Hla.Boa()&&(this.H3c(this.xh.Hla.rc),this.xh.Hla.Zgc(this.Olb))};this.oWf=()=>{this.T7a();this.pT.nWf()};this.igg=()=>{!this.Byb&&this.pT.Ocg()&&(this.vrd=this.JWe.scrollTop,this.Byb=!0,this.IUa.SGa(2))};this.v3f=(Ee,ef)=>{this.Byb&&(Ee=this.JWe.scrollTop,Ee-this.vrd?(this.xvc||ef.Coe||this.updatePosition(),this.xvc||
1!==ef.Coe||this.T7a(),this.N_e(Ee),this.pT.iVf()):this.xvc=this.Byb=!1)};this.JWe=this.xh.Jda;this.kia=se.a.M8d;this.kt=this.xh.kt;this.xh.RGh()}get qYd(){return this.pT.TFf()}get kia(){return this.xh.kia}set kia(ka){this.xh.kia=ka}get euh(){return"1"===this.kt.qF.style.opacity}goj(ka){this.z8c||(this.z8c=!0,this.xh.C1i(),this.ptb=ka(this.kt.UEa,this.xh.Q$i,()=>{this.updatePosition()}),this.xh.fJi(this.ptb),this.pT.initialize(this.ptb,this),this.xh.initialize(this.ptb,this.pT.Qlb),this.xh.o8i(),
this.xh.aoj(),this.xh.boj(),this.xh.foj(this.pT.b3e,this.pT.L7d,this.pT.K7d),this.h4f())}A7c(){}Dhe(){return this.xh.$oj()}setInitialActiveContainerId(ka,bb,ub=null){this.xh.setInitialActiveContainerId(ka,0,ub)}updatePosition(){if(!this.JQb&&this.qYd&&this.$h.b9b()){var ka=F.a.Ze()-this.GUe<se.a.AGj;ka||this.Smd||this.T7a(ka)}}g2e(){this.T7a()}NSa(ka,bb,ub){this.cN.zCb&&this.P1.T4("OnFloatingCommentsVisibilityChange",!0);this.xh.NSa(ka,bb,ub)}deleteContainer(ka,bb,ub=!1){this.xh.deleteContainer(ka,
bb,()=>{this.$h.zQc()||this.xh.bVd();this.pT.nTf()},ub)}addContainer(ka,bb,ub){this.xh.addContainer(ka,bb,ub,this.xh.lf,this.pT.HOc,this.pT.YRf)}h0i(ka){this.JQb=!0;ka();this.JQb=!1}z4c(ka,bb,ub){this.xh.z4c(ka,bb,ub)}A2b(){this.xh.A2b()}WGj(){const ka="1"===this.kt.qF.style.opacity;switch(!0){case ka&&!this.$h.zQc():this.xh.bVd();break;case !ka&&this.$h.zQc():this.xh.ZOb()}}yjg(ka=!0){this.pT.rdg&&this.xh.pzj(ka)}static n7h(ka,bb=null){const ub=new fb.a;for(const Xb of ka)Xb.Df||Xb.Vq!==kd.a.beingCreated&&
(!bb||bb(Xb))&&He.Wqk(ub,Xb.objectId,Xb);return ub}static Wqk(ka,bb,ub){let Xb;({value:Xb}=ka.Dc(bb,Xb)).returnValue||(Xb=[],ka.Z(bb,Xb));Xb.push(ub)}H3c(ka){ka&&(ka.Kla(()=>{this.updateViewportInfo()}),this.vrd=this.JWe.scrollTop,ka.mqh(this.igg),ka.nqh(this.v3f))}h4f(){this.xh.lf?this.H3c(this.xh.lf):this.xh.Hla?this.xh.Hla.s0b(this.Olb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}N_e(ka){this.kt.qF.style.top=ka-this.vrd+"px";this.xvc=!1}T7a(ka=
!1){ka=new ra.a(0,1,0,()=>{this.vff()},129,void 0,!ka);this.Hb.Wb(ka);this.Smd=!0;this.xvc=this.Byb;this.IUa.SGa(10)}Jsf(ka){return this.xh.r_a({contentAnchorPositions:ka.contentAnchorPositions})}vff(){this.Smd=!1;if(this.kt.UEa&&this.ptb&&this.$h.b9b()){this.xh.pKd();var ka=0;this.si.he(()=>{ka=this.xh.EOd()},"FCM:UP:GET");var bb=null,ub=null;this.si.he(()=>{const Xb=this.pT.P5h(ka,this.xh.lf);bb=Xb.w1k;ub=this.Jsf(Xb)},"FCM:UP:GP");this.si.he(()=>{this.Byb?(this.xh.OUh(ub),this.Byb=!1):this.ptb.emitEvent(3,
ub);this.P1.Ube()},"FCM:UP:RC");this.ptb.setFirstCommentRenderDone();"0"===this.kt.qF.style.opacity&&0<bb.count&&!this.Yi.$m&&this.Yi.L6a&&this.si.he(()=>{this.xh.ZOb()},"FCM:UP:SFC");!this.bOg&&0<bb.count&&(Fh.a.a3(this.Hb,this.xh.HJi,Zi.a.GJi),this.bOg=!0);this.GUe=F.a.Ze();this.IUa.SGa(6)}else this.GUe=F.a.Ze()}}Object(f.a)(He,"FloatingCommentManager",null,[357,358]);var wf=c(112),fc=c(1472),hf;(function(ka){ka[ka.vlp=0]="singleHint";ka[ka.aip=1]="multiHint";ka[ka.kkp=2]="resolvedHint";ka[ka.bip=
3]="multiResolvedHint";ka[ka.entryPoint=4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(hf||(hf={}));Object(f.b)("CommentIconType",hf);var Fk=c(127),Mh=c(1102);const mm={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[hf.unknown]:""},wj={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],
[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[hf.unknown]:[]},Yd=(ka,bb)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(bb){case 3:return Mh.a.PFh;
case 2:return Mh.a.QFh;case 1:return Mh.a.RFh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(bb){case 3:return Mh.a.MFh;case 2:return Mh.a.NFh;case 1:return Mh.a.OFh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(bb){case 3:return Mh.a.SFh;case 2:return Mh.a.TFh;
case 1:return Mh.a.UFh}}},$g=(ka,bb)=>{Fk.a("renderIcon")&&appChrome.api.renderIcon(ka,bb)};class fg{}fg.wni=16;fg.tsm=1;fg.nzf=20;fg.oLj=2;Object(f.a)(fg,"CommentIconConstants",null,[]);class Eo{constructor(){this.sEd=0;this.vEc=!1}}Object(f.a)(Eo,"CommentHintCensus",null,[]);class Fo{constructor(ka,bb,ub,Xb,tc){this.$Og=ka;this.L_b=ub;this.x0j=Xb;this.Ifa=tc;this.CMa=-1;this.Eve=new Set(bb)}get y(){if(-1!==this.CMa)return this.CMa;const ka=Sys.UI.DomElement.getBounds(this.$Og),bb=this.$Og.getClientRects();
return this.CMa=0<bb.length&&bb[0]?this.x0j?ka.y/this.L_b+fg.oLj:Math.floor(bb[0].height)/(2*this.L_b)+ka.y/this.L_b-fg.wni/2:0}get yEd(){return Array.from(this.Eve)}Uuk(ka){this.Eve=new Set([...this.Eve,...ka])}}Object(f.a)(Fo,"HintInfo",null,[582]);class Da extends fc.a{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag,Dh){super();this.ah=ka;this.ig=bb;this.qk=ub;this.oE=Xb;this.ga=tc;this.$h=Ee;this.zra=ef;this.IUa=Wf;this.Yi=Ag;this.YYj=Dh;this.wfd=new Map;this.Ttb=this.nxb=null;this.zlc={hIa:-1,
MQf:-1}}Hob(ka){let bb=!1;U.App.GKj&&ka.nc.Vi?P.a.instance.he(()=>{bb=qg.m(ka,!0)},"CHA:SCIVE"):P.a.instance.he(()=>{bb=qg.l(ka.htmlElement,!0)},"CHA:SCI");return bb}bfb(ka){const bb=this.zoom,ub=ka.M4,Xb=ka.nwa;let tc=0;for(let le=0;le<ka.Vba.length;le++)if(0<ka.Vba[le].width){tc=le;break}const Tc=ka.geb(1,fg.nzf,bb,tc);this.IUa.SGa(1);let Md=[];Xb.forEach((le,md)=>{const Ee=ka.Vba[md].y/bb;le=this.S$k(this.BYl(le,md),ef=>this.F$k(ub,ef,ef.y-Ee,Tc),()=>Da.Gbl(ub));Md=Md.concat(le)});return Md}S$k(ka,
bb,ub){ub=ub();const Xb=[];for(const tc of ka){ka=bb(tc);for(const Md of tc.yEd)this.wfd.set(Md.toString(),ka);const Tc=this.Tbi(tc.yEd);this.pFj(Tc,ka);null==ub.Ifa&&(ub.Ifa=tc.Ifa);ub.appendChild(ka);Xb.push(ka)}this.v9b(this.Ttb);this.xib(this.nxb);return[ub]}Bql(ka,bb){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Da.VYi);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(Da.M0k)))?this.Bao(ka,bb):!1}Bao(ka,bb){let ub=0,Xb=ka.length-1,tc;
for(;Xb>=ub;){tc=Math.floor((Xb-ub)/2+ub);const Tc=ka[tc];if(Tc.offsetTop>=bb-2&&Tc.offsetTop<=bb+2)return!0;Tc.offsetTop>bb+2?Xb=tc-1:ub=tc+1}return!1}Tbi(ka){var bb,ub;let Xb=0,tc=0;for(const Tc of ka)if(this.$h.UEf(Tc)){if(this.ah.contentFilterApiEnabled&&this.Yi.$m&&(ka=this.$h.x_(Tc.toString()),null===(ub=(bb=this.YYj).isContentInFilteredContent)||void 0===ub||!ub.call(bb,ka.id)))continue;this.$h.Cui(Tc)?tc+=1:Xb+=1}bb=new Eo;bb.sEd=Xb+tc;bb.vEc=0===Xb;return bb}omc(ka){if(ka=this.wfd.get(ka.objectId)){var bb=
qg.g(ka);bb=this.Tbi(bb);this.pFj(bb,ka)}}pFj(ka,bb){let ub,Xb;if(this.ah.contentFilterApiEnabled&&0===ka.sEd)bb.style.display="none";else if(1===ka.sEd?(ub=ka.vEc?2:0,Xb=ka.vEc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.sEd&&(ub=ka.vEc?3:1,Xb=ka.vEc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),bb.style.display=
"block",ka=bb.firstElementChild)this.hio(ka,ub),ka.title=Xb+". "+ka.title,$g(mm[ub],ka)}hio(ka,bb){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;wf.a.Kl(ka,Da.VFh,bb)}BYl(ka,bb){ka=this.G$k(ka,bb);ka.sort((ub,Xb)=>ub.y-Xb.y);return this.Lbn(ka)}G$k(ka,bb){const ub=[],Xb=this.ah.Wq,tc=this.zoom;ka=qg.f(ka,!0);for(let Tc=0,Md=ka.length;Tc<Md;Tc++){const le=ka[Tc],md=qg.g(le);md&&ub.push(new Fo(le,md,tc,Xb,bb))}return ub}Lbn(ka){let bb=null;const ub=[];for(let Xb=0;Xb<
ka.length;Xb++)bb&&Math.abs(ka[Xb].y-bb.y)<fg.wni+fg.tsm?bb.Uuk(ka[Xb].yEd):(bb=ka[Xb],ub.push(bb));return ub}F$k(ka,bb,ub,Xb){const tc=ka.fh.ownerDocument,Tc=tc.createElement("div");Tc.className=Da.KFh;Tc.style.top=ub+"px";Tc.style.left=Xb+"px";Tc.style.right="auto";Tc.style.zIndex="40";wf.a.Kl(Tc,ve.a.UGc,bb.yEd);bb=tc.createElement("span");this.mmg(bb,Tc);$g(mm[0],bb);this.QB(bb,ka);return Tc}mmg(ka,bb){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");bb.appendChild(ka)}QB(ka,
bb){this.ig.eE(Dk.a.click,ka,this.Ynn.bind(this),bb);this.ig.mb(Dk.a.oB,ka,this.aon.bind(this));this.qk.mb(Dk.a.p0,ka,this.con.bind(this));this.qk.mb(Dk.a.hL,ka,this.bon.bind(this));this.oE.mb(ka,this.$nn.bind(this))}static Gbl(ka){ka=ka.fh.ownerDocument.createElement("div");ka.className=Da.VYi;return ka}$nn(){return!0}aon(){return!0}Ynn(ka){const bb=qg.g(ka.Qw.parentNode);ka.eventName===Dk.a.VJ&&(this.zra.c7e(),this.JDh());this.ga.Qb(vf.a.LFh,2,bb);return!0}con(ka){this.jEa(this.Ttb)!==ka.Qw&&(ka=
qg.g(ka.Qw.parentNode),this.ga.Qb(vf.a.o8e,2,ka));return!0}bon(){this.ga.processAction(vf.a.DEd,2);return!0}v9b(ka){this.JDh();this.Ttb=ka;this.QDk()}QDk(){this.RDk(this.jEa(this.Ttb),this.jEa(this.nxb))}xib(ka){this.AXk();this.nxb=ka;if(ka=this.jEa(this.nxb)){const bb=this.wPd(ka);this.mge(ka,bb,1)}}jEa(ka){if(!ka)return null;let bb=null;if(ka=this.$h.x_(ka))if(ka=ka.Df?this.$h.LD(ka.Df):ka)bb=ka.objectId;return bb&&this.wfd.has(bb)?this.wfd.get(bb).firstChild:null}JDh(){this.CXk(this.jEa(this.Ttb),
this.jEa(this.nxb))}CXk(ka,bb){if(ka){const ub=this.wPd(ka);this.mge(ka,ub,ka===bb?1:3);this.Ttb=null}}RDk(ka,bb){ka&&(ka.title=0<this.zlc.MQf&&1<this.zlc.hIa?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.zlc.MQf,this.zlc.hIa):CommonUIStrings.l_CommentHintTooltip,bb!==ka&&(bb=this.wPd(ka),this.mge(ka,bb,2)))}AXk(){const ka=this.jEa(this.Ttb),bb=this.jEa(this.nxb);if(bb){const ub=this.wPd(bb);this.mge(bb,ub,ka===bb?2:3);this.nxb=null}}mge(ka,bb,ub){this.TKm()?
this.Zho(ka,ub):this.Vjo(ka,bb,ub)}Zho(ka,bb){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===bb||1===bb?"Highlight":"ButtonText")}Vjo(ka,bb,ub){bb=wj[bb];for(let tc=0;tc<bb.length;tc++){var Xb=bb[tc];const Tc=Yd(Xb,ub);if(!this.BHm(Tc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Tc}.`);break}Xb=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Xb);0<(null===
Xb||void 0===Xb?void 0:Xb.length)&&(Xb[0].style.fill=`var(${Tc})`)}}TKm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}wPd(ka){return wf.a.Db(ka,Da.VFh)}BHm(ka){var bb;const ub=document.getElementById(jd.AppFrame.VJc);return!(null===(bb=null===ub||void 0===ub?void 0:ub.style)||void 0===bb||!bb.getPropertyValue(ka))}}Da.KFh="clip16x16 HintContainer";Da.M0k=".clip16x16.HintContainer";Da.VYi="OutlineElementHintMargin";Da.VFh="CommentIconType";Object(f.a)(Da,
"CommentHintActor",fc.a,[559]);var pb=c(1007);class oc extends pb.a{get rdg(){return this.I_()}get yff(){return this.Q5o.Ufi()}constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee){super();this.Xh=ka;this.ks=bb;this.yj=ub;this.taskManager=Xb;this.ryd=tc;this.OI=Tc;this.xh=Md;this.getSelectedText=le;this.Q5o=md;this.focusManager=Ee;this.k_c=()=>{};this.D6d=()=>{};this.vLg=!1;this.OTk={[0]:()=>this.KPh(),[1]:()=>this.Rjc.g2e(),[2]:()=>this.KPh()};this.nWf=()=>{this.ryd.SGa(11)};this.b3e=ef=>{if(this.ks.Gzb)for(const Wf of qg.t)ef.bindAction(Lc.KeyInputManager.BG(Wf),
vj.a.P4e)};this.L7d=()=>{this.D6d()};this.K7d=(ef,Wf)=>{if(ef.name!==Uf.AFrame.Gr&&Wf){var Ag=this.yj.jt?this.yj.jt.id:"";this.Xh.gKb||(this.Xh.gKb=Fh.a.a3(this.taskManager,()=>{this.k_c(Ag)}))}};this.$Wi=()=>{};this.Qlb=()=>{this.Uqj()};this.YRf=(ef,Wf)=>{0===Wf&&(this.OI.Ube(),this.ryd.SGa(0))};this.nTf=()=>{this.ryd.SGa(5)};this.HOc=ef=>{let Wf=0;const Ag=this.yj.BO();for(let Dh=0;Dh<Ag.length;Dh++){if(Ag[Dh].Df||Ag[Dh].done)continue;if((Ag[Dh].Vq===kd.a.beingCreated?Ag[Dh].iz.draftId:Ag[Dh].id)===
ef.contentId)break;const gh=this.Dx.getContentAnchorPosition(Ag[Dh].id);!gh||4<Math.abs(ef.anchorTop-gh.anchorTop)||Wf++}return Wf};this.iSi=()=>{this.OI.Ube()};this.iVf=()=>{this.ryd.SGa(2)};this.Uqj=()=>{if(!this.vLg&&this.xh.Jda){const ef=this.xh.Jda.getElementsByClassName(Da.KFh);for(let Wf=0;Wf<ef.length;Wf++)ef[Wf].style.opacity="1";this.vLg=!0}}}initialize(ka,bb){this.Dx=ka;this.Rjc=bb;this.G3c();this.ks.zCb&&this.JVn()}yho(ka,bb){this.D6d=ka;this.k_c=bb}a6h(ka,bb){return{fZa:this.HQl(ka,bb),
containerContentByType:{}}}P5h(ka,bb){const ub=He.n7h(this.yj.BO(),this.yj.dha),Xb=[],tc=qg.e(!0);var Tc=this.yj.BO();bb=this.CHn(bb,Tc,ub);!bb.o_f&&bb.contentAnchorPosition&&(Xb.push(bb.contentAnchorPosition),bb.contentAnchorPosition=null);for(Tc=0;Tc<tc.length;Tc++){const Md=tc[Tc],le=qg.g(Md);if(le)for(let md=0;md<le.length;md++){const Ee=this.getContentAnchorPosition(ka,ub,Md,le[md]);Ee&&(Xb.push(Ee),bb.o_f&&bb.contentAnchorPosition&&Ee.contentId===bb.o_f.id&&(Xb.push(bb.contentAnchorPosition),
bb.contentAnchorPosition=null))}}bb.contentAnchorPosition&&Xb.splice(0,0,bb.contentAnchorPosition);return{w1k:ub,contentAnchorPositions:Xb}}TFf(){var ka;return!(null===(ka=this.Dx)||void 0===ka||!ka.getAreContainersEnabled())}I_(){return this.yj.b9b()}Ocg(){return this.I_()}$7c(){return this.I_()}wdg(){return this.Dx&&this.xh.Jda&&this.I_()}FJo(){this.OI.T4("OnFloatingCommentsVisibilityChange",this.Xh.L6a);if(this.Xh.L6a)this.xh.ZOb();else{const ka=this.yj.dJ;ka.Cz&&ka.clearSelection();this.xh.bVd()}}PWi(ka){0!==
ka&&this.k_c(this.yj.jt?this.yj.jt.id:"")}getContentAnchorPosition(ka,bb,ub,Xb){let tc=null;return({value:tc}=bb.Dc(Xb.toString(),tc)).returnValue?(bb=tc[0])&&!bb.Df?{...(new Vd.a),anchorTop:(se.a.QNc(ub)-ka)/this.xh.gba,anchorLeft:0,containerContentType:0,contentId:bb.id}:null:null}CHn(ka,bb,ub){var Xb,tc;const Tc={};"CREATE"===(null===(tc=null===(Xb=this.yj.oy)||void 0===Xb?void 0:Xb.iz)||void 0===tc?void 0:tc.sessionType)&&(Xb=this.xh.Jda.querySelectorAll(qg.b),ka=this.xh.x3h((0<Xb.length?Xb[0]:
null)||this.getSelectedText(),this.yj.oy.iz.draftId,0,ka),Tc.o_f=this.W6l(bb,ub),Tc.contentAnchorPosition=ka);return Tc}W6l(ka,bb){var ub=Array.indexOf(ka,this.yj.oy);for(--ub;-1<ub;ub--)if(bb.nb(ka[ub].objectId))return ka[ub]}HQl(ka,bb){return this.P5h(ka,bb).contentAnchorPositions}G3c(){this.OI.D9("OnAfterTrackChangeMarkupViewChange",(ka,bb)=>{if(bb)this.OTk[bb.Fj]()})}JVn(){this.OI.D9("OnFloatingCommentsToggle",this.FJo.bind(this))}KPh(){const ka=qg.i();if(0!==ka.length){var bb=He.n7h(this.yj.BO()),
ub=this.yj.dJ;for(let Xb=0;Xb<ka.length;Xb++){const tc=qg.g(ka[Xb]);for(let Tc=0;Tc<tc.length;Tc++){let Md;({value:Md}=bb.Dc(tc[Tc].toString(),Md)).returnValue&&(Md.forEach(le=>{var md;le&&!le.Df&&(this.Rjc.deleteContainer(le.id,0,!1),(null===(md=ub.Cz)||void 0===md?void 0:md.id)===le.id&&ub.clearSelection())}),this.focusManager.mg(Uf.AFrame.Pn))}}}}}Object(f.a)(oc,"CommentFloatingContainerActor",pb.a,[565]);var Mc=c(1474),$c=c(2031),$d=c(193);class jc extends Mc.a{constructor(ka,bb,ub,Xb,tc,Tc,Md,
le,md){super();this.k$j=ka;this.A9a=bb;this.Fve=ub;this.si=tc;this.u$=le;this.P1=md;this.Xi=null;this.Fj=1;Xb.execute(Ee=>{this.Xi=Ee});this.o2=[];this.iqc=new $d.ScriptSharpLegacyMap;this.ATn(Tc,Md);this.G3c()}get vj(){return this.k$j.value}get commentEditor(){return this.A9a}get Oba(){return!!this.Xi}get yib(){return 0}get X1a(){return this.o2}get aYg(){return this.iqc.nb(this.Fj)?this.iqc.J(this.Fj):this.iqc.J(0)}wQa(ka){return this.u$.wQa(ka)}p1a(ka,bb){if(ka=Object(Ab.a)(560,ka))for(const ub of this.THn(ka))bb.add(ub)}rGa(ka,
bb){this.Oba&&this.si.he(()=>{this.Fqn(ka,bb)},"CHA:OPHC")}Fqn(ka,bb){if(this.Xi.Jo.b9b()){var ub=this.Cu.jDa,Xb=new za.a(new cf.a),tc=bb.LGa("*"),Tc=this.jQl(ub),Md=!!ub&&!ub.action||!!Tc&&Tc===this.Xi.Cz,le;this.si.he(()=>{this.Fve.Y4l(ka.id,Xb,null===Tc||void 0===Tc?void 0:Tc.objectId)},"OPHC:GOI");this.si.he(()=>{le=this.aYg.Sxh(tc,Tc,Xb,Md);le.Bui=this.zui(ub)&&0===ub.action},"OPHC:BHI");this.si.he(()=>{this.aYg.nth(tc,le,Md)},"OPHC:AH")}}jQl(ka){let bb=null;!this.zui(ka)||0!==ka.action&&2!==
ka.action||(bb=this.Cu.jDa.xA);return bb||this.Xi.Cz}THn(ka){if(!ka)return[];ka=this.vj.Db(la.a.Ff(ka.objectId));return this.commentEditor.QQd(ka,null)}n9i(){return!1}yF(ka,bb,ub){this.Oba&&(ka=Object.assign(new $c.a,{action:ka,type:0,xA:bb,JJ:ub}),this.Cu.yF(ka))}c7e(){this.Oba&&(this.yF(3,this.Xi.B9b,this.Xi.B9b),this.Xi.B9b=null)}ATn(ka,bb){this.iqc.add(1,ka);this.iqc.add(0,bb)}G3c(){this.P1.D9("OnBeforeTrackChangeMarkupViewChange",(ka,bb)=>{bb&&bb.wQf!==this.Fj&&(this.Fj=bb.wQf)})}zui(ka){return ka&&
0===ka.type}}Object(f.a)(jc,"CommentHighlightActor",Mc.a,[563,564]);var $e=c(1026),Wc=c(361),Ng=c(498),Re=c(1508);class Ah{constructor(ka,bb){this.i1k=ka;this.RRf=bb}}Object(f.a)(Ah,"CommentEndParaIdBeforeChangeInfo",null,[]);var hi=c(1608);class Sj{constructor(ka,bb,ub,Xb,tc,Tc,Md,le){this.NIf=ka;this.Xh=bb;this.yj=ub;this.OI=Xb;this.Oo=tc;this.Jk=Tc;this.F0k=Md;this.ks=le;this.Qrb=null;this.DHn=(md,Ee)=>{(md=Ee.commentNode)&&!qg.s(md)&&(Ee=this.yj.gof(md),la.a.Zp(Ee.a9c,Ee.DKc)||this.QEj(Ee,md)||
this.vCh(Ee.RCa,Ee.tNa,md)||this.ymg(md))};this.lkn=(md,Ee)=>{Ee.property===qa.a.hva&&(md=qg.h(Ee.node,la.a.nil),this.Qrb=new Ah(Ee.node.id,md))};this.wln=(md,Ee)=>{md=Ee.node;if(Ee.property===qa.a.hva&&md){var ef=qg.k(md,la.a.nil);Ee=qg.h(md,la.a.nil);var Wf=this.Qrb?this.od.Db(this.Qrb.RRf):null;!qg.s(md)&&ef&&!ef.equals(Ee)&&this.Qrb&&md.id.equals(this.Qrb.i1k)&&!ef.equals(this.Qrb.RRf)&&Wf&&Wf.isConnected&&this.XYe(this.Qrb.RRf,md.id);Ee&&this.Xh.Ox.nb(Ee)&&(ef=this.Xh.Ox.J(Ee),ef.P1a&&(a.ULS.shipAssertTag(572835481,
327,!!ef.NM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),ef.NM&&ef.NM.contains(md.id)&&(ef.NM.remove(md.id),ef.NM.count||(ef.P1a=!1),this.Xh.KU.nb(md.id)?this.Xh.KU.J(md.id).remove(Ee):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.I_c=(md,Ee)=>{md=Ee.node.id;this.Xh.Ox.nb(md)&&this.IZn(md)};this.Wjn=(md,Ee)=>{Ee&&Ee.node&&this.YUa.nb(Ee.node)&&(md=this.YUa.J(Ee.node).L8d,this.YUa.nb(md)||(md=this.YUa.J(Ee.node),
this.vCh(md.Xbf?md.currentNode:md.L8d,md.Xbf?md.L8d:md.currentNode,md.commentNode)||this.ymg(md.commentNode)),this.YUa.remove(Ee.node))};this.zln=(md,Ee)=>{const ef=md.Xj;if(!Ee&&this.Qbb.nb(ef)){var Wf;(Wf=this.Qbb).Z(ef,Wf.J(ef)&(md.Mc?-2:-3));this.Qbb.J(ef)||(this.ymg(this.od.Db(ef)),this.Qbb.remove(ef))}};this.YUa=new Ng.a(new $e.a);this.Qbb=new zf.a(qg.c);this.OI.D9("OnCommentNodeAdded",this.DHn);this.ks.contentFilterApiEnabled?(this.OI.D9("OnCommentPaneOpen",this.rDm.bind(this)),this.OI.D9("OnCommentPaneClose",
this.qDm.bind(this)),this.OI.D9("OnContentFilterUpdate",this.z_c.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(md=>{this.OI.D9(md,this.oDm.bind(this))});this.ks.zCb&&this.OI.D9("OnFloatingCommentsVisibilityChange",this.pDm.bind(this));ka=this.Oo.Ye(12);ka.Ow(this.I_c);ka.Vt(this.Wjn);this.Oo.Ye(40).JDc(this.lkn);this.Oo.Ye(40).Go(this.wln);Wc.a.mSa(this.zln)}get hx(){return this.NIf.value}get od(){return this.hx.od}Y4l(ka,bb,ub){if(this.Yyn(ka))for(const Xb of this.Xh.Ox.J(ka).NM)!this.Woj(Xb,
ub===Xb.toString())||bb.add(Xb)}Woj(ka,bb){const ub=this.od.Db(ka),Xb=qg.s(ub);if(!ub||Xb)return!1;ka=this.yj.x_(ka.toString());return!ka||this.ks.contentFilterApiEnabled&&this.Xh.$m&&!this.F0k.isContentInFilteredContent(ka.id)||!this.Xh.$m&&!this.yj.dha(ka)&&!bb?!1:!0}Yyn(ka){return this.Eyn(ka)}ymg(ka){if(ka){var bb=Re.a.QQd(ka,null),ub=new Ra.a;for(let Xb=1;Xb<bb.length-1;Xb++)this.XYe(bb[Xb].id,ka.id),ub.add(bb[Xb]);Hf.b(ub)}}pDm(){const ka=new Ra.a;for(const bb of this.yj.BO())!bb.Df&&bb.Vq!==
kd.a.beingCreated&&this.yj.dha(bb)&&this.yj.Cne(bb,ka);Hf.b(ka)}Eyn(ka){if(!this.Xh.gY)return!1;let bb=null;if(({value:bb}=this.Xh.Ox.Dc(ka,bb)).returnValue)return bb.P1a;let ub=!1;this.Jk.he(()=>{const Xb=qg.e();for(let tc=0;tc<Xb.length;tc++)ub=this.iWo(Xb[tc],ka,ub);ub||(this.Xh.Ox.add(ka,new hi.a),this.Xh.Ox.J(ka).P1a=!1)},"CHORA:PHOC");return ub}iWo(ka,bb,ub){ka=qg.g(ka);if(!ka)return ub;for(let Xb=0;Xb<ka.length;Xb++){const tc=this.od.Db(ka[Xb]);tc&&!qg.s(tc)&&(ub=ub||this.nUk(tc,bb))}return ub}nUk(ka,
bb){var ub=this.yj.gof(ka);if(this.QEj(ub,ka))return!1;var Xb=ub.a9c;const tc=ub.DKc;ub=ub.RCa;if(Xb!==la.a.nil&&(Xb.equals(tc)||Xb.equals(bb)))return!1;for(Xb=Ua.ParagraphReader.jg(ub,!1);Xb&&!Xb.id.equals(tc);){if(Xb.id.equals(bb))return this.XYe(bb,ka.id),!0;Xb=Ua.ParagraphReader.jg(Xb,!1)}return!1}XYe(ka,bb){this.Xh.KU.nb(bb)||this.Xh.KU.add(bb,new za.a(new cf.a));this.Xh.KU.J(bb).add(ka);this.Xh.Ox.nb(ka)?this.Xh.Ox.J(ka).NM||(this.Xh.Ox.J(ka).NM=new za.a(new cf.a)):this.Xh.Ox.add(ka,new hi.a(!0));
this.Xh.Ox.J(ka).P1a=!0;this.Xh.Ox.J(ka).NM.add(bb)}IZn(ka){if(this.Xh.Ox.J(ka).NM)for(const bb of this.Xh.Ox.J(ka).NM)this.Xh.KU.nb(bb)?this.Xh.KU.J(bb).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Xh.Ox.remove(ka)}oDm(){const ka=new Ra.a;for(const bb of this.yj.BO())bb.Df||bb.Vq===kd.a.beingCreated||this.yj.dha(bb)||this.yj.Cne(bb,ka);Hf.b(ka)}rDm(){this.XAf("OnCommentPaneOpen")}z_c(){this.XAf("OnContentFilterUpdate")}qDm(){this.XAf("OnCommentPaneClose")}XAf(ka){const bb=
new Ra.a;for(const ub of this.yj.BO())ub.Df||ub.Vq===kd.a.beingCreated||this.yj.dJ.kAh(ka,ub)||this.yj.Cne(ub,bb);Hf.b(bb)}QEj(ka,bb){let ub=!1;if(!ka.xje||!ka.TJd){ub=!0;if(!ka.RCa||!ka.tNa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.RCa,!ka.tNa),!0;ka.xje||this.YUa.nb(ka.RCa)||this.YUa.add(ka.RCa,{commentNode:bb,currentNode:ka.RCa,L8d:ka.tNa,Xbf:!0});ka.TJd||this.YUa.nb(ka.tNa)||this.YUa.add(ka.tNa,{commentNode:bb,currentNode:ka.tNa,L8d:ka.RCa,
Xbf:!1})}return ub}vCh(ka,bb,ub){ka=Re.a.Ava(ka,ub.id,!0);bb=Re.a.Ava(bb,ub.id,!1);let Xb;ka||({value:Xb}=this.Qbb.Dc(ub.id,Xb),this.Qbb.Z(ub.id,Xb&1));bb||({value:Xb}=this.Qbb.Dc(ub.id,Xb),this.Qbb.Z(ub.id,Xb&2));return!ka||!bb}}Object(f.a)(Sj,"CommentHighlightOnRestActor",null,[562]);var al=c(536),fj=c(415),yk=c(626);class dn{constructor(ka,bb){this.Ayb=ka;this.nka=bb}getViewContainer(){return this.Ayb}registerForViewContainerEvents(ka){this.nka.hXn(ka)}unregisterForViewContainerEvents(ka){this.nka.cRo(ka)}}
Object(f.a)(dn,"ViewContainerProvider",null,[1118]);class Ji{constructor(ka,bb,ub,Xb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=bb;this.uiCulture=ub;this.dataCulture=Xb}}Object(f.a)(Ji,"LocalizationDetails",null,[]);var nm=c(1138),Lg=c(1520);class sf{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag,Dh,gh,gl,Al,Pm,ck,Zf,qk,vn,zh,Qm,Hl,en,mi,um,fn,im,Vp){this.Uq=ka;this.yj=bb;this.R2b=ub;this.h_=Xb;this.ks=tc;this.Xh=Tc;this.oMd=
Md;this.w9b=le;this.Eq=md;this.oc=Ee;this.dynamicScriptLoader=ef;this.S7n=Wf;this.focusManager=Ag;this.w8e=Dh;this.s8e=gh;this.omh=gl;this.b1o=Al;this.V0=Pm;this.OI=ck;this.A9n=Zf;this.nyl=qk;this.KRi=vn;this.c1o=zh;this.JAb=Qm;this.pT=Hl;this.xh=en;this.cN=mi;this.H9e=um;this.P4a=fn;this.EEd=im;this.M4k=Vp;this.ild=this.lXa=null;this.uZg=!1;this.BLe=[];this.fdh=this.vZg=!1;this.initialize=(vm,Il)=>{this.vxm(Il)};this.ugl=vm=>Un.a.d$e(vm);this.Aln=()=>{this.wqi()};this.zWl=(vm,Il,Fi)=>{vm={...(new nm.a),
containerPanel:vm,paneOpenedCallback:Il,paneClosedCallback:Fi,ulsLogger:new al.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.xh.Wof(),destroyAllContainersCallback:()=>{this.Xh.$m||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.ks.pMd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.ks.trackChangeInSidetrackEnabled,
improveJumpingFixEnabled:!1,shouldInitialize:!this.ks.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.ks.contentNavigationApiEnabled,contentFilterApiEnabled:this.ks.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.ks.contentNavigationApiEnabled&&(vm.sidetrackContentNavigationApi=this.H9e,vm.featureGateApiSettings=this.pT.yff,vm.telemetryDetails=this.KRi,this.ks.contentFilterApiEnabled&&(vm.contentFilterAPI=this.M4k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(vm)};
this.qnn=vm=>{2!==this.Uq.mode&&3!==this.Uq.mode&&this.yj.jt&&vm===this.yj.jt.id&&this.Uq.clearSelection();U.App.xa.updateCommandUI(!0)};this.ZSi=(vm,Il)=>{this.yx("onCSCStart",window.performance.now());this.ldb&&!vm&&(this.yvn(),this.yx("openInFishbowl",!0));this.R2b.pdb&&this.ks.UBb&&this.oc.processAction(vf.a.newComment,2);Il&&Il();this.yx("onCSCEnd",window.performance.now())};this.OI.D9("OnCommentInit",this.initialize);this.OI.D9("OnCommentRenderedOnce",this.Aln);this.pT.yho(()=>{},this.qnn)}get YJa(){return this.Uq}get ldb(){return this.Xh.ldb}yx(ka,
bb){this.P4a.yx(Qi.a.comments,ka,bb,!0)}vxm(ka){if(this.Xh.gY)ka&&ka.eGa&&ka.eGa();else if(this.uZg)(null===ka||void 0===ka?0:ka.eGa)&&this.BLe.push(ka.eGa);else{var bb=this.ks.c9b;this.yx("hasCommentOnBoot",bb);bb?this.JAb.logKpiUsage(Lg.a.Q2b,0):fj.a.aec("canvas","floatingComments");this.uZg=!0;this.yx("initInProgress",!0);this.yj.initialize(this.Uq);this.R2b.initialize(this.Uq,null);this.R2b.coj(this.Uq);this.w9b.pym(this.h_.cmo);this.yx("InitAMSetup",window.performance.now());yk.a.Bp(this.nyl).continueWith(ub=>
{(this.lXa=ub.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.w8e.initialize(this.lXa);this.YJa.k8e.initialize(this.YJa,this.yj,this.lXa,this.w8e);this.omh.initialize(this.dynamicScriptLoader,this.YJa.k8e,this.KRi,this.lXa,new dn(this.b1o,this.c1o),this.Gai(),"",this.w8e.Ufi(),this.V0,U.App.uhe);this.yx("AMInitialized",window.performance.now());this.ks.contentNavigationApiEnabled?(U.App.hDb?U.App.hDb:this.xh.aGi()).then(()=>{this.yx("FCMLoaded",
window.performance.now());this.A7c();this.DWd(ka)}):this.DWd(ka)})}}zEn(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.ugl)}DWd(ka){this.ild=this.omh.DWd(void 0,this.zEn.bind(this));this.qSc(ka);this.Xh.gY=!0;this.ks.Teg&&this.s8e.initialize()}qSc(ka){if(!this.Xh.lGb){this.yx("InitCSStart",window.performance.now());var bb=this.Eq.$f("Task","InitiateCommentingSession");this.JAb.logKpiUsage(Lg.a.WFh,0);try{const ub=this.Eq.$f("Task","InitiateCommentingSession-UpdateModel");
this.EEd.Nxm();ub.stop();this.yx("initAtBoot",window.performance.now());this.ks.Wq&&this.yj.b9b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",F.a.Ze()));Hd.a.get_instance().aI(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Xh.lGb=!0;this.ild.then(()=>{this.yx("SCLoaded",window.performance.now());this.xh.gym();this.yx("FCMInitiated",window.performance.now());if(this.ks.Wq){let tc=!1;if(this.ldb){var Xb=
this.h_.fOd(this.ldb);Xb?(y.AFrameworkApplication.te("3ge3g205;cha3g788"),Xb=this.h_.gOd(Xb,0),Xb)?this.yj.dha(Xb)||(tc=!0,this.zvn(Xb)):(tc=!0,this.t4a()):tc=!0}Xb=ka?ka.RTi:null;this.ks.contentNavigationApiEnabled?this.ZSi(tc,Xb):this.l_m(tc,Xb)}ka&&ka.eGa&&ka.eGa();for(const tc of this.BLe)tc();this.vZg&&this.wqi();this.BLe=[]})}catch(ub){a.ULS.eD(539567713,327,10,ub,`Comments Initialization Failed: ${ub}`),this.JAb.logKpiFailure(Lg.a.WFh,"CommentsInitializationFailed",{isInternal:!0},{name:Lg.a.P2b,
isInternal:!0})}finally{bb.stop(),this.yx("InitCSEnd",window.performance.now())}this.oc.processAction(vf.a.yFh,2)}}zvn(ka){this.oc.processAction(vf.a.mV,2);this.pT.Uqj();Fh.a.a3(y.AFrameworkApplication.pc,()=>{this.h_.selectComment(ka,{...(new zd.a),LR:!0,K9:1});this.focusManager.mg(Uf.AFrame.Gr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.WW)},Zi.a.hbo);this.JAb.Mv(vf.a.n8e);y.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}t4a(){this.oc.processAction(vf.a.t4a,
2)}l_m(ka,bb){(U.App.hDb?U.App.hDb:this.xh.aGi()).then(()=>{this.yx("FCMLoaded",window.performance.now());this.A7c();this.ZSi(ka,bb)}).catch(ub=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+ub.toString())})}A7c(){this.cN.trackChangeInSidetrackEnabled?(this.oMd.A7c(),this.yx("STSet",window.performance.now())):this.oMd.goj(this.zWl)}wqi(){this.fdh||(this.Xh.gY&&this.ild?(this.ild.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
this.A9n.execute(bb=>{ka.registerSafelinksNavigator(bb.Ylc.bind(bb))});this.S7n.execute(bb=>{bb.DTn(ka)})}),this.fdh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.vZg=!0))}Gai(){return new Ji(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}yvn(){this.h_.mhj(this.ldb,{...(new zd.a),mdg:!1,ITc:!0});this.JAb.Mv(vf.a.n8e)}}Object(f.a)(sf,"CommentInitActor",
null,[]);class ne{constructor(ka,bb,ub,Xb,tc){this.ig=ka;this.oE=bb;this.ga=ub;this.ZYj=Xb;this.mj=tc;this.ioe=this.OVa=null}get zoom(){let ka=1;this.mj&&this.mj.instance&&(ka=this.mj.instance.hj);return 0<ka?ka:1}Ozl(ka,bb){if(!this.ioe||!ka.nwa||bb>=ka.nwa.length)return null;const ub=this.zoom,Xb=ka.M4,tc=ka.geb(1,fg.nzf,ub,bb);return this.O9k(ka.nwa[bb],Xb,(this.ioe.y-ka.Vba[bb].y)/ub+fg.oLj,tc)}O9k(ka,bb,ub,Xb){if(this.OVa)return(bb=this.OVa.parentElement)&&bb.removeChild(this.OVa),this.Sjj(ka,
this.OVa,ub,Xb),this.OVa;const tc=bb.fh.ownerDocument,Tc=tc.createElement("div");Tc.className=ne.C0k;this.Sjj(ka,Tc,ub,Xb);ka=tc.createElement("span");this.mmg(ka,Tc);$g(mm[4],ka);this.QUn(ka,bb);return this.OVa=Tc}mmg(ka,bb){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");bb.appendChild(ka)}QUn(ka,bb){this.ig.eE(Dk.a.click,ka,this.Ymn.bind(this),bb);this.ig.mb(Dk.a.oB,ka,this.$mn.bind(this));this.oE.mb(ka,this.Zmn.bind(this))}WUd(){if(this.OVa){const ka=this.OVa.parentElement;
ka&&ka.removeChild(this.OVa)}}Sjj(ka,bb,ub,Xb){this.ZYj.Bql(ka,ub)?bb.style.left=Xb+fg.nzf+"px":bb.style.left=Xb+"px";bb.style.top=ub+"px";bb.style.right="auto";bb.style.display="block";bb.style.position="absolute";bb.style.overflow="hidden";bb.style.cursor="default";bb.style.zIndex="40"}$mn(){return!0}Ymn(ka){this.ga.AD=30;this.ga.processAction(vf.a.newComment,2);ka=ka.Qw;$g(mm[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}Zmn(){return!0}}
ne.C0k="clip16x16 EntryPointContainer";Object(f.a)(ne,"CommentMarginEntryPointActor",null,[]);var ke=c(418),We=c(75),de=c(223),vl=c(33),Um=c(116);class Th{constructor(ka,bb,ub,Xb,tc,Tc,Md){this.NIf=ka;this.$Xm=bb;this.Jo=ub;this.Xh=Xb;this.ks=tc;this.q8e=Tc;this.JAb=Md;this.N3i=new Set;this.UIb=new Set;this.m0c=new de.a;this.S2b=new Map;this.aGh=L.a.instance.Ue("Box4.CommentParagraphMapping");this.KAb=new Set;this.Efa=this.eOd()}get hx(){return this.NIf.value}get od(){return this.hx.od}get UCa(){return this.$Xm.value}eOd(){const ka=
new ad.GraphIterator;ka.set(this.hx);this.UCa.o4a(ka);return ka}Nxm(){this.Xh.lGb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",vl.Debug.E0a());this.ks.contentNavigationApiEnabled||(this.ks.c9b&&this.Lxm(),this.Jo.$Ui())}Dkn(){this.$dj();this.KAb.forEach(ka=>{this.Xug(ka)});this.KAb.clear();this.Jo.$Ui()}Xug(ka){if(ke.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);
var bb=this.S2b.get(ka).fkc,ub=this.S2b.get(ka).x5b;bb===la.a.nil||ub===la.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${bb} or end ${ub} has invalid value`):(this.aGh.value.XZa.set(ka,bb),this.aGh.value.WZa.set(ka,ub),a.ULS.sendTraceTag(512235651,327,50,`Start ${bb} and End ${ub} mapping info for Comment ${ka} added on Comment Model load`))}}sAm(ka){const bb=[];for(const ub of ka)ka=ub.Xj.toString(),this.uEj(ka,ub.paragraph.id,ub.Mc),ub.Mc&&(this.N3i.has(ka)?a.ULS.sendTraceTag(523334301,327,
50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",ub.Xj):(this.N3i.add(ka),(ka=this.Yqk(ub))&&bb.push(ka)));return bb}uEj(ka,bb,ub){ke.a.isEnabled&&(this.S2b.has(ka)||this.S2b.set(ka,{fkc:la.a.nil,x5b:la.a.nil}),ub?this.S2b.get(ka).fkc=bb:this.S2b.get(ka).x5b=bb)}Yqk(ka){var bb=this.od.Db(ka.Xj);this.Efa.Fi(bb);if(40!==this.Efa.Ve||!bb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",
!bb,!ka.Xj),this.Efa=39===this.Efa.Ve?this.Efa:this.eOd(),null;bb=this.Jo.qGd(this.Efa);let ub;if(({index:ub}=this.Jo.rme(bb)).returnValue)if(this.Jo.tYe(bb,ub),this.UIb.add(bb.objectId),qg.p(bb)||this.KAb.add(bb.objectId),bb.Df)this.Bkf(bb);else return{contentId:bb.id,containerContentType:0,x9:{yd:ka.Ib.cp,MM:ka.paragraph.Al}};else this.m0c.add(bb);return null}Bkf(ka){if(ka.Df){var bb=this.Jo.LD(ka.Df);if(bb&&bb.Df){const ub=this.Jo.LD(bb.Df);ub&&(ub.Df?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):
(ka.Df=bb.Df,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${bb.objectId}`)))}}}Lxm(){const ka=new M.a(0),bb=We.a.Zo(this.Jo.SIa),ub=new Set;this.ks.Xwn&&!ke.a.isEnabled&&this.ftk(bb,ka);const Xb=this.eOd(),tc=new Set,Tc=new Set,Md=new ji.GraphTransaction(2);try{if(Md.ku(Xb),Xb.Nr(1)){for(;bb.moveNext();){if(!Ua.ParagraphReader.sh(bb.iterator))continue;const md=bb.iterator.currentNode,Ee=Ua.ParagraphReader.PDb(md);ke.a.isEnabled&&
this.c$m(md,Ee,ka);ub.add(md.id.toString());this.h3i(Ee,Tc,Xb,tc)}this.$dj();const le=this.kQl(ub);0<le.length&&this.i7n(le,ub,Xb,Tc);this.KAb.forEach(md=>{this.Xug(md)});this.KAb.clear()}}finally{Md&&Md.dispose()}0==this.UIb.size&&this.ks.c9b&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");ac.a.X3m(tc,Tc,this.od)}h3i(ka,bb,ub,Xb){for(const tc of ka){ka=this.ks.Wq?!tc.Mc:tc.Mc;const Tc=tc.Xj.toString();this.uEj(Tc,tc.paragraph.id,tc.Mc);ka?bb.has(Tc)||
Xb.add(Tc):bb.has(Tc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",tc.Xj):(bb.add(Tc),this.Zqk(tc,ub))}}i7n(ka,bb,ub,Xb){const tc=this.g6l(ka);ac.a.mVk(tc);const Tc=new Set,Md=new Set;tc.forEach(md=>{bb.has(md.id.toString())||Md.has(md.id.toString())||(Md.add(md.id.toString()),md=Ua.ParagraphReader.PDb(md),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${md.length} CommentRangeObjects`),this.h3i(md,Xb,ub,Tc))});const le=[];ka.forEach(md=>{this.UIb.has(md)||
le.push(md)});0<le.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${le.length} Failed To Load on Retry: ${le.join(",")}`),this.JAb.logKpiFailure(Lg.a.Q2b,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:Lg.a.P2b,isInternal:!0}))}g6l(ka){const bb=[];ka.forEach(ub=>{if(ub=this.q8e.N5h(ub))ub=qg.k(ub),(ub=this.od.Db(ub))&&ub.pj&&bb.push(ub)});return bb}Zqk(ka,bb){const ub=this.od.Db(ka.Xj);bb.Fi(ub);40===bb.Ve&&ub?(ka=this.Jo.qGd(bb),({index:bb}=this.Jo.rme(ka)).returnValue?(this.Jo.tYe(ka,
bb),this.UIb.add(ka.objectId),qg.p(ka)||this.KAb.add(ka.objectId),ka.Df&&this.Bkf(ka)):this.m0c.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!ub,!ka.Xj),39===bb.Ve||this.eOd())}kQl(ka){const bb=[],ub=this.q8e.eQl();if(this.UIb.size===ub.length)return bb;ub.forEach(Xb=>{!this.UIb.has(Xb)&&ac.a.ZTm(Xb,ka,this.q8e,this.od)&&bb.push(Xb)});return bb}$dj(){for(let ka=0;ka<this.m0c.length;ka++){const bb=this.m0c.J(ka);
let ub;({index:ub}=this.Jo.rme(bb)).returnValue?(this.Jo.tYe(bb,ub),qg.p(bb)||this.KAb.add(bb.objectId),this.UIb.add(bb.objectId),bb.Df&&this.Bkf(bb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",bb.nPa,bb.X_a,bb.objectId,bb.Df))}this.m0c.clear()}ftk(ka,bb){ka.oo(ub=>{if(11===ub.Ve){var Xb=ub.currentNode;const tc=Xb.ia(Um.a.z8e,null),Tc=Xb.ia(Um.a.x8e,null);ub=!!tc&&0<tc.length;const Md=
!!Tc&&0<Tc.length;ub&&tc.forEach(md=>{const Ee=this.od.Db(md);Ee&&!qg.s(Ee)&&bb.add(md,0)});Md&&Tc.forEach(md=>{bb.nb(md)&&bb.remove(md)});(Xb=Xb.ia(Ic.a.KK,null))&&Xb.forEach(md=>{const Ee=this.od.Db(md);Ua.ParagraphReader.Vb(Ee)&&!this.Xh.Ox.nb(md)&&this.Xh.Ox.add(md,new hi.a)});const le=bb.keys;for(let md=0;md<le.length;md++){Xb&&0<bb.J(le.J(md))&&(this.Xh.KU.nb(le.J(md))||this.Xh.KU.add(le.J(md),new za.a(new cf.a)),Xb.forEach(ef=>{const Wf=this.od.Db(ef);Ua.ParagraphReader.Vb(Wf)&&(this.Xh.Ox.J(ef).NM||
(this.Xh.Ox.J(ef).NM=new za.a(new cf.a)),this.Xh.KU.J(le.J(md)).add(ef),this.Xh.Ox.J(ef).P1a=!0,this.Xh.Ox.J(ef).NM.add(le.J(md)))}));let Ee;bb.Z(Ee=bb.keys.J(md),bb.J(Ee)+1)}return ub||Md}return!0},null)}c$m(ka,bb,ub){ka&&(this.pSj(bb,ub),this.Xh.Ox.nb(ka.id)||this.Xh.Ox.add(ka.id,new hi.a),ub.forEach((Xb,tc)=>{0<tc&&(this.Xh.KU.nb(Xb)||this.Xh.KU.add(Xb,new za.a(new cf.a)),this.Xh.Ox.J(ka.id).NM||(this.Xh.Ox.J(ka.id).NM=new za.a(new cf.a)),this.Xh.KU.J(Xb).add(ka.id),this.Xh.Ox.J(ka.id).P1a=!0,
this.Xh.Ox.J(ka.id).NM.add(Xb));ub.Z(Xb,tc+1);return!0}))}pSj(ka,bb){ka.forEach(ub=>{if(ub.Mc){const Xb=this.od.Db(ub.Xj);Xb&&!qg.s(Xb)&&bb.Z(ub.Xj,0)}else bb.nb(ub.Xj)&&bb.remove(ub.Xj)})}}Object(f.a)(Th,"CommentModelBootLoader",null,[558]);var Gk=c(1036);class Ye{constructor(ka){this.YFh=ka;this.ctc=null;this.x6g=void 0;this.y6g=null;this.Lxc=new Map;this.Uye=new Map}YWn(){Gk.a.mSa(this.VSo.bind(this))}VSo(ka,bb){const ub=ka.id.toString();var Xb=ka.getValue(qa.a.XE).toString();bb?(this.Lxc.delete(ub),
this.Uye.delete(Xb)):(this.Lxc.set(ub,ka),this.Uye.set(Xb,ka));0===this.Lxc.size&&this.ctc&&(ka=+new Date-+this.ctc,this.ctc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));bb||this.x6g!==Xb||(bb=+new Date-+this.y6g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${bb}`),Xb=new I.a,Xb.durationMs=bb,this.YFh.logKpiFailure(Lg.a.uEd,"CommentFoundAfterDeeplinkAttempt",
{isInternal:!0,additionalValues:Xb},{name:Lg.a.EFh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Xb}));this.ctc||(this.ctc=new Date)}set edn(ka){this.x6g=ka;this.y6g=new Date;if(ka=this.cQl(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),ka=new I.a,this.YFh.logKpiFailure(Lg.a.uEd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Lg.a.EFh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}eQl(){return[...this.Lxc.keys()]}cQl(ka){return this.Uye.get(ka)}N5h(ka){return this.Lxc.get(ka)}}
Object(f.a)(Ye,"CommentNodeTracker",null,[]);class rf{get contentType(){return 0}constructor(ka,bb,ub,Xb,tc){this.Y7f=ka;this.Jo=bb;this.h_=ub;this.dJ=Xb;this.Xh=tc;this.Y7f.M8i(this)}qhj(ka,bb,ub){0===bb?(bb=this.Jo.OTc(ka),this.h_.selectComment(bb?this.Jo.oy:this.Jo.LD(ka),Object.assign(new zd.a,{LR:ub||bb,K9:1}))):this.dJ.clearSelection()}Bpj(ka){return this.Xh.$m||this.Jo.OTc(ka.contentId)?!0:this.Jo.dha(this.Jo.LD(ka.contentId))}}Object(f.a)(rf,"CommentReviewSuggestionContentActor",null,[557]);
class Dp{get lwj(){return this.Pgg}constructor(ka,bb){this.EEd=ka;this.ks=bb;this.Pgg=new Set([12])}initialize(){}iGi(ka){if(!Ua.ParagraphReader.Vb(ka.node))return[];ka=Ua.ParagraphReader.PDb(ka.node);return this.EEd.sAm(ka)}GSi(){this.EEd.Dkn()}Kli(){return this.ks.Txo?this.ks.c9b:!0}}Object(f.a)(Dp,"CommentReviewSuggestionContentProvider",null,[555]);var Hk=c(67),ch=c(126),ar=c(246),ah=c(1571);class Mg{constructor(){this.commentId=null;this.CVc=!1}}Object(f.a)(Mg,"CommentToSelectOnPaneLoadData",
null,[]);class ue{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag,Dh,gh){this.Uq=ka;this.Jo=bb;this.TCa=ub;this.h_=Xb;this.OI=tc;this.Xh=Tc;this.oMd=Md;this.ks=le;this.R2b=md;this.G3a=Ee;this.oc=ef;this.OIf=Wf;this.focusManager=Ag;this.Jk=Dh;this.f1k=gh;this.oc.qa(vf.a.UOb,Hk.a.frame,this.Uq.UOb.bind(this.Uq));this.oc.qa(vf.a.hJd,Hk.a.frame,this.hJd.bind(this));this.oc.qa(vf.a.l8e,Hk.a.frame,this.sln.bind(this));this.oc.qa(vf.a.q0k,Hk.a.frame,this.rln.bind(this));this.oc.qa(vf.a.MPi,Hk.a.frame,
this.Ypn.bind(this));this.oc.qa(vf.a.TRh,Hk.a.frame,this.Emn.bind(this));this.oc.qa(vf.a.LFh,Hk.a.frame,this.Znn.bind(this));this.oc.fb(vf.a.o8e,Hk.a.frame,this.ADk.bind(this),64);this.oc.fb(vf.a.DEd,Hk.a.frame,this.rYn.bind(this),64);this.oc.qa(vj.a.selectComment,Hk.a.frame,this.h_.ebo.bind(this.h_));this.ks.GYm&&this.oc.qa(vj.a.M0d,Hk.a.frame,this.M0d.bind(this));this.mnh(vj.a.cJc,!1);this.mnh(vj.a.hdf,!0);this.oc.fb(vj.a.FEd,Hk.a.frame,this.FEd.bind(this),64);this.ks.zCb&&this.oc.qa(vj.a.ujg,Hk.a.frame,
this.dun.bind(this));this.oc.qa(vj.a.PIi,Hk.a.frame,ch.ActionManager.Pf);this.ks.Gzb&&this.oc.qa(vj.a.P4e,Hk.a.frame,this.dPk.bind(this));this.oc.qa(vj.a.JPh,Hk.a.frame,(gl,Al)=>ar.a.kha(Al.$j)&&ar.a.kac()?8:32)}get yj(){return this.Jo}get mode(){return this.Uq.mode}get Cz(){return this.Uq.Cz}get mA(){return this.ks.Wq}get vj(){return this.G3a.value}get lb(){return this.OIf.value}get dJ(){return this.Uq}hJd(ka,bb,ub,Xb,tc){return tc?tc?(ka=this.h_.fOd(tc.NavigationId))&&this.h_.gOd(ka,1)?32:8:(a.ULS.sendTraceTag(540160449,
327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}sln(ka,bb,ub,Xb,tc){tc&&this.OI.T4("OnCommentInit",{...(new ah.a),eGa:()=>{var Tc=this.h_.fOd(tc.NavigationId);if(Tc){var Md=this.h_.gOd(Tc,1);Md?this.R2b.isVisible?(this.b6c(Md,1),this.focusManager.dD(Uf.AFrame.Gr)):this.yj.dha(Md)?(Tc=qg.r(Md),this.h_.selectComment(Md,{...(new zd.a),LR:!Tc,K9:1}),this.focusManager.dD(Uf.AFrame.rM)):(this.Xh.$m||this.oc.processAction(vf.a.mV,
2),Fh.a.a3(y.AFrameworkApplication.pc,()=>{this.b6c(Md,1)},Zi.a.b6c)):this.oc.processAction(vf.a.t4a,2)}}});return 32}rln(ka,bb,ub,Xb,tc){tc?(ka=this.yj.wNc(tc))?this.dJ.pec(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.dJ.pec(null);return 32}Ypn(ka,bb,ub,Xb,tc){if(tc){if(this.Xh.lGb){for(ka=0;ka<tc.length;ka++)this.yj.Njj(tc[ka]);this.Uq.CMb()}else this.yj.$uk(tc);this.j4m(tc)}return 32}Emn(ka,bb,ub,Xb,tc){if(tc)if(this.Xh.lGb){for(ka=
0;ka<tc.length;ka++)this.yj.Njj(tc[ka],!0);this.Uq.CMb()}else this.yj.MXk();return 32}Znn(ka,bb,ub,Xb,tc){this.mA||this.Xh.$m||this.oc.processAction(vf.a.mV,2);if(tc){ka=null;if(!this.Cz||2!==this.mode&&3!==this.mode){if(!tc)return 8;if(this.mA)ka=this.xBl(tc);else for(bb=0;bb<tc.length&&(ka=this.yj.x_(tc[bb].toString()),this.oMd.qYd&&(!ka||ka.done));bb++);}else ka=this.Cz;this.b6c(ka,1);ka&&this.Xh.gY&&this.focusManager.mg(this.mA&&!this.Xh.$m?Uf.AFrame.rM:Uf.AFrame.Gr)}else a.ULS.sendTraceTag(5017933,
327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}ADk(ka,bb,ub,Xb,tc){var Tc;if(!tc)return 32;if(tc&&0<tc.length){bb=ka=ub=0;Xb=!1;for(let Md=0;Md<tc.length;Md++)tc[Md].toString()===(null===(Tc=this.Cz)||void 0===Tc?void 0:Tc.objectId)?(Xb=!0,ka++):this.Jo.UEf(tc[Md])&&(Xb&&0===ub&&(ub=Md,bb=ka),ka++);(Tc=this.Jo.x_(tc[ub].toString()))?(this.TCa.zlc.MQf=bb+1,this.TCa.zlc.hIa=ka,this.dJ.pec(Tc.id)):(tc=tc[ub],this.vj.Db(tc)?a.ULS.sendTraceTag(540148256,327,10,
`Comment Node with ObjectId ${tc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",tc.toString()))}return 32}rYn(){this.dJ.pec(null);return 32}mnh(ka,bb){this.oc.qa(ka,Hk.a.frame,(ub,Xb,tc)=>this.imn(tc,bb))}dun(ka,bb,ub){if(2===ub&&this.Xh.$m)return this.oc.processAction(vf.a.mV,2),this.Xh.L6a=!1,this.OI.T4("OnFloatingCommentsToggle"),32;if(2===ub&&!this.Jo.zQc())return 32;2===ub&&(this.Xh.L6a=
!this.Xh.L6a,this.OI.T4("OnFloatingCommentsToggle"));return 32}M0d(ka,bb,ub){2===ub&&(ka=this.yj.Ts.Oc(7),ka.Cb(this.yj.SIa),bb=new hm.a,bb.aha(`${String.fromCodePoint(128077)} \n`),this.Jo.nBb(sh.a.instance.gb.kb,void 0,bb),this.f1k.WUd(),ka.dispose());return 32}imn(ka,bb=!1){if(2===ka)ka=this.yj.Ts.Oc(15),ka.Cb(this.yj.SIa),this.Jk.he(()=>{this.cJc(bb)},"ECM:DAC"),ka.dispose();else if(1===ka&&!this.yj.b9b())return 2;return 32}cJc(ka=!1){this.Uq.mode=1;const bb=this.yj.BO();for(const ub of bb)ub.Vq===
kd.a.beingCreated||ka&&!ub.done||ub.Df||this.Uq.deleteComment(ub);this.focusManager.mg(Uf.AFrame.Pn);0<(ka?this.yj.BO().filter(ub=>ub.done):this.yj.BO()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}FEd(ka,bb,ub){if(2===ub)if(ka=this.focusManager.currentScope.name,ka!==Uf.AFrame.Gr&&ka!==Uf.AFrame.rM){!this.mA||this.Xh.$m?(this.Xh.$m||
this.oc.processAction(vf.a.mV,2),this.focusManager.mg(Uf.AFrame.Gr)):this.focusManager.mg(Uf.AFrame.rM);var Xb=this.lb.gb.kb;if(!Xb||!Xb.Oa)return 2;ka=Xb.Oa.cpBegin;bb=Xb.Oa.node;Xb=!!this.Cz&&(Fd.SelectionEditor.km(Xb)||Xb.NH)&&qg.q(this.Cz,bb,this.vj,ka);ka=!!this.Cz&&(2===this.mode||3===this.mode);if(Xb||ka)return this.dJ.shj(this.Cz.id,!0),32;Xb=this.mA&&!this.Xh.$m?this.yj.O5h(!0,!0):null;this.dJ.nbo(Xb)}else this.yj.jt&&(this.Uq.w9b.lhj(this.yj.jt,!0),this.Uq.w9b.xib(null===(Xb=this.yj.jt)||
void 0===Xb?void 0:Xb.objectId)),this.focusManager.mg(Uf.AFrame.Pn);return 32}dPk(){return 4}j4m(ka){const bb=new Set;for(let ub=0;ub<ka.length;ub++){const Xb=this.yj.wNc(ka[ub]);Xb&&bb.add(Xb.Df?Xb.Df:Xb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",bb.size.toString())}b6c(ka,bb){ka?this.R2b&&!this.Xh.gY?this.Xh.Geb=Object.assign(new Mg,{commentId:ka.id,CVc:!1}):this.h_.selectComment(ka,Object.assign(new zd.a,{LR:!!bb,K9:bb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}xBl(ka){let bb=
null,ub=!1;for(let Xb=0;Xb<ka.length;Xb++){const tc=ka[Xb].toString();if(this.yj.UEf(ka[Xb])){bb||(bb=tc);if(ub&&this.yj.jt.objectId!==tc)return this.yj.x_(tc);ub=ub||!!this.yj.jt&&this.yj.jt.objectId===tc}}return bb?this.yj.x_(bb):null}}Object(f.a)(ue,"CommentsActionManager",null,[]);var Pe=c(233),Eb=c(47),co=c(176),bl=c(1814),xi=c(514),Ml=c(31),Bn;(function(ka){ka[ka.Acp=0]="commentDeeplink";ka[ka.catchUpActivity=1]="catchUpActivity"})(Bn||(Bn={}));Object(f.b)("DeeplinkSource",Bn);class Cn{constructor(ka,
bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag){this.ga=ka;this.$h=bb;this.wv=ub;this.Gve=Xb;this.XP=tc;this.ffh=Tc;this.Ub=Md;this.Yi=le;this.ah=md;this.Xub=Ee;this.Ive=ef;this.eK=Wf;this.kSe=!1;this.cmo=Dh=>{if(this.ah.Wq&&!this.Yi.$m){const gh=new ra.a(0,1,0,()=>{this.zjj(Dh)},136,void 0,!0);y.AFrameworkApplication.pc.Wb(gh)}else this.zjj(Dh)};Ag.execute(Dh=>{this.vE=Dh})}get Jo(){return this.$h}get lb(){return this.Xub.value}PUh(ka){let bb=ka.Vq===kd.a.beingCreated?ka.iz.draftId:ka.id,ub=null;ka.Df&&(bb=
ka.Df,ub=()=>{this.ffh.selectComment(ka.id)});this.XP.setInitialActiveContainerId(bb,0,ub)}ebo(ka,bb,ub,Xb,tc){if(!tc.commentId)return 2;ka=this.$h.LD(tc.commentId);if(!ka)return 2;this.Xnb(ka,tc);return 32}phj(ka,bb){var ub,Xb;if(ka){var tc=(null===(Xb=null===(ub=this.$h.oy)||void 0===ub?void 0:ub.iz)||void 0===Xb?void 0:Xb.draftId)===ka?this.$h.oy:this.$h.LD(ka);this.selectComment(tc,bb)}}selectComment(ka,bb){ka&&this.Xnb(ka,bb)}mhj(ka,bb){var ub=this.fOd(ka);ub&&((ub=this.gOd(ub,0))?bb.mdg?(this.Yi.Geb=
Object.assign(new Mg,{commentId:ub.id,CVc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Xnb(ub,Object.assign(new zd.a,{commentId:ub.id,K9:1,LR:!0,ITc:!0})),this.ah.Wq&&void 0!==ka&&null!==ka&&this.PUh(ub),Fh.a.a3(y.AFrameworkApplication.pc,()=>{this.Ub.mg(this.ah.Wq&&!this.Yi.$m?Uf.AFrame.rM:Uf.AFrame.Gr)},Zi.a.Aho),Pe.a.instance.rf(Eb.a.EOh,(new Date).getTime()),ka=this.ah.Wq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",
ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.WW)):this.ga.processAction(vf.a.t4a,2))}fOd(ka){let bb=null;var ub=null;if(J.a.Tac(ka))bb=ka;else if(({Yu:ub}=w.d(ka)).returnValue&&(ka=ub))return xi.a.comment in ka&&(bb=ka[xi.a.comment]),bb;bb||(ub=ub?Object.keys(ub):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",ub?ub.join(","):"Not Json."));return bb?bb.toString():null}gOd(ka,bb){const ub=this.$h.wNc(ka),
Xb=0===bb;Xb&&this.eK.logKpiUsage(Lg.a.uEd,0);if(!ub){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,bb);const tc=new Ml.a;tc.name="DeepLinkSource";tc.string=Bn[bb];this.eK.logActivity("CommentDeeplinkNotFound",{dataFields:[tc]});Xb&&(bb=new I.a,bb.extendedProperties=new Map([["ErrorLevel","warning"]]),this.eK.logKpiFailure(Lg.a.uEd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:bb}),this.Ive.edn=ka)}return ub}zjj(ka){this.kSe=
!0;this.lb.setSelection(ka);this.kSe=!1}Xnb(ka,bb){if(ka){this.ah.zCb&&!this.Yi.L6a&&this.ga.processAction(vj.a.ujg,2);this.Yi.gKb&&(y.AFrameworkApplication.pc.We(this.Yi.gKb),this.Yi.gKb=null);var ub=this.$h.jt,Xb=this.Jo.Gsf(ka),tc=2===bb.K9,Tc={};tc&&(Tc.TriggeredByFindReplace=!0);if(this.Yi.$m)tc&&(Tc.PaneAlreadyOpen=!0),co.UISurfaces.Bu().then(Md=>{Md.setSelectedTaskPane(bl.a.GEd);return null});else if(ka.Vq!==kd.a.beingCreated&&!this.Jo.dha(ka))this.Yi.gY?this.ga.processAction(vj.a.mV,2):this.Yi.Geb=
Object.assign(new Mg,{commentId:ka.id,CVc:bb.ITc}),tc&&(Tc.OpeningPaneToSelect=!0);else if(this.ah.Wq){const Md=Xb.Vq===kd.a.beingCreated;Md?this.XP.NSa(Xb.iz.draftId,0,bb.LR):this.XP.NSa(Xb.id,0,bb.LR);!Md&&tc&&(Tc.SelectingDHC=!0)}Fh.a.a3(y.AFrameworkApplication.pc,()=>{this.Yi.gY&&(bb.LR&&this.Ub.mg(this.ah.Wq&&!this.Yi.$m?Uf.AFrame.rM:Uf.AFrame.Gr),bb.ITc&&this.Jo.dha(ka)||!bb.LR&&!bb.K9||this.ffh.selectComment(ka.id))},Zi.a.kag);tc=this.Jo.Gsf(ub);this.ah.nua&&this.vE&&tc&&tc.id!==Xb.id&&this.vE.fireEvent(9,
{comment:tc});this.$h.selectComment(ka);this.ah.nua&&this.vE&&ka.Vq===kd.a.normal&&!ka.Df&&this.vE.fireEvent(8,{comment:ka});this.Gve.highlightComment(ka,!0);this.wv.yF(0,Xb,ub);U.App.xa.updateCommandUI(!0);0<Object.keys(Tc).length&&this.eK.Mv(vj.a.selectComment,{customData:Tc})}}}Object(f.a)(Cn,"CommentSelectionActor",null,[556]);class iq extends of.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new xd.a,{T_:iq.getTypeName(),B_:iq.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(f.a)(iq,"CommentSmartReplySignal",of.a,[]);class jq extends Pa.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new xd.a,{T_:jq.getTypeName(),B_:jq.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(jq,"SmartReply",Pa.a,[]);var br=c(853);class Nn{constructor(ka){this.yra=ka}I3b(ka,bb){return Object.assign(new br.a,
{parentPath:["Signal",iq.getTypeName()],items:[Object.assign(new Me.a,{body:Object.assign(new iq,{commentId:ka,comment:bb})})]})}GZf(ka){const bb=new kb.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const ub of ka.ResultSets[0].Documents)bb.add(ub.Caption);0<bb.count&&this.yra.GZf(ka.CommentId,bb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return jq.getTypeName()}}
Object(f.a)(Nn,"BaseCommentSmartReplyProvider",null,[1298]);class Hq extends Nn{constructor(ka,bb,ub,Xb){super(ka);this.Te=bb;this.dA=ub;this.qWj=Xb}initialize(){this.dA.$k().then(()=>{this.Te.mb(this,Nn.prototype.getTypeName.call(this))})}invoke(ka,bb){this.dA.$k().then(()=>{this.qWj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Tb.a,{operation:this.I3b(ka,bb)}))})}PC(ka,bb){ka&&wa.a.getTypeNameFor(ka.content)===this.getTypeName()&&bb===Ka.a.getTypeName()?this.GZf(ka.content):a.ULS.sendTraceTag(579170963,
327,10,"Invalid annotation event for smart replies")}}Object(f.a)(Hq,"CommentSmartReplyProvider",Nn,[52]);var Ep=c(38),om=c(137),Gl=c(157),eo=c(384);class Wi{constructor(ka,bb,ub,Xb,tc,Tc){this.Ma=ka;this.ld=bb;this.vx=ub;this.pIe=Xb;this.Ive=tc;this.cN=Tc;this.bub=!1;this.Ive.YWn();this.XYj=this.B4l();this.Y2f&&(Ep.a.addHandler(window.self,Dk.a.drh,()=>{this.bub=!0}),Ep.a.addHandler(window.self,Dk.a.erh,()=>{this.bub=!1}))}get hx(){return this.vx?this.vx.value:null}get UCa(){return this.pIe.value}get VOo(){return this.bub}get c9b(){return 0<
this.XYj}get Wq(){return this.cN.Wq}get vnl(){return!0}get cIk(){return Object(eo.c)()?!1:this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get OPb(){return this.ld.isFeatureEnabled(115)&&!Gl.App.QUc}get wco(){return this.ld.isFeatureEnabled(37)&&this.Ma.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get r0k(){return this.Ma.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get Y2f(){return this.Ma.$("RecordCommentActionsInTypingIsEnabled")}get rQi(){return this.Ma.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get UBb(){return this.Wq&&
!this.c9b&&!this.Ma.jb("BootActivityNavigationId")&&G.a.du}get Gzb(){return this.ld.isFeatureEnabled(7)}get aHk(){return this.Ma.$("AtMentionUserFloodGateCampaignIsEnabled")}get H0k(){return this.Ma.$("CommentFriendlyTimestampsIsEnabled")}get onl(){return this.Ma.jb("DisabledChangeGatesInSharedComments")}get pMd(){return this.cN.pMd}get cPb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get Teg(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get AY(){return this.Ma.jb("PresenceUserId")}get removePersonalInformation(){return Gl.App.cpe&&!!om.PageReader.instance&&om.PageReader.instance.Kga(U.App.xa.hb.Uc).removePersonalInformation}get cgb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get MZm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get vGo(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get zCb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get y1k(){return this.Ma.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get m1k(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get GYm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.cN.contentNavigationApiEnabled}get Xwn(){return this.ld.isFeatureEnabled(86)}get nua(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.cN.contentFilterApiEnabled}get G0k(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get Txo(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}B4l(){if(this.hx&&this.UCa){const ka=new ad.GraphIterator;ka.set(this.hx);this.UCa.o4a(ka);let bb=0;39===ka.Ve&&(bb=ka.xq());return bb}return-1}}Object(f.a)(Wi,"CommentsSettings",null,[]);var ki=c(1605),mb=c(1372);
class pc{constructor(ka){this.u$=ka}Sxh(ka,bb,ub){const Xb=new Gm;bb=this.u$.wQa(bb)?bb.objectId:null;if(!bb)return Xb;bb=la.a.Ff(bb);if(ub.contains(bb))return Xb.bSc=0,Xb.aSc=ka.length,Xb;for(let Tc=0,Md=ka.length;Tc<Md;Tc++){var tc=ka[Tc];ub=qg.g(tc);tc=qg.d(tc);ub&&mb.a.xHh(ub,bb)&&(Xb.bSc=Tc);if(tc&&mb.a.xHh(tc,bb)){Xb.aSc=Tc;break}}return Xb}nth(ka,bb,ub){const Xb=-1===bb.bSc&&-1===bb.aSc,tc=-1<bb.bSc?bb.bSc:-1;bb=-1<bb.aSc?bb.aSc:ka.length;const Tc=!Xb&&tc===bb;var Md=!1;for(let le=0;le<ka.length;le++){const md=
ka[le],Ee=Hf.a(md);if(1!==Ee&&2!==Ee&&3!==Ee)continue;this.u$.pSa(md);if(Xb||le<tc||le>bb)continue;const ef=3===Ee||2===Ee&&-1!==md.className.indexOf(ve.a.DPa),Wf=ub?1:2;this.CEk(le,tc,bb,Wf,ef,Md,md,Tc);if(le!==bb||Tc)(Md=this.u$.W1a.J(Ee).J(Wf))&&md.classList.add(Md),Md=ef}}CEk(ka,bb,ub,Xb,tc,Tc,Md,le){ka!==bb&&ka!==ub||tc||Tc||((ka=this.u$.Kfc.J(Xb))&&Md.classList.add(ka),le&&Md.classList.add(ve.a.gZf))}}Object(f.a)(pc,"DefaultHighlightChangeHandler",null,[554]);var dd;(function(ka){ka[ka.success=
0]="success";ka[ka.noSelection=1]="noSelection";ka[ka.invalidContent=2]="invalidContent"})(dd||(dd={}));Object(f.b)("AnchorCreationResult",dd);var Zb=c(61),Ne=c(23),uf=c(276),Rf=c(235),cd=c(1199);class ei{}Object(f.a)(ei,"EditorAnchorInfo",null,[506]);class fh{constructor(ka,bb,ub,Xb,tc,Tc,Md,le){this.eYm=ka;this.OIf=bb;this.yj=ub;this.g2a=Xb;this.TCa=tc;this.yo=Tc;this.OI=Md;this.ks=le;this.Xeh=null;this.g2a.x5a(this.TCa);this.ks.contentFilterApiEnabled&&(this.OI.D9("OnCommentPaneOpen",this.OUo.bind(this)),
this.OI.D9("OnCommentPaneClose",this.NUo.bind(this)),this.OI.D9("OnContentFilterUpdate",this.z_c.bind(this)))}get lb(){return this.OIf.value}get vj(){return this.eYm.value}initialize(){}pym(ka){this.Xeh=ka}dispose(){}xib(ka){this.TCa.xib(ka)}v9b(ka){this.TCa.v9b(ka)}highlightComment(ka){this.lhj(ka,!1);this.TCa.xib(ka.objectId)}omc(ka){this.TCa.omc(ka)}jEa(ka){return this.TCa.jEa(ka)}z_c(){this.Pqe("OnContentFilterUpdate")}OUo(){this.Pqe("OnCommentPaneOpen")}NUo(){this.Pqe("OnCommentPaneClose")}Pqe(ka){const bb=
[],ub=new Set;for(const tc of this.yj.BO())if(!tc.Df&&tc.Vq!==kd.a.beingCreated&&!this.yj.dJ.kAh(ka,tc)){var Xb=this.u5l(tc);ub.has(Xb.id.toString())||(ub.add(Xb.id.toString()),(Xb=Xb.De(Zb.InteractiveViewManager.instance.Bd.ic))&&bb.push(Xb))}bb.forEach(tc=>{this.g2a.pmc(tc)})}u5l(ka){var bb,ub;const Xb=null===(bb=this.vj)||void 0===bb?void 0:bb.Db(ka.objectId);if(!Xb)return null;ka=qg.k(Xb);bb=null===(ub=this.vj)||void 0===ub?void 0:ub.Db(ka);return ac.a.uci(bb)}lhj(ka,bb){if(!ka.Vq){var ub=this.vj.Db(la.a.Ff(ka.objectId)),
Xb=Re.a.yba(ub,this.vj,!0);ub=Re.a.yba(ub,this.vj,!1);if(Xb&&ub){const tc=Xb.Ib.paragraph;Xb=Xb.Ib.cp;if(this.iRm(tc,Xb))U.App.xa.updateCommandUI(!0);else{Xb=Ne.SelectionFactory.ue(tc,Xb);ub=Gc.a.Rc(ub.Ib.paragraph,ub.Ib.cp);if(fh.Xf.I8(Xb.Oa)||fh.Xf.I8(ub))ka.fQa=!0,ka.l4a();ka=bb?Ne.SelectionFactory.oA(Xb,ub):Xb;this.Xeh(ka)}}}}zXk(){this.TCa.v9b(null);this.TCa.xib(null)}U7k(){const ka=new ei;return{returnValue:dd.success,anchor:ka}}iRm(ka,bb){if(ka&&Object(em.a)(cd.PageView,this.yo.Bd)){var ub=
ka.De(this.yo.Bd.ic);ka=document.getElementById(jd.AppFrame.rUa);if(ub&&ka){bb=uf.a.Rq(ub,bb);if(!bb)return!1;bb=bb.y;ub=Sys.UI.DomElement.getBounds(ka).y;ka=ka.offsetHeight;if(bb>=ub&&bb<=ub+ka)return!0}}return!1}static get Xf(){return Rf.a.instance}static getInstance(){return fh.Rl()}static Rl(){return fh._instance||(fh._instance=new fh(new X.a(()=>U.App.xa.hb.Uc.od),new X.a(()=>sh.a.instance),L.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),L.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,
L.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Zb.InteractiveViewManager.instance,L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}fh._instance=null;Object(f.a)(fh,"EditorCommentHintManager",null,[473,474,10]);var wc=c(2028),xj=c(350),xh=c(1147);class $h extends am.a{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag,Dh,gh,gl,Al,Pm,ck,Zf,qk,vn,zh,Qm,Hl,en){super(Md);this.oi=bb;this.Xub=le;this.k8e=Ee;this.zra=
ef;this.kqc=Wf;this.XP=Ag;this.ah=Dh;this.Rp=gh;this.jTb=gl;this.Yi=Al;this.P1=Pm;this.ge=Zf;this.eK=qk;this.pT=zh;this.wEd=Qm;this.dKo=en;this.Pmi=this.Qgh=this.gWa=null;this.Olb=()=>{this.fra.Boa()&&(this.E8i(this.fra.rc),this.fra.Zgc(this.Olb))};this.cZc=mi=>{2===mi.mode?this.oD=1:1===mi.mode&&(this.oD=0);this.$h.oy&&0===this.oD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.$h.oy.iz.sessionType):this.Yi.gY&&(this.mA||
this.Q1.isVisible)&&this.CMb()};this.Bjn=()=>{this.Yi.lGb?this.mode=0:this.oD=0};this.tGa=(mi,um)=>{var fn;mi=um.nl.kb;if((this.mA||this.Hca&&this.Hca.isVisible)&&!this.jTb.kSe&&mi){um=Fd.SelectionEditor.km(mi);var im=mi.NH;null!==(fn=this.Pmi)&&void 0!==fn&&fn.lba||(this.Jo||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),fn=this.Jo&&this.Jo.ojb(this.ga,!1),1!==this.mode||um&&!im||!fn?this.kqc.WUd():this.Lal(mi));2!==this.mode&&3!==this.mode&&this.ah.r0k&&this.kNo(mi,
um,im)}};this.iVk=()=>{if(this.yj&&this.yj.oy&&!U.App.oBf){var mi=this.yj.oy;mi.iz.sessionType!==wc.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${mi.Vq} present on app shutdown`),(mi=ac.a.hUl(mi))&&this.eK.logKpiFailure(mi,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Lg.a.P2b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.Kjn=()=>{if(this.Yi.gY){var mi=()=>!0;this.mA&&!this.Yi.$m&&(mi=um=>this.Jo.dha(um));mi=this.Jo.Onf(mi);this.CMb(mi)}};this.ga=
Md;this.oD=1===this.ga.mode?0:1;this.Q1=tc;this.$h=Xb;this.M$=Tc;this.Ub=md;this.YVn();ub.w5a(this.zra);this.lb.Pw(this.tGa);ka.CWR(()=>ka.result.ZB.NMa(this.Bjn));y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.WYa(this.cZc);this.P1.D9("OnAfterTrackChangeMarkupViewChange",this.Kjn);y.AFrameworkApplication.dI&&y.AFrameworkApplication.dI(this.iVk);Hl.execute(mi=>{this.vE=mi});vn.execute(mi=>{mi.u5k.execute(um=>{this.Pmi=um})})}YVn(){this.fra&&(this.fra.Boa()?this.E8i(this.fra.rc):this.fra.s0b(this.Olb))}E8i(ka){ka.Kla(()=>
{this.tBo()})}get fra(){var ka;return null===(ka=Gl.App.un)||void 0===ka?void 0:ka.hb}get lb(){return this.Xub.value}get yj(){return this.$h}get Jo(){return this.$h}get mA(){return this.ah.Wq}get YPi(){return!0}get dij(){return!0}get B9b(){return this.gWa}set B9b(ka){this.gWa=ka}get mode(){return super.mode}set mode(ka){ka!==this.oD&&(super.mode=ka,this.l4a())}get Cz(){return this.model&&this.model.jt?this.model.jt.Df?this.model.LD(this.model.jt.Df):this.model.jt:null}get vj(){return this.oi.value}get Vqj(){return!1}get removePersonalInformation(){return this.ah.removePersonalInformation}CMb(ka=
null,bb=null){const ub=this.Jo,Xb=!this.oD,tc=this.Hca.D0k,Tc=ub.CQd();tc.xmg(Tc?5:1,Xb);ka=this.ah.cPb&&ka?ka:ub.iof(this.ah.cPb&&this.mA&&!this.Yi.$m);tc.qco(ka,Tc,ub.aVa);this.$lg();bb&&a.ULS.sendTraceTag(572281362,327,50,bb)}A_c(ka,bb,ub=!1){this.Yi.$m?this.XP.WGj():bb?this.XP.deleteContainer(ka.Vq===kd.a.beingCreated?ka.iz.draftId:ka.id,0,ub):this.gOn(ka)}gOn(ka){const {mIo:bb}=this.$h.GZl(ka),ub=this.M$.jEa(ka.objectId);ub&&this.XP.addContainer(ka.id,ub.parentElement,0,bb)}whj(ka){const bb=
this.Cz;this.d6c();this.zra.yF(0,this.$h.jt,bb);this.mA&&this.$h.jt&&!this.Yi.$m&&this.XP.NSa(this.$h.jt.id,0,1===ka)}obo(){const ka=this.Cz;this.e6c();this.zra.yF(0,this.$h.jt,ka);this.mA&&this.$h.jt&&!this.Yi.$m&&this.XP.NSa(this.$h.jt.id,0,!1)}omc(ka){this.M$.omc(ka)}Tsl(ka,bb){this.XP.addContainer(ka,null,0,bb)}NAn(ka){this.XP.h0i(ka)}Vsl(ka,bb){this.XP.z4c(ka,bb,0)}aUo(){this.XP.g2e()}ohj(ka){if(ka&&(2!==this.mode||ka.Vq===kd.a.beingCreated)){var bb=this.$h.jt;bb!==ka&&(this.$h.selectComment(ka),
this.Q1.isVisible?this.Yi.gY?(this.Q1.selectComment(ka,1),this.nka.selectComment(ka.id)):this.Yi.Geb=Object.assign(new Mg,{commentId:ka.id,CVc:!1}):this.mA&&!ka.done&&(this.shj(ka.id,!1),this.nka.selectComment(ka.id)),!this.Q1.isVisible&&this.mA&&ka.done||(this.w9b.xib(ka.objectId),this.zra.yF(0,this.Cz,bb)))}}qSc(){}ihf(){this.Yi.lGb=!1}Xyb(ka){this.ah.rQi&&this.$h.jt&&this.clearSelection();super.Xyb(ka);this.eK.logKpiUsage(Lg.a.v8e,0);this.$lg();if(this.mA){const bb=this.$h.kfm(ka.draftId);this.Tsl(ka.draftId,
bb)}}addReply(ka,bb){this.eK.logKpiUsage(Lg.a.IEd,0);super.addReply(ka,bb)}oua(ka){this.mA&&null!=ka.iz&&this.$h.K9i(ka.iz.draftId);super.oua(ka);this.M$.xib(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",qg.a(ka));this.eK.logKpiUsage(Lg.a.CFh,0);this.nVk(ka);ac.a.K0o(ka,this.vj,this.eK);this.eK.Mv(vj.a.BFh,{succeeded:!0,customData:{actionType:ka.Df?wc.a.reply:wc.a.create}})}Ieb(ka){super.Ieb(ka);this.eK.Mv(vj.a.BFh,{succeeded:!0,customData:{actionType:wc.a.edit}})}nVk(ka){if(ka.Df){var bb=
this.$h.Gsf(ka);if(bb.aEc&&bb.bEc){var ub=this.vj.Db(la.a.Ff(bb.bEc));bb=bb.bEc===bb.aEc?null:this.vj.Db(la.a.Ff(bb.aEc));ac.a.Prg(ub,ka,!0);ac.a.Prg(bb,ka,!1)}}}dJc(ka){super.dJc(ka);this.Cz&&this.Cz.id===ka.id&&(super.clearSelection(),this.mA&&this.XP.A2b());if(this.mA)if(qg.r(ka)){var bb=[];let ub=null;for(const Xb of this.model.BO())Xb!==ka&&(Xb.Df===ka.Df&&bb.push(Xb),Xb.id===ka.Df&&(ub=Xb));ub&&ub.id&&ub.objectId&&!ub.done&&this.Jo.DG(ub.objectId)&&!this.Jo.W0i(ub.objectId)&&!bb.length&&this.A_c(ub,
!0)}else bb=ka.Vq===kd.a.beingCreated,ka.done||this.A_c(ka,!0),bb&&this.$h.K9i(ka.iz.draftId)}editComment(ka,bb){1===this.mode&&ka&&(this.$h.kKc(ka,bb),wc.a.edit===bb.sessionType&&this.eK.logKpiUsage(Lg.a.HFh,0),this.ah.OPb&&3!==wc.a.Nqf(bb.sessionType)&&this.jTb.selectComment(ka,Object.assign(new zd.a,{LR:!1,K9:0})))}cfe(ka){this.mA&&!this.Yi.$m||super.cfe(ka)}deleteComment(ka){ka.Vq!==kd.a.beingCreated&&this.Jo.XPh(la.a.Ff(ka.objectId));this.gWa&&this.gWa.id===ka.id&&(this.$h.jt&&this.gWa.id===
this.$h.jt.id?this.gWa=null:this.zra.c7e());!this.$h.jt||this.$h.jt.id!==ka.id&&this.$h.jt.Df!==ka.id?this.$h.jt&&this.zra.yF(0,this.$h.jt,null):void 0===ka.Df||null===ka.Df?this.clearSelection():this.$h.selectComment(this.$h.LD(ka.Df));ka.fQa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",qg.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${qg.a(ka)} deleted by user action. DurableId: ${ka.X_a}`)}qAb(ka,bb){super.qAb(ka,bb);this.mA&&
!this.Yi.$m&&bb&&(this.$h.jt&&this.$h.jt.id===ka.id&&this.clearSelection(),this.B9b&&this.B9b.id===ka.id&&this.zra.c7e())}nbo(ka=null){(ka=this.Jo.aQl(ka))?this.jTb.selectComment(ka,Object.assign(new zd.a,{LR:!0,K9:1})):this.whj(1)}Lal(ka){var bb,ub=this.fra.rc;if(ub){var Xb=ka.Oa.node,tc=null===(bb=this.dKo.instance)||void 0===bb?void 0:bb.GPc(Xb);if(tc)for(const Tc of ub.EOa(tc))if(Tc&&Tc instanceof xj.a&&(bb=Tc,ub=xh.a.WLh(bb),this.kqc.ioe=this.Yzl(Xb,ka),tc=this.oQk(ub),null!==tc)){if(ka=this.kqc.Ozl(ub,
tc))ub.nwa[tc].appendChild(ka),bb.Gz(ka);break}}}Yzl(ka,bb){let ub;for(const Xb of ka.XG)if(Xb&&Xb){ub=Xb;break}ka=bb.Oa.oj;bb=!(null===ub||void 0===ub||!ub.Tn)&&0<ub.Tn.length;return 0>ka||!bb||null===ub||void 0===ub||!ub.eop?null:uf.a.b_(ka,ub,!1,!1)}oQk(ka){var bb;const ub=null===(bb=this.kqc.ioe)||void 0===bb?void 0:bb.y;for(const [Xb,tc]of ka.Vba.entries())if(ka=ub-tc.y,-2<=ka&&ka<tc.height+2)return Xb;return null}l4a(){U.App.iib=2===this.mode||3===this.mode;1!==this.mode&&this.kqc.WUd()}kNo(ka,
bb,ub){const Xb=this.Ub.currentScope;let tc=null;if(bb||ub){bb=ka.Oa.cpBegin;ka=ka.Oa.node;if(this.Cz&&qg.q(this.Cz,ka,this.vj,bb))return;tc=this.l3l(ka,bb)}tc?!this.mA||this.Yi.$m?Fh.a.a3(y.AFrameworkApplication.pc,()=>{this.ohj(tc)},Zi.a.gbo):this.ohj(tc):!this.$h.jt||Xb&&Xb.name===Uf.AFrame.rM||this.clearSelection()}l3l(ka,bb){let ub=null;const Xb=this.model.BO();for(let tc=Xb.length-1;0<=tc;tc--){const Tc=Xb[tc];if(Tc.objectId&&!(Tc.Df||this.mA&&!this.Hca.isVisible&&Tc.done)&&qg.q(Tc,ka,this.vj,
bb)){ub=Tc;break}}return ub}selectComment(ka,bb=1){this.jTb.phj(ka,Object.assign(new zd.a,{LR:1===bb,K9:bb}))}shj(ka,bb){const ub=this.$h.LD(ka);ub?this.mA&&!qg.r(ub)&&ub.Vq!==kd.a.beingCreated&&this.XP.NSa(ka,0,bb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.jt;this.ah.nua&&this.vE&&ka&&this.vE.fireEvent(9,{comment:ka});super.clearSelection();this.zra.yF(1,ka,ka);this.mA&&ka&&this.XP.A2b()}MQm(){var ka;return 500>(null===(ka=this.Qgh)||
void 0===ka?void 0:ka.ti)}pec(ka,bb=1){if(!this.ah.rQi||!this.$h.oy){var ub=this.$h.LD(ka),Xb=null;ub||(Xb=this.gWa);var tc=this.MQm(),Tc=!1;1===bb&&this.nka&&(tc?Tc=!0:this.nka.highlightComment(ka));ka?ub?tc?Tc=!0:this.M$.v9b(ub.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.M$.v9b(null);ub?tc?Tc=!0:(this.gWa=ub,this.zra.yF(2,ub,Xb)):(this.gWa=null,this.zra.yF(3,null,Xb));Tc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}tBo(){this.ge&&
(this.Qgh=this.ge.$f("UserAction","StartScrollDetectionStopwatch"))}notify(ka,bb){this.Rp.sendNotification(ka,bb)}$lg(){this.wEd.onContentChanged()}kAh(ka,bb){var ub,Xb;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Nxo(bb);case "OnContentFilterUpdate":return!(null===(Xb=(ub=this.wEd).isContentInFilterUpdateDiff)||void 0===Xb?0:Xb.call(ub,bb.id));default:return!0}}Nxo(ka){return this.ah.G0k?!ka.done&&this.Jo.dha(ka)===this.wEd.isContentInFilteredContent(ka.id):this.Jo.dha(ka)===
this.wEd.isContentInFilteredContent(ka.id)}static getInstance(){return $h.Rl()}static Rl(){$h.Lg||($h.Lg=new $h(U.App.Pna(),new X.a(()=>U.App.xa.hb.Uc.od),L.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,L.a.instance.resolve("Common.Comments.ICommentModel"),L.a.instance.resolve("Common.Comments.ICommentPane"),fh.getInstance(),y.AFrameworkApplication.va,new X.a(()=>sh.a.instance),bg.FocusManager.instance(),L.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),
L.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),L.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),L.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings"),L.a.instance.resolve("Common.Utils.IAriaNotifier"),L.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),L.a.instance.resolve("WordEditor.Comments.CommentsState"),L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
Gl.App.un.hb.rc,U.App.xa.Gq,L.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),L.a.instance.Sa("WordEditor.HeaderFooter.HeaderFooterControlOwner"),L.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),L.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),L.a.instance.Sa("WordEditor.Extension.RichApiEventManager"),L.a.instance.Sa("WordEditor.Indicator.TopLevelOutlineElementCache")),$h.Lg.xOb=!0);return $h.Lg}}$h.Lg=null;Object(f.a)($h,
"EditorCommentManager",am.a,[359,360,361,10]);var Nf=c(1752);class Wh{constructor(ka,bb,ub,Xb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=bb;this.confirmButton=ub;this.cancelButton=Xb}}Object(f.a)(Wh,"ViewContainerModalDialogStrings",null,[]);var mk=c(307);c(1480);class Hj{constructor(ka,bb){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=
ka;this.canvasContextId=bb}}Object(f.a)(Hj,"CommentUIAction",null,[]);var Gh=c(1049);class nh{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag,Dh,gh,gl,Al){this.ga=ka;this.ig=bb;this.ae=ub;this.Ub=Xb;this.fp=tc;this.Mh=Tc;this.R2=Md;this.yra=le;this.Axd=md;this.HWe=Ee;this.Hb=ef;this.XP=Wf;this.ah=Ag;this.Yi=Dh;this.jTb=gh;this.P1=gl;this.kka=Al;this.Gve=this.Xi=null;this.afh=this.zKg=!1;this.rzc=null;this.pvo=(Pm,ck,Zf)=>2!==Zf||this.Yi.gY?1===Zf?32:2:(this.P1.T4("OnCommentInit",Object.assign(new ah.a,
{eGa:()=>{this.ga.processAction(vf.a.mV,2)}})),32);this.Rpi=(Pm,ck,Zf)=>1!==Zf||this.Yi.gY?2:8;this.Tpk=(Pm,ck,Zf)=>{if(1===Zf)return!this.ojb()||this.pdb?8:this.Yi.gY?2:32;if(!this.Yi.gY)return this.pdb=!0,this.P1.T4("OnCommentInit",Object.assign(new ah.a,{eGa:()=>{this.Wq||this.Yi.$m||this.ga.processAction(vf.a.mV,2)}})),32;this.Wq||this.Yi.$m||this.ga.processAction(vf.a.mV,2);(this.Wq||this.Yi.$m)&&this.Ub.mg(this.Yi.$m?Uf.AFrame.Gr:Uf.AFrame.rM);return 2};this.yil=(Pm,ck,Zf)=>1===Zf&&Bc.SessionStatusManager.instance.Aj?
8:2;this.Wml=(Pm,ck,Zf,qk)=>1!==qk||(this.Wq||this.isVisible)&&this.Xi.model.jt?Pm||this.Xi.model.jt?32:8:8;this.uib=(Pm,ck,Zf,qk,vn)=>{if(1===Zf||!this.Yi.$m)return 32;if(!this.Wq&&2===Zf&&(2===this.Xi.mode||3===this.Xi.mode))return vn=new Wh(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.Axd.invokeModalConfirmationDialog(()=>{this.Iln(Pm,ck,Zf,qk)},()=>{this.Nkn()},vn),32;this.YUd();
if(this.Wq)return 32;vn&&this.NUh();return 32};this.mMb=(Pm,ck,Zf,qk,vn)=>{if(1===Zf)return 32;vn[mk.a.On]=this.isVisible;return 32};this.loc=this.Q7k()}get isVisible(){return this.Yi.$m}get pdb(){return this.zKg}set pdb(ka){this.zKg=ka}get qpo(){return"SharedCommentsTaskPaneProps"}get L0c(){return null}get NPi(){return null}get $E(){return this.fp}get Hca(){return null}get D0k(){return this.yra}get Wq(){try{return this.ah.Wq}catch(ka){return!1}}Gai(){return new Ji(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Q7k(){const ka=new Yi.a,bb=new Hj(vf.a.newComment,Hk.a.frame);bb.preCallback=this.Tpk;const ub=new Hj(vj.a.HQf,Hk.a.frame),Xb=new Hj(vj.a.r_f,Hk.a.frame),tc=new Hj(vj.a.deleteComment,Hk.a.frame);tc.preCallback=this.yil;tc.postCallback=this.Wml;this.Wq&&(ub.preCallback=this.Rpi,Xb.preCallback=this.Rpi);const Tc=new Hj(vf.a.mV,Hk.a.frame);Tc.preCallback=this.pvo;ka.Z(6,Tc);ka.Z(0,bb);ka.Z(1,ub);ka.Z(2,Xb);ka.Z(3,tc);return ka}coj(ka){this.afh||
(this.mlk=this.uRd(),this.R2.INa(),this.Doo(),this.zoo(ka),this.afh=!0)}zoo(ka){this.Xi=ka;this.Gve=ka.w9b;this.Xi.UWh=this.yra}initialize(ka){this.coj(ka);this.Tb()}Ozf(){this.rzc&&this.Ub.mg(Uf.AFrame.Gr);this.pdb&&!this.Wq?(this.ga.processAction(vf.a.newComment,2),this.pdb=!1):this.Yi.Geb&&Fh.a.a3(y.AFrameworkApplication.pc,()=>{const ka=this.Yi.Geb.commentId,bb=this.Yi.Geb.CVc;this.ga.Qb(vj.a.selectComment,2,Object.assign(new zd.a,{commentId:ka,K9:1,LR:!0,ITc:bb}));bb&&(Fh.a.a3(y.AFrameworkApplication.pc,
()=>{this.Ub.mg(Uf.AFrame.Gr)},Zi.a.kag),Pe.a.instance.rf(Eb.a.EOh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.WW);this.Yi.Geb=null},Zi.a.fbo)}dispose(){}m5(){}selectComment(){this.isVisible||this.Wq||this.Drj();this.Mh.updateCommandUI(!0)}Tb(){this.ga.qa(vf.a.uib,Hk.a.frame,this.uib);this.ga.fb(vf.a.mMb,Hk.a.frame,this.mMb,96)}l4a(){-1!==this.Xi.mode&&(this.Xi.mode||this.NUh())}NUh(){const ka=
this.Xi,bb=ka.Jo,ub=bb.CQd(),Xb=bb.iof(this.ah.cPb&&this.ah.Wq&&!this.Yi.$m);this.yra.pco(Xb.length,ub,!ka.mode,ub?5:1);this.yra.Oco(Xb,bb.aVa)}Doo(){const ka=this.Ub.fe(Uf.AFrame.Gr);ka.parent=Uf.AFrame.vp;ka.TH=!0;ka.h5c=!0;ka.jUa=!0;ka.TYa((bb,ub)=>{se.a.jAh(ub.name)&&(this.Yi.gKb=Fh.a.a3(this.Hb,()=>{ub.name!==Uf.AFrame.rM&&2!==this.Xi.mode&&3!==this.Xi.mode&&(this.Xi.clearSelection(),this.Mh.updateCommandUI(!0));this.Yi.gKb=null},Zi.a.xln))});this.fp.gT(Uf.AFrame.Gr);if(this.ah.Gzb)for(const bb of qg.t)ka.bindAction(Lc.KeyInputManager.BG(bb),
vj.a.P4e)}nho(){this.rzc&&this.HWe.EFl()}gCh(){this.P2j&&this.nho()}Iln(ka,bb,ub,Xb){const tc=this.Xi,Tc=tc.Jo.oy;Tc&&Tc.iz?tc.k8e.endCommentSession(Tc.iz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.uib(ka,bb,ub,Xb,!0);Fh.a.a3(this.Hb,()=>{this.Mh.updateCommandUI(!0)},Zi.a.c8n)}Nkn(){this.rzc&&this.Ub.mg(Uf.AFrame.Gr);this.Mh.updateCommandUI(!0)}RGa(ka){ka.ir(this.Ub.vW);ka.ir(this.Ub.wW)}UOb(ka,bb,ub){if(1===ub)return 32;this.Drj();return 32}Drj(){this.isVisible||
(this.ah.zCb&&(this.Yi.L6a=!0),this.Yi.gY?(this.Unl(),this.Yi.$m=!0,this.P1.Ube(),this.Ub.jDc(Uf.AFrame.Gr),this.Wq&&this.ah.cPb&&this.Xi.CMb(this.Xi.model.Onf(()=>!0)),this.P2j=!0,co.UISurfaces.Bu().then(ka=>{ka.showTaskPane(bl.a.GEd,this.mlk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Xi.pec(null),this.Mh.updateCommandUI(!0),this.RGa(this.Ub.fe(Uf.AFrame.Gr)),this.P1.T4("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):
this.P1.T4("OnCommentInit",Object.assign(new ah.a,{eGa:()=>{this.Yi.$m||this.ga.processAction(vf.a.mV,2)}})))}Unl(){this.ga.Qb(vj.a.z3,2,null);this.ga.Qb(vj.a.BT,2,null)}ojb(){return this.kka.ojb(this.ga,!1)}Xyb(){}show(){this.isVisible||this.ga.processAction(vf.a.mV,2)}editComment(){return 2}YUd(){this.Xi.paneClosing();this.Yi.$m=!1;if(this.Wq&&this.ah.cPb){const bb=this.Xi.model;this.Xi.CMb(bb.Onf(ub=>bb.dha(ub)))}var ka=bg.FocusManager.instance();ka.currentScope&&ka.currentScope.name===Uf.AFrame.Gr&&
ka.mg(this.Wq&&(2===this.Xi.mode||3===this.Xi.mode||this.Xi.yj.jt)?Uf.AFrame.rM:ka.yT);this.fp.Ww(Uf.AFrame.Gr);this.Ub.QIc(Uf.AFrame.Gr);co.UISurfaces.Bu().then(bb=>{bb.hideTaskPane(bl.a.GEd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Wq&&(ka=this.Xi.model.jt)&&this.cTo(ka);this.P1.T4("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}cTo(ka){ka.done?this.Xi.clearSelection():this.jTb.PUh(ka)}Mtn(ka=null){this.HWe.wnj(3);
this.Ozf();if(ka){this.gCh();Ep.a.T3f(ka,[Dk.a.contextMenu]);const bb=this.Ub.fe(Uf.AFrame.Gr);this.ig.$_b(Uf.AFrame.Gr,ka,bb.jUa)}}vrn(ka){this.fp.FI(Uf.AFrame.Gr);1!==ka&&Fh.a.a3(y.AFrameworkApplication.pc,()=>{this.Ub.dD(Uf.AFrame.Gr)},Zi.a.kag)}onTaskPaneClose(){this.Yi.gY&&this.HWe.wnj(1)}uRd(){const ka={type:this.qpo,Uep:this.gCh};return Object.assign(new Gh.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:bb=>{this.rzc=bb;this.Mtn(bb);
this.XP.yjg(!0)},onClose:()=>{this.rzc=null;this.ga.Qb(vf.a.uib,2,!0);this.Mh.updateCommandUI(!0);this.onTaskPaneClose();const bb=this.Xi.Jo;this.Yi.L6a&&bb.zQc()&&this.XP.yjg(!1)},onShow:bb=>{this.vrn(bb)}})}mV(){return 32}}Object(f.a)(nh,"OfficeSharedCommentPane",null,[10,355,356]);var lc=c(1669),Sd=c(175);class Yf{constructor(ka,bb){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=bb}openView(){this.ga.processAction(vf.a.UOb,2)}closeView(){this.ga.Qb(vf.a.uib,2,!0)}invokeModalConfirmationDialog(ka,
bb,ub){const Xb=new Sd.StandardDialog;ub&&ub.title&&ub.body&&ub.confirmButton&&ub.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),ub=new Wh("","","",""));Xb.Ad=1;Xb.Ee(1,ub.confirmButton);Xb.Ee(0,ub.cancelButton);Xb.Ju(ub.title,ub.body,1,tc=>{1===tc?ka():bb()})}}Object(f.a)(Yf,"ViewContainerAPI",null,[353,354]);class bk{constructor(ka,bb,ub){this.EKo=ka;this.Xh=bb;this.kIa=ub;this.hd=new pa.a;this.EKo.execute(Xb=>{this.kIa.Dce("OnBeforeTrackChangeMarkupViewChange",
(tc,Tc)=>{Tc&&Tc.wQf!==Xb.Fj&&this.hd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Tc)});this.kIa.Dce("OnAfterTrackChangeMarkupViewChangeEventKey",(tc,Tc)=>{Tc&&Tc.Fj===Xb.Fj&&(ki.a.Fj=Xb.Fj,this.hd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Tc))})})}D9(ka,bb){this.hd.addHandler(ka,bb)}T4(ka,bb){this.hd.raiseEvent(ka,bb)}Ube(){this.Xh.x2f||(this.Xh.x2f=!0,this.hd.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(bk,"WordCommentEventsActor",null,[]);var yj=c(1811);class Vm{constructor(){this.insertIndex=
0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(Vm,"InitCommentSessionResult",null,[]);class yh extends Vm{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(f.a)(yh,"BeginDraftingHostResult",Vm,[]);var mh=c(2071),fo=c(2029),Wm=c(1034);class Fp{constructor(ka,bb,ub,Xb,tc,Tc,Md,le,md,Ee,ef,Wf,Ag,Dh,gh){this.taskManager=ka;this.yra=bb;this.pUj=ub;this.KLo=Xb;this.s8e=tc;this.ks=Tc;this.qt=Md;this.focusManager=le;
this.V0=md;this.oc=Ee;this.Jk=ef;this.h_=Wf;this.Xh=Ag;this.g1k=Dh;this.e1k=gh;this.JXb=this.N6=this.Hm=null;this.fZj="WordWebCommitNewCommentActivity";this.gZj="WordWebCommitTaskActivity";this.cZj="WordWebCommentReactionActivity";this.bPg=null}get kka(){return this.N6}kFn(ka){var bb;const ub=this.kka.oy,Xb=this.N6.BO();if(Xb&&ub){const tc=Wm.a.wgb(null!==(bb=ub.authorId)&&void 0!==bb?bb:"");bb=new yj.a(ub.authorId,ub.l1b,ub.author,null!==tc&&void 0!==tc?tc:"",!0);ka.author=bb;ka.insertIndex=Array.indexOf(Xb,
ub);ka.authorName=ub.author;ka.authorIdentity="";return null}return Fh.a.FD(-2130915320)}initialize(ka,bb,ub,Xb){this.Hm=ka;this.N6=bb;this.JXb=ub;this.bPg=Xb}beginDraftingAsync(ka){if(!ka)return new Promise((Xb,tc)=>{tc(Fh.a.FD(-2130915327))});const bb=new yh,ub=wc.a.Nqf(ka.sessionType);return void 0===ub||null===ub?new Promise((Xb,tc)=>{tc(Fh.a.FD(-2130915317))}):new Promise((Xb,tc)=>{Fh.a.a3(this.taskManager,()=>{if(1!==this.Hm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.Hm.mode),tc(Fh.a.FD(-2130915325));else{this.EBh();try{switch(ub){case 0:if(!this.Hm.Hca.ojb()){tc(Fh.a.FD(-2130915326));return}this.g1k.WUd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.Hm.Xyb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){tc(Fh.a.FD(-2130915324));return}if(this.ks.Teg){const le=this.N6.LD(ka.threadId);if(le){const md=this.N6.J5h(le,!1),Ee=mh.a.QDb(le,md,le.authorId===this.ks.AY);Ee&&this.s8e.invoke(ka.threadId,Ee)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.Hm.mode)}this.Hm.addReply(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){tc(Fh.a.FD(-2130915324));return}var Tc=this.N6.LD(ka.threadId);if(!Tc){tc(Fh.a.FD(-2130915323));return}this.Hm.editComment(Tc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){tc(Fh.a.FD(-2130915324));return}const Md=this.N6.LD(ka.commentId);if(!Md){tc(Fh.a.FD(-2130915323));return}this.Hm.editComment(Md,ka)}}catch(Md){tc(Md);this.Tcj();
a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Md} on Session ${ub}`);return}(Tc=this.kFn(bb))?tc(Tc):Xb(bb);this.Tcj()}},Zi.a.beginDraftingAsync)})}commit(ka,bb,ub){const Xb=this.kka.oy;if(!Xb)throw Fh.a.FD(-2130915320);var tc=Xb.iz;if(!tc)throw Fh.a.FD(-2130915320);const Tc=wc.a.Nqf(tc.sessionType);if(void 0===Tc||null===Tc)throw Fh.a.FD(-2130915317);if(ka!==tc.draftId)throw Fh.a.FD(-2130915327);let Md=!1,le=!1;tc=!1;switch(Tc){case 3:if(!ub)throw Fh.a.FD(-2130915327);break;case 0:this.Jk.he(()=>
{if(!this.Hm.Hca.ojb())throw Fh.a.FD(-2130915326);Xb.text=[bb];this.Hm.mA&&!this.Xh.$m?this.Hm.NAn(()=>{this.Hm.oua(Xb);this.Hm.Vsl(ka,Xb.id)}):this.Hm.oua(Xb);le=ub&&null!=ub.Task;Md=this.Hm.mA;Fh.a.a3(this.taskManager,()=>{this.Xnb(Xb.id)},Zi.a.Xnb)},"WESCA:C:C");break;case 1:this.Jk.he(()=>{Xb.text=[bb];this.Hm.oua(Xb);le=ub&&null!=ub.Task;Md=this.Hm.mA},"WESCA:C:R");break;case 2:this.Jk.he(()=>{Xb.text=[bb];this.Hm.Ieb(Xb);this.l3i(vj.a.f1m)},"WESCA:C:E");break;default:throw Fh.a.FD(-2130915322);
}ub&&(ub.Resolve&&(this.Pjj(Xb,ub.Resolve.isResolved),ub.Resolve.isResolved&&!this.Xh.$m&&this.Hm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),ub.Task&&this.Hm.G1k(Xb,ub.Task),ub.Reaction&&(tc=this.ks.m1k,ub.Reaction.isActive?this.Hm.Hyd(Xb,ub.Reaction.reactionType):this.Hm.Rce(Xb,ub.Reaction.reactionType)));this.ks.y1k&&le&&this.V0.execute(md=>md.logActivity(this.gZj,"CommentsTasksFpsIsEnabled"));Md&&this.V0.execute(md=>{md.logActivity(this.fZj,"CommentsFpsIsEnabled")});tc&&this.V0.execute(md=>
{md.logActivity(this.cZj,"CommentReactionsFpsIsEnabled")});return Xb.id}endCommentSession(ka){const bb=this.kka.oy;if(bb){if(bb.iz&&bb.iz.draftId!==ka)throw Fh.a.FD(-2130915327);if(bb.Vq===kd.a.beingCreated)this.Hm.deleteComment(bb),!this.Hm.mA||bb.Df||this.Xh.$m||this.focusManager.mg(Uf.AFrame.Pn);else{if(3!==this.Hm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}bb.Vq=kd.a.normal;bb.LSa=fo.a.succeeded;bb.iz=null;this.Hm.J5e()}}this.qt&&
this.qt.updateCommandUI(!0);this.kka.CQd()||this.yra.xmg(1,!this.Hm.mode)}deleteComment(ka){(ka=this.N6.LD(ka))?(this.Hm.deleteComment(ka),this.Hm.mA&&!this.Xh.$m?ka.Df||this.focusManager.mg(Uf.AFrame.Pn):this.focusManager.dD(Uf.AFrame.Gr),this.KLo.idg(ka)&&this.l3i(vj.a.PIi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.Xnb(ka,0)}highlightComment(ka){this.Hm.pec(ka,0)}setThreadResolvedState(ka,bb){(ka=this.N6.LD(ka))&&this.Pjj(ka,bb)}Pjj(ka,
bb){if(ka.Df&&""!==ka.Df)throw Fh.a.FD(-2130915321);this.Hm.qAb(ka,bb);bb&&!this.Xh.$m&&this.focusManager.mg(Uf.AFrame.Pn)}presentLinkToComment(ka){var bb=this.N6.LD(ka);bb?(bb=this.kka.HOd(bb))?(ka={["nav"]:btoa(`{"${xi.a.comment}":${bb}}`),["mode"]:"copy"},this.e1k.Mv(vj.a.presentLinkToComment),this.oc.Qb(vf.a.i8,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",
ka)}selectFirstThreadInNextCommentContext(){this.Hm.whj(0)}selectLastThreadInPreviousCommentContext(){this.Hm.obo()}registerForCommentEvents(ka){const bb=this.kka.iof(this.ks.cPb&&this.ks.Wq&&!this.Xh.$m),ub=this.kka.aVa,Xb=this.kka.CQd(),tc=!this.Hm.mode;this.yra.vlo();this.bPg.C2l().then(Tc=>{this.yra.tVn(ka,bb,Xb,tc,ub,Tc);this.yra.xmg(Xb?5:1,tc);this.qt&&this.qt.updateCommandUI(!0)})}unregisterForCommentEvents(ka){this.yra.yQb(ka)}registerForAction(ka,bb){this.pUj.lSa(ka,bb)}unregisterForAction(){}checkAtMentionCapability(){return this.JXb?
this.JXb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}EBh(){const ka=this.Hm.mA&&!this.Xh.$m?Uf.AFrame.rM:Uf.AFrame.Gr;if(ka===Uf.AFrame.Gr){if(!this.Xh.$m)return;co.UISurfaces.Bu().then(bb=>{bb.setSelectedTaskPane(bl.a.GEd);return null})}this.focusManager.dD(ka)}Xnb(ka,bb=
1){this.EBh();this.h_.phj(ka,Object.assign(new zd.a,{K9:bb,LR:1===bb}))}Tcj(){this.Hm.Hca.pdb&&(this.Hm.Hca.pdb=!1)}l3i(ka){this.oc.processAction(ka,2)}}Object(f.a)(Fp,"WordEditorSharedCommentAPI",null,[351,352]);class zl{constructor(ka,bb,ub,Xb,tc,Tc,Md=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=bb;this.commentBody=ub;this.author=Xb;this.date=tc;this.commentFlags=Tc;this.usersByReactionType=
Md}}Object(f.a)(zl,"OfficeSharedCommentModel",null,[]);c(1652);class Cf{constructor(ka,bb){this.Ma=ka;this.G3a=bb;this.Hmh="AD";this.jqc=new M.a;this.sWe=new M.a;this.DHk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.ZOg=new fi.a}get userPrincipalName(){return this.Ma.jb("UserPrincipalName")}get b5a(){return this.Ma.jb("PresenceProvider")}get AY(){return this.Ma.jb("PresenceUserId")}get vj(){return this.G3a.value}EQi(ka){const bb=this.DHk.exec(ka);return bb?bb[1]:ka}Tfi(ka,bb=!1){let ub=0;ka.done&&(ub=ka.Df&&
""!==ka.Df?ub|4:ub|8);ka.OHh&&(ub|=2);bb&&(ub|=1);this.idg(ka)&&(ub|=16);ka.wEf&&(ub|=32);this.mqm(ka)||(ub|=128);return ub}mqm(ka){return ka?(ka=this.vj.Db(ka.objectId))?ka.hasProperty(qa.a.F7):!1:!1}idg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.EKf(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.AY||null===this.AY||""===this.AY)return this.EKf(ka.id,ka.objectId,"PresenceUserId null or empty"),!1;if(this.AY==ka.authorId&&
ka.l1b==this.b5a)return!1;const bb=this.cLd(ka.authorId),ub=this.cLd(this.AY);if(this.b5a===this.Hmh&&bb&&ub&&bb[0]!=this.userPrincipalName&&bb[1]!=ub[1])return!0;this.EKf(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.AY||null===this.AY||""===this.AY)return!1;if(this.AY==ka.authorId&&ka.l1b==this.b5a)return!0;ka=this.cLd(ka.authorId);const bb=this.cLd(this.AY);return this.b5a===this.Hmh&&ka&&bb?ka[0]==this.userPrincipalName||
ka[1]==bb[1]:!1}cLd(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}EKf(ka,bb,ub){ka&&!this.ZOg.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${bb}; reason: ${ub}`),this.ZOg.add(ka))}M1h(ka,bb){var ub;if(!ka)return null;const Xb=ka.YZd;let tc=!1;1===bb&&(tc=!0);bb=ka.author?this.EQi(ka.author):"";const Tc=Wm.a.wgb(null!==(ub=ka.authorId)&&void 0!==ub?ub:"");ub=new yj.a(ka.authorId?ka.authorId:"",ka.l1b,
bb,null!==Tc&&void 0!==Tc?Tc:"",this.isCurrentUser(ka));return new zl(ka.id?ka.id:"",ka.Df?ka.Df:"",ka.text&&ka.text.length?ka.text[0]:null,ub,ka.date||Xb?ka.date:new Date,this.Tfi(ka,tc),this.Vfi(ka.usersByReactionType))}WHl(ka,bb,ub){const Xb=[],tc=new M.a;if(!ka)return Xb;for(const Tc of ka)Tc.Vq!==kd.a.beingCreated&&ub(Tc)&&(Tc.id&&this.jqc.nb(Tc.id)?(ka=this.jqc.J(Tc.id),ka=this.cbl(Tc,ka,bb),Xb.push(ka),tc.Z(Tc.id,ka)):Tc.id?(ka=this.M1h(Tc,bb),Xb.push(ka),tc.Z(Tc.id,ka)):a.ULS.sendTraceTag(50667679,
327,10,"CommentId should not be null"));this.jqc=tc;return Xb}dOl(ka,bb,ub){const Xb=[];for(const tc of ka)tc.Vq!==kd.a.beingCreated&&ub(tc)&&(tc.id&&this.jqc.nb(tc.id)?Xb.push(this.jqc.J(tc.id)):tc.id&&Xb.push(this.M1h(tc,bb)));return Xb}cbl(ka,bb,ub){var Xb=ka.YZd,tc=1===ub;ub=ka.Df?ka.Df:"";const Tc=ka.text&&ka.text.length?ka.text[0]:null,Md=ka.author?this.EQi(ka.author):"",le=ka.authorId?ka.authorId:"",md=ka.l1b?ka.l1b:"",Ee=Wm.a.wgb(le);Xb=ka.date||Xb?ka.date:new Date;tc=this.Tfi(ka,tc);const ef=
this.isCurrentUser(ka),Wf=this.Vfi(ka.usersByReactionType);return bb.parentId===ub&&bb.commentBody===Tc&&bb.author.DisplayName===Md&&bb.author.UserId===le&&bb.author.Provider===md&&bb.author.IsCurrentUser===ef&&bb.date===Xb&&bb.commentFlags===tc&&this.eGk(bb.usersByReactionType,Wf)?bb:(bb=new yj.a(le,md,Md,null!==Ee&&void 0!==Ee?Ee:"",ef),new zl(ka.id,ub,Tc,bb,Xb,tc,Wf))}eGk(ka,bb){if(!ka&&!bb)return!0;if(!bb||!ka)return!1;var ub=Object.keys(ka);if(ub.length!==Object.keys(bb).length)return!1;for(const Xb of ub){if(!(Xb in
bb))return!1;ub=ka[Xb];const tc=bb[Xb];if(ub.length!==tc.length)return!1;for(let Tc=0;Tc<ub.length;Tc++)if(!this.TFk(ub[Tc],tc[Tc]))return!1}return!0}TFk(ka,bb){return ka||bb?ka&&bb&&ka.UserId===bb.UserId&&ka.Provider===bb.Provider&&ka.Email===bb.Email&&ka.DisplayName===bb.DisplayName&&ka.IsCurrentUser===bb.IsCurrentUser?!0:!1:!0}Vfi(ka){if(!ka)return null;const bb={},ub=this.Ma.jb("PresenceUserId");for(const tc of Object.keys(ka)){const Tc=[];var Xb=ka[tc];for(const Md of Xb){Xb=Md.UserId===ub;let le;
this.sWe.nb(Md.UserId)?(le=this.sWe.J(Md.UserId),le.IsCurrentUser=Xb):(le=new yj.a(Md.UserId,Md.Provider,Md.DisplayName,Md.Email,Xb),this.sWe.add(Md.UserId,le));Tc.push(le)}bb[tc]=Tc}return bb}}Object(f.a)(Cf,"WordEditorSharedCommentModelTranslator",null,[350]);class Gd{constructor(){this.pn=null;this.oed=this.Dah=this.ELg=this.Lhh=this.Bkh=this.m7g=this.Ech=!1}Ufi(){this.pn||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Dmj());
return this.pn}C2l(){return new Promise((ka,bb)=>{this.oed?ka(this.fbi()):this.njj().then(()=>{ka(this.fbi())}).catch(ub=>{bb(ub)})})}fbi(){this.oed||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.ELg&&(ka|=2);this.Ech&&(ka|=8);this.Bkh&&(ka|=16);this.m7g&&(ka|=4);this.Lhh&&(ka|=64);this.Dah&&(ka|=128);return ka}}Object(f.a)(Gd,"OfficeSharedCommentsAppCapabilities",null,
[1222]);class Ve extends Gd{constructor(ka){super();this.lXa=null;this.ah=ka;this.Fmo();this.Dmj()}Fmo(){this.Lhh=this.ah.OPb;this.Bkh=!1;this.Dah=this.m7g=this.Ech=!0}initialize(ka){this.lXa=ka;this.njj()}Dmj(){this.pn={};this.pn.LivePersonaPicker="true";this.pn.PersonaColor="true";this.pn.DiscreteHostedComments=this.ah.vnl.toString();this.pn.NewCommentButton="true";this.pn.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.ah.onl;this.pn.CommentsFluentUI="true";this.pn.CommentTasks=
this.ah.OPb.toString();this.pn.CommentTasksFromReply=this.pn.CommentTasks;this.pn.CommentsFluentUIV2="true";this.pn.CommentFriendlyTimestamps=this.ah.H0k.toString();this.pn.AtMentionFloodgateSurvey=this.ah.aHk.toString();this.pn.HyperlinksInComments="true";this.pn.NewModelState="true";this.pn.LogDraftCommentIdPair="true";this.pn.RichTextFormattingInWeb=this.ah.Gzb.toString();this.pn.NoDiscardOnFocusLoss="true";this.pn.NewResolvedCardDesignInWeb="true";this.pn.RichContentEditIntegration="true";this.pn.HyperlinksWithDisplayText=
"true";this.pn.SmartReplies=this.ah.Teg.toString();this.pn.NewBorderAndFocusLookInWeb="true";this.pn.LinkToComment="true";this.pn.TaskPaneWithNewInfrastructure="true";this.pn.CommentReactions="true";this.pn.WebThemeIntegration="true";this.pn.NewSelectionInteractions="true";this.pn.QuillInitializationTelemetry="true";this.pn.PersonaIconImageForWeb="true";this.pn.HighlightsAndFontColorInWebComments="true";this.pn.TruncationUIWithReadMoreText="true";this.pn.CtrlEnterTip="true";this.pn.AtMentionHintMessage=
"true";this.pn.LivePersonaCardForWeb=this.ah.MZm.toString();this.pn.TaskHistoryRecordIDs=this.ah.vGo.toString();this.pn.ContentNavigation=this.ah.contentNavigationApiEnabled.toString()}njj(){return new Promise((ka,bb)=>{this.lXa?this.lXa.atMentionsEnabledAsync().then(ub=>{this.ELg=ub;this.oed=!0;ka(this.oed)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),bb(Fh.a.FD(-2130915320)))})}}
Object(f.a)(Ve,"WordSharedCommentsAppCapabilities",Gd,[348]);class un{constructor(){this._initialized=!1;this.x1k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Lg.a.ljf,vetoPillar:7};this.CGo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:lc.a.ljf,vetoPillar:7}}get P4a(){return null!=this.AEg?this.AEg:this.AEg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}TZ(ka){this.P4a.TZ(Qi.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}xc(ka){this.W=
ka;this.TZ("CPConfigStart");ka.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new ul.a(n.Health.instance,new jh.a,this.x1k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new ul.a(n.Health.instance,new jh.a,this.CGo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.CommentNodeTracker",()=>new Ye(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();
ka.ha("WordEditor.Comments.CommentsSettings",()=>new Wi(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new X.a(()=>U.App.xa.hb.Uc),new X.a(()=>ag.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();ka.ha("WordEditor.Comments.CommentsState",()=>new ki.a).singleInstance();ka.ha("WordEditor.Comments.WordCommentEventsActor",()=>new bk(ka.Sa("Box4.TrackChange.ITrackChangeManager"),
ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();ka.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Cf(y.AFrameworkApplication.K,new X.a(()=>U.App.xa.hb.Uc.od))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();ka.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new cb(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();
ka.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new yl(y.AFrameworkApplication.pc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Of(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();ka.ha("WordEditor.Comments.EditorCommentModel",Nf.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();
ka.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new Th(new X.a(()=>U.App.xa.hb.Uc),new X.a(()=>ag.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ha("WordEditor.Comments.ICommentFilterActor",()=>new Ec(ka.resolve("WordEditor.Comments.IEditorCommentModel"),
y.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Sj(new X.a(()=>U.App.xa.hb.Uc),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").zl,P.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),
ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();ka.ha("WordEditor.Comments.CommentHighlightUtils",()=>new dg(ka.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();ka.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new pc(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();ka.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new xk(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ka.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ta.f1,y.AFrameworkApplication.ta.dIa,y.AFrameworkApplication.va,y.AFrameworkApplication.pc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Sa("WordEditor.Comments.IEditorCommentManager"))).singleInstance();ka.ha("WordEditor.Comments.CommentHighlightActor",()=>new jc(new X.a(()=>U.App.xa.hb.Uc.od),ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ka.Sa("WordEditor.Comments.IEditorCommentManager"),P.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();ka.ha("WordEditor.Comments.CommentHintActor",()=>new Da(ka.resolve("WordEditor.Comments.CommentsSettings"),Lh.a.instance,Ck.a.instance,
lk.a.instance,y.AFrameworkApplication.va,cg.TableCellReader.uMm,pg.moveToLastRenderedCellOfTheRow,new og.a,ka.Sa("Box4.ContentControlConfigSettings"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();
ka.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new ne(Lh.a.instance,lk.a.instance,y.AFrameworkApplication.va,ka.resolve("WordEditor.Comments.ICommentHintActor"),ka.Sa("Common.IZoomManager"))).singleInstance();ka.ha("WordEditor.Comments.ViewContainerAPI",()=>new Yf(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();ka.ha("Common.Comments.CommentActivationManager",()=>new Pk).as("Common.Comments.ICommentActivationManager").singleInstance();
ka.ha("Common.Comments.ViewContainerEventHost",()=>new Fm(y.AFrameworkApplication.pc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new Hq(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();
ka.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new Ve(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.TZ("CPConfigEnd")}init(){this.TZ("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{try{this.jn(),this.TZ("CPInitEnd")}catch(ka){throw a.ULS.eD(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.P4a.yx(Qi.a.comments,
"CPInitException",ka,!0),ka;}})}jn(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.TZ("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new nh(y.AFrameworkApplication.va,y.AFrameworkApplication.ta.hD,y.AFrameworkApplication.ta.iD,y.AFrameworkApplication.ta.Dp,y.AFrameworkApplication.ta.nx,U.App.xa,be.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
y.AFrameworkApplication.pc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new $k(y.AFrameworkApplication.va,
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").loc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Fp(y.AFrameworkApplication.pc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
ka,U.App.xa,y.AFrameworkApplication.ta.Dp,this.W.Sa("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,P.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();am.a.factory=$h.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",
$h.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new oc(this.W.resolve("WordEditor.Comments.CommentsState"),ka,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.pc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${jd.AppFrame.rUa} .${ak.a.q4b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ta.Dp)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const bb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),ub=bb.trackChangeInSidetrackEnabled;ub&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").s8i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ha("WordEditor.Comments.FloatingCommentManager",
()=>new He(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.pc,P.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),bb)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",()=>ub?
this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new Cn(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),fh.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
y.AFrameworkApplication.ta.Dp,this.W.resolve("WordEditor.Comments.CommentsState"),ka,new X.a(()=>sh.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Sa("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new sf(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),fh.getInstance(),U.App.xa.Gq,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").Pz,this.W.Sa("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ta.Dp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Sa("Common.App.SafeLinks.ISafeLinksManager"),this.W.Sa("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),bb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new ue(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new X.a(()=>U.App.xa.hb.Uc.od),y.AFrameworkApplication.va,
new X.a(()=>sh.a.instance),bg.FocusManager.instance(),P.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new Dp(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",
()=>new rf(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const Xb=ka.Wq,tc=this.W.resolve("WordEditor.Comments.EditorCommentManager");
this.W.resolve("WordEditor.Comments.CommentsActionManager");tc&&Xb&&(this.W.resolve("WordEditor.Comments.CommentsState").ldb=un.o4h(),ka.UBb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").T4("OnCommentInit"));ac.a.R4m();ka.c9b&&U.App.xa.hb.HVh();am.a.instance&&(ka.UBb||Hd.a.get_instance().xk(4,()=>{this.yln(Xb)},11).continueWith(()=>{this.Kxm()}),this._initialized=!0);this.zTn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}Kxm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").T4("OnCommentInit")}yln(ka){ka||
this.Njm()}Njm(){const ka=un.o4h();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.WW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").T4("OnCommentInit",Object.assign(new ah.a,{eGa:()=>{am.a.instance.Hca.isVisible||y.AFrameworkApplication.va.processAction(vf.a.mV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").mhj(ka,Object.assign(new zd.a,{mdg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Mv(vf.a.n8e))}zTn(ka,
bb,ub){ka&&ka.execute(Xb=>{Xb.V4(new Jb.a(bb,ub))})}dispose(){this._initialized&&(am.a.instance&&am.a.instance.dispose(),this._initialized=!1)}static o4h(){return y.AFrameworkApplication.K.jb("BootActivityNavigationId")}}Object(f.a)(un,"PackageManager",null,[1,2]);const Nl=ka=>{const bb=L.a.instance.Sa("Box4.IPackageBootPerfLogger"),ub=window.performance.now();bb.execute(Xb=>{Xb.yx(Qi.a.comments,"CPMain",ub,!0)});z.a.instance.Fc(new un,0,ka)};var Xm=c(1956);class nl{isComment(ka){return Re.a.isComment(ka)}KXd(ka){return Re.a.KXd(ka)}RBf(ka){return Re.a.RBf(ka)}bTf(ka,
bb){Re.a.bTf(ka,bb)}fTf(ka,bb){Re.a.fTf(ka,bb)}zaf(ka){return Re.a.zaf(ka)}o4a(ka){return ag.a.instance.o4a(ka)}deleteComment(ka,bb){Re.a.deleteComment(ka,bb)}ZHd(ka,bb){Re.a.ZHd(ka,bb)}wnb(ka){Re.a.wnb(ka)}yba(ka,bb,ub){return Re.a.yba(ka,bb,ub)}Ava(ka,bb,ub){return Re.a.Ava(ka,bb,ub)}A8b(ka,bb){return Re.a.A8b(ka,bb)}vNc(ka,bb,ub,Xb=null){return Re.a.vNc(ka,bb,ub,Xb)}X_b(ka,bb,ub,Xb){Re.a.X_b(ka,bb,ub,Xb)}Gyd(ka,bb,ub,Xb){return Re.a.Gyd(ka,bb,ub,Xb)}get XGb(){return Re.a.XGb}set XGb(ka){Re.a.XGb=
ka}BKb(ka,bb){Re.a.BKb(ka,bb)}U3c(ka){Re.a.U3c(ka)}J4f(ka){Re.a.J4f(ka)}QQd(ka,bb){return Re.a.QQd(ka,bb)}cTf(ka,bb){Re.a.cTf(ka,bb)}eTf(ka,bb){Re.a.eTf(ka,bb)}h6d(ka,bb,ub,Xb,tc,Tc){Re.a.h6d(ka,bb,ub,Xb,tc,Tc)}Dhf(ka,bb){Re.a.Dhf(ka,bb)}R1c(ka,bb,ub,Xb){return Re.a.R1c(ka,bb,ub,Xb)}W1c(ka,bb,ub,Xb){return Re.a.W1c(ka,bb,ub,Xb)}}Object(f.a)(nl,"CommentEditorProxy",null,[347]);class lo{constructor(){this.W=null}get HPb(){return null!=this.bHg?this.bHg:this.bHg=(()=>this.W.Sa("WordEditor.ITableEditor"))()}get P4a(){return null!=
this.BEg?this.BEg:this.BEg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}TZ(ka){this.P4a.TZ(Qi.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}xc(ka){this.W=ka;this.TZ("CIPConfigStart");ka.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new nl).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.TZ("CIPConfigEnd")}init(){this.TZ("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn();this.TZ("CIPInitEnd")})}jn(){this.ysm()}dispose(){}ysm(){Wc.a.mSa(Re.a.fTf);
Xm.a.g_e(Re.a.cTf);Xm.a.wzd(Re.a.eTf);Xm.a.Pwk(Re.a.vln);this.HPb.execute(bb=>{bb.h_e(Re.a.BKb)});const ka=U.App.Tj.zl;ka.Ye(39).Go(Re.a.bTf);Xm.a.Wvk(Re.a.Akn);Xm.a.Nvk(Re.a.Ljn);ke.a.isEnabled&&ka.Ye(12).Ow(Re.a.gQj)}}Object(f.a)(lo,"PackageManager",null,[1,2]);const go=ka=>{const bb=L.a.instance.Sa("Box4.IPackageBootPerfLogger"),ub=window.performance.now();bb.execute(Xb=>{Xb.yx(Qi.a.comments,"CIPMain",ub,!0)});z.a.instance.Fc(new lo,0,ka)};var gj=c(2069),rc=c(152),Ym=c(1668);class Pc{constructor(ka,
bb,ub,Xb,tc,Tc,Md){this.qMa=ka;this.xaa=bb;this.Z6=ub;this.Wc=Xb;this.b4j=tc;this.MKe=Tc;this.ivb=Md;Ym.a.Owk((le,md)=>{this.Luk(md.graphNode,md.s0k)});Ym.a.txk((le,md)=>{this.h7k(md.graphNode,md.qZk)})}PPd(){var ka=this.b4j();const bb=this.Wc.yk();bb.set(ka);if(this.xaa.IOo(bb))return bb;bb.set(ka);rc.PageNavigator.instance.gP(bb);ka=this.Z6.Ndl(bb.currentNode);bb.Fi(ka);return bb}lSd(ka){const bb=this.PPd();let ub=null;this.xaa.QMd(bb,Xb=>{this.Z6.shi(Xb)===ka&&(ub=Xb);return!ub});return ub}ohi(ka){const bb=
this.PPd();let ub=null;this.xaa.QMd(bb,Xb=>{this.Z6.H8b(Xb)===ka&&(ub=Xb);return!ub});return ub}zJi(ka,bb,ub){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,bb,ub)}thi(){const ka=this.PPd(),bb=[];this.xaa.QMd(ka,ub=>{bb.push(this.Z6.shi(ub));return!0});return bb}hfb(ka,bb){if(!bb.length)return this.ivb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const ub=this.PPd(),Xb=
lh.a.create().toString(),tc=new de.a;for(let Tc of bb)tc.add(Tc),this.zJi(Tc.type,Xb,Tc.completion);bb=this.qMa.n$f(tc);this.Z6.hfb(ub.currentNode,Xb,ka,bb);this.MKe();return Xb}We(ka){(ka=this.lSd(ka))?(this.Z6.We(ka),this.MKe()):this.ivb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}H8b(ka){ka=this.lSd(ka);return ka?this.Z6.H8b(ka):(this.ivb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}phi(ka){return this.Z6.H8b(ka)}rhi(ka){ka=
this.lSd(ka);if(!ka)return this.ivb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.Z6.Ktf(ka);return this.qMa.y4b(ka).toArray()}aDk(ka,bb){if(!bb.length)return this.ivb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const ub=this.lSd(ka);if(!ub)return this.ivb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Xb=this.Z6.Ktf(ub),tc=this.qMa.y4b(Xb);
for(let Tc of bb)tc.add(Tc),this.zJi(Tc.type,ka,Tc.completion);ka=this.qMa.n$f(tc);ka!==Xb&&(this.Z6.hmo(ub,ka),this.MKe());return!0}Luk(ka,bb){if(bb=this.ohi(bb)){const ub=this.Wc.yk();ub.set(ka);this.Z6.Wb(bb.clone(),this.Z6.Jvl(bb,ub))}}g7i(ka,bb,ub){if(bb.nb(ka))return bb.J(ka);const Xb=lh.a.create().toString();bb.add(ka,Xb);ub&&this.ivb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Xb}h7k(ka,bb){const ub=new sm.a;var Xb=
this.Wc.yk();Xb.set(ka);Xb.Sb(38)&&this.xaa.QMd(Xb,tc=>{const Tc=this.Z6.H8b(tc);void 0!==Tc&&null!==Tc&&ub.add(Tc,tc);return!0});for(let tc of bb)if(ka=null,({value:ka}=ub.Dc(tc.key,ka)).returnValue)if(tc.value===tc.key)ka=this.ohi(tc.key),this.Z6.Tmo(ka,parseInt(tc.key));else{ka=this.Z6.Ktf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.qMa.y4b(ka);Xb=new fb.a;for(let Tc=0;Tc<ka.length;Tc++){if(ka.J(Tc).commentId){const Md=
Number.parseInvariant(ka.J(Tc).commentId);bb.nb(Md)?ka.J(Tc).commentId=bb.J(Md).toString():ka.J(Tc).commentId=null}ka.J(Tc).recordId=this.g7i(ka.J(Tc).recordId,Xb,!1);-1===ka.J(Tc).type&&(ka.J(Tc).undoId=this.g7i(ka.J(Tc).undoId,Xb,!0))}this.hfb(tc.value,ka.toArray())}}static Jr(){return new Pc(L.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),L.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new og.a,()=>U.App.xa.hb.Uc,()=>
{L.a.instance.Sa("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(f.a)(Pc,"TaskActor",null,[572]);var tm=c(1113);class nk{create(){return new tm.a}}Object(f.a)(nk,"TaskContentNodeFactory",null,[395]);var Ol=c(1057);class Go{create(){return new Ol.a}}Object(f.a)(Go,"TaskNodeFactory",null,[395]);class zj{constructor(ka,bb,ub,Xb,tc,Tc){this.xaa=ka;this.Gc=bb;this.Wc=ub;this.hlk=Xb;this.klk=tc;this.zSb=Tc}qcl(ka,bb,ub){const Xb=this.klk.create(1074135162);Xb.setValue(qa.a.taskId,
ka);Xb.setValue(qa.a.LPb,bb);Xb.setValue(qa.a.Sya,ub);return Xb}J8b(ka){const bb=this.Gc.Oc(4);bb.Cb(ka);this.zSb();return bb}shi(ka){return this.xaa.aIb(ka)?ka.getValue(qa.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}H8b(ka){return this.xaa.aIb(ka)?ka.hasProperty(qa.a.LPb)?ka.getValue(qa.a.LPb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Ktf(ka){return this.xaa.aIb(ka)?ka.getValue(qa.a.Sya):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}Ndl(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const bb=this.J8b(ka);try{const ub=this.hlk.create(1074135161),Xb=this.Wc.yk();Xb.set(ka);Xb.Y2(ub,38,zj.rGo);return ub}finally{bb&&bb.dispose()}}hfb(ka,bb,ub,Xb){if(!this.xaa.vGf(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const tc=this.J8b(ka);try{const Tc=this.qcl(bb,ub,Xb),Md=this.Wc.yk();Md.set(ka);Md.Y2(Tc,1,new la.a(lh.a.Dua(ub.toString()),1));return Tc}finally{tc&&
tc.dispose()}}We(ka){if(this.xaa.aIb(ka))if(ka.anchor&&ka.anchor.eq){var bb=ka.anchor.eq.vr.node;if(this.xaa.vGf(bb)){var ub=this.J8b(bb);try{const Xb=this.Wc.yk();Xb.set(bb);Xb.Fi(ka.anchor.node);Xb.Cg()}finally{ub&&ub.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}hmo(ka,bb){if(this.xaa.aIb(ka)){var ub=
this.J8b(ka);try{ka.setValue(qa.a.Sya,bb)}finally{ub&&ub.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Tmo(ka,bb){if(this.xaa.aIb(ka)){var ub=this.J8b(ka);try{const Xb=ka.hasProperty(qa.a.LPb)?ka.getValue(qa.a.LPb):null;void 0===Xb||null===Xb||Xb===bb?ka.Zg(qa.a.LPb,bb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{ub&&ub.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}Jvl(ka,bb){if(!bb.Nr(38)){const ub=this.Wc.yk();
ub.set(ka);ub.zb(71);ub.jd(71);ka=lb.a(ub.currentNode,ka.Bi().Jc,!0);bb.Jf(ka,38)}return bb.Sb(38)}Wb(ka,bb){if(this.xaa.vGf(bb)){var ub=this.J8b(bb);try{const Xb=this.Wc.yk();Xb.set(bb);Xb.Jf(ka,1)}finally{ub&&ub.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Jr(){return new zj(L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new Bd.a,new og.a,new nk,new Go,()=>{Gl.App.un.hb.Uc.hF.w7(10)})}}zj.rGo=new la.a(lh.a.Ff("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(f.a)(zj,"TaskEditor",null,[570]);class ip{constructor(ka,bb){this.vx=ka;this.cwb=bb}aIb(ka){return!!ka&&72===ka.type}NSm(ka){return!!ka&&71===ka.Ve}vGf(ka){return!!ka&&71===ka.type}IOo(ka){ka.set(this.vx.value);this.cwb.gP(ka);return!!ka.Sb(38)}QMd(ka,bb){if(ka&&bb)if(this.NSm(ka))for(var ub=!0,Xb=ka.Sb(1);ub&&Xb;)this.aIb(Xb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Xb.type),ub=bb(Xb),Xb=ka.vf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.Ve);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Jr(){return new ip(new X.a(()=>U.App.xa.hb.Uc),rc.PageNavigator.instance)}}Object(f.a)(ip,"TaskNavigator",null,[346]);class Mj{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}dispose(){}xc(ka){this.W=ka;ka.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new gj.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();
ka.ha("WordEditor.Tasks.TaskNavigator",()=>ip.Jr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();ka.ha("WordEditor.Tasks.TaskEditor",()=>zj.Jr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();ka.ha("WordEditor.Tasks.TaskActor",()=>Pc.Jr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}jn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(115)}}Object(f.a)(Mj,"TasksPackage",null,[1,2]);var Ug=c(79),jp=c(1665),ol=c(400),ld=c(93);class Om{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(Om,"TaskPaneGroupAppProps",null,[]);var zo=c(180);class mo{static L1k(ka,bb){bg.FocusManager.$J()&&(Ck.a.instance.bCa(ka,bb,!1),zo.a.instance.bCa(ka,bb,!1),y.AFrameworkApplication.ta.nx.gT(ka))}}Object(f.a)(mo,"ReactTaskPaneManagerUtils",null,[]);var Qk=c(141),Ho=c(332);class Iq{constructor(){this.type=
null}}Object(f.a)(Iq,"SampleTaskPaneProps",null,[]);var kq=c(1666);class Ik{constructor(){this.entry=null;this.show=!1}}Object(f.a)(Ik,"AnimationBatchEntry",null,[]);var no=c(292),rj=c(1129),mg=c(125);class Jk{constructor(){this.q$g=[];this.r$g=[];this.zla={};this.DJa=this.CJa=null;this.Qvd=!1;this.zZ=null;this.Zsd=this.Rnd=0;this.Foc=[];this.ZFe=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Nb.Vjb;this.Jw=!1}initialize(){this.Qvd=!1;(this.Jw=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Nb.xJ)&&
this.mbf()}obf(ka,bb,ub,Xb){bb=this.nSd(bb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.mbf();const tc=document.createElement("div");tc.id=bb;tc.className=Jk.K1o;tc.style.width="0";this.ZFe||(this.Grk(ub,bb,tc),this.zla[bb]=ka.obf(bb,ub,Xb,tc));return tc}mbf(){this.Qvd||this.Soo()}Grk(ka,bb,ub){let Xb=null,tc=null;0===ka?(Xb=this.CJa,tc=this.q$g):1===ka&&(Xb=this.DJa,tc=this.r$g);if(Xb){ka=!1;for(let Tc=0;Tc<tc.length;Tc++)if(!ka)tc[Tc]===bb&&(ka=!0);else if(tc[Tc]in this.zla){this.eCm(Xb,
ub,this.zla[tc[Tc]]);return}Xb.appendChild(ub)}}eCm(ka,bb,ub){ka.insertBefore(bb,ub.element)}Jol(ka){ka=this.nSd(ka);if(ka in this.zla){const bb=this.zla[ka];bb.element.parentNode.removeChild(bb.element);delete this.zla[ka]}}jsj(ka){ka=this.nSd(ka);ka in this.zla&&(ka=this.zla[ka])&&!ka.isVisible&&(this.trj(ka,!0),this.Kqh(ka.position,!0,this.Azh(ka,!0)),1===ka.position&&1<H.a.count(this.zla)&&this.q7m())}Wrm(ka){ka=this.nSd(ka);ka in this.zla&&(ka=this.zla[ka])&&ka.isVisible&&(this.trj(ka,!1),this.Kqh(ka.position,
!1,this.Azh(ka,!1)))}Q3b(ka){if(this.zZ)return this.zZ;const bb=document.createElement("div");document.body.appendChild(bb);bb&&(this.zZ=new jp.a(bb,ka));return this.zZ}trj(ka,bb){ka.element&&(ka.isVisible=bb,this.Foc.push(Object.assign(new Ik,{entry:ka,show:bb})));0===ka.position?this.Rnd+=bb?1:-1:this.Zsd+=bb?1:-1;1===this.Foc.length&&window.setTimeout(Object(fm.a)(this,this.nBo,"startPaneAnimation"),0);this.Jw&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.Rnd||1===ka.position&&!this.Zsd?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}nBo(){this.wVi();var ka=Fb.where(Fb.asEnumerable(this.Foc),tc=>0===tc.entry.position),bb=Fb.where(ka,tc=>!tc.show);if(Fb.any(bb)&&Fb.Ct(bb)!==Fb.Ct(ka)){for(var ub of bb)ub.entry.element.style.width="0";ka=Fb.where(ka,tc=>tc.show)}bb=Fb.where(Fb.asEnumerable(this.Foc),
tc=>1===tc.entry.position);ub=Fb.where(bb,tc=>!tc.show);if(Fb.any(ub)&&Fb.Ct(ub)!==Fb.Ct(bb)){for(var Xb of ub)Xb.entry.element.style.width="0";bb=Fb.where(bb,tc=>tc.show)}for(let tc of Fb.concat(ka,bb))ka=tc.entry,mg.WacAirSpace.aV(ka.element,no.a.Zdg),Xb=new rj.a(ka.element),tc.show?Xb.s0e(0,ka.width):Xb.s0e(ka.width,0),mg.WacAirSpace.animate(Xb,null,null);this.Foc.length=0}wVi(){}Azh(ka,bb){let ub=ka.width;ka=0===ka.position?this.Rnd:this.Zsd;if(bb&&1===ka||!bb&&!ka)ub+=1;return ub}Soo(){this.Qvd||
(this.CJa||(this.CJa=document.createElement("div"),this.CJa.id=Jk.I1o,this.CJa.className=Jk.FJj,Sys.UI.DomElement.addCssClass(this.CJa,"alignLeft"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Nb.M8&&Sys.UI.DomElement.addCssClass(this.CJa,"FlexBoxLayout"),this.ZFe&&Sys.UI.DomElement.addCssClass(this.CJa,Jk.CJj),this.Noh(0,this.CJa)),this.DJa||(this.DJa=document.createElement("div"),this.DJa.id=Jk.J1o,this.DJa.className=Jk.FJj,Sys.UI.DomElement.addCssClass(this.DJa,"alignRight"),y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Nb.M8&&Sys.UI.DomElement.addCssClass(this.DJa,"FlexBoxLayout"),this.ZFe&&Sys.UI.DomElement.addCssClass(this.DJa,Jk.CJj),this.Noh(1,this.DJa)),this.BXi(this.CJa,this.DJa),this.Qvd=!0)}BXi(){}eCa(ka,bb){Array.add(1===ka?this.r$g:this.q$g,bb)}nSd(ka){return ka+"-Entry"}q7m(){let ka=0;for(const bb of H.a.HO(this.zla)){const ub=Object(Ab.a)(1281,this.zla[bb]);ub&&ub.isVisible&&1===ub.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}Jk.I1o="WACTaskPaneContainerLeft";Jk.J1o="WACTaskPaneContainerRight";Jk.FJj="WACTaskPaneContainer";Jk.K1o="WACTaskPaneEntry";Jk.CJj="WACReactTaskPaneContainer";Object(f.a)(Jk,"BaseTaskPaneManager",null,[1282]);var cl=c(486),Ff=c(290);class Xo extends Jk{constructor(ka,bb){super();this.xxc=this.wxc=this.LWe=this.KWe=0;this.b1h=()=>{Zb.InteractiveViewManager.instance.forEach(ub=>{ub.UMd()})};this.ga=ka;this.j_g=bb}Noh(ka,bb){const ub=
U.App.xa.lD;ub.parentNode&&(ka?1===ka&&(this.Jw?((ka=Object(Ff.a)("FarPane"))&&ka.appendChild(bb),bb.classList.add("regionComposer"),U.App.xa.GI.registerBoundingWindowRectsChanged("farPane",(Xb,tc)=>{"DP"===tc||3===tc?bb.classList.add("DL"):bb.classList.remove("DL")})):ub.parentNode.insertBefore(bb,ub.nextSibling)):this.Jw?((ka=Object(Ff.a)("NearPane"))&&ka.appendChild(bb),bb.classList.add("regionComposer")):ub.parentNode.insertBefore(bb,ub))}Kqh(ka,bb,ub){this.Jw||(bb=bb?ub:-ub,ka?this.xxc+=bb:this.wxc+=
bb)}wVi(){if(!this.Jw){var ka=U.App.xa.lD;mg.WacAirSpace.aV(ka,no.a.Zdg);if(this.KWe!==this.wxc){const bb=new cl.a(ka);bb.zBk(this.KWe,this.wxc,this.j_g);mg.WacAirSpace.animate(bb,null,this.b1h);this.KWe=this.wxc}this.LWe!==this.xxc&&(ka=new cl.a(ka),ka.ABk(this.LWe,this.xxc,this.j_g),mg.WacAirSpace.animate(ka,null,this.b1h),this.LWe=this.xxc)}}}Object(f.a)(Xo,"TaskPaneManager",Jk,[]);var Kk=c(271);class qf extends Xo{get pwi(){null==this.fre&&(this.fre=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.fre}constructor(ka,bb){super(ka,bb);this.vW=Lc.KeyInputManager.kc(Ug.a.Aw,0);this.wW=Lc.KeyInputManager.kc(Ug.a.Aw,4);this.CPe=this.ixc=null;this.p4g="AccCheckerTaskPane";this.ra=new pa.a;this.isPaneOpen=!1;this.fre=this.Wze=null;this.eCa(0,"SampleTaskPane");this.eCa(0,Kk.a.Dgb);this.eCa(1,Kk.a.WGk);this.eCa(1,"CustomTaskPane");this.eCa(1,Kk.a.HAf);this.eCa(1,Uf.AFrame.Gr);this.eCa(1,Uf.AFrame.Emh);this.eCa(1,Uf.AFrame.zmh);this.eCa(1,Kk.a.$Md);this.eCa(1,Kk.a.lJc);this.eCa(1,
Kk.a.ZKc);this.C8j=(this.jLg=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Nb)&&y.AFrameworkApplication.ta.Nb.pFf;this.J7j=Gl.App.iIb;this.P7j=this.jLg&&y.AFrameworkApplication.ta.Nb.qVc;this.initialize();ka.fb(vj.a.qeg,wi.a.application,qf.qeg,96)}get Tde(){if(!U.App.xa||!U.App.xa.lD)return null;this.CPe||(this.CPe=new jp.a(U.App.xa.lD,bg.FocusManager.instance()));return this.CPe}Tb(){}BXi(ka,bb){const ub=ol.a.instance,Xb=bg.FocusManager.instance(),tc=ld.EventHandlerManager.instance,
Tc=this;co.UISurfaces.Bu().then(Md=>{Tc.ixc=Tc.Q3b(Xb);let le;Md.renderTaskPaneGroups(ka,bb,(le=new Om,le.middleContainer=U.App.xa.lD,le.onTabStripFocus=()=>{Xb.dD(Kk.a.Ckc)},le.onOpen=(md,Ee)=>{Tc.qFf(md)&&mo.L1k(md,Ee);tc.CYe(Ee,"focus",Tc.nfi(md,Xb),!0);var ef=Tc.Yxi(md),Wf=Md.selectors.getTabbedTaskPaneCount(ef?1:2);ef=ef?Kk.a.xke:Kk.a.Ckc;1===Wf&&(ub.Eaa(ef),this.isPaneOpen=!0,this.E5i({isPaneOpen:this.isPaneOpen,NPb:Ee}));Ee=Tc.Wpf(md);if(Wf=Xb.fe(Ee))Wf.kHc=ef,Tc.uto(md)&&(Wf.ir(Tc.vW),Wf.ir(Tc.wW)),
ub.Iwi(Ee)&&ub.Ww(Ee);this.pwi&&this.ZKd&&this.ZKd.Xw(!0)},le.onClose=(md,Ee)=>{Tc.qFf(md);const ef=Tc.Yxi(md),Wf=ef?Kk.a.xke:Kk.a.Ckc;Md.selectors.getTabbedTaskPaneCount(ef?1:2)||(ub.Ww(Wf),this.isPaneOpen=!1,this.E5i({isPaneOpen:this.isPaneOpen,NPb:Ee}));tc.M4f(Ee,"focus",Tc.nfi(md,Xb),!0);this.pwi&&this.ZKd&&this.ZKd.Xw(!0)},le.setFocusCallback=(md,Ee)=>{Tc.qFf(md)&&Ee&&(md=Xb.fe(Tc.Wpf(md)),md.fYk(),md.ffa(Ee))},le.onOverflowMenuOpen=()=>{if(Tc.ixc)Tc.ixc.onMenuOpen()},le.onOverflowMenuClose=
()=>{if(Tc.ixc)Tc.ixc.onMenuClose()},le.onShow=(md,Ee)=>{2===Ee&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Xb.mg(md)},0)})},le.onHide=(md,Ee,ef)=>{ef&&1!==Ee&&Xb.mg(Xb.yT)},le.onResizeStart=()=>{if(U.App.xa&&(U.App.xa.lD.className=jd.AppFrame.kog,Tc.Tde))Tc.Tde.onMenuOpen()},le.onResizeEnd=()=>{if(U.App.xa&&(Qk.a.nAi()||(U.App.xa.lD.className+=" "+U.App.xa.TAh),Tc.Tde))Tc.Tde.onMenuClose()},le));this.aja(Kk.a.Ckc,Xb,bb,Tc);this.aja(Kk.a.xke,Xb,ka,Tc);return null})}aja(ka,bb,ub,Xb){const tc=
bb.fe(ka);tc.parent=Uf.AFrame.vp;tc.TH=!0;Ck.a.instance.bCa(ka,ub,!1);zo.a.instance.bCa(ka,ub,!1);ka=new Ho.DOMFocusListing(()=>ub);ka.Xm(3);ka.Xm(2);ka.Xm(4);ka.Xm(1);bb.ema(()=>ub,tc,ka).oR=!0;tc.ir(Xb.vW);tc.ir(Xb.wW)}Wpf(ka){return ka===this.p4g?Kk.a.Jlh:ka}nfi(ka,bb){return()=>{bb.dD(this.Wpf(ka))}}uto(ka){return ka===this.p4g?!1:!0}EJm(ka){return ka===Kk.a.Dgb}qFf(ka){return this.EJm(ka)||ka===Kk.a.Jlh||0<=ka.indexOf("AppForOfficePanel")||ka===Kk.a.$Md||ka===Kk.a.HAf&&this.C8j||ka===Kk.a.lJc&&
this.J7j||ka===Kk.a.ZKc&&this.P7j||ka===kq.a.pDb?!0:!1}Yxi(ka){return ka===Kk.a.Dgb||"SampleTaskPane"===ka}static Hem(){return new qf(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static qeg(ka,bb,ub,Xb,tc){if(1===ub)return 32;co.UISurfaces.Bu().then(Tc=>{Tc.showTaskPane(tc,Object.assign(new Gh.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Iq,{type:"SampleTaskPaneProps"})}));return null});return 32}$Ya(ka){this.ra.addHandler("onPaneToggle",ka)}q4c(ka){this.ra.removeHandler("onPaneToggle",
ka)}E5i(ka){this.ra.raiseEvent("onPaneToggle",ka)}get ZKd(){this.Wze||(this.Wze=L.a.instance.Na("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.Wze}}Object(f.a)(qf,"TaskPaneManager",Xo,[345]);class Aj{constructor(){this.cT=null}get name(){return"WordEditor.TaskPaneManager"}xc(){}init(){this.cT=qf.Hem();this.cT.Tb();U.App.xa.l7a=this.cT}dispose(){}}Object(f.a)(Aj,"PackageManager",null,[1,2]);c.d(K,"a",function(){return l})},1956:function(E,K,c){E=c(0);var l=c(171),f=c(720),a=c(353),
k=c(22),x=c(2),y=c(80),n=c(44),u=c(41),z=c(6),w=c(15),F=c(7),G=c(74),H=c(439),L=c(86),I=c(466),N=c(5),P=c(588),M=c(203),J=c(222),V=c(18),X=c(1096),W=c(36),U=c(81),Y=c(40),ca=c(765),aa=c(27),fa=c(76),pa=c(21),ra=c(52);class la{constructor(Ra,gb,Bb,$b){this.jId=this.hId=null;this.L8c=Ra;this.Eke=gb;this.xtj=Bb;this.ytj=$b}}Object(E.a)(la,"TableSimplificationInformation",null,[]);var qa=c(78),La=c(28),Pa=c(442),Ka=c(256),Na=c(921),sa=c(1570),wa=c(280),ja=c(3),ha=c(9),va=c(137),xa=c(17),ma=c(257),Ja=
c(32),oa=c(249),za=c(8),Fa=c(631),kb=c(560),fb=c(339);class lb extends Sys.EventArgs{constructor(Ra){super();this.Mo=Ra}}Object(E.a)(lb,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var sb=c(1766);class ab extends sb.a{constructor(Ra,gb,Bb,$b){super(Ra,gb,{});this.PSa=[];for(Ra=0;Ra<Bb.length;Ra++)this.PSa.push(...Bb.J(Ra).toArray());this.aDa=0;this.my=$b;this.Mo={}}}Object(E.a)(ab,"BasicInternalCopyArguments",sb.a,[]);class Ga extends Sys.EventArgs{constructor(Ra,gb){super();this.Mo=gb;this.PSa=
[];for(gb=0;gb<Ra.length;gb++)this.PSa.push(...Ra.J(gb).toArray())}}Object(E.a)(Ga,"BeforeCopyArguments",Sys.EventArgs,[]);class Ua extends Sys.EventArgs{constructor(Ra){super();this.Mo=Ra}}Object(E.a)(Ua,"BeforePasteArguments",Sys.EventArgs,[]);class wb extends Sys.EventArgs{constructor(Ra,gb,Bb,$b){super();this.paragraph=Ra;this.cpBegin=gb;this.cpEnd=Bb;this.Mo=$b}}Object(E.a)(wb,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var cc=c(1809),zb=c(1810);class nb{constructor(Ra,gb,Bb,$b,Qb,Ac,Db,dc,
Pb){this.Jkc=Ra;this.source=gb;this.target=Bb;this.UWf=$b;this.rowIndex=Qb;this.wo=Ac;this.KZa=Db;this.T_i=dc;this.ie=Pb}}Object(E.a)(nb,"CoreInternalTablePasteArguments",null,[]);class eb extends Sys.EventArgs{constructor(Ra,gb,Bb,$b,Qb){super();this.operation=Ra;this.DYi=gb;this.original=Bb;this.clone=$b;this.Mo=Qb}}Object(E.a)(eb,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Ib=c(103);c.d(K,"a",function(){return Xa});class Xa{constructor(Ra,gb,Bb,$b,Qb,Ac,Db,dc,Pb,Ub,rb,Yb,Ya,Ob,vc){this.GW=
this.ot=null;this.FKe=!1;this.PL=this.wAa=null;this.DXk=(Sa,Ab)=>{l.a.mark(5566);Ab=Ab.target;if(Ab.Qd())return Ab.Cg(),!0;Sa.ji(this.gLc);return!0};this.gLc=(Sa,Ab)=>{Ab=new cc.a(Ab,null);const Fb=new f.a(Sa,this.MHc,Ab);Fb.Jl("ExecuteCoreCopyToInternalClipboard");this.ZGn(Ab);Fb.run();Sa.ji(this.xMo);return!0};this.MHc=(Sa,Ab)=>{if(!Ab.source.Qd())return Ab.Di&&(Ab.Di.lDd=null),F.ULS.shipAssertTag(6305560,307,!1),this.Nh.logKpiFailure({kpiName:fb.a.KCd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Sa.ji(this.mJh);return!0};this.mJh=(Sa,Ab)=>{const Fb=Ab.insertAfter,Va=Ab.source,Wa=Ab.target,jb=Va.currentNode;var mc=this.cYi;if(!jb.pha)return Sa.ji(this.LHc),!0;Ab.Di.COb&&(Ab.COb=!0);if(!this.lVk(Ab))return Ab.Dja.cFa.c++,Sa.ji(this.LHc),!0;if(!Ab.COb&&(jb.L5b()&&Ab.Dja.cFa.c++,jb.L5b()||mc&&!jb.Rjb(this.ov)))return Sa.ji(this.LHc),!0;if(!Ab.COb&&mc&&!jb.Az)return Va.wA()&&(Ab.Xne=!0,Ab=new f.a(Sa,this.MHc,new cc.a(Ab,Fb)),Ab.Jl("RecursiveCoreCopyToInternalClipboard"),Ab.run()),Sa.ji(this.LHc),
!0;mc=Wa.currentNode.Bi().od;mc=P.a(jb,mc,!0);mc.rjb=!0;this.Yqa.pce(Ab.Dja.wFb,mc);Wa.LH(mc,Fb,18===Va.parentNode.type?1:Va.role);Wa.Fi(mc);Ab.insertAfter=mc;za.ParagraphReader.Vb(mc)&&(this.lHn(Sa,this.MHc,jb,mc,Ab),this.kHn(Sa,jb,mc));this.vWh(jb,mc);Va.wA()&&(F.ULS.shipAssertTag(6305562,307,!Ab.Xne),Ab=new f.a(Sa,this.MHc,new cc.a(Ab,null)),Ab.Jl("RecursiveCoreCopyToInternalClipboard"),Ab.run());Sa.ji((yb,Oa)=>this.j7k(yb,Oa));return!0};this.LHc=(Sa,Ab)=>{Ab.Xne&&(Ab.insertAfter=Ab.lDd,Ab.Xne=
!1);if(!Ab.source.xt()){Ab.Di&&(Ab.Di.lDd=Ab.insertAfter);const Fb=Ab.source;11!==Fb.Ve||Fb.S7b(-1)||this.PHn(Sa,Fb.currentNode,Ab.target.currentNode,Ab);return!1}Sa.ji(this.mJh);return!0};this.xMo=(Sa,Ab)=>{if(Ab.aDa>=Ab.PSa.length)return Xa.ra.raiseEvent("AfterTrimCompleteOnCopy",new lb(Ab.Mo)),Sa.ji(this.i7k),!0;Sa=Ab.PSa[Ab.aDa];var Fb=Sa.node,Va=Sa.cpBegin;let Wa=Sa.cpEnd;if(!xa.SelectionEditor.jv(Sa))if(!Ab.aDa&&xa.SelectionEditor.Gk(Sa))Wa=Va=za.ParagraphReader.textLength(Fb);else if(za.ParagraphReader.lm(Sa))Va=
0,Wa=za.ParagraphReader.textLength(Fb);else if(xa.SelectionEditor.Zba(Sa)){F.ULS.shipAssertTag(6305568,307,!Ab.aDa);var jb=N.GraphIterator.$a(Fb);Va=jb.zb(12);F.ULS.shipAssertTag(6305569,307,Va);Fb=jb.origin;Wa=Va=za.ParagraphReader.textLength(Fb)}else{if(U.OutlineReader.xZd(Sa))for(Sa=M.a.Zo(Sa.node);Sa.moveNext();)jb=Sa.currentNode,za.ParagraphReader.Vb(jb)&&Ab.PSa.push(La.a.createTextRange(jb,0,za.ParagraphReader.textLength(jb)));Ab.aDa++;return!0}jb=Ab.LXf[Fb.id.toString()];F.ULS.shipAssertTag(6305570,
307,!!jb);if(!jb)return F.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Ab.aDa,["SelectedContextsLength"]:Ab.PSa.length,["SelectedNodeType"]:Fb.type,["ContextId"]:Sa.contextId}),Ab.aDa++,!0;Fb=qa.e(jb);let mc,yb=!1;for(mc=Fb.length-1;0<=mc;mc--)if(!Fb[mc].DCa)if(4===Fb[mc].Bh)Fb[mc].Ib.blob=null,Fb[mc].Ib.blob=new Pa.a(Fb[mc].Ib),Ab.Dja.cFa.e++;else{Fb[mc].Ib.blob=null;if(-1!==Fb[mc].pe){var Oa=Fb[mc].Ib.formatting,Gb=void 0,Wb=void 0;Oa&&-1===Oa.pe?(Wb=Fb[mc].pe+
1,Gb=Fb[mc].z4-1,Oa.pe=Fb[mc].pe):(Gb=Fb[mc].z4,Wb=Fb[mc].pe);for(Oa=0;Oa<Gb;Oa++)jb.xe.removeAt(Wb,16);0<Gb&&(yb=!0)}Gb="";wa.f(Fb[mc])?(Gb=" ",Ab.Dja.cFa.f++):wa.g(Fb[mc])&&(Wb=wa.b(Fb[mc]))&&(Gb=wa.a(Wb),Ab.Dja.cFa.g++);Wb=Fb[mc].Ib.cp;Wb>=Va&&Wb<Wa&&(Xa.characterPropertiesEditor.replaceTextRange(La.a.createTextRange(jb,Wb,Wb+1),Gb,void 0,void 0,void 0,void 0,!0),Wa=Wa-1+Gb.length,Ab.Dja.cFa.i++)}yb&&jb.Xl();this.SZn(jb);Xa.ra.raiseEvent("BeforeTrimOnCopy",new wb(jb,Va,Wa,Ab.Mo));Fb=za.ParagraphReader.textLength(jb);
Wa<Fb&&Xa.characterPropertiesEditor.replaceTextRange(La.a.createTextRange(jb,Wa,Fb),"",void 0,void 0,void 0,void 0,!0);0<Va&&Xa.characterPropertiesEditor.replaceTextRange(La.a.createTextRange(jb,0,Va),"",void 0,void 0,void 0,void 0,!0);this.clm(jb,Ab.Dja.cFa);za.ParagraphReader.textLength(jb)||Ab.aDa!==Ab.PSa.length-1||!xa.SelectionEditor.jv(Sa)||jb.Us||(Sa=N.GraphIterator.$a(jb),Sa.zb(25)&&(W.OutlineElementNavigator.Vd(Sa),this.nh.Q_a(Sa),Ab.aDa&&(this.ot.kb.iva=!0)));Ab.aDa!=Ab.PSa.length-1||this.iva||
jb.Eg(u.a.S4,u.a.Ica,u.a.wpa,u.a.Jxa,u.a.p9);this.Yqa.v3c(Ab.Dja.r9d,Ab.Dja.wAb,Ab.Dja.Sdb,jb);Ab.aDa++;return!0};this.i7k=(Sa,Ab)=>{this.pja.cRb(null);Ab.my.dispose();l.a.mark(5567);this.Fgn();this.GW=Ab.Dja;this.GIi("Copy");this.sGm&&F.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.CAn=(Sa,Ab)=>{if(Ab.Jkc){if(Ab.Jkc.inProgress)return!0;aa.TableCellReader.isTableCell(Ab.source)||Ab.source.jd(16);if(this.hen(Ab))return!1}else Ja.TableReader.isTable(Ab.target)||Ab.target.jd(14),
Ja.TableReader.isTable(Ab.source)||Ab.source.jd(14),pa.moveToCell(Ab.target,Ab.rowIndex,Ab.wo),pa.moveToCell(Ab.source,0,0);if(aa.TableCellReader.hg(Ab.source)||aa.TableCellReader.hg(Ab.target))return!0;this.pAn(Ab,Sa);return!0};this.NHc=(Sa,Ab)=>{if(!Ab.source.Qd())return Sa.ji(this.Omb),!0;Sa.ji(this.oJh);return!0};this.oJh=(Sa,Ab)=>{const Fb=Ab.source,Va=Ab.target,Wa=Fb.currentNode;if(!Wa.pha||!Wa.bNa||this.bto(Fb,Va))return Sa.ji(this.t$e),!0;if(L.a.instance.J(1)&&Y.OutlineElementReader.Dh(Fb)){if(!W.OutlineElementNavigator.Ge(Fb).bNa)return W.OutlineElementNavigator.Vd(Fb),
Sa.ji(this.t$e),!0;W.OutlineElementNavigator.Vd(Fb)}F.ULS.shipAssertTag(6305608,307,!Wa.L5b());var jb=Va.currentNode.Bi().od;jb=P.a(Wa,jb,!0);jb.uRa();jb.aVc=!0;this.c3n(Fb,Va);Va.LH(jb,Ab.insertAfter,Fb.role);Va.Fi(jb);Ab.insertAfter=jb;ha.App.qd.Qo&&ha.App.qd.Qp.QF(jb);this.vWh(Wa,jb);Ab=new f.a(Sa,this.NHc,new zb.a(Fb,Va,null,Ab.UWf,Ab.Mo));Ab.Jl("RecursiveCorePasteOperation");Ab.run();Sa.ji(this.m7k);return!0};this.m7k=(Sa,Ab)=>{const Fb=Ab.target,Va=Fb.currentNode,Wa=Ab.source,jb=Wa.currentNode;
let mc=-1;Ab.Mo[Xa.Nyf]&&(mc=Ab.Mo[Xa.Nyf]);za.ParagraphReader.Vb(Va)&&(this.aIn(Sa,this.NHc,jb,Va,Ab),this.XHn(Sa,jb,Va));Va.s0();Ab.Mo[X.a.zsi]?22===Va.type&&(aa.TableCellReader.Z_(Wa)||Va.setValue(z.a.listID,Number.MAX_VALUE)):this.qK.m2n(Va);if(za.ParagraphReader.Vb(Va)&&(Ab=qa.i(Va,5),0<Ab.length)){for(const yb of Ab)!yb.properties.hasProperty(z.a.kLb)&&yb.properties.hasProperty(z.a.U9d)&&(Ab=yb.properties.getValue(z.a.U9d),yb.properties.setValue(z.a.kLb,Ab)),V.ImageReader.N$b()?V.ImageReader.cIb(yb.properties)&&
this.Oj.Z8f(yb.properties,mc):V.ImageReader.qy(yb.properties)||this.Oj.Z8f(yb.properties,mc);Va.Bi().contentReplicator.forceOutbound(null,null,null)}this.uWh(Fb);this.aYo(jb,Va);Ja.TableReader.CU(Va)&&F.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.BU&&aa.TableCellReader.Moa(Fb)&&sa.a.jgj(Va);Fb.sc();Sa.ji(this.t$e);return!0};this.t$e=(Sa,Ab)=>{if(!Ab.source.xt())return Sa.ji(this.Omb),!0;Sa.ji(this.oJh);return!0};this.Omb=()=>{l.a.mark(5565);return!1};this.gXb=Ac;this.Xo=Db;this.Oj=Ra;this.STe=
gb;this.tK=Bb;this.nh=$b;this.qK=Qb;this.Ma=dc;this.Gc=Ub;this.uxd=Pb.create(2097162);this.N3f(this.uxd);this.Rye=Pb.create(2097162);this.N3f(this.Rye);this.NWe=Pb.create(2097162);this.N3f(this.NWe);this.cwd=this.uxd;this.hZ=rb;this.O2=Yb;this.Sd=Ya;this.Nh=a.a.getInstance(fb.a.FZa);this.NAc=Ob;this.Zhk=Ob.substr(0,3);this.w6=vc}get paragraphEditor(){return null!=this.$Eg?this.$Eg:this.$Eg=k.a.instance.resolve("Box4.IParagraphEditor")}get Xb(){return null!=this.Tyg?this.Tyg:this.Tyg=k.a.instance.Na("Box4.IFeatureHelper")}get ov(){return this.ot?
this.ot.ov:0}get QAb(){return this.ot.kb.QAb}get iva(){return this.ot.kb.iva}get pja(){return this.cwd}get hyj(){return this.NWe}get v9e(){return this.ot.vJ&&!this.FKe}Dnj(){this.FKe=!0}get cYi(){return!this.ot.vJ}get Yqa(){return Fa.a.instance}N3f(Ra){var gb=new Na.a(-1);this.gXb.zl.JMa(gb);const Bb=new N.GraphIterator;Bb.set(gb);x.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");gb=3;this.Ma&&this.Ma.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&
(gb=0);gb=this.Gc.Oc(gb);gb.ku(Bb);Bb.Jf(Ra,80);gb.dispose()}XFd(Ra,gb=null){Ra=Ra.lb;this.ot=Ra.gb.clone();this.FKe=!1;Ra=N.GraphIterator.$a(Ra.h1);const Bb=N.GraphIterator.$a(this.pja),$b=this.Gc.Oc(3,ja.a.internalCopy);$b.ku(Bb);Ra.Sb(82);do Ra.currentNode.cRb(null);while(Ra.xi(82));Ra=new f.a(gb,this.DXk,new ab(Ra,Bb,this.ot,$b));Ra.Jl("InternalCopy");Ra.Jh=!gb||gb.Jh;Ra.run()}j7k(Ra,gb){var Bb=gb.source;const $b=gb.target;var Qb=$b.currentNode,Ac=Bb.currentNode;za.ParagraphReader.sh($b)&&(gb.LXf[Ac.id.toString()]=
Qb);if(za.ParagraphReader.Vb(Qb)){if(0<za.ParagraphReader.Qgi(Ac))if(0<this.Xo.vG(Ac).Lt)Ac.setValue(z.a.LRa,0);else{const Db=this.Xo.R3(Ac).Lt;this.paragraphEditor.gq.dda(Qb,Db)}if(!this.zTc&&this.w6.U_i){Bb.sc();if(!Ja.TableReader.ex($b)&&Bb.vFa&&!this.iva)for(const Db of this.w6.NXf)Qb.removeProperty(Db);Bb.Fi(Ac)}}if(za.ParagraphReader.Vb(Qb)){for(Ac=0;Ac<Qb.xe.length;Ac++)Qb.xe.jq.Z(Ac,oa.CharacterPropertiesEditor.LM),Qb.xe.$s.Z(Ac,oa.CharacterPropertiesEditor.tR);F.ULS.shipAssertTag(6305565,
307,!!ha.App.qd);(this.Sd.rg||L.a.instance.J(1)&&ha.App.Bv.jQb)&&Qb.setValue(z.a.hQa,!0);Qb.Eg(z.a.YCb,z.a.WZi,z.a.EXf);L.a.instance.J(1)&&za.ParagraphReader.Vb(Qb)&&Qb.Eg(z.a.Mwa)}this.cYi&&(this.uWh($b),Ja.TableReader.isTable($b)&&(Qb=this.ot.oO(),Qb.moveNext(),(Qb=aa.TableCellReader.$Da(Bb,Qb.current.node))||(Qb=new ca.a(0,0)),Bb=new la(Qb,$b,Ja.TableReader.yga(Bb),Ja.TableReader.ttf(Bb)),this.STe.value.k5n(Bb)));Y.OutlineElementReader.Dh($b)&&!$b.Nr(2)&&(this.nh.YI($b),$b.sc());$b.sc();gb.Di&&
(gb.Di.lDd=gb.insertAfter);Ra.ji(this.LHc);return!0}lVk(Ra){const gb=Ra.source;if(Y.OutlineElementReader.Dh(gb)&&gb.kib(12)){const Bb=gb.Qd();if(za.ParagraphReader.Vb(Bb)&&Bb.ia(z.a.jN,null))return gb.sc(),Ra.COb=!1;gb.sc()}else if(za.ParagraphReader.Vb(gb.Nn)&&gb.Nn.ia(z.a.jN,null))return!1;return!0}kHn(Ra,gb,Bb){gb=qa.e(gb);Bb=qa.e(Bb);for(let $b=0;$b<gb.length;$b++)gb[$b].GSf(Bb[$b],Ra,this.MHc)}SZn(Ra){if(Ra=Ra.pa){var gb=new G.a;for(let Bb=0;Bb<Ra.length;Bb++){const $b=Ra.J(Bb);$b.uj&&gb.add($b)}for(const Bb of gb)Bb.uj=
null}}get sGm(){return!N.GraphIterator.$a(this.pja).Qd()}aIj(){this.cwd=this.NWe}$Hj(){this.cwd=this.uxd}AZo(){this.cwd=this.Rye}get BTm(){return this.pja===this.uxd}get FIm(){return this.pja===this.Rye}KDh(){const Ra=N.GraphIterator.$a(this.pja);for(;Ra.Qd();)Ra.Cg()}GIi(Ra){const gb=this.GW.cFa.b;Ra+="-"+gb;this.GW.cFa.b=Ra;this.GW.wFb.b=Ra;this.GW.r9d.b=Ra;this.GW.wAb.b=Ra;this.GW.Sdb.b=Ra;this.Yqa.h3m(this.GW.cFa);this.Yqa.mKf(this.GW.wFb);this.Yqa.JJi(this.GW.r9d);this.Yqa.aKf(this.GW.wAb);this.Yqa.XJf(this.GW.Sdb);
this.GW.cFa.b=gb;this.GW.wFb.b=gb;this.GW.r9d.b=gb;this.GW.wAb.b=gb;this.GW.Sdb.b=gb}Q_i(Ra,gb,Bb,$b,Qb=null,Ac=null){this.GIi("Paste");gb=N.GraphIterator.$a(gb);const Db=N.GraphIterator.$a(this.pja);var dc=null;Qb&&(dc=new I.a(U.OutlineReader.khl,U.OutlineReader.Thl),dc=Qb.equals(new I.a(-1,-1))?new I.a(0,0):Qb.Yje(dc));if(this.tsi())if(Db.Qd(),V.ImageReader.Eu(Db.currentNode))Qb=Db.currentNode,Db.sc(),Db.LH(this.nh.ffb(),null,1),Db.Qd(),Db.LH(Qb,null,2),Db.sc(),Db.Fi(Qb),Db.Cg(),this.Dnj();else if(J.isFloatingEmbeddedFileNode(Db.currentNode)){Qb=
Db.currentNode;Db.sc();Db.LH(this.nh.ffb(),null,1);Db.Qd();var Pb=this.nh.YI(Db);Pb=La.a.Rc(Pb,0);Xa.characterPropertiesEditor.replaceTextRange(Pb,"<<"+J.getEmbeddedFileName(Qb)+">>",void 0,void 0,void 0,void 0,!0);Db.sc();Db.sc();Db.Fi(Qb);Db.Cg();this.Dnj()}this.hZ&&this.hZ.VEf(Bb)||!this.lCi(Db,gb)?(l.a.mark(5564),Db.currentNode.cRb(null),Ra={},Ra[Xa.Nyf]=$b,Ib.ListItemReader.Ig(Bb)&&(Ra[X.a.zsi]=!0),Bb=new zb.a(Db,gb,Bb,dc,Ra),$b=new f.a(Ac,this.NHc,Bb),$b.Jl("ExecuteCorePasteFromInternalClipboard"),
$b.Jh=!Ac||Ac.Jh,this.$Gn(Bb),$b.run()):(Db.currentNode.cRb(null),F.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.R2n(Ac,Db,gb,dc,Ra),F.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}IBi(Ra){if(Ra&&Ra.isValid){const gb=N.GraphIterator.$a(this.pja);return this.lCi(gb,Ra)}return!1}lCi(Ra,gb){if(aa.TableCellReader.Moa(gb)&&1===Ra.xq()){Ra.Sb(1);if(Y.OutlineElementReader.Dh(Ra)){W.OutlineElementNavigator.Ge(Ra);if(Ja.TableReader.isTable(Ra)){Ja.TableReader.BB(Ra.currentNode)&&
F.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(gb.zb(14)&&!Ja.TableReader.BB(pa.getContainingTable(gb))){if(F.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.BU)return!0}else if(F.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.zTc&&!this.BU)return!0;if(this.BU)return!0}W.OutlineElementNavigator.Vd(Ra)}Ra.sc()}return!1}R2n(Ra,gb,Bb,$b,Qb){let Ac,Db;let dc;Object(n.a)("ReplaceTableCellsFromClipboardTable",!0);Bb.zb(14);
Ac=ra.a.xs(Bb);Db=fa.a(Bb);Bb.jd(14);var Pb=Ja.TableReader.fg(Bb.currentNode);dc=Ja.TableReader.Yg(Bb.currentNode);const Ub=Ja.TableReader.fg(gb.currentNode),rb=Ja.TableReader.Yg(gb.currentNode);F.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",Pb,dc,Ub,rb,Ac,Db);if(this.BU&&ma.TableBorderSelectionCache.QPc())this.Smo(),Pb=Math.min(this.Oke+1,Pb),dc=Math.min(this.Thg+1,dc),this.Thg-this.pGo==dc-1&&(this.sxj==
this.Oke?Db=0:this.Oke-this.sxj==Pb-1&&(Bb.Qd(),Ac=ra.a.xs(Bb),Db=fa.a(Bb)));else{this.wAa=kb.a.P7b;const Yb=Ac+Ub-Pb;0<Yb&&(pa.moveToLastRow(Bb),F.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+Yb),this.STe.value.insertRows(Bb,!1,Yb,this.wAa),F.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Bb.jd(14));const Ya=Db+rb-dc;if(0<Ya){F.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Ya);try{this.STe.value.insertColumns(Bb,dc,!1,Ya,this.wAa)}catch(Ob){throw F.ULS.sendTraceTag(19269661,
307,10,"Insert columns failed: {0}",Ob.toString()),Ob;}F.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<Yb||0<Ya)&&Object(n.a)("InsertRowsAndColumnsForInternalCCP",!0)}Pb=this.MOl(Pb,dc,Ub,rb,Ac,Db);F.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Ra=new f.a(Ra,this.CAn,new nb(null,gb,Bb,$b,Ac,Db,Pb,null,Qb));Ra.Jl("ExecuteCorePasteTableInTable");Ra.Jh=!1;Ra.run()}Fgn(){if(this.zTc){for(var Ra=N.GraphIterator.$a(this.pja),gb=Ra.currentNode;14!==Ra.Ve;)if(gb=Ra.Qd(),
!gb){F.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.JQi(gb)}}Jgn(Ra){this.zTc&&this.JQi(Ra)}dJo(Ra){const gb=N.GraphIterator.$a(Ra);this.tK.Wib(gb,null,!0);Ra.hg=!1;Ra.rowSpan=1;Ra.colSpan=1}JQi(Ra){if(Ra&&14===Ra.type){F.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var gb={},Bb=Ja.TableReader.fg(Ra),$b=Ja.TableReader.Yg(Ra),Qb=N.GraphIterator.$a(Ra);pa.forEachCellInTable(Qb,(Ac,Db,
dc)=>{const Pb={};Ac=Ac.currentNode;if(16===Ac.type)if(Ac.hg)Xa.CGh(Db,dc)in gb||(this.dJo(Ac),Pb.IsGhostCell="->false");else{Xa.JSn(Ra,Ac,Db,dc,Bb,(rb,Yb,Ya)=>{Pb.rowSpan=String.format("{0}:{1}->{2}",rb,Yb,Ya)});Xa.ISn(Ra,Ac,dc,Db,$b,(rb,Yb,Ya)=>{Pb.colSpan=String.format("{0}:{1}->{2}",rb,Yb,Ya)});const Ub=String.format("{0},{1}-{2},{3}",Db,dc,Db+Ac.rowSpan,dc+Ac.colSpan);for(let rb=0;rb<Ac.rowSpan;rb++)for(let Yb=0;Yb<Ac.colSpan;Yb++)if(rb||Yb)gb[Xa.CGh(Db+rb,dc+Yb)]=Ub}if(0<H.a(Pb).length){if(void 0===
Pb.IsGhostCell||null===Pb.IsGhostCell){if(void 0===Pb.rowSpan||null===Pb.rowSpan)Pb.rowSpan=Ac.rowSpan;if(void 0===Pb.colSpan||null===Pb.colSpan)Pb.colSpan=Ac.colSpan}F.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",Db,dc,Pb)}return!0});Xa.srl(gb)}}clm(Ra,gb){if(Ra&&za.ParagraphReader.Vb(Ra)){var Bb=0,$b=N.GraphIterator.$a(Ra);for($b.Sb(6);!$b.Pr;){var Qb=$b.currentNode;$b.xi(6);V.ImageReader.Eu(Qb)?V.ImageReader.vFf(Qb)?N.GraphIterator.$a(Qb).kib(59)?F.ULS.sendTraceTag(590455048,
307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.qIh(Qb,La.a.Rc(Ra,Bb),!0),gb.d++,Bb++):(Qb=N.GraphIterator.$a(Qb),Qb.zb(12),Qb.Cg(),gb.h++):F.ULS.shipAssertTag(6305571,307,!1)}}}get zTc(){return!!this.Ma&&this.Ma.$("ComplexTableCellPasteWithFormattingIsEnabled")}MOl(Ra,gb,Bb,$b,Qb,Ac){const Db=[];let dc,Pb,Ub,rb;this.BU&&ma.TableBorderSelectionCache.QPc()?(dc=Math.min(Ra,Qb+Bb),Pb=Math.min(gb,Ac+$b),rb=Qb):(rb=0,dc=Math.max(Qb+Bb,Ra));
for(;rb<dc;rb++)for(this.BU&&ma.TableBorderSelectionCache.QPc()?Ub=Ac:(Ub=0,Pb=Ac+$b,rb<Qb?Ub=gb:rb>=Qb&&rb<Math.min(Qb+Bb,Ra)?Ub=Ac:rb>=Qb+Bb&&rb<Ra?Ub=gb:Pb=Math.max(Ac+$b,gb));Ub<Pb;Ub++)Db.push(Array(2)),Db[Db.length-1][0]=rb,Db[Db.length-1][1]=Ub;return Db}c3n(Ra,gb){if(this.zTc)if(!gb||!Ra)F.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Ra,["table"]:gb});else if(16===gb.currentNode.type&&16===Ra.parentNode.type){gb=gb.currentNode;Ra=Ra.parentNode;var Bb={};
gb.hg!==Ra.hg&&(gb.hg=Ra.hg,Bb.IsGhostCell=gb.hg);gb.q4!==Ra.q4&&(gb.q4=Ra.q4,Bb.IsSkippedCell=gb.q4);gb.Mob!==Ra.Mob&&(gb.Mob=Ra.Mob,Bb.ShouldRenderCell=gb.Mob);gb.colSpan!==Ra.colSpan&&(Bb.ColSpan=String.format("{0}<={1}.",gb.colSpan,Ra.colSpan),gb.colSpan=Ra.colSpan);gb.rowSpan!==Ra.rowSpan&&(Bb.RowSpan=String.format("{0}<={1}.",gb.rowSpan,Ra.rowSpan),gb.rowSpan=Ra.rowSpan);H.a(Bb)}}bto(Ra,gb){let Bb=!1;Y.OutlineElementReader.Dh(Ra)&&(Bb=Y.OutlineElementReader.wQ(Ra)&&this.MSm(gb));return Bb}MSm(Ra){if(Ra)return Ra=
Ra.Ve,36===Ra||38===Ra||16===Ra;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}XHn(Ra,gb,Bb){gb=qa.e(gb);const $b=qa.e(Bb);for(let Qb=gb.length-1;0<=Qb;Qb--){if(!gb[Qb].tjc(Bb)){const Ac=La.a.createTextRange(Bb,gb[Qb].Ib.cp,gb[Qb].Ib.cp+1);Xa.characterPropertiesEditor.replaceTextRange(Ac,"",void 0,void 0,void 0,void 0,!0)}gb[Qb].j_c($b[Qb],Ra,this.NHc,this.FIm)}}aYo(Ra,gb){if(L.a.instance.J(1)&&Ja.TableReader.CU(Ra)){let Bb=0;const $b=Ja.TableReader.fg(Ra);
for(const Qb of Ja.TableReader.Gx(Ra,0,$b-1))Qb.Nu&&Bb++;Ra=this.Gc.Oc(4);Ra.Cb(gb);gb.properties.setValue(w.a.Qya,$b-Bb);Ra.dispose()}}get BU(){null==this.PL&&(x.AFrameworkApplication.te("he991617;3eed2178"),this.PL=x.AFrameworkApplication.K?x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.PL}p5d(){return!N.GraphIterator.$a(this.pja).Qd()}tsi(){return this.v9e?1===N.GraphIterator.$a(this.pja).xq():!1}x6h(Ra){try{return this.wRl(Ra)}catch(gb){return F.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",gb.message),0}}wRl(Ra){let gb=0;if(Ra&&(gb=this.vRl(Ra),!gb&&Ra.childNodes))for(let Bb=0;Bb<Ra.childNodes.length&&!(gb=this.x6h(Ra.childNodes[Bb]));Bb++);return gb}vRl(Ra){if(1===Ra.nodeType&&Ra.getAttribute){Ra=(Ra.getAttribute("class")||"").split(" ");for(const gb of Ra)if(gb.startsWith(this.Zhk))return gb.startsWith(this.NAc)?this.ov&&gb===this.NAc+this.ov?3:2:1}return 0}lHn(Ra,gb,Bb,$b,Qb){Qb.Mo||(Qb.Mo={});Xa.ra.raiseEvent("OnParagraphCopy",
new eb(Ra,gb,Bb,$b,Qb.Mo))}PHn(Ra,gb,Bb,$b){$b.Mo||($b.Mo={});Xa.ra.raiseEvent("OnCopyComplete",new eb(Ra,null,gb,Bb,$b.Mo))}$Gn(Ra){Ra.Mo||(Ra.Mo={});Xa.ra.raiseEvent("BeforePaste",new Ua(Ra.Mo))}ZGn(Ra){Ra.Mo||(Ra.Mo={});Xa.ra.raiseEvent("BeforeCopy",new Ga(this.ot,Ra.Mo))}aIn(Ra,gb,Bb,$b,Qb){Xa.ra.raiseEvent("OnParagraphPaste",new eb(Ra,gb,Bb,$b,Qb.Mo))}uWh(Ra){aa.TableCellReader.isTableCell(Ra)&&(Ra.Sb(1)||this.tK.o7(Ra,!0),Ra.sc())}vWh(Ra,gb){this.O2.Qwa(gb)&&(gb.width=Ra.width)}static g_e(Ra){Xa.ra.addHandler("OnParagraphCopy",
Ra)}static wzd(Ra){Xa.ra.addHandler("OnParagraphPaste",Ra)}static s0n(Ra){Xa.ra.removeHandler("OnParagraphPaste",Ra)}static Pwk(Ra){Xa.ra.addHandler("OnCopyComplete",Ra)}static Vvk(Ra){Xa.ra.addHandler("BeforePaste",Ra)}static M_n(Ra){Xa.ra.removeHandler("BeforePaste",Ra)}static Tvk(Ra){Xa.ra.addHandler("BeforeCopy",Ra)}static Wvk(Ra){Xa.ra.addHandler("BeforeTrimOnCopy",Ra)}static Nvk(Ra){Xa.ra.addHandler("AfterTrimCompleteOnCopy",Ra)}static get characterPropertiesEditor(){return null!=Xa.wwg?Xa.wwg:
Xa.wwg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get XJ(){return Ka.a.instance}static get nf(){return va.PageReader.instance}static srl(Ra){const gb={};for(const Bb of H.a(Ra)){const $b=Ra[Bb];gb[$b]=$b in gb?String.format("{0}|{1}",gb[$b],Bb):Bb}1<=H.a(gb).length&&F.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",gb)}static ISn(Ra,gb,Bb,$b,Qb,Ac){gb.colSpan>Qb-Bb&&(Ac&&Ac("A",gb.colSpan,Qb-Bb),gb.colSpan=Qb-Bb);Ra=Xa.lxo(Ra,gb,$b,Bb);gb.colSpan!==Ra&&(Ac&&
Ac("B",gb.colSpan,Ra),gb.colSpan=Ra)}static JSn(Ra,gb,Bb,$b,Qb,Ac){gb.rowSpan>Qb-Bb&&(Ac&&Ac("A",gb.rowSpan,Qb-Bb),gb.rowSpan=Qb-Bb);Ra=Xa.mxo(Ra,gb,Bb,$b);gb.rowSpan!==Ra&&(Ac&&Ac("B",gb.rowSpan,Ra),gb.rowSpan=Ra)}static lxo(Ra,gb,Bb,$b){return Xa.vsj(Ra,gb.colSpan,(Qb,Ac)=>{pa.moveToCell(Qb,Bb,$b+Ac)})}static mxo(Ra,gb,Bb,$b){return Xa.vsj(Ra,gb.rowSpan,(Qb,Ac)=>{pa.moveToCell(Qb,Bb+Ac,$b)})}static vsj(Ra,gb,Bb){if(14!==Ra.type)throw Error.argument("tableNode is not a Table.");if(!Bb)throw Error.argumentNull("MoveToCellAction");
for(let Qb=1;Qb<gb;Qb++){var $b=N.GraphIterator.$a(Ra);Bb($b,Qb);$b=$b.currentNode;if(!$b||16!==$b.type||!$b.hg)return Qb}return gb}static CGh(Ra,gb){return Ra+","+gb}pAn(Ra,gb){for(;Ra.target.Qd();)Ra.target.Cg();Ra.Jkc=new f.a(gb,Ra.T_i?Ra.T_i:this.NHc,new zb.a(Ra.source,Ra.target,null,Ra.UWf));Ra.Jkc.Jl("ExecuteCorePasteCellContentInCell");Ra.Jkc.Jh=!1;Ra.Jkc.run()}hen(Ra){let gb=!1;if(this.BU&&ma.TableBorderSelectionCache.QPc()){const Bb=fa.a(Ra.target),$b=ra.a.xs(Ra.target);let Qb=this.Oke;isNullOrUndefined(Ra.KZa[Ra.KZa.length-
1])||(Qb=Math.min(Qb,Ra.KZa[Ra.KZa.length-1][0]));let Ac=this.Thg;isNullOrUndefined(Ra.KZa[Ra.KZa.length-1])||(Ac=Math.min(Ac,Ra.KZa[Ra.KZa.length-1][1]));aa.TableCellReader.eQa(Ra.target)||aa.TableCellReader.eQa(Ra.source)||$b==Qb&&Bb==Ac?gb=!0:(aa.TableCellReader.isTableCell(Ra.target)||Ra.target.jd(16),aa.TableCellReader.dca(Ra.source)?(aa.TableCellReader.eQa(Ra.target)||(pa.moveToNextRow(Ra.target),pa.moveToColumnByIndex(Ra.target,Ra.wo),F.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),
pa.moveToNextOrPreviousCell(Ra.source,!1,!1)):aa.TableCellReader.dca(Ra.target)||Bb==Ac?(pa.moveToNextRow(Ra.source),pa.moveToColumnByIndex(Ra.source,0),F.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),pa.moveToNextRow(Ra.target),pa.moveToColumnByIndex(Ra.target,Ra.wo),F.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(pa.moveToNextOrPreviousCell(Ra.target,!1,!1),pa.moveToNextOrPreviousCell(Ra.source,!1,!1)))}else aa.TableCellReader.eQa(Ra.source)?
gb=!0:(aa.TableCellReader.isTableCell(Ra.target)||Ra.target.jd(16),aa.TableCellReader.dca(Ra.source)?(pa.moveToNextRow(Ra.target),pa.moveToColumnByIndex(Ra.target,Ra.wo),F.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):pa.moveToNextOrPreviousCell(Ra.target,!1,!1),pa.moveToNextOrPreviousCell(Ra.source,!1,!1));gb&&(this.hZ&&this.hZ.ZHn(Ra.target,Ra.KZa),Ja.TableReader.isTable(Ra.target)||Ra.target.jd(14),this.Jgn(Ra.target.currentNode),F.ULS.sendTraceTag(7869377,307,
50,"End of internal paste table in table"));return gb}Smo(){this.Oke=ma.TableBorderSelectionCache.I9.bottomMostRowSelected;this.Thg=ma.TableBorderSelectionCache.I9.rightMostColumnSelected;this.pGo=ma.TableBorderSelectionCache.I9.leftMostColumnSelected;this.sxj=ma.TableBorderSelectionCache.I9.topMostRowSelected}}Xa.ra=new y.a;Xa.Nyf="PasteConstrainingWidth";Object(E.a)(Xa,"InternalClipboard",null,[])},1966:function(E,K,c){E=c(0);var l=c(2),f=c(126),a=c(58),k=c(239),x=c(22),y=c(19),n=c(83),u=c(177),
z=c(15),w=c(42),F=c(6),G=c(7),H=c(73),L=c(44),I=c(31),N=c(304),P=c(86),M=c(12),J=c(5),V=c(101),X=c(18),W=c(36),U=c(245),Y=c(40),ca=c(247),aa=c(21),fa=c(78),pa=c(148),ra=c(875),la=c(3),qa=c(84),La=c(60),Pa=c(9),Ka=c(92),Na=c(43),sa=c(474),wa=c(589),ja=c(212),ha=c(17),va=c(23),xa=c(46),ma=c(32),Ja=c(235),oa=c(8),za=c(1555),Fa=c(1574),kb=c(293),fb=c(171),lb=c(65),sb=c(503),ab=c(48);class Ga extends kb.a{constructor(eb,Ib,Xa,Ra,gb,Bb,$b,Qb){super();this.neh=this.Mw=null;this.init(eb);this.Jl("FormattingViewOperation");
this.Qib(l.AFrameworkApplication.va,Ib,Ra,gb,Bb);this._context=Xa;this.I8a=0;this.Hs=!0;this.A2j=$b;this.Tm=Qb}get qba(){return this.Tm.instance}run(){const eb=this._context.view;var Ib=null;eb.qe&&(Ib=eb.lb);if(Ib){var Xa=Ib.gb.kb,Ra=!Fa.a.R$b(this.actionId);!Xa||Ga.Xf.MFf(Xa,Ra)?(Ga.Ic.Yb(qa.a.kf,{["Reason"]:La.a.RE}),this.Hs=!1):this.qba&&this.qba.hac(Xa)?(Ga.Ic.Yb(qa.a.kf,{["Reason"]:La.a.externalSelection}),this.Hs=!1):Ga.Wg.qza(oa.ParagraphReader.oU,Ib.tg)&&(Ga.Ic.Yb(qa.a.kf,{["Reason"]:La.a.hO}),
this.Hs=!1)}else Ga.Ic.Yb(qa.a.kf,{["Reason"]:La.a.zca}),this.Hs=!1;1!==this.behavior&&this.Hs||(this.Hs&&(Xa=Ib.gb.kb,1===Ib.gb.length&&1===Xa.length&&ha.SelectionEditor.ml(Xa.Oa)&&fa.b(Xa.Oa)&&(Ga.Ic.Yb(qa.a.kf,{["Reason"]:La.a.nHc}),this.Hs=!1)),(Xa=this.Hs)&&this.actionId===la.a.g5&&((Xa=Array.from(Ib.gb.kb).some(V.FormattingReader.o9e))||Ga.Ic.Yb(qa.a.kf,{["Reason"]:La.a.Mff})),this.mr=Xa?32:8,this.I8a=3);this.I8a||(fb.a.mark(5730),this.neh=sb.SelectionReferenceFactory.instance.rBb(),Xa=Ib.gb.kb.Oa,
this.Mw=new Na.GraphTransaction(15),this.Mw.Cb(Xa.node),this.Mw.fk=this.actionId,this.I8a=1);if(1===this.I8a){this.uC||this.G6c(this._context.$j);if(1===this.g5a())return;this.I8a=2}if(2===this.I8a){if(this.actionId===la.a.g5)if(Ib=Ib.tg,Ib.$w)for(Xa=0;Xa<Ib.length;Xa++)Ra=Ib.getContext(Xa),this.xCj(Ra);else this.xCj(Ib);ab.a.C9e&&this.MMo(this.actionId,this.xd);this.neh.Xpa(this.actionId===la.a.HY||this.actionId===la.a.bua);(Ib=Object(H.a)(28,this.xd))&&!Ib.gTa||lb.FocusManager.instance().mg(eb.gJ);
this.Mw.dispose();this.Mw=null;Pa.App.xa.updateCommandUI();fb.a.mark(5731);this.I8a=3;this.mr=32}3===this.I8a&&(this.A2j.process(this.actionId,this._context,this.behavior,this.response),this.mqa())}MMo(eb,Ib){const Xa={};Xa.FormattingActionId=eb;Xa.FormattingActionData=Ib;8===this.ga.Qb(la.a.yAd,2,Xa)&&G.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",eb,Ib)}xCj(eb){(ha.SelectionEditor.jv(eb)||ha.SelectionEditor.Gk(eb))&&Pa.App.gN.nda(eb.node)}static get Xf(){return Ja.a.instance}static get Wg(){return ja.ContextSetEditor.instance}static get Ic(){return u.a.instance}}
Object(E.a)(Ga,"FormattingViewOperation",kb.a,[]);var Ua=c(1031),wb=c(941),cc=c(68);c.d(K,"a",function(){return nb});const zb=new Set([la.a.G_,la.a.U0,la.a.clearFormatting,la.a.HCa,la.a.ICa,la.a.HZa,la.a.$ta,la.a.IZa]);class nb{constructor(eb,Ib,Xa=null,Ra,gb,Bb,$b,Qb,Ac,Db,dc,Pb,Ub){this.kpiName="ChangeCaseCommandUsage";this.f8="wwaengidc";this.vkb=new Map;this.j5g=new Set;this.yDb=()=>new ra.a(2);this.u4i=(rb,Yb,Ya,Ob,vc)=>{Ob=!0;Yb.contextId!==M.a.view&&(Ob=!1);if(1===Ya&&!Ob)return 8;if(rb===
la.a.v2c)rb=vc.formatting,vc=vc.Weg;else{if(!Yb.view||!Yb.view.qe)return 2;Yb=Yb.view;if(!Yb.lb||!Yb.lb.gb.kb)return 8;rb=vc;vc=Yb.lb.gb}this.y2k(vc,rb);return 32};this.T0e=(rb,Yb,Ya,Ob,vc,Sa)=>new Ga(rb,Yb,Ya,Ob,vc,Sa,this.g3j,nb.Zw());this.vAd=(rb,Yb,Ya,Ob,vc)=>{var Sa,Ab,Fb;let Va=!0,Wa=Yb;const jb=!Fa.a.R$b(rb);Yb.contextId!==M.a.Hd&&Yb.contextId!==M.a.Tc?Va=!1:(nb.Xf.I8(Wa,!1,jb)&&(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.RE}),Va=!1),nb.Zw()&&nb.Zw().instance&&nb.Zw().instance.tU(Wa)&&(Va=!1),Va&&ha.SelectionEditor.ml(Yb)&&
fa.b(Wa)&&(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.nHc}),Va=!1),oa.ParagraphReader.oU(Yb)&&(nb.Ic.Yb(qa.a.kf,{["Reason"]:La.a.hO}),Va=!1));if(1===Ya||!Va)return Va?32:8;if(Yb.contextId===M.a.Tc)return 2;(Yb=null===(Sa=this.Do)||void 0===Sa?void 0:Sa.bRd(Wa))&&(Wa=Yb);this.sto(rb)&&(Sa=ha.SelectionEditor.nQb(Wa),ha.SelectionEditor.gf(Sa)||(Wa=Sa));Sa="boolean"===typeof vc&&vc;Yb=!1;(null===(Ab=this.J$)||void 0===Ab?0:Ab.annotateRange)&&(null===(Fb=this.J$)||void 0===Fb?0:Fb.ebc(Wa.node))&&(Yb=this.XZ(Wa,
rb,vc,Sa));Yb&&rb!==la.a.g5||nb.Lqa.XZ(Wa,mc=>{this.Gic(mc,rb,vc,Wa.cpEnd)},Sa);Wa.node.ur&&(Ab=[Object.assign(new I.a,{name:"Source",string:"CharacterFormatting"})],L.a("TOCFormatting",!0,void 0,Ab));this.fGm(rb)&&this.SCd(Wa,rb);Ob&&za.a.Epb&&(Ob.ns|=za.a.khb(Wa.node));return 32};this.q$c=(rb,Yb,Ya)=>1!==Ya&&2===Ya?(this.vkb.set("Source","Shortcut"),rb=Yb.node.characterData.substr(Yb.cpBegin,Yb.cpEnd-Yb.cpBegin),nb.gGf(rb,0,rb.length)?this.SCd(Yb,la.a.HCa):nb.ZRm(rb,rb.length)?this.SCd(Yb,la.a.$ta):
this.SCd(Yb,la.a.ICa)):32;this.veb=(rb,Yb,Ya)=>{let Ob=!0;rb=!Fa.a.R$b(rb);Yb.contextId!==M.a.Hd&&Yb.contextId!==M.a.Tc?Ob=!1:(nb.Xf.I8(Yb,!1,rb)&&(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.RE}),Ob=!1),Ob&&ha.SelectionEditor.ml(Yb)&&fa.b(Yb)&&(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.nHc}),Ob=!1),Ob&&oa.ParagraphReader.oU(Yb)&&(nb.Ic.Yb(qa.a.kf,{["Reason"]:La.a.hO}),Ob=!1));if(1===Ya||!Ob)return Ob?32:8;Yb=Yb.node;this.Ks.C2b(Yb,!1);Yb.ur&&(Yb=[Object.assign(new I.a,{name:"Source",string:"ClearFormatting"})],L.a("TOCFormatting",
!0,void 0,Yb));return 32};this.mGc=(rb,Yb,Ya,Ob,vc)=>{rb={};rb[Ua.a.QIa]=6168;rb[Ua.a.PIa]=6169;const Sa=Yb.view;var Ab=null;Sa.Vi&&(Ab=Sa);var Fb=!0;let Va=32;Ab&&(Ab=Ab.lb.gb.kb)&&(nb.Xf.MFf(Ab)?(nb.Ic.Yb(qa.a.kf,{["Reason"]:La.a.RE}),Va=8,Fb=!1):1===Ya&&(Va=32,Fb=!1));Fb&&(Fb=new Na.GraphTransaction(1===Ya?3:15),Fb.Cb(Sa.root),Va=Ua.a.Bpa(la.a.veb,Yb,Ya,Ob,vc,rb,12),Fb.dispose());return Va};this.b1e=(rb,Yb,Ya,Ob,vc)=>{var Sa,Ab=!0,Fb=32;const Va=!Fa.a.R$b(rb);Yb.contextId!==M.a.Tc?Ab=!1:nb.Xf.I8(Yb,
!1,Va)&&(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.RE}),Ab=!1);if(1===Ya||!Ab)return Ab?32:8;Ya=Yb.node;rb===la.a.clearFormatting&&(nb.Un.nGc(Ya),this.Ks.bEh(Ya),Ab=this.Uy.MC(Ya).Pi(this.Uy.wordStyleIdNormal),this.Ru.PJ(Ab,Ya,!0));Ya=nb.rj.Itf(Yb);!Ya&&(Ab=null===(Sa=this.Do)||void 0===Sa?void 0:Sa.bRd(Yb))&&(Yb=Ab,Ya=va.SelectionFactory.io(Yb));if(Ya)Fb=xa.a.mBb(Ya),Fb=l.AFrameworkApplication.va.Of(Fb,rb,2,!1,Ob,vc);else{Ob=Object(H.a)(28,vc);Sa=V.FormattingReader.Kr(Yb);if(!Sa)return 16;Sa=Sa.cache;switch(rb){case la.a.font:nb.a0h();
if(Ob&&Ob.xd){const {fontName:Wa,Ada:jb,bold:mc,italic:yb}=nb.Ypf(Ob.xd);nb.rj.gge(Wa);nb.rj.Dbg(jb);Object(sa.a)()&&(rb=1==mc,vc=1==yb,rb||vc)&&(nb.rj.qL(rb),nb.rj.setItalic(vc))}break;case la.a.Sv:G.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");nb.rj.Sv(vc);break;case la.a.lqa:nb.rj.Sv(vc);this.recentColors.UYa(vc)||G.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.Cfa:nb.rj.Cfa();break;case la.a.HY:G.ULS.sendTraceTag(594899722,
340,50,"Font background color is selected from Standard colors.");nb.rj.Bya(vc);break;case la.a.N9:nb.rj.Bya(vc);this.recentColors.UYa(vc)||G.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.bua:nb.rj.zDd();break;case la.a.RA:nb.a0h();nb.rj.RA(Ob.xd);break;case la.a.G_:rb=nb.rj.xG(z.a.fontSize,Sa.fontSize);nb.rj.RA(this.Be.G_(rb));break;case la.a.U0:rb=nb.rj.xG(z.a.fontSize,Sa.fontSize);nb.rj.RA(this.Be.U0(rb));break;case la.a.bold:rb=
nb.rj.xG(z.a.bold,Sa.isBold);nb.rj.qL(!rb);break;case la.a.setItalic:rb=nb.rj.xG(z.a.italic,Sa.isItalic);nb.rj.setItalic(!rb);break;case la.a.underline:rb=nb.rj.xG(z.a.underline,Sa.isUnderline);nb.rj.j5(!rb);break;case la.a.Zia:nb.rj.Zia(vc);break;case la.a.superscript:rb=nb.rj.xG(z.a.superscript,Sa.isSuperscript);nb.rj.oqa(!rb);break;case la.a.subscript:rb=nb.rj.xG(z.a.subscript,Sa.isSubscript);nb.rj.zHa(!rb);break;case la.a.strikethrough:rb=nb.rj.xG(z.a.strikethrough,Sa.isStrikethrough);nb.rj.Wia(!rb);
break;case la.a.wt:rb=nb.rj.xG(w.a.wt,Sa.isDoubleStrikethrough);nb.rj.age(!rb);break;case la.a.clearFormatting:nb.rj.N5a();break;case la.a.g5:vc.hasProperty(z.a.eL)&&nb.rj.g5(vc.getValue(z.a.eL));vc.hasProperty(F.a.noProof)&&(rb=vc.getValue(F.a.noProof),nb.rj.Ujo(rb));break;default:this.j5g.has(rb)||(this.j5g.add(rb),(vc=f.ActionManager.Baa(rb))&&vc.length||(vc="UnknownAction"),G.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${vc} (${rb})`))}}Pa.App.xa.updateCommandUI();
return Fb};this.kT=(rb,Yb,Ya,Ob,vc)=>{Ob=nb.Ic.Ap(la.a.Qgo);var Sa=!0;Yb.contextId!==M.a.endOfParagraph&&(Sa=!1);if(1===Ya||!Sa)return Sa?32:8;Ya=Yb.node;Sa=J.GraphIterator.$a(Yb.node);Sa.vd();Sa=Sa.Tga(4);if((Sa=!!Sa&&nb.Gd.eca(Sa))&&!Pa.App.Icc)return 8;var Ab=!oa.ParagraphReader.textLength(Ya);Ob.properties.Z("Action",rb.toString());Ob.properties.Z("ListContext",Sa.toString());Ob.properties.Z("IsEmptyParagraph",Ab.toString());G.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
rb,Sa,Ab);Sa=Ya.pa.last;this.a_n(Ya,rb);var Fb=!!Sa.formatting;const Va=Ya.getValue(F.a.endOfParagraphFormatting);Ab=this.Kd.f0a(Ya);Fb=!Fb&&Va&&Va.equals(a.a.nil)?new pa.a(Sa,a.a.nil):Ab.Ef(Ab.Ib);this.Gic(Ab,rb,vc,Sa.cp);P.a.instance.J(1)&&nb.lj.XNb(Ya,Sa,Yb.cpBegin,Yb.cpEnd,Fb,Ab,nb.Ld.rg);Ob.end();return 32};this.Ula=(rb,Yb,Ya)=>{rb=!0;const Ob=J.GraphIterator.$a(Yb.node);Ob.vd();Yb.contextId===M.a.endOfParagraph&&Ob.Tga(4)||(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.qJf}),rb=!1);return nb.Gd.eca(Ob.currentNode)?
1!==Ya&&rb?32:rb?32:8:8};this.Opa=(rb,Yb,Ya,Ob,vc)=>{rb=!0;Yb.contextId!==M.a.paragraph&&(rb=!1);if(1===Ya&&!rb)return 8;Ya=Yb.node;-1!==vc.Kh?vc.Kh!==oa.ParagraphReader.Ex(Ya)&&(vc.Kh=0):vc.Kh=oa.ParagraphReader.Ex(Ya);rb=this.Xo.Ahb(Ya);vc.zt?(!vc.Ppm&&this.Spm(vc.zt,rb)&&2===vc.zt.specialIndentType&&(vc.zt.specialIndentType=0),vc.zt.nGb===rb.nGb&&k.a.ywa(vc.zt.zB,rb.zB)||(vc.zt.zB=Number.MAX_VALUE),vc.zt.oGb===rb.oGb&&k.a.ywa(vc.zt.foa,rb.foa)||(vc.zt.foa=Number.MAX_VALUE)):vc.zt=rb;Yb=nb.Wg.cvh(Yb.$j);
void 0!==Yb&&null!==Yb&&(Yb=Yb.node,void 0!==Yb&&null!==Yb&&(Yb=U.WordSectionNavigator.instance.EJ(Yb),void 0!==Yb&&null!==Yb&&(Yb=nb.Tf.$t(Yb)-(nb.Tf.mJ(Yb)+nb.Tf.ZK(Yb)+Pa.App.vza),rb.$Rc=Yb-rb.zB,rb.ZRc=Yb-rb.foa,vc.zt.ZRc=Math.min(vc.zt.ZRc,rb.ZRc),vc.zt.$Rc=Math.min(vc.zt.$Rc,rb.$Rc))));Yb=this.aW.qEa(Ya);vc.spacing?(vc.spacing.beforeSpacing=nb.Sqh(Yb.beforeSpacing,vc.spacing.beforeSpacing),vc.spacing.afterSpacing=nb.Sqh(Yb.afterSpacing,vc.spacing.afterSpacing),vc.spacing.lineSpacing.unit===
Yb.lineSpacing.unit&&k.a.ywa(vc.spacing.lineSpacing.value,Yb.lineSpacing.value)||(vc.spacing.lineSpacing.unit=0,vc.spacing.lineSpacing.value=0)):vc.spacing=Yb;Yb=new J.GraphIterator;Yb.set(Ya);Yb.zb(11);if(Ya=Yb.jd(11))vc.isRtl=Y.OutlineElementReader.an(Ya);Ya=nb.Gd.lw(Yb);Yb=16;void 0!==Ya&&null!==Ya&&(Yb=Ya.listType);vc.listType=nb.eSl(vc.listType,Yb);vc.Jx=16===vc.listType?null:Ya;return 32};this.JKn=(rb,Yb,Ya,Ob,vc)=>{vc.isRtl=Y.OutlineElementReader.an(W.OutlineElementNavigator.Gl(Yb.node));return 32};
this.Qth=(rb,Yb,Ya)=>{if(rb===la.a.rOb)rb=!0;else if(rb===la.a.qOb)rb=!1;else return 2;rb&&this.XJi(Yb);if(1===Ya)return 32;this.nh.jOb(W.OutlineElementNavigator.Gl(Yb.node),rb);return 32};this.zKn=(rb,Yb,Ya,Ob,vc)=>{rb=Yb.node;vc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Gl(rb));vc.Kh=X.ImageReader.Ex(rb);return 32};this.LLn=(rb,Yb,Ya,Ob,vc)=>{rb=Yb.node;vc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Gl(rb));vc.Kh=ma.TableReader.Ex(rb);-1!==vc.Kh&&vc.Kh||(vc.Kh=
vc.isRtl?3:1);return 32};this.m1e=(rb,Yb,Ya,Ob,vc)=>{let Sa;if(!({gy:Sa}=Fa.a.Ncg(Ya,Yb)).returnValue)return Sa;const Ab=Yb.node;switch(rb){case la.a.qOb:this.nh.bjc(Ab,!1);break;case la.a.rOb:this.XJi(Yb);this.nh.bjc(Ab,!0);break;case la.a.g5:Sa=l.AFrameworkApplication.va.Of(Yb.$j,rb,Ya,!0,Ob,vc),32===Sa&&oa.ParagraphReader.lm(Yb)&&nb.e2c&&nb.e2c.nda(Ab)}return 32};this.wXk=(rb,Yb,Ya,Ob,vc)=>{const Sa={};Sa[Ua.a.QIa]=6168;Sa[Ua.a.PIa]=6169;var Ab=Yb.view;const Fb=new Na.GraphTransaction(1===Ya?3:
15);Fb.Cb(Ab.root);let Va=Ua.a.Bpa(rb,Yb,Ya,Ob,vc,Sa,0),Wa=null;Ab.Vi&&(Wa=Ab);Ab=!0;let jb=null;Wa&&(jb=Wa.lb.gb.kb)&&(rb=!Fa.a.R$b(rb),nb.Xf.MFf(jb,rb)?(nb.Ic.Yb(qa.a.kf,{["Reason"]:La.a.RE}),Va=8,Ab=!1):1===Ya&&(Va=32,Ab=!1),nb.Wg.qza(oa.ParagraphReader.oU,Wa.lb.tg)&&(nb.Ic.Yb(qa.a.kf,{["Reason"]:La.a.hO}),Va=8,Ab=!1));Ab&&this.dSm(jb)&&(Va=Ua.a.Bpa(la.a.veb,Yb,Ya,Ob,vc,Sa,12));Fb.dispose();return Va};this.vXk=(rb,Yb,Ya)=>{rb=!0;Yb.contextId!==M.a.paragraph&&Yb.contextId!==M.a.Tc?rb=!1:nb.Xf.i3a(Yb)&&
(nb.Ic.Yb(qa.a.hn,{["Reason"]:La.a.RE}),rb=!1);if(1===Ya||!rb)return rb?32:8;Yb=Yb.node;Ya=new Na.GraphTransaction(15);Ya.Cb(Yb);nb.Un.nGc(Yb);this.Ks.C2b(Yb,!0);this.Ru.k7e(Yb);Ya.dispose();return 2};this.slm=(rb,Yb,Ya)=>{rb=!0;Yb.contextId!==M.a.view&&(rb=!1);if(1===Ya&&!rb)return 8;if(!Yb.view||!Yb.view.qe)return 2;Yb=Yb.view;if(!Yb.lb||!Yb.lb.gb.kb)return 8;if(nb.Wg.qza(oa.ParagraphReader.oU,Yb.lb.tg))return nb.Ic.Yb(qa.a.kf,{["Reason"]:La.a.hO}),8;Yb=Yb.lb.gb;for(const Ob of Yb)for(const vc of Ob)if(vc&&
vc.contextId!==M.a.Hd&&vc.contextId!==M.a.Tc&&vc.contextId!==M.a.paragraph&&vc.contextId!==M.a.endOfParagraph)return 2;return 32};this.m5a=(rb,Yb,Ya,Ob,vc)=>{rb=!0;Yb.contextId!==M.a.paragraph&&(rb=!1);if(1===Ya&&!rb)return 8;vc.zt||(Yb=Yb.node,Ya=this.Xo.Ahb(Yb),vc.zt=Ya,Yb=W.OutlineElementNavigator.Gl(Yb),vc.isRtl=Yb?Y.OutlineElementReader.an(Yb):!1);return 32};this.MLn=(rb,Yb,Ya,Ob,vc)=>{Yb=Yb.node;rb=W.OutlineElementNavigator.Gl(Yb);vc.zt||(Yb=this.A6l(Yb),Yb=this.Xo.Ahb(Yb),vc.zt=Yb,vc.isRtl=
Y.OutlineElementReader.isRtl(rb));return 32};this.g3j=eb;this.J$=Ib;this.u6=Xa;this.Do=Ra;this.Be=gb;this.Kd=Bb;this.Ks=$b;this.aW=Qb;this.Ru=Db;this.Uy=Ac;this.nh=dc;this.Xo=Ub}get recentColors(){return null!=this.CFg?this.CFg:this.CFg=x.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get EMd(){return!!this.u6&&this.u6.enabled}Tb(){const eb=l.AFrameworkApplication.va,Ib=this.JKn;(nb.Xb?nb.Xb.DA(42):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?
(eb.qa(la.a.font,M.a.endOfParagraph,this.kT),eb.qa(la.a.RA,M.a.endOfParagraph,this.kT),eb.qa(la.a.G_,M.a.endOfParagraph,this.kT),eb.qa(la.a.U0,M.a.endOfParagraph,this.kT),eb.qa(la.a.Sv,M.a.endOfParagraph,this.kT),eb.qa(la.a.lqa,M.a.endOfParagraph,this.kT),eb.qa(la.a.Cfa,M.a.endOfParagraph,this.kT),eb.qa(la.a.HY,M.a.endOfParagraph,this.kT),eb.qa(la.a.N9,M.a.endOfParagraph,this.kT),eb.qa(la.a.bua,M.a.endOfParagraph,this.kT),eb.qa(la.a.bold,M.a.endOfParagraph,this.kT),eb.qa(la.a.setItalic,M.a.endOfParagraph,
this.kT),eb.qa(la.a.underline,M.a.endOfParagraph,this.kT),eb.qa(la.a.Zia,M.a.endOfParagraph,this.kT),eb.qa(la.a.superscript,M.a.endOfParagraph,this.kT),eb.qa(la.a.subscript,M.a.endOfParagraph,this.kT),eb.qa(la.a.strikethrough,M.a.endOfParagraph,this.kT),eb.qa(la.a.wt,M.a.endOfParagraph,this.kT),eb.qa(la.a.g5,M.a.endOfParagraph,this.kT),eb.qa(la.a.clearFormatting,M.a.endOfParagraph,this.kT)):Pa.App.Icc&&(eb.qa(la.a.font,M.a.endOfParagraph,this.Ula),eb.qa(la.a.RA,M.a.endOfParagraph,this.Ula),eb.qa(la.a.Sv,
M.a.endOfParagraph,this.Ula),eb.qa(la.a.lqa,M.a.endOfParagraph,this.Ula),eb.qa(la.a.Cfa,M.a.endOfParagraph,this.Ula),eb.qa(la.a.bold,M.a.endOfParagraph,this.Ula),eb.qa(la.a.setItalic,M.a.endOfParagraph,this.Ula),eb.qa(la.a.superscript,M.a.endOfParagraph,this.Ula),eb.qa(la.a.subscript,M.a.endOfParagraph,this.Ula),eb.qa(la.a.strikethrough,M.a.endOfParagraph,this.Ula),eb.qa(la.a.wt,M.a.endOfParagraph,this.Ula),eb.qa(la.a.G_,M.a.endOfParagraph,this.Ula),eb.qa(la.a.U0,M.a.endOfParagraph,this.Ula));const Xa=
Pa.App.MTa.YHc(Ra=>wa.OutlineElementGeneralizer.qna(Ra.gb,!0));eb.fb(la.a.k6e,M.a.view,this.slm,100);eb.fb(la.a.q$c,M.a.Hd,this.q$c,1028);eb.qa(la.a.j5a,M.a.view,this.u4i);eb.qa(la.a.v2c,M.a.view,this.u4i);eb.qa(la.a.Opa,M.a.view,Xa);eb.qa(la.a.Opa,M.a.paragraph,this.Opa);eb.qa(la.a.Opa,M.a.image,this.zKn);eb.qa(la.a.Opa,M.a.unsupportedObject,Ib);eb.qa(la.a.Opa,M.a.table,this.LLn);eb.qa(la.a.m5a,M.a.view,Xa);eb.qa(la.a.m5a,M.a.paragraph,this.m5a);eb.qa(la.a.m5a,M.a.table,this.MLn);eb.Vc(la.a.j5a,
99);eb.Vc(la.a.v2c,1127);eb.Vc(la.a.Opa,97);eb.Vc(la.a.m5a,97);this.cM(eb,la.a.font);this.cM(eb,la.a.RA);this.cM(eb,la.a.G_);this.cM(eb,la.a.U0);eb.ndb(la.a.z0h,M.a.view,this.T0e);eb.Vc(la.a.z0h,1092);this.cM(eb,la.a.Sv);this.cM(eb,la.a.lqa);this.cM(eb,la.a.Cfa);this.cM(eb,la.a.HY);this.cM(eb,la.a.N9);this.cM(eb,la.a.HZa);this.cM(eb,la.a.HCa);this.cM(eb,la.a.ICa);this.cM(eb,la.a.$ta);this.cM(eb,la.a.IZa);this.cM(eb,la.a.bua);this.cM(eb,la.a.bold);eb.QNb(la.a.bold,this.yDb);this.cM(eb,la.a.setItalic);
eb.QNb(la.a.setItalic,this.yDb);this.cM(eb,la.a.underline);eb.QNb(la.a.underline,this.yDb);this.cM(eb,la.a.Zia);this.cM(eb,la.a.superscript);eb.QNb(la.a.superscript,this.yDb);this.cM(eb,la.a.subscript);eb.QNb(la.a.subscript,this.yDb);this.cM(eb,la.a.strikethrough);eb.QNb(la.a.strikethrough,this.yDb);this.cM(eb,la.a.wt);eb.QNb(la.a.wt,this.yDb);eb.fb(la.a.PPa,M.a.Hd,this.vAd,96);eb.ndb(la.a.g5,M.a.view,this.T0e);eb.qa(la.a.g5,M.a.paragraph,this.m1e);eb.qa(la.a.g5,M.a.Hd,this.vAd);eb.qa(la.a.g5,M.a.Tc,
this.b1e);eb.qa(la.a.clearFormatting,M.a.view,this.wXk);eb.qa(la.a.clearFormatting,M.a.paragraph,this.vXk);eb.qa(la.a.clearFormatting,M.a.Hd,this.vAd);eb.qa(la.a.clearFormatting,M.a.Tc,this.b1e);eb.Vc(la.a.clearFormatting,1036);eb.qa(la.a.veb,M.a.Hd,this.veb);eb.qa(la.a.veb,M.a.Tc,this.veb);eb.qa(la.a.mGc,M.a.view,this.mGc);eb.qa(la.a.qOb,M.a.view,Fa.a.dw);eb.qa(la.a.qOb,M.a.paragraph,this.m1e);eb.qa(la.a.qOb,M.a.unsupportedObject,this.Qth);eb.Vc(la.a.qOb,1028);eb.qa(la.a.rOb,M.a.view,Fa.a.dw);eb.qa(la.a.rOb,
M.a.paragraph,this.m1e);eb.qa(la.a.rOb,M.a.unsupportedObject,this.Qth);eb.Vc(la.a.rOb,1028)}cM(eb,Ib){eb.ndb(Ib,M.a.view,this.T0e);eb.qa(Ib,M.a.Hd,this.vAd);eb.qa(Ib,M.a.Tc,this.b1e);eb.Vc(Ib,1036)}y2k(eb,Ib){for(const Qb of eb)for(const Ac of Qb){eb=null;if(Ac.contextId===M.a.Hd){if(fa.b(Ac))continue;eb=[];var Xa=Ac.node.pa;if(Xa){var Ra=Xa.length-1;const Db=Ac.cpBegin,dc=Ac.cpEnd;let Pb=!1;const Ub=Ac.node.characterData;if(Ub&&""!==Ub){var gb=Ub.substr(Db,dc-Db);gb&&""!==gb&&y.a.x9e(gb,0,gb.length)&&
(Pb=!0)}gb=!1;for(let rb=0;rb<Ra;rb++){var Bb=Xa.J(rb).cp,$b=Xa.J(rb+1).cp;if(Xa.J(rb).formatting&&Math.max(Bb,Db)<Math.min($b,dc)){if(Ub&&""!==Ub&&(Bb=Bb<Db?Db:Bb,$b=Ub.substr(Bb,($b<dc?$b:dc)-Bb),!Pb&&y.a.x9e($b,0,$b.length)))continue;gb=!0;eb.push(Xa.J(rb).formatting)}else if(gb)break}Xa.J(Ra).formatting&&Ac.cpEnd>Xa.J(Ra).cp&&eb.push(Xa.J(Ra).formatting)}}else if(Ac.contextId===M.a.paragraph&&!oa.ParagraphReader.oU(Ac)){if(eb=[],Xa=Ac.node.pa)for(Ra=0;Ra<Xa.length;Ra++)Xa.J(Ra).formatting&&eb.push(Xa.J(Ra).formatting)}else if(Ac.contextId===
M.a.endOfParagraph)eb=[V.FormattingReader.Kr(Ac)];else if(Ac.contextId===M.a.Tc){this.iKn(Ac,Ib);return}if(eb&&0<eb.length)for(const Db of eb)if(V.FormattingReader.Klg(Ib,Db.cache,Ac))return}}iKn(eb,Ib){if(eb=V.FormattingReader.Kr(eb)){eb=eb.cache;var Xa=nb.rj.xG(z.a.bold,eb.isBold);Ib.bold=Xa?1:0;Xa=nb.rj.xG(z.a.italic,eb.isItalic);Ib.italic=Xa?1:0;Xa=nb.rj.xG(z.a.underline,eb.isUnderline);Ib.underline=Xa?1:0;Ib.underlineType=nb.rj.xG(z.a.underlineType,eb.underlineType);Xa=nb.rj.xG(z.a.superscript,
eb.isSuperscript);Ib.superscript=Xa?1:0;Xa=nb.rj.xG(z.a.subscript,eb.isSubscript);Ib.subscript=Xa?1:0;Xa=nb.rj.xG(z.a.strikethrough,eb.isStrikethrough);Ib.strikethrough=Xa?1:0;Xa=nb.rj.xG(w.a.wt,eb.isDoubleStrikethrough);Ib.wt=Xa?1:0;Xa=nb.rj.xG(z.a.font,eb.rG);Ib.fontName=Ka.a.Y0a(Xa);Ib.Ada=eb.He;Ib.fontSize=nb.rj.xG(z.a.fontSize,eb.fontSize);Ib.fontColor=nb.rj.xG(z.a.fontColor,eb.fontColor);Ib.highlight=nb.rj.xG(z.a.highlight,eb.highlight)}}sto(eb){return eb===la.a.underline||eb===la.a.Zia||eb===
la.a.strikethrough||eb===la.a.wt||eb===la.a.HY}static Ypf(eb){return"string"===typeof eb?{fontName:eb,Ada:-1,bold:2,italic:2}:eb}XZ(eb,Ib,Xa,Ra){var gb;const Bb=eb.cpBegin,$b=eb.cpEnd,Qb=eb.node;var Ac=V.FormattingReader.Kr(eb);let Db=Bb;const dc=null===(gb=l.AFrameworkApplication.K)||void 0===gb?void 0:gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);gb=nb.Ld.rg;if(dc&&(gb||Qb.Us))return!1;if(zb.has(Ib))for(const Pb of Qb.pa)if(!(Pb.cp<=Bb)){if(Pb.cp>=$b)break;Pb.formatting&&
Pb.formatting.cache.fontSize!=Ac.cache.fontSize&&(Ac=this.cqf(eb.node,Ac,Ib,Xa,dc?null:Ra),this.J$.annotateRange(eb.node,dc?Qb.pa.U_a(Db):Db,dc?Qb.pa.U_a(Pb.cp):Pb.cp,Ac),Db=Pb.cp,Ac=Pb.formatting)}Ib=this.cqf(eb.node,Ac,Ib,Xa,dc?null:Ra);this.J$.annotateRange(eb.node,dc?Qb.pa.U_a(Db):Db,dc?Qb.pa.U_a($b):$b,Ib);return!0}cqf(eb,Ib,Xa,Ra,gb){const Bb={},$b=Object(H.a)(28,Ra),Qb=Ib.cache;switch(Xa){case la.a.bold:2===Ra.value&&(Ra.value=Qb.isBold?0:1);Bb[z.a.bold.id]=1===Ra.value;break;case la.a.setItalic:2===
Ra.value&&(Ra.value=Qb.isItalic?0:1);Bb[z.a.italic.id]=1===Ra.value;break;case la.a.underline:2===Ra.value&&(Ra.value=Qb.isUnderline?0:1);Bb[z.a.underline.id]=1===Ra.value;break;case la.a.Zia:Bb[z.a.underlineType.id]=Ra.number;break;case la.a.superscript:2===Ra.value&&(Ra.value=Qb.isSuperscript?0:1);Bb[z.a.superscript.id]=1===Ra.value;1===Ra.value&&(Bb[z.a.subscript.id]=!1);break;case la.a.subscript:2===Ra.value&&(Ra.value=Qb.isSubscript?0:1);Bb[z.a.subscript.id]=1===Ra.value;1===Ra.value&&(Bb[z.a.superscript.id]=
!1);break;case la.a.strikethrough:6!==l.AFrameworkApplication.va.AD?G.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Ra.value&&(Ra.value=Qb.isStrikethrough?0:1);Bb[z.a.strikethrough.id]=1===Ra.value;break;case la.a.wt:2===Ra.value&&(Ra.value=Qb.isDoubleStrikethrough?0:1);Bb[w.a.wt.id]=1===Ra.value;break;case la.a.font:if($b&&$b.xd){const {fontName:Db,Ada:dc,bold:Pb,italic:Ub}=nb.Ypf($b.xd);
Ra=Db.substr(0,nb.wMi);this.EMd&&(Bb[F.a.lT.id]=Ra,Bb[F.a.zC.id]=Ra,Bb[F.a.i_.id]=Ra,Bb[F.a.J_.id]=Ra,Bb[F.a.Ke.id]=dc,Bb[F.a.Xe.id]=dc,Bb[F.a.Je.id]=dc,Bb[F.a.Le.id]=dc);Bb[z.a.font.id]=Ra;Bb[F.a.He.id]=dc;if(Object(sa.a)()){Ra=1==Pb;var Ac=1==Ub;if(Ra||Ac)Bb[z.a.bold.id]=Ra,Bb[z.a.italic.id]=Ac}}break;case la.a.Sv:Ra=wb.a.instance.iua(eb,Ra);Bb[z.a.fontColor.id]=Ra;break;case la.a.lqa:Ac=wb.a.instance.iua(eb,Ra);Bb[z.a.fontColor.id]=Ac;this.recentColors.UYa(Ra)||G.ULS.sendTraceTag(529006977,340,
50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.Cfa:Bb[z.a.fontColor.id]=cc.a.auto;break;case la.a.HY:Bb[z.a.highlight.id]=parseInt(Ra,16);break;case la.a.N9:Bb[z.a.highlight.id]=parseInt(Ra,16);this.recentColors.UYa(Ra)||G.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.bua:Bb[z.a.highlight.id]=cc.a.auto;break;case la.a.RA:Bb[z.a.fontSize.id]=this.Be.a3b($b.xd);break;case la.a.G_:Bb[z.a.fontSize.id]=this.AZl(Qb.fontSize);
break;case la.a.U0:Bb[z.a.fontSize.id]=this.SSl(Qb.fontSize);break;case la.a.PPa:if(Ra=null===(Ac=nb.Sz)||void 0===Ac?void 0:Ac.PPa)for(const Db of Ra.Hl())Bb[Db.id]=Ra.Hf(Db);break;case la.a.clearFormatting:if(Ra=Ib.yn)for(const Db of Ra.Hl())Bb[Db.id]=null;Bb[F.a.AAb.id]=!0;break;case la.a.HCa:case la.a.ICa:case la.a.HZa:case la.a.$ta:case la.a.IZa:Qb.pPa&&2===Qb.capitalization&&(Bb[w.a.capitalization.id]=0)}null!=gb&&(Bb[l.AFrameworkApplication.$lf]=gb);return Bb}AZl(eb){eb=this.Be.G_(eb);return this.Be.a3b(eb)}SSl(eb){eb=
this.Be.U0(eb);return this.Be.a3b(eb)}Gic(eb,Ib,Xa,Ra){var gb=eb.cache;const Bb=Object(H.a)(28,Xa);switch(Ib){case la.a.bold:2===Xa.value&&(Xa.value=gb.isBold?0:1);this.Be.qL(eb,1===Xa.value);break;case la.a.setItalic:2===Xa.value&&(Xa.value=gb.isItalic?0:1);this.Be.setItalic(eb,1===Xa.value);break;case la.a.underline:2===Xa.value&&(Xa.value=gb.isUnderline?0:1);this.Be.j5(eb,1===Xa.value);break;case la.a.Zia:this.Be.Zia(eb,Xa);break;case la.a.superscript:2===Xa.value&&(Xa.value=gb.isSuperscript?0:
1);this.Be.oqa(eb,1===Xa.value);break;case la.a.subscript:2===Xa.value&&(Xa.value=gb.isSubscript?0:1);this.Be.zHa(eb,1===Xa.value);break;case la.a.strikethrough:6!==l.AFrameworkApplication.va.AD?G.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Xa.value&&(Xa.value=gb.isStrikethrough?0:1);this.Be.Wia(eb,1===Xa.value);break;case la.a.wt:2===Xa.value&&(Xa.value=gb.isDoubleStrikethrough?
0:1);this.Be.age(eb,1===Xa.value);break;case la.a.font:if(Bb&&Bb.xd){const {fontName:$b,Ada:Qb,bold:Ac,italic:Db}=nb.Ypf(Bb.xd);this.Be.Sia(eb,$b.substr(0,nb.wMi));this.Be.Dbg(eb,Qb);Object(sa.a)()&&(Xa=1==Ac,Ra=1==Db,Xa||Ra)&&(this.Be.qL(eb,Xa),this.Be.setItalic(eb,Ra))}break;case la.a.Sv:G.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.Be.Sv(eb,Xa,null);break;case la.a.lqa:this.Be.Sv(eb,Xa,null);this.recentColors.UYa(Xa)||G.ULS.sendTraceTag(594899727,
340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.Cfa:this.Be.Cfa(eb);break;case la.a.HY:G.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Be.Bya(eb,Xa);break;case la.a.N9:this.Be.Bya(eb,Xa);this.recentColors.UYa(Xa)||G.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.bua:this.Be.zDd(eb);break;case la.a.RA:this.Be.RA(eb,Bb.xd);break;case la.a.G_:this.Be.wki(eb);
break;case la.a.U0:this.Be.tsj(eb);break;case la.a.g5:gb=Xa.ia(F.a.noProof,!1);this.Be.Gag(eb,Xa.getValue(z.a.eL),Ra,gb);break;case la.a.PPa:this.Be.ige(eb);break;case la.a.clearFormatting:this.Be.Bfa(eb);break;case la.a.HCa:case la.a.ICa:case la.a.HZa:case la.a.$ta:case la.a.IZa:gb.pPa&&2===gb.capitalization&&this.Be.jXk(eb)}}a_n(eb,Ib){la.a.clearFormatting===Ib&&W.OutlineElementNavigator.Gl(eb).properties.removeProperty(z.a.y0)}Spm(eb,Ib){return this.iuh(eb,Ib)||this.iuh(Ib,eb)}iuh(eb,Ib){return(1===
eb.specialIndentType||!eb.specialIndentType)&&2===Ib.specialIndentType}A6l(eb){eb=J.GraphIterator.$a(eb);eb.zb(11);aa.moveToCell(eb,0,0);eb.Qd();eb.F_();return eb.currentNode}dSm(eb){return!eb||ha.SelectionEditor.km(eb)||1===eb.length&&ha.SelectionEditor.ml(eb.Oa)&&!ha.SelectionEditor.wjb(eb.Oa)?!1:!0}XJi(eb){nb.Adh.nb(eb.contextId)||(G.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",eb.contextId),nb.Adh.Z(eb.contextId,!0))}fGm(eb){return eb===la.a.HZa||eb===la.a.HCa||eb===la.a.ICa||eb===la.a.$ta||
eb===la.a.IZa}SCd(eb,Ib){const Xa=eb.node,Ra=Xa.characterData.substr(eb.cpBegin,eb.cpEnd-eb.cpBegin);this.vkb.set("Command",Ib.toString());n.Health.instance.recordKpiUsage(this.kpiName,1,this.f8,this.vkb);Ib=nb.vHo(Ra,Ib);Xa.jqa(Xa.characterData.substr(0,eb.cpBegin)+Ib+Xa.characterData.substr(eb.cpEnd));return 32}static get rj(){return nb.Sz||(nb.Sz=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Zw(){return nb.Tm||(nb.Tm=x.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Wg(){return ja.ContextSetEditor.instance}static get Xf(){return Ja.a.instance}static get Ic(){return u.a.instance}static get Xb(){return null!=
nb.Qyg?nb.Qyg:nb.Qyg=x.a.instance.Na("Box4.IFeatureHelper")}static get e2c(){return Pa.App.gN}static get Ld(){return null!=nb.pIg?nb.pIg:nb.pIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lj(){return null!=nb.RHg?nb.RHg:nb.RHg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Lqa(){return null!=nb.tHg?nb.tHg:nb.tHg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Gd(){return null!=nb.LDg?nb.LDg:nb.LDg=x.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=
nb.xDg?nb.xDg:nb.xDg=x.a.instance.resolve("Box4.List.IListEditor")}static get Tf(){return ca.a.instance}static eSl(eb,Ib){return 42===eb?Ib:eb!==Ib||16===eb?16:eb}static Sqh(eb,Ib){eb.Xui||(Ib.Xui?Ib=eb:Ib.unit===eb.unit&&k.a.ywa(Ib.value,eb.value)||(Ib.value=-1));return Ib}static vHo(eb,Ib){switch(Ib){case la.a.HCa:return eb.toLowerCase();case la.a.ICa:return 6!==l.AFrameworkApplication.va.AD?G.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):G.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),eb.toUpperCase();case la.a.HZa:case la.a.$ta:return nb.bUk(eb,Ib===la.a.$ta);case la.a.IZa:return nb.JJo(eb);default:return eb}}static JJo(eb){let Ib="";for(let Xa=0;Xa<eb.length;Xa++)Ib=eb.charAt(Xa)===eb.charAt(Xa).toUpperCase()?Ib+eb.charAt(Xa).toLowerCase():Ib+eb.charAt(Xa).toUpperCase();return Ib}static bUk(eb,Ib){let Xa,Ra,gb=!0,Bb=eb.length,$b=0,Qb=nb.gGf(eb,$b,Bb);for(;0<Bb;){Ra=Xa=!1;var Ac=Bb;let dc;var Db=void 0;for(Db=0;0<Ac&&nb.uWk(eb.charAt($b+
Db));Db++,Ac--)Ra=nb.e_d(eb.charAt($b+Db));for(dc=Db;0<Ac&&!(Xa=nb.e_d(eb.charAt($b+Db)))&&" "!==eb.charAt($b+Db)&&"/"!==eb.charAt($b+Db);Db++,Ac--);Ac=Db-dc;if(0>=Ac)break;$b+=dc;Db=eb.substr($b,Ac);Db=Db===Db.toUpperCase();if(Qb||!Db)eb=gb||Ra||Ib?eb.substr(0,$b)+eb.charAt($b).toUpperCase()+eb.substr($b+1,Ac-1).toLowerCase()+eb.substr($b+Ac):eb.substr(0,$b)+eb.substr($b,Ac).toLowerCase()+eb.substr($b+Ac);Bb-=Ac+dc;$b+=Ac;if(gb=Xa)$b++,Bb--,Qb=nb.gGf(eb,$b,Bb)}return eb}static gGf(eb,Ib,Xa){for(;0<
Xa&&!nb.e_d(eb.charAt(Ib));){if(eb.charAt(Ib)!==eb.charAt(Ib).toUpperCase())return!1;Ib++;Xa--}return!0}static ZRm(eb,Ib){for(var Xa=0;0<Ib&&!nb.e_d(eb.charAt(Xa));){if(eb.charAt(Xa)!==eb.charAt(Xa).toLowerCase())return!1;Xa++;Ib--}return!0}static e_d(eb){return"."===eb||"!"===eb||"?"===eb?!0:!1}static uWk(eb){return-1==="0123456789".indexOf(eb)&&eb.toUpperCase()===eb.toLowerCase()}static a0h(){const eb=x.a.instance.Sa("Common.ISystemInitiatedFeedback");eb&&eb.execute(Ib=>{Ib.logActivity("FontsSurveyActivity",
"FontsFloodgateSurvey")})}}nb.Adh=new N.a;nb.Sz=null;nb.Tm=null;nb.wMi=31;Object(E.a)(nb,"TextFormattingActor",null,[])},2025:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.chrome=0]="chrome";f[f.edge=1]="edge";f[f.firefox=2]="firefox";f[f.IE=3]="IE";f[f.safari=4]="safari";f[f.others=5]="others";f[f.unknown=6]="unknown";f[f.electron=7]="electron";f[f.chromiumEdge=8]="chromiumEdge";f[f.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(E.b)("BrowserCode",l)},2027:function(E,
K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(E.a)(l,"AtMentionAttributes",null,[])},2033:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.initial=0]="initial";f[f.startSearch=1]="startSearch";f[f.searching=2]="searching";f[f.searchComplete=3]="searchComplete";f[f.replaceAllInProgress=4]="replaceAllInProgress";f[f.replaceAllComplete=5]="replaceAllComplete";f[f.tooManyResults=6]="tooManyResults";
f[f.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(E.b)("FindReplaceViewType",l)},2035:function(E,K,c){c.d(K,"a",function(){return l});var l;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(l||(l={}))},2050:function(E,K,c){function l(b,h){h=Object.assign(new pa.a,{name:"LinkType",string:h});f(Eb.a.RAm,b,[h])}function f(b,h,v,D=!0){h&&h.UILocation&&
Object(Qe.d)(b,D,Qe.e,0,h.UILocation,0,v)}function a(b,h){const v=Ga.a.instance;return new DB(b,h,v.Ue("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,v.Ue("WordEditor.Bookmark.FullBookmarkManager").value,v.resolve("Box4.IHyperlinkStrategy"),v.resolve("Box4.IHyperlinkEditor"),v.resolve("Box4.ICharacterPropertiesEditor"),v.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,v.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,wr.a.instance,v.Na("Box4.IInternalLinkManager"))}
function k(b,h){var v;return b===Qr.none?"none":null===(v=GB[b])||void 0===v?void 0:v[h]}function x(){const b=Ga.a.instance.Na("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&u.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Ga.a.instance.Na("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&u.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");
return b}c.r(K);var n=c(0),u=c(7),z=c(55),w=c(2),F=c(35),G=c(19),H=c(162),L=c(85);class I{constructor(b){this.djg=0;this.$Fb=this.igc=this.tTa=null;this.MR=w.AFrameworkApplication.ta.Gq;this.PX=b;this.PX.Av(L.a.ckj);this.PX.OB(L.a.ckj,Object(z.a)(this,this.Arn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.$Fb)return u.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.$Fb;this.tTa=this.MR.$f("ComponentAttach","getCustomAuthConfig");return this.$Fb=new Promise((b,
h)=>{const v={};let D=!1,Q=!1,ba=0;this.djg=window.setInterval(()=>{4>ba?(ba++,this.PX.sendMessage(L.a.getCustomAuthConfig,v)):(window.clearInterval(this.djg),D=!0,u.ULS.sendTraceTag(588087303,344,10,F.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.igc=(ta,Ta)=>{window.clearInterval(this.djg);D||Q||(Q=!0,ta?(u.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ta)):(u.ULS.sendTraceTag(589050654,369,10,F.c({["error"]:Ta.toString()})),h(Ta)))};
this.PX.sendMessage(L.a.getCustomAuthConfig,v)})}Arn(b){try{const h=F.a(b.Values[H.a.rPk]);let v=w.AFrameworkApplication.K.jb("Application")||"";v=G.a.Ug(v);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
v+"%3Facctsw%3D1";this.tTa&&(this.tTa.stop(),this.tTa=null);this.igc(h,"")}catch(h){u.ULS.sendTraceTag(589050655,344,10,F.c({["error"]:h.message,["stack"]:h.stack})),this.igc(null,h.message)}}}Object(n.a)(I,"AccountSwitchingManager",null,[315]);var N=c(179);class P{get name(){return"Common.App.AccountSwitching"}xc(b){b.register(I,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Rd(()=>new I(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){N.a.instance.Fc(new P)}}
Object(n.a)(P,"AccountSwitchingPackage",null,[1,2]);var M;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";
b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(M||(M={}));Object(n.b)("ErrorCodes",M);c(1803);class J{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(n.a)(J,"OutstandingRequest",null,[]);class V{}V.lgn="AADSTS50058";V.invalidResourceUrl="AADSTS50001";V.egn="AADSTS65001";V.Sgn="AADSTS70011";V.userAborted="13002";V.JDn="Popup Window is null";
V.IDn="Popup Window closed";V.adalTimeout="Token renewal operation failed due to timeout";V.RJo="tokenRevoked";Object(n.a)(V,"WopiHostErrorType",null,[]);var X=c(743),W=c(58),U=c(1802);class Y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(n.a)(Y,"WopiIdentityInfo",null,[813]);class ca{constructor(b,h,v){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=v}}Object(n.a)(ca,"WopiIdentityToken",
null,[812]);var aa=c(20),fa=c(185),pa=c(31),ra=c(173);class la{constructor(b){this._initialized=!1;this.hfc={};this.Mje={};this.MR=w.AFrameworkApplication.ta.Gq;this.dyf=b}hgb(b){this._initialized||(b.Av(L.a.Xfc),b.OB(L.a.Xfc,Object(z.a)(this,this.zrn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,v=null){this.Hha(b,h);return new Promise((D,Q)=>{if(this.rBf(h))if(h in this.hfc)Q("unresolvedPendingRequest");else{var ba=window.setTimeout(()=>{u.ULS.sendTraceTag(37856032,344,10,F.c({["error"]:"Request timeout.",
["callerId"]:h}));Q("timeout")},12E4);this.Kmf(b,h,v,(ta,Ta)=>{window.clearTimeout(ba);ta?D(ta):(u.ULS.sendTraceTag(37856033,369,15,F.c({["error"]:M[Ta]})),Q(Ta))})}else u.ULS.sendTraceTag(37856034,344,10,F.c({["error"]:"Caller is not allowed."})),Q("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,v)=>{this.rBf(b)?this.G8l((D,Q)=>{D?h(D):(u.ULS.sendTraceTag(37856064,369,10,F.c({["error"]:Q.toString()})),v(Q))}):(u.ULS.sendTraceTag(37856065,344,10,F.c({["error"]:"Caller is not allowed."})),
v("notAllowed"))})}getAuthContext(b){return new Promise((h,v)=>{const D=this.getAuthContextSync(b);D?h(D):v("notAllowed")})}getAuthContextSync(b){if(this.rBf(b)){const h=new U.a;h.upn=w.AFrameworkApplication.K.jb("UserPrincipalName");h.userId=w.AFrameworkApplication.K.jb("LoggableUserId");h.authority=w.AFrameworkApplication.K.jb("HostAuthAuthority");h.tenantId=w.AFrameworkApplication.K.jb("TenantId");h.isAnonymous=w.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.Usm(b);b=w.AFrameworkApplication.K.jb("HostAuthType");
h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}u.ULS.sendTraceTag(40751647,344,10,F.c({["error"]:"Caller is not allowed."}));return null}Usm(b){const h=X.OAuthManagerSettings.jRc;return aa.a.uQa?h&&X.OAuthManagerSettings.Cxj?Array.contains(X.OAuthManagerSettings.Cxj,b.toLowerCase()):!1:h}Kmf(b,h,v,D){var Q=[];Array.add(Q,Object.assign(new pa.a,{name:"CallerId",string:h}));Array.add(Q,Object.assign(new pa.a,{name:H.a.Cfg,string:b.correlationId}));fa.a.sendTelemetryEvent(Object.assign(new ra.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Q}));Q=W.a.create().toString();const ba="getAccessToken_"+Q,ta=this.MR.$f("ComponentAttach",ba);this.Mje[ba]=ta;const Ta={};Ta[H.a.Dfg]=Q;Ta[H.a.tAo]=b.resource;Ta[H.a.uAo]=b.scope;Ta[H.a.euj]=w.AFrameworkApplication.K.jb("HostAuthType");Ta[H.a.xAo]=w.AFrameworkApplication.K.jb("UserPrincipalName");Ta[H.a.vAo]=b.silentLogin;Ta[H.a.qAo]=b.options;Ta[H.a.Cfg]=b.correlationId;Ta[H.a.rAo]=h;v&&(Ta[H.a.addinName]=v.AddinName,
Ta[H.a.pAo]=v.AddinTrustId);this.dyf.execute(ob=>{this.hgb(ob);ob.sendMessage(L.a.getAuthToken,Ta)});this.hfc[Q]=new J(b,D)}G8l(b){const h=w.AFrameworkApplication.K.jb("UserName"),v=w.AFrameworkApplication.K.jb("UserPrincipalName"),D=w.AFrameworkApplication.K.jb("LoggableUserIdSpace"),Q=new Y;Q.email=v;Q.displayName=h;switch(D){case "OrgIdPuid":Q.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Q.authority="MicrosoftAccount";break;default:Q.authority=D}b(Q,null)}zrn(b){let h=
null;try{let D=b.Values[H.a.Dfg];const Q=b.Values[H.a.oAo],ba=b.Values[H.a.euj],ta=b.Values[H.a.wAo];let Ta=null,ob=null;const Kb=this.hfc[D];if("undefined"!==typeof Kb&&Kb){var v=[];Array.add(v,Object.assign(new pa.a,{name:H.a.Cfg,string:Kb.requestParameters.correlationId}));fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:v}));h=Kb.requestCallback;delete this.hfc[D];"undefined"!==typeof Q&&Q&&Q.length?ob=new ca(Q,ba,
ta):Ta=M[this.u9m(b)];v="getAccessToken_"+D;v in this.Mje&&(this.Mje[v].stop(),delete this.Mje[v]);h(ob,Ta)}else u.ULS.sendTraceTag(37856066,344,10,F.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:D}))}catch(D){b=b.Values[H.a.Dfg],b in this.hfc&&delete this.hfc[b],this.j2d(),u.ULS.sendTraceTag(37856067,344,10,F.c({["error"]:D.message,["stack"]:D.stack})),h&&h(null,"generalException")}}rBf(b){var h=w.AFrameworkApplication.Cjm();b=b.toLowerCase();for(const v of h)if(b===
v.toLowerCase())return!0;h=X.OAuthManagerSettings.C0e;for(let v in h)if(b===h[v].toLowerCase())return!0;return!1}u9m(b){b=b.Values[H.a.sAo];this.j2d();u.ULS.sendTraceTag(39068821,344,15,F.c({["error"]:b}));return b?-1<b.indexOf(V.lgn)?9:-1<b.indexOf(V.JDn)||-1<b.indexOf(V.IDn)?12:-1<b.indexOf(V.invalidResourceUrl)?10:-1<b.indexOf(V.userAborted)?8:-1<b.indexOf(V.Sgn)||-1<b.indexOf(V.egn)||b===V.RJo?11:-1<b.indexOf(V.adalTimeout)?6:0:13}Hha(b,h){b=this.DSn(b.resource);u.ULS.sendTraceTag(39921882,344,
50,F.c({["callerId"]:h,["resource"]:b}))}j2d(){u.ULS.sendTraceTag(39068822,344,50,F.c({["userAgent"]:window.navigator.userAgent}))}DSn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(n.a)(la,"WopiIdentityManager",null,[796]);class qa{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}xc(b){this.W=b;b.register(la,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Rd(()=>new la(b.Sa("Postmessage.IHostPostmessenger")))}init(){w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){u.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){N.a.instance.Fc(new qa)}}Object(n.a)(qa,"WopiIdentityPackage",null,[1,2]);var La=c(498),Pa=c(355),Ka=c(73),Na;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]=
"cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Na||(Na={}));Object(n.b)("ApplicationFeatureHelperRequestType",Na);class sa{constructor(){this.message=null;this.httpStatusCode=0}}Object(n.a)(sa,"HttpRequstToPromiseRejectData",null,[]);var wa=c(83),ja=c(57),ha=c(197),va=c(750);class xa{constructor(b,h){this.Ma=b;this.Yf=h}fIc(b,h,v,D=null,Q=null,ba=null,ta=null,Ta=null){const ob=Na[v],Kb=ob+"RequestFailure";wa.Health.instance.recordKpiUsage(Kb,0,"jpittsdirects",null);return new Promise((Vb,
bc)=>{u.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",ob);const Dc=null!=ta?ta:this.Ma.mc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Oc=null!=Ta?Ta:this.Ma.mc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Yf.$yb(b,1,null,this.pqf(v,D),ba,1,gd=>{u.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",ob);try{if(void 0===gd||null===gd||void 0===
gd.data||null===gd.data||void 0===gd.data.we||null===gd.data.we){wa.Health.instance.recordKpiFailure(Kb,"Invalid RequestSucceededEventArgs",!1,!0,null);let je=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",ob);bc(this.vEa(je,gd))}else if(gd.data.Qe!==ha.a.Jy){wa.Health.instance.recordKpiFailure(Kb,"HttpStatusCode_"+gd.data.Qe.toString(),!1,!0,null);let je=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
gd.data.Qe,ob);bc(this.vEa(je,gd))}else{void 0!==Q&&null!==Q&&void 0!==gd.data.wj&&null!==gd.data.wj&&Q(gd.data.wj);var rd=h(gd.data.we);if(rd)u.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",ob),Vb(rd);else{wa.Health.instance.recordKpiFailure(Kb,"Parse Failure",!1,!0,null);let je=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",ob);bc(this.vEa(je,
gd))}}}catch(je){wa.Health.instance.recordKpiFailure(Kb,"Unexpected Failure",!1,!0,null),rd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",je,ob),bc(this.vEa(rd,gd))}},gd=>{if(gd.data){wa.Health.instance.recordKpiFailure(Kb,"HttpStatusCode_"+gd.data.Qe.toString(),!1,!0,null);var rd=va.a.t8b(gd.data.we||"No Data");rd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
gd.data.Qe,rd,ob)}else wa.Health.instance.recordKpiFailure(Kb,"Invalid RequestFailedEventArgs",!1,!0,null),rd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",ob);bc(this.vEa(rd,gd))},void 0,void 0,Dc,Oc)})}vEa(b,h){const v=new sa;v.message=b;v.httpStatusCode=h&&h.data?h.data.Qe:-1;return v}pqf(b,h){const v={};v["x-UserDataSignature"]=this.Ma.jb("UserDataSignature");v["x-LicensingIsEnabled"]=this.Ma.$("LicensingIsEnabled").toString();
v["x-CacheIsEnabled"]=this.Ma.$("LicensingRedisIsEnabled").toString();v["x-OcpsIsEnabled"]=this.Ma.$("OcpsIsEnabled").toString();v["x-LicensingAADIdIsEnabled"]=this.Ma.$("LicensingAadIdIsEnabled").toString();0===b&&(v["x-LicenseCheckOnTenantEnabled"]="true",v["x-SupportUserConsentDependentFeatures"]="true",v["x-AFHUserConsentGroupValue"]="0",v["x-UseShellServiceForUserConsentGroup"]="true",v["x-SMBUserLicensingEnabled"]="true",v["x-AFHPIPLComplianceEnabled"]=ja.a.dU(window.location.href,"wd_afhpipl")||
"false");if(h)for(let D of h.keys)v[D]=h.J(D);return v}}Object(n.a)(xa,"HttpRequestToPromiseUtility",null,[]);var ma;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(ma||(ma={}));Object(n.b)("AlternateAuthSupportApp",ma);class Ja{constructor(){this.Token=null;this.ExpirationTime=0}}Object(n.a)(Ja,"WacAlternateAuthToken",null,[]);class oa{constructor(b,h){this.PJo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ma=b;this.Sdd=new La.a(Pa.a.ai());this.guc=new xa(b,h);void 0!==X.OAuthManagerSettings.WKf&&null!==X.OAuthManagerSettings.WKf&&void 0!==X.OAuthManagerSettings.S2d&&null!==X.OAuthManagerSettings.S2d&&0<X.OAuthManagerSettings.S2d&&(b=new Ja,b.Token=X.OAuthManagerSettings.WKf,b.ExpirationTime=X.OAuthManagerSettings.S2d,this.Sdd.Z("loki",b))}FLl(){let b=null;this.Sdd.nb(ma[0])&&(b=this.Sdd.J(ma[0]));return void 0===b||null===b||this.fTm(b)?this.Rzl():Promise.resolve(b.Token)}fTm(b){return b.ExpirationTime-
Date.now()<this.PJo}Rzl(){const b=new La.a(Pa.a.ai());b.Z("X-AlternateAuthApp",ma[0]);return this.guc.fIc(this.rhb("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.qzn,"parseAlternateAuthTokenResponse"),2,b).then(h=>{u.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ma[0]);this.Sdd.Z(ma[0],h);return h.Token},h=>{h=Object(Ka.a)(sa,h);u.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
h.message,h.httpStatusCode);return null})}qzn(b){let h=null;({Yu:h}=F.d(b));u.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}rhb(b){return String.format("{0}{1}?{2}",this.Ma.jb("WebServiceBase"),b,w.AFrameworkApplication.hm)}}Object(n.a)(oa,"AlternateAuthHelper",null,[774]);var za=c(603);class Fa{constructor(b,h,v){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=
v}}Object(n.a)(Fa,"FeatureStateChangeArgs",null,[]);var kb=c(150),fb=c(201),lb=c(82),sb=c(135),ab;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(ab||(ab={}));Object(n.b)("FeatureState",ab);var Ga=c(22),Ua=c(13),wb=c(119);class cc{constructor(b,h,v=null,D=null,Q=null){this.Agb=this.dla=this.xch=this.Vab=this.Zud=null;this.guc=new xa(b,h);this.Ma=b;this.o$j=b.mc("LicensingMaxRetryAttempts",0);this.omd=b.$("IsO365ConsumerHost");this.HFe=b.$("IsO365CommercialHost");this.cFe=b.$("PremiumUpsellIsEnabled");
this.TVb=!1;this.iIe=0;this.EOg=v;this.mkh=D;this.ga=Q;this.Uab=b.$("LicensingIsEnabled");this.Jvb=b.$("OcpsIsEnabled")&&this.HFe;this.tWe=b.$("ShowPrivacyDialog")&&!!D;this.IVb=b.$("IsAnonymousUser");this.lLd=new Promise(ba=>{ba(!1)});this.Ypb=new Promise(ba=>{ba(!0)});this.zgb=new La.a(Pa.a.ai());this.vxd=!0;this.s4g=this.w0l();this.h3a()&&!this.IVb?(void 0!==w.AFrameworkApplication.ta&&null!==w.AFrameworkApplication.ta&&(this.Zud=w.AFrameworkApplication.ta.Gq,void 0!==this.Zud&&null!==this.Zud&&
(this.Vab=this.Zud.YQa("WebServiceCall","ApplicationFeatureHelperService"))),this.Agb=this.Ekg()):this.Agb=new Promise(ba=>{ba({})});this.Agb.catch(ba=>{ba=Object(Ka.a)(sa,ba);u.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ba?ba.httpStatusCode.toString():"Unknown")});this.vxd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ba=>{this.TVb=ba;return null})}w0l(){const b=this.Ma.Sw("AllLicensedFeatures")?this.Ma.KC("AllLicensedFeatures"):[],h=new za.a;
for(let v=0;v<b.length;v++)h.add(b[v]);return h}h3a(){return this.HFe||this.omd}Ekg(b=0,h=!1){u.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const v=kb.a.fG();v&&(v.set("retryAttempt",b.toString()),v.set("forceRefresh",h.toString()),v.set("isO365ConsumerHost",this.omd.toString()),v.set("isO365CommercialHost",this.HFe.toString()),v.set("isFreemiumUpsellSettingEnabled",this.cFe.toString()));wa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",v);wa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",v);void 0!==this.Vab&&null!==this.Vab&&this.Vab.start();let D=null;h&&(D=new La.a(Pa.a.ai()),D.Z("x-LicensingForceRefresh","true"));this.xch=new Date;return(this.Uab?this.guc.fIc(this.rhb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.uzn,"parseApplicationFeatureHelperResponse"),0,D,Object(z.a)(this,this.XGn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Q=>
{const ba=Object.assign(new wb.a,{durationMs:this.bvj()});ba.extendedProperties=v;ba.extendedProperties&&Q&&(ba.extendedProperties.set("featureCount",lb.a.count(Q).toString()),ba.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Q).toString()),ba.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Q).toString()),"FreemiumUpsell"in Q&&ba.extendedProperties.set("isFreemiumUpsellEnabled",Q.FreemiumUpsell.toString()),this.dla&&ba.extendedProperties.set("fromCache",
(this.dla<this.xch).toString()));wa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ba);return Q},Q=>{const ba=Object.assign(new wb.a,{durationMs:this.bvj()}),ta=Object(Ka.a)(sa,Q);if(!ta)return u.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),wa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ba),new Promise((Ta,ob)=>{ob(Q)});ba.extendedProperties=
v;ba.extendedProperties&&ba.extendedProperties.set("status",ta.httpStatusCode.toString());wa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ba);return 408===ta.httpStatusCode&&++b<=this.o$j?this.Ekg(b):new Promise((Ta,ob)=>{ob(ta)})})}uzn(b){(b=F.b(b))?(u.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),u.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):u.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return b.Features}rhb(b){var h=String.format("{0}{1}",this.Ma.jb("WebServiceBase"),b);this.Ma.Sw("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ma.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=cc.mQd(this.Ma))&&0<b.length&&(this.vxd&&(b+="ucbf"),h=new fb.QueryStringBuilder(h),h.Ce("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.Jvb&&!this.tWe&&!this.Uab)return this.Ypb;u.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var v=this.Jvb?this.EOg.m8("ControllerConnectedServicesEnabled"):this.Ypb;const ba=this.tWe?this.mkh.getSettings().then(ta=>2!==ta.WI,()=>h):this.Ypb;return v.then(ta=>ta?ba:this.lLd)}if("FreemiumUpsell"===b&&(!this.cFe||!this.omd||this.IVb))return this.lLd;v=null;v=this.Jvb?this.EOg.isFeatureEnabled(b):this.Ypb;let D=null;D=this.Uab?this.wJm(b,h):this.Ypb;let Q=null;Q=this.tWe?this.mkh.isFeatureEnabled(b):this.Ypb;return v.then(ba=>ba?Q.then(ta=>ta?D:this.lLd):this.lLd).then(ba=>
{this.ZIi(b,ba,!0);return ba},()=>{this.ZIi(b,h,!1);return h})}ZIi(b,h,v){u.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,v)}getFeatureTier(b,h){if(!this.Uab)return new Promise(v=>{v(2)});u.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Agb.then(v=>this.uSd(b,v,h),()=>h)}isFreemiumUpsellEnabled(){if(this.cFe&&this.omd&&!this.IVb){if(this.TVb&&2!==this.iIe||!this.TVb&&1!==this.iIe)u.ULS.sendTraceTag(509728161,
3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.TVb.toString()),this.iIe=this.TVb?2:1;return this.TVb}return!1}launchUpsellExperience(b,h=null){u.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var v=kb.a.fG();v&&(v.set("experienceId",b),h&&v.set("campaignId",h));wa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",v);
if(v=Ga.a.instance.Na("Common.IInProductMessagingUIManager")){const D=Object(z.a)(this,this.Xlm,"handleDimeTaskComplete");v.EEi(b,D,h)}else u.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),wa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb(Ua.a.fNd,2,{["experience"]:b})}eya(b,h){if(!this.Uab)return null;if(!b||!h)return u.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const v=sb.a.create().toString();this.zgb.nb(b)||this.zgb.Z(b,new La.a(Pa.a.ai()));this.zgb.J(b).add(v,h);u.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",v,b));return v}Vgc(b,h){this.Uab&&(b&&this.zgb.nb(b)?h&&sb.a.isValid(h)?this.zgb.J(b).nb(h)?(u.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
h,b)),this.zgb.J(b).remove(h)):u.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):u.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):u.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
b)))}uSd(b,h,v){return this.vxd?b in h?h[b].LicenseTier:v:b in h?this.eAn(h[b],v):v}eAn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}Xlm(){u.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Agb.then(b=>{this.Q7i(b)}).catch(()=>{this.Q7i({})})}Q7i(b){u.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.Ekg(0,!0);h.then(v=>
{this.Agb=h;lb.a.count(v)>lb.a.count(b)?wa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):wa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let D of this.zgb.keys)if(D in v){const Q=this.uSd(D,v,0);D in b?this.uSd(D,b,0)!==Q&&this.kRf(D,!0,Q):this.kRf(D,!0,Q)}else D in b&&this.kRf(D,!1,this.uSd(D,b,0))}).catch(v=>{wa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);u.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(v))})}kRf(b,h,v){u.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,v);h=new Fa(b,h,v);v=this.zgb.J(b);for(let D of v)try{D.value(h)}catch(Q){u.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,D.key,Q.message))}}vJm(b,h){if(this.Uab){const v=
this.s4g.contains(b);let D=!0,Q="",ba=!1;return this.Agb.then(ta=>{b in ta?(ta=ta[b],Q=ab[ta.FeatureState],D=1!==ta.FeatureState):D=!v;this.nJi(b,v,Q,ba,h,D);return D},()=>{ba=!0;v&&(D=h);this.nJi(b,v,Q,ba,h,D);return D})}return this.Ypb}nJi(b,h,v,D,Q,ba){u.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,D,v,Q,ba)}wJm(b,h){if(this.vxd)return this.vJm(b,h);if(this.Uab){if(this.s4g.contains(b))return this.Agb.then(v=>
b in v,()=>h);u.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Ypb}XGn(b){try{b&&"Date"in b&&(this.dla=new Date(b.Date),u.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.dla.toString()))}catch(h){u.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",h)}}bvj(){if(void 0!==this.Vab&&
null!==this.Vab){const b=this.Vab.ti;this.Vab.stop();return b}return null}static mQd(b){try{if(aa.a.mke){const h=b.jb("UserDataSignature").split(".");if(1<h.length){const v=window.self.atob(h[1]),D=JSON.parse(v).LocalStorageKey;if(void 0!==D&&null!==D&&0<D.length)return D}}}catch(h){u.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(n.a)(cc,"ApplicationFeatureHelper",null,[775]);var zb=c(74);class nb{constructor(b,h){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(n.a)(nb,"CloudPolicySettingsCacheData",null,[]);var eb=c(1377),Ib=c(527),Xa=c(289);class Ra{static zsj(){return w.AFrameworkApplication.K.$("SideCarIsEnabled")?Ra.Xee&&Ra.NTc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Ra.Xee=Xa.a.create(w.AFrameworkApplication.K.jb("SideCarUrl"));Ib.a.rX(Ra.Xee);Ra.Xee.UZ((v,D)=>{(Ra.NTc=D.succeeded)?b(D.succeeded):h(D.succeeded)})}):
new Promise(b=>{b(!1)})}}Ra.NTc=!1;Ra.Xee=null;Object(n.a)(Ra,"SideCarLoader",null,[]);class gb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(n.a)(gb,"CloudPolicySettingsData",null,[]);class Bb{constructor(b,h){this.Lue=0;this.WDd=null;this.guc=new xa(b,h);this.Ma=b;h=b.jb("HostAuthType");this.Jvb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.b8g=F.b(b.jb("OcpsDefaultSettings")||"{}");this.zwc=
this.mQd();h=this.Ma.Sw("ServicesControlsMicrosoftControllerServicesList")?this.Ma.KC("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.fgd=new za.a;for(let v=0;v<h.length;v++)this.fgd.add(h[v]);this.Jvb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.WDd=this.MNo():this.WDd=this.Dkg(this.Jvb,this.rhb("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.yzn,"parseCloudPolicySettingsResponse"));this.WDd.then(()=>null).catch(v=>{v=Object(Ka.a)(sa,v);u.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",v?v.httpStatusCode.toString():"Unknown")})}m8(b,h=!0){if(!this.Jvb){const ba=this;return new Promise(ta=>{ta(ba.LOc(b))})}let v=this,D=this;const Q=this.WDd.then(ba=>{try{let ta=null;ba.PolicySettings&&"unknown"in ba.PolicySettings&&(ta=ba.PolicySettings.unknown);if(ta){if(b in ta&&void 0!==ta[b]&&null!==ta[b])return new Promise(ob=>{ob("0"!==ta[b])});const Ta=b.toLowerCase();if(Ta in ta&&void 0!==ta[Ta]&&null!==ta[Ta])return new Promise(ob=>
{ob("0"!==ta[Ta])});u.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(ob=>{ob(v.LOc(b))})}return new Promise(Ta=>{Ta(v.LOc(b))})}catch(ta){return u.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ta.message),v.handleError(ta.toString(),h,v.LOc(b))}},ba=>D.handleError(ba,h,D.LOc(b)));Q.then(ba=>{u.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ba);
return null});return Q}isFeatureEnabled(b,h=!0){if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.yJm(b,h);let v=new Promise(Q=>{Q(!0)}),D="";this.fgd.contains(b)&&(D="ControllerConnectedServicesEnabled",v=this.m8(D,h));v.then(Q=>{u.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,Q,D);return null});return v}yJm(b,h=!0){let v=new Promise(Q=>
{Q(!0)}),D="";"mso_sendASmile"===b?D="Enabled":"Survey"===b||"FloodgateSurvey"===b?D="SurveyEnabled":this.fgd.contains(b)&&(D="ControllerConnectedServicesEnabled");""!==D&&(v=this.m8(D,h));v.then(Q=>{u.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,Q,D);return null});return v}handleError(b,h,v){return h?new Promise(D=>{D(v)}):new Promise((D,Q)=>{Q(b)})}Dkg(b,h,v){if(!b)return Promise.resolve(new gb);let D=!1,Q=
null;wa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ba=this.E$e("GetCloudPolicySettings");return(new Promise((ta,Ta)=>{if(void 0!==this.zwc&&null!==this.zwc&&0<this.zwc.length){const ob=this.pNo();if(void 0!==ob&&null!==ob){D=!0;ta(ob);return}}this.guc.fIc(h,v,1,null,Object(z.a)(this,this.iHn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ma.mc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ma.mc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(ob=>{u.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.xOo(ob);ta(ob);return ob},ob=>{Ta(ob);return null})})).then(ta=>{({UA:ba,returnValue:Q}=this.Ije(ba));var Ta=kb.a.fG();Ta&&Ta.set("FromCache",D.toString());Ta=Object.assign(new wb.a,{durationMs:Q,extendedProperties:Ta});wa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ta);return ta})}MNo(){return Ra.zsj().then(()=>{u.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}rhb(b){return String.format("{0}{1}",this.Ma.jb("WebServiceBase"),b)}yzn(b){let h=null;({Yu:h}=F.d(b));b=!!h;u.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}iHn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.Lue=h)}}catch(h){u.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
h)}}LOc(b){return b in this.b8g?"0"!==this.b8g[b]:!0}pNo(){try{const b=eb.a.instance.getItem(this.zwc);if(void 0===b||null===b)return u.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;u.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return u.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return u.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return u.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const v=new gb;v.PolicySettings=h.PolicySettings;v.ControllerConnectedServicesFeatureNames=new zb.a;this.Ma.Sw("ServicesControlsMicrosoftControllerServicesList")&&
this.Ma.KC("ServicesControlsMicrosoftControllerServicesList");for(let D of this.fgd)v.ControllerConnectedServicesFeatureNames.add(D);u.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return v}catch(b){return u.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}xOo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)u.ULS.sendTraceTag(51662944,3004,15,
"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Lue)u.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new nb(b,this.Lue),v=JSON.stringify(h);u.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",v);eb.a.instance.setItem(this.zwc,v);u.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){u.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}mQd(){const b=cc.mQd(this.Ma);return b&&0<b.length?"OCPS"+b:null}E$e(b){const h=Ga.a.instance.Na("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==h&&null!==h?h.$f("WebServiceCall",b):null}Ije(b){if(void 0!==b&&null!==b){const h=b.ti;b.stop();return{returnValue:h,UA:null}}return{returnValue:null,UA:b}}}Object(n.a)(Bb,"CloudPolicySettingsHelper",null,[772]);class $b{constructor(){this.FTh=this.gIj=this.WI=
0;this.GTh=this.hIj=this.XAb="";this.DSe=this.lUa=2}clone(){const b=new $b;b.WI=this.WI;b.gIj=this.gIj;b.FTh=this.FTh;b.XAb=this.XAb;b.hIj=this.hIj;b.GTh=this.GTh;b.lUa=this.lUa;b.DSe=this.src;return b}get src(){return this.DSe}serialize(b=null){const h={};if(!b||b.contains($b.WJb))h[$b.WJb]=this.WI;if(!b||b.contains($b.XZc))h[$b.XZc]=this.XAb;if(!b||b.contains($b.YZc))h[$b.YZc]=this.lUa;return JSON.stringify(h)}static create(b,h=null){const v=new $b;v.DSe=b;void 0!==h&&null!==h&&($b.WJb in h&&(v.WI=
h[$b.WJb]),$b.XZc in h&&(v.XAb=h[$b.XZc]),$b.YZc in h&&(v.lUa=h[$b.YZc]));return v}static deserialize(b,h){try{const v=JSON.parse(b);if(void 0!==v&&null!==v)return $b.create(h,v);u.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(v){throw u.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",v.toString()),v;}}}$b.WJb="CCS";$b.XZc="CCSTime";$b.YZc="OfficePrivacyRoamedNoticeShown";
Object(n.a)($b,"UserPrivacySettings",null,[]);var Qb=c(154);class Ac{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=b;this.Yf=h;this.tRe=this.Vf=null}rhb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ma.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(w.AFrameworkApplication.hm);return h.toString()}executeRequest(b,h,v,
D=null){return this.Yf.k0b(b,h,D,null,v,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,v)=>{try{if(void 0===this.Vf||null===this.Vf||void 0===b||null===b)u.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),v("Can't determine setting changes to save");else{var D=this.Vf.WI!==b.WI;if(2===this.Vf.src&&D)this.u$n(b),h(!0);else{var Q=this.meo(b);if(void 0===Q||null===Q||!Q.length)u.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),
v("No changes to save");else if(1===this.Vf.src)h(this.sCj(Q));else if(0===this.Vf.src){u.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Q);const ba=this.executeRequest(this.rhb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Q);ba.continueWith(()=>{if(ba.zo||ba.Ci)u.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ta=ba.result;void 0!==ta.args&&null!==ta.args&&void 0!==ta.args.data&&
null!==ta.args.data&&ta.args.data.Qe===ha.a.Jy?(u.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(u.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ba){u.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ba.toString()),h(!1)}})}meo(b){if(void 0===this.Vf||null===this.Vf||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");
const h=new zb.a;0===b.src?(this.Vf.WI!==b.WI&&(h.add($b.WJb),h.add($b.XZc)),this.Vf.lUa!==b.lUa&&h.add($b.YZc)):1===b.src&&this.Vf.WI!==b.WI&&h.add($b.WJb);return h.count?b.serialize(h):(u.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.tRe){const b=this;this.tRe=new Promise(h=>{try{b.Vf?h(b.Vf.clone()):b.HNo().then(v=>{b.Vf=v;h(b.Vf.clone());return null},()=>{b.FNo().then(v=>{b.Vf=v;h(b.Vf.clone());return null},()=>{b.GNo().then(v=>
{b.Vf=v;h(b.Vf.clone());return null},()=>{u.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Vf=new $b;h(b.Vf.clone());return null});return null});return null})}catch(v){u.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",v.toString()),b.Vf=new $b,h(b.Vf.clone())}})}return this.tRe}HNo(){return new Promise((b,h)=>{try{const D=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ma.$("PrivacyDialogShouldCheckRoaming")||
D){var v=this.executeRequest(this.rhb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");v.continueWith(()=>{try{if(v.zo||v.Ci)u.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Q=v.result;if(Q&&Q.args&&Q.args.data)if(Q.args.data.Qe!==ha.a.Jy)u.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Q.args.data.Qe);else{if(Q.args.data.we){b(Ac.parse(Q.args.data.we,0));u.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Q.args.data.we);return}u.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else u.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Q){u.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
Q.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else u.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(D){u.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",D.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}FNo(){return new Promise((b,h)=>{try{const v=Qb.a.get("WacUPToggleState");let D=null;void 0!==v&&null!==
v&&0<v.length&&(D=decodeURIComponent(v));if(void 0!==D&&null!==D&&0<D.length){const Q=Ac.parse(D,1);u.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Q.toString());b(Q)}else{const Q=$b.create(1),ba=new zb.a;ba.add($b.WJb);const ta=Q.serialize(ba);this.sCj(ta)?(u.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ta),b(Q)):(u.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",
ta),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(v){u.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",v.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}GNo(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let v=$b.create(2);h?(v.WI=2,w.AFrameworkApplication.zRh(),u.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",
v.toString())):(v.WI=1,u.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",v.toString()));b(v)}catch(v){u.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",v.toString()),h=$b.create(2),h.WI=1,b(h)}})}u$n(b){u.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.WI?w.AFrameworkApplication.zRh():w.AFrameworkApplication.mtl();u.ULS.sendTraceTag(51258454,
3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}sCj(b){try{u.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ma.jb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");u.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Qb.a.Anj("WacUPToggleState",b,Qb.a.cRa,h)}catch(h){return u.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",
h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const v=this.Ma.Sw("ServicesControlsMicrosoftControllerServicesList")?this.Ma.KC("ServicesControlsMicrosoftControllerServicesList"):[],D=new za.a;for(let Q=0;Q<v.length;Q++)D.add(v[Q]);return D.contains(b)?2!==h.WI:!0},()=>{u.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return u.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
b,h),$b.deserialize(b,h)}catch(v){throw u.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",v.toString()),v;}}}Object(n.a)(Ac,"UserPrivacySettingsHelper",null,[773]);class Db{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}xc(b){this.W=b;this.W.register(772,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Rd(()=>new Bb(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(773,
"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Rd(()=>new Ac(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(774,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Rd(()=>new oa(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(775,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Rd(()=>new cc(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),
this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),w.AFrameworkApplication.va))}init(){w.AFrameworkApplication.K.Po(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");w.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{u.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,
w.AFrameworkApplication.K.jb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{u.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,w.AFrameworkApplication.K.jb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.fHo()})}dispose(){}fHo(){try{w.AFrameworkApplication.K.$("SideCarIsEnabled")&&Ra.zsj().then(b=>
{u.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){N.a.instance.Fc(new Db)}}Object(n.a)(Db,"ApplicationFeatureHelperPackage",null,[1,2]);var dc=c(169);class Pb{rQd(b,h){let v;const D=[];for(;v=h.exec(b);){const Q=v.index;D.push(new dc.a(Q,Q+v[0].length))}return D}isEndPuncSpecialCase(b){const h=this.rQd(b,Pb.fzo);for(const v of h)if(v.end===b.length)return!0;return!1}lLc(b){for(const h of Pb.Ixl){const v=
this.rQd(b,h);if(0<v.length&&!v[0].begin)return v[0].end-1}return 0}findBeginBoundary(b,h,v){var D=b.substring(v,h);b=this.rQd(D,Pb.yVh);for(h=b.length-1;0<=h;h--){const Q=D.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(Q))return D=D.substring(b[h].begin,D.length),v+b[h].end+this.lLc(D)}return v}findEndBoundary(b,h,v){var D=b.substring(h,v);b=this.rQd(D,Pb.yVh);for(v=0;v<b.length;v++){const Q=D.substring(0,b[v].end);if(!this.isEndPuncSpecialCase(Q))return D=D.substring(b[v].begin,D.length),
h+b[v].end+this.lLc(D)}return-1}}Pb.Kif="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";Pb.Lif="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
Pb.Mif="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Pb.Ixl=[new RegExp(Pb.Kif,"ig"),new RegExp(Pb.Lif,"ig"),new RegExp(Pb.Mif,"ig")];Pb.dfg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Pb.gfg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Pb.ffg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Pb.efg=Pb.gfg+"|"+Pb.ffg;Pb.hfg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Pb.ifg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Pb.jfg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Pb.kfg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Pb.l$f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Pb.efg+"|"+Pb.hfg+"|"+Pb.ifg+")";Pb.k$f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Pb.jfg+")";Pb.RQf=Pb.dfg+"|"+Pb.kfg;Pb.cfg=Pb.RQf+"|"+Pb.l$f+"|"+Pb.k$f;Pb.yVh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Pb.fzo=new RegExp(Pb.cfg,"g");Object(n.a)(Pb,"ProofingSentenceSeparatorScriptSharp",null,[771]);class Ub{Gcd(b,h){const v=[];let D;for(;null!=(D=h.exec(b));){const Q=D.index;v.push({begin:Q,end:Q+D[0].length})}return v}isEndPuncSpecialCase(b){return this.Gcd(b,Ub.zRj).some(h=>
h.end==b.length)}lLc(b){for(const h of Ub.RNj){const v=this.Gcd(b,h);if(0<v.length&&0==v[0].begin)return v[0].end-1}return 0}findBeginBoundary(b,h,v){var D=b.substring(v,h);b=this.Gcd(D,Ub.Qqg);for(h=b.length-1;0<=h;h--){const Q=D.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(Q))return D=D.substring(b[h].begin,D.length),v+b[h].end+this.lLc(D)}return v}findEndBoundary(b,h,v){var D=b.substring(h,v);b=this.Gcd(D,Ub.Qqg);for(v=0;v<b.length;v++){const Q=D.substring(0,b[v].end);if(!this.isEndPuncSpecialCase(Q))return D=
D.substring(b[v].begin,D.length),h+b[v].end+this.lLc(D)}return-1}}Ub.BMj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Ub.uRj="[\u2639\u263a\u263b]";Ub.atg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Ub.DNj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Ub.jQj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Ub.Atg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Ub.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Ub.$sg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Ub.fPj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Ub.ePj="[\uff21-\uff3a\uff41-\uff5a]";Ub.cPj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Ub.bPj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Ub.dPj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Ub.Ppe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Ub.Pqg="[\u3002\uff61]";Ub.$cd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Ub.YNj="[\u00bb\u2019\u201d\u203a\"']";Ub.iqe=Ub.BMj+"|"+Ub.uRj;Ub.gPj="[\u2028\u2029\n\r]";Ub.aPj="("+Ub.$cd+"|"+Ub.atg+"|"+Ub.Atg+"|"+Ub.$sg+
")";Ub.$Oj="("+Ub.$cd+"|"+Ub.atg+"|"+Ub.Atg+"|"+Ub.Symbol+"|"+Ub.$sg+"|"+Ub.DNj+"|"+Ub.jQj+")";Ub.Kif="("+Ub.Ppe+"("+Ub.iqe+"|"+Ub.YNj+"|"+Ub.$cd+")*"+Ub.gPj+")";Ub.Lif="("+Ub.Ppe+"("+Ub.iqe+")*("+Ub.$cd+")+)";Ub.Mif="("+Ub.Pqg+"("+Ub.iqe+")*)";Ub.RNj=[new RegExp(Ub.Kif,"ig"),new RegExp(Ub.Lif,"ig"),new RegExp(Ub.Mif,"ig")];Ub.dfg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Ub.gfg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Ub.ffg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Ub.efg=Ub.gfg+"|"+Ub.ffg;Ub.hfg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Ub.ifg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Ub.jfg="(("+Ub.fPj+"|"+Ub.cPj+"|"+Ub.dPj+")[.])+|(("+Ub.bPj+")[.\ufe52\uff0e])+";Ub.kfg="("+Ub.ePj+")[.\ufe52\uff0e]";Ub.l$f=Ub.aPj+"("+Ub.efg+"|"+Ub.hfg+"|"+Ub.ifg+")";Ub.k$f=Ub.$Oj+"("+Ub.jfg+")";Ub.RQf=Ub.dfg+"|"+Ub.kfg;Ub.cfg=Ub.RQf+"|"+Ub.l$f+"|"+Ub.k$f;Ub.Qqg=new RegExp(Ub.Ppe+"|"+Ub.Pqg,"ig");Ub.zRj=new RegExp(Ub.cfg,"g");Object(n.a)(Ub,"ProofingSentenceSeparator",null,[771]);class rb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}xc(b){this.W=b;w.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Ub).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Pb).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){N.a.instance.Fc(new rb)}}Object(n.a)(rb,"Box4GrammarCheckPackage",null,[1,2]);var Yb=c(96),Ya=c(9),Ob=c(61),vc=c(1817);class Sa{constructor(){this.W=null}get name(){return"Box4.AtMentions"}xc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>
new vc.a(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Ob.InteractiveViewManager.instance)).singleInstance()}init(){w.AFrameworkApplication.K.Po(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Pdb(Ya.App.xa.hb,Yb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){N.a.instance.Fc(new Sa)}}Object(n.a)(Sa,"Box4AtMentionsPackage",null,[1,
2]);class Ab{get name(){return"Box4.Workers"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Ab)}}Object(n.a)(Ab,"Box4WorkersPackage",null,[1,2]);var Fb=c(304),Va=c(77);class Wa{constructor(){this.bJa=new Va.a}d5(b,h){this.bJa.Z(b,h)}Qmf(b){({value:b}=this.bJa.Dc(b));return b}}Object(n.a)(Wa,"AggregationMethodsForActivityName",null,[]);var jb=c(248);class mc{constructor(){this.Frd=new Fb.a;this.bJa=new Fb.a}d5(b,h,v){this.bJa.nb(b)&&this.bJa.J(b)||this.bJa.Z(b,new Wa);this.bJa.J(b).d5(h,
v)}Qmf(b,h){return this.bJa.nb(b)&&this.bJa.J(b)?this.bJa.J(b).Qmf(h):null}dPc(b){this.Frd.nb(b)&&this.Frd.J(b)||this.Frd.Z(b,new jb.a);return this.Frd.J(b)}uOh(b,h){this.dPc(b).add(h)}}Object(n.a)(mc,"ActivityAggregationInfo",null,[784]);var yb=c(110),Oa=c(988),Gb=c(1011);class Wb extends Oa.a{constructor(b,h){super(b);this.QVe=(this.yUj=h)?h.tWl():Gb.a.Bmf()}get $Ba(){return this.yUj}get activityName(){return this.$Ba.name}get startTime(){return this.$Ba.startTime}get endTime(){return this.$Ba.endTime}end(){}cancel(){}tlf(){}nUo(){this.D6b.Z("AM",
this.$Ba.mode.toString());this.D6b.Z("C",this.$Ba.count.toString());this.D6b.Z("DA",this.$Ba.UTh.toFixed(2));this.D6b.Z("DV",this.$Ba.wrl.toFixed(2))}Xsf(b){return this.$Ba.Xsf(b)}Btf(){return this.$Ba.Btf()}q0b(){for(let b of this.$Ba.aCa)b.q0b()}}Object(n.a)(Wb,"AggregatedActivity",Oa.a,[]);class kc{constructor(b,h){this.hse=0;this.Aza=b;this.JUa=h}lAk(b,h){this.hse=h;for(h=0;h<b.count;h++){const v=b.J(h);this.mAk(v)}}mAk(b){const h=Object(Ka.a)(Wb,b);if(h)if(1===this.hse)this.kAk(h);else if(2===
this.hse){this.nAk(h);for(let v of this.JUa.dPc(this.Aza)){const D=h.$Ba.aCa.J(0);D.properties.nb(v)&&b.properties.Z(v,D.properties.J(v))}}}kAk(b){for(let h of this.JUa.dPc(this.Aza))this.pfj(b,h)}nAk(b){for(let h of b.Btf())this.pfj(b,h)}pfj(b,h){const v=this.JUa.Qmf(this.Aza,h);if(v){const D=b.Xsf(h);b.properties.Z(h,v(D))}}}Object(n.a)(kc,"PropertyAggregationHelper",null,[]);var Mb=c(1074);class Qc{constructor(b,h,v,D,Q){this.iSb=b;this.JUa=h;this.hPg=Q;this.Qre=D;this.L9j=v}get xmh(){return this.L9j.value}XGc(b){if(Object(yb.a)(Mb.a,
b))b.XGc();else if(Object(yb.a)(Wb,b)&&this.Qre.sAh(b.activityName.toString())){b=Object(Ka.a)(Wb,b);b.nUo();b=b.QLi();var h=[];Array.add(h,b);b=F.c(h);u.ULS.sendTraceTag(6907266,213,50,b)}}gCa(b,h){const v=(new Date).getTime();var D=this.hPg.list.J(b);const Q=({pAk:D}=this.OKl(D)).returnValue;this.hPg.list.Z(b,new zb.a);h&&(D=this.r7k(D,v,this.iSb.aki));0<D.count&&(new kc(b,this.JUa)).lAk(D,Q)}r7k(b,h,v){const D=new zb.a;for(let Q=0;Q<b.count;Q++){const ba=b.J(Q);ba.startTime>h-v?ba.q0b():D.add(ba)}return D}OKl(b){const h=
this.xmh.Fyj(b);b=this.xmh.CIo(b);const v=this.qAk(h,b);return{returnValue:v,pAk:1===v?h:b}}qAk(b,h){return b.count*this.iSb.lOi<h.count?1:2}get enabled(){return this.iSb.enabled}q0b(){}}Object(n.a)(Qc,"ActivityAggregationManager",null,[783]);class Ic{constructor(b){this.enabled=!1;this.AMi=500;this.RNi=2;this.lOi=5;this.aki=3E4;this.vLc(b.appSettings)}vLc(b){this.enabled=Boolean.parse(b[Ic.ehf]||"false");this.AMi=parseInt(b[Ic.ban]||"500");this.RNi=parseInt(b[Ic.Kcn]||"2");this.lOi=parseInt(b[Ic.idn]||
"5");this.aki=parseInt(b[Ic.Wjm]||"30000")}}Ic.ehf="ActivityAggregationEnabled";Ic.ban="ActivityAggregationMaxInterval";Ic.Kcn="ActivityAggregationMinChain";Ic.idn="ActivityAggregationModeFactor";Ic.Wjm="ActivityAggregationGraceWindow";Object(n.a)(Ic,"ActivityAggregationParams",null,[]);class Ed{constructor(b,h){this.JUa=b;this.wKg=h}Fyj(b,h=1){if(!b||!b.count)return b;const v=new zb.a;var D=null;for(let Q=0;Q<b.count;Q++){const ba=b.J(Q);if(!ba)continue;const ta=ba.activityName;D?D.BUm(ba)?D.add(ba):
(D=D.process(),v.addRange(D),D=this.wKg(ta,h),D.add(ba)):(D=this.wKg(ta,h),D.add(ba))}D&&(b=D.process(),v.addRange(b));return v}CIo(b){if(!b||!b.count)return b;const h={};var v=null;for(let Q=0;Q<b.count;Q++){const ba=b.J(Q);if(ba){if(!v){v=new zb.a;var D=this.JUa.dPc(ba.activityName);for(let ta of D)v.add(ta)}D=this.f9l(ba,v);null!==D&&(D in h&&h[D]||(h[D]=new zb.a),h[D].add(ba))}}b=new zb.a;for(const Q of lb.a.HO(h))v=this.Fyj(h[Q],2),b.addRange(v);return b}f9l(b,h){let v="";for(let D of h)v+=D,
v=b.properties.nb(D)&&void 0!==b.properties.J(D)&&null!==b.properties.J(D)?v+b.properties.J(D):v+"null";return v}}Object(n.a)(Ed,"ActivityAggregationSchemes",null,[782]);class me{constructor(b,h,v,D,Q){this.Yr=this.ii=0;this.iSb=v;this.soc=D;this.JUa=Q;this.name=b;this.Qy=h;this.aCa=new zb.a}get mode(){return this.Qy}get count(){return this.aCa.count}get startTime(){return this.ii}get endTime(){return this.Yr}get UTh(){if(!this.count)return 0;let b=0;for(let h of this.aCa)b+=h.endTime-h.startTime;
return b/this.count}get wrl(){if(!this.count)return 0;let b=0;const h=this.UTh;for(let v of this.aCa){const D=v.endTime-v.startTime;b+=(D-h)*(D-h)}return b/this.count}add(b){this.count?this.Yr=b.endTime>this.endTime?b.endTime:this.endTime:(this.ii=b.startTime,this.Yr=b.endTime);this.aCa.add(b)}BUm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.iSb.AMi}process(){if(this.count>=this.iSb.RNi){const b=new zb.a,h=this.soc(this);b.add(h);return b}return this.aCa}Xsf(b){const h=new zb.a;for(let v of this.aCa)if(v.properties.nb(b)){const D=
v.properties.J(b);h.add(D)}else h.add(null);return h}Btf(){const b=this.JUa.dPc(this.name),h=new jb.a;for(let v of this.rLl())b.contains(v)||h.add(v);return h}rLl(){const b=new jb.a;if(!this.aCa)return b;for(let h of this.aCa)for(let v of h.properties.keys)b.add(v);return b}tWl(){return this.aCa.J(0).uniqueID}}Object(n.a)(me,"ActivityCollection",null,[785]);class Be{constructor(){this.Srb=new Fb.a}get list(){return this.Srb}add(b){const h=b.activityName;if(this.Srb.nb(h)&&this.Srb.J(h)){const v=this.DZl(this.Srb.J(h),
b);this.Srb.J(h).insert(v,b)}else this.Srb.Z(h,new zb.a),this.Srb.J(h).add(b)}DZl(b,h){for(let v=b.count-1;0<=v;v--)if(h.startTime>b.J(v).startTime)return v+1;return 0}}Object(n.a)(Be,"CompletedActivitiesHelper",null,[781]);class ad{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){w.AFrameworkApplication.dI(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}xc(b){this.W=b;const h=D=>new Wb(()=>b.Na("Common.App.Activities.IActivityAggregationManager"),
D),v=(D,Q)=>new me(D,Q,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Qc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Rd(()=>new Qc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ue("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Ic,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Rd(()=>new Ic(w.AFrameworkApplication.K));b.register(mc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Rd(()=>new mc);b.register(Ed,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Rd(()=>
new Ed(b.resolve("Common.IActivityAggregationInfo"),v));b.register(Be,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Rd(()=>new Be)}static main(){N.a.instance.Fc(new ad)}}Object(n.a)(ad,"ActivityAggregatorPackage",null,[1,2]);var Nc=c(526),Sc=c(11),Gc=c(1388);class ie{constructor(b){this.Sah=0;this.Iue=null;this.Pfk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get pcg(){return this.Pfk.value}Tb(){this.isInitialized?this.Ogc():this.FVn(Object(z.a)(this,
this.Ogc,"registerActionsInternal"))}Ogc(){u.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.Zkn,"onChatContainerReady"))}).catch(b=>{u.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.lUk,"chatCountChanged"))}).catch(b=>{u.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",
b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(z.a)(this,this.bln,"onChatKeyPress"))}).catch(b=>{u.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){u.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}lUk(b){u.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.pcg.Ykn();else if(1===b&&!this.Sah){const h=document.getElementById(this.Iue?this.Iue:Gc.a.tAb);h?this.pcg.cln(h,Object(z.a)(this,this.mLo,"transferFocusToChat")):
u.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.Sah=b}Zkn(b){this.Iue=b}bln(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.lLo(b.shiftKey)}FVn(b){Nc.a.instance.mb(Sc.a.vEo,window.self,()=>{b();return!0})}mLo(){u.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{u.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){u.ULS.sendTraceTag(50595974,
333,10,"Failed to transfer focus to chat: {0}",b)}}lLo(b){u.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.pcg.$kn(b)}}Object(n.a)(ie,"ChatManager",null,[778]);var cf=c(80);class Ge{constructor(){this.ra=new cf.a;this.kmk=!1}Qxk(b){this.ra.addHandler("OnTopRowControlsCreatedEvent",b)}Bxk(b){this.ra.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get gKo(){return this.kmk}I5i(b){this.ra.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(n.a)(Ge,
"HeaderEventSource",null,[]);var gf=c(166),Ie=c(332),zf=c(79);class uc{constructor(b,h,v,D,Q){this.Hwd=null;this.Ub=b;this.fp=h;this.qk=v;this.nmk=D;this.ga=Q}q8i(b,h,v,D=null){const Q=this.Ub.fe(h);Q.parent=v;Q.TH=!0;D&&Q.k7(D);this.qk.bCa(h,b,!1);this.nmk.bCa(h,b,!1);h=new Ie.DOMFocusListing(()=>b);h.Xm(2);h.Xm(1);h.Xm(8);h.Xm(5);h.Xm(3);h.Xm(6);this.Ub.ema(()=>b,Q,h).oR=!0;h=Yb.KeyInputManager.kc(zf.a.Aw,0);v=Yb.KeyInputManager.kc(zf.a.Aw,4);Q.ir(h);Q.ir(v)}onFlexPaneOpen(b){this.q8i(b,Gc.a.udc,
Gc.a.vPa);this.Ub.mg(Gc.a.udc);this.fp.Eaa(Gc.a.udc)}onFlexPaneClose(){this.fp.Ww(Gc.a.udc);this.Ub.mg(Gc.a.vPa)}cln(b,h){this.Hwd||(this.Hwd=h,this.q8i(b,Gc.a.tAb,gf.AFrame.eM,Object(z.a)(this,this.aln,"onChatFocus")));this.Ub.mg(Gc.a.tAb);this.fp.Eaa(Gc.a.tAb)}aln(){this.Hwd&&this.Hwd()}Ykn(){this.fp.Ww(Gc.a.tAb);this.Ub.VMd(gf.AFrame.Pn)}$kn(b){this.ga.processAction(b?Ua.a.cjf:Ua.a.Rpe,2)}}Object(n.a)(uc,"ReactSharedHeaderFocusManager",null,[777]);var Rc=c(126),Dd=c(1046),Id=c(39),Kd=c(67);class af{constructor(b){this.ga=
b}Tb(){this.ga.qa(Ua.a.fNd,Kd.a.frame,Object(z.a)(this,this.yPi,"navigateToUpsellPage"));this.ga.qa(Ua.a.RHl,Kd.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.qa(Ua.a.w3n,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.$bj,Kd.a.frame,Rc.ActionManager.Pf)}yPi(b,h,v,D,Q){if(1===v)return 32;b=8;2===v&&(v=this.dof(Q,"experience","gopremiumribbon"),Q=ja.a.q8("2116536"),Q=ja.a.fo(Q,"ocid",Dd.b(w.AFrameworkApplication.ta.Nb.Sl,w.AFrameworkApplication.ta.Nb.Sha,v)),
Id.a.om(Q,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(Ua.a.$bj,2),u.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,v,D,Q){if(1===v)return 32;var ba=8;2===v&&(u.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ba=Ga.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.dof(Q,"experience","gopremium"),Q=this.dof(Q,"dimeCampaignId",null),ba.launchUpsellExperience(b,Q),ba=32):
(u.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ba=this.yPi(b,h,v,D,Q)));return ba}dof(b,h,v){b&&b[h]&&(v=Object(Ka.a)(String,b[h]));return v}}Object(n.a)(af,"UpsellActor",null,[776]);class Dg{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ga.a.instance.resolve("Common.App.Header.IUpsellActor").Tb();Ga.a.instance.resolve("Common.App.Header.IChatManager").Tb()}dispose(){}xc(b){this.W=b;this.W.register(Ge,"Common.App.Header.HeaderEventSource").singleInstance();
this.W.register(af,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Rd(()=>new af(w.AFrameworkApplication.va));this.W.register(uc,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Rd(()=>new uc(w.AFrameworkApplication.ta.Dp,w.AFrameworkApplication.ta.nx,w.AFrameworkApplication.ta.f1,w.AFrameworkApplication.ta.ile,w.AFrameworkApplication.va));this.W.register(ie,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Rd(()=>
new ie(this.W.Ue("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){N.a.instance.Fc(new Dg)}}Object(n.a)(Dg,"CommonAppHeaderPackage",null,[1,2]);var oi=c(746);class zg{static N3h(b,h){switch(b){case 3:return zg.Rim(h);case 2:return zg.G5l(h);case 1:return zg.cVl(h)}return""}static Rim(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static G5l(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static cVl(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,v){if(aa.a.ui||aa.a.CM)window.setTimeout(()=>{zg.G7i(v,zg.JSd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(zg.lsh(v),b,0,!1)}static MYk(b,h,v,D){h&&
D&&D();zg.openInClient(b,h,v)}static JSd(){return aa.a.ui?1:aa.a.CM?2:aa.a.v3a?3:aa.a.fl?4:0}static xim(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static yim(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get iEf(){return"zh-CN"===window.navigator.language}static G7i(b,h){1===h?(u.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=zg.N3h(b,h),8<aa.a.Y1a?Id.a.om(b,void 0,void 0,"RedirectToAppStore"):Id.a.oDb(b)):document.hidden||(zg.iEf?(b=w.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(u.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Id.a.oDb(b)):u.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(u.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(zg.N3h(b,
h),null,null)))}static lsh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Xhe(){return(aa.a.v3a||aa.a.fl)&&aa.a.zq}static get Tso(){return aa.a.ui||aa.a.CM}static g4h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static iyi(b){return(b=zg.w_l(b))&&""!==b?Boolean.parse(b):!1}static Jbg(b){zg.Jio(b)}static w_l(b){try{return localStorage.getItem(b)}catch(h){return u.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static Jio(b){try{localStorage.setItem(b,"true")}catch(h){u.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}zg.bDh="ChromeExtensionBarDismiss";Object(n.a)(zg,"WildFireUtilities",null,[]);var ec=c(365);class Bc{constructor(){this.zse=new ec.a;this.xse=new ec.a;this.wse=new ec.a;this.$Lk(this.zse);this.ZLk(this.xse);this.YLk(this.wse);this.bDe=new ec.a;
this.aDe=new ec.a;this.$Ce=new ec.a;this.GOk(this.bDe);this.FOk(this.aDe);this.EOk(this.$Ce);this.$ue=new ec.a;this.mMk(this.$ue);this.Vyb(this.$ue);this.Vyb(this.wse);this.Vyb(this.xse);this.Vyb(this.zse);this.Vyb(this.aDe);this.Vyb(this.bDe);this.Vyb(this.$Ce)}VRd(b,h){switch(b){case 1:return this.Hjm(h);case 2:return this.QLl(h)}return zg.Xhe?this.$ue:null}$Lk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}ZLk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}YLk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}GOk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}mMk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}FOk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}EOk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}Vyb(b){b.add("Corporation","Microsoft Corporation")}Hjm(b){switch(b){case 3:return this.bDe;case 2:return this.aDe;case 1:return this.$Ce}return null}QLl(b){switch(b){case 3:return this.zse;case 2:return this.xse;case 1:return this.wse}return null}static get instance(){Bc._instance||
(Bc._instance=new Bc);return Bc._instance}}Bc._instance=null;Object(n.a)(Bc,"WildFireStringFactory",null,[]);class Vc{constructor(b,h,v,D,Q=null,ba=null){this.ULe=null;this._id=b;this.wNe=h;this.r4j=Q;this.Zuc=D;this.nAc=ba;this.Y8a=null;this.GCc=v;this.wBc=Bc.instance.VRd(h,b)}D8k(){this.Y8a=new oi.a(this.title,this.message,null);this.Y8a.addButton(this.XOk,Object(z.a)(this,this.Gkn,"onButtonOneClick"),"");this.GCc&&this.Y8a.Foh(this.cPk,Object(z.a)(this,this.Lkn,"onButtonTwoClick"));this.Y8a.nma=
Object(z.a)(this,this.ynl,"dismissBar");this.Y8a.image=3;this.Y8a.id=16;this.Y8a.closeable=!0}get title(){return this.wBc.J("Headline")}get message(){return this.wBc.J("CallToAction")}get XOk(){return this.GCc?this.wBc.J("InstallButton"):this.wBc.J("UseAppButton")}get cPk(){return this.GCc?this.wBc.J("OpenAppButton"):""}Gkn(){this.GCc?this.uCm():this.yZo()}Lkn(){this.GCc&&this.svn()}get zyh(){return this.Y8a}get L4a(){this.ULe||(this.ULe=this.r4j());return this.ULe}uCm(){u.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.Zuc&&this.nAc&&this.nAc();zg.G7i(this._id,this.wNe)}svn(){this.L4a&&(u.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Zuc&&this.nAc&&this.nAc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(zg.lsh(this._id),this.L4a,0,!1))}yZo(){zg.Xhe?this.TOk():(u.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),zg.Jbg("BizBarClicked"),1!==this.wNe&&2!==this.wNe||zg.MYk(this.L4a,this.Zuc,this._id,this.nAc))}TOk(){this.Zuc?
u.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):u.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Id.a.oDb(w.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}znl(){this.Zuc?u.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):u.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");zg.Jbg(zg.bDh)}ynl(){zg.Xhe?this.znl():(zg.Jbg(zg.g4h(this._id)),u.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static sbf(){const b=w.AFrameworkApplication.ta.Nb;
new Vc(b.Sl,zg.JSd(),8<aa.a.Y1a,1===b.Sha,()=>b.Dfa,b.K8f());u.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(n.a)(Vc,"WildFireBusinessBar",null,[]);class xd{get name(){return"Common.App.WildFire"}qYe(b){const h=w.AFrameworkApplication.ta.Nb;let v=!1;b&&(b.D8k(),b.zyh&&(v=h.Jla(b.zyh,!0)));return v}I8k(){var b=w.AFrameworkApplication.ta.Nb;b=new Vc(b.Sl,zg.JSd(),!1,1===b.Sha);this.qYe(b)&&u.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}sbf(b,h,v,D,Q,ba){b=new Vc(b,
v,D,h,Q,ba);this.qYe(b)&&u.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Hel(){const b=w.AFrameworkApplication.ta.Nb;var h=w.AFrameworkApplication.K;const v=b.Sl,D=1===b.Sha;if(h.$(zg.xim(v))){var Q=zg.JSd(),ba=8<aa.a.Y1a;if(2!==v||2!==Q||!D){h=h.$(zg.yim(v));var ta=b.K8f(),Ta=()=>b.Dfa;h&&!zg.iyi(zg.g4h(v))&&this.sbf(v,D,Q,ba,Ta,ta)}}}init(){var b=w.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;zg.Xhe&&b&&!zg.iyi(zg.bDh)?
this.I8k():(document.body&&zg.Tso&&this.Hel(),w.AFrameworkApplication.va.qa(Ua.a.BIf,Kd.a.frame,Object(z.a)(this,this.BIf,"launchWildFireBusinessBar")))}BIf(b,h,v,D,Q){if(1===v)return 32;if(!Q)return 8;this.sbf(Q.app,Q.mode,Q.platform,Q.useTwoButton,null,null);return 32}dispose(){}xc(){}static main(){N.a.instance.Fc(new xd)}}Object(n.a)(xd,"PackageManager",null,[1,2]);class ee{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(ee,"BrowserInfo",null,[]);class Me{constructor(){this.Version=
this.Name=null}}Object(n.a)(Me,"PluginInfo",null,[]);class De{static sca(){if(w.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=De.nIl();try{const h=JSON.stringify(b);u.ULS.sendTraceTag(6903563,102,50,h)}catch(h){u.ULS.sendTraceTag(6903564,102,15,h.message)}}else u.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static M7l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let v=0;v<b.length;v++){const D=b[v].name,Q=b[v].version;
Array.add(h,Object.assign(new Me,{Name:D,Version:Q}))}return h}static nIl(){const b=new ee,h=new Sys.StringBuilder;De.KH(v=>{b.DocElemClientHeight=v},()=>document.documentElement.clientHeight,h);De.KH(v=>{b.DocElemClientWidth=v},()=>document.documentElement.clientWidth,h);De.KH(v=>{b.DocElemOffsetHeight=v},()=>document.documentElement.offsetHeight,h);De.KH(v=>{b.DocElemOffsetWidth=v},()=>document.documentElement.offsetWidth,h);De.KH(v=>{b.ScreenAvailHeight=v},()=>window.screen.availHeight,h);De.KH(v=>
{b.ScreenAvailWidth=v},()=>window.screen.availWidth,h);De.KH(v=>{b.ScreenWidth=v},()=>window.screen.width,h);De.KH(v=>{b.ScreenHeight=v},()=>window.screen.height,h);De.KH(v=>{b.ScreenLogicalXdpi=v},()=>window.screen.logicalXDPI,h);De.KH(v=>{b.ScreenLogicalYdpi=v},()=>window.screen.logicalYDPI,h);De.KH(v=>{b.ScreenDeviceXdpi=v},()=>window.screen.deviceXDPI,h);De.KH(v=>{b.ScreenDeviceYdpi=v},()=>window.screen.deviceYDPI,h);De.KH(v=>{b.WinInnerHeight=v},()=>window.self.innerHeight,h);De.KH(v=>{b.WinInnerWidth=
v},()=>window.self.innerWidth,h);De.KH(v=>{b.WinOuterHeight=v},()=>window.self.outerHeight,h);De.KH(v=>{b.WinOuterWidth=v},()=>window.self.outerWidth,h);De.KH(v=>{b.WinOrientation=v},()=>window.self.orientation,h);De.KH(v=>{b.WinDevicePixelRatio=v},()=>window.self.devicePixelRatio,h);De.KH(v=>{b.SupportsTouch=v},()=>aa.a.y9c,h);De.KH(v=>{b.NavAppName=v},()=>window.navigator.appName,h);De.KH(v=>{b.NavAppVersion=v},()=>window.navigator.appVersion,h);De.KH(v=>{b.NavLanguage=v},()=>window.navigator.browserLanguage||
window.navigator.language,h);De.KH(v=>{b.NavUserAgent=v},()=>window.navigator.userAgent,h);De.KH(v=>{b.NavPlatform=v},()=>window.navigator.platform,h);De.KH(v=>{b.NavPlugins=v},De.M7l,h);De.KH(v=>{b.CalculatedDevicePixelRatio=v},()=>De.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static KH(b,h,v){try{const D=h();b(D)}catch(D){v.isEmpty()||v.append(" | "),v.append(D.message||
"null")}}}Object(n.a)(De,"BrowserInfoLogger",null,[]);class oe{get name(){return"Common.App.BrowserInfoLogger"}xc(){}init(){De.sca()}dispose(){}static main(){N.a.instance.Fc(new oe)}}Object(n.a)(oe,"BrowserInfoLoggerPackage",null,[1,2]);class nf{constructor(){this.ra=new cf.a}sdb(b){this.ra.addHandler("OnEditHappenedEvent",b)}o4c(b){this.ra.removeHandler("OnEditHappenedEvent",b)}KMn(){this.ra.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(nf,"EditNotificationEventSource",null,[]);var Qe=c(44),of=
c(91);class mf{constructor(b,h,v,D,Q,ba,ta=0){this.Zye=!1;this.Yye=this.Hvb=null;this.ikh=!1;this.Hb=h;this.opd=b;this.fab=v;this.dea=D;this.gkh=Q;this.a1j=ba;this.Hhd=0;this.Njd=!1;try{0<ta&&(this.Hhd=ta,3E5>this.Hhd&&(this.Hhd=3E5),this.Hb&&!this.Yye&&(this.Yye=new of.a(3,2,this.Hhd,Object(z.a)(this,this.q3n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Hb.Wb(this.Yye)))}catch(Ta){u.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Ta)}}get Fng(){return this.ikh}editHappened(){this.Fng?this.Njd=!0:(this.ikh=!0,wa.Health.instance.addQosPillar("Save"),wa.Health.instance.addQosPillar("ContentCreation"),Qe.c(Ua.a.editDocument));this.Zye=!0;this.gkh&&this.gkh.Amh();this.dea&&this.dea.KMn();w.AFrameworkApplication.Kg&&w.AFrameworkApplication.Kg.J9m();this.a1j&&!this.Hvb&&(this.q6c(null),this.Hvb=new of.a(3,2,this.opd,Object(z.a)(this,this.q6c,"sendPostMessageIfNecessary"),113),this.Hb.Wb(this.Hvb))}q6c(){this.Zye&&(this.fab.CWR(()=>
this.fab.result.sendMessage(L.a.editNotification,null)),u.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Zye=!1)}q3n(){try{this.Njd&&(Qe.c(Ua.a.editDocument),this.Njd=!1)}catch(b){this.Njd=!1,u.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(n.a)(mf,"EditNotificationManager",null,[787]);class jg{constructor(b,h,v,D,Q){this.bCe=this.Hvb=null;this.kVb=this.Lre=!1;this.Hb=h;this.opd=
b;this.fab=v;this.qk=D;this.nLe=Q;this.x8i(null)}x8i(){const b=document.getElementById(w.AFrameworkApplication.Z0b);!this.kVb&&this.qk&&b&&(this.qk.mb(Sc.a.p0,b,Object(z.a)(this,this.qNf,"mouseActivityHandler"),null),this.kVb=!0);this.nLe(()=>{this.dispose()})}qNf(){this.kVb&&(this.qk.uc(Sc.a.p0,document.getElementById(w.AFrameworkApplication.Z0b),Object(z.a)(this,this.qNf,"mouseActivityHandler")),this.kVb=!1);this.Amh();return!1}Amh(){this.Lre=!0;this.bCe||(this.bCe=new of.a(3,2,this.opd,Object(z.a)(this,
this.x8i,"registerHandlerTask"),112),this.Hb.Wb(this.bCe));this.Hvb||(this.q6c(null),this.Hvb=new of.a(3,2,this.opd,Object(z.a)(this,this.q6c,"sendPostMessageIfNecessary"),111),this.Hb.Wb(this.Hvb))}q6c(){this.Lre&&(this.fab.CWR(()=>this.fab.result.sendMessage(L.a.ZZo,null)),u.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Lre=!1)}dispose(){this.kVb&&(this.qk.uc(Sc.a.p0,document.getElementById(w.AFrameworkApplication.Z0b),Object(z.a)(this,
this.qNf,"mouseActivityHandler")),this.kVb=!1)}}Object(n.a)(jg,"UserActivityHostNotificationManager",null,[786,10]);var pf=c(188),xb=c(106),Tb=c(626);class Xc{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){Xc.Qrl&&0<Xc.sgf&&(this.W.register(nf,"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(jg,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Rd(()=>
new jg(6E4,xb.a.instance,Tb.a.Bp(this.W.Sa("Postmessage.IHostPostmessenger")),pf.a.instance,w.AFrameworkApplication.dI)),this.W.register(mf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Rd(()=>new mf(Xc.sgf,xb.a.instance,Tb.a.Bp(this.W.Sa("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Na("Common.Interface.IUserActivityHostNotificationManager"),Xc.Rrl,Xc.Krl)),
this.W.resolve("Common.Interface.IEditNotificationManager"),u.ULS.shipAssertTag(38086291,209,0<Xc.sgf,"EditNotification Interval is less than or equal to 0."))}xc(b){this.W=b}dispose(){}static get sgf(){return w.AFrameworkApplication.K?parseInt(w.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get Krl(){return w.AFrameworkApplication.K?parseInt(w.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get Qrl(){return!!w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get Rrl(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){N.a.instance.Fc(new Xc)}}Object(n.a)(Xc,"CommonHostNotificationPackage",null,[1,2]);class Fd{constructor(b,h,v){this.Axb=null;this.Hb=b;this.ga=h;this.kVg=v.create()}rnb(){this.Axb?u.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(u.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.Axb=new of.a(2,1,3E4,Object(z.a)(this,this.jie,"showFloatPane"),67),this.Hb.Wb(this.Axb))}jie(){this.Axb=null;u.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.kVg.display()}lSa(){this.ga.qa(Ua.a.jie,Kd.a.frame,Object(z.a)(this,this.cvo,"showFloatPaneHandler"))}cvo(b,h,v,D,Q){return b!==Ua.a.jie?2:1===v?32:2===v&&Q?(u.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Q),Q?this.rnb():(this.Axb?(u.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Hb.We(this.Axb)):(u.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.kVg.remove(null)),this.Axb=null),32):8}}Object(n.a)(Fd,"FloatPaneActor",null,[789]);var Se=c(95),pd=c(88),lf=c(38),Ze=c(26);class Vg{constructor(b,h,v,D,Q){this.FIe=this.Vtc=this.psd=this.EXa=this.Eea=this.XUa=this.Rte=this.eaa=this.Ayc=this.uwc=this.vwc=this.HAe=null;this.Hb=h;this.Ma=b;this.ig=v;this.W=Q;this.Eza=D}sKh(){this.eaa=document.createElement("div");
this.eaa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.eaa.style.width=this.Eea.width+"px";(this.FIe=this.D4l(this.Eza))?(this.EXa=document.createElement("a"),this.EXa.setAttribute(Ze.a.qh,Ze.a.$y),this.ig.mb(Sc.a.click,this.EXa,Object(z.a)(this,this.eWi,"onRedirectClick")),this.EXa.href=this.FIe,this.EXa.target="_blank",this.EXa.appendChild(this.Eea),this.eaa.appendChild(this.EXa)):this.eaa.appendChild(this.Eea);this.XUa=document.createElement("a");this.XUa.setAttribute(Ze.a.qh,
Ze.a.f3);this.XUa.className="StandardButton WACFloatPaneCloseButton";this.XUa.title=CommonUIStrings.l_Close;this.XUa.tabIndex=-1;this.Rte=pd.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Rte.setAttribute(Ze.a.qh,Ze.a.$y);this.XUa.appendChild(this.Rte);this.ig.mb(Sc.a.click,this.XUa,Object(z.a)(this,this.onClose,"onClose"));this.eaa.appendChild(this.XUa);this.Ayc.appendChild(this.eaa)}oZl(b){const h=this.Ma.$("O365PromotionHasStarted");
switch(b){case 2:return Se.a.Yaa(String.format("adppt{0}.png",h?"sale":""));case 1:return Se.a.Yaa(String.format("adxls{0}.png",h?"sale":""));case 3:return Se.a.Yaa(String.format("addoc{0}.png",h?"sale":""))}return null}D4l(b){const h=this.Ma.jb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.Vtc=null;this.eaa&&!this.psd&&(b?u.ULS.sendTraceTag(23674904,207,50,
"The float pane is closed automatically."):u.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.eaa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.eaa.style.height="0px",this.psd=new of.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Hb.Wb(this.psd))}remove(){this.eaa&&this.Ayc&&(this.EXa&&this.ig.uc(Sc.a.click,this.EXa,Object(z.a)(this,this.eWi,"onRedirectClick")),this.ig.uc(Sc.a.click,this.XUa,Object(z.a)(this,this.onClose,
"onClose")),this.Ayc.removeChild(this.eaa),this.eaa=null);this.psd=null}display(){if(this.HAe=this.W.Na("Common.IFloatPaneContainer"))if(this.Ayc=this.HAe.container){var b=this.oZl(this.Eza);b?(u.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Eea=document.createElement("img"),this.Eea.className="WACFloatPaneImage",this.vwc=Object(z.a)(this,this.ppn,"onLoadImageFinish"),lf.a.addHandler(this.Eea,Sc.a.load,this.vwc),this.uwc=Object(z.a)(this,this.opn,"onLoadImageError"),
lf.a.addHandler(this.Eea,Sc.a.error,this.uwc),this.Eea.src=b):u.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else u.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else u.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}ppn(){const b=this.Ma.mc("O365AdPaneShowingDuration",60);this.sKh();this.eaa.style.display="block";this.eaa.style.height=this.Eea.height+
"px";this.Vtc=new of.a(2,1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Hb.Wb(this.Vtc);this.d$i()}opn(){u.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.d$i();this.Eea=null}d$i(){this.vwc&&this.Eea&&lf.a.removeHandler(this.Eea,Sc.a.load,this.vwc);this.vwc=null;this.uwc&&this.Eea&&lf.a.removeHandler(this.Eea,Sc.a.error,this.uwc);this.uwc=null}eWi(){u.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");
return!1}onClose(){this.Vtc&&this.Hb.We(this.Vtc);this.hide();return!0}dispose(){this.hide()}}Object(n.a)(Vg,"FloatPane",null,[798]);class Pi{constructor(b,h,v,D,Q){this.Hb=h;this.Ma=b;this.ig=v;this.W=Q;this.Eza=D}create(){return new Vg(this.Ma,this.Hb,this.ig,this.Eza,this.W)}}Object(n.a)(Pi,"FloatPaneFactory",null,[788]);var Sh=c(230);class wh{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get Dwi(){return w.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&w.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.Dwi&&
(u.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").rnb(),u.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").lSa())}xc(b){this.W=b;this.Dwi&&(this.W.register(Pi,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Rd(()=>new Pi(w.AFrameworkApplication.K,w.AFrameworkApplication.pc,Sh.a.instance,w.AFrameworkApplication.ta.Nb.Sl,
this.W)).singleInstance(),this.W.register(Fd,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Rd(()=>new Fd(w.AFrameworkApplication.pc,w.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){N.a.instance.Fc(new wh)}}Object(n.a)(wh,"FloatPanePackage",null,[1,2]);var rm=c(1651);class xf{}Object(n.a)(xf,"LokiTokenResult",null,[]);class lg{constructor(b){this.xpd=b}xrf(){const b=this.E1l();return b?
lg.h3a?new Promise((h,v)=>{this.xpd.continueWith(()=>{this.xpd.zo||this.xpd.Ci?v(Error.create("Error downloading auth library")):this.xpd.result.PY("Loki",b).then(D=>{D=w.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.H1l():D.IsSuccess&&D.Token?Object.assign(new xf,{isSuccess:!0,token:D.Token,errorMessage:null}):Object.assign(new xf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(D)});h(D);return D})})}):Promise.resolve(Object.assign(new xf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new xf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",rm.a.V3h())}))}H1l(){const b=w.AFrameworkApplication.K.jb("LokiUserDataSignature")||"";return Object.assign(new xf,{isSuccess:!0,token:b,errorMessage:null})}E1l(){let b=null;const h=rm.a.GNd();2===h?b=w.AFrameworkApplication.K.jb("LokiAADAppId"):1===h&&(b=w.AFrameworkApplication.K.jb("LokiMSAAppId"));return b}static get h3a(){return w.AFrameworkApplication.K.$("IsO365CommercialHost")||
w.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(n.a)(lg,"LokiTokenManager",null,[780]);class nd{get name(){return"Common.App.LivePersonaUtils"}init(){Ga.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}xc(b){b.register(lg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Rd(()=>new lg(Tb.a.Bp(b.Sa("Common.App.OAuth.IOAuthManager"))))}static main(){N.a.instance.Fc(new nd)}}Object(n.a)(nd,"LivePersonaUtilsPackage",null,[1,2]);class ud{constructor(b){this.rse=
b}Mvi(b){if(!this.rse)return!0;b=ja.a.vqf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.rse.length;h++)if(b.endsWith(this.rse[h]))return!0;return!1}}Object(n.a)(ud,"DomainAllowListManager",null,[]);class Bd{constructor(b,h){this.mcf=null;this.QUe=b;this.url=h}get lng(){return ja.a.hya(this.url)}get Wr(){return this.QUe}ojg(){const b={},h=this.Wr;b.a=this.lng;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.mcf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(n.a)(Bd,"PerformanceTimingEntry",null,[]);const kl=(b,h)=>{const v={};let D=null;switch(b){case 0:D="ResourceTiming";b=h.a;null!=b&&(v.Url=b);b=h.b;null!=b&&(v.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(v.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(v.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(v.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(v.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(v.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(v.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(v.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(v.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(v.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(v.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(v.ResponseEnd=b);b=h.n;
null!=b&&(v.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(v.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(v.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(v.TransferSize=h);break;case 1:D="PerformanceTiming",b=h.a,null!=b&&(v.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(v.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(v.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(v.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(v.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(v.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(v.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(v.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(v.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(v.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(v.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(v.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(v.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(v.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(v.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(v.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(v.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(v.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(v.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(v.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(v.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(v.LoadEventEnd=b),h=h.w,null!=h&&(v.CustomText=h)}v.Table=D;return Sys.Serialization.JavaScriptSerializer.serialize(v)};var fi=c(47),ji=c(233),wi=c(167);class xl{constructor(b,h=null,v=null){this.Uf=b;this.kng=this;this.x3j=h||(()=>window.location.href);this.Fye=new ud(v)}run(){if(xl.aeb(window.performance))try{const Q=this.x3j();if(xl.vmk.exec(Q)&&this.Fye.Mvi(Q)){var b=new Bd(window.performance.timing,Q);wi.a.instance.IPn(b.Wr.fetchStart);wi.a.instance.JPn(b.Wr.navigationStart);
wi.a.instance.pY(fi.a.AHl,"connectStart","requestStart");wi.a.instance.pY(fi.a.IHl,"requestStart","responseStart");wi.a.instance.pY(fi.a.LHl,"responseStart","responseEnd");this.kng.R3a(1,b.ojg());this.Uf.rf(fi.a.Qgb,b.Wr.fetchStart);this.Uf.rf(fi.a.FHl,b.Wr.domainLookupStart);this.Uf.rf(fi.a.EHl,b.Wr.domainLookupEnd);this.Uf.rf(fi.a.CHl,b.Wr.connectStart);this.Uf.rf(fi.a.NHl,b.Wr.secureConnectionStart);this.Uf.rf(fi.a.BHl,b.Wr.connectEnd);this.Uf.rf(fi.a.JHl,b.Wr.requestStart);this.Uf.rf(fi.a.Tlf,
b.Wr.responseStart);this.Uf.rf(fi.a.GHl,b.Wr.responseEnd-b.Wr.responseStart);this.Uf.rf(fi.a.KHl,b.Wr.responseStart-b.Wr.requestStart);var h=0,v=0,D=0;({transferSize:h,ghf:v,Jcf:D}=this.cOo(Q)).returnValue&&(this.Uf.rf(fi.a.PHl,h),this.Uf.rf(fi.a.DHl,D),this.Uf.rf(fi.a.HHl,v));this.Uf.rf(fi.a.yMc,b.Wr.navigationStart)}}catch(Q){u.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Q)}}cOo(b){let h,v,D;D=v=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,ghf:v,Jcf:D};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,ghf:v,Jcf:D};b=b[0];var Q=b.transferSize;void 0!==h&&null!==h&&(h=Q);Q=b.decodedBodySize;void 0!==Q&&null!==Q&&(D=Q);b=b.encodedBodySize;void 0!==b&&null!==b&&(v=b);return{returnValue:!0,transferSize:h,ghf:v,Jcf:D}}R3a(b,h){u.ULS.sendTraceTag(4551815,306,50,kl(b,h))}static get instance(){return xl._instance||
(xl._instance=new xl(ji.a.instance,null,w.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?w.AFrameworkApplication.K.KC("ResourceLoggerDomainAllowList"):null))}static aeb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}xl._instance=null;xl.vmk=RegExp("^https?://.*","i");Object(n.a)(xl,"PerformanceTimingLogger",null,[779]);class Fl{constructor(b,h){this.mcf=null;this.QUe=b;this.behavior=h;this.url=this.Wr.name}get lng(){return 2===this.behavior?this.url:
ja.a.hya(this.url)}get Wr(){return this.QUe}ojg(){const b={},h=this.Wr;b.a=this.lng;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(Fl.Phb(h,"decodedBodySize"));b.p=this.round(Fl.Phb(h,"encodedBodySize"));b.q=this.round(Fl.Phb(h,"transferSize"));b.n=this.mcf;return b}round(b){return Math.round(1E3*b)/1E3}static Phb(b,h){return b[h]}}Object(n.a)(Fl,"ResourceTimingEntry",null,[797]);class di{constructor(b,h=null,v=100){this.mLg=b;this.Wud=h;this.V8a={};this.RXj=v}JMo(b){var h=b.name.toLowerCase();const v=ja.a.ROc(h);this.ydj(v,h)&&(v in this.V8a?u.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
v):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.jCi(b),h.encodedsize=Fl.Phb(b,"encodedBodySize"),h.decodedsize=Fl.Phb(b,"decodedBodySize"),this.V8a[v]=h))}KMo(b){var h=b.name.toLowerCase();const v=ja.a.ROc(h);this.d6n(v,h)&&(v in this.V8a?u.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",v):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.jCi(b),h.encodedsize=Fl.Phb(b,"encodedBodySize"),
h.decodedsize=Fl.Phb(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.V8a[v]=h))}ydj(b,h){if(this.mLg)return Array.contains(this.mLg,b);if(this.Wud)for(b=ja.a.z_(h),h=0;h<this.Wud.length;h++)if(this.Wud[h]&&b.endsWith(this.Wud[h]))return!0;return!1}d6n(b,h){return this.ydj(b,h)?b.endsWith(".js")||b.endsWith(".css"):
!1}jCi(b){try{const h=Fl.Phb(b,"transferSize");if(void 0!==h&&null!==h)return!h;u.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.RXj}catch(h){u.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}fSn(){if(lb.a.jf(this.V8a))u.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var b=w.AFrameworkApplication.flightId?w.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new wb.a,{extendedProperties:kb.a.fG()});h.extendedProperties.set("Flights",F.c(b));this.sJi(h,this.V8a,wa.Health.instance)}}Pmf(b){let h=0,v=0,D=0,Q=0;const ba=this.V8a;for(let Ta in ba){var ta=ba[Ta];Ta.endsWith(".js")&&(ta=Object(Ka.a)(Object,ta),ta.responseend<b&&(h+=1,v+=ta.decodedsize,Q+=ta.encodedsize,D+=ta.iscached?0:ta.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=v;b.transferredBytes=
D;b.encodedBytes=Q;return b}sJi(b,h,v){if(h){var D=0,Q=0,ba=0,ta=0,Ta=0,ob=0,Kb=0,Vb=0,bc=0,Dc=0,Oc=0;for(let rd in h){var gd=h[rd];try{const je=Object(Ka.a)(Object,gd);if(!je)continue;const Ld=je.iscached?Boolean.parse(je.iscached.toString()):!1,Qd=je.fetchstart?this.parseFloat(je.fetchstart.toString()):0,ge=(je.responseend?this.parseFloat(je.responseend.toString()):0)-Qd,ze=je.encodedsize?this.parseFloat(je.encodedsize.toString()):0,gg=je.decodedsize?this.parseFloat(je.decodedsize.toString()):0;
D+=ge;ta+=ze;Kb+=gg;Dc++;Ld?(ba+=ge,ob+=ze,bc+=gg,Oc++):(Q+=ge,Ta+=ze,Vb+=gg)}catch(je){u.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",je.message)}}b.extendedProperties.set("StaticResources",F.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",D.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Q.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ba.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ob.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Kb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Vb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",bc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Dc.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Oc.toString());v.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);v.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(n.a)(di,"AppStaticResourceManager",null,[]);class Xi extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(n.a)(Xi,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Yi{constructor(b,
h,v=null,D=null,Q=100,ba=!1){this.LGe=!1;this.vo=null;this.Jqc=0;this.ra=new cf.a;this.rrb=null;this.xZ=!1;this.vih=0;this.Hb=b;this.WQg=0;this.kng=this;this.Fye=new ud(v);this.xK=h;D&&(this.rrb=new di(null,D,Q));this.XUj=ba}get Dxh(){try{return!(void 0===this.xK||null===this.xK)&&!(void 0===this.xK.getEntriesByType||null===this.xK.getEntriesByType)}catch(b){return u.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get Xgl(){return this.WQg}get isActive(){return this.xZ}get ejg(){return this.vih}nph(b){this.ra.addHandler(Yi.cif,
b)}jaj(b){this.ra.removeHandler(Yi.cif,b)}xc(b,h){const v=this.ejg!==b;this.vih=b;this.isActive&&this.Hb&&v&&(this.We(),this.Wb());this.WQg=h}activate(){!this.isActive&&this.Dxh&&(this.Wb(),this.xZ=!0)}deactivate(b){this.isActive&&(this.We(),b&&this.flush(),this.xZ=!1)}flush(){if(this.isActive&&this.Dxh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.Jqc&&u.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.Jqc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.Jqc=0);const v=[];for(let D=this.Jqc;D<b.length;D++)this.Fye.Mvi(b[D].name)&&(this.rrb&&(this.XUj?this.rrb.KMo(b[D]):this.rrb.JMo(b[D])),v.push(new Fl(b[D],this.Xgl)));h||(this.Jqc=b.length);this.ra.raiseEvent(Yi.cif,new Xi(v));for(b=0;b<v.length;b++)0!==v[b].behavior&&2!==v[b].behavior||this.kng.R3a(0,v[b].ojg());0<v.length&&
u.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",v.length)}catch(h){u.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}R3a(b,h){u.ULS.sendTraceTag(4310804,306,50,kl(b,h))}DPn(){this.rrb.fSn()}Pmf(b){return this.rrb.Pmf(b)}Wb(){this.Hb&&0<this.ejg&&(this.vo=new of.a(3,2,1E3*this.ejg,()=>{this.flush()},5),this.Hb.Wb(this.vo),this.LGe=!0)}We(){this.LGe&&(this.Hb.We(this.vo),this.vo=null,this.LGe=
!1)}}Yi.cif="EntriesAvailable";Object(n.a)(Yi,"ResourceTimingLogger",null,[765,779]);class sm{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");xl.instance.run()}dispose(){}xc(b){this.W=b;let h=null;if(w.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=w.AFrameworkApplication.K.KC("ResourceLoggerDomainAllowList")}catch(ba){u.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const v=
[];v.push(ja.a.z_(Se.a.s5).toLowerCase());v.push(ja.a.z_(Se.a.E7c).toLowerCase());const D=w.AFrameworkApplication.K.mc("AppStaticResourceMonitorCacheThresholdInMs",100),Q=w.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(765,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Rd(()=>new Yi(w.AFrameworkApplication.pc,window.performance,h,v,D,Q))}static main(){N.a.instance.Fc(new sm)}}Object(n.a)(sm,"ResourceTimingPackage",null,[1,2]);var Fg=c(243);class $f{constructor(){this.Ire=
{}}Epk(b){this.Ire[b.id.toString()]=b}khn(b){const h=this.Ire;for(let v in h)h[v].notify(b,!1);this.Ire={}}sKn(b,h){h&&this.Epk(h);return this.rWi(b,h)}Tgf(b){this.khn(b)}MUh(b,h){b.notify(h,!0)}}Object(n.a)($f,"AEventEmitter",null,[645]);var Qi;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(Qi||(Qi={}));Object(n.b)("EventResultState",Qi);class em{constructor(){this._state=0}get state(){return this._state}set state(b){u.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:Qi[this._state],["NewState"]:Qi[b]},"ResultType",this.Rei());this._state=b}}Object(n.a)(em,"AEventResult",null,[644]);class Zi extends em{constructor(){super();this.iTe=this.Vyc=null;this.state=0;this.oEe=this.NZg=!1}get Lca(){return this.Vyc}get a7a(){return this.iTe}get ACm(){return this.NZg}Rei(){return"GetMoreInfo Result"}}Object(n.a)(Zi,"GetMoreInfoResult",em,[808,644]);var Tg=c(1379),Ri=c(1551),cj=c(1047);class Fh{constructor(b,h,v,D,Q,
ba,ta,Ta){this.ga=b;this.Yf=h;this.Mh=v;this.Eza=D;this.Hb=Q;this.rD=ba;this.Q4j=ta;this.svd=Ta}BTn(){this.Sdc.qa(Ua.a.afc,Kd.a.frame,Object(z.a)(this,this.afc,"openUrlInNewTab"));this.Sdc.qa(Ua.a.AWf,Kd.a.frame,Object(z.a)(this,this.AWf,"openDocumentUrl"));w.AFrameworkApplication.$fa?this.yJi():this.Sdc.fb(Ua.a.ZId,Kd.a.frame,Object(z.a)(this,this.ZId,"documentLoaded"),96)}afc(b,h,v,D,Q){Q&&Q.MenuItemId&&(u.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:Q.SourceControlId,["AppType"]:cj.a[this.jxa]}),
Id.a.om(Q.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}AWf(b,h,v,D,Q){if(Q&&Q.MenuItemId){const ba=w.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ta=w.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");u.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ba,ta);if(ba&&ta){u.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Q.SourceControlId,["AppType"]:cj.a[this.jxa]});
b=Q.MenuItemId.toString();const Ta={};Ta[H.a.Mgc]="1";Ta[H.a.documentUrl]=b;Ta[H.a.reason]=Ri.a.open;u.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");w.AFrameworkApplication.PO().execute(ob=>{ob.sendMessage(L.a.iCb,Ta)})}else this.afc(b,h,v,D,Q)}return 32}ZId(){this.yJi();return 32}OQa(b,h,v=""){if(h&&h.MH){const D=Tg.a[h.status];h=h.MH.getTime();const Q=this.fq()-h;u.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:D,
["ElapsedMs"]:Q,["StartTime"]:h,["Notes"]:v})}else u.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}yJi(){var b=w.AFrameworkApplication.K.$("QPGVCI"),h=ja.a.dU(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var v=ja.a.dU(document.URL,"wdPreviousSession",b);b=ja.a.dU(document.URL,"wdPreviousCorrelation",b);var D=w.AFrameworkApplication.K.$("NAOPLP");if(w.AFrameworkApplication.$fa){var Q=w.AFrameworkApplication.$fa.getTime();
!h||h>Q?u.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:Q,["SessionId"]:v,["Correlation"]:b}):u.ULS.sendTraceTag(5849683,202,D?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:Q-h,["ClickTimestamp"]:h,["SessionId"]:v,["Correlation"]:b})}else u.ULS.sendTraceTag(5849681,202,D?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:v,["Correlation"]:b})}}get Sdc(){return this.ga.value}get yZc(){return this.Yf.value}get LPi(){return this.Mh.value}get jxa(){return this.Eza.value}get Z4d(){return this.Hb.value}get fq(){return this.rD}get lRa(){return this.Q4j.value}get e7a(){return this.svd.value}static get instance(){return Fh._instance||(Fh._instance=Fh.Jr())}static Jr(){return new Fh(new Fg.a(()=>w.AFrameworkApplication.va),new Fg.a(()=>w.AFrameworkApplication.Ne),new Fg.a(()=>w.AFrameworkApplication.ta),
new Fg.a(()=>w.AFrameworkApplication.ta.Nb.Sl),new Fg.a(()=>w.AFrameworkApplication.pc),()=>(new Date).getTime(),new Fg.a(()=>w.AFrameworkApplication.ta.Nb.lRa),new Fg.a(()=>w.AFrameworkApplication.e7a))}}Fh._instance=null;Object(n.a)(Fh,"NewAndOpenCommonHelpers",null,[642]);class Kh{constructor(b,h,v){this.Ttd=this.vo=null;this.MPe=0;this.aik=b;this.Hb=h;this.wRg=v}Xzk(){this.MPe=this.uhc+1}k7f(b){this.vo&&(this.Hb.We(this.vo),this.vo=null);b&&(this.MPe=0)}kBo(b){const h=this.NIo;0<=h?(this.Xzk(),
this.k7f(!1),this.vo=new of.a(4,1,h,b,107),this.Hb.Wb(this.vo)):(this.k7f(!0),u.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.wRg}))}get uhc(){return this.MPe}get NIo(){return this.uhc>=this.Sij.length?-1:this.Sij[this.uhc]}get Sij(){if(!this.Ttd){const b=(this.aik.value||"0").split(",");this.Ttd=[];for(let h=0;h<b.length;h++){const v=parseInt(b[h]);isNaN(v)?u.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.wRg,["Entry"]:b[h]}):
Array.add(this.Ttd,v)}}return this.Ttd}}Object(n.a)(Kh,"RetryHelper",null,[]);class Ok extends $f{constructor(b,h){super();this.VAa=b;this.Wzc=new Kh(h,this.fZc.Z4d,"GetMoreInfo");this.pq=new Zi}Q8m(){this.LLf("Document opened")}Jal(b){return()=>{this.LLf(b,!0)}}rWi(b,h=null){u.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.pq.state?(h&&this.MUh(h,this.pq),u.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.LLf(b);return this.pq}LLf(b,h=!1){this.Wzc.k7f(!h);1===this.pq.state?u.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Wzc.uhc}):(u.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Wzc.uhc}),this.pq.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.fZc.lRa,w.AFrameworkApplication.hm),this.fZc.yZc.$yb(h,1,null,null,[Ok.cah,Ok.Rgh],5,this.v$k(),this.u$k(b)))}v$k(){return b=>
{var h=!1;let v=!1;var D=!1,Q;w.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.we?({Yu:Q}=F.d(b.data.we)).returnValue?Q?(D=!0,this.pq.iTe=Q.StorageServiceDisplayName,this.pq.Vyc=Ok.aDi(Q.PersonalFileStorageUrl)?Q.PersonalFileStorageUrl:"",""===this.pq.Lca&&"SharePointOnlineConsumer"===w.AFrameworkApplication.K.jb("FileSource")&&(this.pq.Vyc=ja.a.hya(w.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.pq.Lca&&""!==this.pq.a7a):u.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
u.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):u.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));D||((Q=b.data.wj)?(this.pq.iTe=(Q[Ok.Rgh]||"").toString(),h=(Q[Ok.cah]||"").toString(),this.pq.Vyc=Ok.aDi(h)?h:"",""===this.pq.Lca&&"SharePointOnlineConsumer"===w.AFrameworkApplication.K.jb("FileSource")?(this.pq.Vyc=ja.a.hya(w.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.pq.Lca&&""!==this.pq.a7a):h=""===h&&""!==this.pq.a7a):(u.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),v=!0));D=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.Wzc.uhc,v,h,D);this.fZc.OQa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,D);this.hjj(3,h,v)}}u$k(b){return h=>{this.fZc.OQa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.hjj(2);this.Wzc.kBo(this.Jal(b))}}hjj(b,h=!1,v=!1){this.pq.state=b;this.pq.NZg=h;this.pq.oEe=v;this.Tgf(this.pq)}get fZc(){return this.VAa.value}static get instance(){return Ok._instance||(Ok._instance=Ok.Jr())}static Jr(){return new Ok(new Fg.a(()=>Fh.instance),new Fg.a(()=>w.AFrameworkApplication.R2l))}static aDi(b){if(!b)return u.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(G.a.Ug(b).startsWith("https://"))return!0;u.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}Ok.cah="PersonalFileStorageUrl";Ok.Rgh="StorageServiceDisplayName";Ok._instance=null;Object(n.a)(Ok,"GetMoreInfoActor",$f,[]);class uj{constructor(b,h,v,D,Q){this.g6j=6E4;this.kpi="inactive";this.pmh="active";this.xZ=!0;this.Hb=b;this.W3j=h;this.rD=v;this.qwd=D;this.ra=new cf.a;Q&&this.$Ao();this.S2g=this.gai()}Smh(b){this.ra.addHandler(this.pmh,b)}Zsk(b){this.ra.addHandler(this.kpi,b)}$Ao(){const b=new of.a(5,2,this.g6j,Object(z.a)(this,this.lvm,
"inactiveLoop"),108);this.mvm.Wb(b)}lvm(){const b=this.gai(),h=this.fq()-b;h>this.vle&&this.xZ&&(u.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.xZ=!1,this.ra.raiseEvent(this.kpi));b-this.S2g>this.vle&&(this.xZ=!0,this.ra.raiseEvent(this.pmh));this.S2g=b}get mvm(){return this.Hb.value}get gai(){return this.W3j}get fq(){return this.rD}get vle(){return this.qwd.value}static get instance(){return uj._instance||(uj._instance=uj.Jr())}static Jr(){return new uj(new Fg.a(()=>
xb.a.instance),()=>w.AFrameworkApplication.nIf.getTime(),()=>(new Date).getTime(),new Fg.a(()=>w.AFrameworkApplication.vle),!0)}}uj._instance=null;Object(n.a)(uj,"InactivityManager",null,[]);var tl=c(1672);class Lj extends em{constructor(){super();this.Mak=this.U6g=this.T6g=null;this.state=this.wih=0;this.oEe=!1}get PNf(){return this.T6g}get aPi(){return this.U6g}get TIo(){return this.wih}Rei(){return"MruActor Result"}}Object(n.a)(Lj,"MruResult",em,[643,644]);class yl{constructor(b,h,v){this.task=
null;this.qGb=b;this.maxRetries=h;this.taskManager=v;this.retryCount=this.XSc=0;this.aOe=this.LWc=null}XOm(b,h){return b===ha.a.w6b||20===h||18===h||3===h}sQm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get U$d(){return this.aOe}reset(){this.XSc=this.retryCount=0;this.aOe=this.LWc=null;this.task&&(this.taskManager.We(this.task),this.task=null)}Jzm(b,h,v,D){this.aOe=String.format("{0}_{1}",v,D);if(this.retryCount>=
this.maxRetries)return u.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.XOm(v,D))return u.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.sQm(D)&&1<=this.XSc)return this.LWc=v,!1;h=Math.max(h,this.qGb*Math.pow(2,this.XSc));if(26===D)h=Math.max(h,3E4);else if(27===D||28===D)h=Math.max(h,6E4);9===D||412===v&&(null==this.LWc||412!==this.LWc)?h=500:this.XSc+=1;this.LWc=v;this.retryCount+=1;this.task&&this.taskManager.We(this.task);u.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new of.a(2,1,h,b,107);this.taskManager.Wb(this.task);return!0}}Object(n.a)(yl,"RetryManager",null,[]);var Lh=c(127);class Ck{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(Ck,"WriteOptions",null,[]);var lk=c(742);class Pk extends $f{constructor(b,h,v,D,Q,ba,ta){super();this.VAa=b;this.D$j=h;this.Vbb=new yl(w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.OM.Z4d);this.hdb=new yl(w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.OM.Z4d);this.Tfk=v;this.rlh=D;this.zok={};this.Kka=new Lj;this.t3j=Q;this.Vod="";this.KL=ba;this.sTg=ta;this.hsd="";this.Xfk=w.AFrameworkApplication.K.mc("WordRecentLinksCount",
25)}get qpe(){return this.zok}kXn(){this.OM.Sdc.qa(Ua.a.Uaj,Kd.a.frame,Object(z.a)(this,this.b1n,"renameMruEntry"))}b1n(){return this.Gpg("Rename")}g9m(){this.SLi("File Opened")}h9m(){this.SLi("IntervalUpdate")}SLi(b){u.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.Gpg(b)}Ega(b){(b=G.a.Ega(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}J3h(){switch(this.OM.jxa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}Bhm(b){var h=this.t3j();if(!h)return null;const v=new Ck;v.documentUrl=this.sTg.value?encodeURI(h):h;v.mruItemId=this.Vod;v.app=this.J3h();if(h=this.KL())v.folderName=h.breadcrumbFolderName,h=h.az,v.documentName=G.a.jJ(h),v.documentExt=this.Ega(h);b&&(v.documentName?v.documentName.length?255<=v.documentName.length?b.set("DocumentNameLength","Long"):2084<=v.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(v)}Gpg(b,h=!1){if(4===this.OM.jxa&&!w.AFrameworkApplication.WId)return 2;var v=kb.a.fG();v&&(v.set("Trigger",b),v.set("IsRetry",h?"true":"false"),v.set("MruIdSent",this.Vod?"true":"false"),v.set("URLEncoded",this.sTg.value?"true":"false"));wa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",v);b=this.Bhm(v);if(!b)return h=!w.AFrameworkApplication.oRb,v&&(v.set("WebEditingIsEnabled",w.AFrameworkApplication.oRb?"true":"false"),v.set("ProtectedFile",w.AFrameworkApplication.protectFile?
"true":"false")),wa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new wb.a,{extendedProperties:v})),2;this.hdb&&!h&&this.hdb.reset();v=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.OM.lRa,this.PJf);this.rlh?this.qpe["X-FileId"]=w.AFrameworkApplication.hm:v+=String.format("&{0}",w.AFrameworkApplication.hm);w.AFrameworkApplication.sessionStartInfoSettings&&(this.qpe["X-Office-AudienceGroup"]=Object(Ka.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.qpe["X-Timeout"]=15E3;return this.OM.yZc.tj(v,2,b,this.qpe,!0,5,Object(z.a)(this,this.m6o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.Oel,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}m6o(b){this.Zki(b.data)}Zki(b){const h=kb.a.fG();this.hdb&&(h&&this.hdb.U$d&&(h.set("LastError",this.hdb.U$d),h.set("NumRetries",this.hdb.retryCount.toString())),this.hdb.reset());const v=tl.c(b.we);v&&v.diagnostics_data&&(this.Vod=v.diagnostics_data.mru_id);
b=+b.rT-+b.MH;h&&h.set("RequestDuration",b.toString());wa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new wb.a,{extendedProperties:h}))}Oel(b){if(b.data.Qe===ha.a.zIc)this.Zki(b.data);else{var h=b.data.Qe===ha.a.sia,v=kb.a.fG();this.jli(this.hdb,b,this.pel(),v);v&&(v.set("StatusCode",b.data.Qe.toString()),h||this.BYe(b.data,v));wa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Qe),h,!1,Object.assign(new wb.a,{extendedProperties:v}))}}pel(){return()=>
{this.Gpg("Retry",!0)}}$2l(){this.rYc("Polling")}Z2l(){this.rYc("Retry",!0)}T8m(){this.rYc("Open")}S8m(){this.rYc("Activity")}R8m(){this.rYc("ActivityRecentLinks",!1,!0)}rYc(b,h=!1,v=!1){u.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const D=kb.a.fG();D&&(D.set("Trigger",b),D.set("IsRetry",h?"true":"false"),v&&D.set("RecentLinks","true"));wa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",D);this.Vbb&&!h&&this.Vbb.reset();v?this.YKh(Object(z.a)(this,this.a3l,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(z.a)(this,this.W2l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.YKh(Object(z.a)(this,this.b3l,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.Y2l,"getMruFromServerFailureCallback"))}BYe(b,h){b&&b.wj&&(b=b.wj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}A2m(b,h){b&&(h&&h.set("RequestDuration",(+b.rT-+b.MH).toString()),wa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new wb.a,{extendedProperties:h})))}b3l(b){this.jbi(b)}jbi(b,h=!1){var v="";let D=null,
Q=null,ba=null;const ta=tl.c(b.data.we);ta&&(D=ta.places?ta.places.items:[],Q=ta.documents?ta.documents.items:[],(ba=tl.a(ta,h))&&(v=F.c(ba)));w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Lh.c()&&(h?this.hsd=v:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(v,!0)));v=kb.a.fG();this.Vbb&&(v&&this.Vbb.U$d&&(v.set("LastError",this.Vbb.U$d),v.set("NumRetries",this.Vbb.retryCount.toString())),this.Vbb.reset());h&&v&&v.set("RecentLinks","true");ba||D||Q?(h?this.OM.OQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.OM.OQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.zne(3,ba,D,Q),this.A2m(b.data,v)):(h?this.OM.OQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.OM.OQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),v&&this.BYe(b.data,v),wa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new wb.a,{extendedProperties:v})),this.zne(3,null,null,null,!0));this.Tgf(this.Kka)}a3l(b){this.jbi(b,
!0)}jli(b,h,v,D){let Q=0,ba=0;const ta=tl.c(h.data.we);ta&&(null!=ta.response_code&&(Q=ta.response_code,D&&D.set("MruResponseCode",Q.toString()),9===Q&&(this.Vod="")),ta.error_data&&null!=ta.error_data.retry_after_ms&&(ba=ta.error_data.retry_after_ms,D&&D.set("ExpectedRetryAfter",ba.toString())));b&&(h=b.Jzm(v,ba,h.data.Qe,Q),D&&(D.set("CurrentRetryCount",b.retryCount.toString()),D.set("RetryScheduled",h?"true":"false")))}Y2l(b){this.ibi(b)}ibi(b,h=!1){const v=b.data.Qe===ha.a.sia,D=kb.a.fG();D&&
(D.set("StatusCode",b.data.Qe.toString()),h&&D.set("RecentLinks","true"),v||this.BYe(b.data,D));h?this.OM.OQa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.OM.OQa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.zne(2);this.jli(this.Vbb,b,Object(z.a)(this,this.Z2l,"getMruFromServerRetryTask"),D);wa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Qe),v,!1,Object.assign(new wb.a,{extendedProperties:D}));this.Tgf(this.Kka);
w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Lh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.hsd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}W2l(b){this.ibi(b,!0)}zne(b,h=null,v=null,D=null,Q=!1){if(3!==this.Kka.state||3===b)this.Kka.T6g=h,this.Kka.U6g=v,this.Kka.Mak=D,this.Kka.state=b,this.Kka.oEe=Q,this.Kka.wih=this.OM.fq()}rWi(b,h){u.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Kka.state});
h&&3===this.Kka.state&&this.MUh(h,this.Kka);return this.Kka}YKh(b,h,v=!1){this.zne(1);let D;const Q={};D=v?String.format(this.OM.lRa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Xfk,"OfficeSuite",this.PJf,"ClassicMru"):String.format(this.OM.lRa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.J3h(),this.PJf);this.Tfk.value||(D+="&entity=docs");w.AFrameworkApplication.sessionStartInfoSettings&&(Q["X-Office-AudienceGroup"]=Object(Ka.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");v&&(Q["X-Office-Application"]="147");this.rlh?Q["X-FileId"]=w.AFrameworkApplication.hm:D+=String.format("&{0}",w.AFrameworkApplication.hm);this.OM.yZc.tj(D,1,null,Q,!0,5,b,h,null)}get OM(){return this.VAa.value}get PJf(){return this.D$j.value}static get instance(){return Pk._instance||(Pk._instance=Pk.Jr())}static Jr(){return new Pk(new Fg.a(()=>Fh.instance),new Fg.a(()=>lk.a.og(w.AFrameworkApplication.lcid).name),new Fg.a(()=>w.AFrameworkApplication.ta.Nb.lF),w.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>w.AFrameworkApplication.ta.Nb.Dfa,()=>w.AFrameworkApplication.us,new Fg.a(()=>w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}Pk._instance=null;Object(n.a)(Pk,"MruActor",$f,[]);class Fm{constructor(){this.yCc=this.Abh=this.W=null;this.Oh=!1}get name(){return"Common.App.NewAndOpen.Core"}xc(b){this.W=b;b.register(642,"Common.INewAndOpenCommonHelpers").singleInstance().Rd(()=>Fh.instance);b.register(645,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Rd(()=>Ok.instance);
b.register(645,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Rd(()=>Pk.instance)}init(){w.AFrameworkApplication.K.Po(()=>{this.h2a()})}h2a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Fh.instance.BTn();w.AFrameworkApplication.cGa&&(b=!0);w.AFrameworkApplication.I2f&&(Pk.instance.T8m(),0<w.AFrameworkApplication.bPi&&this.Gnh(),this.Moo(),b=!0);w.AFrameworkApplication.e7a&&
b&&Ok.instance.Q8m();w.AFrameworkApplication.ZVo&&(b=Pk.instance,b.kXn(),b.g9m(),xb.a.instance.Wb(this.$Vo))}Moo(){uj.instance.Smh(Object(z.a)(Pk.instance,Pk.instance.S8m,"makeGetMruRequestActivityTrigger"));uj.instance.Smh(Object(z.a)(this,this.Gnh,"addGetMruFromServerTask"));uj.instance.Zsk(Object(z.a)(this,this.jjl,"deleteGetMruFromServerTask"))}jjl(){xb.a.instance.We(this.cPi)}Gnh(){xb.a.instance.Wb(this.cPi)}get cPi(){return this.Abh||(this.Abh=new of.a(5,2,w.AFrameworkApplication.bPi,Object(z.a)(Pk.instance,
Pk.instance.$2l,"getMruFromServerTask"),109))}get $Vo(){return this.yCc||(this.yCc=new of.a(2,2,6E4*w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(Pk.instance,Pk.instance.h9m,"makeUpdateMruTask"),197))}dispose(){this.Oh||(this.Oh=!0,this.yCc&&(xb.a.instance.We(this.yCc),this.yCc=null))}}Object(n.a)(Fm,"CorePackageManager",null,[1,2,10]);var fm=c(1547),gm=c(146);class kg{static Dtl(b){return kg.pyh("New",b)}static Etl(b){return kg.pyh("Open",
b)}static Vxh(b,h){return kg.yZa("LoadingMenuSection",kg.X_m,b,kg.oFc("lblLoading",h))}static pFc(b,h,v=null,D=null){return kg.yZa("MessageMenuSection",kg.$Oi,h,kg.oFc("lblMessage",b,v,D))}static sNk(b){return kg.Vxh(b,CommonUIStrings.l_VoicedLoadingText)}static tNk(b,h){return kg.pFc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Lca,h.a7a)}static rNk(b,h){return kg.pFc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.a7a,"\n\n"),b.labelText)}static Zxh(b){return kg.pFc(CommonUIStrings.l_NewGenericErrorMessage,
b.labelText)}static pNk(b,h,v){return kg.yZa("menuNewBlank",kg.Vqm,v?b.labelText:null,kg.kFc(b.Kmi,b.Lmi,b.Mmi,null,b.Z1a,b.ARc,h,"blank"))}static oOk(){return kg.oFc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static nyh(){return kg.oFc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static pOk(b,h){return kg.yZa("menuNewTemplates",b,null,h)}static nNk(b,h){return kg.yZa("menuNewMoreTemplates",kg.M0h,null,kg.kFc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,
CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static eMk(b,h,v){let D="";v&&h&&(D=kg.yZa("BrowseMoreMenuSection",kg.M0h,null,kg.kFc("btnBrowseMore",h,h,null,null,null,b||"1959943459",v)));return D}static oFc(b,h,v=null,D=null){let Q=D;h&&0<h.length&&(Q=kg.UPi.Rmb(h).trimEnd(),Q=0<=Q.indexOf("{0}")?String.format(Q,D):String.format("{0} {1}",Q,D));v=v&&D?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',G.a.Af(v),G.a.Af(D),G.a.Af(Q)):
"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',G.a.Af(b||""),kg.UPi.Rmb(G.a.Af(h||"")),v)}static kFc(b,h,v,D,Q,ba,ta,Ta){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',G.a.Af(b||""),G.a.Af(h||""),G.a.Af(v||""),D||"32by32",G.a.Af(Q||""),
G.a.Af(ba||""),ta,G.a.Af(Ta||""))}static pyh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static yZa(b,h,v,D){v=v?String.format('Title="{0}"',G.a.Af(v)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',G.a.Af(b||""),G.a.Af(h||""),v,D)}}kg.$Oi="MenuMru";kg.X_m=
"MenuLoading";kg.Vqm="MenuHeader";kg.M0h="MenuFooter";kg.UPi=gm.a.wC("\n","&#10;");Object(n.a)(kg,"NewAndOpenXmlUtilities",null,[]);class $k{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(n.a)($k,"HostInformation",null,[]);var am=c(189);class bg{constructor(b,h,v,D,Q,ba){this.Wvd=this.Ew=this.Oed=null;this.zud=this.aSe=!1;this.f6g=0;this.GRe=this.cGe=!1;this.VAa=b;this.Vsc=h;this.bWa=new Fg.a(()=>new fm.a(v.value,Object(z.a)(this,this.FEb,"getMoreInfoEventReceived")));
this.Kak=D;this.lbb=Q;this.fjk=ba;this.VAc=this.Uhe;2===this.r0.jxa&&(this.GRe=!0);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.dAl()}get n7(){switch(this.r0.jxa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}dAl(){xb.a.instance.Wb(new of.a(5,1,0,()=>{this.getTemplateListJson()}))}Tb(){const b=this.r0.Sdc;b.qa(Ua.a.newDocument,Kd.a.frame,
Object(z.a)(this,this.newDocument,"newDocument"));b.qa(Ua.a.t$d,Kd.a.frame,Object(z.a)(this,this.t$d,"populateNewMenu"))}newDocument(b,h,v,D,Q){if(1===v)return 32;if(2===v&&Q){if(w.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&Q.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),w.AFrameworkApplication.va.processAction(Ua.a.OEn,2);if(Q.MenuItemId&&Q.SourceControlId)return"NewDocumentHome"===Q.SourceControlId&&Qe.a("NewDocumentFromHomeTab"),
this.mIc(Q.MenuItemId,Q.SourceControlId)}return 8}mIc(b,h){var v=this.d5d.DLh;if(null===v)return 8;var D=w.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(w.AFrameworkApplication.mkb&&D){u.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Q={};Q[H.a.template]=b;Q[H.a.n7]=this.n7;Q[H.a.lcid]=w.AFrameworkApplication.lcid.toString();Q[H.a.reason]=Ri.a.Kaf;Q[H.a.uiCulture]=w.AFrameworkApplication.uiCulture;
Q[H.a.dataCulture]=w.AFrameworkApplication.dataCulture;w.AFrameworkApplication.PO().execute(ba=>{ba.sendMessage(L.a.mIc,Q)})}else D=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",v,G.a.Nj(this.cGa),G.a.Nj(b),G.a.Nj(this.n7),G.a.Nj(w.AFrameworkApplication.lcid.toString()),G.a.Nj(D.toString()),G.a.Nj(h),G.a.Nj(w.AFrameworkApplication.canary),w.AFrameworkApplication.hm),(v=w.AFrameworkApplication.K.jb("ScenarioId"))&&
""!==v&&(h+="&wdscenarioid="+G.a.Nj(v)),h+="&"+w.AFrameworkApplication.NRd(),w.AFrameworkApplication.e3a&&(h+="&"+w.AFrameworkApplication.oQd()),(v=this.Ew?this.Ew.Lca:null)?h+="&DestinationUrl="+G.a.Nj(v):u.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Id.a.om(h,"_blank",void 0,"CreateNewDocument");2!==this.r0.jxa&&3!==this.r0.jxa||u.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:cj.a[this.r0.jxa],
["Template"]:b});w.AFrameworkApplication.K&&w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.r0.jxa&&("blank"===b?Qe.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new pa.a,{name:"TemplateId",string:b})],Qe.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}C6m(b){let h=Number.MAX_VALUE,v=Number.MIN_VALUE;const D=window.performance;if(D&&"undefined"!==typeof D.getEntriesByName){for(let ba=0;ba<b.length;ba++){var Q=D.getEntriesByName(b[ba]);
Q&&0<Q.length&&(Q=Q[0],h=Math.min(parseInt(String(Q.fetchStart)),h),v=Math.max(parseInt(String(Q.responseEnd)),v))}v>h&&u.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:v-h,["MinFetchStart"]:h,["MaxResponseEnd"]:v})}}t$d(b,h,v,D,Q){if(1===v)return this.GRe&&(w.AFrameworkApplication.Zoa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.GRe=!1),32;2!==v||this.cGe||(this.f6g=(new Date).getTime(),u.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Uhe,["CachedNewMenuXmlExists"]:!!this.Oed,["ShouldCallGetMoreInfo"]:this.r0.e7a}));w.AFrameworkApplication.te("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");w.AFrameworkApplication.te("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.vDn(Q)}vDn(b){b&&(this.Oed?b.PopulationXML=this.Oed:(this.r0.e7a&&!this.Ew&&this.Jfn.Yj("Opened New menu",!0),b.PopulationXML=this.KJl(this.getTemplateListJson())));
return 32}lAi(){return!this.r0.e7a||!!this.Ew&&3===this.Ew.state&&!!this.Ew.a7a&&!!this.Ew.Lca}RPm(){return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa?!0:this.lAi()}getTemplateListJson(){if(!this.Uhe||!this.RPm())return null;if(this.VAc&&!this.zud){var b="9";w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=w.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in
h&&(b=h.NumberOfTemplatesInBackstage);let v=this.n7;"TemplateCollectionId"in h&&(v=h.TemplateCollectionId);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(v="WordConsumerWAC",b="23");b=String.format(this.r0.lRa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",G.a.Nj(w.AFrameworkApplication.lcid.toString()),G.a.Nj(v),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+w.AFrameworkApplication.NRd();w.AFrameworkApplication.e3a&&(b+="&"+w.AFrameworkApplication.oQd());this.r0.yZc.tj(b,1,null,null,!1,2,D=>{this.r0.OQa("CreateNewActor.GetTemplateListJson",D.data);this.eHo(D.data.we)},D=>{this.r0.OQa("CreateNewActor.GetTemplateListJson",D.data);this.dHo()},null,void 0,void 0,void 0,void 0,"5");this.VAc=!1}return this.Wvd}eHo(b){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.Wvd=this.bBl(b):this.Wvd=b;this.VAc=!1;this.A3c();if(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Lh.c()){b=w.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const h=w.AFrameworkApplication.mkb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Wvd,!0,b&&h))}}dHo(){this.zud=this.VAc=!0;this.A3c();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Lh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));wa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}bBl(b){b=JSON.parse(b);const h=new zb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const v=am.a.Qog(b,D=>h.contains(D.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(v));return JSON.stringify(b)}Ouf(b){var h=0;for(var v=0;v<b.length;v++)if("ST"===b[v].ImageType){h=v;break}const D=b.length?b[h]:null;b=D?D.Url||"":"";var Q;let ba=v=h=!1;if(D&&(Q=D.AspectRatio))Q=
parseFloat(Q),1>Q?h=!0:1.5<Q?v=!0:1===Q&&(ba=!0);else switch(u.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.r0.jxa){case 3:h=!0;break;case 2:v=!0;break;case 5:ba=!0}return{returnValue:b,Oum:h?"95by123":v?"123by69":ba?"100by100":"123by95"}}KJl(b){b=({Che:h}=this.qNk(b,this.d5d,this.d5d.rFc||"1056925771")).returnValue;if(h){this.Oed=b;var h=(new Date).getTime()-this.f6g;u.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:h})}return b}FEb(b,h){u.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Ew||3!==b.state?2===b.state&&(u.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.aSe=!0,this.A3c()):(this.Ew=b,h||this.A3c(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Lh.c()&&Lh.d("setFileMenuHostInformation")&&(b=Object.assign(new $k,{hostUrl:this.Ew.Lca,hostName:this.Ew.a7a,folderUrl:w.AFrameworkApplication.breadcrumbFolderUrl,
folderName:w.AFrameworkApplication.breadcrumbFolderName}),u.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}qNk(b,h,v){let D;D=!1;const Q=this.lAi();let ba="";this.r0.e7a&&(this.aSe?(ba=kg.Zxh(h),this.aSe=!1,u.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Ew?Q?ba=kg.tNk(h,this.Ew):this.Ew.ACm?(D=!0,this.VAc=!1,ba=kg.rNk(h,this.Ew),u.ULS.sendTraceTag(5849607,
202,50,"Rendering File>New with personal storage instantiation message")):(D=!0,ba=kg.Zxh(h),u.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Ew.Lca,["StorageServiceDisplayNameIsSet"]:!!this.Ew.a7a})):(ba=kg.sNk(h.labelText),u.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Q&&(ba+=kg.pNk(h,v,!ba)+({Che:D}=this.nOk(b,v)).returnValue);return{returnValue:kg.Dtl(ba),
Che:D}}nOk(b,h){let v;v=!1;if(!this.Uhe)return v=!0,u.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Che:v};let D="",Q="",ba="MenuTemplate";if(this.zud)D=kg.nyh(),this.zud=!1,u.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ta=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);D=this.mOk(ta,h);u.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");w.AFrameworkApplication.VPi&&
"OneDrive"===this.cGa&&(Q=kg.nNk(this.Kfn,w.AFrameworkApplication.VPi))}catch(ta){u.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),D=kg.nyh()}v=!0}else ba="MenuLoading",D=kg.oOk(),u.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:kg.pOk(ba,D)+Q,Che:v}}mOk(b,h){let v="";const D=[];for(let ba=0;ba<b.length;ba++){var Q=b[ba];let ta="";if(Q){const Ta=Q.Title,ob=Q.AssetId;Q=Q.Thumbnails;
ob&&Ta&&Q&&({Oum:Q,returnValue:ta}=this.Ouf(Q),v+=kg.kFc("jbtnNewTemplate"+ba,Ta,null,Q,null,ta,h,ob))}D[ba]=ta}b=new of.a(4,1,5E3,()=>{this.C6m(D)},106);this.r0.Z4d.Wb(b);return v}A3c(){this.cGe=!0;this.r0.LPi.FIa(this.d5d.mMc);this.cGe=!1}get r0(){return this.VAa.value}get d5d(){return this.Vsc.value}get Jfn(){return this.bWa.value}get Kfn(){return this.Kak.value}get cGa(){return this.lbb.value}get Uhe(){return this.fjk.value}}Object(n.a)(bg,"CreateNewActor",null,[]);class Hd{constructor(){this._initialized=
!1;this.lTe={}}QD(b){this.sWh();return this.get(b)}contains(b){this.sWh();return b.toString()in this.lTe}sWh(){this._initialized||(this.Auk(),this._initialized=!0)}qdb(b,h){this.lTe[b.toString()]=h}get(b){return this.lTe[b.toString()]}}Object(n.a)(Hd,"AIntlHelper",null,[]);class zd extends Hd{constructor(){super()}Auk(){this.qdb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.qdb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.qdb(2,CommonUIStrings.l_Open);this.qdb(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.qdb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.qdb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return zd._instance||(zd._instance=new zd)}static Zvn(b){return zd.instance.QD(b)}}zd._instance=null;Object(n.a)(zd,"MruActorIntlHelper",Hd,[]);var vf;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(vf||(vf={}));Object(n.b)("DisplayState",vf);class cg{constructor(b,h,v,D,Q,ba,ta,Ta){this.due=null;this.VWe=!0;this.Ned="";
this.fmk=0;this.DWb=null;this.HHe=3;this.Ma=Ta;this.VAa=b;this.dta=h;this.j2j=v;this.vXj=D;this.uXj=Q;this.bWa=new Fg.a(()=>new fm.a(ba.value,null));this.Z3j=new Fg.a(()=>new fm.a(ta.value,Object(z.a)(this,this.Aen,"mruEventResultReceived")));this.Ma.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ma.$("UiHostSupportsDocRebootFeatures")}Aen(b,h){this.DWb=b;h||this.U7i()}oWn(){this.OM.Sdc.fb(Ua.a.EZf,Kd.a.frame,Object(z.a)(this,this.EZf,"populateMruMenu"),96)}EZf(b,h,v,D,Q){return 1!==v&&Q?this.tDn(Q):
32}tDn(b){this.nul();this.mul();b.PopulationXML=kg.Etl(this.Ned+this.due);return 32}nul(){var b=3;let h=!1;if(this.Ned&&this.fmk===this.DWb.TIo)u.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.HHe;else{u.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var v=this.OM.fq();this.DWb=this.zen.Yj("File Open opened",!0);this.Ned&&2!==this.HHe&&3!==this.DWb.state?
h=!0:(b=this.wbm(this.DWb),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Lh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.Ned=({Afn:b}=this.LJl(this.DWb)).returnValue);v=this.OM.fq()-v;u.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:v})}2!==b&&(v={["DisplayState"]:vf[b]},1!==b&&(v.IsStale=h),u.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",v));this.HHe=
b}wbm(b){let h;try{h=F.c(b.PNf)}catch(v){h=null,u.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",v)}return h}mul(){this.VWe?(u.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.due=({V1o:this.VWe}=this.N8m()).returnValue):u.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");u.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.VWe,
["NotDisplayingLink"]:!this.due})}LJl(b){let h;1===b.state||0===b.state?(u.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=kg.Vxh(this.z1a(2),this.z1a(5))):3===b.state&&b.PNf?(h=this.oNk(b.PNf),b=0):(u.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=kg.pFc(this.z1a(1),this.z1a(2)),b=1);return{returnValue:h,Afn:b}}oNk(b){let h;const v=this.RYc.rFc||"2155708348";if(b.length){h=kg.oFc("lblRecentDocuments",this.z1a(3));
let D=0;for(let Q=0;Q<b.length;Q++){const ba=b[Q];"FileName"in ba&&"DocumentUrl"in ba&&"Path"in ba&&(h+=kg.kFc("MruButton"+Q,ba.FileName.toString(),ba.Path.toString(),null,this.RYc.Z1a,this.RYc.ARc,v,ba.DocumentUrl.toString()),ba.IsPinned&&D++)}h=kg.yZa("RecentDocumentsMenuSection",kg.$Oi,this.z1a(2),h);u.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:D})}else h=kg.pFc(this.z1a(0),this.z1a(2)),u.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}N8m(){let b;b=!0;let h=this.xLk;var v=this.wLk;if(h&&v||!this.OM.e7a)b=!1;else{const D=this.uQd.Yj("File Open",!1);3===D.state&&(h=D.Lca,v=D.a7a,b=!1)}v=v?String.format(this.z1a(4),v):null;return{returnValue:kg.eMk(this.RYc.rFc,v,h),V1o:b}}U7i(){this.OM.LPi.FIa(this.RYc.mMc)}get OM(){return this.VAa.value}get z1a(){return this.dta.value}get RYc(){return this.j2j.value}get xLk(){return this.vXj.value}get wLk(){return this.uXj.value}get uQd(){return this.bWa.value}get zen(){return this.Z3j.value}}
Object(n.a)(cg,"MruRenderer",null,[]);var og=c(1552);class be{constructor(b,h,v,D,Q,ba,ta){this.Ew=null;this.Ydh=!1;this.Zra=this.L1=0;this.$ak=b;this.dXb=h;this.bpd=v;this.Vsc=D;this.lbb=Q;this.VAa=ba;this.bWa=new Fg.a(()=>new fm.a(ta.value,Object(z.a)(this,this.FEb,"getMoreInfoEventReceived")))}mIc(){!this.Ew&&this.oQf.e7a?this.uQd.Yj("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}FEb(b){if(!this.Ew&&3===b.state)this.Ew=b;else if(2===b.state){this.Ydh?u.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.uQd.Yj("NewDocumentFromStream",!0),this.Ydh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.L1=(new Date).getTime();var b=this.rAl.DLh;if(null===b)this.dXb(null);else{var h=this.bpd.menuItemId,v=this.bpd.LHa,D=this.bpd.MCo,Q=this.bpd.zAl;this.Zra="streamBase64"===D?Q.length/1024:0;u.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.n7,this.Zra);var ba=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,G.a.Nj(this.cGa),G.a.Nj(h),G.a.Nj(this.n7),G.a.Nj(w.AFrameworkApplication.lcid.toString()),G.a.Nj(ba.toString()),G.a.Nj(v),G.a.Nj(w.AFrameworkApplication.canary),w.AFrameworkApplication.hm,G.a.Nj(D));b+="&"+w.AFrameworkApplication.NRd();w.AFrameworkApplication.e3a&&(b+="&"+w.AFrameworkApplication.oQd());(h=this.Ew?this.Ew.Lca:null)&&(b+="&DestinationUrl="+G.a.Nj(h));this.oQf.yZc.tj(b,2,Q,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.Efn,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.Cfn,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Efn(b){if(b&&b.data&&b.data.we)if(({Yu:h}=F.d(b.data.we)).returnValue)if(b=h,b.StatusCode!==ha.a.Jy&&b.StatusCode!==ha.a.zIc)u.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.n7,this.Zra,b.StatusCode),this.dXb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.L1;u.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.n7,this.Zra,h);this.$ak(b.NewDocumentUrl)}else u.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.n7,this.Zra),this.dXb(null);else u.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.n7,this.Zra,{["ResponseData"]:og.a.Y$c(b.data.we)}),this.dXb(null);else u.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.n7,this.Zra),this.dXb(null)}Cfn(b){b&&b.data&&u.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.n7,this.Zra,b.data.status);this.dXb(null)}get n7(){switch(this.oQf.jxa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get rAl(){return this.Vsc.value}get cGa(){return this.lbb.value}get oQf(){return this.VAa.value}get uQd(){return this.bWa.value}}
Object(n.a)(be,"NewDocumentFromStreamOperation",null,[]);class jd{constructor(b,h,v,D){this.Vsc=b;this.lbb=h;this.VAa=v;this.Y3j=D}create(b,h,v){return new be(b,h,v,this.Vsc,this.lbb,this.VAa,this.Y3j)}}Object(n.a)(jd,"NewDocumentFromStreamOperationFactory",null,[806]);var ak=c(128);class sh{get name(){return"Common.App.NewAndOpen.UX"}xc(b){b.register(jd,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Rd(()=>
new jd(new Fg.a(()=>w.AFrameworkApplication.ta.Nb.Jpf()),new Fg.a(()=>w.AFrameworkApplication.cGa),new Fg.a(()=>b.Na("Common.INewAndOpenCommonHelpers")),new Fg.a(()=>b.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){w.AFrameworkApplication.K.Po(()=>{this.h2a()})}h2a(){const b=Tb.a.Bp(Ga.a.instance.Sa("Common.INewAndOpenCommonHelpers")),h=Tb.a.Bp(Ga.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));w.AFrameworkApplication.cGa&&ak.Task.WAA.call(null,b,h).continueWith(()=>
{const v=new bg(new Fg.a(()=>b.result),new Fg.a(()=>w.AFrameworkApplication.ta.Nb.Jpf()),new Fg.a(()=>h.result),new Fg.a(()=>w.AFrameworkApplication.ta.Nb.Kpf().rFc||"1959943459"),new Fg.a(()=>w.AFrameworkApplication.cGa),new Fg.a(()=>w.AFrameworkApplication.vNm));v.Tb();v.A3c()});if(w.AFrameworkApplication.I2f){const v=Tb.a.Bp(Ga.a.instance.Sa("Common.IEventEmitter<Common.IMruResult>"));ak.Task.WAA.call(null,b,h,v).continueWith(()=>{const D=new cg(new Fg.a(()=>b.result),new Fg.a(()=>zd.Zvn),new Fg.a(()=>
w.AFrameworkApplication.ta.Nb.Kpf()),new Fg.a(()=>w.AFrameworkApplication.Yvn),new Fg.a(()=>w.AFrameworkApplication.Xvn),new Fg.a(()=>h.result),new Fg.a(()=>v.result),w.AFrameworkApplication.K);D.oWn();D.U7i()})}}dispose(){}}Object(n.a)(sh,"UXPackageManager",null,[1,2,10]);var pg=c(175);class ul extends pg.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}sO(b){this.mx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}fff(b){this.mx(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(n.a)(ul,"ErrorDialog",pg.StandardDialog,[790]);var jh=c(458);class ag{E3h(){u.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new jh.a;b.zg("api.onedrive.com");return b.task}}Object(n.a)(ag,"OneDriveConsumerEndpointHelper",null,[764]);var Uf=c(50);class Dk{constructor(b,h,v,D){this.Pvb=this.jGa=null;this.sRe=this.uRe=!1;this.oXb=null;this.Ma=b;this.pSb=h;this.Zub=v;this.gH=D}get Trh(){return this.pSb}get K(){return this.Ma}V7b(){this.oXb||
(this.oXb=this.$ec?Xa.a.create(this.$ec,null,null,null,!1):null);return this.oXb}setup(b){this.Pvb=b;this.uRe||this.sRe?this.uRe&&this.Pvb&&this.Pvb(!0):(b=this.V7b())?(this.sRe=!0,b.N3a.continueWith(h=>{this.iqn(h)}),Ib.a.rX(b)):(u.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Pvb(!1))}nUf(b){u.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}iqn(b){this.sRe=
!1;if(b.Ci)this.nUf(b),this.Pvb(!1);else try{this.uRe=!0,u.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Czf(),u.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Pvb(!0)}catch(h){u.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.Pvb(!1)}}c9c(b){this.jGa=b;this.Zub?u.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(u.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.oSf,"onApiReady")))}oSf(b){b?this.w0d():this.zp()}zp(){this.gH().sO(Uf.a.ivn)}onSuccess(b){u.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.jGa&&this.jGa(!0,b)}dispose(){this.oXb&&this.oXb.dispose()}}Object(n.a)(Dk,"AOneDriveFilePickerApiManager",null,[800,10]);class ve extends Dk{constructor(b,h,v,D,Q,ba){super(h,v,D,ba);this.Um=null;this.$sa=b;this.njk=Q}get $ec(){return this.K.jb("OneDriveApiUrl")}start(b,h){this.Um=
b;this.c9c(h)}Czf(){WL.init(1===this.Trh||2===this.Trh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}c9c(b){this.jGa=b;!this.Zub&&this.$sa.jTc?(u.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.oSf,"onApiReady"))):(u.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.njk())}w0d(){try{u.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Um).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){u.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.zp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){u.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}u.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else u.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.jGa&&this.jGa(!1,b);this.zp()}}Object(n.a)(ve,"OneDriveFilePickerApiManagerV5",Dk,[]);class Hf extends Dk{constructor(b,h,v,D,Q){super(b,h,v,D);this.ikd=this.p9g=null;this.w1j=Q;this.options={};this.options.clientId=this.K.jb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.Fle,"toggleHostDivVisibility")}get $ec(){return this.K.jb("OneDriveApiV72Url")}start(b,h){this.ikd=h;const v=
this.w1j.E3h();v.continueWith(()=>{u.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.p9g=v.result;this.c9c((D,Q)=>{this.Fle();b(D,Q)})},3);v.continueWith(()=>{u.ULS.sendTraceTag(24134242,352,15,v.exception.message);this.Fle()},5)}Czf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.p9g;this.options.advanced.iframeParentDiv=this.ikd}w0d(){try{u.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Fle(),OneDrive.open(this.options)}catch(b){u.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.zp()}}onFailure(b){this.jGa&&this.jGa(!1,b);this.zp()}Fle(){this.ikd.style.visibility="hidden"===this.ikd.style.visibility?"":"hidden"}}Object(n.a)(Hf,"OneDriveFilePickerApiManagerV7",Dk,[]);class ej extends Dk{constructor(b,
h,v,D){super(b,h,v,D);this.KVj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.jb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get $ec(){return this.K.jb("OneDriveApiV72Url")}start(b,h,v,D){this.options.advanced.iframeParentDiv=v;this.options.advanced.endpointHint=D;this.options.cancel=h;this.KVj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.c9c(b)}c9c(b){this.jGa=b;this.Zub?u.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(u.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.oSf,"onApiReady")))}Czf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}w0d(){try{u.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){u.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.zp()}}nUf(b){u.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Ib.a.b_n(this.$ec);this.oXb=null}zp(){this.gH().fff(Uf.a.P9n)}onFailure(b){this.jGa&&this.jGa(!1,b)}}Object(n.a)(ej,"OneDriveFilePickerApiManagerV72",
Dk,[]);class vj{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(n.a)(vj,"IExtraData",null,[]);class Xh extends ej{constructor(b,h,v,D){super(b,h,v,D);this.options.advanced.filter=b.jb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=w.AFrameworkApplication.fsh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.jb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new vj(w.AFrameworkApplication.userSessionId))}get $ec(){return this.K.jb("OneDriveApiV72Url")}w0d(){try{u.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",w.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){u.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.zp()}}}Object(n.a)(Xh,"OneDriveFilePickerApiOpenManagerV72",ej,[]);class dg{constructor(b){this.Xp=null;this.Yf=b;this.KPe=3}E3h(){this.Xp=new jh.a;u.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.V9f();return this.Xp.task}V9f(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",w.AFrameworkApplication.BBb);this.Yf.$yb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.S2l,"getMoreInfoSucceeded"),Object(z.a)(this,this.Q2l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}Q2l(b){if(b.data.Qe===ha.a.sia&&"X-NewKey"in b.data.wj){u.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.wj["X-NewKey"];this.V9f(h)}else 0<this.KPe?(u.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.KPe),this.KPe--,this.V9f()):(u.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Xp.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}S2l(b){"PersonalFileStorageUrl"in b.data.wj&&""!==b.data.wj.PersonalFileStorageUrl?(u.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Xp.zg(b.data.wj.PersonalFileStorageUrl)):(u.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Xp.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(n.a)(dg,"OneDriveForBusinessEndpointHelper",null,[764]);var ll=c(745);class gi{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}xc(b){this.W=b;this.W.register(ve,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Rd(()=>new ve(ll.a.instance,w.AFrameworkApplication.K,
w.AFrameworkApplication.a8,w.AFrameworkApplication.Woa,w.AFrameworkApplication.ueg,()=>new ul));w.AFrameworkApplication.QHb?this.W.register(764,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Rd(()=>new ag):this.W.register(764,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Rd(()=>new dg(w.AFrameworkApplication.Ne));this.W.register(Hf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Rd(()=>new Hf(w.AFrameworkApplication.K,
w.AFrameworkApplication.a8,w.AFrameworkApplication.Woa,()=>new ul,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(ej,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Rd(()=>new ej(w.AFrameworkApplication.K,w.AFrameworkApplication.a8,w.AFrameworkApplication.Woa,()=>new ul));this.W.register(Xh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Rd(()=>new Xh(w.AFrameworkApplication.K,
w.AFrameworkApplication.a8,w.AFrameworkApplication.Woa,()=>new ul))}static main(){N.a.instance.Fc(new gi)}}Object(n.a)(gi,"PackageManager",null,[1,2]);class Gm{constructor(b,h,v,D,Q,ba){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=v;this.PolicyCookieTTL=D;this.WasServiceDown=Q;this.AffinitizedUrl=ba}}Object(n.a)(Gm,"SafeLinksData",null,
[]);class An{constructor(b,h){this.Pke=b;this.UA=h}}Object(n.a)(An,"SafeLinksGetUrlReputationRequestData",null,[]);class qg{constructor(b,h,v,D){this.Ma=b;this.Yf=h;this.s4j=v;qg.ge=D}Ylc(b,h,v){try{var D=null;qg.ge&&(D=qg.ge.$f("WebServiceCall","SafeLinksGetUrlReputation"));const Q=new An(h,D);D={};D.AffinitizedUrl=b;D.TargetUrl=h;D.PolicyCookie=v;const ba=F.c(D);this.Yf.tj(this.s4j,2,ba,null,!1,2,Object(z.a)(this,this.Pnn,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.Onn,"onGetUrlReputationFailureCallback"),
Q,void 0,void 0,3E3,3E3,"36");return!0}catch(Q){u.ULS.sendTraceTag(588788033,378,10,Q.message)}return!1}Pnn(b){let h="OnGetUrlReputationSuccessCallback: ",v=10;const D=b.data.state;try{const Q=F.b(b.data.we).reputationResults[0],ba=Q.navigateUrl.length,ta=D.Pke.length,Ta=Q.navigateUrl===D.Pke;Q.navigateUrl&&0<Q.navigateUrl.length&&(D.Pke=Q.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Qe,Q.verdict,
ta.toString(),ba.toString(),Ta.toString());v=50}catch(Q){h+=String.format("Exception {0}",Q.message)}this.Qki(D,h,v)}Onn(b){let h="OnGetUrlReputationFailureCallback: ";const v=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Qe)}catch(D){h+=String.format("Exception {0}",D.message)}this.Qki(v,h,10)}Qki(b,h,v){b.UA&&(b.UA.stop(),b.UA=null);u.ULS.sendTraceTag(588788034,378,v,h);Id.a.om(b.Pke,void 0,"noopener,noreferrer","SafeLinksNav")}}qg.ge=null;Object(n.a)(qg,"SafeLinksNavigationHelper",
null,[]);var xk;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(xk||(xk={}));Object(n.b)("SafeLinksNavigationState",xk);class Gj{constructor(b,h,v,D=!1,Q=null,ba=null){this.Ftb=this.Etb=0;this.eUc=this.Cjd=!1;this.Fbb=null;this.mWb=!0;this.Vtd=null;u.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Ma=b;this.Yf=h;this.Oda=v;Gj.ge=ba;this.gok=D?this.Ma.jb("SafeLinksHandlerWebServiceBase"):this.Ma.jb("WebServiceBase");this.znk=this.Ma.jb("SafeLinksHashedUserId");this.a6o=this.Ma.jb("SafeLinksWorkloadIdHeaderValue");this.ood=this.Ma.mc("SafeLinksMaxGetPolicyBootRetries",2);this.pod=this.Ma.mc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Sld=this.HQm();this.Rld=this.GQm();u.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Sld,this.Rld);
if(this.Sld&&this.Rld){h=(b=this.ehb())?b.IsSafeLinksEnabled.toLowerCase():"";v=this.ZEf();u.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,v);var ta=!b||"unknown"===h||b.WasServiceDown||v,Ta=kb.a.fG();Ta&&(Ta.set("shouldGetSafeLinksDataFromServer",ta.toString()),Ta.set("isSafeLinksEnabledCacheValue",h.toString()));Q?(this.mWb=!1,Q.execute(ob=>{ob.isFeatureEnabled("MsoUrlreputation",!0).then(Kb=>{this.mWb=Kb;Ta.set("isUserLicensedForSafeLinks",
this.mWb.toString());wa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ta);this.mWb&&ta&&this.GRd(!0);return null})})):(wa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ta),ta&&this.GRd(!0))}}get appName(){return this.Oda}get Loe(){return this.gok}get userId(){return this.znk}get O7l(){const b=this.Loe?this.Loe+"/":"",h=new fb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ce("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&h.Ce("action","debug");
this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ce("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Ce("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),w.AFrameworkApplication.hm)}get chm(){const b=this.Loe?this.Loe+"/":"",h=new fb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ce("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&h.Ce("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&h.Ce("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Ce("s2saat","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Ce("s2se03","1");h.Ce("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),w.AFrameworkApplication.hm)}get gfn(){Gj.vQe||(Gj.vQe=new qg(this.Ma,this.Yf,this.chm,Gj.ge));return Gj.vQe}Ylc(b){if(!b)return u.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var h=this.aLm(b);u.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.Sld,this.Rld,this.mWb);if(!(h&&this.Sld&&this.Rld&&this.mWb))return!1;h=0;const v=({state:h}=this.tto()).returnValue;u.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",xk[h]);const D=kb.a.fG();D&&D.set("SafeLinksNavigationState",xk[h]);wa.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",D);if(!v)return 2!==h&&3!==h||wa.Health.instance.recordKpiFailure("SafeLinksNavigations",xk[h],!1,!0,null),!1;u.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.Rto())return this.ZEf()?!1:this.gfn.Ylc(this.NKl(),b,this.xdi());if(!this.ZEf())return this.eCj(b),!0;this.Fbb=b;u.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.eUc=!1;this.GRd();return!0}aLm(b){b=b.toLowerCase();const h=this.Ma.KC("SafeLinksUnsupportedProtocols");
if(h)for(let v=0;v<h.length;v++)if(b.startsWith(h[v]))return!1;return!0}GRd(b=!1){var h=kb.a.fG();h&&h.set("isOnBootRequest",b.toString());wa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);wa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.E$e("SafeLinksGetPolicy");this.Yf.tj(this.O7l,1,null,null,!0,2,Object(z.a)(this,this.nam,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.mam,"getSafeLinksDataFromServer_OnFailureCallback"),
h,void 0,void 0,void 0,void 0,"23");this.eUc=b;this.Cjd=!0;b?this.Etb++:this.Ftb++}nam(b){let h=ha.a.Qgn,v="";try{this.Cjd=this.eUc=!1;var D=b.data.state;const Dc=({UA:D}=this.Ije(D)).returnValue,Oc=Object.assign(new wb.a,{durationMs:Dc});wa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Oc);u.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Qe,b.data.we.length,Dc);if(b.data.Qe!==ha.a.Jy)v=
"Unexpected httpStatus: "+b.data.Qe.toString();else{D=null;try{D=F.b(b.data.we)}catch(gd){v="Exception:"+gd.toString()+" deserializing response";return}if(D){var Q=D.IsSafeLinksEnabled;if(void 0===Q||null===Q||0>=Q.length)v="Invalid isSafeLinksEnabledString";else{u.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Q);var ba=Gj.fYf(Q);if(void 0===D.WebAffinitizedUrl||null===D.WebAffinitizedUrl||0>=D.WebAffinitizedUrl.length)v="Invalid WebAffinitizedUrl";else if(void 0===D.PolicyCookie||
null===D.PolicyCookie||0>=D.PolicyCookie.length)v="Invalid PolicyCookie";else if(void 0===D.PolicyCookieTTL||null===D.PolicyCookieTTL)v="Invalid PolicyCookieTTL";else{var ta=D.WebAffinitizedUrl,Ta=D.PolicyCookie,ob=D.AffinitizedUrl,Kb=new Date;Kb.setMinutes(Kb.getMinutes()+(5<D.PolicyCookieTTL?D.PolicyCookieTTL-5:0));var Vb=Kb.getTime(),bc=new Gm(Q,ta,Ta,Vb,!1,ob);this.yjj(bc);h=b.data.Qe;this.Fbb&&(ba?(this.eCj(this.Fbb),this.Ftb=this.Etb=0):(u.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),
wa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Id.a.oDb(this.Fbb)),this.Fbb=null)}}}else v="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Dc){v="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Dc.toString()}finally{h!==ha.a.Jy&&this.Pki(h,v)}}mam(b){this.Cjd=!1;let h=500,v="";try{let D=b.data.state;const Q=({UA:D}=this.Ije(D)).returnValue,ba=Object.assign(new wb.a,{durationMs:Q});h=b.data.Qe;wa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+h.toString(),!1,!0,ba);v="Request Failed, Status="+Tg.a[b.data.status]+" Duration: "+Q}catch(D){v="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+D.toString()}finally{this.Pki(h,v)}}Pki(b,h=""){try{if(u.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.Etb<this.ood&&this.Ftb<this.pod)this.GRd(this.eUc);else{this.eUc=!1;u.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.Etb,this.Ftb,b,h);h=null;const v=kb.a.fG();v&&(v.set("HttpStatus",b.toString()),h=Object.assign(new wb.a,{extendedProperties:v}));wa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const D=new Gm("false","","",0,!0,"");this.yjj(D);this.Fbb&&(u.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),wa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Id.a.oDb(this.Fbb),this.Fbb=null)}}catch(v){u.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",v.toString())}}eCj(b){const h=this.xdi(),v=this.pim(),D={};D.Url=b;D.SafeLinksCookie=h;D.CorrelationId=sb.a.create().toString();D.WorkloadId=this.a6o;D.UserAgentInfo=aa.a.bG+"|"+this.appName;u.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",D.CorrelationId);Id.a.PZf(Id.a.dra(4),v,D)}HQm(){const b=this.Ma.jb("IsSafeLinksEnabledForUser");
return b?Gj.fYf(b):!1}GQm(){const b=this.Ma.KC("SafeLinksDisabledBrowsers");if(aa.a.c4){if(this.Ma.Sw("SafeLinksForTeamsIsEnabled")&&this.Ma.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,aa.a.bG))return!1;return"officecomhwa"===(this.Ma.jb(w.AFrameworkApplication.vja)||"").toLowerCase()?!1:!0}Rto(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&aa.a.IUc?!0:aa.a.c4}tto(){let b;b=0;const h=this.ehb(),v=h?h.IsSafeLinksEnabled:"";if(""!==v)return h.WasServiceDown?(u.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===v.toLowerCase()?(u.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:Gj.fYf(v),state:b};if(this.Cjd)return b=3,u.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.Etb>=
this.ood||this.Ftb>=this.pod)return b=2,u.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.Etb,this.ood,this.Ftb,this.pod),{returnValue:!1,state:b};u.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.ood+this.pod-(this.Etb+this.Ftb));return{returnValue:!0,state:b}}xdi(){const b=
this.ehb();return b?b.PolicyCookie:""}pim(){const b=this.ehb();return b?b.WebAffinitizedUrl:""}NKl(){const b=this.ehb();return b?b.AffinitizedUrl:""}eVl(){const b=new Date;try{const h=this.ehb();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){u.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}ZEf(){const b=this.eVl();return!!b&&b.getTime()<Date.now()}ehb(){if(!this.Vtd){const b=eb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Vtd=
JSON.parse(b)}return this.Vtd}yjj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Vtd=b;b.WasServiceDown||this.p6o(b)}p6o(b){b=JSON.stringify(b);eb.a.instance.setItem(this.userId,b)}E$e(b){return void 0!==Gj.ge&&null!==Gj.ge?Gj.ge.$f("WebServiceCall",b):null}Ije(b){if(void 0!==b&&null!==b){const h=b.ti;b.stop();return{returnValue:h,
UA:null}}return{returnValue:null,UA:b}}static fYf(b){return"false"!==b.toLowerCase()?!0:!1}}Gj.ge=null;Gj.vQe=null;Object(n.a)(Gj,"SafeLinksManager",null,[791]);const Of=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},hm=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class fe{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}xc(b){this.W=
b}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Mx,"onFullAppSettingsReady"))}dispose(){}Mx(){w.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(Gj,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Rd(()=>new Gj(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne,String.format("{0}-{1}",Of(w.AFrameworkApplication.ta.Nb.Sl),hm(w.AFrameworkApplication.ta.Nb.Sha)),!1,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
w.AFrameworkApplication.ta.Gq)),this.W.Na("Common.App.SafeLinks.ISafeLinksManager"))}static main(){N.a.instance.Fc(new fe)}}Object(n.a)(fe,"SafeLinksPackage",null,[1,2]);var Ti=c(229);class Ek{constructor(b){this.ra=new cf.a;this.Mh=b}tdb(b){this.ra.addHandler(Ek.zya,b)}p4c(b){this.ra.removeHandler(Ek.zya,b)}YYa(b){this.ra.addHandler(Ek.STa,b)}RMb(b){this.ra.removeHandler(Ek.STa,b)}m_e(b){this.ra.addHandler(Ek.xlc,b)}Pdg(){this.ra.raiseEvent(Ek.zya)}kxf(){return Ti.a.instance.qQa(w.AFrameworkApplication.Yy)}}
Ek.zya="SE";Ek.x6c="SEP";Ek.STa="SER";Ek.xlc="TRP";Object(n.a)(Ek,"NullSessionExpirationManager",null,[757,758]);class rg{constructor(){this.OAc=this.rcb=!1;const b=w.AFrameworkApplication.Yy;0>=b||(this.Yy=b,u.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Yy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:w.AFrameworkApplication.WW}),Ti.a.instance.tqh(Object(z.a)(this,this.Qec,"onSessionExpiredDetected")),Ti.a.instance.sqh(Object(z.a)(this,
this.V_c,"onSessionExpiringDetected")))}Qec(){Ti.a.instance.Oaj(Object(z.a)(this,this.Qec,"onSessionExpiredDetected"));u.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Ewf()}V_c(){Ti.a.instance.Q0n(Object(z.a)(this,this.V_c,"onSessionExpiringDetected"));this.OAc||this.rcb||(u.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.OAc=!0,this.weg())}Ewf(){this.rcb||(w.AFrameworkApplication.YM(Uf.a.w6c),this.rcb=!0,this.Eie())}}Object(n.a)(rg,"ASessionExpirationManager",
null,[]);var Vf=c(174),lh=c(274);class qj{constructor(b,h,v,D){this.Oig="";this.sdd=b;this.Meh=v;this.Ieh=D;this.e0g=h;b=(new Date(this.sdd)).format(w.AFrameworkApplication.Uoj);this.Oig=this.e0g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}xic(b){1===b?this.Meh&&this.Meh(this.e0g):0===b&&w.AFrameworkApplication.va.Qb(Ua.a.close,2,lh.g)}dispose(){this.Ieh&&this.Ieh()}}qj.id="SessionExpirationDialog";Object(n.a)(qj,"SessionExpirationDialogSharedProperties",
null,[]);class lm{}lm.Xg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(n.a)(lm,"SessionExpirationDialogHtml",null,[]);class Nd extends Vf.a{constructor(b,h,v,D){super(h);const Q={};this.aYa=new qj(b,h,v,D);this.wg=qj.id;w.AFrameworkApplication.oAh?(this.Ad=1,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.yt=!1);h||1===w.AFrameworkApplication.ta.mode?this.Ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Xg=lm.Xg;Q.WACSessionExpirationText=this.aYa.Oig;this.Yh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.xic,"sessionExpirationDialogHandler"),Q);this.e5(this.kj("WACSessionExpirationText"))}xic(b){this.aYa.xic(b)}Exf(){this.hide()}dispose(){super.dispose();this.aYa&&this.aYa.dispose()}}Object(n.a)(Nd,"LegacySessionExpirationDialog",Vf.a,[837]);class Un extends pg.StandardDialog{constructor(b,h,v,D){super(h);this.aYa=
new qj(b,h,v,D);this.wg=qj.id;w.AFrameworkApplication.oAh?(this.Ad=1,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.yt=!1);h||1===w.AFrameworkApplication.ta.mode?this.Ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Ju(CommonUIStrings.l_DefaultDialogTitle,this.aYa.Oig,0,Object(z.a)(this,this.xic,"sessionExpirationDialogHandler"))}xic(b){this.aYa.xic(b)}Exf(){this.hide()}dispose(){super.dispose();this.aYa&&this.aYa.dispose()}}
Object(n.a)(Un,"SessionExpirationDialog",pg.StandardDialog,[837]);const Ad=(b,h,v,D)=>w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.lF&&w.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Un(b,h,v,D):new Nd(b,h,v,D);var ml=c(199);class Pf extends rg{constructor(b){super();this.xud=this.iZb=!0;this.IZ=null;this.ra=new cf.a;this.Mh=b}tdb(b){this.ra.addHandler(Pf.zya,b)}p4c(b){this.ra.removeHandler(Pf.zya,b)}YYa(b){this.ra.addHandler(Pf.STa,b)}RMb(b){this.ra.removeHandler(Pf.STa,
b)}m_e(b){this.ra.addHandler(Pf.xlc,b)}kxf(){return Ti.a.instance.qQa(w.AFrameworkApplication.Yy)}Pdg(b){this.iZb=b}weg(){if(!this.IZ&&!ml.a.lM){if(this.xud){const b=Object(z.a)(this,this.L4b,"disposeCallback");this.IZ=Ad(this.Yy,!1,Object(z.a)(this,this.yic,"sessionExpirationHandler"),b)}this.ra.raiseEvent(Pf.x6c)}}Eie(){this.IZ&&(this.IZ.tha&&this.IZ.Exf(),this.IZ=null);if(this.iZb){const b=Object(z.a)(this,this.L4b,"disposeCallback");this.IZ=Ad(this.Yy,!0,Object(z.a)(this,this.yic,"sessionExpirationHandler"),
b)}this.ra.raiseEvent(Pf.zya)}L4b(){this.IZ=null}yic(b){(b||this.Mh.nBd())&&this.Mh.refreshDocument(null)}}Pf.zya="SE";Pf.x6c="SEP";Pf.STa="SER";Pf.xlc="TRP";Object(n.a)(Pf,"SessionExpirationManager",rg,[757,758]);class sg{}sg.Nok="Aborting";sg.zyd="ActivityDuration";sg.error="Error";sg.kif="Errors";sg.failed="Failed";sg.eDb="FirstActivity";sg.initialized="Initialized";sg.kickedOut="KickedOut";sg.BWm="LastActivity";sg.aej="RetryOverride";sg.Jde="RequestGroups";sg.Dnb="Requests";sg.Vde="Responses";
sg.Cfe="SessionDuration";sg.status="Status";sg.success="Success";sg.xDo="Successful";sg.tokens="Tokens";sg.pZf="PollingDuration";Object(n.a)(sg,"SessionExpirationStrings",null,[]);class cb{constructor(b){this.gC={};this.Mja={};this.mXa={};this.mJi=15;this.X1g=!1;this.cik=new Date;this.hnd=new Date;this.Hb=b;this.SN=new of.a(2,2,6E4*this.mJi,Object(z.a)(this,this.kLj,"writeMeasures"),135,"SL",!1);this.Hb.Wb(this.SN);this.Hym()}kLj(){u.ULS.sendTraceTag(41964821,217,50,u.ULS.CWc({["Aggregate"]:this.Mja,
["Current"]:this.gC}))}Hym(){this.Mja[sg.Jde]=0;this.Mja[sg.Dnb]=0;this.Mja[sg.Vde]=0;this.Mja[sg.status]=sg.initialized;this.Mja[sg.eDb]=new Date;this.Mja[sg.Cfe]=0;this.Mja[sg.zyd]=0;this.Mja[sg.Cfe]=0;this.gC[sg.Cfe]=0;this.Mja[sg.zyd]=0;this.gC[sg.zyd]=0}get KCn(){this.mXa[sg.pZf]=+new Date-+this.mXa[sg.eDb];return this.mXa}izf(b,h){var v=b[h];v=v?v:0;v++;b[h]=v;this.Hag(b)}Hag(b){const h=new Date;b[sg.zyd]=+h-+this.hnd;this.hnd=h;b[sg.Cfe]=+this.hnd-+this.cik;b[sg.BWm]=this.hnd}P9(b,h){this.gC[b]=
h;this.Hag(this.gC)}Y$f(b,h){this.gC[b]=h;this.Hag(this.gC)}X9b(b){this.izf(this.gC,b);this.izf(this.Mja,b);this.izf(this.mXa,b)}flush(){this.X1g||(this.Mja[sg.status]=this.gC[sg.status],this.kLj(this.SN),this.Hb.J0(this.SN,6E4*this.mJi))}M4n(){const b=this.gC[sg.status];b&&(this.Mja[sg.status]=b);this.gC={}}c5n(){this.mXa={};this.mXa[sg.pZf]=0;this.mXa[sg.eDb]=new Date}stop(){u.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.X1g=!0;this.Hb.We(this.SN)}}
Object(n.a)(cb,"SessionLogger",null,[753]);class Jb{constructor(b,h){this.wwd=b;this.qAa=h}get tokens(){return this.wwd}get errors(){return this.qAa}}Object(n.a)(Jb,"TokenRefreshArgs",null,[793]);var ac=c(397);class Ec extends Sys.EventArgs{constructor(b,h,v,D,Q,ba,ta){super();this.mXa=b;this.BCn=h;this.Jde=D;this.failed=Q;this.Dnb=ba;this.Vde=ta}}Object(n.a)(Ec,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Lc=c(34);class kd{constructor(b,h=null,v=null){this.OAc=this.rcb=!1;this.xud=this.iZb=
!0;this.ra=new cf.a;this.QAc=this.Pvc=this.jsd=!1;this.swb=null;this.mah=10;this.wmd=!1;this.YUe=b;this.MGe=w.AFrameworkApplication.DUm;this.Hb=xb.a.instance;u.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:w.AFrameworkApplication.Yy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:w.AFrameworkApplication.WW});this.ye=h||new cb(xb.a.instance);this.rla=v;Ti.a.instance.tqh(Object(z.a)(this,this.Gok,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));
Ti.a.instance.sqh(Object(z.a)(this,this.DXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ac.SessionStatusManager.instance.j_e(Object(z.a)(this,this.DXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ac.SessionStatusManager.instance.eyk(Object(z.a)(this,this.CEn,"preemptiveTokenRefresh"));this.q3g=new Date;w.AFrameworkApplication.CUm&&(Ti.a.instance.P5e=Object(z.a)(this,this.ESn,"refreshAccessTokenWhenSessionExpired"));b=!1;w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",
!1),this.mah=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=w.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));b?ac.SessionStatusManager.instance.j_e(Object(z.a)(this,this.Hok,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):ac.SessionStatusManager.instance.j_e(Object(z.a)(this,this.DXe,
"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}tdb(b){this.ra.addHandler(kd.zya,b)}p4c(b){this.ra.removeHandler(kd.zya,b)}YYa(b){this.ra.addHandler(kd.STa,b)}RMb(b){this.ra.removeHandler(kd.STa,b)}m_e(b){this.ra.addHandler(kd.xlc,b)}kxf(){return Ti.a.instance.qQa(w.AFrameworkApplication.Yy)}ESn(){this.tQc(!1);return!Ti.a.instance.qQa(w.AFrameworkApplication.Yy)}Gok(b,h){Ti.a.instance.j_d?this.Qec(b,h):this.MGe?(this.Pvc=!1,this.tQc(!1)):(this.rcb||u.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.Qec(b,h))}Hok(b,h){Ti.a.instance.i_d?this.V_c(b,h):(Lc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.Pvc=!1,this.tQc(!0))}DXe(b,h){Ti.a.instance.i_d?this.V_c(b,h):this.tQc(!0)}tQc(b){if(!this.jsd&&!this.Pvc)if(this.rla&&this.rla.Ao)this.QAc=!0,this.ye.P9(sg.status,sg.kickedOut),this.ye.flush(),this.ye.stop();else if(u.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.QAc),this.QAc)this.Eie();else{this.ye.flush();
this.ye.M4n();this.ye.X9b(sg.Jde);this.jsd=!0;this.wmd||(this.ye.c5n(),this.wmd=!0,this.e8k());const h=this.YUe.YSn(b);h.continueWith(()=>{if(this.YUe.FIn(h))this.ye.X9b(sg.xDo),this.ye.P9(sg.status,sg.success),this.xud=!1,this.MGe&&(this.iZb=!1),this.Pvc=!1,this.q3g=new Date,this.oCo(),this.ra.raiseEvent(kd.STa,new Jb(h.result.tokens,null));else{const v=h.result.errors;this.ye.X9b(sg.failed);this.ye.P9(sg.status,sg.failed);b||(this.QAc=this.YUe.cVc(v));this.QAc&&(this.ye.P9(sg.Nok,JSON.stringify(v)),
u.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Pvc=!0;this.ra.raiseEvent(kd.STa,new Jb(null,v))}this.ye.flush();this.jsd=!1})}}Qec(){this.MGe||Ti.a.instance.Oaj(Object(z.a)(this,this.Qec,"onSessionExpiredDetected"));u.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Ewf(Ti.a.instance.j_d)}V_c(){this.OAc||this.rcb||(u.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.OAc=!0,this.weg(Ti.a.instance.i_d))}Ewf(b){if(!this.rcb){var h=
b?Uf.a.ueo:Uf.a.w6c;const v=Object.assign(new wb.a,{extendedProperties:new Map});v.extendedProperties.set("ErrorCode",String.format("{0}",h));w.AFrameworkApplication.YM(h,void 0,["SessionExpired"],v);b||(b=new Date,h=new Date(w.AFrameworkApplication.WW),u.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&wa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,v),2592E5>+b-+h&&
wa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,v));this.rcb=!0;this.Eie()}}oCo(){this.wmd&&(this.Hb.We(this.swb),this.wmd=!1)}e8k(){this.swb=new of.a(2,2,1E3*this.mah,Object(z.a)(this,this.OJo,"tokenRefreshPolling"),135);this.Hb.Wb(this.swb)}OJo(){const b=this.ye.KCn;u.ULS.sendTraceTag(555255521,217,50,"{0}",F.c(b));this.ra.raiseEvent(kd.xlc,new Ec(b,b[sg.pZf],b[sg.eDb],b[sg.Jde],b[sg.failed],b[sg.Dnb],b[sg.Vde]))}CEn(){3E5<+new Date-
+this.q3g?(u.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.tQc(!1)):u.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}kd.zya="SE";kd.x6c="SEP";kd.STa="SER";kd.xlc="TRP";Object(n.a)(kd,"ASessionExpirationManagerWithRefresh",null,[]);class Vd extends kd{constructor(b,h,v=null,D=null){super(h,v,D);this.IZ=null;this.Mh=b}Pdg(b){this.iZb=b}weg(b){if(!this.IZ&&!ml.a.lM){if(b){var h=Object(z.a)(this,this.L4b,
"disposeCallback");this.IZ=Ad(w.AFrameworkApplication.Rnb,!1,Object(z.a)(this,this.yic,"sessionExpirationHandler"),h)}else if(this.xud){if(this.jsd)return;h=Object(z.a)(this,this.L4b,"disposeCallback");this.IZ=Ad(w.AFrameworkApplication.Yy,!1,Object(z.a)(this,this.yic,"sessionExpirationHandler"),h)}u.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",kd.x6c,b);this.ra.raiseEvent(kd.x6c)}}Eie(){this.IZ&&(this.IZ.tha&&this.IZ.Exf(),this.IZ=null);if(this.iZb){this.ye.stop();
if(this.rla&&this.rla.Ao)return;const b=Object(z.a)(this,this.L4b,"disposeCallback");this.IZ=Ad(w.AFrameworkApplication.Yy,!0,Object(z.a)(this,this.yic,"sessionExpirationHandler"),b)}u.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",kd.zya);this.ra.raiseEvent(kd.zya)}L4b(){this.IZ=null}yic(b){(b||this.Mh.nBd())&&this.Mh.refreshDocument(null)}}Object(n.a)(Vd,"SessionExpirationManagerWithRefresh",kd,[757,758]);class se{constructor(b,h,v=null,D=null){this.Vjh=!1;this._instance=null;this._frame=
b;this.Hm=h;this.ye=v||new cb(xb.a.instance);this.rla=D}create(){this.Vjh=w.AFrameworkApplication.w3a;if(!this.Vjh)return new Pf(this._frame);w.AFrameworkApplication.Dn("WOPITokenRefreshIsEnabled");u.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(w.AFrameworkApplication.J2o){case 1:u.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new Ek(this._frame);break;case 2:u.ULS.sendTraceTag(39408091,
217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Vd(this._frame,this.Hm,this.ye,this.rla);break;default:u.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Pf(this._frame)}u.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(n.a)(se,"SessionExpirationManagerFactory",null,[756]);class He{}Object(n.a)(He,"Error",
null,[]);class wf{}Object(n.a)(wf,"NamedResult",null,[]);class fc extends wf{}Object(n.a)(fc,"ErrorInfo",wf,[]);var hf=c(1069);class Fk{constructor(b,h,v,D=null,Q=!1,ba=null,ta=!1,Ta=!1){this.pBa=0;this.rMa=this.vo=null;this.wwd=new zb.a;this.qAa=new zb.a;this.Xp=null;this.wvc=!1;this.cCc=this.dCc=null;this.Hb=b;this.rah=h;this.rah.execute(ob=>{ob.OB(L.a.fyf,Object(z.a)(this,this.don,"onHostResponseReceived"))});this.D2=v;this.Cih=new hf.a("WebServiceCall","TokenRefresh");this.ye=D||new cb(b);this.Whk=
Q;this.$e=ba?ba:ac.SessionStatusManager.instance;this.pTg=ta;this.Xhd=Ta}don(b){if(b.MessageId!==L.a.fyf)Lc.b(39408099,306,15,"Unexpected message.");else{var h=new zb.a,v=new zb.a;this.ye.X9b(sg.Vde);var D=b.Values[H.a.Yij];if(!D||0>=D.length)Lc.b(40122317,306,15,"Found no tokens in the dictionary"),D=b.Values;Lc.b(40122318,306,100,"The Tokens array contains {0} tokens",D.length);this.ye.P9("Correlation",b.CorrelationId);var Q="";for(let Ta=0;Ta<D.length;Ta++){this.ye.Y$f(sg.tokens,D.length);var ba=
D[Ta],ta=ba;if(!ta||!ta.Name)continue;this.ye.X9b(ta.Name);const ob=ba;if(ob&&ob.Value)Lc.b(39408128,306,100,"Received token with name: {0}",ob.Name),h.add(ob),this.wwd.add(ob),this.Xhd||this.ye.P9(sg.status,sg.success),this.pTg&&this.$e&&this.$e.t5n();else if(ba=this.yam(ba),Lc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ta.Name,JSON.stringify(ba),this.rMa),v.add(ba),this.Xhd||(this.qAa.add(ba),Q=JSON.stringify(ba),this.ye.P9(sg.error,JSON.stringify(ba)),
this.ye.P9(sg.status,sg.failed)),this.pTg)for(const Kb of ba.Errors)ta=this.VUl(Kb),this.$e&&this.$e.gvk(ta)}this.Xhd?(0<v.count?this.cCc?this.cCc(new Jb(h,v)):Lc.b(512267295,306,15,"Received errors but the promise has completed"):this.dCc?this.dCc(new Jb(h,v)):Lc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Lc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,v.count,b.CorrelationId,this.rMa)):(0<v.count&&
""!==Q?(D=Object.assign(new wb.a,{extendedProperties:new Map}),D.extendedProperties.set("Errors",Q),D.extendedProperties.set("RetryCount",this.pBa.toString()),D.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),D.extendedProperties.set("IsTokenExpiring",this.wvc.toString()),wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,D)):wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Lc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,v.count,b.CorrelationId,this.rMa),0<v.count&&!this.cVc(v)?(b=this.D2.Sei(v),b!==this.D2.vhc&&(this.ye.Y$f(sg.aej,b),this.Hb.J0(this.vo,b))):(this.ye.flush(),this.vo&&(Lc.b(39408131,306,100,"Deleting task {0} from task manager",this.vo.name),this.Hb.We(this.vo)),this.Xp&&!this.Xp.task.isCompleted?this.Xp.zg(new Jb(h,v)):Lc.b(512267293,306,15,"Received results but the task has completed")))}}yam(b){if(!b)return null;const h=Object.assign(new fc,{Name:b.Name,Errors:[]});for(const v of b.Errors)b=
new He,b.Id=v.Id,b.Details=va.a.t8b(v.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.Kcj()}Kcj(){w.AFrameworkApplication.te("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.pBa>=this.D2.L3d?(Lc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.rMa),this.Q9k(this.Xp)):(wa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.fij())}fij(){const b={};b[H.a.Yij]=this.D2.tokens;const h=sb.a.create().toString();
Lc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.D2.tokens),this.pBa+1,h,this.rMa);this.rah.execute(v=>{v.sendMessage(L.a.H0e,b,h)});this.pBa++;this.ye.X9b(sg.Dnb)}Q9k(b){const h=new zb.a;for(let v=0;v<this.D2.tokens.length;v++){const D=Object.assign(new fc,{Name:this.D2.tokens[v],Errors:[Object.assign(new He,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(D);
this.qAa.add(D)}this.Hb.We(this.vo);this.ye.P9(sg.kif,JSON.stringify(this.qAa));this.ye.P9(sg.status,sg.failed);b&&!b.task.isCompleted&&b.zg(new Jb(new zb.a,this.qAa))}YSn(b){this.Cih.start();this.wvc=b;this.rMa=sb.a.create().toString();Lc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.rMa,this.wvc);this.pBa=0;this.qAa.clear();this.wwd.clear();this.Xp=new jh.a;this.Xhd?this.Lcj(this.D2.L3d).then(h=>{this.Xp&&!this.Xp.task.isCompleted&&this.Xp.zg(h);this.cCc=this.dCc=
null;this.ye.P9(sg.kif,JSON.stringify(this.qAa));this.ye.P9(sg.status,sg.success);this.ye.flush()}).catch(h=>{this.Xp&&!this.Xp.task.isCompleted&&this.Xp.zg(Object(Ka.a)(793,h));this.cCc=this.dCc=null;this.ye.P9(sg.kif,JSON.stringify(this.qAa));this.ye.P9(sg.status,sg.failed);this.ye.flush()}):(this.vo=new of.a(this.D2.priority,2,this.D2.vhc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,L.a.H0e,!0),this.Whk&&this.Kcj(),this.Hb.Wb(this.vo));return this.Xp.task}Lcj(b){const h=this,
v=new Promise((Ta,ob)=>{h.dCc=Ta;h.cCc=ob;wa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.fij()}),D=this,Q=new Promise((Ta,ob)=>{window.setTimeout(()=>{ob(D.NKh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},D.D2.vhc)});let ba=b;const ta=this;return new Promise((Ta,ob)=>{ba--;Promise.race([v,Q]).then(Kb=>{wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ta(Kb)}).catch(Kb=>{var Vb=ta.D2.vhc;if(Object(yb.a)(793,Kb)&&(Kb=
Object(Ka.a)(793,Kb),0<Kb.errors.count)){ta.O1m(Kb.errors);ta.snh(Kb.errors);if(ta.cVc(Kb.errors)){ob(Kb);return}const bc=ta.D2.Sei(Kb.errors);bc!==ta.D2.vhc?(ta.ye.Y$f(sg.aej,bc),Vb=bc):ta.cTm(Kb.errors)&&(Vb=0)}ba?window.setTimeout(()=>{ta.Lcj(ba).then(Ta).catch(ob)},Vb):(Vb=ta.NKh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ta.snh(Vb.errors),ob(Vb),Lc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ta.rMa))})})}snh(b){for(let h of b)this.qAa.add(h)}cTm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}NKh(b,h){const v=new zb.a;for(let D=0;D<this.D2.tokens.length;D++){const Q=this.R9k(this.D2.tokens[D],b,h);v.add(Q)}return new Jb(new zb.a,v)}R9k(b,h,v){return Object.assign(new fc,{Name:b,Errors:[Object.assign(new He,{Id:h,Details:v})]})}O1m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new wb.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.pBa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.wvc.toString());wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.ye.P9(sg.error,b);this.ye.P9(sg.status,sg.failed)}}FIn(b){this.Cih.stop();const h=this.tpm(b.result.errors);u.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.rMa,this.wvc,this.pBa,this.qAa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.EIn(b.result.tokens)}cVc(b){return this.D2.cVc(b)}EIn(b){for(let h=0;h<b.count;h++){const v=b.J(h);if(v.Name===H.a.accessToken){const D=(new Date).getTime();v.Expiry>w.AFrameworkApplication.Yy?
(u.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:v.Expiry,["NowGetTime"]:D,["BootTime"]:w.AFrameworkApplication.WW},"PreviousAccessTokenTtl",w.AFrameworkApplication.Yy),w.AFrameworkApplication.accessToken=v.Value,w.AFrameworkApplication.Yy=Math.floor(v.Expiry),w.AFrameworkApplication.Uog=D,w.AFrameworkApplication.DMa=Math.floor(v.Expiry)):u.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:v.Expiry,
["NowGetTime"]:D,["BootTime"]:w.AFrameworkApplication.WW},"PreviousAccessTokenTtl",w.AFrameworkApplication.Yy)}}return!0}tpm(b){let h=!1;for(let v=0;v<b.count;v++){h=!0;const D=b.J(v);u.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",D.Name,JSON.stringify(D.Errors),this.rMa)}return h}VUl(b){let h=Uf.a.w6c;b=parseInt(b.Id);if(isNaN(b))h=Uf.a.nKj;else{switch(b){case 401:h=Uf.a.Vog;break;case 403:h=Uf.a.lKj;break;case 500:h=Uf.a.mKj;break;case 503:h=Uf.a.pKj}h===
Uf.a.w6c&&(h=500<b?Uf.a.oKj:Uf.a.kKj)}return h}}Object(n.a)(Fk,"TokenRefreshManager",null,[755]);class Mh{constructor(){this.vhc=w.AFrameworkApplication.M2o;this.L3d=w.AFrameworkApplication.K2o;this.tokens=w.AFrameworkApplication.Ejm();this.priority=w.AFrameworkApplication.N2o;this.Och=this.rlo();this.hXe=w.AFrameworkApplication.Djm()}cVc(b){b=JSON.stringify(b);if(this.hXe&&0<this.hXe.length)for(const h of this.hXe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}Sei(b){try{if(b)for(let h of b)if(h.Errors)for(const v of h.Errors)if(v.Id in
this.Och)return Number.parseInvariant(this.Och[v.Id].toString())}catch(h){u.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.vhc}rlo(){const b={};try{if(!w.AFrameworkApplication.RSd()||0>=w.AFrameworkApplication.RSd().length||""===w.AFrameworkApplication.RSd()[0])return b;for(const h of w.AFrameworkApplication.RSd())0<h.length&&(b[h]=w.AFrameworkApplication.L2o)}catch(h){u.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(n.a)(Mh,"TokenRefreshPolicy",null,[754]);class mm{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){w.AFrameworkApplication.K.Po(()=>{this.h2a()})}h2a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}xc(b){this.W=b;b.register(753,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Rd(()=>new cb(xb.a.instance));
b.register(754,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Rd(()=>new Mh);b.register(755,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Rd(()=>new Fk(xb.a.instance,w.AFrameworkApplication.PO(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),w.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Na("Common.ISessionStatus"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),w.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(756,"Common.ISessionExpirationManagerFactory").singleInstance().Rd(()=>new se(w.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Na("Common.ISessionStatus")));b.register(757,"Common.ISessionExpirationManagerWithDialog").singleInstance().Rd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(758,
"Common.ISessionExpirationManager").singleInstance().Rd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){N.a.instance.Fc(new mm)}}Object(n.a)(mm,"SessionExpirationPackage",null,[1,2]);var wj=c(748),Yd=c(399),$g=c(336),fg=c(206);class Eo extends fg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(Eo,"PersonaButtonProps",fg.a,[]);class Fo{L3b(b,h){if(b&&!(1>b.length)&&h){var v=Object.assign(new $g.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.e$k(b,v.ControlList);h.push(v)}}e$k(b,h){const v=Object.assign(new wj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Yd.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,v);h=Object.assign(new $g.a,{Title:"",ControlList:[]});Array.add(v.Menu.MenuSectionList,h);this.$bl(b,h.ControlList)}$bl(b,h){for(let v=0;v<b.length;v++){const D=Object.assign(new Eo,{ExternalId:String.format("CoauthorPersona_{0}",
v),Command:"336231556",DisplayName:b[v].userName,LabelText:b[v].userName,ImageBackColor:b[v].color,PersonaId:b[v].email,IsAnonymous:b[v].isAnonymous});Array.add(h,D)}}}Object(n.a)(Fo,"PresenceContextMenuSectionBuilder",null,[792]);var Da=c(97);class pb{constructor(b,h,v,D){this.Nza=this.nt=this.vo=this.ei=this.kJa=null;this.Cud=b;this.kjk=D;this.Cud.jTc&&(this.vo=new of.a(3,2,5E3,Object(z.a)(this,this.BHk,"authenticationCheckTask"),2),w.AFrameworkApplication.pc.Wb(this.vo),this.Tb(h,v));this.Cud.Qvk(()=>
{this.cKb()});this.Cud.iph(()=>{this.dKb()})}get hM(){return this.nt||(this.nt=Ga.a.instance.Na("CommonUI.IBusinessBar"))}get Ayh(){return this.Nza||(this.Nza=Ga.a.instance.Na("CommonUI.IBusinessBarEntryFactory"))}Tb(b,h){const v=w.AFrameworkApplication.va;v.fb(Ua.a.svh,Kd.a.frame,b,96);v.fb(Ua.a.tvh,Kd.a.frame,h,96);v.qa(Ua.a.MAh,Kd.a.frame,Rc.ActionManager.FQ);v.qa(Ua.a.NAh,Kd.a.frame,Rc.ActionManager.FQ);v.qa(Ua.a.zIf,Kd.a.frame,Rc.ActionManager.FQ)}cKb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
w.AFrameworkApplication.va.processAction(Ua.a.svh,2)}dKb(){this.PGo();w.AFrameworkApplication.va.processAction(Ua.a.tvh,2)}BHk(){this.Cud.authenticationCheck()}PGo(){this.ei&&(this.ei.hide(),this.ei.dispose(),this.ei=null);this.kJa&&this.hM&&(w.AFrameworkApplication.Lk||this.hM.removeEntry(this.kJa),this.kJa.dispose(),this.kJa=null)}showDialog(b){Da.a.VB(this.ei);this.ei=new pg.StandardDialog;this.kjk||(this.ei.yt=!1,this.ei.Ad=0);this.ei.Ee(1,CommonUIStrings.l_SignIn);this.ei.fV(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.jba,"dialogHandler"))}jba(b){1===b?(ll.a.R9d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),w.AFrameworkApplication.va.processAction(Ua.a.zIf,2)):(this.fuo(),w.AFrameworkApplication.va.processAction(Ua.a.NAh,2))}fuo(){this.hM&&this.Ayh&&(this.kJa=this.Ayh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.kJa.closeable=!0,this.kJa.addButton(CommonUIStrings.l_SignIn,pb.eeb,""),this.kJa.nma=
Object(z.a)(this,this.OOk,"businessBarEntryCloseHandler"),this.hM.fA(this.kJa,!1))}OOk(){this.fnl();w.AFrameworkApplication.va.processAction(Ua.a.MAh,2)}fnl(){this.vo&&(w.AFrameworkApplication.pc.We(this.vo),this.vo=null)}dispose(){this.vo=this.ei=this.kJa=null}static eeb(){ll.a.R9d();w.AFrameworkApplication.va.processAction(Ua.a.zIf,2)}}Object(n.a)(pb,"SignOutResponseUI",null,[10]);class oc{get name(){return"Common.App.UI"}xc(b){b.register(Fo,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){Da.a.VB(oc.$sa);
oc.$sa=null}static main(){N.a.instance.Fc(new oc)}static Xwm(b,h,v){oc.Sto()&&(oc.$sa=new pb(ll.a.instance,b,h,v))}static Sto(){return w.AFrameworkApplication.V4d&&!w.AFrameworkApplication.gha}}oc.$sa=null;Object(n.a)(oc,"CommonAppUIPackage",null,[1,2]);class Mc{get name(){return"Common.App.DialogWithLinkToResource"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Mc)}}Object(n.a)(Mc,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var $c=c(65);class $d{constructor(b){this.ey=b;this.Vx=
Array.indexOf(this.ey,this.pga)}dispose(){this.ey=null}get u3(){return this.ey[this.Vx]}Iy(b){this.F6c(b,!1);return!0}z6b(b){this.F6c(b,!0)}F6c(b,h){b&&(this.u3!==b||h)&&(b.tabIndex=0,$c.FocusManager.WJ(b));Array.contains(this.ey,b)&&(this.Vx=Array.indexOf(this.ey,b))}get E2i(){let b=this.Vx;do if(b)if(0<b&&b<this.ey.length)b--;else break;else b=this.ey.length-1;while(!Ie.DOMFocusListing.Z_a(this.ey[b])&&b!==this.Vx);return this.ey[b]}get bQi(){let b=this.Vx;do if(b===this.ey.length-1)b=0;else if(0<=
b&&b<this.ey.length-1)b++;else break;while(!Ie.DOMFocusListing.Z_a(this.ey[b])&&b!==this.Vx);return this.ey[b]}get pga(){let b=0;for(;!Ie.DOMFocusListing.Z_a(this.ey[b])&&b<this.ey.length;)b++;return Ie.DOMFocusListing.Z_a(this.ey[b])?this.ey[b]:null}get ncc(){let b=this.ey.length-1;for(;!Ie.DOMFocusListing.Z_a(this.ey[b])&&0<b;)b--;return Ie.DOMFocusListing.Z_a(this.ey[b])?this.ey[b]:null}}Object(n.a)($d,"DialogFocusListing",null,[135]);var jc=c(54);class $e extends pg.StandardDialog{constructor(b,
h,v,D=null){super();this.Fea=this.Kw=this.E$a=null;this.ey=[];this.Rqd=h;this.qk=b;this.i5j=v;this.Qtd=D;this.gm=new hf.a("LoadResource","LoadPrintablePdf")}DDa(){this.Ad=5;this.width=40;const b=document.createElement("span");b.id=this.kj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Fea=document.createElement("iframe");this.Fea.name="pdfObjectFrame";this.Fea.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Fea.onload=Object(z.a)(this,this.uGn,"printablePdfLoaded");if(this.Qtd&&0<this.Qtd.count){var v=ja.a.Csf(this.Rqd,this.Qtd);const D=ja.a.c5f(this.Rqd,this.Qtd);this.Kw=document.createElement("form");this.Kw.id="printPreviewPostForm";this.Kw.method="POST";this.Kw.target=this.Fea.name;this.Kw.action=D;for(let Q of v)v=document.createElement("input"),v.type="hidden",v.name=Q.key,v.value=Q.value,this.Kw.appendChild(v)}else this.Fea.setAttribute("src",this.Rqd);
Sys.UI.DomElement.addCssClass(this.Fea,ml.a.Z7g);this.i5j?(Sys.UI.DomElement.addCssClass(this.Fea,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Ze.a.gr(this.Fea,Ze.a.gA,Ze.a.np)):(Sys.UI.DomElement.addCssClass(this.Fea,"DirectPrintPdfObject"),this.ey.push(this.Fea));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Fea);this.Kw&&b.appendChild(this.Kw);b.appendChild(document.createElement("br"));b.appendChild(this.w3k(this.Kw?
"#":this.Rqd));this.gm.start();this.llb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.e5(this.kj("DirectPrintHeaderContent"));this.Kw&&this.Kw.submit();this.f$k();u.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}w3k(b){const h=document.createElement("span");var v=document.createElement("span");v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(v);w.AFrameworkApplication.K&&(2===w.AFrameworkApplication.ta.Nb.Sl&&w.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===w.AFrameworkApplication.ta.Nb.Sl&&w.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===w.AFrameworkApplication.ta.Nb.Sl?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===w.AFrameworkApplication.ta.Nb.Sl&&(b.innerText=CommonUIStrings.l_InternalError_Directive,u.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.E$a=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(v=
document.createElement("a"),v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,v.href=b,v.target="_blank",v.id="PrintPDFLink",v.className="AllowBrowserClick",this.E$a=v,h.appendChild(document.createElement("br")),h.appendChild(v),this.Kw&&lf.a.addHandler(v,"click",Object(z.a)(this,this.Atn,"onSubmit")),this.qk.mb(Sc.a.click,this.E$a,Object(z.a)(this,this.KTh,"downloadPDFLinkClicked"),null));this.ey.push(this.E$a);return h}Atn(b){this.Kw&&(this.Kw.target="_blank",this.Kw.submit());b.preventDefault()}f$k(){if(0<
this.ey.length){const b=new $d(this.ey),h=$c.FocusManager.instance().Ss();h&&(this.E$a.focus(),h.Zj=b,h.oR=!0)}}KTh(){u.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}VXc(){u.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}uGn(){u.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.gm&&this.gm.stop()}dispose(){this.E$a&&(this.qk.uc(Sc.a.click,this.E$a,Object(z.a)(this,this.KTh,"downloadPDFLinkClicked")),
this.E$a=null);jc.a.jx(this.Fea);this.Fea=null;super.dispose()}}Object(n.a)($e,"DirectPrintDialog",pg.StandardDialog,[807]);class Wc{constructor(b){this.qk=b}HTl(b,h,v=null){return new $e(this.qk,b,h,v)}}Object(n.a)(Wc,"DirectPrintDialogFactory",null,[795]);class Ng{constructor(b,h){this._url=b;this.jdk=h}wSh(){this.jdk?Id.a.downloadFile(this._url):Id.a.om(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(n.a)(Ng,"OpenUrlInTabDialogDownloadBehavior",null,
[833,10]);class Re extends pg.StandardDialog{constructor(b,h=!0,v=!1,D=null,Q=null,ba=!1){super();this.aVb=this.$Ub=this.Kw=this.v2=null;var ta=this.ijg?this.ijg:CommonUIStrings.l_DefaultDialogTitle;Re.r9b=ba;this.Kye=D||new Ng(b,!0);const Ta=[],ob=[];Re.yL&&(this.Jzd&&this.Jzd.forEach(bc=>{Array.add(Ta,bc)}),this.Iqh&&this.Iqh.forEach(bc=>{Array.add(ob,bc)}));h?v?this.WXd?(this.Ad=12,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.Ee(3,CommonUIStrings.l_DialogClose)):
this.hYd?(this.Ad=12,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Ee(3,CommonUIStrings.l_DialogClose)):(this.Ad=4,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DialogClose)):(this.Ad=6,this.Ee(0,CommonUIStrings.l_DialogClose)):this.Ad=5;ba=document.createElement("span");this.AIc&&(ba.className=this.AIc);D=document.createElement("a");D.innerText=this.Gcc;D.href=b;D.target="_blank";D.id=this.AXc;D.className=gf.AFrame.i0e;var Kb=!aa.a.c4&&
!!Q&&0<Q.count;if(Kb){const bc=ja.a.Csf(b,Q);Q=ja.a.c5f(b,Q);D.href="#";D.target="_self";this.Kw=document.createElement("form");this.Kw.id="printPreviewPostForm1";this.Kw.method="post";this.Kw.target="_blank";this.Kw.action=Q;for(var Vb of bc)Q=document.createElement("input"),Q.type="hidden",Q.name=Vb.key,Q.value=Vb.value,this.Kw.appendChild(Q)}else this.Kw=null;this.Kw||Re.r9b?Re.r9b||Array.add(ob,{["type"]:"AppLinkProps",["id"]:this.AXc,["text"]:this.Gcc,["onExecute"]:()=>{this.i6i()}}):Array.add(ob,
{["type"]:"AppLinkProps",["id"]:this.AXc,["text"]:this.Gcc,["handler"]:{["href"]:Kb?"#":b,["target"]:Kb?"_self":"_blank"}});this.k4a&&Array.add(Ta,this.k4a);v?(b=document.createElement("span"),b.innerText=this.k4a.replace("{0}",""),ba.appendChild(b)):this.FNi?(b=document.createElement("span"),b.id=this.kj("message"),Vb=document.createElement("span"),Q=document.createElement("span"),Kb=this.k4a.split("{0}"),Vb.innerText=Kb[0],Q.innerText=Kb[1],b.appendChild(Vb),b.appendChild(D),b.appendChild(Q),ba.appendChild(b)):
(b=document.createElement("span"),b.innerText=this.k4a,ba.appendChild(b),ba.appendChild(document.createElement("br")),ba.appendChild(document.createElement("br")),ba.appendChild(D),Re.r9b||Array.add(Ta,"{0}"));this.Kw&&ba.appendChild(this.Kw);Re.yL&&(this.Ikb&&(this.gXc?this.vnh(this.Ikb,this.gXc):(Array.add(Ta,"{0}"),Array.add(ob,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Ikb,["onExecute"]:()=>{}}))),this.qDc(Ta,ob));this.llb(ta,null,this.syf,null,Object(z.a)(this,this.jba,"dialogHandler"),
Re.yL?null:ba);this.e5(this.kj("message"));!Re.yL&&this.gXc&&this.Ikb&&(ta=document.createElement("div"),ta.className="WACDialogLearnMoreLinkContainer",this.v2=document.createElement("a"),this.v2.innerText=this.Ikb,this.v2.href=this.gXc,this.v2.target="_blank",this.v2.id=this.kj("LearnMoreLinkId"),this.v2.className=gf.AFrame.i0e,ta.appendChild(this.v2),h?this.Hc.insertBefore(ta,this.Hc.lastChild):this.Hc.appendChild(ta),this.e5(String.format("{0} {1}",this.kj("message"),this.kj("LearnMoreLinkId"))));
this.Zrc=D;v?this.R0(this.aH):this.R0(this.Zrc);this.cKf();w.AFrameworkApplication.ta.f1.mb(Sc.a.click,this.Zrc,Object(z.a)(this,this.JTh,"downloadLinkClicked"),null);this.v2&&w.AFrameworkApplication.ta.f1.mb(Sc.a.click,this.v2,Object(z.a)(this,this.cFi,"learnMoreLinkClicked"),null);this.PV=!1}get syf(){return null}get ijg(){return null}get k4a(){return null}get gXc(){return null}get Ikb(){return null}get FNi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get AIc(){return null}get Jzd(){return null}get Iqh(){return null}get WXd(){return!1}get hYd(){return!1}p$e(){}JUh(){}Zla(){this.Kw&&
(this.$Ub||(this.$Ub=Object(z.a)(this,this.hjn,"onActionButtonClicked"),this.Lq.mb(Sc.a.click,this.aH,this.$Ub)),this.aVb||(this.aVb=Object(z.a)(this,this.ijn,"onActionButtonKeyUp"),this.ae.mb(Sc.a.uh,this.aH,this.aVb)));super.Zla()}hjn(b){this.kXh(b);return!0}ijn(b){return this.FWc(b,Object(z.a)(this,this.kXh,"executeDismissActionButtonFromArgs"))}kXh(b){this.Kw&&this.Kw.submit();this.JCb(b.zf)}VXc(){}JTh(){this.dKf();this.Kw?this.Kw.submit():this.Kye.wSh();return!0}cFi(){return!1}dispose(){this.Kye.dispose();
this.Zrc&&(w.AFrameworkApplication.ta.f1.uc(Sc.a.click,this.Zrc,Object(z.a)(this,this.JTh,"downloadLinkClicked")),this.Zrc=null);this.v2&&(w.AFrameworkApplication.ta.f1.uc(Sc.a.click,this.v2,Object(z.a)(this,this.cFi,"learnMoreLinkClicked")),this.v2=null);this.Lq&&this.$Ub&&(this.Lq.uc(Sc.a.click,this.aH,this.$Ub),this.$Ub=null);this.ae&&this.aVb&&(this.ae.uc(Sc.a.uh,this.aH,this.aVb),this.aVb=null);super.dispose()}i6i(){this.Kw&&(document.body.appendChild(this.Kw),this.Kw.submit(),document.body.removeChild(this.Kw))}jba(b){1===
b?(this.VXc(),this.Kw?Re.yL&&this.i6i():this.Kye.wSh()):2===b&&(this.WXd?this.p$e():this.hYd&&this.JUh());this.dispose()}static get yL(){return w.AFrameworkApplication.ta.Nb.lF&&w.AFrameworkApplication.ta.Nb.gAi}static get r9b(){return Re.TXg}static set r9b(b){Re.TXg=b}}Re.TXg=!1;Object(n.a)(Re,"ADialogWithLinkToResource",pg.StandardDialog,[]);class Ah extends Re{constructor(b,h,v=null,D=!0,Q=!1){super(b,!0,!(Ah.qqb&&D),new Ng(b,h),v,Q);Ah.qqb=Ah.qqb&&D;if(Ah.qqb){h=document.createElement("iframe");
D=null;Q=this.VQh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(v&&0<v.count){const ba=ja.a.Csf(b,v);b=ja.a.c5f(b,v);D=document.createElement("form");D.id="printPreviewPostForm";D.method="POST";D.target=h.name;D.action=b;for(let ta of ba)b=document.createElement("input"),b.type="hidden",b.name=ta.key,b.value=ta.value,D.appendChild(b)}else h.src=b;Q.appendChild(h);D&&(Q.appendChild(D),D.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Ze.a.gr(h,Ze.a.gA,Ze.a.np)}}get syf(){return"Print_32x32x32"}get ijg(){return Ah.qqb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get k4a(){return Ah.qqb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Jzd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Re.r9b){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==w.AFrameworkApplication.ta.Nb.aOh&&(h=w.AFrameworkApplication.ta.Nb.aOh);Array.add(b,h)}return Ah.qqb?b:null}get Gcc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get AXc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get AIc(){return w.AFrameworkApplication.K_a?
"UIFontDialogTextLarge":null}cKf(){u.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}dKf(){w.AFrameworkApplication.Rm.d2a(9540);u.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}VXc(){u.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get qqb(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.lF&&w.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(aa.a.c4||aa.a.At||aa.a.jj||aa.a.hca)&&!w.AFrameworkApplication.jWc&&
w.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set qqb(b){}}Object(n.a)(Ah,"PrintDialogWithLinkToPdf",Re,[]);class hi{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.uPm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.ZLm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.pPb=(b.DirectPrintSupportedMimeTypes||"").split(hi.Bef);this.lpb=(b.DirectPrintSupportedPlugins||"").split(hi.Bef);this.avm=(b.DirectPrintImmersivePreviewPlugins||
"").split(hi.Bef);this.Uvi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.lGm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.zWk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.ZMf=14;this.TNi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.ZMf=parseInt(h[0]),this.TNi=parseInt(h[1])):u.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else u.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}hi.Bef=",";Object(n.a)(hi,"DirectPrintBrsSettings",null,[]);class Sj{constructor(b,h){this.Qgg=b;this.lpb=h}}Object(n.a)(Sj,"DirectPrintProbeResults",null,[]);class al{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){this.txd=null;this.s0j=b;this.sxc=h;this.sKe=v;this.O7j=D;this.S8j=Q;this.kzc=new Fg.a(Object(z.a)(this,this.L8l,"getProbeResults"));this.Brc=ba;this.q4g=ob;this.aT=ta;this.uvc=Ta;this.k9j=Kb}get EQ(){return this.s0j}start(){}RGn(){this.EQ.uPm&&
this.n5m()}HLn(){const b=Array(this.EQ.pPb.length);if(void 0!==this.sxc&&null!==this.sxc)for(let h=0;h<this.EQ.pPb.length;h++)b[h]=this.EQ.pPb[h]in this.sxc&&this.O7j(this.sxc[this.EQ.pPb[h]]);return b}ILn(){const b=Array(this.EQ.lpb.length),h=!(void 0===this.sKe||null===this.sKe);for(let v=0;v<this.EQ.lpb.length;v++){const D=this.EQ.lpb[v];b[v]=h&&D in this.sKe?!0:this.S8j(D)}return b}xdm(){const b=this.HLn(),h=Array(b.length);for(let v=0;v<b.length;v++)h[v]=b[v]?this.Iyl(this.sxc[this.EQ.pPb[v]]):
null;return h}Iyl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}n5m(){u.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.kzc.value.Qgg,this.kzc.value.lpb)}L8l(){var b=this.xdm();const h=this.ILn(),v={},D={};for(let Q=0;Q<this.EQ.pPb.length;Q++)v[this.EQ.pPb[Q]]=b[Q];for(b=0;b<this.EQ.lpb.length;b++)D[this.EQ.lpb[b]]=h[b];return new Sj(v,D)}Kto(){return this.k9j||!this.EQ.isEnabled||w.AFrameworkApplication.jWc?!1:this.KDo()}Qto(){if(null!=
this.txd)return this.txd;const b=al.Tvi(this.EQ);return this.txd=this.EQ.Uvi&&b||this.kGm()}kGm(){return aa.a.zq&&this.EQ.lGm&&aa.a.yWk>=this.EQ.zWk?!0:!1}KDo(){if(!this.uvc(this.EQ))return!1;var b=lb.a.mFb(this.kzc.value.Qgg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=lb.a.mFb(this.kzc.value.lpb);for(const h of b)if(h)return!0;return!1}Dpm(){const b=lb.a.mFb(this.kzc.value.Qgg);for(const h of b)if(am.a.contains(this.EQ.avm,h))return!0;return!1}gwo(b,h=null){w.AFrameworkApplication.ta&&w.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.q4g(b,h):this.Kto()?this.kol(b,this.Dpm()&&!0,h):this.q4g(b,h)}kol(b,h,v=null){const D=this.aT.$f("UserAction","OpenDirectPrintDialog");this.Brc.HTl(b,h,v).DDa();D.stop()}static eSm(b){try{return new ActiveXObject(b),!0}catch(h){u.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static dJm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new hi(w.AFrameworkApplication.K.appSettings);let v=
null;try{v=window.navigator.mimeTypes}catch(Kb){u.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let D=null;try{D=window.navigator.plugins}catch(Kb){u.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Q=al.dJm,ba=al.eSm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ta=w.AFrameworkApplication.ta.Gq,Ta=al.gSm,ob=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.lF&&!w.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");
return new al(h,v,D,Q,ba,b,ta,Ta,(Kb,Vb)=>new Ah(Kb,!1,Vb,!0,ob),w.AFrameworkApplication.gha)}static gSm(b){return aa.a.zq||aa.a.At&&b.ZLm||b.Uvi&&al.Tvi(b)?!0:!1}static Tvi(b){var h=aa.a.d5b;if(h){var v=h.split(".");if(2===v.length)return h=parseInt(v[0]),v=parseInt(v[1]),h>b.ZMf||h===b.ZMf&&v>=b.TNi}return!1}}Object(n.a)(al,"DirectPrintManager",null,[770]);class fj{constructor(){this.Gsb=this.W=null}get name(){return"Common.App.DirectPrint"}xc(b){this.W=b;b.register(Wc,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Rd(()=>
new Wc(w.AFrameworkApplication.ta.f1));b.register(770,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Rd(()=>al.create(this.W))}init(){this.Gsb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Gsb.start()}dispose(){}}Object(n.a)(fj,"PackageManager",null,[1,2]);class yk{constructor(b,h=3E4){this.Ajg=9E5;this.Cjg=1E4;this.WKi=this.gdc=null;this.lLf=0;this.rfb=Date.now;this.Bfm=b;this.t7a=h;this.ANd()}Yhi(b=!0){const h=this.rfb();if(h<this.lLf+this.Ajg)return h>this.lLf+
this.Cjg&&this.ANd(),this.WKi;b&&this.ANd();return null}getToken(b=!0){return(b=this.Yhi(b))?Promise.resolve(b):this.ANd()}ANd(){return this.gdc=this.gdc||new Promise(b=>{this.Bfm().then(h=>{this.gdc=null;""!==h&&h&&(this.WKi=h,this.lLf=this.rfb(),b(h));b(null)}).catch(()=>{this.gdc=null;b(null)});window.setTimeout(()=>{this.gdc=null;b(null)},this.t7a)})}}Object(n.a)(yk,"OAuthCacheManager",null,[]);var dn=c(111),Ji=c(288);class nm{constructor(){this.a9=null;this.xTg={};this.vlc=new La.a(Pa.a.ai())}getToken(b,
h){if(this.vlc.nb(h))return this.vlc.J(h).getToken();const v=new yk(()=>this.Zhi(b,h));this.vlc.Z(h,v);return v.getToken()}Afm(b,h){if(this.vlc.nb(h))return this.vlc.J(h).Yhi();const v=new yk(()=>this.Zhi(b,h));this.vlc.Z(h,v);return null}Zhi(b,h){if(!this.a9)try{this.a9=Ga.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(v){u.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+v)}return this.a9?new Promise(v=>{const D=Date.now();this.a9.PY(b,h).then(Q=>{const ba=Q.Token;
!Q.IsSuccess||this.eTm(ba)?(this.iic("GetTokenInternalImplicitJS",!1,Date.now()-D,b,Q.ErrorCode,Q.ErrorMessage,h),v(null)):(this.iic("GetTokenInternalImplicitJS",!0,Date.now()-D,b,Q.ErrorCode,Q.ErrorMessage,h),v(ba))}).catch(Q=>{Q=Q?F.c(Q):"";this.iic("GetTokenInternalImplicitJS",!1,Date.now()-D,b,"Caught Exception",Q,h);v(null)})}):new Promise(v=>{this.iic("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");v(null)})}iic(b,h,v,D,Q="",ba="",ta=""){var Ta="Search"===D;const ob=
[];b=dn.a.Aga(Ta?"Event":"EventName",b,2);D=dn.a.Aga("AppName",D,2);Array.add(ob,b);Array.add(ob,D);Ta&&(D=dn.a.Aga("LatencyType","FetchToken",2),Array.add(ob,D));Q&&""!==Q&&(Q=dn.a.Aga("ErrorCode",Q,2),Array.add(ob,Q));ba&&""!==ba&&(ba=dn.a.Aga("ErrorMessage",ba,2),Array.add(ob,ba));ta&&""!==ta&&(ba=!(ta in this.xTg),this.xTg[ta]=ba,ba=dn.a.Aga("WarmUpCall",ba.toString(),1),Array.add(ob,ba),ta=dn.a.Aga("Service",this.Abm(ta),2),Array.add(ob,ta));Ta=Ta?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
h=Object.assign(new Ji.a,{name:Ta,samplingPolicy:2,dataFields:ob,succeeded:h,durationMs:v});fa.a.sendActivityEvent(h)}Abm(b){return b===w.AFrameworkApplication.XKf?"Loki":b===w.AFrameworkApplication.Hgg?"Substrate":w.AFrameworkApplication.K&&b===w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}eTm(b){return!b||!b.length}}Object(n.a)(nm,"SearchOAuthManager",null,[752]);class Lg{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}xc(b){this.W=
b;this.W.register(752,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Rd(()=>new nm)}init(){}dispose(){}static main(){N.a.instance.Fc(new Lg)}}Object(n.a)(Lg,"SearchOAuthPackage",null,[1,2]);var sf=c(223),ne=c(5),ke=c(18),We=c(17),de=c(8);class vl{constructor(b,h,v){this.jLe=this.Twb=this.gLe=this.Swb=this.XHe=null;this.bmm=D=>{try{this.amm(D)}catch(Q){D=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",Q.message,Q.stack),u.ULS.sendTraceTag(5285580,
334,10,D)}};this.Rp=b;this.e1j=h;this.ib=v;this.init()}init(){this.e1j.mb(this.bmm);this.Swb=new ec.a;this.gLe=new ec.a;this.Twb=new ec.a;this.jLe=new sf.a}V4(b){this.Swb.add(b.key,b)}Rgc(b){this.Twb.add(b.key,b)}amm(b){let h;const v=this.ib.gb.kb;({acf:h}=vl.JNo(v)).returnValue&&(b=vl.iRl(b,this.XHe,h),this.jHn(b,h,v),this.XHe=h)}jHn(b,h,v){b=this.RKl(b,h,v);let D;({notification:D}=vl.ANo(b)).returnValue&&this.Rp.sendNotification(D,!1)}RKl(b,h,v){const D=new ec.a;D.Z(1,new sf.a);D.Z(0,new sf.a);
b.forEach(Q=>{3===Q?(vl.bdg(h.node)||this.t4n(h,v),this.x6l(D,h)):Q||this.GRl(D,h);return!0});return D}t4n(b,h){this.Swb.forEach((v,D)=>{D.reset(b,h);return!0})}GRl(b,h){let v=new ec.a;vl.bdg(h.node)||(v=this.ERl(h.cpBegin));this.FRl(b,this.gLe,v,vl.Qhj(this.XHe,h));this.gLe=v}ERl(b){const h=new ec.a;this.Swb.forEach((v,D)=>{v=null;({RF:v}=D.qIa(b)).returnValue&&h.Z(D.key,v);return!0});return h}FRl(b,h,v,D){const Q=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ba,ta)=>{const Ta=
this.Swb.J(ba).Uw||ta.title;let ob;({value:ob}=v.Dc(ba)).returnValue?D&&ob.contentObject!==ta.contentObject&&(Ta&&b.J(1).add(Ta),ba=this.Swb.J(ba).Uw,ba=String.format(Q,ob.title,ba),ob.description&&(ba+=", "+ob.description),b.J(0).add(ba)):Ta&&b.J(1).add(Ta);return!0});v.forEach((ba,ta)=>{h.nb(ba)||(ba=this.Swb.J(ba).Uw,ba=String.format(Q,ta.title,ba),ta.description&&(ba+=", "+ta.description),b.J(0).add(ba));return!0})}x6l(b,h){h=this.Qcm(h.node);h=this.f_k(h);this.Rcm(b,this.jLe,h);this.jLe=h}Qcm(b){const h=
new ne.GraphIterator;h.set(b);if(!h.zb(1))return null;const v=new sf.a;for(;1!==h.Ve;)this.Twb.forEach((D,Q)=>{let ba;({vma:ba}=Q.Vlc(h)).returnValue&&v.add(ba);return!0}),h.sc();v.reverse();return v}f_k(b){b=b.toArray();let h=0;for(;h<b.length-1;){var v=b[h];if(v.LG===b[h+1].LG&&(this.Twb.J(v.LG),({i_k:v}={returnValue:!1,i_k:null}).returnValue)){b.splice(h,2,v);continue}h++}return new sf.a(b)}Rcm(b,h,v){var D;for(D=0;D<Math.min(v.length,h.length)&&v.J(D).contentId.equals(h.J(D).contentId);D++){var Q=
this.Twb.J(v.J(D).LG).WDb(v.J(D),h.J(D));Q&&(v.J(D).description&&(Q+=", "+v.J(D).description),b.J(0).add(Q))}for(Q=D;Q<v.length;Q++){let ba=this.Twb.J(v.J(Q).LG).WDb(v.J(Q),null);ba&&(v.J(Q).description&&(ba+=", "+v.J(Q).description),b.J(0).add(ba))}for(v=D;v<h.length;v++)(D=this.Twb.J(h.J(v).LG).Uw)&&b.J(1).add(D)}static iRl(b,h,v){const D=new sf.a;(b=b||vl.Sbo(h,v))?(D.add(3),D.add(0)):vl.Qhj(h,v)&&D.add(0);return D}static Sbo(b,h){return!b||!b.node.id.equals(h.node.id)}static Qhj(b,h){return!b||
!b.equals(h)}static JNo(b){let h=null;if(!b||!(We.SelectionEditor.km(b)||(b=We.SelectionEditor.xj(b,!0,!1),We.SelectionEditor.km(b)||b.Oa&&vl.bdg(b.Oa.node))))return{returnValue:!1,acf:h};h=b.Oa;return{returnValue:!!h,acf:h}}static ANo(b){const h=new sf.a;b.J(1).forEach(v=>{v=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,v);h.add(v);return!0});b.J(0).forEach(v=>{v=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,v);h.add(v);return!0});b=h.toArray().join(" ");
return{returnValue:0<h.length,notification:b}}static bdg(b){return ke.ImageReader.Eu(b)||de.ParagraphReader.qua(b)}}Object(n.a)(vl,"AccessibilityContextManager",null,[751]);class Um{constructor(b,h){this.E1g=!1;this.tAc=null;this.Ntd=this.jxd=!1;this.USg=null;this.Pzd=(v,D)=>{(D.aS||D.fqa)&&this.thn(D.aS,D.fqa)};this.Hb=b;this.vN=h}get tqm(){return!!this.tAc}mb(b){this.E1g||(this.vN.zph(this.Pzd),this.E1g=!0);this.USg=b}thn(b,h){this.tqm&&this.Hb.We(this.tAc);this.jxd=this.jxd||b;this.Ntd=this.Ntd||
h;this.tAc=new of.a(5,1,Um.Kwl,()=>{this.USg(this.jxd,this.Ntd);this.reset()},126);this.Hb.Wb(this.tAc)}reset(){this.tAc=null;this.Ntd=this.jxd=!1}}Um.Kwl=100;Object(n.a)(Um,"EditingViewOnAfterValidateEventsConsolidator",null,[750]);var Th=c(46);class Gk{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Ya.App.zuh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}xc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",
()=>new Um(w.AFrameworkApplication.pc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",()=>new vl(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Th.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){N.a.instance.Fc(new Gk)}}Object(n.a)(Gk,
"Box4AccessibilityPackage",null,[1,2]);var Ye=c(177),rf=c(1053),Dp=c(1641),Hk=c(890),ch=c(171),ar=c(1528),ah=c(43),Mg=c(23),ue=c(121),Pe=c(28),Eb=c(3);class co extends ar.a{get twa(){return null!=this.ACg?this.ACg:this.ACg=Ga.a.instance.Na("Box4.IInternalLinkManager")}get F1i(){return null!=this.wFg?this.wFg:this.wFg=Ga.a.instance.Na("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get VC(){return!0}get commandId(){return Eb.a.LHk}Rma(b){ch.a.mark(7012);const h=new ah.GraphTransaction(15);h.Cb(b);
var v=this.FG,D=this.m0,Q=de.ParagraphReader.text(b),ba=Q.substring(v,D);const ta=({BZc:Ta}=G.a.pgg(ba)).returnValue;ba!==ta&&(v+=Ta,D=v+ta.length);ba=Pe.a.createTextRange(b,v,D);var Ta=Q.substring(v,D);co.SLm(Q,v,D)&&(this.Kd.replaceTextRange(Pe.a.createTextRange(b,v-1,D+1),Ta,!0,!1),--v,--D,ba=Pe.a.createTextRange(b,v,D),v=Mg.SelectionFactory.ue(b,D),Th.a.instance.setSelection(v));v=ue.HyperlinkReader.ePa(Ta);co.hyperlinkEditor.hG(ba,v,!1);Q=Ta="";D=!1;this.twa&&({s4f:Ta,wDb:Q}=this.twa.vkg(v)).returnValue&&
(v=Ta,D=!0,Ta=ue.HyperlinkReader.ND(ba,!1),co.hyperlinkEditor.HR(Ta[0].paragraph,Ta[0].hyperlink),""!==Q&&(this.Kd.replaceTextRange(ba,Q,!0,!1),ba=Pe.a.createTextRange(b,this.FG,this.FG+Q.length),b=Mg.SelectionFactory.ue(b,this.FG+this.FG+Q.length),Th.a.instance.setSelection(b)),co.hyperlinkEditor.hG(ba,v,!1));h.dispose();!D&&this.F1i&&this.F1i.$Dn(ba,v);ch.a.mark(7013)}set VC(b){super.VC=b}static get hyperlinkEditor(){return null!=co.AAg?co.AAg:co.AAg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static SLm(b,
h,v){v=v!==b.length&&('"'===b.charAt(v)||"\u201d"===b.charAt(v));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&v}}Object(n.a)(co,"HyperlinkAction",ar.a,[]);class bl{constructor(b){this.Kd=b}J$k(b,h,v){return new co(null,b,h,v,this.Kd)}}Object(n.a)(bl,"HyperlinkActionFactory",null,[747]);var xi=c(235);class Ml{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}xc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new Dp.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),
xi.a.instance,w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new rf.a(b.resolve("Box4.IRoamingServiceRequestManager"),w.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Hk.a(b.resolve("Box4.IAutoCorrectRules"),
Th.a.instance,Ye.a.instance,w.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new bl(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").$Zm();const b=
w.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").yMl()}dispose(){}static main(){N.a.instance.Fc(new Ml)}}Object(n.a)(Ml,"Box4AutoCorrectPackage",null,[1,2]);class Bn{get name(){return"Box4.Clipboard"}init(){}dispose(){}xc(){}static main(){N.a.instance.Fc(new Bn)}}Object(n.a)(Bn,"Box4ClipboardPackage",null,[1,2]);class Cn{get name(){return"Box4.ImageEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Cn)}}
Object(n.a)(Cn,"Box4ImageEditorsPackage",null,[1,2]);var iq=c(615),jq=c(871),br=c(594),Nn=c(822),Hq=c(1144);class Ep{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,v,D,Q){const ba=new Ep;ba.DocumentId=Q;ba.UserId=v;ba.WACSessionId=D;ba.Revision=b;ba.ChangeStateList=Hq.a.Lij(h);return ba}}Object(n.a)(Ep,"LocalUnsavedChange",null,[]);class om{constructor(){this.d2d=null}xne(b){return new Promise((h,v)=>{this.vKh().then(D=>{const Q=D.transaction(om.PXc,"readwrite");Q.objectStore(om.PXc).put(b);
Q.oncomplete=()=>h();Q.onerror=()=>v(Q.error.message)}).catch(v)})}CDd(b,h,v){return new Promise((D,Q)=>{this.vKh().then(ba=>{const ta=ba.transaction(om.PXc,"readwrite");ta.objectStore(om.PXc).delete([b,h,v]);ta.oncomplete=()=>D();ta.onerror=()=>Q(ta.error.message)}).catch(Q)})}static isSupported(){return"indexedDB"in window}vKh(){return new Promise((b,h)=>{if(om.isSupported())if(this.d2d)b(this.d2d);else{var v=window.indexedDB.open(om.b0m,om.c0m);v.onsuccess=()=>{this.d2d=v.result;b(v.result)};v.onerror=
()=>{h(v.error.message)};v.onupgradeneeded=()=>{const D=v.result,Q=D.createObjectStore(om.PXc,{keyPath:["DocumentId","UserId","WACSessionId"]});Q.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});Q.createIndex("UserId",["UserId"],{unique:!1});this.d2d=D;b(D)}}else h("This browser does not support IndexedDB.")})}}om.b0m="LocalUnsavedChangeDatabase";om.c0m=1;om.PXc="LocalUnsavedChange";Object(n.a)(om,"LocalUnsavedChangeStore",null,[]);class Gl{constructor(b,h,v,D,Q,ba){this.sIi=
b;this.iee=h;this.$bi=v;this.sPd=D;this.aUk=Q;this.pya=ba}initialize(){const b=jq.a.qtf(this.$bi());this.jHd=this.DIc=b;this.pya.Fxk(this.wWi.bind(this));this.pya.Gxk(this.xWi.bind(this))}dispose(){this.pya.v0n(this.wWi.bind(this));this.pya.w0n(this.xWi.bind(this))}wWi(b,h){this.sVo(h.JSa)}xWi(b,h){this.eSo(h.JSa)}eSo(b){b.equals(this.DIc)||(this.DIc=b,b.equals(this.jHd)?this.CDd():this.xne())}sVo(b){b.equals(this.jHd)||(this.jHd=b,b.equals(this.DIc)?this.CDd():this.xne())}Cal(){const b=new Nn.a(this.jHd,
this.DIc,this.$bi(),this.sPd().sr,this.sPd().tnb,this.sPd().contextId,this.DIc.id,this.iee,br.FolderReader.xjb(this.sPd()),!1);return Ep.construct(b,this.aUk.INc(),Gl.userId,Gl.sessionId,Gl.documentId)}xne(){const b=this.Cal();this.sIi.xne(b).then(()=>{u.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>{u.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}CDd(){this.sIi.CDd(Gl.documentId,
Gl.userId,Gl.sessionId).then(()=>{u.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{u.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return om.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Gl.Lxg?Gl.Lxg:Gl.Lxg=w.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Gl.SIg?Gl.SIg:Gl.SIg=w.AFrameworkApplication.K.jb("LoggableUserId")}static get sessionId(){return null!=
Gl.aGg?Gl.aGg:Gl.aGg=w.AFrameworkApplication.K.jb("SessionId")}}Object(n.a)(Gl,"LocalUnsavedChangeManager",null,[545]);class eo{get name(){return"Box4.LocalUnsavedChange"}init(){this.Cvi()&&Gl.isSupported()&&(this.OJf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.OJf.initialize())}dispose(){this.OJf&&this.OJf.dispose()}xc(b){this.container=b;if(this.Cvi()){b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new om).singleInstance();var h=(v,D,Q)=>new iq.a(v,
D,Q);b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new Gl(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Ya.App.xa.hb.Uc.od,()=>Ya.App.xa.hb.Uc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).singleInstance()}}static main(){N.a.instance.Fc(new eo)}Cvi(){return w.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}Object(n.a)(eo,"LocalUnsavedChangePackage",null,[1,2]);class Wi{get name(){return"Box4.NotebookLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Wi)}}
Object(n.a)(Wi,"Box4NotebookLevelEditorsPackage",null,[1,2]);var ki=c(1539),mb=c(33),pc=c(131),dd=c(768),Zb=c(12);const Ne=(b,h,v,D,Q)=>{if(h.contextId===Zb.a.view)switch(b){case Eb.a.search:return mb.Debug.SGk(509109570),Ya.App.hN.Dlj(),32;case Eb.a.findOnPage:return 1!==v&&(mb.Debug.SGk(509109571),Ya.App.hN.Sag()),32;case Eb.a.edj:return Ya.App.xa.hb.rc&&Ya.App.xa.hb.rc.Vi?(1!==v&&(dd.a.GNb?Ya.App.hN.X4n():Ya.App.hN.Sag()),b=32):b=8,b;case Eb.a.lAb:case Eb.a.FAh:return 1===v?b=dd.a.GNb?32:8:(Ya.App.hN.X4n(),
b=32),b;case Eb.a.V$d:return 1!==v&&Ya.App.hN.WSd(),32;case Eb.a.G2i:return(b=Id.a.COa(document.body.ownerDocument))&&b.id===pc.AppFrame.Wgj&&Ya.App.hN.WSd(),32;case Eb.a.i5d:return 1!==v&&Ya.App.hN.VSd(),32;case Eb.a.dQi:return(b=Id.a.COa(document.body.ownerDocument))&&b.id===pc.AppFrame.Wgj&&Ya.App.hN.VSd(),32;case Eb.a.Ekj:return Ya.App.hN.elp(),32;case Eb.a.e5c:return Ya.App.hN.e5c(),32;case Eb.a.gyf:return 1!==v&&"string"===typeof Q&&Ya.App.hN.gyf(Q),32;case Eb.a.Ggj:return 1!==v&&Ya.App.hN.Sag(),
32;case Eb.a.Hgj:return 1!==v&&Ya.App.hN.Dlj(),32;case Eb.a.umh:return Ya.App.hN.Qfp(),32;case Eb.a.Ygj:return Ya.App.hN.Dlj(),"string"===typeof Q&&(Ya.App.hN.hKn(Q),dd.a.GNb=!0),32;case Eb.a.RLd:return Ya.App.hN.Sag(),"string"===typeof Q&&(Ya.App.hN.hKn(Q),dd.a.GNb=!0),32}return 2};class uf{get name(){return"Box4.Search"}xc(b){b.ha("Box4.Search.FindManagerHelper",()=>ki.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableSearchActor",
!1)||Ib.a.C3c(Ne)}dispose(){}}Object(n.a)(uf,"PackageManager",null,[1,2]);class Rf{get name(){return"Box4.TableEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Rf)}}Object(n.a)(Rf,"Box4TableEditorsPackage",null,[1,2]);class cd{get name(){return"Box4.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new cd)}}Object(n.a)(cd,"Box4TextLevelEditorsPackage",null,[1,2]);var ei=c(112),fh=c(354),wc=c(145),xj=c(610),xh=c(1553);class $h{constructor(b,h,v){this.Zv=this.cKa=
this.nMa=null;this.lE=this.bxe=this.tJa=0;this.Fka=this.bmd=this.WVa=this.VVa=!1;this.Mkd=this.VYg=this.YYg=0;this.FAa=b;this.ga=h;this.Wm=v}ZO(b){return!Ya.App.xa.hb.isEditingAllowed||ac.SessionStatusManager.instance.Aj?!1:""!==this.iOc(b.zf)}kL(b){if(!this.ZO(b))return!1;this.vio(b);this.lE=this.FAa.k7b();this.llo(b);this.mlo();({tac:this.bmd,Pbc:this.Fka}=this.hmj(this.bxe));this.nlo();this.nMa=b.$H;this.Zv=new Sys.UI.Point(0,0);[this.YYg,this.VYg]=this.FAa.getDimensions();u.ULS.sendTraceTag(16802335,
322,50,"Image resize drag started");return!0}IU(b){this.cKa=b.$H;this.HPk();this.Mkd=xh.b(this.Zv.x,this.Zv.y,this.YYg,this.VYg,this.bmd,this.Fka,this.Mkd,w.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.FAa.Gmg(this.Mkd,this.bmd,this.Fka);return!0}$D(){this.setSize();u.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}sY(){this.FAa.j7f();u.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}vio(b){this.FAa=ei.a.Db(b.zf,xj.a)}mlo(){this.bxe=(Math.floor((this.lE+
22)/45)%8+this.tJa)%8}hmj(b){let h,v;if(this.lE&&90!==this.lE&&180!==this.lE&&270!==this.lE&&360!==this.lE||this.WLm(b))return{tac:!0,Pbc:!0};h=v=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:v=!0}return{tac:v,Pbc:h}}nlo(){this.WVa=this.VVa=!1;switch(this.bxe){case 0:this.WVa=this.VVa=!0;break;case 1:case 2:this.WVa=!0;break;case 7:case 6:this.VVa=!0}}WLm(b){return!(b%2)}iOc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());
b=h.split(" ");for(h=0;h<b.length;h++){const v=b[h].toString();if(v.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==v)return v}return""}llo(b){switch(this.iOc(b.zf)){case "WACImageResizeHandleNW":this.tJa=0;break;case "WACImageResizeHandleN":this.tJa=1;break;case "WACImageResizeHandleNE":this.tJa=2;break;case "WACImageResizeHandleE":this.tJa=3;break;case "WACImageResizeHandleSE":this.tJa=4;break;case "WACImageResizeHandleS":this.tJa=5;break;case "WACImageResizeHandleSW":this.tJa=6;break;
case "WACImageResizeHandleW":this.tJa=7}}HPk(){var b=1;this.Wm.instance&&(b=this.Wm.instance.hj);const h=(this.cKa.x-this.nMa.x)/b;b=(this.cKa.y-this.nMa.y)/b;this.Zv.x=this.VVa?-h:h;this.Zv.y=this.WVa?-b:b}setSize(){const b=new fh.DictionaryPropertySet;b.setValue(wc.a.SRc,100*this.Mkd);b.setValue(wc.a.Soi,!0);if(90===this.lE||270===this.lE){let h,v;({tac:h,Pbc:v}=this.hmj(this.tJa));b.setValue(wc.a.Pyf,h);b.setValue(wc.a.Qyf,v)}else b.setValue(wc.a.Pyf,this.bmd),b.setValue(wc.a.Qyf,this.Fka);this.ga.Qb(Eb.a.N9b,
2,b)}}Object(n.a)($h,"ImageResizeDragAdapter",null,[138]);var Nf=c(123),Wh=c(876);class mk{constructor(b,h,v,D){this.FDe=this.cKa=this.nMa=this.htd=null;this.eqd=this.Qxd=0;this.Fb=null;this.ga=b;this.ib=h;this.Wm=v;this.E4g=this.sBa=0;this.fd=D}ZO(b){return Ya.App.xa.hb.isEditingAllowed&&!ac.SessionStatusManager.instance.Aj&&b&&this.AQm(b.zf)?(this.htd=this.ib.tg)?!0:!1:!1}mMd(){}rtf(){return null}kL(b){if(!this.ZO(b))return!1;this.FAa=ei.a.Db(b.zf,xj.a);if(!this.FAa)return!1;this.Ftd=this.FAa.J9;
if(!this.Ftd)return!1;this.htd=this.ib.tg;this.Fb=ke.ImageReader.Zm(this.htd);if(!this.Fb)return!1;this.nMa=this.LOa(b);this.FDe=Sys.UI.DomElement.getBounds(this.Ftd);this.Qxd=0<ke.ImageReader.BPd(this.Fb)?ke.ImageReader.BPd(this.Fb):0;this.eqd=ke.ImageReader.Fqf(this.Fb);return!0}IU(b){this.cKa=this.LOa(b);this.PPk();if(this.FAa)return this.FAa.Jne(this.sBa,this.E4g),!0;u.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}$D(){this.Qxd=this.sBa=
xh.c(this.sBa);this.i5()}sY(){this.FAa.Jne(this.eqd,0)}AQm(b){return b.classList.contains(Wh.c)||b.classList.contains(Wh.b)||b.classList.contains(Wh.a)||!!b.parentElement&&b.parentElement.classList.contains(Wh.a)}LOa(b){return this.fd.Bd.J0a(b)}PPk(){var b=1;this.Wm&&this.Wm.instance&&(b=this.Wm.instance.hj);var h=new Sys.UI.Point(this.FDe.x+this.Ftd.clientWidth/2*b,this.FDe.y+this.Ftd.clientHeight/2*b);b=xh.a(this.nMa,h);h=xh.a(this.cKa,h);this.sBa=Math.round(Nf.a.mMn(h-b));0<this.Qxd&&(this.sBa+=
this.Qxd-this.eqd);this.E4g=this.sBa;this.sBa+=this.eqd}i5(){const b=new fh.DictionaryPropertySet;b.setValue(wc.a.PRc,0);b.setValue(wc.a.qJ,this.sBa);this.ga.Qb(Eb.a.imageRotate,2,b)}}Object(n.a)(mk,"ImageRotateDragAdapterSimplified",null,[366,138]);class Hj{constructor(){this.W=null}get name(){return"Box4.Images"}xc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new $h(null,w.AFrameworkApplication.va,Ga.a.instance.Sa("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new mk(w.AFrameworkApplication.va,Th.a.instance,Ga.a.instance.Sa("Common.IZoomManager"),Ob.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){N.a.instance.Fc(new Hj)}}Object(n.a)(Hj,"Box4ImagesPackage",null,[1,2]);var Gh=c(311),nh=c(116),lc=c(6),Sd=c(680),Yf=c(454),
bk=c(568),yj=c(251),Vm=c(258),yh=c(1767),mh=c(1820),fo=c(1198);class Wm extends mh.a{constructor(b,h,v){super(b,h,v);this.frd=this.Xcb=null}get MR(){return w.AFrameworkApplication.ta.Gq}SOd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}poe(b){return Wm.pza(b,this.Eii())}Eii(){return Wm.xWe}pza(b,h=null){b=this.poe(b);return 0!==b?(h&&h.Qyd(),2===b&&(h=this.SOd(b),this.zp(this.R7h(b),h)),!1):
!0}sOa(b,h){u.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.jWf=h;ch.a.mark(5576);this.frd=this.MR.$f("LoadResource","PictureUploadTime");this.zWd()?this.Bde(b):this.Z_c()}zp(b,h){const v=new pg.StandardDialog;v.Ad=0;v.mx(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}Z_c(){u.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.Z_c();this.frd&&(this.frd.stop(),this.frd=null)}O6a(){this.Xcb=(new fo.a).create();this.Xcb.message=CommonUIStrings.l_ImageUploadWait;
this.Xcb.Ad=5;this.Xcb.yt=!1;this.Xcb.rL(null,null,null)}G2b(){this.Xcb&&(this.Xcb.close(),this.Xcb=null)}static Iqm(b,h){b=G.a.Ug(b);for(let v=0;v<h.length;++v)if(b.endsWith(h[v]))return!0;return!1}static pza(b,h=null){h||(h=Wm.xWe);return b?Wm.Iqm(b,h)?0:2:1}}Wm.xWe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(Wm,"PictureUploader",mh.a,[]);var Fp=c(353),zl;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(zl||(zl={}));Object(n.b)("PictureValidationResult",zl);var Cf=c(53),Gd=c(15),Ve=c(42);class un{constructor(){this.OT=null}}Object(n.a)(un,"ImageData",null,[]);var Nl=c(51),Xm=c(1768),nl=c(1609),lo=c(1646);class go extends Vf.a{constructor(b,h=!0){super(!1,!1,go.yL);this.dYb=null;this.GUg=!1;this.ey=[];this.As=null;this.Zcb=b;this.jik=h;this.L$=this.yhh=!1;this.CYa=null;this.mAe=!1;this.Xg=this.Xll;this.wg="InsertFileDialog";this.Ee(1,this.hyd);go.yL?(this.dYb=
{["id"]:this.wg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.Fun,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.Bnn,"onFrameReady")},this.Yh(this.titleText,Object(z.a)(this,this.pWd,"insertDialogHandler"),this.dYb),this.PV=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.pWd,"insertDialogHandler")),h&&this.yno(),(b=this.JNd(1))&&this.ey.push(b),
(b=this.JNd(0))&&this.ey.push(b),this.SFj(),this.PV=!1)}get JHj(){return this.Zcb}validate(){this.As.OT||u.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.As.OT.value?!0:(go.mx(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Bnn(b){this.jik&&(this.As=this.knj(b,this.Zcb))}Fun(){this.As&&this.As.OT&&(this.GUg||(this.As.HVn(Object(z.a)(this,this.xTf,"onFileChosen")),this.GUg=!0),this.As.TYh())}xTf(b){this.dYb.uploadStatusLabel=b;this.J5(this.titleText,Object(z.a)(this,
this.pWd,"insertDialogHandler"),this.dYb)}pWd(b){1===b&&this.isEnabled()?go.yL&&this.As.OT&&!this.As.OT.value?(this.dYb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.J5(this.titleText,Object(z.a)(this,this.pWd,"insertDialogHandler"),this.dYb)):(this.$Ud(),this.Zcb.sOa(this.As,Object(z.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}yno(){this.mAe=!1;this.As=this.knj(document.getElementById("uploadFrameContainer"),this.Zcb);w.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.CYa=Object(z.a)(this,this.kWf,"onUploadFrameLoad"),lf.a.addHandler(this.As.iFrame,"load",this.CYa));this.As.OT||u.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.p3i()}kWf(){this.p3i()}p3i(){if(this.As&&!this.mAe){var b=this.As.OT;b&&(lf.a.addHandler(b,Sc.a.fi,Object(z.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.ey=b.concat.apply(b,this.ey),this.SFj(),this.mAe=!0)}}dispose(){if(this.As&&!go.yL){const b=this.As.OT;b&&lf.a.removeHandler(b,Sc.a.fi,Object(z.a)(this,
this.onKeyDown,"onKeyDown"));this.CYa&&lf.a.removeHandler(this.As.iFrame,"load",this.CYa)}this.As=null;super.dispose()}SFj(){if(0<this.ey.length){const b=new $d(this.ey),h=$c.FocusManager.instance().Ss();h&&(this.ey[0].focus(),h.Zj=b,h.oR=!0)}}onKeyDown(b){4!==$c.FocusManager.instance().t3i(b)&&b.preventDefault()}static get yL(){return w.AFrameworkApplication.ta.Nb.lF&&w.AFrameworkApplication.ta.Nb.iAi}static mx(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}
Object(n.a)(go,"InsertFileDialog",Vf.a,[]);class gj{static get Xg(){return Vf.a.qA(gj.Lm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}gj.Lm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(n.a)(gj,"InsertImageDialogHtml",null,[]);class rc extends go{constructor(b,
h=!0){super(b,h)}get hyd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get Xll(){return gj.Xg}validate(){this.As.OT||u.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Ka.a)(Wm,this.JHj);const h=b.poe(this.As.OT.value);return 0!==h?(b=b.SOd(h),go.mx(b),!1):!0}}Object(n.a)(rc,"InsertImageDialog",go,[]);class Ym extends rc{constructor(b){super(b)}knj(b,h){const v=w.AFrameworkApplication.ta.Nb.lF&&w.AFrameworkApplication.ta.Nb.iAi;
return new lo.a(b,Object(z.a)(h,h.Wec,"onUploadFrameInitialized"),Object(z.a)(h,h.hza,"uploadResponseReceived"),w.AFrameworkApplication.K,!v)}isEnabled(){return Ym.TO.Afa(this.JHj.context)}static get TO(){return null!=Ym.LAg?Ym.LAg:Ym.LAg=Ga.a.instance.resolve("Box4.Images.IImageEditor")}}Object(n.a)(Ym,"Box4InsertImageDialog",rc,[]);class Pc{G5k(b){return new Promise((h,v)=>{this.H5k(b).then(D=>{h(D)},D=>{v(D)})})}sIh(b){return new Promise((h,v)=>{const D=new FileReader;D.addEventListener("load",
()=>{h(D.result)},!1);D.addEventListener("error",()=>{v("FileReader exception ("+D.error.name+")")});D.readAsDataURL(b)})}H5k(b){return new Promise((h,v)=>{this.sIh(b).then(D=>{this.Y9e(D,"image/jpeg").then(Q=>{h(Q)},Q=>{v(Q)})},D=>{v(D)})})}Y9e(b,h){return new Promise((v,D)=>{const Q=new Image;Q.addEventListener("load",()=>{const ba=document.createElement("canvas"),ta=ba.getContext("2d");ba.width=Q.width;ba.height=Q.height;ta.drawImage(Q,0,0);v(ba.toDataURL(h))});Q.addEventListener("error",()=>{D("Image failed to load")});
Q.src=b})}}Object(n.a)(Pc,"ImageFormatConverter",null,[]);var tm=c(394);const nk=["ImageInsertFailed"];class Ol extends Wm{constructor(b,h,v,D,Q,ba,ta=!0){super(b,h,v);this.CAa=this.Nl=this.$G=this.Fe=null;this.sLd="wwpicturesfc";this.kpiName="ImageFileExtension";this.Kvc="LocalDeviceUpload";this.wha=new Map;this.ZYh=0;this.Ycb=null;this.kAe="";this.Zra=0;this.Rp=null;this.zuc="";this.H5g=50;this.gWg=this.Ksc=this.hBc=this.Hxc=!1;this.bak=19922944;this.U7g=0;this.oAe=[];this.FUg=[];this.V7g=0;this.cVf=
Ta=>{u.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Ta){var ob={},Kb=this.$G?this.$G.properties.Qc.toString():this.Fe.Qc.toString();ob[Yf.a.nodeId]=this.$G?this.$G.id.toString():this.Fe.id.toString();ob[Yf.a.classId]=Kb;this.Vg.hasProperty(lc.a.imageType)&&(ob[Sd.a.imageType]=this.Vg.getValue(lc.a.imageType));this.Vg.hasProperty(lc.a.mU)&&(ob[Sd.a.mU]=this.Vg.getValue(lc.a.mU));this.Vg.hasProperty(nh.a.bga)&&(ob[Sd.a.bga]=this.Vg.getValue(nh.a.bga));this.Vg.hasProperty(lc.a.Ykb)&&
(ob[Sd.a.Ykb]=this.Vg.getValue(lc.a.Ykb));nl.d(Ta,this.Fe,this.Nl,ob)&&(this.q9c(Ta),Ol.fec++)}else u.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.knn=Ta=>{if(!this.mAf){var ob=this.k8h(this.As);ob&&(this.kAe=ob.name,this.Zra=ob.size);if(!this.pza(Ta,this.As)||!this.Ung(ob,this.As)){ob=Object.assign(new wb.a,{extendedProperties:new Map});ob.extendedProperties.set("type",this.pza(Ta,this.As)?"Image too large":"FileType invalid");this.x2d(ob);this.t2d();return}}this.sOa(this.As,
null)};this.Vg=D;this.Jm=Q;this.ga=ba;this.Nh=Fp.a.getInstance(tm.a);this.F4g=v.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.Y5g=v.mc("ImageUploadMaxByteSize",Number.MAX_VALUE);ta&&this.showDialog();Ya.App.hlc.addHandler(this)}get Oxi(){return this.K.$("JfifImageInsertIsEnabled")}get bP(){return this.Kvc}get fileExtension(){return this.kAe}get fileSize(){return this.Zra}get IHj(){return this.Ycb}get uu(){return this.Rp||(this.Rp=Ga.a.instance.resolve("Common.Utils.IAriaNotifier"))}get mAf(){return this.bP===
this.Kvc}showDialog(){nl.a(this.K)?(this.C4b=!1,this.As=new lo.a(document.body,Object(z.a)(this,this.Wec,"onUploadFrameInitialized"),Object(z.a)(this,this.hza,"uploadResponseReceived"),this.K,!1,void 0,!0)):nl.b()||this.JJb&&aa.a.PH?(this.C4b=!1,this.As=new lo.a(document.body,Object(z.a)(this,this.Wec,"onUploadFrameInitialized"),Object(z.a)(this,this.hza,"uploadResponseReceived"),this.K,!1)):(this.C4b=!0,this.As=(new Ym(this)).As)}R7h(b){switch(b){case zl.noPictureSpecified:return Nl.a.noPictureSpecified;
case zl.invalidExtension:return Nl.a.JBm;case zl.pictureTooLarge:return Nl.a.IJf}return Uf.a.unknown}Bde(b){this.mAf||(this.Fe.Bi()?(u.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),Xm.a.instance.ing(this.Fe.Bi()),this.Fe.Bi().contentReplicator.forceOutbound(this.cVf,Object(z.a)(this,this.KLb,"processFailure"),b)):this.KLb(b,157))}gPm(){return nl.c(this.Fe)}q9c(b){b.q9c();this.Ycb=b.Ycb}hza(b){this.ZYh=+new Date-+this.IHj;this.t2d();u.ULS.sendTraceTag(36783364,322,50,
"Box4PictureUploader.UploadResponseReceived");nl.e(this,b,this.Fe)}UYo(){u.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.Z_c();Ol.fec--;this.ga.processAction(Ua.a.V7a,2);this.Fe?Xm.a.instance.ymc(this.Fe.Bi(),0):u.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.uu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}KLb(b,h){var v;if(this.l7n(b))u.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",
this.retryCount,h.toLocaleString());else{b=Object.assign(new wb.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.$("ShouldLogPicturesExtendedHealthKpis"))?this.Nh.logKpiFailure({kpiName:tm.c.OEa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:tm.c.L9b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,
isSessionEndingError:!1,additionalValues:b}}):wa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",nk,!1,!0,!1,!1,b);v=this.jif(h);u.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Fe.IH();var D=new ah.GraphTransaction(15,Eb.a.aR);D.Cb(this.Fe);Ol.TO.XSa(this.Vg,v);Ol.TO.d5f(this.Fe,this.$G);ke.ImageReader.Ykj(this.Vg);D.dispose();this.Erj(v);this.Jm.E2b(b,!1);this.Z_c();Ol.fec--;Xm.a.instance.ymc(this.Fe.Bi(),
h)}}Erj(b){const h=new pg.StandardDialog;h.Ad=0;h.mx(Nl.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}jif(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}zOj(){if(this.zuc&&0<this.zuc.length){const b=new fh.DictionaryPropertySet;b.setValue(wc.a.jP,this.zuc);b.setValue(wc.a.e4,!0);this.ga.Qb(Eb.a.c_,2,b)}this.Tuo()}Tuo(){let b="";this.gWg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Hxc&&
this.Ksc&&this.hBc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Hxc&&this.Ksc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Hxc&&this.hBc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.hBc&&this.Ksc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.hBc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.Ksc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Hxc&&
(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.Erj(b),this.mPj())}Xuk(b){this.zuc+=String.format('<img src="{0}"></img>',b);this.V7g++}b3m(){this.hBc=!0;u.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new wb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.x2d(b)}$2m(){this.Ksc=!0;u.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new wb.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Filetype invalid");this.x2d(b)}bJi(b){this.gWg=!0;u.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}KAo(b){const h=new Pc;if(this.poe(b.name)===zl.validPicture)return h.sIh(b);if(Wm.pza(b.name,lo.a.yWe)===zl.validPicture)return h.G5k(b)}P5k(b){return new Promise(h=>{const v=this.KAo(b);void 0===v&&(this.bJi("Failed starting conversion work"),h());v.then(D=>{D.length>this.bak?this.b3m():this.Xuk(D);h()},D=>{this.bJi(D);
h()})})}PTm(b){return this.poe(b.name)===zl.validPicture||Wm.pza(b.name,lo.a.yWe)===zl.validPicture}XAm(){const b=[];if(this.As.OT.files){this.U7g=this.As.OT.files.length;this.As.OT.files.length>this.H5g&&(this.Hxc=!0);this.O6a();for(let h=0;h<this.As.OT.files.length&&this.H5g;h++){const v=this.As.OT.files[h];this.oAe.push(v.name);this.FUg.push(v.size);v&&(this.PTm(v)?b.push(this.P5k(v)):this.$2m())}}Promise.all(b).then(()=>{this.G2b();this.zOj()});return!0}LBm(){this.Nl=sb.a.create();this.Vg||(this.Vg=
new fh.DictionaryPropertySet);this.F4g&&this.CAa&&this.Vg.setValue(nh.a.qIi,this.CAa);var b=480;let h=320;const v=this.context.view.rh.editingElement.clientWidth;0<v&&v<b&&(h=Math.floor(1*v/b*h),b=v,this.Vg.setValue(nh.a.bga,v));this.Vg.setValue(Gd.a.zha,Cf.a.Tl(b,0));this.Vg.setValue(Gd.a.yha,Cf.a.Tl(h,1));this.Vg.setValue(Ve.a.O_,1);this.Vg.setValue(wc.a.e4,!0);this.Vg.setValue(lc.a.Ykb,Box4Intl.Box4Strings.l_Picture);b=Ol.TO.zSh(this.context,this.Vg,this.Nl);if(!b)return!1;this.Fe=b.node;this.Vg=
(this.$G=b.blob)?this.$G.properties:this.Fe.properties;Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(this.Fe);return!0}zWd(){return this.mAf?this.XAm():this.LBm()}mPj(){var b;this.wha.set("FileExtensions",this.sQl());this.wha.set("FileSizeInBytes",this.FUg.toString());this.wha.set("Source",this.bP);this.wha.set("NumberOfImagesAttemptedToInsert",this.U7g.toString());this.wha.set("NumberOfImagesPasted",this.V7g.toString());(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?
(this.wha.set("ErrorLevel","warning"),b=Object.assign(new wb.a,{extendedProperties:this.wha}),this.Nh.logKpiFailure({kpiName:tm.c.OEa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):wa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.sLd,this.wha)}sQl(){let b="";for(let h=0;h<this.oAe.length;++h)b=b+this.j8h(this.oAe[h])+",";return b}sOa(b,h){this.F4g&&(this.CAa=new un,this.CAa.OT=b.OT);super.sOa(b,h)}Wec(b){this.As=b;if(!this.C4b){if(this.aoe){if(nl.a(this.K)||
this.JJb&&aa.a.PH){b.OId(this.knn);return}const h=b.OId(null),v=this.k8h(b);v&&(this.kAe=v.name,this.Zra=v.size);if(!this.pza(h,b)||!this.Ung(v,b)){b=Object.assign(new wb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.pza(h,this.As)?"Image too large":"FileType invalid");this.x2d(b);this.t2d();return}}this.sOa(b,null)}}QUd(){return!!Ol.fec}t2d(){var b;this.wha.set("FileExtension",this.j8h(this.fileExtension));this.wha.set("Source",this.bP);this.wha.set("FileSizeInBytes",this.fileSize.toString());
this.wha.set("RequestTimeInMs",this.ZYh.toString());(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.Nh.logKpiUsage({kpiName:tm.c.OEa,kpiType:0,optionalProperties:{extendedProperties:this.wha}}):wa.Health.instance.recordKpiUsage(this.kpiName,0,this.sLd,this.wha)}j8h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}Eii(){return this.Oxi?lo.a.pkh:Wm.xWe}k8h(b){return(b=b.OT)?b.files[0]:null}Ung(b,h){return b&&b.size>this.Y5g?
(h&&h.Qyd(),b=this.SOd(zl.pictureTooLarge),this.zp(this.R7h(zl.pictureTooLarge),b),!1):!0}SOd(b){switch(b){case zl.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case zl.invalidExtension:return this.Oxi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case zl.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.Y5g/1E6));default:return""}}x2d(b){var h;(null===(h=w.AFrameworkApplication.K)||
void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:tm.c.L9b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.Nh.logKpiFailure({kpiName:tm.c.OEa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):wa.Health.instance.recordQosError("PictureFromLocalInvalid",nk,!0,!0,!1,!1,b)}static get TO(){return null!=
Ol.KAg?Ol.KAg:Ol.KAg=Ga.a.instance.resolve("Box4.Images.IImageEditor")}}Ol.fec=0;Object(n.a)(Ol,"Box4PictureUploader",Wm,[443,444]);var Go=c(829),zj=c(132);class ip{constructor(){this.Gs=this.sq=this.xwb=this.lih=this.med=this.yYj=null;this.DPe=0;this.Pra=this.TKe=this.Mwb=null;this.xPg=0;this.Xse=this.Iea=this.pHe=null;this.p_g=!1;this.cse=this.Zre=this.dse=null}get assetId(){return this.med}get thumbnailUrl(){return this.lih}get kGn(){return this.xwb}get displayName(){return this.Pra}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.sq,this.Gs)}get jzk(){if(this.Zre&&this.cse&&this.dse){const b=document.createElement("a");b.setAttribute("href",this.dse);b.setAttribute("target","_blank");b.innerText=this.cse;return b}return null}get Hqh(){return this.Zre}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.xPg)}get bOn(){const b=document.createElement("span");var h=0;if(this.Mwb&&0<this.Mwb.length){var v=this.Mwb.indexOf("."),D=0>v?this.Mwb:this.Mwb.substring(0,v);for(D=Number.parseInvariant(D);h<
D&&5>h;h++)b.appendChild(pd.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",zj.a.vg("box42.png"),"","",!0,""));0<v&&(v=Number.parseInvariant(this.Mwb.substr(v+1)),3>v?b.appendChild(pd.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",zj.a.vg("box42.png"),"","",!0,"")):8>v?b.appendChild(pd.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",zj.a.vg("box42.png"),"","",!0,"")):b.appendChild(pd.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",zj.a.vg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(pd.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",zj.a.vg("box42.png"),"","",!0,""));this.TKe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.TKe),b.appendChild(h));return b}get I5n(){return 0<this.DPe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.DPe):""}get xHk(){if(this.p_g){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.Xse&&this.Iea)return ip.ral(this.Xse,this.Iea);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.pHe){const h=this.pHe.split(",");b=Array(h.length);for(let v=0;v<h.length;v++)b[v]=h[v].trim()}else b=[];return b}static $Hl(b){const h=new ip;for(let v=0;v<b.childNodes.length;v++){const D=b.childNodes[v];if(1===D.nodeType)try{const Q=D.firstChild.nodeValue;switch(D.nodeName){case "src":h.yYj=Q;break;case "assetid":h.med=
Q;break;case "thumb":"64x64"===D.attributes.getNamedItem("size").nodeValue?h.lih=ip.dBj(Q):"192x192"===D.attributes.getNamedItem("size").nodeValue&&(h.xwb=ip.dBj(Q));break;case "imagedim":if(Q){const ta=Q.indexOf("x");0<ta&&ta<Q.length&&(h.sq=Q.substr(0,ta),h.Gs=Q.substr(ta+1))}break;case "resolution":h.DPe=Number.parseInvariant(Q);break;case "rating":h.Mwb=Q;break;case "numofratings":h.TKe=Q;break;case "displayname":h.Pra=Q;break;case "contentlength":h.xPg=Number.parseInvariant(Q)/1024;break;case "subject":h.pHe=
Q;break;case "provider":h.Iea=Q;break;case "attributionlink":h.Xse=Q;break;case "iscsc":h.p_g=1===Number.parseInvariant(Q);break;case "additional":const ba=D.firstChild;if(D.hasChildNodes()&&ba&&"id"===ba.nodeName&&1===Number.parseInvariant(ba.text))for(let ta=0;ta<D.childNodes.length;ta++){const Ta=D.childNodes[ta];switch(Ta.nodeName){case "caption":h.Zre=Ta.text;break;case "value":h.dse=Ta.text;break;case "string":h.cse=Ta.text}}}}catch(Q){}}return h}static ral(b,h){const v=document.createElement("a");
v.setAttribute("href",b);v.setAttribute("target","_blank");v.innerText=h;return v}static dBj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(n.a)(ip,"ClipArtSearchResult",null,[]);class Mj{static get Xg(){return Vf.a.qA(Mj.Lm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Mj.Lm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(n.a)(Mj,"InsertClipartDialogHtml",null,[]);class Ug extends Vf.a{constructor(b){super();this.AAa=this.Xtb=0;this.Hah=null;this.UNe=!1;this.QXb=this.tXa=this.HN=null;this.LWi=h=>{const v=this.yW.value;v&&0<v.trim().length&&(this.search(this.yW.value),this.hqa(1,!1));h.preventDefault();h.stopPropagation()};this.Lsn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.LWi(h),h.preventDefault(),h.stopPropagation())};this.MWi=h=>{100<=this.yW.value.length&&(h.preventDefault(),h.stopPropagation())};
this.jrn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.B2i(h);this.jag(h)};this.onScroll=()=>{if(this.Er&&this.Er.children&&!(2>this.Er.children.length)){var h=this.Er.children[0].children[0],v=this.Er.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Er.scrollTop,D=h.clientHeight+2,Q=parseInt(String(this.Er.scrollTop/D));h=parseInt(String(v/D));var ba=parseInt(String(this.Er.clientWidth/D));h<v/D&&h<parseInt(String(this.HN.length/ba))&&h++;for(v=Q;v<h;v++)for(D=
0;D<ba;D++){var ta=v*ba+D;Q=this.HN[ta];(ta=document.getElementById("clip"+ta))&&!ta.childNodes.length&&(Q=this.WMh(Q),ta.appendChild(Q))}}};this.Ttn=h=>{h.target.setAttribute("src",zj.a.vg("phthumb.64x64x32.png"))};this.krn=h=>{h.target.setAttribute("src",zj.a.vg("phpreview.96x96x32.png"))};this.lUi=h=>{Id.a.om(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.kon=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.lUi(h)};this.FUi=h=>{const v=h.target.innerText;this.yW&&(this.yW.value=v);this.search(v);h.stopPropagation();h.preventDefault();this.hqa(1,!1)};this.Yon=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.FUi(h)};this.OWi=h=>{this.HN&&(this.Kao(this.HN[this.Xtb]),h.stopPropagation(),h.preventDefault(),this.yW.value="",this.hqa(1,!1))};this.Msn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.OWi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let v=0;switch(h.keyCode){case Sys.UI.Key.up:v=-5;break;case Sys.UI.Key.down:v=5;break;case Sys.UI.Key.left:v=-1;break;case Sys.UI.Key.right:v=1}this.AAa=this.AAa+v<this.Er.children.length-1?0>this.AAa+v?0:this.AAa+v:this.Er.children.length-1;this.jag(this.AAa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Er.children.length&&this.zhj(h)):h.keyCode===Sys.UI.Key.tab&&
(this.AAa=h.shiftKey?Math.max(0,this.AAa-1):Math.min(this.AAa+1,this.Er.children.length-1))};this.onError=()=>{this.Er&&(this.Er.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.I3i=h=>{if(this.Er)if(h.data.Fia){var v=h.data.Fia.lastChild.childNodes;this.HN||(this.HN=[]);for(h=0;h<v.length&&100>this.HN.length;h++){var D=v[h];1===D.nodeType&&"image"===D.nodeName&&(D=ip.$Hl(D),this.HN.push(D))}this.gSh();this.HN.length||(this.Er.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.we){h=
G.a.Hvj(h.data.we);try{v=parseInt(h)}catch(Q){v=14}this.Er.innerText=26===v?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.gSh=()=>{if(this.HN){jc.a.f_(this.Er);this.tXa&&(this.tXa.dispose(),this.tXa=null);this.Er.focus();this.Er.classList.remove("ClipartSearchInProgress");for(let v=0;v<this.HN.length;v++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+v;const D=document.createElement("span");D.id="clip"+v;D.classList.add("ClipartImageContainer");
h.appendChild(D);this.Er.appendChild(h);v<parseInt(String(this.Er.clientHeight/D.clientHeight))*parseInt(String(this.Er.clientWidth/D.clientWidth))&&(h=this.WMh(this.HN[v]),D.appendChild(h))}this.UNe&&(this.zhj(this.Xtb),this.jag(this.Xtb))}};this.nAm=h=>{1===h&&this.HN&&Ug.TO.Afa(this.wOg.context)&&(h=this.HN[this.Xtb])&&this.wOg.PHa(h)};this.wOg=b;this.Xg=Mj.Xg;this.wg="InsertClipartDialog";this.Ee(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.nAm);this.Er=document.getElementById("clipartsearchresults");this.Atd=this.onKeyDown;lf.a.addHandler(this.Er,"keydown",this.Atd);this.ztd=this.onScroll;lf.a.addHandler(this.Er,"scroll",this.ztd);this.yW=document.getElementById("textInput");this.Zvd=this.Lsn;lf.a.addHandler(this.yW,"keydown",this.Zvd);this.$vd=this.MWi;lf.a.addHandler(this.yW,"keypress",this.$vd);this.awd=this.MWi;lf.a.addHandler(this.yW,"paste",this.awd);this.jpc=document.getElementById("btnSearch");this.jpc.setAttribute("src",
zj.a.vg("search.16x16x32.png"));this.ytd=this.LWi;lf.a.addHandler(this.jpc,"click",this.ytd);this.cUb=document.getElementById("clipartpreviewimage");this.oye=document.getElementById("clipartattributedisplayname");this.n$a=document.getElementById("clipartseesimilar");this.nye=document.getElementById("clipartdimensions");this.Orc=document.getElementById("clipartadditionalvalue");this.pye=document.getElementById("clipartratingvalue");this.BVa=document.getElementById("clipartattributionvalue");this.CVa=
document.getElementById("clipartkeywords");this.lye=document.getElementById("clipartadditionalname");this.qye=document.getElementById("clipartratingname");this.mye=document.getElementById("clipartattributionname");this.WNe=this.jrn;this.EUe=this.Ttn;this.skd=this.lUi;this.tkd=this.kon;this.nHe=this.FUi;this.oHe=this.Yon;this.Ctd=this.OWi;this.Dtd=this.Msn;this.yW.focus();this.hqa(1,!1)}dispose(){this.Er&&this.tDh();this.Er&&this.Atd&&(lf.a.removeHandler(this.Er,"keydown",this.Atd),this.Atd=null);
this.Er&&this.ztd&&(lf.a.removeHandler(this.Er,"scroll",this.ztd),this.ztd=null);this.Er=null;this.yW&&this.Zvd&&(lf.a.removeHandler(this.yW,"keydown",this.Zvd),this.Zvd=null);this.yW&&this.$vd&&(lf.a.removeHandler(this.yW,"keypress",this.$vd),this.$vd=null);this.yW&&this.awd&&(lf.a.removeHandler(this.yW,"paste",this.awd),this.awd=null);this.yW=null;this.jpc&&this.ytd&&(lf.a.removeHandler(this.jpc,"click",this.ytd),this.jpc=this.ytd=null);this.mye=this.qye=this.lye=this.CVa=this.BVa=this.pye=this.Orc=
this.nye=this.n$a=this.oye=this.cUb=this.Dtd=this.Ctd=this.oHe=this.nHe=this.tkd=this.skd=this.QXb=this.EUe=this.WNe=null;this.tXa&&(this.tXa.dispose(),this.tXa=null);super.dispose()}tL(){super.tL();document.getElementById(this.kj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.NNb(b,!1,this.I3i)}NNb(b,h,v){this.AAa=this.Xtb=0;this.tDh();if(this.HN&&b===this.Hah&&this.UNe===h)window.setTimeout(this.gSh,500);else{this.HN&&(Array.clear(this.HN),this.HN=null);this.Hah=b;this.UNe=
h;var D=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');D.append("<query>");D.append(G.a.Af(b));D.append("</query>");D.append("<mediatype>Illustration</mediatype>");D.append("<mediatype>Photo</mediatype>");D.append("<filetype>jpg</filetype>");D.append("<filetype>jpeg</filetype>");D.append("<filetype>gif</filetype>");D.append("<filetype>bmp</filetype>");D.append("<filetype>tif</filetype>");D.append("<filetype>tiff</filetype>");D.append("<filetype>png</filetype>");D.append("</search>");
b=w.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let Q=b.length;4>Q;Q++)b="0"+b;w.AFrameworkApplication.Ne.tj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Ya.App.webServiceBase,b,Sd.a.vxo,h.toString()),2,D.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,v,this.onError,null)}}Kao(b){this.NNb(b.assetId,!0,this.I3i);this.HN||(this.HN=[],this.HN.push(b))}WMh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);lf.a.addHandler(h,"click",this.WNe);lf.a.addHandler(h,"error",this.EUe);return h}Qjl(b){1===b.childNodes.length&&(b=b.childNodes[0],lf.a.removeHandler(b,"click",this.WNe),lf.a.removeHandler(b,"error",this.EUe))}B2i(b){const h=this.HN[b];var v=h.kGn;this.rDh();this.QXb=this.krn;var D=document.createElement("img");D.setAttribute("src",v);if(h.displayName)v=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{v=new Sys.StringBuilder;for(let Q=0;Q<h.keywords.length&&5>Q;Q++)Q&&v.append(", "),v.append(h.keywords[Q]);v=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,v.toString())}D.setAttribute("title",v);D.setAttribute("alt",v);lf.a.addHandler(D,"error",this.QXb);this.cUb.appendChild(D);D=document.getElementById("clip"+this.Xtb);D.classList.remove("ClipartSelectedImage");D=document.getElementById("clip"+
b);D.classList.add("ClipartSelectedImage");this.Xtb=b;h.displayName&&(this.oye.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');lf.a.addHandler(b,"click",this.Ctd);lf.a.addHandler(b,"keydown",this.Dtd);this.n$a.appendChild(b);this.nye.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.I5n,h.fileSize);(b=h.jzk)&&h.Hqh?(this.Orc.parentNode.style.display="block",this.lye.innerText=h.Hqh,this.Orc.appendChild(b)):
this.Orc.parentNode.style.display="none";this.pye.appendChild(h.bOn);jc.a.f_(this.BVa);if(b=h.xHk)this.BVa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(lf.a.addHandler(b,"click",this.skd),lf.a.addHandler(b,"keydown",this.tkd));this.CVa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)D=h.keywords[b],v=document.createElement("a"),v.innerText=D,v.setAttribute("href",'""'),lf.a.addHandler(v,"click",this.nHe),lf.a.addHandler(v,"keydown",this.oHe),this.CVa.appendChild(v),
b<h.keywords.length-1&&(D=document.createElement("span"),D.innerText=", ",this.CVa.appendChild(D));this.qye.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.mye.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.hqa(1,!0)}rDh(){this.cUb&&1===this.cUb.childNodes.length&&(this.QXb&&(lf.a.removeHandler(this.cUb.childNodes[0],"error",this.QXb),this.QXb=null),jc.a.f_(this.cUb));this.BVa&&0<this.BVa.childNodes.length&&"a"===this.BVa.childNodes[0].nodeName.toLowerCase()&&(this.skd&&lf.a.removeHandler(this.BVa.childNodes[0],
"click",this.skd),this.tkd&&lf.a.removeHandler(this.BVa.childNodes[0],"keydown",this.tkd));this.n$a&&0<this.n$a.children.length&&"a"===this.n$a.children[0].nodeName.toLowerCase()&&(this.Ctd&&lf.a.removeHandler(this.n$a.children[0],"click",this.Ctd),this.Dtd&&lf.a.removeHandler(this.n$a.children[0],"keydown",this.Dtd),jc.a.f_(this.n$a));if(this.CVa){for(let b=0;b<this.CVa.childNodes.length;b++){const h=this.CVa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(lf.a.removeHandler(h,"click",this.nHe),lf.a.removeHandler(h,
"keydown",this.oHe))}jc.a.f_(this.CVa)}this.oye.innerText="";this.nye.innerText="";jc.a.f_(this.Orc);jc.a.f_(this.pye);jc.a.f_(this.BVa);this.CVa.innerText="";this.lye.innerText="";this.qye.innerText="";this.mye.innerText=""}zhj(b){if(!(this.Er.children.length<=b||0>b)){var h=this.Er.children[b],v=this.Er.children[0];v=v.clientHeight-v.children[0].clientHeight+2;this.Er.scrollTop+this.Er.clientHeight<h.offsetTop+h.clientHeight?this.Er.scrollTop=h.offsetTop-3*h.clientHeight-v:this.Er.scrollTop>h.offsetTop&&
(this.Er.scrollTop=h.offsetTop-v/2);this.B2i(b)}}validate(){return!0}tDh(){if($c.FocusManager.$J()){var b=$c.FocusManager.instance().getRegion(this.TK);b&&b.Zj.Iy(this.yW)}else this.yW.focus();for(b=0;b<this.Er.childNodes.length;b++){const h=this.Er.childNodes[b];1===h.childNodes.length&&this.Qjl(h.childNodes[0])}jc.a.f_(this.Er);this.rDh();this.hqa(1,!1);this.tXa=new Go.a(Box4Intl.Box4Strings.l_ClipartSearching);this.tXa.iBi=!1;this.Er.appendChild(this.tXa.element);this.Er.classList.add("ClipartSearchInProgress")}jag(b){this.AAa=
b;b=this.Er.children[this.AAa];$c.FocusManager.$J()?$c.FocusManager.instance().getRegion(this.TK).Zj.Iy(b):b.focus()}static get TO(){return Ug.Oj=Ug.Oj||Ga.a.instance.resolve("Box4.Images.IImageEditor")}}Ug.Oj=null;Object(n.a)(Ug,"InsertClipartDialog",Vf.a,[]);class jp extends Ol{constructor(b,h,v,D,Q,ba){super(b,h,v,D,Q,ba,!1);this.Sqn=ta=>{if(this.gPm()){var Ta=this.Fe.Bi(),ob=Ta.contentReplicator.Bt.toString(),Kb=new Sys.Net.WebRequest;Kb.set_url("ClipArtUpload.ashx");Kb=new Sys.StringBuilder(Kb.getResolvedUrl());
this.MW(Kb,Sd.a.assetId,ta.assetId,!0);this.MW(Kb,Yf.a.lcid,w.AFrameworkApplication.lcid.toString());this.MW(Kb,Yf.a.nodeId,this.$G?this.$G.id.toString():this.Fe.id.toString());this.MW(Kb,Yf.a.cellId,Ta.nm.toString());this.MW(Kb,Yf.a.fileId,Ta.sr);this.MW(Kb,Yf.a.Vta,ob);this.MW(Kb,Yf.a.lX,this.Nl.toString());ta=this.Fe.ia(nh.a.CJ,Vm.a.Ft);this.MW(Kb,Yf.a.CJ,ta.toString());this.MW(Kb,Yf.a.Cqb,"1");Ta.FH&&this.MW(Kb,Yf.a.FH,Ta.FH);this.MW(Kb,Yf.a.classId,this.$G?this.$G.properties.Qc.toString():this.Fe.Qc.toString());
this.Vg.hasProperty(lc.a.imageType)&&this.MW(Kb,Sd.a.imageType,this.Vg.getValue(lc.a.imageType).toString());yj.a.instance.fvk(Kb);w.AFrameworkApplication.Ne.tj(Kb.toString(),2,"",{},!1,2,this.VYo,this.uploadFailed,null);Ol.fec++}};this.VYo=ta=>{if(({group:Ta}=bk.a.l1(ta.data.we)).returnValue){var Ta=Ta.Responses[0];Ta.Bnb=ta.data.MH;Ta.Ir=ta.data.wj?ta.data.wj[Gh.a.L7]:"";this.hza(Ta)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ta=new yh.a;ta.StatusCode=14;this.hza(ta)};new Ug(this)}PHa(b){this.zWd()&&
this.Fe.Bi().contentReplicator.forceOutbound(this.Sqn,null,b)}MW(b,h,v,D){b.append(D?"?":"&");b.append(G.a.Nj(h));b.append("=");b.append(G.a.Nj(v))}jif(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.jif(b)}}hza(b){super.hza(b);Ol.fec--}}Object(n.a)(jp,"ClipartUploader",Ol,[]);class ol{constructor(b,h,v){this.oAm=(D,Q,ba,ta,Ta)=>{if(!this.Oj||!this.Oj.value)return u.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;D=this.Oj.value.Afa(Q);return 2===ba&&D?(new jp(Q,xb.a.instance,w.AFrameworkApplication.K,Ta,this.Jm,this.ga),32):1===ba?D&&Ya.App.iEh?32:8:2};this.Oj=b;this.Jm=h;this.ga=v}Tb(){this.ga.fb(Eb.a.$qi,Zb.a.view,this.oAm,260)}}Object(n.a)(ol,"ClipArtActor",null,[]);class ld{constructor(){this.W=null}get name(){return"Box4.ClipArt"}xc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new ol(b.Ue("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.va)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Tb();
const b=Ya.App.xa;b&&b.updateCommandUI()}dispose(){}}Object(n.a)(ld,"ClipartPackage",null,[1,2]);class Om{constructor(b){this.QXa=this.BXa=this.UXa=this.TXa=null;this.vXg=this.dSg=this.wXg=this.j3g=this.Ah=this.V$=!1;this.sPe=this.Q3g=null;this.A3g=0;this.Ma=this.L3g=null;this.dea=b;this.rN=3;this.MVb=!0}initialize(b,h,v){this.TXa=this.ztf(b,h);this.UXa=CommonUIStrings.l_SavingStatus;this.BXa=CommonUIStrings.l_ReadOnlyStatus;this.QXa=CommonUIStrings.l_ReviewModeStatus;this.dea&&this.dea.execute(D=>
{D.sdb(Object(z.a)(this,this.Zad,"updateToSavingStatus"))});this.Ah=!0;this.Ma=v;this.dSg=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}nqb(b,h){this.V$=b;this.rN=h;this.fUa(this.MVb)}fUa(b){!this.MVb&&b&&(this.L3g=new Date);this.MVb=b;this.vXg=!1;b=null;3===this.rN&&(b=this.MVb?this.TXa:this.UXa);this.aol(b)}ztf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}Zad(){this.fUa(!1)}B2l(){switch(this.rN){case 1:return this.BXa;case 2:return this.QXa;default:return null}}A2l(){if(3!==this.rN)switch(this.rN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.vXg?"FailedToSave":this.MVb?"Saved":"Saving"}vIm(b){return this.j3g===this.V$&&this.A3g===this.rN&&this.Q3g===b}Vef(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.V$,b,this.B2l(),this.L3g,this.MVb,this.dSg?h.getHeaderSaveStatusIconProps(this.A2l()):
null);this.wXg=!0;return null});this.sPe=null}aol(b){this.Ah&&Lh.c()&&!this.vIm(b)&&(!this.wXg&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Vef(b):Id.a.Kde()?(this.sPe&&u.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.sPe=window.requestIdleCallback(()=>{this.Vef(b)})):window.requestAnimationFrame(()=>{this.Vef(b)}),this.j3g=this.V$,this.Q3g=b,this.A3g=this.rN)}}Object(n.a)(Om,"ReactSaveStatusUIHandler",
null,[424]);class zo{constructor(b,h){this.PX=null;this.TXa=CommonUIStrings.l_SavedStatus;this.UXa=CommonUIStrings.l_SavingStatus;this.BXa=CommonUIStrings.l_ReadOnlyStatus;this.QXa=CommonUIStrings.l_ReviewModeStatus;this.eab=h;this.dea=b;this.rN=3;this.kcb=!0}QB(){this.dea&&this.dea.execute(b=>{b.sdb(Object(z.a)(this,this.Zad,"updateToSavingStatus"))});this.eab.execute(b=>{this.PX=b})}nqb(b,h){this.rN=h;3===h?this.fUa(this.kcb):2===h?this.Rkg(this.QXa):this.Rkg(this.BXa)}Zad(){this.fUa(!1)}fUa(b){this.kcb=
b;this.Rkg(this.kcb?this.TXa:this.UXa)}Rkg(b){this.PX&&this.PX.sendMessage(L.a.$Oo,this.H3k(b))}H3k(b){const h={};h.StatusText=b;return h}}Object(n.a)(zo,"SaveStatusPostMessageHandler",null,[424]);var mo=c(215),Qk=c(141);class Ho{constructor(b,h,v,D){this.QXa=this.BXa=this.UXa=this.TXa=null;this.pvb=0;this.HZ=this.AQe=this.qrb=this.Jse=this.RUe=null;this.ng=b;this.Z$a=h;this.dea=v;this.em=D;this.o0g=!0;this.V$=!1;this.rN=3;this.kcb=!0}initialize(b,h){if(!this.ng)return!1;this.TXa=this.ztf(b,h);this.UXa=
CommonUIStrings.l_SavingStatus;this.BXa=CommonUIStrings.l_ReadOnlyStatus;this.QXa=CommonUIStrings.l_ReviewModeStatus;this.QB();return!0}ztf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}QB(){this.Z$a&&this.Z$a.execute(b=>{b.Qxk(Object(z.a)(this,this.DMh,"createStatusAndModeElements"));b.Bxk(Object(z.a)(this,this.tvo,"showHideSaveStatusElement"));b.gKo&&this.DMh(null,
null)});this.dea&&this.dea.execute(b=>{b.sdb(Object(z.a)(this,this.Zad,"updateToSavingStatus"))})}I5(){this.HZ&&this.ng&&this.ng.bza(this.HZ)}tvo(b,h){this.nqb("true"===h,this.rN)}nqb(b,h){this.V$=b;this.rN=h;this.Jse&&(this.Jse.style.display=this.V$||3===this.rN||!this.RUe?"none":"");this.qrb&&(this.qrb.style.display=this.V$||3===this.rN?"none":"",this.qrb.innerText=1===this.rN?this.BXa:this.QXa,this.qrb.title=1===this.rN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.AQe&&(this.AQe.style.display=this.V$||1===this.rN||!this.RUe&&!this.qrb?"none":"");this.HZ&&(this.HZ.style.display=this.V$||1===this.rN?"none":"",this.fUa(this.kcb),this.HZ.title=CommonUIStrings.l_SaveStatusTooltip)}DMh(b,h){b=document.getElementById(mo.CuiHelper.Wqm);h&&h.C2o||!b||""===this.TXa||""===this.UXa||""===this.BXa||""===this.QXa||(this.RUe=document.getElementById(mo.CuiHelper.i4e),this.Jse=mo.CuiHelper.nGd(b,"BreadcrumbAppModeDash","-"),this.qrb=mo.CuiHelper.nGd(b,"BreadcrumbAppModeStatus",
1===this.rN?this.BXa:this.QXa),this.ZEj(this.qrb),this.AQe=mo.CuiHelper.nGd(b,"BreadcrumbSaveStatusDash","-"),this.HZ=mo.CuiHelper.nGd(b,"BreadcrumbSaveStatus",this.TXa),this.ZEj(this.HZ),this.nqb(this.V$,this.rN))}Zad(){this.fUa(!1)}fUa(b){this.kcb=b;this.nXo(this.kcb?this.TXa:this.UXa)}nXo(b){!this.HZ||3!==this.rN&&2!==this.rN||(this.o0g&&!this.kcb?(this.pvb=this.HZ.offsetWidth<this.pvb?this.pvb:this.HZ.offsetWidth,this.SRo(this.UXa),this.o0g=!1):this.HZ.innerText=b)}ZEj(b){b.style.direction=this.em?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.em?"right":"left";b.style.display=this.V$?"none":"";b.setAttribute("Unselectable","on")}SRo(b){this.HZ&&(this.HZ.style.width="",this.HZ.innerText=b,this.pvb=this.HZ.offsetWidth<this.pvb?this.pvb:this.HZ.offsetWidth,b=Qk.a.uB(this.HZ),this.HZ.style.width=this.pvb-jc.a.UM(b.paddingLeft)-jc.a.UM(b.paddingRight)+1+"px")}}Object(n.a)(Ho,"SaveStatusUIHandler",null,[424]);var Iq=c(93);class kq{constructor(){this.BQe=this.GOe=this.cMa=this.W=null}get name(){return"Common.App.SaveStatus"}xc(b){this.W=
b;w.AFrameworkApplication.K.$("PostMessageEmbedded")&&w.AFrameworkApplication.NX?this.W.register(zo,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>new zo(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),this.W.Sa("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.ta.Nb.lGf||(w.AFrameworkApplication.ta.Nb.wJ?this.W.register(Om,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>
new Om(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(Ho,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>new Ho(Iq.EventHandlerManager.instance,this.W.Sa("Common.App.Header.HeaderEventSource"),this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Mx,"onFullAppSettingsReady"))}Mx(){const b=
w.AFrameworkApplication.K,h=!!w.AFrameworkApplication.ta.Nb&&4===w.AFrameworkApplication.ta.Nb.Sl;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.K.$("PostMessageEmbedded")&&w.AFrameworkApplication.NX?(this.BQe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.BQe.QB():w.AFrameworkApplication.ta.Nb.lGf||
b.$("PreventSaveStatusInitializationWithHiddenHeader")&&w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.ta.Nb.wJ?(this.GOe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.GOe.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.K):(this.cMa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.cMa.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus")))}dispose(){this.cMa&&this.cMa.I5()}}Object(n.a)(kq,
"PackageManager",null,[1,2]);var Ik=c(1649);class no{get name(){return"Common.App.EventsCachePackage"}xc(){}init(){Ik.a.instance.init()}dispose(){}static main(){N.a.instance.Fc(new no)}}Object(n.a)(no,"EventsCachePackage",null,[1,2]);var rj=c(130),mg=c(161),Jk=c(87),cl=c(619),Ff=c(307),Xo=c(443),Kk=c(284),qf=c(25),Aj=c(241),ka=c(24);class bb{constructor(b){this.v_g=!1;this.ydd=this.qm=null;this.Hre=!1;this.pE=b}get control(){return this.pE}get Pd(){return this.control.Pd}get root(){return this.control.root}get XH(){return this.control.XH}get MYa(){return this.control.MYa}get tk(){return this.control.tk}get UE(){return this.control.UE}LI(){}initialize(){}Yw(b,
h,v){this.control.Wol(b,h,v)}xm(){qf.c(this.control.Hh.Command)||this.iu(this.control.Hh.Command,null,null)}iu(b,h,v){let D=0;this.root&&(D=this.root.Fpa(b,h,v));this.control.enabled=0<(D&1);return D}X7a(){let b=this.control.visible;this.root.zTa&&(b=this.Pd[Aj.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Qdc=!0));return b}qmg(){const b=ka.a.$qa(this.Pd[Aj.a.labelText],this.control.Hh.LabelText);this.wge(b)}wge(b){this.control.labelText!==b&&(this.UE.forEach(h=>{h.wge(b)}),
this.control.labelText=b,this.root.q4a=!0)}NQb(){const b=ka.a.$qa(this.Pd[Aj.a.alt],this.control.Hh.Alt);this.cjc(b)}cjc(b){this.control.tooltip!==b&&(this.UE.forEach(h=>{h.cjc(b)}),this.control.tooltip=b)}Aja(){const b=ka.a.$qa(this.Pd[cl.a.Image16by16Class],this.control.Hh.Image16by16Class),h=ka.a.$qa(this.Pd[cl.a.Image32by32Class],this.control.Hh.Image32by32Class);var v=ka.a.$qa(this.Pd[cl.a.Image48by48Class],this.control.Hh.Image48by48Class);v=qf.b(v)?h:v;this.nEc(this.UE.small,b);this.nEc(this.UE.medium,
b);this.nEc(this.UE.large,h);this.nEc(this.UE.qyo,b);this.nEc(this.UE.lcc,v)}nEc(b,h){!b||qf.c(b.GQ)||qf.c(h)||b.GQ.className===h||(b.GQ.className=h)}ETo(b){if(!qf.b(b)&&this.root.Ugg){for(const h of this.control.N8e){const v=h.GT===b;v&&(this.control.ZXe=h);this.control.visible&&(h.WA=v)}this.control.visible&&(this.root.q4a=!0)}}Czk(){if(this.UE.lcc&&this.UE.lcc.vO&&this.UE.lcc.Xfb){const b=this.UE.lcc.vO,h=ka.a.$qa(this.Pd[Ff.a.Description],this.control.Hh.Description);qf.b(h)&&(b.style.position=
"relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.tk;Object(yb.a)(Xo.a,b)?this.XH.hqb(b):this.root.WAb=this.control;return!1}onBlur(){const b=this.tk;this.control.SHb()&&ka.a.xw(b.Nc,"cui-ctl-menu-hovered-without-focus");this.root.WAb=null;return!1}hP(b){if(this.control.SHb()){var h=this.XH.zqa;const v=h===this.root.vJb-1;h=v?null:this.root.ZC[h+1];this.H7e(!1);v||this.control===h||ka.a.xw(h.CIb,Kk.MenuLauncher.PYc);this.control.enabled&&
this.control.Au?v?this.control.GY():(ka.a.Zf(this.tk.Nc,"cui-ctl-menu-hovered-without-focus"),h.cga=this.control.Au):v?this.XH.setFocus(b.kg):(h.cga=this.XH.Nc,this.XH.Wpa())}return!1}GJ(){this.control.SHb()&&ka.a.xw(this.tk.Nc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!qf.c(b.Gb)&&!qf.c(b.Gb.rawEvent)){const v=b.Gb.keyCode;b=b.Gb.rawEvent.shiftKey;v===Sys.UI.Key.enter&&(h=!0);if(Object(yb.a)(Xo.a,this.tk)){const D=this.XH;if(!qf.c(D)){const Q=D.zqa,ba=0===this.root.c1,
ta=!qf.c(this.control.lzn);if(v!==Sys.UI.Key.tab&&v!==Sys.UI.Key.left&&v!==Sys.UI.Key.right&&v!==Sys.UI.Key.up&&v!==Sys.UI.Key.down&&v!==Sys.UI.Key.esc)return h;Id.a.h7e();v!==Sys.UI.Key.tab||b?v===Sys.UI.Key.tab&&b?(D.QK(1),h=!0):v===Sys.UI.Key.left&&ba||v===Sys.UI.Key.right&&!ba?(ta?D.QK(2):0<Q&&this.root.UZa(Q,!0,!1),h=!0):v===Sys.UI.Key.right&&ba||v===Sys.UI.Key.left&&!ba?(ta&&D.QK(4),h=!0):v===Sys.UI.Key.up?(D.QK(5),h=!0):v===Sys.UI.Key.down?(D.QK(6),h=!0):v===Sys.UI.Key.esc&&(this.root.UZa(Q,
!0,!1),h=!0):(D.QK(0),h=!0)}}}return h}Ay(b){let h=!1;if(!qf.c(b.Gb)&&!qf.c(b.Gb.rawEvent)){const v=b.Gb.keyCode;Yb.KeyInputManager.cmi(b)||v!==Sys.UI.Key.enter&&v!==Sys.UI.Key.space||(h=this.lwf(b),h||(this.Yw(b.zf,1,b.Gb),h=!0))}return h}$C(b){this.C8e();if(this.MYa){let h=!0;2===b.kg&&(h=b.vca===Sys.UI.MouseButton.leftButton);h&&this.tk&&this.tyd(this.tk.Nc)}(b.Gb.type.toLowerCase()!==Sc.a.zP||this.MYa)&&b.Gb.preventDefault();return!1}get SBf(){return this.v_g}ktl(){this.v_g=!0}C8e(){this.SBf&&
this.control.root.Heb()}yxa(b){Object(yb.a)(Xo.a,this.tk)&&!this.MYa&&2===b.kg&&b.vca===Sys.UI.MouseButton.leftButton?(this.Yw(b.zf,b.kg,b.Gb),b=!0):b=this.control.Nua(b);return b}onClick(b){let h=!1;Object(yb.a)(Xo.a,this.tk)&&!this.MYa&&3===b.kg&&(this.Yw(b.zf,b.kg,b.Gb),h=!0);return aa.a.ui?!1:h}rmb(b){return this.P5d(b)}vGa(b){this.Nua(b);return!1}P5d(b){return qf.c(this.qm)?!1:(this.z$f(Id.a.IZd(this.smh,b.clientPoint)),!0)}Aec(b){let h=!1;this.Nua(b)&&(h=!0);3!==b.kg&&(b=!0,!this.root&&bb.sRf&&
(u.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.n3(),h=!0);return h}Dec(b){return this.Nua(b)}Bec(b){return this.P5d(b)}Cec(b){return this.Nua(b)}yec(b){return 3===b.kg?(this.root.n3(),!0):!1}zec(){return!1}get smh(){!qf.c(this.qm)&&qf.c(this.ydd)&&(this.ydd=Id.a.getElementBounds(this.qm));return this.ydd}z$f(b){this.Hre!==b&&(this.Hre=b,this.$Xe(this.Hre))}$Xe(b){qf.c(this.qm)||ka.a.D5(this.qm,Jk.Control.wyd,b)}tyd(b){this.control.enabled&&(this.qm=b,this.root.nDc=this.control,
this.z$f(!0),this.root.ufa(this.control,!1))}Nua(b){if(!qf.c(this.qm)){this.z$f(!1);let h=!!this.root;if(bb.sRf){const v=Rc.ActionManager.Baa(parseInt(this.control.Hh.Command))||"";u.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,v)}h&&this.root.nba(this.control,!1);qf.c(b)||Id.a.IZd(this.smh,b.clientPoint)&&this.Yw(this.qm,b.kg,b.Gb);h=!!this.root;bb.sRf&&u.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.nDc=null);this.ydd=this.qm=null;return!0}return!1}QK(b){return Object(yb.a)(Xo.a,
this.tk)&&2!==b&&4!==b&&!Id.a.y$b(this.control.Au)?this.GY():!1}GY(){try{if(this.control.visible){const b=this.control.Au;if(!qf.c(b))return b.focus(),!0}}catch(b){}return!1}H7e(b){const h=this.XH;qf.c(h)||this.root.UZa(h.zqa+1,b)}mpa(){}lwf(){return!1}GX(b){let h=null;b&&b.rawEvent&&(h={},h[bb.triggerTime]=b.rawEvent.timeStamp);return h}static get sRf(){null==bb.OKe&&(bb.OKe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return bb.OKe}}
bb.triggerTime="TriggerTime";bb.OKe=null;Object(n.a)(bb,"ControlBehavior",null,[437]);var ub=c(180);class Xb extends bb{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Hh}LI(b){const h=b.Mm;b=b.GT;qf.c(h)||(Nc.a.instance.mb(Sc.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),Nc.a.instance.mb(Sc.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),mg.a.instance.mb(Sc.a.pointerOver,h,Object(z.a)(this,this.hP,"onPointerOver")),mg.a.instance.mb(Sc.a.pointerOut,
h,Object(z.a)(this,this.GJ,"onPointerOut")),Yb.KeyInputManager.instance.eE(Sc.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),Yb.KeyInputManager.instance.eE(Sc.a.eu,h,Object(z.a)(this,this.GG,"onKeyPress"),b),Yb.KeyInputManager.instance.eE(Sc.a.uh,h,Object(z.a)(this,this.Ay,"onKeyUp"),b),mg.a.instance.mb(Sc.a.pointerDown,h,Object(z.a)(this,this.$C,"onPointerDown")),mg.a.instance.mb(Sc.a.VM,h,Object(z.a)(this,this.yxa,"onPointerUp")),Sh.a.instance.mb(Sc.a.click,h,Object(z.a)(this,this.onClick,
"onClick")),ub.a.instance.mb(Sc.a.yP,h,Object(z.a)(this,this.rmb,"onTouchMove")),ub.a.instance.mb(Sc.a.VJ,h,Object(z.a)(this,this.vGa,"onTouchEnd")))}Yw(b,h,v){this.control.enabled&&(b=null,this.tk&&this.tk.FUc()&&this.XH&&(b=this.root.ZC[this.XH.zqa])&&!this.SBf&&(b.OSa(this.button),b=null),this.executeCommand(this.control.Hh.Command,h,!0,v),b&&b.OSa(this.button))}executeCommand(b,h,v,D){if(!qf.c(b)){const Q=this.Pd;Q.CommandValueId=this.button.NDb();Q.MenuItemId=this.button.Hh.MenuItemId;Q.SourceControlId=
this.control.id;this.root.executeCommand(b,Q,this.tk,h,v,null,this.GX(D))}}xm(){qf.c(this.control.Hh.Command)||0<(this.iu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)&&this.X7a()&&this.cUa()}cUa(){this.qmg();this.NQb();this.Aja()}onFocus(b){super.onFocus(b);this.Ofg();return!1}onBlur(b){super.onBlur(b);this.lhf();return!1}onKeyDown(b){let h=super.onKeyDown(b);qf.c(b.Gb)||this.Icg(b.Ro,b.Gb.keyCode)&&(h=!1);return h}GG(b){let h=!1;qf.c(b.Gb)||qf.c(b.Gb.rawEvent)||(this.Icg(b.Ro,
b.Gb.rawEvent.keyCode)?(this.Yw(b.zf,b.kg,b.Gb),h=!0):b.Gb.preventDefault());return h}Icg(b,h){if(aa.a.At&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Ay(b){let h=!1;qf.c(b.Gb)||this.Icg(b.Ro,b.Gb.keyCode)||(h=super.Ay(b));return h}Ofg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}lhf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(n.a)(Xb,
"ButtonBehavior",bb,[]);var tc=c(979);class Tc{}Tc.Color="Color";Tc.IndexColorSelected="ColorSelected";Object(n.a)(Tc,"ColorPickerCommandProperties",null,[]);class Md extends bb{constructor(b){super(b);this.DAc=this.vv=-1}get colorPicker(){return this.control}get pNa(){return this.colorPicker.F_k.pNa}get properties(){return this.colorPicker.Hh}Yw(b,h,v){if(this.control.enabled){const D=this.Pd;D.Color=Md.xQd(b)[tc.ColorPicker.jEd];b=null;ka.a.Rr(this.properties.Stateful)&&this.tk&&this.tk.FUc()&&
this.XH&&(b=this.root.ZC[this.XH.zqa]);this.root.executeCommand(this.properties.Command,D,this.tk,h,!0,null,this.GX(v));b&&b.OSa(this.colorPicker)}}xm(){var b=this.Pd;b.SourceControlId=this.properties.Id;if(0<(this.iu(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Tc.IndexColorSelected in this.Pd&&(b=this.Pd[Tc.IndexColorSelected]),b!==this.DAc)){const h=this.pNa;0<=b&&b<h.length&&this.nEj(h[b],!0);0<=this.DAc&&this.DAc<h.length&&this.nEj(h[this.DAc],!1);this.DAc=b}}nEj(b,h){h?
ka.a.Zf(b,"cui-colorpicker-selected"):ka.a.xw(b,"cui-colorpicker-selected")}LI(b){for(let h=0;h<b.EXe.length;++h){const v=b.EXe[h];Nc.a.instance.mb(Sc.a.focus,v,Object(z.a)(this,this.MSf,"onCellFocus"));Nc.a.instance.mb(Sc.a.blur,v,Object(z.a)(this,this.Ukn,"onCellBlur"));Yb.KeyInputManager.instance.mb(Sc.a.fi,v,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.uh,v,Object(z.a)(this,this.Ay,"onKeyUp"));Sh.a.instance.mb(Sc.a.click,v,Object(z.a)(this,this.Vkn,"onCellClick"));
mg.a.instance.mb(Sc.a.VM,v,Object(z.a)(this,this.OSf,"onCellPointerUp"));mg.a.instance.mb(Sc.a.pointerOver,v,Object(z.a)(this,this.NSf,"onCellPointerOver"));mg.a.instance.mb(Sc.a.pointerDown,v,Object(z.a)(this,this.Wkn,"onCellPointerDown"))}}MSf(b){b=Md.xQd(b.zf);this.XH.hqb(this.tk);this.jne(b,!0);return!0}Ukn(b){this.jne(Md.xQd(b.zf),!1);return!0}jne(b,h){h?(this.vv=parseInt(b.getAttribute("arrayPosition")),ka.a.Zf(b,"cui-colorpicker-hoveredOver"),this.Ofg(b)):(this.vv=-1,this.lhf(b),ka.a.xw(b,
"cui-colorpicker-hoveredOver"))}Vkn(b){3===b.kg&&this.Yw(b.zf,b.kg,b.Gb);return!0}OSf(b){3!==b.kg&&this.Yw(b.zf,b.kg,b.Gb);return!0}NSf(b){this.H7e(!1);b=parseInt(Md.xQd(b.zf).getAttribute("arrayPosition"));this.L6c(b);return!0}Wkn(){return!1}Ofg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!qf.b(h)){const v=this.Pd;v.Color=b[tc.ColorPicker.jEd];this.root.executeCommand(h,v,this.tk,0,!1)}}}lhf(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!qf.b(h)){const v=
this.Pd;v.Color=b[tc.ColorPicker.jEd];this.root.executeCommand(h,v,this.tk,0,!1)}}}QK(b){b=Jk.Control.alf(this.vv,this.colorPicker.width,this.pNa.length,b);if(b!==this.vv&&this.L6c(b))return!0;this.jne(this.pNa[this.vv],!1);return!1}GY(){return this.L6c(0)}L6c(b){return this.pNa&&this.pNa.length>b&&(b=this.pNa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}mpa(){-1!==this.vv&&this.jne(this.pNa[this.vv],!1)}static xQd(b){return Md.j3l(b)}static j3l(b){var h=["td"];const v=h.length;if(!b)return null;
for(var D=0;D<v;D++)if(b.tagName.toLowerCase()===h[D].toLowerCase())return b;for(b=b.parentNode;b;){for(D=0;D<v;D++)if(b.tagName.toLowerCase()===h[D].toLowerCase())return b;b=b.parentNode}return null}}Object(n.a)(Md,"ColorPickerBehavior",bb,[]);var le=c(337),md=c(292),Ee=c(1673),ef=c(687),Wf=c(371),Ag=c(1120);class Dh{constructor(b,h){this.Dlk=b;this.h_g=h}ege(b,h,v,D){if(qf.c(b)||qf.c(h))return null;const Q=new Ag.a;const ba=D.x;var ta=D.y;const Ta=D.width;var ob=D.height;let Kb;Dh.D4b(h,"flyoutWidth");
D=Dh.D4b(h,"flyoutRealHeight");const Vb=Dh.D4b(h,"viewportWidth");var bc=Dh.D4b(h,"viewportHeight"),Dc=Dh.D4b(h,"viewableLeft");const Oc=Dh.D4b(h,"viewableTop"),gd=this.Dlk;let rd=!1,je=!1;const Ld=1===v,Qd=4===v,ge=this.h_g;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Kb=this.ZMi(b);Q.tJj=bc;Q.mog=Vb;if(Ld)gd?h=ba+Ta:(h=ba-Kb,Q.Fkb=!0),ob=ta;else{var ze="";Ta>Kb&&(Kb=Ta,ze=(Kb-2*Wf.Menu.S3d).toString());gd?h=ba:(h=ba+Ta-Kb,Q.Fkb=!0);ob=ta+ob;""!==ze&&
(b.style.minWidth=ze+"px")}ge&&(ob+=Oc,h+=Dc);b.style.top=ob+"px";b.style.left=h+"px";let gg=!1;ze=!1;Kb<=Vb?h+Kb>Dc+Vb?(Ld&&gd&&ba-Kb>Dc||Qd&&ba-Kb>Dc?(h=ba-Kb,ge&&(h+=Dc),ze=Q.Fkb=!0):(h=Dc+Vb-Kb,rd=!0),gg=!0):h<Dc&&(Ld&&!gd&&ba+Ta+Kb<Dc+Vb?(h=ba+Ta,ge&&(h+=Dc),Q.Fkb=!1,ze=!0):(h=Dc,je=!0,Q.Fkb=!0),gg=!0):gd?(h=Dc,gg=!0,Q.Fkb=!0):(h=Dc+Vb-Kb,gg=!0,Q.Fkb=!1);gg&&(b.style.left=h+"px");Q.p6b=ob;ob+D<=Oc+bc&&3!==v||(Q.DIf=!0,{Gfn:v,oFl:ta,TJm:bc,PQm:Dc}=this.ykf(v,ob,D,ta,Oc,bc),ob!==v&&(b.style.top=
v+"px",Q.p6b=v),-1<ta&&(b.style.maxHeight=ta+"px"),bc&&(b.style.bottom="0px",b.style.height="auto"),Dc&&this.P8m(b,gd,Ld,ze,je,rd,Vb,ba,Ta));Q.oMc=h;Q.Ykf=Kb;Q.Ukf=D;return Q}ykf(b,h,v,D,Q,ba){let ta,Ta,ob;ta=-1;ob=Ta=!1;const Kb=h,Vb=Q+ba-h;h=D-v;const bc=this.h_g;let Dc=!1;0>h&&(h=Q);bc||(D-=Q);v<=D&&1!==b||(4===b||1===b?v<ba?(h=ba-v,Ta=!0):(h=Q,Dc=ob=Ta=!0):(D<Vb&&3!==b?(h=Kb,Ta=!0):ta=D,ob=!0));bc&&(Ta=!1,Dc?ta=ba:h+=Q);return{Gfn:h,oFl:ta,TJm:Ta,PQm:ob}}P8m(b,h,v,D,Q,ba,ta,Ta,ob){b.style.overflowY=
"scroll";b.style.width="auto";if(h){if(ba||D)b.style.left="",b.style.right=(ba?0:ta-Ta)+"px"}else Q||D||(b.style.left="",b.style.right=(v?ta-Ta:ta-Ta-ob)+"px")}FTl(b){const h={};if(qf.c(b))return h;h.viewportWidth=jc.a.oFb();h.viewportHeight=jc.a.HX();qf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);qf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=
window.pageYOffset;h.viewableLeft=window.pageXOffset;qf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);qf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*Wf.Menu.S3d:b.scrollHeight;const v=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.ZMi(b);b.style.overflowY=v;return h}ZMi(b){return b.offsetWidth}static D4b(b,
h){return qf.c(b)?0:b[h]}}Object(n.a)(Dh,"MenuPositioner",null,[]);var gh=c(505),gl=c(601),Al=c(1122),Pm=c(1121),ck=c(1118),Zf=c(1119),qk=c(1124),vn=c(385),zh=c(977);class Qm extends bb{constructor(b){super(b);this.KJe=0;this.d3g=null;this.gNe=-1;this.Khd=null;this.oZf=this.eXg=!1;this.vak=new Dh(0===this.root.c1,ka.a.Rr(this.root.properties.DivSyndicated))}get oNi(){return this.vak}get Iu(){return this.control}get properties(){return this.control.Hh}get menu(){return this.Iu.menu}set menu(b){this.Iu.menu=
b}get gL(){return this.Iu.gL}set gL(b){this.Iu.gL=b}get Gvh(){qf.c(this.Khd)&&(this.Khd=Qm.E$k());return this.Khd}get cqj(){let b=!this.root.$yf;Object(yb.a)(441,this.root)&&1===this.root.vJb&&(b=!0);return b}Yw(b,h){Object(yb.a)(441,this.root)&&this.root.Ehf();this.Iu.c0(h)}c0(b){if(this.Iu.enabled&&!this.gL){var h=Ye.a.instance.Ap(Ua.a.c0);h.properties.add("Id",this.Iu.Hh.Id);h.properties.add("InputMethod",le.a[b]);h.end();ch.a.mark(10326);Id.a.P3d(this.Iu.Hh.Id,"MenuOpen");this.Iu.Au&&(this.Iu.cga=
Id.a.COa(this.Iu.Au.ownerDocument));this.KJe=b;this.m1i(b);this.wfe();this.Iu.O7a(this.Iu.Au,!0)}}wfe(){qf.c(this.properties.PopulateAsyncTriggerCommand)||this.eXg||(this.lhn(),this.eXg=!0)}lhn(){const b={};b[Ee.a.Callback]=Object(z.a)(this,this.S7i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.tk,0,!1)}S7i(){this.Iu.kSa()}kSa(){this.gL&&this.m1i(this.KJe,!0)}m1i(b,h=!1){var v=!0;if(ka.a.Rr(this.properties.PopulateDynamically)){v=!1;const D=this.q1c(b);
D!==this.d3g&&(v=this.DZf(D,h));v=v||!this.gL}v&&(h=w.AFrameworkApplication.ta.Gq,v=null,h&&(v=h.$f("LoadResource","Menu Initialization")),this.TEa(b),v&&v.stop(),this.b7d())}TEa(b){if(!qf.c(this.menu)){if(this.Iu.U4a){var h=this.Iu.tk;if(h&&h.keytip){var v=h.keytip.key.toLocaleLowerCase();this.menu.Ako(String.format("{0} {1}",this.Iu.U4a,h.keytip.Kgf),this.Iu.ORa&&""!==this.Iu.ORa?String.format("{0}-{1}",this.Iu.ORa,v):v)}}this.menu.bna();ka.a.Zf(this.menu.Nc,this.Iu.G_e);ka.a.D5(this.menu.Nc,"cui-touch",
3===b||this.root.Tle);if(this.menu.hasItems()){this.menu.LI();h=this.tk;h.SVh();h.xRc=!0;h.Jf(this.menu);h.xRc=!1;this.menu.h1i();v=Object(yb.a)(zh.a,this.root);var D=null,Q=!1;v&&(D=this.root,Q=D.F6a,D.F6a=!1);var ba=this.menu.Nc;ba.style.visibility="hidden";ba.style.position="absolute";ba.style.top="0px";ba.style.left="0px";aa.a.At&&!aa.a.Ijb&&(ba.style.maxHeight="100px",ba.style.overflowY="scroll");document.body.appendChild(ba);this.Gzk();this.PDn(ba);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.Xpk();ka.a.Zf(this.Iu.CIb,Kk.MenuLauncher.PYc);var ta=this.root.vJb;this.Zqo&&this.root.ufa(this.control,!0);ba.style.zIndex=String(w.AFrameworkApplication.ta.Ata);this.root.Esk(this.Iu);this.menu.zqa=ta;ba.style.visibility="visible";ta=this.e5h();if(Object(yb.a)(Zf.a,this.menu)){ba.style.position="fixed";const Ta=this.root.ZC[0];Ta&&Ta.menu&&Ta.menu.Nc?100!==Id.a.NOc(this.root.ZC[0].menu.Nc)&&md.a.feg(ba,ta,Object(z.a)(this,this.R_e,"afterShowMenu")):md.a.feg(ba,ta,Object(z.a)(this,this.R_e,
"afterShowMenu"))}else md.a.feg(ba,ta,Object(z.a)(this,this.R_e,"afterShowMenu"));this.gL=!0;this.menu.CIf=!0;!aa.a.ui&&this.Iu.Bco&&this.menu.setFocus(b);v&&(D.F6a=Q);v=this.properties.CommandMenuOpen;qf.b(v)||this.root.executeCommand(v,null,h,b,!1)}}ch.a.mark(10327)}b7d(){}Xpk(){this.gNe=ka.a.mAb(this.gNe);this.gNe=window.setTimeout(Object(z.a)(this,this.Ypk,"addAndPositionBackFrameInternal"),50)}Ypk(){this.menu&&this.menu.Nc&&(document.body.appendChild(this.Gvh),this.LDn())}LDn(){const b=this.Gvh;
var h=this.menu.Nc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let v=h.offsetWidth;h=h.offsetHeight;aa.a.Ijb&&(v-=4,h-=4);b.style.width=v.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get Zqo(){return this.root.vJb?!1:!0}R_e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Nc===b.element&&Object(yb.a)(ck.a,this.menu)&&
md.a.uBk(this.e5h()))}e5h(){const b=this.menu.children,h=[];if(Object(yb.a)(ck.a,this.menu))for(let v=0;v<b.count;v++){const D=b.J(v);Array.add(h,D.separator);for(let Q=0;Q<D.children.count;Q++){const ba=D.children.J(Q);Array.add(h,ba.Nc)}}return h}Gzk(){var b=this.menu.children;for(let v=0;v<b.count;v++){const D=b.J(v).children;for(let Q=0;Q<D.count;Q++){var h=D.J(Q);if(Object(yb.a)(Xo.a,h)){const ba=h;if("Menu32"===ba.GT||"Menu48"===ba.GT)h=h.control,h.behavior&&(Object(yb.a)(gl.a,h)||Object(yb.a)(Pm.a,
h))&&h.behavior.Czk()}}}0<b.count&&(b=b.J(0),qf.c(b.separator)||(b.separator.style.display="none"),qf.c(b.yle)||ka.a.Zf(b.yle,"cui-menusection-titleAtTop"))}PDn(b){if(!qf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=ef.a.create();try{const v=this.oNi.FTl(b),D=this.yOc();let Q=this.root.ege(b,v,this.Iu.T3d,D);Q||(Q=this.oNi.ege(b,v,this.Iu.T3d,D));this.root.pNi=Q}finally{h&&h.dispose()}}}yOc(){const b=Id.a.getElementBounds(this.Iu.CIb);
var h=this.XH;qf.c(h)||qf.c(h.Nc)||(h=Id.a.getElementBounds(h.Nc),b.x=h.x+Wf.Menu.S3d,b.width=h.width-2*Wf.Menu.S3d);Object(yb.a)(vn.a,this.Iu.A0d)&&(b.height=0);return b}hua(){if(this.Iu.gL){u.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.Iu.Hh.Id});this.menu.mpa();this.s$i();this.gL=!1;this.menu.CIf=!1;this.root.nba(this.control,!0);this.cqj?w.AFrameworkApplication.ta.g5c(this.Iu.cga,this.KJe):this.q6n();this.Iu.cga=null;var b=this.Iu.CIb;ka.a.xw(b,Kk.MenuLauncher.PYc);this.Iu.O7a(this.Iu.Au,
!1);ka.a.xw(b,"cui-ctl-menu-hovered-without-focus");this.menu.Wpa();qf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.tk,0,!1);this.r$i()}}q6n(){const b=this.Iu.cga;if(b)try{b.focus()}catch(h){}}r$i(){jc.a.jx(this.menu.Nc);jc.a.jx(this.Khd);ka.a.bza(this.menu.Nc)}q1c(b){if(this.oZf&&ka.a.Rr(this.properties.PopulateOnlyOnce)||qf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Iu.eof();return 0<(this.root.Fpa(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}DZf(b,h=!1){if(this.oZf&&ka.a.Rr(this.properties.PopulateOnlyOnce))return!0;let v=null;this.d3g=b;qf.c(b)||(v=this.Oal(b));qf.c(v)||(this.oZf=!0);if(h){this.root.KXk(this.Iu);if(qf.c(v)||!v.hasItems())return this.hua(),!1;this.s$i();this.r$i()}this.Djo(v);return!0}DTi(){}Oal(b){b=gh.Builder.SIh(b);if(!qf.c(b)){const h=new qk.a;h.qEh=!0;h.parentId=this.control.id;let v;v=Object(yb.a)(Al.a,this.control);return this.root.eO.xZa(b,h,v)}return null}Djo(b){qf.c(b)||
(qf.c(this.menu)||this.menu.dispose(),this.menu=b,this.DTi())}s$i(){const b=this.menu.parent;b?(b.xRc=!0,b.removeChild(this.menu.id),b.xRc=!1):u.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;qf.c(b.Gb)||qf.c(b.Gb.rawEvent)||Object(yb.a)(Xo.a,this.tk)||!b.Gb.rawEvent.altKey||b.Gb.keyCode!==Sys.UI.Key.down||(this.Yw(b.zf,1,b.Gb),h=!0);h||(h=super.onKeyDown(b));return h}$C(b){this.C8e();2===b.kg&&b.vca!==Sys.UI.MouseButton.leftButton||
this.Yw(b.zf,b.kg,b.Gb);b.Gb.preventDefault();return!1}lwf(b){if(!this.XH||!this.XH.inKeytipMode||!this.Iu.QUi)return!1;this.Iu.QUi(this.tk,b);return!0}static E$k(){const b=ka.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(n.a)(Qm,"MenuLauncherBehavior",bb,[449,437]);var Hl=c(917);class en extends Qm{constructor(b){super(b)}get ht(){return this.fKc.properties}get fKc(){return this.control}get VNa(){return this.fKc.VNa}LI(){mg.a.instance.mb(Sc.a.pointerDown,
this.VNa.Mm,Object(z.a)(this,this.$C,"onPointerDown"));Yb.KeyInputManager.instance.mb(Sc.a.fi,this.VNa.Mm,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.uh,this.VNa.Mm,Object(z.a)(this,this.Ay,"onKeyUp"))}xm(){const b=this.Pd[Hl.a.SelectedItemId];if(0<(this.iu(this.ht.Command,this.ht.QueryCommand,this.Pd)&2)){const h=this.Pd[Hl.a.SelectedItemId];qf.c(h)||b===h||this.fKc.c6c(h)||(this.Pd[Hl.a.SelectedItemId]=null)}}}Object(n.a)(en,"DropDownBehavior",Qm,[]);var mi=
c(519),um=c(697);class fn extends en{constructor(b){super(b);this.LVa=null;this.tKe=this.lub=this.TAa=!1;this.Myc=null;this.Kyc=-1}get o3(){return this.control}get tQ(){return this.o3.tQ}get xH(){return this.o3.xH}get xYd(){return this.Pd[mi.a.IsFreeForm]}set xYd(b){this.Pd[mi.a.IsFreeForm]=b}LI(b){mg.a.instance.mb(Sc.a.pointerDown,b.Mm,Object(z.a)(this,this.$C,"onPointerDown"));const h=b.rr;Nc.a.instance.mb(Sc.a.focus,h,Object(z.a)(this,this.cmb,"onInputFocus"));Nc.a.instance.mb(Sc.a.blur,h,Object(z.a)(this,
this.uxa,"onInputBlur"));Yb.KeyInputManager.instance.mb(Sc.a.fi,h,Object(z.a)(this,this.Don,"onInputKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.eu,h,Object(z.a)(this,this.Eon,"onInputKeyPress"));pf.a.instance.mb(Sc.a.xca,h,Object(z.a)(this,this.aUf,"onInputMouseUp"));mg.a.instance.mb(Sc.a.pointerDown,h,Object(z.a)(this,this.Gon,"onInputPointerDown"));mg.a.instance.mb(Sc.a.pointerDown,b.wUh,Object(z.a)(this,this.zUf,"onMenuButtonPointerDown"))}xm(){0<(this.iu(this.xH.Command,this.xH.QueryCommand,
this.Pd)&2)&&(this.lub||this.xHj(),this.gUo())}DTi(){this.o3.menuItems=null;var b;var h=b=null;if(!qf.c(this.menu)){this.Ife();for(let D of this.menu.children)for(let Q of D.children)if(Object(yb.a)(Xo.a,Q)){var v=Q;v=v.control;Object(yb.a)(440,v)&&(b=v,b=b.Hh.MenuItemId);Object(yb.a)(434,v)&&(h=v,h=h.x1a());qf.c(b)||qf.c(h)||(this.o3.menuItems[h]=b,b=h=null)}}}Gon(b){Object(yb.a)(441,this.root)&&2===b.kg&&(this.LVa=Id.a.COa(this.control.Au.ownerDocument),this.control.Au.focus());return!1}$C(b){this.C8e();
let h=!1;3===b.kg&&(h=super.$C(b),this.Ife());h&&b.Gb.preventDefault();return!1}zUf(b){let h=!1;if(2!==b.kg||b.vca===Sys.UI.MouseButton.leftButton)this.Yw(b.zf,b.kg,b.Gb),this.Ife(),h=!0;h&&b.Gb.preventDefault();return!1}Don(b){let h=!1;if(!qf.c(b.Gb)&&!qf.c(b.Gb.rawEvent)){const v=b.Gb.keyCode;b=b.Gb.rawEvent.shiftKey;ka.a.Rr(this.xH.AutoComplete);if(v===Sys.UI.Key.enter)this.qT(),this.v7f(),Object(yb.a)(um.Ribbon,this.root)&&this.root.r_(),h=!0;else if(v===Sys.UI.Key.tab){if(this.qT(),this.v7f(),
Object(yb.a)(um.Ribbon,this.root)&&(h=this.root.jpe(this.tk.Nc,!b)),Object(yb.a)(441,this.root))return!0}else v===Sys.UI.Key.backspace||v===Sys.UI.Key.del?this.control.enabled?(this.M5e(),this.Myc=null):h=!0:v===Sys.UI.Key.esc?(this.z7f(),this.v7f(),Object(yb.a)(um.Ribbon,this.root)&&this.root.r_(),h=!0):v===Sys.UI.Key.down&&(this.c0(1),this.Ife(),h=!0)}return h}Eon(b){if(!this.control.enabled)return!0;!qf.c(b.Gb)&&b.Gb.charCode&&this.dil();return!1}aUf(){return this.TAa?!1:this.TAa=!0}Rwl(){this.Kyc=
-1;const b=this.tQ.rr,h=b.value,v=this.eWl(h);if(v){b.value=v.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const D=b.createTextRange();D.moveStart("character",h.length);D.moveEnd("character",b.value.length);D.select()}this.Myc=v.value}else this.Myc=null}eWl(b){const h=this.o3.menuItems;for(let v in h){const D={key:v,value:h[v]};if(D.key.toLowerCase().startsWith(b.toLowerCase()))return D}return null}dil(){ka.a.Rr(this.xH.AutoComplete)&&-1===this.Kyc&&
(this.tKe&&(this.q1c(0),this.tKe=!1),this.Kyc=window.setTimeout(Object(z.a)(this,this.Rwl,"executeAutoComplete"),this.o3.GHk))}M5e(){ka.a.Rr(this.xH.AutoComplete)&&(this.Kyc=ka.a.mAb(this.Kyc))}cmb(b){if(this.gL)return this.menu.setFocus(0),!0;Object(yb.a)(441,this.root)&&($c.FocusManager.instance().dD("ribbon"),this.root.JQc=!1);this.onFocus(b);this.lub=!0;ka.a.Zf(this.tQ.Mm,"cui-cb-focus");ka.a.Rr(this.xH.PopulateDynamically)&&(this.tKe=!0);Id.a.Z5c(this.tQ.rr);qf.c(this.menu)||this.menu.ym();return this.TAa=
!1}uxa(){this.lub=!1;this.qT();ka.a.xw(this.tQ.Mm,"cui-cb-focus");return!1}v7f(){Object(yb.a)(441,this.root)&&(void 0!==this.LVa&&null!==this.LVa&&w.AFrameworkApplication.ta.g5c(this.LVa,2),this.LVa=null)}qT(){if(this.control.enabled){this.M5e();var b=this.tQ.rr;if(void 0===this.Pd[mi.a.Value]||null===this.Pd[mi.a.Value]||b.value!==this.Pd[mi.a.Value].toString())if(this.o3.c6c(this.Myc))this.xYd=!1,this.Pd[mi.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.o3.h6c.NDb(),["MenuItemId"]:this.o3.h6c.Hh.MenuItemId},
this.root.executeCommand(this.xH.Command,b,this.tk,0,!1);else{if(!ka.a.Rr(this.xH.AutoComplete)){var h=this.o3.menuItems[b.value];if(!qf.b(h)&&this.o3.c6c(h)){this.xYd=!1;this.Pd[mi.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.o3.h6c.NDb(),["MenuItemId"]:h};this.root.executeCommand(this.xH.Command,b,this.tk,0,!1);return}}h=!qf.b(b.value)&&""!==G.a.iya(b.value);this.o3.urh&&h?(this.xYd=!0,this.Pd[mi.a.Value]=b.value,this.root.executeCommand(this.xH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.tk,0,!1)):this.z7f()}}else this.z7f()}z7f(){this.M5e();this.Myc=null;this.xHj()}xHj(){const b=this.Pd[mi.a.Value]||"";b!==this.tQ.rr.value&&(this.tQ.rr.value=b);this.o3.c6c(this.o3.menuItems[b])}gUo(){const b=this.Pd[mi.a.FontStyle]||"normal";b!==this.tQ.rr.style.fontStyle&&(this.tQ.rr.style.fontStyle=b)}Ife(){this.control.Au&&this.menu&&this.control.Au.setAttribute(Ze.a.Buh,this.menu.id)}}Object(n.a)(fn,"ComboBoxBehavior",en,[]);class im extends Qm{constructor(b){super(b)}get zFd(){return this.control}yOc(){let b=
0;this.menu&&this.menu.Nc&&2===this.menu.horizontalAlignment&&(b=this.menu.Nc.clientWidth);return new Sys.UI.Bounds(this.zFd.x-b,this.zFd.y,this.zFd.FIf,this.zFd.EIf)}}Object(n.a)(im,"ContextMenuLauncherBehavior",Qm,[]);class Vp extends Qm{constructor(b){super(b)}get uId(){return this.control}yOc(){return new Sys.UI.Bounds(this.uId.x,this.uId.y,this.uId.FIf,this.uId.EIf)}}Object(n.a)(Vp,"DialogMenuLauncherBehavior",Qm,[]);var vm=c(600);class Il extends Qm{constructor(b){super(b);this.wKe=!1;this.bjk=
!ka.a.hha(this.ht.ShouldRefreshWhenDropped)}get VDa(){return this.control}get ht(){return this.control.Hh}LI(b){b=b.Mm;qf.c(b)||(Nc.a.instance.mb(Sc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),Nc.a.instance.mb(Sc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),mg.a.instance.mb(Sc.a.pointerOver,b,Object(z.a)(this,this.hP,"onPointerOver")),Yb.KeyInputManager.instance.mb(Sc.a.fi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),Yb.KeyInputManager.instance.mb(Sc.a.uh,b,Object(z.a)(this,this.Ay,
"onKeyUp")),mg.a.instance.mb(Sc.a.pointerDown,b,Object(z.a)(this,this.$C,"onPointerDown")))}xm(){qf.c(this.control.Hh.Command)||(this.VDa.gL&&!this.bjk?this.wKe=!0:(0<(this.iu(this.ht.Command,this.ht.QueryCommand,this.Pd)&2)&&this.X7a()&&this.cUa(),ka.a.Rr(this.ht.RefreshableMenu)&&this.gL&&this.menu.ECn()))}cUa(){this.dUo();this.Aja();this.PUo();this.VDa.Jyf=this.Pd[vm.a.ImageIsVisible]}dUo(){const b=ka.a.$qa(this.Pd[vm.a.LabelText],this.ht.LabelText),h=this.Pd[vm.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.ht.LabelTextUserGeneratedPlaceholderReplacements!==h)this.UE.medium&&this.eUo(this.UE.medium.vO,b,h),this.root.q4a=!0,this.control.labelText=b,this.ht.LabelTextUserGeneratedPlaceholderReplacements=h}eUo(b,h,v){const D=b.lastChild;ka.a.Xjj(b,h+" ",v);h=qf.c(D);u.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":D.nodeType.toString());h||b.appendChild(D)}PUo(){const b=this.Pd[vm.a.ImageBackColor];this.UE.forEach(h=>
{Il.yDk(h.GQ,b)})}c0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(w.AFrameworkApplication.Zoa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),w.AFrameworkApplication.va.processAction(Ua.a.yId,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||w.AFrameworkApplication.va.processAction(Ua.a.yId,2);Object(yb.a)(Xo.a,this.tk)&&(this.gL||this.H7e(!0),this.control.enabled&&
this.GY());super.c0(b)}hua(){super.hua();this.wKe&&(this.wKe=!1,this.xm())}hP(b){return this.control.SHb()?(this.VDa.gL?(this.root.HAh(),ka.a.Zf(this.VDa.CIb,Kk.MenuLauncher.PYc),this.VDa.cga=this.control.Au):(super.hP(b),this.Yw(b.zf,b.kg,b.Gb)),!1):super.hP(b)}onKeyDown(b){let h=!1;if(!qf.c(b.Gb)&&!qf.c(b.Gb.rawEvent)){if(Object(yb.a)(Xo.a,this.tk)){const v=b.Gb.rawEvent,D=b.Gb.keyCode,Q=0===this.root.c1;v.shiftKey||v.ctrlKey||!(D===Sys.UI.Key.right&&Q||D===Sys.UI.Key.left&&!Q)||(h=this.lwf(b),
h||(this.Yw(b.zf,1,b.Gb),h=!0))}h||(h=super.onKeyDown(b))}return h}static yDk(b,h){qf.c(b)||qf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(n.a)(Il,"FlyoutAnchorBehavior",Qm,[]);var Fi=c(945);class oo extends bb{constructor(b){super(b)}get I6b(){return this.control}get properties(){return this.I6b.properties}get Gfa(){return this.I6b.Gfa}LI(b){b=b.uCb;Nc.a.instance.mb(Sc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Nc.a.instance.mb(Sc.a.blur,b,Object(z.a)(this,this.onBlur,
"onBlur"));mg.a.instance.mb(Sc.a.pointerOver,b,Object(z.a)(this,this.hP,"onPointerOver"));mg.a.instance.mb(Sc.a.pointerOut,b,Object(z.a)(this,this.GJ,"onPointerOut"));Yb.KeyInputManager.instance.mb(Sc.a.fi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.uh,b,Object(z.a)(this,this.Ay,"onKeyUp"));mg.a.instance.mb(Sc.a.pointerDown,b,Object(z.a)(this,this.$C,"onPointerDown"));mg.a.instance.mb(Sc.a.VM,b,Object(z.a)(this,this.yxa,"onPointerUp"));ub.a.instance.mb(Sc.a.yP,
b,Object(z.a)(this,this.rmb,"onTouchMove"));ub.a.instance.mb(Sc.a.VJ,b,Object(z.a)(this,this.vGa,"onTouchEnd"))}xm(){const b=this.Pd[Fi.a.On],h=this.Pd[Fi.a.IsRtl];this.cHj();if(0<(this.iu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)){var v=!qf.c(this.Pd[Fi.a.InnerHTML])||!qf.c(this.properties.InnerHTML),D=!qf.c(this.properties.Image);v||D||(this.control.enabled=!1);D=this.Gfa.uCb;if(!qf.c(D)){if(v){v=ka.a.$qa(this.Pd[Fi.a.InnerHTML],this.properties.InnerHTML);if(null===D.innerHTML||
null===v||G.a.Ug(D.innerHTML)!==G.a.Ug(v))D.innerHTML=v;""===v&&(this.control.enabled=!1)}v=D.title;const Q=ka.a.$qa(this.Pd[Fi.a.Alt],this.properties.Alt);Q===v||this.control.Ucg||(D.title=Q)}D=this.Pd[Fi.a.IsRtl];b===this.Pd[Fi.a.On]&&h===D||this.control.IKb()}}cHj(){const b=this.Pd;b[Fi.a.CommandValueId]=this.control.NDb();b.MenuItemId=this.control.Hh.MenuItemId;b.SourceControlId=this.properties.Id}Yw(b,h,v){if((b=this.tk)&&this.control.enabled){const D=this.root;if(w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.FUc()&&this.XH){const Q=D.ZC[this.XH.zqa];Q?Q.OSa(this.I6b):u.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.cHj();this.Pd[Fi.a.On]||(this.Pd[Fi.a.On]=!0,this.control.IKb());"Menu"===b.GT&&ka.a.xw(this.Gfa.Mm,"cui-gallerybutton-focused");D.executeCommand(this.properties.Command,this.Pd,b,h,!0,null,this.GX(v))}}onFocus(b){super.onFocus(b);ka.a.Zf(this.Gfa.Mm,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);ka.a.xw(this.Gfa.Mm,"cui-gallerybutton-focused");return!1}}Object(n.a)(oo,"GalleryButtonBehavior",bb,[]);var Rm=c(1125),lq=c(1391),po=c(637);class pl extends bb{constructor(b){super(b);this.YWa=-1}get k$b(){return this.control}get properties(){return this.k$b.Hh}get OGc(){return this.k$b.OGc}get byf(){var b=null;if(this.tk&&(b=this.tk.parent,!Object(yb.a)(po.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get vGb(){return this.k$b.BWd.vGb}get o0c(){return this.k$b.BWd.o0c}Yw(b,
h,v){if(this.control.enabled){b=this.Kqf(this.Y6b(b));const D=this.VNd(b);this.OGc[lq.a.Rows]=this.DRd(b)+1;this.OGc[lq.a.Columns]=D+1;this.root.executeCommand(this.properties.Command,this.OGc,this.tk,h,!0,null,this.GX(v))}}LI(b){var h=b.Mm;const v=b.uBh;b=b.cells;mg.a.instance.mb(Sc.a.pointerOut,h,Object(z.a)(this,this.Yln,"onControlPointerOut"));ub.a.instance.mb(Sc.a.yP,h,Object(z.a)(this,this.$ln,"onControlTouchMove"));ub.a.instance.mb(Sc.a.VJ,h,Object(z.a)(this,this.Zln,"onControlTouchEnd"));
for(h=0;h<b.length;++h)this.cHk(v[h],b[h])}cHk(b,h){Nc.a.instance.mb(Sc.a.focus,b,Object(z.a)(this,this.MSf,"onCellFocus"));mg.a.instance.mb(Sc.a.pointerOver,h,Object(z.a)(this,this.NSf,"onCellPointerOver"));mg.a.instance.mb(Sc.a.VM,h,Object(z.a)(this,this.OSf,"onCellPointerUp"));Yb.KeyInputManager.instance.mb(Sc.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.uh,h,Object(z.a)(this,this.Ay,"onKeyUp"));ub.a.instance.mb(Sc.a.zP,h,Object(z.a)(this,this.Xkn,"onCellTouchStart"))}Kqf(b){return parseInt(b.id.substr(this.k$b.id.length+
1))}Ski(b){this.Rki(this.Kqf(b))}DRd(b){return Math.floor(b/Rm.a.PZc)}VNd(b){return b%Rm.a.PZc}Rki(b){if(b!==this.YWa){var h=this.VNd(b),v=this.DRd(b),D=-1;let Q=-1;-1!==this.YWa&&(D=this.DRd(this.YWa),Q=this.VNd(this.YWa));for(;D!==v||Q!==h;)D<v?this.nmj(++D,Q,!0):D>v?(this.nmj(D,Q,!1),D--):Q<h?this.Kjj(++Q,D,!0):Q>h&&(this.Kjj(Q,D,!1),Q--);this.byf?this.byf.cnj(this.P4h(v+1,h+1)):(v=(h=this.control.N8e)&&0<h.length?h[0]:null,D=this.tk,u.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!v,["FirstCompPar"]:!!v&&!!v.parent,["DispComp"]:!!D,["DispCompPar"]:!!D&&!!D.parent}));this.YWa=b}}nmj(b,h,v){for(let D=0;D<=h;D++)this.Cjj(b,D,v)}Kjj(b,h,v){for(let D=0;D<=h;D++)this.Cjj(D,b,v)}Cjj(b,h,v){h=b*Rm.a.PZc+h;b=this.vGb[h];h=this.o0c[h];v?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}OSf(b){this.Yw(b.zf,b.kg,b.Gb);return!0}Y6b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return qf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}dnj(b){const h=this.Kqf(b);b.childNodes[0].childNodes[0].title=this.P4h(this.DRd(h)+1,this.VNd(h)+1)}P4h(b,h){let v=this.properties.Alt;qf.c(v)&&(v=this.properties.MenuSectionTitle);return v=String.format(v,h.toString(),b.toString())}ihc(){if(this.tk){for(var b=0;b<Rm.a.cec;b++)this.vGb[b].className="cui-it-inactiveCell",this.o0c[b].className="cui-it-inactiveCellOuter";this.YWa=-1;b=this.properties.MenuSectionInitialTitle;
qf.c(b)&&(b="");this.byf.cnj(b)}}NSf(b){this.control.enabled&&(b=this.Y6b(b.zf),this.L6c(b),this.mff(b));return!1}mff(b){this.dnj(b);this.Ski(b)}MSf(b){if(!this.control.enabled)return!1;b=this.Y6b(b.zf);this.dnj(b);this.Ski(b);return!1}Yln(b){Id.a.YEf(this.k$b.BWd.Mm,b.clientPoint)||this.ihc();return!1}Xkn(b){if(!this.control.enabled)return!1;b=this.Y6b(b.zf);this.mff(b);return!0}$ln(b){if(!this.control.enabled)return!1;b=Id.a.LOd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.Y6b(b))?this.mff(b):this.ihc();return!0}Zln(b){if(!this.control.enabled)return!1;var h=Id.a.LOd(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.ihc(),!0;(h=this.Y6b(h))?this.Yw(h,3,b.Gb):this.ihc();return!0}QK(b){b=Jk.Control.alf(this.YWa,Rm.a.PZc,Rm.a.cec,b);if(b!==this.YWa)return this.vGb[b].firstChild.focus(),this.Rki(b),!0;this.ihc();this.YWa=-1;return!1}GY(){const b=this.vGb[0];if(qf.c(b))return!1;b.firstChild.focus();return!0}L6c(b){if(qf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}mpa(){this.ihc()}}Object(n.a)(pl,"InsertTableBehavior",bb,[]);class ht extends Qm{constructor(b){super(b)}xm(){this.control.enabled=!!this.menu}Yw(b,h,v){w.AFrameworkApplication.va.Qb(Ua.a.HQa,2,h,this.GX(v))}}Object(n.a)(ht,"JewelMenuLauncherBehavior",Qm,[]);var rr=c(1061);class Hr extends bb{constructor(b){super(b)}get properties(){return this.control.Hh}xm(){0<(this.iu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)&&this.X7a()&&this.cUa()}cUa(){this.gYo();this.Aja();
this.NQb()}gYo(){const b=this.control.labelText;let h=this.Pd[rr.a.Value];qf.c(h)&&(h=this.properties.LabelText,qf.c(h)&&(h=""));h!==b&&this.wge(h)}LI(b){b=b.Mm;qf.c(b)||(mg.a.instance.mb(Sc.a.pointerDown,b,Object(z.a)(this,this.$C,"onPointerDown")),mg.a.instance.mb(Sc.a.pointerOver,b,Object(z.a)(this,this.hP,"onPointerOver")),mg.a.instance.mb(Sc.a.pointerOut,b,Object(z.a)(this,this.GJ,"onPointerOut")))}}Object(n.a)(Hr,"LabelBehavior",bb,[]);var cr=c(868),Wp=c(211),Xr=c(300);class Sm extends Qm{constructor(b){super(b);
this.GDe=this.qve=!1;this.wVb=this.$Rb=null;if(this.$Vb=w.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.$Rb=this.ju.Iia.LightImage16by16Class,this.wVb=this.ju.Iia.DarkImage16by16Class}get ju(){return this.control}q5d(b,h,v,D){h&&(this.ju.cga=v,w.AFrameworkApplication.ta.p6a());if(Object(yb.a)(Wp.a,b)&&D){v=new cr.a;v.CommandLocation=this.root.H9;v.InvocationMethod=0;const Q={};(b=b.control)&&b.Hh&&(Q.CommandId=b.Hh.Command,Q.ControlId=b.Hh.Id,Q.CloseAllMenus=h,b.XH&&b.XH.parent&&b.XH.parent.id&&
(Q.ParentControlId=b.XH.parent.id.split("-")[0]),this.root.wF&&this.root.wF.jOa(D,Q,v))}}hua(){this.ju.cga||(this.ju.cga=this.ju.py);!this.ju.Hdn&&this.$Vb&&(ka.a.xw(this.ju.py,"cui-sb-focus"),ka.a.xw(this.ju.k1,"cui-sb-focus"),ka.a.xw(this.ju.wya,this.$Rb),ka.a.Zf(this.ju.wya,this.wVb));this.qve=!0;super.hua();this.qve=!1;this.o2f()}get cqj(){return!this.ju.WRa}b7d(){this.ju.b7d()}Wbe(){this.GDe||this.qve||(this.GDe=!0,this.ju.raiseEvent(Xr.a.u2a,null))}o2f(){this.gL||this.ju.$zf||(this.GDe=!1,this.ju.raiseEvent(Xr.a.MGb,
null))}ZTf(b){ka.a.xw(this.ju.py,"cui-sb-focus");ka.a.xw(this.ju.k1,"cui-sb-focus");this.$Vb&&!this.ju.gL&&(ka.a.xw(this.ju.wya,this.$Rb),ka.a.Zf(this.ju.wya,this.wVb));this.ju.raiseEvent(Xr.a.blur,b);this.o2f();this.ju.cga=this.ju.py;return!1}$Tf(b){ka.a.Zf(this.ju.py,"cui-sb-focus");ka.a.Zf(this.ju.k1,"cui-sb-focus");this.$Vb&&(ka.a.xw(this.ju.wya,this.wVb),ka.a.Zf(this.ju.wya,this.$Rb));this.ju.raiseEvent(Xr.a.focus,b);this.Wbe();return!1}DVf(){this.$Vb&&(ka.a.Zf(this.ju.k1,"cui-sb-hover"),ka.a.Zf(this.ju.py,
"cui-sb-hover"),ka.a.xw(this.ju.wya,this.wVb),ka.a.Zf(this.ju.wya,this.$Rb));return!1}CVf(){this.$Vb&&(ka.a.xw(this.ju.k1,"cui-sb-hover"),ka.a.xw(this.ju.py,"cui-sb-hover"),this.ju.gL||this.ju.$zf||(ka.a.xw(this.ju.wya,this.$Rb),ka.a.Zf(this.ju.wya,this.wVb)));return!1}}Object(n.a)(Sm,"SearchBoxBehavior",Qm,[439,437]);class $i{}$i.Value="value";$i.MinValue="MinValue";$i.MaxValue="MaxValue";$i.Text="Text";Object(n.a)($i,"SliderCommandProperties",null,[]);class Eh extends bb{constructor(b){super(b)}get Seg(){return this.control}get o5(){return this.Seg.o5}get properties(){return this.control.Hh}initialize(){}Yw(){}LI(b){b=
b.rr;Nc.a.instance.mb(Sc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Nc.a.instance.mb(Sc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Nc.a.instance.mb(Sc.a.change,b,Object(z.a)(this,this.Bca,"onChange"));Nc.a.instance.mb(Sc.a.input,b,Object(z.a)(this,this.Bca,"onChange"))}onFocus(b){this.o5.Mm&&Sys.UI.DomElement.addCssClass(this.o5.Mm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.o5.Mm&&Sys.UI.DomElement.removeCssClass(this.o5.Mm,"cui-sldr-onfocus");return super.onBlur(b)}Bca(){this.I1k(this.o5.rr.value);
return!0}I1k(b){this.Pd[$i.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Pd,this.tk,0,!1)}xm(){const b=this.Pd[$i.Value],h=this.Pd[$i.MaxValue],v=this.Pd[$i.Text];var D=this.iu(this.properties.Command,this.properties.QueryCommand,this.Pd);this.o5&&this.o5.rr&&(this.o5.rr.disabled=!this.control.enabled);if(0<(D&2)){D=this.Pd[$i.Value];const Q=this.Pd[$i.MaxValue],ba=this.Pd[$i.Text];(Q!==h||D!==b||v!==ba)&&this.o5&&this.o5.rr&&(this.o5.rr.setAttribute(Ze.a.RAd,String.format("{0}",
Q)),this.o5.rr.setAttribute("max",String.format("{0}",Q)),this.o5.rr.value=D,this.o5.vO.innerText=this.Pd[$i.Text])}}}Object(n.a)(Eh,"SliderBehavior",bb,[]);var kh=c(1385);class ql extends bb{constructor(b){super(b);this.wpd=0;this.Vcb=null;this.Lmd=!1;this.rkh=null;this.BSe=!1;this.zsd=this.Tqd=-1;this.TAa=!1}get spinner(){return this.control}get OG(){return this.spinner.OG}get properties(){return this.control.Hh}initialize(){const b=this.spinner.Png;this.rkh=this.ZPo(b);this.wpd=b[0].min;this.Vcb=
b[0];this.Lmd=!1}Yw(){}LI(b){const h=b.rr,v=b.o5b;b=b.qKc;Nc.a.instance.mb(Sc.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Nc.a.instance.mb(Sc.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));Yb.KeyInputManager.instance.mb(Sc.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.eu,h,Object(z.a)(this,this.GG,"onKeyPress"));Yb.KeyInputManager.instance.mb(Sc.a.uh,h,Object(z.a)(this,this.Ay,"onKeyUp"));Nc.a.instance.mb(Sc.a.change,h,Object(z.a)(this,this.Bca,
"onChange"));pf.a.instance.mb(Sc.a.xca,h,Object(z.a)(this,this.aUf,"onInputMouseUp"));mg.a.instance.mb(Sc.a.pointerDown,v,Object(z.a)(this,this.qSi,"onArrowPointerDown"));mg.a.instance.mb(Sc.a.pointerDown,b,Object(z.a)(this,this.qSi,"onArrowPointerDown"));mg.a.instance.mb(Sc.a.VM,v,Object(z.a)(this,this.rSi,"onArrowPointerUp"));mg.a.instance.mb(Sc.a.VM,b,Object(z.a)(this,this.rSi,"onArrowPointerUp"));ub.a.instance.mb(Sc.a.yP,v,Object(z.a)(this,this.tSi,"onArrowTouchMove"));ub.a.instance.mb(Sc.a.yP,
b,Object(z.a)(this,this.tSi,"onArrowTouchMove"));ub.a.instance.mb(Sc.a.VJ,v,Object(z.a)(this,this.sSi,"onArrowTouchEnd"));ub.a.instance.mb(Sc.a.VJ,b,Object(z.a)(this,this.sSi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);ka.a.Zf(this.OG.Mm,"cui-spn-focus");this.control.enabled&&Id.a.Z5c(this.OG.rr);return this.TAa=!1}onBlur(b){super.onBlur(b);ka.a.xw(this.OG.Mm,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!qf.c(b.Gb)&&!qf.c(b.Gb.rawEvent)){const v=b.Gb.keyCode,D=b.Gb.rawEvent.shiftKey;if(v===
Sys.UI.Key.up||v===Sys.UI.Key.down)this.root.lCf(this.control)||this.Kuj(v===Sys.UI.Key.up,b.kg),h=!0;else if(v===Sys.UI.Key.enter)this.qT(),Object(yb.a)(um.Ribbon,this.root)&&this.root.r_(),h=!0;else if(v===Sys.UI.Key.tab)this.qT(),Object(yb.a)(um.Ribbon,this.root)&&(h=this.root.jpe(this.tk.Nc,!D));else if(v===Sys.UI.Key.esc)this.khc(),Object(yb.a)(um.Ribbon,this.root)&&this.root.r_(),h=!0;else if(v===Sys.UI.Key.backspace||v===Sys.UI.Key.del)h=!this.control.enabled}return h}GG(){return!this.control.enabled}Ay(){this.Ggl();
return!1}Bca(){this.qT();return!1}aUf(){return this.TAa?!1:this.TAa=!0}qSi(b){var h=!1;let v=!0;2===b.kg&&(v=b.vca===Sys.UI.MouseButton.leftButton);v&&(h=b.zf,this.Kuj(h===this.OG.o5b||h===this.OG.HUh||h===this.OG.GUh,b.kg),h=!0);return h}rSi(b){return this.Nua(b)}tSi(b){return this.P5d(b)}sSi(b){return this.Nua(b)}rvm(b){if(this.control.enabled){var h=!1;if(!this.Lmd){var v=this.zZl(b);v=b?v+this.Vcb.step:v-this.Vcb.step;v=Math.min(v,this.Vcb.max);v=Math.max(v,this.Vcb.min);v!==this.wpd&&(this.B8e(v,
this.Vcb),this.root.executeCommand(this.properties.Command,this.Pd,this.tk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,v=this.Pd,v.Increment=b,qf.c(h)||this.root.executeCommand(h,v,this.tk,0,!1))}}zZl(b){const h=Math.pow(10,w.AFrameworkApplication.numberFormat.x5d),v=Math.round(this.Vcb.step*h);let D=Math.round(this.wpd*h)/v;D=b?Math.floor(D):Math.ceil(D);return D*v/h}Kuj(b,h){if(this.control.enabled){this.qT();const v=b?this.OG.o5b:this.OG.qKc;switch(h){case 2:case 3:this.BSe=b;this.tyd(v);break;
case 1:this.BSe=b,this.Dpk(v)}}}pvj(){this.IAh();this.QSk()}yPh(){-1===this.Tqd&&(this.Tqd=window.setTimeout(Object(z.a)(this,this.r2n,"repeatSpin"),500))}IAh(){this.Tqd=ka.a.mAb(this.Tqd)}r2n(){this.IAh();-1===this.zsd&&(this.nje(),this.zsd=window.setInterval(Object(z.a)(this,this.nje,"spin"),50))}QSk(){this.zsd=ka.a.MSk(this.zsd)}nje(){this.rvm(this.BSe)}Dpk(b){this.root.ufa(this.control,!1);ka.a.Zf(b,Jk.Control.wyd);this.nje();this.yPh()}Ggl(){this.root.nba(this.control,!1);this.pvj();ka.a.xw(this.OG.o5b,
Jk.Control.wyd);ka.a.xw(this.OG.qKc,Jk.Control.wyd)}Oic(b){this.OG.rr.value!==b&&(this.OG.rr.value=b)}khc(){this.Oic(this.Pd[kh.a.Text])}$jj(b){this.Oic(b);this.Pd[kh.a.Text]=b;this.Lmd=!0}jgo(b,h,v){this.Oic(v);this.Pd[kh.a.Text]=v;this.Pd[kh.a.Number]=b;this.Pd[kh.a.UnitType]=h.type;this.wpd=b;this.Vcb=h;this.OG.rr.setAttribute(Ze.a.a2e,v);this.OG.rr.setAttribute(Ze.a.Iuh,String.format("{0}",h.min));this.OG.rr.setAttribute(Ze.a.RAd,String.format("{0}",h.max));this.Lmd=!1}hGh(b){var h;if(({Pgn:h}=
this.LRm(b)).returnValue)this.$jj(h);else{({number:b,K7a:h}=G.a.F_i(b,this.rkh,w.AFrameworkApplication.numberFormat));let v=this.Vme(h);0===h&&qf.c(v)&&(v=this.Vme(this.Pd[kh.a.UnitType]));this.B8e(b,v)}}B8e(b,h){b=this.YQf(b,h);if(isNaN(b)||qf.c(h))this.khc();else{const v=w.AFrameworkApplication.numberFormat;let D;D=G.a.YDa(b,h.type,v);D=D.replace(6===h.type?v.y5d:v.EYf,"");this.jgo(b,h,D)}}LRm(b){let h,v=!1;h="";b=b.trim();const D=this.spinner.FIj;if(!qf.c(D))for(let Q=0;Q<D.length;Q++)if(D[Q].toLowerCase()===
b.toLowerCase()){h=D[Q];v=!0;break}return{returnValue:v,Pgn:h}}YQf(b,h){return isNaN(b)||qf.c(h)?Number.NaN:h.YQf(b)}Vme(b){let h=null;const v=this.spinner.Png;for(let D=0;D<v.length;D++)if(v[D].type===b){h=v[D];break}return h}ZPo(b){const h=b.length,v=Array(h);for(let D=0;D<h;D++)v[D]=b[D].type;return v}qT(){if(this.control.enabled){const b=this.Pd[kh.a.Text],h=this.OG.rr.value;h!==b&&(this.hGh(h),this.Pd[kh.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Pd,this.tk,0,!1))}else this.khc()}xm(){var b=
this.Pd[kh.a.Text],h=this.Pd[kh.a.Number];const v=this.Pd[kh.a.UnitType],D=this.Pd[kh.a.MaxValue];if(0<(this.iu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)){const Q=this.Pd[kh.a.Text],ba=this.Pd[kh.a.Number],ta=this.Pd[kh.a.UnitType],Ta=this.Pd[kh.a.MaxValue];Ta!==D&&(this.Vme(ta).max=Ta,this.OG.rr.setAttribute(Ze.a.RAd,String.format("{0}",Ta)));Q!==b?""===Q?this.$jj(Q):this.hGh(Q):isNaN(ba)||ba===h&&ta===v||this.B8e(ba,this.Vme(ta));b=this.OG.Mm.title;h=ka.a.$qa(this.Pd[kh.a.Alt],
this.properties.Alt);h!==b&&(this.OG.rr.title=h,this.OG.o5b.title=h,this.OG.qKc.title=h)}}$Xe(b){super.$Xe(b);b?(this.nje(),this.yPh()):this.pvj()}}Object(n.a)(ql,"SpinnerBehavior",bb,[438,437]);var ho=c(405),Jl=c(883);class wp extends Qm{constructor(b){super(b);this.YWb=!0;this.Frb=!1}get r5(){return this.control}get ht(){return this.r5.properties}LI(b){const h=b.Mm,v=b.Wfb;b=b.sKc;Nc.a.instance.mb(Sc.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Nc.a.instance.mb(Sc.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));Yb.KeyInputManager.instance.mb(Sc.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.uh,h,Object(z.a)(this,this.Ay,"onKeyUp"));aa.a.du&&16>this.pUl()&&(mg.a.instance.mb(Sc.a.pointerDown,h,Object(z.a)(this,this.hXi,"onSplitbuttonPointerDownPointerUp")),mg.a.instance.mb(Sc.a.VM,h,Object(z.a)(this,this.hXi,"onSplitbuttonPointerDownPointerUp")));mg.a.instance.mb(Sc.a.pointerOver,v,Object(z.a)(this,this.Ikn,"onButtonPointerOver"));mg.a.instance.mb(Sc.a.pointerOut,
v,Object(z.a)(this,this.Hkn,"onButtonPointerOut"));mg.a.instance.mb(Sc.a.pointerDown,v,Object(z.a)(this,this.ISi,"onButtonPointerDown"));mg.a.instance.mb(Sc.a.VM,v,Object(z.a)(this,this.JSi,"onButtonPointerUp"));ub.a.instance.mb(Sc.a.yP,v,Object(z.a)(this,this.Kkn,"onButtonTouchMove"));ub.a.instance.mb(Sc.a.VJ,v,Object(z.a)(this,this.Jkn,"onButtonTouchEnd"));mg.a.instance.mb(Sc.a.pointerDown,b,Object(z.a)(this,this.zUf,"onMenuButtonPointerDown"));mg.a.instance.mb(Sc.a.pointerOver,b,Object(z.a)(this,
this.Cpn,"onMenuButtonPointerOver"));mg.a.instance.mb(Sc.a.pointerOut,b,Object(z.a)(this,this.Bpn,"onMenuButtonPointerOut"))}Yw(b,h,v){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.Frb&&(this.r5.on=!this.r5.on,b=this.Pd,b.CommandValueId=this.control.NDb(),this.root.executeCommand(this.ht.Command,b,this.tk,h,!0,null,this.GX(v))):this.YWb&&super.Yw(b,h,v)}Ay(b){const h=b.Gb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Pd,b.CommandValueId=this.control.NDb(),this.root.executeCommand(this.ht.Command,
b,this.tk,1,!0),!0):super.Ay(b)}xm(){const b=this.root.Fpa(this.ht.Command,this.ht.QueryCommand,this.Pd),h=0<(b&1);let v=!0;v=qf.c(this.ht.CommandMenuOpen)?h:0<(this.root.Fpa(this.ht.CommandMenuOpen,null,null)&1);if(v!==this.YWb||h!==this.Frb||(v||h)!==this.control.enabled)this.control.enabled=v||h,h!==this.Frb&&this.Umn(h),v!==this.YWb&&this.Vmn(v),this.YWb=v,this.Frb=h;if(0<(b&2)){this.Aja();const D=ka.a.$qa(this.Pd[Jl.a.LabelText],this.ht.LabelText);this.Pd[Jl.a.ApplyLabelTextToControlOnly]?this.r5.v6b(Q=>
{Q.Mm.title=D;Q.Wfb.removeAttribute("title");Q.sKc.removeAttribute("title")}):this.r5.v6b(Q=>{Q.Wfb.title=D});this.Pd[Jl.a.EnsureControlRoleIsButton]&&this.r5.v6b(Q=>{Ze.a.gr(Q.Mm,Ze.a.qh,Ze.a.f3)});qf.c(this.Pd[Jl.a.Visible])||this.X7a()&&this.cUa()}this.r5.setState(this.r5.on&&h)}cUa(){this.qmg();this.NQb();this.Aja()}Vmn(b){this.r5.v6b(h=>{ka.a.iob(h.sKc,b)});this.X3c();this.YWb=b}Umn(b){this.r5.v6b(h=>{ka.a.iob(h.Wfb,b)});this.X3c();this.Frb=b}X3c(){const b=this.r5.phb();qf.c(b)||(ka.a.xw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),ka.a.xw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),ka.a.xw(b.childNodes[1],"cui-ctl-split-hovered-primary"),ka.a.xw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}hXi(b){if(0!==ho.a(b.Gb))return!1;let h=!1;b.eventName===Sc.a.pointerDown?h=this.ISi(b):b.eventName===Sc.a.VM&&(h=this.JSi(b));return h}ISi(b){let h=!1;const v=b.kg;switch(v){case 3:this.Nto()?this.Yw(this.tk.Nc,v,b.Gb):this.tyd(this.r5.jSh);h=!0;break;case 2:b.vca===Sys.UI.MouseButton.leftButton&&
(this.tyd(this.r5.jSh),h=!0)}h&&b.Gb.preventDefault();return!1}Nto(){const b=this.tk.GT;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}JSi(b){return this.Nua(b)}Kkn(b){return this.P5d(b)}Jkn(b){return this.Nua(b)}onFocus(b){super.onFocus(b);this.Qxf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.X3c();return!1}Ikn(){this.control.enabled&&this.Frb&&this.Qxf(!0,this.r5.on);return!1}Hkn(){this.control.enabled&&this.Frb&&this.X3c();return!1}zUf(b){let h=!1;if(2!==b.kg||b.vca===Sys.UI.MouseButton.leftButton)this.Yw(b.zf,
b.kg,b.Gb),h=!0;h&&b.Gb.preventDefault();return!1}Cpn(){this.control.enabled&&this.YWb&&this.Qxf(this.r5.on,!0);return!1}Bpn(){this.X3c();return!1}Qxf(b,h){const v=this.control.phb();qf.c(v)||(ka.a.Zf(v.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),ka.a.Zf(v.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}pUl(){var b=aa.a.d5b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(n.a)(wp,"SplitButtonBehavior",Qm,[]);
var Qo=c(1390);class gn extends bb{constructor(b){super(b);this.lub=this.TAa=!1;this.J1j=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get xda(){return this.textBox.xda}get Zhg(){return this.textBox.Hh}LI(b){b=b.rr;Nc.a.instance.mb(Sc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Nc.a.instance.mb(Sc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Yb.KeyInputManager.instance.mb(Sc.a.fi,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.eu,b,Object(z.a)(this,this.GG,"onKeyPress"));Yb.KeyInputManager.instance.mb(Sc.a.uh,b,Object(z.a)(this,this.Ay,"onKeyUp"));Nc.a.instance.mb(Sc.a.change,b,Object(z.a)(this,this.Bca,"onChange"));pf.a.instance.mb(Sc.a.xca,b,Object(z.a)(this,this.zRa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.lub=!0;ka.a.Zf(this.xda.Mm,"cui-tb-focus");this.control.enabled&&Id.a.Z5c(this.xda.rr);return this.TAa=!1}onBlur(b){this.lub=!1;super.onBlur(b);ka.a.xw(this.xda.Mm,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!qf.c(b.Gb)&&!qf.c(b.Gb.rawEvent)){const v=b.Gb.keyCode,D=b.Gb.rawEvent.shiftKey;v===Sys.UI.Key.tab?(this.qT(),Object(yb.a)(um.Ribbon,this.root)&&(h=this.root.jpe(this.tk.Nc,!D))):v===Sys.UI.Key.enter?this.J1j&&(this.qT(),Object(yb.a)(um.Ribbon,this.root)&&this.root.r_(),h=!0):v===Sys.UI.Key.esc?(this.khc(),Object(yb.a)(um.Ribbon,this.root)&&this.root.r_(),h=!0):v===Sys.UI.Key.backspace||v===Sys.UI.Key.del?h=!this.control.enabled:b.kua&&
(lf.a.EAh(b.Gb),h=!1)}return h}GG(){return!this.control.enabled}Ay(){return!1}Bca(){this.qT();return!1}zRa(){return this.xda.isEditable?this.TAa?!1:this.TAa=!0:(Id.a.Z5c(this.xda.rr),!0)}Oic(b){this.xda.rr.value!==b&&(this.xda.rr.value=b)}khc(){this.Oic(this.Pd[Qo.a.Text])}qT(){if(this.control.enabled&&this.xda.isEditable){const b=this.xda.rr.value;b!==this.Pd[Qo.a.Text]&&(this.Pd[Qo.a.Text]=b,this.root.executeCommand(this.Zhg.Command,this.Pd,this.tk,0,!1))}else this.khc()}xm(){const b=this.Pd[Qo.a.Text];
if(0<(this.iu(this.Zhg.Command,this.Zhg.QueryCommand,this.Pd)&2)&&!this.lub){const h=this.Pd[Qo.a.Text];h!==b&&this.Oic(h)}}}Object(n.a)(gn,"TextBoxBehavior",bb,[436,437]);var Bl=c(386);class On extends bb{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Hh}Yw(b,h,v){this.control.enabled&&(ka.a.hha(this.properties.TogglesWhenExecuted)||this.toggle(),this.Pd.CommandValueId=this.toggleButton.NDb(),this.Pd.MenuItemId=this.toggleButton.Hh.MenuItemId,
this.Pd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Pd,this.tk,h,!ka.a.hha(this.properties.CloseMenuWhenExecuted),D=>{ka.a.Rr(this.properties.UpdateHtmlPostToggle)&&(32===D?this.szj():this.qzj())},this.GX(v)))}qzj(){this.Pd[Ff.a.On]=!this.Pd[Ff.a.On]}szj(){this.toggleButton.setState(this.Pd[Ff.a.On]);(this.toggleButton.jza&&this.toggleButton.eoe||ka.a.Rr(this.properties.UpdateHtmlPostToggle))&&this.cUa()}toggle(){this.qzj();ka.a.Rr(this.properties.UpdateHtmlPostToggle)||
this.szj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!qf.c(b.Gb)&&this.XH){const v=b.Gb.keyCode;v!==Sys.UI.Key.enter&&v!==Sys.UI.Key.space||b.Gb.preventDefault()}return h}xm(){qf.c(this.properties.MenuItemId)||(this.Pd.MenuItemId=this.properties.MenuItemId);0<(this.iu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)&&this.X7a()&&this.cUa()}cUa(){this.toggleButton.setState(this.Pd[Ff.a.On]);this.ETo(ka.a.$qa(this.Pd[Ff.a.DisplayMode],""));this.qmg();this.Aja();this.mVo();Ff.a.Alt in
this.Pd&&this.NQb()}mVo(){const b=this.UE.lcc;if(b&&b.Xfb){var h=ka.a.$qa(this.Pd[Ff.a.Description],this.properties.Description);h!==b.Xfb.innerText&&(b.Xfb.innerText=h,b.vO&&!Object(yb.a)(Bl.Jewel,this.root)&&(h=!qf.b(h),ka.a.D5(b.vO,"UIFontBold",h),ka.a.D5(b.vO,"cui-ctl-mediumlabel-nodescription",!h)))}}LI(b){b=b.Mm;Nc.a.instance.mb(Sc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Nc.a.instance.mb(Sc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));mg.a.instance.mb(Sc.a.pointerOver,b,Object(z.a)(this,
this.hP,"onPointerOver"));mg.a.instance.mb(Sc.a.pointerOut,b,Object(z.a)(this,this.GJ,"onPointerOut"));Yb.KeyInputManager.instance.mb(Sc.a.fi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Yb.KeyInputManager.instance.mb(Sc.a.uh,b,Object(z.a)(this,this.Ay,"onKeyUp"));mg.a.instance.mb(Sc.a.pointerDown,b,Object(z.a)(this,this.$C,"onPointerDown"));mg.a.instance.mb(Sc.a.VM,b,Object(z.a)(this,this.yxa,"onPointerUp"));Sh.a.instance.mb(Sc.a.click,b,Object(z.a)(this,this.onClick,"onClick"));ub.a.instance.mb(Sc.a.yP,
b,Object(z.a)(this,this.rmb,"onTouchMove"));ub.a.instance.mb(Sc.a.VJ,b,Object(z.a)(this,this.vGa,"onTouchEnd"))}}Object(n.a)(On,"ToggleButtonBehavior",bb,[]);class Cl{constructor(b){this.eZj=b;this.cAe={["Button"]:h=>new Xb(h),["FileMenuButton"]:h=>new Xb(h),["ColorPicker"]:h=>new Md(h),["ComboBox"]:h=>new fn(h),["ContextMenuControl"]:h=>new im(h),["ContextMenuLauncher"]:h=>new im(h),["DialogMenuLauncher"]:h=>new Vp(h),["DropDown"]:h=>new en(h),["FlyoutAnchor"]:h=>new Il(h),["GalleryButton"]:h=>new oo(h),
["StatefulColorFlyoutAnchor"]:h=>new Il(h),["JewelMenuLauncher"]:h=>new ht(h),["Label"]:h=>new Hr(h),["Placeholder"]:h=>new bb(h),["SearchBox"]:h=>new Sm(h),["Separator"]:h=>new bb(h),["SplitButton"]:h=>new wp(h),["StatefulColorSplitButton"]:h=>new wp(h),["StatefulImageSplitButton"]:h=>new wp(h),["TextBox"]:h=>new gn(h),["ToggleButton"]:h=>new On(h)}}eVh(){this.cAe[Jk.Control.Kri]=b=>new pl(b)}chf(){this.cAe[Jk.Control.Itj]=b=>new ql(b)}NMl(b){const h=this.cAe[b.controlType];(b=h?h(b):null)&&this.eZj&&
b.ktl();return b}static get instance(){return Cl._instance||(Cl._instance=new Cl(!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Cl._instance=null;Object(n.a)(Cl,"ControlBehaviorFactory",null,[418]);var yi=c(978),lj=c(147);class mq extends Kk.MenuLauncher{constructor(b,h,v,D){super(b,h,v,D);this.g4g=null;this.CMa=this.YCc=0;this.wF=null;this.kwc=this.jwc=0;this.ih("Menu");this.enabled=!0}get x(){return this.YCc}get y(){return this.CMa}get EIf(){return this.jwc}get FIf(){return this.kwc}get controlType(){return"DialogMenuLauncher"}r6a(){}O7a(){}eof(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.ht.DialogMoveCommand;b.DialogCloseCommand=this.ht.DialogCloseCommand;return b}lXm(b,h){this.YCc=b.x;this.CMa=b.y;this.jwc=b.height;this.kwc=b.width;this.c0(h)}yQ(b){this.g4g=ka.a.createElement("span");return new lj.a(b,this.g4g)}get ht(){return this.Hh}pua(b,h,v){return new mq(b,this.id,h,v)}}Object(n.a)(mq,"DialogMenuLauncher",Kk.MenuLauncher,[]);var ng=c(814);class qo extends yi.a{constructor(b,h){super(b,h);this.R8a=null}get cYe(){return this.R8a}get UQh(){return this.properties}get H9(){return 20}ym(){super.ym();
qf.c(this.Nc)&&this.DC();this.Nc=ka.a.tSa(this.Nc);this.RW(this.Nc);this.dirty=!1}xO(b){if(!Object(yb.a)(ng.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}$$e(b,h,v,D){v=new Wf.Menu(this,h,v,D,null);b||(b={});b.CommandMenuOpen=this.UQh.CommandMenuOpen;b.CommandMenuClose=this.UQh.CommandMenuClose;b=new mq(this,h,b,v);this.xBb[h]=b;h=new ng.a(this,"dock"+h);h.Jf(b.zQ("Menu"));this.Jf(h);this.refresh()}Odg(b,h,v,D){const Q=this.xBb[b];if(qf.c(Q))throw Error.create('The dialog menu "'+
b+'" does not exist');Q.lXm(new Sys.UI.Bounds(h,v,0,0),D);this.R8a=Q.menu}I7e(b){b=this.xBb[b];qf.c(b)||(b.hua(),this.R8a=null)}c7d(){this.R8a=null}dispose(){const b=this.xBb;for(let h in b)b[h].dispose();super.dispose()}}Object(n.a)(qo,"DialogMenuRoot",yi.a,[]);class Ir{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(n.a)(Ir,"RootProperties",null,[]);class hn extends Ir{constructor(){super()}}Object(n.a)(hn,"StandaloneRootProperties",Ir,[]);class Hm extends hn{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(n.a)(Hm,"DialogMenuRootProperties",hn,[]);class Ih{constructor(){const b=new Hm;b.ImageSideArrow=w.AFrameworkApplication.Vs;b.ImageSideArrowClass=pd.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=w.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ed=new qo("DialogMenuRootId",b);this.Ed.wF=this;this.Ed.refresh();w.AFrameworkApplication.va.fb(Ua.a.vZf,Kd.a.frame,Object(z.a)(this,this.vZf,"populateDialogMenu"),96)}get g1(){return this.Ed}jOa(b,h,v,D,Q=null){b=parseInt(b);D=w.AFrameworkApplication.va;
v&&(D.AD=v.CommandLocation,D.U_=v.InvocationMethod);h=D.Qb(b,2,h,Q);this.Ed.refresh();return 32===h}yFa(b){return b?32===w.AFrameworkApplication.va.processAction(parseInt(b),1):!0}iu(){this.g1.root.xm()}$$e(b,h,v){const D={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};D.DialogMoveCommand=h;D.DialogCloseCommand=v;this.g1.$$e(D,b,"","")}Odg(b,h,v,D){this.g1.Odg(b,h,v,D)}I7e(b){this.g1.I7e(b)}vZf(b,h,v,D,Q){if(1===v)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',Q.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',Q.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");Q.PopulationXML=b.toString();return 32}dispose(){this.Ed&&
(this.Ed.dispose(),this.Ed=null)}}Object(n.a)(Ih,"DialogMenuRootUser",null,[321,10,372]);class dr{constructor(b,h,v){this.nsb=this.Sud=this.nxc=this.ul=null;this.MDe=this.iud=!1;this.ptc=b;this.ae=h;this.Zr=v;this.ZVb=w.AFrameworkApplication.isRtl}get azf(){return this.MDe}Yvl(b){b?(this.ul=b,this.MDe=!0,this.iud=!1,this.ae.capture(Object(z.a)(this,this.QVm,"keyEventHandler"),null),this.Zr.mb(Sc.a.pointerDown,this.ptc,Object(z.a)(this,this.Nfc,"pointerDownHandler")),this.nxc||this.Yal(),this.ul.appendChild(this.nxc),
this.Txm()):u.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}Hif(){this.MDe=!1;this.Sud=this.nsb=null;this.CZn();this.u4f();this.ul=null}u4f(){this.ae.releaseCapture();this.Zr.uc(Sc.a.pointerDown,this.ptc,Object(z.a)(this,this.Nfc,"pointerDownHandler"))}Txm(){if(this.ul.style.left.endsWith("px")&&this.ul.style.right.endsWith("px"))this.nsb=new Sys.UI.Point(Qk.a.yY(this.ZVb?this.ul.style.right:this.ul.style.left),Qk.a.yY(this.ul.style.top));else{const b=this.ZVb?this.ptc.offsetWidth-
(this.ul.offsetLeft+this.ul.offsetWidth+Qk.a.yY(this.ul.style.marginRight)):this.ul.offsetLeft-Qk.a.yY(this.ul.style.marginLeft),h=this.ul.offsetTop-Qk.a.yY(this.ul.style.marginTop);this.Kmj(b,h);this.nsb=new Sys.UI.Point(b,h)}this.Sud=this.nsb}Yal(){this.nxc=pd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}CZn(){this.nxc.parentNode===this.ul&&this.ul.removeChild(this.nxc)}QVm(b){if(!this.azf)return!1;b.Gb.preventDefault();if(b.eventName===Sc.a.fi){const h=b.Gb.ctrlKey?
1:10;let v;switch(b.Gb.keyCode){case zf.a.O5:this.Jdc(0,-1*h);break;case zf.a.Fda:this.Jdc(0,1*h);break;case zf.a.Omc:v=this.ZVb?1:-1;this.Jdc(v*h,0);break;case zf.a.vqb:v=this.ZVb?-1:1;this.Jdc(v*h,0);break;case zf.a.IIa:this.BOi(this.Sud.x,this.Sud.y);this.iud=!0;break;case zf.a.Bs:this.iud=!0}}b.eventName===Sc.a.uh&&this.iud&&this.Hif();return!0}Nfc(b){if(!this.azf)return!1;b.Gb.preventDefault();this.Hif();return!0}Jdc(b,h){this.BOi(this.nsb.x+b,this.nsb.y+h)}BOi(b,h){b=this.Hzk(b,h);this.Kmj(b.x,
b.y);this.nsb=b}Kmj(b,h){this.ZVb?this.ul.style.right=b+"px":this.ul.style.left=b+"px";this.ul.style.top=h+"px"}Hzk(b,h){const v=this.ZVb?Qk.a.yY(this.ul.style.marginRight):Qk.a.yY(this.ul.style.marginLeft),D=Qk.a.yY(this.ul.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-v,b),this.ptc.offsetWidth-this.ul.offsetWidth-v),Math.min(Math.max(-D,h),this.ptc.offsetHeight-this.ul.offsetHeight-D))}}Object(n.a)(dr,"KeyMoveAdapter",null,[373]);var Io=c(1114),hl=c(559);class Og{get name(){return"CUI.Behavior"}xc(b){w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(372,"Common.UI.IDialogMenuRootUser").singleInstance().Rd(()=>new Ih),b.register(373,"Common.IKeyMoveAdapter").singleInstance().Rd(()=>new dr(w.AFrameworkApplication.ta.vna(),Yb.KeyInputManager.instance,mg.a.instance)));b.register(hl.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Rd(()=>hl.a.instance)}init(){Io.a.T9e=Cl.instance;const b=hl.a.instance.Tej;for(let h=0;h<b.length;++h){const v=Object(Ka.a)(374,
b[h]);v&&v.dOa()}rj.a.get_instance().aI(6)}dispose(){}static main(){N.a.instance.Fc(new Og,5)}}Object(n.a)(Og,"CuiBehaviorPackage",null,[1,2]);class Vn{constructor(b){const h=new hn;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=pd.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=pd.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=pd.getImageClass("RibbonUpArrow_8x8x32");
h.ImageDownArrow8by8Class=pd.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=pd.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=pd.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=pd.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=w.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ccb=yi.a.tdl(h);this.Ccb.refresh()}get jda(){return this.Ccb}dispose(){this.Ccb.dispose()}}Object(n.a)(Vn,"StandaloneRootController",null,[1194,10]);var Wn=c(1141),
bm=c(160);class Jr{constructor(b){this.Lzc=b}create(b,h){const v=new Sys.StringBuilder;this.tIc(v,b,h);this.waf(v,b);return v.toString()}efb(b,h){const v=[];this.gbf(v,b,h);this.xaf(v,b);return v}tIc(b,h,v){switch(h.errorType){case 0:b.append(this.Lzc.build());break;case 1:case 2:b.append(this.w4e(h,v))}}gbf(b,h,v){switch(h.errorType){case 0:b.push(this.Lzc.fyh());break;case 1:case 2:b.push(this.vMk(h,v))}}waf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');
b.append(bm.a("btnIgrnoreSpellingError",(2===h.errorType?Eb.a.zIa:Eb.a.gwa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}xaf(b,h){const v=Object.assign(new $g.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";v.ControlList.push(Object.assign(new fg.a,{ExternalId:h}));b.push(v)}w4e(b,h){b=this.rJl(b.suggestions,h);return 0<b.length?bm.g("msUnknownWord",bm.d(null,b),"Menu16"):bm.g("msUnknownWord",bm.d(null,[bm.a("btnNoSuggestions",
Eb.a.zIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}rJl(b,h){const v=[];if(b){const D=Math.min(h.length,b.length);for(let Q=0;Q<D;++Q)b[Q]&&v.push(bm.a("btnCorrectWord"+Q,h[Q].toString(),b[Q]))}return v}vMk(b,h){const v=Object.assign(new $g.a,{Id:"Suggestions",ControlList:[]});this.qJl(b.suggestions,h,v.ControlList);0>=v.ControlList.length&&(b=Object.assign(new fg.a,{ExternalId:"NoSuggestions"}),v.ControlList.push(b));return v}qJl(b,h,v){if(b){const D=Math.min(h.length,b.length);
for(let Q=0;Q<D;++Q){if(!b[Q])continue;const ba=Object.assign(new fg.a,{ExternalId:"btnCorrectWord"+Q,Command:h[Q].toString(),LabelText:b[Q]});v.push(ba)}}}}Object(n.a)(Jr,"DefaultProofingContextMenuCreator",null,[]);var nq=c(702);class ro{constructor(b,h){this.XQg=b;this.XSg=h;this.ula=[Eb.a.Bpb,Eb.a.Cpb,Eb.a.Dpb,Eb.a.JPb,Eb.a.KPb]}create(b,h){return h?Object(yb.a)(nq.a,h)?this.XSg.create(b,h,this.ula):this.XQg.create(h,this.ula):""}L3b(b,h){return h?Object(yb.a)(nq.a,h)?this.XSg.efb(b,h,this.ula):
this.XQg.efb(h,this.ula):null}}Object(n.a)(ro,"ProofingContextMenuSectionFactory",null,[551]);class Gp{build(){const b=[bm.a("btnDeleteRepeatedWord",Eb.a.vDa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return bm.g("msRepeatedWord",bm.d(null,b),"Menu16")}fyh(){const b=Object.assign(new $g.a,{ControlList:[]}),h=Object.assign(new fg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(n.a)(Gp,"ProofingRepeatedWordSectionBuilder",null,[550]);class Dn{static get Xg(){return Vf.a.qA(Dn.Lm,
Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Dn.Lm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(n.a)(Dn,"AutoCorrectOptionsDialogHTML",null,[]);class Hp{static get Xg(){return Vf.a.qA(Hp.Lm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Hp.Lm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(n.a)(Hp,"AutoCorrectOptionsDialogHTML2",null,[]);class oq extends Vf.a{constructor(b,h){super();this.gfo=(v,D)=>{1!==v?u.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):D.ReplaceTextAsYouType!==this.BV.vSa||D.CapitalizeFirstLetterOfSentences!==this.BV.xCd||D.ReplaceOrdianalsWithSuperscript!==this.BV.wde||D.ReplaceHyphensWithDash!==this.BV.A4c||D.ReplaceFractionsWithFractionCharacter!==this.BV.vde||this.Kea&&D.ReplaceQuoteWithSmartQuote!==
this.BV.x6f?(v={},v.ReplaceTextAsYouType=D.ReplaceTextAsYouType,v.CapitalizeFirstLetterOfSentences=D.CapitalizeFirstLetterOfSentences,v.ReplaceOrdianalsWithSuperscript=D.ReplaceOrdianalsWithSuperscript,v.ReplaceHyphensWithDash=D.ReplaceHyphensWithDash,v.ReplaceFractionsWithFractionCharacter=D.ReplaceFractionsWithFractionCharacter,this.Kea&&(v.ReplaceQuoteWithSmartQuote=D.ReplaceQuoteWithSmartQuote),this.BV.U9n(v),u.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:D.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:D.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:D.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:D.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:D.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Kea,["ReplaceQuoteWithSmartQuote"]:this.Kea&&D.ReplaceQuoteWithSmartQuote}),Ya.App.xa.updateCommandUI(!0)):u.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.BV=b;this.Kea=h;this.wg="AutoCorrectOptionsDialog"}eeg(){u.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Xg=this.Kea?Hp.Xg:Dn.Xg;const b={};b.ReplaceTextAsYouType=this.BV.vSa;b.CapitalizeFirstLetterOfSentences=this.BV.xCd;b.ReplaceOrdianalsWithSuperscript=this.BV.wde;b.ReplaceHyphensWithDash=this.BV.A4c;b.ReplaceFractionsWithFractionCharacter=this.BV.vde;this.Kea&&(b.ReplaceQuoteWithSmartQuote=
this.BV.x6f);this.Yh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.gfo,b)}}Object(n.a)(oq,"AutoCorrectOptionsDialog",Vf.a,[548]);class sr{static get Xg(){return Vf.a.qA(sr.Lm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}sr.Lm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(sr,"AltTextDialogWithDescriptionHtml",null,[]);class Sk{static get Xg(){return Vf.a.qA(Sk.Lm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Sk.Lm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(Sk,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class En extends Vf.a{constructor(b=!1,h=!1){super(!1,!1,b);this.nni=!1;h?(this.nni=!0,this.Xg=Sk.Xg):this.Xg=sr.Xg;this.wg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}D$e(b){this.Yh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.iBk,"altTextDialogHandler"),this.gpf(b));b=document.getElementById(En.m0e)||document.getElementById(En.aAd);b.focus();b.select()}gpf(b){const h={};this.nni||(h[En.m0e]=this.Zmf(b));
h[En.aAd]=this.oTl(b)||"";return h}Sua(b){return b.zf.id===En.aAd?!1:super.Sua(b)}}En.m0e="titleText";En.aAd="descriptionText";Object(n.a)(En,"BaseAltTextDialogWithDescription",Vf.a,[]);var rh=c(32);class Td extends En{constructor(b,h,v,D,Q){super();this.vk=h;this.wn=v;this.Ts=D;this.Ld=Q;this.zpb=this.uT=null;this.D$e(b)}oTl(b){this.uT=b.node;this.zpb=rh.TableReader.bhi(b);return rh.TableReader.puf(this.zpb)}Zmf(b){this.uT=b.node;this.zpb=rh.TableReader.bhi(b);return rh.TableReader.quf(this.zpb)}iBk(b,
h){if(1===b){b=rh.TableReader.quf(this.zpb);const v=rh.TableReader.puf(this.zpb),D=h[En.m0e];h=h[En.aAd];this.hide();const Q=this.Ts.Oc(15);try{Q.Cb(this.uT),this.vk.xbg(this.zpb,D),this.vk.Pmj(this.zpb,h)}finally{Q&&Q.dispose()}D===b&&h===v||this.Ld.Ls(16)}this.wn.Qo&&this.wn.Qp.QF(this.uT)}}Object(n.a)(Td,"TableAltTextDialog",En,[]);class Pn{constructor(b,h,v){this.cA=b;this.Gc=h;this.Sd=v}create(b){return new Td(b,this.cA,Ya.App.qd,this.Gc,this.Sd)}}Object(n.a)(Pn,"TableAltTextDialogFactory",null,
[]);const Zr=()=>{Ya.App.wrh=!0;return 32},cm=(b,h,v,D,Q)=>{if(1===v)return 32;if(!({point:b,Ix:h}=Xp(Q)).returnValue)return 16;Ya.App.xa.Ajc(b,h);return 32},Ks=(b,h,v,D,Q)=>{if(1===v)return 32;if(!({point:b,Ix:h}=Xp(Q)).returnValue)return 16;Ya.App.xa.bja(b,h);return 32},Xp=b=>{let h=null,v=0;if(!b)return{returnValue:!1,point:h,Ix:v};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Ix:v};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));v=parseInt(b[2]);return{returnValue:!0,point:h,Ix:v}};
var er=c(1821);class Im extends Sys.EventArgs{constructor(b,h,v,D,Q,ba=0,ta=0,Ta=null){super();this.controlId=b;this.commandId=D;this.time=Q;this.commandSurface=ba;this.Ix=ta;this.contentType=Ta}}Object(n.a)(Im,"CommandClickEventArgs",Sys.EventArgs,[]);class Ip{constructor(b,h){this.gsa=b.Rof();this.Fqc=b;this.L8a=h}jOa(b,h,v,D=null,Q=null){v&&(this.L8a.AD=v.CommandLocation,this.L8a.U_=v.InvocationMethod,this.L8a.sNa=v.CommandTabName);b=parseInt(b);let ba=this.Fqc.V7h(b,h,v);ba.VPf&&(ba=this.Fqc.V7h(ba.aM,
h,v));if(void 0!==ba.Y_a&&null!==ba.Y_a)return ba.Y_a;if(ba.NFb)Q=32;else{var ta=null;this.gsa&&this.gsa.QZf&&(ta=this.gsa.QZf(ba,Q));ba.qha||ba.oVc?ba.ODa?Q=16:(Q=this.L8a.Qb(ba.aM,ba.gbc?2:1,ba.xd,Q),2===Q&&(Q=32)):ba.ODa?Q=this.L8a.Kpa(null,ba.aM,ba.xd,Ta=>{D&&D(Ta.response)},Q):(Q=this.L8a.Qb(ba.aM,2,ba.xd,Q),D&&D(Q));this.gsa&&this.gsa.LZf&&this.gsa.LZf(ba,Q,ta);if(h&&v&&-1!==v.InvocationMethod&&v.InvocationMethod){v=h.LegacyId;if(void 0===v||null===v)v="";ta=h.ParentMenuId;void 0!==ta&&null!==
ta||!h.MenuId||(ta=h.MenuId);let Ta=h.SqmControlId;void 0!==Ta&&null!==Ta||!h.SourceControlId||(Ta=h.SourceControlId);(void 0!==Ta&&null!==Ta||void 0!==ta&&null!==ta)&&er.a.AMn(new Im(Ta,v,ta,Rc.ActionManager.Baa(b),Date.now()))}}ba.qha&&32===Q&&this.gsa&&this.gsa.mCa&&this.gsa.mCa(ba,h);ba.oVc&&32===Q&&this.gsa&&this.gsa.iZa&&this.gsa.iZa(ba,h);return 32===Q||1===Q}yFa(b,h=null){if(w.AFrameworkApplication.Lk||xb.a.instance.Kv)return!1;null!=h&&null!=h.UILocation&&(this.L8a.AD=h.UILocation);const v=
parseInt(b);if(!b||v===Rc.ActionManager.Vgf)return!0;b=this.Fqc.L7h(v,h);b.VPf&&(b=this.Fqc.L7h(b.aM,h));if(void 0!==b.Y_a&&null!==b.Y_a)return b.Y_a;v===Ua.a.e0b&&h&&(b.xd=h);return 32===this.L8a.Qb(b.aM,1,b.xd)}clearCache(){this.Fqc.clearCache()}}Object(n.a)(Ip,"GeneralCuiUser",null,[320,321]);var pq=c(193),Pl=c(99),hj=c(56),Yp=c(1398);class lp{get ZG(){return null!=this.$Ig?this.$Ig:this.$Ig=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,h,v,D){this.nSg="DocumentProofingFailed";
this.uUe=b;this.Shh=h;this.ued=v;this.wI=D}Iam(){const b=this.wI.S8l(this.uUe);return{returnValue:this.wI.aPa(this.uUe),eJn:b}}lVo(b,h){const v=Pl.a.Lr();if(v){var D=new pq.ScriptSharpLegacyMap;D.add(Gd.a.eL,b);D.add(lc.a.noProof,h);b=new ah.GraphTransaction(15);b.Cb(v);this.ZG.iRa(hj.StyleReader.wordStyleIdNormal,D,v)?Yp.a.KAj():(u.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Yp.a.recordQosError(this.nSg,[Yp.a.ozc],"Style could not be modified"));b.dispose()}else u.ULS.sendTraceTag(555775182,
375,10,"PageContentNode not found"),Yp.a.recordQosError(this.nSg,[Yp.a.ozc],"PageContentNode not found")}Ego(b,h){this.lVo(b,h)}Olo(b,h){if(this.Shh){var v=new fh.DictionaryPropertySet;this.ued.execute(D=>{D.MKc(b)});v.setValue(Gd.a.eL,b);v.setValue(lc.a.noProof,h);h=new ah.GraphTransaction(15);h.set(Ya.App.Tj.zl);this.Shh.g5(v);h.dispose()}}gf(){return We.SelectionEditor.gf(this.uUe)}}Object(n.a)(lp,"LanguageEditor",null,[547]);var wl=c(602),so=c(244),Bj=c(102);class Jq{constructor(b=!1,h=0){this.languages=
Jq.cgi(lk.a.dSl());this.Mnd=new so.a;this.fSa=[];this.fYb=new wl.a;this.E6i=b;this.Hbh=0>=h?7:h;this.Gbh=this.NOe=0;this.oXg=!1;b&&(this.czm(),w.AFrameworkApplication.dI(()=>{this.F5m()}))}czm(){for(var b of this.languages)this.Mnd.Z(b.LCID,b);b=[];try{const D=Qb.a.get("RecentlyUsedLcids");if(D&&""!==D){const Q=decodeURIComponent(D).split(",").slice(0,this.Hbh);for(const ba of Q){let ta;({value:ta}=this.Mnd.Dc(parseInt(ba),ta)).returnValue&&b.push(ta)}}}catch(D){u.ULS.sendTraceTag(38385057,324,15,
"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",D.message),Array.clear(b)}if(b.length)for(var h of b){var v=h.LCID;this.fYb.contains(v)||(this.fSa.push(h),this.fYb.add(v))}else h=w.AFrameworkApplication.lcid,({value:v}=this.Mnd.Dc(h,v)).returnValue&&(this.fSa.push(v),this.fYb.add(h));this.Wfj()}Wfj(){const b=Bj.toArray(Bj.select(Bj.asEnumerable(this.fSa),h=>h.LCID)).join(",");Qb.a.eTa("RecentlyUsedLcids",b,180)}P_l(b){let h,v=-1,D=null;var Q=Jq.cgi(this.fSa);this.E6i&&
0<Q.length&&(D=Bj.toArray(Bj.Si(Bj.asEnumerable(Q),(Ta,ob)=>{b===Ta.LCID&&-1===v&&(v=ob);return{["key"]:ob,["text"]:Ta.displayName,["value"]:Ta.LCID.toString()}})));let ba=0;D&&(ba=D.length);Q=ba;const ta=Bj.toArray(Bj.Si(Bj.asEnumerable(this.languages),(Ta,ob)=>{b===Ta.LCID&&-1===v&&(v=ba+ob);return{["key"]:ba+ob,["text"]:Ta.displayName,["value"]:Ta.LCID.toString()}}));h=v;return 0<ba?{returnValue:D.concat.apply(D,ta),selectedIndex:h,Ytj:Q}:{returnValue:ta,selectedIndex:h,Ytj:Q}}Lio(b,h){if(this.E6i&&
({value:v}=this.Mnd.Dc(b,v)).returnValue){h=b!==h;if(this.fYb.contains(b))b=Array.indexOf(this.fSa,v),0<=b&&(Array.removeAt(this.fSa,b),this.fSa.push(v)),h&&this.NOe++;else{this.fYb.add(b);this.fSa.push(v);if(this.fSa.length>this.Hbh){var v=this.fSa.shift();this.fYb.remove(v.LCID)}h&&this.Gbh++}this.Wfj()}}F5m(){const b=this.NOe+this.Gbh;!this.oXg&&0<b&&(u.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.NOe/b),this.oXg=!0)}static cgi(b){b=Array.clone(b);b.sort((h,
v)=>h.displayName.localeCompare(v.displayName));return b}}Object(n.a)(Jq,"LanguageListHelper",null,[546]);var Ro=c(190);class Jm extends Ro.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)(Jm,"NumberButtonProps",Ro.a,[]);var io=c(212);class wm{static get p5(){return null!=wm.rGg?wm.rGg:wm.rGg=Ga.a.instance.Na("Box4.ISpacingCommands")}static get Wg(){return io.ContextSetEditor.instance}static get KFa(){return null!=wm.mDg?wm.mDg:wm.mDg=Ga.a.instance.Na("Box4.ILineSpacingHelper")}static get Spj(){return!!wm.p5}static Tb(){const b=
w.AFrameworkApplication.va;b.qa(Eb.a.Ufc,Zb.a.view,wm.Ufc);b.Vc(Eb.a.Ufc,1124);b.qa(Eb.a.Ufc,Zb.a.paragraph,wm.tVo)}static Ufc(b,h,v,D,Q){if(1===v||!wm.Spj)return wm.Spj?32:8;if(!wm.xyi){var ba=[];ba.push(Object.assign(new Jm,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ba.push(Object.assign(new Jm,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ba.push(Object.assign(new Jm,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ba.push(Object.assign(new Jm,{ExternalId:"LineSpacing2_00",Number:2,
Type:0}));ba.push(Object.assign(new Jm,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ba.push(Object.assign(new Jm,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));Q.MenuItems=bm.e(ba);wm.xyi=!0}u.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.lb;ba=null;h&&h.gb.kb&&(ba=h.gb.kb);h=wm.Wg.f2h(ba.Oa);w.AFrameworkApplication.va.Of(h,b,v,!0,D,Q);return 32}static tVo(b,h){let v=b=!0;h=wm.KFa.qEa(h.node);var D=h.beforeSpacing;let Q=!1;1===D.unit&&(Q=!0);if(Q||0<D.value)b=!1;
h=h.afterSpacing;D=!1;1===h.unit&&(D=!0);if(D||0<h.value)v=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(wm.vuk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(wm.o_n,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(wm.uuk,!v));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(wm.n_n,v));return 32}}wm.vuk="AddSpaceBeforeParagraph";wm.uuk="AddSpaceAfterParagraph";wm.o_n="RemoveSpaceBeforeParagraph";wm.n_n="RemoveSpaceAfterParagraph";
wm.xyi=!1;Object(n.a)(wm,"LineSpacingRibbonMenu",null,[]);var Xj=c(176),Ql=c(1678),wn=c(1380);const qq=(b,h,v)=>{if(1===v)return 32;b=Ya.App.xa.notificationBar.Ama("Automation test",!1);b.image=3;Ya.App.xa.notificationBar.fA(b);return 32},Zp=(b,h,v,D,Q)=>{let ba;if(!({ZHj:ba}=Tk(Q)).returnValue)return 16;Xj.UISurfaces.uM().then(ta=>{let Ta=null;var ob=Object.assign(new Ql.a,{label:"OK",onExecute:()=>{Ta&&ta.removeNotification(Ta)}});ob=Object.assign(new wn.a,{target:"#"+pc.AppFrame.j8f,content:"Here's the text for the callout",
title:"Your title",primaryButtonProps:ob,useTeachingStyles:ba});ob=ta.callout(ob);Ta=ta.addNotification(ob);return null},ta=>{u.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ta);return null});return 32},Tk=b=>{let h=!1;if(!b)return{returnValue:!1,ZHj:h};h=Boolean.parse(b);return{returnValue:!0,ZHj:h}};var Uk=c(1459);let Qp,ti,xm,to,Gg;class jn{constructor(){this.V6=new zb.a;this.D1g=!1}UYa(b){const h=this.V6.indexOf(b);let v=!0;if(-1!==h){v=!1;if(!h)return v;this.V6.removeAt(h)}this.V6.insert(0,
b);u.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.V6.count&&(u.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.V6.J(10)),this.V6.removeAt(10));this.UWo();return v}Kne(b){let h="#";for(let D=0;D<this.V6.count;D++){var v="#"+this.V6.J(D).substring(4,6)+this.V6.J(D).substring(2,4)+this.V6.J(D).substring(0,2);v=Object.assign(new Uk.a,{Color:this.V6.J(D),Alt:v,DisplayColor:v});if(v.DisplayColor.toLowerCase()===b.toLowerCase()){h=
v.Color;break}}for(const D of jn.Dbh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(D,h))}UWo(){u.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let v=0;v<this.V6.count;v++){var h="#"+this.V6.J(v).substring(4,6)+this.V6.J(v).substring(2,4)+this.V6.J(v).substring(0,2);h=Object.assign(new Uk.a,{Color:this.V6.J(v),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const v of jn.Dbh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(v,
b));this.D1g||this.QVo();this.D1g=!0}QVo(){for(const b of Object.keys(jn.g6g)){u.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=jn.g6g[b],v=[];for(const D of h)v.push(appChrome.api.menuSection([D],D in jn.MJe?jn.MJe[D].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,v,jn.MJe[b].toString()))}}}jn.g6g={["FontColor"]:(Gg=new zb.a,Gg.add("AutomaticFontColor"),Gg.add("ThemeFontColorPickerMCU"),Gg.add("ThemeFontColorPicker"),Gg.add("StandardFontColorPicker"),
Gg.add("RecentFontColorPicker"),Gg.add("MoreFontColors"),Gg),["CellShading"]:(to=new zb.a,to.add("ThemeShadingColorPickerMCU"),to.add("ThemeShadingColorPicker"),to.add("StandardShadingColorPicker"),to.add("RecentCellShadingColorPicker"),to.add("ClearShadingColor"),to.add("MoreCellShadingColors"),to),["PictureBorders"]:(xm=new zb.a,xm.add("ThemePictureBorderColorPickerMCU"),xm.add("ThemePictureBorderColorPicker"),xm.add("StandardPictureBorderColorPicker"),xm.add("RecentPictureBorderColorPicker"),xm.add("MorePictureBorderColors"),
xm.add("NoPictureBorder"),xm.add("PictureBorderWeightOptions"),xm.add("PictureBorderStyleOptions"),xm),["PageColor"]:(ti=new zb.a,ti.add("AutomaticPageColor"),ti.add("ThemePageColorPickerMCU"),ti.add("ThemePageColorPicker"),ti.add("StandardPageColorPicker"),ti.add("RecentPageColorPicker"),ti.add("MorePageColors"),ti)};jn.MJe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,
["PictureBorders"]:"Picture Border",["PageColor"]:"Page Color"};jn.Dbh=(Qp=new zb.a,Qp.add("RecentFontColorPicker"),Qp.add("RecentCellShadingColorPicker"),Qp.add("RecentPictureBorderColorPicker"),Qp.add("RecentPageColorPicker"),Qp);Object(n.a)(jn,"RecentColorsSectionHandler",null,[]);var qn=c(1407),uo=c(1049);class fr{constructor(b){this.Zdk=b}G4(){}E4(b){this.Zdk.hhn(b)}}Object(n.a)(fr,"DataBuddyActionListener",null,[30]);class Oj{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=
this.clearButtonLabel=this.actions=null}}Object(n.a)(Oj,"DataBuddyTaskPaneProps",null,[]);class Fn{constructor(b){this.isVisible=!1;this.VY=new zb.a;this.Cre=null;this.R2=b;this.gB=new qn.a;this.Ub=$c.FocusManager.instance()}initialize(){this.Cre=new fr(this);this.R2.INa();this.gB.oL(this.Etk());this.gB.oL(this.Hqk())}toggle(){this.isVisible?this.hide():this.show()}hhn(b){if(2===b.behavior){const h=Rc.ActionManager.Baa(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.VY.add(h+": "+
Fn.hKl(b.response)),this.Cm())}}hide(){Xj.UISurfaces.Bu().then(b=>{b.hideTaskPane(Fn.XB,2);return null})}show(){Xj.UISurfaces.Bu().then(b=>{b.showTaskPane(Fn.XB,this.jA());return null});this.isVisible&&Xj.UISurfaces.Bu().then(b=>{b.setSelectedTaskPane(Fn.XB);return null})}Etk(){return b=>{b.actions=this.VY.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}Hqk(){return b=>{b.onClearClick=()=>{this.VY.clear();this.Cm()}}}Tb(){w.AFrameworkApplication.va.BY(this.Cre)}L7a(){w.AFrameworkApplication.va.yQb(this.Cre)}jA(){const b=
new Oj;this.gB.qob(b);return Object.assign(new uo.a,{title:"Data Buddy",hideHeader:!1,width:Fn.width,location:2,contentProps:b,onOpen:()=>{this.M9();this.Tb();this.isVisible=!0;w.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.eda();this.L7a();this.isVisible=!1;this.Cm();w.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}Cm(){Xj.UISurfaces.Bu().then(b=>{b.updateTaskPane(Fn.XB,this.jA());return null})}M9(){this.Ub.mg(Fn.XB)}eda(){this.p3a()&&this.Ub.mg(this.Ub.yT)}p3a(){return!!this.Ub.currentScope&&
this.Ub.currentScope.name===Fn.XB}static hKl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Fn.XB="DataBuddyTaskPane";Fn.width=300;Object(n.a)(Fn,"Box4DataBuddyTaskPane",null,[367]);class Yo{constructor(b){this.Mh=b}CIa(b){this.Mh&&this.Mh.WG(b)}Fad(){this.Mh&&this.Mh.Uad(void 0)}}Object(n.a)(Yo,
"RibbonButtonUpdater",null,[362]);var rl=c(369);class Zm{constructor(){this.GSe=this.W=null}get name(){return"Box4.UI"}xc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new Ip(b.resolve("Box4.UI.CuiActionBridge"),w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new Pn(b.resolve("Box4.ITableEditor"),new rl.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.UI.ILanguageEditor",()=>new lp(Th.a.instance.tg,b.Na("Box4.ITextFormattingCommands"),
b.Sa("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new Vn(w.AFrameworkApplication.Vs)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new oq(b.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>new Jq(w.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();
b.register(Gp,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Jr(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new ro(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();
b.ha("Box4.RibbonButtonUpdater",()=>new Yo(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new jn).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new Fn(Wn.a.instance)).singleInstance()}init(){var b=Ya.App.xa;const h=b.Nb;oc.Xwm(Object(z.a)(h,h.cKb,"onAuthenticationLost"),Object(z.a)(h,h.dKb,"onAuthenticationRestored"),b.BSk);b=w.AFrameworkApplication.va;b.qa(Eb.a.ZFn,Zb.a.application,Zr);b.fb(Eb.a.wuo,Zb.a.application,
cm,96);b.fb(Eb.a.dvo,Zb.a.application,Ks,96);b=w.AFrameworkApplication.va;b.fb(Eb.a.Owo,Zb.a.application,qq,96);b.fb(Eb.a.muo,Zb.a.application,Zp,96);wm.Tb();this.jzm();this.GSe=this.W.resolve("Common.IStandaloneRootController")}jzm(){this.W.Sa("Box4.IGeneralCuiUser").execute(b=>{this.W.Sa("Common.IStandaloneRootController").execute(h=>{h.jda.wF=b})})}dispose(){this.GSe.dispose();this.GSe=null}static main(){N.a.instance.Fc(new Zm,6)}}Object(n.a)(Zm,"Box4UIPackage",null,[1,2]);var Ij=window.InsightsTaskPaneData=
{name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},vh=c(1836);class mp{get name(){return"Box4.Insights"}init(){}dispose(){}xc(b){b.ha("Box4.Insights.Box4InsightsSelection",()=>new vh.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}
Object(n.a)(mp,"Box4InsightsPackage",null,[1,2]);const aj=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var Z=c(400),na=c(536),qb=c(1805);class gc{vlb(){return!1}reset(){}update(){}}Object(n.a)(gc,"NullTaskYieldStrategy",null,[735]);var zc=c(1411);class Yc{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=
this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(n.a)(Yc,"CatchUpConfiguration",null,[]);class td{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(n.a)(td,"SharedControllerFactoryParameters",
null,[]);var Jd=c(157),sc=c(16);class eg{constructor(b,h,v,D){this.bun=(Q,ba)=>{(this.uld=!this.uld)&&ba.$j&&ba.$j.contextId===Zb.a.Tc&&this.zCh(ba.$j.node,ba.$j.oj);return 32};this.Tx=b;this.Rp=h;this.ga=v;this.Ub=D;this.ind=this.jnd=null;this.uld=!1;this.ga.qa(sc.a.bzj,Zb.a.view,this.bun);this.Ub.fe(gf.AFrame.vp).bindAction(Yb.KeyInputManager.kc(zf.a.$nc,6),sc.a.bzj)}vY(b,h){this.uld&&this.Rp&&h&&h.nl&&h.nl.kb&&h.nl.kb.Oa&&h.nl.kb.Oa.node&&h.nl.kb.Oa.contextId===Zb.a.Tc&&this.zCh(h.nl.kb.Oa.node,
h.nl.kb.Oa.oj)}zCh(b,h){b&&(this.xQi(b)?(this.jnd&&this.jnd.id.equals(b.id)||(this.Rp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.jnd=b),this.M8m(b,h)):this.ind=this.jnd=null)}xQi(b){return 0<this.Tx.GEb(b).count}M8m(b,h){if(b){var v=-1,D=null,Q=null;for(let ba=0;ba<b.pa.length;ba++){const ta=b.pa.J(ba);if(!(null==Q||ta.changeStart&&ta.changeStart.equals(D))&&h>=v&&h<=ta.cp&&!D.equals(this.ind))if(this.Tx.rHb(D)){(b=this.Tx.OMc(D,b.id))&&
0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Rp.sendNotification(b,!1),this.ind=D);break}else this.ind=null;ta.changeStart&&!ta.changeStart.equals(D)&&(v=ta.cp,D=ta.changeStart);Q=ta.changeStart}}}}Object(n.a)(eg,"ActivityAnnouncementManager",null,[]);var hg=c(1381),eh=c(530),Rg=c(758),Sg=c(585);class uh{constructor(){this.activityId=null;this.type=
0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(n.a)(uh,"Activity",null,[]);var yf=c(392);class Xg extends uh{constructor(){super();this.Cv=this.objectId=null}static TG(b){const h=new Sg.a(new yf.a);if(b.Cv)for(const v of b.Cv)h.add(v);return h}}Object(n.a)(Xg,"RevisionSetActivity",uh,[]);class Pj{constructor(b,h,v,D=!1){this.Zve=null;this.dismiss=()=>{this.RQi.then(Q=>{Q.removeNotification(this.Zve);return this.Zve=null})};this.ZW=b;
this.oc=h;this.RQi=v;this.Qac=D}dOo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.oc.Qb(Ua.a.t4a,2,null);break;default:this.mhn()}else u.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}mhn(){this.RQi.then(b=>{var h=Object.assign(new wn.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new hg.a,{directionalHint:6,
gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const v=Object.assign(new eh.a,{expirationOptions:Object.assign(new Rg.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.Zve=b.addNotification(h,v)})}doesContentExist(b){if(!b)return u.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return u.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),
!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.oc.Qb(Ua.a.hJd,2,h))return!1;break;case 1:return this.zpl(b)}return!0}zpl(b){b=Xg.TG(b);return b?0<this.ZW.rPd(b).count:(u.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(n.a)(Pj,"ActivityContentManager",null,[487]);var dk=c(1474),Vk=c(2030),tg=c(391),Nh=c(694);class ym{constructor(){this.Cv=this.OX=null}compare(b){if(!b)return!1;if(this.OX&&b.OX){if(this.OX.count!==b.OX.count)return!1;
for(const h of this.OX)if(!b.OX.contains(h))return!1}else if(!b.OX&&this.OX||!this.OX&&b.OX)return!1;if(b.Cv&&this.Cv){if(b.Cv.count!==this.Cv.count)return!1;for(const h of this.Cv)if(!b.Cv.contains(h))return!1}else if(!this.Cv&&b.Cv||!b.Cv&&this.Cv)return!1;return!0}}Object(n.a)(ym,"ActivityHighlightableObject",null,[]);class ok extends dk.a{constructor(b,h){super();this.ZNe=this.TXb=null;this.Ddd=b;this.Tx=h;this.o2=[new Vk.a(tg.a.hBh,tg.a.gBh),new Vk.a(tg.a.eBh,tg.a.dBh),new Vk.a(tg.a.CCd,tg.a.DCd),
new Vk.a(tg.a.ECd,tg.a.X5e)]}get yib(){return 1}get X1a(){return this.o2}get Oba(){return!0}p1a(b,h){if(b=Object(Ka.a)(ym,b))if(b.OX)for(const v of b.OX)h.add(v);else u.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}rGa(b,h){if(this.Cu.jDa){var v=this.Ddd.i6a,D=this.Ddd.Aib,Q=!!v&&v.compare(D),ba=this.Cu.jDa,ta=ba.action,Ta=this.cro(ba,b),ob=!1;2!==ta&&ta&&(ob=(ob=this.Cu.TWc)?1===ob.type:!!v||!!D);h=h.LGa("*");for(let Kb=0,Vb=h.length;Kb<Vb;Kb++){const bc=h[Kb],
Dc=this.CUl(bc,tg.a.NFc);if(Dc&&Dc.Yt)if(this.eZn(bc),1===ba.type)switch(ta){case 0:Ta&&v.Cv.contains(Dc.Yt)&&this.zAd(bc,2,Dc,!1);break;case 2:Ta&&D.Cv.contains(Dc.Yt)&&this.zAd(bc,Q?2:1,Dc,!1);break;default:this.u9b(b,bc,Dc,!1)}else ob?this.u9b(b,bc,Dc,!1):this.u9b(b,bc,Dc,!0)}this.TXb&&(this.TXb.classList.add(tg.a.ECd),this.ZNe=this.TXb=null)}}CUl(b,h){return ei.a.Db(b,h)}cro(b,h){if(b&&b.xA){const v=b.xA,D=b.action;if(1===b.type&&(2===D||!D)&&v.OX)return v.OX.contains(h);if(v.Cv)for(const Q of v.Cv){b=
this.Tx.gOc(Q);for(const ba of b)if(ba===h)return!0}}return!1}u9b(b,h,v,D){const Q=this.Ddd.i6a,ba=this.Ddd.Aib;Q&&Q.Cv.contains(v.Yt)&&(!Q.OX||Q.OX.contains(b))?this.zAd(h,2,v,D):ba&&ba.Cv.contains(v.Yt)&&(!ba.OX||ba.OX.contains(b))&&this.zAd(h,1,v,D)}zAd(b,h,v,D){b&&Nh.a(b)&&(b.classList.add(this.xYl(2===h,D)),this.$ho(b,v,D))}$ho(b,h,v){this.TXb?-1!==h.cpEnd&&this.ZNe.cpEnd!==h.cpBegin&&(this.TXb.classList.add(v?tg.a.X5e:tg.a.ECd),b.classList.add(v?tg.a.DCd:tg.a.CCd)):b.classList.add(v?tg.a.DCd:
tg.a.CCd);b.classList.add(tg.a.fBh);this.TXb=b;this.ZNe=h}eZn(b){this.Cu.pSa(b);this.YXn(b)}YXn(b){b.classList.remove(tg.a.CCd,tg.a.DCd,tg.a.fBh,tg.a.ECd,tg.a.X5e)}xYl(b,h){return h?b?tg.a.dBh:tg.a.gBh:b?tg.a.eBh:tg.a.hBh}}Object(n.a)(ok,"ActivityHighlightActor",dk.a,[]);var Gi=c(2031),Rp=c(165);class Qn{constructor(b,h,v,D,Q,ba,ta,Ta){this.YV=b;this.RN=h;this.Tx=v;this.xyc=Q;this.ib=ba;this.Rp=Ta;this.Ub=ta;this.RN.MZd=!1}QWi(b,h,v){b?this.gsm(b,h,v):this.RN.i6a&&(b=Object.assign(new Gi.a,{action:1,
type:1,xA:null,JJ:this.RN.i6a}),this.RN.i6a=null,this.YV.yF(b))}gsm(b,h,v){if(h){b=new Sg.a(new yf.a);for(Q of h){var D=this.Tx.nNc(Q);for(let ba=0;ba<D.length;ba++){const ta=D[ba];this.Tx.rHb(ta)&&b.add(ta)}}var Q=this.Tx.rPd(b);Q=this.NJh(Q,b);D=this.RN.i6a;this.RN.i6a=Q;Q=Object.assign(new Gi.a,{action:0,type:1,xA:this.RN.i6a,JJ:D});this.YV.yF(Q);v&&!this.uao(h.J(0),b)||this.gco(h.J(0),b)}else u.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}uao(b,
h){if(!b)return u.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return u.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.IRl(b,h);return this.xyc.kHa(b.id,h)?this.setSelection(b,h)?!0:!1:(u.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}gco(b,h){b=this.yYl(b,h);h=new Sys.StringBuilder;for(let v=0;v<b.count;v++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,
v+1,b.count,b.J(v)));this.Rp.sendNotification(h.toString(),!0)}setSelection(b,h){if(!b||!de.ParagraphReader.Vb(b))return u.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return u.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.RN.MZd=!0;b=Pe.a.Rc(b,h);b=new Rp.Selection([b],!0);this.ib.setSelection(b);$c.FocusManager.$J()&&this.Ub.mg(gf.AFrame.Pn);return!0}IRl(b,h){if(h&&0<h.count)for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.changeStart&&
h.contains(D.changeStart))return D.cp}u.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}yYl(b,h){const v=new zb.a;if(h&&0<h.count&&b){let D=-1;for(let Q=0;Q<b.pa.length;Q++){const ba=b.pa.J(Q);if(-1!==D&&ba.isChangeEnd)if(ba.changeStart&&h.contains(ba.changeStart))continue;else v.add(b.characterData.substring(D,ba.cp)),D=-1;ba.changeStart&&h.contains(ba.changeStart)&&(D=ba.cp)}}return v}XVi(b,h){if(b)switch(b.type){case 1:if(h){b=
new Sg.a(new yf.a);for(var v of h){h=this.Tx.nNc(v);for(let D=0;D<h.length;D++){const Q=h[D];this.Tx.rHb(Q)&&b.add(Q)}}}else b=Xg.TG(b);h=this.Tx.rPd(b);this.RN.Aib=this.NJh(h,b);v=Object.assign(new Gi.a,{action:2,type:1,xA:this.RN.Aib,JJ:null});this.YV.yF(v)}else this.RN.Aib&&(v=Object.assign(new Gi.a,{action:3,type:1,xA:null,JJ:this.RN.Aib}),this.RN.Aib=null,this.YV.yF(v))}NJh(b,h){var v=null;if(b){v=new za.a;for(const D of b)12===D.type&&v.add(D)}b=new ym;b.OX=v;b.Cv=h?h:this.p3l(v);return b}p3l(b){const h=
new Sg.a(new yf.a);if(!b)return h;for(const v of b)for(const D of this.Tx.GEb(v))h.add(D);return h}}Object(n.a)(Qn,"ActivityHighlightManager",null,[]);var Xn=c(499),Rn=c(459),Jp=c(1472),Dl=c(107),$r=c(59);class as{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(n.a)(as,"CreateIndicatorTooltipParameters",null,[]);class Sn{constructor(){this.clearSticky=!1}}Object(n.a)(Sn,"DismissIndicatorTooltipParameters",null,[]);class mn{constructor(){this.target=
null;this.isSticky=!1}}Object(n.a)(mn,"UpdateIndicatorTooltipParameters",null,[]);class Bh extends Sys.EventArgs{constructor(b,h,v){super();this.eDb=b;this.Gpi=h;this.jso=v}}Object(n.a)(Bh,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Gn{constructor(){this.Hpi=new Map;this.Ipi=new Set}YKo(b,h){this.Ipi.add(b);this.Hpi.set(b,h)}ELm(b){return Id.a.awi(b.htmlElement)}eim(){const b=new Set;for(const h of this.Ipi){const v=this.Hpi.get(h);v&&this.DLm(v)&&b.add(h)}return b}DLm(b){return b.parentElement&&
Id.a.awi(b.parentElement)}}Object(n.a)(Gn,"IndicatorVisibilityTracker",null,[]);class $p extends Jp.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){super();this.ra=new cf.a;this.jub=this.R$=null;this.Xnm=(bc,Dc,Oc,gd,rd)=>{if(!rd)return u.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Dc=Xg.TG(rd.Activity);bc=null;if(rd.NodeId&&(rd=Dl.b(rd.NodeId),!W.a.Zp(rd,W.a.nil)&&(rd=this.Tx.j9h(rd),this.Kkg(rd,!1))))return 32;for(const je of Dc)if(this.Tx.rHb(je)){rd=
this.Tx.s7b(je);if(this.Kkg(rd,!0))return 32;rd&&!bc&&(bc=rd)}if(this.Kkg(bc,!1))return 32;u.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.Vnm=(bc,Dc,Oc,gd,rd)=>{u.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");rd&&Dc&&Dc.el&&(bc=Dc.node)&&((bc=this.toc.FPd(bc))?this.syd(bc,!1,!1):u.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));
return 32};this.Qwo=bc=>{(bc=this.toc.FPd(bc.customData))&&this.syd(bc,!1,!1)};this.onMouseEnter=bc=>this.bVi(bc.Qw,!0);this.npa=bc=>{bc=bc.Qw;if(bc===this.R$)return!0;this.N9i(bc);return!0};this.hGa=bc=>{this.jub=null;return this.bVi(bc.Qw,!1)};this.t0=()=>{this.Ieg();this.BDd(!0);return!1};this.Ys=()=>{this.NZi()};this.e9d=()=>{this.R$&&this.AFj(this.R$);this.jub&&this.N9i(this.jub);this.yon()};this.NZi=()=>{this.R$?this.AFj(this.R$):this.Z6e()};this.Tx=b;this.Mre=h;this.oZg=v;this.r6j=D;this.tl=
Q;this.t6=null;this.Hb=ta;this.toc=Ta;this.QDe=new Gn;this.rx=ob;this.uK=Kb;this.vI=Vb;this.lf&&(this.lf.Kla(this.e9d),this.lf.Xph(this.NZi));ba&&ba.execute(bc=>{bc.H0(this.Ys)})}get lf(){return this.tl&&this.tl.Vi?this.tl:(u.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}gDa(b,h,v){if(this.R$){var D=$r.a(this.R$);if(b===D)return this.R$}const Q=b.fh.ownerDocument;D=Xn.a.createElement(Q,Rn.a.div);D.className=tg.a.FCd;D.style.left=h+"px";D.style.top=v+"px";h=Xn.a.createElement(Q,
Rn.a.div);h.className=this.rx?tg.a.nBh:tg.a.iBh;D.style.cursor="pointer";h.style.cursor="pointer";this.vI&&(h.style.backgroundColor=this.uK.qOl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.uK.rOl());D.appendChild(h);pf.a.instance.mb(Sc.a.rR,D,this.onMouseEnter);pf.a.instance.mb(Sc.a.hL,D,this.npa);Sh.a.instance.mb(Sc.a.click,D,this.hGa);pf.a.instance.mb(Sc.a.contextMenu,D,this.t0);u.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");
this.e3m(b);h=this.m4l(b);this.QDe.YKo(h,D);this.QDe.ELm(b)&&this.rUi(h);return D}Hob(b){return this.Zpo(b)}bfb(b){const h=this.pQk(b),v=[];v.push(this.gDa(b.M4,h,b.$mc[0].y-b.Vba[0].y));return v}pQk(b){let h=tg.a.cwm+(0>b.hXc?-b.hXc:0);const v=Cf.a.Mi(b.leftMargin,0)/2;1>=v&&u.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>v?v:h;h=h<tg.a.jBh?tg.a.jBh:h;return w.AFrameworkApplication.isRtl?b.Vba[0].width/this.zoom+h:-h}dpj(b){if(b&&393230===b.Qc||393251===b.Qc){const h=
this.Tx.GEb(b);if(h)for(const v of h)if(b===this.Tx.s7b(v))return!0}return!1}Zpo(b){for(const h of de.ParagraphReader.ow(b.Bb,!0,!1))if(this.dpj(h))return!0;return!1}Tb(b){b.qa(sc.a.Qqj,Zb.a.Tc,this.Vnm);b.qa(sc.a.aeg,Zb.a.Tc,this.Xnm)}Kkg(b,h){if(!b)return!1;const v=this.toc.FPd(b);if(v)return this.syd(v,!1,!0),!0;if(!h){let D;this.c3c((D=new zb.a,D.add(b),D),!1,!0,!0);h=new of.a(3,1,0,this.Qwo,181);h.customData=b;this.Hb.Wb(h);return!0}return!1}R$k(b,h=!1){h&&this.BDd(!0);if(b&&b.parentNode){var v=
this.Auf(b);v=this.sKl(v);this.t6||(this.t6=document.createElement("Div"),document.getElementById(w.AFrameworkApplication.Z0b).appendChild(this.t6));this.Mre.createActivityIndicatorTooltip(Object.assign(new as,{target:b,container:this.t6,activityIds:v,isSticky:h,dirHint:9}));h&&(this.R$=b)}else u.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}aul(b){b&&b.classList.add(tg.a.GCd)}bVi(b,h){return this.syd(b,
h,!1)}syd(b,h,v){if(h&&b===this.R$)return!0;const D=this.Auf(b);h||this.Ieg();this.R$k(b,!h);this.aul(b.getElementsByClassName(this.rx?tg.a.nBh:tg.a.iBh)[0]);this.c3c(D,h,!0,v);this.iJi(D,h?1:2);this.r6j.N2d();h&&(this.jub=b);return!0}BDd(b=!1){this.Mre.dismissActivityIndicatorTooltips(Object.assign(new Sn,{clearSticky:b}));this.jub=null;b&&(this.R$=null)}usj(b){b&&b.classList.remove(tg.a.GCd)}Ieg(){this.R$&&this.usj(this.R$.getElementsByClassName(tg.a.GCd)[0])}N9i(b){const h=this.Auf(b);this.c3c(h,
!0,!1,!1);this.usj(b.getElementsByClassName(tg.a.GCd)[0]);this.BDd(!1);this.jub=null}Auf(b){let h=null;(b=(b=$r.a(b))?b.Bb:null)&&11===b.type&&(h=de.ParagraphReader.ow(b,!0,!1));return h}Z6e(){const b=!!this.jub;if(this.R$||b)this.Ieg(),this.BDd(!0),this.c3c(null,!1,!1,!1),this.c3c(null,!0,!1,!1)}Evk(b){this.ra.addHandler($p.Cmh,b)}Fvk(b){this.ra.addHandler($p.Dmh,b)}c3c(b,h,v,D){let Q=null;if(v&&b){for(const ba of b)if(v=this.Tx.nNc(ba))for(let ta=0;ta<v.length;ta++){const Ta=v[ta];if(this.Tx.rHb(Ta)){Q=
this.Tx.OMc(Ta,ba.id);break}}if(!Q){u.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.ra.raiseEvent($p.Cmh,new Bh(Q,b,!1)):this.ra.raiseEvent($p.Dmh,new Bh(Q,b,D))}sKl(b){const h=[];if(b)for(const D of b){var v=this.Tx.GEb(D);for(const Q of v)(v=this.Tx.OMc(Q,D.id))&&h.push(v.activityId)}!h.length&&b&&b.count&&u.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}AFj(b){b&&b.parentNode?(this.Mre.updateActivityIndicatorTooltip(Object.assign(new mn,{target:b,isSticky:!0})),this.R$=b):u.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}yon(){const b=this.QDe.eim();for(const h of b)this.rUi(h)}rUi(b){this.oZg.hJi(b,3)}m4l(b){return(b=de.ParagraphReader.ow(b.Bb,!0,!1))&&b.count?b.J(0).id:null}e3m(b){b=de.ParagraphReader.ow(b.Bb,!0,!1);this.iJi(b,0)}iJi(b,
h){b&&b.count&&this.d3m(b.J(0).id,h)}d3m(b,h){this.oZg.hJi(b,h)}}$p.Cmh="ActivityIndicatorPreviewed";$p.Dmh="ActivityIndicatorSelected";Object(n.a)($p,"ActivityIndicatorActor",Jp.a,[]);var ig=c(36);class vo{constructor(b,h,v){this.Tx=b;this.swd=h;this.tl=v}get lf(){return this.tl&&this.tl.Vi?this.tl:(u.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}FPd(b){u.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.j$h(b);if(!h){u.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Tx.GEb(b);for(const v of b)if(b=this.Tx.s7b(v),b=this.j$h(b))return b}return h}j$h(b){if(!b||12!==b.type)return u.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return u.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.swd.GPc(b);if(!h||11!==h.type)return u.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.De(this.lf.ic);if(!h||!h.htmlElement)return u.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var v=jc.a.oNc(h.htmlElement,vo.Bmh);if(v)return v;h=h.Xjf();if(!h)return u.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=jc.a.ePl(h,vo.Bmh);if(!h)return u.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(v=0;v<h.length;v++){const D=$r.a(h[v]),Q=ig.OutlineElementNavigator.Gl(b);if(D&&D.Bb&&Q&&D.Bb.id.equals(Q.id))return h[v]}u.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}MZl(b){b=this.Tx.j9h(b);if(!b||12!==b.type)return u.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
W.a.nil;b=this.FPd(b);if(!b)return u.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),W.a.nil;b=$r.a(b);return b?b.Bb.id:(u.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),W.a.nil)}}vo.Bmh="CatchUpActivityIndicatorContainer";Object(n.a)(vo,"ActivityIndicatorHelper",null,[]);var oj=c(1679);class Jo{constructor(b,h,v,D,Q,ba,ta){this.g2a=
b;this.pageContentNode=h;this.hYe=v;this.oc=D;this.ZW=Q;this.Re=ba;this.DXd=ta;this.dDi=!1;this.K9m=(Ta,ob,Kb)=>{if(1===Kb)return this.gxf?32:8;2===Kb&&(this.gxf&&(this.hYe.Z6e(),this.$Wk()),u.ULS.sendTraceTag(38138719,377,50,F.c({["MarkAsRead invoked"]:!0})));Ya.App.xa.updateCommandUI();return 8};this.g2a.x5a(this.hYe)}initialize(){this.oc.qa(sc.a.$Li,Kd.a.frame,this.K9m)}get gxf(){return!!this.ZW.sR&&0<this.ZW.sR.count||!!this.ZW.Tdc&&0<this.ZW.Tdc.count}get KUm(){return this.dDi}sWf(b){const h=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.DXd||0<h||!b){const v=new Map;v.set("activityCount",h.toString());this.Re.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:v})}b?(this.ljn(b.wywaActivities),this.dDi=!0):(u.ULS.shipAssertTag(36538305,377,!1),this.DXd||Object(oj.a)(),this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}ljn(b){b?(u.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.voo(b),b=this.ZW.Zuk(b),this.woo(b)):u.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}voo(b){if(b){var h=new zb.a;for(const v of b)switch(v.type){case 2:case 3:case 4:case 10:b=4===v.type?v.u_i:v.contentId,h.add(b),this.ZW.Tdc.add(b)}0<h.count&&(u.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.oc.Qb(Ua.a.MPi,2,h.toArray()))}}woo(b){const h=new Sg.a(new yf.a),v=new ah.GraphTransaction(3);try{v.Cb(this.pageContentNode);for(const D of b){const Q=this.ZW.s7b(D);Q&&this.hYe.dpj(Q)&&
(h.add(Q.id),this.g2a.r$b(Q,!0))}}finally{v&&v.dispose()}0<b.count&&Ya.App.xa.updateCommandUI();b={};b.highlightedNodeCount=h.count;u.ULS.sendTraceTag(36509257,377,50,"{0}",F.c(b))}$Wk(){u.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.ZW.Tdc.count&&(this.oc.Qb(Ua.a.TRh,2,this.ZW.Tdc.toArray()),this.ZW.Tdc.clear());const b=this.ZYk(this.ZW.sR);this.SXn(b)}SXn(b){u.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new ah.GraphTransaction(3);try{h.Cb(this.pageContentNode);for(const v of b){this.ZW.sR.remove(v);for(const D of this.ZW.gOc(v))this.g2a.r$b(D,!0)}this.ZW.kDh()}finally{h&&h.dispose()}}ZYk(b){const h=new Sg.a(new yf.a);for(const v of b)h.add(v);return h}}Object(n.a)(Jo,"ActivityIndicatorManager",null,[]);class rq{constructor(){this.Aib=this.i6a=null;this.isFirstDocumentOpen=this.MZd=!1}}Object(n.a)(rq,"ActivityStateManager",null,[486]);class Kq{constructor(b,h){this.$ed={};this.PSb=b;this.vK=
h;this.Tdc=new zb.a}get sR(){return this.PSb.sR}GEb(b){const h=new Sg.a(new yf.a);if(!b)return h;b=this.PSb.NNd(b);for(let v=0;v<b.length;v++){const D=b[v];this.rHb(D)&&h.add(D)}return h}gOc(b){return this.PSb.gOc(b)}rPd(b){const h=new zb.a;if(b)for(const v of b)h.addRange(this.gOc(v));return h}Zuk(b){const h=new Sg.a(new yf.a);if(b)for(const v of b)if(1===v.type&&(b=v))for(const D of b.Cv){h.add(D);this.sR.add(D);const Q=D.toString();this.$ed[Q]||(this.$ed[Q]=new zb.a);this.$ed[Q].add(b)}this.kDh();
return h}rHb(b){return this.sR&&b?this.sR.contains(b):!1}OMc(b,h){if(b&&(b=this.$ed[b.toString()])&&0<b.count){for(const v of b)if(v.objectId.equals(h))return v;return b.J(0)}return null}s7b(b){return this.PSb.s7b(b)}kDh(){this.PSb.MWk()}nNc(b){return this.PSb.nNc(b)}j9h(b){if(!this.vK)return null;const h=this.vK.Jc;return h?h.Db(b):null}}Object(n.a)(Kq,"ChangeIdCache",null,[]);var sq=c(153),aq=c(100);class tq extends sq.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new aq.a,{T_:tq.getTypeName(),B_:tq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(n.a)(tq,"ChangeSummariesResponse",sq.a,[]);var rn=c(440);class Zo extends rn.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new aq.a,{T_:Zo.getTypeName(),B_:Zo.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(n.a)(Zo,"ChangeSummariesRequest",rn.a,[]);var Ha=c(330),Hb=c(368),ic=c(238),Hc=c(331);class id{constructor(){this.Sgc=this.Y4c=null}}Object(n.a)(id,"ActionPair",null,[]);class ae{constructor(b,h,v,D){this.Ttl=Q=>{Q=Q.customData;const ba=this.l9i(Q);ba&&(u.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.Krf(Q)),ba.Sgc("Request timeout"))};this.dA=b;this.yV=h;this.Te=v;this.Hb=D;this.SDe=null;this.iOe=
new Va.a;this.ych=new Va.a}rDo(b){const h=Object.assign(new Ha.a,{parentPath:["Signal",Zo.getTypeName()],items:[Object.assign(new Hb.a,{body:b})]});return this.initialize().then(()=>{const v=new Promise((D,Q)=>{this.iOe.Z(b.requestId,Object.assign(new id,{Y4c:D,Sgc:Q}))});this.ych.Z(b.requestId,new Date);u.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",ae.requestTimeoutMs);this.yV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Hc.a,
{operation:h}));this.jlo(b.requestId);return v})}initialize(){this.SDe||(this.SDe=this.dA.$k().then(()=>{this.Te.mb(this,tq.getTypeName())}));return this.SDe}PC(b,h){if(b&&ic.a.getTypeNameFor(b.content)===tq.getTypeName())if(b=b.content){var v=this.l9i(b.correspondingRequest);v?h!==Ha.a.getTypeName()?v.Sgc("Invalid operation type"):(u.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.Krf(b.correspondingRequest)),
v.Y4c(b)):u.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.Krf(b.correspondingRequest))}else u.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else u.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}jlo(b){const h=new of.a(3,1,ae.requestTimeoutMs,
this.Ttl,176);h.fyd=0;h.customData=b;this.Hb.Wb(h)}l9i(b){if(!b)return null;let h;if(!({value:h}=this.iOe.Dc(b,h)).returnValue)return null;this.iOe.remove(b);return h}Krf(b){if(!b)return-1;let h;return({value:h}=this.ych.Dc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return w.AFrameworkApplication.K.mc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(n.a)(ae,"ChangeSummariesAugloopProvider",null,[52]);class bf{constructor(){this.activityGroups=null}}Object(n.a)(bf,
"FeaturedActivityGroupPayload",null,[]);class re{constructor(b,h,v,D,Q){this.Fgk=b;this.uWj=h;this.lYj=v;this.R0j=D;this.erb=Q}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.R0j.Ewb.then(()=>this.xVl(b)):re.Wgf}tlm(b,h,v){if(!h)return u.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;aj("TranslateFeaturedActivityGroups");v=this.lYj.ILo(b,h,v.wywaActivities);u.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<v.length);this.erb.set(h.correspondingRequest,v);return Object.assign(new bf,{activityGroups:v})}xVl(b){aj("BuildFeaturedActivityGroupRequest");const h=this.Fgk.lMk();if(!h||!h.documentContent||!h.activityChanges)return u.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
re.Wgf;if(!h.documentContent.length||!h.activityChanges.length)return re.Wgf;u.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);aj("SubmitFeaturedActivityGroupRequest");return this.uWj.rDo(h).then(v=>this.tlm(h,v,b))}}re.Wgf=Promise.resolve(Object.assign(new bf,{activityGroups:[]}));Object(n.a)(re,"ChangeSummariesDataProvider",null,[485]);class Ef{constructor(b,h){this.Tx=b;this.plk=h}lMk(){const b=new zb.a,
h=new zb.a,v=new Sg.a(new yf.a);var D=this.Tx.sR;if(!D||!D.count)return Ef.Zgf;D=this.Tx.rPd(D);if(!D||!D.count)return u.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Ef.Zgf;for(const Q of D)v.contains(Q.id)||(v.add(Q.id),this.UHn(Q,b,h));return h.count&&b.count?Object.assign(new Zo,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Dl.a(W.a.create())}):Ef.Zgf}UHn(b,h,v){if(de.ParagraphReader.Vb(b)){var D=
de.ParagraphReader.plainText(b);if(D&&D.length){h.add(D);D=this.Tx.GEb(b);D=this.Dkm(D);for(const Q of D){D=new zb.a;const ba=this.getTextRanges(b,Q);for(const ta of ba)D.add({changeEnd:ta.endIndex,changeSpanId:ta.oeo,changeStart:ta.startIndex,contentIndex:h.count-1,locationId:Dl.a(b.id)});(D=this.R7k(Q,D.toArray()))&&v.add(D)}}else u.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else u.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}Dkm(b){const h=
new Va.a;for(const v of b)(b=this.ldi(v))?(h.nb(b)||h.Z(b,new Sg.a(new yf.a)),h.J(b).add(v)):u.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}R7k(b,h){const v=[];let D=null;for(const Q of b)if(b=this.Tx.OMc(Q,W.a.nil)){if(!D){const ba=this.ldi(Q);if(!ba||!ba.length){u.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}D=
ba}v.push(b)}else u.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return v.length?D?h.length?{activityId:v[0].activityId,changes:h,personId:D,timestamp:v[0].displayTimestamp.toISOString()}:(u.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(u.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(u.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}ldi(b){b=this.Tx.OMc(b,W.a.nil);if(!b)return u.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return u.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const v=new zb.a;if(!h||!h.count||!b)return v;let D=-1,Q=new Sg.a(new yf.a);for(let ba=0;ba<b.pa.length;ba++){const ta=b.pa.J(ba);if(-1!==D&&ta.isChangeEnd){if(ta.changeStart&&h.contains(ta.changeStart)){Q.add(ta.changeStart);continue}v.add({startIndex:D,endIndex:ta.cp,oeo:this.plk.Kij(Q)});D=-1;Q=new Sg.a(new yf.a)}ta.changeStart&&h.contains(ta.changeStart)&&(D=ta.cp,Q.add(ta.changeStart))}return v}}Ef.Zgf=Object.assign(new Zo,
{activityChanges:[],documentContent:[],requestId:Dl.a(W.a.nil)});Object(n.a)(Ef,"ChangeSummariesRequestBuilder",null,[]);class Bf{constructor(){this.changes=this.content=null}}Object(n.a)(Bf,"ContentChange",null,[]);class ii{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(n.a)(ii,"FeaturedActivityGroup",null,[]);class Jg{constructor(){this.end=this.start=0}}Object(n.a)(Jg,"TextRange",null,[]);class Ia{constructor(b){this.toc=b}ILo(b,h,v){if(!h)return u.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Ia.JJd;if(!h.inferences)return u.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Ia.JJd;if(!h.activityClassifications)return u.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Ia.JJd;if(!h.inferences.length||!h.activityClassifications.length)return u.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Ia.JJd;const D=[],Q=new La.a(new yf.a);for(const ba of h.inferences){const ta=this.HLo(ba,b,h,v);if(!ta)continue;const Ta=this.toc.MZl(Dl.b(ta.locationId));Ta.equals(W.a.nil)?D.push(ta):Q.nb(Ta)?Q.J(Ta).ranking>ta.ranking&&Q.Z(Ta,ta):Q.add(Ta,ta)}b=[...Array.from(Q.values),...D];b.sort((ba,ta)=>ba.ranking-ta.ranking);return b.slice(0,Ia.Y$m)}HLo(b,h,v,D){if(!b||am.a.jf(b.activitiesInGroup))return u.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const Q=new zb.a,ba=new Va.a;let ta=null;for(const ob of b.activitiesInGroup){if(!ob){u.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>ob.activityIndex||ob.activityIndex>=v.activityClassifications.length){u.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Kb=v.activityClassifications[ob.activityIndex];if(!Kb||am.a.jf(Kb.contents))u.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ta=this.mBl(D,Kb.activityId);if(Ta){Q.add(Ta);for(const Vb of ob.changes){if(!Vb){u.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ta=Vb.value;if(0>Ta||Ta>=Kb.contents.length){u.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Ta=Kb.contents[Ta];if(!Ta){u.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const bc=h.documentContent[Ta.contentIndex],Dc=Object.assign(new Jg,{start:Ta.changeStart,end:Ta.changeEnd});if(ba.nb(bc))ba.J(bc).add(Dc);else{let Oc;ba.Z(bc,(Oc=new zb.a,Oc.add(Dc),Oc))}ta||(ta=Ta.locationId)}}else u.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!Q.count)return u.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.sgm(ba);return h.count?Object.assign(new ii,{ranking:b.ranking.value,reasons:[1],activities:Q.toArray(),contentChanges:h.toArray(),locationId:ta}):(u.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}mBl(b,h){for(const v of b)if(v&&v.activityId&&v.activityId===h)return v;return null}sgm(b){const h=new zb.a;for(const D of b){b=D.key;const Q=D.value;Q.Sc((ba,ta)=>ba.start-ta.start);var v=Q.J(0).start;if(v>Ia.BMi){v-=Ia.BMi;b=b.substring(v,b.length);for(const ba of Q)ba.start-=v,ba.end-=v}h.add(Object.assign(new Bf,{content:b,changes:Q.toArray()}))}return h}}Ia.JJd=[];Ia.BMi=10;Ia.Y$m=4;Object(n.a)(Ia,"ChangeSummariesResponseTranslator",null,[]);class Za{constructor(){this.erb=new Va.a;this.rPe=
new Va.a}set(b,h){if(h.length&&b){this.erb.Z(b,h);for(const v of h)if(v.activities)for(const D of v.activities)D&&D.activityId?this.rPe.Z(D.activityId,b):u.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else u.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.erb.nb(b)?this.erb.J(b):null}P7m(b){return b&&this.rPe.nb(b)?this.rPe.J(b):null}}Object(n.a)(Za,"FeaturedActivityGroupCache",null,
[]);class tb{constructor(b){this.g2d=(h,v,D,Q,ba)=>{if(!ba)return u.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ba.Activity;if(!h)return u.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;v=this.erb.P7m(h.activityId);if(!v)return u.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;D=Xg.TG(h);u.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",v,h.activityId,this.Kij(D));return 32};this.erb=b;this.ONg=new Map}Tb(b){b.qa(sc.a.g2d,Kd.a.frame,this.g2d)}Kij(b){let h=0;const v=Array(b.count);for(const D of b)b=this.d5l(D),v[h]=Dl.a(b),h++;return v.join(",")}d5l(b){let h=this.ONg.get(b);if(h&&h!=W.a.nil)return h;h=W.a.create();this.ONg.set(b,h);return h}}Object(n.a)(tb,"FeaturedActivityGroupTelemetryActor",
null,[]);var nc=c(75);class Cc extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(n.a)(Cc,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Zc{constructor(b,h,v){this.NN=null;this.NLo=D=>{this.IYa.reset();D=this.jgm(D.customData);let Q=null;for(;D.moveNext();){const ba=D.currentNode;if(ba&&(de.ParagraphReader.Vb(ba)&&this.ra.raiseEvent("OPV",new Cc(ba)),this.IYa.update(),this.IYa.vlb())){Q=ba;break}}Q?this.$oh(Q):this.NN(!0)};this.Hb=b;this.IYa=h;this.vK=v;this.ra=new cf.a;this.Ewb=new Promise(D=>
{this.NN=D})}sxk(b){this.ra.addHandler("OPV",b)}jJk(){this.$oh(null)}$oh(b){const h=new of.a(3,1,0,this.NLo,182);h.customData=b;this.Hb.Wb(h)}jgm(b){if(!b)return nc.a.Zo(this.vK);b=ne.GraphIterator.$a(b);b.zb(7);return nc.a.Qs(b,this.vK)}}Object(n.a)(Zc,"DocumentTraverser",null,[]);class wd{constructor(b){this.oc=b}shouldShowEmptyExperienceButton(){return w.AFrameworkApplication.Q_d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.oc.Qb(Ua.a.Lie,
2,null)}onInviteOthersButtonClick(){this.oc.Qb(Ua.a.i8,2,null)}}Object(n.a)(wd,"EmptyCatchUpBehaviorManager",null,[484]);class Rd{constructor(b,h){this.zFl=()=>{const v=document.getElementById("flyoutItem0");v&&(u.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),v.focus())};this.fp=b;this.Ub=h}initialize(){const b=this.Ub.fe(gf.AFrame.h2b);b.TH=!0;b.parent=gf.AFrame.vp;b.ffa(this.zFl);this.fp.gT(gf.AFrame.h2b)}enableF6Focus(){this.fp.FI(gf.AFrame.h2b)}disableF6Focus(){this.fp.Ww(gf.AFrame.h2b)}}
Object(n.a)(Rd,"FlyoutFocus",null,[483]);var Ke=c(415);class Df{constructor(b,h,v){this.SMg=this.gXg=this.cvc=this.Xld=!1;this.KAe=this.Ked=null;this.rrn=(D,Q,ba,ta,Ta)=>{Ta[Ff.a.Visible]=!0;Ta[Ff.a.On]=this.cvc&&this.Xld;return 32};this.cun=(D,Q,ba)=>{if(1===ba)return this.Xld?(this.gXg||(this.gXg=!0,u.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.Ked)return u.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.SMg=!0;this.Ked();return 32};this.ga=b;this.lVg=h;this.Ub=v}get Wkf(){return this.KAe?this.KAe:(u.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Wkf(b){this.KAe=b}initialize(){this.Tb()}registerButtonClickedEvent(b){this.Ked&&u.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.Ked=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Xld&&u.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.Wkf.getTime();u.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.Xld=!0;(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||Ke.a.pRa("ribbon","catchUp");Qe.c(Ua.a.lTk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.cvc!==b.flyoutIsVisible&&
(this.cvc=b.flyoutIsVisible,Ya.App.xa&&Ya.App.xa.updateCommandUI(!0),this.cvc&&this.SMg&&this.Ub.mg(gf.AFrame.h2b),this.cvc||this.lVg&&this.lVg.X0m())}logFlightTriggers(b){b.hasFlyoutData&&w.AFrameworkApplication.te("WoCha187;WoCha187cf")}Tb(){this.ga.qa(Ua.a.fzj,Kd.a.frame,this.cun);this.ga.fb(Ua.a.V4i,Kd.a.frame,this.rrn,96)}}Object(n.a)(Df,"FlyoutRibbonButton",null,[482]);var Oh=c(149);class rk{constructor(b,h){this.sR=null;this.hXd=this.Azi=!1;this.ZW=b;this.Re=h;this.ejb=new Oh.a;this.NWd=new Map;
this.ejb.Z(1,new Sg.a(new yf.a));this.ejb.Z(0,new Sg.a(new yf.a));this.ejb.Z(2,new Sg.a(new yf.a));this.ejb.Z(3,new Sg.a(new yf.a));this.NWd.set(3,"CatchUpIndicatorVisible");this.NWd.set(1,"CatchUpIndicatorPreviewed");this.NWd.set(2,"CatchUpIndicatorSelected");this.rde=0}hJi(b,h){if(this.ejb.J(h).add(b)){this.f3m(h);switch(h){case 0:u.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:u.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:u.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:u.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.uCh()}}Hqn(b){this.hvl();b=this.ZW.GEb(b);for(const h of b)if(this.sR.remove(h)){this.rde++;break}}hvl(){if(!this.sR){this.sR=new Sg.a(new yf.a);for(const b of this.ZW.sR)this.sR.add(b)}}MAk(){u.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.rde);this.uCh()}uCh(){this.rde&&
(this.$Uk(),this.LUk())}$Uk(){!this.Azi&&.5<=this.ejb.J(0).count/this.rde&&(this.Azi=!0,Qe.c(Ua.a.nTk),u.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}LUk(){if(!this.hXd){var b="";1<=this.ejb.J(1).count&&(this.hXd=!0,b="previews");1<=this.ejb.J(2).count&&(this.hXd=!0,b="selections");this.hXd&&(Qe.c(Ua.a.gTk),u.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}f3m(b){(b=this.NWd.get(b))&&this.Re.logKpiUsage(b,0)}}Object(n.a)(rk,"IndicatorTelemetryActor",
null,[]);var xg=c(477);c(1067);class Hi{constructor(b,h){this.D7c=b;this.OFc=h}him(){return this.OFc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return xg.b(this.D7c.requestActivities(b,h))}getRelevantActivities(b,h){return this.OFc.promise.then(v=>v.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(v.getRelevantActivitiesResponse):xg.b(this.D7c.requestRelevantActivities(b,h)))}updateActivityState(b){return xg.b(this.D7c.updateActivityState(b))}getActivityFeed(){return this.OFc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):xg.b(this.D7c.requestActivityFeed()))}updateWaterline(){return xg.b(this.D7c.g4n())}}Object(n.a)(Hi,"ActivityRepository",null,[]);var Qj=c(1068),ek=c(1037);class tf{constructor(b,h,v,D,Q,ba=!1){this.activityContentManager=b;this.oc=h;this.pql=v;this.Re=D;this.dwm=Q;this.Qac=ba}RKf(b){const h=new Map;h.set("activityType",b.type.toString());this.Re.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}fKf(b){this.Re.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}Xen(b){try{const h=b.activity;this.RKf(b.activity);1==h.type&&this.dwm.N2d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.dOo(h),this.fKf("Content does not exist"),Promise.resolve(2);const v={};let D=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:v.ActivityId=h.activityId;v.NavigationId=atob(h.navigationId);D=this.oc.Qb(Ua.a.l8e,2,v);break;case 1:v.Activity=
h,v.NodeId=b.locationId,D=this.oc.Qb(sc.a.aeg,2,v),v.NodeId&&this.oc.Qb(sc.a.g2d,2,v)}8==D&&this.fKf("Action failed")}catch(h){return u.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.fKf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.pql.Ewb.then(()=>this.Xen(b))}}Object(n.a)(tf,"WordActivityNavigationManager",null,[480]);var Te;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";
b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Te||(Te={}));Object(n.b)("ProfilePhotoDimension",Te);var df=c(763),yg=c(1473);class wg{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(n.a)(wg,"ActivityFeedEntry",null,[]);const fk=(b,h)=>h.qWc?Bj.toArray(Bj.select(Bj.asEnumerable(b),
v=>{if(!v||!v.activityFeedItemPayload)return v;const D=JSON.parse(v.activityFeedItemPayload);var Q=D.actor;if(!Q||Q.pictureUrl)return v;const ba=Q.userPrincipalName||Q.email;if(!ba)return v;Q=h.vBb(ba,Q.provider,w.AFrameworkApplication.hm,0);if(!Q)return v;D.actor.pictureUrl=Q;return Object.assign(new wg,{id:v.id,type:v.type,collectionId:v.collectionId,activityState:v.activityState,activityFeedItemPayload:JSON.stringify(D),timestamp:v.timestamp})})):b,Ui=(b,h)=>{const v=new Map,D=new Map;for(const Q of b){if(!Q||
!Q.activityFeedItemPayload)continue;b=JSON.parse(Q.activityFeedItemPayload).actor;if(!b)continue;const ba=b.email||b.userPrincipalName;ba&&!D.has(ba)&&D.set(ba,new df.a(ba,null,b.name))}D.forEach(Q=>{const ba=h.R8b(Q,6);v.set(Q.UserId,ba)});return v};var Uh=c(502);class Bi{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(n.a)(Bi,"ActivityRequestPayload",null,[]);class dl{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(n.a)(dl,"Person",null,[]);class Lq extends uh{constructor(){super();this.relationship=0}}Object(n.a)(Lq,"TaskActivity",uh,[]);class bs extends uh{constructor(){super();this.contentId=null}}Object(n.a)(bs,"CommentActivity",uh,[]);class cs extends bs{constructor(){super()}}Object(n.a)(cs,"CommentReplyActivity",bs,[]);class Mq extends bs{constructor(){super();this.u_i=null}}Object(n.a)(Mq,"MentionActivity",bs,[]);class Wu{constructor(b,
h,v,D){this.frb=b;this.HLa=h;this.lzc=v;this.RN=D;this.RN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.frb.him().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Jaf("GetWYWAActivities",b);155===b.StatusCode&&(u.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.RN.isFirstDocumentOpen=!0);const h=this.gkg(b.People);return Object.assign(new Bi,{activities:this.$le(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.frb.getActivities(b,h).then(v=>{if(!v||v.StatusCode)throw this.Jaf("GetActivities",v);const D=this.gkg(v.People);return Object.assign(new Bi,{activities:this.$le(v.Activities,D),actors:D,hasMore:!v.RequestedRetrieved,highWaterline:v.HighWaterline,lowWaterline:v.LowWaterline})})}requestRelevantActivities(b){return this.frb.getRelevantActivities(b,this.RN.isFirstDocumentOpen).then(h=>
{if(!h||h.StatusCode)throw this.Jaf("GetRelevantActivities",h);const v=this.gkg(h.People),D=this.$le(h.NewActivities,v,2);h=this.$le(h.OutstandingActivities,v,3);for(const Q of h)D.push(Q);return Object.assign(new Bi,{activities:D,actors:v})})}updateActivityState(b){return this.frb.updateActivityState(b)}requestActivityFeed(){return this.frb.getActivityFeed().then(b=>({activityFeedItems:this.Kzm(b),personaColorMap:this.CNk(b)}))}$le(b,h,v=1){const D=[];if(!b)return D;for(const ta of b){var Q=null;
b=[];b.push(h[ta.CreatorIndex]);switch(ta.ActivityType){case 1:Q=ta;var ba=new Xg;ba.Cv=new zb.a;for(const Ta of Q.ChangeIds)ba.Cv.add(Dl.b(Ta));ba.objectId=Dl.b(Q.ObjectId);Q=ba;break;case 2:Q=ta;ba=new bs;ba.contentId=Q.ContentId;ba.navigationId=Q.NavigationId;Q=ba;break;case 4:Q=ta;ba=new Mq;b.push(h[Q.MentioneeIndex]);ba.u_i=Q.ParentContentId;ba.navigationId=Q.NavigationId;Q=ba;break;case 3:case 10:Q=ta;ba=new cs;b.push(h[Q.RepliedIndex]);ba.contentId=Q.ContentId;ba.navigationId=Q.NavigationId;
Q=ba;break;case 6:case 7:case 8:case 9:Q=ta,ba=new Lq,b.push(h[Q.MentioneeIndex]),ba.navigationId=Q.NavigationId,ba.relationship=Q.Relationship,Q=ba}Q&&(Q.actors=b,Q.displayTimestamp=new Date(ta.DisplayTimestamp),Q.activityId=Dl.b(ta.ActivityId).toString(),Q.type=ta.ActivityType,1!==v&&(Q.relevancy=v),D.push(Q))}return D}V6n(b,h,v){return this.lzc&&this.lzc.qWc?this.lzc.vBb(h,v,w.AFrameworkApplication.hm,Te.default):b}gkg(b){if(!b)return null;const h=Array(b.length);for(let v=0;v<b.length;v++){if(!b[v])continue;
const D=new dl;D.id=b[v].Id;D.provider=b[v].Provider;D.displayName=b[v].DisplayName;D.email=b[v].Email;D.imageUrl=this.V6n(b[v].PictureUrl,b[v].Email,b[v].Provider);this.HLa&&(D.color=this.HLa.R8b(new df.a(D.email,void 0,D.displayName),yg.a.catchUpFlyout));h[v]=D}return h}Jaf(b,h){let v="null";h&&(v=Uh.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,v))}Kzm(b){return this.lzc?fk(b,this.lzc):b}CNk(b){return this.HLa?Ui(b,this.HLa):new Map}}Object(n.a)(Wu,"WordActivityRequestManager",
null,[481]);class Kr{constructor(b,h,v){this.apd=0;this.uzc=!1;this.k3g=null;this.updateWaterline=()=>{if(Ya.App.lostSession)u.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.uzc||3>=this.apd){this.uzc?this.uzc=!1:this.apd++;const D=Math.max(this.Ma.mc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.k3g),0);u.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",D);ak.Task.delay(D).continueWith(()=>
{this.frb.updateWaterline().then(()=>{this.Ree();return null}).catch(()=>{this.Ree();this.uzc=!0;this.apd=0})})}else this.Ree()};this.Ma=b;this.frb=v;h.xzd(()=>{this.uzc=!0;this.k3g=new Date;this.apd=0})}start(){this.Ree()}Ree(){window.setTimeout(this.updateWaterline,6E4)}}Object(n.a)(Kr,"WordEditorActivityScheduler",null,[]);class fw{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}xfo(b){this.resolve(b)}}Object(n.a)(fw,"CatchUpNetworkRequestWorkerCache",null,[]);class Cu{constructor(b,
h,v){this.Qfl=b;this.K=h;this.Re=v}sWf(b){b&&b.authors&&this.Z2m(b.authors)}Z2m(b){for(const h of b)h&&h.displayName===this.Qfl&&(this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),u.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.jb("PresenceUserId"),h.email===this.K.jb("UserPrincipalName")))}}Object(n.a)(Cu,
"WywaAuthorComparator",null,[]);class Wk{constructor(b){this.V0=b}N2d(){this.V0&&this.V0.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(n.a)(Wk,"IndicatorSurveyActor",null,[]);var tv=c(1040),ds=c(1033);class Xw{constructor(){this.oTk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get iTk(){return w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get JBf(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get Pvi(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get hvi(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get jXd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get DXd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",
!1)}get CTm(){return w.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get Qac(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}xc(b){aj("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new fw).singleInstance()}init(){aj("Init");this.iTk&&(N.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,
4,w.AFrameworkApplication.rootQuerySignature,Ya.App.webServiceBase+"OneNote.ashx",2,this.jXd)}),aj("HotStore"),Ya.App.A5.i2a.execute(()=>{aj("ChromeReady");rj.a.get_instance().xk(7,()=>{aj("ScriptDownload");(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").Pz.loadScript("catchUpActivity")).catch(b=>{u.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",
b)}).then(()=>this.Tkn()).catch(b=>{u.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}Tkn(){aj("CreateObjectsAndInitializeState");this.a2m();this.b8k();return this.dym()}a2m(){u.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");u.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");u.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.JBf&&u.ULS.sendTraceTag(588130079,
3012,50,"ChangeSummaries is enabled");this.Pvi&&u.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.hvi&&u.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");u.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.CTm);this.jXd&&u.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}dym(){this.Kym();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Wkf=new Date;aj("InitializeCatchUpApp");return this.g2b.initialize(Object.assign(new Yc,
{featuredActivityGroupsEnabled:this.JBf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.Pvi,customDynamicEntryPointEnabled:this.hvi,activityFeedDataEnabled:this.jXd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}b8k(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Kq(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Jd.App.un.hb.rc.Yc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new tv.a(wa.Health.instance,new ds.a,this.oTk)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new rq).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Pj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),w.AFrameworkApplication.va,Xj.UISurfaces.uM(),this.Qac)).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new Hi(new Qj.a(Tb.a.azj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>w.AFrameworkApplication.rootQuerySignature,Ya.App.webServiceBase+"OneNote.ashx",2,Tb.a.azj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Wu(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.Qac)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Qn(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
Jd.App.un.hb.rc,new ek.a(Jd.App.un.hb.rc),Th.a.instance,$c.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new qb.a(50,Id.a.Ze):new gc;return new Zc(w.AFrameworkApplication.pc,b,Jd.App.un.hb.rc.Yc)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",
()=>new Wk(this.container.Sa("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new tf(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),w.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.Qac)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Df(w.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),$c.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Rd(Z.a.instance,$c.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",
()=>new Za).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new vo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Jd.App.un.hb.rc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new tb(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",
()=>new re(new Ef(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new ae(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),w.AFrameworkApplication.pc),new Ia(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.Qac)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new wd(w.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").singleInstance();this.g2b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new td,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:w.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:w.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.jXd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:w.AFrameworkApplication.uiCulture,ulsLogger:new na.a}));this.g2b.setWebpackPublicPath(w.AFrameworkApplication.t5);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new ok(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new Kr(w.AFrameworkApplication.K,zc.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new rk(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new $p(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.g2b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Jd.App.un.hb.rc,this.container.Sa("Common.IZoomManager"),w.AFrameworkApplication.pc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Ya.App.instance&&Ya.App.instance.Doa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ya.App.instance&&Ya.App.instance.WC)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Jo(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Jd.App.un.hb.rc.Yc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),w.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.DXd)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new eg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),w.AFrameworkApplication.va,$c.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Cu(w.AFrameworkApplication.userName,w.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}Kym(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.w5a(h);const v=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const D=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const Q=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
ba=Th.a.instance,ta=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ba.Pw(()=>{Q.MZd?Q.MZd=!1:(Q.i6a&&v.QWi(null,null,!1),Q.Aib&&v.XVi(null,null),D.Z6e())});ba.Pw(Object(z.a)(h,h.vY,"onSelectionChanged"));this.g2b.getWywaEvent().addListener(Object(z.a)(b,b.sWf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.g2b.getWywaEvent().addListener(Object(z.a)(b,b.sWf,"onWywaActivityReady"));const Ta=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");
ta.sxk((ob,Kb)=>{Kb&&Ta.Hqn(Kb.node)});ta.Ewb.then(()=>{Ta.MAk()});this.g2b.getWywaEvent().addListener(()=>{ta.jJk()});D.Evk((ob,Kb)=>{Kb&&v.XVi(Kb.eDb,Kb.Gpi)});D.Fvk((ob,Kb)=>{Kb&&v.QWi(Kb.eDb,Kb.Gpi,Kb.jso)});D.Tb(w.AFrameworkApplication.va);this.JBf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Tb(w.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.two()}two(){Lh.c()&&(u.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(n.a)(Xw,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var So=c(182),xp=c(398),Kp=c(1504),yp=c(451),it=c(1610),uq=c(1505),Ut=c(1674),uv=c(1675),Yw=c(635),Lr=c(1676),
tr=c(853),Vt=c(134),To=c(1513);class vv{constructor(){this.Gt=this.annotation=null}}Object(n.a)(vv,"AnnotationChangedData",null,[]);class np{constructor(b,h,v,D,Q,ba,ta,Ta=!1,ob){this.annotationType=b;this.nQ=h;this.Eq=v;this.Uje=D;this.sbd=Q;this.n_o=ba;this.hb=ta;this.apj=Ta;this.K=ob;this.UA=null;this.Dzi=!1;this.hd=new cf.a;this.SZc=0}UF(b){this.hd.addHandler("AnnotationChangedEvent",b)}YH(b){this.hd.removeHandler("AnnotationChangedEvent",b)}register(){return this.sbd().then(()=>{0===this.SZc&&
(this.apj&&(this.UA=this.Eq.$f("WebServiceCall",this.annotationType)),this.nQ.mb(this,this.annotationType));this.SZc++})}unregister(){return this.sbd().then(()=>(new Promise(b=>setTimeout(b,this.K.mc(Vt.a.Xkl,3E3)))).then(()=>{0<this.SZc&&(this.SZc--,0===this.SZc&&this.nQ.uc(this,this.annotationType))}))}R6b(){return this.sbd().then(()=>this.nQ.getAnnotationsByType(this.annotationType))}D3h(b){b=xp.a.tM(b);return(b=this.nQ.C3h(b))&&0<b.count?b.toArray().filter(h=>ic.a.matchesTypesFor(h.content,[this.annotationType])):
[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.n_o(this.hb.Uc.od,b.parentPath):null:(u.ULS.shipAssertTag(575930380,3016,!1),null)}cva(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new tr.a,{parentPath:["Signal",ic.a.getTypeNameFor(b)],items:[Object.assign(new Hb.a,{body:b})]});this.Uje.submitOperation(b)}Wsl(b,h){b=Object.assign(new Ha.a,{parentPath:["Signal",h],items:b});this.Uje.submitOperation(b)}PC(b,h){b?h?(this.apj&&!this.Dzi&&(this.UA.stop(),this.Dzi=!0),this.hd.u8&&
(b=new To.a(Object.assign(new vv,{annotation:b,Gt:h})),this.hd.raiseEvent("AnnotationChangedEvent",b))):u.ULS.shipAssertTag(575930382,3016,!1):u.ULS.shipAssertTag(575930381,3016,!1)}}Object(n.a)(np,"AnnotationManager",null,[472,52]);class Du{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.bJ=b;this.ree=h;this.uDb=v;this.C0a=D;this.X7=Q;this.kyj=ba;this.i1=ta;this.SPb=Ta;this.U4b=ob;this.SLb=Kb;this.fGo=Vb}}Object(n.a)(Du,"AnnotationManagerHolder",null,[408]);class Eu{constructor(b,h){this.Ola=b;this.sbd=
h}submitOperation(b){return this.sbd().then(()=>{this.Ola.getAugLoopRuntimeManager().submitOperation(Object.assign(new Hc.a,{operation:b}))})}}Object(n.a)(Eu,"SubmitOperationHelper",null,[]);var gw=c(869),$m=c(1677),wv=c(1065),Hg=c(103),S=c(124),Ba=c(78),ib=c(1085);class Sb{constructor(b,h,v){this.X7=b;this.Om=h;this.TKb=v;this.EDa={};this.RSh=!1;this.Ulb=(D,Q)=>{var ba;Q.data.Gt!==Ha.a.getTypeName()&&Q.data.Gt!==ib.n.getTypeName()||!Q.data.annotation||Q.data.annotation.annotationType!==$m.a.getTypeName()||
(D=Q.data.annotation.content)&&null!==(ba=D.documentTypeConfidences)&&void 0!==ba&&ba.length&&(this.QSh=D.documentTypeConfidences[0].documentTypeLabel,u.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.QSh))};this.X7.UF(this.Ulb);this.X7.register();this.EDa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}GPd(){this.RSh||(this.X7.cva(new wv.a),
u.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.RSh=!0);this.rff();this.EDa.docType=this.QSh;this.EDa.characterCount=this.characterCount;this.EDa.paragraphCount=this.AR;this.EDa.imageCount=this.pJ;this.EDa.tableCount=this.c$;this.EDa.listElementsCount=this.vFi;this.EDa.blobsCount=this.VEc;this.EDa.pageCount=this.TKb.O8b();this.EDa.currentPage=this.TKb.Fci();return this.EDa}rff(){this.AR=this.VEc=this.vFi=this.c$=this.pJ=this.characterCount=0;var b=this.Om.Gva(Jd.App.un.hb.rc.Yc,
7,7).currentNode,h=ne.GraphIterator.$a(b);for(b=nc.a.Qs(h,b);b.moveNext();)if(h=b.currentNode)if(ke.ImageReader.Eu(h))this.pJ++;else if(rh.TableReader.CU(h))this.c$++;else if(Hg.ListItemReader.Ig(h))this.vFi++;else if(de.ParagraphReader.Vb(h)){var v=Ba.e(h);for(let D=0;D<v.length;D++)5===v[D].Bh?this.pJ++:this.VEc++;v=S.AParagraphNode.IR(h.characterData);v=v.trim();this.characterCount+=v.length;0<v.length&&!de.ParagraphReader.d4(h)&&!de.ParagraphReader.wU(h)&&this.AR++}}}Object(n.a)(Sb,"LoggingDocumentInfo",
null,[402]);class yc{constructor(){this.ra=new cf.a}Nxk(b){this.ra.addHandler("OnTaskPaneReviewStateChanged",b)}C0n(b){this.ra.removeHandler("OnTaskPaneReviewStateChanged",b)}Kwk(b){this.ra.addHandler("BlueDotClickedEvent",b)}g0n(b){this.ra.removeHandler("BlueDotClickedEvent",b)}Ywk(b){this.ra.addHandler("OnFormattingMarkedForReview",b)}$wk(b){this.ra.addHandler("OnFormattingReviewCompleted",b)}Xwk(b){this.ra.addHandler("OnFormattingAccept",b)}Zwk(b){this.ra.addHandler("OnFormattingReject",b)}Exk(b){this.ra.addHandler("OnReviewInvalidated",
b)}iqh(b){this.ra.addHandler("OnTraigeAction",b)}i_e(b){this.ra.addHandler("OnReviewVisibilityChanged",b)}u0n(b){this.ra.removeHandler("OnReviewVisibilityChanged",b)}Hwk(b){this.ra.addHandler("OnBeforeReviewNavigation",b)}Axk(b){this.ra.addHandler("OnRegisterEnhancement",b)}Pxk(b){this.ra.addHandler("onTooltipVisibilityChanged",b)}D0n(b){this.ra.removeHandler("onTooltipVisibilityChanged",b)}f3c(b){b?this.ra.raiseEvent("OnTaskPaneReviewStateChanged",new To.a(b)):u.ULS.shipAssertTag(575930374,3016,
!1)}gNn(b){b?this.ra.raiseEvent("BlueDotClickedEvent",new To.a(b)):u.ULS.shipAssertTag(575930375,3016,!1)}jNn(b){b?this.ra.raiseEvent("OnFormattingMarkedForReview",new To.a(b)):u.ULS.shipAssertTag(575930376,3016,!1)}y5i(b){b?this.ra.raiseEvent("OnFormattingReviewCompleted",new To.a(b)):u.ULS.shipAssertTag(573850377,3016,!1)}iNn(b){b?this.ra.raiseEvent("OnFormattingAccept",new To.a(b)):u.ULS.shipAssertTag(575930377,3016,!1)}kNn(b){b?this.ra.raiseEvent("OnFormattingReject",new To.a(b)):u.ULS.shipAssertTag(575930378,
3016,!1)}lNn(b){b?this.ra.raiseEvent("OnReviewInvalidated",new To.a(b)):u.ULS.shipAssertTag(575930379,3016,!1)}q2f(b){b?this.ra.raiseEvent("OnTraigeAction",new To.a(b)):u.ULS.shipAssertTag(573850378,3016,!1)}z5i(b){b?this.ra.raiseEvent("OnReviewVisibilityChanged",new To.a(b)):u.ULS.shipAssertTag(573850379,3016,!1)}fNn(b){b?this.ra.raiseEvent("OnBeforeReviewNavigation",new To.a(b)):u.ULS.shipAssertTag(573687395,3016,!1)}Fgc(b){b?this.ra.raiseEvent("OnRegisterEnhancement",new To.a(b)):u.ULS.shipAssertTag(555055117,
3016,!1)}S5i(b){b?this.ra.raiseEvent("onTooltipVisibilityChanged",new To.a(b)):u.ULS.shipAssertTag(540587343,3016,!1)}}Object(n.a)(yc,"ReviewEvents",null,[403]);class ed{constructor(b){this.St=b;if(!b)throw So.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}xc(b){this.W=b;b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Eu(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),xp.a.$k)).singleInstance();b.ha("WordEditor.Designer.IDesignerControl",
()=>new gw.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),w.AFrameworkApplication.uiCulture)).singleInstance();b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new yc).singleInstance();b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new Du(this.eDa(uq.DocumentRoleDetectionAnnotation.getTypeName()),this.eDa(uq.RoleDetectionAnnotation.getTypeName()),this.eDa(Kp.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.eDa(Kp.FormattingSuggestionsAnnotation.getTypeName()),
this.eDa(yp.DocumentTypeClassifierAnnotation.getTypeName()),this.eDa(uv.ThemeExtractorAnnotation.getTypeName()),this.eDa(Yw.ThemeGeneratorAnnotation.getTypeName()),this.eDa(Ut.TextToImageAnnotation.getTypeName()),this.eDa(it.DocumentPullQuoteAnnotation.getTypeName()),this.eDa(it.PullQuoteAnnotation.getTypeName()),this.eDa(Lr.TableTypeAnnotation.getTypeName()))).singleInstance();b.ha("WordEditor.Designer.DocumentInfo",()=>new Sb(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").X7,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()}dispose(){}eDa(b,h=!1){return new np(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),xp.a.$k,xp.a.Ehb,this.St,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(n.a)(ed,"PackageManager",null,[1,2]);var Ud=c(1029),Xe=c(1498),Ue=c(1680);class Kf extends Sys.EventArgs{constructor(b,
h){super();this.node=b;this.DQf=h}}Object(n.a)(Kf,"RoleChangeArgs",Sys.EventArgs,[]);class Bg{constructor(b){this.Oh=!1;this.gQ=b;this.gQ.rld++}dispose(){this.Oh||(this.Oh=!0,this.gQ.rld--)}}Object(n.a)(Bg,"InvalidationSuspension",null,[10]);class Vh{constructor(){this.C9c=null;this.role=this.i4d=0;this.vzb=this.TZd=this.mha=this.Lbc=!1;this.q3d=this.tYc=this.yOa=null;this.removed=this.placeholder=!1;this.uAd=this.wbf=null;this.tAd=0}get Q2a(){return!this.role||!this.yOa||!this.yOa.length}kDm(){this.vzb=
this.TZd=!0}STm(){return!!this.role||!!this.yOa||!!this.C9c}}Object(n.a)(Vh,"RoleState",null,[508]);class Jh{constructor(b,h,v,D,Q){this.Ah=!1;this.VWd=null;this.QLf=new ec.a;this.XXg=0;this.m8n=(ba,ta)=>{ta.data.Gt===Ha.a.getTypeName()&&(ta=ta.data.annotation,(ba=ta.content)?(ta=this.uYb.getParent(ta))&&this.X6c(ta,Xe.e(ba.roleType),!1,void 0,null!=ba.listID?ba.listID:0,ba.listItemlevel,ba.listItemPrefix):u.ULS.shipAssertTag(575813856,3016,!1))};this.aql=(ba,ta)=>{if(ta.data.Gt===Ha.a.getTypeName())if(ba=
ta.data.annotation.content)for(u.ULS.sendTraceTag(556074199,3016,50,ba.confidence.toString()),this.QLf=new ec.a,ta=0;ba.listInfos&&ta<ba.listInfos.length;ta++){const Ta=ba.listInfos[ta];this.QLf.Z(Ta.listID,Ta)}else u.ULS.shipAssertTag(556323522,3016,!1)};this.uyi=(ba,ta)=>{ba=ba.lN;if(!ba||ba.ia(lc.a.mB,!1))return!1;ba=ba.getValue(lc.a.la);if(!ba)return!1;ba=Xe.f(ba);return 1!=ba&&ba!=ta.role};this.rHl=(ba,ta)=>{ba=ta.data.annotation;const Ta=this.njd.getParent(ba);if(Ta)if(ta.data.Gt===Ha.a.getTypeName()){const ob=
ta.data.annotation.content;ob?this.fda(Ta,Kb=>{this.VWd&&Kb.wbf&&this.VWd>Kb.wbf&&!Kb.vzb||Kb.role!==Kb.i4d||this.uyi(Ta,Kb)?(u.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.VWd,Kb.vzb,Kb.role===Kb.i4d),Kb.C9c=ob.suggestions):(Kb.yOa=ob.suggestions,Kb.vzb=!1)}):u.ULS.shipAssertTag(575813859,3016,!1)}else ta.data.Gt===Ud.a.getTypeName()&&this.fda(Ta,ob=>{ob.yOa=null;ob.C9c=null});else u.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ba.id} parentPath: ${ba.parentPath}`)};
this.xnn=(ba,ta)=>{(ba=ta.data.paragraphNode)?this.fda(ba,Ta=>{ta.data.qIj?(Ta.uAd=Ta.yOa,Ta.tAd=Ta.role):(Ta.uAd=null,Ta.tAd=0);Ta.mha=!0}):u.ULS.shipAssertTag(575930368,3016,!1)};this.znn=(ba,ta)=>{(ba=ta.data.paragraphNode)?this.fda(ba,Ta=>{Ta.mha=!1;Ta.uAd=null;Ta.tAd=0;5!==ta.data.state&&(Ta.yOa=null)}):u.ULS.shipAssertTag(573850380,3016,!1)};this.vnn=(ba,ta)=>{(ba=ta.data.paragraphNode)?this.fda(ba,Ta=>{Ta.mha=!0}):u.ULS.shipAssertTag(575930369,3016,!1)};this.ynn=(ba,ta)=>{(ba=ta.data.paragraphNode)?
this.X6c(ba,1,!0,!0):u.ULS.shipAssertTag(575930370,3016,!1)};this.aWf=(ba,ta)=>{(ba=ta.data.paragraphNode)?this.X6c(ba,ta.data.DQf,!0,!0):u.ULS.shipAssertTag(575484484,3016,!1)};this.ekm=(ba,ta)=>{if(ta.node){var Ta=ta.node;ba=this.uA(Ta);27==ba.role&&u.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ba.mha&&27!==ba.role&&28!==ba.role&&this.Vnj(this.qNb-1);ba.Q2a||27===ba.role||28===ba.role||this.Onj(this.inconsistenciesCount-1);this.fda(Ta,ob=>{ob.removed=!0});setTimeout(()=>this.removeNode(Ta),
1E4)}else u.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ba=>{let ta;({value:ta}=this.ou.Dc(ba.id));(null===ta||void 0===ta?0:ta.removed)&&this.ou.remove(ba.id)};this.dkm=(ba,ta)=>{ta.node?(ba=ta.node,this.ZUc(ba)?this.fda(ba,Ta=>{Ta.removed=!1}):this.fda(ba,Ta=>{Ta.vzb=!1})):u.ULS.shipAssertTag(540672206,3016,!1)};this.fkm=(ba,ta)=>{ta.node?this.Qcg(ta.property,ta.node)&&(ba=ta.node,this.rld||ba.N$d?this.fda(ba,Ta=>{Ta.vzb=!1}):this.fda(ba,Ta=>{Ta.kDm();Ta.C9c&&(Ta.yOa=Ta.C9c,Ta.role=Ta.i4d)}).mha&&
this.PXa.lNn(new Ue.a(ta.node))):u.ULS.shipAssertTag(575930372,3016,!1)};this.Irn=(ba,ta)=>{switch(ta.data.role){case 27:const Ta=ta.data;this.fda(ta.data.paragraphNode,Kb=>{Kb.role=27;Kb.Lbc=!0;Kb.placeholder=Ta.placeholder});break;case 28:const ob=ta.data;this.fda(ta.data.paragraphNode,Kb=>{Kb.role=28;Kb.Lbc=!0;Kb.placeholder=ob.placeholder;Kb.Zna=ob.Zna});break;case 2:this.fda(ta.data.paragraphNode,Kb=>{Kb.role=2})}};this.njd=b;this.uYb=h;this.yye=v;this.Vp=D;this.PXa=Q;this.ou=new ec.a;this.ra=
new cf.a;this.rld=this.atd=this.Wkd=0}get GDm(){return this.rld}cxk(b){this.ra.addHandler(Jh.qUi,b)}Hxk(b){this.ra.addHandler(Jh.AWi,b)}bqh(b){this.ra.addHandler(Jh.vVf,b)}x0n(b){this.ra.removeHandler(Jh.vVf,b)}get inconsistenciesCount(){return this.Wkd}Onj(b){this.Wkd!==b&&(this.Wkd=b,this.ra.raiseEvent(Jh.qUi,new To.a(this.Wkd)))}get qNb(){return this.atd}Vnj(b){this.atd!==b&&(this.atd=b,this.ra.raiseEvent(Jh.AWi,new To.a(this.atd)))}get Oxf(){return this.XXg}ZUc(b){return this.ou.nb(b.id)}R1l(b){var h,
v;return null===(v=null===(h=this.QLf)||void 0===h?void 0:h.Dc(b))||void 0===v?void 0:v.value}Vci(b,h){var v,D,Q;const ba=new Map;for(const ta of h)if(h=ta){const Ta=null!==(Q=null===(D=null===(v=this.ou.Dc(h.id))||void 0===v?void 0:v.value)||void 0===D?void 0:D.role)&&void 0!==Q?Q:1;b.has(Ta)&&(ba.has(Ta)?ba.get(Ta).add(h):ba.set(Ta,new zb.a([h])))}return ba}uA(b){if(!b)return u.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.ou.Dc(b.id)).returnValue?h:Object.assign(new Vh,
{role:1,Lbc:!1})}U3n(){this.VWd=new Date;return new Bg(this)}register(){this.njd.register();this.uYb.register();this.yye.register()}unregister(){this.njd.unregister();this.uYb.unregister();this.yye.unregister()}initialize(){if(!this.Ah){const b=this.Vp.Ye(12);b.Ow(this.ekm);b.Vt(this.dkm);b.Go(this.fkm);this.njd.UF(this.rHl);this.uYb.UF(this.m8n);this.yye.UF(this.aql);this.PXa.Zwk(this.ynn);this.PXa.Xwk(this.vnn);this.PXa.Ywk(this.xnn);this.PXa.$wk(this.znn);this.PXa.iqh(this.aWf);this.PXa.Axk(this.Irn);
this.Ah=!0}}Md(){}X6c(b,h,v,D=!1,Q=0,ba=0,ta){let Ta=0,ob=!1;this.fda(b,Kb=>{const Vb=Kb.TZd||!Kb.role||1==Kb.role;v||(Kb.i4d=h);if(D||Vb)ob=Kb.role!==h,Ta=Kb.role,Kb.role=h,Kb.Lbc=v,Kb.TZd=!1,Kb.tYc=Q,Kb.q3d=ba,Kb.listItemPrefix=ta,Kb.wbf=new Date});if(ob){const Kb=h-4;Kb>this.Oxf&&8>Kb&&(this.XXg=Kb);1===h&&this.fda(b,Vb=>{Vb.yOa=null});this.ra.raiseEvent(Jh.vVf,new To.a(new Kf(b,h,Ta)))}}fda(b,h){let v;if(({value:v}=this.ou.Dc(b.id)).returnValue){b=v.Q2a;const D=v.mha;h(v);if(27!==v.role&&28!==
v.role){if(v.removed)return v;b!==v.Q2a&&this.Onj(this.inconsistenciesCount+(b?1:-1));D!==v.mha&&this.Vnj(this.qNb+(D?-1:1))}}else h(v=new Vh),v.STm()&&this.ou.add(b.id,v);return v}Qcg(b,h){({value:h}=this.ou.Dc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Gd.a.mo:!(null===h||void 0===h?0:h.placeholder)&&(b===Gd.a.mo||b===Gd.a.Hn||Array.contains(S.AParagraphNode.Sga(),b))}}Jh.qUi="OnInconsistenciesChanged";Jh.AWi="OnRoleReviewCount";Jh.vVf="OnRoleChanged";
Object(n.a)(Jh,"RoleLifecycleManager",null,[477,478,479]);class ij{constructor(b,h,v,D,Q){this.PXa=b;this.uYb=h;this.Te=v;this.Vp=D;this.gQ=Q;this.Ah=!1;this.aWf=(ba,ta)=>{(ba=ta.data.paragraphNode)?this.NEj(ba,()=>!0,Ta=>Ta.userSetRole=Xe.d(ta.data.DQf)):u.ULS.shipAssertTag(557057378,3016,!1)};this.Dqn=(ba,ta)=>{0<this.gQ.GDm||this.Qcg(ta.property)&&this.NEj(ta.node,Ta=>!(Ta&&Ta.isInvalidated),Ta=>Ta.isInvalidated=!0)}}initialize(){this.Ah||(this.PXa.iqh(this.aWf),this.Vp.Ye(12).Go(this.Dqn),this.Ah=
!0)}Md(){}NEj(b,h,v){if(b=(b=this.uYb.D3h(b))&&1===b.length&&b[0]){var D=b.content;D=D&&D.M_&&D.M_.customMetadata;h(D)&&(h=new uq.RoleDetectionCustomMetadata,h.isInvalidated=D&&D.isInvalidated,h.userSetRole=D&&D.userSetRole,v(h),this.Te.VRo(b,h))}}Qcg(b){return b===Gd.a.mo||b===Gd.a.Hn||Array.contains(S.AParagraphNode.Sga(),b)}}Object(n.a)(ij,"RoleDetectionMetadataUpdater",null,[475]);class gk{constructor(b,h){this.Uje=b;this.jCb=h;this.s_c=(v,D)=>{v=D.data;if(v.Gt==ib.a.getTypeName()||v.Gt==ib.n.getTypeName())if(v=
v.annotation&&v.annotation.content)this.runId=v.runId};this.revisionId=0}initialize(){this.jCb.UF(this.s_c)}Md(){this.jCb.YH(this.s_c)}ekn(){if(void 0===this.runId)Promise.resolve();else{var b=new uq.RoleDetectionSettings({acceptedRunId:this.runId});b=new ib.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Uje.submitOperation(b)}}}Object(n.a)(gk,"RoleDetectionSettingsUpdater",null,[]);class Yh{constructor(b,h,v){this.xCm=
b;this.nQ=h;this.Ud=v;this.Vri=this.initialized=!1;this.nSi=()=>{this.Dpj()&&(this.tqi(),this.nQ.Z_n(this.nSi))}}initialize(){this.initialized||(this.Ozf(),this.initialized=!0)}Md(){}Ozf(){this.Dpj()?this.tqi():this.nQ.vwk(this.nSi)}Dpj(){return!this.Vri&&(this.Ud.vvi()||this.nQ.C$b(uq.DocumentRoleDetectionAnnotation.getTypeName())||this.nQ.C$b(uq.RoleDetectionAnnotation.getTypeName()))}tqi(){for(const b of this.xCm)b.initialize();this.Vri=!0}}Object(n.a)(Yh,"RLMInitializer",null,[]);class bq{constructor(b,
h,v){this.WY=b;this.St=h;this.fed=v;this.W=null;this.fja=()=>{this.VSc();this.St.ynb(this.fja)};if(!b)throw So.a.argument("AppLifecycleManager is null");if(!h)throw So.a.argument("Workspace is null");if(!v)throw So.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>this.jn())}xc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new gk(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").bJ)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new ij(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ree,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",
()=>new Jh(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").C0a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ree,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").bJ,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new Yh([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}jn(){this.fed.wJ?this.WY.xk(16,()=>this.hSc()):this.hSc()}hSc(){this.St.vwa?this.VSc():this.St.ifa(this.fja)}VSc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(n.a)(bq,"PackageManager",null,[1,2]);class gr{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const v=new gr;v.ContractVersion=b;v.FileName=h;v.Paragraphs=[];return v}}Object(n.a)(gr,"DocumentSwayPreviewContent",null,[]);class Ko{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static D5k(b,h,v,D){const Q=
new Ko;Q.RawText=b;Q.ParagraphFormatting=h;Q.TextRuns=v;Q.IsRTL=D;Q.ParagraphIndex=0;return Q}}Object(n.a)(Ko,"ParagraphContent",null,[]);var Ao=c(92),Lp=c(1195);class cq{constructor(){this.Name=null;this.Size=0}static construct(b,h){const v=new cq;v.Name=b;v.Size=h;return v}}Object(n.a)(cq,"FontData",null,[]);class vq{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,v,D,Q,ba){const ta=new vq;ta.IsBold=b;ta.IsUnderline=
h;ta.IsUppercase=v;ta.Font=D;ta.Alignment=Q;ta.LeftIndent=ba;return ta}}Object(n.a)(vq,"TextFormatting",null,[]);class Yn{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const v=new Yn;v.RawText=b;v.RunFormatting=h;return v}}Object(n.a)(Yn,"TextRunContent",null,[]);var Hn=c(101),Cd=c(40);class Aa{constructor(b,h){this.oTb=null;this.$9j=b;this.DN=h||""}get Zxn(){return this.$9j.value}Ayl(){var b=Date.now();const h=gr.construct(2,this.DN);h.Paragraphs=this.mLl();b=Date.now()-
b;const v={};v.ExtractionDurationInMs=b.toString();u.ULS.sendTraceTag(25268374,382,50,"{0}",v);return h}mLl(){const b=new zb.a;var h=0;let v=0,D=!1;var Q=new ne.GraphIterator;Q.set(this.Zxn);Q=nc.a.Zo(Q.currentNode);const ba=new ec.a(0);for(;Q.moveNext()&&2100>v&&25>h;){var ta=Q.currentNode;if(de.ParagraphReader.Vb(ta)&&!de.ParagraphReader.d4(ta)){!D&&de.ParagraphReader.wU(ta)&&(D=!0);let Ta=S.AParagraphNode.IR(ta.characterData);Ta=Ta.trim();if(0<Ta.length){const ob=this.cU(ta);ob.ParagraphIndex=
h;h++;v+=Ta.length;b.add(ob);this.kVo(ba,de.ParagraphReader.language(ta))}}}this.oTb=this.cSl(ba);h={};h.documentHasList=D;u.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}cSl(b){let h=-1,v=1033;for(const D of b.keys.toArray())D&&b.J(D)>h&&(h=b.J(D),v=D);return lk.a.og(v)}kVo(b,h){b.nb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}cU(b){const h=S.AParagraphNode.IR(b.characterData),v=this.s6l(b),D=this.$em(b);b=this.FOm(b);return Ko.D5k(h,v,D,b)}s6l(b){const h=de.ParagraphReader.Rn(b,Gd.a.bold,!1),v=de.ParagraphReader.Rn(b,
Gd.a.underline,!1);var D=de.ParagraphReader.Rn(b,Gd.a.fontSize,Ao.a.nM);const Q=de.ParagraphReader.Rn(b,Gd.a.font,Ao.a.kG);var ba=de.ParagraphReader.Ex(b);ba=this.Rmf(ba);const ta=!!de.ParagraphReader.Rn(b,Ve.a.capitalization,0);b=(new Lp.a).$T(b).value/20;D=cq.construct(Q,D);return vq.construct(h,v,ta,D,ba,b)}$em(b){const h=new zb.a;for(let Q=0;Q<b.pa.length-1;Q++){var v=b.pa.J(Q),D=b.pa.J(Q+1);v.formatting&&(D=S.AParagraphNode.IR(b.characterData.substr(v.cp,D.cp-v.cp)),v=this.afm(v.formatting),
v=Yn.construct(D,v),h.add(v))}return h.toArray()}afm(b){const h=Hn.FormattingReader.uPc(b,Gd.a.bold,!1),v=Hn.FormattingReader.uPc(b,Gd.a.underline,!1);var D=Hn.FormattingReader.uPc(b,Gd.a.fontSize,Ao.a.nM);const Q=Hn.FormattingReader.uPc(b,Gd.a.font,Ao.a.kG);D=cq.construct(Q,D);b=!!Hn.FormattingReader.uPc(b,Ve.a.capitalization,0);return vq.construct(h,v,b,D,5,0)}Rmf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}FOm(b){const h=new ne.GraphIterator;
h.set(b);h.zb(11);return(b=h.jd(11))?Cd.OutlineElementReader.an(b):!1}}Object(n.a)(Aa,"DocumentContentExtractor",null,[349]);class Qa{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}xc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Aa(new Fg.a(()=>Jd.App.un.hb.rc.Yc),w.AFrameworkApplication.us.az)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){N.a.instance.Fc(new Qa)}}Object(n.a)(Qa,"DocumentContentExtractorPackage",
null,[1,2]);class Ca{}Ca.Xg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(n.a)(Ca,"EmbedDialogHtml",null,[]);class ya{constructor(b,h,v,D){this.cfc=b;this.a2a=h;this.F8d=v;this.value=D}}Object(n.a)(ya,"OptionInfo",null,[]);class $a{constructor(b,h,v){this.r9f=b;this.K9b=h;this.a2a=v}}Object(n.a)($a,"SectionInfo",null,[]);var Cb=c(272);class Lb extends Vf.a{constructor(b,
h=!1){super(!1,!1,h);this.Thd=476;this.tUb=288;this.Qxe=798;this.Zek=476;this.Yek=288;this.Z0c={};this.Vnb=[];this.SV=this.oXa=this.Vvb=this.Fsb=this.cqd=this.RXb=null;this.osc=w.AFrameworkApplication.iRc;this.xwb=b;this.ZLe=Object(z.a)(this,this.swn,"optionClickHandler");this.hyc=Object(z.a)(this,this.twn,"optionKeyHandler");this.Tse=Object(z.a)(this,this.JGk,"arrowClickHandler");this.tSb=Object(z.a)(this,this.KGk,"arrowKeyHandler");this.Yvd=Object(z.a)(this,this.sHo,"textAreaOnFocusHandler");this.A8j=
h;this.Xg=Ca.Xg;this.Ad=0;this.wg="EmbedDialog"}get Gs(){return this.tUb}set Gs(b){this.tUb=b}Yrj(b){const h={["id"]:this.wg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:ja.a.lp(this.xwb,"wdPreview","1"),["initialEmbedUrl"]:this.osc,["getEmbedCode"]:Lb.J7h,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};
for(const v of Object.keys(b))h[v]=b[v];this.Ad=1;this.Ee(1,CommonUIStrings.l_CopyAction);this.Ee(0,CommonUIStrings.l_Close);this.Yh(CommonUIStrings.l_Embed,null,h)}Djc(){if(this.A8j)this.Yrj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.RXb=document.getElementById("embedpreviewpane");this.cqd=document.getElementById("embedoptionpane");this.RXb.style.width=String.format("{0}px",this.Zek);this.oXa=document.createElement("iframe");this.oXa.className=Lb.Xek;this.oXa.frameBorder="0";this.oXa.style.height=
String.format("{0}px",this.Yek);this.oXa.tabIndex=-1;this.RXb.appendChild(this.SGd(CommonUIStrings.l_Preview,this.oXa,Lb.Kah,Lb.Jah,Lb.Kah,!0));this.SV=document.createElement("textarea");this.SV.className=Lb.k1j;Sys.UI.DomElement.addCssClass(this.SV,Cb.a.j0e);this.SV.id=Lb.fTg;aa.a.ui||(this.SV.readOnly=!0);this.SV.rows=4;this.SV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.SV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.SV.setAttribute(Ze.a.qfa,String.format("{0} {1}",
Lb.eTg,Lb.dTg));this.RXb.appendChild(this.SGd(CommonUIStrings.l_EmbedCode,this.SV,Lb.eTg));lf.a.addHandler(this.SV,"focus",this.Yvd);var b=document.createElement("span");b.className=Lb.W2j;b.innerText=CommonUIStrings.l_CopyText;b.id=Lb.dTg;this.RXb.appendChild(b);this.Fsb=document.createElement("div");this.Fsb.className=Lb.r0j;this.cqd.appendChild(this.SGd(CommonUIStrings.l_Dimensions,this.Fsb));this.Vvb=document.createElement("div");this.cqd.appendChild(this.Q8k(Lb.A9g,this.Vvb));this.Ad=0;this.Ee(1,
CommonUIStrings.l_Close);this.Tlg();this.DGj();aa.a.ui||this.SV.focus()}}dispose(){if(this.Z0c){var b=this.Z0c;for(let h in b){const v=b[h];this.Lq.uc(Sc.a.click,v.cfc,this.ZLe);this.ae.uc(Sc.a.fi,v.cfc,this.hyc);this.ae.uc(Sc.a.uh,v.cfc,this.hyc)}this.hyc=this.ZLe=this.Z0c=null}if(this.Vnb){for(b=0;b<this.Vnb.length;++b)this.Lq.uc(Sc.a.click,this.Vnb[b].K9b,this.Tse),this.ae.uc(Sc.a.fi,this.Vnb[b].K9b,this.tSb),this.ae.uc(Sc.a.eu,this.Vnb[b].K9b,this.tSb),this.ae.uc(Sc.a.uh,this.Vnb[b].K9b,this.tSb);
this.ae=this.Tse=this.Vnb=null}this.Yvd&&this.SV&&(lf.a.removeHandler(this.SV,"focus",this.Yvd),this.Yvd=null);this.SV=this.oXa=this.Vvb=this.Fsb=this.cqd=this.RXb=null;super.dispose()}Qca(){super.Qca();this.Hc.style.width=String.format("{0}px",this.Qxe);this.GCa()}MTo(b,h){const v=ja.a.lp(this.osc,b,h);return this.osc!==v?(this.osc=v,this.xwb=ja.a.lp(this.xwb,b,h),!0):!1}Tlg(){this.SV&&(this.SV.innerText=Lb.J7h(this.osc,this.Thd,this.tUb))}DGj(){this.oXa&&this.oXa.contentWindow.location.replace(ja.a.lp(this.xwb,
"wdPreview","1"))}qne(b,h){this.MTo(b,h)&&(this.Tlg(),this.DGj())}SGd(b,h,v=null,D=null,Q=null,ba=!1){const ta=document.createElement("div");ta.className=Lb.Ghk;D&&(ta.id=D);Q&&ta.setAttribute(Ze.a.qfa,Q);ba&&(ta.tabIndex=0);D=document.createElement("span");D.className=Lb.Hhk;D.innerText=b;v&&(D.id=v);ta.appendChild(D);ta.appendChild(h);return ta}Q8k(b,h){const v=this.SGd(CommonUIStrings.l_Interaction,h),D=this.ej.createElement("div");D.className=Lb.$Vj;D.id=Lb.zLg+b;D.setAttribute(Ze.a.qh,Ze.a.f3);
D.tabIndex=0;v.insertBefore(D,h);b=pd.createClusteredImage(16,16,Lb.aWj,Lb.bWj,!0,"");D.appendChild(b);b=b.childNodes[0];b.className=pd.getImageClass(Lb.wSg);b.title=CommonUIStrings.l_Expand;D.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new $a(h,D,b);Array.add(this.Vnb,h);this.Lq.eE(Sc.a.click,D,this.Tse,h);this.ae.eE(Sc.a.fi,D,this.tSb,h);this.ae.eE(Sc.a.eu,D,this.tSb,h);this.ae.eE(Sc.a.uh,D,this.tSb,h);return v}JGk(b){this.CBh(b);return!0}KGk(b){return this.FWc(b,Object(z.a)(this,
this.CBh,"changeArrowState"))}CBh(b){b=b.Ro;"visible"===b.r9f.style.visibility?(b.r9f.style.visibility="hidden",b.a2a.className=pd.getImageClass(Lb.wSg),b.a2a.title=CommonUIStrings.l_Expand,b.K9b.title=CommonUIStrings.l_Expand):(b.r9f.style.visibility="visible",b.a2a.className=pd.getImageClass(Lb.Umk),b.a2a.title=CommonUIStrings.l_Collapse,b.K9b.title=CommonUIStrings.l_Collapse)}iKh(b,h){const v=document.createElement("div");v.className=Lb.x9g;v.id=b+Lb.y9g;var D=this.ej.createElement("div");D.tabIndex=
0;D.className=Lb.TNg;D.id=b+Lb.Opc;D.setAttribute(Ze.a.qh,Ze.a.R1e);D.setAttribute(Ze.a.rCa,Ze.a.np);D.setAttribute(Ze.a.qfa,b+Lb.RTb);v.appendChild(D);v.setAttribute(Ze.a.qh,Ze.a.$y);var Q=pd.createClusteredImage(16,16,Lb.ZNg,Lb.YNg,!0,"");D.appendChild(Q);Q=Q.childNodes[0];Q.id=b+Lb.z9g;Q.className=pd.getImageClass(Lb.Pue);D=new ya(v,Q,D,1);this.Z0c[b]=D;this.Lq.eE(Sc.a.click,v,this.ZLe,b);D=document.createElement("span");D.className=Lb.RTb;D.innerText=h;D.id=b+Lb.RTb;v.appendChild(D);this.ae.eE(Sc.a.fi,
v,this.hyc,b);this.ae.eE(Sc.a.uh,v,this.hyc,b);return v}swn(b){this.HYi(b);return!0}twn(b){return this.FWc(b,Object(z.a)(this,this.HYi,"optionHandler"))}HYi(b){const h=this.Z0c[b.Ro.toString()];h.value?(h.value=0,h.a2a.className=pd.getImageClass(Lb.KVe),h.F8d.setAttribute(Ze.a.rCa,Ze.a.fM)):(h.value=1,h.a2a.className=pd.getImageClass(Lb.Pue),h.F8d.setAttribute(Ze.a.rCa,Ze.a.np));this.qne(b.Ro.toString(),h.value.toString())}sHo(){this.SV.select()}static J7h(b,h,v){if(!Lb.EKe){const D=String.format('<a target="_blank" href="{0}">{1}</a>',
G.a.C9b("https://office.com"),CommonUIStrings.l_Office),Q=String.format('<a target="_blank" href="{0}">{1}</a>',G.a.C9b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Lb.EKe=String.format(CommonUIStrings.l_NoFrames,D,Q)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',G.a.C9b(b),h,v,Lb.EKe)}}Lb.EKe=null;Lb.Pue="CheckboxChecked_16x16x32";Lb.KVe="CheckboxUnchecked_16x16x32";Lb.Umk="OutlookSearchChevronUp_16x16x32";Lb.wSg="OutlookSearchChevronDown_16x16x32";
Lb.ZNg="CommentChecked";Lb.aWj="UpArrowServer";Lb.RTb="EmbedDescription";Lb.Ghk="EmbedSectionHeader";Lb.Hhk="EmbedSectionName UIFontBold";Lb.W2j="EmbedCodeFooter";Lb.YNg="EmbedOptionImage";Lb.Xek="EmbedPreviewFrame";Lb.k1j="EmbedCodeTextArea";Lb.x9g="EmbedOption";Lb.r0j="EmbedDimensionSection";Lb.bWj="EmbedArrowIcon";Lb.$Vj="WACGlyph EmbedArrowHolder";Lb.TNg="EmbedCheckBoxHolder";Lb.y9g="Option";Lb.z9g="OptionImage";Lb.fTg="EmbedCode";Lb.eTg="EmbedCodeHeader";Lb.Kah="Preview";Lb.Jah="PreviewHeader";
Lb.A9g="Options";Lb.zLg="Arrow";Lb.Opc="Check";Lb.dTg="EmbedCodeFooter";Object(n.a)(Lb,"EmbedDialog",Vf.a,[]);class hc extends ya{constructor(b,h,v,D,Q){super(b,h,v,D);this.j2a=Q}}Object(n.a)(hc,"OptionInputInfo",ya,[]);class Fc extends Lb{constructor(b,h){super(b,Fc.yL);this.taa=null;this.Grc=[];this.Rud=Object(z.a)(this,this.lBo,"startOnOptionClickHandler");this.uZb=Object(z.a)(this,this.mBo,"startOnOptionKeyHandler");this.uqd=Object(z.a)(this,this.uqn,"onPageNumberChanged");this.bye=Object(z.a)(this,
this.Bmn,"onDimensionChanged");this.eH=h}Djc(){if(Fc.yL){var b=Fc.IOn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.eH.L2i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.eH.I7i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.eH.Buj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.eH.Cuj}});this.Yrj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.Thd,["defaultHeight"]:this.tUb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.eH.dKj,["heightLabel"]:this.eH.Wmi},["interactionOptions"]:h})}else super.Djc(),this.nnh(this.eH.dKj,"EmbedWidthInput",this.Thd),this.nnh(this.eH.Wmi,"EmbedHeightInput",this.tUb),this.Vvb.appendChild(this.iKh("wdPrint",this.eH.L2i)),this.Vvb.appendChild(this.iKh("wdEmbedCode",this.eH.I7i)),this.Cqk(this.eH.Buj),this.GCa(),$c.FocusManager.$J()&&(b=$c.FocusManager.instance(),h=[document.getElementById(Lb.fTg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Lb.zLg+Lb.A9g),document.getElementById("wdPrint"+Lb.Opc),document.getElementById("wdEmbedCode"+Lb.Opc),document.getElementById("wdStartOn"+Lb.Opc),document.getElementById("wdStartOnText"),document.getElementById(ml.a.wdd),document.getElementById(Lb.Jah)],h=new $d(h),b.Ss().Zj=h,aa.a.ui?this.R0(document.getElementById(ml.a.wdd)):this.SV.select())}dispose(){if(!Fc.yL){if(this.Grc){for(let b=
0;b<this.Grc.length;++b)lf.a.removeHandler(this.Grc[b],"change",this.bye);this.Grc=this.bye=null}this.uqd&&(lf.a.removeHandler(this.taa.j2a,"change",this.uqd),this.uqd=null);this.Rud&&(this.Lq.uc(Sc.a.click,this.taa.cfc,this.Rud),this.Rud=null);this.uZb&&(this.ae.uc(Sc.a.fi,this.taa.cfc,this.uZb),this.ae.uc(Sc.a.uh,this.taa.cfc,this.uZb),this.uZb=null);this.taa=null}super.dispose()}nnh(b,h,v){const D=document.createElement("label");D.className="EmbedInputPrefix";D.innerText=b;this.Fsb.appendChild(D);
b=document.createElement("input");b.className=h;b.id=h;b.value=v.toString();b.type="text";b.setAttribute("data-lpignore","true");D.setAttribute("for",h);this.Fsb.appendChild(b);this.Grc.push(b);lf.a.addHandler(b,"change",this.bye);this.Fsb.appendChild(document.createElement("br"))}Bmn(b){"EmbedWidthInput"===b.target.id?this.Thd=this.iKd(b.target,375):this.tUb=this.iKd(b.target,250);this.Tlg()}iKd(b,h){let v=parseInt(b.value);if(isNaN(v)||v<h)v=h;b.value=v.toString();return v}uqn(b){b=this.iKd(b.target,
1);1===this.taa.value&&this.qne("wdStartOn",b.toString())}Cqk(b){const h=document.createElement("div");h.className=Lb.x9g+" EmbedInlineOption";h.id="wdStartOn"+Lb.y9g;const v=this.ej.createElement("div");v.tabIndex=0;v.className=Lb.TNg;v.id="wdStartOn"+Lb.Opc;v.setAttribute(Ze.a.qh,Ze.a.R1e);v.setAttribute(Ze.a.rCa,Ze.a.fM);v.setAttribute(Ze.a.qfa,"wdStartOn"+Lb.RTb);h.appendChild(v);h.setAttribute(Ze.a.qh,Ze.a.$y);var D=pd.createClusteredImage(16,16,Lb.ZNg,Lb.YNg,!0,"");v.appendChild(D);D=D.childNodes[0];
D.id="wdStartOn"+Lb.z9g;D.className=pd.getImageClass(Lb.KVe);const Q=document.createElement("span");Q.className=Lb.RTb;Q.innerText=b;Q.id="wdStartOn"+Lb.RTb;h.appendChild(Q);this.Vvb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.eH.Cuj;b.setAttribute("data-lpignore","true");this.Vvb.appendChild(b);lf.a.addHandler(b,"change",this.uqd);this.taa=new hc(h,D,v,0,b);this.qne("wdStartOn","1");this.Lq.mb(Sc.a.click,h,this.Rud);
this.ae.mb(Sc.a.fi,h,this.uZb);this.ae.mb(Sc.a.uh,h,this.uZb)}lBo(b){this.zuj(b);return!0}mBo(b){return this.FWc(b,Object(z.a)(this,this.zuj,"startOnOptionHandler"))}zuj(){let b=1;this.taa.value?(this.taa.value=0,this.taa.a2a.className=pd.getImageClass(Lb.KVe),this.taa.F8d.setAttribute(Ze.a.rCa,Ze.a.fM)):(this.taa.value=1,this.taa.a2a.className=pd.getImageClass(Lb.Pue),b=this.iKd(this.taa.j2a,1),this.taa.F8d.setAttribute(Ze.a.rCa,Ze.a.np));this.qne("wdStartOn",b.toString())}static get yL(){return w.AFrameworkApplication.ta.Nb.lF}static IOn(b,
h,v,D=null){if("wdPrint"===h||"wdEmbedCode"===h)return ja.a.lp(b,h,v?"1":"0");if("wdStartOn"===h){let Q="1";v&&D&&(D=parseInt(D),!isNaN(D)&&1<=D&&(Q=D.toString()));return ja.a.lp(b,h,v?Q:"1")}return b}}Object(n.a)(Fc,"WordEmbedDialog",Lb,[]);class Kc{constructor(b,h,v,D,Q){this.nea=null;this.ga=b;this.eab=h;this.JP=v;this.eH=D;this.tra=Q}Tb(){this.ga.qa(this.JP,Kd.a.frame,Object(z.a)(this,this.Ouo,"showEmbedCode"));this.eab.execute(Object(z.a)(this,this.STf,"onHostPostmessengerCreated"))}STf(b){u.ULS.shipAssertTag(4994850,
332,!!b);this.nea=b;w.AFrameworkApplication.gha||(this.nea.Av(L.a.nAh),this.nea.OB(L.a.nAh,Object(z.a)(this,this.Djc,"showEmbedDialog")))}Djc(b){b=b.Values.HostEmbeddedViewUrl.toString();w.AFrameworkApplication.iRc=b;this.tra.Sgf=b;(new Fc(b,this.eH)).Djc()}Ouo(b,h,v){if(2===v)if(w.AFrameworkApplication.iRc)(new Fc(this.tra.Sgf,this.eH)).Djc();else return w.AFrameworkApplication.Rm.d2a(Kc.sNj),w.AFrameworkApplication.png&&this.nea.sendMessage(L.a.nAl,null)?32:w.AFrameworkApplication.ta.HU(!0,w.AFrameworkApplication.wjf);
return 32}}Kc.sNj=10381;Object(n.a)(Kc,"EmbedActor",null,[]);class hd{}Object(n.a)(hd,"WordEmbedDialogStrings",null,[]);var qd=c(219);class sd extends Kc{constructor(b,h){super(b,h,sc.a.Udg,Object.assign(new hd,{dKj:WordEditorIntl.WordEditorStrings.l_Width,Wmi:WordEditorIntl.WordEditorStrings.l_Height,L2i:WordEditorIntl.WordEditorStrings.l_PrintOption,I7i:WordEditorIntl.WordEditorStrings.l_ReembedOption,Buj:WordEditorIntl.WordEditorStrings.l_StartOnOption,Cuj:WordEditorIntl.WordEditorStrings.l_StartPage}),
qd.WoncaApp.instance)}}Object(n.a)(sd,"EmbedActor",Kc,[]);class vd{constructor(){this.W=null}get name(){return"WordEditor.Embed"}xc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new sd(w.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Tb()}dispose(){}}Object(n.a)(vd,"EmbedPackage",null,[1,2]);class we{constructor(b,h,v){this.Zv=this.cKa=this.nMa=null;this.RJa=0;this.cWb=this.XVb=this.JVb=this.lWb=this.WVa=
this.VVa=!1;this.Oj=b;this.Wm=v}ZO(b){return Ya.App.xa.hb.isEditingAllowed?""!==this.iOc(b.zf):!1}kL(b){if(!this.ZO(b))return!1;this.dgo(b);this.ego();this.fgo();this.nMa=b.$H;this.Zv=new Sys.UI.Point(0,0);u.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}IU(b){this.cKa=b.$H;this.YPk();this.Oj.xFj(this.Zv.x,this.Zv.y,this.lWb,this.JVb,this.XVb,this.cWb,!1);return!0}$D(){this.Oj.xFj(this.Zv.x,this.Zv.y,this.lWb,this.JVb,this.XVb,this.cWb,!0);u.ULS.sendTraceTag(22381024,322,50,
"Image Crop drag succeeded")}sY(){this.Oj.RSk();u.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}ego(){this.cWb=this.XVb=this.JVb=this.lWb=!1;switch(this.RJa){case 1:this.lWb=!0;break;case 5:this.JVb=!0;break;case 3:this.cWb=!0;break;case 7:this.XVb=!0;break;case 0:this.XVb=this.lWb=!0;break;case 2:this.cWb=this.lWb=!0;break;case 6:this.XVb=this.JVb=!0;break;case 4:this.cWb=this.JVb=!0}}fgo(){this.WVa=this.VVa=!1;switch(this.RJa){case 0:this.WVa=this.VVa=!0;break;case 1:case 2:this.WVa=
!0;break;case 7:case 6:this.VVa=!0}}iOc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const v=b[h].toString();if(v.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==v)return v}return""}dgo(b){switch(this.iOc(b.zf)){case "WACImageCropHandleNW":this.RJa=0;break;case "WACImageCropHandleN":this.RJa=1;break;case "WACImageCropHandleNE":this.RJa=2;break;case "WACImageCropHandleE":this.RJa=3;break;case "WACImageCropHandleSE":this.RJa=
4;break;case "WACImageCropHandleS":this.RJa=5;break;case "WACImageCropHandleSW":this.RJa=6;break;case "WACImageCropHandleW":this.RJa=7}}YPk(){var b=1;this.Wm.instance&&(b=this.Wm.instance.hj);const h=(this.cKa.x-this.nMa.x)/b;b=(this.cKa.y-this.nMa.y)/b;this.Zv.x=this.VVa?-h:h;this.Zv.y=this.WVa?-b:b}}Object(n.a)(we,"ImageCropDragAdapter",null,[138]);class te{constructor(b,h){this.ga=b;this.Wm=h}dZl(b){return new we(b,this.ga,this.Wm)}}Object(n.a)(te,"ImageCropDragAdapterFactory",null,[344]);var xe=
c(296),ye=c(239),qe=c(41),ff=c(438),Lf=c(693),Oe=c(84),Fe=c(60),Jf=c(401),ni=c(974),If=c(511),ai=c(897),bi=c(137),jf=c(359),sj=c(246),sn=c(860),sk=c(205),dh=c(81),Ig=c(21),$o=c(280),jm=c(769),es=c(373),Km=c(114);class Yj{constructor(b,h,v,D,Q,ba,ta,Ta,ob=null){this.Xb=ob;this.MSc=null;this.tK=b;this.nh=h;this.Gc=v;this.Ks=D;this.Kd=Q;this.ib=ba;this.Tm=ta;this.xE=Ta}get $W(){return null!=this.jwg?this.jwg:this.jwg=Ga.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get wc(){return null!=
this.vJg?this.vJg:this.vJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get nf(){return bi.PageReader.instance}nio(b,h,v){const D=this.Gc.Oc(15);D.Cb(h.node);this.XSa(b,v);D.dispose()}mio(b,h,v){const D=this.Gc.Oc(15);D.Cb(h.node);this.ZNb(b,v);D.dispose()}XSa(b,h){b.setValue(Gd.a.imageAltText,h)}ZNb(b,h){b.setValue(lc.a.UX,h)}uio(b,h){b.setValue(Gd.a.Bib,h)}Xkj(b,h){var v=ke.ImageReader.mk(b);Ya.App.instance&&Ya.App.instance.f4(v)?(v=b.ia(qe.a.G5d,null),h=jm.a.Ebl(h,v),b.setValue(qe.a.G5d,
h)):b.setValue(lc.a.VX,h)}qio(b,h,v,D,Q){let ba=0;var ta=0;({width:ba,height:ta}=ke.ImageReader.yhb(b));ta-=(h+v)/1E5*ta;this.vHa(b,ba-(D+Q)/1E5*ba);this.uHa(b,ta);this.plj(b);b.setValue(lc.a.HRc,h);b.setValue(lc.a.ERc,v);b.setValue(lc.a.FRc,D);b.setValue(lc.a.GRc,Q)}mmo(b,h,v,D){const Q=this.Gc.Oc(15);Q.Cb(h.node);this.Yfe(b,v,D);Q.dispose()}Yfe(b,h,v){this.vHa(b,h);this.uHa(b,v);this.plj(b);b.removeProperty(wc.a.a$d);b.removeProperty(wc.a.Z9d)}vHa(b,h){b.setValue(Gd.a.zha,h);b.setValue(wc.a.NEa,
-1)}uHa(b,h){b.setValue(Gd.a.yha,h);b.setValue(wc.a.MEa,-1)}gE(b,h){b.setValue(lc.a.dRc,h);b.setValue(Gd.a.Kh,h);b.setValue(Gd.a.ar,h)}ano(b,h){b.setValue(lc.a.TPb,h)}jfo(b,h){b.setValue(lc.a.Z2e,h)}eno(b){if(!ke.ImageReader.g4(b)&&b.el){var h=b.node;if(ke.ImageReader.C8(h)){const Q=this.Gc.Oc(15);Q.Cb(b.node);b=ne.GraphIterator.$a(h);b.zb(12);b=b.parentNode;var v=b.properties.Hf(lc.a.jq),D=h.properties.getValue(lc.a.runId);h.ia(lc.a.Lc,Vm.a.dS);const ba=b.pa,ta=[lc.a.dRc,Gd.a.Kh,Gd.a.ar,lc.a.Z2e,
lc.a.TPb,lc.a.dZa];Ya.App.instance&&Ya.App.instance.f4(ke.ImageReader.mk(h))&&ta.push(qe.a.Zvf,qe.a.Yvf);h.Eg.apply(h,ta);v=this.Jof(D,v,ba);D=Pe.a.Rc(b,v);this.Ks.qIh(h,D);(h=this.xE.LK(b,v,v+1))&&this.ib.setSelection(h);this.$W.iqa(b,v,v+1);Q.dispose()}}}E$f(b,h){if(b.properties.hasProperty(lc.a.m7)){const v=b.properties.Hf(lc.a.m7);v.push(h);b.properties.setValue(lc.a.m7,Array.clone(v))}else b.properties.setValue(lc.a.m7,[h])}khe(b,h,v=0,D=!1){if(b.el){var Q=this.Gc.Oc(15),ba=b.node;Q.Cb(ba);if(ke.ImageReader.g4(b)){const Kb=
this.Xb&&this.Xb.isFeatureEnabled(46)?new ai.a:new If.a;Kb.Vw(ke.ImageReader.Zm(b));var ta=ba.pa,Ta=this.dCl(b.cpBegin,ta);this.UFk(b.cpEnd,ta,Ta)&&u.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ta=ta.J(Ta).blob;Ta=ta.pe;var ob=ba.properties.Hf(lc.a.jq);ob=this.hOn(ob);Ta=ob[Ta];ob=ba.ia(lc.a.Lc,Vm.a.dS);if(ta=Object(Ka.a)(ni.ImageBlobObject,ta))ta.zOb=!1;this.Kd.replaceTextRange(b,"");ta&&(ta.zOb=!0);Kb.properties.setValue(lc.a.runId,Ta);Kb.properties.setValue(lc.a.Lc,
ob);b=ne.GraphIterator.$a(ba);b.zb(12);b.Jf(Kb,6);this.E$f(b.currentNode,Kb.anchor.node.id);ba=Kb}v&&this.gE(ba.properties,v);this.jfo(ba.properties,D);this.ano(ba.properties,h);this.$W.Fic(ba);(h=this.xE.uq(ba))&&this.ib.setSelection(h);Q.dispose()}}Z8f(b,h){if(!(0>=h)){var v=Cf.a.Tl(h,0),D=ke.ImageReader.dF(b),Q=ke.ImageReader.wG(b);D>v&&(Q*=v/D,this.vHa(b,v),this.uHa(b,Q),u.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}UFk(b,h,v){const D=
h.length;if(v>=D||!h.J(v).tf)return!1;const Q=new wl.a;for(;v<D;v++){const ba=h.J(v);if(ba.cp>b||!ba.tf)break;for(let ta=0;ta<ba.tf.length;ta++){if(Q.contains(ba.tf.J(ta).Xj))return!0;Q.add(ba.tf.J(ta).Xj)}}return!1}hOn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var v=0;v<b.length;)b[v]=v+1,v++;else{var D=b[h];v=h-1;for(var Q=D-1;0<=v;)b[v]=Q,v--,Q--;Q=0;for(v=h+1;v<b.length;)(h=b[v])?h<D?(D=h+Q,b[v]=D):D=h:(Q+=2,D++,b[v]=D),v++}return b}ikf(b,h){let v=0;for(;v<h.length&&!(b<h[v]);)v++;
return v}Jof(b,h,v){let D=0;const Q=this.ikf(b,h);let ba=0;if(Q===h.length)ba=v.length-1;else for(;ba<v.length;){h=v.J(ba);if(h.formatting&&h.formatting.pe===Q)break;ba++}ba<v.length?D=v.J(ba).cp:u.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ba,["RunId"]:b,["CharacterPropertiesArrayLength"]:v.length});return D}dCl(b,h){let v=0;for(;v<h.length&&h.J(v).cp!==b;)v++;v===h.length&&u.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:v,["CharacterPropertiesArrayLength"]:h.length});return v}plj(b){b.setValue(Gd.a.Hwa,!0)}K$d(b,h,v,D=!1){h&&v?(h=Math.max(h,Lf.a.VNi),v=Math.max(v,Lf.a.VNi)):v=h=Lf.a.VOh;b.setValue(Gd.a.zha,Cf.a.Tl(h,0));b.setValue(Gd.a.yha,Cf.a.Tl(v,1));b.setValue(Gd.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Ve.a.O_,1);b.setValue(lc.a.lha,D)}yWd(){return null}zSh(b,h,v){let D=null;h=({OJb:D}=this.ASh(b,h,v)).returnValue;D&&b.view.lb.setSelection(D);return h}ASh(b,h,v){var D=
null;if(!this.Afa(b))return{returnValue:null,OJb:D};var Q=b.view;const ba=this.Gc.Oc(15,Eb.a.CGb);ba.Cb(Q.Yc);h||(h=new fh.DictionaryPropertySet);h.setValue(wc.a.Oql,!0);let ta=Q.lb.tg;var Ta=new sn.a;if(!We.SelectionEditor.gf(ta)){if(2===w.AFrameworkApplication.va.processAction(Eb.a.Kma,2))return ba.dispose(),{returnValue:null,OJb:D};ta=Q.lb.tg}else if(ta.el&&de.ParagraphReader.Vb(ta.node)){Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(ta.node);Q=Hn.FormattingReader.Kr(ta);if(!Q)return ba.dispose(),{returnValue:null,
OJb:D};Q.cache.DB&&(Q=Q.Ef(null),Yj.Sn.X4(Q));Ta.formatting=Q.Qj;Ta.languageId=Hn.FormattingReader.language(Q);Ta.cra=this.wc.No(ta.node)}if(!ta.el)return ba.dispose(),{returnValue:null,OJb:D};if(!this.wAf(b.$j,h))return ba.dispose(),this.MSc=null,{returnValue:null,OJb:D};b=this.MSc;this.MSc=null;1===b.location?(D=b.node,h=es.a.instance.evf(D),ig.OutlineElementNavigator.Ur(h,!1,!1)||(sk.OutlineNavigator.fee(h),this.tK.o7(h,!0,Ta)),ig.OutlineElementNavigator.Ge(h),rh.TableReader.isTable(h)&&(Object(yb.a)(Km.a,
h)||Object(yb.a)(jf.a,h)?(Ta=new ne.GraphIterator,Ta.set(h.currentNode),Ig.moveToCellContent(Ta,0,0),h.set(Ta.currentNode)):Ig.moveToCellContent(h,0,0),Cd.OutlineElementReader.Dh(h)?ig.OutlineElementNavigator.Ge(h):h=es.a.instance.evf(D)),D=de.ParagraphReader.Xt(h.currentNode)?this.xE.ue(h.currentNode,0):this.xE.uq(h.currentNode)):b.location||(Ta=b.blob.Ib.cp+1,D=this.xE.LK(b.node,Ta-1,Ta));ba.TFa(v,1);ba.fk=Eb.a.CGb;ba.dispose();return{returnValue:b,OJb:D}}wAf(){return!1}Afa(b){b.contextId===Zb.a.view&&
b.view.qe&&b.view.lb&&(b=b.view.lb.tg);if(!b)return Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.noSelection}),!1;if(Yj.Xf.j_(b))return Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.RE}),!1;if(Yj.Xf.nha(b))return Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.ori}),!1;if(this.Tm&&this.Tm.instance&&this.Tm.instance.tU(b))return Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.externalSelection}),!1;if(this.nf.b4)return Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.compatMode}),!1;if(b.el)return dh.OutlineReader.xZd(b)?(Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.u9e}),
!1):ke.ImageReader.rYd(b)?(Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.m9e}),!1):$o.c(b)?(Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.n9e}),!1):sj.a.eDf(b)?(Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.l9e}),!1):de.ParagraphReader.oU(b)||ke.ImageReader.UEm(b)?(Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),!1):!0;if(Jf.a.tEf(b)){let h=!0;for(let v=0;v<b.length;++v){const D=b.getContext(v);if(!D.el)return!1;h&&!de.ParagraphReader.oU(D)&&(h=!1)}return h?(Yj.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),!1):!0}return!1}d5f(b,h){const v=this.Gc.Oc(7);
v.Cb(b);if(12===b.type){h=h.Ib.cp;var D=de.ParagraphReader.textLength(b);D=Pe.a.nO(h,h+1,h+1===D?!0:!1,b);this.Kd.replaceTextRange(D,"");b=Pe.a.Rc(b,h);this.ib.setSelection(Mg.SelectionFactory.io(b))}else this.nh.WGa(b);v.dispose()}static get Sn(){return null!=Yj.Rzg?Yj.Rzg:Yj.Rzg=Ga.a.instance.resolve("Box4.IFormattingEditor")}static get Xf(){return xi.a.instance}static get Ic(){return Ye.a.instance}}Object(n.a)(Yj,"ImageEditor",null,[343]);class Mp{constructor(b,h,v,D=0){this.node=b;this.blob=h;
this.location=v;this.mU=D}}Object(n.a)(Mp,"InsertPictureResult",null,[]);var In=c(817),fs=c(285),op=c(1179);class tk extends Yj{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc){super(b,h,v,D,Q,ba,ta,Ta,Oc);this.p_j="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.Q9a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.gK=this.JKa=this.jAa=null;this.Zja=Array(8);this.Jkd=this.EAa=null;this.KKa=!1;this.Ikd=this.yDe=null;this.qgd=this.Bhd=!1;this.FS=this.ES=this.CS=this.GS=this.NV=this.MV=this.LV=this.OV=this.hW=this.iW=0;this.vY=()=>{this.KKa&&this.jhf()};this.qxa=gd=>{this.KKa&&gd.Gb.keyCode!==zf.a.Bs&&this.jhf(!0);return!1};this.SYg=Dc;ba.Pw(this.vY);this.ae=bc;this.b2=xe.a.instance;this.ga=w.AFrameworkApplication.va;this.Sd=Kb;this.qq=ob;this.ld=Oc}pge(b,h,v,D,Q){b.hasProperty(wc.a.MQa)&&b.removeProperty(wc.a.MQa);
const ba=Array(4);ba[0]=h;ba[1]=v;ba[2]=D;ba[3]=Q;b.setValue(lc.a.Nca,ba)}NYn(b){b.setValue(lc.a.PEa,0);b.setValue(lc.a.kLb,"");this.pge(b,0,0,0,0)}yag(b,h,v,D,Q){b.setValue(lc.a.HRc,h);b.setValue(lc.a.ERc,v);b.setValue(lc.a.FRc,D);b.setValue(lc.a.GRc,Q)}rge(b,h,v,D){b.setValue(lc.a.qJ,h);b.setValue(lc.a.CQc,v);b.setValue(lc.a.OQc,D);b.setValue(wc.a.qJ,-1)}wWd(b,h){b=b.node;const v=ne.GraphIterator.$a(b);if(de.ParagraphReader.Vb(b)&&de.ParagraphReader.isEmpty(v)){var D=b.properties.Hf(lc.a.Lc);h.setValue(lc.a.Lc,
D);h.setValue(lc.a.runId,1);D=new op.a;h&&D.Vw(h);v.Jf(D,6);this.E$f(b,D.anchor.node.id);this.$W.Fic(D);return new Mp(D,null,3)}return null}yWd(b,h){var v=In.a.instance.Mcd;h&&v.Vw(h);v.setValue(lc.a.imageType,1);let D=0;D=ye.a.tF();v.setValue(lc.a.mU,D);const Q=b.node.Jc.Lu(v,v.id);v=this.Kd.Zga(b,ba=>new ni.ImageBlobObject(ba,Q));fs.GraphTransactionManager.instance.yTf(b.node);if(this.Sd.rg){const ba=new ah.GraphTransaction(15);ba.Cb(b.node);this.qq.pqa(b.node,b.cpBegin,b.cpBegin+1,1,null);ba.dispose()}this.$W.dNa&&
!h.ia(lc.a.lha,!1)&&this.$W.iqa(b.node,b.cpBegin,b.cpBegin+1);return new Mp(b.node,v,0,D)}wAf(b,h){if(!this.Afa(b))return!1;const v=this.Gc.Oc(7);v.Cb(b.node);w.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ia(lc.a.zti,!1)?this.MSc=this.wWd(b,h):this.MSc=this.yWd(b,h);v.dispose();return!0}Xgc(b,h,v,D){if(!v.Vb(b))return!1;v=this.Gc.Oc(7,Eb.a.tkm);v.Cb(b);var Q=b.properties.ia(Gd.a.zm,[]);Q.push(0);for(const ba of Q)if((Q=D.unf(b,ba))&&5===Q.Bh&&Q.id.equals(h))return this.Kd.replaceTextRange(Pe.a.createTextRange(b,
ba,ba+1),""),v.dispose(),!0;v.dispose();u.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}aYn(b,h,v,D){if(!ke.ImageReader.C8(b))return!1;h.set(b);h.zb(12);const Q=h.Xn(12);if(!Q)return u.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(v.WUc(Q))return u.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;D(b);v=this.Gc.Oc(7);v.Cb(b);h.Cg();v.dispose();return!0}I2n(b,h,v,D){return ke.ImageReader.x2a(b)?this.w2n(b,v):ke.ImageReader.g4(b)?this.L2n(b,h,v,D):null}L2n(b,h,v,D){const Q=In.a.instance.Mcd;v&&Q.Vw(v);v=0;v=ye.a.tF();Q.setValue(lc.a.mU,v);v=b.node.Jc;b=b.node;D=D.eNc(b,5);for(const ba of D)if(ba.id.equals(h)){this.Kd.replaceTextRange(Pe.a.createTextRange(b,ba.Ib.cp,ba.Ib.cp+1),"");const ta=v.Lu(Q,Q.id);h=Pe.a.Rc(b,ba.Ib.cp);this.Kd.Zga(h,Ta=>new ni.ImageBlobObject(Ta,ta));return Q}return null}w2n(b,
h){if(!ke.ImageReader.x2a(b))return null;h.setValue(lc.a.mU,ye.a.tF());b=b.node;var v=b.anchor.node.id;b=ne.GraphIterator.$a(b);b.zb(12);const D=b.parentNode;let Q;D.properties.hasProperty(lc.a.m7)?(Q=D.properties.Hf(lc.a.m7),v=W.a.indexOf(Q,v),-1!==v&&Array.removeAt(Q,v)):Q=[];D.properties.setValue(lc.a.m7,Array.clone(Q));b.Cg();v=this.ld&&this.ld.isFeatureEnabled(46)?new ai.a:new If.a;v.Vw(h);b.Jf(v,6);this.E$f(D,v.anchor.node.id);return v}r$c(b,h){this.KKa?this.jhf():this.MAo(b,h)}wio(b,h){b.setValue(wc.a.qJ,
h)}hZl(b){let h=null,v=null;if(!b)return u.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,vj:v};if(!Ob.InteractiveViewManager.instance.Bd)return u.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,vj:v};const D=b.node;if(!D)return u.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:h,vj:v};v=D.Jc;var Q=D.De(Ob.InteractiveViewManager.instance.Bd.ic);if(!Q)return u.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,vj:v};h=Q.fh;if(b.el&&ke.ImageReader.g4(b)){b=ke.ImageReader.kEa(b);if(!b)return u.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,vj:v};Q=b.Ova(h,Q);if(!Q)return u.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,vj:v};Q=Q.element}else if(ke.ImageReader.Eu(D))Q=Q.htmlElement;else return u.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,vj:v};return{returnValue:Q,view:h,vj:v}}Aoo(b){for(let D=0;D<this.Zja.length;D++){this.Zja[D]=b.Kk(Rn.a.span);this.Zja[D].className="WACImageCropHandles "+
this.p_j[D];if(2>=D){var h=b.Kk(Rn.a.span);h.className=this.Q9a[0];var v=b.Kk(Rn.a.span);v.className=this.Q9a[1];this.Zja[D].appendChild(h);this.Zja[D].appendChild(v)}else 4<D&&(h=b.Kk(Rn.a.span),h.className=this.Q9a[2],v=b.Kk(Rn.a.span),v.className=this.Q9a[3],this.Zja[D].appendChild(h),this.Zja[D].appendChild(v));if(!D||3===D||5===D)h=b.Kk(Rn.a.span),h.className=this.Q9a[4],v=b.Kk(Rn.a.span),v.className=this.Q9a[5],this.Zja[D].appendChild(h),this.Zja[D].appendChild(v);else if(2===D||4===D||7===
D)h=b.Kk(Rn.a.span),h.className=this.Q9a[6],v=b.Kk(Rn.a.span),v.className=this.Q9a[7],this.Zja[D].appendChild(h),this.Zja[D].appendChild(v)}}MAo(b,h){u.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.KKa)u.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var v=null,D=null;if((this.EAa=({view:v,vj:D}=this.hZl(h)).returnValue)&&v){this.EAa.classList.add("ImageCropMode");this.jAa=v.Kk(Rn.a.div);this.jAa.className="WACImageCropMode";
this.JKa=v.Kk(Rn.a.b2a);this.JKa.className="WACImageCropBase";this.gK=v.Kk(Rn.a.span);this.gK.className="WACImageCropSrcRect";this.Aoo(v);this.jAa.appendChild(this.gK);for(v=0;v<this.Zja.length;v++)this.gK.appendChild(this.Zja[v]);this.jAa.appendChild(this.JKa);this.JKa.style.visibility="";this.JKa.style.display="";this.EAa.appendChild(this.jAa);this.ODn(b);D=ke.ImageReader.sEa(b,D);v=ke.ImageReader.G5(b,wc.a.tpa,null);this.JKa.src=v?v:ke.ImageReader.mEb(D);this.SYg&&this.SYg.execute(Q=>{this.Jkd||
(this.Jkd=Q.dZl(this))});this.Bhd||(this.b2.nP(this.EAa,this.Jkd),this.Bhd=!0);this.ae&&this.ae.mb(Sc.a.XF,Ob.InteractiveViewManager.instance.editingView.editingElement,this.qxa);this.KKa=!0;this.yDe=b;this.Ikd=h;this.qgd=!1;b=new ah.GraphTransaction(4);b.Cb(this.Ikd.node);this.yDe.setValue(wc.a.Bwa,this.KKa);b.dispose()}else u.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}ODn(b){const h=Cf.a.xf(ke.ImageReader.dF(b),
0),v=Cf.a.xf(ke.ImageReader.wG(b),1);var D=ke.ImageReader.Bba(b);const Q=Math.max(D.top,0),ba=Math.max(D.bottom,0),ta=Math.max(D.left,0);D=Math.max(D.right,0);this.iW=1E5*h/(1E5-(ta+D));this.hW=1E5*v/(1E5-(Q+ba));this.OV=Math.floor(Q*this.hW/1E5);this.LV=Math.floor(ba*this.hW/1E5);this.MV=Math.floor(ta*this.iW/1E5);this.NV=Math.floor(D*this.iW/1E5);this.gK.style.top=this.OV+"px";this.gK.style.bottom=this.LV+"px";this.gK.style.left=this.MV+"px";this.gK.style.right=this.NV+"px";this.JKa.style.width=
this.iW+"px";this.JKa.style.height=this.hW+"px";ke.ImageReader.qy(b)&&(this.jAa.style.width=this.iW+"px",this.jAa.style.height=this.hW+"px");this.GS=this.OV;this.CS=this.LV;this.ES=this.MV;this.FS=this.NV}jhf(b=!1){u.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.KKa?(b||this.D1k(),this.JKa?jc.a.vC(this.JKa):u.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.EAa?(this.jAa?this.jAa.parentNode===this.EAa?this.EAa.removeChild(this.jAa):
u.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):u.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.EAa.classList.remove("ImageCropMode"),this.KKa=!1,b=new ah.GraphTransaction(4),b.Cb(this.Ikd.node),this.yDe.setValue(wc.a.Bwa,this.KKa),b.dispose(),this.Bhd&&(this.b2.BP(this.EAa,this.Jkd),this.Bhd=!1),this.ae&&this.ae.uc(Sc.a.XF,Ob.InteractiveViewManager.instance.editingView.editingElement,
this.qxa),this.EAa=this.jAa=null):u.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):u.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}xFj(b,h,v,D,Q,ba,ta){if(v){v=Math.max(this.OV-h,0);const Ta=Math.floor(this.hW)-this.LV-v;5<=Ta?(this.GS=v,this.CS=this.LV):5>Ta&&0<=Ta||0>Ta&&!this.LV?(this.GS=v-(5-Ta),this.CS=this.LV):0>Ta&&5>=Math.abs(Ta)?(this.GS=Math.floor(this.hW)-
this.LV,this.CS=Math.max(this.LV-(v-(this.hW-this.LV))-(5-Math.abs(Ta)),0)):(this.GS=Math.floor(this.hW)-this.LV,this.CS=Math.max(this.LV-(v-(this.hW-this.LV)),0));this.gK.style.top=this.GS+"px";this.gK.style.bottom=this.CS+"px";ta&&(this.OV=this.GS,this.LV=this.CS)}D&&(h=Math.max(this.LV-h,0),D=Math.floor(this.hW)-this.OV-h,5<=D?(this.CS=h,this.GS=this.OV):5>D&&0<=D||0>D&&!this.OV?(this.CS=h-(5-D),this.GS=this.OV):0>D&&5>=Math.abs(D)?(this.CS=Math.floor(this.hW)-this.OV,this.GS=Math.max(this.OV-
(h-(this.hW-this.OV))-(5-Math.abs(D)),0)):(this.CS=Math.floor(this.hW)-this.OV,this.GS=Math.max(this.OV-(h-(this.hW-this.OV)),0)),this.gK.style.top=this.GS+"px",this.gK.style.bottom=this.CS+"px",ta&&(this.OV=this.GS,this.LV=this.CS));Q&&(Q=Math.max(this.MV-b,0),h=Math.floor(this.iW)-this.NV-Q,5<=h?(this.ES=Q,this.FS=this.NV):5>h&&0<=h||0>h&&!this.NV?(this.ES=Q-(5-h),this.FS=this.NV):0>h&&5>=Math.abs(h)?(this.ES=Math.floor(this.iW)-this.NV,this.FS=Math.max(this.NV-(Q-(this.iW-this.NV))-(5-Math.abs(h)),
0)):(this.ES=Math.floor(this.iW)-this.NV,this.FS=Math.max(this.NV-(Q-(this.iW-this.NV)),0)),this.gK.style.left=this.ES+"px",this.gK.style.right=this.FS+"px",ta&&(this.MV=this.ES,this.NV=this.FS));ba&&(b=Math.max(this.NV-b,0),ba=Math.floor(this.iW)-this.MV-b,5<=ba?(this.FS=b,this.ES=this.MV):5>ba&&0<=ba||0>ba&&!this.MV?(this.FS=b-(5-ba),this.ES=this.MV):0>ba&&5>=Math.abs(ba)?(this.FS=Math.floor(this.iW)-this.MV,this.ES=Math.max(this.MV-(b-(this.iW-this.MV))-(5-Math.abs(ba)),0)):(this.FS=Math.floor(this.iW)-
this.MV,this.ES=Math.max(this.MV-(b-(this.iW-this.MV)),0)),this.gK.style.left=this.ES+"px",this.gK.style.right=this.FS+"px",ta&&(this.MV=this.ES,this.NV=this.FS));ta&&(this.qgd=!0,Ya.App.xa.updateCommandUI())}RSk(){this.GS=this.OV;this.CS=this.LV;this.ES=this.MV;this.FS=this.NV;this.gK.style.top=this.GS+"px";this.gK.style.bottom=this.CS+"px";this.gK.style.left=this.ES+"px";this.gK.style.right=this.FS+"px"}D1k(){if(this.qgd){u.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");
var b=Math.floor(1E5*this.OV/this.hW),h=Math.floor(1E5*this.LV/this.hW),v=Math.floor(1E5*this.MV/this.iW),D=Math.floor(1E5*this.NV/this.iW),Q=new fh.DictionaryPropertySet;Q.setValue(wc.a.Jib,b);Q.setValue(wc.a.Gib,h);Q.setValue(wc.a.Hib,v);Q.setValue(wc.a.Iib,D);this.ga.Of(this.Ikd,sc.a.Eoi,2,!1,null,Q)}else u.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Bwa(){return this.KKa}hSl(){return{top:this.GS,bottom:this.CS,left:this.ES,right:this.FS}}RUo(b,h){if(0>b)u.ULS.sendTraceTag(22552777,
322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.OV=this.GS=Math.min(Math.floor(this.hW)-this.CS-5,b);this.gK.style.top=this.GS+"px";break;case 1:this.LV=this.CS=Math.min(Math.floor(this.hW)-this.GS-5,b);this.gK.style.bottom=this.CS+"px";break;case 2:this.MV=this.ES=Math.min(Math.floor(this.iW)-this.FS-5,b);this.gK.style.left=this.ES+"px";break;case 3:this.NV=this.FS=Math.min(Math.floor(this.iW)-this.ES-5,b),this.gK.style.right=this.FS+"px"}this.qgd=!0}}}Object(n.a)(tk,
"ImageEditor",Yj,[342,343]);class Bo{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}xc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new te(w.AFrameworkApplication.va,Ga.a.instance.Sa("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new tk(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Yb.KeyInputManager.instance,b.Sa("WordEditor.IImageCropDragAdapterFactory"),b.Na("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){N.a.instance.Fc(new Bo)}}
Object(n.a)(Bo,"WordEditorImageEditorsPackage",null,[1,2]);class ps{}Object(n.a)(ps,"FolderContentEditor",null,[1647]);class xn{}Object(n.a)(xn,"PageEditor",null,[1555]);var Rl=c(152);class Ls extends xn{constructor(){super()}get vh(){return Rl.PageNavigator.instance}}Object(n.a)(Ls,"PageEditor",xn,[]);class yn{get name(){return"WordEditor.NotebookLevelEditors"}xc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new ps).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new Ls).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){N.a.instance.Fc(new yn)}}Object(n.a)(yn,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class xt{get HLb(){return w.AFrameworkApplication.privacyUrl}cua(){u.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Id.a.om(this.HLb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(n.a)(xt,"PrivacyLinkHandler",null,[278]);class Co{constructor(b,h){this.tLe=null;this.Yhk=
b;this.Xhk=h}showDialog(b){this.tLe=b;this.Xhk.create().Yh(Object(z.a)(this,this.Wlm,"handleDialog"))}Wlm(b){1===b&&this.Yhk.yij();this.tLe();this.tLe.prototype}}Object(n.a)(Co,"SendUsYourFileController",null,[270]);class Mr extends pg.StandardDialog{constructor(b,h,v){super();this.WXb=null;this.ig=b;this.jzc=h;this.eH=v}Yh(b){this.Ad=1;this.Ee(1,this.eH.send);this.Ee(0,this.eH.kgn);u.ULS.shipAssertTag(37034013,342,!this.WXb,"privacy anchor should be null before initializing it.");const h=this.dialogContent();
this.llb(this.eH.wCk,null,"CancelRequest_32x32x32",null,b,h);this.e5(this.kj(Mr.Iij))}dialogContent(){const b=document.createElement("span");b.innerText=this.eH.SGn;const h=document.createElement("span");h.innerText=this.eH.bHo;h.style.fontWeight=this.eH.h_o;const v=document.createElement("span");v.innerText=this.eH.Tdo;const D=this.I3k(),Q=document.createElement("span");Q.id=this.kj(Mr.Iij);Q.appendChild(b);Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(h);
Q.appendChild(document.createElement("br"));Q.appendChild(v);Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(D);return Q}I3k(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.eH.AGn;h.href=this.jzc.HLb||"";b.appendChild(h);this.WXb=h;this.ig.mb(Sc.a.click,this.WXb,Object(z.a)(this.jzc,this.jzc.cua,"clickHandler"));return b}dispose(){this.WXb&&(this.ig.uc(Sc.a.click,
this.WXb,Object(z.a)(this.jzc,this.jzc.cua,"clickHandler")),this.WXb=null);super.dispose()}}Mr.Iij="sendUsYourFileId";Object(n.a)(Mr,"SendUsYourFileDialog",pg.StandardDialog,[277]);class qs{create(){return Ga.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(n.a)(qs,"Factory",null,[276]);var jt=c(582);class Fu extends jt.a{constructor(){super();this.FileId=null}al(){return 38}static construct(b){const h=new Fu;h.FileId=b;return h}}Object(n.a)(Fu,"CreateSendUsYourFileRequest",
jt.a,[]);var Ms=c(990);class Nr{constructor(b,h,v){this.V5=b;this.YP=h;this.L$j=v}yij(b=!1){if(this.YP){const h=Fu.construct(this.YP()),v=new Ms.a;v.Dq=h;v.status=1;v.HG="BootErrorReport";b=b?this.V5(null):this.V5(D=>{this.b5c(v,D)});b.HI(v);b.DT();this.L$j()}}b5c(b){5===b.statusCode&&this.yij(!0)}}Object(n.a)(Nr,"SendUsYourFileManager",null,[269]);class Wt{constructor(b,h){this.W=null;this.eH=b;this.YP=h}xc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.eH).singleInstance();
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Mr(Sh.a.instance,new xt,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Nr(h=>this.wga(0,h),this.YP,()=>{u.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new qs;return new Co(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),
h)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(n.a)(Wt,"SendUsYourFilePackageManager",null,[]);var Ki=c(510),Xt=c(1028),ap;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(ap||(ap={}));Object(n.b)("AppMode",ap);class Mk{get wCk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get kgn(){return CommonUIStrings.l_NoThanks}get SGn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get bHo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get h_o(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Tdo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get AGn(){return CommonUIStrings.l_PrivacyStatement}}
Object(n.a)(Mk,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Jn extends Wt{constructor(){super(new Mk,()=>w.AFrameworkApplication.rootQuerySignature)}wga(b,h){return new Xt.a(b,h,"SendUsYourFile.ashx",ap.word,Ya.App.webServiceBase,Ki.a.amIAlone,Ki.a.d5c,Ki.a.P4c)}get name(){return"WordEditor.SendUsYourFile"}static main(){N.a.instance.Fc(new Jn)}}Object(n.a)(Jn,"PackageManager",Wt,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Ci=c(538),an=c(641),zm=c(1837),sl=c(115),Ph=c(27),dm=c(151),Sl=c(68),Zh=c(941),Pg=c(144),El=c(999);class Sp{constructor(b,h,v,D,Q,ba){this.Z1h=b;this.gallerySectionId=h;this.gyl=v;this.HAk=D;this.commandId=Q;this.queryCommandId=ba}}Object(n.a)(Sp,"BorderStyleMenuPropsArguments",null,[]);class bn{constructor(b,h,v,D,Q,ba,ta){this.B1b=b;this.Ivj=h;this.width=v;this.rRi=D;this.height=Q;this.qFi=ba;this.altText=ta}}Object(n.a)(bn,"TableBorderStyleProperties",null,[]);class ug{constructor(){this.Hwh=
[new bn(ug.qtj,"","2",1,8,0,"Solid Line"),new bn(ug.lOh,"5,3","1",1,8,0,"Dashed Line"),new bn(ug.xTh,"1,1","1",1,8,0,"Dotted Line"),new bn(ug.zTh,"","1",2,8,3,"Double Line")];this.Iwh=[new bn(ug.Pwh,"","1",1,8,0,"0.25pt"),new bn(ug.Mwh,"","1",1,8,0,"0.5pt"),new bn(ug.Swh,"","2",1,8,0,"0.75pt"),new bn(ug.Nwh,"","2",1,8,0,"1pt"),new bn(ug.Lwh,"","3",1,8,0,"1.5pt"),new bn(ug.Twh,"","4",1,8,0,"2.25pt"),new bn(ug.Rwh,"","4",1,8,0,"3pt"),new bn(ug.Kwh,"","5",1,8,0,"4.5pt"),new bn(ug.Qwh,"","6",1,8,0,"6pt")]}initialize(){this.$3f()}TIl(){const b=
new Sp("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Hwh,Eb.a.wob,Eb.a.Z1f);return this.z2h(b)}UIl(){const b=new Sp("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.Iwh,Eb.a.xob,Eb.a.$1f);return this.z2h(b)}p4h(b){switch(b){case ug.qtj:return Pg.a.C1b;case ug.lOh:return Pg.a.Ydb;case ug.xTh:return Pg.a.dFc;case ug.zTh:return Pg.a.j3;default:return Pg.a.Wta}}q4h(b){switch(b){case ug.Pwh:return Pg.a.Owh;case ug.Mwh:return Pg.a.F3e;case ug.Swh:return Pg.a.z1b;
case ug.Nwh:return Pg.a.Xdb;case ug.Lwh:return Pg.a.ama;case ug.Twh:return Pg.a.xCa;case ug.Rwh:return Pg.a.wfa;case ug.Kwh:return Pg.a.pZa;case ug.Qwh:return Pg.a.wCa;default:return Pg.a.aG}}z2h(b){const h=new Yd.a,v=new $g.a,D=Object.assign(new an.a,{Id:b.Z1h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.gyl,Type:4,Width:1,GalleryItems:[]});for(const ba of b.HAk){var Q={};const ta={};ta.width=ug.SYm;ta.height=ug.RYm;Q.root=ta;Q=Object.assign(new zm.a,{Id:ba.B1b,ExternalId:String.format("{0}_GalleryButton",
ba.B1b),Icon:ba.B1b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ba.B1b,FullIconStyle:Q,ShouldSetTitle:"true",Alt:ba.altText});D.GalleryItems.push(Q)}v.ControlList=[];h.MenuSectionList=[];v.ControlList.push(D);h.MenuSectionList.push(v);h.UpdateDynamically=!0;return h}$3f(){const b={};for(const h of this.Hwh)b[h.B1b]=appChrome.buildBorderStyleIcon(h.Ivj,h.width,h.rRi,h.height,h.qFi);for(const h of this.Iwh)b[h.B1b]=appChrome.buildBorderStyleIcon(h.Ivj,h.width,
h.rRi,h.height,h.qFi);appChrome.api.registerIconProvider(()=>b)}sfo(b,h,v){if(!b)return u.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==Zb.a.y5)return u.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.T0(sl.a.ZT(b),b.node,5,v,h);break;case 0:this.T0(sl.a.ZT(b),b.node,3,v,h);break;case 1:this.T0(sl.a.ZT(b),b.node,4,v,h);break;case 3:this.T0(sl.a.ZT(b),
b.node,0,v,h);break;case 7:this.T0(sl.a.ZT(b),b.node,1,v,h);break;case 8:this.T0(sl.a.ZT(b),b.node,2,v,h);break;case 6:this.T0(sl.a.ZT(b),b.node,1,v,h);this.T0(sl.a.ZT(b),b.node,2,v,h);break;case 5:this.T0(sl.a.ZT(b),b.node,3,v,h);this.T0(sl.a.ZT(b),b.node,5,v,h);this.T0(sl.a.ZT(b),b.node,4,v,h);this.T0(sl.a.ZT(b),b.node,0,v,h);break;case 4:this.T0(sl.a.ZT(b),b.node,3,v,h),this.T0(sl.a.ZT(b),b.node,5,v,h),this.T0(sl.a.ZT(b),b.node,4,v,h),this.T0(sl.a.ZT(b),b.node,0,v,h),this.T0(sl.a.ZT(b),b.node,
1,v,h),this.T0(sl.a.ZT(b),b.node,2,v,h)}return!0}N$f(b,h,v,D){if(!h)return u.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==Zb.a.Z0)return u.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var Q=h.node;const ba=new ne.GraphIterator;ba.set(Q);ba.zb(14);Q=Ph.TableCellReader.KOa(ba);switch(h.border){case 2:this.SSa(b,h.node,5,D,v,Q);this.Lge(h.node,5,v);this.Hfe(b,h.F0a(),3,v,D,Q);
break;case 0:this.SSa(b,h.node,3,D,v,Q);this.Lge(h.node,3,v);this.Hfe(b,h.F0a(),1,v,D,Q);break;case 1:this.SSa(b,h.node,4,D,v,Q);this.Lge(h.node,4,v);this.Hfe(b,h.F0a(),0,v,D,Q);break;case 3:this.SSa(b,h.node,0,D,v,Q),this.Lge(h.node,0,v),this.Hfe(b,h.F0a(),2,v,D,Q)}return!0}JLn(b,h){if(We.SelectionEditor.XVc(b)&&h)switch(b=Object(Ka.a)(dm.TableNodeBorderContext,b),b.border){case 2:this.LO(b.node,ug.Ho.wM(5),h);break;case 0:this.LO(b.node,ug.Ho.wM(3),h);break;case 3:this.LO(b.node,ug.Ho.wM(0),h);
break;case 1:this.LO(b.node,ug.Ho.wM(4),h);break;case 7:this.LO(b.node,ug.Ho.wM(1),h);break;case 8:this.LO(b.node,ug.Ho.wM(2),h);break;case 5:h=this.LO(b.node,ug.Ho.wM(5),h);h=this.LO(b.node,ug.Ho.wM(3),h);h=this.LO(b.node,ug.Ho.wM(0),h);this.LO(b.node,ug.Ho.wM(4),h);break;case 6:h=this.LO(b.node,ug.Ho.wM(1),h);this.LO(b.node,ug.Ho.wM(2),h);break;case 4:h=this.LO(b.node,ug.Ho.wM(5),h),h=this.LO(b.node,ug.Ho.wM(3),h),h=this.LO(b.node,ug.Ho.wM(0),h),h=this.LO(b.node,ug.Ho.wM(4),h),h=this.LO(b.node,
ug.Ho.wM(1),h),this.LO(b.node,ug.Ho.wM(2),h)}}fKn(b,h){if(We.SelectionEditor.YVc(b)&&h)switch(b=Object(Ka.a)(dm.TableNodeBorderContext,b),b.border){case 2:this.LO(b.node,ug.Ho.EO(5),h);break;case 0:this.LO(b.node,ug.Ho.EO(3),h);break;case 3:this.LO(b.node,ug.Ho.EO(0),h);break;case 1:this.LO(b.node,ug.Ho.EO(4),h)}}Cnf(b,h,v){v=null;if(!b)return u.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),v;b.properties.hasProperty(h.size)&&(v=new El.a,v.weight=b.properties.ia(h.size,Pg.a.aG),v.style=
b.properties.ia(h.style,Pg.a.Wta),v.color=b.properties.ia(h.color,0));return v}M$f(b,h,v){b?v?(b.properties.setValue(h.size,v.weight),b.properties.setValue(h.style,v.style),b.properties.setValue(h.color,v.color)):u.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):u.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}KMb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):u.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}T0(b,h,v,D,Q){Q=this.VXo(b,h,v,D,Q);this.Aic(h,ug.Ho.wM(v),Q);switch(v){case 5:this.sSa(h,2,D,Q);break;case 4:this.sSa(h,1,D,Q);break;case 0:this.sSa(h,3,D,Q);break;case 3:this.sSa(h,0,D,Q);break;case 1:this.sSa(h,7,D,Q);break;case 2:this.sSa(h,8,D,Q)}}VXo(b,h,v,D,Q){if(3!==D){var ba=ug.Fg.JOd(b,h,v,3);void 0!==ba&&null!==ba&&ba!==Pg.a.a_&&(ba=Sl.a.Chc(ba),Q.color=ug.o7a.iua(h,ba))}1!==D&&(ba=ug.Fg.JOd(b,h,v,1),void 0!==ba&&null!==ba&&ba!==Pg.a.$F&&(Q.weight=parseFloat(ba)*
Pg.a.A1b));2!==D&&(b=ug.Fg.JOd(b,h,v,2),void 0!==b&&null!==b&&b!==Pg.a.$F&&(Q.style=b));return Q}SSa(b,h,v,D,Q,ba){D&&(Q=this.BSo(b,h,ba,v,D,Q));this.Aic(h,ug.Ho.EO(v),Q)}BSo(b,h,v,D,Q,ba){if(3!==Q){var ta="",Ta=ug.Fg.dEb(b,h,D,!1,!0,v,3);Ta&&(ta=Ta.Qzb);void 0!==ta&&null!==ta&&ta!==Pg.a.a_&&(ta=Sl.a.Chc(ta),ba.color=ug.o7a.iua(h,ta))}if(1!==Q){ta="";if(Ta=ug.Fg.dEb(b,h,D,!1,!0,v,1))ta=Ta.Qzb;void 0!==ta&&null!==ta&&ta!==Pg.a.$F&&(ba.weight=parseFloat(ta)*Pg.a.A1b)}if(2!==Q){Q="";if(b=ug.Fg.dEb(b,
h,D,!1,!0,v,2))Q=b.Qzb;void 0!==Q&&null!==Q&&Q!==Pg.a.$F&&(ba.style=Q)}return ba}ydn(b){let h=0,v=0;({Zcn:h,Can:v}=this.v2l(b.style,h,v));b.weight<h&&(b.weight=h);b.weight>v&&(b.weight=v);return b}v2l(b,h,v){switch(b){case Pg.a.C1b:case Pg.a.Ydb:case Pg.a.dFc:h=2;v=48;break;case Pg.a.j3:h=2;v=24;break;default:h=2,v=48}return{Zcn:h,Can:v}}Hfe(b,h,v,D,Q,ba){if(h)if(D)for(let ta=0;ta<h.length;ta++)switch(v){case 2:this.SSa(b,h[ta],5,Q,D,ba);break;case 0:this.SSa(b,h[ta],3,Q,D,ba);break;case 1:this.SSa(b,
h[ta],4,Q,D,ba);break;case 3:this.SSa(b,h[ta],0,Q,D,ba)}else u.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else u.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}Lge(b,h,v){const D=new ne.GraphIterator;D.set(b);D.zb(14);const Q=Ph.TableCellReader.Kna(b);b=Ph.TableCellReader.FO(b);Ig.forEachCell(D,Q,b,(ba,ta,Ta)=>{ba=ba.currentNode;Ph.TableCellReader.Qr(ba)&&0==Ta&&0<ta&&this.Aic(ba,ug.Ho.EO(h),v)})}Aic(b,h,v){b?(v=this.ydn(v),b.properties.setValue(h.color,
v.color),b.properties.setValue(h.size,v.weight),b.properties.setValue(h.style,v.style)):u.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}sSa(b,h,v,D){if(b){var Q=rh.TableReader.fg(b),ba=rh.TableReader.Yg(b),ta=new ne.GraphIterator,Ta=[];for(let ob=0;ob<Q;ob++)for(let Kb=0;Kb<ba;Kb++)if(ta.set(b),Ig.moveToCell(ta,ob,Kb),ta&&ta.currentNode&&!Ph.TableCellReader.hg(ta))switch(h){case 2:Ph.TableCellReader.iha(ta)&&Ta.push(dm.TableNodeBorderContext.N7(ta.currentNode,2));break;case 0:Ph.TableCellReader.jha(ta)&&
Ta.push(dm.TableNodeBorderContext.N7(ta.currentNode,0));break;case 3:Ph.TableCellReader.WDf(b,ta.currentNode)&&Ta.push(dm.TableNodeBorderContext.N7(ta.currentNode,3));break;case 1:Ph.TableCellReader.XDf(b,ta.currentNode)&&Ta.push(dm.TableNodeBorderContext.N7(ta.currentNode,1));break;case 7:Ph.TableCellReader.XDf(b,ta.currentNode)||Ta.push(dm.TableNodeBorderContext.N7(ta.currentNode,1));break;case 8:Ph.TableCellReader.WDf(b,ta.currentNode)||Ta.push(dm.TableNodeBorderContext.N7(ta.currentNode,3))}for(b=
0;b<Ta.length;b++)switch(h=Ta[b],h.border){case 2:this.T3c(h.node,ug.Ho.EO(5),v,D);this.Kce(h.F0a(),ug.Ho.EO(0),v,D);break;case 0:this.T3c(h.node,ug.Ho.EO(3),v,D);this.Kce(h.F0a(),ug.Ho.EO(4),v,D);break;case 1:this.T3c(h.node,ug.Ho.EO(4),v,D);this.Kce(h.F0a(),ug.Ho.EO(3),v,D);break;case 3:this.T3c(h.node,ug.Ho.EO(0),v,D),this.Kce(h.F0a(),ug.Ho.EO(5),v,D)}}else u.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}Kce(b,h,v,D){if(b)for(let Q=0;Q<b.length;Q++)this.T3c(b[Q],h,v,D);else u.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}T3c(b,h,v,D){if(b){var Q=b.ia(h.color,ug.Lcf),ba=b.ia(h.size,ug.Ncf),ta=b.ia(h.style,ug.Mcf),Ta=new El.a;Ta.weight=D.weight;Ta.style=D.style;Ta.color=D.color;2!==v||Q===ug.Lcf&&ba===ug.Ncf?3!==v||ta===ug.Mcf&&ba===ug.Ncf?1!==v||Q===ug.Lcf&&ta===ug.Mcf?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ta.color=Q,Ta.style=ta,this.Aic(b,h,Ta)):(Ta.style=ta,Ta.weight=ba,this.Aic(b,h,Ta)):(Ta.color=
Q,Ta.weight=ba,this.Aic(b,h,Ta))}else u.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}LO(b,h,v){var D=b.properties.ia(h.style,Pg.a.$F);D!==Pg.a.$F&&(v.lineStyle!==Pg.a.$F?v.lineStyle!==D&&(v.lineStyle=Pg.a.eLk):v.lineStyle=D);D=b.properties.ia(h.size,Pg.a.aG);D!==Pg.a.aG&&(v.xXc!==Pg.a.aG?v.xXc!==D&&(v.xXc=Pg.a.XKk):v.xXc=D);b=b.properties.ia(h.color,0);b=Sl.a.VE(b);b!==Pg.a.a_&&(v.borderColor!==Pg.a.a_?v.borderColor!==b&&(v.borderColor=Pg.a.PKk):v.borderColor=b);return v}static get Ho(){return null!=
ug.bwg?ug.bwg:ug.bwg=Pg.a.instance}static get Fg(){return null!=ug.QJg?ug.QJg:ug.QJg=Ga.a.instance.Na("WordEditor.IWACTableStyleReader")}static get o7a(){return null!=ug.CHg?ug.CHg:ug.CHg=Zh.a.instance}}ug.SYm="110px";ug.RYm="20px";ug.qtj="SolidLineStyle";ug.lOh="DashedLineStyle";ug.xTh="DottedLineStyle";ug.zTh="DoubleLineStyle";ug.Pwh="BorderPointSizeOneQuarter";ug.Mwh="BorderPointSizeOneHalf";ug.Swh="BorderPointSizeThreeQuarters";ug.Nwh="BorderPointSizeOne";ug.Lwh="BorderPointSizeOneAndHalf";ug.Twh=
"BorderPointSizeTwoAndQuarter";ug.Rwh="BorderPointSizeThree";ug.Kwh="BorderPointSizeFourAndHalf";ug.Qwh="BorderPointSizeSix";ug.Mcf="single";ug.Ncf=4;ug.Lcf=0;Object(n.a)(ug,"TableBorderManager",null,[574]);var il=c(845),Kl=c(52),wq=c(207);class Nq{constructor(b,h){this.Obh=this.z7g=null;this.fNa=b;this.W9g=h}get WYi(){return this.W9g}get ipa(){return this.z7g}get z3f(){return this.Obh}emj(b,h){this.Obh=b;this.z7g=h}mko(b){this.W9g=b}}Object(n.a)(Nq,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var Uj=c(90),jo=c(203),dq=c(363),Or=c(143),Zn=c(247),hk=c(588),hw=c(76),Oq=c(469),Ns=c(1044);class ui extends il.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb=null,bc=null){super(b,h,v,bc,Vb);this.D9a=Ns.a.instance;this.ra=new cf.a;this.a6e=[lc.a.Hkc,lc.a.wpb,lc.a.GPb,lc.a.Fkc,lc.a.upb,lc.a.EPb,lc.a.Ekc,lc.a.tpb,lc.a.DPb,lc.a.Gkc,lc.a.vpb,lc.a.FPb];this.jYj=[lc.a.ya,lc.a.ua,Gd.a.Kh,Gd.a.ar];this.oi=D;this.Rxb=Q;this.Wc=ba;this.ib=ta;this.s6=Ta;this.Zl=ob;this.utc=Kb;this.Pih=Vb;this.omk=bc;this.VIn=
this.F0f.bind(this)}get vj(){return this.oi.value}get Rs(){return this.s6?this.s6.instance:null}h_e(b){this.ra.addHandler("OnParagraphDelete",b)}get gh(){return!!this.utc.instance&&this.utc.instance.gh}ISc(b,h,v,D,Q){h.setValue(lc.a.Lc,ye.a.tF());h.setValue(lc.a.NGm,Q);hk.b(D,h,[lc.a.a1]);super.ISc(b,h,v,D,Q)}lWd(b,h,v,D,Q){const ba=this.mQc(h,v,D,Q);this.QFd(ba,h,!1);return super.lWd(b,h,v,D,Q)}Eyd(b,h,v,D,Q){const ba=this.mQc(h,v,D,Q);this.QFd(ba,h,!0);super.Eyd(b,h,v,D,Q);return ba}m$e(b,h,v,D){h=
this.mQc(b,h,v,D);this.QFd(h,b,!0);return h}insertRows(b,h,v,D){const Q=Kl.a.xs(b),ba=new ne.GraphIterator;ba.Zc(b);const ta=ba.currentNode;ba.Sb(1);let Ta;Ta=h?b.NC(1):b.currentNode;const ob=b.sc();if(!ob)throw Error.create("table row insertion cannot be performed on a null tableNode");const Kb=rh.TableReader.fg(ob),Vb=ob.tT.Fg;let bc=!1;try{ob.oya=1;const Dc=this.D9a.ghb(ob,Vb.fF(ob));this.dTa(b.currentNode);this.Wqa(b);this.Ssk(v,b,Ta,ba,ta,h,D);const Oc=this.D9a.ghb(ob,Vb.fF(ob));this.A6a(ob,
rh.TableReader.fg(ob)+v);bc=!0;this.TWd(ob,Dc,Oc)}finally{ob.oya=0,bc||this.A6a(ob,rh.TableReader.fg(ob)+v)}Q+1!==Kb||h?!Q&&h&&ui.QAf(ob,v):ui.QAf(ob,Q);h=Q+v+(h?0:1);h<Kb+v&&this.Zsi(ob,h);return b.currentNode}Ssk(b,h,v,D,Q,ba,ta){let Ta=null,ob=null;for(var Kb=0;Kb<b;++Kb){var Vb=wq.a.instance.createInstance(393251);ob||(ob=Vb);Ta=Vb;this.ISc(h,Vb,v,Q,ba)}b=rh.TableReader.Yg(h.currentNode);v=!0;do{v?(h.Fi(Ta),v=!1):h.vf(1);Q=Array(b);for(Kb=0;Kb<b;++Kb){Vb=this.KNa();const bc=this.m$e(Vb,D.currentNode,
ba,!0);let Dc=null;bc.hg||(Dc=ta(bc));Q[Kb]=new Nq(Vb,Dc);Q[Kb].emj(bc,null);D.vf(1)}for(Kb=0;Kb<b;++Kb)Vb=Q[Kb].fNa,h.Y2(Vb,1,il.a.xKa?il.a.xKa():null),Ph.TableCellReader.Qr(Vb)||(this.pzb(h,Vb,Q[Kb].WYi),this.aJh(Q[Kb].z3f,Vb,!0));D.Tga(1)}while(h.currentNode!==ob)}insertColumns(b,h,v,D,Q){let ba=b.currentNode,ta=!1,Ta=rh.TableReader.Yg(b.currentNode);const ob=Ta;try{this.dTa(b.currentNode);this.Wqa(b);const Kb=ba.tT.Fg;ba.oya=1;const Vb=this.D9a.ghb(ba,Kb.fF(ba));Ta=rh.TableReader.Yg(b.currentNode);
-1===h&&(h=Ta);this.Qsk(b,D,v,h,Q);ba=b.currentNode;Ta+=D;this.T2f(b,Ta,D,h);ta=!0;const bc=this.D9a.ghb(ba,Kb.fF(ba));this.TWd(ba,Vb,bc)}finally{ba.oya=0,ta||this.T2f(b,Ta,D,h)}h!==ob||v?!h&&v&&ui.PAf(ba,D):ui.PAf(ba,h-1)}Qsk(b,h,v,D,Q){var ba=b.currentNode;D=v?D:D-1;b.Sb(1);var ta=new zb.a;do{var Ta=b.AG(D,1);b.sc();var ob=Array(h);for(let Vb=0;Vb<h;++Vb){var Kb=this.KNa();const bc=this.n4l(b,Ta,v),Dc=this.m$e(Kb,Ta,v,!1);Kb=new Nq(Kb,null);Kb.emj(Dc,bc);ob[Vb]=Kb}ta.add(ob)}while(b.xi(1));v=ta.toArray();
for(D=0;D<v.length;D++)for(ta=0;ta<h;ta++)Ta=v[D][ta],ob=Ta.z3f,ob.hg||Ta.mko(Q(ob));b.set(ba);b.Sb(1);Q=0;do{for(ba=0;ba<h;++ba)D=v[Q][ba],ta=D.fNa,b.yGb(ta,D.ipa,1,il.a.xKa?il.a.xKa():null),Ph.TableCellReader.Qr(ta)||(this.pzb(b,ta,D.WYi),this.aJh(D.z3f,ta,!1));Q++}while(b.xi(1))}TWd(b,h,v){if(h){var D=2===b.oya,Q=[],ba=new ne.GraphIterator;ba.set(b);for(var ta=ba.Sb(1);ta;){for(ta=ba.Sb(1);ta;){const Ta=ta.id.toString();Ta in h&&h[Ta]===v[Ta]&&(!D||!Ph.TableCellReader.jha(ba)&&!Ph.TableCellReader.iha(ba))||
Q.push(ta);ta=ba.xi(1)}ta=ba.xi(1)}if(0<Q.length){h=new ah.GraphTransaction(3);try{h.set(b.pj);for(const Ta of Q)Ta.RAf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const v=Kl.a.xs(b),D=v+h;let Q=b.sc();const ba=Q.tT.Fg;let ta=!1;u.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",Q.id.toString(),Q.type,v,h);const Ta=rh.TableReader.fg(Q);try{Q.oya=2;const ob=this.D9a.ghb(Q,ba.fF(Q));this.dTa(b.currentNode);
this.Wqa(b);for(let Vb=D-1;Vb>=v;--Vb){b.AG(Vb,1);let bc=b.Sb(1);for(;bc;)this.m_c(bc,!0),bc=b.xi(1);this.K1a(b);u.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Ve);b.Cg()}Q=b.currentNode;const Kb=this.D9a.ghb(Q,ba.fF(Q));this.A6a(Q,rh.TableReader.fg(Q)-h);this.o6d(b);ta=!0;this.TWd(Q,ob,Kb)}finally{Q.oya=0,ta||(this.A6a(b.currentNode,rh.TableReader.fg(b.currentNode)-h),this.o6d(b))}Ta===D&&0<=v-1&&ui.QAf(Q,v-1);v<Ta-h&&this.Zsi(Q,v)}deleteColumns(b,
h,v){b=Object(Ka.a)(ne.GraphIterator,b);let D=Object(Ka.a)(Oq.a,b.currentNode),Q=rh.TableReader.Yg(b.currentNode);const ba=D.tT.Fg;let ta=!1;u.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",D.id.toString(),D.type,h,v);const Ta=Q;try{D.oya=2;const ob=this.D9a.ghb(D,ba.fF(D));this.dTa(b.currentNode);this.Wqa(b);-1===h&&(h=Q-v);b.Sb(1);do for(let Vb=h+v-1;Vb>=h;--Vb)b.AG(Vb,1),this.m_c(b.currentNode,
!1),this.K1a(b),b.Cg();while(b.xi(1));Q-=v;this.S2f(b,Q,h,v);ta=!0;D=Object(Ka.a)(Oq.a,b.currentNode);const Kb=this.D9a.ghb(D,ba.fF(D));this.TWd(D,ob,Kb);this.n6d(b)}finally{D&&(D.oya=0),ta||(this.S2f(b,Q,h,v),this.n6d(b))}Ta===h+v&&0<=h-1&&ui.PAf(D,h-1)}mergeCells(b,h,v){if(b&&(1!==h||1!==v)){var D=new ne.GraphIterator;D.Zc(b);D.zb(14);this.Haf(D,h,v);this.iSo(D,h,v);D.sc();D.sc();this.RUi(D)}}Ttj(b,h,v){if(b&&(1!==h||1!==v)){var D=new ne.GraphIterator;D.Zc(b);D.zb(14);this.rdl(D,h,v);D.sc();D.sc();
this.gXi(D)}}m_c(b,h){u.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.Nlm(b,h,this.VIn)}F0f(b,h){const v=b.currentNode;v.hg=!1;this.QFd(h.currentNode,b.currentNode,!0);v.removeProperty(lc.a.skippedCell);v.removeProperty(lc.a.renderCell);1===v.colSpan&&1===v.rowSpan&&v.lGc();il.a.tK.o7(b,!0,il.a.rci(h.currentNode));Ig.returnToCell(b);this.Y6k(h,b)}pwf(b,h,v){super.pwf(b,h,v);1===h.controlCell.colSpan&&1===h.controlCell.rowSpan?h.controlCell.lGc():
!v&&h.vee&&(b.qPa?1<b.colSpan&&(h=new ne.GraphIterator,h.set(b),h.zb(15),Ig.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(v=new ne.GraphIterator,v.set(h.controlCell),v.zb(15),h=hw.a(v),v=new ne.GraphIterator,v.set(b),v.zb(15),Ig.moveToColumnByIndex(v,h),--v.currentNode.colSpan))}mQc(b,h,v,D){const Q=super.mQc(b,h,v,D);if(b.hg&&!D){var ba=h.exa;ba.vee&&(D=il.a.Z6b(ba.controlCell,D),!ba.aEd&&v||ba.aEd===D-1&&!v?b.colSpan=1:(v=new ne.GraphIterator,v.set(ba.controlCell),v.zb(15),ba=hw.a(v),
v=new ne.GraphIterator,v.set(h),v.zb(15),Ig.moveToColumnByIndex(v,ba),v.currentNode.colSpan+=1))}Q.ia(lc.a.skippedCell,!1)&&(b.hg=!0,b.q4=!0,b.Mob=!0);return Q}o6d(b){this.HQb(b,lc.a.complexTable)}n6d(b){this.HQb(b,lc.a.complexTable)}RUi(b){this.HQb(b,lc.a.complexTable)}gXi(b){this.HQb(b,lc.a.complexTable)}Y6k(b,h){if(b&&h){let v;b=ne.GraphIterator.$a(b.currentNode);sk.OutlineNavigator.c9(b)&&(b.Sb(2),b=b.currentNode,12==b.type&&(v=b.Hf(Gd.a.Kh)));v&&(b=new ne.GraphIterator,b.Zc(h),sk.OutlineNavigator.c9(b)&&
b.Sb(2)&&(h=b.currentNode,12==h.type&&h.Zg(Gd.a.Kh,v)))}}QFd(b,h,v){b&&(hk.b(b,h,this.a6e),hk.b(b,h,[Gd.a.yH]),v&&hk.b(b,h,[lc.a.uP,lc.a.QR,lc.a.WHa,lc.a.UHa,lc.a.Gqa,lc.a.skippedCell,lc.a.renderCell]))}aJh(b,h,v){b&&(b=ne.GraphIterator.$a(b),b.vd(),b.Qd(),h=ne.GraphIterator.$a(h),h.vd(),h.Qd(),Cd.OutlineElementReader.Dh(b)&&ig.OutlineElementNavigator.Ge(b)&&Cd.OutlineElementReader.Dh(h)&&ig.OutlineElementNavigator.Ge(h)&&hk.b(b.currentNode,h.currentNode,this.jYj),v&&(ig.OutlineElementNavigator.Vd(b),
ig.OutlineElementNavigator.Vd(h),Hg.ListItemReader.Ig(b)&&(v=ui.DZm.lw(b),v.RB=Uj.a.ql,{owa:v}=ui.Un.Sla(v.propertySet,h,v))))}K1a(b){this.gh&&this.Zl.DXn(b.currentNode);for(b=jo.a.$p(b);b.moveNext();)if(de.ParagraphReader.Vb(b.currentNode)){const h=Ba.e(b.currentNode);for(const v of h)v.Wha();this.ra.raiseEvent("OnParagraphDelete",b.currentNode)}else Hg.ListItemReader.Ig(b.iterator)&&this.Rs&&this.Rs.Sca(b.iterator)}gE(b,h){let v=null;if(this.Pih.rg){const D=Object(Ka.a)(Oq.a,b);D&&(v=D.FR())}rh.TableReader.an(b)&&
(1===h?h=3:3===h&&(h=1));super.gE(b,h);this.Pih.rg&&this.omk.Yia(b,v);Object(yb.a)(Oq.a,b)&&il.a.nh.Smj(Object(Ka.a)(Oq.a,b),(new dq.a(1,0)).Lt)}Vag(b,h){const v=Array(h),D=this.ihi(b)/h;for(let Q=0;Q<h;Q++)v[Q]=Math.max(Cf.a.Tl(Or.a.sda,0),D);b.setValue(Gd.a.Fz,v)}Ilj(b){b.setValue(lc.a.tableLayout,0)}Qqh(b,h,v,D,Q){const ba=Array(v);for(var ta=0,Ta=0;ta<D;++ta)ba[ta]=h[ta],Ta+=ba[ta];for(;ta<v;++ta)ba[ta]=0>ta-Q?h[0]:h[ta-Q],Ta+=ba[ta];ta=this.ihi(b.currentNode);if(Ta>ta)for(Ta=ta/Ta,ta=0;ta<v;++ta)ba[ta]=
Math.max(Cf.a.Tl(Or.a.sda,0),ba[ta]*Ta);return ba}ihi(b){var h=ne.GraphIterator.$a(b);b=Cf.a.Tl(Cf.a.Mi(rh.TableReader.Wgi(h),0),0);if(h.zb(16))return Ig.returnToCell(h),h=Or.a.Clc(h.currentNode),Cf.a.Tl(Cf.a.Mi(h,0),0)-b;h=Zn.a.A$c(h);return Cf.a.Tl(Cf.a.Mi(h,0),0)-b}FO(b,h,v){const D=new ne.GraphIterator;D.set(b);Ig.moveToCell(D,h,v);return D.currentNode.ia(lc.a.colSpan,1)}Hic(b){var h=Ya.App.xa.hb.tu;if(h.qe&&(h=b.De(h.ic))){var v=!1,D=rh.TableReader.Yg(b),Q=b.ia(Gd.a.Fz,Array(D));for(var ba of Q)if(!ba){v=
!0;break}if(v){Q=am.a.clone(Q);ba=b.ia(lc.a.complexTable,!1);u.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",D,Q,ba);v=1;var ta=0;for(let ob=0;ob<D;)if(ba&&(v=this.FO(b,0,ob)),1<v){for(var Ta=0;Ta<v;Ta++)Q[ob]||(Q[ob]=this.Vai(0)),ob++;ta+=v-1}else(Ta=h.gSl(ob-ta))||u.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",ob,ta),Q[ob]||(Q[ob]=this.Vai(Ta)),ob++;b.setValue(Gd.a.Fz,Q)}}}Vai(b){return Cf.a.Tl(Math.max(b,
Or.a.sda),0)}dTa(b){b=ne.GraphIterator.$a(b);this.Hic(b.currentNode);b.zb(14)&&(Ig.returnToContainingTable(b),this.Hic(b.currentNode))}Pmj(b,h){h&&b.setValue(lc.a.d$,h)}xbg(b,h){h&&b.setValue(lc.a.Dkc,h)}DDh(b,h){const v=rh.TableReader.Yg(b);il.a.nXk(b,h,v)}qgo(b,h,v){let D;if(!({tableNode:D}=this.Dbc(b)).returnValue)return!1;if(h&&v&&h.length===v.length){if(!this.Rol(D,h))return!1;for(let Q=0;Q<h.length;++Q){const ba=this.Rxb.I6c(b,h[Q],v[Q]);if(ba)return u.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ba),!1}this.s4d(D);return!0}return!1}WCk(b,h){let v;if(!({tableNode:v}=this.Dbc(b)).returnValue||rh.TableReader.BB(v))return!1;var D=Object(Ka.a)(ne.GraphIterator,this.Wc.Wf(v));Ig.moveToLastRow(D);var Q=rh.TableReader.fg(v);if(h&&0<h.length){this.insertRows(D,!1,h.length,()=>null);D=rh.TableReader.fg(v);var ba=this.Wc.Wf(v);Q=this.Rgi(ba,Q,D-1);for(D=0;D<Q.length;++D){ba=Q[D];const ta=h[D];for(let Ta=0;Ta<ba.length;++Ta){let ob;if(ob=ta&&ta[Ta]?this.Rxb.I6c(b,ba[Ta],ta[Ta].toString()):this.Rxb.I6c(b,
ba[Ta],""))return u.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ob),!1}}}this.s4d(v);return!0}ECk(b,h){let v;if(!({tableNode:v}=this.Dbc(b)).returnValue||rh.TableReader.BB(v))return!1;var D=this.Wc.Wf(v),Q=rh.TableReader.Yg(v);if(h&&0<h.length){this.insertColumns(Object(Ka.a)(ne.GraphIterator,D),Q,!1,h[1].length,()=>null);var ba=rh.TableReader.Yg(v);D=this.Vdm(D,Q,ba-1);for(Q=0;Q<D.length;++Q){ba=h[Q];const ta=D[Q];for(let Ta=
0;Ta<ta.length;++Ta){let ob;if(ob=ba&&ba[Ta]?this.Rxb.I6c(b,ta[Ta],ba[Ta].toString()):this.Rxb.I6c(b,ta[Ta],""))return u.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ob),!1}}}this.s4d(v);return!0}zil(b){let h;if(!({tableNode:h}=this.Dbc(b)).returnValue)return!1;let v=this.c1a(h);const D=rh.TableReader.fg(h);var Q=this.Wc.Wf(h);Q=this.Rgi(Q,v,D-1);for(let ba=0;ba<Q.length;++ba){const ta=Q[ba];for(let Ta=0;Ta<ta.length;++Ta){const ob=
this.Rxb.a9i(b,ta[Ta]);if(ob)return u.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",ob),!1}}v=v?v:1;b=this.Wc.Wf(h);b.zG(v)&&15===b.Ve&&this.deleteRows(Object(Ka.a)(ne.GraphIterator,b),D-v);this.s4d(h);return!0}c1a(b){let h=0;const v=this.Wc.Wf(b);let D=v.Qd();for(;D&&D.ia(lc.a.ikb,!1);)h++,D=v.xt();return!h&&hj.StyleReader.GTa.aU(b)&32?1:h}iSo(b,h,v){var D,Q;const ba=b.currentNode,ta=new ne.GraphIterator;ta.Zc(b);let Ta=null,ob=
null,Kb=null;const Vb=Pg.a.instance.EO(3),bc=Pg.a.instance.EO(4),Dc=Pg.a.instance.EO(5),Oc=Pg.a.instance.EO(0);Ig.forEachCell(ta,h,v,(gd,rd,je)=>{gd=gd.currentNode;rd||je||(Ta=ui.Ez.Cnf(gd,Vb,Ta));rd||je!==v-1||(ob=ui.Ez.Cnf(gd,bc,ob));0<rd&&!je&&(Ta?ui.Ez.M$f(gd,Vb,Ta):ui.Ez.KMb(gd,Vb),ob?ui.Ez.M$f(gd,bc,ob):ui.Ez.KMb(gd,bc),ui.Ez.KMb(gd,Dc),rd!==h-1&&ui.Ez.KMb(gd,Oc));je||rd!==h-1||(Kb=ui.Ez.Cnf(gd,Oc,Kb))});b=null===(Q=null===(D=null===Ya.App||void 0===Ya.App?void 0:Ya.App.xa)||void 0===D?void 0:
D.hb)||void 0===Q?void 0:Q.tu;ob?(D=dm.TableNodeBorderContext.N7(ba,1),ui.Ez.N$f(sl.a.Kp(b),D,ob,0)):ui.Ez.KMb(ba,bc);D=dm.TableNodeBorderContext.N7(ba,0);if(Ta)ui.Ez.N$f(sl.a.Kp(b),D,Ta,0);else for(D=Object(Ka.a)(dm.TableNodeBorderContext,D).F0a(),Q=0;Q<D.length;Q++)ui.Ez.KMb(D[Q],bc);Kb?ui.Ez.M$f(ba,Oc,Kb):ui.Ez.KMb(ba,Oc)}Rol(b,h){for(let D=0;D<h.length;++D){var v=this.Wc.Wf(h[D]);if(v.zb(14)&&(v=v.jd(14),b.id===v.id))continue;return!1}return!0}Dbc(b){let h=null;if(b&&b.lu.toString()!==b.kz.toString())return{returnValue:!1,
tableNode:h};h=this.vj.Db(b.lu);return 14===h.type&&this.Rxb.Dbc(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}Rgi(b,h,v){const D=[];Ig.forEachCellInTable(Object(Ka.a)(ne.GraphIterator,b),(Q,ba,ta)=>{if(ba>=h&&ba<=v)ta||D.push([]),Ph.TableCellReader.hg(Q)||Array.add(D[ba-h],Q.currentNode);else if(ba>v)return!1;return!0});return D}Vdm(b,h,v){const D=[];Ig.forEachCellInTable(Object(Ka.a)(ne.GraphIterator,b),(Q,ba,ta)=>{ta>=h&&ta<=v&&(ta===h&&D.push([]),Ph.TableCellReader.hg(Q)||Array.add(D[ba],
Q.currentNode));return!0});return D}s4d(b){if(b&&14===b.type){b=Object(Ka.a)(ne.GraphIterator,this.Wc.Wf(b));const h=new zb.a;de.ParagraphReader.Jhb(b,!0,!1,h);b=Mg.SelectionFactory.ue(h.J(h.count-1),0);this.ib.setSelection(b)}}static get Ez(){ui.gta||(ui.gta=Ga.a.instance.Na("WordEditor.ITableBorderManager"));return ui.gta}static get DZm(){return null!=ui.zDg?ui.zDg:ui.zDg=Ga.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=ui.tDg?ui.tDg:ui.tDg=Ga.a.instance.resolve("Box4.List.IListEditor")}Zsi(b,
h){const v=new ne.GraphIterator;v.set(b);Ig.moveToFirstRow(v);Ig.moveToRowByIndex(v,h);do v.currentNode.Tk(4,!0);while(Ig.moveToNextRow(v))}static QAf(b,h){if(b){var v=rh.TableReader.fg(b),D=rh.TableReader.Yg(b);if(!(!Ya.App.xa.hb.tu.qe||0>h||h>=v))for(v=new ne.GraphIterator,v.set(b),b=0;b<D;b++){b?Ig.moveToNextColumn(v):Ig.moveToCell(v,h,b);if(!v||!v.currentNode||16!==v.currentNode.type)continue;let Q=v.currentNode;Ph.TableCellReader.Qr(Q)&&(Q=Ph.TableCellReader.nga(Q));Q&&Q.Tk(4,!0)}}else u.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static PAf(b,h){if(b){var v=rh.TableReader.fg(b),D=rh.TableReader.Yg(b),Q=new ne.GraphIterator;if(!(!Ya.App.xa.hb.tu.qe||0>h||h>=D))for(D=0;D<v;D++){Q.set(b);Ig.moveToCell(Q,D,h);if(!Q||!Q.currentNode)continue;let ba=Q.currentNode;Ph.TableCellReader.Qr(ba)&&(ba=Ph.TableCellReader.nga(ba));ba&&ba.Tk(4,!0)}}else u.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}ui.gta=null;Object(n.a)(ui,"TableEditor",
il.a,[340,341]);class iw{get name(){return"WordEditor.TableEditors"}xc(b){w.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.TableEditors.TableEditor",()=>new ui(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new Fg.a(()=>Ya.App.xa.hb.Uc.od),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Ci.a,Th.a.instance,b.Sa("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Sa("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),b.ha("WordEditor.TableEditors.TableBorderManager",()=>new ug).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Fc(new iw)}}Object(n.a)(iw,"WordEditorTableEditorsPackage",null,[1,2]);class Zw{get name(){return"WordEditor.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Zw)}}
Object(n.a)(Zw,"WordEditorTextLevelEditorsPackage",null,[1,2]);var xv=c(1957);c(466);var yv=c(757),jw=c(218),kw=c(245);class Tp{constructor(b){this.Cdk=b}Jbl(){const b=wq.a.instance.createInstance(393228);b.setValue(Gd.a.mL,jw.a.first);b.setValue(Gd.a.lwh,0);b.setValue(Gd.a.zha,dh.OutlineReader.Bhl);(new yv.OutlineIndentInfo(!0)).egj(b);return b}o7(b,h,v=null){const D=b.currentNode;if(!b.gF(1))return this.Wib(b,null,h,v);Cd.OutlineElementReader.dL(b)&&ig.OutlineElementNavigator.NNf(b,!0);return Cd.OutlineElementReader.Dh(b)?
Tp.lg.yA(b,!1,h,v):(b.l5c(D),null)}$Rk(b){return dh.OutlineReader.NEf(b.currentNode)||Cd.OutlineElementReader.Dh(b)||Cd.OutlineElementReader.dL(b)||Ph.TableCellReader.isTableCell(b)}Wib(b,h=null,v=!1,D=null){if(!this.$Rk(b))return null;const Q=Tp.lg.ffb();this.Flo(Q,b);b.yGb(Q,h,1,null);b.Fi(Q);v&&(Tp.lg.YI(b,D),ig.OutlineElementNavigator.Vd(b));return Q}Flo(b,h){if(h=this.Z$l(h))switch(h.type){case 11:Tp.lg.jgf(h,b,!0);break;case 8:h=Tp.nf.isRtl(h),Tp.lg.kOb(b,h)}}Z$l(b){return this.Cdk.$$l(b)}jOb(b,
h){b.setValue(Gd.a.ar,h?11:9)}xgo(b,h){const v=kw.WordSectionNavigator.instance.EJ(b);return v?dh.OutlineReader.xX(b)!==h?(v.setValue(lc.a.Wcf,h),!0):!1:null}static get nf(){return bi.PageReader.instance}static get lg(){return Tp.nh||(Tp.nh=Ga.a.instance.resolve("Box4.IOutlineElementEditor"))}static set lg(b){Tp.nh=b}}Tp.nh=null;Tp.Be=null;Object(n.a)(Tp,"OutlineEditor",null,[401]);const $w=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new Tp(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();
b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new xv.a(b.Ue("Box4.IOutlineEditor"),b.Ue("Box4.List.IListEditor"),b.Ue("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").singleInstance()};
class ax{Mpj(){return{Lpj:!0,fKj:!1}}}Object(n.a)(ax,"CursorMovementValidator",null,[339]);class Yt{get name(){return"Box4.OutlineLevelEditors"}xc(b){b.ha("Box4.ListEditors.CursorMovementValidator",()=>new ax).as("Box4.List.ICursorMovementValidator").singleInstance();$w(b)}init(){}dispose(){}static main(){N.a.instance.Fc(new Yt)}}Object(n.a)(Yt,"Box4OutlineLevelEditorsPackage",null,[1,2]);class lw{constructor(b){this.qHd=null;this.JRi=b.jb("OfficeOnlineChromeExtensionId");this.RRi=b.jb("ChromeClipboardAccessExtensionId");
this.UFm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.lfh=!this.WNm();this.qHd=this.BOb?this.RRi:this.JRi}H4n(){this.qHd===this.JRi&&this.gyi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.qHd=this.RRi;this.lfh=!0}get BOb(){return this.lfh}WNm(){if(this.UFm&&this.gyi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get gyi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){u.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(n.a)(lw,"ChromeExtensionHelper",null,[1294]);var Xu=c(1444),mw=c(672),Zt=c(1399);class Os{create(b){return new Zt.a(b)}}Object(n.a)(Os,"Factory",null,[658]);var eq=c(139);class Am{constructor(b,
h,v){this.enk=b;this.ve=h;this.rYa=v}Tb(){this.rYa.fb(Eb.a.w$d,Zb.a.application,this.w$d.bind(this),96);this.rYa.qa(Eb.a.vmc,Zb.a.view,this.NXo.bind(this));this.rYa.fb(Eb.a.Z4i,Zb.a.view,this.PXo.bind(this),96)}w$d(b,h,v,D,Q){if(1===v)return 32;b=Object.assign(new Yd.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];v=Object.assign(new $g.a,{ControlList:[]});v.ControlList.push(Object.assign(new fg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));
h.push(v);Array.addRange(b.MenuSectionList,h);Q.MenuItems=b;return 32}PXo(b,h,v,D,Q){if(1===v)return 32;b=Pl.a.Ovj();null==b&&8;b=this.ve.vM(b);Q[cl.a.LabelText]=String.format(G.a.Af(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}NXo(b,h,v){b=Pl.a.UHb(h);if(1===v||b)return b?8:32;v=new Map;v.set("Source","StyleContextMenuActor");v.set("Action","UpdateStyle");wa.Health.instance.recordKpiUsage(eq.a.wza,0,eq.a.sB,v);this.enk.Umg(h)?Lc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new wb.a,{extendedProperties:h}),wa.Health.instance.recordKpiFailure(eq.a.wza,"UpdateStyleFailed",!1,!0,h),Lc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(n.a)(Am,"StyleContextMenuActor",null,[]);var yt=c(1030),bx=c(1512),hr=c(442),gs=c(1756);class Ps extends gs.a{constructor(b,h,v,D,Q,ba,ta=null,Ta=null){super(b,ba,ta,Ta);this._formatting=
null;this.rKa=!1;this.qtb=w.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Bvb=0;this.JBc=new zb.a;Lc.a(8128527,307,Cd.OutlineElementReader.Dh(b));this.ZL=h;this.ZL.r1b(this);this.gq=v;this.Un=D;this.Gd=Q;this.$3e=Ta;this.dNe=Hg.ListItemReader.Ig(this.Ec)}get paragraphEditor(){return null!=this.ZEg?this.ZEg:this.ZEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get iHd(){return null}get q3b(){return this.dNe&&!this.ZL.pDa}get KBb(){return 0<this.Bvb}Eca(b,h){if(!this.$Y.Ckg(this.Ec,
h,!0)){Lc.a(8701077,307,de.ParagraphReader.sh(this.Ec));var v=this.Ec.currentNode,D=Pe.a.jw(v);this.qtb&&this._formatting.MQ&&(v=v.pa.last,this.rKa&&(v.formatting=this._formatting.MQ.Ef(v),this.rKa=!1),b=this.$Y.zwf(b,h),this.$Y.Q9(this.Ec.currentNode,this._formatting.Kca,h));this.characterPropertiesEditor.replaceTextRange(D,b)}}Dca(){Lc.a(8701078,307,de.ParagraphReader.sh(this.Ec));const b=Pe.a.jw(this.Ec.currentNode);this.characterPropertiesEditor.Zga(b,h=>new hr.a(h))}omb(){this.$Y.Gwf(this.Ec)}kGa(){this.qtb&&
(this.rKa=!0)}tRa(){Lc.a(8701079,307,de.ParagraphReader.sh(this.Ec))}sRa(){Lc.a(8701080,307,de.ParagraphReader.sh(this.Ec))}aE(b){this.ZL.pDa||(this.qtb?(this.N0e(b),this._formatting.kme(this.Ec.currentNode),b&&"P"===b.o9.lVd&&this.$3e.gda(this.Ec.currentNode,this._formatting.BR),this.$Y.Q9(this.Ec.currentNode,this._formatting.Kca,b)):this.lJk(b))}oF(){this.ZL.pDa||this.EKc()}yRa(){}G4a(){}xxa(){Lc.a(8701081,307,Cd.OutlineElementReader.Dh(this.Ec)||dh.OutlineReader.fx(this.Ec)||de.ParagraphReader.sh(this.Ec)&&
this.ZL.pDa);let b=!1;this.KBb||(b=this.q3b||!0);b||(this.QU+=1);this.Bvb++}vxa(){this.Bvb--;let b=!1;this.KBb||(b=this.q3b||!0,this.Un.o$i(this.JBc));b||--this.QU}pGa(b){Lc.a(8701082,307,Cd.OutlineElementReader.Dh(this.Ec)||dh.OutlineReader.fx(this.Ec)||de.ParagraphReader.sh(this.Ec)&&this.ZL.pDa);Lc.a(8701083,307,!!b.listStyleType)}wxa(){Lc.a(8701084,307,Cd.OutlineElementReader.Dh(this.Ec)||de.ParagraphReader.sh(this.Ec)&&this.ZL.pDa);this.ZL.pDa||Lc.a(8701085,307,this.Ec.Nr(2))}k9(b){this.ZL.k9(b)}i9(){this.ZL.i9()}N$c(b){this.JBc.add(b)}K4(b){this.ZL.K4(b)}j9(){this.ZL.j9()}h9(b){this.ZL.h9(b)}g9(){this.ZL.g9()}lJk(b){this.Mdc(!1);
(new ne.GraphIterator).Zc(this.Ec);b=gs.a.lg.YI(this.Ec,this.FOc(b));Lc.a(8128534,307,b===this.Ec.currentNode);Lc.a(8128535,307,de.ParagraphReader.Vb(b))}EKc(){Lc.a(8128536,307,de.ParagraphReader.sh(this.Ec));ig.OutlineElementNavigator.Vd(this.Ec)}reset(){this.qtb&&(super.reset(),this._formatting=this.bpf(!0))}N0e(b){this.Mdc(!1);(new ne.GraphIterator).Zc(this.Ec);b=gs.a.lg.YI(this.Ec,this.FOc(b));Lc.a(36577367,307,b===this.Ec.currentNode);Lc.a(36577368,307,de.ParagraphReader.Vb(b));-1!==this._formatting.rw&&
this.paragraphEditor.gE(b,this._formatting.rw);this._formatting.lineSpacing&&this.$3e.fD(b,this._formatting.lineSpacing);this._formatting.q5&&this.$3e.Zge(b,this._formatting.q5);this.rKa=!0;this._formatting.paragraph=b}static g$e(b,h){let v=0;switch(h){case 3:v=Nf.a.Hv(b);break;case 7:v=Cf.a.Cy(b,0);break;case 1:v=Nf.a.i6e(b);break;case 5:v=Nf.a.Hv(Nf.a.iZf(b));break;default:u.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
b,h)}return v}}Object(n.a)(Ps,"TextOnlyBox4PasteSteward",gs.a,[]);class cx extends Ps{constructor(b,h,v,D,Q,ba,ta,Ta=null,ob=null){super(h,v,D,Q,ba,ta,Ta,ob);this.hvc=!1;this.pub=[];this.Whh=b;h={};h.textOnlyPasteFlags=b;u.ULS.sendTraceTag(509088282,307,50,F.c(h))}reset(){super.reset();this.hvc=!1;this.pub.length=0;this.vld=!1}aE(b){this.hvc||(super.aE(b),this.hvc=!0)}oF(){this.vld?this.vld=!1:this.Dca(null)}Dca(b){this.Whh&2||super.Dca(b)}xxa(){}vxa(){}pGa(){}wxa(){}k9(){}i9(){}K4(b){this.hvc||(super.K4(b),
this.hvc=!0);this.pub.push(!1)}j9(){this.Whh&1&&this.Dca(null);0<this.pub.length?this.pub.pop():Lc.a(509088281,307,!1)}h9(){var b=this.pub.length-1;0<=b?this.pub[b]?(b=Pe.a.jw(this.Ec.currentNode),this.characterPropertiesEditor.replaceTextRange(b,", ")):this.pub[b]=!0:Lc.a(509088280,307,!1);this.vld=!0}g9(){this.vld=!1}N$c(){}}Object(n.a)(cx,"StrictTextOnlyBox4PasteSteward",Ps,[]);class nw{constructor(b,h,v,D){this.lMe=b;this.qK=h;this.If=v;this.$Y=D}create(b,h,v,D,Q=null,ba=null,ta=null,Ta=null){return 1===
b?null!==Ta&&0!==Ta?new cx(Ta,h,D,this.lMe,this.qK,this.If,Q,ba,this.$Y):new Ps(h,D,this.lMe,this.qK,this.If,Q,ba,this.$Y):new bx.Box4PasteSteward(h,v,D,this.lMe,this.qK,this.If,Q,ba,this.$Y,ta)}}Object(n.a)(nw,"Box4PasteStewardFactory",null,[657]);var oz=c(186),zv=c(334),pp=c(1570);class rs{constructor(b,h,v){this.Ky=null;this.Cvb=0;this.PL=null;this.Ec=b;this.vk=v}r1b(b){this.Ky=b}get pDa(){return 0<this.Cvb}k9(b){var h;Lc.a(7869459,307,!!this.Ky);Lc.a(7869460,307,Cd.OutlineElementReader.Dh(this.Ec)||
dh.OutlineReader.fx(this.Ec));Lc.b(38563978,307,50,"Table pasting started");this.Ky.Mdc(!0);const v=new ne.GraphIterator;v.Zc(this.Ec);let D=pp.a.gtm[b.styleId];D||(w.AFrameworkApplication.te("gdea6103;0df65435"),(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.DBf?(u.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),D=pp.a.Cgn):D=pp.a.nPh);h=this.vk.tSn(this.Ec,b.rowCount,b.Deb,
D,b.tableLook,this.Ky.FOc(b),b.DBf);b.qhg&&(Lc.b(573691298,3022,100,"Applying table border properties"),pp.a.Ysh(b.qhg,this.Ec,!1,!0));b.YVd&&(Lc.b(573691299,3022,100,"Applying indentation properties"),pp.a.SDk(this.Ec,b.YVd.spaceBefore,b.YVd.spaceAfter));b.bEd&&(Lc.b(573691328,3022,100,"Applying column widths"),pp.a.zDk(b.bEd,this.Ec,Object(Ka.a)(zv.TableNode,h),b.j3a));this.Ky.CAd(v,!1);this.Cvb++;Hg.ListItemReader.Ig(v)&&this.Ky.N$c(v.currentNode);Lc.a(7869461,307,rh.TableReader.isTable(this.Ec))}i9(){Lc.a(7869462,
307,!!this.Ky);Lc.a(7869463,307,Kl.a.isTableRow(this.Ec));Lc.b(38563979,307,50,"Table pasting finished");this.BU&&this.Ec.Ht(14)&&pp.a.jgj(this.Ec.Nn);ig.OutlineElementNavigator.Vd(this.Ec);this.Cvb--}K4(b){Lc.a(7869464,307,!!this.Ky);Lc.b(573691329,3022,100,"Table row pasting started");rh.TableReader.isTable(this.Ec)?Ig.moveToFirstRow(this.Ec):Kl.a.isTableRow(this.Ec)&&Ig.moveToNextRow(this.Ec);b.height&&(Lc.b(573691330,3022,100,"Applying table row height"),pp.a.KEk(this.Ec,b.height));Lc.a(7869465,
307,Kl.a.isTableRow(this.Ec))}j9(){Lc.a(7869466,307,!!this.Ky);Lc.a(7869467,307,Ph.TableCellReader.isTableCell(this.Ec));Ig.returnToContainingRow(this.Ec)}h9(b){Lc.a(7869468,307,!!this.Ky);Lc.a(7869469,307,!this.Ky.QU);Kl.a.isTableRow(this.Ec)?Ig.moveToFirstColumn(this.Ec):Ph.TableCellReader.isTableCell(this.Ec)?Ig.moveToNextColumn(this.Ec):Lc.a(7869471,307,!1);if(this.Ec.currentNode){Lc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Ka.a)(oz.TableCellNode,this.Ec.currentNode);Lc.a(50689760,
307,!h&&16!==this.Ec.currentNode.type||!!h&&16===this.Ec.currentNode.type);if(h){var v=new ne.GraphIterator;v.Zc(this.Ec);if(b.xbc)Lc.b(573691332,3022,100,"Processing skipped cell"),pp.a.tIn(v,b);else{if(1<b.colSpan||1<b.rowSpan){const D=Ig.returnToContainingTable(v);if(!D)return;D.setValue(lc.a.complexTable,!0);v.Zc(this.Ec);Lc.b(573691333,3022,100,"Processing merged cell");pp.a.KHn(v,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}pp.a.QEk(this.Ec,b.shadingColor);pp.a.FFk(this.Ec,b.verticalAlignment);
pp.a.mDk(this.Ec,b.Ake);pp.a.Ysh(b.lja,this.Ec,!b.colSpan&&!b.rowSpan,!1);(new ne.GraphIterator).Zc(this.Ec);Ig.forEachCell(v,b.rowSpan,b.colSpan,(D,Q,ba)=>{Lc.b(573691334,3022,100,"Setting ghost cell borders");pp.a.Kkj(D,b.lja,Q,ba,b.rowSpan,b.colSpan)});pp.a.HFk(this.Ec,b.width,b.j3a);Lc.a(7869472,307,dh.OutlineReader.fx(this.Ec))}}}}g9(){Lc.a(7869473,307,!!this.Ky);Lc.a(7869474,307,Cd.OutlineElementReader.Dh(this.Ec)||Ph.TableCellReader.isTableCell(this.Ec));Ig.returnToCell(this.Ec);Lc.a(7869475,
307,0>=this.Ky.QU);this.Ky.f7e()}get BU(){null==this.PL&&(w.AFrameworkApplication.te("he991617;3eed2178"),this.PL=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.PL}}Object(n.a)(rs,"Box4TableSteward",null,[681,299]);class uk{constructor(b,h,v){this.Ky=null;this.Cvb=0;this.Ec=b;this.vk=v}r1b(b){this.Ky=b}get pDa(){return 0<this.Cvb}k9(){this.pDa&&(Lc.a(8787101,307,de.ParagraphReader.sh(this.Ec)),
ig.OutlineElementNavigator.Vd(this.Ec));Lc.a(8701086,307,!!this.Ky);Lc.a(8701087,307,Cd.OutlineElementReader.Dh(this.Ec)||dh.OutlineReader.fx(this.Ec));this.Cvb++}i9(){Lc.a(8701088,307,!!this.Ky);ig.OutlineElementNavigator.Vd(this.Ec);this.Cvb--;if(this.pDa){this.Ky.Mdc(!0);const b=uk.lg.YI(this.Ec);Lc.a(8787102,307,b===this.Ec.currentNode);Lc.a(8787103,307,de.ParagraphReader.sh(this.Ec))}}K4(b){Lc.a(8701089,307,!!this.Ky);this.Ky.Mdc(!0);const h=new ne.GraphIterator;h.Zc(this.Ec);this.Ky.CAd(h,!1);
Hg.ListItemReader.Ig(h)&&this.Ky.N$c(h.currentNode);b=uk.lg.YI(this.Ec,this.Ky.FOc(b));Lc.a(8701090,307,b===this.Ec.currentNode);Lc.a(8701091,307,de.ParagraphReader.sh(this.Ec))}j9(){Lc.a(8701120,307,!!this.Ky);Lc.a(8701121,307,de.ParagraphReader.sh(this.Ec));ig.OutlineElementNavigator.Vd(this.Ec)}h9(){Lc.a(8701122,307,!!this.Ky);Lc.a(8701123,307,de.ParagraphReader.sh(this.Ec));Lc.a(8701124,307,!this.Ky.QU);var b=this.Ec.currentNode;de.ParagraphReader.textLength(b)&&(b=Pe.a.jw(b),this.Ky.characterPropertiesEditor.replaceTextRange(b,
", "))}g9(){Lc.a(8701125,307,!!this.Ky);Lc.a(8701126,307,de.ParagraphReader.sh(this.Ec));Lc.a(8701127,307,0>=this.Ky.QU);this.Ky.f7e()}static get lg(){return null!=uk.nEg?uk.nEg:uk.nEg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(n.a)(uk,"TextOnlyBox4TableSteward",null,[681,299]);class xq{constructor(b,h,v=!1,D=!1){this.qK=b;this.cA=h;this.hek=v;this.oek=D}create(b,h){return 1===b?new uk(h,this.qK,this.cA):new rs(h,this.qK,this.cA,this.hek,this.oek)}}Object(n.a)(xq,"Box4TableStewardFactory",
null,[656]);class pm{create(){return new Km.a}}Object(n.a)(pm,"Factory",null,[654]);class fq{constructor(b){this.ga=b}Rdn(b){if(4===b)b=Eb.a.IFa;else if(2===b)b=Eb.a.Hia;else if(1===b)b=Eb.a.AQb;else if(3===b)b=Eb.a.V_a;else return;this.ga.processAction(b,2)}ogb(){this.ga.processAction(Eb.a.ogb,2)}}Object(n.a)(fq,"SelectionCommands",null,[653]);var Lo=c(250),Av=c(1089),hs=c(138),xy=c(631);class Qs{constructor(){this.vWc=!1;this.s1o=w.AFrameworkApplication.K.jb("WordEditorVisiFontFileUri");this.u1o=
w.AFrameworkApplication.K.jb("WordEditorVisiRtlFontFileUri");this.t1o=w.AFrameworkApplication.K.jb("WordEditorVisiPilcrowFontFileUri");this.p1o=w.AFrameworkApplication.K.jb("WordEditorVisiCarriageReturnFontFileUri");this.r1o=w.AFrameworkApplication.K.jb("WordEditorVisiCarriageReturnRtlFontFileUri")}MJo(){this.vWc=!this.vWc}LJo(b){this.MJo();let h=b.getElementsByClassName("VisiFontStyle")[0],v=b.getElementsByClassName("VisiFontRtlStyle")[0],D=b.getElementsByClassName("VisiFontPilcrowStyle")[0],Q=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],
ba=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",jc.a.Gy(h,""),b.appendChild(h));v||(v=document.createElement("Style"),v.className="VisiFontRtlStyle",jc.a.Gy(v,""),b.appendChild(v));D||(D=document.createElement("Style"),D.className="VisiFontPilcrowStyle",jc.a.Gy(D,""),b.appendChild(D));Q||(Q=document.createElement("Style"),Q.className="VisiFontCarriageReturnStyle",jc.a.Gy(Q,""),b.appendChild(Q));ba||(ba=document.createElement("Style"),
ba.className="VisiFontCarriageReturnRtlStyle",jc.a.Gy(ba,""),b.appendChild(ba));if(this.vWc)return u.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.sEc(h)&&this.sEc(v)&&this.sEc(D)&&this.sEc(Q)&&this.sEc(ba);u.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.k4c(h)&&this.k4c(v)&&this.k4c(D)&&this.k4c(Q)&&this.k4c(ba)}sEc(b){return""===jc.a.tA(b)?("VisiFontStyle"===b.className?jc.a.Gy(b,this.ZNc("WordVisi_MSFontService",this.s1o)):"VisiFontRtlStyle"===
b.className?jc.a.Gy(b,this.ZNc("WordVisiRtl_MSFontService",this.u1o)):"VisiFontPilcrowStyle"===b.className?jc.a.Gy(b,this.ZNc("WordVisiPilcrow_MSFontService",this.t1o)):"VisiFontCarriageReturnStyle"===b.className?jc.a.Gy(b,this.ZNc("WordVisiCarriageReturn_MSFontService",this.p1o)):"VisiFontCarriageReturnRtlStyle"===b.className&&jc.a.Gy(b,this.ZNc("WordVisiCarriageReturnRtl_MSFontService",this.r1o)),!0):!1}k4c(b){return""!==jc.a.tA(b)?(jc.a.Gy(b,""),!0):!1}ZNc(b,h){return"@font-face { font-family: "+
b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(n.a)(Qs,"VisiMarkersOperation",null,[649]);var yy=c(446),$t=c(375);class ow extends yy.a{constructor(b,h){super(b,h);this.UDe=-1;this.otb=0;this.IAe=null;this.dZg=!1;this.WBe=[];this.pmd=!1;this.f7g=!0;this.yLe=this.dkd=null;this.preventDismissOnScroll=this.P$d=this.cgc=!1;this.J7=null;this.Fwd=!1;this.JQc=!0;this.Is=!1;this.r0g=w.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");ow.Ubh||
(w.AFrameworkApplication.va.qa(Ua.a.showFloatie,Kd.a.frame,Rc.ActionManager.Pf),ow.Ubh=!0)}get T_h(){return this.eO}set T_h(b){this.eO=b}get Mzj(){return this.Fwd}get VRc(){return this.dZg}set VRc(b){this.dZg=b;this.otb=0}get WA(){return!0}get cssClass(){return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.N8?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Is}USa(){for(let b of this.children)if(b.USa())return!0;return!1}get H9(){return 9}Jf(b){this.WBe[this.WBe.length]=
b;super.Jf(b)}ym(){super.ym();qf.c(this.Nc)&&this.DC();this.Nc=ka.a.tSa(this.Nc);this.RW(this.Nc);this.dirty=!1}Aec(b){3===b.kg||this.P$d||this.Xw(b);return!1}Dec(){return!1}Bec(b){3!==b.kg&&this.JQc&&!this.cgc&&this.hWo(b);return!1}Cec(){return!1}yec(b){3===b.kg&&this.Xw(b);return!1}zec(b){void 0!==this.J7&&null!==this.J7||this.preventDismissOnScroll||this.Xw(b);return!1}$C(){this.Ehf();return!1}c7d(){this.VRc=!0}hWo(b){if(b=ye.a.N4b(b.clientPoint,this.IAe)){if(this.VRc){if(!this.otb||b<this.otb)this.otb=
b;b-=this.otb}b-=this.UDe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.Xw():aa.a.setOpacity(this.Nc,Math.max(h/255,0))}else this.VRc=!1,this.otb=0,aa.a.setOpacity(this.Nc,1)}zUo(b){let h=null;void 0!==this.dkd&&null!==this.dkd&&(h=this.dkd(b));b=null;for(const v of this.WBe){let D=!this.Mzj&&v.qCi;if(!D&&void 0!==h&&null!==h)for(let Q=0;Q<h.length;Q++)if(v.id===h[Q]){D=!0;break}v.Nc.style.display=D?"none":"";v.K4b=!D;D||(b=v)}b&&(b.K4b=!1)}I8h(){const b=this.Nc.style.top,h=this.Nc.style.left;this.Nc.style.top=
"0px";this.Nc.style.left="0px";const v=this.hEb();this.Nc.style.top=b;this.Nc.style.left=h;return v}hEb(){const b=this.Nc.style.visibility,h=this.Nc.style.display;this.Nc.style.visibility="hidden";this.Nc.style.display="";const v=Id.a.getElementBounds(this.Nc);this.Nc.style.display=h;this.Nc.style.visibility=b;return v}O7i(b){3===b||this.Tle?(Sys.UI.DomElement.addCssClass(this.Nc,$t.a.eQb),this.Fwd=!0):(Sys.UI.DomElement.removeCssClass(this.Nc,$t.a.eQb),this.Fwd=!1);this.zUo(b)}K6a(b,h,v,D=!1){this.isVisible||
(this.J7||!this.f7g&&this.preventDismissOnScroll||(this.f7g=!1,Id.a.P3d("ShowLegacyFloatie",""),w.AFrameworkApplication.va.processAction(Ua.a.showFloatie,2)),this.O7i(v),this.JQc=!0,this.otb=0,this.VRc=!1,!this.r0g||void 0!==this.J7&&null!==this.J7?(this.pmd=!1,this.ufa(this,!1)):(this.pmd=!0,this.kJk(this)),h=D?b:this.MDn(b,h),this.Nc.style.top=h.y.toString()+"px",this.Nc.style.left=h.x.toString()+"px",this.iu(),this.IAe=this.hEb(),this.UDe=ye.a.N4b(b,this.IAe),aa.a.setOpacity(this.Nc,1),this.Nc.style.zIndex=
String(w.AFrameworkApplication.ta.Ata),this.Nc.style.display="",this.Is=!0)}MDn(b,h){const v=this.Mzj?30:17,D=this.I8h(),Q=jc.a.oFb(),ba=jc.a.HX();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=D.height:3===h?(b.y-=D.height,b.x-=D.width):2===h&&(b.x-=D.width);b.x+D.width>Q&&(b.x=Math.floor(Q-D.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-v:b.y+v;0>b.y&&(b.y=0);b.y+D.height>ba&&(b.y=ba-D.height);return b}NDn(b,h){const v=b.pNi;if(v){this.O7i(h);var D=this.I8h();this.J7=b;b=v.mog-v.oMc>D.width;var Q=v.oMc+v.Ykf>
D.width,ba=v.p6b>D.height+17,ta=v.tJj-(v.p6b+v.Ukf)>D.height+17;D=new Sys.UI.Point(v.oMc,v.p6b);Q||b||(Q=!0,D.x=v.mog);b=v.Fkb?v.DIf?ta?Q?2:0:Q?3:1:ba?Q?3:1:Q?2:0:v.DIf?ta?b?0:2:b?1:3:ba?b?1:3:b?0:2;if(3===b||2===b)D.x=v.oMc+v.Ykf;if(2===b||0===b)D.y=v.p6b+v.Ukf;this.K6a(D,b,h);this.JQc=!1;h=this.J7.cYe.Nc;void 0!==h&&null!==h&&(h.style.zIndex=String(w.AFrameworkApplication.ta.Ata))}}y3(){let b=super.y3();this.Xw()&&(b=!0);return b}Xw(b=null){if(!this.isVisible)return!1;void 0!==this.nDc&&null!==
this.nDc&&this.nDc.Nua(null);void 0!==this.J7&&null!==this.J7&&this.J7.n3();this.n3();this.r0g&&this.pmd?this.Mtl(this):this.nba(this,!1);this.pmd=!1;this.UDe=-1;this.J7=null;this.Nc.style.display="none";this.Is=!1;this.yLe&&this.yLe(b);return!0}Ehf(){void 0!==this.J7&&null!==this.J7&&(this.J7.NYa=null,this.J7.n3(),this.J7=null,this.h4d.style.zIndex=String(w.AFrameworkApplication.ta.ZBa),this.Nc.style.zIndex=String(w.AFrameworkApplication.ta.Ata))}WUn(b){this.dkd=b}IVn(b){this.yLe=b}set WA(b){super.WA=
b}}ow.Ubh=!1;Object(n.a)(ow,"Floatie",yy.a,[429,441,542]);class dx{constructor(b,h){this.uv=this.oKa=null;this.GKi=b;this.lfj=h}get V_h(){return this.oKa}boo(b){this.oKa=b}hEb(){return this.uv.hEb()}X_(){return this.uv?this.uv.isVisible:!1}Xvh(b){this.boo(b)}showFloatie(b,h){this.K6a(h.location,h.Ix,h.isRtl)}K6a(b,h,v){v=v?this.lfj:this.GKi;this.hKd();this.uv&&this.uv.K6a(b,v,h)}Xw(){this.uv&&this.uv.Xw()}hKd(){this.oKa&&!this.uv&&(this.uv=Object(Ka.a)(ow,this.oKa()))}XKd(){}}Object(n.a)(dx,"AFloatieManager",
null,[676]);class Gu extends dx{constructor(){super(1,3);this.Sxj=!1;this.AQh=""}K6a(b,h,v){v=v?this.lfj:this.GKi;this.hKd();this.uv&&(this.uv.isVisible&&this.uv.Xw(),this.Sxj||this.uv.xm(),this.uv.K6a(b,v,h,!0))}hKd(){this.V_h&&!this.uv&&(this.uv=this.oKa())}XKd(){if(this.uv&&this.uv.isVisible){const b=Object(Ka.a)(Jk.Control,this.uv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.Yw(b.phb(),1,null)}}rbg(b){this.AQh=b}k1n(b){b=b.Zof("Menu16",null);Lh.a("renderIcon")&&b&&appChrome.api.renderIcon(Gu.g0j,
b.firstElementChild)}umc(b,h,v){if(this.uv){const D=this.uv.controls[this.AQh];D&&(Gu.P_g||(this.k1n(D),Gu.P_g=!0),D.Pd[Aj.a.labelText]=b,D.Pd[Aj.a.alt]=h,v&&D.behavior.xm())}}}Gu.P_g=!1;Gu.g0j="Designer_20";Object(n.a)(Gu,"PasteFloatieManager",dx,[]);var pw=c(1038);class vk{constructor(){this.Nd=null}get Uw(){return null}getTitle(){return null}g7h(){return null}reset(b){this.Nd=b.node}qIa(b){b=Ba.d(this.Nd,b);let h=null;if(!b||b.Bh!==this.Bh)return{returnValue:!1,RF:h};h=Object.assign(new pw.a,{LG:this.key,
contentObject:b,title:this.getTitle(b),description:this.g7h(b)});return{returnValue:!0,RF:h}}}Object(n.a)(vk,"BlobDetailsProvider",null,[567,568]);class ss extends vk{constructor(){super()}get key(){return"EQUATION"}get Bh(){return 11}get Uw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(n.a)(ss,"EquationDetailsProvider",vk,[]);class oB{constructor(){this.HYg=null}get key(){return"LINK"}get Uw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.HYg=ue.HyperlinkReader.nOc(b.node)}qIa(b){let h=
null;for(const v of this.HYg)if(v.cpBegin<=b&&b<v.cpEnd)return h=Object.assign(new pw.a,{LG:this.key,contentObject:v.hyperlink}),{returnValue:!0,RF:h};return{returnValue:!1,RF:h}}}Object(n.a)(oB,"HyperlinkDetailsProvider",null,[567,568]);var ex=c(1378),au=c(899);class nn{constructor(){this.u2g=!1}get key(){return"IFRAMENODE"}get Uw(){return this.u2g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}Vlc(b){let h=null;b=b?de.ParagraphReader.WOa(b.currentNode):null;
if(!b)return{returnValue:!1,vma:h};h=Object.assign(new ex.a,{LG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,vma:h}}WDb(b,h){b=b?Object(Ka.a)(au.a,b.contentObject):null;h=h?Object(Ka.a)(au.a,h.contentObject):null;let v="";h&&b.id===h.id||(this.u2g=b.t3a,v=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Uw,this.Uw));return v}}Object(n.a)(nn,"IFrameDetailsProvider",null,[677,568]);class qC extends vk{constructor(){super()}get key(){return"IMAGE"}get Bh(){return 5}reset(b,
h){super.reset(b,h);this.z8j=!We.SelectionEditor.km(h)}get Uw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return ke.ImageReader.BX(b.properties)}g7h(b){var h;b=ke.ImageReader.YOa(b.properties);return null!==(h=Ya.App.instance)&&void 0!==h&&h.aHf&&this.z8j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(n.a)(qC,"ImageDetailsProvider",vk,[]);class lB{get key(){return"IMAGENODE"}get Uw(){return Box4Intl.Box4Strings.l_ImageContentTitle}Vlc(b){let h=
null;if(!b||!ke.ImageReader.Eu(b.currentNode))return{returnValue:!1,vma:h};h=Object.assign(new ex.a,{LG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,vma:h}}WDb(b,h){b=b.contentObject;const v=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let D="";h&&b.id===h.contentObject.id||(D=String.format(v,ke.ImageReader.BX(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return D}}Object(n.a)(lB,"ImageNodeDetailsProvider",null,[677,568]);let Nx,cw;class jl{constructor(b,
h){this.GTg=null;this.sn=h;this.oOe=b;this.key=jl.keys.J(b);this.Uw=jl.X4k.J(b)}reset(b){this.GTg=this.sn.Q3(b.node)}qIa(b){var h=jl.GDl(this.GTg||[],v=>this.vHm(b,v));h=this.g9k(h);return{returnValue:!!h,RF:h}}vHm(b,h){return h.begin<=b&&b<h.end&&(!h.errorDetails||this.oOe===h.errorDetails.proofingType)}g9k(b){return b?Object.assign(new pw.a,{LG:this.key,contentObject:b.errorDetails,description:this.lhb()}):null}lhb(){return w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?
Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static GDl(b,h){for(const v of b)if(h(v))return v;return null}}jl.keys=(cw=new Oh.a,cw.add(1,"SPELLINGERROR"),cw.add(2,"GRAMMATICALERROR"),cw.add(3,"ADVANCEDERROR"),cw);jl.X4k=(Nx=new Oh.a,Nx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Nx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Nx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Nx);Object(n.a)(jl,"ProofingDetailsProvider",null,[567,568]);
class kz{constructor(){this.tableNode=null;this.$Dd=this.uee=this.columns=this.rows=0}}Object(n.a)(kz,"TableInfo",null,[]);class lA{get key(){return"TABLE"}get Uw(){return Box4Intl.Box4Strings.l_TableContentTitle}Vlc(b){var h=null;if(!Ph.TableCellReader.isTableCell(b))return{returnValue:!1,vma:h};h=new ne.GraphIterator;h.Zc(b);b=new kz;b.uee=Kl.a.xs(h)+1;b.$Dd=hw.a(h)+1;Ig.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=rh.TableReader.Yg(b.tableNode);b.rows=rh.TableReader.fg(b.tableNode);
h=Object.assign(new ex.a,{LG:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,vma:h}}WDb(b,h){b=b.contentObject;const v=new sf.a;h||v.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.$Dd===b.$Dd||v.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.$Dd));h&&h.contentObject.uee===b.uee||v.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.uee));return v.toArray().join(" ")}}
Object(n.a)(lA,"TableDetailsProvider",null,[677,568]);class xu{constructor(b,h){this.tKa=b;this.sn=h}get RQb(){return null!=this.IIg?this.IIg:this.IIg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}P3f(){this.tKa.execute(b=>{b.V4(new oB);this.RQb||(b.V4(new jl(1,this.sn)),b.V4(new jl(2,this.sn)));b.V4(new jl(3,this.sn));b.V4(new ss);b.V4(new qC);b.Rgc(new lA);b.Rgc(new lB);b.Rgc(new nn)})}}Object(n.a)(xu,"AccessibilityActor",null,[]);
class mA{constructor(b,h,v){this.tvn=(D,Q,ba)=>{if(1===ba)return 32;this.DWj().eeg();return 32};this.rYa=b;this.DWj=v}Tb(){this.rYa.fb(Eb.a.hYi,Zb.a.view,this.tvn,1028)}}Object(n.a)(mA,"AutoCorrectActor",null,[]);var lz=c(1958);class os{constructor(){this.K3d=!0}txa(){}I4a(){}r1b(){}XUf(){}qge(){}get Ifc(){return!1}get Jlb(){return 0}get HMi(){return!1}get lX(){return sb.a.nil}}Object(n.a)(os,"TextOnlyBox4ImageSteward",null,[675]);class ih{constructor(b,h,v,D,Q,ba,ta=!1){this.TO=b;this.taskManager=
h;this.Pg=v;this.Qum=D;this.notificationBar=Q;this.Xb=ba;this.w0m=ta}create(b,h,v,D){return 1===b?new os:new lz.a(h,this.TO,this.taskManager,this.Pg,this.Xb,this.Qum,this.notificationBar,this.w0m,v,D)}}Object(n.a)(ih,"Box4ImageStewardFactory",null,[647]);var $l=c(37);class kk{constructor(b){this.EZd=b}tOm(b){if(!b||!b.xB||1>b.xB.count)return!1;const h=[$l.a.vNh,$l.a.uNh];return!!this.UNd(b.xB,1,v=>this.eFd(v,h))}Qvi(b){return!b||!b.xB||1>b.xB.count?!1:!!this.UNd(b.xB,1,h=>this.eFd(h,[$l.a.pG]))}vLm(b){return!b||
!b.xB||1>b.xB.count?!1:!!this.UNd(b.xB,2,h=>this.eFd(h,[$l.a.rXc]))}sh(b){return!b||!b.xB||1>b.xB.count?!1:!!this.UNd(b.xB,1,h=>this.eFd(h,[$l.a.vpa]))}wYd(b){if(!b||!b.xB)return!1;b=b.xB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).wHk)return!1;return!0}uwl(b,h){return this.Qvi(h)||this.vLm(h)?"":b}UNd(b,h,v){if(b&&0<b.count)for(let D=b.count-1;0<=D;--D){if(v(b.J(D)))return b.J(D);if(b.count-D>=h)break}return null}eFd(b,h){b=b&&b.Vni?b.Vni.split(" "):null;if(!b)return!1;for(const v of h)if(0<=
Array.indexOf(b,v))return!0;return!1}}Object(n.a)(kk,"Box4PasteStewardUtils",null,[648]);var Mf=c(720);class qv{constructor(){this.gmc=0;this.Kcc=Array(9)}}Object(n.a)(qv,"FullListMetadata",null,[]);class Vu{constructor(b,h,v){this.gmc=this.level=0;this.lYh=null;this.Bfc=!1;this.level=b;this.bpe=h;this.zwn=v}}Object(n.a)(Vu,"ListItemMetadata",null,[]);var yu=c(1573);class jj{constructor(){this.level=0;this.tagName="UL";this.olb=null;this.ignore=!1;this.fin=0;this.listStyle="BulletListStyle1";this.Skb=
new yu.a;this.font=this.levelText=""}}Object(n.a)(jj,"ListLevelMetadata",null,[]);class on{constructor(){}}Object(n.a)(on,"LevelLists",null,[]);class Vw{constructor(b){this.nodes=b;this.NNa=0;this.lists={};this.Skb=[];this.jEi=null;this.Ffl=[];this.Ffl[0]=new on}}Object(n.a)(Vw,"WordConverterArguments",null,[]);var Hs=c(587);class Kj{}Kj.ygl="data-ccp-timestamp";Kj.AHd="data-clipservice-ccpid";Kj.Bgl="data-shapeids";Kj.Ujm="docs-internal-guid-";Kj.kvn="SCXO";Kj.mEn="SCXP";Kj.C3o="SCXW";Kj.Ien="MsoListParagraphCxSpFirst";
Kj.Jen="MsoListParagraphCxSpLast";Kj.zcf="data-pkey";Kj.Acf="data-clipservice-type";Kj.xcf="data-clipservice-count";Kj.ycf="data-clipservice-dc";Kj.OIc="data-clipservice-client";Kj.Bcf="data-clipservice-version";Object(n.a)(Kj,"HtmlContentMetadataConstants",null,[]);class mB{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(n.a)(mB,"AbsolutePosition",null,[]);var Is=c(852);class Ox{constructor(b,h,v="",D=0){this.ux=!1;this.uYg=this.vYg=null;let Q=!1;Ox.HKm(b)&&(Q=!0,this.vYg=b);Ox.ZKm(h)&&
(this.uYg=h);this.w5j=v;this.kWj=D;this.ux=Q&&this.lVd?!0:!1}get isValid(){return this.ux}get Yni(){return this.vYg}get lVd(){return this.uYg}get Vni(){return this.w5j}get wHk(){return this.kWj}static HKm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static ZKm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(n.a)(Ox,"HtmlElementInfo",null,[]);class Yu{constructor(b){this.next=null;this.data=b}}Object(n.a)(Yu,"StackNode",null,[]);class kt{constructor(){this.Qq=null;this.aj=0}get count(){return this.aj}get isEmpty(){return!this.count||
!this.Qq}push(b){b=new Yu(b);b.next=this.Qq;this.Qq=b;this.aj=this.count+1}NA(){return this.count&&this.Qq?this.Qq.data:null}pop(){if(!this.count||!this.Qq)return null;const b=this.Qq;this.Qq=b.next;this.aj=this.count-1;return b.data}clear(){this.Qq=null;this.aj=0}toArray(){const b=Array(this.count);let h=this.Qq;for(let v=this.count-1;0<=v&&h;v--)b[v]=h.data,h=h.next;return b}}Object(n.a)(kt,"Stack",null,[]);class Qg{constructor(b){this.Wi=b;this.ntc=this.Fpd=null;this.Jhd=!1}get iHd(){return this.ntc.NA()}reset(){this.Wi.reset();
this.Fpd=new kt;this.ntc=new kt;this.ntc.push(this.Wi.XIc);this.Jhd=!1}V5d(){this.Jhd=!1}MJ(b){this.Jhd||(this.Fpd.push(null),this.Jhd=!0);this.Fpd.push(b)}onClose(){for(;;){const b=this.Fpd.pop();if(!b)break;b()}}Ikj(){return!1}Ahn(){this.fv(()=>!0)}fv(b){const h=this.iHd.clone();return b(h)?(this.ntc.push(h),this.Wi.kGa(h),this.MJ(Object(z.a)(this,this.wnn,"onFormattingEnd")),!0):!1}jwf(b){return b.style?this.fv(h=>this.Ikj(h,b))?1:2:2}wnn(){this.ntc.pop();this.Wi.kGa(this.iHd)}Eca(){}O5d(){return 2}VRf(){return 2}WRf(){return 2}$Rf(){return 2}pSf(){return 3}rSf(){}U5d(){return 2}sSf(){}tSf(){}uSf(){return 2}X5d(){return 2}Y5d(){return 2}ISf(){return 2}Z5d(){}KSf(){return 2}$5d(){return 2}a6d(){return 2}d6d(){return 2}e6d(){return 2}WSf(){}XSf(){return 2}l6d(){return 2}m6d(){return 2}p6d(){return 2}q6d(){return 2}s6d(){return 2}t6d(){return 2}v6d(){return 2}x6d(){return 2}wTf(){return 2}E6d(){return 2}DTf(){return 2}FTf(){}GTf(){return 2}H6d(){return 2}I6d(){return 2}J6d(){return 2}K6d(){return 2}L6d(){return 2}M6d(){return 2}NTf(){return 3}N6d(){}UTf(){return 2}O6d(){return 2}WTf(){return 3}R6d(){}bUf(){}S6d(){return 2}hUf(){return 3}U6d(){return 2}W6d(){return 2}Y6d(){return 2}Z6d(){return 2}tUf(){}xUf(){return 3}a7d(){return 2}onMenuOpen(){return 2}BUf(){}KUf(){return 2}LUf(){return 2}NUf(){return 3}m7d(){return 2}PUf(){return 2}n7d(){return 2}r7d(){return 2}WUf(){}y7d(){return 2}gVf(){return 2}H7d(){return 2}I7d(){return 2}AVf(){return 3}HVf(){return 2}Q7d(){return 2}R7d(){return 2}T7d(){return 2}U7d(){return 2}LVf(){return 3}V7d(){return 2}Y7d(){return 2}$7d(){return 2}OVf(){return 2}X_c(){return 2}RVf(){return 2}SVf(){return 2}c8d(){return 2}TVf(){return 2}WVf(){return 3}h8d(){return 2}i8d(){return 2}j8d(){return 2}k8d(){return 2}n8d(){return 2}static Oga(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(G.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static gei(b){if(!b||""===b)return-1;const h=G.a.Ug(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(G.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(G.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static Tai(b){b=Qg.gei(b);return-1===b?0:0>b?(u.ULS.sendTraceTag(508925786,307,50,"Negative margin in px or pt"),0):b}static acm(b){return Qg.gei(b)}static Bdi(b){return b&&
""!==b?Qg.Oga(b):null}static cE(b){let h=null,v=null,D=null,Q=null;b&&b.qf&&(h=Qg.PQ(b.qf,"id"),v=Qg.PQ(b.qf,"lang"),D=b.qf.tagName,b.jDk&&(Q=Object.assign(new mB,{x:Qg.Oga(b.qf.style.left),y:Qg.Oga(b.qf.style.top),left:Qg.Bdi(b.qf.style.left),top:Qg.Bdi(b.qf.style.top)})),void 0===h&&(h=""),void 0===v&&(v=""));return new Is.a(new Ox(h,D),b.xB,null,v,Q)}static PQ(b,h){return b[h]}}Object(n.a)(Qg,"AHtmlTranslator",null,[768]);class Wr extends Is.a{constructor(b,h,v,D=0,Q=0,ba=null){super(ba?ba.o9:
null,ba?ba.xB:null,ba?ba.Gxa:null,ba?ba.cultureName:null,ba?ba.WBa:null);this.width=D;this.height=Q}}Object(n.a)(Wr,"AugmentationSemanticArgs",Is.a,[]);class Er{constructor(b,h,v,D,Q,ba,ta){this.ccpId=b;this.pKey=h;this.type=v;this.count=D;this.dc=Q;this.client=ba;this.version=ta}}Object(n.a)(Er,"ClipServiceArgs",null,[]);var Bk;(Bk||(Bk={})).Chart="chart";Object(n.b)("ClipServiceDataType",Bk);var gt;(gt||(gt={})).ExcelOnline="XLO";Object(n.b)("ClipServiceClientApp",gt);class mz{constructor(){this.stop=
this.color=null}}Object(n.a)(mz,"ColorStopPair",null,[]);var Pp=c(1964);class Zu{constructor(){this.direction=null;this.JGc=new yu.a}Sli(){return!!this.direction&&0<this.direction.length}}Object(n.a)(Zu,"LinearGradient",null,[]);class pA{constructor(){this.W$b=!1}}Object(n.a)(pA,"HtmlTranslatorContext",null,[]);var qw=c(1840);class pz{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(n.a)(pz,"IndentationProperties",null,[]);var Fr=c(1384);class vy extends Is.a{constructor(b,h,v,D,Q=null,
ba=0,ta=null,Ta=null,ob=!1,Kb=!1,Vb=69905,bc=null){super(bc?bc.o9:null,bc?bc.xB:null,bc?bc.Gxa:null,bc?bc.cultureName:null,bc?bc.WBa:null);this.colSpan=b;this.rowSpan=h;this.width=v;this.xbc=Kb;this.height=D;this.j3a=ob;this.shadingColor=Q;this.verticalAlignment=ba;this.lja=ta;this.Ake=Ta;this.z7=Vb}}Object(n.a)(vy,"TableCellSemanticArgs",Is.a,[]);class dw extends Is.a{constructor(b,h=null){super(h?h.o9:null,h?h.xB:null,h?h.Gxa:null,h?h.cultureName:null,h?h.WBa:null);this.height=b}}Object(n.a)(dw,
"TableRowSemanticArgs",Is.a,[]);class rv extends Is.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb=null,Vb=-1,bc=null){super(bc?bc.o9:null,bc?bc.xB:null,bc?bc.Gxa:null,bc?bc.cultureName:null,bc?bc.WBa:null);this.bEd=null;this.rowCount=b;this.Deb=h;this.width=v;if(Q)for(this.bEd=Array(Q.length),b=0;b<Q.length;++b)this.bEd[b]=Q[b];this.DBf=ba;this.qhg=Ta;this.NFm=ta;this.j3a=D;this.YVd=ob;this.styleId=Kb;this.tableLook=Vb}}Object(n.a)(rv,"TableSemanticArgs",Is.a,[]);let Rt;class Nm extends Qg{get cKm(){if(null!=
this.PCg)var b=this.PCg;else{var h;w.AFrameworkApplication.te("FontFamilyFix;FontFamilyFixCf");b=this.PCg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",!1)}return b}constructor(b,h,v=new pA,D=null){super(b);this.settings=h;this.context=v;this.JXc=D;this.cvb=null;this.w$j=lb.a.B5("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,
"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Zjo=new Set(["DIV","P"])}get OFi(){return this.w$j}Aai(b,h){var v;if((v=b.style?b.style.listStyleType:"")&&""!==v&&(v=this.OFi[G.a.Ug(v)])||(v=Qg.PQ(b,"type"))&&""!==v&&(v=this.OFi[v]))return v;if((v=b.tagName.toLowerCase())&&("ol"===v||"ul"===v)&&(b=b.className))if("ul"===v)switch(b=Nm.CSd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;
case "BulletListStyle3":return 5}else if("ol"===v)switch(b=Nm.CSd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}tai(b){let h=-1,v=b.tagName.toLowerCase();if("ol"===v||"ul"===v){b=jc.a.q8h(b,"li");if(!b)return h;v="li"}if("li"===v){h=(h=this.ENd(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=jc.a.q8h(b,"p"))return Nm.Q0l(b)-1}return h}ENd(b,
h,v){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?v:b}jpn(){this.cvb.pop();this.Wi.vxa()}nQc(b,h){this.fv(Q=>Q.gda(0,0));const v=this.Aai(b.qf,h?6:2);let D=1;h&&(D=this.ENd(b.qf,"start",1));h=!1;h=b.qf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.qf.removeAttribute("data-pasteFromRc");(aa.a.i4||aa.a.jj)&&Nm.DDd(b.qf);b=new Fr.a(v,D,Qg.cE(b),0,-1,h);this.cvb.push(b);this.Wi.xxa(b);this.MJ(Object(z.a)(this,this.jpn,"onListElementClose"));return 1}xdl(b,h,v){return(h=h.getAttribute(v))?
b.jbf(h):!1}reset(){super.reset();this.cvb=new kt}Ikj(b,h){var v;let D=!1;try{var Q=h.getAttribute("xml:lang")||Qg.PQ(h,"lang")}catch(Ta){Q=null}Q&&""!==Q&&(D=b.Fag(Q)||D);(Q=Qg.PQ(h,"dir"))&&(D=b.bjc(Q)||D);if(this.settings.Sqo(this.context)&&h.getAttribute)for(Q=0;Q<Nm.Kvj.length;Q++)D=this.xdl(b,h,Nm.Kvj[Q])||D;if(Q=h.style){if(Q.fontWeight){var ba=G.a.VA(Q.fontWeight),ta=parseInt(ba);isNaN(ta)?"BOLD"===ba?D=b.qL(!0)||D:"NORMAL"===ba&&(D=b.qL(!1)||D):D=600<=ta?b.qL(!0)||D:b.qL(!1)||D}this.settings.rpj&&
Q.fontSize&&(ba=Qg.acm(Q.fontSize),0<ba&&(D=b.hge(Math.floor(2*ba))||D));(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.Zjo.has(h.tagName)&&((null===Q||void 0===Q?0:Q.marginTop)||(null===Q||void 0===Q?0:Q.marginBottom))&&(v=Qg.Tai(null===Q||void 0===Q?void 0:Q.marginTop),ba=Qg.Tai(null===Q||void 0===Q?void 0:Q.marginBottom),D=b.gda(v,ba)||D);this.settings.Wqo(this.context)&&(this.settings.vpj&&
h.getAttribute?(v=h.getAttribute("data-indent"))&&0<v.length&&(v=Cf.a.Mi(parseInt(v),0)+"px",D=b.ghe(v)||D):Q.textIndent&&(D=b.ghe(Q.textIndent)||D));this.settings.Rqo(this.context)&&Q.marginLeft&&(this.settings.vpj&&h.getAttribute?(v=h.getAttribute("data-margin"))&&0<v.length&&(D=b.Tia(Q.marginLeft)||D):"TABLE"!==h.tagName&&(D=b.Tia(Q.marginLeft)||D));if(this.settings.Uqo(this.context)&&(v=h.getAttribute("style"))&&""!==v)for(v=v.split(";"),ba=0;ba<v.length;ba++)ta=v[ba].trim(),ta.startsWith("tab-stops")&&
(D=b.wbg(ta.replace("tab-stops:",""))||D);this.settings.Qqo(this.context)&&Q.lineHeight&&(D=b.fD(Q.lineHeight)||D);this.settings.Nqo&&(v=Q.textTransform?G.a.Ug(Q.textTransform):null,ba=Q.fontVariantCaps?G.a.Ug(Q.fontVariantCaps):null,ta=Q.fontVariant?G.a.Ug(Q.fontVariant):null,"uppercase"===v?D=b.o7c("uppercase")||D:"small-caps"===ba||ta&&0<=ta.indexOf("small-caps")?D=b.o7c("small-caps")||D:this.settings.YSk&&"none"===v&&(D=b.o7c("none")||D));this.settings.Vqo(this.context)&&Q.textAlign&&(D=b.pOb(G.a.Ug(Q.textAlign))||
D);Q.fontStyle&&(v=G.a.VA(Q.fontStyle),"ITALIC"===v||"OBLIQUE"===v?D=b.lob(!0)||D:"NORMAL"===v&&(D=b.lob(!1)||D));v=Nm.Uem(h);if(Q.textDecoration||v)ba=G.a.Ug(Q.textDecoration||""),v=G.a.Ug(v||""),h.parentNode&&h.parentNode.tagName&&"a"===G.a.Ug(h.parentNode.tagName)?(ta=(h.querySelector(".TextRun")||h).className)&&-1<ta.indexOf("Underlined")&&(D=b.j5(!0)||D):Q.Bmp||Nm.isUnderline(ba)||Nm.isUnderline(v)?D=b.j5(!0)||D:this.settings.Dqj&&(D=b.j5(!1)||D),Q.Amp||Nm.Zxi(ba)||Nm.Zxi(v)?D=b.Wia(!0)||D:this.settings.Dqj&&
(D=b.Wia(!1)||D);if(Q.verticalAlign){v=G.a.VA(Q.verticalAlign);ba=this.$On(v);if("SUB"===v||this.settings.upj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>ba&&this.settings.$pj)D=b.zHa(!0)||D;else if("SUPER"===v||this.settings.upj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<ba&&this.settings.$pj)D=b.oqa(!0)||D;this.settings.rpj&&("SUB"===v||"SUPER"===v)&&h.getAttribute&&(v=parseFloat(h.getAttribute("data-fontsize")),isNaN(v)||(D=b.hge(Math.floor(2*v))||
D))}v=!1;w.AFrameworkApplication.K&&(v=w.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.Pqo&&Q.fontFamily&&(this.settings.Yqo&&h.getAttribute?(ba=h.getAttribute("data-usefontface"))&&"true"===ba&&(v&&u.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),D=this.Gkj(b,Q.fontFamily,D)):D=this.Gkj(b,Q.fontFamily,D));ba=null;this.settings.Oqo&&Q.color&&(ba=Pp.a.uua(Q.color));ta=!!ba;this.settings.Xqo(this.context)&&h.getAttribute&&(ba=h.getAttribute("data-scheme-color"),
ba=null!==ba?ba:"",ta=""!==ba||!this.context.W$b||Nm.YSm(h));ta&&(D=b.Sv(ba)||D);this.settings.Lqo&&Q.backgroundColor&&(h.tagName&&Nm.dGo.contains(G.a.VA(h.tagName))||(D=b.Bya(Pp.a.uua(Q.backgroundColor))||D));if(this.settings.Mqo&&Q.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Q=Nm.Lhm(Q.backgroundImage))&&0<Q.JGc.count){ba=Q.JGc.J(0).color;ta=!0;for(let Ta=0;Ta<Q.JGc.count&&(ta=ta&&ba===Q.JGc.J(Ta).color,ta);Ta++);ta&&(v&&u.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),
D=b.Bya(Pp.a.uua(ba))||D)}}this.settings.tpj(this.context)&&h.getAttribute&&(Q=h.getAttribute("data-ccp-props"))&&(D=b.Q9(Q)||D);h.getAttribute&&((Q=h.getAttribute("data-ccp-charstyle"))&&this.settings.Kob&&(D=b.Ofe(Q)||D),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.Kob&&(D=b.Sge(h)||D));return D}Vso(b){if(this.settings.Wso)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<G.a.VA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===G.a.VA(b.tagName))break;
b=b.parentNode}return!1}Gkj(b,h,v){if(this.cKm){h=Nm.bLl(h);let Q=!1;if(!h)return v;for(var D of h)if(Q=b.VSa(D,this.settings.iwj))break;return Q||v}D=Nm.M8h(h);return b.VSa(D,this.settings.iwj)||v}$On(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Eca(b,h){"\u200b"===b&&(b="\u00a0");h&&h.qf&&this.Vso(h.qf)&&(b="");this.Wi.Eca(b,Qg.cE(h))}O5d(b){const h=Qg.PQ(b.qf,"href");return h&&""!==h?(this.Wi.tRa(h,Qg.cE(b)),this.MJ(Object(z.a)(this.Wi,this.Wi.sRa,"onAnchorEnd")),1):2}U5d(){return this.fv(b=>
b.qL(!0))?1:2}X5d(){return this.fv(b=>b.dwf())?1:2}Y5d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}Z5d(b){this.Wi.Dca(Qg.cE(b))}$5d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}d6d(){return this.fv(b=>b.lob(!0))?1:2}a6d(b){this.fv(h=>h.pOb("center"));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}e6d(){return this.fv(b=>b.VSa("consolas"))?1:2}m6d(){return this.fv(b=>
b.Wia(!0))?1:2}l6d(b){return this.nQc(b,!1)}p6d(){return this.fv(b=>b.lob(!0))?1:2}q6d(b){return this.nQc(b,!1)}s6d(b){var h=b.qf.getAttribute("data-render-src");const v=b.qf.getAttribute("data-render-method");if(h&&""!==h&&v&&""!==v){const ta=b.qf.getAttribute("data-render-fallback");let Ta=0,ob=0;if(b.qf.currentStyle){var D=b.qf.currentStyle.width,Q=b.qf.currentStyle.height;D&&-1!==D.indexOf("px")&&(D=parseInt(G.a.substring(D,0,D.indexOf("px"))),isNaN(D)||(Ta=D));Q&&-1!==Q.indexOf("px")&&(Q=parseInt(G.a.substring(Q,
0,Q.indexOf("px"))),isNaN(Q)||(ob=Q))}b=new Wr(h,v,ta,Ta,ob,Qg.cE(b));this.Wi.I4a(b);return 2}(aa.a.i4||aa.a.jj)&&(h=b.qf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Nm.DDd(b.qf);const ba=b.qf.getAttribute("align");this.fv(ta=>ta.pOb(ba));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}t6d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}v6d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,
"onParagraphEnd"));return 1}x6d(){return this.fv(b=>b.lob(!0))?1:2}E6d(b){return this.fv(h=>{var v=Nm.M8h(b.qf.getAttribute("face"));v=h.VSa(v);h=h.Sv(Pp.a.uua(b.qf.getAttribute("color")));return v||h})?1:2}H6d(b){this.fv(h=>this.settings.Kob?h.nob(1):h.pob(1));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}I6d(b){this.fv(h=>this.settings.Kob?h.nob(2):h.pob(2));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}J6d(b){this.fv(h=>
this.settings.Kob?h.nob(3):h.pob(3));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}K6d(b){this.fv(h=>this.settings.Kob?h.nob(4):h.pob(4));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}L6d(b){this.fv(h=>this.settings.Kob?h.nob(5):h.pob(5));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}M6d(b){this.fv(h=>this.settings.Kob?h.nob(6):h.pob(6));this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,
this.Wi.oF,"onParagraphEnd"));return 1}N6d(b){this.Wi.Dca(Qg.cE(b))}R6d(b){var h=b.qf;const v=h.src,D=h.alt,Q=h.zhp,ba=h.getAttribute("data-external-content-url");let ta=0,Ta=0;h.style&&(ta=Qg.Oga(h.style.width),Ta=Qg.Oga(h.style.height));ta&&Ta||(ta=h.width,Ta=h.height);let ob=0,Kb=0;b.qf.currentStyle&&(ta||Ta||(ta=Qg.Oga(b.qf.currentStyle.width),Ta=Qg.Oga(b.qf.currentStyle.height)),ob=Qg.Oga(b.qf.currentStyle.maxWidth),Kb=Qg.Oga(b.qf.currentStyle.maxHeight));let Vb=null;const bc=h.getAttribute(Kj.AHd);
if(bc&&(u.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Dc=h.getAttribute(Kj.zcf),Oc=h.getAttribute(Kj.Acf),gd=h.getAttribute(Kj.xcf),rd=h.getAttribute(Kj.ycf),je=h.getAttribute(Kj.OIc);h=h.getAttribute(Kj.Bcf);Dc&&rd&&(Vb=new Er(bc,Dc,Oc,gd,rd,je,h))}b=new qw.a(v,D,ta,Ta,Qg.cE(b),ob,Kb,Q,null,ba,Vb);this.Wi.txa(b)}O6d(){return this.fv(b=>b.lob(!0))?1:2}S6d(){return this.fv(b=>b.j5(!0))?1:2}U6d(){return this.fv(b=>
b.VSa("consolas"))?1:2}W6d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}Y6d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}Z6d(b){let h;const v=this.Aai(b.qf,0);let D=this.ENd(b.qf,"value",0);0<this.cvb.count?h=this.cvb.NA():(h=new Fr.a(2,1,Qg.cE(b)),D||(D=1));var Q=Nm.b1l(b.qf,Fr.a.NCj);3!==Q&&(h.Sr=Q);Q=h.listLevel;let ba=h.listId;this.settings.spj?(Q=this.tai(b.qf),Q=0>Q&&0>h.listLevel&&0<this.cvb.count?h.listLevel=
this.cvb.count-1:h.listLevel=0<=Q?Q:h.listLevel,this.JXc&&this.JXc.b<Q&&(this.JXc.b=Q)):0>Q&&(Q=h.listLevel=this.tai(b.qf));1>ba&&(ba=h.listId=this.ENd(b.qf,Fr.a.CXc,0));b.qf.getAttribute(Fr.a.U0d)&&(h.levelText=b.qf.getAttribute(Fr.a.U0d));var ta=b.qf.getAttribute(Fr.a.nJf);ta&&(h.font=ta);ta=!1;w.AFrameworkApplication.K&&(ta=w.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ta){var Ta=b.qf.getAttribute("data-charcodes");ta=[];if(Ta&&""!==Ta)if(-1<Ta.indexOf(",")){Ta=Ta.split(",");
for(var ob=0;ob<Ta.length;ob++)ta.push(parseInt(Ta[ob]))}else ta.push(parseInt(Ta));if(ta&&0<ta.length){Ta=Array(ta.length);for(ob=0;ob<ta.length;ob++)Ta[ob]=ta[ob];h.v6e=Ta}(ta=b.qf.getAttribute("data-buAutoNum"))&&0<ta.length&&(h.buAutoNum=parseInt(ta))}(Q=0<=Q&&0<ba)&&Nm.DDd(b.qf);h.mEk(v,D,Q);h.mJf=this.C0l(b.qf);this.Wi.pGa(h.clone());this.MJ(Object(z.a)(this.Wi,this.Wi.wxa,"onListItemEnd"));return 1}C0l(b){var h=b.getAttribute(Fr.a.wFi);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{u.ULS.sendTraceTag(524038493,
307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new fh.DictionaryPropertySet;for(const v in b)h.snj(+v,b[v]);return h}onMenuOpen(b){return this.nQc(b,!1)}a7d(b){if(this.fv(h=>h.Ric(!0))){const h=b.qf.getAttribute("OuterHtml");this.Wi.yRa(h,Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.G4a,"onMathEnd"))}return 1}m7d(b){return this.nQc(b,!0)}n7d(b){this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));
return 1}r7d(b){const h=b.qf.getAttribute("align");this.fv(D=>D.pOb(h));const v=b.qf.parentNode;v&&v.tagName.toLowerCase().startsWith("li")&&Nm.DDd(b.qf,aa.a.i4||aa.a.jj);this.Wi.aE(Qg.cE(b));this.MJ(Object(z.a)(this.Wi,this.Wi.oF,"onParagraphEnd"));return 1}y7d(){this.fv(b=>b.VSa("consolas"));this.Wi.jmb();this.MJ(Object(z.a)(this.Wi,this.Wi.imb,"onPreFormattedTextEnd"));return 1}H7d(){return this.fv(b=>b.Wia(!0))?1:2}I7d(){return this.fv(b=>b.VSa("consolas"))?1:2}Q7d(){return this.fv(b=>b.Geg())?
1:2}R7d(b){var h=b.qf.attributes.getNamedItem("style"),v="";h&&h.value&&(v=h.value);h=Pp.a.Rzn(v);if(0<h&&this.settings.Uzm){for(v=0;v<h;v++)this.Wi.omb(Qg.cE(b));return 3}return 2}T7d(){return this.fv(b=>b.Wia(!0))?1:2}U7d(){return this.fv(b=>b.qL(!0))?1:2}V7d(){return this.fv(b=>b.zHa(!0))?1:2}Y7d(){return this.fv(b=>b.oqa(!0))?1:2}$7d(b){this.fv(Vb=>Vb.clearFormatting()&&Vb.f7f());Pp.a.jUd(b.qf,this);const h=Pp.a.Vii(b.qf),v=Pp.a.L4h(b.qf),D=Pp.a.mJ(b.qf),Q=Pp.a.ZK(b.qf),ba=!parseInt(Qg.PQ(b.qf,
"border")),ta=Pp.a.ySm(b.qf);let Ta=-1,ob="";var Kb=-1;b.qf.attributes.hasOwnProperty("style")&&-1!==(Kb=b.qf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ta=parseInt(b.qf.attributes.getNamedItem("style").value.substr(Kb+17)):b.qf.attributes.hasOwnProperty(Hs.a.BHd.toString())&&(Ta=parseInt(b.qf.attributes.getNamedItem(Hs.a.BHd.toString()).value));Kb=-1;b.qf.attributes.hasOwnProperty("class")&&-1!==(Kb=b.qf.attributes.getNamedItem("class").value.indexOf("Mso"))?ob=b.qf.attributes.getNamedItem("class").value.substr(Kb).split(" ")[0]:
b.qf.attributes.hasOwnProperty(Hs.a.PIc.toString())&&(ob=b.qf.attributes.getNamedItem(Hs.a.PIc.toString()).value);this.Wi.k9(new rv(0,0,h.value,h.pAi,null,ba,ta,v,new pz(D.value,Q.value),ob,Ta,Qg.cE(b)));this.MJ(Object(z.a)(this.Wi,this.Wi.i9,"onTableEnd"));w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}X_c(b){const h=Pp.a.z9h(b.qf),v=Pp.a.Vii(b.qf);if(!v.value&&v.zYd&&(w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),
this.settings.O_i))return 3;let D=parseInt(Qg.PQ(b.qf,"colSpan"));if(void 0===D||null===D||""===D+"")D=v.value?1:0;let Q=parseInt(Qg.PQ(b.qf,"rowSpan"));if(void 0===Q||null===Q||""===Q+"")Q=h.value?1:0;let ba=!1;b.qf.attributes.hasOwnProperty("style")&&(ba=-1!==b.qf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.qf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ba&&b.qf.attributes.hasOwnProperty("class")&&(ba=-1!==b.qf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));
let ta=69905;if(b.qf.attributes.hasOwnProperty(Hs.a.wcf.toString())){var Ta=parseInt(b.qf.attributes.getNamedItem(Hs.a.wcf.toString()).value);isNaN(Ta)||(ta=Ta)}Ta=Pp.a.uua(b.qf.style.backgroundColor);const ob=Pp.a.Phm(b.qf);this.fv(bc=>bc.gda(0,0));Pp.a.jUd(b.qf,this);const Kb=Pp.a.L4h(b.qf),Vb=this.settings.BAn?Pp.a.wOl(b.qf):null;b=new vy(D,Q,v.value,h.value,Ta,ob,Kb,Vb,v.pAi,ba,ta,Qg.cE(b));this.Wi.h9(b);this.MJ(Object(z.a)(this.Wi,this.Wi.g9,"onTableCellEnd"));this.Ahn();return 1}c8d(b){const h=
this.X_c(b);if(3===h)return h;this.fv(v=>{const D=v.qL(!0);v=v.pOb("center");return D||v});Pp.a.jUd(b.qf,this);return 1}h8d(b){Pp.a.jUd(b.qf,this);const h=Pp.a.z9h(b.qf);if(h.zYd&&!h.value&&(w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.O_i))return 3;this.Wi.K4(new dw(h.value,Qg.cE(b)));this.MJ(Object(z.a)(this.Wi,this.Wi.j9,"onTableRowEnd"));return 1}i8d(){return this.fv(b=>b.VSa("consolas"))?1:2}j8d(){return this.fv(b=>b.j5(!0))?
1:2}k8d(b){return this.nQc(b,!1)}n8d(){return this.fv(b=>b.j5(!0))?1:2}static vUl(b){return b?b.split(",")[0]:null}static aLl(b){return b?b.split(","):null}static aBj(b){if(!b)return null;b=G.a.q5f(b.trim(),'"');return b=G.a.q5f(b,"'")}static M8h(b){if(!b)return null;b=Nm.vUl(b);return b=Nm.aBj(b)}static bLl(b){var h;if(!b)return null;b=null===(h=Nm.aLl(b))||void 0===h?void 0:h.map(v=>Nm.aBj(v));h=null===b||void 0===b?void 0:b.filter(v=>!!v);return null!==h&&void 0!==h?h:null}static Koh(b,h){h=h.trim();
var v=h.match(RegExp("^-?[0-9]+deg$"));if(v&&0<v.length){if(b.Sli())return!1;b.direction=h;return!0}if((v=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<v.length){if(b.Sli())return!1;b.direction=h;return!0}var D=(v=h.match(RegExp("^rgb\\(.*\\)")))&&0<v.length?h.indexOf(")")+1:h.indexOf(" ");v=-1===D?h:Pp.a.uua(h.substr(0,D).trim());if(!v||""===v)return!1;h=-1===D?"":h.substr(D).trim();D=new mz;D.color=v;D.stop=h;b.JGc.add(D);return!0}static Lhm(b){try{if(!b)return null;
b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const v=new Zu;for(;0<h.trim().length;){let D=h.indexOf(",");const Q=h.indexOf("(");if(0<Q&&Q<D){const ba=h.indexOf(")");if(ba<Q)return null;D=h.indexOf(",",ba)}if(-1===D){if(!Nm.Koh(v,h))return null;h=""}else{const ba=h.substr(0,D);h=h.substr(D+1);if(!Nm.Koh(v,ba))return null}}return v}catch(h){return null}}static CSd(b,h){b=b.split(" ");if(0<b.length)for(let v=0;v<b.length;v++)if(0<=
b[v].indexOf(h))return b[v];return""}static DDd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Nm.CDh(b,h))}static CDh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&Nm.CDh(b,h)),b=b.nextSibling}static Q0l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let v=0;v<b.length;v++){var h=b[v].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static b1l(b,
h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static YSm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static Uem(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static Zxi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Nm.dGo=(Rt=new zb.a,Rt.add("TABLE"),Rt.add("THEAD"),Rt.add("TBODY"),Rt.add("TFOOT"),
Rt.add("TR"),Rt.add("TH"),Rt.add("TD"),Rt);Nm.Kvj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(n.a)(Nm,"DefaultHtmlTranslator",Qg,[]);var vp=c(1546);class pn{constructor(b=null){this.U2=b||vp.a.$ii("");this.r7g=Number.parseInvariant((new Date).format("HHmmss"))}get Kc(){return this.U2}process(b,h){if(b&&b.querySelectorAll){const ba=b.querySelectorAll("p");if(ba&&0<ba.length){for(var v=0,D=!1,Q=ba[0].parentNode;5>v&&
Q&&Q!==b;){v++;const ta=Q.id.toLowerCase();if(ta&&ta.length&&-1!==ta.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(Q,"WACEditing")&&Sys.UI.DomElement.containsCssClass(Q,"EditingSurfaceBody")){D=!0;break}Q=Q.parentNode}if(D&&Q!==b){v=b.firstChild;for(D=!1;0<Q.children.length&&Q.children[0]!==v;)b.insertBefore(Q.children[0],v),D=!0;if(D)for(;v;)Q=v.nextSibling,b.removeChild(v),v=Q}b=new Mf.a(h,Object(z.a)(this,this.NHn,"processNodesDiscovery"),new Vw(ba));b.Jl("Word Converter Operation");
b.Jh=!h||h.Jh;b.run()}}}NHn(b,h){const v=h.nodes[h.NNa];var D=pn.L0l(v);if(D){let ba=D.bpe.replace(RegExp("level[0-9]"),"").trim();ba=ba&&ba.length?ba:D.bpe;let ta=h.lists[ba];ta||(ta=new qv,ta.gmc=this.r7g++);let Ta=ta.Kcc[D.level-1];Ta||(Ta=new jj,Ta.level=D.level);var Q=v.parentNode;if(Q&&"li"===Q.tagName.toLowerCase()){if(Q=Q.parentNode)!(Q=Q.tagName.toUpperCase())||"OL"!==Q&&"UL"!==Q||(Ta.tagName=Q)}else Ta.olb=pn.c8h(v,5),Ta.olb&&Ta.olb.length||(Ta.olb=pn.luf(v,5)),Ta.ignore=!Ta.olb||!Ta.olb.length,
Ta.tagName=pn.b8h(Ta.olb),"UL"===Ta.tagName&&(Ta.font=this.P8h(v,5));D.gmc=ta.gmc;Ta.fin++;Ta.ignore||"li"===v.parentNode.tagName.toLowerCase()||(Q=(Q=pn.luf(v,5))?Q:Ta.olb)&&Q.length&&(D.lYh=Q,(Q=pn.ujo(v,Q,Ta.listStyle,D.level-1))&&Q.length&&(Ta.listStyle=Q));h.Skb[h.Skb.length]=D;Ta.Skb.contains(D)||Ta.Skb.add(D);if(void 0===ta.Kcc[D.level-1]||null===ta.Kcc[D.level-1]||ta.Kcc[D.level-1]!==Ta)ta.Kcc[D.level-1]=Ta;h.lists[ba]&&h.lists[ba]===ta||(h.lists[ba]=ta);h.jEi=v}else if((D=h.jEi)&&pn.E9l(v)===
D&&v.tagName===D.tagName&&v.className===D.className){D.appendChild(D.ownerDocument.createElement("BR"));for(D.appendChild(D.ownerDocument.createElement("BR"));v.firstChild;)D.appendChild(v.firstChild);v.parentNode.removeChild(v)}h.NNa++;if(h.nodes.length<=h.NNa){if(!h.Skb.length)return!1;h.NNa=0;b.ji(Object(z.a)(this,this.MHn,"processNodeConvert"))}return!0}MHn(b,h){b=h.Skb[h.NNa];var v=b.zwn,D=b.bpe.replace(RegExp("level[0-9]"),"").trim();D=D&&D.length?D:b.bpe;D=h.lists[D];var Q=D.Kcc[b.level-1],
ba=v.parentNode.tagName.toLowerCase();if(!Q.ignore&&v.parentNode&&"li"!==ba){if(ba=pn.ual(v,Q)){pn.qDh(v,5);const ta=v.ownerDocument.createElement("LI");ta.setAttribute("data-aria-level",String.format("{0}",b.level));ta.setAttribute(Fr.a.CXc,String.format("{0}",D.gmc));"UL"===Q.tagName&&(ta.setAttribute(Fr.a.U0d,String.format("{0}",b.lYh)),ta.setAttribute(Fr.a.nJf,String.format("{0}",Q.font)));for(;v.firstChild;)ta.appendChild(v.firstChild);ba.appendChild(ta);v.parentNode.removeChild(v);"UL"===Q.tagName?
this.Kc.b++:this.Kc.c++}}else"li"===ba&&(Q=Q.tagName,v=v.parentNode,b.Bfc&&(b=v.parentNode)&&b.tagName.toUpperCase()===Q&&b.setAttribute("data-pasteFromRc","true"),v.setAttribute(Fr.a.CXc,String.format("{0}",D.gmc)),"UL"===Q?this.Kc.b++:this.Kc.c++);h.NNa++;return h.NNa<h.Skb.length}P8h(b,h){let v=null;for(let D=0;!v&&D<b.childNodes.length;D++){const Q=b.childNodes[D];v=pn.KWl(Q);!v&&1===Q.nodeType&&1<h&&(v=this.P8h(Q,h-1))}return v}static ual(b,h){b=pn.sal(b,h.tagName);return pn.e6k(b,h)}static e6k(b,
h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static sal(b,h){h=b.ownerDocument.createElement(h?h:"UL");var v=b.getAttribute("start");v&&0<v.length&&(h.setAttribute("start",v),b.removeAttribute("start"));(v=b.className)&&0<v.length&&(v="OL"===h.tagName?Nm.CSd(v,"NumberListStyle"):Nm.CSd(v,"BulletListStyle"),0<v.length&&(Sys.UI.DomElement.addCssClass(h,v),
Sys.UI.DomElement.removeCssClass(b,v)));b.parentNode.insertBefore(h,b);return h}static qDh(b,h){for(let v=0;v<b.childNodes.length;v++){const D=b.childNodes[v];1===D.nodeType&&1<h&&pn.qDh(D,h-1);if(pn.YIm(D)||pn.kxi(D))b.removeChild(D),v--}}static L0l(b){if(1===b.nodeType){var h=pn.guf(b,"mso-list");if(h&&0<h.length)try{var v=h.split(" ");if(3===v.length){const D=Number.parseInvariant(v[1].substr(5)),Q=new Vu(D,h,b);Q.Bfc=!0;return Q}}catch(D){}else if((v=b.parentNode)&&"li"===v.tagName.toLocaleLowerCase()&&
(h=v.getAttribute("data-"+Ze.a.PAd),v=v.getAttribute(Fr.a.CXc),h&&v&&0<h.length&&0<v.length))return b=new Vu(Number.parseInvariant(h),v+" level"+h,b),b.Bfc=!1,b}return null}static ujo(b,h,v,D){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===pn.b8h(h))return v=pn.NNl(h),Sys.UI.DomElement.addCssClass(b,v),v;var Q=h.match(RegExp("^[0-9]+"));return Q&&Q.length?(v="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,v),b.setAttribute("start",Q[0]),v):(Q=h.match(RegExp("^[a-zA-Z]+")))&&Q.length&&
(Q=Q[0],D=(h=Q.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?pn.J$l(v,D):1,1!==D&&((v=pn.GFd(b,Q,RegExp("^[ivxlcdm]+"),G.a.AIh,"NumberListStyle3"))||(v=pn.GFd(b,Q,RegExp("^[IVXLCDM]+"),G.a.AIh,"NumberListStyle5")))||D&&((v=pn.GFd(b,Q,RegExp("^[a-z]+"),G.a.yIh,"NumberListStyle2"))||(v=pn.GFd(b,Q,RegExp("^[A-Z]+"),G.a.yIh,"NumberListStyle4"))))?v:"NumberListStyle1"}return null}static NNl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static J$l(b,
h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static GFd(b,h,v,D,Q){return(h=h.match(v))&&h.length?(D=D(h[0]),D=1>D?1:D,Sys.UI.DomElement.addCssClass(b,Q),b.setAttribute("start",D+""),Q):null}static b8h(b){return pn.VFm(b)?"UL":"OL"}static VFm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||
"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static luf(b,h){let v=null;var D;let Q,ba;for(let ta=-1;!v&&ta<b.childNodes.length;ta++){const Ta=-1===ta?b:b.childNodes[ta];if(Ta)if((D=Ta.innerHTML)&&0<D.length){if(Q=D.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=Q&&(ba=D.indexOf("\x3c!--[endif]--\x3e"),0<=ba)){D=D.substring(Q,ba+14);Ta.innerHTML=Ta.innerHTML.replace(D,"");if(D.length){b=b.ownerDocument.createElement("span");b.innerHTML=D;v=b.innerText.trim();break}v&&v.length||
(v="o")}}else 0<=ta&&1===Ta.nodeType&&1<h&&(v=pn.luf(Ta,h-1))}return v}static KWl(b){let h=null;1===b.nodeType&&((h=pn.O8h(b,"font-family"))||(h=pn.O8h(b,"mso-ascii-font-family")));return h}static O8h(b,h){return(b=pn.guf(b,h))&&0<b.length?b.trim():null}static c8h(b,h){let v=null;for(let D=0;!v&&D<b.childNodes.length;D++){const Q=b.childNodes[D];pn.kxi(Q)?(v="string"===typeof Q.innerText?Q.innerText.trim():Q.textContent.trim(),v.length||(v="o"),Q.parentNode.removeChild(Q)):1===Q.nodeType&&1<h&&(v=
pn.c8h(Q,h-1))}return v}static kxi(b){return 1===b.nodeType&&(b=pn.guf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static YIm(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static guf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let v=0;v<b.length;v++){const D=b[v].split(":");if(2===D.length&&D[0].trim()===h)return D[1].trim()}}return null}static E9l(b){do b=b.previousSibling;while(b&&pn.ewi(b));return b}static ewi(b){return b?
3===b.nodeType?(b=b.nodeValue,b=b.replace(pn.p$j,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:pn.ewi(b.firstChild):!0}}pn.p$j=RegExp("[\n|\r]","gi");Object(n.a)(pn,"WacAndRichClientWordConverter",null,[763]);class Ww{constructor(){}create(b=null){return new pn(b)}}Object(n.a)(Ww,"Box4WordConverterFactory",null,[646]);var nB=c(1759);class nz{constructor(b,h,v,D,Q){this.zTg=0;this.U1o=ba=>{let ta=!0;const Ta=this.Tea.kvl;null!=Ta?(ba.spa=
Ta,ta=!1):Date.now()-this.zTg>this.Zue&&(u.ULS.sendTraceTag(18354843,307,50,null),this.rd.Yb(Oe.a.gna,{["Reason"]:Fe.a.EYi}),ta=ba.spa=!1);return ta};this.rd=b;this.Se=h;this.Zue=Q;this.Tea=v;this.jMa=D}aWk(b,h,v){u.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,v,this.Se.bG);b.Jh&&this.Se.zq&&window.chrome&&u.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.Tea.TKc(!!(h&16));
this.jMa.create(b,this.U1o,null).Jl("ClipboardPreProcess");this.zTg=Date.now()}q5n(){this.Tea.reset()}}Object(n.a)(nz,"ClipboardOperationClipboardAccessHelper",null,[641]);var Gr=c(339);class sv{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd){this.qWa=null;this.ga=b;this.rd=h;this.Uz=v;this.nh=D;this.ib=Q;this.Tea=ba;this.eb=ta;this.Ie=Ta;this.Kn=ob;this.Wc=Kb;this.xbb=Vb;this.cPe=bc;this.xE=Dc;this.hk=gd;this.vVb=Oc?Oc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.vmd=Oc?Oc.$("PasteKeepSourceFontSizeFixIsEnabled"):
!1;this.ld=rd;this.Nh=Fp.a.getInstance(Gr.a.FZa)}get lg(){return this.nh}get Ic(){return this.rd}get GTc(){if(null==this.qWa)if(this.ld)if(this.ld.Lp.isCompleted)this.qWa=this.ld.isFeatureEnabled(3);else return!1;else this.qWa=!1;return this.qWa}N1o(b){b.mN();return!0}dJh(b,h){b=h.xx;u.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let D=!1,Q;aa.a.AFa&&w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.GTc&&h.ie&&h.ie.rh&&(D=this.hk.Pnh(h.ie.rh.editingElement));
Q=this.hk.Jwf(h.ie.rh.editingElement,!1);var v=h.ie.rh.editingElement;this.hk.cBf(v,!1,1);this.vVb&&aa.a.AFa?(v=h.ie.rh.editingElement,this.hk.u6f(v,"data-src","data-srcurl"),b=this.Tea.copy(),this.hk.u6f(v,"data-srcurl","data-src")):this.vmd&&h.ie&&h.ie.rh?(v=this.hk.m6e(h.ie.rh.editingElement,h.ie.nB,!0),b=this.Tea.copy(),v&&this.hk.m6e(h.ie.rh.editingElement,h.ie.nB,!1)):(this.hk.faj(h.ie.rh.editingElement),b=this.Tea.copy());this.GTc&&D&&this.hk.q_n(h.ie.rh.editingElement);Q&&this.hk.Jwf(h.ie.rh.editingElement,
!0);v=h.ie.rh.editingElement;this.hk.cBf(v,!1,0);if(!b)return u.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.Nh.logKpiFailure({kpiName:Gr.a.KCd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Ic.Yb(Oe.a.RCb,{["Reason"]:Fe.a.mhg}),h.yR&&h.yR.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}o$e(b,h){const v=h.ie;u.ULS.shipAssertTag(18130961,307,!!(h.xx&16));h.Qxo?this.Uz.KDh():
this.Uz.XFd(v,b);return!0}UPh(b,h){var v=h.context,D=h.xd;const Q=h.G9;var ba=!1;b=this.ib.gb.kb.Pc;if(this.eb.lm(b)||this.Ie.Gk(b)){const ta=this.Wc.Wf(b.node),Ta=ta.vd();u.ULS.shipAssertTag(18130962,307,Ta);this.Kn.Vd(ta);this.xbb.Jjb(ta)&&(ba=!0)}D=h.xx&64?new fh.DictionaryPropertySet:D||new fh.DictionaryPropertySet;D.setValue(wc.a.QJc,!1);v=this.ga.Of(v,Eb.a.CH,2,!0,Q,D);8===v&&(u.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Ic.Yb(Oe.a.gna,{["Reason"]:Fe.a.TPh}),h.yR&&h.yR.fail("DeleteKey failed",
!1),this.Nh.logKpiFailure({kpiName:Gr.a.$5e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===v&&this.Nh.logKpiSuccess({kpiName:Gr.a.$5e});32===v&&ba&&(h=this.ib.gb.kb,this.Ie.km(h)&&h.Oa.node===b.node&&!this.eb.textLength(h.Oa.node)&&(h=this.Wc.Wf(h.Oa.node),b=this.Ie.mu(h),u.ULS.shipAssertTag(18130964,307,b),this.Kn.Vd(h),this.xbb.nYd(h)||(b=this.cPe.create(),b.Zc(h),this.Kn.q0(b,!1,!1),ba=this.Kn.Ge(b),this.eb.Vb(ba)&&(this.Kn.Vd(b),this.lg.merge(b,h,!1,!1),this.ib.setSelection(this.xE.ue(ba,
this.eb.textLength(ba)))))));return!0}}Object(n.a)(sv,"ClipboardOperationCutCopy",null,[671]);class nA{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd){this.ga=b;this.rd=h;this.Uz=v;this.Tea=ba;this.ib=Q;this.nh=D;this.eb=ta;this.Ie=Ta;this.Kn=ob;this.Wc=Kb;this.xbb=Vb;this.cPe=bc;this.xE=Dc;this.Ma=Oc;this.hk=gd;this.ld=rd}create(){return new sv(this.ga,this.rd,this.Uz,this.nh,this.ib,this.Tea,this.eb,this.Ie,this.Kn,this.Wc,this.xbb,this.cPe,this.xE,this.Ma,this.hk,this.ld)}}Object(n.a)(nA,
"Factory",null,[640]);var oA=c(1682);class bo{constructor(b,h){this.Qfd=null;this.S6k=(v,D)=>{if(!Object(yb.a)(112,D.xd))return!1;const Q=Object(Ka.a)(112,D.xd);if(!Q.hasProperty(wc.a.Ivf))return!1;const ba=Q.getValue(wc.a.Ivf),ta=D.ie,Ta=ta.lb;this.Uz.aIj();Ta.wNb(()=>{Ta.setSelection(ba,void 0,!0);this.Uz.XFd(ta,v)},!0);return!0};this.Uz=b;this.b6=h;this.pI=0}process(b,h){this.pI||(this.Qfd=[this.S6k,Object(z.a)(this.b6,this.b6.uAn,"pasteGlossaryPlaceholder")]);let v=!0;this.pI<this.Qfd.length&&
(v=this.Qfd[this.pI++](b,h));return v?this.pI<this.Qfd.length:!1}}Object(n.a)(bo,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[683]);class ew{constructor(b){this.rsb=null;this.M1=b;this.pI=-1}process(b,h){-1===this.pI&&(this.kgl(b,h),this.pI=0);let v=!1;this.pI<this.rsb.length&&(v=this.rsb[this.pI++](b,h));return v?this.pI<this.rsb.length:!1}kgl(b,h){aa.a.k4||h.xx&512?(this.rsb=[Object(z.a)(this.M1,this.M1.o$e,"copyInternal")],u.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!b.Jh&&h.xx&256?(this.rsb=[Object(z.a)(this.M1,this.M1.N1o,"waitBeforeCopy"),Object(z.a)(this.M1,this.M1.dJh,"copyExternal"),Object(z.a)(this.M1,this.M1.o$e,"copyInternal")],u.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.rsb=[Object(z.a)(this.M1,this.M1.dJh,"copyExternal"),Object(z.a)(this.M1,this.M1.o$e,"copyInternal")],u.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
h.xx&32&&(b=Object(z.a)(this.M1,this.M1.UPh,"deleteForCut"),this.rsb.push(b),u.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Gr.a.n1m(h)}}Object(n.a)(ew,"ClipboardOperationCutCopyProcessor",null,[673]);class St{constructor(b,h,v,D){this.Tod=null;this.V6k=(Q,ba)=>{ba=ba.ie;this.Uz.AZo();this.Uz.XFd(ba,Q);return!0};this.gZc=(Q,ba)=>{ba=new Rp.Selection([ba.xd],!0);this.ib.setSelection(ba,Q);return!0};this.Uz=b;this.ib=h;this.M1=v;this.b6=
D;this.pI=0}process(b,h){this.pI||(this.Tod=[this.V6k,Object(z.a)(this.M1,this.M1.UPh,"deleteForCut"),this.gZc,Object(z.a)(this.b6,this.b6.S_i,"pasteInternal"),Object(z.a)(this.b6,this.b6.ymj,"setSelectionAfterPaste")]);let v=!0;this.pI<this.Tod.length&&(v=this.Tod[this.pI++](b,h));return v?this.pI<this.Tod.length:!1}}Object(n.a)(St,"ClipboardOperationMoveProcessor",null,[674]);var yo=c(1681);class rw{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld){this.Uz=b;this.ga=h;this.Qpc=v;this.rd=
D;this.Ie=Q;this.Se=ba;this.Gc=ta;this.jfd=Ta;this.DYj=ob;this.$Sb=Kb;this.mve=Vb;this.Dpc=bc;this.jMa=Dc;this.yD=Oc;this.Sd=gd;this.Jm=rd;this.CZ=je;this.Vea=Ld}create(b,h,v,D,Q,ba,ta,Ta,ob=!0){const Kb=this.jfd.create(D,Object(Ka.a)(112,Ta));var Vb=this.DYj.create();const bc=new bo(this.Uz,Kb),Dc=new St(this.Uz,Th.a.instance,Vb,Kb);Vb=new ew(Vb);D=new yo.a(w.AFrameworkApplication.K,Xu.a.instance,D,Ye.a.instance,Kb,this.$Sb);return new oA.a(b,h,v,Q,ba,ta,Ta,this.Qpc,this.ga,this.rd,this.Ie,this.Se,
this.Gc,bc,Dc,Vb,D,this.$Sb,this.mve,this.Dpc,this.jMa,this.yD,this.Sd,this.Jm,this.CZ,this.Vea,w.AFrameworkApplication.Cdg(),ob)}}Object(n.a)(rw,"Factory",null,[639]);var qz=c(257);class rz{constructor(b,h){this.wFb=b.kqf(h);this.y$e=b.LRl(h);this.wAb=b.Ynf(h);this.Sdb=b.vnf(h)}static cF(b){return rz.Jr(b)}static Jr(b){return new rz(xy.a.instance,b)}}Object(n.a)(rz,"CpUsageHelper",null,[]);class rC{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc){this.PL=null;this.J2=!1;this.rd=b;this.Uz=h;this.Iyc=v;
this.sta=D;this.ib=Q;this.ga=ba;this.WCe=ta;this.LVe=ob;this.aNe=Ta;this.Bye=Kb;this.kve=Vb;this.Sd=bc;this.Nh=Fp.a.getInstance(Gr.a.FZa);this.J2=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get Pg(){return this.LVe.value}get Yqa(){return this.sta}get Ic(){return this.rd}get PRa(){return this.aNe.PRa}paste(b,h){const v=this.Sd.oZa();try{const D=h.ie,Q=h.xx;this.BU&&(this.ib&&this.ib.gb&&this.ib.gb.kb&&qz.TableBorderSelectionCache.eoo(this.ib.gb.kb.qw||
this.ib.gb.kb.$Hb),pp.a.$lo(this.ib));u.ULS.shipAssertTag(18131010,307,!!(Q&1));Object(yb.a)(112,h.xd)&&h.xd.setValue(nh.a.bga,D.rh.editingElement.clientWidth);this.kve.AOo(b,h);let ba;if(!({uFd:ba}=this.WCe.value.GBj()).returnValue)return this.ZXc(h,"HTML import strategy failed",!1),this.J2?this.Nh.logKpiFailure({kpiName:Gr.a.eNa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:Gr.a.Nmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):wa.Health.instance.recordQosError("HtmlImportStrategyFailed",
[Gr.a.Nmb],!1,!0,!0,!1,null),!1;this.Pg.iF();let ta=!0,Ta=null;const ob=this.Bye.create(ba),Kb=h.YHj;if(!D||!D.lb)return this.ZXc(h,"Fail to set selection.",!1),this.J2?this.Nh.logKpiFailure({kpiName:Gr.a.eNa,errorName:"SetSelectionFailed",optionalVeto:{name:Gr.a.Nmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):wa.Health.instance.recordQosError("SetSelectionFailed",[Gr.a.Nmb],!1,!0,!0,!1,null),!1;D.lb.wNb(()=>{Kb&&2===this.ga.processAction(Eb.a.Kma,2)?ta=!1:(Ta=Kb?this.ib&&
this.ib.gb&&this.ib.gb.kb?this.ib.gb.kb.Oa:null:h.xd)?(u.ULS.shipAssertTag(18158338,307,We.SelectionEditor.gf(Ta)),this.uJi(Ta,"paste")):u.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Kb)},this.aNe.Czi);if(!ta)return this.ZXc(h,"fail to deleteForReplace.",!0),!1;if(!Ta)return this.ZXc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ta.node||!Ta.node.isConnected)return this.ZXc(h,"node is null or not connected in ip context.",!0),!1;D.editingView.disable(!0,
25);ob.restore();this.Iyc.oAn(ba,Ta,b);return!0}finally{v&&v.dispose()}}ZXc(b,h,v){b.failed=!0;b.yR&&b.yR.fail(h,v)}uAn(b,h){const v=Object(Ka.a)(112,h.xd).getValue(wc.a.Jji);u.ULS.shipAssertTag(20492440,307,We.SelectionEditor.gf(v));if(!this.QCh(v,h))return!1;this.Pg.iF();h=(new rl.a).Oc(15);h.Cb(this.Uz.pja);this.Iyc.Asi(v,b);this.Uz.KDh();h.dispose();return!0}S_i(b,h){const v=this.ib.gb.kb.Oa;if(!this.QCh(v,h))return!1;this.Pg.iF();this.ga.processAction(Eb.a.Kma,2);this.uJi(v,"intPaste");this.Iyc.Asi(v,
b);return!0}QCh(b,h){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return u.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.dWc),h.yR&&(h.yR.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.Nh.logKpiFailure({kpiName:Gr.a.eNa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),
!1;if(!We.SelectionEditor.gf(b))return u.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.dWc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.Nh.logKpiFailure({kpiName:Gr.a.eNa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.yR&&(h.yR.fail("ipContext is not insertion point in InternalPasteAtIp",
!0),h.failed=!0),!1}return!0}uJi(b,h){h=rz.cF(h);this.Yqa.$Pn(h,b.node,b.cpBegin);this.Yqa.p1m(h.y$e);this.Yqa.mKf(h.wFb);this.Yqa.aKf(h.wAb);this.Yqa.XJf(h.Sdb)}ymj(b,h){if(!h.YHj)return!1;h.xx&64&&this.Uz.$Hj();if(!h.q0a)return u.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.fjb}),h.yR&&h.yR.fail("No selection after paste",!1),h.failed=!0,!1;this.aNe.SYo(h);this.Pg.iF();return!1}get BU(){null==this.PL&&(w.AFrameworkApplication.te("he991617;3eed2178"),
this.PL=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.PL}}Object(n.a)(rC,"ClipboardOperationPaste",null,[672]);class Xk{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.rd=b;this.Uz=h;this.Iyc=v;this.sta=D;this.ib=Q;this.ga=ba;this.LVe=Ta;this.mek=ta;this.Bye=ob;this.kve=Kb;this.Sd=Vb}create(b,h){h=this.mek.create(this.ib,h);return new rC(this.rd,this.Uz,this.Iyc,this.sta,this.ib,this.ga,b,h,
this.LVe,this.Bye,this.kve,this.Sd)}}Object(n.a)(Xk,"Factory",null,[638]);var Zg=c(1612);class yq{constructor(b,h){this.aDo=b;this.ozn=h}}Object(n.a)(yq,"ParagraphFormatStore",null,[]);class bp{constructor(b,h,v){this.ib=b;this.eb=h;this.ve=v}AOo(b,h){if(h.Xac){h=b.spa;var v=this.ib.gb.kb.Oa.node,D=null;this.eb.Vb(v)&&(D=this.ve.No(v),v=this.eb.o1a(v),D=new yq(D,v));h=new Zg.a(h.context,h.xx,h.yR,h.G9,h.xd,D);b.spa=h}}}Object(n.a)(bp,"ClipboardOperationPasteOvertypeStrategy",null,[637]);class Kn{constructor(b){this.OIe=
null;this.ib=b;b.wNb(h=>{this.OIe=h},!1)}get Czi(){return!1}SYo(b){b=this.P_e(b);this.setSelection(this.ib,b)}P_e(b){let h=b.q0a;(b.kUa||b.Nia)&&b.yje&&(h=Mg.SelectionFactory.oA(b.yje,h.Oa));return h}setSelection(b,h){b.setSelection(h)}}Object(n.a)(Kn,"AClipboardOperationPasteStrategy",null,[687]);class is extends Kn{constructor(b){super(b)}get PRa(){return this.OIe}}Object(n.a)(is,"ClipboardOperationPasteToLiveSelectionStrategy",Kn,[]);class ko extends Kn{constructor(b,h){super(b);this.PWe=null;
this.zak=h;b.wNb(v=>{this.PWe=v},!0)}get Czi(){return!0}get PRa(){return this.PWe}P_e(b){let h=super.P_e(b);b.xd.setValue(wc.a.W_i,h);return h=this.zak.cbi(this.OIe.kb,this.PWe.kb,h)}}Object(n.a)(ko,"ClipboardOperationPasteToVirtualSelectionStrategy",Kn,[]);class Rx{constructor(b){this.OWe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ia(wc.a.kUa,!1)&&this.OWe?new ko(b,this.m1o):new is(b)}get m1o(){return null!=this.ZIg?this.ZIg:this.ZIg=Ga.a.instance.Na("Box4.Actors.IVirtualSelectionMerger")}}
Object(n.a)(Rx,"ClipboardOperationPasteStrategyFactory",null,[636]);class $u{constructor(b,h,v,D){this.Ic=b;this.lb=h;this.wn=v;this.Xf=D}fFn(b){(b&1||b&32)&&this.wn.Qo&&this.lb.O_b()}rGm(b,h){return b&1&&this.Xf.j_(h,!0)?(this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.RE}),!1):!0}}Object(n.a)($u,"ClipboardOperationWordStrategy",null,[]);class sC{constructor(){}p6k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var v=Array.clone(h);v.reverse();var D=h=0,Q=0,ba=0;for(const Ta of v){v=Ta.style;var ta=Ta.selectorText;
v=v?v.cssText:null;ta=ta?ta.split(","):null;if(v&&ta&&Ta.type===Ta.STYLE_RULE){ba+=ta.length;for(const ob of ta){0<=ob.indexOf("#")&&h++;0<=ob.indexOf(".")&&D++;0>ob.indexOf("#")&&0>ob.indexOf(".")&&Q++;ta=null;try{ta=b.querySelectorAll(ob)}catch(Kb){u.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ob,Kb.message)}if(ta)for(let Kb=0;Kb<ta.length;Kb++)ta[Kb].setAttribute("style",v+(ta[Kb].getAttribute("style")||""))}}}u.ULS.sendTraceTag(51245663,
307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ba,h,D,Q)}else this.aKi();else this.aKi()}aKi(){u.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",aa.a.bG)}}Object(n.a)(sC,"ExternalPasteCssConverter",null,[635]);class qA{constructor(b){this.NNa=0;this.hEh=null;this.node=b}}Object(n.a)(qA,"ChartConverterArguments",null,[]);class Bv{constructor(b=null){this._imgNodesConverted=
0;this.U2=b||vp.a.Z4h("")}get Kc(){return this.U2}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Mf.a(h,this.tyl.bind(this),new qA(b[0])),b.Jl("Chart Converter Operation"),b.Jh=!h||h.Jh,b.run())))}tyl(b,h){var v=h.node;if(1<h.NNa)return!1;if(1===v.nodeType&&"DIV"===v.tagName){const D=v.getAttribute(Kj.AHd);if(D){const Q=v.getAttribute(Kj.zcf),ba=v.getAttribute(Kj.Acf),ta=v.getAttribute(Kj.xcf),Ta=v.getAttribute(Kj.ycf),ob=v.getAttribute(Kj.OIc);
v=v.getAttribute(Kj.Bcf);Q&&Ta&&ba&&"chart"===ba&&ob&&"XLO"===ob&&(h.hEh=new Er(D,Q,ba,ta,Ta,ob,v))}}b.ji(this.rdn.bind(this));return!0}rdn(b,h){var v=h.node;if(b=h.hEh)1===v.childElementCount&&1===v.firstChild.nodeType&&"IMG"===v.firstChild.tagName?(v=v.firstChild,v.setAttribute(Kj.AHd,b.ccpId),v.setAttribute(Kj.zcf,b.pKey),v.setAttribute(Kj.Acf,b.type),v.setAttribute(Kj.ycf,b.dc),v.setAttribute(Kj.OIc,b.client),b.version&&v.setAttribute(Kj.Bcf,b.version),b.count&&v.setAttribute(Kj.xcf,b.count),
this._imgNodesConverted++):u.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.U2._imgNodesConverted=this._imgNodesConverted;h.NNa++;return!1}}Object(n.a)(Bv,"ChartConverter",null,[]);class sw{constructor(b,h=null,v=null){this.pf=b;this.U2=h||vp.a.Efi("");this.alk=v||vp.a.Ffi("")}get Kc(){return this.U2}get Mhg(){return this.alk}k9(b){this.Mhg.b++;this.pf.k9(b)}i9(){this.pf.i9()}K4(b){this.Mhg.c++;this.pf.K4(b)}j9(){this.pf.j9()}h9(b){this.Mhg.d++;this.pf.h9(b)}g9(){this.pf.g9()}reset(){this.pf.reset()}get XIc(){return this.pf.XIc}Eca(b,
h){this.Kc.b++;this.pf.Eca(b,h)}Dca(b){this.Kc.c++;this.pf.Dca(b)}omb(b){this.Kc.b++;this.pf.omb(b)}txa(b){this.Kc.d++;this.pf.txa(b)}kGa(b){this.Kc.f++;this.pf.kGa(b)}tRa(b,h){this.Kc.g++;this.pf.tRa(b,h)}sRa(){this.pf.sRa()}aE(b){this.Kc.h++;this.pf.aE(b)}oF(){this.pf.oF()}jmb(){this.pf.jmb()}imb(){this.pf.imb()}yRa(b,h){this.Kc.i++;this.pf.yRa(b,h)}G4a(){this.pf.G4a()}xxa(b){this.Kc.j++;this.pf.xxa(b)}vxa(){this.pf.vxa()}pGa(b){this.Kc.k++;this.pf.pGa(b)}wxa(){this.pf.wxa()}I4a(b){this.Kc.l++;
this.pf.I4a(b)}}Object(n.a)(sw,"SemanticEventUsageCollector",null,[298,299]);class av{constructor(b,h=null,v=null,D=null){this.iZj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.pf=b;this.U2=h||vp.a.J9h(aa.a.Rzb,"");this.tv=v;this.Vik=D?D.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.Wik=D?D.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.ePg=new Sg.a(Pa.a.ai());for(const Q of this.iZj)this.ePg.add(Q)}get Kc(){return this.U2}get Fl(){return this.tv}Ih(b){return b?
b+1:1}reset(){this.pf.reset()}V5d(){this.pf.V5d()}jwf(b){if(b&&this.Fl&&(b.getAttribute&&(b.getAttribute(Kj.ygl)&&(this.Fl.B1h=!0),b.getAttribute(Kj.AHd)&&(this.Fl.uHl=!0),b.getAttribute(Kj.OIc)&&(this.Fl.z7e=b.getAttribute(Kj.OIc)),b.getAttribute(Kj.Bgl)&&(this.Fl.C1h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Kj.Ujm)&&(this.Fl.D1h=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Kj.kvn)&&(this.Fl.H1h=!0);h.startsWith(Kj.mEn)&&(this.Fl.I1h=!0);h.startsWith(Kj.C3o)&&
(this.Fl.J1h=!0);if(h.startsWith(aa.a.k4e)&&h.length===aa.a.k4e.length+1){const v=parseInt(G.a.substring(h,h.length-1,h.length));isNaN(v)||(this.Fl.JHc=v)}if(h===Kj.Ien||h===Kj.Jen)this.Fl.wMc=!0}return this.pf.jwf(b)}onClose(){this.pf.onClose()}ONm(b){for(const h of b)if("\n"!==h)return!0;return!1}Eca(b,h){this.Fl&&(this.Fl.wHl=!0);this.Fl&&!this.Fl.Slf&&b&&(this.Fl.Slf=this.ONm(b));this.Kc.d=this.Ih(this.Kc.d);this.pf.Eca(b,h)}O5d(b){this.Fl&&(this.Fl.F1h=!0);this.Kc.e=this.Ih(this.Kc.e);this.ri(b);
return this.pf.O5d(b)}VRf(b){this.Kc.f=this.Ih(this.Kc.f);this.ri(b);return this.pf.VRf(b)}WRf(b){this.Kc.g=this.Ih(this.Kc.g);this.ri(b);return this.pf.WRf(b)}$Rf(b){this.Kc.h=this.Ih(this.Kc.h);this.ri(b);return this.pf.$Rf(b)}pSf(b){this.Kc.i=this.Ih(this.Kc.i);this.ri(b);return this.pf.pSf(b)}rSf(b){this.Kc.j=this.Ih(this.Kc.j);this.ri(b);this.pf.rSf(b)}U5d(b){this.Kc.k=this.Ih(this.Kc.k);this.ri(b);return this.pf.U5d(b)}sSf(b){this.Kc.l=this.Ih(this.Kc.l);this.ri(b);this.pf.sSf(b)}tSf(b){this.Kc.m=
this.Ih(this.Kc.m);this.ri(b);this.pf.tSf(b)}uSf(b){this.Kc.n=this.Ih(this.Kc.n);this.ri(b);return this.pf.uSf(b)}X5d(b){this.Kc.o=this.Ih(this.Kc.o);this.ri(b);return this.pf.X5d(b)}Y5d(b){this.Kc.p=this.Ih(this.Kc.p);this.ri(b);return this.pf.Y5d(b)}ISf(b){this.Kc.q=this.Ih(this.Kc.q);this.ri(b);return this.pf.ISf(b)}Z5d(b){this.Kc.r=this.Ih(this.Kc.r);this.ri(b);this.pf.Z5d(b)}KSf(b){this.Kc.s=this.Ih(this.Kc.s);this.ri(b);return this.pf.KSf(b)}$5d(b){this.Kc.t=this.Ih(this.Kc.t);this.ri(b);return this.pf.$5d(b)}a6d(b){this.Kc.u=
this.Ih(this.Kc.u);this.ri(b);return this.pf.a6d(b)}d6d(b){this.Kc.v=this.Ih(this.Kc.v);this.ri(b);return this.pf.d6d(b)}e6d(b){this.Kc.w=this.Ih(this.Kc.w);this.ri(b);return this.pf.e6d(b)}WSf(b){this.Kc.x=this.Ih(this.Kc.x);this.ri(b);this.pf.WSf(b)}XSf(b){this.Kc.y=this.Ih(this.Kc.y);this.ri(b);return this.pf.XSf(b)}l6d(b){this.Kc.z=this.Ih(this.Kc.z);this.ri(b);return this.pf.l6d(b)}m6d(b){this.Kc.ba=this.Ih(this.Kc.ba);this.ri(b);return this.pf.m6d(b)}p6d(b){this.Kc.bb=this.Ih(this.Kc.bb);this.ri(b);
return this.pf.p6d(b)}q6d(b){this.Kc.bc=this.Ih(this.Kc.bc);this.ri(b);return this.pf.q6d(b)}s6d(b){this.Kc.bd=this.Ih(this.Kc.bd);this.ri(b);return this.pf.s6d(b)}t6d(b){this.Kc.be=this.Ih(this.Kc.be);this.ri(b);return this.pf.t6d(b)}v6d(b){this.Kc.bf=this.Ih(this.Kc.bf);this.ri(b);return this.pf.v6d(b)}x6d(b){this.Kc.bg=this.Ih(this.Kc.bg);this.ri(b);return this.pf.x6d(b)}wTf(b){this.Kc.bh=this.Ih(this.Kc.bh);this.ri(b);return this.pf.wTf(b)}E6d(b){this.Kc.bi=this.Ih(this.Kc.bi);this.ri(b);return this.pf.E6d(b)}DTf(b){this.Kc.bj=
this.Ih(this.Kc.bj);this.ri(b);return this.pf.DTf(b)}FTf(b){this.Kc.bk=this.Ih(this.Kc.bk);this.ri(b);this.pf.FTf(b)}GTf(b){this.Kc.bl=this.Ih(this.Kc.bl);this.ri(b);return this.pf.GTf(b)}H6d(b){this.Kc.bm=this.Ih(this.Kc.bm);this.ri(b);return this.pf.H6d(b)}I6d(b){this.Kc.bm=this.Ih(this.Kc.bm);this.ri(b);return this.pf.I6d(b)}J6d(b){this.Kc.bm=this.Ih(this.Kc.bm);this.ri(b);return this.pf.J6d(b)}K6d(b){this.Kc.bm=this.Ih(this.Kc.bm);this.ri(b);return this.pf.K6d(b)}L6d(b){this.Kc.bm=this.Ih(this.Kc.bm);
this.ri(b);return this.pf.L6d(b)}M6d(b){this.Kc.bm=this.Ih(this.Kc.bm);this.ri(b);return this.pf.M6d(b)}NTf(b){this.Kc.bn=this.Ih(this.Kc.bn);return this.pf.NTf(b)}N6d(b){this.Kc.bo=this.Ih(this.Kc.bo);this.ri(b);this.pf.N6d(b)}UTf(b){this.Kc.bp=this.Ih(this.Kc.bp);return this.pf.UTf(b)}O6d(b){this.Kc.bq=this.Ih(this.Kc.bq);this.ri(b);return this.pf.O6d(b)}WTf(b){this.Kc.br=this.Ih(this.Kc.br);this.ri(b);return this.pf.WTf(b)}R6d(b){this.Fl&&(this.Fl.E1h=!0);this.ri(b);this.Kc.bs=this.Ih(this.Kc.bs);
this.pf.R6d(b)}bUf(b){this.Kc.bt=this.Ih(this.Kc.bt);this.ri(b);this.pf.bUf(b)}S6d(b){this.Kc.bu=this.Ih(this.Kc.bu);this.ri(b);return this.pf.S6d(b)}hUf(b){this.Kc.bv=this.Ih(this.Kc.bv);this.ri(b);return this.pf.hUf(b)}U6d(b){this.Kc.bw=this.Ih(this.Kc.bw);this.ri(b);return this.pf.U6d(b)}W6d(b){this.Kc.bx=this.Ih(this.Kc.bx);this.ri(b);return this.pf.W6d(b)}Y6d(b){this.Kc.by=this.Ih(this.Kc.by);this.ri(b);return this.pf.Y6d(b)}Z6d(b){this.Fl&&(this.Fl.wMc=!0);this.Kc.bz=this.Ih(this.Kc.bz);this.ri(b);
return this.pf.Z6d(b)}tUf(b){this.Kc.ca=this.Ih(this.Kc.ca);this.ri(b);this.pf.tUf(b)}xUf(b){this.Kc.cb=this.Ih(this.Kc.cb);this.ri(b);return this.pf.xUf(b)}a7d(b){this.Fl&&(this.Fl.vHl=!0);this.Kc.cc=this.Ih(this.Kc.cc);this.ri(b);return this.pf.a7d(b)}onMenuOpen(b){this.Kc.cd=this.Ih(this.Kc.cd);this.ri(b);return this.pf.onMenuOpen(b)}BUf(b){this.Kc.ce=this.Ih(this.Kc.ce);this.pf.BUf(b)}KUf(b){this.Kc.cf=this.Ih(this.Kc.cf);this.ri(b);return this.pf.KUf(b)}LUf(b){this.Kc.cg=this.Ih(this.Kc.cg);
this.ri(b);return this.pf.LUf(b)}NUf(b){this.Kc.ch=this.Ih(this.Kc.ch);this.ri(b);return this.pf.NUf(b)}m7d(b){this.Fl&&(this.Fl.wMc=!0);this.Kc.ci=this.Ih(this.Kc.ci);this.ri(b);return this.pf.m7d(b)}PUf(b){this.Kc.cj=this.Ih(this.Kc.cj);this.ri(b);return this.pf.PUf(b)}n7d(b){this.Kc.ck=this.Ih(this.Kc.ck);this.ri(b);return this.pf.n7d(b)}r7d(b){this.Kc.cl=this.Ih(this.Kc.cl);this.ri(b);return this.pf.r7d(b)}WUf(b){this.Kc.cm=this.Ih(this.Kc.cm);this.ri(b);this.pf.WUf(b)}y7d(b){this.Kc.cn=this.Ih(this.Kc.cn);
this.ri(b);return this.pf.y7d(b)}gVf(b){this.Kc.co=this.Ih(this.Kc.co);this.ri(b);return this.pf.gVf(b)}H7d(b){this.Kc.cp=this.Ih(this.Kc.cp);this.ri(b);return this.pf.H7d(b)}I7d(b){this.Kc.cq=this.Ih(this.Kc.cq);this.ri(b);return this.pf.I7d(b)}AVf(b){this.Kc.cr=this.Ih(this.Kc.cr);return this.pf.AVf(b)}HVf(b){this.Kc.cs=this.Ih(this.Kc.cs);this.ri(b);return this.pf.HVf(b)}Q7d(b){this.Kc.ct=this.Ih(this.Kc.ct);this.ri(b);return this.pf.Q7d(b)}R7d(b){this.Kc.cu=this.Ih(this.Kc.cu);this.ri(b);return this.pf.R7d(b)}T7d(b){this.Kc.cv=
this.Ih(this.Kc.cv);this.ri(b);return this.pf.T7d(b)}U7d(b){this.Kc.cw=this.Ih(this.Kc.cw);this.ri(b);return this.pf.U7d(b)}LVf(b){this.Kc.cx=this.Ih(this.Kc.cx);return this.pf.LVf(b)}V7d(b){this.Kc.cy=this.Ih(this.Kc.cy);this.ri(b);return this.pf.V7d(b)}Y7d(b){this.Kc.cz=this.Ih(this.Kc.cz);this.ri(b);return this.pf.Y7d(b)}$7d(b){this.Fl&&(this.Fl.pna=!0);this.Kc.da=this.Ih(this.Kc.da);this.ri(b);return this.pf.$7d(b)}OVf(b){this.Fl&&(this.Fl.pna=!0);this.Kc.db=this.Ih(this.Kc.db);this.ri(b);return this.pf.OVf(b)}X_c(b){this.Fl&&
(this.Fl.pna=!0);this.Kc.dc=this.Ih(this.Kc.dc);this.ri(b);return this.pf.X_c(b)}RVf(b){this.Kc.dd=this.Ih(this.Kc.dd);this.ri(b);return this.pf.RVf(b)}SVf(b){this.Kc.de=this.Ih(this.Kc.de);this.ri(b);return this.pf.SVf(b)}c8d(b){this.Fl&&(this.Fl.pna=!0);this.Kc.df=this.Ih(this.Kc.df);this.ri(b);return this.pf.c8d(b)}TVf(b){this.Fl&&(this.Fl.pna=!0);this.Kc.dg=this.Ih(this.Kc.dg);this.ri(b);return this.pf.TVf(b)}WVf(b){this.Kc.dh=this.Ih(this.Kc.dh);this.ri(b);return this.pf.WVf(b)}h8d(b){this.Fl&&
(this.Fl.pna=!0);this.Kc.di=this.Ih(this.Kc.di);this.ri(b);return this.pf.h8d(b)}i8d(b){this.Kc.dj=this.Ih(this.Kc.dj);this.ri(b);return this.pf.i8d(b)}j8d(b){this.Kc.dk=this.Ih(this.Kc.dk);this.ri(b);return this.pf.j8d(b)}k8d(b){this.Fl&&(this.Fl.wMc=!0);this.Kc.dl=this.Ih(this.Kc.dl);this.ri(b);return this.pf.k8d(b)}n8d(b){this.Kc.dm=this.Ih(this.Kc.dm);this.ri(b);return this.pf.n8d(b)}C1m(b){var h,v,D;w.AFrameworkApplication.te("ec3e8394;h715g427");null!==(h=this.Fl)&&void 0!==h&&h.bwi&&(h=b.cssText)&&
(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),this.Fl.NQf+=null!==(v=null===b||void 0===b?void 0:b.length)&&void 0!==v?v:0,this.Fl.OQf+=null!==(D=null===h||void 0===h?void 0:h.length)&&void 0!==D?D:0)}ri(b){const h=b.qf;if(h&&this.Fl){var v=h.tagName.toLowerCase();this.C1m(h.style);if(this.Vik&&this.Fui(v)||this.Wik&&!this.Fui(v)||this.Fl.jvi)if("font"===v&&this.cAn(b),h.style&&(b=h.style))for(const D of b)D&&0<D.length&&this.Fl.VVd(h.tagName,D)}}cAn(b){if((b=b.qf)&&"font"===b.tagName.toLowerCase()&&
this.Fl){var h=b.getAttribute("face");h&&0<h.length&&this.Fl.VVd(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Fl.VVd(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Fl.VVd(b.tagName,"font-attr-size")}}Fui(b){return this.ePg.contains(b)}}Object(n.a)(av,"HtmlEventUsageCollector",null,[768]);class mj{constructor(b,h,v=!1){this.qf=b;this.xB=h;this.jDk=v}}Object(n.a)(mj,"TagEventParam",null,[]);class Sx{constructor(b,h=null){this.whd=this._prunedElements=
this.zVe=this._voidElements=null;this.ud=b;this.U2=h||vp.a.K9h("");this.xno()}get Kc(){return this.U2}Nhn(b,h,v){this.zVe[h]?this.dRi():(this.Kc.e++,(h=this.whd[h])&&h(new mj(b,v,!1)),this.Kc.b++)}dRi(){this.Kc.d++}Ihn(){this.Kc.c++}uhn(b,h,v){if(this.zVe[h])this.dRi();else{if(h=this.whd[h])return this.Kc.b++,h(new mj(b,v,!1));this.Kc.f++}return 2}xno(){this._voidElements=lb.a.B5("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",
!0);this.zVe=lb.a.B5("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=lb.a.B5("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,h=this.ud,v=this.ud,D=this.ud,Q=this.ud,ba=this.ud,ta=
this.ud,Ta=this.ud,ob=this.ud,Kb=this.ud,Vb=this.ud,bc=this.ud,Dc=this.ud,Oc=this.ud,gd=this.ud,rd=this.ud,je=this.ud,Ld=this.ud,Qd=this.ud,ge=this.ud;this.whd=lb.a.B5("A",Object(z.a)(this.ud,this.ud.O5d,"onAOpen"),"ABBR",Object(z.a)(this.ud,this.ud.VRf,"onAbbrOpen"),"ACRONYM",Object(z.a)(this.ud,this.ud.WRf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.ud,this.ud.$Rf,"onAddressOpen"),"APPLET",Object(z.a)(this.ud,this.ud.pSf,"onAppletOpen"),"AREA",Object(z.a)(this.ud,this.ud.rSf,"onAreaTag"),"B",Object(z.a)(this.ud,
this.ud.U5d,"onBOpen"),"BASE",Object(z.a)(this.ud,this.ud.sSf,"onBaseTag"),"BASEFONT",Object(z.a)(this.ud,this.ud.tSf,"onBasefontTag"),"BDO",Object(z.a)(this.ud,this.ud.uSf,"onBdoOpen"),"BIG",Object(z.a)(this.ud,this.ud.X5d,"onBigOpen"),"BLOCKQUOTE",Object(z.a)(this.ud,this.ud.Y5d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.ud,this.ud.ISf,"onBodyOpen"),"BR",Object(z.a)(this.ud,this.ud.Z5d,"onBrTag"),"BUTTON",Object(z.a)(this.ud,this.ud.KSf,"onButtonOpen"),"CAPTION",Object(z.a)(this.ud,this.ud.$5d,
"onCaptionOpen"),"CENTER",Object(z.a)(this.ud,this.ud.a6d,"onCenterOpen"),"CITE",Object(z.a)(this.ud,this.ud.d6d,"onCiteOpen"),"CODE",Object(z.a)(this.ud,this.ud.e6d,"onCodeOpen"),"COL",Object(z.a)(this.ud,this.ud.WSf,"onColTag"),"COLGROUP",Object(z.a)(this.ud,this.ud.XSf,"onColgroupOpen"),"DD",Object(z.a)(this.ud,this.ud.l6d,"onDdOpen"),"DEL",Object(z.a)(this.ud,this.ud.m6d,"onDelOpen"),"DFN",Object(z.a)(this.ud,this.ud.p6d,"onDfnOpen"),"DIR",Object(z.a)(this.ud,this.ud.q6d,"onDirOpen"),"DIV",Object(z.a)(this.ud,
this.ud.s6d,"onDivOpen"),"DL",Object(z.a)(this.ud,this.ud.t6d,"onDlOpen"),"DT",Object(z.a)(this.ud,this.ud.v6d,"onDtOpen"),"EM",Object(z.a)(this.ud,this.ud.x6d,"onEmOpen"),"FIELDSET",Object(z.a)(this.ud,this.ud.wTf,"onFieldsetOpen"),"FONT",Object(z.a)(this.ud,this.ud.E6d,"onFontOpen"),"FORM",Object(z.a)(this.ud,this.ud.DTf,"onFormOpen"),"FRAME",Object(z.a)(this.ud,this.ud.FTf,"onFrameTag"),"FRAMESET",Object(z.a)(this.ud,this.ud.GTf,"onFramesetOpen"),"H1",Object(z.a)(this.ud,this.ud.H6d,"onH1Open"),
"H2",Object(z.a)(this.ud,this.ud.I6d,"onH2Open"),"H3",Object(z.a)(this.ud,this.ud.J6d,"onH3Open"),"H4",Object(z.a)(this.ud,this.ud.K6d,"onH4Open"),"H5",Object(z.a)(this.ud,this.ud.L6d,"onH5Open"),"H6",Object(z.a)(this.ud,this.ud.M6d,"onH6Open"),"HEAD",Object(z.a)(this.ud,this.ud.NTf,"onHeadOpen"),"HR",Object(z.a)(this.ud,this.ud.N6d,"onHrTag"),"HTML",Object(z.a)(this.ud,this.ud.UTf,"onHtmlOpen"),"I",Object(z.a)(this.ud,this.ud.O6d,"onIOpen"),"IFRAME",Object(z.a)(this.ud,this.ud.WTf,"onIframeOpen"),
"IMG",Object(z.a)(this.ud,this.ud.R6d,"onImgTag"),"INPUT",Object(z.a)(this.ud,this.ud.bUf,"onInputTag"),"INS",Object(z.a)(this.ud,this.ud.S6d,"onInsOpen"),"ISINDEX",Object(z.a)(this.ud,this.ud.hUf,"onIsindexOpen"),"KBD",Object(z.a)(this.ud,this.ud.U6d,"onKbdOpen"),"LABEL",Object(z.a)(this.ud,this.ud.W6d,"onLabelOpen"),"LEGEND",Object(z.a)(this.ud,this.ud.Y6d,"onLegendOpen"),"LI",Object(z.a)(this.ud,this.ud.Z6d,"onLiOpen"),"LINK",Object(z.a)(this.ud,this.ud.tUf,"onLinkTag"),"MAP",Object(z.a)(this.ud,
this.ud.xUf,"onMapOpen"),"MATH",Object(z.a)(this.ud,this.ud.a7d,"onMathOpen"),"MENU",Object(z.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.ud,this.ud.BUf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.ud,this.ud.KUf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.ud,this.ud.LUf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.ud,this.ud.NUf,"onObjectOpen"),"OL",Object(z.a)(this.ud,this.ud.m7d,"onOlOpen"),"OPTGROUP",Object(z.a)(this.ud,this.ud.PUf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.ud,
this.ud.n7d,"onOptionOpen"),"P",Object(z.a)(this.ud,this.ud.r7d,"onPOpen"),"PARAM",Object(z.a)(this.ud,this.ud.WUf,"onParamTag"),"PRE",Object(z.a)(this.ud,this.ud.y7d,"onPreOpen"),"Q",Object(z.a)(this.ud,this.ud.gVf,"onQOpen"),"S",Object(z.a)(this.ud,this.ud.H7d,"onSOpen"),"SAMP",Object(z.a)(this.ud,this.ud.I7d,"onSampOpen"),"SCRIPT",Object(z.a)(this.ud,this.ud.AVf,"onScriptOpen"),"SELECT",Object(z.a)(this.ud,this.ud.HVf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.Q7d,"onSmallOpen"),"SPAN",Object(z.a)(h,
h.R7d,"onSpanOpen"),"STRIKE",Object(z.a)(v,v.T7d,"onStrikeOpen"),"STRONG",Object(z.a)(D,D.U7d,"onStrongOpen"),"STYLE",Object(z.a)(Q,Q.LVf,"onStyleOpen"),"SUB",Object(z.a)(ba,ba.V7d,"onSubOpen"),"SUP",Object(z.a)(ta,ta.Y7d,"onSupOpen"),"TABLE",Object(z.a)(Ta,Ta.$7d,"onTableOpen"),"TBODY",Object(z.a)(ob,ob.OVf,"onTbodyOpen"),"TD",Object(z.a)(Kb,Kb.X_c,"onTdOpen"),"TEXTAREA",Object(z.a)(Vb,Vb.RVf,"onTextareaOpen"),"TFOOT",Object(z.a)(bc,bc.SVf,"onTfootOpen"),"TH",Object(z.a)(Dc,Dc.c8d,"onThOpen"),"THEAD",
Object(z.a)(Oc,Oc.TVf,"onTheadOpen"),"TITLE",Object(z.a)(gd,gd.WVf,"onTitleOpen"),"TR",Object(z.a)(rd,rd.h8d,"onTrOpen"),"TT",Object(z.a)(je,je.i8d,"onTtOpen"),"U",Object(z.a)(Ld,Ld.j8d,"onUOpen"),"UL",Object(z.a)(Qd,Qd.k8d,"onUlOpen"),"VAR",Object(z.a)(ge,ge.n8d,"onVarOpen"))}}Object(n.a)(Sx,"AHtmlProcessor",null,[]);class rA{constructor(b,h){this.childNodes=b.childNodes;this.xB=h;this.Lbf=0;this.ZXd=!1}}Object(n.a)(rA,"HtmlProcessorArguments",null,[]);class bv extends Sx{constructor(b,h=null){super(b,
h);this.PFe=null}get QOm(){null==this.PFe&&(this.PFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.PFe}process(b,h=null){b&&(this.ud.reset(),this.e3i(new rA(b,new yu.a),h))}e3i(b,h){b.childNodes.length&&(b=new Mf.a(h,Object(z.a)(this,this.hHn,"processChild"),b),b.Jl("HTML Processing Operation"),h||(b.Jh=!0),b.run())}hHn(b,h){const v=h.childNodes[h.Lbf];if(3===v.nodeType)return this.ud.V5d(),this.ud.Eca(v.nodeValue,new mj(v,h.xB.v6h())),
bv.bmc(h);if(1!==v.nodeType)return bv.bmc(h);if(!h.ZXd){const Q=G.a.VA(v.tagName);if(!bv.apm(v))if(this._prunedElements[Q])this.Ihn();else{bv.G9m(v);this.ud.V5d();var D=v.id;const ba=v.tagName,ta=h.xB.v6h(),Ta=v.getAttribute?v.getAttribute("class"):null;D=new Ox(D,ba,Ta?Ta:"",v.attributes?v.attributes.length:0);D.isValid&&ta.add(D);if(this._voidElements[Q])return this.Nhn(v,Q,ta),bv.bmc(h);D=!1;switch(this.uhn(v,Q,ta)){case 1:D=!0;break;case 3:return bv.bmc(h)}switch(this.ud.jwf(v)){case 1:D=!0}h.ZXd=
D;this.e3i(new rA(v,ta),b);if(!b.Jh)return!0}}if(h.ZXd){if(this.QOm&&!this.whd[G.a.VA(v.tagName)])return bv.bmc(h);this.ud.onClose()}return bv.bmc(h)}static G9m(b){3!==b.nodeType&&ei.a.Kl(b,"alreadyPasted",!0)}static apm(b){return 3!==b.nodeType&&ei.a.Db(b,"alreadyPasted")}static bmc(b){b.Lbf++;b.ZXd=!1;return b.Lbf<b.childNodes.length}}Object(n.a)(bv,"HtmlProcessor",Sx,[]);var ts=c(2025),pB=c(633);const tC={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,
["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,
["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,
["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,
["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,
["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,
["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,
["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,
["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,
["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,
["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,
["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,
["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,
["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,
["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,
["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["No Style Present"]:313,["OTHERS"]:314},
qB={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,
["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,
["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89};class uC{constructor(){this.xx=0;this.JHc=6;this.uHl=this.B1h=!1;this.z7e=null;this.J1h=this.I1h=this.H1h=this.D1h=this.C1h=!1;this.progId=null;this.Slf=this.F1h=this.E1h=this.pna=this.wMc=this.vHl=this.wHl=!1;this.HAn=this.eLb=0;this.IWf=this.platform=null;this.bui=this.OGf=!1;this.OQf=this.NQf=0;this.Vjk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,
["OneNote"]:9,["Other"]:10};this.kff=[1,3,4,2,5];this.Vtb={}}get LHm(){if(null!=this.LCg)var b=this.LCg;else{var h;b=this.LCg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get jvi(){if(null!=this.KCg)var b=this.KCg;else{var h;b=this.KCg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get bwi(){if(null!=
this.OCg)var b=this.OCg;else{var h;b=this.OCg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get dje(){if(null!==this.z7e)switch(this.z7e){case "XLO":return"Excel Online"}if(this.J1h)return"Word Online";if(this.I1h||this.C1h)return"PowerPoint Online";if(this.B1h)return"Excel Online";if(this.D1h)return"Google Docs";if(this.H1h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";
case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}m_(b,h){const v=new pa.a;v.name=b;"number"===typeof h?v.int64=h:v.bool=h;return v}sfe(b,h,v){const D=new pB.a;D.name=b;D.dataFields=h;D.dnmInterval=v;D.dnmAllowedPartA=this.kff;fa.a.sendDirectNumericEvent(D)}N2m(){const b=this.ZMk();if(this.LHm){var h=[];const v=[this.m_("isUserConsumer",this.OGf),this.m_("isDocumentBlank",this.bui),this.m_("FoundText",this.Slf),this.m_("FoundTable",
this.pna),this.m_("FoundImage",this.E1h),this.m_("FoundList",this.wMc),this.m_("FoundLink",this.F1h),this.m_("Browser",this.eLb),this.m_("SourceApp",this.Vjk[this.dje])];for(const D of v)h.push(D);this.sfe("Office.DNM.Word.Online.ExternalPasteEvent2",h,2)}this.bwi&&(h=[this.m_("NumberOfEm",this.NQf),this.m_("NumberOfRem",this.OQf)],Object(Qe.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));u.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}tKh(b,h){var v,D;const Q=[];b=this.m_("tag",null!==(v=
qB[b])&&void 0!==v?v:qB.OTHERS);h=this.m_("style",null!==(D=tC[h])&&void 0!==D?D:tC.OTHERS);D=this.m_("IsUserConsumer",this.OGf);Q.push(b);Q.push(h);Q.push(D);this.sfe("Office.DNM.Word.Online.ExternalPasteEvent1",Q,2)}O2m(){const b=this.Vtb;for(const v in b){var h=v;const D=b[v];if(this.jvi){0===Object.keys(D).length&&this.tKh(h,"No Style Present");for(const Q of Object.keys(D))this.tKh(h,Q)}D&&(D.SourceApp=this.dje,D.Browser=ts.a[this.eLb],D.TagName=h,D.OperationId=this.IWf,u.ULS.sendTraceTag(51406242,
307,50,JSON.stringify(D)))}}VVd(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.Vtb||(this.Vtb[b]={}),this.Vtb[b][h]=this.Vcm(b,h)+1)}Vcm(b,h){if(!(b&&b.length&&h&&h.length&&this.Vtb&&b in this.Vtb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.Vtb[b])&&h in b?b[h]:0}ZMk(){const b={};b.ActionIdFlags=this.xx;b.SourceApp=this.dje;b.CopySourceBrowser=this.JHc;b.PasteBrowser=this.eLb;b.IsSameBrowserPaste=this.IQm(this.JHc,this.eLb);b.IsCrossBrowserPaste=this.zHm(this.JHc,
this.eLb);b.IsUncategorizedBrowserPaste=this.sTm(this.JHc,this.eLb);b.Platform=this.platform;b.OperationId=this.IWf;return b}IQm(b,h){return 5===b||6===b?!1:b===h}zHm(b,h){return 6===b?!1:b!==h}sTm(b,h){return 5===b&&5===h}}Object(n.a)(uC,"HtmlContentMetadata",null,[]);var zy=c(242),sA=c(1442),ir=c(1054),bu=c(374),Tl=c(140),Cv=c(1683),Di=c(48),zt=c(216);class cn{get Gn(){return null!=this.IGg?this.IGg:this.IGg=Ga.a.instance.Na("Box4.Styles.StyleSettings")}constructor(b,h,v,D,Q,ba,ta){this.Z5b=ta;
this.Q1g=!1;this.yzj=this.YEe=null;this.sAn=Ta=>{ch.a.mark(5568);this.sXh(Ta);let ob=this.fbn;if(this.yyi){const Kb=this.rqj();Kb&&(ob=this.Omb);u.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Kb)}Ta.ji(ob);return!0};this.fbn=Ta=>{ch.a.mark(5569);var ob=new ne.GraphIterator;this.URa.restore(ob);cn.BU||(this.URa=null);var Kb=new ne.GraphIterator;this.elf.restore(Kb);this.elf=null;u.ULS.shipAssertTag(6305489,307,Cd.OutlineElementReader.Dh(ob));u.ULS.shipAssertTag(6305490,307,
Cd.OutlineElementReader.Dh(Kb));ig.OutlineElementNavigator.Ge(ob);var Vb=de.ParagraphReader.sh(ob)?de.ParagraphReader.textLength(ob.currentNode):0;ig.OutlineElementNavigator.Vd(ob);ig.OutlineElementNavigator.Ge(Kb);u.ULS.shipAssertTag(6305491,307,de.ParagraphReader.sh(Kb));var bc=de.ParagraphReader.textLength(Kb.currentNode);ig.OutlineElementNavigator.Vd(Kb);let Dc=this.Q7c;var Oc=new Km.a;Oc.Zc(ob);ig.OutlineElementNavigator.Ur(Oc,!1,!1);var gd=Oc.currentNode===Kb.currentNode,rd=!!this.Di&&!!(this.Di.xx&
8192);let je=!1;if(!rd&&this.Di.xd&&Object(yb.a)(fh.DictionaryPropertySet,this.Di.xd)){var Ld=this.Di.xd.Hf(wc.a.fLb);rd=Ld&&""!==Ld?!0:!1}Ld=!1;this.Di.xd instanceof zy.APropertySet&&(Ld=this.Di.xd.ia(wc.a.e4,!1));if(gd){Vb=ne.GraphIterator.$a(ob.currentNode);de.ParagraphReader.Xt(ig.OutlineElementNavigator.Ge(Vb))||(ob=Kb);ob.currentNode.id!==Kb.currentNode.id&&(u.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Hg.ListItemReader.Ig(ob),
Hg.ListItemReader.Ig(Kb)),rd=cn.lg.merge(ob,Kb,!0,rd),u.ULS.shipAssertTag(6305492,307,rd));Kb=ob;var Qd=!0}else{gd=!!(this.Di.xx&4);Qd=this.Ld.rg&&gd&&this.Di.M2a;var ge=!!(this.Di.xx&262144);this.nYf&&this.Di&&!gd&&!ge&&(this.nYf.oli(ob,!1),this.nYf.oli(Kb,!0));ig.OutlineElementNavigator.Ge(Oc);gd=de.ParagraphReader.sh(Oc)?de.ParagraphReader.textLength(Oc.currentNode):0;ig.OutlineElementNavigator.Vd(Oc);Di.a.pr&&this.Di.xx&65536||this.AFk(Oc,ob,Kb);ge=new Km.a;ge.Zc(Oc);ig.OutlineElementNavigator.Ur(ge,
!1,!1);cn.BU&&ge.currentNode.id===Kb.currentNode.id&&(this.Q1g=!0);if(this.$W.dNa||this.Tqo)if(ge.Nn.id!==Kb.Nn.id){for(;Oc.currentNode.id!==Kb.currentNode.id;)ig.OutlineElementNavigator.Ge(Oc,!1),this.$W.sHa(Pe.a.create(Oc.currentNode)),Oc.sc(),ig.OutlineElementNavigator.Ur(Oc,!1,!1);Oc.Zc(ob);ig.OutlineElementNavigator.Ur(Oc,!1,!1)}else je=!0;this.hZ&&({Q7c:Dc,qva:Oc}=this.hZ.f0f(ob,Kb,Dc,Oc));zt.a.h8&&this.Z5b&&(Oc=this.Z5b.f0f(ob,Kb,Oc));if(this.Di.zde&&(u.ULS.shipAssertTag(6305493,307,this.Di.Xac),
ge=new ne.GraphIterator,ge.Zc(Oc),ge=ig.OutlineElementNavigator.Ge(ge))){var ze=this.Di.zde.Ef(ge.pa.J(0));ge.pa.J(0).formatting=ze}ge=0;rd&&this.bNe&&(ge=1);ze=this.tro(ob,Oc,ge);this.Di.yje=null;if(this.Di.Nia||this.Di.kUa)this.Di.yje=this.Bcm(ze?ob.currentNode:Oc.currentNode,ze);var gg=!1;ze&&(gg=Hg.ListItemReader.Ig(ob),u.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",gg,Hg.ListItemReader.Ig(Kb)),this.YEe=gg=cn.lg.merge(ob,
Oc,!0,rd,Kb,void 0,je,Qd,this.bNe),this.uro(ob,ge)&&this.Dbn(ob,Kb,ge,rd));ge=cn.GAn.Uym(ob,Oc,Kb,Vb,gg,this.STc);var Kg=!1;if(Dc){const Ll=new Km.a;Ll.Zc(Kb);ig.OutlineElementNavigator.q0(Ll,!1,!1);Kg=Hg.ListItemReader.Ig(Ll);const Em=Hg.ListItemReader.Ig(Kb),up=Ld;u.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",up);Qd=cn.lg.merge(Ll,Kb,!0,rd,void 0,!0,void 0,Qd,this.bNe,up);u.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",
Kg,Em,Qd?"True":"False, will cause IP to reset to zero.");Kb=(Kg=Qd)?Ll:Kb}else Qd=!1,u.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.$W.dNa&&je&&(ze&&!this.QJm(ge,gg)?(Oc=new ne.GraphIterator,Oc.Zc(ob),ob=ig.OutlineElementNavigator.Ge(Oc),this.$W.iqa(ob,Vb,Vb+gd)):Dc&&!this.tMm(ge,Kg)?(ob=new ne.GraphIterator,ob.Zc(Oc),ob=ig.OutlineElementNavigator.Ge(ob),this.$W.iqa(ob,0,gd)):(ob=new ne.GraphIterator,ob.Zc(Oc),ob=ig.OutlineElementNavigator.Ge(ob),this.$W.sHa(Pe.a.create(ob))));
this.cEn(ge);this.isProgressiveStyleEnabled&&!rd&&this.HH.bIn(ge)}u.ULS.shipAssertTag(6305494,307,Kb.isValid);rd=ig.OutlineElementNavigator.Ge(Kb);bc=Qd?de.ParagraphReader.textLength(rd)-bc:0;this.Di.q0a=Ld?Mg.SelectionFactory.LK(rd,bc-1,bc):Mg.SelectionFactory.ue(rd,bc);this.Di&&this.Di.Xac&&de.ParagraphReader.Vb(rd)&&this.Di.H8d&&((bc=this.Di.H8d.aDo)&&this.ZG.PJ(bc,rd,!0),(bc=this.Di.H8d.ozn)&&this.paragraphEditor.Dth(rd,bc));Ta.ji(this.Omb);return!0};this.Ylo=Ta=>{const ob=ne.GraphIterator.$a(this.yzj);
ob.gF(1);this.Di.q0a=Mg.SelectionFactory.ho(ob.currentNode,!1);Ta.ji(this.Omb);return!0};this.Omb=()=>{var Ta=void 0===this.Di.xx||null===this.Di.xx?"not available":Object(sA.a)(Cv.a,this.Di.xx);u.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Di.xx,Ta);u.ULS.shipAssertTag(6305497,307,!!this.Di.q0a);this.STc?Object(Qe.a)("ExternalPasteAction",!0):Object(Qe.a)("InternalPasteAction",!0);cn.BU&&this.URa&&(Ta=new ne.GraphIterator,this.URa.restore(Ta),this.URa=null,this.oom(Ta));this.transaction.dispose();
Ta=this.St.tu;if(!Ta.qe||!Ta.editingView.Sj)return!1;Ta.editingView.MGo();return!1};this.jFa=b;this.elf=this.URa=null;this.Di=h;this.transaction=v;this.hZ=D;this.St=Q;this.w6=ba}get K(){return w.AFrameworkApplication.K}get bNe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get HH(){return null!=this.Czg?this.Czg:this.Czg=Ga.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Gn&&this.Gn.isProgressiveStyleEnabled}get ZG(){return null!=
this.dJg?this.dJg:this.dJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get wc(){return null!=this.GJg?this.GJg:this.GJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.fFg?this.fFg:this.fFg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get Gd(){return null!=this.MDg?this.MDg:this.MDg=Ga.a.instance.resolve("Box4.List.IListReader")}get Un(){return null!=this.yDg?this.yDg:this.yDg=Ga.a.instance.resolve("Box4.List.IListEditor")}get VQ(){return null!=
this.nAg?this.nAg:this.nAg=Ga.a.instance.resolve("Box4.IBox4GraphWriter")}get B8c(){return null!=this.mGg?this.mGg:this.mGg=Ga.a.instance.Na("Box4.List.ISingleLevelListEditor")}get lj(){return null!=this.VHg?this.VHg:this.VHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Fh(){return null!=this.vIg?this.vIg:this.vIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Ld(){return null!=this.dIg?this.dIg:this.dIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get $W(){return null!=
this.kwg?this.kwg:this.kwg=Ga.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get nYf(){return null!=this.rFg?this.rFg:this.rFg=Ga.a.instance.Na("Box4.IPastedParagraphSpaceHandler")}get f0i(){return!1}tXh(){}get STc(){return!1}V_i(b){var h=void 0===this.Di.xx||null===this.Di.xx?"not available":Object(sA.a)(Cv.a,this.Di.xx);u.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Di.xx,h);u.ULS.shipAssertTag(6305487,307,We.SelectionEditor.gf(this.jFa));if(this.p5d)return u.ULS.sendTraceTag(6305488,
307,50,"NothingToPaste"),this.Di.q0a=Mg.SelectionFactory.io(this.jFa),b.ji(this.Omb),!0;if(!this.jFa.node)return u.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new ne.GraphIterator;h.set(this.jFa.node);We.SelectionEditor.mu(h);ig.OutlineElementNavigator.Vd(h);this.yzj=h.origin;if(this.f0i)return h.Ht(10),this.tXh(h,b),b.ji(this.Ylo),!0;this.hZ&&this.hZ.wkn(this.jFa);if(!this.cAo(this.jFa))return this.Di.yR&&(this.Di.yR.fail("SplitLine Failed",
!0),this.Di.failed=!0),this.Di.q0a=Mg.SelectionFactory.io(this.jFa),b.ji(this.Omb),!0;const v=new Km.a;v.Zc(h);ig.OutlineElementNavigator.Ur(v,!1,!1);this.URa=new ir.a(h);this.elf=new ir.a(v);b.ji(this.sAn);return!0}rqj(){return!1}get yyi(){return this.K.$("PptCcpFix2IsEnabled")}get Tqo(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}QJm(b,h){return!h&&!!b&&Cd.OutlineElementReader.Dh(b.qva)&&Cd.OutlineElementReader.Neb(b.qva)}tMm(b,h){return!h&&!!b&&Cd.OutlineElementReader.Dh(b.Akb)&&
Cd.OutlineElementReader.Neb(b.Akb)}cEn(b){cn.N1i&&b&&cn.N1i.YHn(b)}tro(b,h,v){var D;Hg.ListItemReader.Ig(b)?(null===(D=this.B8c)||void 0===D?void 0:D.ozf(b),h=Hg.ListItemReader.Ig(h)?this.Kpj:!0):Cd.OutlineElementReader.isEmpty(b,!0)&&!v?(cn.lg.Q_a(b),h=!1):h=!0;this.hZ&&(h=this.hZ.SVk(b,h));return h}uro(b,h){return Hg.ListItemReader.Ig(b)||1===h?!0:!1}Dbn(b,h,v,D){const Q=Hg.ListItemReader.Ig(b);if(Q){if(D=new Km.a,D.Zc(b),ig.OutlineElementNavigator.Ur(D,!1,!1),D.Nn.id!==h.Nn.id){v=this.Gd.lw(b);
this.Gd.fP(b);var ba=b.currentNode.ia(lc.a.listID,0);b.sc();var ta=this.Gd.Ysj,Ta=!0;for(v.RB=Uj.a.ql;D.currentNode.id!==h.currentNode.id;){if(!ta||!Cd.OutlineElementReader.ato(D))if(!Hg.ListItemReader.Ig(D))Tl.a.getInstance().Iv?(Cd.OutlineElementReader.MQc(D)||({owa:v}=this.Un.Sla(v.propertySet,D,v)),this.Un.i$()):{owa:v}=this.Un.Sla(v.propertySet,D,v),Ta=!1;else if(Q){Ta=this.Gd.mrf(D);var ob=this.Gd.Fx(b.currentNode,ba,Ta);ob=ob?bu.a.O7(ob,null):v;Ta=bu.a.n_(ob.listType,v.listStyle,null,0,Ta,
"","");Ta.Mlb=b.currentNode;this.Un.Fko(Ta);this.Un.Fge(D,!0);Ta=!1}ig.OutlineElementNavigator.Ur(D,!1,!1)}ta&&Ta&&this.Un.NHk()}}else if(1===v)for(v=new Km.a,v.Zc(b),ig.OutlineElementNavigator.Ge(v),b=de.ParagraphReader.sh(v)?v.currentNode:null,ba=this.wc.buf(v),ig.OutlineElementNavigator.Vd(v),ig.OutlineElementNavigator.Ur(v,!1,!1);v.currentNode.id!==h.currentNode.id;)ig.OutlineElementNavigator.Ge(v),ta=de.ParagraphReader.sh(v)?v.currentNode:null,ig.OutlineElementNavigator.Vd(v),ta&&b&&D&&(ba&&
this.ZG.PJ(ba,ta,!0),this.w6.ANi(b,ta,Q),this.w6.WFa(b,ta,1,!0)),ig.OutlineElementNavigator.Ur(v,!1,!1)}AFk(b,h,v){var D=!1;if(this.Ld.rg)if(Di.a.pr)D=!0;else{var Q=!1;this.hZ&&(Q=h.currentNode,Q=this.hZ.TOm(Q)||this.hZ.VEf(Q));Q?this.Ld.Y4a=4:D=!0}if(D){for(;b.currentNode!==v.currentNode;){ig.OutlineElementNavigator.Ge(b,!1);D=this.Fh.O8c(Pe.a.create(b.currentNode));let ba;({type:ba}=D.DSd()).returnValue&&this.Ld.Ls(ba);for(Q=0;Q<D.length;Q++){let ta;const Ta=({F_d:ta}=D.getContext(Q)).returnValue;
ta&&(cn.hyperlinkEditor.Flb(Ta,1),this.lj.zob(Ta,1,null,!0))}b.sc();ig.OutlineElementNavigator.Ur(b,!1,!1)}b.Zc(h);ig.OutlineElementNavigator.Ur(b,!1,!1)}}Bcm(b,h){b=ne.GraphIterator.$a(b);ig.OutlineElementNavigator.Ge(b);return de.ParagraphReader.Vb(b.currentNode)?(h=h?de.ParagraphReader.textLength(b.currentNode):0,Mg.SelectionFactory.ue(b.currentNode,h)):rh.TableReader.CU(b.currentNode)?Mg.SelectionFactory.uq(b.currentNode):null}oom(b){if(b){if(this.STc&&rh.TableReader.ex(b)&&this.Q1g){if(null!=
this.YEe&&0==this.YEe){var h=new Km.a;h.Zc(b);ig.OutlineElementNavigator.Ur(h,!1,!1);b.Zc(h)}h=pp.a.S2n(b);const v=de.ParagraphReader.kl(h);h&&v&&(this.Di.q0a=Mg.SelectionFactory.ue(v,0),b=ne.GraphIterator.$a(h))}else cn.POm&&pp.a.AAn(b);b&&rh.TableReader.ex(b)&&Ig.returnToContainingCell(b)&&pp.a.vzk(b.currentNode)}else u.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}Upo(b,h){const v=new ne.GraphIterator;v.Zc(b);b=ig.OutlineElementNavigator.Ge(v);h=de.ParagraphReader.Vb(b)&&
h===de.ParagraphReader.textLength(b);u.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}cAo(b){var h;u.ULS.shipAssertTag(6305498,307,We.SelectionEditor.gf(b));if(null===(h=this.VQ)||void 0===h?0:h.splitParagraph)return!!this.VQ.splitParagraph(b.node,b.cpBegin,{YHl:!0,Eb:b.Eb,Rb:b.Rb});h=ne.GraphIterator.$a(b.node);var v=h.vd();ig.OutlineElementNavigator.Vd(h);v&&b.isValid||u.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:v,
["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Cd.OutlineElementReader.Dh(h)&&(u.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;v=cn.lg.joa(h,!0);const D=this.Upo(h,b.cpBegin);cn.lg.X9(h,v,b,!1,!1,!0,D);return!0}static get hyperlinkEditor(){return null!=cn.vAg?cn.vAg:cn.vAg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get nf(){return bi.PageReader.instance}static get lg(){return null!=
cn.rEg?cn.rEg:cn.rEg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}static get Vn(){return Tl.a.getInstance()}static get Xb(){return null!=cn.Lyg?cn.Lyg:cn.Lyg=Ga.a.instance.Na("Box4.IFeatureHelper")}static get N1i(){return null!=cn.xFg?cn.xFg:cn.xFg=Ga.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get GAn(){return null!=cn.qFg?cn.qFg:cn.qFg=Ga.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get BU(){null==this.PL&&(w.AFrameworkApplication.te("he991617;3eed2178"),
this.PL=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.PL}static get POm(){null==this.OFe&&(w.AFrameworkApplication.te("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.OFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.OFe}}cn.PL=null;cn.OFe=null;
Object(n.a)(cn,"APasteExecutionManager",null,[]);class sz{constructor(b){this.Lj=b}reset(){this.Lj.reset()}get XIc(){return this.Lj.XIc}Eca(b,h){this.Lj.Eca(b,h)}Dca(b){this.Lj.Dca(b)}omb(b){this.Lj.omb(b)}txa(b){this.Lj.txa(b)}kGa(b){this.Lj.kGa(b)}tRa(b,h){this.Lj.tRa(b,h)}sRa(){this.Lj.sRa()}aE(b){this.Lj.aE(b)}oF(){this.Lj.oF()}jmb(){this.Lj.jmb()}imb(){this.Lj.imb()}xxa(b){this.Lj.xxa(b)}vxa(){this.Lj.vxa()}pGa(b){this.Lj.pGa(b)}wxa(){this.Lj.wxa()}I4a(b){this.Lj.I4a(b)}k9(b){this.Lj.k9(b)}i9(){this.Lj.i9()}K4(b){this.Lj.K4(b)}j9(){this.Lj.j9()}h9(b){this.Lj.h9(b)}g9(){this.Lj.g9()}yRa(b,
h){this.Lj.yRa(b,h)}G4a(){this.Lj.G4a()}}Object(n.a)(sz,"AHtmlNormalizer",null,[298,299]);class ur extends sz{constructor(b){super(b);this.KJ=!1}Eca(b,h){this.KJ?this.WM.pM(()=>{this.s0f(b,h)}):this.s0f(b,h)}s0f(b,h){this.Lj.Eca(b,h)}Dca(b){this.KJ?this.WM.pM(()=>{this.W_f(b)}):this.W_f(b)}W_f(b){this.Lj.Dca(b)}txa(b){this.KJ?this.WM.pM(()=>{this.T1c(b)}):this.T1c(b)}T1c(b){this.Lj.txa(b)}kGa(b){this.KJ?this.WM.pM(()=>{this.U_f(b)}):this.U_f(b)}U_f(b){this.Lj.kGa(b)}tRa(b,h){this.KJ?this.WM.pM(()=>
{this.P_f(b,h)}):this.P_f(b,h)}P_f(b,h){this.Lj.tRa(b,h)}sRa(){this.KJ?this.WM.pM(Object(z.a)(this,this.O_f,"processAnchorEnd")):this.O_f()}O_f(){this.Lj.sRa()}aE(b){this.KJ?this.WM.pM(()=>{this.e0f(b)}):this.e0f(b)}e0f(b){this.Lj.aE(b)}oF(){this.KJ?this.WM.pM(Object(z.a)(this,this.d0f,"processParagraphEnd")):this.d0f()}d0f(){this.Lj.oF()}jmb(){this.KJ?this.WM.pM(Object(z.a)(this,this.h0f,"processPreFormattedTextStart")):this.h0f()}h0f(){this.Lj.jmb()}imb(){this.KJ?this.WM.pM(Object(z.a)(this,this.g0f,
"processPreFormattedTextEnd")):this.g0f()}g0f(){this.Lj.imb()}xxa(b){this.KJ?this.WM.pM(()=>{this.$_f(b)}):this.$_f(b)}$_f(b){this.Lj.xxa(b)}vxa(){this.KJ?this.WM.pM(Object(z.a)(this,this.X_f,"processListEnd")):this.X_f()}X_f(){this.Lj.vxa()}pGa(b){this.KJ?this.WM.pM(()=>{this.Z_f(b)}):this.Z_f(b)}Z_f(b){this.Lj.pGa(b)}wxa(){this.KJ?this.WM.pM(Object(z.a)(this,this.Y_f,"processListItemEnd")):this.Y_f()}Y_f(){this.Lj.wxa()}k9(b){this.KJ?this.WM.pM(()=>{this.r0f(b)}):this.r0f(b)}r0f(b){this.Lj.k9(b)}i9(){this.KJ?
this.WM.pM(Object(z.a)(this,this.o0f,"processTableEnd")):this.o0f()}o0f(){this.Lj.i9()}K4(b){this.KJ?this.WM.pM(()=>{this.q0f(b)}):this.q0f(b)}q0f(b){this.Lj.K4(b)}j9(){this.KJ?this.WM.pM(Object(z.a)(this,this.p0f,"processTableRowEnd")):this.p0f()}p0f(){this.Lj.j9()}h9(b){this.KJ?this.WM.pM(()=>{this.n0f(b)}):this.n0f(b)}n0f(b){this.Lj.h9(b)}g9(){this.KJ?this.WM.pM(Object(z.a)(this,this.m0f,"processTableCellEnd")):this.m0f()}m0f(){this.Lj.g9()}yRa(b,h){this.KJ?this.WM.pM(()=>{this.b0f(b,h)}):this.b0f(b,
h)}b0f(b,h){this.Lj.yRa(b,h)}G4a(){this.KJ?this.WM.pM(Object(z.a)(this,this.x3i,"processMathEnd")):this.x3i()}x3i(){this.Lj.G4a()}}Object(n.a)(ur,"AQueuingHtmlNormalizer",sz,[]);var nD=c(1967);class Tx{constructor(){this.yOe=new nD.a}pM(b){this.yOe.enqueue(b)}flush(b=!1){for(b&&this.Ufe();!this.yOe.isEmpty;)this.yOe.dequeue()();b&&this.Ode()}Ufe(){}Ode(){}}Object(n.a)(Tx,"QueuedEventManager",null,[]);class At extends Tx{constructor(b){super();this.id=void 0;this.Zbf=null;this.SYd=!1;this.xpa="";this.RYd=
this.KZd=!1;this.Pbf=this.Z3b=null;this.wZc=0;this.CUc=this.hWc=this.JGf=!1;this.table=null;this.jQf=0;this.AZ=b}get $Dc(){return!!this.table}Ufe(){this.AZ.gfc.push(this.AZ.currentState);this.AZ.currentState=this}Ode(){this.AZ.currentState=this.AZ.gfc.pop()}}At.nextId=void 0;Object(n.a)(At,"ContentState",Tx,[]);class Hu{constructor(b,h,v){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.j3a=b.j3a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.lja=b.lja;this.Ake=b.Ake;this.xbc=b.xbc;this.z7=b.z7;this.contents=v;this.Jjm=h}}Object(n.a)(Hu,"TableCell",null,[]);var rB=c(1684),sB=c(1685);class tB extends Tx{constructor(b,h){super();this.AZ=b;this.Fhh=new yu.a;this.Yja=new yu.a;this.NJe=[];this.itd=[];this.MJa=-1;this.jVa=0;this.u7j=h.DBf;this.t7j=h.NFm;this.Rkk=h.qhg;this.sq=h.width;this.F1g=h.j3a;this.z4j=new Is.a(new Ox(h.o9.Yni,h.o9.lVd),h.xB,h.Gxa,h.cultureName,h.WBa);this.n6j=h.YVd;this.Jvd=h.styleId;this.Wkk=h.tableLook}get Lj(){return this.AZ.Lj}wFn(b){this.MJa++;
this.Fhh.add(b);this.itd[this.MJa]=b.height;this.jVa=0}get yfl(){for(;this.jVa>=this.Yja.count;)this.Yja.add(Array(this.MJa+1));return this.Yja.J(this.jVa)}yqk(b,h,v,D,Q,ba,ta){if(0>this.MJa)return!1;for(;this.NJe[this.jVa]>=this.MJa;)this.jVa++;b=new Hu(b,new Is.a(h,v,D,Q,ba),ta);this.yfl[this.MJa]=b;if(1<b.rowSpan)for(h=this.MJa+b.rowSpan-1,D=this.jVa,v=this.jVa+b.colSpan-1;D<=v;D++)this.NJe[D]>=h||(this.NJe[D]=h);this.jVa+=b.colSpan;this.itd[this.MJa]<b.height&&(this.itd[this.MJa]=b.height);return!0}Ufe(){this.AZ.currentState.table=
this}Ode(){this.AZ.currentState.table=null}f0h(){w.AFrameworkApplication.te("fd8b6402;j6e17681");this.flush(!0);const b=this.MJa+1;var h=Array(b);for(var v=0;v<b;v++)h[v]=Array(this.Yja.count);v=!0;var D=0;for(var Q=0;Q<this.Yja.count;Q++){var ba=this.Yja.J(Q),ta=!0;for(var Ta=0;Ta<b;Ta++){var ob=ba[Ta];ob&&(ta=!1,h[Ta][Q+D]=new vy(ob.colSpan,ob.rowSpan,ob.width,ob.height,void 0,void 0,void 0,void 0,ob.j3a,ob.xbc))}ta?(this.Yja.removeAt(Q),Q--,++D):v=!1}if(!v){(h=this.F1g?this.AZ.Tzh(h,this.sq/100):
this.AZ.Tzh(h,1,this.sq))&&h.length!==this.Yja.count&&(h=null);this.AZ.ggb(!0);this.AZ.UDd();this.Lj.k9(new rv(b,this.Yja.count,this.sq,this.F1g,h,this.u7j,this.t7j,this.Rkk,this.n6j,this.Jvd,this.Wkk,this.z4j));for(h=0;h<b;h++){v=this.Fhh.J(h);this.Lj.K4(new dw(this.itd[h],new Is.a(v.o9,v.xB,v.Gxa,v.cultureName,v.WBa)));for(v=0;v<this.Yja.count;v++){D=this.Yja.J(v)[h];var Kb=!!this.Jvd&&""!==this.Jvd&&"Custom"!==this.Jvd;Q=D?D.colSpan:0;ba=D?D.rowSpan:0;D&&(Q=Math.min(D.colSpan,this.Yja.count-v),
ba=Math.min(D.rowSpan,b-h));ta=D?D.width:0;Ta=D?D.height:0;ob=D?D.z7:0;const Vb=D?D.j3a:!1,bc=D&&(65536&ob||!Kb)?D.shadingColor:"",Dc=D?D.verticalAlignment:0,Oc=D?D.xbc:!1;Kb=D?this.AZ.u4l(D.lja,v,h,this.Yja,Kb,D.z7):new rB.a;const gd=D?D.Ake:new sB.a,rd=D?D.Jjm:null;this.Lj.h9(new vy(Q,ba,ta,Ta,bc,Dc,Kb,gd,Vb,Oc,ob,new Is.a(rd?rd.o9:null,rd?rd.xB:null,rd?rd.Gxa:null,rd?rd.cultureName:null,rd?rd.WBa:null)));D&&!D.xbc&&(D.contents.Ufe(),D.contents.flush(),this.AZ.ggb(!1),this.AZ.UDd(),D.contents.Ode());
this.Lj.g9()}this.Lj.j9()}this.Lj.i9();this.AZ.currentState.CUc=!1;this.AZ.kWh(!1)}}}Object(n.a)(tB,"NormalizedTable",Tx,[]);class tA{constructor(b=!1,h=!1){this.d8j=b;this.ola=h}get ILm(){return this.d8j}get V6a(){return this.ola}}Object(n.a)(tA,"HtmlNormalizerSettings",null,[767]);class zk extends ur{constructor(b,h=null){super(b);this.HGe=null;this.gfc=new kt;this.tVb=h||new tA}reset(){super.reset();this.currentState=new At(this);this.gfc.clear();this.KJ=!1}get WM(){return this.currentState&&this.currentState.$Dc?
this.currentState.table:this.currentState}lKd(b=!1){this.currentState.SYd||(this.UDd(),this.Lj.aE(this.currentState.Zbf),this.currentState.SYd=!0,this.currentState.CUc=!1);b||!this.currentState.Z3b||this.currentState.RYd||(this.Lj.tRa(this.currentState.Z3b,this.currentState.Pbf),this.currentState.RYd=!0)}SKc(){this.currentState.RYd&&(this.Lj.sRa(),this.currentState.RYd=!1)}mvl(){this.currentState.SYd&&(this.Lj.oF(),this.currentState.SYd=!1,this.currentState.xpa="")}kWh(b){this.currentState.hWc&&(this.currentState.CUc?
b||(this.Lj.aE(null),this.Lj.oF(),this.Lj.wxa(),this.currentState.hWc=!1):(this.Lj.wxa(),this.currentState.hWc=!1,this.currentState.CUc=!0))}ggb(b){this.SKc();this.mvl();this.kWh(b)}$vn(b){this.Lj.xxa(new Fr.a(2,1,b));this.currentState.wZc++;this.currentState.JGf=!0}UDd(){!this.currentState.hWc&&this.currentState.JGf&&(this.Lj.vxa(),this.currentState.wZc--,this.currentState.JGf=!1)}s0f(b,h){b=this.Ogn(b);if(""!==b)if(this.lKd(),this.currentState.KZd)this.t0f(b,h);else{b=b.split(zk.nPk);for(let v=
0;v<b.length-1;v++)this.t0f(b[v],h),this.Lj.omb(h);this.t0f(b[b.length-1],h)}}b0f(b,h){""!==b&&(this.lKd(),this.Lj.yRa(b,h))}W_f(b){this.tVb.V6a||this.SKc();this.lKd(!0);this.Lj.Dca(b)}U_f(b){this.currentState.$Dc||this.Lj.kGa(b)}T1c(b){this.currentState.Z3b&&(b.href=this.currentState.Z3b);super.T1c(b)}P_f(b,h){this.SKc();this.currentState.Z3b=b;this.currentState.Pbf=h}O_f(){this.SKc();this.currentState.Z3b=null;this.currentState.Pbf=null}e0f(b){this.currentState.Zbf=b;this.ggb(!0)}d0f(){this.currentState.Zbf=
null;this.ggb(!0)}h0f(){this.currentState.KZd=!0}g0f(){this.currentState.KZd=!1}$_f(b){this.ggb(!1);this.UDd();this.Lj.xxa(b);this.currentState.wZc++}X_f(){this.ggb(!1);this.Lj.vxa();this.currentState.wZc--}Z_f(b){this.ggb(!1);this.currentState.wZc||this.$vn(b);this.Lj.pGa(b);this.currentState.hWc=!0;this.currentState.CUc=!0}Y_f(){this.ggb(!1)}k9(b){this.currentState.$Dc||(this.KJ=!0,this.currentState.table=new tB(this,b))}r0f(){}i9(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.gfc.isEmpty?(this.KJ=!1,b.f0h()):this.WM.pM(Object(z.a)(b,b.f0h,"flushTable"))}}o0f(){}K4(b){this.currentState.$Dc&&this.currentState.table.wFn(b)}q0f(){}j9(){}p0f(){}h9(b){let h=!1;if(this.currentState.$Dc){const v=new At(this);this.currentState.table.yqk(b,new Ox(b.o9.Yni,b.o9.lVd),b.xB,b.Gxa,b.cultureName,b.WBa,v)?(this.gfc.push(this.currentState),this.currentState=v):h=!0}else h=!0;h&&this.currentState.jQf++}n0f(){}g9(){0<this.currentState.jQf?this.currentState.jQf--:this.currentState=
this.gfc.pop()}m0f(){}Tzh(b,h=1,v=0){if(!b)return null;const D=b.length;if(!D)return null;const Q=b[0].length;for(var ba=1;ba<D;ba++)if(b[ba].length!==Q)return null;ba=Array(Q+1);ba[0]=0;const ta=Array(Q+1);for(var Ta=0;Ta<ta.length;Ta++)ta[Ta]=!1;const ob=new zb.a;Ta=0;for(let Vb=0;Vb<Q;Vb++){for(var Kb=0;Kb<D;Kb++){const bc=b[Kb][Vb];if(bc&&0<bc.width){const Dc=Math.min(Vb+bc.colSpan,Q);ba[Dc]=ba[Vb]+bc.width*(bc.j3a?h:1);ta[Dc]=!0}}if(ta[Vb+1]){Kb=ba[Vb+1]-ba[Vb];if(0>=Kb)return null;ob.add(Kb)}else ba[Vb+
1]=ba[Vb],0<v&&this.LBi&&(ob.add(-1),Ta++)}b=ob.toArray();if(0<Ta&&0<v&&this.LBi)for(u.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),v=(v-ba[ba.length-1])/Ta,h=0;h<b.length;h++)-1===b[h]&&(b[h]=v);return b}get LBi(){null==this.HGe&&(w.AFrameworkApplication.te("2i46g603;2fc7g589"),this.HGe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.HGe}o$m(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}u4l(b,h,v,D,Q,ba){if(!b)return null;Q&&(b=this.o$m(b,ba));if(0>v||0>h||h>D.count-1)return b;0<=h-1&&v<=D.J(h-1).length-1&&1===b.borderLeftStyle&&(Q=D.J(h-1)[v])&&1!==Q.lja.borderRightStyle&&(b.borderLeftStyle=Q.lja.borderRightStyle,b.borderLeftColor=Q.lja.borderRightColor,b.borderLeftWidth=Q.lja.borderRightWidth);0<=v-1&&v<=D.J(h).length-1&&1===b.borderTopStyle&&(h=D.J(h)[v-
1])&&1!==h.lja.borderBottomStyle&&(b.borderTopStyle=h.lja.borderBottomStyle,b.borderTopColor=h.lja.borderBottomColor,b.borderTopWidth=h.lja.borderBottomWidth);return b}Ogn(b){this.currentState.KZd||(b=this.tVb.ILm?b.replace(zk.rtm," "):b.replace(zk.qtm," "));b.startsWith(" ")&&(this.currentState.xpa.endsWith(" ")||""===this.currentState.xpa)&&(b=G.a.substring(b,1,b.length));return b}t0f(b,h){""!==b&&(this.Lj.Eca(b,h),this.currentState.xpa+=b)}}zk.qtm=RegExp("[ \t\f\u200b\r\n]+","g");zk.rtm=RegExp("[ \f\u200b\r\n]+",
"g");zk.nPk="\t";Object(n.a)(zk,"DefaultHtmlNormalizer",ur,[]);class uA extends zk{constructor(b,h,v){super(b,v);this.IXg=!1;this.$tb=h}static eIm(b){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=uA.Dkl.exec(b))&&0<b.length:!1}T1c(b){this.$tb.Ifc&&(w.AFrameworkApplication.Woa?this.IXg||(b=new pg.StandardDialog,b.Ad=0,b.Ee(1,CommonUIStrings.l_DialogClose),b.Ju(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.IXg=!0):this.$tb.HMi?this.$tb.K3d=!0:b.src&&""!==b.src?ja.a.getOrigin(b.src)!==ja.a.getOrigin(window.location.href)||uA.eIm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?w.AFrameworkApplication.va.processAction(Eb.a.a0i,2):b.src.startsWith("webkit-fake-url")?w.AFrameworkApplication.va.processAction(Eb.a.$_i,2):(this.SKc(),this.lKd(!0),this.Lj.txa(b)):w.AFrameworkApplication.va.processAction(Eb.a.c0i,2):w.AFrameworkApplication.va.processAction(Eb.a.b0i,2))}}uA.Dkl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(n.a)(uA,"Box4HtmlNormalizer",zk,[]);class Bt{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.htmlProcessor=b;this.Ryf=h;this.jUk=v;this.uKj=D;this.qHl=Q;this.Xbo=ba;this.Ybo=ta;this.kVd=Ta;this.jtm=ob;this.mtm=Kb;this.JXc=Vb}}Object(n.a)(Bt,"ExecutePasteArguments",null,[]);class vC extends cn{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je){super(h,v,D,Kb,bc,gd,je);this.Bka=null;this.Hgn=Ld=>{this.pkd.VDi(this.Tka)&&w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.cjk&&this.pkd.zMo(this.Tka);Ld.ji(this.BFn);return!0};this.BFn=Ld=>{if(this.qik){const Qd=this.Tka.getElementsByTagName("style");if(Qd&&0<Qd.length){u.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let ge=0;ge<Qd.length;ge++)this.Xze.p6k(this.Tka,Qd[ge]),Qd[ge]&&(Qd[ge].parentNode.removeChild(Qd[ge]),ge--)}}Ld.ji(this.F6k);return!0};this.F6k=(Ld,Qd)=>{this.iXe.value.create(Qd.uKj).process(this.Tka,Ld);(Qd=Ga.a.instance.Na("Box4.IFeatureHelper"))&&
Qd.isFeatureEnabled(11)?Ld.ji(this.I5k):Ld.ji(this.r3i);return!0};this.I5k=(Ld,Qd)=>{(new Bv(Qd.jUk)).process(this.Tka,Ld);Ld.ji(this.r3i);return!0};this.r3i=(Ld,Qd)=>{Qd.htmlProcessor.process(this.Tka,Ld);Ld.ji(Qd.Ryf&&Qd.Ryf.Ifc?this.ZMb:this.wVh);return!0};this.ZMb=(Ld,Qd)=>{if(Qd=Qd.Ryf){let ze=!1,gg=!1,Kg=!1,Ll=!1;var ge=-1;const Em=new fh.DictionaryPropertySet,up=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(yb.a)(112,this.Di.xd)?(ze=this.Di.xd.ia(lc.a.lha,!1),ge=this.Di.xd.ia(wc.a.jP,
""),Kg=this.Di.xd.ia(wc.a.e4,!1),Ll=this.Di.xd.ia(Gd.a.Hwa,!1),up.test(ge)&&(gg=!0),ge=this.Di.xd.ia(nh.a.bga,-1)):this.Di.xx&256&&this.Tka&&(ze=!0,up.test(this.Tka.innerHTML)&&(gg=!0));Em.setValue(lc.a.lha,ze);Em.setValue(wc.a.nWc,gg);Em.setValue(wc.a.e4,Kg);Em.setValue(nh.a.bga,ge);Em.setValue(Gd.a.Hwa,Ll);Qd.qge(Em);Qd.XUf();Qd.Jlb&&(this.Di.rUc=!0,this.Di.jzf=Qd.lX,this.Di.zRf=Qd.Jlb,ze&&!Kg&&Qe.c(Eb.a.myl),w.AFrameworkApplication.va.processAction(Eb.a.ZMb,2))}Ld.ji(this.wVh);return!0};this.wVh=
(Ld,Qd)=>{vp.a.A7m(Qd.uKj);vp.a.Q2m(Qd.mtm);vp.a.a6m(Qd.Xbo);vp.a.b6m(Qd.Ybo);vp.a.x3m(Qd.JXc);Ld="Others";Qd.kVd&&(Qd.kVd.N2m(),Qd.kVd.O2m(),Ld=Qd.kVd.dje);vp.a.P2m(Qd.jtm,Ld);vp.a.t2m(Qd.qHl,Ld);return!1};this.Tka=b;this.Mte=Q;this.CDe=ba;this.WTe=ta;this.iXe=Ta;this.fuc=ob;this.tVb=Oc;this.Ma=Vb;this.yYg=Object.assign(new pA,{W$b:2===this.Di.s3b||3===this.Di.s3b});this.Xze=Dc;this.pkd=rd;this.dZb=Vb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.qik=Vb.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.cjk=Vb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get p5d(){return!1}get STc(){return!0}sXh(b){this.Bka=new ne.GraphIterator;this.URa.restore(this.Bka);u.ULS.shipAssertTag(6305550,307,Cd.OutlineElementReader.Dh(this.Bka));this.Di.yR&&this.Di.yR.X0b("external");var h=this.Di.xx&8192?1:0,v=this.CDe.value.create(h,this.Bka,this.Di.yGc,this.Di.Knb);const D=this.WTe.value.create(h,this.Bka),Q=vp.a.Z4h(w.AFrameworkApplication.userSessionId),ba=vp.a.$ii(w.AFrameworkApplication.userSessionId),ta=vp.a.dqf(aa.a.Rzb,
this.Di.yGc),Ta=vp.a.Efi(w.AFrameworkApplication.userSessionId),ob=vp.a.Ffi(w.AFrameworkApplication.userSessionId),Kb=this.dZb?this.xym():null,Vb=vp.a.J9h(aa.a.Rzb,this.Di.yGc),bc=vp.a.K9h(w.AFrameworkApplication.userSessionId),Dc=this.fuc.spj?vp.a.s1l(w.AFrameworkApplication.userSessionId):null;h=this.Mte.value.create(h,this.Bka,v,D,null,ta,this.rBk,this.Di.fle);h=new sw(h,Ta,ob);h=new uA(h,v,this.tVb);h=new Nm(h,this.fuc,this.yYg,Dc);h=new av(h,Vb,Kb,this.Ma);h=new bv(h,bc);v=new Bt(h,v,Q,ba,ta,
Ta,ob,Kb,Vb,bc,Dc);v=new Mf.a(b,this.Hgn,v);v.Jl("paste and request pictures");v.Jh=!b||b.Jh;v.run()}get rBk(){return this.Tka.getElementsByTagName("a").length}xym(){const b=new uC;b.eLb=aa.a.Rzb;this.Di&&(b.xx=this.Di.xx,b.IWf=this.Di.yGc,this.Di.xd&&(b.progId=this.Di.xd.ia(wc.a.Z_i,"")));this.Tka&&this.Tka.innerHTML&&(b.HAn=this.Tka.innerHTML.length);w.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=w.AFrameworkApplication.sessionStartInfoSettings.Platform,b.OGf=w.AFrameworkApplication.K.$("IsO365ConsumerHost"),
b.bui=de.ParagraphReader.Xla(Ya.App.xa.hb.rc.Yc));return b}get Kpj(){return!0}get Q7c(){u.ULS.shipAssertTag(6305551,307,!!this.Bka);if(this.fuc.tpj(this.yYg)){let b=!1;Cd.OutlineElementReader.Dh(this.Bka)&&(this.Bka.F_(),b=!0);const h=de.ParagraphReader.sh(this.Bka)&&!this.Bka.currentNode.ia(wc.a.hwi,!1);b&&this.Bka.sc();return h}return de.ParagraphReader.sh(this.Bka)}}Object(n.a)(vC,"ExternalPasteExecutionManager",cn,[]);class wC{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc){this.Z5b=bc;this.Mte=b;
this.CDe=h;this.WTe=v;this.iXe=D;this.fuc=Q;this.hZ=ba;this.Ma=ta;this.Xze=Ta;this.tVb=ob;this.w6=Kb;this.pkd=Vb}create(b,h,v,D){return new vC(b,h,v,D,this.Mte,this.CDe,this.WTe,this.iXe,this.fuc.value,this.hZ,this.Ma,Ya.App.xa.hb,this.Xze,this.tVb,this.w6,this.pkd,this.Z5b)}}Object(n.a)(wC,"Factory",null,[634]);class uB{VDi(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.fJm(b.childNodes[h-2])&&this.yUm(b.childNodes[h-1])}zMo(b){this.VDi(b)&&(b.removeChild(b.lastChild),
u.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}HGm(b){return!!b&&8===b.nodeType}USm(b){return!!b&&3===b.nodeType}fJm(b){return this.HGm(b)&&"EndFragment"===b.nodeValue}yUm(b){if(!this.USm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(n.a)(uB,"HtmlNormalizerHelper",null,[633]);var ph=c(1956),us=c(634);class Sf extends cn{constructor(b,h,v,D,Q,ba,ta,Ta,ob){super(b,h,v,Q,ba,Ta,ob);this.Uz=D;this.yI=ta}get tl(){return this.yI.value}get p5d(){return this.Uz.p5d()}get f0i(){const b=
this.Uz;return b.v9e&&!b.tsi()}tXh(b,h){u.ULS.shipAssertTag(6305616,307,dh.OutlineReader.fx(b));const v=us.a(b.currentNode);if(dh.OutlineReader.isEmpty(b)){var D=Pe.a.create(b.currentNode);b.Ht(8);w.AFrameworkApplication.va.Of(D,Eb.a.CH,2,!0,null,null)}else b.Ht(8);(D=b.gF(1))&&b.sc();this.Uz.Q_i(this.Di.ie,b.currentNode,D,-1,v,h)}sXh(b){const h=new ne.GraphIterator;this.URa.restore(h);u.ULS.shipAssertTag(6305618,307,Cd.OutlineElementReader.Dh(h));this.Di.yR&&this.Di.yR.X0b("internal");let v=-1;if(Object(yb.a)(112,
this.Di.xd))v=this.Di.xd.ia(nh.a.bga,-1);else{const D=this.HSl(h.currentNode);v=D?D.clientWidth:v}this.Uz.Q_i(this.Di.ie,h.parentNode,h.currentNode,v,null,b);this.yyi&&(this.URa.restore(h),Cd.OutlineElementReader.Dh(h)&&this.Uz.IBi(h)&&(b=ig.OutlineElementNavigator.Ge(h)))&&(this.Di.q0a=Mg.SelectionFactory.ue(b,0))}HSl(b){return b?(b=b?b.De(this.tl.ic):null)?b.htmlElement:null:null}rqj(){const b=new ne.GraphIterator;this.URa.restore(b);return this.Uz.IBi(b)}get Kpj(){return!0}get Q7c(){return!this.Uz.iva&&
!this.Uz.v9e}}Object(n.a)(Sf,"InternalPasteExecutionManager",cn,[]);class vA{constructor(b,h,v,D,Q){this.Z5b=Q;this.Uz=b;this.hZ=h;this.yI=v;this.w6=D}create(b,h,v){return new Sf(b,h,v,this.Uz,this.hZ,Ya.App.xa.hb,this.yI,this.w6,this.Z5b)}}Object(n.a)(vA,"Factory",null,[632]);var Ay;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(Ay||(Ay={}));
Object(n.b)("CopySource",Ay);class tz{constructor(b,h,v,D){this.Uz=b;this.RZg=h;this.R1j=v;this.Ik=D}oAn(b,h,v){u.ULS.shipAssertTag(6305620,307,!!b);u.ULS.shipAssertTag(6305621,307,We.SelectionEditor.gf(h));u.ULS.shipAssertTag(6305622,307,!!v);u.ULS.shipAssertTag(6305623,307,Object(yb.a)(Zg.a,v.spa));const D=v.spa;D.s3b=this.Uz.x6h(b);this.g3m(b,D);let Q=!1;Di.a.sFd&&this.Ik.nha(h,Ta=>Q=Ta)&&(D.xx|=8192,Di.a.tFd&&(D.fle=1,Q||(D.fle|=2)));const ba=this.YLm(D);var ta=new ah.GraphTransaction(7,Eb.a.paste);
ta.Cb(h.node);h.node.IH().hF.w7(8);ba?(u.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",D.xx,D.browserName),b=this.RZg.create(h,D,ta)):(u.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",D.xx,D.s3b,D.browserName),tz.X2m(b),b=this.R1j.create(b,h,D,ta));v=new Mf.a(v,Object(z.a)(b,b.V_i,"pasteSetup"),null);v.Jl("Paste");v.run()}YLm(b){return!this.ROm(b)&&3===b.s3b}ROm(b){return 1===(b.xx&8192?1:0)}Asi(b,h){u.ULS.shipAssertTag(6305624,307,
We.SelectionEditor.gf(b));u.ULS.shipAssertTag(6305625,307,!!h);u.ULS.shipAssertTag(6305626,307,Object(yb.a)(Zg.a,h.spa));const v=new ah.GraphTransaction(7,Eb.a.PWd);v.Cb(b.node);b=this.RZg.create(b,h.spa,v);h=new Mf.a(h,Object(z.a)(b,b.V_i,"pasteSetup"),null);h.Jl("InternalPasteAtIp");h.run()}g3m(b,h){if(b){let v=!1,D=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?D=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(v=!0);(v||D)&&u.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",
Ay[h.s3b],v,D)}}static X2m(b){b&&tz.hok.test(b.innerText)&&u.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}tz.hok=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(n.a)(tz,"PasteCoordinator",null,[]);class qh{constructor(b,h,v,D,Q){this.qva=b;this.Akb=h;this.FAn=v;this.EAn=D;this.STc=Q}}Object(n.a)(qh,"PastedContentsPostProcessorParams",null,[]);class Ux{Uym(b,h,v,D,Q,ba){b=this.pWl(b,h,Q);v=this.a0l(v);
if(!b||!v)return null;D=this.q7l(b,D,Q);Q=this.p7l(v);return new qh(b,v,D,Q,ba)}pWl(b,h,v){b=v?b:h;if(!Cd.OutlineElementReader.Dh(b))return null;h=new Km.a;h.Zc(b);return h}a0l(b){if(!Cd.OutlineElementReader.Dh(b))return null;const h=new Km.a;h.Zc(b);ig.OutlineElementNavigator.q0(h,!1,!1);return h}q7l(b,h,v){ig.OutlineElementNavigator.Ge(b);let D=-1;de.ParagraphReader.sh(b)&&(D=v?h:0);ig.OutlineElementNavigator.Vd(b);return D}p7l(b){ig.OutlineElementNavigator.Ge(b);const h=de.ParagraphReader.sh(b)?
de.ParagraphReader.textLength(b.currentNode):-1;ig.OutlineElementNavigator.Vd(b);return h}}Object(n.a)(Ux,"PastedContentsPostProcessorHelper",null,[]);var uz=c(789),cu=c(1082),Vx=c(1081);class lt{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc=null){this.ypa=b;this.t9=h;this.yo=v;this.w2i=D;this.ta=Q;this.V4a=ba;this.K=ta;this.tAn=Ta;this.Jca=ob;this.xFb=Kb;this.tua=Vb;this.lb=bc;this.rha=Dc;this.sOh=100;this.Jbc=!1;this.Mwe=null;this.xFe=!1;this.Oqd=null;this.Vmd=this.TKa=!1;this.PEl=(Oc,gd)=>{this.Xw(gd.iBl)};
this.evo=(Oc,gd)=>{this.c$k(Oc,gd)};this.uY=(Oc,gd)=>{gd.property===Gd.a.lastModifiedTime?(u.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.xFb.Wbf.contains(Eb.a.Fmg)||this.l2f(gd)):u.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.CKb=(Oc,gd)=>{this.l2f(gd)};this.Yha=(Oc,gd)=>{gd.rCf||this.l2f(gd)};this.kVi=()=>{uz.a.instance.keyCode===zf.a.nza&&this.t9.s5i()};this.TAo()}TAo(){this.t9.eqh(this.evo);
this.t9.Lph(this.PEl)}c$k(b,h){var v,D,Q;(null===(D=null===(v=this.lb.gb)||void 0===v?void 0:v.kb)||void 0===D?0:D.YTc)?u.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.V4a.OAf(),1===this.tAn.q$k(h.f1c)?u.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.TKa?this.TKa=!1:this.gXn(),this.D3c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",
Eb.a.bU(h.zY)||"Unknown",h.correlationId),u.ULS.sendTraceTag(40379588,307,50,b),Qe.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new pa.a,{name:"PasteCommand",int64:Eb.a.bU(h.zY)||"Unknown"}),Object.assign(new pa.a,{name:"CorrelationId",string:null===(Q=h.correlationId)||void 0===Q?void 0:Q.toString()})]),this.DQb()):u.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}Xw(b){var h;!this.xFe&&(this.TKa||(this.rha?null===(h=this.tua)||void 0===
h?0:h.X_:this.ypa.X_()))&&(b&&(this.V4a.OAf(),this.tDj(),u.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Oqd)),this.TKa=!b,this.Zme(),this.rha?w.AFrameworkApplication.va.processAction(Eb.a.UFb,2):this.ypa.Xw())}gXn(){this.Vmd||(this.Mwe=this.yo.Bd,lf.a.addHandler(this.Mwe.container,"scroll",Object(z.a)(this,this.ENb,"scrollHandler")),this.ta.VZ(Object(z.a)(this,this.Eia,"resizeHandler")),this.Vmd=!0)}tDj(){this.Vmd&&(lf.a.removeHandler(this.Mwe.container,
"scroll",Object(z.a)(this,this.ENb,"scrollHandler")),this.ta.Uca(Object(z.a)(this,this.Eia,"resizeHandler")),this.Vmd=!1)}DQb(){if(this.rha)this.tua.X_&&w.AFrameworkApplication.va.processAction(Eb.a.UFb,2),w.AFrameworkApplication.va.processAction(Eb.a.n8c,2),this.Jbc=!1;else{const b=new Vx.a(0,w.AFrameworkApplication.isRtl);b.location=this.V4a.UOa();this.V4a.WJm(b.location)?this.showFloatie(null,b):this.t9.PGa(new cu.a(!1))}}Eia(){this.rha?(w.AFrameworkApplication.va.processAction(Eb.a.UFb,2),this.RIc()):
this.DQb()}ENb(){this.rha?(w.AFrameworkApplication.va.processAction(Eb.a.UFb,2),this.RIc()):this.DQb()}D3c(){this.w2i.exk(this.kVi);this.t9.Qph(Object(z.a)(this.ypa,this.ypa.XKd,"expandFloatie"));this.t9.$ph(Object(z.a)(this,this.X_i,"pastedFloatieStatusChange"));this.Jca.Vt(this.Yha);this.Jca.Ow(this.CKb);this.Jca.Go(this.uY)}Zme(){this.w2i.o0n(this.kVi);this.t9.zaj(Object(z.a)(this.ypa,this.ypa.XKd,"expandFloatie"));this.t9.Haj(Object(z.a)(this,this.X_i,"pastedFloatieStatusChange"));this.Jca.VU(this.Yha);
this.Jca.Dia(this.CKb);this.Jca.WU(this.uY)}X_i(b,h){this.xFe=h.XTc;h.zY&&(this.Oqd=h.zY);h.vdg&&this.ypa.X_()&&this.DQb()}l2f(b){b.node.loading||this.t9.PGa(new cu.a(!0))}showFloatie(b,h){h||(h=new Vx.a(0,w.AFrameworkApplication.isRtl));h.location||(h.location=this.V4a.UOa());if(!h.location)return!1;this.TKa&&(this.TKa=!1,this.D3c());this.rha?w.AFrameworkApplication.va.processAction(Eb.a.n8c,2):this.ypa.showFloatie(b,h);return!0}RIc(){if(!this.Jbc){const b=new of.a(3,1,this.sOh,()=>{this.DQb()},
215);xb.a.instance.Wb(b);this.Jbc=!0}}}Object(n.a)(lt,"PasteFloatieEventManager",null,[]);class By{constructor(b,h){this.hk=b;this.lI=h}q$k(b){return Bj.any(Bj.where(Bj.asEnumerable(By.MDo),h=>this.lI.yVc(h)))?(b=this.hk.Lmb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}By.MDo=[Eb.a.reformatPastedContent.toString(),Eb.a.jSa.toString(),Eb.a.bya.toString()];Object(n.a)(By,"PasteFloatieFeatureSetBuilder",null,[]);class wA{constructor(){this.Mxa=null;this.Dfc=0}}Object(n.a)(wA,"PasteFloatieAnchorData",
null,[]);class tw{constructor(b,h,v,D,Q,ba=!1){this.lwb=null;this.ib=b;this.jta=h;this.fd=v;this.C3j=D;this.ZMe=Q;this.YFe=ba}OAf(){this.lwb=null}UOa(){const b=this.Upf(this.lwb)||this.Fzh();if(!b){let h="null",v="null";if(this.lwb&&this.lwb.Mxa){if(!this.fd.Bd)return u.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.lwb.Mxa).getName();const D=this.fd.Bd.Gj(this.lwb.Mxa);D&&(v=Object.getType(D).getName())}u.ULS.shipAssertTag(40641054,
307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,v)}return b}WJm(b){if(!b)return!1;const h=this.ZMe.hEb(),v=this.C3j(this.fd.Bd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=v.y&&b.y+b.height<=v.y+v.height}Fzh(){if(!this.ib||!this.ib.gb||!this.ib.gb.kb)return u.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.ib.gb.kb.Oa,h=!b.cpBegin&&!b.cpEnd;let v=b.node;if(v&&h){do v=this.Mdi(v);
while(v&&Object(yb.a)(S.AParagraphNode,v)&&!v.characterData.trim().length)}let D="";const Q=Object(Ka.a)(S.AParagraphNode,v);Q&&(D=Q.characterData.length===b.cpBegin||h?Q.characterData.trimEnd():Q.characterData.substring(0,b.cpBegin).trimEnd());h=Q?D.length:b.cpBegin;b=Object.assign(new wA,{Mxa:Object(Ka.a)(144,(Q?Object(Ka.a)(144,Q):Object(Ka.a)(144,v))||b.node),Dfc:h});return this.Upf(b)}Mdi(b){const h=new ne.GraphIterator;if(!b.anchor)return null;h.set(b);if(!h.vd())return null;h.jd(11);return h.nJ()?
h.Sb(2):null}Upf(b){if(!b||!b.Mxa)return null;this.lwb=b;const h=this.fd.Bd;if(!h)return u.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.L9h(b,h);if(!b)return null;w.AFrameworkApplication.isRtl&&this.ZMe.X_()&&(b.x-=this.ZMe.hEb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}L9h(b,h){h=h.De(b.Mxa);if(!h)return null;let v=null;if(Object(yb.a)(S.AParagraphNode,b.Mxa)){const D=Object(Ka.a)(134,h);if(!D)return null;try{v=this.jta.b_(b.Dfc,
D,0<b.Dfc,!1,!1,!1),v.height+=this.YFe?tw.tOn:tw.SEl}catch(Q){u.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",Q),v=null}}else Object(yb.a)(zv.TableNode,b.Mxa)&&(v=Object(Ka.a)(201,h).uuf());v||(v=h.getBounds());return v}}tw.SEl=2;tw.tOn=60;Object(n.a)(tw,"PasteFloatiePositionProvider",null,[]);class vs{constructor(b,h){this.Crc=b;this.zYj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get A1h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get scf(){return CommonUIStrings.l_ClipboardCut}get ILf(){return CommonUIStrings.l_ClipboardCut_Mac}get r$e(){return CommonUIStrings.l_ClipboardCopy}get HLf(){return CommonUIStrings.l_ClipboardCopy_Mac}get kYf(){return CommonUIStrings.l_ClipboardPaste}get JLf(){return CommonUIStrings.l_ClipboardPaste_Mac}get u9(){return CommonUIStrings.l_ClipboardPasteText}get KLf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get A7e(){return this.zYj}get jEh(){return CommonUIStrings.l_ClipboardExtensionLink}get Aeb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}KXh(){u.ULS.sendTraceTag(8716421,
307,50,null);Id.a.om(this.A7e,"_blank",void 0,"ClipboardAccessExtensionLink")}Wca(b,h){let v=aa.a.fl;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(v=aa.a.ui||v);return v?String.format(h,"\u2318"):b}dispose(){this.Crc=null}C2f(b){this.jJh(b)}rYm(b){this.jJh(b)}jJh(b){this.Crc&&this.Crc(b)}}vs.id="CopyPasteShortcutDialog";vs.Vxj="CopyPasteText";Object(n.a)(vs,"ACopyPasteShortcutDialog",null,[10]);class km extends vs{constructor(b,h,v){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=vs.Vxj;var D=document.createElement("span");D.innerText=this.A1h;var Q=document.createElement("span");Q.className="UIFontBold";Q.innerText=this.Wca(this.scf,this.ILf);const ba=document.createElement("span");ba.className="UIFontBold";ba.innerText=this.Wca(this.r$e,this.HLf);const ta=document.createElement("span");ta.className="UIFontBold";ta.innerText=this.Wca(this.kYf,this.JLf);h.appendChild(D);h.appendChild(document.createElement("br"));
h.appendChild(Q);h.appendChild(ba);h.appendChild(ta);v.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.zq||aa.a.jj)&&(v=document.createElement("span"),v.className="UIFontBold",v.innerText=this.Wca(this.u9,this.KLf),h.appendChild(v));b.appendChild(h);this.A7e?(u.ULS.sendTraceTag(8716420,307,50,null),v=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.jEh,lf.a.addHandler(h,"click",Object(z.a)(this,this.KXh,"extensionLinkHandler")),v.appendChild(h),Q=this.Aeb.indexOf("{0}"),
-1!==Q&&(D=this.Aeb.substring(0,Q),Q=this.Aeb.substring(Q+3,this.Aeb.length),D=document.createTextNode(D),Q=document.createTextNode(Q),v.insertBefore(D,h),v.appendChild(Q)),b.appendChild(document.createElement("br")),b.appendChild(v)):u.ULS.sendTraceTag(8716422,307,50,null);v=new pg.StandardDialog;v.Ad=0;v.wg=vs.id;v.Ju(this.titleText,null,0,Object(z.a)(this,this.rYm,"legacyCopyPasteShortcutDialogHandler"),b);v.e5(vs.Vxj)}}Object(n.a)(km,"CopyPasteShortcutDialog",vs,[]);class du extends vs{constructor(b,
h){super(b,h);h={};b=this.wCm;h.extensionStartText=this.byl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.Dpo;h.cutText=this.Wca(this.scf,this.ILf);h.copyText=this.Wca(this.r$e,this.HLf);h.pasteText=this.Wca(this.kYf,this.JLf);4!==w.AFrameworkApplication.ta.Nb.Sl&&(h.pasteTextOnly=this.Wca(this.u9,this.KLf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const v=new Vf.a(!1,!1,!0);v.wg="CopyPasteInstallDialog";v.Ad=0;v.Ee(1,this.vCm);v.cV(1);v.Yh(b,Object(z.a)(this,
this.C2f,"reactCopyPasteShortcutDialogHandler"),h)}get Dpo(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get vCm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get wCm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get byl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Oto(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(n.a)(du,"ReactCopyPasteInstallDialog",vs,[]);class xA extends vs{constructor(b){super(b,null);this.bFi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.bgn;var v="";let D="";this.messageText&&(v=this.messageText.split(" {")[0],D=this.messageText.split("} ")[1]);h.startText=v;h.endText=D;h.cutText=this.lgl;h.copyText=this.U6k;h.pasteText=this.wAn;
h.cutShortcutText=this.Wca(this.mgl,this.B8m);h.copyShortcutText=this.Wca(this.d7k,this.A8m);h.pasteShortcutText=this.Wca(this.zAn,this.D8m);h.imageSrc=Se.a.Yaa("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.qGn;this.bFi&&(u.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Ikb,["onExecute"]:()=>{this.lYm()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
v=new Vf.a(!1,!1,!0);v.Ad=0;v.wg="CopyPasteNoClipboardAccessDialog";v.Yh(b,Object(z.a)(this,this.C2f,"reactCopyPasteShortcutDialogHandler"),h)}get bgn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Ikb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get qGn(){return CommonUIStrings.l_DialogOk}get lgl(){return CommonUIStrings.l_CutString}get mgl(){return CommonUIStrings.l_CutShortcut}get B8m(){return CommonUIStrings.l_CutShortcut_Mac}get U6k(){return CommonUIStrings.l_CopyString}get d7k(){return CommonUIStrings.l_CopyShortcut}get A8m(){return CommonUIStrings.l_CopyShortcut_Mac}get wAn(){return CommonUIStrings.l_PasteString}get zAn(){return CommonUIStrings.l_PasteShortcut}get D8m(){return CommonUIStrings.l_PasteShortcut_Mac}lYm(){u.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Id.a.om(this.bFi,"_blank",void 0,"learnMoreLink")}}Object(n.a)(xA,"ReactCopyPasteNoClipboardAccessDialog",vs,[]);class cv extends vs{constructor(b,h,v){super(b,h);b={};b.forwardElementText=this.A1h;b.cutText=this.Wca(this.scf,this.ILf);b.copyText=this.Wca(this.r$e,this.HLf);b.pasteText=this.Wca(this.kYf,this.JLf);v.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.zq||aa.a.jj)&&(b.pasteTextOnly=this.Wca(this.u9,this.KLf));this.A7e?(u.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.jEh,["onExecute"]:D=>{this.KXh(D)}},v=this.Aeb.indexOf("{0}"),-1!==v&&(b.suggestionPrefixElement=this.Aeb.substring(0,v),b.suggestionSuffixElement=this.Aeb.substring(v+3,this.Aeb.length))):u.ULS.sendTraceTag(40726915,307,50,null);v={["id"]:vs.id,["bodyControls"]:b};b=new Vf.a(!1,!1,!0);b.Ad=0;b.wg=vs.id;b.Yh(this.titleText,Object(z.a)(this,this.C2f,"reactCopyPasteShortcutDialogHandler"),v)}}Object(n.a)(cv,"ReactCopyPasteShortcutDialog",
vs,[]);class uw{constructor(){this.UKa=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.lF}T$e(b,h,v=!1){u.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.UKa,v));this.UKa?v?new du(b,h):new cv(b,h,w.AFrameworkApplication.K):new km(b,h,w.AFrameworkApplication.K)}static get instance(){return uw._instance||(uw._instance=new uw)}}uw._instance=null;Object(n.a)(uw,"CopyPasteShortcutDialogFactory",null,[1300]);class Wx{constructor(b,h,v,D,
Q,ba,ta,Ta){this.vfh=this.J0g=this.aTe=!1;this.Kkk=b;this.fd=h;this.St=v;this.Ub=D;this.ze=Q;this.gg=ba;this.Se=ta;Ta&&(this.vfh=Ta.$("ShouldLogExecCommandCopySuccess"))}get DTa(){return this.Kkk}get a3a(){return this.J0g}set a3a(b){this.J0g=b;this.gg.ignoreClipboardEvents=b}TKc(b){this.DTa.TKc(b);b||this.X9c(!0)}get kvl(){return this.DTa.B7f}prepareForPaste(b){this.a3a=!0;this.DTa.prepareForPaste(b,this.Rhg)}reset(){this.a3a=!1}paste(){var b=null;let h=null;if(!this.DTa.pRb){(b=this.fd.Bd)&&this.Ub.mg(b.gJ);
var v=this.St.tu;if(!v.qe||!v.editingView.Sj)return null;h=v.editingView;b=this.ze.kw();this.a3a=!0;v.c8a()}v=null;try{h&&h.cFn(),v=b=this.DTa.hLc(this.Rhg,b)}catch(D){u.ULS.shipAssertTag(6305672,307,!1),this.Cki()}this.a3a=!1;return v}copy(){var b=this.fd.Bd;b&&this.Ub.mg(b.gJ);b=this.St.tu;if(!b.qe||1!==b.editingView.mode)return!1;this.a3a=!0;let h;try{const v=new Map;v.set("View","ContentEditableView");wa.Health.instance.recordKpiUsage(Gr.a.m2b,0,Gr.a.MCd,v);const D=this.DTa.Aif(this.Rhg);h=!0;
this.vfh&&u.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",D,this.Se.bG);if(!D){const Q=Object.assign(new wb.a,{extendedProperties:v});wa.Health.instance.recordKpiFailure(Gr.a.m2b,Gr.a.Z5e,!0,!0,Q)}}catch(v){u.ULS.shipAssertTag(6305673,307,aa.a.jj),u.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",aa.a.bG),h=!1}this.a3a=!1;return h?!0:!1}X9c(){if(this.aTe)return!0;var b=this.St.tu;if(!b.qe||!b.editingView.Sj)return!1;
const h=b.editingView;b=this.ze.kw();this.a3a=!0;const v=new Zt.a(b);let D=!1;try{D=this.DTa.X9c(b,()=>{h.FDd()},()=>{h.mHa()})}catch(Q){}v.restore();this.a3a=!1;D?this.aTe=!0:(u.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",aa.a.bG),this.Cki());return D}Cki(){this.aTe=!1;if(w.AFrameworkApplication.C1o)uw.instance.T$e(null,null);else{const b=new pg.StandardDialog;b.Ad=0;b.fV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,
null)}}get Rhg(){const b=this.ze.qhb();return b?b.Qn:null}}Object(n.a)(Wx,"SystemClipboard",null,[630]);class Iu{constructor(b,h,v){this.sxd=!1;this.Rxd=this.US=this.z3g=this.jve=this.ifd=null;this.GDn=D=>{1===D?(u.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Yue)),this.w_b&&(u.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.w_b)),Id.a.om(this.PBe+this.eLe,"_blank",void 0,"ChromeCCPInstallDialog"))):D||u.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",
this.Yue))};this.Yue=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.PBe=b.jb("ChromeClipboardAccessExtensionLink");this.B$a=h;this.hk=v;this.eLe=b.jb("ChromeClipboardAccessExtensionId");this.onk=b.$("UseGetClipboardDataIsEnabled");this.Jbh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.w_b=!1;b.$("CcpInstallDialogIsEnabled")&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.lF&&(this.w_b=du.Oto()||b.$("IgnoreDomainCheckCcpInstallDialog"),u.ULS.sendTraceTag(587314304,
307,50,"_useInstallDialog: {0}",this.w_b));this.Jsc=null}TKc(b){b?this.US=!0:(this.US=null,chrome.runtime&&chrome.runtime.sendMessage?(this.Jsc=this.B$a.qHd,this.B$a.BOb?(this.sxd=this.onk,this.rCh()):(this.sxd=!0,this.rCh(),u.ULS.sendTraceTag(19256732,307,50,W.a.create().toString()))):(this.WOb(),this.US=!1))}get B7f(){return this.US}get pRb(){return this.Rxd}X9c(){return!0}Aif(b){u.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Id.a.KCb(b,"copy"))||u.ULS.sendTraceTag(24402116,307,10,
String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}$nf(b){if(!b)return null;var h=b.img;const v=b.text;b=b.html;const D=this.hk.rhj(!!h,!!v,b);let Q=null;if(3===D){if(!b)return null;h=this.hk.UXh(b);(h=this.hk.aYh(h))&&(b+=h);Q=this.hk.Lmb(b)}else 2===D?Q=this.hk.dYf(v,!0):1===D&&(Q=this.hk.Lmb(h));return Q}hLc(b,h){if(this.pRb)h=this.$nf(this.jve),this.jve=null;else{if(!this.ifd)return h;b=document.implementation.createHTMLDocument("doc");
b.body.innerHTML=this.ifd;h=b.body;this.ifd=null}return h}prepareForPaste(b){const h=W.a.create();this.z3g=h;this.B$a.BOb?u.ULS.sendTraceTag(7377737,307,50,h.toString()):u.ULS.sendTraceTag(19256735,307,50,h.toString());const v={};v.command=this.pRb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.Jsc,v,D=>{h.equals(this.z3g)?this.pRb?this.jve=D:this.ifd=D:u.ULS.sendTraceTag(7385868,307,50,null);u.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.lrl(),this.B$a.BOb?
u.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):u.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}WOb(){u.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.w_b?b=this.PBe+this.eLe:this.Yue&&(b=this.PBe+this.Jsc);uw.instance.T$e(this.GDn,b,this.w_b)}lrl(){this.B$a.H4n();this.WOb()}Eij(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}vUk(){const b=W.a.create();this.B$a.BOb?u.ULS.sendTraceTag(592491466,307,50,b.toString()):u.ULS.sendTraceTag(591984031,
307,50,b.toString());chrome.runtime.sendMessage(this.Jsc,{command:"getAvailableCommands"},h=>{u.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(yb.a)(Array,h)?(u.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.Rxd=-1!==Array.indexOf(h,"getClipboardData")):(u.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.Rxd=!1):(u.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:
null),this.Rxd=!1)})}rCh(){const b=W.a.create();this.B$a.BOb?u.ULS.sendTraceTag(7726105,307,50,b.toString()):u.ULS.sendTraceTag(591984032,307,50,b.toString());this.sxd&&this.vUk();this.Eij(this.Jsc,h=>{u.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.US=!0:(h?"ping"!==h&&u.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):u.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.WOb(),this.US=!1);this.sxd&&!this.pRb&&u.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}lJi(b,h){const v={};v.OfficeOnlineExtensionInstallationStatus=b;v.OfficeClipboardExtensionInstallationStatus=h;u.ULS.sendTraceTag(51144839,307,50,JSON.stringify(v));this.Jbh&&(b&&wa.Health.instance.recordKpiSuccess(Iu.h8g,null),h&&wa.Health.instance.recordKpiSuccess(Iu.e8g,null))}U1m(){this.Jbh&&(wa.Health.instance.recordKpiUsage(Iu.h8g,
1,Iu.VTg,null),wa.Health.instance.recordKpiUsage(Iu.e8g,1,Iu.VTg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.B$a.BOb;this.Eij(this.eLe,h=>{this.lJi(b,!!h)})}else this.lJi(!1,!1)}}Iu.h8g="OfficeOnlineExtensionInstallationStatus";Iu.e8g="OfficeClipboardExtensionInstallationStatus";Iu.VTg="wwccp";Object(n.a)(Iu,"ChromeSystemClipboardAccessManager",null,[661]);class xC{constructor(b,h){this.US=null;this.Se=b;this.Ma=h;this.UWj=!this.Ma.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Ma.$("BlockCopyCutOnFirefoxIsEnabled");this.iik=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}TKc(b){this.UWj&&b&&this.Se.jj?(this.WOb(),this.US=!1):this.US=!0}get B7f(){return this.US}get pRb(){return!1}Aif(b){return Id.a.KCb(b,"copy")}hLc(b,h){Id.a.KCb(b,"paste");return h}prepareForPaste(b){b()}X9c(b,h,v){if(this.Se.c4)return this.iik&&(this.US=!1),!1;h();v();b=this.hLc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=sb.a.create().toString();v();b=this.hLc(b.ownerDocument,b);return this.US=
b=h===b.innerHTML}WOb(){uw.instance.T$e(null,null)}}Object(n.a)(xC,"DefaultSystemClipboardAccessManager",null,[661]);class yC{constructor(b,h,v){this.US=this.P$=this.IXb=this.Uka=this.jXa=this.efd=null;this.hk=h;this.sXa=v;this.fak=b.mc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.Nik=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}TKc(b){this.Nik&&b&&(this.US=!0)}get B7f(){return this.US}get pRb(){return!1}Aif(b){return b?Id.a.KCb(b,
Sc.a.copy):!1}hLc(b,h){this.jXa&&(h=this.jXa,this.jXa=null);return h}prepareForPaste(b,h=null){if(b&&h){this.efd=b;this.IXb=h;$addHandler(this.IXb,Sc.a.paste,Object(z.a)(this,this.EVi,"onPasteEvent"));this.P$=this.Uka=null;if(this.lCj(this.IXb)){if(this.P$&&0<this.P$.length&&(!this.Uka||this.hk.boe(this.Uka))){this.sXa.BIh(this.P$,Object(z.a)(this,this.oon,"onImageConverted"));this.jXa&&!this.jXa.hasChildNodes()&&u.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Uka&&
this.Uka.innerHTML&&((this.jXa=this.Zni(this.Uka.innerHTML))&&!this.jXa.hasChildNodes()&&u.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),jc.a.vC(this.Uka))}this.l_h()}else b&&b()}X9c(b){return this.US=b=this.lCj(b.ownerDocument)}EVi(b){try{b&&b.rawEvent&&((this.Uka=b.rawEvent.target)&&this.Uka.id&&-1<this.Uka.id.indexOf("Paste")?(u.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Uka.id),this.Uka=null):this.P$=this.aZl(b.rawEvent))}catch(h){u.ULS.sendTraceTag(22073952,
307,15,"Exception while processing context menu paste event: "+h.toString())}}oon(b){b&&(this.sXa.Rpj&&(b=String.format('<img src="{0}">',b)),this.jXa=this.Zni(b));this.l_h()}l_h(){this.IXb&&($removeHandler(this.IXb,Sc.a.paste,Object(z.a)(this,this.EVi,"onPasteEvent")),this.IXb=null);this.efd&&(this.efd(),this.efd=null)}aZl(b){let h=null;(b=this.hk.s5h(b))&&({Hyf:h}=this.hk.NBj(b,this.fak,this.sXa.yMi));return h}lCj(b){return Id.a.KCb(b,Sc.a.paste)}Zni(b){const h=document.implementation.createHTMLDocument("doc");
h.body.innerHTML=b;return h.body}WOb(){}}Object(n.a)(yC,"EdgeSystemClipboardAccessManager",null,[661]);class vB{constructor(b,h,v,D){this.Ma=b;this.pYj=h;this.hk=v;this.Se=D}create(){let b=null;w.AFrameworkApplication.ydg()&&this.Se.zq&&window.chrome?(u.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Iu(this.Ma,this.pYj,this.hk),this.Ma.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.U1m()):this.Ma.$("EdgeContextMenuPasteFixIsEnabled")&&this.Se.du?(u.ULS.sendTraceTag(22073953,
307,50,"EdgeSystemClipboardAccessManager"),b=new yC(this.Ma,Ga.a.instance.resolve("Box4.IClipboardDataHelper"),Ga.a.instance.resolve("Box4.IProcessImageStrategy"),Ga.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(u.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new xC(this.Se,this.Ma));return b}}Object(n.a)(vB,"SystemClipboardAccessManagerFactory",null,[631]);class vw{Owl(b){return b}}Object(n.a)(vw,"DeleteTableSegmentStrategy",null,[629]);
var vz=c(589),Pr=c(1031);class Cy{get gq(){return yt.a.NEb}get paragraphEditor(){return null!=this.YEg?this.YEg:this.YEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get B0(){return this.paragraphEditor.gq}get Ic(){return Ye.a.instance}get MA(){return null!=this.iFg?this.iFg:this.iFg=Ga.a.instance.resolve("Box4.IParagraphIndentationReader")}rEc(b,h,v,D,Q,ba,ta){let Ta=2;if(!b.qe)return 2;const ob=b.lb;if(!ob)return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.zca}),8;if(w.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=
this.uAh(h===Eb.a.JG,v,!0);if(1===D)return b?32:8;b&&(Ta=Pr.a.Gfc(h,v,D,Q,ba,ta))}else Ta=Pr.a.Gfc(h,v,1,Q,ba,ta),1!==D&&32===Ta?(b.lb.M7d(),b=new ah.GraphTransaction(15),b.Cb(v.view.Yc),Ta=this.uAh(h===Eb.a.JG,v,!1)?Pr.a.Gfc(h,v,D,Q,ba,ta):8,b.dispose()):1!==D&&8===Ta&&(b.lb.M7d(),this.i2k(h,v,ob));return Ta}uAh(b,h,v){h=h.view.lb;if(!h||!h.gb.kb)return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.SJb}),!1;if(h.gb.vJ)return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.u9e}),!1;h=vz.OutlineElementGeneralizer.qna(h.gb,
!1);if(!h)return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hLd}),!1;let D=!1;for(let Q=0;Q<h.length;Q++){const ba=h.getContext(Q),ta=new ne.GraphIterator;ta.set(ba.node);We.SelectionEditor.mu(ta);if(!Cd.OutlineElementReader.Dh(ta))if(v)continue;else return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.Jfb}),!1;if(b?!this.gq.jAb(ta):!this.gq.Z1b(ta))if(v)continue;else return this.Ic.Yb(Oe.a.O4b,{["Reason"]:Fe.a.Q5e}),!1;D=!0}return v?D:!0}i2k(b,h,v){const D=new ah.GraphTransaction(15);try{D.Cb(h.view.Yc);h=!0;const Q=
vz.OutlineElementGeneralizer.qna(v.gb,!1);for(let ba=0;ba<Q.length;ba++){const ta=Q.getContext(ba),Ta=new ne.GraphIterator;Ta.set(ta.node);We.SelectionEditor.mu(Ta);if(!Cd.OutlineElementReader.Dh(Ta))h=!1;else if(b===Eb.a.JG?this.gq.jAb(Ta):this.gq.Z1b(Ta))switch(h=!1,b){case Eb.a.JG:this.gq.XRa(Ta,-1,0);break;case Eb.a.qO:this.gq.iJc(Ta,1)}}if(h){const ba=v.gb.kb;for(v=0;v<ba.length;v++){const ta=ba.J(v);if(ta.el){const Ta=this.MA.Ahb(ta.node),ob=Ta.mda;if(b===Eb.a.JG?Ta.zB>ob:Ta.zB<18*ob){const Kb=
new ne.GraphIterator;Kb.set(ta.node);this.B0.Dya(Kb,1,b===Eb.a.JG?Ta.zB>=2.5*ob?Ta.zB-2*ob:ob:Ta.zB<16*ob?Ta.zB+2*ob:18*ob)}}}}}finally{D&&D.dispose()}}}Object(n.a)(Cy,"IndentationActorExtension",null,[627]);var wB=c(740),yA=c(1210);class Bm{constructor(b,h){this.Zn=new fh.DictionaryPropertySet;this.Crd=new fh.DictionaryPropertySet;this.vub=!1;this.hBa=this.Zrb=null;this.u6=b;this.vVg=h}get Gpb(){return null!=this.qHg?this.qHg:this.qHg=Ga.a.instance.Na("Box4.ITextFormattingCommands")}get Sn(){return null!=
this.Pzg?this.Pzg:this.Pzg=Ga.a.instance.resolve("Box4.IFormattingEditor")}get wc(){return null!=this.zJg?this.zJg:this.zJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}N5a(){this.vub||(0<this.PPa.jM()&&(this.Crd=this.Zn.clone()),this.Zn.D4f(),this.Zrb=null,this.qZn())}c7k(b){var h;const v=null!==(h=Hn.FormattingReader.Kr(b))&&void 0!==h?h:Hn.FormattingReader.ePd(b.node,b.cpBegin,-1);!v.cache.DB&&(b=v.yn)&&(h=new fh.DictionaryPropertySet,h.Vw(b),h.Vw(this.Zn),h.hasProperty(Ve.a.hw)&&(this.Zrb=
v.paragraph.Jc),this.Zn=h)}hasProperty(b){return this.Zn.hasProperty(b)}GQc(){return 0<this.Zn.jM()}get PPa(){return this.Zn}freeze(){this.vub=!0}bIa(){this.vub=!1}xG(b,h){return this.PPa.ia(b,h)}RA(b){this.Zn.setValue(Gd.a.fontSize,this.Sn.a3b(b));this.S0();Ao.a.h3f(this.Crd,this.Zn)}fontSize(){return this.Zn.ia(Gd.a.fontSize,Ao.a.nM)}gge(b){this.Zn.setValue(Gd.a.font,b);this.vVg&&this.vVg.execute(h=>{null==h?u.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):
h.gge(this.Zn)});this.u6&&this.u6.enabled&&(Lc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.u6.Hho(this.Zn,b));this.S0();Ao.a.h3f(this.Crd,this.Zn)}Dbg(b){this.Zn.setValue(lc.a.He,b);this.u6&&this.u6.enabled&&(Lc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.u6.bno(this.Zn,b));this.S0()}Sv(b){b=Zh.a.instance.iua(Th.a.instance.gb.kb.Oa.node,b);this.Zn.setValue(Gd.a.fontColor,b);this.S0();Ao.a.h3f(this.Crd,this.Zn)}Cfa(){this.Zn.setValue(Gd.a.fontColor,
Sl.a.auto);this.S0()}fontColor(){return this.Zn.ia(Gd.a.fontColor,Sl.a.nil)}Bya(b){this.Zn.setValue(Gd.a.highlight,parseInt(b,16));this.S0()}zDd(){this.Zn.setValue(Gd.a.highlight,Sl.a.auto);this.S0()}isBold(){return this.Zn.ia(Gd.a.bold,!1)}qL(b){this.Zn.setValue(Gd.a.bold,b);this.S0()}isItalic(){return this.Zn.ia(Gd.a.italic,!1)}setItalic(b){this.Zn.setValue(Gd.a.italic,b);this.S0()}isUnderline(){return this.Zn.ia(Gd.a.underline,!1)}j5(b){this.Zn.setValue(Gd.a.underline,b);this.Zn.setValue(Gd.a.underlineType,
b?Ao.a.uQb:Ao.a.qV);this.S0()}underlineType(){return this.Zn.ia(Gd.a.underlineType,Ao.a.qV)}Zia(b){b<Ao.a.uQb||b>Ao.a.qV||(this.Zn.setValue(Gd.a.underline,b!==Ao.a.qV),this.Zn.setValue(Gd.a.underlineType,b),this.S0())}isSuperscript(){return this.Zn.ia(Gd.a.superscript,!1)}oqa(b){this.Zn.setValue(Gd.a.superscript,b);b&&this.isSuperscript()&&this.Zn.setValue(Gd.a.subscript,!1);this.S0()}isSubscript(){return this.Zn.ia(Gd.a.subscript,!1)}zHa(b){this.Zn.setValue(Gd.a.subscript,b);b&&this.isSubscript()&&
this.Zn.setValue(Gd.a.superscript,!1);this.S0()}isStrikethrough(){return this.Zn.ia(Gd.a.strikethrough,!1)}Wia(b){this.Zn.setValue(Gd.a.strikethrough,b);this.S0()}isDoubleStrikethrough(){return this.Zn.ia(Ve.a.wt,!1)}age(b){this.Zn.setValue(Ve.a.wt,b);this.S0()}Y4h(){return this.Zn.ia(Ve.a.hw,null)}D6a(b,h){this.Zn.D4f();this.Zn.setValue(Ve.a.hw,b.id);this.Zrb=h.Jc;this.S0()}g5(b){let h=Gd.a.eL;const v=wB.a.I0d(b);switch(v){case 1:h=lc.a.jcc;break;case 2:h=lc.a.kcc}this.Zn.setValue(lc.a.B3a,v);this.Zn.setValue(h,
b);this.S0()}language(){let b=Gd.a.eL;switch(this.Zn.ia(lc.a.B3a,0)){case 1:b=lc.a.jcc;break;case 2:b=lc.a.kcc}return this.Zn.ia(b,0)}Ujo(b){this.Zn.setValue(lc.a.noProof,b);this.S0()}tHb(){return this.Zn.ia(lc.a.noProof,!1)}INm(){return this.Zn.hasProperty(lc.a.noProof)}pMm(){return this.Zn.hasProperty(Gd.a.eL)||this.Zn.hasProperty(lc.a.jcc)||this.Zn.hasProperty(lc.a.kcc)}S0(){if(aa.a.zkc){var b=Th.a.instance.gb.kb.Oa,h=b.node;if(h===this.hBa)this.hBa.Tk(16,!0);else{this.hBa=h;h=this.hBa.NY();try{this.hBa.u_(b.cpBegin).Dwa=
!0}finally{h&&h.dispose()}}}}qZn(){if(aa.a.zkc&&this.hBa){var b=0,h=this.hBa.NY();try{for(let v=this.hBa.pa.length-1;0<=v;v--){const D=this.hBa.pa.J(v);D.Dwa&&(D.Dwa=!1,b++,D.isEmpty&&this.hBa.pa.removeAt(v))}}finally{h&&h.dispose()}this.hBa=null}}b5k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.pa.Qh(b.cpBegin);return!!b&&b.Dwa}d1e(b){if(this.Gpb){this.freeze();var h=new ah.GraphTransaction(7);h.Cb(b.node);this.Gpb.ige(b);this.bIa();this.N5a();h.dispose()}}Itf(b){const h=de.ParagraphReader.text(b.node);
return b.cpBegin&&b.cpBegin!==h.length&&!G.a.Jv(h.charCodeAt(b.cpBegin))&&yA.a.instance.$0a(h,b.cpBegin-1)!==b.cpBegin&&We.SelectionEditor.ckb(b)?(b=We.SelectionEditor.F3(b,!1))?1<b.length||We.SelectionEditor.ml(b.Oa)?b:null:null:null}}Object(n.a)(Bm,"InsertionPointFormatting",null,[628]);class Dy{constructor(b){this.ga=b}get oc(){return this.ga}MOk(b,h,v=null){const D=new fh.DictionaryPropertySet;D.setValue(wc.a.GA,b);D.setValue(wc.a.KQa,h);v&&D.Vw(v);D.CommandSource="autobulleting";this.oc.Qb(Eb.a.kD,
2,D)}numbering(b,h,v,D,Q){const ba=new fh.DictionaryPropertySet;ba.setValue(wc.a.GA,b);ba.setValue(wc.a.KQa,h);ba.setValue(wc.a.L3a,v);Q&&ba.setValue(nh.a.pQ,Q);D&&ba.setValue(lc.a.lv,D);Tl.a.eY&&(ba.setValue(nh.a.Xoa,"autocorrect"),Q&&ba.setValue(nh.a.Aha,Q));ba.CommandSource="autonumbering";return 32===this.oc.Qb(Eb.a.uL,2,ba)}}Object(n.a)(Dy,"ListCommands",null,[626]);var bj=c(293);class Mo extends bj.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){super();this.$Xb=this.sm=this.KJa=null;this.nHn=(bc,
Dc)=>{Dc=this.Osa.$$d(this.KJa,Dc);bc.ji(this.XHl);return Dc};this.XHl=(bc,Dc)=>{if(this.sm.moveNext())return bc=this.sm.currentNode,12!==bc.type||bc===this.KJa.node?!0:this.Osa.V1c(bc,Dc);this.cOk();bc.ji(this.ZHl);return!0};this.ZHl=(bc,Dc)=>{if(this.sm.moveNext()){const Oc=this.sm.currentNode;return 12!==Oc.type?!0:Oc===this.KJa.node?(bc.ji(this.oHn),!0):this.Osa.V1c(Oc,Dc)}return!1};this.oHn=(bc,Dc)=>{this.Osa.aae(this.KJa,Dc);return!1};this.init(b);this.Jl(Vb);this.Qib(Ta,h,D,Q,ba);this.EL=ba;
this._context=v;this.ib=ob;this.Ie=Kb;this.Osa=ta;this.Xz=0}run(){this.D6e();this.Xz||this.Poo();1===this.Xz&&this.uIn();2===this.Xz&&this.OGo();3===this.Xz&&this.tDl()}D6e(){this.ib.gb&&this.ib.gb.kb?1===this.behavior&&(this.Osa.D6e(this._context)?this.mr=32:this.mr=2,this.Xz=3):(u.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.mr=2,this.Xz=3)}Poo(){this.ENk();this.Osa.fcg(this.KJa)?(this.XMk(),this.Xz=1):(this.mr=8,this.Xz=3)}uIn(){this.uC||new Mf.a(this,this.nHn,this.EL);
do if(this.uC.run(),this.uC.inProgress&&!this.Jh)return;while(this.uC.inProgress);this.vDd();this.Xz=2}OGo(){this.Osa.cig(this)?this.mr=32:this.mr=8;this.Xz=3}tDl(){this.mqa()}ENk(){let b=this.ib.gb.kb;if(b=this.Ie.xj(b,!0,!1))this.KJa=b.Oa;this.KJa&&this.KJa.node&&(this.$Xb=this.Osa.dei(this.KJa.node))}XMk(){if(!this.$Xb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Km.a;b.set(this.KJa.node);b.zb(this.$Xb.type);this.sm=jo.a.Qs(b,this.$Xb);this.sm.oo(Object(z.a)(this.Osa,
this.Osa.Zjc,"spellErrorFilter"),null)}cOk(){if(!this.$Xb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Km.a;b.set(this.$Xb);this.sm=jo.a.$p(b);this.sm.oo(Object(z.a)(this.Osa,this.Osa.Zjc,"spellErrorFilter"),null)}}Object(n.a)(Mo,"ProofingWholeDocumentOperation",bj.a,[]);var Do=c(276);class Ey extends hn{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(n.a)(Ey,"ContextMenuRootProperties",hn,[]);var xB=c(1364);class zC{constructor(b){const h=new Ey;
h.ImageSideArrow=w.AFrameworkApplication.Vs;h.ImageSideArrowClass=pd.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=Eb.a.u$d.toString();this.dih=new xB.ContextMenuRoot("ContextMenuRootName",h);b.execute(v=>{this.g1.wF=v});this.g1.refresh();w.AFrameworkApplication.va.qa(Ua.a.showContextMenu,Kd.a.frame,Rc.ActionManager.Pf);w.AFrameworkApplication.va.qa(Ua.a.Bjc,Kd.a.frame,Rc.ActionManager.Pf)}get g1(){return this.dih}dispose(){this.g1&&
(this.g1.dispose(),this.dih=null)}showContextMenu(b,h){this.Nob(b,h.clientPoint,h.kg)}w3b(b,h,v,D,Q){this.g1.w3b(b,h,v,D,Q)}I6a(b,h,v){Id.a.P3d(this.g1.NYa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Ya.App.xa.PGl();this.iu();this.g1.I6a(b,h,v);this.g1.NYa?w.AFrameworkApplication.va.processAction(Ua.a.Bjc,2):w.AFrameworkApplication.va.processAction(Ua.a.showContextMenu,2)}Nob(b,h,v){this.I6a(b,new Sys.UI.Bounds(h.x,h.y,0,0),v)}iu(){this.g1.root.xm()}y3(){return this.g1.y3()}Bjc(b,
h,v,D){const Q=this.g1;let ba=!1;v=Object(Ka.a)(ow,v);Q.NYa=v;D.Gya(b,h);Q.cYe?v&&(v.NDn(Q,h),ba=!0):(u.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",D.Mfl()),Q.NYa=null);return ba}}Object(n.a)(zC,"AContextMenuController",null,[660,10]);class eu{}eu.jgc="faProofing";eu.iUh="EditorMenuSection";Object(n.a)(eu,"ContextMenuControlId",null,[]);var yB=c(525);class Yk{constructor(b){this.Ie=b}D6e(b){b=Object(Ka.a)(yB.a,b);return!!b&&!!b.view&&b.view.qe}fcg(){return!0}$$d(){return!0}V1c(){return!0}aae(){}cig(){return!0}Zjc(b){if(b.Pr)return!0;
b=b.role;return 1===b||2===b||3===b||4===b||5===b}dei(b){if(!b||!this.Ie)return b;const h=new Km.a;h.set(b);if(this.Ie.mu(h)){for(;!h.Pr;)h.sc();return h.currentNode}return b}}Object(n.a)(Yk,"SimpleProofingWholeDocumentCallBacks",null,[419]);class Fy{constructor(b){this.value=b}}Object(n.a)(Fy,"RefBool",null,[]);class wz{constructor(){this.bLc=this.QJb=null;this.XCj=new Fy(!1)}}Object(n.a)(wz,"FindNextErrorOperationParam",null,[]);class Gy{constructor(){this.Priority=0;this.Context=null;this.Length=
this.StartInContext=this.Start=0;this.Metadata=Gy.dtl;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}Gy.dtl=[];Object(n.a)(Gy,"Critique",null,[]);class ww{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(ww,
"Suggestion",null,[]);var Hy=c(598);class fu extends Sys.EventArgs{constructor(b,h,v,D,Q,ba){super();this.F4j=b;this.L6j=h;this.M6j=v;this.Bre=D;this.Kz=Q;this.M8a=ba}}Object(n.a)(fu,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var ws=c(335);class xs{constructor(b,h,v){this.Dze=b;this.Fm=h;this.ra=v}CIh(b){const [h,v,D]=this.Fii(b);return this.S7h(h,v,D)}xHm(b){return ic.a.getTypeNameFor(b.content)===ws.a.getTypeName()}S7h(b,h,v){if(v&&this.xHm(v)){if(this.L0b(v.content))return null;const Q=
v.content;var D=new Gy;D.ExplanationTitle=Q.explanationTitle;D.Suggestions=this.rdm(v);D.CategoryTitle=Q.categoryName;D.TypeId=Q.typeId;D.CritiqueActions=Q.critiqueActions;D.Priority=Q.priority;v=this.Dze.create(D);D=Q.context;v.token=D.substring(Q.range.start,Q.range.start+Q.range.length);v.lcid=lk.a.og(Q.language).LCID;v.originalText=D;return new Hy.a(b,h,v)}return null}rdm(b){var h=b.content.suggestions;b=[];for(const v of h)h=new ww,h.Action=v.suggestionActions,h.Text=v.text,h.Description=v.description,
b.push(h);return b}L0b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}Fii(b){const h=this.Fm.uOc(b,0),v=b.cpBegin,D=b.cpEnd,Q=We.SelectionEditor.gf(b);b=de.ParagraphReader.text(b.node,0);for(const ba of h)if(Q){if(ba.begin<=v&&ba.end>=D)return[ba.begin,ba.end,ba.intent]}else if(ba.begin<=v&&ba.end>=v&&G.a.IHh(b,ba.end,D))return[ba.begin,ba.end,ba.intent];return[null,null,null]}static AB(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}kwf(b,h,v){const [D,Q,ba]=this.Fii(b);ba&&this.ra.raiseEvent(xs.ovh,new fu(b,D,Q,h,ba,v))}zwk(b){this.ra.addHandler(xs.ovh,b)}Szl(b,h,v){b=this.Fm.LPd(b,0,0,b.characterData.length);for(let D=0;D<b.count;D++){const Q=b.J(D);if(Q.intent){const ba=Q.intent;if(ba.content&&(0==ba.content.priority||1==ba.content.priority)&&Q.begin>=h&&(!v||v(Q.intent)))return this.S7h(Q.begin,Q.end,Q.intent)}}return null}}xs.ovh="augloopProofingContextMenuActionEventKey";Object(n.a)(xs,"AugLoopProofingErrorDetailHelper",
null,[]);class xz extends Yk{constructor(b,h,v,D){super(h);this.sn=b;this.TAc=v;this.sWj=D}$$d(b,h){return!this.QJf(b.node,b.cpBegin,h)}V1c(b,h){return!this.QJf(b,0,h)}aae(b,h){this.QJf(b.node,0,h);Object(Ka.a)(wz,h)}QJf(b,h,v){v=Object(Ka.a)(wz,v);if(de.ParagraphReader.Vb(b)&&!b.tJ)if(Hn.FormattingReader.Kr(Pe.a.Rc(b,h)).cache.tHb)v.XCj.value=!0;else{if(xs.AB())return h=this.sWj.Szl(b,h,this.TAc),null!=h?(v.QJb=h,v.bLc=b,!0):!1;const D=this.sn.Q3(b);for(let Q=0;Q<D.length;Q++){const ba=D[Q];if(ba.begin>=
h&&!ba.errorDetails.W2a()&&(!this.TAc||this.TAc(ba.errorDetails)))return v.QJb=ba,v.bLc=b,!0}return!1}}}Object(n.a)(xz,"FindNextErrorCallbackSteps",Yk,[]);var zp=c(303);class Xx{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd){this.e_k=(je,Ld,Qd,ge,ze)=>{Ld=this.ib.gb.kb;if(!Ld)return this.rd.Yb(Oe.a.kf,{["Reason"]:Fe.a.noSelection}),2;Ld=this.Ie.xj(Ld,!0,!1);return this.ga.Of(Ld.Oa,je,Qd,!1,ge,ze)};this.Uvn=(je,Ld,Qd)=>{if(1===Qd)return this.ga.processAction(Eb.a.g5,1);this.E9j().eeg();return 32};
this.vDa=(je,Ld,Qd)=>{if(1===Qd)return 32;ch.a.mark(4670);Qd=this.sn.yna(Ld);if(this.tme(Qd))return 8;Ld=Ld.node;const ge=this.Gc.Oc(15);let ze=Qd.begin;" "===de.ParagraphReader.text(Ld).charAt(ze-1)&&ze--;ge.Cb(Ld);const gg=this.Kd.replaceTextRange(Pe.a.createTextRange(Ld,0<Qd.begin?Qd.begin-1:0,Qd.end),"",!0,!1);this.ib.setSelection(Mg.SelectionFactory.ue(Ld,gg+ze));ge.dispose();Qd.errorDetails.Spb(je);ch.a.mark(4671);return 32};this.gwa=(je,Ld,Qd)=>{if(1===Qd)return 32;u.ULS.sendTraceTag(7660830,
324,50,"Ignore spelling error triggerred");if(xs.AB())return this.c9a.kwf(Ld,null,zp.b.IgnoreOnce),32;ch.a.mark(4670);Qd=this.sn.yna(Ld);if(this.tme(Qd))return 8;Ld=Ld.node;const ge=this.Gc.Oc(15);ge.Cb(Ld);this.sn.xnb(Ld,[Qd],!0);Ld.setValue(Gd.a.q9e,!0);ge.dispose();Qd.errorDetails.Spb(je);ch.a.mark(4671);u.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.G5m(Qd);this.wXa.woi(Qd,Ld,!0);return 32};this.q7k=(je,Ld,Qd)=>{var ge,ze=!this.Ik.I8(Ld);this.Tm&&this.Tm.instance&&
this.Tm.instance.tU(Ld)&&(ze=!1);if(1===Qd||!ze)return ze?32:8;this.ga.processAction(Eb.a.Iqa,2);ch.a.mark(4670);ze=this.zRl(je);if(0>ze)return 8;if(xs.AB())return this.c9a.kwf(Ld,ze,zp.b.Apply),32;Qd=this.sn.yna(Ld);if(this.tme(Qd))return 8;Ld=Ld.node;var gg=Qd.errorDetails.suggestions;if(!gg)return this.rd.Yb(Oe.a.RCb,{["Reason"]:"NoSuggestionsFound"}),ch.a.mark(4671),8;ze=ze<gg.length?gg[ze]:null;if(!ze)return this.rd.Yb(Oe.a.RCb,{["Reason"]:"RequestedSuggestionIsNull"}),ch.a.mark(4671),8;(null===
(ge=Ya.App.qd)||void 0===ge?0:ge.Qo)&&Ya.App.qd.Qp.QF(Ld);ze=ze.replace("  "," \u00a0");ge=this.Gc.Oc(15);ge.Cb(Ld);gg=this.Kd.replaceTextRange(Pe.a.createTextRange(Ld,Qd.begin,Qd.end),ze,!0,!1,Eb.a.Iqa);this.ib.setSelection(Mg.SelectionFactory.ue(Ld,Qd.begin+ze.length+gg));ge.dispose();Qd.errorDetails.Spb(je);ch.a.mark(4671);this.t0m(Qd);return 32};this.lco=(je,Ld)=>{Ld=this.sn.yna(Ld);if(this.tme(Ld))return 8;Ld.errorDetails.Spb(je);return 32};this.yCl=(je,Ld,Qd,ge,ze)=>{if(!Ld.view.qe)return 2;
const gg=Ld.view;if(!this.ib.gb.kb)return this.rd.Yb(Oe.a.kf,{["Reason"]:Fe.a.noSelection}),2;if(1===Qd)return 32;const Kg=new wz,Ll=new xz(this.sn,this.Ie,this.TAc,this.c9a);Ld=new Mo(null,je,Ld,Qd,ge,Kg,Ll,this.ga,this.ib,this.Ie,null);Ld.Jh=!0;Ld.run();if(Ld.isCompleted&&Kg.QJb){if(Ld=Mg.SelectionFactory.ue(Kg.bLc,Kg.QJb.begin),Ld=Mg.SelectionFactory.oA(Ld,Pe.a.Rc(Kg.bLc,Kg.QJb.end)),!this.ebh.instance||!this.ebh.instance.KFn(Kg.QJb,Ld,gg)){this.ib.setSelection(Ld);let Em=0;ze&&(Em=ze.Ix);gg.Phe=
!1;xb.a.instance.Wb(new of.a(1,1,1,()=>{this.rao(gg,Em,Kg.bLc,Kg.QJb)}))}}else{const Em=new pg.StandardDialog;Em.Ad=0;Ya.App.gN.OVc?Em.cja(CommonUIStrings.l_DefaultDialogTitle,Kg.XCj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Em.cja(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Ya.App.gN.ezd(()=>{Em.tha&&(Em.hide(),this.ga.processAction(je,2))}))}return 32};this.u$d=(je,Ld,Qd)=>
{if(1===Qd)return 32;this.Yda&&this.Yda.g1&&(je=this.Yda.g1.pvf(eu.jgc))&&!je.gL&&(je.c0(0),je.menu.QK(0));return 32};this.ga=h;this.sn=b;this.E9j=v;this.Kd=D;this.Gc=Q;this.ib=ba;this.Tm=ta;this.Ie=Ta;this.Qhk=ob;this.Ik=Kb;this.rd=Vb;this.c9a=rd;this.Yda=Object(Ka.a)(zC,bc);this.YVb=Dc.lVc;this.ebh=Oc;this.wXa=gd;this.eoc=new Map;this.eoc.set(1,Eb.a.rfg);this.eoc.set(2,Eb.a.Pvf);this.eoc.set(3,Eb.a.qgg);this.Fzc=new Map;this.Fzc.set(1,Eb.a.sfg);this.Fzc.set(2,Eb.a.Qvf);this.Fzc.set(3,Eb.a.rgg)}Tb(){const b=
this.ga,h=this.q7k,v=this.e_k;b.fb(Eb.a.w8d,Zb.a.view,this.Uvn,1028);b.qa(Eb.a.vDa,Zb.a.Tc,this.vDa);b.qa(Eb.a.gwa,Zb.a.Tc,this.gwa);b.qa(Eb.a.Bpb,Zb.a.Tc,h);b.qa(Eb.a.Cpb,Zb.a.Tc,h);b.qa(Eb.a.Dpb,Zb.a.Tc,h);b.qa(Eb.a.JPb,Zb.a.Tc,h);b.qa(Eb.a.KPb,Zb.a.Tc,h);b.qa(Eb.a.vDa,Zb.a.view,v);b.qa(Eb.a.gwa,Zb.a.view,v);b.qa(Eb.a.Bpb,Zb.a.view,v);b.qa(Eb.a.Cpb,Zb.a.view,v);b.qa(Eb.a.Dpb,Zb.a.view,v);b.qa(Eb.a.JPb,Zb.a.view,v);b.qa(Eb.a.KPb,Zb.a.view,v);b.Vc(Eb.a.vDa,1028);b.Vc(Eb.a.gwa,1028);b.Vc(Eb.a.Bpb,
1028);b.Vc(Eb.a.Cpb,1028);b.Vc(Eb.a.Dpb,1028);b.Vc(Eb.a.JPb,1028);b.Vc(Eb.a.KPb,1028);b.qa(Eb.a.Iqa,Kd.a.frame,Rc.ActionManager.Pf);this.YVb&&b.fb(Eb.a.u$d,Zb.a.view,this.u$d,1124);b.fb(Eb.a.CZc,Zb.a.view,this.yCl,1028);b.fb(Eb.a.G0f,Zb.a.Hd,this.lco,1124);this.uVn([Eb.a.mje,Eb.a.rfg,Eb.a.sfg,Eb.a.ZSd,Eb.a.Pvf,Eb.a.Qvf,Eb.a.Pje,Eb.a.qgg,Eb.a.rgg,Eb.a.Y3i,Eb.a.nPi,Eb.a.Gtj])}uVn(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],Zb.a.view,Rc.ActionManager.FQ,1028)}IWn(b){this.TAc=b}tme(b){return b?b.errorDetails?
!1:(u.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.rd.Yb(Oe.a.RCb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),ch.a.mark(4671),!0):(u.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.rd.Yb(Oe.a.RCb,{["Reason"]:"RequestedErrorRangeNotFound"}),ch.a.mark(4671),!0)}G5m(b){b=b.errorDetails.proofingType;if(this.Fzc.has(b)){const h=this.Fzc.get(b);this.ga.processAction(h,2);u.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",
h,b)}}zRl(b){switch(b){case Eb.a.Bpb:return 0;case Eb.a.Cpb:return 1;case Eb.a.Dpb:return 2;case Eb.a.JPb:return 3;case Eb.a.KPb:return 4;default:return-1}}t0m(b){b=b.errorDetails.proofingType;if(this.eoc.has(b)){const h=this.eoc.get(b);this.ga.processAction(h,2);u.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}rao(b,h,v,D){b.b5();(b=v.De(b.ic))?(D=Do.a.Rq(b,w.AFrameworkApplication.isRtl?D.begin:D.end),this.Qhk.Gya(new Sys.UI.Point(D.x,D.y+D.height),
h)):u.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(n.a)(Xx,"ProofingActor",null,[]);var qp=c(408),js=c(1555),vr=c(1843),$n=c(533);class Li{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.rkc=null;this.ZEl="StyleUsageActivity";this.$El="StylesFloodgateSurveyIsEnabled";this.TMa=(bc,Dc,Oc,gd)=>{bc=this.Ucm(bc);return 0>bc||bc>this.rkc.length?2:(bc=this.rkc[bc])?w.AFrameworkApplication.va.Of(Dc,Eb.a.applyStyle,Oc,!0,gd,bc):2};this.uLb=(bc,Dc,Oc,gd,rd)=>{bc=!0;Dc.contextId!==
Zb.a.paragraph&&Dc.contextId!==Zb.a.Hd&&Dc.contextId!==Zb.a.Tc&&(bc=!1);if(1===Oc||!bc)return bc?32:8;if(2===Oc&&!rd)return 8;Dc=this.wc.MC(Dc.node);rd.MenuItems=qp.a.U2l(Dc);return 32};this.ELn=(bc,Dc,Oc,gd,rd)=>{bc=!0;Dc.contextId!==Zb.a.paragraph&&(bc=!1);if(1===Oc&&!bc)return 8;Dc=Dc.node;Oc=this.wc.No(Dc);if(!Oc||!rd)return u.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",rd,Dc,Oc),8;rd.wTa.Vw(Oc.wl());return 32};this.$Ek=(bc,Dc,Oc,gd,rd)=>{if(Dc.contextId!==
Zb.a.paragraph)return 8;if(this.Xf.i3a(Dc,!1))return this.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),8;if(1===Oc)return 32;const je=Dc.node;if(de.ParagraphReader.qua(je)||!rd)return 8;const Ld=this.fuf(rd,je);if(!Ld)return this.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.SCb}),8;if(2!==this.wc.yG(Ld))return 2;Oc=new ah.GraphTransaction(15);this.Gn&&this.Gn.isProgressiveStyleEnabled&&this.HH.Ljc(rd);Oc.Cb(je);this.rj.N5a();const Qd=[];bc!=Eb.a.clearFormatting&&Qd.push(qe.a.NIa);this.w5.PJ(Ld,je,!1,void 0,void 0,void 0,
Di.a.Pj?new vr.a(Qd,!1,!0):null);(bc=this.wc.MC(je))&&this.wc.je(Ld,bc)&&Lc.b(593078098,3017,50,"Custom linked style applied by user");je.ur&&(bc=[Object.assign(new pa.a,{name:"Source",string:"ApplyStyle"})],Qe.a("TOCFormatting",!0,void 0,bc));Oc.dispose();rd=G.a.YW(rd);gd.ns=rd>>>16^rd&65535;gd&&js.a.Epb&&(gd.xC|=js.a.khb(Dc.node));return 32};this.FLn=(bc,Dc,Oc,gd,rd)=>{bc=!0;Dc.contextId!==Zb.a.Hd&&(bc=!1);if(1===Oc&&!bc)return 2;Dc=Hn.FormattingReader.Kr(Dc);Dc=Hn.FormattingReader.Ona(Dc);if(!Dc)return 2;
if(!rd)return 8;rd.wTa.Vw(Dc.wl());return 32};this.aFk=(bc,Dc,Oc,gd,rd)=>{if(Dc.contextId!==Zb.a.Hd)return 8;this.Xf.i3a(Dc);if(1===Oc)return 32;bc=Dc;Di.a.sFd&&(Dc=this.Do.bRd(bc))&&(bc=Dc);Dc=bc.node;if(!rd)return 8;const je=this.fuf(rd,bc.node);if(!je)return this.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.SCb}),8;if(1!==this.wc.yG(je))return 2;Oc=this.wc.MC(Dc);if(!Oc)return this.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.hYh}),8;if(!Oc.Pi(this.wc.pg(je)))return this.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.SCb}),8;const Ld=new ah.GraphTransaction(7);
try{if(this.Gn&&this.Gn.isProgressiveStyleEnabled&&this.HH.Ljc(rd),Ld.Cb(Dc),this.w5.Smg(Dc,Oc),this.Lqa.XZ(bc,Qd=>{this.Sn.Bfa(Qd);this.Sn.D6a(Qd,je)}),Dc.ur){const Qd=[Object.assign(new pa.a,{name:"Source",string:"ApplyStyle"})];Qe.a("TOCFormatting",!0,void 0,Qd)}}finally{Ld&&Ld.dispose()}Oc&&this.wc.je(je,Oc)&&Lc.b(593078097,3017,50,"Custom linked style applied by user");rd=G.a.YW(rd);gd.ns=rd>>>16^rd&65535;gd&&js.a.Epb&&(gd.xC|=js.a.khb(bc.node));return 32};this.DLn=(bc,Dc,Oc,gd,rd)=>{bc=!0;Dc.contextId!==
Zb.a.Tc&&(bc=!1);if(1===Oc&&!bc)return 2;Dc=this.w5.$cm(Dc);if(!Dc)return 2;if(!rd)return 8;rd.wTa.Vw(Dc.wl());return 32};this.ZEk=(bc,Dc,Oc,gd,rd)=>{if(Dc.contextId!==Zb.a.Tc)return 8;if(this.Xf.i3a(Dc,!1))return this.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),8;if(1===Oc)return 32;var je=Dc.node;if(!rd)return 8;Oc=this.fuf(rd,Dc.node);if(!Oc)return this.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.SCb}),8;const Ld=this.wc.yG(Oc);if(1!==Ld&&2!==Ld)return 2;(Dc=this.rj.Itf(Dc))?(Dc=Th.a.mBb(Dc),bc=w.AFrameworkApplication.va.Of(Dc,
bc,2,!1,gd,rd)):(bc=new ah.GraphTransaction(7),this.Gn&&this.Gn.isProgressiveStyleEnabled&&this.HH.Ljc(rd),bc.Cb(je),this.w5.Amo(Oc,je),bc.dispose(),bc=32);je.ur&&(Dc=[Object.assign(new pa.a,{name:"Source",string:"ApplyStyle"})],Qe.a("TOCFormatting",!0,void 0,Dc));(je=this.wc.MC(je))&&this.wc.je(Oc,je)&&Lc.b(593078096,3017,50,"Custom linked style applied by user");rd=G.a.YW(rd);gd.ns=rd>>>16^rd&65535;return bc};this.GLn=(bc,Dc,Oc,gd,rd)=>{const je=this.Dbd.Bpa(bc,Dc,Oc,gd,rd,null,0);return 2!==je?
je:this.Dbd.Bpa(bc,Dc,Oc,gd,rd,null,12)};this.bFk=(bc,Dc,Oc,gd,rd)=>{var je;const Ld={};Ld[this.Dbd.QIa]=6168;Ld[this.Dbd.PIa]=6169;let Qd=12;if(!Dc.view.qe)return 2;var ge=Dc.view.lb,ze=ge?ge.tg:null;if(!ze)return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.noSelection}),8;if(this.Wg.$Ca(ke.ImageReader.x2a,ze))return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.lHc}),8;if(this.Wg.qza(de.ParagraphReader.oU,ze))return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),8;if(this.Xf.V$b(ze,!1))return this.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.RE}),
8;ze=this.wc.Mr();if(rd&&ze){const gg=ze.Pi(rd);if(gg){(null===(je=w.AFrameworkApplication.K)||void 0===je?0:je.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("Style");je=this.wc.Iva(gg,ze);let Kg=this.wc.yG(gg);je&&(ge=ge.gb.J(0),ge.iy&&ge.Oa.contextId===Zb.a.Hd||2===ge.length&&ge.Oa.contextId===Zb.a.Hd&&ge.Pc.contextId===Zb.a.endOfParagraph)&&(Kg=1,rd=je.getValue(Ve.a.ka));1===Kg?Qd=0:3===Kg&&(Qd=14);!this.wc.je(gg,ze)&&this.wc.Fd(gg)&&(ge=this.wc.pg(gg),
Lc.b(562317522,3017,50,String.format("{0}: style applied by user",ge)));this.Pqa(this.ZEl,this.$El)}}return this.Dbd.Bpa(bc,Dc,Oc,gd,rd,Ld,Qd)};this.Ru=h;this.Be=v;this.wN=D;this.Sz=Q;this.Ik=ba;this.rd=ta;this.xW=Ta;this.Unk=ob;this.ve=Kb;this.Do=Vb}get Gn(){return null!=this.MGg?this.MGg:this.MGg=Ga.a.instance.Na("Box4.Styles.StyleSettings")}get w5(){return this.Ru}get Wg(){return this.wN}get rj(){return this.Sz}get Sn(){return this.Be}get Xf(){return this.Ik}get Ic(){return this.rd}get Lqa(){return this.xW}get Dbd(){return this.Unk}get wc(){return this.ve}Tb(){const b=
w.AFrameworkApplication.va,h=Ya.App.MTa.xKh(12);b.qa(Eb.a.applyStyle,Zb.a.Hd,this.aFk);b.qa(Eb.a.NGa,Zb.a.Hd,this.FLn);b.qa(Eb.a.applyStyle,Zb.a.Tc,this.ZEk);b.qa(Eb.a.NGa,Zb.a.Tc,this.DLn);b.qa(Eb.a.applyStyle,Zb.a.paragraph,this.$Ek);b.qa(Eb.a.applyStyle,Zb.a.view,this.bFk);b.Vc(Eb.a.applyStyle,1036);b.qa(Eb.a.NGa,Zb.a.view,this.GLn);b.qa(Eb.a.NGa,Zb.a.paragraph,this.ELn);b.Vc(Eb.a.NGa,99);b.qa(Eb.a.uLb,Zb.a.view,h);b.qa(Eb.a.uLb,Zb.a.paragraph,this.uLb);b.Vc(Eb.a.uLb,1127);b.fb(Eb.a.p1e,Zb.a.view,
this.TMa,4);b.fb(Eb.a.q1e,Zb.a.view,this.TMa,4);b.fb(Eb.a.r1e,Zb.a.view,this.TMa,4);b.fb(Eb.a.s1e,Zb.a.view,this.TMa,4);b.fb(Eb.a.t1e,Zb.a.view,this.TMa,4);b.fb(Eb.a.u1e,Zb.a.view,this.TMa,4);b.fb(Eb.a.v1e,Zb.a.view,this.TMa,4);b.fb(Eb.a.Mth,Zb.a.view,this.TMa,4);b.fb(Eb.a.Nth,Zb.a.view,this.TMa,4);b.fb(Eb.a.Oth,Zb.a.view,this.TMa,4);this.rkc=Array(10);hj.StyleReader.Jmj(this.rkc)}Ucm(b){switch(b){case Eb.a.p1e:return 0;case Eb.a.q1e:return 1;case Eb.a.r1e:return 2;case Eb.a.s1e:return 3;case Eb.a.t1e:return 4;
case Eb.a.u1e:return 5;case Eb.a.v1e:return 6;case Eb.a.Mth:return 7;case Eb.a.Nth:return 8;case Eb.a.Oth:return 9;default:return-1}}Pqa(b,h){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const v=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");v&&v.execute(D=>{D.logActivity(b,h)})},Li.uDa)}fuf(b,h){if(b&&h&&de.ParagraphReader.Vb(h))h=this.wc.MC(h);else return null;return h.Pi(b)}get HH(){return null!=this.Dzg?this.Dzg:this.Dzg=Ga.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
Li.uDa=5E3;Object(n.a)(Li,"StyleActor",null,[]);var pv=c(1966);class Pq{constructor(b){this.ga=b}get oc(){return this.ga}ige(b,h=!1){this.oc.Of(b,Eb.a.PPa,2,!0,null,h)}g5(b){this.oc.Qb(Eb.a.g5,2,b)}}Object(n.a)(Pq,"TextFormattingCommands",null,[625]);class No{constructor(b,h,v,D){this.mVe=this.Lih=!1;this.uKo=(Q,ba,ta)=>{if(2!==ta)return 2;this.Lih||(this.Lih=!0);w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.BHn=(Q,ba,ta,Ta,ob)=>{if(2!==ta)return 2;this.s3i(ob,!0);return 32};this.AHn=(Q,ba,ta,Ta,ob)=>{if(2!==ta)return 2;this.s3i(ob,!1);return 32};this.vIn=(Q,ba,ta)=>{if(2!==ta)return 2;if(!this.X$a)return 8;this.X$a.Jrm();return 32};this.uHn=(Q,ba,ta)=>{if(2!==ta)return 2;if(!this.X$a)return 8;this.X$a.r6n();return 32};this.opa=(Q,ba)=>{3===ba.Ix&&We.SelectionEditor.km(ba.nl.kb)&&(Qe.c(Eb.a.pKo),w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.mVe=!0)};this.ga=b;this.Ma=h;this.X$a=v;this.ib=D}get tKo(){return this.mVe}Tb(){var b;this.ga.fb(Ua.a.zP,Zb.a.view,this.uKo,4);this.ga&&this.Ma&&(this.Ma.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(Eb.a.Sjg,Zb.a.view,this.BHn,4),this.ga.fb(Eb.a.Ujg,Zb.a.view,this.AHn,4)),this.ga.fb(Ua.a.Fuj,Zb.a.application,this.vIn,4),this.ga.fb(Ua.a.ohf,Zb.a.application,this.uHn,4),Iq.EventHandlerManager.instance.OVn(()=>{this.jun()}));(null===(b=Ya.App.xa.hb.rc)||void 0===b?0:b.qe)&&Ya.App.xa.hb.rc.Kla(()=>
{this.vao()});this.ib&&this.ib.Pw(this.opa)}ZNn(){Qe.c(Eb.a.sKo);this.mVe=!0}vao(){const b=window.performance.now();No.fIe&&250>b-No.fIe&&1E3<b-No.M3g&&(Qe.c(Eb.a.rKo),No.M3g=b);this.X$a&&No.Xb&&No.Xb.DA(116)&&this.X$a.showFloatie()}jEm(b,h){if(h){var v=null;aa.a.SJ&&b&&(v=b.getSelection());b=null;v&&"Caret"===v.type&&(b=v.getRangeAt(0))&&this.X$a&&this.X$a.xUo(b.getBoundingClientRect(),h)}}jun(){No.fIe=window.performance.now()}s3i(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(No.Mum)){for(b=
b.firstChild;b;)this.Bzk(b,h),b=b.nextSibling;break}b=b.nextSibling}}Bzk(b,h){if(b.classList.contains(No.Poi)){const v="WACImageResizeHandleTouch"+this.RXl(b);h?b.classList.add(No.Qoi,v):b.classList.remove(No.Qoi,v)}}RXl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==No.Poi)return G.a.substring(h,20,h.length);return""}static get Xb(){return null!=No.yyg?No.yyg:No.yyg=Ga.a.instance.Na("Box4.IFeatureHelper")}}No.Poi="WACImageResizeHandles";No.Qoi="WACImageResizeHandlesTouch";
No.Mum="WACImgSelection";No.fIe=0;No.M3g=0;Object(n.a)(No,"TouchInputActor",null,[624]);class wt{get QIa(){return Pr.a.QIa}get PIa(){return Pr.a.PIa}get Zmc(){return Pr.a.Zmc}Bpa(b,h,v,D,Q,ba,ta){return Pr.a.Bpa(b,h,v,D,Q,ba,ta)}Gfc(b,h,v,D,Q,ba){return Pr.a.Gfc(b,h,v,D,Q,ba)}static get instance(){wt._instance||(wt._instance=new wt);return wt._instance}}wt._instance=null;Object(n.a)(wt,"ViewActionHandlerProxy",null,[623]);class Uu{constructor(b,h){this.kpiName="VisiMarkersUsage";this.f8="wwaengidc";
this.vkb=new Map;this.gxo=(v,D,Q,ba,ta)=>{if(1===Q)return 32;if(!ta)return 2;this.vkb.set("Source",le.a[this.ga.U_]);this.QWe.vWc?this.vkb.set("Action","Removed"):this.vkb.set("Action","Applied");wa.Health.instance.recordKpiUsage(this.kpiName,1,this.f8,this.vkb);v=document.getElementsByTagName("head")[0];if(!this.QWe.LJo(v))return u.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Ya.App.xa.WG({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.VKn=(v,D,Q,ba,ta)=>{if(1===
Q)return 32;ta[Ff.a.On]=this.QWe.vWc;return 32};this.ga=b;this.QWe=h}Tb(){this.ga.fb(Eb.a.Mie,Zb.a.application,this.gxo,1);this.ga.fb(Eb.a.R4i,Zb.a.application,this.VKn,96)}}Object(n.a)(Uu,"VisiMarkersActor",null,[]);var Gs=c(108);class xw{constructor(b,h,v,D,Q){this.Un=b;this.Fin=h;this.lj=v;this.Ld=D;this.characterPropertiesEditor=Q}get yRi(){return this.Fin.value}execute(b,h,v,D){const Q=Ye.a.instance.Ap(Eb.a.ijo);Cd.OutlineElementReader.isEmpty(b,!1)?this.qxl(b):this.rxl(b,h,v,D);Q.end()}qxl(b){this.yRi.y5e(b,
-1)?this.yRi.XRa(b,-1,0):this.Un.XGa(b,{e$i:!0})}rxl(b,h,v,D){h=D(b,h,v);b=de.ParagraphReader.kl(b.currentNode);!this.Un.dPb&&this.lTm(b)&&this.hvk(h);this.Un.i$();(null===b||void 0===b?0:b.pa)&&!b.pa.last.formatting&&this.characterPropertiesEditor.f0a(b)}lTm(b){return b.Ki&&!b.yz.hasProperty(lc.a.listID)}hvk(b){ig.OutlineElementNavigator.Ge(b);b=b.currentNode;const h=new Gs.a;b.Jc.Lu(h);this.lj.dV(b,h,this.Ld.rg)}}Object(n.a)(xw,"ListNewLineStrategy",null,[]);var Kx=c(866),bw=c(470);class Lx{xc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",
()=>new nw(yt.a.NEb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new kk(w.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new nB.ClipboardActor(b.Ue("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),
Ye.a.instance,b.resolve("Box4.IClipboardDataHelper"),Th.a.instance,w.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.K,$c.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),w.AFrameworkApplication.Cdg(),w.AFrameworkApplication.Iqj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ga.a.instance.resolve("Common.IReactContextualUILauncher"),
!!Ya.App.instance&&Ya.App.instance.rha)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new lw(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new vB(w.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Xu.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();
b.ha("Box4.Actors.ISystemClipboard",()=>new Wx(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Ob.InteractiveViewManager.instance,Ya.App.xa.hb,$c.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Xu.a.instance,w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new vw).singleInstance();b.ha("Box4.ISelectionFactory",()=>new Av.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>
new pm).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new Os).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new bp(Th.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new Ux).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new tw(Th.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Ob.InteractiveViewManager.instance,
Id.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Ya.App.instance&&Ya.App.instance.rha)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new By(b.resolve("Box4.IClipboardDataHelper"),Ya.App.Bv.NI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new lt(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Ob.InteractiveViewManager.instance,mw.a.instance(),w.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ya.App.Tj.zl.Ye(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Ya.App.instance&&Ya.App.instance.rha)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new Xk(Ye.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),xy.a.instance,Th.a.instance,w.AFrameworkApplication.va,
b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ue("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new nA(w.AFrameworkApplication.va,Ye.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),Th.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Box4.IParagraphReader"),Lo.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Na("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new nz(Ye.a.instance,Xu.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Common.ISimpleOperationFactory"),w.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Rx(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new rw(b.resolve("Box4.Actors.InternalClipboard"),w.AFrameworkApplication.va,w.AFrameworkApplication.ydg(),Ye.a.instance,Lo.a.instance,Xu.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),
b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new wC(b.Ue("Box4.Actors.IBox4PasteStewardFactory"),b.Ue("Box4.Actors.IBox4ImageStewardFactory"),b.Ue("Box4.Actors.IBox4TableStewardFactory"),b.Ue("Box4.Actors.IBox4WordConverterFactory"),b.Ue("HtmlImport.IHtmlTranslatorSettings"),b.Na("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new ph.a(b.resolve("Box4.Images.IImageEditor"),b.Ue("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Ya.App.Tj,b.resolve("Box4.IParagraphIndentationReader"),w.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Na("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").Jij,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new vA(b.resolve("Box4.Actors.InternalClipboard"),b.Na("Box4.IContentControlCopyPasteHelper"),new Fg.a(()=>Ya.App.xa.hb.rc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).singleInstance();b.ha("Box4.List.IListCommands",()=>new Dy(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.List.ListNewLineStrategy",()=>new xw(b.resolve("Box4.List.IListEditor"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).singleInstance();b.ha("Box4.Actors.PasteCoordinator",
()=>new tz(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),xi.a.instance)).singleInstance();b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new ih(b.resolve("Box4.Images.IImageEditor"),w.AFrameworkApplication.pc,b.resolve("Box4.IUndoManager"),b.Na("Box4.Actors.IImageStewardBridge"),Ya.App.xa.notificationBar,b.Na("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4TableStewardFactory",()=>new xq(Ga.a.instance.resolve("Box4.List.IListEditor"),Ga.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new $u(Ye.a.instance,Th.a.instance,Ya.App.qd,xi.a.instance)).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",
()=>new Ww(w.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new sC(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new uB).singleInstance();b.ha("Box4.ISelectionCommands",()=>new fq(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new Pq(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new xu(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),
b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new Bm(b.Na("Box4.IFontSlotProvider"),b.Sa("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();b.ha("Box4.UI.PasteFloatieManager",()=>new Gu).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new Xx(Ga.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.va,()=>Ga.a.instance.resolve("Box4.UI.ILanguageDialog"),
Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Th.a.instance,Ga.a.instance.Sa("Box4.IExternalSelectionManager"),Lo.a.instance,Ga.a.instance.resolve("Box4.ISelectionContextMenuProvider"),xi.a.instance,Ye.a.instance,Ga.a.instance.resolve("Box4.IContextMenuController"),Ga.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ga.a.instance.Sa("Box4.Actors.IProofingErrorPresenter"),Ga.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
Ga.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new Li(Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ga.a.instance.resolve("Box4.IFormattingEditor"),io.ContextSetEditor.instance,Ga.a.instance.resolve("Box4.IInsertionPointFormatting"),xi.a.instance,Ye.a.instance,Ga.a.instance.resolve("Box4.TextFormattingHelper"),wt.instance,Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Ga.a.instance.resolve("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new Am(Ga.a.instance.resolve("Box4.IUpdateStyleManager"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",()=>new pv.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Na("Box4.IFontSlotProvider"),b.Na("Box4.IContentControlChpHelper"),
Ga.a.instance.resolve("Box4.IFormattingEditor"),Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.IParagraphEditor"),Ga.a.instance.resolve("Box4.ILineSpacingHelper"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),Ga.a.instance.resolve("Box4.List.IListFormattingEditor"),Ga.a.instance.resolve("Box4.IParagraphIndentationReader"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",
()=>new mA(w.AFrameworkApplication.va,Ye.a.instance,()=>Ga.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new No(w.AFrameworkApplication.va,w.AFrameworkApplication.K,hs.GrippersManager.instance,Th.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(Qs,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new Uu(w.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();
b.ha("Box4.Actors.IndentationActorExtension",()=>new Cy).as("Box4.Actors.IIndentationActorExtension").singleInstance();Kx.a.UUc&&b.ha("Box4.Actors.PageColorActor",()=>new Kx.a(bw.a.instance,new Fg.a(()=>Ya.App.xa.hb.rc.Yc),Zh.a.instance,rl.a.instance,Ga.a.instance.Na("Box4.UI.RecentColorsSectionHandler"))).singleInstance()}}Object(n.a)(Lx,"Box4ActorsComponentConfiguration",null,[2]);var mt=c(222),Ct=c(1083);const AC=()=>{const b=BC;w.AFrameworkApplication.va.qa(Eb.a.Vff,Zb.a.embeddedFile,b);w.AFrameworkApplication.va.qa(Eb.a.Vff,
Zb.a.n6b,b);w.AFrameworkApplication.va.qa(Eb.a.Uff,Zb.a.embeddedFile,Yx);w.AFrameworkApplication.va.qa(Eb.a.Uff,Zb.a.n6b,Yx)},BC=(b,h,v)=>Ya.App.CId?8:2===v?(b=new pg.StandardDialog,b.Ad=4,b.cV(1),b.Ee(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ee(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.peg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,Ju),32):2,Ju=b=>{1===b&&w.AFrameworkApplication.va.processAction(Eb.a.Uff,2)},
Yx=(b,h,v)=>{if(Ya.App.CId)return 8;if(1===v)return h.node.hasProperty(Gd.a.embeddedFileContainer)?32:2;if(2===v&&(h.contextId===Zb.a.view&&h.view.lb&&(h=h.view.lb.tg),mt.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=Ct.a.JVl(h.node);Qb.a.Qno();try{Iy(b)}catch(D){u.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",D)}}return 32},Iy=b=>{Id.a.om(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var zB=c(772),Mx=c(944),yz=c(986);class Rs{constructor(b){this.LAa=this.GV=null;this.bia=
(h,v,D,Q,ba)=>{if(1===D)return 32;w.AFrameworkApplication.va.Qb(Eb.a.j5a,2,ba);h=ba&&0<=ba.fontColor&&16777215>=ba.fontColor?ba.fontColor:0;Ya.App.xa.Xw();(new Mx.a(Rs.IGc,Eb.a.lqa)).zjc(h);return 32};this.tLb=(h,v,D,Q,ba)=>{if(1===D)return 32;if(2===D&&!ba)return 8;h=Rs.nf.JQd(v);v=new zB.a;D=null;32===w.AFrameworkApplication.va.Qb(Eb.a.j5a,2,v)&&v&&(D=v.fontColor);Q="";D&&!v.r6b&&(Q=Sl.a.VE(D)||"");this.y0h.KNb=Q;this.tVc&&this.recentColors.Kne(Q);h=this.y0h.EMc(h,Ya.App.FAb);if(!h)return 8;ba.MenuItems=
h;u.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.IJe=b}get y0h(){this.GV||(this.GV=new yz.a(Rs.IGc),this.TEa(this.GV));return this.GV}TEa(b){b.OW(1,Eb.a.Cfa);b.OW(3,Eb.a.Sv);b.OW(4,Eb.a.Sv);b.OW(5,Eb.a.lqa);b.OW(6,Eb.a.bia);b.bzb(this.IJe,1)}Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.bia,Zb.a.view,this.bia);b.qa(Eb.a.tLb,Zb.a.view,this.tLb);b.Vc(Eb.a.tLb,1127)}static GWl(){return new Rs(bw.a.instance)}static get instance(){return null!=Rs.ABg?Rs.ABg:
Rs.ABg=Rs.GWl()}get recentColors(){return null!=this.FFg?this.FFg:this.FFg=Ga.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}static get nf(){return bi.PageReader.instance}get tVc(){null==this.LAa&&(w.AFrameworkApplication.te("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.LAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.LAa}}Rs.IGc="Font";Object(n.a)(Rs,"FontColorActor",
null,[]);class gu{constructor(b){this.bia=(h,v,D,Q,ba)=>{if(1===D)return 32;w.AFrameworkApplication.va.Qb(Eb.a.j5a,2,ba);h=ba&&0<=ba.highlight&&16777215>=ba.highlight?ba.highlight:0;Ya.App.xa.Xw();(new Mx.a("Highlighter",Eb.a.N9)).zjc(h);return 32};this.ga=b}Tb(){this.ga.qa(Eb.a.vYi,Zb.a.view,this.bia)}static zYl(){return new gu(w.AFrameworkApplication.va)}static get instance(){return null!=gu.kCg?gu.kCg:gu.kCg=gu.zYl()}}Object(n.a)(gu,"HighlighterColorActor",null,[]);var wr=c(372),jr=c(86);class AB{static get Xg(){return Vf.a.qA(AB.Lm,
Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}AB.Lm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(n.a)(AB,
"InsertLinkDialogHtml",null,[]);class Oo extends Vf.a{constructor(b){super();this.$6d=()=>{const h=document.getElementById("txtLink");this.hqa(1,!h||!h.value.length||ue.HyperlinkReader.r3a(h.value))};this.nAf=(h,v)=>{if(this.mh.hv){var D=this.mh.lb.gb.kb;if(D)if(D.equals(this.wx)&&0!==h){h=new ah.GraphTransaction(15);h.Cb(this.ZS[0].node);for(D=0;D<this.ZS.length;D++)this.ZS[D].node.IH().hF.w7(4);D=v.txtLink.trim();v=this.Ail();D=this.TAm(D);(v||D)&&Oo.Ld.Ls(7);this.hide();h.dispose()}else this.mh.x5()}};
this.ZS=b;this.mh=Ob.InteractiveViewManager.instance.Bd;this.wx=this.mh.lb.gb.kb;this.qkf=b[0].cpBegin;this.UHf=b[b.length-1].cpEnd;this.wg="InsertMultiParagraphLinkDialog";b=this.WTo();this.showDialog("",b)}showDialog(b,h){u.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Xg=AB.Xg;""===h.trim()&&this.Ee(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Yh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.nAf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;Oo.ADf&&(b=document.getElementById("txtLink"),lf.a.addHandler(b,Sc.a.input,this.$6d),lf.a.addHandler(b,Sc.a.change,this.$6d))}hide(){if(Oo.ADf){const b=document.getElementById("txtLink");b&&(lf.a.removeHandler(b,Sc.a.change,this.$6d),lf.a.removeHandler(b,Sc.a.input,this.$6d))}super.hide()}Sua(b){return Oo.ADf?this.QNl(this.frc)?super.Sua(b):!1:super.Sua(b)}WTo(){let b;var h="";const v=this.ZS.length,D=ue.HyperlinkReader.ND(this.ZS[0],!1);0<D.length&&
({cpBegin:Q,cpEnd:b}=Oo.L_.Iga(this.ZS[0],D[0]),Q<=this.ZS[0].cpBegin&&(h=D[0].hyperlink.url),this.qkf=Math.min(this.qkf,Q));var Q=ue.HyperlinkReader.ND(this.ZS[v-1],!1);0<Q.length&&({cpBegin:Q,cpEnd:b}=Oo.L_.Iga(this.ZS[v-1],Q[Q.length-1]),this.UHf=Math.max(this.UHf,b));this.$Mo(this.qkf,this.UHf);return h}$Mo(b,h){const v=this.ZS.length;if(b!==this.ZS[0].cpBegin||h!==this.ZS[v-1].cpEnd){b=Pe.a.Rc(this.ZS[0].node,b);b=Mg.SelectionFactory.io(b);h=Pe.a.Rc(this.ZS[v-1].node,h);h=Mg.SelectionFactory.oA(b,
h);b=this.Ghi(h.Oa.clone());const D=this.Ghi(h.Pc.clone());b&&D&&(this.ZS[0]=b,this.ZS[v-1]=D,this.mh.lb.setSelection(h),this.wx=h)}}TAm(b){if(!b)return!1;b=ue.HyperlinkReader.ePa(b);for(let v=0;v<this.ZS.length;v++){var h=this.ZS[v];if(Oo.Dta&&We.SelectionEditor.ml(h)&&(h=We.SelectionEditor.qkg(h),!We.SelectionEditor.ml(h)))continue;h=Pe.a.createTextRange(this.ZS[v].node,h.cpBegin,h.cpEnd);this.CMo(h);Oo.hyperlinkEditor.hG(h,b,!1)}return!0}CMo(b){jr.a.instance.J(1)&&Oo.Ld.gBj(b)}Ghi(b){return de.ParagraphReader.lm(b)&&
!We.SelectionEditor.G8(b)&&de.ParagraphReader.textLength(b.node)?Pe.a.createTextRange(b.node,0,de.ParagraphReader.textLength(b.node)):We.SelectionEditor.ml(b)?b:null}Ail(){let b=!1;for(const h of this.ZS){const v=ue.HyperlinkReader.ND(h,!1);v&&(b=Oo.L_.b$i(h,v)||b)}return b}static get L_(){return null!=Oo.HAg?Oo.HAg:Oo.HAg=Ga.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Ld(){return null!=Oo.eIg?Oo.eIg:Oo.eIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=
Oo.yAg?Oo.yAg:Oo.yAg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get Dta(){null==Oo.l$&&(Oo.l$=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Oo.l$}static get ADf(){null==Oo.kFe&&(Oo.kFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return Oo.kFe}}Oo.l$=null;Oo.kFe=null;Object(n.a)(Oo,"InsertMultiParagraphLinkDialog",Vf.a,[]);var Dv;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";
b.Url="Url";b.RecentLinks="RecentLinks"})(Dv||(Dv={}));Object(n.b)("InsertLinkUserActivitySource",Dv);class Ev{constructor(b,h,v,D,Q){this.linkurl=b;this.isHeading=h;this.startCp=v;this.endCp=D;this.paragraphNode=Q}}Object(n.a)(Ev,"HeadingDataForLinkDialog",null,[]);class BB{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(n.a)(BB,"BookmarkDataForLinkDialog",null,[]);class zA{constructor(b,h,v,D,Q,ba){this.key=b;this.name=h;this.startIndex=v;this.count=D;this.level=Q;this.isCollapsed=ba}}
Object(n.a)(zA,"GroupHeaderDataForLinkDialog",null,[]);class CB{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(n.a)(CB,"SelectedItemFromLinkDialogGroupedList",null,[]);class DB{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.fr=b;this.xd=h;this.Qpl=v;this.bookmarkManager=D;this.L_=Q;this.hyperlinkEditor=ba;this.characterPropertiesEditor=ta;this.Ld=Ta;this.lj=ob;this.Jk=Kb;this.twa=Vb;this.wDb=null;this.Dvi=!1;this.nAf=(Oc,gd)=>{var rd;if(this.ie.hv){var je=ue.HyperlinkReader.pPc(this.fr),
Ld=this.ie.lb.gb.kb;if(Ld){Ld=Ld.Oa;de.ParagraphReader.lm(Ld)&&(Ld=Pe.a.createTextRange(Ld.node,0,de.ParagraphReader.textLength(Ld.node)));var Qd=We.SelectionEditor.nQb(Ld);We.SelectionEditor.ml(Qd)&&(Ld=Qd);if(0!==Oc&&32===w.AFrameworkApplication.va.Of(Ld,Eb.a.insertHyperlink,1,!0,null,null)&&this.fr.equals(Ld)){ch.a.mark(5562);(null===(rd=Ya.App.qd)||void 0===rd?0:rd.Qo)&&this.ie.lb.O_b();Oc=new ah.GraphTransaction(15);Oc.Cb(this.fr.node);this.fr.node.IH().hF.w7(4);rd=gd.txtDisplay;Ld=!1;if(null!=
gd.linkurl)if(Ld=!0,gd.isHeading){l(this.xd,"Heading");Qd=gd.paragraphNode;const ge=gd.startCp,ze=gd.endCp;gd=this.bookmarkManager.iNl(Qd);this.bookmarkManager.sDc(gd,ge,ze,Qd,Qd,!1)}else l(this.xd,"Bookmark"),gd=gd.linkurl;else l(this.xd,"Url"),gd=gd.txtLink.trim();this.insertLink(rd,gd,je,Ld);Oc.fk=Eb.a.insertHyperlink;Oc.dispose();ch.a.mark(5563);this.fr.node.igb()}else this.ie.x5()}else u.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};
this.ie=Ob.InteractiveViewManager.instance.Bd;this.fr=b;v=We.SelectionEditor.nQb(this.fr);We.SelectionEditor.ml(v)&&(this.fr=v);const bc=new Vf.a(!1,!1,!0);v=this.JXl();D={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:v};Q=this.wDb="";Q=de.ParagraphReader.text(this.fr.node);
ta=this.fr.cpBegin;Ta=this.fr.cpEnd;({F9f:Q,Iif:ta,Jif:Ta,pyf:ba}=this.sTl(Q));if((h="object"===typeof h?h:null)&&(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,ba);else{ba[0]&&this.Jxl(ta,Ta,ba[0].paragraph);h=""===Q.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;bc.Ee(1,h);(null===Q||void 0===Q?0:Q.startsWith(G.a.Tdb))?(h=this.Oam(Q,v))?v.selectedItem=h:D.txtLink=Q:D.txtLink=Q;D.txtDisplay=this.wDb;1>=ba.length&&
this.L_.Y3k(b,ba[0],1===ba.length)&&(this.Dvi=!0,D.textDisplayDisabled=!0);var Dc={["id"]:"InsertLinkDialog",["bodyControls"]:D};this.Jk.he(()=>{bc.Yh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.nAf,Dc)},"RILD:IAS")}}sTl(b){const h=ue.HyperlinkReader.pPc(this.fr);let v=this.fr.cpBegin,D=this.fr.cpEnd,Q="";if(!h.length)return this.wDb=b.substring(this.fr.cpBegin,this.fr.cpEnd),{returnValue:!0,F9f:Q,Iif:v,Jif:D,pyf:h};if(h[0].hyperlink){let ba,ta=0,Ta=Math.max(0,b.length-1),ob=0;for(let Kb=0;Kb<h.length;Kb++)h[Kb].cpBegin>=
ta&&({cpBegin:ba,cpEnd:ta}=this.L_.Iga(this.fr,h[Kb]),Ta=Math.min(ba,Ta),ob=Math.max(ta,ob));v=Math.min(Ta,v);D=Math.max(ob,D);this.wDb=b.substring(v,D);v===Ta&&(Q=h[0].hyperlink.url);return{returnValue:!0,F9f:Q,Iif:v,Jif:D,pyf:h}}return{returnValue:!1,F9f:Q,Iif:v,Jif:D,pyf:h}}Jxl(b,h,v){if(h!==this.fr.cpEnd||b!==this.fr.cpBegin)b=Mg.SelectionFactory.LK(v,b,h),this.ie.lb.setSelection(b),this.fr=We.SelectionEditor.nQb(b.Oa.clone())}UKo(b,h,v,D,Q,ba=!1){D?(D=Pe.a.createTextRange(this.fr.node,this.fr.cpBegin,
this.fr.cpBegin+b.length),this.hyperlinkEditor.Lrl(D,v,h),b=Mg.SelectionFactory.ue(this.fr.node,this.fr.cpBegin+b.length)):(this.hyperlinkEditor.Flb(this.fr,2),this.lj.zob(this.fr,2),v=Pe.a.Rc(this.fr.node,this.fr.cpEnd),this.characterPropertiesEditor.replaceTextRange(v,b,!0),D=Pe.a.createTextRange(this.fr.node,this.fr.cpEnd,this.fr.cpEnd+b.length),this.hyperlinkEditor.hG(D,h,Q,!1,!0,ba),b=Mg.SelectionFactory.ue(this.fr.node,this.fr.cpEnd+b.length));b&&this.ie.lb.setSelection(b)}insertLink(b,h,v,
D=!1){var Q=null;b||(b=h,w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!v.length||h!==v[0].hyperlink.url)&&!D){h=ue.HyperlinkReader.ePa(h);var ba="";this.twa&&({s4f:ba}=this.twa.vkg(h)).returnValue&&(h=ba)}this.Dvi||(b=this.hyperlinkEditor.X2n(b));ba=!1;if(h){Q=0<v.length;const ta=de.ParagraphReader.text(this.fr.node).substring(this.fr.cpBegin,this.fr.cpEnd)!==b,Ta=this.Ld.rg;if(Ta&&1===v.length&&!v[0].hyperlink.CG&&
!(v[0].cpBegin>this.fr.cpBegin&&v[0].cpEnd<=this.fr.cpEnd)){this.UKo(b,h,v[0].hyperlink,!ta,Q,D);return}if(Q)for(let ob=0;ob<v.length;ob++)v[ob].hyperlink.CG&&(ba=!0),this.hyperlinkEditor.HR(this.fr.node,v[ob].hyperlink,!1);ta?this.characterPropertiesEditor.replaceTextRange(this.fr,b,!ba):Ta&&!ba&&this.lj.zob(this.fr,1);v=Pe.a.createTextRange(this.fr.node,this.fr.cpBegin,this.fr.cpBegin+b.length);this.hyperlinkEditor.hG(v,h,Q,ba,!0,D);Q=Mg.SelectionFactory.ue(this.fr.node,this.fr.cpBegin+b.length)}else 0<
v.length&&(b=v[0],b.hyperlink.CG&&(ba=!0),this.hyperlinkEditor.HR(b.paragraph,b.hyperlink));ba&&this.Ld.Ls(ba?2:7);Q&&this.ie.lb.setSelection(Q);Ya.App.pMo()}Oam(b,h){h=h.items;const v=b.substring(G.a.Tdb.length),D=this.bookmarkManager.Kci(v);b=-1;let Q=0;for(let ba=0;ba<h.length;ba++)if(h[ba].isHeading&&0!=D.count&&h[ba].paragraphNode.id==D.J(0).id){b=ba;break}else if(!h[ba].isHeading&&h[ba].linkurl==v){b=ba;Q=1;break}h=new CB(b,Q);return-1!=b?h:null}JXl(){const b={};let h=[],v=0,D=0;var Q=this.Qpl.lYl();
Q&&(v=Q.count,h=h.concat(this.qYl(Q)));if(Q=this.bookmarkManager.wNd(!1))D=Q.count,h=h.concat(this.mNl(Q));b.groups=this.dYl(v,D);b.items=h;return b}dYl(b,h){const v=[],D=new zA("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);v.push(D);b=new zA("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);v.push(b);return v}qYl(b){const h=[],v=/\uFFFC/;for(const D of b)b=D.characterData.replace(v," "),b=new Ev(b,!0,D.begin,D.end,D.paragraphNode),h.push(b);
return h}mNl(b){const h=[];for(const v of b)b=v.Hf(lc.a.rt).toString(),b=new BB(b,!1),h.push(b);return h}}Object(n.a)(DB,"ReactInsertLinkDialog",null,[]);class kf{static get Xf(){return xi.a.instance}static get fX(){return null!=kf.Mwg?kf.Mwg:kf.Mwg=Ga.a.instance.Na("Box4.IContentControlChpHelper")}static get L_(){return null!=kf.IAg?kf.IAg:kf.IAg=Ga.a.instance.resolve("Box4.IHyperlinkStrategy")}static Zw(){return kf.Tm||(kf.Tm=Ga.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Ld(){return null!=
kf.qIg?kf.qIg:kf.qIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Fh(){return null!=kf.xIg?kf.xIg:kf.xIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Wg(){return io.ContextSetEditor.instance}static get Ic(){return Ye.a.instance}static get mZc(){null==kf.Yqb&&(kf.Yqb=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return kf.Yqb}static get Dta(){null==kf.l$&&(kf.l$=
w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return kf.l$}static get hyperlinkEditor(){return null!=kf.EAg?kf.EAg:kf.EAg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=kf.zwg?kf.zwg:kf.zwg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get h3a(){kf.IFe||(kf.IFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost"):
!1);return kf.IFe}static get xIo(){kf.oih||(kf.oih=w.AFrameworkApplication.K?w.AFrameworkApplication.K.mc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return kf.oih}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.insertHyperlink,Zb.a.view,kf.dGb);b.qa(Eb.a.insertHyperlink,Zb.a.Tc,kf.insertLink);b.qa(Eb.a.insertHyperlink,Zb.a.Hd,kf.insertLink);b.Vc(Eb.a.insertHyperlink,1028);b.qa(Eb.a.f5b,Zb.a.view,kf.dGb);b.qa(Eb.a.f5b,Zb.a.Tc,kf.insertLink);b.qa(Eb.a.f5b,Zb.a.Hd,kf.insertLink);
b.Vc(Eb.a.f5b,1028);b.qa(Eb.a.HR,Zb.a.view,kf.dGb);b.qa(Eb.a.HR,Zb.a.Tc,kf.l$i);b.qa(Eb.a.HR,Zb.a.Hd,kf.l$i);b.Vc(Eb.a.HR,1028);b.qa(Eb.a.dfe,Zb.a.view,kf.dGb);b.qa(Eb.a.dfe,Zb.a.Tc,kf.vhj);b.qa(Eb.a.dfe,Zb.a.Hd,kf.vhj);b.qa(Eb.a.K4a,Zb.a.view,kf.dGb);b.qa(Eb.a.K4a,Zb.a.Tc,kf.yYi);b.qa(Eb.a.K4a,Zb.a.Hd,kf.yYi);b.qa(Eb.a.K4a,Zb.a.image,kf.BWf);b.qa(Eb.a.K4a,Zb.a.iDb,kf.BWf);b.qa(Eb.a.K4a,Zb.a.anchoredObject,kf.BWf);b.qa(Eb.a.rGc,Zb.a.application,kf.rGc);b.qa(Eb.a.VFd,Zb.a.view,kf.dGb);kf.h3a&&(b.fb(Ua.a.s5a,
Zb.a.view,this.dGb.bind(this),1028),b.qa(Ua.a.s5a,Zb.a.Tc,this.s5a.bind(this)),b.qa(Ua.a.s5a,Zb.a.Hd,this.s5a.bind(this)),b.Vc(Ua.a.s5a,1028),b.qa(Ua.a.oAf,Zb.a.Tc,this.s5a.bind(this)),b.qa(Ua.a.oAf,Zb.a.Hd,this.s5a.bind(this)),b.Vc(Ua.a.oAf,1028),b.qa(Ua.a.FZf,Zb.a.view,this.FZf.bind(this)),b.qa(Ua.a.zZf,Zb.a.view,this.zZf.bind(this)),b.fb(Ua.a.Xib,Zb.a.Tc,this.Xib.bind(this),1028),b.fb(Ua.a.Xib,Zb.a.Hd,this.Xib.bind(this),1028))}static rGc(){return 32}static s5a(b,h,v){if(!kf.h3a)return 2;b=kf.NIj(h);
if(32!=b)return b;if(!kf.xQa(h,!0).returnValue||kf.e3b(h))return 8;1!==v||kf.x_h||(kf.Gne(!0),kf.x_h=!0);return 32}static FZf(b,h,v,D,Q){if(!kf.h3a)return 2;if(1===v)return 32;kf.nce(kf.Kek,kf.Lek,kf.Fbh);wr.a.instance.he(()=>{kf.Gne();Q.MenuItems=Object.assign(new Yd.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ba=this.kMh();ba?(u.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),Q.MenuItems.MenuSectionList.push(ba)):kf.q1i(Q,kf.Fbh)},"HA:PRLF");
return 32}static zZf(b,h,v,D,Q){if(!kf.h3a)return 2;if(1===v)return 32;kf.nce(kf.Iek,kf.Jek,kf.Ebh);wr.a.instance.he(()=>{kf.Gne();Q.MenuItems=Object.assign(new Yd.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});Q.MenuItems.MenuSectionList.push(this.V$k());const ba=this.kMh(!0);ba?(u.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),Q.MenuItems.MenuSectionList.push(ba)):kf.q1i(Q,kf.Ebh)},"HA:PILF");return 32}static q1i(b,h){u.ULS.sendTraceTag(524911777,
324,50,"Recent Links could not load in "+h);kf.nce(kf.lbk,kf.mbk,h);b.MenuItems.MenuSectionList.push(this.vcl());kf.Gne(!0)}static vcl(){const b=this.Waf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new fg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static V$k(){const b=this.Waf("InsertLinkSection");b.ControlList.push(Object.assign(new fg.a,{ExternalId:"InsertLink"}));return b}static kMh(b=!1){if(Pk.instance.hsd){var h=
this.Waf("RecentLinksSection",b);b=JSON.parse(Pk.instance.hsd);this.gsd.clear();b.forEach((v,D)=>{this.gsd.set(D,[v.FileName,v.DocumentUrl]);const Q=kf.F9l(v.FileName);var ba=kf.fXl(v.TimeStamp),ta=h.ControlList,Ta=ta.push,ob=Object,Kb=ob.assign,Vb=new fg.a,bc=Ua.a.Xib,Dc=Ua.a.Xib;ba=Q!==v.FileName?v.FileName+"\n"+ba:ba;var Oc=v.FileName;let gd="SaveAsWordDocx_32";switch(v.App){case "Word":gd="SaveAsWordDocx_32";break;case "PowerPoint":gd="SaveAsPowerPointPptx_32";break;case "Excel":gd="SaveAsExcelXlsx_32"}Ta.call(ta,
Kb.call(ob,Vb,{ExternalId:D,Command:bc,CommandValueId:Dc,LabelText:Q,Alt:ba,AriaDescription:Oc,ExternalImageId:gd,KeyTip:v.FileName}))});return h}}static Waf(b,h=!1){return Object.assign(new $g.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Xib(b,h,v,D,Q){if(!kf.h3a)return 2;if(!Q||Q.CommandValueId!=Ua.a.Xib)return 32;kf.nce(kf.D6j,kf.E6j,kf.Yfk);v=h;h=new ah.GraphTransaction(15);h.fk=b;h.Cb(v.node);
D=kf.xQa(v,!0).hyperlink;v=We.SelectionEditor.nQb(v);if(D)kf.m5f(v),b=Mg.SelectionFactory.LK(v.node,Math.min(v.cpBegin,D.cpBegin),Math.max(v.cpEnd,D.cpEnd)),Th.a.instance.setSelection(b),v=b.Oa;else if(We.SelectionEditor.gf(v)){var ba;We.SelectionEditor.ckb(v)&&(ba=We.SelectionEditor.F3(v,!1));ba||(ba=this.gsd.get(Q.SourceControlId)[0],kf.characterPropertiesEditor.replaceTextRange(v,ba,!0,void 0,b),ba=Mg.SelectionFactory.LK(v.node,v.cpBegin,v.cpBegin+ba.length));if(ba&&(Th.a.instance.setSelection(ba),
v=ba.Oa,kf.e3b(v)))return kf.Ld.VOb(!1),8}try{kf.hyperlinkEditor.hG(v,this.gsd.get(Q.SourceControlId)[1],0<ue.HyperlinkReader.pPc(v).length);const ta=Mg.SelectionFactory.ue(v.node,v.cpEnd);ta&&Th.a.instance.setSelection(ta);l(Q,"RecentLinks")}finally{h&&h.dispose()}u.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static dGb(b,h,v,D,Q){if(kf.mZc)return kf.Atm(b,h,v,D,Q);if(!h.view.qe)return 2;var ba=h.view.lb;if(!ba||!ba.gb||!ba.gb.length)return 8;var ta=ba.gb.kb;let Ta=ta.Oa.clone();
if(2===ta.length){if(ta=ta.J(1),!We.SelectionEditor.ml(Ta)||!We.SelectionEditor.Gk(ta)||Ta.node!==ta.node)return 8}else if(2<ta.length)return 8;if(ba.gb.vJ)return 8;if(kf.Wg.qza(de.ParagraphReader.oU,ba.tg))return kf.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),8;de.ParagraphReader.lm(Ta)&&!We.SelectionEditor.G8(Ta)&&(ba=Ta.node,Ta=Pe.a.createTextRange(ba,0,de.ParagraphReader.textLength(ba)));return b===Eb.a.VFd?kf.iJh(h,Ta,v,D):w.AFrameworkApplication.va.Of(Ta,b,v,!0,D,Q)}static Atm(b,h,v,D,Q){if(!h.view.qe)return 2;
var ba=h.view.lb;if(!ba||!ba.gb||!ba.gb.length||ba.gb.vJ)return 8;var ta=ba.gb.kb;if(ba=kf.VFf(ta))ta=kf.Huf(ta.Oa.clone(),!0);else{let Ta=ta.J(0).clone(),ob=1;for(;ob<ta.length&&(!de.ParagraphReader.textLength(Ta.node)||We.SelectionEditor.Gk(Ta)||kf.Dta&&Ba.l(Ta));)Ta=ta.J(ob).clone(),ob++;ta=kf.Huf(Ta,!1)}return kf.Dta&&We.SelectionEditor.ml(ta)&&Ba.l(ta)||!We.SelectionEditor.ml(ta)&&!ba?8:b===Eb.a.VFd?kf.iJh(h,ta,v,D):w.AFrameworkApplication.va.Of(ta,b,v,!0,D,Q)}static VFf(b){if(1===b.length)return!0;
if(2===b.length){const h=b.Oa.clone();b=b.J(1);return We.SelectionEditor.ml(h)&&We.SelectionEditor.Gk(b)&&h.node===b.node?!0:!1}return!1}static BGh(b){let h=null;const v=[];for(let D=0;D<b.length;D++){const Q=kf.Huf(b.J(D).clone(),!1);if(We.SelectionEditor.ml(Q))kf.Dta&&Ba.l(Q)||v.push(Q);else if(!We.SelectionEditor.Gk(Q)&&!de.ParagraphReader.lm(Q))return{returnValue:!1,Teb:h}}h=v;return{returnValue:!kf.Dta||0<h.length?!0:!1,Teb:h}}static insertLink(b,h,v,D,Q){if(kf.mZc)return kf.aBm(h,v,Q);D=kf.NIj(h);
if(32!==D)return D;let ba;if(!({hyperlink:ba}=kf.xQa(h,!0)).returnValue||kf.e3b(h)||!ba&&b==Eb.a.f5b)return 8;if(1===v)return 32;if(!ba&&We.SelectionEditor.gf(h)&&We.SelectionEditor.ckb(h)&&(b=We.SelectionEditor.F3(h,!1))&&(Th.a.instance.setSelection(b),h=b.Oa,kf.e3b(h)))return kf.Ld.VOb(!1),8;ba&&u.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,Q);return 32}static NIj(b){return!kf.w5e()||!kf.oCd(b)||b.node.ur||Th.a.instance.gb.vJ?8:We.SelectionEditor.g4(b)||sj.a.gDf(b)?2:32}static aBm(b,h,v){var D=
Th.a.instance.gb.kb;const Q=kf.VFf(D);if(Q)b=[b];else if(!({Teb:b}=kf.BGh(D)).returnValue)return 8;if(!kf.w5e())return 8;for(D=0;D<b.length;D++)if(!kf.oCd(b[D]))return 8;if(Th.a.instance.gb.vJ)return 8;D=Array(b.length);let ba=null;for(let ta=0;ta<b.length;ta++)if(D[ta]=b[ta],!({hyperlink:ba}=kf.xQa(D[ta],!0)).returnValue||kf.e3b(D[ta]))return 8;if(1===h)return 32;if(!ba&&1===D.length&&Q&&We.SelectionEditor.gf(D[0])&&We.SelectionEditor.ckb(D[0])&&(h=We.SelectionEditor.F3(D[0],!1))&&(Th.a.instance.setSelection(h),
D[0]=h.Oa,kf.e3b(D[0])))return kf.Ld.VOb(!1),8;Q?a(D[0],v):new Oo(D,v);return 32}static l$i(b,h,v){if(kf.mZc)return kf.rZn(b,h,v);if(!kf.oCd(h)||We.SelectionEditor.g4(h))return 2;let D;if(!({hyperlink:D}=kf.xQa(h,!1)).returnValue)return 2;if(2===v){v=new ah.GraphTransaction(15);try{v.fk=b,v.Cb(D.paragraph),kf.m5f(h)}finally{v&&v.dispose()}D.hyperlink.CG&&kf.Ld.Ls(2)}return 32}static rZn(b,h,v){var D=Th.a.instance.gb.kb;if(kf.VFf(D))h=[h];else if(!({Teb:h}=kf.BGh(D)).returnValue)return 8;if(!kf.w5e())return 8;
for(D=0;D<h.length;D++)if(!kf.oCd(h[D]))return 8;if(1===v&&!kf.xQa(h[0],!1).returnValue)return 2;if(2===v){for(v=0;v<h.length;v++)if(!kf.xQa(h[v],!0).returnValue)return 2;v=new ah.GraphTransaction(15);try{const Q=h[0];v.fk=b;v.Cb(Q.node);for(b=0;b<h.length;b++)kf.m5f(h[b])}finally{v&&v.dispose()}kf.Ld.Ls(7)}return 32}static m5f(b){const h=ue.HyperlinkReader.pPc(b);let v=0;for(let D=0;D<h.length;D++)if(h[D].cpBegin>=v){const Q=({cpEnd:v}=kf.L_.Iga(b,h[D])).returnValue;kf.L_.b$i(b,Q)}}static vhj(b,
h,v){if(ke.ImageReader.y2a(h)||!({hyperlink:b}=kf.xQa(h,!1)).returnValue)return 2;if(2===v){const {cpBegin:D,cpEnd:Q}=kf.L_.Iga(h,b);Th.a.instance.setSelection(Mg.SelectionFactory.LK(b.paragraph,D,Q))}return 32}static yYi(b,h,v){if(({hyperlink:b}=kf.VTm(h)).returnValue)u.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=kf.xQa(h,!1)).returnValue)return 2;2===v&&Ya.App.Jgb(b.hyperlink.url);return 32}static BWf(b,h,v){b=ke.ImageReader.Iga(h.node);
if(!b)return 2;2===v&&Ya.App.Jgb(b);return 32}static iJh(b,h,v,D){if(ke.ImageReader.y2a(h)||!Ob.InteractiveViewManager.instance.editingView.Sj)return 2;let Q;if(!({hyperlink:Q}=kf.xQa(h,!1)).returnValue)return 2;if(1===v)return 32;const {cpBegin:ba,cpEnd:ta}=kf.L_.Iga(h,Q);Th.a.instance.setSelection(Mg.SelectionFactory.LK(Q.paragraph,ba,ta));h=Ob.InteractiveViewManager.instance.PCa.ownerDocument.createElement("span");h.innerText=Q.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return w.AFrameworkApplication.va.Of(b,
Eb.a.UFd,2,!0,D,h)}static xQa(b,h){if(We.SelectionEditor.ml(b)){const v=Ba.g(b),D=am.a.all(v,Q=>6===Q.Bh);if(0<v.length&&(!kf.Dta||!D)||kf.Xf.gh&&kf.fX&&0<kf.fX.lOd(b).count)return{returnValue:!1,hyperlink:null}}return kf.KTm(b,h)}static VTm(b){let h=null;return ke.ImageReader.y2a(b)&&(h=ue.HyperlinkReader.E7b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static KTm(b,h){let v=null;const D=ue.HyperlinkReader.pPc(b);return D.length?D[0].hyperlink?(v=D[0],b.cpBegin<D[0].cpBegin?{returnValue:h,
hyperlink:v}:{returnValue:!0,hyperlink:v}):{returnValue:!1,hyperlink:v}:{returnValue:h,hyperlink:v}}static e3b(b){if(jr.a.instance.J(1)){b=kf.Fh.fPa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Jd.changeType)return!0}return!1}static w5e(){return jr.a.instance.J(1)?!0:!jr.a.instance.J(1)||!Ya.App.Bv.jQb}static oCd(b){return kf.Xf.j_(b)||kf.Xf.nha(b)||kf.Zw()&&kf.Zw().instance&&kf.Zw().instance.tU(b)?!1:!0}static Huf(b,h){return de.ParagraphReader.lm(b)&&!We.SelectionEditor.G8(b)&&
(de.ParagraphReader.textLength(b.node)||h)?Pe.a.createTextRange(b.node,0,de.ParagraphReader.textLength(b.node)):b}static F9l(b){return b&&b.length<=kf.D6i?b:b.substring(0,kf.D6i)+"..."}static fXl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static Gne(b=!1){const h=Date.now();if(b||h-kf.fEi>kf.xIo)Pk.instance.R8m(),kf.fEi=h}static nce(b,
h,v){const D=new Map;D.set("Source",v);D.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.TVa,D)}}kf.Tm=null;kf.Yqb=null;kf.l$=null;kf.gsd=new Map;kf.IFe=null;kf.D6i=35;kf.fEi=Date.now();kf.x_h=!1;kf.TVa="wwaengidc";kf.Yfk="RecentLinks";kf.Fbh="RecentLinksRibbonOptions";kf.Ebh="RecentLinksContextMenuOptions";kf.Kek="PopulateRecentLinksRibbon";kf.Lek="PopulateRecentLinksRibbonAction";kf.Iek="PopulateRecentLinksContextMenu";kf.Jek="PopulateRecentLinksContextMenuAction";kf.lbk="PopulateRecentLinksContextMenu";
kf.mbk="PopulateRecentLinksContextMenuAction";kf.D6j="InsertRecentLinks";kf.E6j="InsertRecentLinksAction";Object(n.a)(kf,"HyperlinkActor",null,[]);class fx{}fx.tkb=Object.freeze({Pvm:"WordIndentationShortcutUsage"});fx.sB="wwaengidc";Object(n.a)(fx,"IndentationConstants",null,[]);class Cm{static get gq(){return yt.a.NEb}static get Wg(){return io.ContextSetEditor.instance}static get Xf(){return xi.a.instance}static get Ic(){return Ye.a.instance}static get yo(){return Ob.InteractiveViewManager.instance}static Zw(){return Cm.Tm||
(Cm.Tm=Ga.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Ovm(){return null!=Cm.PAg?Cm.PAg:Cm.PAg=Ga.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.JG,Zb.a.view,Cm.rEc);b.qa(Eb.a.JG,Zb.a.outlineElement,Cm.Jth);b.Vc(Eb.a.JG,1036);b.qa(Eb.a.qO,Zb.a.view,Cm.rEc);b.qa(Eb.a.qO,Zb.a.outlineElement,Cm.Jth);b.Vc(Eb.a.qO,1036)}static TQn(b){const h=new Map;b=b?b.ia(nh.a.wpi,"Unknown"):"tab";h.set("actionCallSource",b);wa.Health.instance.recordKpiUsage(fx.tkb.Pvm,
1,fx.sB,h)}static rEc(b,h,v,D,Q){const ba=h.view;if(!ba.qe)return 2;var ta=ba.lb;if(!ta)return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.zca}),8;ta=ta.tg;if(!ta)return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.noSelection}),8;if(sj.a.kha(h))return 8;if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Cm.Xf.V$b(ta))return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.RE}),8;if(1===v)return 32;if(Cm.Wg.$Ca(Cm.r0e,ta))return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.lHc}),8;if(Cm.Wg.qza(de.ParagraphReader.oU,
ta))return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),8;if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Cm.Xf.V$b(ta))return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.RE}),8;if(Cm.Zw()&&Cm.Zw().instance&&Cm.Zw().instance.tU(ta))return Cm.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.externalSelection}),8;ta={};ta[Pr.a.QIa]=5794;ta[Pr.a.PIa]=5795;return Cm.Ovm.rEc(ba,b,h,v,D,Q,ta)}static Jth(b,h,v,D,Q){var ba,ta;if(h.contextId!==Zb.a.outlineElement)return 2;var Ta=h.clone().nfg();
if(rh.TableReader.MBi(Ta)){if(Cm.Xf.NBi(Ta))return Cm.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),8}else if(Cm.Xf.i3a(Ta))return Cm.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),2;Ta=new ne.GraphIterator;Ta.set(h.node);We.SelectionEditor.mu(Ta);if(!Cd.OutlineElementReader.Dh(Ta))return 2;let ob;switch(b){case Eb.a.JG:ob=Cm.gq.jAb(Ta);break;case Eb.a.qO:ob=Cm.gq.Z1b(Ta);break;default:return 2}if(1===v||!ob)return ob?32:8;v=0;b===Eb.a.qO&&Q&&Q.ia(wc.a.yvh,!1)&&(v|=2);if(Cd.OutlineElementReader.wQ(Ta))return Cm.Ic.Yb(Oe.a.hn,
{["Reason"]:Fe.a.hO}),2;(null===(ta=null===(ba=Cm.yo)||void 0===ba?void 0:ba.Bd)||void 0===ta?0:ta.uU)&&Cm.yo.editingView&&(Cm.yo.editingView.cI=!0);switch(b){case Eb.a.JG:Cm.gq.XRa(Ta,-1,v);break;case Eb.a.qO:Cm.gq.iJc(Ta,1)}D&&js.a.Epb&&(D.ns|=js.a.khb(h.node,!0));Cm.TQn(Q);return 32}}Cm.Tm=null;Cm.r0e=ke.ImageReader.x2a;Object(n.a)(Cm,"IndentationActor",null,[]);var Cg=c(1574);class wk{static get paragraphEditor(){return null!=wk.WEg?wk.WEg:wk.WEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get vk(){return null!=
wk.iHg?wk.iHg:wk.iHg=Ga.a.instance.resolve("Box4.ITableEditor")}static get Xf(){return xi.a.instance}static get Ic(){return Ye.a.instance}static Zw(){return wk.Tm||(wk.Tm=Ga.a.instance.Sa("Box4.IExternalSelectionManager"))}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.Txj,Zb.a.view,(h,v)=>sj.a.kha(v)?8:32);b.qa(Eb.a.leftJustify,Zb.a.view,Cg.a.dw);b.qa(Eb.a.leftJustify,Zb.a.paragraph,wk.lCa);b.qa(Eb.a.leftJustify,Zb.a.table,wk.w1e);b.Vc(Eb.a.leftJustify,1036);b.qa(Eb.a.centerJustify,Zb.a.view,
Cg.a.dw);b.qa(Eb.a.centerJustify,Zb.a.paragraph,wk.lCa);b.qa(Eb.a.centerJustify,Zb.a.table,wk.w1e);b.Vc(Eb.a.centerJustify,1036);b.qa(Eb.a.rightJustify,Zb.a.view,Cg.a.dw);b.qa(Eb.a.rightJustify,Zb.a.paragraph,wk.lCa);b.qa(Eb.a.rightJustify,Zb.a.table,wk.w1e);b.Vc(Eb.a.rightJustify,1036);b.qa(Eb.a.fullJustify,Zb.a.view,Cg.a.dw);b.qa(Eb.a.fullJustify,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.fullJustify,1036);b.qa(Eb.a.LJc,Zb.a.view,Cg.a.dw);b.qa(Eb.a.LJc,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.LJc,1036);b.qa(Eb.a.oIb,
Zb.a.view,Cg.a.dw);b.qa(Eb.a.oIb,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.oIb,1036);b.qa(Eb.a.p7c,Zb.a.view,Cg.a.dw);b.qa(Eb.a.p7c,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.p7c,1036);b.qa(Eb.a.Ecc,Zb.a.view,Cg.a.dw);b.qa(Eb.a.Ecc,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.Ecc,1036);b.qa(Eb.a.p2b,Zb.a.view,Cg.a.dw);b.qa(Eb.a.p2b,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.p2b,1036);b.qa(Eb.a.Ehc,Zb.a.view,Cg.a.dw);b.qa(Eb.a.Ehc,Zb.a.paragraph,wk.lCa);b.Vc(Eb.a.Ehc,1036);b.qa(Eb.a.H6b,Zb.a.view,Cg.a.dw);b.qa(Eb.a.H6b,Zb.a.paragraph,wk.lCa);
b.Vc(Eb.a.H6b,1036)}static w1e(b,h,v,D){let Q=!0;if(!h)return 8;rh.TableReader.MBi(h)?wk.Xf.NBi(h)?(wk.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),Q=!1):wk.Zw()&&wk.Zw().instance&&wk.Zw().instance.tU(h)&&(wk.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.externalSelection}),Q=!1):(wk.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.Nff}),Q=!1);if(1===v||!Q)return Q?32:8;h=h.node;switch(b){case Eb.a.leftJustify:wk.vk.gE(h,1);break;case Eb.a.centerJustify:wk.vk.gE(h,2);break;case Eb.a.rightJustify:wk.vk.gE(h,3)}D&&js.a.Epb&&(D.ns|=2);return 32}static lCa(b,
h,v,D,Q){let ba=!0;h.contextId!==Zb.a.paragraph?ba=!1:wk.Xf.i3a(h)?(wk.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),ba=!1):wk.Zw()&&wk.Zw().instance&&wk.Zw().instance.tU(h)&&(wk.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.externalSelection}),ba=!1);if(1===v||!ba)return ba?32:8;h=h.node;v=de.ParagraphReader.Ex(h);switch(b){case Eb.a.leftJustify:case Eb.a.Ecc:wk.paragraphEditor.gE(h,1===v&&wk.C_d(Q)?6:1);break;case Eb.a.centerJustify:case Eb.a.p2b:wk.paragraphEditor.gE(h,2===v&&wk.C_d(Q)?1:2);break;case Eb.a.rightJustify:case Eb.a.Ehc:wk.paragraphEditor.gE(h,
3===v&&wk.C_d(Q)?1:3);break;case Eb.a.fullJustify:case Eb.a.H6b:wk.paragraphEditor.gE(h,6===v&&wk.C_d(Q)?1:6);break;case Eb.a.oIb:wk.paragraphEditor.gE(h,11);break;case Eb.a.LJc:wk.paragraphEditor.gE(h,7);break;case Eb.a.p7c:wk.paragraphEditor.gE(h,13)}D&&js.a.Epb&&(D.ns|=js.a.khb(h));return 32}static C_d(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}wk.Tm=null;Object(n.a)(wk,"JustificationActor",null,[]);const kr=()=>{const b=w.AFrameworkApplication.va;
b.qa(Eb.a.save,Kd.a.frame,FB);b.qa(Eb.a.sync,Kd.a.frame,EB)},EB=(b,h,v)=>{if(1===v)return 32;w.AFrameworkApplication.va.processAction(Eb.a.lAb,2);Ya.App.Tj.vke();return 32},FB=(b,h,v)=>{if(1===v)return 2===Ya.App.xa.mode?32:8;w.AFrameworkApplication.va.processAction(Eb.a.lAb,2);if(2!==Ya.App.xa.mode)return 32;Ya.App.Tj.Tfj(null,null);return 32};class Ku{constructor(){this.activateRibbonTab=(b,h,v,D,Q)=>{Ya.App.Bv.NI.kee(Q.toString());return 32};this.BXm=(b,h,v,D,Q)=>{w.AFrameworkApplication.Zoa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");
Ya.App.Bv.NI.xDi(1,Q.toString());return 32};this.gun=(b,h)=>{if(h.contextId!==Kd.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.activateRibbonTab,Zb.a.view,this.activateRibbonTab);b.Vc(Eb.a.activateRibbonTab,5);b.qa(Eb.a.yDi,Zb.a.view,this.BXm);b.qa(Eb.a.xjg,Kd.a.frame,this.gun)}static get instance(){return null!=Ku.qBg?Ku.qBg:Ku.qBg=Ku.Rl()}static Rl(){return new Ku}}Object(n.a)(Ku,"RibbonActor",null,[]);var Dt=c(560);class Lu{constructor(b,
h){this.Jm=null;this.IPo=(v,D,Q,ba,ta)=>{let Ta;ba=D.view;if(!ba.qe)return Lu.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.SJb}),8;Ta=v===Eb.a.undo?this.Pg.LX:this.Pg.sPa;if(1===Q)return sj.a.kha(D)&&sj.a.kac()?8:Ta?32:8;if(!Ta)return u.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",v===Eb.a.undo?"undo":"redo"),this.xJa.value.$Cj(),Lu.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.DPo}),2;D=new ah.GraphTransaction(3);D.Cb(ba.Yc);D.Jfe();v=v===Eb.a.undo?this.Pg.undo():this.Pg.redo();D.dispose();ta&&
hs.GrippersManager.instance.OQb(ta.Ix);if(v)return 32;Lu.Ic.Yb(Oe.a.O4b,{["Reason"]:Fe.a.oQi});return 8};this.Cla=b;this.xJa=h}get Pg(){return this.Jm||(this.Jm=this.Cla())}Tb(){const b=w.AFrameworkApplication.va,h=this.IPo;b.fb(Eb.a.undo,Zb.a.view,h,1028);b.fb(Eb.a.redo,Zb.a.view,h,1028)}static get instance(){return null!=Lu.aBg?Lu.aBg:Lu.aBg=Lu.Rl()}static Rl(){const b=Ga.a.instance;return new Lu(()=>b.resolve("Box4.IUndoManager"),b.Ue("Box4.ICoauthCashTelemetry"))}static get Ic(){return Ye.a.instance}}
Object(n.a)(Lu,"UndoActor",null,[]);class zz{constructor(){this.W=null}get name(){return"Box4.Actors"}xc(b){this.W=b;(new Lx).xc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Kx.a.UUc&&this.W.resolve("Box4.Actors.PageColorActor").Tb();b.Tb();b.W4();AC();Rs.instance.Tb();kf.Tb();Cm.Tb();wk.Tb();this.W.resolve("Box4.Actors.TouchInputActor").Tb();gu.instance.Tb();this.W.resolve("Box4.ISelectAllHandlers").Tb();kr();this.W.resolve("Box4.Actors.ProofingActor").Tb();Ku.instance.Tb();(b=this.W.Na("Box4.IFeatureHelper"))?
b.Lp.continueWith(()=>{this.K8i()}):this.K8i();Dt.a.Tb(Ya.App.MTa);this.W.resolve("Box4.Actors.TextFormattingActor").Tb();Lu.instance.Tb();this.W.resolve("Box4.Actors.AccessibilityActor").P3f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Ya.App.xa.updateCommandUI()}K8i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Tb();this.W.resolve("Box4.Actors.StyleActor").Tb()}dispose(){}static main(){N.a.instance.Fc(new zz)}}Object(n.a)(zz,"Box4ActorsPackage",
null,[1,2]);class CC extends Yk{constructor(b,h,v,D){super(b);this.dna=v;this.X5a=D;this.wpg=0;this.UA=h.YQa("UserAction","WordOnlineAddToDictionary")}fcg(b){this.zKd=this.dna.yna(b);if(!this.IUk())return!1;const h=this.zKd.errorDetails.token;this.X5a.fph(h);if(!this.X5a.Y9c(h))return u.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;u.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.UA.start();
this.transaction=new ah.GraphTransaction(15);this.transaction.Cb(b.node);return!0}$$d(b){this.LLb(b.node);return!0}V1c(b){this.LLb(b);return!0}aae(b){this.LLb(b.node)}cig(b){this.transaction.dispose();this.zKd.errorDetails.Spb(b.actionId);this.X5a.X8f("unused corelation id.");this.UA.stop();u.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.wpg,this.UA.ti,this.zKd.errorDetails.proofingType));return!0}Zjc(b,
h){const v=b.role;return super.Zjc(b,h)||9===v||10===v||13===v||7===v||8===v}LLb(b){if(b){var h=this.dna.Q3(b,v=>this.X5a.Y9c(v.errorDetails.token));this.dna.xnb(b,h,!0);this.wpg+=h.length}}IUk(){var b,h;return null!==(h=null===(b=this.zKd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(u.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(n.a)(CC,"AddToDictionaryCallbackSteps",Yk,[]);class Az{constructor(b,h,v,D,Q,
ba,ta){this.oc=b;this.lb=h;this.O0=v;this.dna=D;this.Eq=Q;this.X5a=ba;this.$In=ta;this.Xkm=(Ta,ob,Kb,Vb,bc,Dc)=>{const Oc=new CC(this.O0,this.Eq,this.dna,this.X5a);return new Mo(Ta,ob,Kb,Vb,bc,Dc,Oc,this.oc,this.lb,this.O0,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Tb(){this.oc.fT(Eb.a.addToDictionary,Zb.a.view,this.Xkm,1124);this.$In.AWn(this.X5a)}}Object(n.a)(Az,"PersonalDictionaryOrchestrator",null,[]);class Et{get name(){return"Box4.PersonalDictionary"}xc(b){this.container=b;b.register(Az,
"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Rd(()=>new Az(w.AFrameworkApplication.va,Th.a.instance,Lo.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Tb()}dispose(){}static main(){rj.a.get_instance().xk(7,()=>{N.a.instance.Fc(new Et)})}}
Object(n.a)(Et,"PersonalDictionaryPackage",null,[1,2]);class ys{constructor(b,h,v,D,Q,ba){this.LAa=this.x9a=this.GV=null;this.RFc=(ta,Ta,ob,Kb,Vb)=>this.cBi(Ta,ob,Vb,!1)?32:8;this.yH=(ta,Ta,ob,Kb,Vb)=>{if(!({gy:ta}=this.lpj(Ta,ob,Vb,!0)).returnValue)return ta;u.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Vb=this.Mlk.iua(Ta.node,Vb);this.mBn(Ta.node,Vb);this.HP();return 32};this.zAb=(ta,Ta,ob,Kb,Vb)=>{if(!({gy:ta}=this.lpj(Ta,ob,Vb,!1)).returnValue)return ta;
this.iBn(Ta.node);return 32};this.gKn=(ta,Ta,ob,Kb,Vb)=>{if(1===ob)return 32;if(!Ta||!Ta.view.qe)return 2;ta=Ta.view.lb;if(!ta)return 2;ta=ta.tg;if(!ta)return 2;ta=ys.Wg.NQ(ta,16);if(!ta||!ta.length)return 2;Ta=null;for(ob=0;ob<ta.length;ob++){Kb=ta.getContext(ob);if(!Kb||Kb.contextId!==Zb.a.tableCell)return 2;const bc={};this.ili(Kb,bc);if(bc.CellShading)if(Ta&&Ta!==bc.CellShading){Ta=null;break}else Ta=bc.CellShading;else{Ta=null;break}}Vb.CellShading=Ta;return 32};this.WLb=(ta,Ta,ob,Kb,Vb)=>1===
ob?32:this.ili(Ta,Vb);this.rLb=(ta,Ta,ob,Kb,Vb)=>{if(1===ob)return 32;ta=Ta.contextId===Zb.a.view?this.eBa.JQd(Ta):this.ssf(Ta);ob={};Ta=null;32===w.AFrameworkApplication.va.Qb(Eb.a.WLb,2,ob)&&ob&&(Ta=ob.CellShading);ob="";Ta&&(ob=Sl.a.VE(Ta)||"");this.ioj.KNb=ob;this.tVc&&this.recentColors.Kne(ob);ta=this.ioj.EMc(ta,Ya.App.FAb);if(!ta)return 8;Vb.MenuItems=ta;u.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.bia=(ta,Ta,ob,Kb,Vb)=>{if(1===ob)return 32;Ya.App.xa.Xw();
w.AFrameworkApplication.va.Qb(Eb.a.WLb,2,Vb);this.x9a=new Mx.a("Shading",Eb.a.Eic);this.x9a.zjc(Vb&&Vb.CellShading?Vb.CellShading:0);return 32};this.DTk=(ta,Ta,ob,Kb,Vb)=>{if(1===ob)return 32;w.AFrameworkApplication.va.Qb(Eb.a.L9,2,Vb);this.recentColors.UYa(Vb)||u.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.Mlk=h;this.IJe=v;this.eBa=D;this.Sd=Q;this.qq=ba}get recentColors(){return null!=this.EFg?this.EFg:this.EFg=Ga.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get ioj(){this.GV||
(this.GV=new yz.a("Shading"),this.TEa(this.GV));return this.GV}TEa(b){b.OW(2,Eb.a.zAb);b.OW(3,Eb.a.L9);b.OW(4,Eb.a.L9);b.bzb(this.IJe,1)}Tb(){this.ga.qa(Eb.a.rLb,Zb.a.view,this.rLb);this.ga.qa(Eb.a.rLb,Zb.a.tableCell,this.rLb);this.ga.Vc(Eb.a.rLb,1126);this.ga.qa(Eb.a.RFc,Zb.a.view,Dt.a.JMc);this.ga.qa(Eb.a.RFc,Zb.a.tableCell,this.RFc);this.ga.Vc(Eb.a.RFc,1028);this.ga.qa(Eb.a.L9,Zb.a.view,Dt.a.JMc);this.ga.qa(Eb.a.L9,Zb.a.tableCell,this.yH);this.ga.Vc(Eb.a.L9,1028);this.ga.qa(Eb.a.zAb,Zb.a.view,
Dt.a.JMc);this.ga.qa(Eb.a.zAb,Zb.a.tableCell,this.zAb);this.ga.Vc(Eb.a.zAb,1028);this.ga.qa(Eb.a.WLb,Zb.a.view,this.gKn);this.ga.qa(Eb.a.WLb,Zb.a.tableCell,this.WLb);this.ga.Vc(Eb.a.WLb,1124);this.ga.qa(Eb.a.Eic,Zb.a.view,Dt.a.JMc);this.ga.qa(Eb.a.Eic,Zb.a.tableCell,this.DTk);this.ga.Vc(Eb.a.Eic,1028);this.ga.qa(Eb.a.EWf,Zb.a.view,this.bia);this.ga.Vc(Eb.a.EWf,1028)}HP(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=
Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}lpj(b,h,v,D){return this.cBi(b,h,v,D)?{returnValue:2===h,gy:32}:(2==h&&Dt.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Fe.a.azl),{returnValue:!1,gy:8})}cBi(b,h,v,D){return b.contextId!==Zb.a.tableCell||2===h&&(D&&!v||!b.node)?!1:!0}mBn(b,h){const v=new ah.GraphTransaction(15);v.Cb(b);this.Rmj(b);b.properties.setValue(Gd.a.yH,
h);v.dispose()}iBn(b){const h=new ah.GraphTransaction(15);h.Cb(b);this.Rmj(b);b.properties.removeProperty(Gd.a.yH);h.dispose()}ssf(b){return b.contextId!==Zb.a.tableCell?null:(b=ys.vh.Xs(b.node))?b:null}Rmj(b){if(this.Sd&&this.Sd.rg&&(b=Object(Ka.a)(oz.TableCellNode,b))){const h=b.FR();this.qq.n7c(b,h)}}ili(b,h){if(b.contextId!==Zb.a.tableCell)return 8;(b=b.node)&&b.hasProperty(Gd.a.yH)&&(h.CellShading=b.getValue(Gd.a.yH));return 32}static COl(){return new ys(w.AFrameworkApplication.va,Zh.a.instance,
bw.a.instance,bi.PageReader.instance,Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get vh(){return Rl.PageNavigator.instance}static get Wg(){return null!=ys.kxg?ys.kxg:ys.kxg=io.ContextSetEditor.instance}static get instance(){return null!=ys.vCg?ys.vCg:ys.vCg=ys.COl()}get tVc(){null==this.LAa&&(w.AFrameworkApplication.te("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.LAa=
w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.LAa}}Object(n.a)(ys,"CellShadingActor",null,[]);class yw{constructor(){this.W=null}get name(){return"Box4.CellShading"}xc(b){this.W=b}init(){const b=this.W.Na("Box4.IFeatureHelper");b?b.Lp.continueWith(()=>{this.jn()}):this.jn()}jn(){ys.instance.Tb();Ya.App.xa.updateCommandUI()}dispose(){}}Object(n.a)(yw,"CellShadingPackage",null,[1,2]);var Qr;
(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Qr||(Qr={}));Object(n.b)("ListStyle",Qr);const GB={[Qr.style1]:{[1]:"disc",[0]:"decimal"},[Qr.style2]:{[1]:"circle",[0]:"lower-alpha"},[Qr.style3]:{[1]:"square",[0]:"lower-roman"},[Qr.style4]:{[0]:"upper-alpha"},[Qr.style5]:{[0]:"upper-roman"},[Qr.bullet]:{[1]:"bullet"}};var zq;(function(b){b[b.number=
0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(zq||(zq={}));Object(n.b)("ListType",zq);var hu=c(1613);class Aq{constructor(b,h){this.KB=this.oXc=null;this.levelText=b;this.font=h}get Q$d(){return this.levelText}get listStyle(){return 6}get rw(){return"left"}}Object(n.a)(Aq,"ListMarkerBullet",null,[396]);class zi{static get Un(){return null!=zi.qDg?zi.qDg:zi.qDg=Ga.a.instance.resolve("Box4.List.IListEditor")}static get Gd(){return zi.If||
(zi.If=Ga.a.instance.resolve("Box4.List.IListReader"))}static set Gd(b){zi.If=b}static get rj(){return null!=zi.UAg?zi.UAg:zi.UAg=Ga.a.instance.resolve("Box4.IInsertionPointFormatting")}static Zw(){return zi.Tm||(zi.Tm=Ga.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Wg(){return io.ContextSetEditor.instance}static get Xf(){return xi.a.instance}static get Ic(){return Ye.a.instance}static get Vn(){return Tl.a.getInstance()}static get B8c(){return null!=zi.lGg?zi.lGg:zi.lGg=Ga.a.instance.Na("Box4.List.ISingleLevelListEditor")}static Tb(){const b=
w.AFrameworkApplication.va;b.qa(Eb.a.kD,Zb.a.view,zi.mEc);b.qa(Eb.a.kD,Zb.a.outlineElement,zi.Sla);b.Vc(Eb.a.kD,1036);b.qa(Eb.a.uL,Zb.a.view,zi.mEc);b.qa(Eb.a.uL,Zb.a.outlineElement,zi.Sla);b.Vc(Eb.a.uL,1036);b.qa(Eb.a.yca,Zb.a.view,zi.mEc);b.qa(Eb.a.yca,Zb.a.outlineElement,zi.Sla);b.Vc(Eb.a.yca,1036);b.qa(Eb.a.i1e,Zb.a.view,Rc.ActionManager.Pf);b.qa(Eb.a.MDh,Zb.a.view,Rc.ActionManager.Pf);b.qa(Eb.a.joinList,Zb.a.view,zi.x4n);b.qa(Eb.a.S0e,Zb.a.view,Rc.ActionManager.Pf);b.qa(Eb.a.j1e,Zb.a.view,Rc.ActionManager.Pf);
b.qa(Eb.a.fhg,Zb.a.view,Rc.ActionManager.Pf);b.qa(Eb.a.Cwj,Zb.a.view,Rc.ActionManager.Pf);b.qa(Eb.a.Kme,Zb.a.view,Rc.ActionManager.Pf)}static x4n(){hu.a.adj();return 32}static mEc(b,h,v,D,Q){var ba,ta,Ta;if(!h.view.qe)return 2;const ob=zi.Ic.Ap(Eb.a.mEc);D.ns=42;D.xC=42;const Kb={[Pr.a.QIa]:5796,[Pr.a.PIa]:5797};var Vb=h.view;if(zi.Wg.$Ca(zi.kum,Vb.lb.tg))return zi.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.r9e}),ob.end(),8;if(zi.Wg.$Ca(zi.r0e,Vb.lb.tg))return zi.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.lHc}),ob.end(),
8;if(zi.Wg.qza(de.ParagraphReader.oU,Vb.lb.tg))return zi.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),ob.end(),8;if(zi.Xf.V$b(Vb.lb.tg))return zi.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.RE}),ob.end(),8;if(null===(ta=null===(ba=zi.Zw())||void 0===ba?void 0:ba.instance)||void 0===ta?0:ta.tU(h))return zi.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.externalSelection}),ob.end(),8;if(1===v)return ob.end(),32;Q||(Q=new fh.DictionaryPropertySet);ba=null;if(2===v){ba=new ah.GraphTransaction(15);ba.Cb(h.view.Yc);zi.VVc=!1;ta=vz.OutlineElementGeneralizer.qna(Vb.lb.gb,
!1);if(!ta)return ba.dispose(),zi.Ic.Yb(Oe.a.gna,{["Reason"]:Fe.a.hLd}),ob.end(),8;1<ta.length&&Q.setValue(wc.a.oPi,null);const bc=Q.ia(wc.a.zJ,-1),Dc=Q.ia(wc.a.GA,-1);null===(Ta=zi.B8c)||void 0===Ta?void 0:Ta.cWk(ta);if(Ta=zi.Rpo(bc,Dc,ta))Q.setValue(wc.a.GA,16),Q.setValue(wc.a.KQa,0);if(!We.SelectionEditor.gf(Vb.lb.tg)&&!Ta&&0<ta.length&&bc){Vb=new ne.GraphIterator;Ta=Array(ta.length);for(let Oc=0;Oc<ta.length;Oc++)Vb.set(ta.getContext(Oc).node),Ta[Oc]=zi.Gd.lw(Vb);zi.Qpo(Ta,Q)&&(Vb=new fh.DictionaryPropertySet,
Vb.setValue(wc.a.GA,16),Vb.setValue(wc.a.KQa,0),Tl.a.eY&&(Vb.setValue(nh.a.Xoa,"clean-list-before-apply-new-list-style"),Vb.setValue(nh.a.Aha,Q.ia(nh.a.Xoa,"unknown")+"@"+Q.ia(nh.a.Aha,"undefined"))),Pr.a.Bpa(b,h,v,D,Vb,Kb,11),w.AFrameworkApplication.va.processAction(Eb.a.Cwj,2),u.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),zi.VVc=!0)}Vb=new ne.GraphIterator;Vb.set(ta.getContext(0).node);Vb=zi.Gd.lw(Vb);zi.w3m(bc,Dc,Vb,ta.length)}b=Pr.a.Bpa(b,h,v,D,Q,Kb,11);
32===b&&Q.ia(wc.a.yvh,!1)&&(b=Pr.a.Bpa(Eb.a.qO,h,v,D,Q,Kb,11));ba&&ba.dispose();ob.end();return b}static Qpo(b,h){let v=null;var D=!1;for(let Q=b.length-1;0<=Q&&(v?(D=b[Q],D=-1!==h.ia(wc.a.zJ,-3)?D?v.listType!==D.listType||v.listStyle!==D.listStyle:!0:D?v.listType!==D.listType:!0):v=b[Q],!D);Q--);return v&&(b=!1,D||(b=h.ia(wc.a.GA,42),h=h.ia(wc.a.zJ,-3),b=b!==v.listType||0<h),D||b)?!0:!1}static w3m(b,h,v,D){0>=D||zi.VVc||(b?v?(v=v.listType,-1===b&&h===v?(w.AFrameworkApplication.va.processAction(Eb.a.Kme,
2),u.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(w.AFrameworkApplication.va.processAction(h?Eb.a.S0e:Eb.a.j1e,2),u.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(w.AFrameworkApplication.va.processAction(h?Eb.a.S0e:Eb.a.j1e,2),zi.qMo(),u.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(w.AFrameworkApplication.va.processAction(Eb.a.Kme,2),u.ULS.sendTraceTag(39715533,
393,50,"List Actions: Clean List Style - None list style")))}static Rpo(b,h,v){if(-1!==b&&b||!v.length)return!1;b=new ne.GraphIterator;let D=null;for(let Q=v.length-1;0<=Q&&!(b.set(v.getContext(Q).node),D=zi.Gd.lw(b));Q--);return D&&h===D.listType?!0:!1}static Sla(b,h,v,D,Q){var ba;if(h.contextId!==Zb.a.outlineElement)return 2;var ta=h.clone().nfg();if(zi.Xf.i3a(ta))return zi.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),2;const Ta=new ne.GraphIterator;Ta.set(h.node);We.SelectionEditor.mu(Ta);if(!Cd.OutlineElementReader.Dh(Ta))return 2;
if(1===v)switch(b){case Eb.a.kD:return 32;case Eb.a.uL:return 32;case Eb.a.yca:return 32;default:return 2}if(Cd.OutlineElementReader.wQ(Ta))return zi.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.hO}),2;h=zi.Gd.lw(Ta);var ob;Tl.a.eY&&(ob=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Kb=Q;if(!Kb)return 8;b===Eb.a.uL||b===Eb.a.kD||b===Eb.a.yca?(Kb=zi.Un.UKc(b,Kb),ta=bu.a.n_(Kb.getValue(wc.a.GA),Kb.getValue(wc.a.KQa))):ta=null;zi.i0(b,Kb);zi.sjo(ta,Kb);let Vb=!1;b===Eb.a.kD&&Kb&&(Kb.hasProperty(lc.a.lv)&&
(ta.levelText=Kb.ia(lc.a.lv,"")),Kb.hasProperty(Gd.a.font)&&(ta.font=Kb.ia(Gd.a.font,"")),Kb.hasProperty(wc.a.xlf)&&(Vb=Kb.ia(wc.a.xlf,!1)));zi.alo(Kb,Ta);ta=zi.Un.Sla(Kb,Ta,ta,Vb);if(!ta.returnValue)return zi.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.qJf}),2;ta=ta.owa;Tl.a.eY&&zi.ZQn(Q,ob,ta);2===v&&(v=Q.ia(wc.a.GA,-1),ta&&-1!==v&&((ob=Q.ia(lc.a.Sr,"Invalid MultiLevel Type"),b===Eb.a.uL&&u.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===Q||void 0===
Q?void 0:Q.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:Qr[null==(null===h||void 0===h?void 0:h.listStyle)?null===ta||void 0===ta?void 0:ta.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:zq[null==(null===h||void 0===h?void 0:h.listType)?null===ta||void 0===ta?void 0:ta.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===ta||void 0===ta?void 0:ta.listType)})),h)?ta.listType&&1!==ta.listType||zi.VVc||(w.AFrameworkApplication.va.processAction(Eb.a.fhg,
2),u.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",v?"Bullet":"Numbering",ob)):16===ta.listType?(w.AFrameworkApplication.va.processAction(Eb.a.MDh,2),u.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",v?"Bullet":"Numbering",ob)):ta.listType&&1!==ta.listType||zi.VVc||(w.AFrameworkApplication.va.processAction(Eb.a.i1e,2),u.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",v?"Bullet":"Numbering",ob))),(b=$c.FocusManager.instance())&&
b.currentScope&&b.currentScope.name===pc.AppFrame.aqa&&b.dD(gf.AFrame.Pn));D.ns=ta.listType;D.xC=ta.listStyle;(null===(ba=w.AFrameworkApplication.K)||void 0===ba?0:ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("List");return 32}static ZQn(b,h,v){var D,Q,ba,ta,Ta,ob,Kb,Vb;const bc=new Map;bc.set("actionCallSource",b.ia(nh.a.Xoa,"unknown"));bc.set("actionCallSourceTrigger",b.ia(nh.a.Aha,"undefined"));bc.set("fromListType",zq[null!==(D=null===h||
void 0===h?void 0:h.listType)&&void 0!==D?D:16]);bc.set("fromListStyle",Qr[null!==(Q=null===h||void 0===h?void 0:h.listStyle)&&void 0!==Q?Q:0]);bc.set("fromListMarkerType",null!==(Ta=k(null!==(ba=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ba?ba:0,null!==(ta=null===h||void 0===h?void 0:h.listType)&&void 0!==ta?ta:16))&&void 0!==Ta?Ta:"undefined");bc.set("fromLevelText",(null===h||void 0===h?0:h.Tna)?h.levelText:"undefined");bc.set("toListType",null!==(ob=zq[null===v||void 0===v?void 0:v.listType])&&
void 0!==ob?ob:"undefined");bc.set("toListStyle",null!==(Kb=Qr[null===v||void 0===v?void 0:v.listStyle])&&void 0!==Kb?Kb:"undefined");bc.set("toListMarkerType",null!==(Vb=k(null===v||void 0===v?void 0:v.listStyle,null===v||void 0===v?void 0:v.listType))&&void 0!==Vb?Vb:"undefined");bc.set("toLevelText",(null===v||void 0===v?0:v.Tna)?v.levelText:"undefined");wa.Health.instance.recordKpiUsage(Uj.a.tkb.LZm,0,Uj.a.sB,bc)}static alo(b,h){var v=new ne.GraphIterator;v.Zc(h);(h=v.Sb(2))&&de.ParagraphReader.Vb(h)&&
(v=Th.a.instance.gb.kb)&&v.Oa&&v.Oa.node===h&&We.SelectionEditor.d_d(v)&&(zi.Gho(b),zi.Eho(b))}static sjo(b,h){h.hasProperty(lc.a.Sr)&&b.Hge(h.getValue(lc.a.Sr));h.hasProperty(nh.a.pQ)&&(b.pQ=h.getValue(nh.a.pQ));h.hasProperty(lc.a.lv)&&(b.levelText=h.getValue(lc.a.lv));b.zJ=h.ia(wc.a.zJ,-1);let v=null;b.Koa&&(v=zi.S0l(b,h));b.Koa&&v?zi.Wko(b,v):(b.Koa?u.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",
b.zJ,b.Sr,b.qz):u.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),zi.vgo(b))}static vgo(b){if(b.qz)b.GUd&&-1===b.zJ||(b.levelText="%1.",b.propertySet.hasProperty(Gd.a.B4)||b.O9(0,1));else if(1===b.listType)b.GUd&&-1===b.zJ||(b.font=Uj.a.VIc,b.levelText=Uj.a.GHd,b.propertySet.hasProperty(Gd.a.B4)||b.O9(1,6));else return;b.rw="left"}static Wko(b,h){1===b.Sr?zi.Mjo(b,h):zi.eio(b,h)}static Mjo(b,h){(b.KB=h.KB)?b.H5=h.KB.H5:h.KB||u.ULS.sendTraceTag(588022422,
393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.zJ,b.Sr,b.qz)}static eio(b,h){b.levelText=h.levelText;b.qz?b.O9(0,h.listStyle):(b.font=h.font,b.O9(1,1));b.rw=h.rw}static S0l(b,h){let v=null;2===b.Sr?v=b.qz?Ga.a.instance.Na("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ga.a.instance.Na("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Sr&&(v=Ga.a.instance.Na("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let D=v.OIb.value;
const Q=b.zJ+"";Q in D||(D=v.U8,u.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",Q,b.Sr,b.qz));if(!(Q in D)){u.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",Q,b.Sr,b.qz);if(h.hasProperty(Gd.a.font))return u.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
Q,b.Sr,b.qz),b=h.ia(Gd.a.font,""),new Aq(G.a.fromCharCode(parseInt(Q)),b);u.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",Q,b.Sr,b.qz)}return D[Q]}static Eho(b){zi.rj.hasProperty(Gd.a.fontColor)&&b.setValue(Gd.a.fontColor,zi.rj.fontColor())}static Gho(b){zi.rj.hasProperty(Gd.a.fontSize)&&b.setValue(Gd.a.fontSize,zi.rj.fontSize())}static i0(b,h){b=b===Eb.a.kD?0:b===Eb.a.uL?1:b===Eb.a.yca?2:-1;h=h.ia(wc.a.zJ,-1);u.ULS.sendTraceTag(22923024,
324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static qMo(){const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");if(b){var h=w.AFrameworkApplication.K.mc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(v=>{window.setTimeout(()=>{v.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else u.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}zi.kum=ke.ImageReader.oUc;zi.r0e=ke.ImageReader.x2a;zi.If=null;
zi.Tm=null;zi.VVc=!1;Object(n.a)(zi,"ListActor",null,[]);class Ss{constructor(){this.OIb=new Fg.a(()=>this.Baf());this.U8={}}O2h(b){return b}}Object(n.a)(Ss,"AListMarkerGalleryLoader",null,[488]);var Mu=c(1382),Qq=c(439);class cp extends Ss{constructor(){super();this.dvb=new Sg.a(Pa.a.ai())}O2h(b){cp.qQ||this.ufo();b in cp.qQ&&(b=cp.qQ[b]);return b}Baf(){const b={};b["0"]=new Aq(Box4Intl.Box4Strings.L_ListStyleNone,Mu.a.Ksi);b["1"]=new Aq(String.fromCharCode(61623),"Symbol");b["2"]=new Aq(String.fromCharCode(111),
"Courier New");b["3"]=new Aq(String.fromCharCode(61607),"Wingdings");b["4"]=new Aq(String.fromCharCode(9643),"Courier New");b["5"]=new Aq(String.fromCharCode(61611),"Wingdings");b["6"]=new Aq(String.fromCharCode(61614),"Symbol");b["7"]=new Aq(String.fromCharCode(61483),"Symbol");b["8"]=new Aq(String.fromCharCode(61485),"Symbol");b["9"]=new Aq(String.fromCharCode(9830),"Courier New");b["10"]=new Aq(String.fromCharCode(61664),"Symbol");b["11"]=new Aq(String.fromCharCode(61558),"Wingdings");b["12"]=
new Aq(String.fromCharCode(61656),"Wingdings");b["13"]=new Aq(String.fromCharCode(61514),"Wingdings");b["14"]=new Aq(String.fromCharCode(61516),"Wingdings");b["15"]=new Aq(String.fromCharCode(61692),"Wingdings");b["16"]=new Aq(String.fromCharCode(61691),"Wingdings");b["17"]=new Aq(String.fromCharCode(61553),"Wingdings");return b}wne(b){b&&b.length&&this.A4e(b)}c_f(){if(this.U8){var b=Qq.a(this.U8),h=b.length;for(let v=0;v<h;v++){const D=this.U8[b[v]];this.dvb.add(D.levelText+"_"+D.font)}}}A4e(b){this.c_f();
for(const h of b)if(h&&!h.qz&&h.Tna&&h.BQc&&(b=h.levelText+"_"+h.font,!this.dvb.contains(b))){const v=Qq.a(this.U8).length+Qq.a(this.OIb.value).length+"";this.U8[v]=new Aq(h.levelText,h.font);this.dvb.add(b)}}ufo(){cp.qQ={};cp.qQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;cp.qQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;cp.qQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;cp.qQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;cp.qQ["Wingdings 0x00ab"]=
Box4Intl.Box4Strings.L_Star;cp.qQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;cp.qQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;cp.qQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;cp.qQ["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;cp.qQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;cp.qQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;cp.qQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;cp.qQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;
cp.qQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;cp.qQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;cp.qQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;cp.qQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}cp.qQ=null;Object(n.a)(cp,"ListMarkerBulletLoader",Ss,[]);class Bq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(n.a)(Bq,"InfoAtLevel",null,[]);class Rq{constructor(b){this.KB=b}get font(){return"Calibri"}get listStyle(){return 42}get rw(){return"left"}get Q$d(){return this.KB?
this.eGn():this.gGn()}get oXc(){return this.KB?this.fGn():null}get levelText(){return""}hWl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}eGn(){let b="";for(let h=0;3>h;h++)b+=this.cPc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Rq.Oof(),b)}fGn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new Bq,{textAtLevel:this.Kdi(h),styleAtLevel:this.Xcm(h)}));return b}gGn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Rq.Pof(),Box4Intl.Box4Strings.L_ListStyleNone)}Kdi(b){b=this.KB.pXc[b];for(let h=0;9>h;h++)b=G.a.replaceAll(b,"%"+(h+1),this.hWl(this.KB.RIb[h]));return b}Xcm(b){const h={};h.fontFamily=6===this.KB.RIb[b]?this.KB.XDa[b]:this.font;return h}cPc(b){const h=this.Kdi(b),v=new Sys.StringBuilder;6===this.KB.RIb[b]&&v.append(String.format("font-family:{0};",this.KB.XDa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,v.toString(),h)}static Oof(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Pof(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Rq,"ListMarkerMultilevel",null,[396]);var Nu=c(1394);class Zx extends Ss{constructor(){super()}Baf(){const b=new Nu.a,h={};h["0"]=new Rq(null);h["1"]=new Rq(b.W$e());h["2"]=new Rq(b.Oaf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Rq(b.cKh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}wne(){}}Object(n.a)(Zx,"ListMarkerMultilevelLoader",Ss,[]);var rp=c(136);class Sq{constructor(b,h){this.KB=null;this.levelText=b;this.Tnd=h}get font(){return"Calibri"}get listStyle(){return this.Tnd}get rw(){switch(this.Tnd){case 3:case 5:return"right";default:return"left"}}get Q$d(){switch(this.Tnd){case 1:return this.dgc("1",
"2","3");case 2:return this.dgc("a","b","c");case 3:return this.dgc("i","ii","iii");case 4:return this.dgc("A","B","C");case 5:return this.dgc("I","II","III");case 0:return this.hGn();default:return this.dgc("1","2","3")}}get oXc(){const b=[],h={};h.fontFamily=rp.FontUtils.dDa(this.font);switch(this.Tnd){case 1:return b.push(Object.assign(new Bq,{textAtLevel:this.FX("1"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("2"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new Bq,{textAtLevel:this.FX("a"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("b"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new Bq,{textAtLevel:this.FX("i"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("ii"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new Bq,
{textAtLevel:this.FX("A"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("B"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new Bq,{textAtLevel:this.FX("I"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("II"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new Bq,{textAtLevel:this.FX("1"),
styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("2"),styleAtLevel:h})),b.push(Object.assign(new Bq,{textAtLevel:this.FX("3"),styleAtLevel:h})),b}}dgc(b,h,v){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Sq.Oof(),this.cPc(b),this.cPc(h),this.cPc(v))}hGn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Sq.Pof(),Box4Intl.Box4Strings.L_ListStyleNone)}cPc(b){b=this.FX(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}FX(b){return G.a.replaceAll(this.levelText,"%1",b)}static Oof(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Pof(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Sq,"ListMarkerNumbering",null,[396]);class Fv extends Ss{constructor(){super();this.dvb=new Sg.a(Pa.a.ai())}DRm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Baf(){const b=
{};b["0"]=new Sq(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Sq("%1.",5);b["2"]=new Sq("%1.",4);b["3"]=new Sq("%1.",1);b["4"]=new Sq("%1.",2);b["5"]=new Sq("%1.",3);b["6"]=new Sq("%1)",5);b["7"]=new Sq("%1)",4);b["8"]=new Sq("%1)",1);b["9"]=new Sq("%1)",2);b["10"]=new Sq("%1)",3);b["11"]=new Sq("(%1)",5);b["12"]=new Sq("(%1)",4);b["13"]=new Sq("(%1)",1);b["14"]=new Sq("(%1)",2);b["15"]=new Sq("(%1)",3);return b}wne(b){b&&b.length&&this.A4e(b)}c_f(){if(this.U8){var b=Qq.a(this.U8),h=b.length;
for(let v=0;v<h;v++){const D=this.U8[b[v]];this.dvb.add(D.levelText+"_"+D.listStyle)}}}A4e(b){this.c_f();for(const h of b)if(h&&h.qz&&h.Tna&&this.DRm(h.levelText)&&h.listStyle&&(b=Mu.a.jmf(h.levelText))){const v=b+"_"+h.listStyle;if(!this.dvb.contains(v)){const D=Qq.a(this.U8).length+Qq.a(this.OIb.value).length+"";this.U8[D]=new Sq(b,h.listStyle)}this.dvb.add(v)}}}Object(n.a)(Fv,"ListMarkerNumberingLoader",Ss,[]);class Ft{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){zi.Tb()}dispose(){}xc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new cp).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Fv).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new Zx).singleInstance()}static main(){N.a.instance.Fc(new Ft)}}Object(n.a)(Ft,"Box4ListMarkerPackage",null,[1,2]);class Bz{static get Xg(){return Vf.a.qA(Bz.Lm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}Bz.Lm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(n.a)(Bz,"DefineNewBulletDialogHtml",null,[]);class gq extends Vf.a{constructor(b,h,v,D){super();this.qwc=this.JIe=this.BWb=this.uWb=null;this.Lvb=0;this.IEc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.eqi=!0;this.Zhl=Q=>{if(this.uWb&&Q.target!==this.uWb){const ba=this.focusManager.Ss();ba&&ba.Zj&&(ba.Zj.Iy(Q.target),this.uWb=Q.target)}this.Qsn(Q.target.id)};this.vZm=Q=>{Q=Q.zf;if(!this.RCi(Q))return!1;this.focusManager.Ss().Zj.Iy(Q);Q.focus();return!0};this.wZm=Q=>{var ba=
Q.zf;if(!this.RCi(ba))return!1;var ta=ba.id;ta=parseInt(ta.substr(ta.lastIndexOf("_")+1))-this.Lvb;if(Q.Gb.ctrlKey||Q.Gb.altKey||Q.Gb.keyCode>=zf.a.MRb&&Q.Gb.keyCode<=zf.a.NRb)return!1;const Ta=Q.Gb.keyCode;if(Q.eventName===Sc.a.fi){Q=-1;if(Ta===Sys.UI.Key.enter)return this.focusManager.Ss().Zj.Iy(ba),ba.focus(),this.vUi(ba.id),this.hide(),!0;Ta===Sys.UI.Key.up?Q=ta-17:Ta===Sys.UI.Key.down?Q=ta+17:Ta===Sys.UI.Key.left?Q=w.AFrameworkApplication.isRtl?ta+1:ta-1:Ta===Sys.UI.Key.right&&(Q=w.AFrameworkApplication.isRtl?
ta-1:ta+1);0<=Q&&(ba=this.vai(gq.s4b+"_"+(Q+this.Lvb)))&&ba.focus()}return!0};this.Yhl=Q=>{1===Q&&this.vUi(this.BWb);this.hide()};this.ru=b;this.focusManager=h;this.ga=v;this.sS=!1;D&&(b=D.indexOf(","),-1!==b&&(D=D.substring(0,b)));this.fontName=D;this.wg="DefineNewBulletDialog";this.Xg=Bz.Xg;this.Ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ee(0,CommonUIStrings.l_DialogClose);this.Yh(Box4Intl.Box4Strings.L_SymbolSingle,this.Yhl,null);this.L$=!1;this.RGa();document.getElementById(gq.FMd).focus()}RGa(){this.focusManager.Ss().scope.ir($c.FocusManager.instance().vW);
this.focusManager.Ss().scope.ir($c.FocusManager.instance().wW);this.focusManager.Ss().scope.bindAction($c.FocusManager.instance().vW,Eb.a.SHd);this.focusManager.Ss().scope.bindAction($c.FocusManager.instance().wW,Eb.a.RHd)}f9(){this.OBd(gq.FMd,"DefineNewBulletFontPlaceholder",Eb.a.QHd.toString(),Eb.a.$Lb.toString(),Eb.a.u1c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.xMk()}tL(){super.tL();document.getElementById(this.kj("WACDialogPanel")).style.width="auto"}OBd(b,h,v,D,Q,ba,ta){v=bm.c(b,
v,!0,!0,D,Q,G.a.Af(ba),!0,ta);this.tGd(b,h,v,"Medium")}xMk(){const b=document.getElementById(gq.s4b);b&&(b.innerHTML=this.c7h(),this.v8i(b))}v8i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)lf.a.addHandler(b[h],Sc.a.focus,this.Zhl)}fUo(){var b=document.getElementById(gq.s4b);if(b){let h=this.fontName;const v=Mu.a.wBf(this.fontName);v&&61472!==this.Lvb||!v&&32!==this.Lvb?(b.innerHTML=this.c7h(),this.v8i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.qoh(h),b[0].style.fontFamily=h)}}Qsn(b){this.Alj(this.BWb,!1);this.BWb=b;this.Alj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.BWb){let h=parseInt(this.BWb.substr(this.BWb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.Lvb?61440:0,b.innerText=G.a.XI(h,4))}}Alj(b,h){(b=this.vai(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}vai(b){const h=document.getElementById(gq.s4b);return h?h.querySelector("#"+b):null}Zla(){const b=document.getElementById(gq.s4b);
b&&(this.JIe||(this.JIe=this.vZm,this.Lq.mb(Sc.a.click,b,this.JIe)),this.qwc||(this.qwc=this.wZm,this.ae.mb(Sc.a.fi,b,this.qwc),this.ae.mb(Sc.a.eu,b,this.qwc),this.ae.mb(Sc.a.uh,b,this.qwc)));super.Zla()}RCi(b){return b.classList.contains("DefineNewBulletTableCell")}vUi(b){if(b){b=b.split("_");const h=new fh.DictionaryPropertySet;h.setValue(wc.a.zJ,parseInt(b[1]));h.setValue(Gd.a.font,this.fontName);h.setValue(wc.a.GA,1);Tl.a.eY&&(h.setValue(nh.a.Xoa,"command-ui"),h.setValue(nh.a.Aha,"define-new-bullet-dialog"));
this.ga.Qb(Eb.a.kD,2,h)}this.focusManager.nL(this.TK,!0)}c7h(){const b=new Sys.StringBuilder,h=Mu.a.wBf(this.fontName);let v=this.fontName;v=this.qoh(v);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',v));h?(this.Lvb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Lvb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}qoh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}tGd(b,h,v,D){h=document.getElementById(h);this.ru.QYa(b,v);v=this.ru.$Db(b,D);h.appendChild(v);this.ru.Gpa(b)}dispose(){this.sS||(this.ru.CY(gq.FMd),this.sS=!0);super.dispose()}}gq.FMd="DefineNewBulletFontStyleComboBox";gq.s4b="DefineNewBulletTableContainer";Object(n.a)(gq,"DefineNewBulletDialog",Vf.a,[]);class Cz{zOc(){return Eb.a.rZm}bPc(){return Eb.a.AZf}}Object(n.a)(Cz,"ListMarkerGalleryBulletCommands",
null,[397]);class AA{zOc(){return Eb.a.tZm}bPc(){return Eb.a.nDn}}Object(n.a)(AA,"ListMarkerGalleryMultilevelCommands",null,[397]);class BA{zOc(){return Eb.a.uZm}bPc(){return Eb.a.BZf}}Object(n.a)(BA,"ListMarkerGalleryNumberingCommands",null,[397]);class gx{constructor(b,h,v,D,Q){this.hAa=this.cLa=null;this.rPh=ba=>{if(!this.hAa)return 2;if(this.hAa.focusManager.Ss().Zj.u3.id.startsWith(gq.s4b)){let ta=null;ba===Eb.a.SHd?ta=this.hAa.vZa:ba===Eb.a.RHd&&(ta=document.getElementById(gq.FMd));if(!ta)return 2;
this.hAa.focusManager.Ss().Zj.Iy(ta);ta.focus()}else if(ba===Eb.a.SHd)this.hAa.focusManager.Ss().Kdc();else if(ba===Eb.a.RHd)this.hAa.focusManager.Ss().Idc();else return 2;return 32};this.HFi=(ba,ta)=>{ba=null;ta.view.qe&&(ba=ta.view);return ba&&ba.lb?32:(Lc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ta.toString()),8)};this.jXm=(ba,ta,Ta)=>{var ob;return 1===Ta?32:2===Ta?((null===(ob=w.AFrameworkApplication.K)||
void 0===ob?0:ob.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("ListDefine"),ba=this.u8b(ta),ba=Hn.FormattingReader.Kr(ba).cache.rG,this.hAa=new gq(this.akk,$c.FocusManager.instance(),w.AFrameworkApplication.va,ba),32):8};this.u1c=(ba,ta,Ta,ob,Kb)=>{if(1===Ta)return 32;if(2===Ta&&!Kb)return 8;if(this.hAa.eqi){for(ba=0;ba<Mu.a.IEc.length;ba++)rp.FontUtils.yCj(Mu.a.IEc[ba]);this.hAa.eqi=!1}Ao.a.hWd(ta);Kb.PopulationXML=rp.FontUtils.t2h(Ao.a.Vhe,Ao.a.Llf,
Eb.a.QHd);return 32};this.mDn=(ba,ta,Ta,ob,Kb)=>{ba=ta.contextId===Zb.a.outlineElement;if(1===Ta||!ba)return ba?32:8;if(2===Ta&&!Kb)return 8;Kb.MenuItems=this.s$j.W0l();return 32};this.Xhl=(ba,ta,Ta,ob,Kb)=>{if(1===Ta)return 32;if(2===Ta){ba=Object(Ka.a)(28,Kb);if(!ba||!ba.xd)return 8;this.hAa.fontName=ba.xd.fontName;this.hAa.fUo();return 32}return 8};this.ga=b;this.If=D.resolve("Box4.List.IListReader");this.H6=h;this.akk=v;switch(this.H6){case 0:b=D.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");
this.cLa=new Cz;break;case 1:b=D.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.cLa=new BA;break;case 2:b=D.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.cLa=new AA;break;default:b=D.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.cLa=new Cz}Q=this.If?this.If.J0l(Q):null;b.wne(Q);this.s$j=new Mu.a(h,b,Q,!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.PHb)}Tb(){this.ga.qa(this.cLa.bPc(),Zb.a.view,Ya.App.MTa.xKh(11));this.ga.qa(this.cLa.bPc(),
Zb.a.outlineElement,this.mDn);this.ga.Vc(this.cLa.bPc(),1124);this.H6||(this.ga.fb(Eb.a.sIf,Zb.a.view,this.jXm,1028),this.ga.fb(Eb.a.u1c,Zb.a.view,this.u1c,1124),this.ga.fb(Eb.a.QHd,Zb.a.view,this.Xhl,1028),this.ga.fb(Eb.a.SHd,Kd.a.frame,this.rPh,64),this.ga.fb(Eb.a.RHd,Kd.a.frame,this.rPh,64));this.ga.qa(this.cLa.zOc(),Zb.a.view,this.HFi);this.ga.qa(this.cLa.zOc(),Zb.a.outlineElement,this.HFi);this.ga.Vc(this.cLa.zOc(),1124)}u8b(b){return this.WNd(b).Oa}WNd(b){let h=null;b=b.view;return b?h=We.SelectionEditor.xj(b.lb.gb.J(0),
!1,!1):h}}Object(n.a)(gx,"ListMarkerGalleryActor",null,[338]);class Jy{constructor(){this.Fe=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Ob.InteractiveViewManager.instance){var b=Ob.InteractiveViewManager.instance;b.editingView&&(this.Fe=b.editingView.Yc,this.rVn())}}dispose(){}xc(b){this.W=b}rVn(){(new gx(w.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").jda,this.W,this.Fe)).Tb();(new gx(w.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").jda,
this.W,this.Fe)).Tb();(new gx(w.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").jda,this.W,this.Fe)).Tb()}static main(){N.a.instance.Fc(new Jy)}}Object(n.a)(Jy,"Box4ListMarkerGalleryPackage",null,[1,2]);var $x=c(425),Gv=c(486),Ky=c(447),Rr=c(125);const iu=b=>{b.element.style.top=""};var zs=c(705);class Ly{constructor(b,h,v){this.tH=!1;this.Y9a=0;this.Zda=this.L9g=null;this.ul=b;this.dlk=h;this.nt=v;this.z6=b.ownerDocument.createElement("div");this.htmlElement.className=
"WACBusinessBar";(this.Jw=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.xJ)&&!this.nt.cff&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";aa.a.jj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.z6}get visible(){return this.tH}set_visible(b){if(this.tH!==b)return(this.tH=b)?this.m2e():this.mJc(),b}dispose(){this.visible&&this.mJc();jc.a.f_(this.htmlElement);this.ul=this.z6=null}crj(b,h){const v=
b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(v):this.htmlElement.insertBefore(v,this.htmlElement.childNodes[h]);b.pdj();this.Y9a+=b.htmlElement.clientHeight;var D=this.htmlElement.childNodes,Q=b.Drh,ba=Object(z.a)(this,this.Gjn,"onAfterShowEntry");Rr.WacAirSpace.aV(v,"Shared_BasicClass");var ta=new Ky.a(v);ta.Kta(0,1);const Ta=new Gv.a(v);Ta.iCa(v.clientTop-30,v.clientTop);Q?(Rr.WacAirSpace.qlb(ta,null,null),Rr.WacAirSpace.qlb(Ta,null,ba)):(Rr.WacAirSpace.animate(ta,
null,null),Rr.WacAirSpace.animate(Ta,null,ba));for(h+=1;h<D.length;h++)ba=D[h],Rr.WacAirSpace.aV(ba,"Shared_BasicClass"),ta=new Gv.a(ba),ta.iCa(ba.clientTop-v.clientHeight,ba.clientTop),Q?Rr.WacAirSpace.qlb(ta,null,null):Rr.WacAirSpace.animate(ta,null,null);b.Quo();this.set_visible(!0)}gni(b){const h=b.htmlElement;if(jc.a.Aac(h)){this.Y9a-=b.htmlElement.clientHeight;var v=h.parentNode.children;b=b.Drh;var D=Object(z.a)(this,this.zjn,"onAfterHideEntry");Rr.WacAirSpace.aV(h,"Shared_BasicClass");var Q=
new $x.a(h);Q.Kta(1,0);b?Rr.WacAirSpace.qlb(Q,null,D):Rr.WacAirSpace.animate(Q,null,D);D=!1;for(Q=0;Q<v.length;Q++){if(D){const ba=v[Q];Rr.WacAirSpace.aV(ba,"Shared_BasicClass");const ta=new Gv.a(ba);ta.iCa(ba.clientTop,-h.clientHeight);b?Rr.WacAirSpace.qlb(ta,null,iu):Rr.WacAirSpace.animate(ta,null,iu)}D||v[Q]!==h||(D=!0)}}}Gjn(b){b.element.style.top="";w.AFrameworkApplication.ta.OZc()}zjn(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);w.AFrameworkApplication.ta.OZc()}m2e(){""===
this.ul.style.top.trim()&&(this.ul.style.top=this.ul.offsetTop+"px");this.htmlElement.style.left=this.ul.style.left;this.htmlElement.style.top=this.ul.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.L9g=this.ul.style.top;this.Y9a=b.height;this.Mne();w.AFrameworkApplication.ta.VZ(Object(z.a)(this,this.onResize,"onResize"));lf.a.addHandler(this.htmlElement,Sc.a.gfe,lf.a.d2b);this.Zda=Object(z.a)(this,
this.bDa,"contextMenuHandler");w.AFrameworkApplication.ta.Uya.mb(this.htmlElement,this.Zda,null);if($c.FocusManager.$J()){var h=$c.FocusManager.instance();b=h.fe(zs.a.$Ma);b.parent=gf.AFrame.vp;const v=new Ie.DOMFocusListing(()=>this.htmlElement);v.Xm(1);v.Xm(2);v.Xm(8);h.ema(()=>this.htmlElement,b,v);h=h.getRegion(zs.a.$Ma);h.oSa();h.oR=!0;h.ZZa=!0;const D=w.AFrameworkApplication.ta.nx;b.RYa(()=>{D.Ww(zs.a.$Ma)});D.gT(zs.a.$Ma);(v.pga||w.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&D.FI(zs.a.$Ma)}}mJc(){this.Fqj()&&
(this.ul.style.top=this.L9g);this.htmlElement.style.visibility="hidden";w.AFrameworkApplication.ta&&($c.FocusManager.$J()&&$c.FocusManager.instance().E5a(zs.a.$Ma),this.Zda&&(w.AFrameworkApplication.ta.Uya.uc(this.htmlElement,this.Zda),this.Zda=null));lf.a.removeHandler(this.htmlElement,Sc.a.gfe,lf.a.d2b)}Mne(){if(this.Fqj()&&this.visible){var b=this.ul,h=this.Y9a+this.dlk;const v=jc.a.UM(b.style.top);Rr.WacAirSpace.aV(b,"Shared_BasicClass");b=new Gv.a(b);b.iCa(v,h);Rr.WacAirSpace.animate(b,null,
null)}}Fqj(){return!this.Jw&&!this.nt.cff}onResize(){const b=this.nt.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let v;for(let D=0;D<b;++D)v=this.nt.entries[D],v.htmlElement&&v.pdj();this.Y9a=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.Y9a&&this.Mne()}bDa(){return!0}}Object(n.a)(Ly,"BusinessBarDom",null,[1434,10]);var Ou;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(Ou||(Ou={}));Object(n.b)("BusinessBarId",
Ou);class Ts{constructor(b,h=0,v=null,D=null){this.B1g=this.cSg=!1;this.UXb=null;this.ZA=[];this.OUa=D||new Ly(b,h,this);this.Vym(v)}Vym(b){if(b){this.UXb={};b=b.ranking;for(let h=0;h<b.length;h++)this.UXb[Ou[b[h]]]=h}}dispose(){this.OUa.dispose();Da.a.G8f(this.ZA);this.ZA=null}get htmlElement(){return this.OUa.htmlElement}get visible(){return this.OUa.visible}get cff(){return this.cSg}set cff(b){this.cSg=b}get nFf(){return this.B1g}set nFf(b){this.B1g=b}get entries(){return this.ZA}set entries(b){this.ZA=
b}cY(b){for(let h=0;h<this.ZA.length;h++)if(this.ZA[h].id===b)return!0;return!1}fA(b,h=!1,v=null,D=null,Q=null){b.hM=this;let ba=this.EZl(b.id);h&&!this.UXb&&(ba=0);ba<Ts.tJb&&(this.OUa.crj(b,ba),this.ZA.length>=Ts.tJb&&this.OUa.gni(this.ZA[Ts.tJb-1]),this.OUa.Mne());Array.insert(this.ZA,ba,b);u.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Ou[b.id],void 0===b.$Za||null===b.$Za?"":b.$Za);b.errorCode&&w.AFrameworkApplication.YM(b.errorCode,v,D,Q)}removeEntry(b){const h=
Array.indexOf(this.ZA,b);-1!==h&&h<Ts.tJb&&(this.ZA.length>Ts.tJb&&this.OUa.crj(this.ZA[Ts.tJb],Ts.tJb),this.OUa.gni(b),this.OUa.Mne());Array.remove(this.ZA,b);b.hM=null;b.dispose()}EZl(b){if(!this.UXb||0===b)return this.ZA.length;b=this.UXb[Ou[b]];if(void 0===b||null===b)return this.ZA.length;for(let h=0;h<this.ZA.length;h++)if(b<this.UXb[Ou[this.ZA[h].id]])return h;return this.ZA.length}}Ts.tJb=2;Object(n.a)(Ts,"BusinessBar",null,[1411,10,1412]);class HB{create(b,h,v){return new oi.a(b,h,v)}}Object(n.a)(HB,
"Factory",null,[1433]);class zw{static R2k(b,h){b.register(Ts,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Rd(()=>new Ts(h.value,0,b.Na("CommonUI.IBusinessBarRankProvider")));b.register(HB,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}Object(n.a)(zw,"CommonUIComponentConfiguration",null,[]);var My=c(1E3);class dv extends My.a{constructor(){super()}static get instance(){return dv._instance||dv.Qzf()}static Qzf(){dv._instance=
new dv;return dv._instance}}dv._instance=null;Object(n.a)(dv,"ReactRootManager",My.a,[589,431]);class ay extends fg.a{constructor(){super()}get ControlType(){return 3}}Object(n.a)(ay,"CompoundButtonProps",fg.a,[]);class xr{constructor(b,h,v,D,Q,ba,ta){this.oW=h;this.Lzc=b;this.R_g=h.wIm;this.YVb=h.lVc;this.nFe=ba;this.Gkd=D;this.Hkd=Q;this.Bkd=v;this.mK=ta;this.jab=new Oh.a;this.jab.Z(1,"SpellingIssue_16x16x32");this.jab.Z(2,"GrammarIssue_16x16x32");this.jab.Z(3,"WritingIssue_16x16x32");this.jab.Z(4,
null);this.jab.Z(0,null)}create(b,h,v){h=Object(Ka.a)(nq.a,h);if(!h)return u.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const D=new Sys.StringBuilder;b=this.V$h(b);this.tIc(D,h,v,b);this.waf(D,h);this.lcl(D,h,b);return D.toString()}efb(b,h,v){const D=Object(Ka.a)(nq.a,h);if(!D)return u.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.V$h(b);this.gbf(h,D,v,b);this.xaf(h,D);this.mcl(h,D,b);for(v=0;v<h.length;v++)h[v].Id=`${eu.iUh}_${v}`;
return h}tIc(b,h,v,D=null){h.errorType?1===h.errorType&&(this.H5b(h)||b.append(this.w4e(h,v,D))):b.append(this.Lzc.build())}gbf(b,h,v,D=null){h.errorType?1===h.errorType&&(this.H5b(h)||b.push(this.uMk(h,v,D))):b.push(this.Lzc.fyh())}waf(b,h){const v=new Sys.StringBuilder;this.Xrj(h)?v.append(bm.a("btnIgnoreAllSpellingError",(2===h.errorType?Eb.a.zIa:Eb.a.Yna).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.H5b(h)||v.append(bm.a("btnIgrnoreSpellingError",this.Q9h(h.errorType).toString(),
Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.csj(h)&&(this.oW.Evi&&v.append(bm.a("btnDoNotCheckForThisIssue",Eb.a.fCb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),v.append(bm.a("btnGrammarOptions",Eb.a.smb.toString(),G.a.Af(Box4Intl.Box4Strings.l_GrammarOptions),null)));v.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(v.toString()),b.append("</Controls></MenuSection>"))}xaf(b,h){const v=Object.assign(new $g.a,
{ControlList:[]});if(this.Xrj(h)){var D=xs.AB()?Object.assign(new fg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Eb.a.Yna,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new fg.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});v.ControlList.push(D)}else this.H5b(h)||(D=Object.assign(new fg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.Q9h(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),v.ControlList.push(D));
this.csj(h)&&(this.oW.Evi&&(h=Object.assign(new fg.a,{ExternalId:"DoNotCheckForThisIssue"}),v.ControlList.push(h)),h=Object.assign(new fg.a,{ExternalId:"GrammerSettingsContext"}),v.ControlList.push(h));b.push(v)}V$h(b){if(!this.mK)return null;b=this.mK.language(this.mK.Kr(b.Oa));return lk.a.og(b)?lk.a.og(b).name:null}Q9h(b){return 2===b?Eb.a.zIa:this.oW.iLm?Eb.a.Xtm:Eb.a.gwa}lcl(b,h,v=null){if(this.Gcg(h)){var D=G.a.Af(h.ut.CategoryTitle);D=bm.m(eu.jgc,Ua.a.Pla,this.jab.J(h.proofingType),""!==D?D:
Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.Gkd,this.Hkd);D=bm.d("cgProofingOuter",[D]);b.clear();b.append(bm.g("msProofingOuter",D,"Menu16",void 0,void 0,v,"ariaLabelledById"));u.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}mcl(b,h,v=null){if(this.Gcg(h)){var D=G.a.Af(h.ut.CategoryTitle);v=Object.assign(new wj.a,{ExternalId:String.format("{0}_{1}",eu.jgc,h.proofingType),Command:Ua.a.Pla.toString(),
Image16by16Class:this.jab.J(h.proofingType),LabelText:""!==D?D:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:v,Menu:Object.assign(new Yd.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.pMl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});v.Menu.MenuSectionList.push(...b);Array.clear(b);D=Object.assign(new $g.a,{ControlList:[]});D.ControlList.push(v);b.push(D);u.ULS.sendTraceTag(39188234,375,
50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}w4e(b,h,v=null){const D=this.KUl(b);var Q=[];let ba=!1;var ta=b.ut.Suggestions;if(ta)if(ta=ta.slice(0,Math.min(3,ta.length)),this.R_g&&(ba=!am.a.any(ta,Ta=>!Ta||!Ta.Description)),1!==ta.length||ta[0].Action){let Ta=0,ob=null;ba&&(ob="font-weight: bold;");for(const Kb of ta){if(!Kb)continue;ta=null;let Vb="";const bc=G.a.Af(Kb.Text);ba&&(ta=this.y4h(Kb.Description),Vb=this.x4h(Kb.Description));Q.push(bm.a("btnCorrectWord"+
Ta,h[Ta].toString(),bc,null,null,null,null,null,ob,null,ta,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,D,bc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.LIh(b.token)),"ariaDescribedById",Vb));Ta++}}else h=G.a.Af(ta[0].Text),Q.push(bm.a("btnCorrectWord0",Eb.a.zIa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
D,h)));h="Menu16";0<Q.length?ba&&(h="Menu16DescriptionEnabled"):Q=[bm.a("btnNoSuggestions",Eb.a.zIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return bm.g("msUnknownWord",bm.d(null,Q),h,D,this.b2l(b),v,"ariaLabelledById")}uMk(b,h,v=null){var D=1!==b.proofingType&&0!==b.proofingType?b.ut.ExplanationTitle:"";D=Object.assign(new $g.a,{Title:D,Lang:v,ControlList:[]});let Q=!1;var ba=b.ut.Suggestions;if(ba)if(ba=ba.slice(0,Math.min(3,ba.length)),this.R_g&&(Q=!am.a.any(ba,ta=>!ta||!ta.Description)),
1!==ba.length||ba[0].Action){let ta=0;for(const Ta of ba){if(!Ta)continue;ba=null;let ob="";Q&&(ba=this.y4h(Ta.Description),ob=this.x4h(Ta.Description));if(ta>=h.length)break;ba?(ba=Object.assign(new ay,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ta,b.proofingType),Command:h[ta].toString(),LabelText:Ta.Text,Description:ba,Lang:v,AriaDescription:ob}),D.ControlList.push(ba)):(ba=Object.assign(new fg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ta,b.proofingType),
Command:h[ta].toString(),LabelText:Ta.Text,Lang:v,RoleInMenu:"menuitem"}),D.ControlList.push(ba));ta++}}else b=ba[0],b=Object.assign(new fg.a,{ExternalId:"NoSuggestion",Command:Eb.a.zIa.toString(),LabelText:b.Text}),D.ControlList.push(b);0>=D.ControlList.length&&D.ControlList.push(Object.assign(new fg.a,{ExternalId:"btnNoSuggestions",Command:Eb.a.zIa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return D}KUl(b){return G.a.Af(0!==b.proofingType?b.ut.ExplanationTitle:"")}b2l(b){return this.Gcg(b)?
null:this.jab.J(b.proofingType)}Gcg(b){return this.YVb&&2!==b.errorType&&(1!==b.errorType||!this.H5b(b))}Xrj(b){return this.nFe&&!!b.errorType&&1===b.proofingType&&!this.H5b(b)}pMl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.LIh(b.token)):""}csj(b){return this.oW.NZd&&this.YVb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}H5b(b){return!!b.errorType&&!!this.Bkd&&this.Bkd.contains(b.token,b.lcid)}y4h(b){return""===
b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}x4h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}LIh(b){let h="";if(b){let v;for(v=0;v<b.length-1;v++)h=h+b.charAt(v)+",";h+=b.charAt(v)}return h}}Object(n.a)(xr,"EditorServiceProofingContextMenuCreator",null,[]);class Dz{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(n.a)(Dz,
"BusinessBarRankProvider",null,[337]);class Hv{constructor(){this.W=null}get name(){return"Wonca.UI"}xc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new Dz).singleInstance();zw.R2k(b,new Fg.a(()=>Ya.App.xa.aga));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new xr(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),w.AFrameworkApplication.Pba,w.AFrameworkApplication.Vs,
w.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>dv.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){N.a.instance.Fc(new Hv)}}Object(n.a)(Hv,"WoncaUIPackage",null,[1,2]);class Vj{constructor(b){this.xN=this.Qxc=null;this.qn=b}get key(){return"BOOKMARK"}get Uw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get v3(){return this.xN}reset(b){this.xN=
b.node}qIa(b){let h=null;w.AFrameworkApplication.te("bookmarks-core-ex;bookmarks-core-ex-cf");if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Qxc&&this.qn.cvi(b,this.v3,this.Qxc))return h=Object.assign(new pw.a,{LG:this.key,contentObject:this.Qxc}),{returnValue:!0,RF:h};this.Qxc=null;if(!this.v3.hasBookmark)return{returnValue:!1,RF:h};const v=new ne.GraphIterator;v.set(this.v3.Bi());this.qn.jZc(v);if(this.qn.IFm(v)){let D=
v.Qd();for(;D;){if(this.qn.cvi(b,this.v3,D))return this.Qxc=D,h=Object.assign(new pw.a,{LG:this.key,contentObject:D,description:this.lhb()}),{returnValue:!0,RF:h};D=v.Rj()}}}return{returnValue:!1,RF:h}}lhb(){return null}}Object(n.a)(Vj,"BookmarkDetailsProvider",null,[567,568]);class nt{constructor(b,h,v,D,Q=null){this.o_g=this.Ah=!1;this.Xod=this.zqd=null;this.FSi=(ba,ta)=>{ba=ta.node;1074135152!==ba.Qc?u.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ba.Qc):(u.ULS.sendTraceTag(24155019,
324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.OVh(!0))};this.Yz=v;this.si=D;this.vx=h;this.tMg=b;this.gS=Q}get hx(){return this.vx.value}initialize(){this.V3f();this.Ah=!0}OVh(b=!1){if(!this.Ah)return u.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.o_g)return!0;let h=!1;this.si.he(()=>{this.zqd={};this.Xod={};if(this.hx){const v=new ne.GraphIterator;v.set(this.hx);if(this.jen(v)){if(v.Sb(1)){do this.Usk(v.currentNode);while(v.vf(1))
}h=this.o_g=!0}}},"BGM:EBGL");return h}wva(b){return this.OVh()?b in this.Xod?this.Xod[b]:null:null}dispose(){this.Ah?this.yQo():u.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}jen(b){if(this.Yz.gP(b))return(b=b.Sb(30))||u.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;u.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}V3f(){u.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.tMg.Yph(this.FSi)}yQo(){u.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.tMg.Daj(this.FSi)}Usk(b){var h,v,D,Q;b?(this.Znh(null!==(v=this.gS.Wdb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil,b),this.Znh(null!==(Q=this.gS.w1b.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==Q?Q:W.a.nil,b),(h=b.properties.ia(lc.a.rt,null))&&(this.Xod[h]=b)):u.ULS.sendTraceTag(24155022,324,50,"Node is null")}Znh(b,h){b===W.a.nil?u.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.zqd||(this.zqd[b]=new zb.a),b=this.zqd[b],b.contains(h)||b.add(h))}}Object(n.a)(nt,"BookmarkGraphManager",null,[591]);var Gt=c(802),hx=c(1111);class yr{create(){return new hx.a}}Object(n.a)(yr,"BookmarkContainerNodeFactory",null,[395]);class ix{constructor(b,h,v,D=null){this.Eqn=(Q,ba)=>{this.qn.yVi(ba)};this.UUf=(Q,ba)=>{var ta=this.mZh(ba.clone);Q=ba.original.Jc;const Ta=new Va.a;for(const ob of ta)ta=ob.kn.toString(),Ta.nb(ta)||(Ta.add(ta,!0),(ta=Q.Db(ob.kn))&&!ta.anchor&&
(ta=this.qn.HDb(ob.kn)),ta?ta.anchor?this.W6k(ta,ba.clone):u.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ta.id,ta.ia(lc.a.Ozb,-1))):u.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.VUf=(Q,ba)=>{Q=ba.clone;ba=this.mZh(Q);this.qn.S3c(Q,ba)};this.cA=h;this.qn=v;this.ZWj=D||new yr}init(){Gt.a.nTn(Object(z.a)(this.qn,this.qn.bSf,"onAfterFullBookmarkRangeDeleted"));this.cA.h_e(this.Eqn);ph.a.g_e(this.UUf);ph.a.wzd(this.VUf)}mZh(b){const h=
new zb.a;for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.Gh)for(let Q=0;Q<D.Gh.length;Q++)h.add(D.Gh.J(Q))}return h}W6k(b,h){var v=h.Bi().od;v=hk.a(b,v,!0);h=ne.GraphIterator.$a(h);this.kul(h);h.Sb(30);h.Y2(v,1,b.id);h.Fi(v)}kul(b){if(b.zb(25)&&b.jd(25)&&!b.Nr(30)){const h=this.ZWj.create(1074135152);b.Jf(h,30)}}}Object(n.a)(ix,"BookmarksEventHandler",null,[]);var lr=c(202),ks=c(249),Aw=c(448),Uo=c(1168),ot=c(133),IB=c(1056);class wo{create(){return new IB.a}}Object(n.a)(wo,"BookmarkNodeFactory",
null,[395]);class jx{constructor(b,h){this.Naa=b;this.jXj=h}get qMb(){return this.jXj}}Object(n.a)(jx,"FoundBookmarkRangeObject",null,[394]);class Iv{constructor(b,h,v,D,Q,ba,ta,Ta=null,ob,Kb=null){this.n2="_";this.wMg=40;this.Xjk=" ";this.vx=b;this.Yz=h;this.Kd=v;this.uIe=D;this.Gc=Q;this.eb=ba;this.ib=ta;this.iXj=Ta||new wo;this.gS=Kb}UOc(b,h){return b?this.gS.Wdb.get(null===h||void 0===h?void 0:h.toString()):this.gS.w1b.get(null===h||void 0===h?void 0:h.toString())}get hx(){return this.vx.value}get SIa(){return this.uIe.value}oYe(b,
h){if(!h||!h.Oa||!h.Pc)return u.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const v=h.Oa.node,D=h.Pc.node,Q=lr.a.mhb(h,!0);h=lr.a.mhb(h,!1);return this.sDc(b,Q,h,v,D)}sDc(b,h,v,D,Q,ba=!1){u.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ba));const ta=this.wva(b);if(ta)if(ba)this.v9i(ta);else return u.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!D||!Q)return u.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ba=this.Gc.Oc(15);ba.Cb(this.SIa);b=this.oqk(b);if(!b)return!1;this.kqk(D,h,b,Q,v);ba.dispose();return!0}wva(b){u.ULS.shipAssertTag(34936482,3029,!!b);return this.pZh(h=>b===h.properties.ia(lc.a.rt,null))}HDb(b){return b&&b!==W.a.nil?this.pZh(h=>b.equals(h.id)):(u.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}bSf(b){const h=this.HDb(b);h?(u.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.u9i(h),this.R3c(h)):
u.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}xva(b,h){var v;const D=null!==(v=this.UOc(h,b.id))&&void 0!==v?v:W.a.nil;if(D===W.a.nil)return u.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new jx(null,2);v=this.hx.od.Db(D);return v?v.isConnected?this.getBookmarkRange(v,b,h):(u.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new jx(null,3)):(u.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new jx(null,2))}yVi(b){const h=this.WCl(b);h[Symbol.iterator]().next().done||this.gen(b,h)}S3c(b,h){const v=new zb.a;let D=0,Q=!1;for(const ba of h)ba&&ba.Ib.Gh?(D++,ba.Ib.Gh.remove(ba),0<=ba.pe&&ba.pe<b.xe.length&&(ba.Ib.cp||(Q=!0),v.add(ba.pe))):u.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Upa(v);u.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",D,v.count));Q&&!b.xe.length&&b.xe.append(ks.CharacterPropertiesEditor.LM,
1024)}wNd(b=!1){u.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new zb.a,v=ne.GraphIterator.$a(this.hx);if(null!==this.jZc(v)){var D=v.xq();u.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",D);if(0<D)for(D=v.Qd();null!==D;){const Q=D.ia(lc.a.rt,"");G.a.jf(Q)||(b?h.add(D):Q.startsWith(this.n2)||h.add(D));D=v.Rj()}}!b&&0<h.count&&u.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}cpm(){return this.hx?this.Z3k():!1}Z3k(){u.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",!1);const b=ne.GraphIterator.$a(this.hx);if(null!==this.jZc(b)&&0<b.xq())for(var h=b.Qd();null!==h;){h=h.ia(lc.a.rt,"");if(!G.a.jf(h)&&!h.startsWith(this.n2))return!0;h=b.Rj()}return!1}Kci(b){var h=this.wva(b);const v=new zb.a;if(h){b=this.UOc(!0,h.id);h=this.UOc(!1,h.id);var D=this.hx.od.Db(b);D&&v.add(D);if(b.equals(h))return v;b=D;do(b=D=this.eb.jg(b,!1,!1,!0))&&v.add(D);while(D&&!D.id.equals(h))}else u.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return v}t9i(b){if(null===b)return u.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.HDb(b);return this.v9i(b)}iNl(b){let h="";const v=b.id;b=b.characterData.split(this.Xjk);for(let D=0;3>D&&D<b.length;D++)h+=this.n2+b[D];h.length>this.wMg&&(h=h.substring(0,this.wMg));return this.uMj(h,v)}uMj(b,h){const v=this.wNd(!0),D=[];let Q;for(let ta=0;ta<v.count;ta++){var ba=v.J(ta);Q=ba.ia(lc.a.rt,"");ba=this.UOc(!0,ba.id);Q.startsWith(b)&&!h.equals(ba)&&D.push(Q)}return 0<
D.length?(D.sort((ta,Ta)=>ta.localeCompare(Ta,void 0,{numeric:!0})),(h=D[D.length-1].substring(b.length+1))?b+this.n2+(parseInt(h)+1):b+this.n2+1):b}Lji(b){G.a.jf(b)?u.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.wva(b),null===b?u.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.xva(b,!0))?(b=Mg.SelectionFactory.ue(b.Naa.paragraph,b.Naa.Ib.cp))&&this.ib.setSelection(b):u.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}v9i(b){if(!b)return u.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;u.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Gc.Oc(15);h.Cb(this.SIa);this.u9i(b);this.R3c(b);h.dispose();return!0}POd(b,h){if(!b||0>h)return u.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let v=null;const D=new zb.a,Q=new zb.a;var ba=b.pa;for(var ta=0;ta<ba.length;ta++){var Ta=ba.J(ta);if(Ta.cp>h||Ta.cp===h&&0<D.count)break;if(Ta.Gh){var ob=
Ta.Gh;if(2===ob.length&&ob.J(0).kn.equals(ob.J(1).kn)&&Ta.cp===h){D.add(ob.J(0).kn.toString());break}for(let Kb=0,Vb=ob.length;Kb<Vb;Kb++){Ta=ob.J(Kb);const bc=b.Jc.Db(Ta.kn).ia(lc.a.rt,"");G.a.jf(bc)||bc.startsWith(this.n2)||(Ta.Mc?D.add(Ta.kn.toString()):D.contains(Ta.kn.toString())?D.remove(Ta.kn.toString()):Q.add(Ta.kn.toString()))}}}0<D.count&&(v=b.Jc.Db(W.a.Ff(D.J(D.count-1))));if(!v)for(h=de.ParagraphReader.jg(b,!0);h&&!v;){for(ba=0;ba<h.pa.length;ba++)if(ta=h.pa.J(ba),ta.Gh){ta=ta.Gh;for(let Kb=
0,Vb=ta.length;Kb<Vb;Kb++)ob=ta.J(Kb),Ta=b.Jc.Db(ob.kn).ia(lc.a.rt,""),G.a.jf(Ta)||Ta.startsWith(this.n2)||(ob.Mc?Q.contains(ob.kn.toString())?Q.remove(ob.kn.toString()):D.add(ob.kn.toString()):D.contains(ob.kn.toString())?D.remove(ob.kn.toString()):Q.add(ob.kn.toString()))}0<D.count?v=h.Jc.Db(W.a.Ff(D.J(D.count-1))):h=de.ParagraphReader.jg(h,!0)}return v}gSo(b,h){if(null===b)return u.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.JFm(h)||this.yql(h))return!1;const v=this.Gc.Oc(15);
v.Cb(this.SIa);this.fSo(b,h);v.dispose();return!0}pZh(b){if(!this.hx)return u.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new ne.GraphIterator;h.set(this.hx);if(!this.jZc(h))return u.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Sb(1))return null;do{const v=h.currentNode;if(b(v))return v}while(h.vf(1));return null}getBookmarkRange(b,h,v){for(let D=0;D<b.pa.length;D++){const Q=b.pa.J(D);if(Q.Gh)for(let ba=0;ba<Q.Gh.length;ba++){const ta=
Q.Gh.J(ba);if(ta.kn.equals(h.id)&&v===ta.Mc)return new jx(ta,0)}}u.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ia(lc.a.Ozb,-1),v,h.id,b.pa.length,this.tM(b));return new jx(null,1)}jZc(b){if(this.Yz.gP(b))return b=b.Sb(30),u.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;u.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}WCl(b){const h=new Va.a;
for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.Gh)for(let Q=0;Q<D.Gh.length;Q++){const ba=D.Gh.J(Q),ta=ba.kn.toString();h.nb(ta)?(u.ULS.shipAssertTag(36218379,3029,ba.Mc!==h.J(ta).Mc),h.remove(ta)):h.add(ta,ba)}}return h.values}gen(b,h){this.S3c(b,h);this.Ldn(b,h)}Ldn(b,h){let v=de.ParagraphReader.jg(b,!1,!0);b=de.ParagraphReader.jg(b,!0,!0);v||b?(v||this.zwh(h,!0)&&u.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.zwh(h,!1)&&u.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),v=v||b,b=b||v,this.uOi(v,h,0,!0),this.uOi(b,h,b.pa.last.cp,!1)):u.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}zwh(b,h){for(const v of b)if(h===v.Mc)return!0;return!1}uOi(b,h,v,D){const Q=new zb.a;v=this.Xnf(b,v);for(const ba of h)ba.Mc===D&&(v?(h=this.qqk(b,D,v,ba.kn))&&Q.add(h):u.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",D));
Q.count&&(b.Xl(),this.eng(b,Q),u.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",Q.count,D)))}qqk(b,h,v,D){const Q=this.HDb(D);return Q?this.pYe(b,h,v,Q):(u.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",D)),null)}pYe(b,h,v,D){var Q;if(!D)return u.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!v)return u.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;v.Gh||(v.Gh=new Aw.a(v));const ba=new Uo.a(v,null,D.id,h);v.Gh.add(ba);(h?this.gS.Wdb:this.gS.w1b).set(null===(Q=D.id)||void 0===Q?void 0:Q.toString(),b.id);return ba}eng(b,h){if(h){u.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((v,D)=>v.pe-D.pe);for(let v=0;v<h.count;v++){const D=h.J(v);D.pe?b.xe.WX(D.pe-1,1024):b.xe.hoa(D.pe,1024);b.xe.jq.Z(D.pe,ks.CharacterPropertiesEditor.LM);b.xe.$s.Z(D.pe,ks.CharacterPropertiesEditor.tR)}}else u.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Xnf(b,h){if(!b||!b.pa||!b.pa.last)return null;u.ULS.shipAssertTag(36471766,3029,h<=b.pa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.pa.last.cp===h){var v=b.pa.length-1;if(!b.pa.J(v).formatting)for(var D=v-1;0<=D;D--){var Q=b.pa.J(D);if(Q.formatting){this.Kd.MY(b,v,h,Q.formatting);break}}return b.pa.last}v=null;for(D=0;D<b.pa.length;D++){Q=b.pa.J(D);if(Q.cp>=h){if(Q.cp>h||!Q.formatting)this.Kd.MY(b,D,h,v),Q=b.pa.J(D);Q.Gh||(Q.Gh=new Aw.a(Q));
u.ULS.shipAssertTag(36471768,3029,Q!==b.pa.last);return Q}Q.formatting&&(v=Q.formatting)}return null}oqk(b){const h=new ne.GraphIterator;h.set(this.hx);if(!this.jZc(h))return u.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.y8k(b);h.Y2(b,1,null);h.Fi(b);return b}y8k(b){const h=this.iXj.create(1074135153);h.setValue(lc.a.rt,b);h.setValue(lc.a.Ozb,ye.a.tF());return h}R3c(b){if(b&&b.anchor){u.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ia(lc.a.Ozb,-1),b.id);var h=new ne.GraphIterator;h.set(b);h.zb(64);h.Cg()}}tM(b){const h=[];let v=0;for(;b.anchor.eq&&7!==b.type;)h[v]=ot.a[b.type],b=b.anchor.eq.vr.node,v++;h[v]=ot.a[b.type];return h.join(" ")}fSo(b,h){b.setValue(lc.a.rt,h)}u9i(b){const h=this.xva(b,!0).Naa;b=this.xva(b,!1).Naa;if(h&&b&&h.paragraph===b.paragraph){let v;this.S3c(h.paragraph,(v=new zb.a,v.add(h),v.add(b),v))}else{if(h){let v;this.S3c(h.paragraph,(v=new zb.a,v.add(h),v))}if(b){let v;this.S3c(b.paragraph,(v=new zb.a,
v.add(b),v))}}}kqk(b,h,v,D,Q){if(h=this.pYe(b,!0,this.Xnf(b,h),v)){b.Xl();var ba;this.eng(b,(ba=new zb.a,ba.add(h),ba));(v=this.pYe(D,!1,this.Xnf(D,Q),v))?(D.Xl(),this.eng(b,(ba=new zb.a,ba.add(v),ba))):u.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else u.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}Lci(b,h){var v;if(!b)return null;h=null!==(v=this.UOc(h,
b.id))&&void 0!==v?v:W.a.nil;return b.Jc.Db(h)?b.Jc.Db(h):null}IFm(b){return!!b&&64===b.Ve}HXf(b){var h;if(0===b.Y9)return!1;for(let v=0;v<(null===(h=b.pa)||void 0===h?void 0:h.length);v++){const D=b.pa.J(v);if(null!=D.Gh)for(let Q=0;Q<D.Gh.length;Q++){const ba=D.Gh.J(Q),ta=b.Jc.Db(ba.kn).HOa();if(!G.a.jf(ta)&&!ta.startsWith(this.n2)&&ba.Mc)return!0}}return!1}n4h(b){var h;const v=[];if(0===b.Y9)return v;for(let D=0;D<(null===(h=b.pa)||void 0===h?void 0:h.length);D++){const Q=b.pa.J(D);if(null!=Q.Gh)for(let ba=
0;ba<Q.Gh.length;ba++){const ta=Q.Gh.J(ba),Ta=b.Jc.Db(ta.kn),ob=Ta.HOa();G.a.jf(ob)||ob.startsWith(this.n2)||!ta.Mc||v.push(Ta)}}return v}Xso(b){return b.ia(lc.a.DG,!1)}JFm(b){return G.a.jf(b)?(u.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}yql(b){return null!==this.wva(b)?(u.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}m4h(b,h,v){return this.getBookmarkRange(b,h,v).Naa}cvi(b,h,v){if(this.Xso(v)||this.SKm(v))return!1;
const D=this.Lci(v,!0),Q=this.Lci(v,!1);if(D&&Q&&this.eb.XUc(h,D,Q)){if(h!==D&&h!==Q)return!0;const ba=this.m4h(D,v,!0);if(ba&&(D!==h||ba.Ib.cp<=b)&&(v=this.m4h(Q,v,!1))&&(Q!==h||v.Ib.cp>=b))return!0}return!1}SKm(b){b=null===b||void 0===b?void 0:b.ia(lc.a.rt,"");return!G.a.jf(b)&&b.startsWith(this.n2)?!0:!1}}Object(n.a)(Iv,"FullBookmarkManager",null,[336]);class Ny{constructor(){this.Ete=this.Vp=this.W=null}get name(){return"WordEditor.Bookmark"}xc(b){this.W=b;this.Vp=this.W.resolve("Box4.INotebookManager").zl;
const h=new Iv(new Fg.a(()=>Ya.App.xa.hb.Uc),Rl.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new Fg.a(()=>Ya.App.xa.hb.rc.Yc),rl.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new ix(this.Vp.Ye(12),
this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();Jd.App.JKj&&(this.Ete=new nt(this.Vp.Ye(64),new Fg.a(()=>Ya.App.xa.hb.Uc),Rl.PageNavigator.instance,wr.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Ete).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}dispose(){this.Ete.dispose()}jn(){u.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();u.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.tTn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}tTn(b,h){b&&b.execute(v=>{v.V4(new Vj(h))})}static main(){N.a.instance.Fc(new Ny)}}Object(n.a)(Ny,"BookmarkPackage",null,[1,2]);var DC=c(872),JB=c(1048),by=c(1541),Cq=c(1405);class CA extends Cq.a{constructor(b){super();
this.Vmk=b}get index(){return 3}run(){this.Vmk()}QJ(){this.rY()}}Object(n.a)(CA,"FootnoteEndnoteGraphUpdateTracker",Cq.a,[]);class Ez{constructor(){this.Jjd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}xc(){}init(){Ez.Xb.Lp.continueWith(()=>{this.jn()})}jn(){DC.a.Lgb=by.a.instance;this.Uxf()}dispose(){}Uxf(){this.Jjd=new CA(()=>{by.a.instance.Pu()});JB.a.Ace(Object(z.a)(this.Jjd,this.Jjd.QJ,"setUpdateNeeded"));fs.GraphTransactionManager.instance.gqa(this.Jjd,3)}static get Xb(){return Ga.a.instance.resolve("Box4.IFeatureHelper")}}
Object(n.a)(Ez,"PackageManager",null,[1,2]);var Oy=c(760),Ht=c(200),ju=c(528),It=c(468),ku=c(1644);class Py extends vk{constructor(){super()}get Uw(){return null}getTitle(b){b=b.Ana();if(!b||!ju.a.instance.toa(b))return"";const h=new Sys.StringBuilder,v=ju.a.instance.S3(b);h.append(1===v?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(ju.a.instance.v7b(b));return h.toString()}}Object(n.a)(Py,"FootnoteEndnoteBaseDetailsProvider",
vk,[]);class Fz extends Py{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get Bh(){return 7}}Object(n.a)(Fz,"FootnoteEndnoteDetailsProvider",Py,[]);var Gz=c(1594),DA=c(1614),EC=c(1688);class Hz extends Py{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get Bh(){return 10}}Object(n.a)(Hz,"FootnoteEndnoteRefMarkDetailsProvider",Py,[]);class Sr{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld){this.hri=(Qd,ge,ze,gg,Kg)=>{gg=ge.view;if(!gg.features.fke||this.qD.Yui)return 8;
const Ll=gg.lb.tg;if(!Ll)return 2;if(this.Ik.j_(Ll))return 8;gg=Qd===sc.a.insertFootnote?1:0;var Em=this.WNd(ge);if(!Em)return u.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;ge=!0;Em=Em.Oa;Kg&&Kg.mbc&&Kg.jFa&&(Em=Kg.jFa,ge=!Kg.keepCurrentFocus);if(1===ze&&sj.a.kha(Ll)||!Em||!We.SelectionEditor.gf(Em)||this.tPg.instance&&this.tPg.instance.fMm(Em)||ue.HyperlinkReader.Ewa(Em,!0))return 8;if(1===ze)return 32;2===ze&&(ze=this.aT.$f("UserAction","InsertFootnoteEndnote"),Qd=this.X2j.iBm(Em,
gg,Qd),Kg&&Kg.mbc&&(Kg.MQi=Qd),ge&&this.v8d(Qd,!0,!0),ze.stop(),this.Sd.Ls(6));return 32};this.Wdc=(Qd,ge,ze)=>{const gg=ge.view;if(Qd===sc.a.M6a||Qd===sc.a.Oob){if(!gg.features.fke)return 8}else if(!gg.features.Wgg)return 8;if(!gg.lb.tg)return 2;ge=this.u8b(ge);return ge?Qd!==sc.a.M6a&&Qd!==sc.a.Oob||this.qKa.ypm(ge.node,Qd===sc.a.M6a?1:0)?1===ze?32:2===ze&&32===this.ga.Qb(sc.a.z3,2,!0)?(this.ga.Qb(sc.a.ZPf,2,Qd),32):8:8:2};this.mGl=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;if(2===ze){Qd=this.hbm(ge);
if(!Qd)return 8;ze=ge=null;switch(Kg){case sc.a.P4d:ze=Qd.Pc;ge=this.YUb.YSd(ze,1);break;case sc.a.O4d:ze=Qd.Pc;ge=this.YUb.YSd(ze,0);break;case sc.a.R4d:ze=Qd.Oa;ge=this.YUb.Zji(ze,1);break;case sc.a.Q4d:ze=Qd.Oa;ge=this.YUb.Zji(ze,0);break;case sc.a.M6a:ze=Qd.Oa;(ge=this.YUb.YSd(ze,1,!0))||(ge=this.qKa.r8h(ze.node,1));break;case sc.a.Oob:ze=Qd.Oa,(ge=this.YUb.YSd(ze,0,!0))||(ge=this.qKa.r8h(ze.node,0))}if(ge)this.v8d(ge);else{if(!this.St.rc)return 8;(Kg=Ba.d(ze.node,ze.cpBegin))&&7===Kg.Bh&&this.qKa.thj(Kg)}}return 32};
this.hvo=(Qd,ge,ze,gg,Kg)=>1===ze?32:2===ze?(u.ULS.shipAssertTag(4520066,308,!!Kg),u.ULS.shipAssertTag(4520067,308,!!Kg.e_a),Qd=Kg.e_a,u.ULS.shipAssertTag(4520068,308,this.sE.toa(Qd)),this.v8d(Qd,Kg.Ehe)?32:8):32;this.ivo=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;2===ze&&(Qd=Kg.footnoteEndnoteNode,Kg=Kg.pGl)&&(this.csa.D5b(),ge=this.sE.yjb(Qd),Kg.title=this.sE.dXl(Qd)+(ge?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.J4a=(Qd,ge,ze,gg,Kg)=>2===ze?(u.ULS.shipAssertTag(4520069,308,!!Kg),u.ULS.shipAssertTag(4520070,308,!!Kg.e_a),u.ULS.shipAssertTag(4520071,308,de.ParagraphReader.Vb(Kg.e_a)),Qd=this.sE.Z0a(Kg.e_a),this.v8d(Qd,Kg.Ehe)?32:8):32;this.qho=(Qd,ge,ze)=>{2===ze&&this.qD.GY();return 32};this.Fnl=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;if(2===ze)return void 0!==Kg&&null!==Kg?this.qD.Pef(Kg,Kg):this.qD.Pef(),32;u.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.wXm=(Qd,ge,ze)=>{Qd=this.u8b(ge);return Qd&&We.SelectionEditor.gf(Qd)?1===ze?32:2===ze?(ze=0<this.Xo.R3(Qd.node).Lt,this.qD.faf(),this.qD.dialog.mib=ze,32):8:(u.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.kGl=(Qd,ge,ze)=>1===ze?32:2===ze?(this.qD.dialog.mib=!1,32):8;this.rKn=(Qd,ge,ze,gg,Kg)=>this.T0h(Qd,ze,Kg);this.pKn=(Qd,ge,ze,gg,Kg)=>1===ze?32:this.qD.dialog&&this.qD.dialog.fontName?(Kg[mi.a.Value]=this.qD.dialog.fontName,32):this.q_j.jOa(Eb.a.$Lb.toString(),
Kg,null)?32:8;this.jGl=(Qd,ge,ze)=>1===ze?32:2===ze?(this.qD.dialog.mib=!0,32):8;this.qKn=(Qd,ge,ze,gg,Kg)=>this.T0h(Qd,ze,Kg);this.hGl=(Qd,ge,ze)=>{if(1===ze)return 32;if(2===ze){Qd=this.u8b(ge);if(!Qd)return u.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;ge=this.sE.Z0a(Qd.node);this.sE.toa(ge)&&(ze=this.Gc.Oc(15),ze.Cb(ge),this.eFj(Qd),this.qKa.jth(ge,this.qD.dialog),ze.dispose());this.qD.U4c();return 32}return 8};this.gGl=(Qd,ge,ze)=>{if(1===ze)return 32;if(2===ze){Qd=
this.u8b(ge);if(!Qd)return u.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;ge=this.sE.Z0a(Qd.node);this.sE.toa(ge)&&(ze=this.Gc.Oc(15),ze.Cb(ge),this.eFj(Qd),this.qKa.ODk(ge,this.qD.dialog),ze.dispose());this.qD.U4c();return 32}return 8};this.iGl=(Qd,ge,ze)=>1===ze?32:2===ze?(this.qD.U4c(),32):8;this.eGl=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;if(2===ze){Qd=Object(Ka.a)(28,Kg);if(!Qd||!Qd.xd)return 8;this.qD.dialog.fontName=Qd.xd.fontName;return 32}return 8};this.fGl=(Qd,
ge,ze,gg,Kg)=>{if(1===ze)return 32;if(2===ze){Qd=Object(Ka.a)(28,Kg);if(!Qd||!Qd.xd)return 8;this.qD.dialog.XUb=Qd.xd;return 32}return 8};this.ga=b;this.St=h;this.q_j=v;this.fd=D;this.sE=Q;this.X2j=ba;this.qKa=ta;this.csa=Ta;this.qD=ob;this.Xo=Kb;this.YUb=Vb;this.Gc=bc;this.Ik=Dc;this.Hb=Oc;this.aT=gd;this.Sd=rd;this.hUj=je;this.tPg=Ld}eFj(b){(b=Hn.FormattingReader.Kr(b))?(this.qD.dialog.fontName||(this.qD.dialog.fontName=b.cache.rG),-1===this.qD.dialog.fontSize&&(this.qD.dialog.XUb=b.cache.fontSize)):
u.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}T0h(b,h,v){return 1===h&&this.qD.dialog?32:2===h&&this.qD.dialog?(v[Fi.a.On]=b===sc.a.r1f?this.qD.dialog.mib:!this.qD.dialog.mib,32):8}Tb(){var b;(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.PageViewFootnoteEndnoteNavigationBugFix",!1))&&Ya.App.instance.uoi([sc.a.P4d,sc.a.O4d,sc.a.R4d,sc.a.Q4d,sc.a.ZPf,sc.a.M6a,sc.a.Oob,sc.a.z3]);this.ga.fb(sc.a.insertFootnote,
Zb.a.view,this.hri,4);this.ga.fb(sc.a.insertEndnote,Zb.a.view,this.hri,4);this.ga.qa(sc.a.P4d,Zb.a.view,this.Wdc);this.ga.qa(sc.a.ZPf,Zb.a.view,this.mGl);this.ga.qa(sc.a.O4d,Zb.a.view,this.Wdc);this.ga.qa(sc.a.R4d,Zb.a.view,this.Wdc);this.ga.qa(sc.a.Q4d,Zb.a.view,this.Wdc);this.ga.qa(sc.a.M6a,Zb.a.view,this.Wdc);this.ga.qa(sc.a.Oob,Zb.a.view,this.Wdc);this.ga.qa(sc.a.lrj,Zb.a.view,this.hvo);this.ga.fb(sc.a.R0h,Zb.a.view,this.jGl,4);this.ga.fb(sc.a.r1f,Zb.a.view,this.qKn,100);this.ga.fb(sc.a.S0h,Zb.a.view,
this.kGl,4);this.ga.fb(sc.a.B4i,Zb.a.view,this.rKn,100);this.ga.qa(sc.a.mrj,Zb.a.view,this.ivo);this.ga.fb(sc.a.J4a,Zb.a.view,this.J4a,96);this.ga.fb(sc.a.KMd,Zb.a.view,this.qho,96);this.ga.qa(sc.a.z3,Zb.a.view,this.Fnl);this.ga.fb(sc.a.JEi,Zb.a.view,this.wXm,4);this.ga.fb(sc.a.O0h,Zb.a.view,this.hGl,4);this.ga.fb(sc.a.P0h,Zb.a.view,this.gGl,4);this.ga.fb(sc.a.Q0h,Zb.a.view,this.iGl,4);this.ga.fb(sc.a.IMd,Zb.a.view,this.eGl,4);this.ga.fb(sc.a.A4i,Zb.a.view,this.pKn,100);this.ga.fb(sc.a.JMd,Zb.a.view,
this.fGl,4);this.ga.fb(sc.a.x1c,Zb.a.view,Sr.x1c,100);this.ga.fb(sc.a.y1c,Zb.a.view,Sr.y1c,100)}O3f(){this.hUj.execute(b=>{b.V4(new Fz);b.V4(new Hz)})}u8b(b){b=this.WNd(b);return b?b.Oa:(u.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}WNd(b){let h=null;b=b.view;if(!b)return u.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.lb;if(!b)return u.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.gb;if(!b||
!b.length)return u.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return u.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=We.SelectionEditor.xj(b,!1,!1))||u.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}hbm(b){return(b=b.view)?b.lb.gb.J(0):null}v8d(b,h=!0,v=!1){if(b){this.csa.D5b();var D=b.mna;if(D){var Q=D.Ib,ba=Mg.SelectionFactory.LK(Q.paragraph,Q.cp,Q.cp+1);Q=this.St.rc;
if(!Q)return!1;this.fd.ida(Q,ba);Q.Snb=150;Q.b5();b=new It.a(b,h);ba=Ht.a.D7b(D,Q);D=D.Ova(Q,ba);if(!D)return u.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;v||D.element?this.qD.Ldg(b):(this.qD.Ldg(new It.a(b.e_a,!1)),h&&(h=new of.a(2,1,10,()=>{this.qD.GY()}),this.Hb.Wb(h)));return!0}}return!1}static VWl(){return new Sr(w.AFrameworkApplication.va,Ya.App.xa.hb,Ga.a.instance.resolve("Box4.IGeneralCuiUser"),Ob.InteractiveViewManager.instance,ju.a.instance,DA.a.instance,Gz.a.instance,
by.a.instance,ku.FootnoteEndnoteControlManager.instance,Ga.a.instance.resolve("Box4.IParagraphIndentationReader"),EC.a.instance,new rl.a,xi.a.instance,xb.a.instance,w.AFrameworkApplication.ta.Gq,Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Ga.a.instance.Sa("Box4.IContentControlReader"))}static UWl(){return Sr.VWl()}static x1c(b,h,v,D,Q){if(1===v)return 32;if(2===v&&!Q)return 8;Ao.a.hWd(h);Q.PopulationXML=
rp.FontUtils.t2h(Ao.a.Vhe,Ao.a.Llf,sc.a.IMd);return 32}static y1c(b,h,v,D,Q){if(1===v)return 32;if(2===v&&!Q)return 8;Q.PopulationXML=rp.FontUtils.u2h(sc.a.JMd);return 32}}Object(n.a)(Sr,"FootnoteEndnoteActor",null,[491]);class Ii extends Cq.a{constructor(b){super();this.dWe=b}get index(){return 1}run(){this.dWe()}QJ(){this.rY()}}Object(n.a)(Ii,"FootnoteEndnoteControlUpdateTracker",Cq.a,[]);var Tm=c(350);class pt extends Tm.a{constructor(b,h,v,D,Q,ba,ta,Ta){super(b,h,v,D);this.Ys=()=>{this.Ead(this.Bb)};
this.mI=b.container;this.Wv=document.createElement("div");b.container.appendChild(this.Wv);this.MG(this.Wv);this.Egk=Q;this.xo.execute(ob=>{ob.H0(this.Ys)});this.uKa=ba;this.uK=ta;this.vI=Ta;this.uKa.execute(ob=>{ob.ecg(this.nc,this.mI)});this.vI&&(this.mI.style.backgroundColor=this.uK.$7b())}dispose(){super.dispose();this.xo.instance&&this.xo.instance.H5a(this.Ys)}get xo(){return null!=this.fAg?this.fAg:this.fAg=Ga.a.instance.Sa("Common.IZoomManager")}bC(b){this.mI.classList.add("FootnoteEndnoteViewElement");
this.Ead(b.currentNode)}Ead(b){this.xo.instance&&(this.xo.instance.hcd(this.Wv),this.Wv.style.width=Math.round(100/this.xo.instance.hj)+"%");this.Egk(b)}}Object(n.a)(pt,"FootnoteEndnoteViewElement",Tm.a,[]);class Tf{constructor(){this._initialized=!1;this.dgd=this.OAe=this.W=null;this.rGl=(b,h,v,D)=>b.U2a?new pt(b,h,v,D,Q=>{ku.FootnoteEndnoteControlManager.instance.J3n(Q)},this.W.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Ya.App.instance&&Ya.App.instance.WC):null}get name(){return"WordEditor.FootnoteEndnote"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}jn(){kw.WordSectionNavigator.instance.bQf=Object(z.a)(Gz.a.instance,Gz.a.instance.efn,"navigateToWordSectionNodeWithFootnoteEndnote");Oy.a.Ubg(this.rGl);ku.FootnoteEndnoteControlManager.instance.bind(Ya.App.xa.lD);this.OAe=Sr.UWl();this.OAe.Tb();this.OAe.O3f();Ya.App.xa.updateCommandUI();this.Uxf();this._initialized=
!0}dispose(){this._initialized&&(this._initialized=!1,ku.FootnoteEndnoteControlManager.instance.dispose())}Uxf(){this.dgd=new Ii(()=>{ku.FootnoteEndnoteControlManager.instance.Fad()});JB.a.Ace(Object(z.a)(this.dgd,this.dgd.QJ,"setUpdateNeeded"));fs.GraphTransactionManager.instance.gqa(this.dgd,3)}}Object(n.a)(Tf,"PackageManager",null,[1,2]);class cy{constructor(b,h,v,D){this.ib=h;this.uea=D}get bookmarkManager(){return this.uea.value}XLm(b){return Jd.App.JKj?b.startsWith(G.a.Tdb):!1}Jmm(b){try{this.Kmm(b)}catch(h){u.ULS.sendTraceTag(24691935,
324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}vkg(b){return{returnValue:!1,s4f:b,wDb:""}}Kmm(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.wva(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.xva(h,!0).Naa,h=this.bookmarkManager.xva(h,!1).Naa,b||h?b?this.Amj(b):(u.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Amj(h)):(u.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.BDi(!1))):(u.ULS.sendTraceTag(35992275,
324,15,"Cannot find bookmark node"),this.BDi(!0))}}BDi(b){b=Mg.SelectionFactory.ho(Ya.App.xa.hb.Uc.Bof(),b);this.ib.setSelection(b)}Amj(b){b.paragraph&&b.Ib?(b=Mg.SelectionFactory.ue(b.paragraph,b.Ib.cp),b.gui=!0,this.ib.setSelection(b)):u.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(n.a)(cy,"InternalLinkManager",null,[333]);class Qy{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}xc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",
()=>new cy(new Fg.a(()=>b.Na("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new Fg.a(()=>b.Na("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){N.a.instance.Fc(new Qy)}}Object(n.a)(Qy,"WordEditorInternalLinksPackage",null,[1,2]);class Bw{constructor(b){this.ZKa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){ch.a.mark(4763);
var v=ne.GraphIterator.$a(h);if(v.zb(8)&&v.jd(8)&&v.WBj(h)===h){if(dh.OutlineReader.isEmpty(v)){let D=!1;for(let Q=0;Q<Th.a.instance.gb.length;Q++){const ba=Th.a.instance.gb.J(Q);for(let ta=0;ta<ba.length;ta++)if(ba.J(ta).node===h){D=!0;break}}D||this.YPh(v)}ch.a.mark(4764)}}};Bw.tK=b}HGd(b){if(!Bw.nf.CZd(b))return null;b.Sb(1)&&(b.currentNode.Tk(8,!0),b.sc());const h=Bw.tK.Jbl();Bw.nf.isRtl(b.currentNode)?h.setValue(Gd.a.ar,11):h.setValue(Gd.a.ar,9);b.Jf(h,1);b.Fi(h);return h}Oio(b){if(this.ZKa&&
b!==this.ZKa){const h=new of.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.ZKa;w.AFrameworkApplication.pc.Wb(h)}this.ZKa=b}YPh(b){this.ZKa===b.currentNode&&(this.ZKa=null);const h=new ah.GraphTransaction(7);h.ku(b);b.Cg();h.dispose()}iDh(){if(this.ZKa&&this.ZKa.anchor){const b=ne.GraphIterator.$a(this.ZKa);b.Ep()&&dh.OutlineReader.RTc(b)&&this.YPh(b);this.ZKa=null}}static get nf(){return bi.PageReader.instance}}Bw.tK=null;Object(n.a)(Bw,"PageContentEditor",null,[1547]);var KB=
c(1164),Jv=c(632);class LB extends ax{constructor(){super()}Mpj(b,h,v,D,Q){let ba=!1,ta=!0;We.SelectionEditor.gf(Q)&&(h=Hg.ListItemReader.Ig(b)&&h,Q=Cd.OutlineElementReader.EA(b,Q,!1)&&!Cd.OutlineElementReader.EA(b,Q,!0),h&&v.y5e(b,D)&&(ba=!0),Ya.App.qd.Qo&&(Q||h&&!ba)&&(ta=!1));return{Lpj:ta,fKj:ba}}}Object(n.a)(LB,"CursorMoveValidator",ax,[]);class Tn{constructor(b,h,v,D,Q){this.XD=Q;this.OMe=b;this.s6=D;this.asa=h;this.nh=v}get Ld(){return null!=this.cIg?this.cIg:this.cIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=
this.NHg?this.NHg:this.NHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get wc(){return null!=this.EJg?this.EJg:this.EJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Rs(){return this.s6.value}get lg(){return this.nh.value}get wq(){return this.asa}Fkm(b){const h=window.performance.now(),v=new pq.ScriptSharpLegacyMap,D=new wl.a,Q=new pq.ScriptSharpLegacyMap;if(b&&b.$w){var ba=null;for(let ta=0;ta<b.length;ta++){const Ta=b.getContext(ta);ba=ba||Tn.vh.Xs(Ta.node);
let ob;if(!({groupId:ob}=this.vNo(Ta.node,ba)).returnValue)continue;let Kb;v.nb(ob)||(Kb=[],v.add(ob,Kb));Kb=v.J(ob);Kb.push(Ta)}for(const ta of Bj.toArray(v.keys))b=v.J(ta),ba=new ne.GraphIterator,ba.set(b[0].node),({Idj:b,fu:ba}=this.asa.SMo(ba)).returnValue?(v.Z(ta,b),Q.add(ta,ba)):D.add(ta)}u.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:v,Ikm:D,Hkm:Q}}jAb(b){return this.oSk(b)}Z1b(b){return this.ORk(b)}qCd(b,
h,v=!0){return ne.GraphIterator.pba(()=>{var D=!1;if(Hg.ListItemReader.Ig(b))return this.y5e(b,h,v);D||(ig.OutlineElementNavigator.Ge(b),D=de.ParagraphReader.sh(b)||rh.TableReader.isTable(b),ig.OutlineElementNavigator.Vd(b),D=D&&this.mSk(b,h));return D})}y5e(b,h,v=!0){return ne.GraphIterator.pba(()=>{const D=Cd.OutlineElementReader.mEa(b),Q=dh.OutlineReader.xX(b.currentNode);if(v?!this.wNm(b,h):!this.xNm(b,h))return!1;var ba=ne.GraphIterator.$a(b.currentNode);if(0<h&&ba.zb(14)){ba.jd(16);var ta=ba.currentNode;
const Ta=Ph.TableCellReader.suf(ba);ba.jd(14);const ob=ba.currentNode;ba=Or.a.xM(ta,ob,lc.a.uP,lc.a.za,0);ta=Or.a.xM(ta,ob,lc.a.QR,lc.a.Aa,0);ba=Cf.a.Cy(ba,0);ta=Cf.a.Cy(ta,0);return D+Q<Ta-ba-ta}return!0})}mSk(b,h){const v=Cd.OutlineElementReader.mEa(b);var D=Cd.OutlineElementReader.vG(b);if(0<h){h=dh.OutlineReader.xX(b.currentNode);D=0;const {Bo:Ta,marginLeft:ob,marginRight:Kb}=Tn.HQd(b.currentNode);var Q=ne.GraphIterator.$a(b.currentNode);ig.OutlineElementNavigator.Ge(b);if(rh.TableReader.isTable(b)){D=
rh.TableReader.yga(b);var ba=0;for(var ta of D)ba+=ta;D=Cf.a.Cy(Cf.a.xf(ba,0),0)}ig.OutlineElementNavigator.Vd(b);return Q.zb(14)?(Q.jd(16),ta=Q.currentNode,b=Ph.TableCellReader.suf(Q),Q.jd(14),ba=Q.currentNode,Q=Or.a.xM(ta,ba,lc.a.uP,lc.a.za,0),ta=Or.a.xM(ta,ba,lc.a.QR,lc.a.Aa,0),Q=Cf.a.Cy(Q,0),ta=Cf.a.Cy(ta,0),v+h<b-Q-ta-D):v+h<Ta-ob-Kb-D}return 0<v-D}XRa(b,h){this.XYi(b,-1*Math.abs(h))}iJc(b,h){this.XYi(b,Math.abs(h))}yll(b,h,v,D,Q){let ba=Tn.QNi;if(h>=Tn.QNi){ba=h-=v;const ta=D*Q,Ta=Math.abs(ta),
ob=Math.abs(h)%Ta;ob&&(ba=0>ba?0>D?ba+ob:ba-(Ta-ob):0<D?ba-ob:ba+(Ta-ob));ba+=ta;ba+=v;Tn.n9d&&(v=Cd.OutlineElementReader.R3(b),ba=Tn.n9d.t5h(b.currentNode,h+v,ba+v,Q,ba<h)-v)}return ba}kSk(b,h,v){if(!b||!b.length)return!1;h=v?h?-1:1:this.f7h(b[0].node,h);return this.lSk(b,h,v)}Zwn(b,h,v){if(!b)return u.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return u.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),
8;if(!v)return u.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!v.length)return u.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const D=b[0].node;h=this.f7h(D,h);if(!this.sdn(D,v[0],h)||!this.pdn(b,h))return 8;this.Rs.i$();return 32}pdn(b,h){for(let v=0;v<b.length;v++){const D=new ne.GraphIterator;D.set(b[v].node);let Q=null;ig.OutlineElementNavigator.Ge(D);if(de.ParagraphReader.sh(D)){if(Q=D.currentNode,
!Q)return u.ULS.shipAssertTag(589592461,338,!Q,"The paraNode is null for the list OE node"),!1}else if(!de.ParagraphReader.sh(D)&&!rh.TableReader.isTable(D))return u.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;D.sc();if(Q){if(this.Epm(Q)){const ba=Q.MD(),ta=Cd.OutlineElementReader.mEa(D);this.lg.Dya(D,1,ta+h);ba&&this.lj.dV(Q,ba,this.Ld.rg)}Tl.a.getInstance().Iv||Q.setValue(Gd.a.jR,new Date)}}return!0}sdn(b,h,v){for(let D=0;D<Uj.a.Mha;D++){const Q=
this.asa.Fx(b,h,D);if(!Q)return u.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ba=Q.getValue(lc.a.$d);ba&&Q.setValue(lc.a.$d,ba+v)}return!0}Epm(b){return b.hasProperty(lc.a.$d)||b.hasProperty(lc.a.at)||b.hasProperty(lc.a.LA)}ORk(b){return this.qCd(b,1,!0)}oSk(b){return this.qCd(b,-1,!0)}f7h(b,h){var v=new ne.GraphIterator;v.set(b);const D=Cd.OutlineElementReader.mEa(v),Q=Cd.OutlineElementReader.vG(v),ba=Cd.OutlineElementReader.R3(v);v=dh.OutlineReader.xX(b);
Tn.HQd(b);b=(Q?D-Q:ba)%v;return h?-1*(b?b:v):v-b>Tn.WOh?Tn.WOh:v-b}vNo(b,h){let v;const D=new ne.GraphIterator;D.set(b);b=D.Sb(4).getValue(lc.a.listID);return({id:v}=this.asa.Ulc(b,h)).returnValue?{returnValue:!0,groupId:v}:{returnValue:!1,groupId:v}}lSk(b,h,v){var D=!1;for(let Q=0;Q<b.length;Q++){D=b[Q];const ba=new ne.GraphIterator;ba.set(D.node);We.SelectionEditor.mu(ba);if(!Cd.OutlineElementReader.Dh(ba))return Tn.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.Jfb}),!1;if(this.qCd(ba,h,v))D=!0;else return Tn.Ic.Yb(Oe.a.O4b,
{["Reason"]:Fe.a.Q5e}),!1}return D}XYi(b,h){if(this.qCd(b,h,!0)){var v=!1;if(Hg.ListItemReader.Ig(b)){var D=new ne.GraphIterator;D.Zc(b);this.wq.fP(D);var Q=D.currentNode;D.sc();v=!0;const {listId:ta,listLevel:Ta}=Hg.ListItemReader.dQd(b);var ba=this.Scm(ta,Ta+h);if(ba)ig.OutlineElementNavigator.Ge(D),de.ParagraphReader.sh(D)&&Tn.ZG.PJ(ba,D.currentNode,!1),D.sc();else{ba=null;let ob;ig.OutlineElementNavigator.Ge(D);de.ParagraphReader.sh(D)&&(ba=D.currentNode);D.sc();ob=ba?ba.MD():null;ba||(ig.OutlineElementNavigator.Ge(D),
de.ParagraphReader.sh(D)&&(ba=D.currentNode),D.sc());ba&&(ba.hasProperty(lc.a.$d)&&ba.removeProperty(lc.a.$d),ba.hasProperty(lc.a.at)&&ba.removeProperty(lc.a.at));Tl.a.getInstance().VD||this.XD.IQb(Q,Ta+h);Tl.a.getInstance().Iv&&this.XD.IQb(ba,Ta+h);Tl.a.getInstance().VD||Q.removeProperty(lc.a.f0);ba&&ob&&(this.lj.dV(ba,ob,this.Ld.rg),this.Rs.i$());this.NEo(b,Q)}}v||(v=Cd.OutlineElementReader.mEa(b),D=Cd.OutlineElementReader.vG(b),Q=dh.OutlineReader.xX(b.currentNode),h=this.yll(b,v,D,h,Q),this.lg.Dya(b,
1,h))}}xNm(b,h){const v=Cd.OutlineElementReader.mEa(b),D=Cd.OutlineElementReader.vG(b),Q=Cd.OutlineElementReader.R3(b),{Bo:ba,marginLeft:ta,marginRight:Ta}=Tn.HQd(b.currentNode);if(0<h){if(b=ba-ta-Ta,Q&&Q+h+Ya.App.vza>b||v+h+Ya.App.vza>b)return!1}else if(Q&&0>v+h||0>v-D+h)return!1;return!0}wNm(b,h){var v=this.Rs.vB(b);const D=v.level+h;if(jw.a.XWm<D||D<jw.a.TDl)return!1;v=this.wq.Fx(b.currentNode,v.listID,D);if(!v)return u.ULS.shipAssertTag(590700875,338,!!v),!1;if(0<h&&v.hasProperty(lc.a.$d)){h=
v.getValue(lc.a.$d);const {Bo:Q,marginLeft:ba,marginRight:ta}=Tn.HQd(b.currentNode);if(h+Ya.App.vza>Q-ba-ta)return!1}return!0}Scm(b,h){const v=this.wc.Mr();for(let D=0;D<v.lO;D++){const Q=v.yEa(D);if(this.wq.kCb(Q)&&Q.ia(lc.a.listID,this.Rs.S8+1)===b&&Q.ia(lc.a.listLevel,-1)===h)return Q}return null}NEo(b,h){ig.OutlineElementNavigator.Ge(b);if(de.ParagraphReader.sh(b)&&b.currentNode.hasProperty(lc.a.$d)&&(h=this.wq.K7b(h))){if(h.hasProperty(lc.a.at)){var v=h.getValue(lc.a.at);this.OMe.job(b.currentNode,
v)}h.hasProperty(lc.a.$d)&&(v=h.getValue(lc.a.$d),this.OMe.Dya(b,1,v));h.hasProperty(lc.a.LA)&&(h=h.getValue(lc.a.LA),this.OMe.dda(b.currentNode,h))}ig.OutlineElementNavigator.Vd(b)}static get ZG(){return null!=Tn.eJg?Tn.eJg:Tn.eJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get n9d(){return null!=Tn.mFg?Tn.mFg:Tn.mFg=Ga.a.instance.Na("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return Tn.Ks||(Tn.Ks=Ga.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){Tn.Ks=
b}static get Ic(){return Ye.a.instance}static get Tf(){return Zn.a.instance}static get vh(){return Rl.PageNavigator.instance}static HQd(b){var h=kw.WordSectionNavigator.instance.EJ(b);b=Tn.Tf.$t(h);const v=Tn.Tf.mJ(h);h=Tn.Tf.ZK(h);return{Bo:b,marginLeft:v,marginRight:h}}}Tn.WOh=Nf.a.Hv(.25);Tn.Ks=null;Tn.QNi=Nf.a.Hv(-11);Object(n.a)(Tn,"OutlineElementIndentationEditor",null,[599,600]);var Iz=c(232),Ry;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=
3]="table"})(Ry||(Ry={}));Object(n.b)("StyleTargetType",Ry);var Tq=c(214);class Jz{constructor(b,h){this.HW=null;this.qK=h;this.If=b}get paragraphEditor(){return null!=this.VEg?this.VEg:this.VEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get HH(){return null!=this.Azg?this.Azg:this.Azg=Ga.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Gn(){return null!=this.PGg?this.PGg:this.PGg=Ga.a.instance.Na("Box4.Styles.StyleSettings")}get Sn(){return null!=this.Szg?this.Szg:this.Szg=Ga.a.instance.resolve("Box4.IFormattingEditor")}get wc(){return null!=
this.HJg?this.HJg:this.HJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Kda(){return this.HW||(this.HW=new Jv.WACStyleSet)}set Kda(b){this.HW=b}get Xb(){return null!=this.ezg?this.ezg:this.ezg=Ga.a.instance.Na("Box4.IFeatureHelper")}get Un(){return this.qK.value}get rj(){return null!=this.XAg?this.XAg:this.XAg=Ga.a.instance.Na("Box4.IInsertionPointFormatting")}get Z0d(){return this.If||(this.If=Ga.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=
this.Bwg?this.Bwg:this.Bwg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Ld(){return null!=this.uIg?this.uIg:this.uIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.UHg?this.UHg:this.UHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get VQ(){return null!=this.mAg?this.mAg:this.mAg=Ga.a.instance.resolve("Box4.IBox4GraphWriter")}$cm(b){const h=b.node;var v=this.rj?this.rj.Y4h():null;if(v&&!v.equals(W.a.nil)){b=
h.Jc;if(!b)return null;v=b.Db(v);if(!v||(v=new Tq.a(v),1!==this.wc.yG(v)))return null}else v=Hn.FormattingReader.Kr(b),v=Hn.FormattingReader.Ona(v);return v}Amo(b,h){const v=this.wc.MC(h);v&&v.Pi(this.wc.pg(b))&&(this.Smg(h,v),this.rj&&(this.rj.N5a(),this.rj.D6a(b,h)))}nDk(b,h){if(h)if(h.vDb&&0<h.vDb.length){let Q=new za.a;for(var v of h.vDb)Q.add(v);if(h.GDi){v=Hn.FormattingReader.j3h(b);const ba=[];for(var D of v)D.formatting&&D.formatting.yn&&ba.push(D.formatting.yn);if(0<ba.length){D=zy.APropertySet.E$h(ba);
v=new za.a;for(const ta of Q)(!D.hasProperty(ta)||h.IVm&&ta===qe.a.NIa)&&v.add(ta);Q=v}}this.paragraphEditor.C2b(b,!0,Q)}else this.paragraphEditor.C2b(b,!0);else Lc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}PJ(b,h,v,D=!1,Q=!1,ba=!1,ta=null){var Ta;if(de.ParagraphReader.Vb(h))if(b)if(this.wc.jY(b.wl()))if(2!==this.wc.yG(b))u.ULS.shipAssertTag(593506381,324,!1);else{var ob=this.wc.MC(h);if(ob){var Kb=this.wc.pg(b);if(!Kb)u.ULS.shipAssertTag(593506377,
324,!1);else if(ob.Pi(Kb)){var Vb=null,bc=jr.a.instance.J(1)&&!D?h.MD():null;v||(ta&&ta.FRk&&this.Xb&&this.Xb.isFeatureEnabled(100)?(this.nDk(h,ta),Di.a.Pj&&1==ta.vDb.length&&ta.vDb[0]==qe.a.NIa?Vb=this.Un.A6i(Vb,h):this.HVo(h,b,ta)):(Vb=this.Un.A6i(Vb,h),this.paragraphEditor.C2b(h,!0)));this.Smg(h,ob);Q&&bc&&bc.hasProperty(Ve.a.paragraphStyle)&&bc.removeProperty(Ve.a.paragraphStyle);(null===(Ta=this.VQ)||void 0===Ta?0:Ta.Q9)?this.VQ.Q9(h,Ve.a.paragraphStyle,b.id):h.properties.setValue(Ve.a.paragraphStyle,
b.id);Di.a.Pj&&this.Z0d.LC(h)&&this.Xb&&this.Xb.isFeatureEnabled(100)&&this.VEj(h,b,ta);h.lN=b;h.RHa=null;for(v=0;v<h.pa.length;v++)h.pa.J(v).formatting&&h.pa.J(v).formatting.q$b();this.Z0d.kCb(b)&&(Vb||(Vb=new ne.GraphIterator,Vb.set(h),Vb.vd(),ig.OutlineElementNavigator.Vd(Vb)),Hg.ListItemReader.Ig(Vb)||(h.Eg(lc.a.$d,lc.a.SM,lc.a.LA,lc.a.A0,lc.a.LRa,lc.a.uw),this.BAd(Vb,b)));this.Gn&&this.Gn.isProgressiveStyleEnabled&&null!=this.HH&&this.HH.Ljc(Kb);D||!bc||ba||this.lj.dV(h,bc,this.Ld.rg)}}else u.ULS.shipAssertTag(593506379,
324,!1)}else u.ULS.shipAssertTag(593506382,324,!1);else u.ULS.shipAssertTag(593506383,324,!1);else u.ULS.shipAssertTag(593506384,324,!1)}HVo(b,h,v){const D=this.Z0d.LC(b),Q=this.Z0d.kCb(h);D&&(this.VEj(b,h,v),Q||D.removeProperty(lc.a.f0))}VEj(b,h,v){const D=b.Jc;if(b=this.characterPropertiesEditor.f0a(b)){var Q=null==b.yn?new Iz.a:b.yn.clone();Pl.a.PWo(Q,h,v&&!v.GDi&&v.vDb?v.vDb:null);Q.BFa?h=D.GR(Q,!0):(D.Lu(Q,null),h=Q);b.Qj=h.id}else u.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}BAd(){}ahe(b,
h){if(h){u.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var v=this.wc.MC(h);v?(b=v.Rva(b))?this.wc.jY(b.wl())?this.PJ(b,h,!1,void 0,void 0,void 0,null):u.ULS.shipAssertTag(593506368,324,this.wc.jY(b.wl())):u.ULS.shipAssertTag(593506369,324,!!b):u.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else u.ULS.shipAssertTag(593506372,324,!1)}k7e(b,h=!1,v=!1){const D=this.wc.MC(b).Pi(hj.StyleReader.wordStyleIdNormal);this.PJ(D,b,h,void 0,
v)}Smg(b,h){(b=Jz.vh.Xs(b))&&h.Yic(b)}QPh(b){var h=null;if(this.Xb&&this.Xb.isFeatureEnabled(36)){if(!b||!b.count)return u.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=Pl.a.Lr(),!h))return u.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var v=this.Kda.TQ(h);if(!v)return u.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var D=new Map;D.set("NumberOfStyles",b.count.toString());D.set("Source",
"DeleteStyleAPI");wa.Health.instance.recordKpiUsage(eq.a.Toe,0,eq.a.sB,D);D=0;const ta=(new Date).getTime();var Q=null;let Ta=null,ob=null,Kb=null;const Vb=this.Xb.isFeatureEnabled(35)&&!0;Vb&&(Q=new zb.a,Ta=new zb.a,ob=new zb.a,Kb=new zb.a);for(var ba of b){if(!ba)return u.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const bc=v.Pi(ba);if(!bc||!this.wc.je(bc,v))return u.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!bc,!!bc&&this.wc.je(bc,
v)),!1;const Dc=this.wc.yG(bc);if(2!==Dc&&1!==Dc)return u.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Dc),!1;const Oc=this.wc.Iva(bc,v);let gd=0;if(Oc){if(!this.wc.je(Oc,v))return u.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;gd=this.wc.yG(Oc);if(2!==gd&&1!==gd)return u.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Dc,gd),!1}else u.ULS.sendTraceTag(592221658,
3018,50,"Provided style's linked style is null.");let rd=this.WBb(bc,v);if(!rd)return!1;D++;Vb&&(1===Dc?(Ta.add(ba),Kb.add(bc.id)):(Q.add(ba),ob.add(bc.id)));if(Oc){rd=this.WBb(Oc,v);if(!rd)return!1;D++;Vb&&(1===gd?(Ta.add(this.wc.pg(Oc)),Kb.add(Oc.id)):(Q.add(this.wc.pg(Oc)),ob.add(Oc.id)))}}qp.a.$Sc();v=Pl.a.duf(v);ba=new ah.GraphTransaction(15);ba.Cb(h);Vb&&this.s_n(Q,Ta,ob,Kb,h);h.setValue(Ve.a.ija,v);Lc.b(572302817,3018,50,String.format("Style Object Ids - {0}",v));ba.Zfe();ba.dispose();h=(new Date).getTime();
Q=new Map;Q.set("Source","DeleteStyleAPI");Q.set("NumberOfStyles",b.count.toString());Q.set("TrueStyleCount",D.toString());Q.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new wb.a,{extendedProperties:Q,durationMs:h-ta});wa.Health.instance.recordKpiSuccess(eq.a.Toe,b);return!0}return!1}s_n(b,h,v,D,Q){if(b&&b.count||h&&h.count)if(Q){var ba=(new Date).getTime();if(Q=this.cUl(Q)){for(;Q.moveNext();){if(!de.ParagraphReader.sh(Q.iterator))continue;const ta=Q.currentNode;this.c_n(ta,b,v);
this.d_n(ta,h,D)}v=(new Date).getTime();u.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",v-ba));D=new Map;D.set("Source","DeleteStyleRemoveStylesReferences");D.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new wb.a,{extendedProperties:D,durationMs:v-ba});wa.Health.instance.recordKpiSuccess(eq.a.Toe,b)}}else Lc.b(577520338,3018,50,"PageContentNode not provided.");else Lc.b(577520337,3018,50,"No style IDs provided")}c_n(b,h,v){if(h&&h.count&&
b){var D=b.yz;D&&D.hasProperty(Ve.a.paragraphStyle)&&v.contains(D.getValue(Ve.a.paragraphStyle))&&(D.removeProperty(Ve.a.paragraphStyle),b.yz=D,b.MD()&&this.lj.dV(b,b.MD(),this.Ld.rg));(v=this.wc.No(b))&&(v=this.wc.pg(v))&&h.contains(v)&&this.k7e(b,!0,!0)}}d_n(b,h,v){if(b&&b.pa&&b.pa.length&&h&&h.count)for(let ta=0;ta<b.pa.length;ta++){var D=b.pa.J(ta);if(D&&D.formatting&&(D=D.formatting)&&D.Ib){var Q=Hn.FormattingReader.Ona(D);Q&&(Q=this.wc.pg(Q))&&h.contains(Q)&&this.Sn.a7e(D);if(Q=D.Ib.Wn){var ba=
Q.yn;ba&&(ba=ba.clone(),ba.hasProperty(Ve.a.hw)&&v.contains(ba.getValue(Ve.a.hw))&&this.oYn(b,ba,Q,D));jr.a.instance.J(1)&&(ba=ta===b.pa.length-1?b.characterData.length:b.pa.J(ta+1).cp,this.lj.XNb(b,D.Ib,D.Ib.cp,ba,Q,D,this.Ld.rg))}}}}oYn(b,h,v,D){b&&h&&v&&D&&(b=b.Jc)&&(h.removeProperty(Ve.a.hw),h.BFa?h=b.GR(h,!0):b.Lu(h,null),v.Qj=h.id,D.Ib.Wn=v)}cUl(b){if(!b)return null;b=ne.GraphIterator.$a(b);return b.Ep()?nc.a.Qs(b,b.origin):null}WBb(b,h){if(!b)return u.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),
!1;var v=b.wl();return this.wc.jY(v)?h.r_n(b)?!0:(v=new Map,v.set("Source","DeleteStyle"),v.set("StyleType",Ry[this.wc.yG(b)]),v.set("IsCustomStyle",this.wc.je(b,h).toString()),v.set("IsLinkedStyle",(!!this.wc.Iva(b,h)).toString()),b=Object.assign(new wb.a,{extendedProperties:v}),wa.Health.instance.recordKpiFailure(eq.a.Toe,"UnableToDeleteStyle",!1,!0,b),u.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(u.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),
!1)}iRa(b,h,v,D){if(this.Xb&&this.Xb.isFeatureEnabled(81)){if(!b)return u.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!v&&(v=Pl.a.Lr(),!v))return u.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ba=this.Kda.TQ(v);if(!ba)return u.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ba.Pi(b);if(!b)return u.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Q=this.wc.yG(b);
if(2!==Q&&1!==Q)return u.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",Q),!1;wa.Health.instance.recordKpiUsage(eq.a.ipg,0,eq.a.sB,new Map([["Source","ModifyStyleAPI"]]));Q=Date.now();const ta=new ah.GraphTransaction(15);let Ta,ob;try{ta.Cb(v);if(!(D&&0!=D.length||h&&0!=h.count))return!1;if(D&&0!=D.length&&(Ta=Pl.a.eQd(b),!ba.Kjl(b,D)))return this.axa("ModifyStyleAPI",b,ba,Q,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Oc=ba.MXo(b,h);ob=Pl.a.eQd(b);if(!Oc)return this.axa("ModifyStyleAPI",
b,ba,Q,"UnableToModifyStyle"),!1}this.udn(b,v,ob,Ta);qp.a.$Sc();const Kb=Pl.a.duf(ba);v.setValue(Ve.a.ija,Kb);Lc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Kb));const Vb=Date.now(),bc=new Map([["Source","ModifyStyleAPI"]]),Dc=Object.assign(new wb.a,{extendedProperties:bc,durationMs:Vb-Q});wa.Health.instance.recordKpiSuccess(eq.a.ipg,Dc);return!0}finally{ta&&ta.dispose()}}return!1}udn(b,h,v,D){var Q,ba;if(null!==b){var ta;D&&((ta=null===(Q=this.Un)||void 0===Q?void 0:Q.Bne(h,D,b,!0))||
Lc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));v&&((ta=null===(ba=this.Un)||void 0===ba?void 0:ba.Bne(h,v,b,!1))||Lc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}axa(b,h,v,D,Q){const ba=Date.now();b=new Map([["Source",b],["StyleType",Ry[this.wc.yG(h)]],["IsCustomStyle",this.wc.je(h,v).toString()],["IsLinkedStyle",(!!this.wc.Iva(h,v)).toString()]]);D=Object.assign(new wb.a,{extendedProperties:b,
durationMs:ba-D});wa.Health.instance.recordKpiFailure(eq.a.ipg,Q,!1,!0,D)}static get vh(){return Rl.PageNavigator.instance}}Object(n.a)(Jz,"WACStyleEditor",null,[1450]);class Cw extends Jz{constructor(b,h,v){super(b,v);this.s6=h}get Rs(){return this.s6.value}BAd(b,h){this.Rs.BAd(b,h)}}Object(n.a)(Cw,"WACStyleEditor",Jz,[]);class Sy{w6a(b,h){b.properties.setValue(lc.a.marginTop,h)}u6a(b,h){b.properties.setValue(lc.a.marginBottom,h)}Tia(b,h){b.properties.setValue(lc.a.marginLeft,h)}v6a(b,h){b.properties.setValue(lc.a.marginRight,
h)}Zag(b,h){b.properties.setValue(lc.a.Bo,h)}Yag(b,h){b.properties.setValue(lc.a.nv,h)}klj(b,h){b.properties.setValue(lc.a.SDi,h)}UNb(b,h){b.properties.setValue(qe.a.NE,h)}Ofo(b,h){b.properties.setValue(qe.a.pma,h)}Hic(b,h){b.properties.setValue(qe.a.eG,h)}fmo(b,h){b.properties.setValue(qe.a.separator,h)}}Object(n.a)(Sy,"WordSectionEditor",null,[332]);class EA{get name(){return"WordEditor.OutlineLevelEditors"}xc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new Sy).as("Box4.IWordSectionEditor").singleInstance();
w.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new Bw(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Tn(yt.a.cPa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Tn(yt.a.cPa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new LB).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new KB.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),
new Jv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new Cw(b.resolve("Box4.List.IListReader"),b.Ue("WordEditor.IFlatListEditor"),b.Ue("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Fc(new EA)}}Object(n.a)(EA,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var FA=c(1197),kx=c(210);class Lm{constructor(b,h){this.Gd=b;this.nh=h;this.GLa=null}Ege(b){var h=
b.propertySet.ia(lc.a.listID,0);const v=b.propertySet.ia(lc.a.listLevel,-1);if(0<h&&0<=v)this.GLa=b;else{let D=1;const Q=b.listStyle;42!==Q&&0<Q&&(D=Q);this.GLa=bu.a.n_(b.listType,D,null,h,v,void 0,"")}h=new Nu.a;switch(b.H5){case 0:this.GLa.KB=h.W$e();break;case 2:this.GLa.KB=h.cKh(h.syh,h.ryh);break;case 1:this.GLa.KB=h.Oaf(h.DRf,h.ERf)}}Fko(b){b&&(this.GLa=b)}rLh(b){const h=Ye.a.instance.Ap(Eb.a.createList);Cd.OutlineElementReader.Dh(b)||Ye.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:Fe.a.Jfb});
Hg.ListItemReader.Ig(b)&&Ye.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:Fe.a.d4k});const v=Cd.OutlineElementReader.cU(b);v&&!v.hasProperty(lc.a.endOfParagraphFormatting)&&u.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const D=this.xal();b.Jf(D,4);v&&(v.VI=D);h.end();return D}xal(){return wq.a.instance.createInstance(393234)}Sca(b){const h=Ye.a.instance.Ap(Eb.a.Sca);Cd.OutlineElementReader.Dh(b)||Ye.a.instance.Yb("PossiblyIncorrectListRemoval",
{["Reason"]:Fe.a.Jfb});Hg.ListItemReader.Ig(b)&&(Tl.a.getInstance().Iv?this.XGa(b):this.u$i(b));h.end()}u$i(b){this.Gd.fP(b);b.Cg()}Sla(b,h,v,D=!1){const Q=Ye.a.instance.Ap(Eb.a.uDk);this.jmj(b,v,D);const ba=b.hasProperty(wc.a.oPi);var ta=b.ia(wc.a.EXd,!1);let Ta=!1;1===v.Sr&&v.Koa&&!v.zJ&&(Ta=!0);const ob=v.propertySet.ia(lc.a.lv,null);ob&&ob===Box4Intl.Box4Strings.L_ListStyleNone&&(1===v.listType?Ta=v.Koa&&!v.zJ:v.listType||(Ta=!v.listStyle));if(ta)Ta&&(v.O9(16,0),b.setValue(wc.a.GA,16),b.setValue(wc.a.KQa,
0));else{ta=this.Gd.lw(h);this.xqj(v,ta,ba,Ta)&&(Q.properties.Z("ToggledOff","true"),v.O9(16,0),this.vjo(b));if(!this.P9d(b,h,v,D))return Q.end(),u.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,owa:v};!v.listType&&b.hasProperty(wc.a.L3a)&&(v.RB=b.getValue(wc.a.L3a),b.removeProperty(wc.a.L3a))}if(ba&&(Q.properties.Z("MultipleOESelection","true"),({owa:v}=this.Zso(h,v)).returnValue))return Q.end(),u.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),
{returnValue:!1,owa:v};this.rzk(h,v,b,D);hu.a.adj();b.hasProperty(nh.a.pQ)&&hu.a.g8k(b.getValue(nh.a.pQ),h,this.Gd);b.setValue(wc.a.EXd,!0);Q.end();return{returnValue:!0,owa:v}}xqj(b,h,v,D){if(D)return!0;if(h){D=b.listType===h.listType;const Q=!b.listStyle&&b.RB===Uj.a.ql;let ba=b.listStyle===h.listStyle&&b.RB===h.RB;b=(!b.Koa||this.J8f(h,b))&&!v;ba=ba&&b;return D&&(Q||ba)}return!1}vjo(b){b.setValue(wc.a.GA,16);b.setValue(wc.a.KQa,0)}J8f(){return!0}jmj(){}P9d(){return!0}Zso(b,h){return{returnValue:16!==
h.listType&&Cd.OutlineElementReader.isEmpty(b,!0),owa:h}}nGc(b){const h=Ye.a.instance.Ap(Eb.a.nGc);de.ParagraphReader.Vb(b)||Ye.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:Fe.a.Mff});const v=new ne.GraphIterator;v.set(b);v.vd();v.Ht(12);ig.OutlineElementNavigator.Vd(v);this.XGa(v);h.end()}merge(b,h,v){const D=Ye.a.instance.Ap(Eb.a.xZm);Cd.OutlineElementReader.Dh(h)||Ye.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Cd.OutlineElementReader.Dh(b)||Ye.a.instance.Yb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});Hg.ListItemReader.Ig(h)&&(D.properties.Z("UseSourceListWithNonlistDestination",v.toString()),v&&Hg.ListItemReader.Ig(b)&&this.Sca(b),Hg.ListItemReader.Ig(b)&&!v?this.y3i(h,b):v&&(v=this.sai(h),1===v.Sr&&v.M6e(!0),this.oEc(b,v),D.properties.Z("MoveListInfoFromSrcToDestOE","true")),this.Sca(h),D.properties.Z("RemoveListFromSrcOE","true"));D.end();return!0}y3i(){}sai(b){return this.Gd.lw(b)}UKc(b,h){h.hasProperty(wc.a.GA)||(b===Eb.a.kD?h.setValue(wc.a.GA,1):(b===Eb.a.uL||
b===Eb.a.yca)&&h.setValue(wc.a.GA,0));h.hasProperty(wc.a.KQa)||h.setValue(wc.a.KQa,0);return h}m1b(b,h,v,D,Q,ba,ta,Ta){const ob=Ye.a.instance.Ap(Eb.a.m1b),Kb=this.Gd.lw(h);v=bu.a.n_(0,v,void 0,void 0,void 0,ta);v.RB=D;v.pQ=ba;Kb&&v.cxf(Kb)&&v.RB===Kb.Fu||(D=new ah.GraphTransaction(15),D.ku(h),Ta.numbering(v.listType,v.listStyle,v.RB,v.levelText,v.pQ)&&(Lm.characterPropertiesEditor.replaceTextRange(Q,""),de.ParagraphReader.Vb(b)&&kx.a.woa(b)&&(h=this.Gd.LC(b))&&Lm.characterPropertiesEditor.Ful(b,h)),
D.dispose());ob.end()}Bne(b,h,v,D=!1){if(null===v||null===b||null===h)return!1;b=this.Gd.Fx(b,h.listId,h.listLevel);if(!b)return u.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(D){if(b.hasProperty(Ve.a.paragraphStyle)){b.getValue(Ve.a.paragraphStyle)instanceof W.a||u.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");if(!W.a.Zp(b.getValue(Ve.a.paragraphStyle),v.id))return u.ULS.sendTraceTag(523069062,
393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(Ve.a.paragraphStyle);return!0}}else{v=v.id;v instanceof W.a||u.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(Ve.a.paragraphStyle))return u.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(Ve.a.paragraphStyle,v);return!0}return!1}static get s6b(){return null!=
Lm.wzg?Lm.wzg:Lm.wzg=Ga.a.instance.Na("Box4.IFontSlotProvider")}static get characterPropertiesEditor(){return null!=Lm.twg?Lm.twg:Lm.twg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Vn(){return Tl.a.getInstance()}}Object(n.a)(Lm,"ListEditor",null,[652]);var lx=c(807),Pu=c(316);class Us{constructor(b,h,v,D,Q,ba){this.If=Q;this._pageContent=v;this.Evb=Array(Us.Mha);this.sZb=Array(Us.Mha);this.ygh=Array(Us.Mha);this.FPe=Array(Us.Mha);this.Ich=Array(Us.Mha);this.F2=D;this.ECc=ba;
for(D=0;D<Us.Mha;D++){var ta=this.mai(b,D,v,Q);ta?(ba=ta.ia(Gd.a.h0,Uj.a.ql),ta=ta.ia(lc.a.f5c,Uj.a.ql)):ta=ba=Uj.a.ql;this.sZb[D]=ba!==Uj.a.ql?ba:Uj.a.aJc;this.FPe[D]=ta===Uj.a.ql?D-1:ta-1;Us.V8(h)&&(this.ygh[D]=Uj.a.ql,this.Ich[D]=Uj.a.ql);this.Evb[D]=this.sZb[D]}}mai(b,h,v,D){D.D3(v);return Tl.a.getInstance().vTc&&this.ECc?this.If.trf(b,h,this.F2,v):this.If.AOc(b,h,v.Jc,v)}restart(b){this.Evb[b]=this.sZb[b]}eQi(b){for(var h=0;h<b;h++)this.Evb[h]===this.sZb[h]&&this.Evb[h]++;for(h=b+1;h<Us.Mha;h++)this.FPe[h]>=
b&&this.restart(h);return this.Evb[b]++}static V8(b){return!!b&&b.isFeatureEnabled(71)}}Us.Mha=9;Object(n.a)(Us,"AWordList",null,[40]);class mx{constructor(b,h,v,D){this.Xab=new pq.ScriptSharpLegacyMap;this.If=b;this.vK=h;this.F2=v;this.ECc=D}lw(b,h){this.Xab.nb(b)||this.Xab.Z(b,new Us(b,h,this.vK,this.F2,this.If,this.ECc));return this.Xab.J(b)}KQf(b,h,v){return this.lw(b,v).eQi(h)}}Object(n.a)(mx,"AListNumberingMap",null,[1617]);class Kz extends Us{constructor(b,h,v,D,Q,ba){super(b,h,v,D,Q,ba)}F5l(b,
h,v,D){D.D3(v);return Tl.a.getInstance().vTc&&this.ECc?this.If.h1l(b,h,this.F2):this.If.g1l(b,h,this._pageContent.Jc)}PEj(b,h,v){var D=this.F5l(b,h,this._pageContent,this.If);D?(b=D.ia(Gd.a.h0,Uj.a.aJc),D=D.ia(lc.a.f5c,Uj.a.ql),this.Evb[h]=this.ygh[h]=this.sZb[h]=b,D!==Uj.a.ql&&(this.Ich[h]=this.FPe[h]=D-1)):v&&(D=this.mai(b,h,this._pageContent,this.If),b=Uj.a.aJc,D&&(b=D.ia(Gd.a.h0,Uj.a.aJc)),this.Evb[h]=this.sZb[h]=b)}}Object(n.a)(Kz,"WordList",Us,[]);class GA extends mx{constructor(b){super(b.Gd,
b.pageContentNode,b.JSa,b.WHj);this.bbh=new zb.a}H0l(b,h,v){let D;Tl.a.getInstance().iY?{value:D}=this.If.yJ.Dc(b,D):{value:D}=this.If.e0.Dc(b,D);this.Xab.nb(D)||this.Xab.Z(D,new Kz(b,v,this.vK,this.F2,this.If,this.ECc));if(!this.bbh.contains(b))for(this.bbh.add(b);h<Uj.a.Mha;h++)this.Xab.J(D).PEj(b,h,!1);else if(!h)for(h+=1;h<Uj.a.Mha;h++)this.Xab.J(D).PEj(b,h,!0);return this.Xab.J(D)}KQf(b,h,v){return Us.V8(v)?this.H0l(b,h,v).eQi(h):super.KQf(b,h,v)}}Object(n.a)(GA,"ListNumberingMap",mx,[]);class HA{constructor(){this.qRa=
0;this.KJj=!1}}Object(n.a)(HA,"LastNumber",null,[]);var MB=c(831),FC=c(609),ev=c(887);class dy{constructor(){this.startAt=this.FSa=0}}Object(n.a)(dy,"WordListRestartInfo",null,[]);class sp{constructor(b,h,v,D){this.m5d=!1;this.Rs=b;this.Pxi=v;this.A$b=D;this.ww=this.Rs.vB(h);this.outlineElement=new ne.GraphIterator;this.outlineElement.Zc(h)}static get Gd(){return sp.If||(sp.If=Ga.a.instance.resolve("Box4.List.IListReader"))}static set Gd(b){sp.If=b}static get Vn(){return Tl.a.getInstance()}static jCl(b,
h,v,D=!1,Q=!1){var ba=h.currentNode;let ta=null,Ta=!1,ob=!1;h=h.VQb();const Kb=nc.a.Zo(h);Kb.moveNext();for(h=Kb.iterator;h.currentNode!==ba;){let bc=ob=Ta=!1;var Vb=sp.Eql(h);if(Cd.OutlineElementReader.Dh(h)&&!Vb){Vb=!1;if(h.Nr(4))if(sp.zRi(h,v,!0,D,Q)){if(bc=!0,ta=new sp(b,h,!1,!1),Kb.moveNext(),Kb.iterator===ba&&(Ta=!0),D)break}else Cd.OutlineElementReader.isEmpty(h,!1)||(Vb=!0),ob=!0;else!Cd.OutlineElementReader.isEmpty(h,!1)&&h.kib(12)&&(Cd.OutlineElementReader.wQ(h)||(Vb=!0));!D&&Vb&&ta&&(v.propertySet.hasProperty(lc.a.listLevel)?
ta.ww.level=0:ta=null)}bc||Kb.moveNext();h=Kb.iterator}ta&&(ta.A$b=Ta);if(!ta&&h.vf(1))for(ba=!0;h.currentNode;){if(Cd.OutlineElementReader.Dh(h)){if(h.Nr(4)&&sp.zRi(h,v,!1,D,Q)){ta=new sp(b,h,!0,ba);break}if(!Cd.OutlineElementReader.isEmpty(h,!1))break}if(!h.vf(1))break;ba=!1}ta&&(ta.m5d=ob);return ta}static Eql(b){var h=b.Sb(2);if(!h)return!1;h=de.ParagraphReader.sh(b)&&sp.EOm(h);b.sc();return h}static EOm(b){return Ba.a(b,8)}static zRi(b,h,v,D=!1,Q=!1){sp.Gd.fP(b);var ba=b.currentNode;b.sc();const ta=
sp.Gd.DX(ba);(b=h.qz===ta.qz)&&h.listStyle&&1!==h.Sr&&(b=h.listStyle===ta.listStyle);b&&(h.Koa&&1!==h.Sr||h.E6b||Q)&&(b=sp.BMm(h,ta),h.qz||(b=b&&h.font===ta.font));if(1===h.Sr)if(1===ta.Sr&&ta.propertySet.hasProperty(nh.a.Vkb))b=h.H5===ta.H5;else return!1;b&&h.qz&&h.RB!==Uj.a.ql&&(b=ta.Fu,v&&(D&&1===h.RB&&1===b||b++),b=h.RB===b);b&&(D||h.E6b)&&(h=h.propertySet.ia(lc.a.listID,0),ba=ba.ia(lc.a.listID,0),0<h&&0<ba&&(b=h===ba));return b}static BMm(b,h){h=h.dJf;b.Koa&&(h=h.replace(RegExp("%\\d"),"%1"));
return h.toLocaleLowerCase()===b.dJf.toLocaleLowerCase()}static kCl(b,h,v){var D=h.currentNode;let Q=null;const ba=new ne.GraphIterator,ta=b.Jna(D,v);var Ta=!1;let ob=!1;ba.Zc(h);ba.sc();for(ba.Sb(1);ba.currentNode!==D;)ob=Ta=!1,Cd.OutlineElementReader.Dh(ba)&&ba.Nr(4)&&(h=b.vB(ba),sp.ARi(h,v,!0)?(Q=new sp(b,ba,!1,!1),Ta=!0):(ob=!0,h.listID===v.listID&&h.level<=ta.FSa&&(Q=null))),ba.vf(1);Q&&(Q.A$b=Ta);if(!Q&&ba.vf(1))for(D=!0;ba.currentNode;){if(Cd.OutlineElementReader.Dh(ba)&&ba.Nr(4)){Ta=b.vB(ba);
if(Ta.listID===v.listID&&Ta.level<=ta.FSa)break;if(sp.ARi(Ta,v,!1)){Q=new sp(b,ba,!0,D);break}}if(!ba.vf(1))break;D=!1}Q&&(Q.m5d=ob);return Q}static ARi(b,h,v){let D=b.listID===h.listID&&b.level===h.level;D&&h.Fu!==Uj.a.ql&&(b=b.Fu,v&&b++,D=h.Fu===b);return D}}sp.If=null;Object(n.a)(sp,"JoinTargetInfo",null,[]);class mr{constructor(b,h){this.ww=null;this.action=b;h&&(this.ww=h)}static $dc(){return new mr(0)}static LFi(){return new mr(1)}static ZYm(b){return new mr(3,b)}static pZm(b){return new mr(2,
b)}static bZm(b){return new mr(4,b)}}Object(n.a)(mr,"ApplyListInfoResult",null,[]);class ls{constructor(b,h,v){this.ekc=v;this.ywn=h;this.E$=v-h.Fu;this.l0c=h.listID}get delta(){-1!==this.E$&&(this.E$=this.ekc-this.ywn.Fu);return this.E$}set delta(b){this.E$=b}}Object(n.a)(ls,"ListTransferInfo",null,[]);class dp extends Lm{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){super(b,v,ob);this.XD=Dc;this.cgh=!1;this.hrc=this.Xgd=this.OTb=null;this.Qie=(Oc,gd)=>gd.listID===Oc.listID&&gd.level===Oc.level;
this.oxo=(Oc,gd,rd)=>gd.listID!==Oc.listID&&gd.listID!==rd.l0c||gd.level!==Oc.level?!1:!0;this.B$m=(Oc,gd,rd)=>gd.listID===Oc.listID||rd&&gd.listID===rd.l0c?!0:!1;this.ysj=(Oc,gd,rd,je,Ld)=>{const Qd=Oc.ia(Lm.Vn.uV,-1);this.xsj(Oc,gd,Qd+rd,je,Ld)};this.xsj=(Oc,gd,rd,je,Ld)=>{Tl.a.getInstance().VD||this.XD.mqb(Oc,je);gd=Hg.ListItemReader.Kq?gd:Oc;Oc=this.EEb(gd);gd=ne.GraphIterator.$a(gd);gd.vd();gd.sc();this.wGl(gd,Oc,this.B$m,this.qDo,Ld)};this.pxo=(Oc,gd,rd,je,Ld)=>{const {ww:Qd,iterator:ge}=this.P4b(gd,
()=>{Tl.a.getInstance().VD||this.XD.mqb(Oc,je);Tl.a.getInstance().Iv&&this.XD.mqb(gd,je);var ze=Hg.ListItemReader.Kq?gd:Oc;const gg=this.EEb(ze);ze=ne.GraphIterator.$a(ze);ze.vd();ze.sc();return{ww:gg,iterator:ze}});this.PMd(ge,Qd,this.Uvj,this.Sje,Ld)};this.oDo=(Oc,gd,rd,je,Ld)=>{this.e6i(Oc,gd,rd,je,Ld)};this.Sje=(Oc,gd,rd,je)=>{rd.listID=gd.listID;je.Sb(4);const Ld=this.wq.DEb(je.currentNode);this.P4b(Ld,()=>{this.pEc(je.currentNode,rd,Ld);je.sc()})};this.qDo=(Oc,gd,rd,je)=>{Hg.ListItemReader.Ig(je)&&
(Oc=new ne.GraphIterator,Oc.Zc(je),Oc.vd(),this.Gd.fP(Oc),this.Ssi(je.currentNode,Oc.currentNode))};this.pDo=(Oc,gd,rd,je,Ld)=>{rd.listID=gd.listID;this.e6i(Oc,gd,rd,je,Ld);this.Sje(Oc,gd,rd,je,Ld)};this.Tvj=(Oc,gd)=>gd.listID===Oc.listID;this.nDo=(Oc,gd)=>gd.level<=Oc.level;this.Uvj=(Oc,gd,rd)=>gd.listID===rd.l0c;this.Xo=Q;this.asa=b;this.Ykd=h;this.Gc=D;this.lYf={};this.q$j=ba;this.Sd=ta;this.qq=Ta;this.ld=Kb;this.Uy=Vb;this.Ru=bc}get V8(){return this.asa.oha}get dPb(){return this.cgh}set dPb(b){this.cgh=
b}get wq(){return this.asa}get w5(){return this.Ru}get wc(){return this.Uy}get fu(){return this.wq.fu}get Bq(){return this.wq.Bq}get zta(){return this.wq.zta}get S8(){return this.wq.S8}set S8(b){this.wq.S8=b}get DQa(){return this.wq.DQa}set DQa(b){this.wq.DQa=b}get B8c(){return null!=this.kGg?this.kGg:this.kGg=Ga.a.instance.Na("Box4.List.ISingleLevelListEditor")}rzk(b,h,v,D){u.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const Q=v.ia(wc.a.EXd,!1);let ba=!1,ta=-1;
!Q||h.listStyle&&1!==h.Sr||(ba=!v.ia(wc.a.kHf,!1),ta=v.ia(wc.a.cJf,-1));b=this.oEc(b,h,{Lpi:ba,CYm:ta,GGl:D,propertySet:v});Q||v.setValue(wc.a.kHf,2===b.action);3===b.action&&!v.hasProperty(wc.a.cJf)&&b.ww&&v.setValue(wc.a.cJf,b.ww.level)}merge(b,h,v,D=null){const Q=Hg.ListItemReader.Ig(b)||Hg.ListItemReader.Ig(h);b=super.merge(b,h,v,D);Q&&this.i$();return b}y3i(b,h){this.dTk(b,h)}dTk(b,h){b=this.Gd.mrf(b);const v=this.Gd.mrf(h);-1!==b&&-1!==v&&(b-=v,0<b?this.Ykd.value.iJc(h,b):0>b&&this.Ykd.value.XRa(h,
b,0))}u$i(b){this.Gd.fP(b);b.Cg();jr.a.instance.J(1)&&this.i$()}nLo(b,h,v,D){var Q=ne.GraphIterator.$a(v);Q=this.vB(Q);this.oLo(Q,b,h,v,D)}vB(b){if(!Hg.ListItemReader.Ig(b)&&(u.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),Hg.ListItemReader.Kq))return null;let h;Hg.ListItemReader.Kq?h=Hg.ListItemReader.Jva(b):(this.Gd.fP(b),h=b.currentNode,b.sc());return this.EEb(h)}Hlj(b,h){this.Gd.fP(b);const v=b.currentNode;b.sc();Tl.a.getInstance().VD||this.XD.mqb(v,h);b=
Cd.OutlineElementReader.cU(b);Tl.a.getInstance().Iv&&this.XD.mqb(b,h);return this.EEb(Hg.ListItemReader.Kq?b:v)}EEb(b){var h;const v=new lx.a;Hg.ListItemReader.Kq&&(b&&de.ParagraphReader.Vb(b)||u.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=jr.a.instance.J(1)?Hg.ListItemReader.Kq?Hg.ListItemReader.U3(b)||Hg.ListItemReader.lRd(b):this.Gd.IO(b,!1,!0):Hg.ListItemReader.U3(b,
{ZIc:0,IHd:-1});v.listID=h.listId;v.level=h.listLevel;v.f0=Hg.ListItemReader.bxf(b);h=this.jQd(b);v.Cho(h);v.Fu=Hg.ListItemReader.Kim(b);v.ZJc=Hg.ListItemReader.Iim(b);return v}Gge(b,h,v=!1){const D=v?null:Cd.OutlineElementReader.cU(b);b=Tl.a.getInstance().VD?null:this.rLh(b);this.pEc(b,h,D,v);return b}pEc(b,h,v=null,D=!1){b||Ye.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!Tl.a.getInstance().Iv||D||v||Lc.b(509364259,393,15,"Apply list info called without para node");h||Ye.a.instance.Yb("CrashWhenApplyingList",
{["Reason"]:"RefInfoIsNull"});Tl.a.getInstance().Iv&&v&&!D&&this.XD.Cge(v,h.listID,h.level);Tl.a.getInstance().VD||(this.XD.Cge(b,h.listID,h.level),h.f0&&b.setValue(lc.a.f0,!0),Tl.a.getInstance().Iv||null==h.levelText||b.setValue(lc.a.lv,h.levelText))}RFj(b){this.wq.D3(b);b=dp.vh.Xs(b);let h=b.ia(lc.a.Bq,null);h=h?Array.clone(h):[];b.setValue(lc.a.Bq,h);this.wq.s$b()}dDo(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}O0l(b){b=
b.view;if(!b.lb||!b.lb.gb)return null;b=vz.OutlineElementGeneralizer.qna(b.lb.gb,!1);if(1!==b.length)return null;b=ne.GraphIterator.$a(b.getContext(0).node);if(!Hg.ListItemReader.Ig(b))if(14===b.Qd().type){const h=this.wq.Ojm(b.currentNode);h&&b.set(h)}else Lc.b(589177753,393,15,"Encountered an OE of non list type."),b.sc();b.vd();return b}dbl(b,h,v,D){const Q=b.IH(),ba=new lx.a;ba.listID=this.KLh(b);this.V8?(ba.Q0d=Lm.Vn.iY?this.LLh(b):this.BLh(b),this.i7i(b,ba.listID,ba.Q0d)):this.k7i(b,ba.listID);
ba.slj(h.propertySet,this.nXc(v));this.bKd(b);v=this.qai(b,h);for(let Ta=0;9>Ta;Ta++){const ob=new Gs.a;Q.od.Lu(ob);this.j7i(b,this.V8?W.a.nil:ob.id,this.V8?ob.id:W.a.nil);this.qrk(ob,h.qz,Ta);this.hoh(ob,v,Ta);var ta=D.RIb[Ta];ta=6===ta?bu.a.n_(1,1):bu.a.n_(0,ta);ta.Bha&&ob.setValue(Gd.a.B4,ta.Bha);h.RB!==Uj.a.ql&&Ta===ba.level&&ob.setValue(Gd.a.h0,h.RB);D.XDa&&D.XDa[Ta]&&ob.setValue(Gd.a.font,D.XDa[Ta]);ta=D.pXc[Ta];u.ULS.shipAssertTag(22127636,338,!!ta);ob.setValue(lc.a.lv,ta);ob.setValue(lc.a.rca,
D.a0d[Ta]);Pu.a.qhe(D.H5,ob)}return ba}bbl(b,h,v){const D=b.IH(),Q=new lx.a;Q.listID=this.KLh(b);this.V8?(Q.Q0d=Lm.Vn.iY?this.LLh(b):this.BLh(b),this.i7i(b,Q.listID,Q.Q0d)):this.k7i(b,Q.listID);Q.slj(h.propertySet,this.nXc(v));if(!h.listStyle)switch(Q.level%3){case 0:h.O9(h.listType,1);break;case 1:h.O9(h.listType,2);break;case 2:h.O9(h.listType,3)}this.bKd(b);v=this.qai(b,h);for(let ba=0;9>ba;ba++){const ta=new Gs.a;D.od.Lu(ta);this.j7i(b,this.V8?W.a.nil:ta.id,this.V8?ta.id:W.a.nil);this.prk(ta,
h.qz,ba);this.hoh(ta,v,ba);2===ba%3&&h.qz?ta.setValue(lc.a.rca,"right"):ta.setValue(lc.a.rca,"left");ba===Q.level&&(h.Bha&&ta.setValue(Gd.a.B4,h.Bha),h.RB!==Uj.a.ql&&ta.setValue(Gd.a.h0,h.RB),h.qz?this.wlj(h,ta,ba):(dp.tlj(h,ta),dp.vlj(h,ta)),dp.ulj(h,ta),h.E6b&&ta.DNa(h.propertySet,lc.a.listID,lc.a.listLevel))}return Q}wlj(b,h,v){b.Koa?(b=b.levelText,b=G.a.replaceAll(b,"%1","%"+(v+1))):b=b.hTc||b.Tna?b.levelText:"%"+(v+1)+".";u.ULS.shipAssertTag(22127638,338,!!b);h.setValue(lc.a.lv,b)}xqj(b,h,v,
D){if(b.hTc)return!1;if(1===b.Sr)return D;if(D)return!0;if(h){D=b.listType===h.listType;const Q=!b.listStyle&&b.RB===Uj.a.ql;let ba=b.listStyle===h.listStyle&&b.RB===h.RB;b=(!b.Koa||this.J8f(h,b))&&!v;ba=ba&&b;return D&&(Q||ba)}return!1}bKd(b){this.OTb||(this.OTb=b.ia(lc.a.rhl,null));this.Xgd||(this.Xgd=b.ia(lc.a.qhl,null));this.hrc||(this.hrc=b.ia(lc.a.shl,null))}nXc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}BZl(b){return b?this.Xo.$T(b).Lt-this.Xo.vG(b).Lt:-1}k7i(b,h){const v=
b.ia(lc.a.fu,null),D=v?v.length:0,Q=Array(D+1);let ba=0;for(;ba<D;ba++)Q[ba]=v[ba];Q[ba]=h;b.setValue(lc.a.fu,Q);this.wq.s$b()}i7i(b,h,v){this.UYe(lc.a.fu,b,h);if(Lm.Vn.iY){this.UYe(qe.a.u4a,b,v);var D=this.wq.gQd(b);D.add(h,v);b.setValue(qe.a.yJ,FC.b(FA.a.tlc(D)))}else this.UYe(lc.a.zta,b,v),D=this.wq.fQd(b),D.add(h,v),b.setValue(lc.a.e0,FC.b(FA.a.tlc(D)))}j7i(b,h,v){this.V8?(this.Xnh(lc.a.Bq,b,v),this.Xnh(lc.a.n9,b,h)):(v=(v=b.ia(lc.a.Bq,null))?Array.clone(v):[],v.push(h),b.setValue(lc.a.Bq,v),
this.wq.s$b())}UYe(b,h,v){const D=h.ia(b,null),Q=D?D.length:0,ba=Array(Q+1);let ta=0;for(;ta<Q;ta++)ba[ta]=D[ta];ba[ta]=v;h.setValue(b,ba)}Xnh(b,h,v){let D=h.ia(b,null);D=D?Array.clone(D):[];D.push(v);h.setValue(b,D)}prk(b,h,v){var D=v%3+1;const Q=h?this.hrc:this.Xgd;Q&&v<Q.length?b.setValue(lc.a.at,Q[v]):b.setValue(lc.a.at,360);D=bu.a.n_(h?0:1,this.dDo(D),null,0,v);b.Vw(D.propertySet);b.setValue(lc.a.O2e,h?-1:-2);h?b.setValue(lc.a.lv,"%"+(v+1)+"."):(b.setValue(Gd.a.font,this.gTl(v)),b.setValue(lc.a.lv,
String.fromCharCode(this.WSl(v))));Pu.a.Qic(2,b)}qrk(b,h,v){const D=h?this.hrc:this.Xgd;D&&v<D.length?b.setValue(lc.a.at,D[v]):b.setValue(lc.a.at,360);b.setValue(lc.a.O2e,h?-1:-2);Pu.a.Qic(1,b)}WSl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}gTl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}KLh(b){if(this.V8)this.S8<Uj.a.DXc&&this.wq.D3(b),this.S8=this.nbi(this.fu,this.S8,Uj.a.DXc);
else{if(this.S8<Uj.a.DXc&&(this.wq.D3(b),this.fu&&this.Bq)){b=this.fu.length;for(let h=0;h<b;h++)this.fu[h]>=this.S8&&(this.S8=this.fu[h])}this.S8+=1}return this.S8}BLh(b){this.DQa<Uj.a.byd&&this.wq.D3(b);return this.DQa=this.nbi(this.zta,this.DQa,Uj.a.byd)}LLh(b){var h;this.wq.D3(b);do b=Math.floor(Math.random()*(dp.gan-dp.WNi))+dp.WNi;while(null===(h=this.wq.UJb)||void 0===h?0:h.includes(b));return b}nbi(b,h,v){if(h<v&&b){v=b.length;for(let D=0;D<v;D++)b[D]>h&&(h=b[D])}h++;return h}p2n(b,h){this.X0h(b,
h,1,this.Qie,this.ysj,null,!1)}o2n(b,h,v){this.xGl(b,h,v,this.Qie,this.xsj)}NHk(){this.i$()}i$(b=null){var h,v;if(jr.a.instance.J(1)){var D=new ne.GraphIterator;if(b)if(8===b.type)D.set(b);else{u.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else D.set(Ya.App.xa.hb.Uc),dp.vh.Jkg(D),b=dp.vh.Xs(D.currentNode);if(D.zb(7)||D.jd(7)){D=nc.a.Qs(D,D.origin);var Q=new GA({Gd:this.wq,pageContentNode:b,JSa:null,WHj:!1});for(b=new GA({Gd:this.wq,
pageContentNode:b,JSa:null,WHj:!1});D.moveNext();){var ba=D.iterator;let Ta;if(!Tl.a.getInstance().VD){if(!ba.Nr(4)&&!ba.Nr(31))continue;this.Gd.GJb(ba);Ta=ba.currentNode;ba.sc();if(!Ta){u.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ba.isValid);continue}}const ob=Hg.ListItemReader.Kq?Hg.ListItemReader.Jva(ba)||Hg.ListItemReader.u8l(ba):Ta;if(!this.V8&&!Hg.ListItemReader.eFf(ob)&&this.Gd.DX(ob).listType)continue;var ta=void 0;if(Hg.ListItemReader.Kq){if(!ob){u.ULS.sendTraceTag(509141473,
393,50,"Skipping updating list numbers because paraNode not found");continue}ta=Hg.ListItemReader.U3(ob)}else ta=this.Gd.IO(Ta,!1,!1);if(this.V8&&ta&&this.Gd.UYd(ta.listId)){u.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ta.listId);continue}const Kb=Hg.ListItemReader.Kq?ob:Cd.OutlineElementReader.cU(ba);Kb&&(Kb.pa?(null==Kb.pa.last&&u.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.V8&&this.wq.D3(ba.currentNode),
12===Kb.type&&(Kb.Ki&&Kb.yz.hasProperty(lc.a.listID)||null===(h=Kb.pa.last)||void 0===h||!h.$i)&&((ba=Hg.ListItemReader.Kq?Hg.ListItemReader.lRd(ob)||Hg.ListItemReader.U3(ob):this.Gd.IO(Ta,!0,!0))?this.ylj(Ta,ob,b,Lm.Vn.Mnc,ba):u.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ta.type)),!ta||null!==(v=Kb.pa.last)&&void 0!==v&&v.gi||!this.ylj(Ta,ob,Q,Lm.Vn.uV,ta)||(ta=Ta.getValue(Lm.Vn.uV),this.V8&&this.Gd.DX(ob).listType||Ta.setValue(Lm.Vn.Nda,ta))):
u.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else u.ULS.shipAssertTag(593234060,376,7===D.Ve,"Couldnt reach to page manifest node")}}ylj(b,h,v,D,Q){D||u.ULS.shipAssertTag(571757918,393,!!D,"Prop definition is null");v=v.KQf(Q.listId,Q.listLevel,this.ld);Q=-1;b.hasProperty(D)&&(Q=b.getValue(D));return v===Q||this.V8&&!Hg.ListItemReader.eFf(h)&&this.Gd.DX(h).listType&&(D!==Lm.Vn.Mnc||1!==this.Gd.DX(h).listType)?!1:(b.setValue(D,v),!0)}oLm(b,h){let v=
!1,D=!0,Q=0;const ba=this.vB(b),ta=b.currentNode;b=b.VQb();b=nc.a.Zo(b);for(b.oo(ev.a.HXc,null);b.moveNext();){var Ta=b.iterator.currentNode;if(Ta===ta)break;Hg.ListItemReader.Ig(Ta)&&(Ta=this.vB(b.iterator),Ta.listID===ba.listID&&(Ta.level>ba.level?(v=!0,Q++):Ta.level===ba.level?(D=!1,Q=0):Ta.level<=h.FSa&&(D=!0,Q=0)))}return v&&D&&!0}FBh(b,h){this.Gd.fP(b);const v=b.currentNode;b.sc();const D=this.vB(b);D&&this.wq.GXc(v,D.listID,D.level)&&this.o2n(b.currentNode,D,h)}sai(b){const h=this.Gd.lw(b);
h.E6b=!0;this.Gd.fP(b);const v=b.currentNode.ia(lc.a.listID,0);h.propertySet.setValue(lc.a.listID,v);b.jd(11);return h}YHf(b,h,v){const D=new ne.GraphIterator,Q=h.currentNode;let ba;var ta=Uj.a.ql;let Ta=!1,ob=!1,Kb=!1,Vb=null;var bc=h.VQb();bc=nc.a.Zo(bc);for(bc.oo(ev.a.HXc,null);bc.moveNext();){D.Zc(bc.iterator);if(D.currentNode===Q)break;Ta=!1;D.Nr(4)&&(ba=this.vB(D),ba.listID===b.listID&&(ba.level===b.level?(this.Gd.fP(D),ta=D.currentNode,D.sc(),ta=ta.ia(Lm.Vn.uV,Uj.a.ql),Ta=!0,Vb=D.Bmc(1),ob=
!0):ba.level>b.level?Kb=!0:ba.level<=v.FSa&&(ta=Uj.a.ql,Kb=ob=!1)))}!ob&&Kb&&(ta=v.startAt);Ta&&(Ta=h.Bmc(1)===Vb);b=new HA;b.qRa=ta;b.KJj=Ta;return b}k2n(b,h){var v=Hg.ListItemReader.Jva(b);if(dp.aQm)this.zVo(v,h);else{b=this.EEb(v);const ba=this.Jna(v,b),ta=this.wq.g1a(v,b);var D=new ne.GraphIterator;const Ta=ta.qz;let ob=ba.startAt,Kb=!1,Vb=!1;u.ULS.shipAssertTag(22127639,338,ta.Tna,"Info does not have a level Text.");D.set(v);if(D.vd()&&(v=D.HSa()))for(v=nc.a.Zo(v),v.oo(ev.a.HXc,b);v.moveNext();){D=
v.iterator.currentNode;if(!Hg.ListItemReader.Ig(D))continue;var Q=this.vB(v.iterator);Q.listID===h&&(Q=this.Hlj(v.iterator,b.listID));if(Q.listID!==b.listID)continue;const bc=v.iterator.Sb(4);bc&&v.iterator.sc();Q.level>b.level?(this.wq.GXc(bc,b.listID,Q.level)&&this.Ssi(D,bc),Vb=!0):(Q.level<=ba.FSa?(ob=ba.startAt,Vb=Kb=!1):(Q=v.iterator,this.Gd.fP(Q),Lm.Vn.Iv||Q.currentNode.setValue(lc.a.lv,ta.dJf),{Wao:Kb,qRa:ob}=this.n2n(Ta,Vb,Kb,Q,ob,D)),dp.hDm(v))}}}zVo(b,h){const v=this.EEb(b),D=new ne.GraphIterator;
D.set(b);if(D.vd()&&(b=D.HSa())){b=nc.a.Zo(b);for(b.oo(ev.a.HXc,v);b.moveNext();)Hg.ListItemReader.Ig(b.iterator.currentNode)&&this.vB(b.iterator).listID===h&&this.Hlj(b.iterator,v.listID);u.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Ssi(b,h){u.ULS.shipAssertTag(22819227,338,!!b&&!!h);h.setValue(ff.a.EFi,W.a.create().toString())}n2n(b,h,v,D,Q,ba){b?(h&&!v&&Q++,ig.OutlineElementNavigator.Vd(D),this.FBh(D,Q),Q++,v=!0,D.Sb(2),MB.a.fEf(D.currentNode)&&D.currentNode.Tk(4,
!0)):(D.currentNode.removeProperty(Lm.Vn.uV),ig.OutlineElementNavigator.Vd(D));ba.Tk(4,!0);(b=D.Xn(16))&&b.Tk(8,!0);return{Wao:v,qRa:Q}}Jna(b,h){const v=Ye.a.instance.Ap(Eb.a.Jna),D=new dy;(b=this.wq.Fx(b,h.listID,h.level))?(D.FSa=b.ia(lc.a.f5c,h.level-1),D.startAt=b.ia(Gd.a.h0,1)):Ye.a.instance.Yb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});v.end();return D}fdl(b){const h=wq.a.instance.createInstance(1074135151);b.Jf(h,31)}j_n(b){b.Sb(31)&&b.Cg()}oLo(b,h,v,D,Q){const ba=this.Gge(h,
b,!0);h=this.wq.g1a(h.currentNode,b);h.listType||(ba.setValue(Lm.Vn.uV,b.Fu),ba.setValue(Lm.Vn.Nda,b.ZJc),this.Cbj(ba,b,v?D:Q));switch(h.listType){case 0:v="Numbering";break;case 1:v="Bullet";break;default:v="Invalid List Type"}w.AFrameworkApplication.va.processAction(Eb.a.joinList,2);u.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",v);Tl.a.getInstance().VD||this.XD.Cge(ba,b.listID,b.level)}n$i(b){var h=this.wc.No(b);h?this.wc.pg(h)===hj.StyleReader.wordStyleIdListParagraph&&(h=
this.wc.MC(b),this.w5.PJ(h.Pi(hj.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.dPb)):u.ULS.shipAssertTag(8271188,315,!1)}qjo(b){if(this.wc.pg(this.wc.No(b))===hj.StyleReader.wordStyleIdNormal){const h=this.wc.MC(b);this.w5.PJ(h.Pi(hj.StyleReader.wordStyleIdListParagraph),b,!0,!0)}b.Eg(lc.a.$d,lc.a.SM,lc.a.LA,lc.a.A0,lc.a.at,lc.a.hia);b.setValue(lc.a.LRa,0)}UTk(b,h){const v=b.getValue(lc.a.listID),D=b.getValue(lc.a.listLevel);for(let ba=0;9>ba;ba++){const ta=this.wq.Fx(b,v,ba);if(!ta)return Ye.a.instance.Yb("PossiblyIncorrectListStyle",
{["Reason"]:"ListDefIsNull"}),null;var Q=h.RIb[ba];Q=6===Q?bu.a.n_(1,1):bu.a.n_(0,Q);Q.Bha&&ta.setValue(Gd.a.B4,Q.Bha);ta.hasProperty(Gd.a.font)&&ta.removeProperty(Gd.a.font);h.XDa&&h.XDa[ba]&&ta.setValue(Gd.a.font,h.XDa[ba]);Q=h.pXc[ba];u.ULS.shipAssertTag(22127641,338,!!Q);ta.setValue(lc.a.lv,Q);ta.setValue(lc.a.Sr,Pu.a.Odc);Pu.a.qhe(h.H5,ta);ta.setValue(lc.a.rca,h.a0d[ba]);ta.Eg(lc.a.f5c,Gd.a.h0);this.RFj(b)}b=new lx.a;b.listID=v;b.level=D;return b}STk(b,h,v,D){if(D)return this.UTk(b,D);D=b.getValue(lc.a.listID);
const Q=b.getValue(lc.a.listLevel),ba=this.wq.Fx(b,D,Q);if(!ba)return Ye.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&u.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,D,Q),null;h.E6b&&(ba instanceof zy.APropertySet?ba.DNa(h.propertySet,lc.a.listID,lc.a.listLevel):u.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===
ba||void 0===ba?void 0:ba.constructor.name));var ta=ba.ia(lc.a.Sr,null);ta&&ta===Pu.a.Odc&&this.RTk(b,D);if(!h.listStyle){ta=0;if(-1!==v){for(ta+=Q-v;0>ta;)ta+=3;ta%=3}switch(ta){default:v=1;break;case 1:v=2;break;case 2:v=3}h.O9(h.listType,v)}h.Bha&&ba.setValue(Gd.a.B4,h.Bha);h.qz?(this.wlj(h,ba,Q),ba.hasProperty(Gd.a.font)&&ba.removeProperty(Gd.a.font)):(dp.tlj(h,ba),dp.vlj(h,ba));dp.ulj(h,ba);ba.Eg(lc.a.f5c,Gd.a.h0,lc.a.fVc);this.RFj(b);b=new lx.a;b.listID=D;b.level=Q;return b}RTk(b,h){let v;for(let D=
0;9>D;D++){v=this.wq.Fx(b,h,D);if(!v){u.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,D);break}v.setValue(lc.a.Sr,Pu.a.oVd);v.removeProperty(nh.a.Vkb)}}Fge(b,h){const v=Ye.a.instance.Ap(Eb.a.Fge);this.Ykd.value||Ye.a.instance.Yb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.GLa?(v.properties.Z("PendingListInfo","true"),Hg.ListItemReader.Ig(b)&&(v.properties.Z("RemoveCurrentListInfo","true"),this.dPb=!0,this.XGa(b),
this.Ykd.value.XRa(b,-1,0),this.dPb=!1),16!==this.GLa.listType&&this.oEc(b,this.GLa,{Lpi:!0,hIl:!0}),this.GLa=null):h||(v.properties.Z("CurrentlyUnderPastedList","true"),this.XGa(b,{e$i:!0}));v.end()}Ahe(b,h){var v;if(Hg.ListItemReader.Ig(b))return!1;b.Sb(2);var D=Dp.a.nIk;const Q=[!0,!1].map(ba=>de.ParagraphReader.jg(b.currentNode,ba,void 0,!1));b.sc();for(let ba=0;ba<Q.length;ba++){const ta=Q[ba];if(ta&&!kx.a.woa(ta))for(const Ta of D)if(Ta.test(ta.characterData))return D=null===(v=Ta.exec(ta.characterData))||
void 0===v?void 0:v[0],this.pRn(h,ba?"nextPara":"prevPara",D),!1}return!0}pRn(b,h,v){const D=new Map;D.set("CurrentAutoListPreventedAutoListText",b);D.set("UndoAutoListPreferenceFoundIn",h);D.set("UndoAutoListPreferenceAutoListText",v);wa.Health.instance.recordKpiUsage(Uj.a.tkb.MXn,0,Uj.a.sB,D)}oto(b,h){return b&&h}o$i(b){for(let h=0;h<b.count;h++){const v=ne.GraphIterator.$a(b.J(h));v.Ep();this.Sca(v)}b.clear()}m2n(b){Hg.ListItemReader.Ig(b)&&this.i$()}A6i(b,h){b=new ne.GraphIterator;b.set(h);b.vd();
ig.OutlineElementNavigator.Vd(b);b.jib(h)||Ye.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.XGa(b);return b}Wio(b,h,v){this.nh.Dya(b,h,v,!0)}djo(b){b.O9(1,1)}BAd(b,h){const v=Ye.a.instance.Ap(Eb.a.iEk);if(this.wc.jY(h.wl())){if(Hg.ListItemReader.Ig(b)&&this.XGa(b),h=this.wq.yai(h)){v.properties.Z("EarlyReturn","False");this.wq.g1a(b.currentNode,h);var D=sp.kCl(this,b,h);if(D)D=this.xlj(b,D,!0);else{D=this.rLh(b);var Q=this.PMd(b,h,this.Tvj,this.oDo);
if(Q){const ba=this.vB(Q);if(ba.listID===h.listID&&ba.level<h.level&&this.Gd.lw(Q).qz){const ta=this.Jna(Q.currentNode,ba);ba.Fu===(ta.startAt===Uj.a.ql?1:ta.startAt)&&(ba.ZJc=ba.Fu,this.Cbj(D,ba,Q.currentNode))}}Q=this.Jna(D,h);b=this.YHf(h,b,Q);b=b.qRa!==Uj.a.ql?b.qRa+1:Q.startAt===Uj.a.ql?1:Q.startAt;Tl.a.getInstance().VD||this.pEc(D,h,null,!0);D.setValue(Lm.Vn.uV,b);D.setValue(Lm.Vn.Nda,b)}Tl.a.getInstance().VD||D.setValue(lc.a.f0,!0);v.end()}}else Ye.a.instance.Yb("PossiblyIncorrectListStyle",
{["Reason"]:"StyleContainerNotValid"})}Cbj(b,h,v){this.wq.GXc(b,h.listID,h.level)&&this.p2n(v,h)}uEk(b,h,v){if(!Hg.ListItemReader.Ig(h)&&(u.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),Hg.ListItemReader.Kq))return;const D=h.Sb(4);h.sc();(h=Cd.OutlineElementReader.cU(h))||Lc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.JLh(b,v,0,null);this.pEc(D,b,h);return b}JLh(b,h,v,D=null){b=D?this.dbl(b,h,v,D):
this.bbl(b,h,v);Lm.Vn.Iv||(h.Tna?(h=h.levelText,D||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(u.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}rmg(b,h,v,D=null){if(Hg.ListItemReader.Ig(b)){var Q=b.Sb(4);b.sc();var ba=Cd.OutlineElementReader.cU(b);this.P4b(ba,()=>{this.pEc(Q,h.ww,ba,v);this.xSh(Q,h,v,D)})}else u.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}xlj(b,
h,v,D=null){const Q=Cd.OutlineElementReader.cU(b);return this.P4b(Q,()=>{const ba=this.Gge(b,h.ww,v);this.xSh(ba,h,v,D);return ba})}xSh(b,h,v,D=null){if(this.wq.g1a(b,h.ww).qz){const Q=new ne.GraphIterator;Q.set(b);Q.vd();Q.sc();const ba=this.DEl(Q,h,D);b=this.uEl(Q,b,h,v,D,ba);this.AEl(h,v,D,ba,b)}}DEl(b,h,v){if(h.Pxi)h=h.outlineElement;else{let D,Q;v?(D=this.Uvj,Q=this.Sje):h.A$b?(D=this.Tvj,Q=this.Sje):(D=this.nDo,Q=this.pDo);h=this.PMd(b,h.ww,D,Q,v)}!h&&v&&(v=new ne.GraphIterator,v.Zc(b),v.WPc()&&
Hg.ListItemReader.Ig(v)&&(h=v));return h}uEl(b,h,v,D,Q,ba){D?(Q?b=Q.ekc:(ba=this.Jna(h,v.ww),v=this.YHf(v.ww,b,ba),b=v.qRa!==Uj.a.ql?v.qRa+1:ba.startAt===Uj.a.ql?1:ba.startAt),h.setValue(Lm.Vn.uV,b),h.setValue(Lm.Vn.Nda,b)):(b=Uj.a.ql,this.Wjo(h,ba,v));return b}AEl(b,h,v,D,Q){if(D){var ba=!1,ta=this.vB(D),Ta=ta.level===b.ww.level,ob=!!v&&ta.listID===v.l0c;(ta.listID===b.ww.listID||ob)&&Ta&&(Ta=this.Jna(D.currentNode,ta),ob=Ta.startAt===Uj.a.ql?1:Ta.startAt,ta.Fu===ob+1&&(ba=h?Q===ob:this.oLm(D,Ta)));
if(!ba||v)v?(h=v.delta,Q=this.oxo,ba=this.pxo):(h=1,Q=this.Qie,ba=this.ysj),ta=new ne.GraphIterator,ta.set(D.currentNode),ta.vd(),this.Gd.fP(ta),ta.sc(),this.X0h(D.currentNode,b.ww,h,Q,ba,v)}}Wjo(b,h,v){let D=null;h&&(D=this.vB(h));if(D&&D.listID===v.ww.listID&&D.level===v.ww.level){const Q=this.Gd.lw(h),ba=Q.Fu;b.setValue(Lm.Vn.uV,ba);b.setValue(Lm.Vn.Nda,ba);Q.propertySet.setValue(lc.a.listID,D.listID);Q.propertySet.setValue(lc.a.listLevel,D.level);if(!v.A$b||v.m5d)v.Pxi&&!v.m5d&&(this.Gd.fP(h),
b=h.currentNode,ig.OutlineElementNavigator.Vd(h)),b.setValue(Lm.Vn.Nda,b.getValue(Lm.Vn.uV))}else h=v.ww.Fu+1,b.setValue(Lm.Vn.uV,h),b.setValue(Lm.Vn.Nda,h)}oEc(b,h,{Lpi:v=!1,CYm:D=-1,GGl:Q=!1,hIl:ba=!1}={}){return h&&16!==h.listType?ne.GraphIterator.pba(()=>{if(!Cd.OutlineElementReader.Dh(b))return u.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),mr.$dc();const ta=Cd.OutlineElementReader.cU(b);return ta&&Ba.a(ta,8)?(u.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),
mr.$dc()):jr.a.instance.J(1)&&(null===ta||void 0===ta?0:ta.pa.last.gi)?(u.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),mr.$dc()):this.P4b(ta,()=>{var Ta=dp.vh.Xs(b.currentNode);const ob=h.KB,Kb=this.infoAtLevel(b,h);var Vb=b.Sb(4);if(Vb)return b.sc(),Ta=this.uth(Kb,Vb,D,ob),Ta.ww=this.vB(b),Ta;this.j_n(b);Vb=h.propertySet.ia(lc.a.listID,-1);const bc=this.G0l(Vb,ba),Dc=this.BZl(ta),Oc=this.z_l(h,b,Kb,ba,Q,v);this.Dho(Oc,Kb);ta&&this.qjo(ta);return null==Oc||Q||Kb.qz!==
this.Gd.g1a(b.currentNode,Oc.ww).qz?this.Dql(Kb,bc,Oc,b.currentNode)?this.kEk(b,Kb,bc,Dc,ob):this.jEk(b,Kb,Ta,Dc,ob,bc,Vb):(Kb.listStyle||(Oc.A$b=!0),this.lEk(bc,Oc,b))})}):(h||u.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.XGa(b))}kEk(b,h,v,D,Q){v=this.j1l(h,v,D);b=this.Gge(b,v);return this.uth(h,b,-1,Q)}z_l(b,h,v,D,Q,ba){var ta;Q=b.Mlb?new sp(this,ne.GraphIterator.$a(b.Mlb),!1,!0):sp.jCl(this,h,v,D,Q);if(!Q)return null;ba?(Q.ww.level=this.NZl(h,v,D),this.gEl(h,
Q)):Q.ww&&(null===(ta=b.propertySet)||void 0===ta?0:ta.hasProperty(lc.a.listLevel))&&(Q.ww.level=b.propertySet.getValue(lc.a.listLevel));return Q}G0l(b,h){return h&&0<b&&b+""in this.lYf?this.lYf[b+""]:-1}j1l(b,h,v){var D,Q;const ba=new lx.a;ba.listID=h;ba.level=null!==(Q=null===(D=b.propertySet)||void 0===D?void 0:D.Hf(lc.a.listLevel))&&void 0!==Q?Q:this.nXc(v);b.propertySet&&b.Tna&&!Lm.Vn.Iv&&(ba.levelText=b.levelText.replace("%1","%"+(ba.level+1)));return ba}uth(b,h,v,D){b=this.STk(h,b,v,D);return mr.ZYm(b)}lEk(b,
h,v){let D=null;0<b&&(D=new ls(0,h.ww,-1),D.l0c=b,D.delta=-1);this.xlj(v,h,!1,D);return mr.pZm(h.ww)}jEk(b,h,v,D,Q,ba,ta){const Ta=Cd.OutlineElementReader.R3(b);0<Ta&&(D+=Ta);v=this.JLh(v,h,D,Q);this.yVo(ba,ta,v);b=this.Gge(b,v);Lm.Vn.VD||h.listType||(h=h.RB,h===Uj.a.ql&&(h=1),b.setValue(Lm.Vn.uV,h),b.setValue(Lm.Vn.Nda,h));return mr.bZm(v)}XGa(b,{e$i:h=!1}={}){return ne.GraphIterator.pba(()=>{if(!Cd.OutlineElementReader.Dh(b))return u.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),
mr.$dc();const v=Cd.OutlineElementReader.cU(b);if(jr.a.instance.J(1)&&(null===v||void 0===v?0:v.pa.last.gi))return u.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),mr.$dc();const D=b.Sb(4);return D?v?this.P4b(v,()=>{var Q;this.n$i(v);this.tZn(v);v.VI=null;this.Gd.UYd(Hg.ListItemReader.Kq?Hg.ListItemReader.U3(v,{ZIc:0}).listId:D.ia(lc.a.listID,0))?(D.Z7c=!1,b.Cg(),Tl.a.getInstance().Iv&&this.XD.Sca(v)):b.sc();h||this.ugo(b);b.Sb(4)&&(D.Z7c=!1,b.Cg(),Tl.a.getInstance().Iv&&
this.XD.Sca(v));(this.Sd.rg&&!this.dPb||!this.Sd.rg&&v.Ki)&&(!v.Ki||(null===(Q=v.yz)||void 0===Q?0:Q.hasProperty(lc.a.listID)))&&this.fdl(b);return mr.LFi()}):(u.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),D.Z7c=!1,b.Cg(),mr.LFi()):mr.$dc()})}ugo(b){const h=dp.vh.Xs(b.currentNode),v=Cd.OutlineElementReader.mEa(b),D=Cd.OutlineElementReader.vG(b),Q=Cd.OutlineElementReader.R3(b);this.bKd(h);this.nh.Dya(b,1,Math.max(0,v+(Q||-1*D)-this.hrc[0]))}P4b(b,
h){let v=null;jr.a.instance.J(1)&&b&&(v=b.MD());h=h();jr.a.instance.J(1)&&!this.dPb&&(b&&v&&this.qq.dV(b,v,this.Sd.rg),this.i$());return h}tZn(b){b.hasProperty(lc.a.$d)&&b.removeProperty(lc.a.$d);b.hasProperty(lc.a.LA)&&b.removeProperty(lc.a.LA);b.hasProperty(lc.a.at)&&b.removeProperty(lc.a.at)}infoAtLevel(b,h){if(!h)return null;const v=h.KB;if(1===h.Sr){if(h.Koa&&!h.zJ||!h.M6e(!1))return h;b=Cd.OutlineElementReader.mEa(b);const D=this.nXc(b),Q=v.RIb[D];b=bu.a.O7(h.propertySet,h.propertySet);6===
Q?b.O9(1,1):b.O9(0,Q);b.Hge("multilevel");b.levelText=v.pXc[D];v.XDa&&v.XDa[D]&&(b.font=v.XDa[D]);b.rw=v.a0d[D];b.H5=v.H5;b.R0d=h.R0d}else b=h;return b}Dho(b,h){null!==b&&void 0!==b&&b.ww&&(h.levelText=b.ww.levelText,h.qz||(h.font=b.ww.font))}NZl(b,h,v){let D=Cd.OutlineElementReader.mEa(b);const Q=Cd.OutlineElementReader.R3(b);0<Q?D+=Q:(b=Cd.OutlineElementReader.vG(b),0<b&&(D-=b));h=h.propertySet.ia(lc.a.listLevel,-1);return v&&0<=h?h:this.nXc(D)}gEl(b,h){if(!this.wq.g1a(b.currentNode,h.ww).listType){const v=
this.Jna(b.currentNode,h.ww);b=this.YHf(h.ww,b,v);h.ww.ZJc=h.ww.Fu=b.qRa===Uj.a.ql?v.startAt-1:b.qRa;h.A$b=b.KJj}}yVo(b,h,v){0>=b?this.lYf[h+""]=v.listID:v.listID=b}Dql(b,h,v,D){if(0>=h)return!1;const Q=(ba,ta)=>ba.length!==ta.length||ba.some((Ta,ob)=>Ta!==ta[ob]);if(v)return h=this.Gd.g1a(D,v.ww),b.qz!==h.qz||Q(b.Bha,h.Bha);v=b.propertySet.ia(lc.a.listLevel,-1);return 0<=v&&(h=this.wq.Fx(D,h,v))&&(h=h.ia(Gd.a.B4,null))&&b.Bha?Q(h,b.Bha):!1}sZn(b,h){var v,D;const Q=!!h&&de.ParagraphReader.Vb(h);let ba=
0,ta=0;Q&&(ba=this.Xo.$T(Hg.ListItemReader.Kq?h:this.Gd.srf(b)).Lt,ta=this.Xo.vG(h).Lt);Q&&this.n$i(h);null!==(v=Tl.a.getInstance())&&void 0!==v&&v.VD||(b.Sb(4),b.Cg());(null===(D=Tl.a.getInstance())||void 0===D?0:D.Iv)&&this.XD.Sca(h);Q&&this.nh.Dya(b,1,ba-ta)}bba(b,h,v,D=-1,Q=!1,ba=null,ta=!1){u.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ta=Ye.a.instance.Ap(Eb.a.bba),ob=this.Gc.Oc(15);ob.ku(b);let Kb=null,Vb=0;({pVm:Kb,Vhn:Vb,returnValue:D}=
this.KCl(b,h,D,Kb,Vb,Q,ba));if(!Kb||ta&&(1===v||0>v-Kb.ww.Fu||2<v-Kb.ww.Fu))return ob.dispose(),Ta.end(),!1;for(;0<Vb;)b.WPc(),Vb--;this.uVo(b,h,D,Kb);ob.dispose();Ta.end();return!0}uVo(b,h,v,D){for(;b.WPc();){var Q=Hg.ListItemReader.Jva(b);if(Q&&(Q=this.EEb(Q),Q.listID===h.listID)){h=new ls(0,h,v);Tl.a.getInstance().Iv?this.rmg(b,D,Q.f0,h):this.rmg(b,D,!0,h);break}}}KCl(b,h,v,D,Q,ba=!1,ta=null){for(var Ta;b.XSd();){if(b.Nr(4)){const ob=this.vB(b),Kb=this.Gd.lw(b);if(Kb.listType!==ta.listType){Q++;
continue}if(ba&&Kb.listStyle!==ta.listStyle||!ba&&h.level<ob.level){Q++;continue}-1===v&&(v=ob.Fu+1);D=null;if(h.level===ob.level||ba)null===(Ta=this.B8c)||void 0===Ta?void 0:Ta.ozf(b),D=new sp(this,b,!1,!1);ba&&ob.level!==h.level&&b.Nr(4)&&(b.Sb(4).setValue(lc.a.listLevel,ob.level),b.sc());break}Q++}return{returnValue:v,pVm:D,Vhn:Q}}i1l(b){b=Hg.ListItemReader.Jva(b);return this.jQd(b)}jQd(b){let h;jr.a.instance.J(1)&&(h=Hg.ListItemReader.Kq?Hg.ListItemReader.U3(b)||Hg.ListItemReader.lRd(b):this.Gd.IO(b,
!1,!0));return this.Gd.Fx(b,h.listId,h.listLevel)}startNewList(b,h,v){u.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var D=Ye.a.instance.Ap(Eb.a.startNewList),Q=this.Gc.Oc(15);Q.ku(b);var ba=bu.a.n_(0,h.listStyle,null,0,h.propertySet.ia(lc.a.listLevel,-1));if(Hg.ListItemReader.Kq)({listId:ta,listLevel:Ta}=Hg.ListItemReader.dQd(b,{ZIc:0,IHd:-1}));else{b.Sb(4);var ta=b.currentNode.ia(lc.a.listID,0);var Ta=b.currentNode.ia(lc.a.listLevel,-1);b.sc()}ba.R0d=
ta;var ob=h.propertySet.ia(lc.a.$d,0);0<ob&&ba.propertySet.setValue(lc.a.$d,ob);-1===ba.propertySet.ia(lc.a.listLevel,-1)&&ba.propertySet.setValue(lc.a.listLevel,Ta);1===h.Sr&&((Ta=new Nu.a,ta=h.uii(b.currentNode,ta),ta)?1===ta&&(ba.Hge(Pu.a.Odc),ba.KB=Ta.Oaf(Ta.DRf,Ta.ERf),ba.H5=ba.KB.H5):(ba.Hge(Pu.a.Odc),ba.KB=Ta.W$e(),ba.H5=ba.KB.H5));h.Dna()&&1>v&&(v=1);ba.RB=v;ta=new fh.DictionaryPropertySet;ta=this.UKc(Eb.a.uL,ta);Ta=Cd.OutlineElementReader.cU(b);h=this.vB(b);if(ob=this.i1l(b))ba.levelText=
ob.ia(lc.a.lv,""),ba.zJ=42,ba.rw=ob.ia(lc.a.rca,"left");this.sZn(b,Ta);({owa:ba}=this.Sla(ta,b,ba,!0));b.Sb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&u.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);Tl.a.getInstance().VD||this.XD.IQb(b.currentNode,h.level);Tl.a.getInstance().Iv&&this.XD.IQb(Ta,h.level);b.sc();ba=new sp(this,b,!1,!1);v=new ls(1,h,v);this.rmg(b,ba,!!Tl.a.getInstance().Iv,v);Q.dispose();D.end()}else u.ULS.sendTraceTag(51242764,324,
50,"'Start New List' has no current ListInfo")}QEf(b){if(!b)return!1;const h=b.Sb(2);h&&b.sc();return jr.a.instance.J(1)&&h&&12===h.type&&h.pa&&h.pa.last&&h.pa.last.gi?!0:!1}P9d(b,h,v,D){return this.q$j.P9d(b,h,v,D)}J8f(b,h){if(!b||!h)return!1;const v=b.propertySet.ia(lc.a.lv,null);h=h.propertySet.ia(lc.a.lv,null);if(!v||!h)return!1;const D=b.propertySet.ia(Gd.a.font,null);b=b.propertySet.ia(Gd.a.font,null);return v===h&&D===b}jmj(b,h,v){v||h.listType||(h.RB=b.ia(Gd.a.h0,Uj.a.ql))}qai(b,h){if(!h)return null;
const v=Array(9),D=h.R0d;if(!this.IMm(h,b)||1>D)return null;for(h=0;9>h;h++){const Q=this.Gd.Fx(b,D,h);if(null===Q||void 0===Q?0:Q.hasProperty(lc.a.$d))v[h]=Q.getValue(lc.a.$d);else return null}return v}IMm(b,h){if(!b)return!1;const v=b.propertySet.ia(lc.a.listLevel,-1);b=b.propertySet.ia(lc.a.$d,-1);if(0>v||0>b)return!1;this.bKd(h);return b!==this.OTb[v]}hoh(b,h,v){b&&b.setValue(lc.a.$d,h?h[v]:this.OTb&&v<this.OTb.length?this.OTb[v]:720*(v+1))}X0h(b,h,v,D,Q,ba=null,ta=!1){const Ta=new ne.GraphIterator,
ob=this.Jna(b,h);Ta.set(b);Ta.vd();b=jo.a.Qs(Ta,Ta.VQb());b.oo(ev.a.HXc,null);let Kb=-1;for(;b.moveNext();){if(!Hg.ListItemReader.Ig(Ta))continue;const Vb=this.vB(Ta),bc=Cd.OutlineElementReader.cU(Ta);this.Gd.fP(Ta);const Dc=Ta.currentNode;Ta.sc();if(D!==this.Qie||Vb.listID===h.listID){if(ta){if(-1!==Kb&&Kb>Vb.level)break;if(-1===Kb)Kb=Vb.level;else if(Vb.level!==Kb)continue}else{if(Vb.level<=ob.FSa)break;if(!D(h,Vb,ba))continue}Q(Dc,bc,v,h.listID,ba)}}}xGl(b,h,v,D,Q){const ba=new ne.GraphIterator,
ta=this.Jna(b,h);ba.set(b);ba.vd();if(Hg.ListItemReader.Ig(ba)){b=this.vB(ba);var Ta=Cd.OutlineElementReader.cU(ba);this.Gd.fP(ba);var ob=ba.currentNode;ba.sc();b.level<=ta.FSa||D(h,b,null)&&Q(ob,Ta,v,h.listID,null)}}wGl(b,h,v,D,Q=null){const ba=new ne.GraphIterator;ba.Zc(b);D(b,h,this.vB(ba),ba,0);this.PMd(b,h,v,D,Q)}PMd(b,h,v,D,Q=null){let ba=new ne.GraphIterator;const ta=this.Jna(b.currentNode,h);let Ta=null,ob=0;var Kb=new ne.GraphIterator;Kb.Zc(b);Kb.zb(10);const Vb=nc.a.Qs(Kb,Kb.origin);for(Vb.moveNext();Vb.moveNext();)if(Ta=
null,ba=Vb.iterator,1===ba.role&&(Ta=Vb.currentNode,ba.Nr(4)&&(Kb=this.vB(ba),v(h,Kb,Q))))if(Kb.level>h.level)D(b,h,Kb,ba,ob),ob++;else if(Kb.level===h.level||Kb.level<=ta.FSa)break;return Ta?ba:null}e6i(b,h,v,D,Q){b=this.Jna(b.currentNode,v);b.FSa>=h.level&&this.FBh(D,b.startAt+Q)}static get aQm(){null==dp.osd&&(w.AFrameworkApplication.K?(w.AFrameworkApplication.te("i75ig452;a229j208"),dp.osd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",
!1)):dp.osd=!1);return dp.osd}static get vh(){return Rl.PageNavigator.instance}static tlj(b,h){h.setValue(Gd.a.font,b.Koa||b.hTc||b.BQc?b.font:"Symbol")}static vlj(b,h){b=b.Koa||b.hTc||b.Tna?b.levelText:Uj.a.GHd;u.ULS.shipAssertTag(22127637,338,!!b);h.setValue(lc.a.lv,b)}static ulj(b,h){b=b.propertySet.ia(lc.a.rca,"left");h.setValue(lc.a.rca,b)}static hDm(b){b=b.iterator.parentNode;const h=ne.GraphIterator.$a(b);b&&Cd.OutlineElementReader.LEf(h,null)&&b.Tk(8,!0)}}dp.gan=2147450879;dp.WNi=1;dp.osd=
null;Object(n.a)(dp,"FlatListEditorCssVersion",Lm,[651,652]);class qt{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){this.wq=b;this.$wn=h;this.lg=v;this.Ts=D;this.MA=Q;this.VYm=ba;this.Ld=ta;this.lj=Ta;this.hZm=ob;this.Xb=Kb;this.wc=Vb;this.ZG=bc;this.XD=Dc}create(){return new dp(this.wq,this.$wn,this.lg,this.Ts,this.MA,this.VYm,this.Ld,this.lj,this.hZm,this.Xb,this.wc,this.ZG,this.XD)}}Object(n.a)(qt,"FlatListEditorFactory",null,[]);class Dw{constructor(){this.startAt=this.listLevel=this.listId=
0;this.Mlb=null}}Object(n.a)(Dw,"ListAutoCorrectionRefInfo",null,[]);class Lz{constructor(b,h){this.Q9j=b;this.If=h}P9d(b,h,v,D){if(!b.hasProperty(wc.a.L3a))return!0;h=ne.GraphIterator.$a(h.currentNode);We.SelectionEditor.mu(h);let Q=!0;if(!v.listType&&!D){23===h.Ve&&h.gF(1);D=b.ia(wc.a.L3a,1);if(1<D){var ba=new ne.GraphIterator;ba.Zc(h);ba.zb(10);ba=nc.a.Zo(ba.origin);D=this.JCl(ba,D,v,h.currentNode);v.Mlb||(Q=!1)}b.setValue(wc.a.L3a,D)}return Q}JCl(b,h,v,D){const Q=new zb.a;for(;b.moveNext()&&b.iterator.currentNode!==
D;){const ba=b.iterator;if(!ba.Nr(4))continue;const ta=this.Q9j.value.vB(ba),Ta=this.If.lw(ba);this.XJn(Q,ta);Ta.listType===v.listType&&Ta.listStyle===v.listStyle&&(0>h-ta.Fu||2<h-ta.Fu||Q.add(Object.assign(new Dw,{listId:ta.listID,listLevel:ta.level,Mlb:ba.currentNode,startAt:ta.Fu+1})))}0<Q.count&&(h=Q.J(Q.count-1).startAt,v.Mlb=Q.J(Q.count-1).Mlb);return h}XJn(b,h){let v=0;for(;v<b.count;){const D=b.J(v);D.listId===h.listID&&D.listLevel>=h.level?b.removeAt(v):v++}}}Object(n.a)(Lz,"ListAutoCorrector",
null,[606]);class Qu{constructor(b,h,v,D,Q){this.Y6a=(ba,ta,Ta)=>{var ob;ba=this.jIc(ta);if(!ba||Hg.ListItemReader.Kq&&!Hg.ListItemReader.Ig(ba)||this.Rs.QEf(ba))return 8;ta=this.Rs.vB(ba);if(1===ta.Fu||this.wUc(ta.level))return 8;ta=null===(ob=this.Gd)||void 0===ob?void 0:ob.lw(ba);if(!ta||this.cyi(ta))return 8;if(1===Ta)return 32;this.Rs.startNewList(ba,ta,1);return 32};this.X6a=(ba,ta,Ta)=>{ba=this.jIc(ta);if(!ba||Hg.ListItemReader.Kq&&!Hg.ListItemReader.Ig(ba)||this.Rs.QEf(ba))return 8;ta=this.Rs.vB(ba);
if(this.wUc(ta.level))return 8;const ob=this.Gd.lw(ba);if(!ob||this.cyi(ob))return 8;if(1===Ta)return 32;this.rJc.v3l(ba.currentNode,ta.Fu,this.Gd,this.Rs,this.NTa);return 32};this.bba=(ba,ta,Ta)=>{ba=this.jIc(ta);if(!ba||Hg.ListItemReader.Kq&&!Hg.ListItemReader.Ig(ba)||this.Rs.QEf(ba))return 8;ta=this.Rs.vB(ba);if(1!==ta.Fu||this.wUc(ta.level))return 8;if(1===Ta)return 32;Ta=this.Gd.lw(ba);return this.Rs.bba(ba,ta,Ta.RB,-1,!1,Ta)?32:8};this.cpb=(ba,ta,Ta,ob,Kb)=>{ba=this.jIc(ta);if(!ba||Hg.ListItemReader.Kq&&
!Hg.ListItemReader.Ig(ba))return 8;ta=this.Rs.vB(ba);if(this.wUc(ta.level))return 8;if(1===Ta)return 32;Ta=this.Gd.lw(ba);this.Rs.startNewList(ba,Ta,Kb);return 32};this.Ueb=(ba,ta,Ta,ob,Kb)=>{ba=this.jIc(ta);if(!ba||Hg.ListItemReader.Kq&&!Hg.ListItemReader.Ig(ba))return 8;ta=this.Rs.vB(ba);return this.wUc(ta.level)?8:1===Ta?32:this.Rs.bba(ba,ta,ta.Fu,Kb)?32:8};this.oc=b;this.Gd=v;this.Rs=D;this.rJc=Q}wUc(b){return 0>b}Tb(){this.oc.qa(Eb.a.Y6a,Zb.a.outlineElement,this.Y6a);this.oc.qa(Eb.a.Y6a,Zb.a.Tc,
this.Y6a);this.oc.qa(Eb.a.Y6a,Zb.a.view,this.Y6a);this.oc.Vc(Eb.a.Y6a,12);this.oc.qa(Eb.a.X6a,Zb.a.outlineElement,this.X6a);this.oc.qa(Eb.a.X6a,Zb.a.Tc,this.X6a);this.oc.qa(Eb.a.X6a,Zb.a.view,this.X6a);this.oc.Vc(Eb.a.X6a,12);this.oc.qa(Eb.a.bba,Zb.a.outlineElement,this.bba);this.oc.qa(Eb.a.bba,Zb.a.Tc,this.bba);this.oc.qa(Eb.a.bba,Zb.a.view,this.bba);this.oc.Vc(Eb.a.bba,12);this.oc.qa(Eb.a.cpb,Zb.a.outlineElement,this.cpb);this.oc.qa(Eb.a.cpb,Zb.a.Tc,this.cpb);this.oc.qa(Eb.a.cpb,Zb.a.view,this.cpb);
this.oc.Vc(Eb.a.cpb,12);this.oc.qa(Eb.a.Ueb,Zb.a.outlineElement,this.Ueb);this.oc.qa(Eb.a.Ueb,Zb.a.Tc,this.Ueb);this.oc.qa(Eb.a.Ueb,Zb.a.view,this.Ueb);this.oc.Vc(Eb.a.Ueb,12)}get NTa(){return Ga.a.instance.resolve("Common.IStandaloneRootController").jda}jIc(b){return this.Rs.O0l(b)}cyi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(n.a)(Qu,"ListContextMenuSectionActor",null,[]);var qm=c(591);class Ty{static get fZm(){return Vf.a.qA(Ty.Lm,Box4Intl.Box4Strings.l_StartNewListDialog,
Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}Ty.Lm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(Ty,"ListSetStartValueDialogHtml",null,[]);class Kv extends Vf.a{constructor(b,h,v,D,Q){super();this.Gpd=this.hwe=this.Ypd=this.KSe=null;this.cye=!0;this.sS=!1;this.gbb=0;this.Htj=[Eb.a.Kag,Eb.a.ufg,Eb.a.z1f];this.rmo=(ba,ta)=>{ba=ta[kh.a.Number];this.B$=Number.isInteger(ta[kh.a.Number])&&ba>=this.gbb?ba:this.gbb};this.ncm=(ba,ta)=>{this.B$=this.B$>=this.gbb?this.B$:this.gbb;ta[kh.a.Number]=this.B$;ta[kh.a.UnitType]=0};this.tjo=(ba,ta)=>{if(1===ba){var Ta=ta.ListRadioStartNew,ob=ta.ListRadioContinue,
Kb=ne.GraphIterator.$a(this.Fe);Kb.vd();ta=this.Rs.vB(Kb);ba=this.If.lw(Kb);if(Ta)this.Rs.startNewList(Kb,ba,this.B$);else if(ob)if(this.cye)this.Rs.bba(Kb,ta,this.cMe,-1,!1,ba);else{Ta=!0;for(ob=null;Kb.nJ();)if(Kb.Nr(4)){ob=new sp(this.Rs,Kb,!1,!1);break}if(!ob||this.Rs.vB(Kb).Fu>=this.B$)Ta=!1;Ta?(Kb=ne.GraphIterator.$a(this.Fe),Kb.vd(),this.Rs.bba(Kb,ta,this.cMe,this.B$,!1,ba)):(this.dispose(),this.tHa(CommonUIStrings.l_ErrorDialogMessage,this.eZm))}}};this.eZm=()=>{new Kv(this.Fe,this.cMe,this.If,
this.Rs,this.Ed)};this.vtn=()=>{document.getElementById(Kv.MFi).style.visibility="visible"};this.Vln=()=>{document.getElementById(Kv.MFi).style.visibility="hidden"};this.wg="ListSetStartValueDialog";this.Xg=Ty.fZm;this.Fe=b;this.B$=h;this.If=v;this.cMe=h;this.s6=D;h=new ne.GraphIterator;b?(h.set(b),h.vd(),Cd.OutlineElementReader.Dh(h)||ig.OutlineElementNavigator.Vd(h),Hg.ListItemReader.Ig(h)&&(h.Sb(4),b=h.currentNode,22===b.type&&(this.If.DX(b).Dna()?this.gbb=1:this.gbb=0))):this.gbb=1;this.Ed=Q;
this.Yh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.tjo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.cye&&(this.KSe=document.getElementById("ListRadioStartNew"),this.Ypd=this.vtn,this.hwe=document.getElementById("ListRadioContinue"),this.Gpd=this.Vln,lf.a.addHandler(this.KSe,"click",this.Ypd),lf.a.addHandler(this.hwe,"click",this.Gpd));for(const ba of this.Htj)Object(qm.a)(ba,this.rmo,this.ncm);this.Ed.xm()}get Rs(){return this.s6}dispose(){if(!this.sS){for(const b of this.Htj)Object(qm.b)(b);
this.cye&&(this.Ypd&&lf.a.removeHandler(this.KSe,"click",this.Ypd),this.Gpd&&lf.a.removeHandler(this.hwe,"click",this.Gpd));this.Ed.CY("ListStartSpinner");super.dispose();this.sS=!0}}gNk(){const b=bm.l("none",this.gbb+"","100","1");return bm.j(Kv.NFi,Eb.a.Kag,Eb.a.z1f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Eb.a.ufg)}Azb(b){const h=document.getElementById(Kv.NFi);this.Ed.QYa("ListStartSpinner",b);b=this.Ed.$Db("ListStartSpinner","Medium");h.appendChild(b)}f9(){const b=this.gNk();this.Azb(b)}}Kv.NFi=
"SetListStartSpinnerContainer";Kv.MFi="ListStartAtSpinnerBox";Object(n.a)(Kv,"ListSetStartValueDialog",Vf.a,[]);class Ru{v3l(b,h,v,D,Q){new Kv(b,h,v,D,Q)}static get instance(){return Ru._instance||(Ru._instance=new Ru)}}Ru._instance=null;Object(n.a)(Ru,"ListDialogFactory",null,[331]);class IA{constructor(b,h,v){this.s6=b;this.If=h;this.Gc=v}ozf(b){u.ULS.shipAssertTag(40420184,393,Cd.OutlineElementReader.Dh(b));if(Hg.ListItemReader.Ig(b)){const h=this.If.lw(b);h.Sr||this.ewm(b,h)}}cWk(b){for(let h=
0;h<b.length;h++){const v=new ne.GraphIterator;v.set(b.getContext(h).node);this.ozf(v)}}ewm(b,h){const v=Rl.PageNavigator.instance.Xs(b.currentNode),D=this.s6.vB(b),Q=this.Gc.Oc(15);Q.ku(b);h=this.s6.uEk(v,b,h);this.s6.k2n(b,D.listID);Q.dispose();this.If.g1a(b.currentNode,h)}}Object(n.a)(IA,"SingleLevelListEditor",null,[330]);var Ew=c(308);class Uy{i3i(b,h,v,D,Q,ba){return b?w.AFrameworkApplication.va.Of(b,h,v,!0,Q,ba):8}}Object(n.a)(Uy,"ListContextManager",null,[1605]);class Jt extends Uy{constructor(b){super();
Jt.Auc=b}i3i(b,h,v,D,Q,ba){if(!b||!b.length)return 8;let ta;const Ta=({Ikm:b,Hkm:ta}=Jt.gq.Fkm(b)).returnValue;let ob=1;for(const Vb of Ta.keys){var Kb=b.contains(Vb);const bc=Ta.J(Vb);Jt.gq.kSk(Ta.J(Vb),this.bGc(h),Kb)?Kb?(u.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.bGc(h)?"Promote":"Demote"),Kb=w.AFrameworkApplication.va.Of(Ew.a.hDa(bc),h,v,D,Q,ba)):(u.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.bGc(h)?"Promote":
"Demote"),Kb=Jt.gq.Zwn(Ta.J(Vb),this.bGc(h),ta.J(Vb))):(u.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.bGc(h)?"Promote":"Demote"),Kb=8);ob=Rc.ActionManager.VYc(ob,Kb)}return ob}bGc(b){return b===Eb.a.JG?!0:!1}static get gq(){return Jt.Auc||(Jt.Auc=Ga.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Jt.Auc=null;Object(n.a)(Jt,"WordEditorListContextManager",Uy,[]);class lu{get name(){return"WordEditor.ListEditors"}xc(b){w.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new Lz(b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new qt(b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new rl.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new IA(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),
b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new Jt(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new Qu(w.AFrameworkApplication.va,new Ci.a,lu.Gd,lu.Rs,Ru.instance)).Tb();const b=w.AFrameworkApplication.va;b.fb(Eb.a.z1f,Zb.a.view,qm.d,96);b.fb(Eb.a.ufg,Zb.a.view,qm.c,96);b.fb(Eb.a.Kag,Zb.a.view,qm.c,96)}dispose(){}static get Gd(){return null!=
lu.GDg?lu.GDg:lu.GDg=Ga.a.instance.resolve("Box4.List.IListReader")}static get Rs(){return null!=lu.pzg?lu.pzg:lu.pzg=Ga.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){N.a.instance.Fc(new lu)}}Object(n.a)(lu,"WordEditorListEditorsPackage",null,[1,2]);var Fw=c(1689),Lv=c(500),Gw=c(2032);class Mv extends dc.a{constructor(b,h,v,D,Q,ba){super(b,h);this.styleId=null;this.Eh=0;this.JQa=null;this.characterData=v;this.paragraphNode=D;this.listMarker=Q;this.v8=ba}}Object(n.a)(Mv,"HeadingText",
dc.a,[]);var nx=c(347);class Mz{constructor(b,h,v,D,Q,ba,ta){this.lZg=!0;this.s5g=0;this.Njh=8;this.gia=null;this.lrm=Ta=>{if(Ta.Pr)return!0;Ta=Ta.role;return 1===Ta||2===Ta||4===Ta};this.K9j=b;this.Yz=h;this.ve=v;this.If=D;this.KF=Q;this.V5=ba;this.tIe=ta}get hx(){return this.K9j.value}get fzf(){return this.lZg}set fzf(b){this.lZg=b}get fJb(){return this.s5g}set fJb(b){this.s5g=b}get PQb(){return this.Njh}set PQb(b){this.Njh=b}async kYl(){var b=this.tIe.value;if(!isNullOrUndefined(b)&&b.rz)return b=
await this.Q5l(),this.b_f(b,!0);b=this.gia;return isNullOrUndefined(b)?null:Promise.resolve(this.b_f(b,!0))}lYl(){return this.b_f([],!1)}b_f(b,h){const v=window.performance.now(),D=this.x9h();if(!D)return null;const Q=new zb.a;let ba=0;for(;D.moveNext();){var ta=D.iterator;if(11===ta.Ve){const Ta=this.If.srf(ta),ob=ig.OutlineElementNavigator.Ge(ta,!0);h&&b[ba]&&b[ba].ParaId===de.ParagraphReader.RQ(ob)&&ba++;ig.OutlineElementNavigator.Vd(ta);if(!ob||!de.ParagraphReader.Vb(ob)||ob.ur||""===ob.characterData||
"\ufffc"===ob.characterData)continue;const Kb=this.tPd(ob);Kb&&(Ta&&(Kb.listMarker=this.KF.Wkb(Ta,!1).T8,ta=this.If.lw(ta),1===ta.listType&&ta.BQc&&(Kb.JQa=ta.font)),h&&(b[ba-1]&&b[ba-1].ParaId===de.ParagraphReader.RQ(ob)?Kb.Eh=ba:Kb.Eh=ba+1),Q.add(Kb))}}u.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-v));return Q}Q5l(){const b=new jh.a;var h=Gw.a.Zaa(w.AFrameworkApplication.rootQuerySignature,null);const v=new Ms.a;v.Dq=h;v.status=
1;this.ndk=window.performance.now();h=this.V5.wga(0,()=>{if(2!=v.statusCode||null==v.Dj||0==v.Dj.length||null==v.Dj[0]){const D=String.format("GetPageEndsOperation Failed with status code: {0};",v.statusCode);b.setException(Error.create(D));u.ULS.sendTraceTag(543802465,3019,10,D)}else b.zg(v.Dj[0].PageEnds),u.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.ndk))});h.HI(v);h.DT();return xg.b(b.task)}hYl(){const b=this.x9h();if(!b)return-1;
let h=0;for(;b.moveNext();){const v=b.iterator;if(11===v.Ve){const D=ig.OutlineElementNavigator.Ge(v,!0);ig.OutlineElementNavigator.Vd(v);D&&de.ParagraphReader.Vb(D)&&!D.ur&&""!==D.characterData&&"\ufffc"!==D.characterData&&this.tPd(D)&&h++}}return h}x9h(){if(!this.hx)return u.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.Yz.MO(this.hx);if(!b)return u.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=ne.GraphIterator.$a(b);if(!b.Ep())return u.ULS.sendTraceTag(591963594,
3019,10,"Failed to root at PageContent."),null;b=nc.a.Qs(b,b.origin);b.oo(this.lrm,null);return b}tPd(b){var h;return null!==(h=this.tim(b))&&void 0!==h?h:this.i6l(b)}tim(b){if(!Di.a.Pj)return this.uim(b);if(!this.zUm(b))return null;var h=Object(nx.c)(9);h=Object(nx.a)(h);h=[...de.ParagraphReader.Ijf(b,h)];if(0===h.length)return null;const v=de.ParagraphReader.Ena(b)+1;return this.eHh(b,h,v)}i6l(b){var h,v,D,Q;if(!Di.a.Pj)return this.eYl(b);var ba=Object(nx.c)(9);ba=Object(nx.a)(ba);const ta=de.ParagraphReader.hPc(b),
Ta=this.ve.MC(b),{nrm:ob,PDl:Kb}=this.Hdm(ta,Ta,ba);ba=null!==(Q=null!==(v=null===(h=Kb.linkedStyle)||void 0===h?void 0:h.v8)&&void 0!==v?v:null===(D=Kb.hw)||void 0===D?void 0:D.v8)&&void 0!==Q?Q:10;return this.wHb(ba-1)?this.eHh(b,ob,ba):null}eHh(b,h,v){var D;if(!this.wHb(v-1))return null;const {lBj:Q,kBj:ba}=this.AMo(b,h);return 0===Q.length?null:(h=null===(D=de.ParagraphReader.pSd(b,Q))||void 0===D?void 0:D.trim())&&""!=h?new Mv(ba.yd,ba.endCp,h,b,null,v):null}Hdm(b,h,v){const D=[];let Q={linkedStyle:null,
hw:null},ba=null,ta=null;for(const Ta of b)if(ba=Ta.chp.formatting?this.gYl(h,Ta.chp):ba,b=v(Ta)){if(!ta&&b){ta=ba;if(!ta)break;Q=ba}else if(!this.OKm(ba,ta))break;D.push(Ta)}return{nrm:D,PDl:Q}}AMo(b,h){var v;let D=-1,Q;for(Q=0;Q<h.length;Q++){var ba=h[Q],ta=b.characterData.substring(ba.chp.cp,ba.cpEnd),Ta=null===ta||void 0===ta?void 0:ta.trimStart();if(Ta){D=ba.chp.cp+(ta.length-Ta.length);break}}if(-1===D)return{lBj:[],kBj:{yd:-1,endCp:-1}};ba=-1;for(ta=h.length;0<ta;ta--){Ta=h[ta-1];const ob=
b.characterData.substring(Ta.chp.cp,Ta.cpEnd),Kb=null===ob||void 0===ob?void 0:ob.trimEnd();if(Kb){ba=Ta.cpEnd-(ob.length-Kb.length);break}}return{lBj:null!==(v=h.slice(Q,ta))&&void 0!==v?v:[],kBj:{yd:D,endCp:ba}}}OKm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.v8===b.linkedStyle.v8||h.hw&&b.hw&&h.hw.UBh==b.hw.UBh?!0:!1}gYl(b,h){h=Hn.FormattingReader.Ona(h.formatting);b=this.jYl(b,h);h=this.fYl(h);return b||h?{linkedStyle:b,hw:h}:null}jYl(b,
h){b=this.ve.Iva(h,b);if(!b)return null;h=b.ia(lc.a.Ii,9);return this.U7c(h)?{shp:b.id,v8:h+1}:null}fYl(b){var h;b=this.ve.pg(b);if(!b||!Pl.a.L_d(b))return null;const v=null!==(h=Pl.a.C7b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(v);return this.wHb(h-1)?{UBh:b,v8:h}:null}uim(b){const h=de.ParagraphReader.Ena(b);if(this.U7c(h))return new Mv(0,b.characterData.length,b.characterData,b,null,h+1);if(this.wHb(h)){var v=this.ve.No(b);v=this.ve.pg(v);if(Pl.a.fIb(v))return new Mv(0,b.characterData.length,
b.characterData,b,null,h+1)}return null}eYl(b){var h;let v=h=null,D=-1;var Q=-1,ba=this.ve.MC(b);for(let Ta=0;Ta<b.pa.length;Ta++)if(h=b.pa.J(Ta),h.formatting){var ta=Hn.FormattingReader.Ona(h.formatting);const ob=this.ve.pg(ta);if(!v&&(v=ob,Q=(Q=Pl.a.C7b(v))?Number.parseInvariant(Q):0,!this.wHb(Q-1)))break;ta=(ta=this.ve.Iva(ta,ba))?ta.ia(lc.a.Ii,9):9;D=-1===D?ta:D;if(!(this.U7c(ta)&&D===ta||Pl.a.L_d(ob)&&v===ob))break}h=h.cp;ba=b.characterData.substring(0,h);return this.U7c(D)?new Mv(0,h,ba,b,null,
D+1):Pl.a.L_d(v)?new Mv(0,h,ba,b,null,Q):null}zUm(b){const h=de.ParagraphReader.Ena(b);if(!this.wHb(h))return!1;if(this.U7c(h))return!0;b=this.ve.No(b);b=this.ve.pg(b);return Pl.a.fIb(b)?!0:!1}U7c(b){return this.fzf&&this.wHb(b)}wHb(b){return b>=this.fJb&&b<=this.PQb}}Object(n.a)(Mz,"StyleBasedDocumentHeadings",null,[391]);var NB=c(1010);class mu{constructor(){this.startTime=0}}Object(n.a)(mu,"TocCallbackData",null,[]);class Uq{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.Vmg=(bc,Dc,Oc)=>{const gd=
Dc.node;if(!gd)return u.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==gd.type)return u.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!gd.ur)return 2;if(1===Oc)return ac.SessionStatusManager.instance.Aj?8:32;this.ld&&this.ld.isFeatureEnabled(120)?this.bCc.ZTo(gd).then(rd=>{rd||this.sHj(gd)}):this.sHj(gd);return 32};this.tYo=bc=>{bc=window.performance.now()-bc.startTime;u.ULS.sendTraceTag(574408796,
3019,50,String.format("UpdateTOC Duration: {0} ms;",bc));bc=Object.assign(new wb.a,{durationMs:bc});wa.Health.instance.recordKpiSuccess(Uq.$Kj,bc);Uq.C7a()};this.Lri=(bc,Dc,Oc,gd,rd)=>{if(de.ParagraphReader.Vb(Dc.node)&&Dc.node.ur)return 2;if(1===Oc)return ac.SessionStatusManager.instance.Aj?8:32;if(Dc.contextId!==Zb.a.Tc||this.Ik.I8(Dc)||!de.ParagraphReader.Vb(Dc.node))return 32;this.Sd.Ls(17);(null===rd||void 0===rd?0:rd.resolve)?this.bCc.oKh(Dc,rd.resolve):this.bCc.oKh(Dc);return 32};this.t5f=
(bc,Dc,Oc)=>{bc=Dc.node;if(!bc)return u.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==bc.type)return u.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!bc.ur)return 2;if(1===Oc)return ac.SessionStatusManager.instance.Aj?8:32;Oc=null;bc.isConnected&&(Oc=NB.a.U7b(bc,!0),Oc.Glc(bc));Dc=new ne.GraphIterator;Dc.set(bc);Dc.zb(8);Dc.jd(8);const gd=this.Gc.Oc(15);gd.ku(Dc);this.bCc.TYn(bc)?(gd.dispose(),
Oc&&Oc.normalize(),Uq.C7a()):(Oc&&Oc.cancel(),gd.dispose(),u.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.xed=h;this.Wc=D;this.Gc=Q;this.Ik=ba;this.bCc=ta;this.Sd=Ta;this.ld=ob;this.$Vg=Kb;this.JN=Vb}Tb(){this.ga.qa(Eb.a.LQb,Zb.a.paragraph,this.Vmg);this.ga.qa(Eb.a.LQb,Zb.a.Hd,this.Vmg);this.ga.qa(Eb.a.LQb,Zb.a.Tc,this.Vmg);this.ga.Vc(Eb.a.LQb,1028);this.ga.qa(sc.a.AAf,Zb.a.Tc,this.Lri);this.ga.Vc(sc.a.AAf,1028);this.ga.qa(sc.a.g4c,Zb.a.paragraph,this.t5f);
this.ga.qa(sc.a.g4c,Zb.a.Hd,this.t5f);this.ga.qa(sc.a.g4c,Zb.a.Tc,this.t5f);this.ga.Vc(sc.a.g4c,1028)}sHj(b){wa.Health.instance.recordKpiUsage(Uq.$Kj,1,Uq.sB,null);const h=this.AMl(b),v=new mu;v.startTime=window.performance.now();this.xed.zij(h,lc.a.Ylg,this.Wgm(this.f6l(b)),this.tYo,null,v);this.bCc.HUk()}nPj(b){if(null!=b&&b.ur)if(null==this.$Vg.instance)u.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.$Vg.instance.Fci();b=this.CCl(b);var v=!1;1===this.JN.Wu&&
(v=!0);0!=b&&h!=b&&(h=[Object.assign(new pa.a,{name:"TOCPageNo",string:b}),Object.assign(new pa.a,{name:"HeadingPageNo",string:h}),Object.assign(new pa.a,{name:"isPageView",string:v})],Qe.a("TOCPageNoMismatch",!0,void 0,h))}}CCl(b){for(let h=0;h<b.pa.length;h++){const v=b.pa.J(h);if(null!=v.ed)for(let D=0;D<v.ed.length;D++){const Q=v.ed.J(D);if(1===Q.xg&&Q.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(v.cp,b.characterData.length-v.cp))}}return 0}f6l(b){return b?b.ia(lc.a.jN,
null):(u.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}AMl(b){return this.Wc.Gva(b,7,7).Sb(35)}Wgm(b){const h=[];h.push(b+",TOC,0");return h}static C7a(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Uq.uDa)}}Uq.uDa=5E3;Uq.$Kj="WordUpdateTOC";Uq.sB="wwaengidc";
Object(n.a)(Uq,"TableOfContentsActor",null,[390]);class Vy{}Object(n.a)(Vy,"FieldData",null,[]);class Ul extends Vy{constructor(){super();this.Mpb=null}}Object(n.a)(Ul,"TOCFieldData",Vy,[]);class ox{constructor(b,h,v,D,Q,ba=null){this.prm=b;this.rt=h;this.Eh=v;this.Mvj=D;this.listMarker=Q;this.JQa=ba}}Object(n.a)(ox,"TOCHeadingData",null,[]);class JA{constructor(b,h){this.FVa=b;this.qn=h}async y9h(b){this.FVa.fzf=b.gzf;this.FVa.fJb=b.fJb;this.FVa.PQb=b.PQb;return this.FVa.kYl()}kNl(b){if(b=this.jNl(b))return this.qn.wva(b)}jNl(b){const h=
b.pa.length;for(let v=0;v<h;v++){const D=b.pa.J(v);if(D.hyperlink&&D.hyperlink.cha&&D.hyperlink.url.startsWith(G.a.Tdb))return D.hyperlink.url.substr(D.hyperlink.url.indexOf("_Toc"))}return null}Nce(b){(b=this.kNl(b))&&this.qn.bSf(b.id)}Idm(){return this.FVa.hYl()}k2i(b,h){const v=new Ul,D=new zb.a;for(const Q of b){b=this.Gdm(Q,h);if(!b)return null;D.add(b)}v.Mpb=D;return v}Gdm(b,h){let v;if(h&&(v=this.w8k(b),!v))return u.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),
null;h=S.AParagraphNode.IR(b.characterData.trim());const D=this.xfm(b.v8);return new ox(h,v,b.Eh,D,b.listMarker,b.JQa)}w8k(b){const h=String.format("{0}{1}","_Toc",ye.a.tF());return this.qn.sDc(h,b.begin,b.end,b.paragraphNode,b.paragraphNode)?h:null}xfm(b){return String.format("toc {0}",b)}}Object(n.a)(JA,"TOCDataManager",null,[389]);class Nv{jeg(){const b=Object.assign(new pg.StandardDialog,{yt:w.AFrameworkApplication.$ba,Ad:0,FHa:!1});b.cV(1);b.cja(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,
WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Nv.dCg?Nv.dCg:Nv.dCg=new Nv}}Object(n.a)(Nv,"TOCDialogHelper",null,[]);var KA=c(183),bh=c(491),Hw=c(268),Ov=c(148);class OB{constructor(b,h,v,D,Q,ba,ta){this.keg=b;this.Cjb=h;this.gzf=v;this.fJb=D;this.PQb=Q;this.Wyb=ba;this.zad=[];this.instruction=ta}toString(){return"showPageNumber:"+this.keg+"  isHyperlink:"+this.Cjb+" includeOutlineLevels:"+this.gzf+" lowerOutlineLevel:"+this.fJb+" upperOutlineLevel:"+
this.PQb+" addContentControl:"+this.Wyb+" unsupportedSwitches:"+this.zad.toString()}}Object(n.a)(OB,"TOCSettings",null,[]);class Mi{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld,Qd){this.OZg="TOC";this.sjf=this.Vwe=this.VUe=null;this.q7a=b;this.nh=h;this.tD=v;this.Ru=D;this.Uy=Q;this.Ik=ba;this.ib=ta;this.Kd=Ta;this.Aih=ob;this.Be=Kb;this.TUe=Vb;this.Wo=Dc;this.CI=Oc;this.Kn=gd;this.Gc=rd;this.Hb=je;this.zd=Ld;this.eb=Qd}static get OTo(){if(null!=Mi.exd)return Mi.exd;w.AFrameworkApplication.te("i430a979-t;a1f4j306-c");
Mi.exd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return Mi.exd}get PSc(){return this.OZg}set PSc(b){this.OZg=b}get Npb(){this.VUe||(this.VUe=this.b7h());return this.VUe}b7h(){return new OB(!0,!0,!0,0,8,!0,this.$En())}async oKh(b,h){Qe.a(Mi.Zdl);const v=window.performance.now();if(this.eb.Vb(b.node))if(this.Ik.I8(b))u.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),
Mi.QQa("IP is in locked range");else{var D=await this.q7a.y9h(this.Npb);if(D){var Q=new of.a(2,1,0,()=>{this.ael(b,D,this.Npb.Cjb,v);h&&h()});this.Hb.Wb(Q)}else u.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Mi.QQa("Failed to get TOC data")}else u.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Mi.QQa("Context should be paragraph")}ael(b,h,v,D=0){let Q;try{if(0==D&&(D=window.performance.now()),this.JYh(b.node)){var ba=
new ne.GraphIterator;ba.set(b.node);ba.zb(7);ba.jd(7);Q=this.Gc.Oc(15);Q.ku(ba);var ta=this.q7a.k2i(h,v);ta||Mi.QQa("Failed to prepare TOC Field data");var Ta=ta.Mpb?ta.Mpb.count:0;if(Ta){h=null;var ob;for(v=0;v<Ta;v++){const Dc=ta.Mpb.J(v);if(!({FBb:ob}=this.Iri(b,h,v,Ta,Dc,Vb?Vb.toString():void 0)).returnValue){Mi.QQa("Failed to populate new TOC paragraph");return}if(0==v){var Kb=ob.currentNode;var Vb=de.ParagraphReader.RQ(Kb)}h=ob}if(this.Npb.Wyb&&!this.P$e(Kb.id,h.Nn.id))Mi.QQa("Failed to add content control block");
else{var bc=window.performance.now()-D;Qe.a(Mi.pbf,!0,bc)}}else if(this.TUe.jeg(),this.M9k(b)){const Dc=window.performance.now()-D;Qe.a(Mi.pbf,!0,Dc)}}else Mi.QQa("Failed to fetch style set")}catch(Dc){Mi.QQa(String.format("{0} {1}",Dc.message,Dc.stack))}finally{Q&&Q.dispose()}}JYh(b){this.Vwe=this.Uy.MC(b);return this.Vwe?!0:(u.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static RFa(b){b=[Object.assign(new pa.a,{name:Mi.rYo,string:b})];Qe.a(Mi.Xmg,!1,void 0,b)}static NKf(b){b=
[Object.assign(new pa.a,{name:Mi.y_n,string:b})];Qe.a(Mi.Y$i,!1,void 0,b)}static QQa(b){b=[Object.assign(new pa.a,{name:Mi.$dl,string:b})];Qe.a(Mi.pbf,!1,void 0,b)}async ZTo(b){const h=this.Pgi(b);if(null==h)Mi.RFa("Cannot update TOC when firstTocPara = null");else{var v=this.Kdm(h);if(0<v.zad.length)return this.d7m(v.zad),!1;Qe.a(Mi.qYo);var D=window.performance.now(),Q=await this.q7a.y9h(v);if(!Q)return u.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Mi.RFa("Failed to fetch TOC data"),
!1;b=new of.a(1,1,0,()=>{this.sYo(h,Q,v,D)});this.Hb.Wb(b);return!0}}sYo(b,h,v,D=0){let Q;try{if(null==b)Mi.RFa("Attempt to update TOC when firstTocPara = null");else{0==D&&(D=window.performance.now());var ba=new ne.GraphIterator;ba.set(b);ba.zb(7);ba.jd(7);Q=this.Gc.Oc(15);Q.ku(ba);var ta=this.q7a.k2i(h,v.Cjb);if(null==ta)Mi.RFa("Attempt to update TOC when tocFieldData = null");else{var Ta;if(({Y5e:Ta}=this.v$i(b,v)).response){u.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",
v.toString()));var ob=ta.Mpb?ta.Mpb.count:0;if(this.JYh(b)){var Kb;this.pzi(b)&&(this.X$i(b),(b=this.eb.jg(b,!1,!0))&&(Kb=b.ia(lc.a.Lc,null).toString()));var Vb=b.ia(lc.a.jN,null);h=Vb;Kb=null!==Kb&&void 0!==Kb?Kb:Vb;if(ob){for(var bc=0,Dc;b.ur&&h==Vb&&bc<ob;){const rd=ta.Mpb.J(bc);v.Cjb&&this.q7a.Nce(b);if(!this.UXo(b,bc,ob,rd,v)){u.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Mi.RFa("Failed to update TOC paragraph");return}b.setValue(lc.a.jN,Kb);bc++;Dc=b;b=this.eb.jg(Dc,
!1,!0);if(!b){h=null;break}this.wzi(b)&&this.W$i(b);h=b.ia(lc.a.jN,null)}h==Vb&&this.i5f(b);var Oc;if(({aIf:Oc}=this.Jtk(ta,bc,ob,Dc,Kb)).response)if(v.Wyb&&!this.P$e(Ta,Oc.id))Mi.RFa("Failed to add content control block");else{var gd=window.performance.now()-D;Qe.a(Mi.Xmg,!0,gd)}else Mi.RFa("Failed to add new paragraph")}else this.TUe.jeg(),this.nYo(b,v.Wyb,Ta,v.instruction,Kb)&&(bc=window.performance.now()-D,Qe.a(Mi.Xmg,!0,bc))}else Mi.RFa("Failed to fetch style set")}else Mi.RFa("Failed to remove Content Control")}}}catch(rd){Mi.RFa(String.format("{0} {1}",
rd.message,rd.stack))}finally{Q&&Q.dispose()}}Jtk(b,h,v,D,Q){let ba=new ne.GraphIterator;for(ba.set(D);h<v;){D=b.Mpb.J(h);if(!({FBb:D}=this.Iri(null,ba,h,v,D,Q)).returnValue)return{aIf:ba.currentNode,response:!1};ba=D;h++}return{aIf:ba.currentNode,response:!0}}v$i(b,h){var v,D,Q;let ba,ta;const Ta=null===(v=null===b||void 0===b?void 0:b.pa)||void 0===v?void 0:v.first.Jb;if(Ta&&0<Ta.length)if(b=b.pa.first.Jb.J(0),b.Kf){v=b.contentControlNode.getValue(lc.a.Tw);ba=Di.a.Bj?this.zd.yq(b.contentControlNode.id,
!0):this.zd.Ps.get(null===(D=b.contentControlNode.id)||void 0===D?void 0:D.toString());ta=Di.a.Bj?this.zd.yq(b.contentControlNode.id,!1):this.zd.tt.get(null===(Q=b.contentControlNode.id)||void 0===Q?void 0:Q.toString());if(0!=this.Wo.HMb(v))return u.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,Y5e:ba,sBh:ta};h.Wyb=!0}else u.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.Wyb=!1;else h.Wyb=!1;return{response:!0,Y5e:ba,sBh:ta}}nYo(b,
h,v,D,Q){u.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.q7a.Nce(b);const ba=this.pOd(b);if(!this.r1i(ba,h,v,D))return Mi.RFa("Failed to populate empty TOC."),!1;if(h=this.eb.jg(b,!1,!0))v=b.ia(lc.a.jN,null),D=h.ia(lc.a.jN,null),v==D&&this.i5f(h);b.setValue(lc.a.jN,Q);return!0}r1i(b,h,v,D){this.Kd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.KOi(b);const Q=b.pa.first;this.Be.qL(Q.formatting,!0);this.baf(b,0,1,D);Mi.OTo&&Q.zcg&&b.xe.jq.Z(Q.formatting.pe,
ks.CharacterPropertiesEditor.LM);return h&&v&&!this.P$e(v,b.id)?!1:!0}pOd(b){b.pa.reset();b.NZa();const h=new KA.a(b,0);h.formatting=new Ov.a(h,W.a.nil);h.Uh=!0;b.pa.add(h);return Pe.a.createTextRange(b,0,b.characterData.length)}pzi(b){if(de.ParagraphReader.XQ(b)){var h=b.pa.last.ed;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).xg;const v=1===h.J(h.length-3).xg&&h.J(h.length-3).instruction.trim().startsWith(this.PSc),D=2===h.J(h.length-2).xg;h=5===h.J(h.length-1).xg;return b&&v&&
D&&h}}return!1}wzi(b){if(de.ParagraphReader.XQ(b)){var h=b.pa.first.ed;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).xg,h=3===h.J(1).xg,b&&h}return!1}X$i(b){const h=b.pa.last.ed,v=h.J(h.length-4),D=h.J(h.length-3),Q=h.J(h.length-2),ba=h.J(h.length-1);h.remove(v);h.remove(D);h.remove(Q);h.remove(ba);b.removeProperty(lc.a.jN)}W$i(b){const h=b.pa.first.ed,v=h.J(0),D=h.J(1);h.remove(v);h.remove(D);b.removeProperty(lc.a.jN)}i5f(b){if(b){var h=b.ia(lc.a.jN,null),v=b.ia(lc.a.Lc,null).toString(),
D=h;v==h&&this.pzi(b)&&(this.X$i(b),(b=this.eb.jg(b,!1,!0))&&(D=b.ia(lc.a.jN,null)));v=new ne.GraphIterator;v.set(b);v.zb(8);u.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var Q;b&&b.ur&&D==h&&Q!=b;){if(this.wzi(b)){this.W$i(b);break}this.q7a.Nce(b);this.Kn.Vd(v);D=this.Kn.Ur(v,!1,!0);this.nh.WGa(b);if(!D)return null;Q=b;v.Sb(2);D=(b=v.currentNode)?b.ia(lc.a.jN,null):null}return b}}Kdm(b){var h=b.pa,v=h?h.length:0,D=null;b=new OB(!0,!1,!1,0,8,!0,void 0);for(let Q=
0;Q<v&&(D=this.Jdm(h.J(Q)),b.instruction=D,D=this.Eam(D),D[0]!==this.PSc);Q++);h=D?D.length:0;for(v=1;v<h;v++)switch(D[v]){case "\\h":b.Cjb=!0;break;case "\\u":b.gzf=!0;break;case "\\o":this.oko(D[v+1],b)&&v++;break;case "\\z":break;case "\\n":b.keg=!1;b.zad.push(D[v]);break;default:b.zad.push(D[v])}return b}oko(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.fJb=Number.parseInvariant(b[1])-1,h.PQb=Number.parseInvariant(b[2])-1,!0):!1}TYn(b){try{Qe.a(Mi.x_n);const h=window.performance.now(),
v=this.Pgi(b);if(null==v){Mi.NKf("Attempt to remove TOC when firstTocPara = null");return}let D,Q,ba;const ta=this.b7h();if(!({Y5e:D,sBh:Q}=this.v$i(v,ta)).response)return Mi.NKf("Failed to remove content control"),!1;if(void 0==D&&void 0==Q)ba=this.i5f(v);else{ba=v.Jc.Db(D);const ob=new ne.GraphIterator;ob.set(ba);ob.zb(8);b=!1;let Kb;for(;!b&&ba&&Kb!=ba;){ba.id.equals(Q)&&(b=!0);ba&&ba.ur&&this.q7a.Nce(ba);this.Kn.Vd(ob);const Vb=this.Kn.Ur(ob,!1,!0);this.nh.WGa(ba);if(!Vb){ba=null;break}ob.Sb(2);
Kb=ba;ba=ob.currentNode}}ba&&this.gZc(ba);const Ta=window.performance.now()-h;Qe.a(Mi.Y$i,!0,Ta)}catch(h){Mi.NKf(String.format("{0} {1}",h.message,h.stack))}return!0}gZc(b){b=Pe.a.Rc(b,0);b=new Rp.Selection([b],!0);this.ib.setSelection(b)}P$e(b,h){return this.Wo.Ila(b,h,null,Mi.Jpl,!0).returnValue?(u.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}HUk(){this.q7a.Idm()||this.TUe.jeg()}Pgi(b){if(!b.ur)return u.ULS.sendTraceTag(528320659,3019,
15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(lc.a.jN,null);return this.CI.p6l(b)}d7m(b){b.length&&(b=[Object.assign(new pa.a,{name:"UnsupportedSwitches",string:b.toString()})],Qe.a("UnsupportedTocInstruction",void 0,void 0,b))}Jdm(b){const h=(b=b.ed)?b.length:0;for(let v=0;v<h;v++)if(1===b.J(v).xg&&b.J(v).instruction.trim().startsWith(this.PSc))return b.J(v).instruction.trim();return null}Eam(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}M9k(b){b=this.MLh(b,
null,!0,void 0).returnValue;if(!b)return Mi.QQa("Failed to create paragraph"),!1;const h=Pe.a.Rc(b,0);if(!this.r1i(h,!0,b.id,this.Npb.instruction))return Mi.QQa("Failed to populate empty TOC"),!1;u.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}MLh(b,h,v,D){let Q,ba;v&&b?(Q=this.b$k(b),ba=Q.currentNode,D=de.ParagraphReader.RQ(ba).toString()):h&&(Q=this.x3l(h),ba=this.nh.YI(Q));if(!ba)return u.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),
{returnValue:null,FBb:Q};ba.setValue(lc.a.jN,D);return{returnValue:ba,FBb:Q}}$En(){const b=new Sys.StringBuilder(this.PSc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}oFn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Npb.Cjb&&h.append(" \\h");return h.toString()}x3l(b){b.vd();this.Kn.Vd(b);return this.nh.joa(b,!1)}b$k(b){const h=new ne.GraphIterator;h.set(b.node);h.vd();this.Kn.Vd(h);let v=this.obi(h);const D=!b.cpBegin;if(Cd.OutlineElementReader.isEmpty(h,!0))return this.rri(v);
if(D)return this.nh.yA(v,!0,!1),this.nh.X9(h,v,b,!1,!1,!1),b=this.obi(v),this.rri(b);v=this.nh.joa(h);this.nh.X9(h,v,b,!1,!1,!0);b=this.nh.joa(h);this.nh.kOb(b.currentNode,!1);this.nh.YI(b);this.Kn.Ge(b);return b}obi(b){const h=new ne.GraphIterator;h.Zc(b);h.vd();return h}rri(b){this.nh.yA(b,!0,!0);this.nh.kOb(b.currentNode,!1);this.Kn.Ge(b);return b}KOi(b){const h=b.pa;1===h.length&&(h.first.Uh=!1,b.$Jd().Uh=!0)}UXo(b,h,v,D,Q){const ba=this.pOd(b);this.Kd.replaceTextRange(ba,"");this.v1i(b,D,Q);
this.baf(b,h,v,Q.instruction);return Q.Cjb&&!this.hG(b,D.rt)?!1:!0}Iri(b,h,v,D,Q,ba){h=({FBb:b}=this.MLh(b,h,0==v,ba)).returnValue;if(!h)return{returnValue:!1,FBb:b};this.v1i(h,Q,this.Npb);this.baf(h,v,D,this.Npb.instruction);return this.Npb.Cjb&&!this.hG(h,Q.rt)?{returnValue:!1,FBb:b}:{returnValue:!0,FBb:b}}v1i(b,h,v){this.MAm(b,h.prm,h.listMarker,h.Mvj,h.JQa);this.Aih.mCm(b,b.characterData.length);v.keg&&this.FBm(b,h);this.KOi(b);this.Gmo(b,h.Mvj)}X0l(b,h){if(!b)return 0;const v=Mi.yfm();return 4<
b.length?v.J(h)+.5*Math.floor(b.length/3):v.J(h)}MAm(b,h,v,D,Q){v&&this.bBm(b,v,D);v=Pe.a.Rc(b,b.characterData.length);this.Kd.replaceTextRange(v,h);Q&&(b=b.pa.Qh(0),this.Be.Sia(b.formatting,Q))}bBm(b,h,v){v=this.X0l(h,v);const D=Pe.a.Rc(b,0);this.Kd.replaceTextRange(D,h);this.Aih.cBm(b,h.length,v)}FBm(b,h){var v=Pe.a.Rc(b,b.characterData.length);this.Kd.replaceTextRange(v,h.Eh.toString());v=b.pa.Qh(b.characterData.length-h.Eh.toString().length);h=this.oFn(h.rt);this.IPa(b,v,0,2,h);this.IPa(b,v,1,
2,h);this.IPa(b,v,2,2,h);v=b.pa.Qh(b.characterData.length);this.IPa(b,v,3,2,h)}Gmo(b,h){h=this.Vwe.Pi(h);this.Ru.PJ(h,b,!0)}baf(b,h,v,D){const Q=b.pa.first,ba=b.pa.last;h?this.IPa(b,Q,4,1,D):(this.IPa(b,Q,0,1,D),this.IPa(b,Q,1,1,D),this.IPa(b,Q,2,1,D));h===v-1?this.IPa(b,ba,3,1,D):this.IPa(b,ba,5,1,D)}IPa(b,h,v,D,Q=null){v=new bh.a(h,null,v,D,!0,!1,!1,Q);h.ed||(h.ed=new Hw.a(h));h.ed.add(v);b.Xl();this.Kel(v,b)}Kel(b,h){b.pe?h.xe.WX(b.pe-1,2):h.xe.hoa(b.pe,2);h.xe.jq.Z(b.pe,ks.CharacterPropertiesEditor.LM);
h.xe.$s.Z(b.pe,ks.CharacterPropertiesEditor.tR)}hG(b,h){b=Pe.a.createTextRange(b,0,b.characterData.length);return this.tD.hG(b,h,!1,!1,!1,!0)?!0:(u.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static yfm(){Mi.ota||(Mi.ota=new Va.a,Mi.ota.Z("toc 1",1),Mi.ota.Z("toc 2",1.5),Mi.ota.Z("toc 3",2),Mi.ota.Z("toc 4",2.5),Mi.ota.Z("toc 5",3),Mi.ota.Z("toc 6",3.5),Mi.ota.Z("toc 7",4),Mi.ota.Z("toc 8",4.5),Mi.ota.Z("toc 9",5));return Mi.ota}}Mi.ota=null;
Mi.Jpl="Table of Contents";Mi.Zdl="CreateTocClient";Mi.pbf="CreateTocSuccess";Mi.$dl="CreateTocFailureCause";Mi.qYo="UpdateTocClient";Mi.Xmg="UpdateTocSuccess";Mi.rYo="UpdateTocFailureCause";Mi.x_n="RemoveTocClient";Mi.Y$i="RemoveTocSuccess";Mi.y_n="RemoveTocFailureCause";Mi.exd=null;Object(n.a)(Mi,"TOCField",null,[387,388]);var fv=c(636);class Ln{constructor(b,h){this.eAa=b;this.gJa=h}mCm(b,h){if(de.ParagraphReader.Vb(b)&&!(0>h)){var v=Zn.a.V1b(b);v=new fv.a(v,4,1,1);this.eAa.nWd(b,v);b=Pe.a.Rc(b,
h);this.gJa.AWd(b)}}cBm(b,h,v){var D=Ao.a.nM/2;const Q=b.pa.thb(h);D=Hn.FormattingReader.Rn(Q.formatting,Gd.a.fontSize,2*D)/2;v=new fv.a(Nf.a.Hv(D/36)*v,1,0,1);this.eAa.nWd(b,v);b=Pe.a.Rc(b,h);this.gJa.AWd(b)}}Object(n.a)(Ln,"TOCTabUtility",null,[385]);class PB{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}xc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new Fw.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Lv.a.LQ)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",
()=>new Mz(new Fg.a(()=>Ya.App.xa.hb.Uc),Rl.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new Ki.a,new Fg.a(()=>Ya.App.xa.hb.rc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new JA(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new Ln(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new Mi(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),xi.a.instance,
this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),Nv.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Na("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),rl.a.instance,w.AFrameworkApplication.pc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();
this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new Uq(w.AFrameworkApplication.va,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),rl.a.instance,xi.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Sa("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Tb()}dispose(){}}
Object(n.a)(PB,"PackageManager",null,[1,2]);class ao{constructor(b,h,v,D,Q,ba,ta,Ta){this.dSa=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:ob}=this.Iob(Kb,Vb,Dc,!0,!0)).returnValue)return ob;this.Kvd.XKh(Dc,Kb.node);return 32};this.Yxa=(ob,Kb,Vb,bc,Dc)=>this.vli(Kb,Vb,bc,Dc,!0);this.vLb=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:ob}=this.Iob(Kb,Vb,Dc,!1,!0)).returnValue)return ob;this.Kvd.Pal(Dc,Kb.node);u.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Vla=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:bc}=this.Iob(Kb,Vb,Dc,!1,
!0)).returnValue)return 2==Vb&&8==bc&&Dt.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Fe.a.SCb),bc;const Oc=Kb.node;let gd=null;(gd=ob===Eb.a.Vla?this.Kvd.iRb(Dc[Ff.a.SourceControlId],Oc):this.fy.C8b(Oc,Dc))?(this.O9d(Oc,()=>{this.Kxd.C6a(gd,Oc)}),this.HP(),bc=32):(Dt.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Fe.a.SCb),bc=8);ob===Eb.a.Vla&&32===bc&&u.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");u.ULS.shipAssertTag(0,
324,32===bc);return bc};this.Ota=(ob,Kb,Vb,bc,Dc)=>this.vli(Kb,Vb,bc,Dc,!1);this.Jke=(ob,Kb,Vb,bc,Dc)=>Pr.a.Bpa(ob,Kb,Vb,bc,Dc,{},14);this.BAb=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:ob}=this.Iob(Kb,Vb,Dc,!1,!1)).returnValue)return ob;const Oc=Kb.node;this.O9d(Oc,()=>{this.Kxd.nYk(Oc)});return 32};this.fy=b;this.Kvd=h;this.ga=v;this.Kxd=D;this.Gc=Q;this.Sz=ba;this.X8j=Ta}Tb(){this.Ogc(Ya.App.MTa.yKh())}Ogc(b){this.ga.qa(Eb.a.dSa,Zb.a.view,b);this.ga.qa(Eb.a.dSa,Zb.a.table,this.dSa);this.ga.Vc(Eb.a.dSa,1127);
this.ga.qa(Eb.a.Vla,Zb.a.view,this.Jke);this.ga.qa(Eb.a.Vla,Zb.a.table,this.Vla);this.ga.Vc(Eb.a.Vla,1030);this.ga.qa(Eb.a.applyStyle,Zb.a.table,this.Vla);this.ga.qa(Eb.a.Ota,Zb.a.view,this.Jke);this.ga.qa(Eb.a.Ota,Zb.a.table,this.Ota);this.ga.Vc(Eb.a.Ota,1038);this.ga.qa(Eb.a.Yxa,Zb.a.view,b);this.ga.qa(Eb.a.Yxa,Zb.a.table,this.Yxa);this.ga.Vc(Eb.a.Yxa,1127);this.ga.qa(Eb.a.vLb,Zb.a.view,b);this.ga.qa(Eb.a.vLb,Zb.a.table,this.vLb);this.ga.Vc(Eb.a.vLb,1126);this.ga.qa(Eb.a.BAb,Zb.a.view,this.Jke);
this.ga.qa(Eb.a.BAb,Zb.a.table,this.BAb);this.ga.Vc(Eb.a.BAb,1028)}HP(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}vli(b,h,v,D,Q){if(!({gy:ba}=this.Iob(b,h,D,Q,!0)).returnValue)return 2==h&&8==ba&&Dt.a.recordQosError("TableStyleOptionButtonClickNoResponse",
["TableInteractionFailed"],Fe.a.bzl),ba;b=b.node;h=this.fy.aU(b);var ba=D[Ff.a.On];const ta=ao.cem(D.MenuItemId);Q?D[Ff.a.On]=ao.tso(h,ta):(this.fFk(h,ta,ba,b),v.ns=ta,v.xC=ba?0:1,u.ULS.shipAssertTag(0,324,!!ta));return 32}O9d(b,h){const v=this.Gc.Oc(15);try{v.Cb(b),this.Sz.N5a(),h()}finally{v&&v.dispose()}}Iob(b,h,v,D,Q){return this.JSm(b,h,v,D,Q)?{returnValue:D||2===h,gy:32}:{returnValue:!1,gy:8}}JSm(b,h,v,D,Q){if(b.contextId!==Zb.a.table)return!1;if(D||2===h)if(Q&&!v||!Object(yb.a)(zv.TableNode,
b.node)||this.X8j(b.node))return!1;return!0}fFk(b,h,v,D){const Q=(512===h||1024===h?!v:v)?b|h:b&~h;Q!==b&&this.O9d(D,()=>{this.Kxd.Fya(Q,D)})}static mD(){ao.Gcb[ao.JDl]=32;ao.Gcb[ao.ADl]=128;ao.Gcb[ao.MWm]=64;ao.Gcb[ao.DWm]=256;ao.Gcb[ao.MIk]=512;ao.Gcb[ao.LIk]=1024}static tso(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static cem(b){let h=0;b in ao.Gcb&&(h=ao.Gcb[b]);return h}}ao.JDl="buttonFirstRow";ao.ADl="buttonFirstColumn";ao.MWm="buttonLastRow";ao.DWm="buttonLastColumn";ao.MIk="buttonBandedRow";
ao.LIk="buttonBandedColumn";ao.Gcb={};Object(n.a)(ao,"TableStyleActor",null,[]);ao.mD();var Nz=c(766),px=c(402);class Oz extends px.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(Oz,"TableGalleryButtonProps",px.a,[]);class Su extends Oz{constructor(){super()}get Type(){return 6}}Object(n.a)(Su,"TableStyleGalleryButtonProps",Oz,[]);class ey{}ey.Tgn=2147483647;Object(n.a)(ey,"TableStyleUtil",null,[]);class rt{constructor(b,h,v){this.n7e="Clear";this.PCb=
null;this.Zkk=b;this.ve=h;this.fy=v;this.Pba=w.AFrameworkApplication.Pba;this.Vs=w.AFrameworkApplication.Vs}e0a(){}Xrk(b,h){this.e0a(b);const v=this.t3h(b),D=v.length;if(!(0>=D)){var Q=ey.Tgn,ba=null;for(let ob=0;ob<D;ob++){var ta=v[ob],Ta=this.fy.qem(ta);Q!==Ta&&(Q=Object.assign(new $g.a,{Id:"msMoreTableStyles"+Ta,Title:this.rem(Ta),ControlList:[]}),ba=Object.assign(new an.a,{Type:6,Id:"galleryMoreTableStyles"+Ta,ExternalGalleryId:"TableStylesGallery",Width:rt.wgg,ElementDimensions:"Size64by48",
GalleryItems:[]}),this.PCb&&(ba.ExternalId=this.PCb[Ta.toString()]),Q.ControlList.push(ba),h.MenuSectionList.push(Q),Q=Ta);Ta=this.ve.vM(ta);ta=rt.Khg+ob;Ta=Object.assign(new Su,{Id:ta,ExternalId:ta,Command:Eb.a.Vla.toString(),QueryCommand:Eb.a.dSa.toString(),LabelText:Ta?G.a.Af(Ta):"",Alt:Ta,VerticalCenterAlign:"true"});Ta.TableCellStyles=this.dSd(ta,b);Ta.TableStyles=this.xPc(ta,b);ba&&ba.GalleryItems.push(Ta)}}}Wrk(b){const h=Object.assign(new $g.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",
ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),v=Object.assign(new fg.a,{Id:"fseaClearTableFormatting",Command:Eb.a.BAb.toString(),LabelText:G.a.Af(this.n7e),Alt:G.a.Af(this.n7e),Image16by16:this.Vs,Image16by16Class:pd.getImageClassWithCluster(this.Pba,rt.mYk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(v);b.MenuSectionList.push(h)}XKh(b,h){this.e0a(h);const v=b[Ff.a.SourceControlId];var D=this.iRb(v,h);if(D){var Q=this.fy.fF(h);Q=Q?this.ve.pg(Q):null;var ba=
this.ve.vM(D);D=this.ve.pg(D);b[Fi.a.Alt]=ba;b[Fi.a.On]=D===Q;h=Object.assign(new Su,{Id:v,ExternalId:v,Command:Eb.a.Vla.toString(),QueryCommand:Eb.a.dSa.toString(),TableCellStyles:this.dSd(v,h),TableStyles:this.xPc(v,h),Alt:ba});b[Fi.a.GalleryButtonProps]=h}else b[Fi.a.InnerHTML]=null,b[Fi.a.Alt]=null,b[Fi.a.On]=!1,b[Fi.a.GalleryButtonProps]=null}dSd(b,h){this.e0a(h);return(b=this.iRb(b,h))?this.Zkk.R4h(b,h):null}xPc(b,h){this.e0a(h);return this.iRb(b,h),null}Pal(b,h){b.MenuItems=this.V2l(h)}V2l(b){const h=
Object.assign(new Yd.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.Xrk(b,h);this.Wrk(h);return h}iRb(b,h){return b?b.startsWith(rt.Khg)?this.Avf(parseInt(b.substr(rt.Khg.length)),h):this.T5n(parseInt(b.substr(rt.YFo.length)),h):null}}rt.Khg="buttonTableStyleMenu";rt.YFo="buttonTableStyleRibbon";rt.wgg=7;rt.mYk="ClearTableStyle_16x16x32";Object(n.a)(rt,"ATableStyleRibbonControl",null,[384]);class QB extends rt{constructor(b,h,v){super(null,h,v);this.Hhh=b}XKh(b,h){this.e0a(h);const v=b[Ff.a.SourceControlId];
var D=this.iRb(v,h);if(D){var Q=this.fy.fF(h);Q=Q?this.ve.pg(Q):null;var ba=this.ve.vM(D);D=this.ve.pg(D);b[Fi.a.Alt]=ba;b[Fi.a.On]=D===Q;h=Object.assign(new Su,{Id:v,ExternalId:v,Command:Eb.a.Vla.toString(),QueryCommand:Eb.a.dSa.toString(),TableCellStyles:this.dSd(v,h),TableStyles:this.xPc(v,h),Alt:ba});b[Fi.a.GalleryButtonProps]=h}else b[Fi.a.InnerHTML]=null,b[Fi.a.Alt]=null,b[Fi.a.On]=!1,b[Fi.a.GalleryButtonProps]=null}dSd(b,h){this.e0a(h);return(b=this.iRb(b,h))?this.Hhh.R4h(b,h,5,5):null}xPc(b,
h){this.e0a(h);return this.iRb(b,h),null}}Object(n.a)(QB,"ATableStyleRibbonControlVariableSizePreviews",rt,[]);var Wy=c(1462),fy=c(1101);class Cj{constructor(b,h,v,D){this.zNl=(Q,ba)=>this.getBorder(Q,this.K1.wM(ba));this.yNl=(Q,ba)=>this.getBorder(Q,this.K1.EO(ba));this.Uy=b;this.Tu=h;this.Sxb=v;this.K1=D;this.nXj=new Fg.a(()=>this.xNl());this.l9a=new Fg.a(()=>this.wNl())}xNl(){const b={},h=w.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";
b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}wNl(){const b={};b[Pg.a.yCa]=Pg.a.Zdb;b[Pg.a.Zdb]=Pg.a.Zdb;b[Pg.a.qZa]=Pg.a.qZa;return b}W8k(b,h,v,D){const Q=new fy.a;Q.rowCount=v;Q.Deb=D;Q.yTa=this.Sxb.ydm(b);Q.Ha=b.ia(lc.a.Ha,1);Q.Ga=b.ia(lc.a.Ga,1);Q.tableLook=h;Q.Dke=1;return Q}R4h(b,h,v,D){if(!this.Uy.pg(b)||!Object(yb.a)(221,b)||!Object(yb.a)(Oq.a,h))return null;const Q=this.Tu.aU(h);v=this.W8k(b,Q,v,D);D=[];
for(v.rowIndex=0;v.rowIndex<v.rowCount;v.rowIndex++)this.auk(b,h,v,D);return D}xPc(){return null}z8(){}auk(b,h,v,D){v.Q9b=!v.rowIndex;for(v.cellIndex=0;v.cellIndex<v.Deb;v.cellIndex++)this.zqk(b,h,v,D)}zqk(b,h,v,D){h=this.Sxb.c2k(v,this.Sxb.mof(v),h,b);const Q={};var ba=this.Tu.cof(b,h,Gd.a.fontColor,!0,sl.a.SK(),"None");Q.color=ba?ba:"inherit";ba=this.Tu.cof(b,h,Gd.a.yH,!0,sl.a.SK(),"None");Q["background-color"]=ba?ba:"inherit";this.Buk(v,b,h,Q);D.push(Q)}Buk(b,h,v,D){b=this.Sxb.KOa(b);this.Myd(5,
b,h,v,D);this.Myd(3,b,h,v,D);this.Myd(0,b,h,v,D);this.Myd(4,b,h,v,D)}Myd(b,h,v,D,Q){h=this.tUl(b,h,v,D);h!==Pg.a.$F&&(Q[this.nXj.value[Wy.a[b]]]=h)}tUl(b,h,v,D){let Q=Pg.a.$F;if(({bma:Q}=this.sIa(D,b,1,h,this.yNl,Q)).returnValue)return Q;({bma:Q}=this.sIa(v,b,3,h,this.zNl,Q));return Q}sIa(b,h,v,D,Q,ba){return this.K1.npj(v,h,D)&&(ba=Q(b,h))!==Pg.a.$F||!h&&({bma:ba}=this.sIa(b,1,v,D,Q,ba)).returnValue||4===h&&({bma:ba}=this.sIa(b,2,v,D,Q,ba)).returnValue?{returnValue:!0,bma:ba}:{returnValue:ba!==Pg.a.$F,
bma:ba}}getBorder(b,h){let v="",D,Q;({borderStyle:D,borderWidth:Q}=this.BNl(b,h));if(D===Pg.a.qZa)return v;v=String.format(Pg.a.ABd,Q,D,this.Anf(b,h));return v.trim()}Anf(b,h){if(!h)return Pg.a.a_;b=this.Tu.zLc(b,h.color,Sl.a.auto);return b!==Sl.a.auto?Sl.a.VE(b):Pg.a.a_}BNl(b,h){var v=Pg.a.Wta;let D=Pg.a.aG+Pg.a.F1b;if(!h)return{borderStyle:v,borderWidth:D};v=this.Tu.zLc(b,h.style,Pg.a.qZa);b=this.Tu.zLc(b,h.size,Pg.a.aG);D=this.ANl(v,b)+Pg.a.F1b;v=this.rNl(v);return{borderStyle:v,borderWidth:D}}ANl(b,
h){let v=2;b===Pg.a.C1b&&h<Pg.a.ama&&(v=1);return v}rNl(b){return this.l9a.value[b]||Pg.a.D1b}static tem(){return new Cj(Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"),Ns.a.instance,Pg.a.instance)}static get instance(){return null!=Cj.nBg?Cj.nBg:Cj.nBg=Cj.tem()}}Object(n.a)(Cj,"TableStylePreviewGenerator",null,[386]);var st;(function(b){b[b.Abp=0]="background1";b[b.ymp=1]="text1";b[b.Bbp=2]="background2";b[b.zmp=3]="text2";b[b.accent1=
4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.Xep=11]="followedHyperlink";b[b.Pcp=12]="dark1";b[b.lhp=13]="light1";b[b.Qcp=14]="dark2";b[b.mhp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(st||(st={}));Object(n.b)("ThemeColor",st);class Iw{constructor(b){this.qLa=b}zLl(b,h,v){let D;({a6i:h,Lvh:D}=this.x9l(h));b=[];const Q=[];for(let ta=0;16>ta;ta++){if(!(st[ta]in v.ayb))continue;
const Ta=ta,ob=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[D[Ta]],this.M_l(ta));var ba=h[Ta];ba=ba&4278190080|(ba&255)<<16|ba&65280|(ba&16711680)>>>16;Q.push(Object.assign(new Uk.a,{Color:Ta.toString(),DisplayColor:"#"+G.a.XI(ba,6),Alt:G.a.Af(ob)}));b[b.length]=ta}return{returnValue:Q,bIo:b}}M_l(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;
case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}x9l(b){let h=null,v=null;b=this.qLa(b);if(!b)return{a6i:h,Lvh:v};h=b.properties.ia(lc.a.themeColors,null);v=b.properties.getValue(lc.a.ple).split(" ");return{a6i:h,Lvh:v}}static vem(){return new Iw(Object(z.a)(Iw.vh,
Iw.vh.Xs,"navigateToPageContentNode"))}static get vh(){return Rl.PageNavigator.instance}static get instance(){return null!=Iw.GBg?Iw.GBg:Iw.GBg=Iw.vem()}}Object(n.a)(Iw,"TableStyleThemeHelper",null,[414]);var Pv=c(861);class gv{constructor(b,h){this.XTe={};this.ayb={};this.ve=b;this.fy=h}Yhf(b,h){const v=this.XTe[st[h]];return v&&v.length?v:this.tJl(b,h)}i$h(b,h,v){if(h=this.Yhf(h,v))for(b=this.ve.pg(b),v=0;v<h.length;v++)if(this.ve.pg(h[v])===b)return v;return-1}z8(){this.XTe={};this.ayb={}}tJl(b,
h){const v=[];this.ayb={};b=this.fy.Thb(b);this.qAd(v,this.ayb,0,h,b);this.qAd(v,this.ayb,1,h,b);this.qAd(v,this.ayb,2,h,b);this.qAd(v,this.ayb,3,h,b);return this.XTe[st[h]]=v}qAd(b,h,v,D,Q){const ba=Q.lO;for(let ta=0;ta<ba;ta++){const Ta=Q.yEa(ta);if(3!==this.ve.yG(Ta))continue;const ob=this.fy.pem(Ta),Kb=this.fy.kSd(Ta);h[st[Kb]]=!0;ob!==v||Kb!==D&&16!==Kb||this.ve.pg(Ta)===Pv.a.tpg||(b[b.length]=Ta)}}static gim(){return new gv(Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static Cel(){return gv.gim()}}
Object(n.a)(gv,"WACTableStyleRibbonList",null,[413]);class xo extends QB{constructor(b,h,v,D,Q){super(b,h,v);this.CTb=4;this.fwd=[];this.BDm=()=>{this.D_b.z8();this.Hhh.z8()};this.$kk=Q;this.D_b=D;this.n7e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.dDn()}R8k(b,h){b.MenuItems=this.BIl(h)}dDn(){this.PCb={};this.PCb["0"]="CustomTableStyles";this.PCb["1"]="PlainTableStyles";this.PCb["2"]="GridTableStyles";this.PCb["3"]="ListTableStyles"}BIl(b){const h=Object.assign(new Yd.a,{Id:"menuTableTheme"});
h.MenuSectionList=[];if(this.XRm(b))return h;const v=Object.assign(new $g.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),D=Object.assign(new Nz.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:sc.a.Ddb.toString(),QueryCommand:sc.a.lMb.toString(),Width:xo.cIo});D.Colors=({bIo:this.fwd}=this.$kk.zLl(this.fwd,b,this.D_b)).returnValue;v.ControlList.push(D);h.MenuSectionList.push(v);return h}e0a(b){if(b=this.fy.fF(b))b=this.fy.kSd(b),16!==b&&
(this.CTb=b)}t3h(b){return this.D_b.Yhf(b,this.CTb)}Avf(b,h){h=this.D_b.Yhf(h,this.CTb);return 0>b||b>=h.length?null:h[b]}T5n(b,h){var v=this.fy.fF(h);v=this.D_b.i$h(v,h,this.CTb);v=-1!==v?Math.floor(v/rt.wgg)*rt.wgg:0;return this.Avf(v+b,h)}rem(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;
default:return""}}XRm(b){this.e0a(b);return 0>=this.t3h(b).length}lYo(b,h){if(!b||!h)return null;b=parseInt(b[Tc.Color]);var v=this.fy.fF(h);const D=this.fy.kSd(v);if(D===b)return null;if(16===D)return this.CTb=b,null;v=this.D_b.i$h(v,h,D);this.CTb=b;return this.Avf(v,h)}Fll(b){b=this.fy.fF(b);b=this.fy.kSd(b);if(16!==b)for(let h=0;h<this.fwd.length;h++)if(this.fwd[h]===b)return h;return-1}bzb(b){b.rYe(this.BDm,2)}static uem(){return new xo(Cj.instance,Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"),gv.Cel(),Iw.instance)}static get instance(){return null!=xo.jCg?xo.jCg:xo.jCg=xo.uem()}}xo.cIo=4;Object(n.a)(xo,"TableStyleRibbonControls",QB,[383,384]);var LA=c(1556);class Qv extends ao{constructor(b,h,v,D,Q,ba,ta,Ta){super(b,h,v,D,Q,ba,ta,Ta);this.Vfc=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:ob}=this.Iob(Kb,Vb,Dc,!1,!0)).returnValue)return ob;this.Lhg.R8k(Dc,Kb.node);return 32};this.Ddb=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:ob}=this.Iob(Kb,Vb,Dc,!1,!0)).returnValue)return 2==
Vb&&8==ob&&Dt.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],Fe.a.czl),ob;const Oc=Kb.node,gd=this.Lhg.lYo(Dc,Oc);gd&&this.O9d(Oc,()=>{this.Kxd.C6a(gd,Oc)});return 32};this.lMb=(ob,Kb,Vb,bc,Dc)=>{if(!({gy:ob}=this.Iob(Kb,Vb,Dc,!0,!0)).returnValue)return ob;Dc[Tc.IndexColorSelected]=this.Lhg.Fll(Kb.node);return 32}}Ogc(b){super.Ogc(b);this.ga.qa(sc.a.Ddb,Zb.a.view,this.Jke);this.ga.qa(sc.a.Ddb,Zb.a.table,this.Ddb);this.ga.Vc(sc.a.Ddb,1030);this.ga.qa(sc.a.Vfc,Zb.a.view,
b);this.ga.qa(sc.a.Vfc,Zb.a.table,this.Vfc);this.ga.Vc(sc.a.Vfc,1126);this.ga.qa(sc.a.lMb,Zb.a.view,b);this.ga.qa(sc.a.lMb,Zb.a.table,this.lMb);this.ga.Vc(sc.a.lMb,1127)}get Lhg(){return this.Kvd}static oem(){return new Qv(Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"),xo.instance,w.AFrameworkApplication.va,LA.a.instance,new rl.a,Ga.a.instance.resolve("Box4.IInsertionPointFormatting"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(xi.a.instance,
xi.a.instance.jkb,"isTableNodeInLockedRange"))}static get instance(){return null!=Qv.uBg?Qv.uBg:Qv.uBg=Qv.oem()}}Object(n.a)(Qv,"TableStyleActor",ao,[]);var RB=c(1615);class el{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}xc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Cj.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>RB.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>
LA.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}jn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(Qv.instance.Tb(),xo.instance.bzb(bw.a.instance),Ya.App.xa.updateCommandUI())}dispose(){}}Object(n.a)(el,"TableStylePackage",null,[1,2]);var gy=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",
ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},
children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",
LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",
attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",
Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",
MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",
Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},GC=c(1455);class Hh{constructor(b,
h){this.EKa=b;this.$za=h}KVn(b){this.EKa.vzd(b)}WCa(b){this.$za.WCa(b)}FOb(b,h){return this.$za.FOb(b,h)}EOb(b,h){return this.$za.EOb(b,h)}bme(b,h,v){this.$za.bme(b,h,v)}}Object(n.a)(Hh,"ClientPaginationHeaderFooterBridge",null,[531]);class hv{constructor(b,h){this.am=b;this.ga=h;this.baa=new so.a;this.caa=new so.a}WCa(b){b=ne.GraphIterator.$a(b);if(b.Ep()&&b.xq()){b.Qd();do 10===b.Ve&&this.xZf(b.currentNode),b.xt();while(8!==b.Ve)}}FOb(b,h){var v=this.cFb(h);if(!this.baa.nb(v))return u.ULS.sendTraceTag(573400388,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+v),!1;h=this.baa.J(v);u.ULS.shipAssertTag(573400389,336,this.caa.nb(v),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");v=this.caa.J(v);return this.vxf(h,b,v)}EOb(b,h){var v=this.cFb(h);if(!this.baa.nb(v))return u.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+v),!1;h=
this.baa.J(v);u.ULS.shipAssertTag(573400391,336,this.caa.nb(v),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");v=this.caa.J(v);return this.klf(h,b,v)}bme(b,h,v){h=this.Cuf(h,v);this.ga.Qb(b?sc.a.Aoe:sc.a.Ebd,2,h)}Cuf(b,h){h=this.am.iEb(h);if(!h)return u.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.am.Qga(h);const v=1===b;b=!(b%2);return 1===h?1:2===h?v?2:1:3===h?b?3:4:
v?2:b?3:4}xZf(b){if(10===b.type){var h=new so.a,v=this.am.iEb(b);u.ULS.shipAssertTag(573400393,336,!!v,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var D=this.am.Qga(v);b=this.cFb(b);this.Omg(b,D);this.Nmg(b,h);v=ne.GraphIterator.$a(v);if(v.xq()){v.Qd();do b=v.currentNode,D=this.am.kOc(b),b=this.am.Qmi(b),h.add(D,b),v.xt();while(36===v.Ve)}}}Omg(b,h){this.caa.nb(b)?this.caa.Z(b,h):this.caa.add(b,h)}Nmg(b,h){this.baa.nb(b)?
this.baa.Z(b,h):this.baa.add(b,h)}cFb(b){u.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(lc.a.Mia,0)}vxf(b,h,v){const D=1===h;h=!(h%2);switch(v){case 2:if(D){if(b.nb(2))return b.J(2)}else if(b.nb(0))return b.J(0);break;case 3:if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 4:if(D){if(b.nb(2))return b.J(2)}else if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 1:if(b.nb(0))return b.J(0)}return!1}klf(b,
h,v){const D=1===h;h=!(h%2);switch(v){case 2:if(D){if(b.nb(5))return b.J(5)}else if(b.nb(3))return b.J(3);break;case 3:if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 4:if(D){if(b.nb(5))return b.J(5)}else if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 1:if(b.nb(3))return b.J(3)}return!1}}Object(n.a)(hv,"ClientPaginationPageAdornmentContentManager",null,[530]);class SB{constructor(b,h,v,D,Q,ba){this.Z2k=ta=>{1===ta&&this.pE.tE&&(ta=this.Wc.Gva(this.pE.tE,
8,8),this.am.KRk(ta)?this.kjl(ta):this.nuo())};this.uPo=ta=>{1===ta&&this.ga.Qb(Eb.a.openInClient,2,!1)};this.pE=b;this.am=h;this.Wc=v;this.Gc=D;this.Otc=Q;this.ga=ba}Cuo(){const b=new pg.StandardDialog;b.Ad=1;b.Ee(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.cV(0);b.Ju(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.Z2k)}kjl(b){b.jd(8);const h=this.Gc.Oc(15);h.set(b.Nn.pj);this.Otc.WXn(b);this.pE.dismiss();
h.dispose();u.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}nuo(){const b=new pg.StandardDialog;b.Ad=1;b.Ee(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ee(0,CommonUIStrings.l_Close);b.cV(0);b.Ju(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.uPo);u.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(n.a)(SB,"DeleteHeaderFooterDialog",null,[]);class tt{constructor(b,h,v,D,Q){this.am=
b;this.Wc=h;this.Gc=v;this.Otc=D;this.ga=Q}create(b){return new SB(b,this.am,this.Wc,this.Gc,this.Otc,this.ga)}}Object(n.a)(tt,"DeleteHeaderFooterDialogFactory",null,[529]);class Od{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){this.K$=null;this.vjg=(Vb,bc,Dc,Oc,gd)=>{var rd=this.Cvf(bc);return rd?1===Dc?32:(Dc=this.control)?(bc=this.Gc.Oc(15),bc.Cb(rd),bc.fk=Vb,Dc.lba?this.ga.processAction(sc.a.BT,2):(rd=this.qWh(rd),Oc.ns=rd?1:0,Oc=Vb!==sc.a.Ebd,(Vb=this.oqf(Vb,gd))&&Dc.Aya(Vb),this.ga.Qb(sc.a.MId,2,Oc)),
bc.dispose(),32):8:8};this.fdf=(Vb,bc,Dc)=>{if(1===Dc)return 32;this.a0j.create(this.control).Cuo();return 32};this.CKn=(Vb,bc,Dc,Oc,gd)=>1===Dc?32:(Vb=this.control)?(gd[Ff.a.On]=Vb.lba,32):8;this.yob=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc||!this.control.lba)return 32;bc=this.w9h(Vb,gd);Dc=Od.cji(this.control.tE);Oc=this.Gc.Oc(15);Oc.Cb(Dc);Oc.fk=Vb;Vb=this.Wc.yk();Vb.set(Dc);this.FKa.Whf(Vb.currentNode,bc);this.am.EJb(Vb);this.Otc.Vmj(Vb,bc);Oc.dispose();return 32};this.Aya=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc)return 32;
Vb=this.oqf(Vb,gd);this.control.lba&&this.control.Aya(Vb);return 32};this.Ffe=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc)return 32;Vb=this.sfi(Vb,gd);Oc.ns=Vb;bc=this.Cvf(bc);if(!bc)return 8;Oc=this.Wc.yk();Oc.set(bc);Oc.zb(8);Oc.Ht(8);if(!this.Qk.sen(Oc,Vb))return 8;this.am.EJb(Oc);this.control.iga(Oc.currentNode);return 32};this.yZf=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc)return 32;Vb=this.imk.Zcl(this.Cvf(bc));gd.PopulationXML=Vb;return 32};this.tbe=(Vb,bc,Dc,Oc,gd)=>{Vb=this.w9h(Vb,gd);bc=this.control.tE;Dc=this.am.Qga(bc);
gd[Ff.a.On]=Vb===Dc;1===Vb&&(gd[Ff.a.LabelText]=this.eki(bc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.zae=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc||!this.control.lba)return 32;bc=this.control.tE;void 0!==bc&&null!==bc&&(bc=this.am.Qga(bc),Vb=this.oqf(Vb,gd),Dc=this.control.ETb,gd[Ff.a.Visible]=this.cHo(Vb,bc),gd[Ff.a.On]=Vb===Dc);return 32};this.SKn=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc||!this.control.lba)return 32;Vb=this.control.tE;
void 0!==Vb&&null!==Vb&&this.zDn(Vb,gd);return 32};this.bKn=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc||!this.control.lba)return 32;Vb=this.sfi(Vb,gd);bc=this.control.tE;Dc=0;void 0!==bc&&null!==bc&&(Dc=bc.getValue(lc.a.Mia));gd[Ff.a.On]=Vb===Dc;return 32};this.BT=(Vb,bc,Dc)=>{if(1===Dc)return 32;this.control.dismiss();return 32};this.UUd=()=>32;this.MId=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc)return 32;this.control.show(gd);return 32};this.Ekb=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc)return 32;if(!gd)return 8;bc=gd.e_a;if(!bc||!bc.isConnected)return 8;
Vb=this.am.T4d(bc);if(!({isHeader:Dc,vig:bc}=this.am.zhi(bc)).returnValue)return 8;this.control.iga(Vb);this.control.Aya(bc);this.control.show(Dc,gd.Ehe);return 32};this.ga=b;this.am=h;this.Otc=v;this.FKa=D;this.Qk=Q;this.Wc=ba;this.Gc=ta;this.imk=Ta;this.x4j=ob;this.a0j=Kb}get control(){return this.K$}set control(b){this.K$=b}Tb(){this.ga.qa(sc.a.qWd,Zb.a.view,this.vjg);this.ga.fb(sc.a.w1f,Zb.a.application,this.CKn,96);this.ga.qa(sc.a.Aoe,Zb.a.view,this.vjg);this.ga.qa(sc.a.Ebd,Zb.a.view,this.vjg);
this.ga.fb(sc.a.UUd,Zb.a.view,this.UUd,64);this.ga.qa(sc.a.MId,Zb.a.view,this.MId);this.ga.fb(sc.a.BT,Zb.a.application,this.BT,96);this.ga.fb(sc.a.Ekb,Zb.a.application,this.Ekb,96);this.ga.fb(sc.a.Ieo,Zb.a.view,this.Aya,96);this.ga.qa(sc.a.bjj,Zb.a.view,this.Aya);this.ga.qa(sc.a.djj,Zb.a.view,this.Aya);this.ga.qa(sc.a.cjj,Zb.a.view,this.Aya);this.ga.qa(sc.a.ejj,Zb.a.view,this.Aya);this.ga.fb(sc.a.Xho,Zb.a.view,this.yob,100);this.ga.fb(sc.a.Pkj,Zb.a.view,this.yob,4);this.ga.fb(sc.a.Okj,Zb.a.view,this.yob,
4);this.ga.fb(sc.a.Mkj,Zb.a.view,this.yob,4);this.ga.fb(sc.a.Nkj,Zb.a.view,this.yob,4);this.ga.qa(sc.a.Ffe,Zb.a.view,this.Ffe);this.ga.qa(sc.a.B$f,Zb.a.view,this.Ffe);this.ga.fb(sc.a.yZf,Zb.a.view,this.yZf,96);this.ga.fb(sc.a.fdf,Zb.a.view,this.fdf,4);this.ga.fb(sc.a.m4i,Zb.a.view,this.zae,97);this.ga.fb(sc.a.o4i,Zb.a.view,this.zae,97);this.ga.fb(sc.a.n4i,Zb.a.view,this.zae,97);this.ga.fb(sc.a.p4i,Zb.a.view,this.zae,97);this.ga.fb(sc.a.F4i,Zb.a.view,this.tbe,97);this.ga.fb(sc.a.E4i,Zb.a.view,this.tbe,
97);this.ga.fb(sc.a.C4i,Zb.a.view,this.tbe,97);this.ga.fb(sc.a.D4i,Zb.a.view,this.tbe,97);this.ga.fb(sc.a.wKn,Zb.a.view,this.SKn,97);this.ga.fb(sc.a.S0f,Zb.a.view,this.bKn,97)}qWh(b){const h=this.am.iEb(b),v=this.am.Qga(h);b=this.FKa.Whf(b,v);this.control.iga(h);return b}w9h(b,h){switch(b){case sc.a.Pkj:case sc.a.F4i:b=1;break;case sc.a.Okj:case sc.a.E4i:b=2;break;case sc.a.Mkj:case sc.a.C4i:b=3;break;case sc.a.Nkj:case sc.a.D4i:b=4;break;default:b=h}return b}oqf(b,h){switch(b){case sc.a.bjj:case sc.a.m4i:b=
1;break;case sc.a.djj:case sc.a.o4i:b=2;break;case sc.a.cjj:case sc.a.n4i:b=3;break;case sc.a.ejj:case sc.a.p4i:b=4;break;case sc.a.Aoe:case sc.a.Ebd:b=h;break;case sc.a.qWd:b=0;break;default:b=h}return b}sfi(b,h){return b===sc.a.B$f||b===sc.a.S0f?parseInt(h.MenuItemId):h}Cvf(b){return this.Qk.s8(b.$j)}cHo(b,h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}zDn(b,h){const v=this.eki(b);if(h[vm.a.Visible]=v)b=this.Qk.dji(this.x4j(b)),
b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[vm.a.LabelText]=b}eki(b){const h=this.Wc.yk();h.set(b);h.zb(8);h.Ht(8);return 1<this.Qk.Zuf(h)}static cji(b){const h=new ne.GraphIterator;h.set(b);h.zb(10);return kw.WordSectionNavigator.u7n(h)}}Object(n.a)(Od,"HeaderFooterActor",null,[]);var hy=c(788),Ei=c(701);class qx{constructor(b,h,v,D,Q){this.pbk=b;this.am=h;this.Qk=v;this.Wc=D;this.ga=Q}cWh(b,h){this.am.EJb(b);h=this.Tul(b,h);b.sc();return h}Whf(b,h){b=
this.Wc.Gva(b,8,8);let v=!1;this.Qk.wOa(b,D=>{const Q=this.Wc.yk();Q.set(D);v=(D=this.cWh(Q,h))||v;return D});return v}Tul(b,h){if(3!==this.ga.mode)return!1;let v=!1;h=Ei.a.Wdf(h);for(let D=0;D<h.length;++D)v=this.pbk.Sul(b,h[D])||v;return v}}qx.Phl=1;Object(n.a)(qx,"HeaderFooterInserter",null,[522]);class iv{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.Teh=this.eSg=!1;this.tE=null;this.gFe=!1;this.ETb=0;this.jKb=()=>{this.gFe=!0};this.f6=b;b.bind(this);this.bWe=D;this.A0j=ob;this.D8g=Q;this.ick=
ba;this.U$a=ta;this.header=h;this.footer=v;this.header.cel();this.f6.zz();this.jUe=qx.Phl;this.FKa=Ta;iv.ga=Kb;this.vN=Vb}get lba(){return this.eSg}show(b=!0,h=!0){this.lba||(this.nHj(),this.kkj(!0),this.header.ZSn(),this.A0j(),this.gBo(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa&&(Lh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new hy.a,{state:0,disablePopover:!0}))):u.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));
(this.Teh=h)&&this.D8g(b)}dismiss(b=!1){this.lba&&(this.ick(b),this.kkj(!1),this.bCb(),this.ETb=0,this.nCo(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa&&(Lh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new hy.a,{disablePopover:!1}))):u.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}kkj(b){this.eSg=b;iv.ga.processAction(Eb.a.Hlf,2);this.f6.Q0(b);this.header.Q0(b);this.footer.Q0(b);this.bWe()}iga(b){this.tE!==
b&&(this.tE=b,this.header.iga(b),this.footer.iga(b),this.ETb=0,this.yob(this.U$a.Qga(b)))}bCb(){this.tE&&(this.header.Cfb(),this.footer.Cfb(),this.tE=null)}update(){this.lba&&this.GQb()}GQb(){this.tE&&(this.U$a.Aql(this.tE)&&this.U$a.$qm(this.tE)?this.nHj():this.dismiss())}nHj(){const b=this.U$a.Qga(this.tE);b!==this.jUe&&this.yob(b)}yob(b){this.jUe=b;this.Aya(this.Rem(b))}Rem(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Aya(b,h=!0){this.ETb!==b&&(this.FKa.Whf(this.tE,this.jUe),
this.header.ajj(b),this.header.$uh(pc.AppFrame.Nba),this.footer.ajj(b),this.footer.$uh(pc.AppFrame.uba),this.ETb=b,this.lba&&this.Teh&&this.Avl(h))}Avl(b){this.D8g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.f6.h$();this.header.dispose();this.footer.dispose()}gBo(){this.vN.KDc(this.jKb);this.gFe=!1}nCo(){this.vN.fde(this.jKb);this.gFe&&iv.ga.processAction(sc.a.UUd,2)}static Knl(){iv.ga.Qb(Ua.a.uib,2,!0);iv.ga.processAction(sc.a.z3,2)}}iv.ga=null;Object(n.a)(iv,
"HeaderFooterControl",null,[573,10]);class Tr{constructor(b,h,v,D,Q){this.bWe=b;this.U$a=h;this.FKa=v;this.ga=D;this.vN=Q}create(b,h,v,D,Q){return new iv(b,h,v,this.bWe,D,Q,this.U$a,this.FKa,iv.Knl,this.ga,this.vN)}}Object(n.a)(Tr,"Factory",null,[528]);class iy{constructor(){this.K$=null}get control(){return this.K$}set control(b){this.K$=b}rmf(b){return this.smf(this.control.tE,this.control.ETb,b.isHeader,b)}smf(b,h,v,D){return()=>{if(!b.isConnected)return null;this.control.iga(b);this.control.Aya(h);
this.control.show(v);return D}}dismiss(){this.K$.lba&&this.K$.dismiss()}}Object(n.a)(iy,"HeaderFooterControlLauncher",null,[]);var Xy=c(1152),MA=c(649),Ap=c(271),TB=c(811);class nu{constructor(b,h,v){this.ylc=null;const D=h?"Header":"Footer";this.Cr=b.ownerDocument.createElement("div");this.Cr.id=h?"HeaderPane":"FooterPane";this.Cr.classList.add(nu.crm,D);this.Ayb=(new TB.a(this.Cr,"WACViewPanel_"+D)).hI;this.Cr.appendChild(this.Ayb);b.appendChild(this.Cr);h&&(this.ylc=b.ownerDocument.createElement("div"),
this.ylc.classList.add(nu.hrm),this.Cr.appendChild(this.ylc));this.$Kg=v.a6l(this.Cr)}bind(){}Q0(b){b?this.$Kg.tBk():this.$Kg.vBk()}IJk(b){b.Jzb(this.Ayb)}}nu.hrm="HeaderToolbarContainer";nu.crm="HeaderFooterPane";Object(n.a)(nu,"PaneControlDom",null,[586]);class ou{constructor(b,h,v,D,Q){this.pE=this.Nq=null;this.qVi=()=>{this.pE.dismiss(!0);if(this.GUb){const ba=new cu.a(!0);this.GUb.PGa(ba)}return!0};this.LB=ba=>{ba.Gb.preventDefault();return!1};this.Cr=b.ownerDocument.createElement("div");this.Cr.id=
ou.mIh;this.Cr.className=ou.mIh;this.CZ=D;this.GUb=Q;this.Omi=new nu(this.Cr,!0,h);this.Lbl(this.Cr);this.N0h=new nu(this.Cr,!1,h);this.Q0(!1);b.appendChild(this.Cr)}Lbl(b){this.Nq=b.ownerDocument.createElement("div");this.Nq.id=ou.nxn;this.Nq.className=ou.lxn;this.Nq.tabIndex=0;this.Nq.setAttribute(Ze.a.qh,Ze.a.f3);this.Nq.setAttribute(Ze.a.pfa,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Nq)}bind(b){this.pE=b}Q0(b){if(!b&&this.CZ){var h=new cu.a(!0);this.CZ.PGa(h)}!b&&
this.GUb&&(h=new cu.a(!0),this.GUb.PGa(h));this.Cr.style.display=b?"":"none";this.Omi.Q0(b);this.N0h.Q0(b)}rho(){this.Nq.focus()}zz(){Sh.a.instance.mb(Sc.a.click,this.Nq,this.qVi);pf.a.instance.mb(Sc.a.Lx,this.Cr,this.LB)}h$(){Sh.a.instance.uc(Sc.a.click,this.Nq,this.qVi);pf.a.instance.uc(Sc.a.Lx,this.Cr,this.LB)}}ou.mIh="HeaderFooterControl";ou.nxn="HeaderFooterOverlay";ou.lxn="EditingSurfaceOverlay HeaderFooterOverlay";Object(n.a)(ou,"HeaderFooterControlDom",null,[571]);class Rv{constructor(b,h,
v,D,Q,ba,ta,Ta,ob,Kb){this.f6=null;this.ra=new cf.a;this.pE=this.wtd=null;this.PTf=Vb=>{this.M9(Vb);this.ra.raiseEvent("OnShowEventKey")};this.OTf=Vb=>{this.lf&&(this.wtd=new Xy.a(this.lf));this.Ub.QIc(pc.AppFrame.Nba);this.Ub.QIc(pc.AppFrame.uba);this.eda(Vb);this.ra.raiseEvent("OnDismissEventKey")};this.e9d=()=>{this.wtd&&(this.wtd.dispose(),this.wtd=null)};this.Ub=b;this.fp=h;this.p$g=v;this.Z4j=D;this.$dk=Q;this.ga=ba;this.GPg=MA.a.create();this.ATg=Yb.KeyInputManager.kc(zf.a.Bs,0);this.sZ=Yb.KeyInputManager.kc(zf.a.t1,
0);this.Yjk=Yb.KeyInputManager.kc(zf.a.JIa,0);this.yI=ta;this.Ma=Ta;this.CZ=ob;this.GUb=Kb;this.lf&&this.lf.Kla(this.e9d)}dqh(b){this.ra.addHandler("OnShowEventKey",b)}y0n(b){this.ra.removeHandler("OnShowEventKey",b)}vzd(b){this.ra.addHandler("OnDismissEventKey",b)}xaj(b){this.ra.removeHandler("OnDismissEventKey",b)}get lf(){const b=this.yI.value;return b?b.Vi?b:(u.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(u.ULS.sendTraceTag(25474003,
317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.pE}get u5k(){return this.GPg}bind(b){this.pE=this.B3k(b);this.GPg.instance=this.pE}B3k(b){this.f6=new ou(b,this.$dk.value,this.Ma,this.CZ,this.GUb);b=this.p$g.value.create(this.ga,this.f6.Omi,!0,pc.AppFrame.Nba);const h=this.p$g.value.create(this.ga,this.f6.N0h,!1,pc.AppFrame.uba);this.pE=this.Z4j.value.create(this.f6,b,h,this.PTf,this.OTf);this.Lzf();this.gT();return this.control}Lzf(){var b=3===this.ga.mode?
pc.AppFrame.YE:pc.AppFrame.Kgc;const h=this.Ub.fe(pc.AppFrame.Nba);h.parent=b;this.Ub.EYe(pc.AppFrame.Nba);const v=this.Ub.fe(pc.AppFrame.uba);v.parent=b;this.Ub.EYe(pc.AppFrame.uba);b=this.Ub.fe(Ap.a.RFb);b.parent=gf.AFrame.vp;b.ffa(()=>{this.f6.rho()});b.bindAction(this.ATg,sc.a.BT);b.bindAction(this.sZ,sc.a.BT);b.bindAction(this.Yjk,sc.a.BT);h.bindAction(this.sZ,sc.a.BT);v.bindAction(this.sZ,sc.a.BT)}gT(){this.fp.gT(pc.AppFrame.Nba);this.fp.gT(Ap.a.R1a);this.fp.gT(pc.AppFrame.uba);this.fp.gT(Ap.a.RFb)}M9(b){this.fp.FI(pc.AppFrame.Nba);
this.fp.FI(Ap.a.R1a);this.fp.FI(pc.AppFrame.uba);this.fp.FI(Ap.a.RFb);this.fp.Ww(gf.AFrame.Pn);this.Ub.jDc(pc.AppFrame.Nba);this.Ub.jDc(pc.AppFrame.uba);b?this.Ub.mg(pc.AppFrame.Nba):this.Ub.mg(pc.AppFrame.uba)}eda(b){this.fp.Ww(pc.AppFrame.Nba);this.fp.Ww(Ap.a.R1a);this.fp.Ww(pc.AppFrame.uba);this.fp.Ww(Ap.a.RFb);this.fp.FI(gf.AFrame.Pn);(b||this.Ub.currentScope&&(this.Ub.currentScope.name===pc.AppFrame.Nba||this.Ub.currentScope.name===Ap.a.R1a||this.Ub.currentScope.name===pc.AppFrame.uba||this.Ub.currentScope.name===
Ap.a.RFb))&&this.Ub.mg(gf.AFrame.Pn)}dispose(){const b=this.Ub.fe(Ap.a.RFb);b.ir(this.ATg);b.ir(this.sZ);this.Ub.fe(pc.AppFrame.Nba).ir(this.sZ);this.Ub.fe(pc.AppFrame.uba).ir(this.sZ);this.lf&&this.lf.hde(this.e9d);this.control.dispose()}}Object(n.a)(Rv,"HeaderFooterControlOwner",null,[526,527]);var Pz=c(1099);class rx{constructor(b,h,v,D,Q,ba){this.am=b;this.Wc=h;this.Bdk=v;this.em=D;this.Edk=Q;this.a5j=ba}AAm(b,h){const v=this.Wc.yk();v.set(b);this.am.FJb(v,h);this.Bdk(v);this.Edk(v.currentNode,
this.em);this.a5j.BAm(v,Pz.a(h))}}Object(n.a)(rx,"HeaderFooterDefaultContentInserter",null,[525]);class Bp{constructor(b,h,v,D,Q,ba,ta,Ta){this.bT=b;this.Ukk=h;this.Cue=v;this.em=D;this.Ddk=Q;this.rjk=ba;this.O4j=ta;Bp.nh=Ta}BAm(b,h){this.Ukk(b,1,3,null,!1);this.bT.m7c(Pv.a.tpg,1696,b.currentNode);this.Cue(b,0,this.em?3:1,h);this.Cue(b,1,2,h);this.Cue(b,2,this.em?1:3,h);this.Ddk(b);this.rjk(b,!1,!0,null);this.O4j(b,h)}static get ZG(){return null!=Bp.bJg?Bp.bJg:Bp.bJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=
Bp.dFg?Bp.dFg:Bp.dFg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static Cfo(b,h,v){Ig.moveToCellContent(b,0,h);ig.OutlineElementNavigator.Ge(b);Bp.ZG.ahe(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Bp.paragraphEditor.gE(b.currentNode,v);h||Bp.paragraphEditor.gq.Dya(b,1,-115);2===h&&Bp.paragraphEditor.gq.$Nb(b.currentNode,1,-115);Ig.returnToContainingTable(b)}static Vho(b,h){ig.OutlineElementNavigator.Ge(b);Bp.ZG.ahe(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,
b.currentNode);ig.OutlineElementNavigator.Vd(b)}static BOl(){return(b,h,v)=>{Bp.Cfo(b,h,v)}}static NXl(){return(b,h)=>{Bp.Vho(b,h)}}static $dm(b){return(h,v,D,Q,ba)=>b.iDa(h,v,D,Q,ba)}static Ubm(){return(b,h,v,D,Q)=>Bp.nh.yA(b,h,v,D,Q)}}Bp.nh=null;Object(n.a)(Bp,"HeaderFooterDefaultTableInserter",null,[524]);class NA{constructor(b,h,v,D){this.am=b;this.sqd=h;this.Wc=v;this.Qk=D}Vmj(b,h){b.Nn.properties.setValue(lc.a.Vwf,2===h||4===h);b.zb(8);b.ibd(8).properties.setValue(lc.a.DUd,3===h||4===h)}WXn(b){this.Qk.wOa(b,
h=>{const v=this.Wc.yk();v.set(h);this.am.EJb(v);this.Vmj(v,1);this.XXn(v);return!0})}XXn(b){for(;b.Qd();)b.Cg()}}Object(n.a)(NA,"HeaderFooterEditor",null,[523]);var Sv=c(1104);class OA extends Cq.a{constructor(b){super();this.dWe=b}get index(){return 0}run(){this.dWe()}Zqm(b,h){h.property===lc.a.Vwf&&this.QJ()}Ixn(b,h){h.property===lc.a.DUd&&this.QJ()}QJ(){this.rY()}}Object(n.a)(OA,"ControlUpdateNeededTracker",Cq.a,[]);class Jw{constructor(b,h,v,D,Q,ba){this.H9a=null;this.$4j=v;this.Xjd=h;this.mVb=
b;this.Rdk=D;this.BLa=ba}start(){this.mVb.bind(Ya.App.xa.lD);this.Xjd.control=this.mVb.control;this.Xjd.Tb();this.$4j.control=this.mVb.control;this.Rdk.value.create(this.mVb.control,Object(z.a)(this.Xjd,this.Xjd.qWh,"ensureSectionHeaderFooterAttachedToControl")).Tb();this.Asm()}Asm(){this.H9a=new OA(()=>{this.mVb.control.update()});const b=Ya.App.Tj.zl;b.Ye(35).Go(Object(z.a)(this.H9a,this.H9a.Zqm,"headerFooterContainerNodePropertyChanged"));b.Ye(8).Go(Object(z.a)(this.H9a,this.H9a.Ixn,"pageContentNodePropertyChanged"));
Sv.a.Ace(Object(z.a)(this.H9a,this.H9a.QJ,"setUpdateNeeded"));fs.GraphTransactionManager.instance.gqa(this.H9a,3)}dispose(){this.mVb.dispose();this.BLa.QRh()}}Object(n.a)(Jw,"HeaderFooterManager",null,[]);class Qz{constructor(b,h,v,D){this.Qk=b;this.am=h;this.obk=v;this.oxe=D}Sul(b,h){let v=!1;const D=Ei.a.Zrf(h);b.Nr(D)||(this.LAm(b,h),this.oxe.AAm(b.currentNode,h),v=!0);return v}LAm(b,h){const v=this.obk.create(1074135123),D=b.currentNode.ia(lc.a.Mia,0);v.properties.setValue(lc.a.Mia,D);v.properties.setValue(lc.a.m9b,
h);h=Ei.a.Zrf(h);b.Jf(v,h)}}Object(n.a)(Qz,"HeaderFooterNodeLevelInserter",null,[521]);var sx=c(225),UB=c(387);class tx extends sx.a{constructor(b,h,v){super(b,h,"","");this.Zvb=null;this.Zmi=tx.UOh;this.UQc=[];this.ECe=v}get WA(){return!0}get cssClass(){return"cui-herodock"}ym(){this.SSn();super.ym()}dOa(){for(const b of this.UQc)b.ZJd();super.dOa()}aAo(){let b,h,v;b=[];h=[];v=[];for(let D=0;D<this.UQc.length;D++){const Q=this.UQc[D];Q.visible?b.length<this.Zmi?b.push(Q):Object(yb.a)(UB.FlyoutAnchor,
Q)?Array.addRange(h,Q.tRl()):h.push(Q):v.push(Q)}return{cKo:b,jxn:h,IDm:v}}Kbl(b){if(!b||!b.length)return null;const h=new Wf.Menu(this.root,this.id+"OverflowMenu",null,null,null),v=new po.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const D of b)v.Jf(D.zQ("Menu20"));h.Jf(v);return h}SSn(){this.Qce();this.Nc=ka.a.tSa(this.Nc);this.DC();var b;({cKo:v,jxn:b,IDm:D}=this.aAo());for(var h of v){var v=h.zQ("Medium20");v.enabled=
!0;this.W_b(v,this.children.count);this.Nc.appendChild(v.Nc);v.bna()}if(b=this.Kbl(b))this.Zvb?this.Zvb.menu=b:(h=this.id+"OverflowMenuLauncher",v={},v.Image20by20=this.ECe.OverflowMenuImage20by20,v.Image20by20Class=this.ECe.OverflowMenuImage20by20Class,v.PopulateDynamically="false",v.HideDefaultArrow="true",v.Alt=this.ECe.OverflowMenuTooltip,v.Command="798637440",v.Id=h,this.Zvb=new UB.FlyoutAnchor(this.root,h,v,b)),b=this.Zvb.zQ("Small20"),b.enabled=!0,this.W_b(b,this.children.count),this.Nc.appendChild(b.Nc),
b.bna();if(w.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const Q of D){var D=Q.zQ("Medium20");this.Jf(D);D.bna()}}dispose(){this.Zvb&&(this.Zvb.dispose(),this.Zvb=null);for(const b of this.UQc)b.dispose();this.Qce();super.dispose()}set WA(b){super.WA=b}}tx.UOh=4;Object(n.a)(tx,"HeroDock",sx.a,[]);var ux=c(599);class Kw extends ux.a{constructor(){super();this.eke=this.aOm=this.QBo=!1;this.S$m=w.AFrameworkApplication.pEf?1:tx.UOh}}Object(n.a)(Kw,"ToolbarBuildOptions",
ux.a,[]);var Vi=c(45),Yy=c(867),HC=c(708);class jv extends sx.a{constructor(b,h,v){super(b,h,"","");this.Coc=v.Alignment;this.KSg=v.ScalingDirection===Vi.a.TNj}ym(){this.jva();this.RW(this.Nc);super.ym()}RW(b){for(let h of this.children){h.DC();switch(this.Coc){case Vi.a.aqe:ka.a.Zf(h.Nc,"cui-toolbar-button-left");break;case Vi.a.y8a:ka.a.Zf(h.Nc,"cui-toolbar-button-center");break;case Vi.a.FRb:ka.a.Zf(h.Nc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Coc);}h.visible&&
b.appendChild(h.Nc);h.bna()}}xO(b){if(!Object(yb.a)(Wp.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.Coc){case Vi.a.aqe:return"cui-toolbar-buttondock alignleft";case Vi.a.y8a:return"cui-toolbar-buttondock aligncenter";case Vi.a.FRb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Coc);}}get WA(){return!0}get alignment(){return this.Coc}S8b(){let b=0;if(this.alignment===Vi.a.y8a)for(let h of this.children){const v=
h;v.visible&&(b+=v.Nc.offsetWidth)}else b=this.Nc.offsetWidth;return b}TRd(){let b=null;if(this.alignment===Vi.a.y8a)for(let h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Nc);break}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.c1?b.x:b.x+b.width:0}QOd(){let b=null;if(this.alignment===Vi.a.y8a){if(0<this.children.count){const h=this.children.ROd(this.children.count-1);for(;h.n4a();){const v=h.get_current();if(v.visible){b=Sys.UI.DomElement.getBounds(v.Nc);
break}}}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.c1?b.x+b.width:b.x:0}Qhf(){for(let b of this.children){const h=b;if(!Object(yb.a)(Wp.a,h)||h.control.visible)h.visible=!0}}F$n(b){const h=this.children.toArray(),v=new HC.a;let D=this.KSg?0:h.length-1;const Q=this.children.count,ba=this.root.zTa;for(;this.S8b()>=b&&!(D>=Q||0>D);){const ta=h[D];ba&&Object(yb.a)(Wp.a,ta)&&ta.control.visible&&(v.add(ta),ta.mth());D+=this.KSg?1:-1}for(let ta of v)ta.a$i(),ta.visible=!1}set WA(b){super.WA=
b}}Object(n.a)(jv,"ButtonDock",sx.a,[]);class ut extends zh.a{constructor(b,h,v,D,Q,ba,ta=!1){super(b,h,ba);this.Tra=this.dZ=this.qla=null;this.mKe=!1;this.n3a=D;this.eke=Q;this.xwd=0;qf.c(h.Size)||(h.Size===Vi.a.Usg||v.options.aOm?this.xwd=0:h.Size===Vi.a.eRj&&(this.xwd=1));this.jmk=ta}get zTa(){return!0}Jf(b){super.Jf(b);Object(yb.a)(jv,b)&&!this.mKe&&(b.alignment===Vi.a.aqe?(this.qla&&this.Uag(),this.qla=b):b.alignment===Vi.a.y8a?(this.dZ&&this.Uag(),this.dZ=b):b.alignment===Vi.a.FRb&&(this.Tra&&
this.Uag(),this.Tra=b))}Uag(){this.mKe=!0;this.Tra=this.dZ=this.qla=null}gob(b,h){b=this.CNc(b);qf.c(b)||b.visible===h||(b.visible=h,this.refresh())}ym(){super.ym();this.P7i(!0)}P7i(b){const h=this.root.WAb;qf.c(this.Nc)&&this.eel();this.Nc=ka.a.tSa(this.Nc);this.VQc&&this.Nc.appendChild(this.VQc);for(let v of this.children)v.visible&&(v.DC(),this.Nc.appendChild(v.Nc),v.bna());this.dZ&&b&&this.pul();h&&h.GY();this.dirty=!1}pul(){if(this.dZ.visible&&this.dZ.children.count&&(this.zth(0,0),this.zql(this.qla,
this.dZ,this.Tra))){let b=0,h=0;const v=this.qla?this.qla.S8b():0,D=this.Tra?this.Tra.S8b():0;if(0<D||0<v)D>v?(b=0,h=D-v):(b=v-D,h=0);this.zth(b,h)}}zql(b,h,v){let D=!1;0===this.root.c1?(b&&(D=b.QOd()>h.TRd()),!D&&v&&(D=h.QOd()>v.TRd())):(b&&(D=b.QOd()<h.TRd()),!D&&v&&(D=h.QOd()<v.TRd()));return D}zth(b,h){0===this.c1?(this.dZ.Nc.style.marginLeft=b+"px",this.dZ.Nc.style.marginRight=h+"px"):(this.dZ.Nc.style.marginRight=b+"px",this.dZ.Nc.style.marginLeft=h+"px")}eel(){this.DC()}iu(){this.ISh(()=>{yy.a.prototype.iu.call(this)})}Gpa(b){b=
this.CNc(b);qf.c(b)||this.ISh(Object(z.a)(b,b.xm,"pollForStateAndUpdate"))}ISh(b){this.Qdc=this.q4a=!1;b();if(this.q4a||this.Qdc)this.jmk||this.refresh(),this.scale()}xO(b){if(!Object(yb.a)(tx,b)&&!Object(yb.a)(jv,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(yb.a)(jv,b)&&b.alignment===Vi.a.y8a)for(let h of this.children)if(h.alignment===Vi.a.y8a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b=
"cui-toolbar-toolbar ";0===this.xwd?(b+="cui-toolbar-onerow ",w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.N8||(b+="UITextTranformUpperCase ")):1===this.xwd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Xua(){return"div"}get H9(){return 26}get vzj(){return this.eO}set vzj(b){this.eO=b}E8k(b){b=b[Vi.a.Bw];return new jv(this.root,b.Id,b)}DC(){super.DC();this.Nc.setAttribute("role","toolbar");this.properties.Title&&this.Nc.setAttribute("title",this.properties.Title)}FIa(b){return this.root&&
this.root.Ngc(b)?!0:!1}uho(){this.USa()}scale(){super.scale();if(!ka.a.Rr(this.properties.Scale)||this.mKe)return!1;qf.c(this.qla)||(this.qla.visible=!0,this.qla.Qhf());qf.c(this.dZ)||(this.dZ.visible=!0,this.dZ.Qhf());qf.c(this.Tra)||(this.Tra.visible=!0,this.Tra.Qhf());this.P7i(!1);const b=this.Nc.offsetWidth,h=qf.c(this.qla)?0:this.qla.S8b(),v=qf.c(this.dZ)?0:this.dZ.S8b(),D=qf.c(this.Tra)?0:this.Tra.S8b();D+v+h>=b&&(D+h>=b?(this.dni(this.dZ),D>=b?(this.dni(this.qla),this.Y8f(this.Tra,b)):this.Y8f(this.qla,
b-D)):this.Y8f(this.dZ,b-D-h));this.q4a=!1;this.ym();return!1}dni(b){b&&(b.visible=!1)}Y8f(b,h){b&&b.F$n(h)}}Object(n.a)(ut,"Toolbar",zh.a,[1127]);class jy extends ut{constructor(b,h,v,D,Q=!1){super(b,h,v,!1,!1,D,Q);this.f4g=!0}get H9(){return 7}get cssClass(){return jy.RBo+" "+super.cssClass}static get RBo(){let b="cui-statusbar";w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.N8||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(n.a)(jy,"StatusBar",ut,[]);var Vs=c(478);class Rz extends Vs.a{constructor(){super();
this.toolbar=null;this.m_d=!1}}Object(n.a)(Rz,"ToolbarBuildContext",Vs.a,[]);class Zy extends gh.Builder{constructor(b,h,v,D){super(b,h,ak.Task.M3(v),D);if(qf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}acg(b){this.root=b}get Gjg(){return this.options}uOk(){const b=new Rz,h=new Yy.a;h.id="toolbar";h.X2c=1;h.handler=Object(z.a)(this,this.jsn,"onReturnToolbarData");h.data=b;this.Mua.Iee(h)}jsn(b){this.acg(this.wOk(b.s2c,b.wHc));this.toolbar.vzj=
this;this.toolbar.ym();this.placeholder.appendChild(this.toolbar.Nc);ka.a.Zf(this.placeholder,"loaded");this.Xta.continueWith(()=>{this.Xta.result.hKb(this.toolbar)},11)}wOk(b,h){var v=Vi.a.Fga(b,Vi.a.QRj);qf.c(v)&&(v=Vi.a.Fga(b,Vi.a.lRj),h.m_d=!0);if(qf.c(v))throw Error.create("No toolbar element was present in the data");b=new Vi.a(v);v=w.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.m_d?this.acg(new jy(b.attributes[Vi.a.id],b.attributes,this,this.naa,v)):this.acg(new ut(b.attributes[Vi.a.id],
b.attributes,this,this.Gjg.QBo,this.Gjg.eke,this.naa,v));this.toolbar.eua=this.options.eua;this.toolbar.Yne=!0;this.toolbar.ym();b=Vi.a.mw(Vi.a.Fga(b.node,Vi.a.BNj));h=this.XLk(b,h);for(const D of h)this.toolbar.Jf(D);return this.toolbar}XLk(b,h){const v=[];for(let D=0;D<b.length;D++)this.iQa(b[D])||Array.add(v,this.AMk(b[D],h));return v}AMk(b,h){const v=Vi.a.KOc(b);let D=null;v===Vi.a.bMj?D=this.gMk(b,h):v===Vi.a.iOj&&(D=this.YMk(b,h));return D}YMk(b,h){var v=new Vi.a(b);v=new tx(this.root,v.attributes[Vi.a.id],
b[Vi.a.Bw]);v.Zmi=this.Gjg.S$m;b=Vi.a.Fga(b,Vi.a.Oqb);b=Vi.a.mw(b);const D=[];for(let ba=0;ba<b.length;ba++){var Q=b[ba];this.iQa(Q)||(Q=this.yfa(Q,h),Array.add(D,Q))}v.UQc=D;return v}gMk(b,h){new Vi.a(b);const v=this.toolbar.E8k(b);b=Vi.a.Fga(b,Vi.a.Oqb);b=Vi.a.mw(b);for(let D=0;D<b.length;D++){if(this.iQa(b[D]))continue;const Q=this.vOk(b[D],h);v.Jf(Q)}return v}vOk(b,h){var v=new Vi.a(b);const D=v.name;v=v.attributes[Vi.a.Cnc];let Q;Q=h.m_d?"Small14":"Small";switch(D){case Vi.a.button:return b=
this.yfa(b,h),b.zQ(qf.b(v)?Q:v);case Vi.a.VDa:return Q=h.m_d?"Medium14":"Medium",b=this.yfa(b,h),b.zQ(qf.b(v)?Q:v);case Vi.a.label:return b=this.yfa(b,h),b.zQ(qf.b(v)?Q:v);case Vi.a.separator:return b=this.yfa(b,h),b.zQ("Small");case Vi.a.toggleButton:return b=this.yfa(b,h),b.zQ(qf.b(v)?Q:v);default:throw Error.create("Invalid control type.");}}}Object(n.a)(Zy,"ToolbarBuilder",gh.Builder,[]);var Sz=c(1467);class Tz{constructor(b,h,v,D,Q,ba){this.Tlb=()=>{this.toolbar.xm()};this.mI=b;b=new mo.CuiHelper(zj.a.tZa,
WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);D=new Kw;D.UG={};ba=3!==ba.mode;D.UG.HeaderToolbarControlsRight=ba;D.UG.HeaderToolbarButtonDockRight=ba;D.UG.HeaderToolbarButtonRemovePageNumbers=ba;Q=new Zy(D,this.mI,this,Q);Q.Mua=new Sz.a(Tz.irm,b);Q.uOk();this.Bla=Q.toolbar;v.execute(ta=>{this.toolbar.wF=ta});this.toolbar.refresh();this.toolbar.xm();this.Mh=h;h.XYa(this.Tlb)}get toolbar(){return this.Bla}dispose(){this.Mh.ahc(this.Tlb);this.toolbar&&(this.toolbar.dispose(),
this.Bla=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.uho()}Jnl(){this.toolbar.y3()}hKb(){}}Tz.irm="WordEditorHeaderToolbarData";Object(n.a)(Tz,"HeaderFooterToolbar",null,[123,519]);class As{constructor(b,h,v,D,Q){this.Mh=b;this.Dwe=h;this.ld=v;this.naa=D;this.ga=Q}create(b){return new Tz(b,this.Mh,this.Dwe,this.ld,this.naa,this.ga)}}Object(n.a)(As,"Factory",null,[505]);class ri{constructor(b,h){this.Wc=b;this.Qk=h}Zcl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+
this.Ycl(b)+"</Controls></MenuSection></Menu>"}xXl(b){const h=this.Wc.yk();h.set(b);h.zb(8);h.jd(8);return h}Ycl(b){if(!b)return"";let h="";b=this.xXl(b);this.Qk.wOa(b,v=>{const D=this.Qk.dji(v);v=v.getValue(lc.a.Mia);h+=bm.k(v.toString(),v.toString(),sc.a.B$f.toString(),sc.a.S0f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,D));return!0});return h}}Object(n.a)(ri,"HeaderFooterToolbarGenerator",null,[507]);var Lw=c(122);class PA extends Tm.a{constructor(b,
h,v,D,Q,ba,ta,Ta){super(b,h,v,D);this.Ys=()=>{this.Ead(this.Bb)};this.mI=b.container;this.Wv=document.createElement("div");this.MG(this.Wv);this.kBa=Q;this.uKa=ba;this.xo.execute(ob=>{ob.H0(this.Ys)});this.uK=ta;if(this.vI=Ta)this.mI.style.backgroundColor=this.uK.$7b()}dispose(){super.dispose();this.xo.instance&&this.xo.instance.H5a(this.Ys)}get xo(){return null!=this.bAg?this.bAg:this.bAg=Ga.a.instance.Sa("Common.IZoomManager")}bC(b){this.mI.classList.add("HeaderFooterViewElement");this.Wv.classList.add("HeaderFooterViewContent");
this.Ead(b.currentNode)}Dda(b){this.Wv.parentNode&&this.Wv.parentNode===this.mI||(this.mI.appendChild(this.Wv),this.uKa.instance&&this.uKa.instance.ecg(this.nc,this.mI));super.Dda(b)}FQb(b){Lw.a.he(()=>{Lw.a.prototype.FQb.call(this,b);this.DEj();this.uKa.instance&&this.uKa.instance.KDj(this.nc,this.Wv.style.paddingLeft,this.Wv.style.paddingTop)},"HFVE:UFO")}Ead(b){this.xo.instance&&this.xo.instance.hcd(this.Wv);this.DEj();b=this.kBa.w8b(b);this.Wv.style.paddingLeft=b.m3b+"px";this.Wv.style.width=
b.vHc+"px";this.uKa.instance&&this.uKa.instance.KDj(this.nc,this.Wv.style.paddingLeft,this.Wv.style.paddingTop)}DEj(){if(this.xo.instance){this.Wv.style.paddingTop="";var b=Qk.a.uB(this.Wv);b.paddingTop&&(b=jc.a.UM(b.paddingTop),this.Wv.style.paddingTop=Math.round(b/this.xo.instance.hj)+"px")}}}Object(n.a)(PA,"HeaderFooterViewElement",Tm.a,[]);class Tv{constructor(b,h,v,D){this.kBa=b;this.uKa=h;this.uK=v;this.vI=D}create(b,h,v,D){return new PA(b,h,v,D,this.kBa,this.uKa,this.uK,this.vI)}}Object(n.a)(Tv,
"Factory",null,[503]);var Uz=c(348),IC=c(192),QA=c(971),JC=c(576);class Ws extends Uz.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld){super(h,ba,ta,Ta,ob,IC.a.$ni,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld);this.isHeader=this.isHeader=b;this.IXa=Q;this.IXa.Q9c=this;D(this);this.Zfd=v;this.pAa=document.createElement("div");this.pAa.setAttribute("Unselectable","on");this.pAa.setAttribute("hideselection","hideselection");this.pAa.setAttribute("style","outline:none;");this.pAa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.pAa.tabIndex=0;this.features.oqj=!0;this.features.E5e=!0}get wDf(){return!0}wvf(){const b=this.Zfd.rmf(this);return QA.ViewReference.cF(this,b)}Sef(b){Object(yb.a)(Ws,b)||this.Zfd.dismiss()}get zxf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}oPc(){return JC.a.hOi}onResize(){super.onResize();this.IXa.pWh()}JE(b,h=null){this.pAa.parentNode&&this.pAa.parentNode.removeChild(this.pAa);super.JE(b,h);this.IXa.bWh(this.Yc.pj)}detach(){this.IXa.oWh();super.detach();this.pAa.parentNode||
this.container.insertBefore(this.pAa,this.container.firstChild)}g7c(){this.hv?super.g7c():this.pAa.focus()}UMd(){this.onResize()}}Object(n.a)(Ws,"HeaderFooterView",Uz.a,[515,202,203,145,10,91,204,205,206]);class RA{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd){this.Zfd=b;this.Xnk=h;this.Wnk=v;this.St=D;this.fd=Q;this.Cla=ba;this.ga=ta;this.lWa=Ta;this.kta=ob;this.X6=Kb;this.Cok=Vb;this.Nt=bc;this.Ly=Dc;this.Qf=Oc;this.yh=gd;this.Rfd=rd}create(b,h){return new Ws(b,h,this.Zfd,this.Xnk,this.Wnk(),
this.St,this.fd,this.Cla,this.ga,this.lWa,this.kta,this.X6,this.Cok,this.Nt,this.Ly,this.Qf,this.yh,this.Rfd)}}Object(n.a)(RA,"Factory",null,[504]);class nr{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld){this.j$g=!1;this.ngh="SourceControlId";this.tIo=1;this.uIo=1E3;this.Wae=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;this.Bjd(Kg[this.ngh]);Kg[Fi.a.Text]=this.GMe.Yxn(this.Bbb.mGb);return 32};this.BKn=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;Kg[Ff.a.On]=this.Bbb.mGb;return 32};this.vvm=(Qd,
ge,ze,gg,Kg)=>{if(1===ze)return 32;this.Bbb.YUo(Kg[Ff.a.On]);return 32};this.y$i=(Qd,ge,ze)=>{if(1===ze)return 32;if(this.K$){ge=nr.vh.Xs(ge.view.Yc);ze=ne.GraphIterator.$a(ge);const gg=this.Sd.oZa();try{const Kg=this.Gc.Oc(15);try{Kg.Cb(ge),Kg.fk=Qd,Zn.a.instance.wOa(ze,Ll=>{this.BXb.c4c(Ll,this.rSl,this.Gio);return!0})}finally{Kg&&Kg.dispose()}}finally{gg&&gg.dispose()}}return 32};this.z1c=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;Kg.MenuItems=this.Tdk.value;this.j$g?this.Bbb.N4n():this.j$g=!0;return 32};
this.GBm=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;const Ll=this.Bjd(Kg[this.ngh]);if(this.K$){ge=nr.vh.Xs(ge.view.Yc);ze=ne.GraphIterator.$a(ge);gg=this.Gc.Oc(15);try{gg.Cb(ge);gg.fk=Qd;let Em=null;const up=this.ge.$f("UserAction","InsertPageNumber");Zn.a.instance.wOa(ze,nv=>{this.K$.lba||this.y1j(nv);Em=this.FMe.EBm(nv,Ll,this.Bbb.mGb)||Em;return!0});up.stop();if(!Em)return 8;this.ovo(Em,Ll)}finally{gg&&gg.dispose()}this.Sd.Ls(12)}return 32};this.Xxn=()=>32;this.Wvo=(Qd,ge,ze,gg,Kg)=>{if(1===ze)return 32;
2===ze&&this.BLa.showCallout(Kg);return 32};this.Vvo=(Qd,ge,ze,gg,Kg,Ll)=>this.URe.create(Qd,ge,ze,gg,Kg,Ll);this.Mnl=(Qd,ge,ze)=>{if(1===ze)return 32;this.BLa.QRh();return 32};this.iuo=Qd=>{w.AFrameworkApplication.va.Kpa(null,sc.a.Trj,Qd.customData,null)};this.rSl=Qd=>{const ge=Th.a.instance.gb.kb;let ze=-1;for(const gg of ge)if(gg.node===Qd){ze=gg.cpBegin;break}return{returnValue:ze,YYd:We.SelectionEditor.km(ge)}};this.Gio=(Qd,ge)=>{Qd=Mg.SelectionFactory.ue(Qd,ge);Th.a.instance.setSelection(Qd)};
this.ga=b;this.Gc=h;this.Hb=v;this.Bbb=D;this.K$=Q;this.am=ba;this.GMe=ta;this.FMe=Ta;this.BXb=ob;this.BLa=Kb;this.ib=Vb;this.URe=bc;this.ge=Dc;this.Sd=Oc;this.Bjd=gd;this.y1j=Ld;this.Tdk=new Fg.a(()=>this.Bbb.V5l())}Tb(){this.ga.fb(sc.a.z1c,Zb.a.view,this.z1c,100);this.ga.fb(sc.a.GZi,Zb.a.view,this.Xxn,68);this.ga.fb(sc.a.yri,Zb.a.view,this.GBm,4);this.ga.fb(sc.a.mGb,Zb.a.view,this.vvm,4);this.ga.fb(sc.a.c4c,Zb.a.view,this.y$i,4);this.ga.fb(sc.a.QZn,Zb.a.view,this.y$i,4);this.ga.fb(sc.a.u1f,Zb.a.application,
this.BKn,97);this.ga.fb(sc.a.Wae,Zb.a.application,this.Wae,97);this.ga.fb(sc.a.Srj,Zb.a.view,this.Wvo,4);this.ga.fT(sc.a.Trj,Zb.a.view,this.Vvo,100);this.ga.fb(sc.a.Lnl,Zb.a.view,this.Mnl,4)}ovo(b,h){const v=b.Ib.paragraph;if(v){var D=this.am.T4d(v);D&&this.K$.iga(D)}D=this.K$.lba;this.K$.show(4>h);v&&this.Who(v)&&(this.Zlo(b,v),this.Kuk(b,D))}Who(b){let h;if(!({isHeader:h,vig:b}=this.am.zhi(b)).returnValue)return!1;this.K$.Aya(b,h);return!0}Zlo(b,h){b=Mg.SelectionFactory.ue(h,b.Ib.cp);this.ib.setSelection(b)}Kuk(b,
h){h=new of.a(2,1,h?this.tIo:this.uIo,this.iuo);h.customData=b;this.Hb.Wb(h)}static get vh(){return Rl.PageNavigator.instance}}Object(n.a)(nr,"PageNumbersActor",null,[518]);class SA{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){this.ga=b;this.Hb=h;this.Bbb=v;this.GMe=D;this.FMe=Q;this.BXb=ba;this.BLa=ta;this.URe=Ta;this.am=ob;this.Sd=Kb;this.Bjd=Vb;this.dnk=bc;this.Zea=Dc}create(b,h){return new nr(this.ga,new rl.a,this.Hb,this.Bbb,b,this.am,this.GMe,this.FMe,this.BXb,this.BLa,Th.a.instance,this.URe,
Ya.App.xa.Gq,this.Sd,this.Bjd,this.dnk,this.Zea,h)}}Object(n.a)(SA,"Factory",null,[502]);var vx=c(1960),$y;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})($y||($y={}));Object(n.b)("ModalCalloutSize",$y);var ky;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(ky||
(ky={}));Object(n.b)("BeakLocation",ky);class ly{constructor(b,h,v){this.sIo=1;this.XOe=!1;this.RYb=null;this.xUn=()=>{this.ib.Pw(this.Lpa);this.XOe=!0;this.RYb=null};this.Lpa=(D,Q)=>{if(D=Q.nl.kb)1<D.length||!D.length?D=!0:(D=D.Oa,D=D.cpEnd-D.cpBegin,D=1<D||!D),D&&this.y0j()};this.Hb=b;this.ib=h;this.y0j=v}zz(){this.Juk()}h$(){this.XOe?(this.ib.DY(this.Lpa),this.XOe=!1):this.RYb&&(this.Hb.We(this.RYb),this.RYb=null)}Juk(){this.RYb=new of.a(2,1,this.sIo,this.xUn);this.Hb.Wb(this.RYb)}}Object(n.a)(ly,
"CalloutDismissManager",null,[]);class Mw{constructor(b,h,v,D){this.dismiss=()=>{this.ax&&(this.Krc.h$(),this.bZc.dismiss())};this.bZc=b;this.Rp=D;this.Krc=new ly(h,v,this.dismiss)}get ax(){return this.bZc.ax}show(){if(!this.ax){const b=document.createElement("div");b.classList.add(Mw.Wxn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.bZc.content=b;this.bZc.show();this.Rp&&this.Rp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Krc.zz()}}dispose(){this.dismiss();
this.bZc.dispose()}static Val(b,h){h=vx.a.zLh(Id.a.getElementBounds(b.targetElement),h,Ya.App.xa.lD,$y.small);h.tfa=Mw.Qnf(b);h.yt=!1;return h}static Qnf(b){let h=ky.bottomCenter;Object(yb.a)(515,b.view)&&b.view.isHeader&&(h=ky.topCenter);return h}}Mw.Wxn="PageNumbersCalloutControl";Object(n.a)(Mw,"PageNumbersCallOutControl",null,[514]);class Vz{constructor(b,h,v){this.JS=null;this.AS=!1;this.dismiss=()=>{this.ax&&this.JS&&Xj.UISurfaces.uM().then(D=>{this.Krc.h$();D.removeNotification(this.JS);this.AS=
!1;return null},D=>{u.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})};this.ul=b;this.Krc=new ly(h,v,this.dismiss)}get ax(){return this.AS}show(){this.ax||Xj.UISurfaces.uM().then(b=>{const h=b.callout(Object.assign(new wn.a,{target:this.ul,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),v=Object.assign(new eh.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.AS=!0},expirationOptions:Object.assign(new Rg.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.JS=b.addNotification(h,v);this.Krc.zz();return null},b=>{u.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(n.a)(Vz,"ReactPageNumbersCallOutControl",null,[514]);class az{constructor(b,h,v){this.ib=h;this.Hb=b;this.Rp=v}create(b,h){if(w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.oQa)return new Vz(h.targetElement,this.Hb,this.ib);b=Mw.Val(h,b);return new Mw(b,this.Hb,this.ib,this.Rp,w.AFrameworkApplication.ta.xP)}}
Object(n.a)(az,"Factory",null,[501]);class VB{constructor(b,h){this.pE=null;this.Sdk=b;this.Ti=h}get control(){return this.pE}showCallout(b){this.control&&this.control.ax&&this.control.dismiss();this.pE=this.pFn(b);this.control.show()}QRh(){this.control&&(this.control.dismiss(),this.pE=null)}pFn(b){const h=this.Ti.vna();this.pE=this.Sdk.value.create(h,b);return this.control}}Object(n.a)(VB,"PageNumbersCalloutControlManager",null,[500]);var kv=c(754);class Wz extends px.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(n.a)(Wz,"PageNumberGalleryButtonProps",px.a,[]);const Tu=(b,h,v)=>{b=b.yk();b.set(v);h.EJb(b);return b};class Dq{constructor(b,h,v){this.PDe=!1;this.Zea=h;this.em=v}get mGb(){return this.PDe}V5l(){const b=Object.assign(new Yd.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.ssk());b.MenuSectionList.push(this.itk());b.MenuSectionList.push(this.Ktk());return b}YUo(b){this.PDe=b;this.N7i()}N4n(){this.PDe=!1;const b={};b[Dq.ppi]="CheckboxModel";
this.Zea(b);this.N7i()}ssk(){const b=Object.assign(new $g.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:G.a.Af(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new kv.a,{Id:Dq.wvm,Command:sc.a.mGb.toString(),QueryCommand:sc.a.u1f.toString(),LabelText:G.a.Af(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:G.a.Af(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}itk(){const b=Object.assign(new $g.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new an.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.em){for(var v=3;1<=v;v--)h.GalleryItems.push(this.hqf(v));for(v=6;4<=v;v--)h.GalleryItems.push(this.hqf(v))}else for(v=
1;6>=v;v++)h.GalleryItems.push(this.hqf(v));b.ControlList.push(h);return b}Ktk(){const b=Object.assign(new $g.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new fg.a,{Id:"btnRemovePageNumber",Command:sc.a.c4c.toString(),LabelText:G.a.Af(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:G.a.Af(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:w.AFrameworkApplication.Vs,Image16by16Class:pd.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}hqf(b){const h=Dq.lXf+b.toString();var v=Object,D=v.assign,Q=new Wz,ba=sc.a.yri.toString(),ta=sc.a.Wae.toString(),Ta=G.a,ob=Ta.Af;let Kb="";switch(b){case 1:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return D.call(v,Q,{Id:h,Command:ba,QueryCommand:ta,Alt:ob.call(Ta,Kb)})}N7i(){const b={};for(let h=1;6>=h;h++)b[Dq.lXf+h.toString()]="PageNumberGalleryButtonModel";b[Dq.ppi]="CheckboxModel";this.Zea(b)}static W5l(b){return b?parseInt(b.substr(Dq.lXf.length)):1}}Dq.wvm="btnIncludePageCount";Dq.ppi="IncludePageCount";Dq.lXf="btnPageNumbersPosition";
Object(n.a)(Dq,"PageNumbersControl",null,[499]);class Bs{constructor(b,h,v,D,Q=null,ba=null,ta=null,Ta=null){this.$Xl=(ob,Kb)=>{const Vb=new sf.a;ob=4>ob;switch(Kb){case 1:case 2:Vb.add(ob?0:3);break;case 3:case 4:Vb.add(ob?0:3),Vb.add(ob?1:4)}return Vb};this.XQl=(ob,Kb,Vb)=>{var bc=Tu(this.Wc,this.am,ob);this.am.FJb(bc,Vb);let Dc=this.SZj(bc,Kb);if(Dc)this.BXb.$$i(Dc);else{bc=Tu(this.Wc,this.am,ob);this.am.FJb(bc,Vb);bc.Qd();if(Cd.OutlineElementReader.Dh(bc)&&(ig.OutlineElementNavigator.Ge(bc),de.ParagraphReader.sh(bc))){bc=
bc.currentNode;const Oc=this.Ehi(Kb);de.ParagraphReader.Ex(bc)===Oc&&this.BXb.$$i(bc)&&(Dc=bc)}Dc||(bc=Tu(this.Wc,this.am,ob),this.am.FJb(bc,Vb),this.lL.Wib(bc,null,!0),Dc=ig.OutlineElementNavigator.Ge(bc),this.gE(Kb,Dc))}return Dc};this.YQl=(ob,Kb)=>{let Vb=null;ob.Sb(1);if(Cd.OutlineElementReader.Dh(ob)&&(ob.Sb(2),rh.TableReader.isTable(ob))){var bc=ob.currentNode;if(3===rh.TableReader.Yg(bc)){let Dc=0;bc=rh.TableReader.an(bc);switch(Kb){case 1:case 4:Dc=bc?2:0;break;case 2:case 5:Dc=1;break;case 3:case 6:Dc=
bc?0:2}Ig.moveToCellContent(ob,0,Dc);ob.currentNode&&Cd.OutlineElementReader.Dh(ob)&&(ob=ig.OutlineElementNavigator.Ge(ob),de.ParagraphReader.Vb(ob)&&(Vb=ob))}}return Vb};this.KKm=(ob,Kb)=>{const Vb=Tu(this.Wc,this.am,ob);ob=Vb.currentNode.ia(lc.a.Mia,0);this.am.FJb(Vb,Kb);Kb=Vb.currentNode.ia(lc.a.Mia,0);return ob===Kb};this.Wc=b;this.Udk=h;this.BXb=v;this.am=D;this.Ptc=Q||this.$Xl;this.TZj=ba||this.XQl;this.SZj=ta||this.YQl;this.Y7j=Ta||this.KKm}get lL(){return null!=this.fEg?this.fEg:this.fEg=
Ga.a.instance.resolve("Box4.IOutlineEditor")}EBm(b,h,v){var D=Tu(this.Wc,this.am,b).Nn;D=this.am.Qga(D);D=this.Ptc(h,D);let Q=null;for(let ta=0;ta<D.length;ta++){var ba=D.eg(ta);this.Y7j(b,ba)&&(ba=this.TZj(b,h,ba),Q=this.Udk.htk(ba,v)||Q)}return Q}gE(b,h){Bs.w5.ahe(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);Bs.paragraphEditor.gE(h,this.Ehi(b))}Ehi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get paragraphEditor(){return null!=
Bs.bFg?Bs.bFg:Bs.bFg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get w5(){return null!=Bs.AGg?Bs.AGg:Bs.AGg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(n.a)(Bs,"PageNumbersInserter",null,[498]);var wx=c(879),Ch=c(888);class Vl{constructor(b,h,v=null,D=null,Q=null){this.a8k=(ba,ta)=>{ba=Pe.a.Rc(ba,de.ParagraphReader.textLength(ba));const Ta=ba.node.Jc;return Ta?Vl.characterPropertiesEditor.Zga(ba,ob=>{ob=Ch.a.getInstance(ob);this.kGd(ob,15,Ta,ta);this.kGd(ob,47,Ta,ta);this.kGd(ob,
16,Ta);this.kGd(ob,17,Ta);return ob}):null};this.hCm=(ba,ta)=>{ba=Pe.a.Rc(ba,de.ParagraphReader.textLength(ba));Vl.characterPropertiesEditor.replaceTextRange(ba,ta)};this.Gc=b;this.tqd=v||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.ywe=D||this.a8k;this.Yhh=Q||this.hCm}htk(b,h){const v=this.Gc.Oc(15);v.Cb(b);var D=de.ParagraphReader.text(b),Q=!1;0<D.length&&" "!==D.charAt(D.length-1)&&(Q=!0);if(h){h=String.format(this.tqd,"#","$");Q&&(h=" "+h);Q=h.indexOf("#");D=h.indexOf("$");
u.ULS.shipAssertTag(4256717,309,-1!==Q,"{0}",{["PageNumberIndex"]:Q});u.ULS.shipAssertTag(4256718,309,-1!==D,"{0}",{["PageCountIndex"]:D});u.ULS.shipAssertTag(4256719,309,Q!==D,"{0}",{["PageNumberIndex"]:Q,["PageCountIndex"]:D});let Ta;let ob;if(Q<D){var ba=Q;Ta=D;var ta=wx.a.VNc(0);ob=wx.a.VNc(1)}else ba=D,Ta=Q,ta=wx.a.VNc(1),ob=wx.a.VNc(0);this.BAf(b,h,0,ba);ta=this.ywe(b,ta);this.BAf(b,h,ba+1,Ta);ba=this.ywe(b,ob);this.BAf(b,h,Ta+1,h.length);b=Q<D?ta:ba}else Q&&this.Yhh(b," "),b=this.ywe(b,wx.a.VNc(0));
v.dispose();return b}kGd(b,h,v,D=null){const Q=new Gs.a;Q.setValue(Gd.a.e$,!0);Q.setValue(lc.a.YCb,1);Q.setValue(lc.a.gt,h);switch(h){case 15:Q.setValue(lc.a.tQa,!0);Q.setValue(lc.a.fieldInstruction,D);break;case 47:Q.setValue(lc.a.fieldInstruction,D);break;case 17:Q.setValue(lc.a.VHb,!0)}h=v.Lu(Q,W.a.create());this.duk(b,h)}duk(b,h){b.Eta(h,W.a.nil,S.AParagraphNode.BC,null)}BAf(b,h,v,D){h=h.substring(v,D);0<h.length&&this.Yhh(b,h)}static get characterPropertiesEditor(){return Vl.Kd||(Vl.Kd=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Vl.Kd=
b}}Vl.Kd=null;Object(n.a)(Vl,"PageNumbersNodeLevelInserter",null,[497]);class Si{Yxn(b){return Si.q8l(b)}static q8l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Si.uZi,Si.uZi)}}Si.uZi="1";Object(n.a)(Si,"PageNumbersPositionPreviewGenerator",null,[496]);class Po{constructor(){this.iPg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.mZj=this.iPg.length}xqm(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===de.ParagraphReader.textLength(b)?{returnValue:!0,C1c:h}:{returnValue:!1,C1c:-1}}gpm(b){let h=b.characterData.lastIndexOf(this.iPg);return-1!==h&&h+this.mZj===de.ParagraphReader.textLength(b)?{returnValue:!0,C1c:h}:{returnValue:!1,C1c:-1}}Xpm(b){return Ba.a(b,9)?!0:!1}}Object(n.a)(Po,"PageNumbersReader",null,[495]);class hq{constructor(b,h,v,D,Q,ba=null,ta=null){this.PZn=(Ta,ob,Kb,Vb)=>{Ta=Tu(this.Wc,this.am,
Ta);this.am.FJb(Ta,ob);ob=jo.a.$p(Ta);for(Ta=!1;ob.moveNext();){const bc=ob.currentNode;if(de.ParagraphReader.Vb(ob.currentNode)&&Ba.a(ob.currentNode,9)){Ta=!0;let Dc;const Oc=({YYd:Dc}=Kb(bc,Dc)).returnValue;let gd=Oc;gd=this.uYn(bc,gd);gd=this.k_n(bc,gd);-1<Oc&&(gd===Oc&&Dc||Vb(bc,gd))}}Ta&&this.Sd.Ls(12)};this.Wc=b;this.am=h;this.HMe=v;this.Sd=D;this.Nzc=Q;this.Ptc=ba||Ei.a.Wdf;this.hgk=ta||this.PZn;this.tqd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.MVg=String.format(this.tqd,
"#","$");this.p6j=this.MVg.indexOf("#");this.o6j=this.MVg.indexOf("$");this.XAe=String.format(this.tqd,"\ufffc","\ufffc");this.FVg=this.XAe.length}c4c(b,h,v){var D=Tu(this.Wc,this.am,b).Nn;D=this.am.Qga(D);D=this.Ptc(D);for(const Q of D)this.hgk(b,Q,h,v)}$$i(b){if(this.HMe.Xpm(b)){let h=-1;if(({C1c:h}=this.HMe.gpm(b)).returnValue&&this.fCh(b,h)||({C1c:h}=this.HMe.xqm(b)).returnValue&&this.qUk(b,h))return!0}return!1}k_n(b,h){var v=b.pa.length;for(let Q=0;Q<v;Q++){var D=b.pa.J(Q);D.blob&&9===D.blob.Bh&&
(D=D.cp,v=Pe.a.createTextRange(b,D,D+1),this.Nzc(v,""),v=b.pa.length,Q--,h=this.Tqh(h,D,1))}return h}uYn(b,h){let v=b.characterData.indexOf(this.XAe);for(;-1!==v;)this.fCh(b,v)&&(h=this.Tqh(h,v,this.FVg)),v=b.characterData.indexOf(this.XAe);return h}qUk(b,h){const v=b.pa.Qh(h);return v&&v.blob&&9===v.blob.Bh?(b=Pe.a.createTextRange(b,h,h+1),this.Nzc(b,""),!0):!1}fCh(b,h){const v=b.pa.Qh(h+this.p6j),D=b.pa.Qh(h+this.o6j);return v&&v.blob&&9===v.blob.Bh&&D&&D.blob&&9===D.blob.Bh?(b=Pe.a.createTextRange(b,
h,h+this.FVg),this.Nzc(b,""),!0):!1}Tqh(b,h,v){-1<b&&b>h&&(h=b-h,b=h>v?b-v:b-h);return b}}Object(n.a)(hq,"PageNumbersRemover",null,[493]);class Xz{constructor(b,h){this.prb=this.orb=null;this.Cr=b;this.Hb=h}tBk(){this.Cr.style.display="";this.orb||(this.prb&&(this.Hb.We(this.prb),this.prb=null),this.orb=new of.a(0,1,10,()=>{this.Cr.classList.add("Displayed");this.orb=null}),this.Hb.Wb(this.orb))}vBk(){this.Cr.classList.remove("Displayed");this.prb||(this.orb&&(this.Hb.We(this.orb),this.orb=null),
this.prb=new of.a(0,1,200,()=>{this.Cr.style.display="none";this.prb=null}),this.Hb.Wb(this.prb))}}Object(n.a)(Xz,"PaneControlAnimationHelper",null,[512]);class TA{constructor(b){this.Hb=b}a6l(b){return new Xz(b,this.Hb)}}Object(n.a)(TA,"PaneControlAnimationHelperFactory",null,[494]);class UA{constructor(b,h,v,D,Q,ba,ta,Ta,ob=!1){this.hKg=this.Bla=this.Yjd=null;this.brm=()=>{this.uu.sendNotification(this.hKg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.f6=h;this.f6.bind(this);this.fFe=v;this.Rsa=Q;this.ZUe=ta;this.Ub=Ta;this.tld=ob;this.hea=ba.value.create(v,D);this.f6.IJk(this.hea);this.sZ=Yb.KeyInputManager.kc(zf.a.t1,0)}get uu(){return null!=this.Svg?this.Svg:this.Svg=Ga.a.instance.resolve("Common.Utils.IAriaNotifier")}Q0(b){this.f6.Q0(b);this.Bla&&!b&&this.Bla.Jnl()}iga(b){this.Yjd!==b&&(this.Cfb(),this.Yjd=b)}ajj(b){if(this.Yjd){var h=this.Rsa.b1a(this.Yjd,Ei.a.ZXl(b,this.fFe));this.tld?(this.hKg=this.Z2h(b,this.fFe),this.hea.WNb(Ze.a.MAd)):
this.GRo(b);h&&this.n2e(h)}}$uh(b){this.tld&&this.Ub&&(b=this.Ub.fe(b))&&b.k7(this.brm)}Z2h(b,h){let v="";switch(b){case 1:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return v}GRo(b){this.hea.okj(this.Z2h(b,this.fFe),Ze.a.MAd)}setInitialSelection(){this.hea.g7c()}n2e(b){this.Cfb();this.hea.JE(b,b.pj)}Cfb(){this.hea.detach()}cel(){this.Bla=
this.ZUe.value.create(this.f6.ylc);this.Voo(this.Bla)}Voo(b){if(this.Ub){const h=this.Ub.fe(Ap.a.R1a);h.parent=gf.AFrame.vp;h.ffa(()=>{b.setFocus();this.hno()});h.bindAction(this.sZ,sc.a.BT)}}hno(){if(this.Ub){var b=this.Ub.fe(Ap.a.R1a);const h=new Ie.DOMFocusListing(()=>this.f6.ylc);h.Tpa=!0;h.Xm(1);this.Ub.Wzb(this.f6.ylc,b,h);b=this.Ub.getRegion(Ap.a.R1a);b.oSa();b.oR=!0;h.pga&&h.Iy(h.pga)}}dispose(){void 0!==this.Bla&&null!==this.Bla&&(this.Ub.fe(Ap.a.R1a).ir(this.sZ),this.Bla.dispose())}ZSn(){void 0!==
this.Bla&&null!==this.Bla&&this.Bla.refresh()}}Object(n.a)(UA,"PaneControl",null,[511]);class VA{constructor(b,h,v,D){this.am=b;this.b5j=h;this.ZUe=v;this.Ub=D}create(b,h,v,D){return new UA(b,h,v,D,this.am,this.b5j,this.ZUe,this.Ub,w.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(n.a)(VA,"Factory",null,[492]);var KC=c(1097);class WB extends bj.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob){super();this.init(b);this.Jl("ShowCalloutForPageNumberOperation");this.qUj=Ta;
this.Qib(this.qUj,h,D,Q,ba);this.Xz=0;this.Abb=ba;this.BLa=ta;this.Mh=ob;1===this.behavior&&(this.mr=32,this.mqa())}run(){var b=this.Mh.hb.tu;if(!this.Xz){var h=Ht.a.D7b(this.Abb,b);this.Abb.FQc(b,h)&&this.Abb.Ova(b,h).element&&(this.Xz=1)}1===this.Xz&&(h=Ht.a.D7b(this.Abb,b),h=this.Abb.Ova(b,h),b=new KC.a(h.element,b),this.BLa.showCallout(b),this.Xz=2);2===this.Xz&&(this.mr=32,this.mqa())}}Object(n.a)(WB,"ShowCalloutForPageNumberOperation",bj.a,[]);class WA{constructor(b,h,v){this.BLa=b;this.ga=
h;this.XRb=v}create(b,h,v,D,Q,ba){return new WB(b,h,v,D,Q,ba,this.BLa,this.ga,this.XRb)}}Object(n.a)(WA,"Factory",null,[380]);class xx{get lL(){return null!=this.dEg?this.dEg:this.dEg=Ga.a.instance.resolve("Box4.IOutlineEditor")}xc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new Jw(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ue("WordEditor.HeaderFooter.IPageNumbersActorFactory"),
b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new RA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),GC.a.Y8e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Ya.App.xa.hb,Ob.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),
b.Sa("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Sa("Common.IZoomManager"),b.Na("Box4.IContentControlViewElementManager"),b.Na("Box4.CpConversionManagerImpl"),b.Na("Box4.ContentControlConfigSettings"),b.Na("Box4.IContentControlReader"),b.Na("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Tv(b.resolve("Box4.SectionAlignedViewPositionProvider"),
b.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ya.App.instance&&Ya.App.instance.WC)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new As(Jd.App.un,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Jd.App.un,w.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",
()=>new VA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),$c.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new Tr(()=>{Ya.App.xa.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),w.AFrameworkApplication.va,
b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new SA(w.AFrameworkApplication.va,xb.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),
b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Dq.W5l,Object(z.a)(Ya.App.xa,Ya.App.xa.Uad,"updateRibbonControl"),Object(z.a)(Ya.App.xa,Ya.App.xa.WG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new iy).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",
()=>new TA(xb.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new Rv($c.FocusManager.instance(),Ya.App.xa.nx,b.Ue("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ue("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),w.AFrameworkApplication.va,new Fg.a(()=>Ya.App.xa.hb.rc),w.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();
b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new NA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),bi.PageReader.instance,new Ci.a,Zn.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new ri(new Ci.a,Zn.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new Od(w.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
Zn.a.instance,new Ci.a,new rl.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Od.cji,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Bp(LA.a.instance,Bp.$dm(b.resolve("Box4.ITableEditor")),Bp.BOl(),w.AFrameworkApplication.isRtl,ig.OutlineElementNavigator.Vd,Bp.Ubm(),Bp.NXl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",
()=>new rx(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Ci.a,h=>this.lL.Wib(h),w.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").kOb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Qz(Zn.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new tt(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Ci.a,new rl.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new qx(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Zn.a.instance,new Ci.a,w.AFrameworkApplication.va)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new Dq(Object(z.a)(Ya.App.xa,Ya.App.xa.Uad,"updateRibbonControl"),Object(z.a)(Ya.App.xa,Ya.App.xa.WG,"updateRibbonControls"),w.AFrameworkApplication.isRtl)).singleInstance();b.register(Si,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Vl(new rl.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new Bs(new Ci.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new Po).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new hq(new Ci.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(z.a)(xx.characterPropertiesEditor,xx.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new VB(b.Ue("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Ya.App.xa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new az(xb.a.instance,Th.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new WA(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),w.AFrameworkApplication.va,Ya.App.xa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new hv(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),w.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new Hh(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=xx.swg?xx.swg:xx.swg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(n.a)(xx,"HeaderFooterComponentConfiguration",null,[2]);class Nw{constructor(){this.$jd=
this.W=null}get name(){return"WordEditor.HeaderFooter"}xc(b){this.W=b;(new xx).xc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}jn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(this.$jd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.$jd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.$jd&&this.$jd.dispose()}static main(){N.a.instance.Fc(new Nw)}}Object(n.a)(Nw,"PackageManager",null,[1,
2]);var XA=c(362),XB=c(492);class Cs{constructor(b,h){this.Qf=b;this.Zl=h}create(){return new XB.a(this.Qf.instance,this.Zl.instance)}}Object(n.a)(Cs,"ContentControlNodeFactory",null,[395]);var my=c(1690),bz=c(383),LC=c(1055);class cz{create(){return new LC.a}}Object(n.a)(cz,"ContentControlContainerNodeFactory",null,[395]);var Xs=c(184),YB=c(390),MC=c(1110);const Yz=b=>b?(b=b.ia(lc.a.c_a,null))&&b.includes(Xs.a.gPh):!1;class ZB{constructor(b,h,v,D,Q,ba){this.rFb=b;this.lg=h;this.characterPropertiesEditor=
v;this.Mfa=D;this.Lqa=Q;this.Sn=ba;this.hTf=(ta,Ta)=>{if(Di.a.dkb)for(const ob of Ta.nOh)Yz(ob.contentControlNode)||(ta=ob.contentControlNode.ia(lc.a.c_a,null),this.yjl(ta))}}get oCf(){return w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Mfa.k8i(this.hTf)}yjl(b){const h=this.rFb.wOc();h&&b&&this.rFb.UPc(h,b)&&(b=new ah.GraphTransaction(7),b.ku(h),h.Cg(),b.dispose())}dIc(){const b=new MC.a;b.setValue(lc.a.Ljm,!0);var h=(h=sb.a.create())?h.toString().replace(RegExp("-",
"g"),"").toUpperCase():null;b.setValue(lc.a.SPc,h);b.setValue(lc.a.t4k,this.oCf);h=sb.a.create();b.setValue(lc.a.Iji,h);return b}RNk(b){const h=b.currentNode.getValue(lc.a.Iji);b.Jf(new YB.a,1);b.F_();b.currentNode.setValue(lc.a.PSh,h);b.Jf(this.lg.ffb(),1);b.F_();return this.lg.YI(b)}Bmo(b){var h=this.rFb.N$h();h.zb(7);if(h.sc()&&h.iPa(0,D=>8==D.type)&&(h=h.currentNode,h=(new Jv.WACStyleSet).TQ(h))){var v=h.Pi(Xs.a.cZf);v?(b=Pe.a.createTextRange(b,0,de.ParagraphReader.textLength(b)),this.Lqa.XZ(b,
D=>{this.Sn.Bfa(D);this.Sn.D6a(D,v)})):u.ULS.sendTraceTag(509116498,368,50,"No Placeholder Text style.")}}fbl(b){var h=this.rFb.N$h();const v=this.dIc();h.Jf(v,29);h.F_();h=this.RNk(h);this.characterPropertiesEditor.replaceTextRange(Pe.a.Rc(h,0),b,!1,!1);this.Bmo(h);return v}GWo(b,h){var v=this.rFb.z8h(b);v&&(v=Pe.a.createTextRange(v,0,de.ParagraphReader.textLength(v)),this.characterPropertiesEditor.replaceTextRange(v,h,!1,!1),this.pVo(b))}pVo(b){const h=this.rFb.wOc();this.rFb.UPc(h,b)&&h.currentNode.setValue(Gd.a.jR,
new Date)}}Object(n.a)(ZB,"GlossaryEditor",null,[609]);class Zz{constructor(b,h,v,D,Q){this.Mfa=b;this.QHh=h;this.SAb=v;this.IJ=D;this.lj=Q;this.r4k=new cz;this.nkn=(ba,ta)=>{this.IJ.he(()=>{if(ta){ta.Mo.selectedContentControls||(ta.Mo.selectedContentControls={});var Ta=ta.Mo.selectedContentControls,ob=ta.PSa;if(ob&&ob.length){var Kb=ob[0];ob=ob[ob.length-1];Kb=this.Mfa.Aof(Pe.a.Rc(Kb.node,Kb.oj),Pe.a.Rc(ob.node,ob.Yo),!1);for(const Vb of Kb)Di.a.Ax&&Vb.contentControlNode.ia(lc.a.rU,!1)||(Ta[Vb.contentControlNode.id.toString()]=
!0)}}},"CC:OnBeforeCopy")};this.UUf=(ba,ta)=>{this.IJ.he(()=>{if(ta){var Ta=ta.clone,ob=ta.original;try{const Kb=ta.Mo.selectedContentControls,Vb=this.Mfa.Knf(ob,0,ob.characterData.length,!0,!0,!1);for(const bc of Vb){const Dc=bc.ke.toString();Kb[Dc]?bc.rp&&!this.N6k(bc.contentControlNode,Ta,Kb)&&(u.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Dc)),this.K4f(Ta,bc.ke)):this.K4f(Ta,bc.ke)}}catch(Kb){u.ULS.sendTraceTag(521171974,307,
10,"onParagraphCopy operation failed: {0}",Kb.toString()),this.QHh.UXn(Ta)}}},"CC:onParagraphCopy")};this.VUf=(ba,ta)=>{this.IJ.he(()=>{if(ta){var Ta=ta.clone,ob=ta.original;try{const Kb=this.Mfa.Knf(Ta,0,ob.characterData.length);ta.Mo.ccObjectIdMapping||(ta.Mo.ccObjectIdMapping={});const Vb=ta.Mo.ccObjectIdMapping;for(let bc=0;bc<Kb.count;bc++){const Dc=Kb.J(bc),Oc=Dc.ke.toString();if(this.UPm(Dc))if(Dc.Mc){const gd=ob.Bi().od.Db(Oc),rd=this.o7l(Dc),je=this.WYk(gd,rd.t_i,rd.Tqi,Ta.Bi().od);Vb[Oc]=
je.id;this.SAb.CEj(Vb[Oc],Ta.id,W.a.nil);this.lj.jdc(je)}else this.SAb.CEj(Vb[Oc],null,Ta.id);Vb[Oc]?(Dc.ke=Vb[Oc],Dc.$u=null):this.K4f(Ta,Dc.ke)}}catch(Kb){u.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Kb.toString())}}},"CC:onParagraphPaste")}}init(){ph.a.Tvk(this.nkn);ph.a.g_e(this.UUf);ph.a.wzd(this.VUf)}tPl(b){if(!b.zb(25)||!b.jd(25))return null;if(!b.Nr(25)){const h=this.r4k.create(1074135144);b.Jf(h,25)}return b.Sb(25)}N6k(b,h,v){var D=b.ia(lc.a.H7,null);const Q=
ne.GraphIterator.$a(h);h=h.Bi().od;v=D&&v[D.toString()]?h.Db(D):this.tPl(Q);if(!v)return u.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;D=hk.a(b,h,!0);ne.GraphIterator.$a(v).Y2(D,26,b.id);54!==v.type&&D.setValue(lc.a.H7,v.id);Di.a.Ax&&bz.a.FAf(null,D);return D}K4f(b,h){this.QHh.Vil(new zb.a([b]),h)}UPm(b){var h=b.Ib.paragraph.Jc;if(!h)return u.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",
b.ke.toString())),!1;h=h.Db(b.$u);if(!h)return u.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.ke.toString())),!1;b=h.getValue(lc.a.gt);return 38===b||39==b}$Nl(b,h){var v,D=b.pa.J(b.pa.length-1);let Q=b.characterData.length;D=(null===(v=null===D||void 0===D?void 0:D.Jb)||void 0===v?void 0:v.length)||0;b.id.equals(h.Ib.paragraph.id)&&(Q=h.Ib.cp,D=h.Ib.Jb.kJ(h.ke,h.Mc));return this.Mfa.Lnf(b,0,Q,0,D)}o7l(b){let h=null,v=b.Ib.paragraph;
const D={};for(;v;){const Q=this.$Nl(v,b);for(let ba=Q.count-1;0<=ba;ba--){const ta=Q.J(ba);if(!ta.rp)continue;const Ta=ta.ke.toString();if(ta.Mc){if(!D[Ta])return{t_i:ta.contentControlNode,Tqi:h}}else D[Ta]=!0,h||(h=ta.contentControlNode)}v=de.ParagraphReader.jg(v,!0,!0)}return{t_i:null,Tqi:h}}WYk(b,h,v,D){let Q;h?Q=this.SAb.Bva(h):(Q=this.SAb.Cva(),h=Q.currentNode);D=hk.a(b,D,!0);D.Zg(lc.a.Tw,ye.a.tF());54!==h.type&&D.setValue(lc.a.H7,h.id);Q.LH(D,v,26);Di.a.dkb&&!Yz(b)&&this.SAb.bZk(b,D);return D}}
Object(n.a)(Zz,"ContentControlCCP",null,[]);var oD=c(714);class $z{constructor(b,h,v,D){this.Kd=b;this.Qf=h;this.eb=v;this.zd=D}get ZX(){return!!this.Qf.instance&&this.Qf.instance.ZX}get ZGb(){return!!this.Qf.instance&&this.Qf.instance.ZGb}Cta(b,h,v,D,Q,ba=Xs.a.SBb,ta=Xs.a.n4b,Ta=null,ob=Xs.a.Pcf,Kb=-1){(b=this.OOc(b,v))?(b.Jb||(b.Jb=new XA.a(b)),this.erk(h,b.Jb,D,Q,ba,ta,Ta,ob,Kb)):u.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}OPh(b,h,v){if(b){new zb.a;
for(let Q=0;Q<b.count;Q++){var D=this.wof(b.J(Q),h,!1);for(const ba of D)this.vYn(ba,v)}}}Uil(b,h){this.OPh(b,h,!0)}Vil(b,h){this.OPh(b,h,!1)}replaceTextRange(b,h,v,D){this.Kd.replaceTextRange(b,h,v===Eb.a.f8c,D)}OOc(b,h){var v=Pe.a.Rc(b,h);this.Kd.U6a(v);for(v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.cp>h)break;if(D.cp===h)return D}return null}erk(b,h,v,D,Q=Xs.a.SBb,ba=Xs.a.n4b,ta=null,Ta=Xs.a.Pcf,ob=-1){const Kb=h.Ib.paragraph;b=new oD.a(h.Ib,!0,!0,!0,null,b,D,v,Q,ba,ta,Ta,null,this.zd);if(!this.ZX||
-1>=ob||ob>h.length)ob=h.length;h.insert(b,ob);Kb.Xl();b.pe?Kb.xe.WX(b.pe-1,512):Kb.xe.hoa(b.pe,512);Kb.xe.jq.Z(b.pe,ks.CharacterPropertiesEditor.LM);Kb.xe.$s.Z(b.pe,ks.CharacterPropertiesEditor.tR)}wof(b,h,v){const D=new zb.a;for(let Q=0;Q<b.pa.length;Q++){const ba=b.pa.J(Q);if(ba.Jb)for(let ta=0;ta<ba.Jb.length;ta++)if(ba.Jb.J(ta).ke.equals(h)&&(D.add(ba.Jb.J(ta)),v))return D}return D}Bad(b,h,v){if(this.ZGb&&b){var D=b.node,Q=b.oj,ba=b.Yo,ta=this.e6h(D,Q,h,!0);h=this.e6h(D,ba,h,!1);v?-1!==ta&&ta++:
-1!==h&&h++;Q||-1===ta||(ta=Math.max(ta,this.eb.Gv(D)));ba===this.eb.textLength(D)&&-1!==h&&(h=Math.min(h,this.eb.av(D)));b.Eb=ta;b.Rb=h}}e6h(b,h,v,D){return(b=(b=b.pa.Qh(h))?b.Jb:null)&&b.length?b.kJ(v,D):-1}vYn(b,h){b&&b.Ib.Jb&&(h?b.Ib.Jb.remove(b):b.Ib.Jb.Vpa(b),h=b.Ib.paragraph,0<=b.pe&&b.pe<h.xe.length&&(b.Ib.cp||1!==h.xe.length||(h.xe.WX(0,512),h.xe.jq.Z(1,ks.CharacterPropertiesEditor.LM),h.xe.$s.Z(1,ks.CharacterPropertiesEditor.tR)),h.xe.removeAt(b.pe,512)),h.Xl())}UXn(b){const h=b.pa;if(h){var v=
new zb.a;for(let D=0;D<h.length;D++){const Q=h.J(D);if(Q&&Q.Jb){for(let ba=0;ba<Q.Jb.length;ba++)v.add(Q.Jb.J(ba).pe);Q.Jb=null}}b.Upa(v)}}WPo(b,h,v){if(!(0>h||0>v))for(this.Kd.U6a(Pe.a.Rc(b,h)),this.Kd.U6a(Pe.a.Rc(b,v)),h=b.pa.Jga(h),v=b.pa.Jga(v),--v;v>h;v--){const D=b.pa.J(v);D.NCf?b.pa.removeAt(v):D.formatting=null}}}Object(n.a)($z,"ContentControlChpManager",null,[617]);class NC{constructor(b,h,v,D,Q){this.eb=b;this.Do=h;this.yh=v;this.ld=D;this.zd=Q}wnf(b){if(!b||!We.SelectionEditor.gf(b))return null;
if(!b.cpBegin){const h=this.i4h(b.node,b.Eb,!0);if(h)return h}return b.cpBegin===this.eb.textLength(b.node)?this.i4h(b.node,b.Eb-1,!1):null}bNl(b,h){b=this.mLh(b,h);return this.wnf(b)}i4h(b,h,v){return b.pa&&b.pa.length?(b=v?b.pa.first.Jb:b.pa.last.Jb)&&0<=h&&h<b.length&&b.J(h).Kf&&b.J(h).Mc===v&&this.YBf(b.J(h))?b.J(h):null:null}Oqf(b){if(!b||!We.SelectionEditor.jv(b))return null;var h=this.Do.mOd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Kf&&this.YBf(b)?(h=1<h.count?h.J(h.count-2):null)&&
!h.Kf&&this.YBf(h)?null:b:null}YBf(b){if(!b)return!1;var h=this.Ici(b);if(!h)return!1;if(b.Mc)var v=b;else v=h,h=b;var D=this.eb.textLength(b.Ib.paragraph);if(v.Ib.cp||h.Ib.cp!==D||!v.rp||v.Pwa||!h.rp||h.Pwa)return!1;v=v.Ib.Jb;h=h.Ib.Jb;for(D=0;D<v.length&&!v.J(D).ke.equals(b.ke);D++)if(!v.J(D).Mc)return!1;for(v=h.length-1;0<=v&&!h.J(v).ke.equals(b.ke);v--)if(h.J(v).Mc)return!1;return!0}iad(b){b=this.wnf(b);this.FFd(b,!1)}CCj(b,h){b=this.mLh(b,h);this.iad(b)}tIa(b){b=this.Oqf(b);return this.FFd(b,
!0)?b:null}FFm(b,h){b=this.wnf(b);return!!b&&b.ke.equals(h)}L$b(b,h,v){b=this.bNl(b,h);return!!b&&b.ke.equals(v)}HDf(b,h){b=this.Oqf(b);return!!b&&b.ke.equals(h)}FFd(b,h){if(!b)return!1;const v=this.Ici(b);return this.vIh(b,h)&&(!v||this.vIh(v,h))}vIh(b,h){if(!b||b.Kf===h)return!1;var v=this.Do.Cme(b.Ib.paragraph,b.Mc);const D=b.Ib.Jb;-1!==v||b.Mc||(v=D.length);const Q=h===b.Mc?1:-1;v+=h?Q:0;b=D.kJ(b.ke,b.Mc)+Q;if(v===b||0<Q!==b>v)return u.ULS.shipAssertTag(24933847,368,v!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",
v,b,Q),u.ULS.shipAssertTag(24933848,368,0<Q===b>v,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",v,b,Q),!1;for(var ba=v;ba!==b;ba+=Q){var ta=D.J(ba);D.Vpa(ta);ta.Kf=h;D.qCm(ta,ba);this.bVo(D.J(ba))}if(this.W_)for(D.Ib.paragraph.Xl(),ba=v;ba!==b;ba+=Q)ta=D.J(ba),ta.paragraph.xe.jq.Z(ta.pe,ks.CharacterPropertiesEditor.LM),ta.paragraph.xe.$s.Z(ta.pe,ks.CharacterPropertiesEditor.tR);h||this.GXo(D,v,b,Q);u.ULS.sendTraceTag(24933849,368,
50,"Converted {0} content control(s) to {1}",Math.abs(b-v),h?"block":"inline");return!0}$Qd(b){var h,v;return b.Mc&&(Di.a.Bj?this.zd.yq(b.contentControlNode.id,!0):this.zd.Ps.get(null===(h=b.contentControlNode.id)||void 0===h?void 0:h.toString())).equals(b.Ib.paragraph.id)?38:!b.Mc&&(Di.a.Bj?this.zd.yq(b.contentControlNode.id,!1):this.zd.tt.get(null===(v=b.contentControlNode.id)||void 0===v?void 0:v.toString())).equals(b.Ib.paragraph.id)?39:b.Kf&&b.Mc?40:b.Kf&&!b.Mc?41:!b.Kf&&b.Mc?38:39}bVo(b){const h=
b.Ib.paragraph.Jc;if(h){var v=h.Db(b.$u),D=b.contentControlNode;if(v){v=v.clone();v.setValue(lc.a.nGf,b.Kf);const Q=this.$Qd(b);v.setValue(lc.a.gt,Q);h.Lu(v,null);b.$u=v.id}D&&D.setValue(lc.a.F8,b.Kf)}}Ici(b){if(b.Ib.cp&&b.Ib.cp!==this.eb.textLength(b.Ib.paragraph)||!b.Ib.paragraph.pa||!b.Ib.paragraph.pa.length)return null;const h=b.Mc?b.Ib.paragraph.pa.last:b.Ib.paragraph.pa.first;if(!h.Jb)return null;b=h.Jb.kJ(b.ke,!b.Mc);return-1===b?null:h.Jb.J(b)}GXo(b,h,v,D){var Q,ba,ta,Ta,ob=b.J(h).contentControlNode;
if(ob){var Kb=b.J(h).Mc,Vb=Kb?this.zd.Ps:this.zd.tt;ob=Di.a.Bj?this.zd.yq(ob.id,Kb):null!==(ba=Vb.get(null===(Q=ob.id)||void 0===Q?void 0:Q.toString()))&&void 0!==ba?ba:W.a.nil;if(!ob.equals(W.a.nil))if(b.Ib&&b.Ib.paragraph&&b.Ib.paragraph.id.equals(ob)){for(h+=D;h!==v;h+=D){Q=b.J(h).contentControlNode;if(!Q)return;Di.a.Bj?this.zd.kE(Q.id,ob,Kb):Vb.set(null===(ta=Q.id)||void 0===ta?void 0:ta.toString(),ob)}0<=v&&v<b.length&&b.J(v).Kf&&this.bGf(b.J(v))&&(b=b.J(v).contentControlNode)&&(Di.a.Bj?this.zd.kE(b.id,
ob,Kb):Vb.set(null===(Ta=b.id)||void 0===Ta?void 0:Ta.toString(),ob))}else u.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}bGf(b){return b.rp&&!b.Pwa}mLh(b,h){if(!b||!this.yh)return null;const v=h?Pe.a.Rc(b,0):Pe.a.jw(b);b=this.yh.Yq(b,h);v.Rb=v.Eb=b;return v}get W_(){return this.ld.isFeatureEnabled(31)}}Object(n.a)(NC,"ContentControlConverter",null,[616]);var yx;(function(b){b[b.w7o=0]="BoundingBox";b[b.B$o=
1]="Tags";b[b.D8o=2]="Hidden";b[b.x9o=3]="NumberOfContentControlAppearance"})(yx||(yx={}));Object(n.b)("ContentControlAppearance",yx);var YA=c(1616),OC=c(1487);class aA{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.x$a=this.BBa=this.vsc=this.rBc=this.ypd=null;this.Oja=this.Ck=this.Hyc=this._id=0;this.dUb=this.ird=this.Lvd=this._title=this.Tza=null;this.rmd=this.qmd=this.c2g=this.qsd=this.$uc=this.Wuc=this.rhd=!1;this.t3g=null;this.Kf=!1;this.Sfd=null;this.oi=v;this.vx=h;this.Rg=D;this.jr=Q;this.Zl=
ba;this.R1=ta;this.I$=Ta;this.afa=ob;this.Jyb=Kb;this.zd=Vb;b?(this.ypd=b.id,this.Sfd=b,this.MT(!1)):this._id=ye.a.tF()}get vj(){return this.oi.value}get id(){this.MT();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.Tw,this._id),this.QY())}get parentId(){this.MT();return this.Hyc}set parentId(b){this.Hyc=b}get title(){this.MT();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.Oeb,this._title),this.QY(),
this.Dad(h=>{h.title=this._title?this._title:Xs.a.SBb}))}get tag(){this.MT();return this.Lvd}set tag(b){this.Lvd=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.Reb,this.Lvd),this.QY())}get type(){this.MT();return this.Ck}set type(b){this.Ck=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.VAb,YA.a[this.Ck]),this.QY())}get appearance(){this.MT();return this.Oja}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Oja=b;
this.isValid()&&(this.contentControlNode.setValue(lc.a.Peb,yx[this.Oja].toLowerCase()),this.QY(),this.Dad(h=>{h.appearance=yx[this.Oja].toLowerCase()}))}get color(){this.MT();return this.Tza}set color(b){if(b&&16777215>=b)this.Tza=b,this.isValid()&&(this.contentControlNode.setValue(lc.a.qHc,this.Tza),this.QY(),this.Dad(h=>{h.color=this.Tza}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.MT();return this.ird}set placeholderText(b){this.ird=b=OC.a.DHc(b);
Di.a.dkb&&(this.Rg.iFj(b,this.Sfd),this.QY(),this.GM&&this.Zl.Cbg(this,b,!0))}get UId(){this.MT();return this.dUb}set UId(b){this.dUb=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.h3b,this.dUb),this.QY())}get xff(){this.MT();return this.rhd}set xff(b){b&&(this.rhd=b,this.isValid()&&(this.contentControlNode.setValue(lc.a.qFd,this.rhd),this.QY()))}get removeWhenEdited(){this.MT();return this.qsd}set removeWhenEdited(b){if(b&&!this.fha)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");
this.qsd=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.THh,this.qsd),this.QY())}get fha(){this.MT();return this.Wuc}set fha(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.Wuc=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.j3b,this.Wuc),this.Dad(h=>{h.NK=this.Wuc}),this.QY())}get isEditable(){this.MT();return this.$uc}set isEditable(b){this.$uc=b;this.isValid()&&
(this.contentControlNode.setValue(lc.a.TAb,this.$uc),this.Dad(h=>{h.editable=this.$uc}),this.QY())}get isSupported(){this.MT();return this.c2g}get ZPm(){return this.isSupported&&11!==this.type&&10!==this.type}get mCi(){this.MT();return this.dUb&&"table of contents"===this.dUb.toLowerCase()?!0:!1}get wZd(){this.MT();return this.qmd}set wZd(b){this.qmd=b;this.isValid()&&(this.contentControlNode.setValue(lc.a.WHh,this.qmd),this.QY())}get Vac(){this.MT();return this.rmd}set Vac(b){this.rmd=b;this.isValid()&&
(this.contentControlNode.setValue(lc.a.XHh,this.rmd),this.QY())}get GM(){return this.contentControlNode.ia(lc.a.I7,!1)}set GM(b){this.isValid()&&this.contentControlNode.setValue(lc.a.I7,b)}get lu(){this.MT();return this.rBc}set lu(b){this.rBc=b}get kz(){this.MT();return this.vsc}set kz(b){this.vsc=b}get objectId(){return this.ypd}set objectId(b){this.ypd=b;this.Sfd=this.vj.Db(this.ypd)}get start(){this.$Gj();return this.BBa}set start(b){this.BBa=b}get end(){this.$Gj();return this.x$a}set end(b){this.x$a=
b}get contentControlNode(){return this.Sfd}Czn(b){for(let h=0;3>h;++h)if(yx[h].toLowerCase()===b)return h;return 0}Dzn(b){for(let h=0;12>h;++h)if(YA.a[h]===b)return h;return-1}QY(){const b=this.start.node;b&&b.setValue(Gd.a.jR,new Date)}Qad(){var b,h,v,D;this._id=this.contentControlNode.ia(lc.a.Tw,0);this.Oja=this.Czn(this.contentControlNode.ia(lc.a.Peb,null));this.Tza=this.contentControlNode.ia(lc.a.qHc,null);this._title=this.contentControlNode.ia(lc.a.Oeb,null);this.Lvd=this.contentControlNode.ia(lc.a.Reb,
null);this.Kf=this.contentControlNode.ia(lc.a.F8,!1);this.Wuc=this.contentControlNode.ia(lc.a.j3b,!1);this.$uc=this.contentControlNode.ia(lc.a.TAb,!1);this.c2g=this.contentControlNode.ia(lc.a.Lfa,!1);this.dUb=this.contentControlNode.ia(lc.a.h3b,null);this.rhd=this.contentControlNode.ia(lc.a.qFd,!1);Di.a.Bj?(this.rBc=this.zd.yq(this.contentControlNode.id,!0),this.vsc=this.zd.yq(this.contentControlNode.id,!1)):(this.rBc=null!==(h=this.zd.Ps.get(null===(b=this.contentControlNode.id)||void 0===b?void 0:
b.toString()))&&void 0!==h?h:W.a.nil,this.vsc=null!==(D=this.zd.tt.get(null===(v=this.contentControlNode.id)||void 0===v?void 0:v.toString()))&&void 0!==D?D:W.a.nil);this.rmd=this.contentControlNode.ia(lc.a.XHh,!1);this.qmd=this.contentControlNode.ia(lc.a.WHh,!1);this.qsd=this.contentControlNode.ia(lc.a.THh,!1);this.Ck=this.Dzn(this.contentControlNode.ia(lc.a.VAb,"RichText"));b=null;try{const Q=this.contentControlNode.ia(lc.a.H7,W.a.nil);if(W.a.Zp(Q,W.a.nil))this.Hyc=0;else if(b=this.vj.Db(Q))this.Hyc=
b.ia(lc.a.Tw,0)}catch(Q){this.Hyc=0}this.FWo()}FWo(){if(this.Jyb){var b=this.contentControlNode.ia(lc.a.c_a,"");if((b=this.I$.Rii(b))&&0<b.length){this.ird=this.r3h(b.Oa,b.Pc);return}}this.ird=(b=this.Rg.Cva())&&b.currentNode?b.currentNode.ia(lc.a.rHc,null):null}MT(b=!0){if(!b||this.isValid())b=this.contentControlNode.ia(Gd.a.lastModifiedTime,new Date(0)),this.t3g!==b?(u.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.Qad(),this.t3g=b):u.ULS.sendTraceTag(520734534,
368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}FXo(b,h){var v,D;this.rBc=b;this.vsc=h;Di.a.Bj?this.zd.kE(this.contentControlNode.id,b,!0):this.zd.Ps.set(null===(v=this.contentControlNode.id)||void 0===v?void 0:v.toString(),b);Di.a.Bj?this.zd.kE(this.contentControlNode.id,h,!1):this.zd.tt.set(null===(D=this.contentControlNode.id)||void 0===D?void 0:D.toString(),h)}$Gj(){if(this.contentControlNode){var b=this.lu,h=this.kz;if(!b||!h||b.equals(W.a.nil)||
h.equals(W.a.nil))u.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.Rg.rna(b,!0),h=this.Rg.rna(h,!1),b&&h)if(b.isConnected&&h.isConnected||u.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Kf)b=Pe.a.create(b),this.jr.Bad(b,this.objectId,!0),this.start=b,b=Pe.a.create(h),this.jr.Bad(b,this.objectId,!0),this.end=b;else{let v=h=-1;if(b.pa){for(let D=0;D<b.pa.length&&(-1===
h||-1===v);D++){const Q=b.pa.J(D);if(Q.Jb)for(let ba=0;ba<Q.Jb.length&&(-1===h||-1===v);ba++){const ta=Q.Jb.J(ba);W.a.Zp(ta.ke,this.objectId)&&(ta.Mc?h=Q.cp:v=Q.cp)}}0<=h&&0<=v&&(b=Pe.a.nO(h,v,!1,b),this.jr.Bad(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const v=this.end;if(!h||!v)return b;this.Kf?b=this.r3h(h,v):(h=de.ParagraphReader.text(h.node).substring(h.cpBegin,v.cpEnd),b+=S.AParagraphNode.IR(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}fhe(b){return this.afa?
this.Zl.Cbg(this,b)?0:2:2}clear(){return this.afa?this.Zl.Cbg(this,"")?0:2:2}k5h(){const b=new zb.a;var h=this.contentControlNode.ia(lc.a.contentControlNode,[]);for(const v of h)if(!W.a.Zp(v,W.a.nil)){h=this.oi.value.Db(v);try{b.add(this.R1.gBb(h,this.vx,this.oi,this.Rg,this.jr,this.Zl,this.I$,this.afa,this.Jyb))}catch(D){}}return b}Tmf(){const b=new zb.a;this.i3h(this,b);return b}i3h(b,h){b=b.k5h();if(b.count)for(const v of b)h.add(v),this.i3h(v,h)}bF(b=!1){const h=new zb.a;if(this.Kf){var v=this.Zl.WT(this.start,
this.end);for(var D of v)v=Pe.a.create(D),this.jr.Bad(v,this.objectId,b),h.add(v)}else D=this.start.clone(),this.jr.Bad(D,this.objectId,b),h.add(D);return h}Dad(b){const h=this.Zl.WT(this.start,this.end);for(let v=0;v<h.count;v++){const D=this.jr.wof(h.J(v),this.objectId,!1);if(D){for(let Q=0;Q<D.count;Q++)b(D.J(Q));h.J(v).ak()}}}r3h(b,h){const v=new Sys.StringBuilder;h=this.Zl.WT(b,h);for(const D of h)D.id.equals(b.node.id)||v.append("\r"),v.append(de.ParagraphReader.plainText(D));return v.toString()}}
Object(n.a)(aA,"ContentControl",null,[655]);class PC{constructor(b){this.zd=b}gBb(b,h,v,D,Q,ba,ta,Ta,ob){return new aA(b,h,v,D,Q,ba,this,ta,Ta,ob,this.zd)}}Object(n.a)(PC,"ContentControlFactory",null,[615]);class zr{constructor(b,h,v,D,Q){this.oi=b;this.jr=h;this.Elk=v;this.xW=D;this.Ma=Q}hTo(b,h,v){var D,Q;if(!(Di.a.C9e&&b&&h&&v))return!1;const ba=b.contentControlNode;if(!ba)return!1;var ta=ba.ia(lc.a.UAb,W.a.nil);ta&&!ta.equals(W.a.nil)?b=this.oi.value.Db(ta):(b=this.jr.OOc(b.start.node,0<=b.start.cpBegin?
b.start.cpBegin:0),b=null===(D=null===b||void 0===b?void 0:b.formatting)||void 0===D?void 0:D.yn,b||(b=new Iz.a,this.oi.value.Lu(b,null)),ba.setValue(lc.a.UAb,b.id));D=this.oi.value.Db(b.id);ta="boolean"===typeof v&&v;const Ta=null===(Q=this.Ma)||void 0===Q?void 0:Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.Elk.cqf(ba,D,h,v,Ta?null:ta);h=this.xW.ooe(h);for(const [ob,Kb]of h)b.setValue(ob,Kb);return!0}}Object(n.a)(zr,"ContentControlFormattingManager",null,
[614]);var $B=c(927);class Vq{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){this.vx=b;this.oi=h;this.Wc=v;this.cwb=D;this.JZj=Q;this.tK=ba;this.nh=ta;this.eb=Ta;this.Gqd=ob;this.qjd=Kb;this.zd=Vb;this.MWg=bc;this.I$=Dc}get Ps(){return this.zd.Ps}get tt(){return this.zd.tt}get hx(){return this.vx.value}Cva(){const b=this.Wc.yk();b.set(this.hx);this.cwb.gP(b);if(b.Sb(25))return b;this.qjd.instance&&this.qjd.instance.soa&&u.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");
u.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}hOc(b,h,v=!1){this.C5b();const D=new zb.a;let Q;if(b){Q=b.Sb(26);if(!Q)return D;for(;Q&&(!h(Q)||(D.add(Q),!v));){D.addRange(this.hOc(b,h));if(v&&0<D.count)break;Q=b.vf(26)}b.sc()}return D}S5l(){const b=this.Wc.yk();b.set(this.vx.value);this.cwb.gP(b);return b.currentNode}mQa(b,h,v){let D;D=b.equals(h);D||(D=(b=this.rna(b,v))?b.id.equals(h):!1);return D}DOa(b,h){var v,D,Q,ba;b=this.Zt(b);if(!b)return null;
let ta=null;for(;55===b.type;){let Ta;Ta=Di.a.Bj?this.zd.yq(b.id,h):h?null!==(D=this.zd.Ps.get(null===(v=b.id)||void 0===v?void 0:v.toString()))&&void 0!==D?D:W.a.nil:null!==(ba=this.zd.tt.get(null===(Q=b.id)||void 0===Q?void 0:Q.toString()))&&void 0!==ba?ba:W.a.nil;if(Ta.equals(ta)){b=null;break}else b=this.Zt(Ta);ta=Ta}return b}rna(b,h){return(b=this.DOa(b,h))?de.ParagraphReader.Vb(b)?b:h?this.eb.kl(b):this.eb.PD(b):null}MPh(b,h=!1){this.nSo(b);this.NPh(b,h)}nSo(b){var h,v,D,Q,ba,ta,Ta,ob,Kb=this.Bva(b);
Kb=this.Bva(Kb.parentNode);Kb=55===Kb.currentNode.type?Kb.currentNode.id:null;let Vb;Vb=this.Zt(Di.a.Bj?this.zd.yq(b.id,!0):null!==(v=this.zd.Ps.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil);for(h=this.Zt(Di.a.Bj?this.zd.yq(b.id,!1):null!==(Q=this.zd.tt.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==Q?Q:W.a.nil);Vb&&55===Vb.type;)Vb=this.Zt(Di.a.Bj?this.zd.yq(Vb.id,!0):null!==(ta=this.zd.Ps.get(null===(ba=Vb.id)||void 0===ba?void 0:ba.toString()))&&
void 0!==ta?ta:W.a.nil);for(;h&&55===h.type;)h=this.Zt(Di.a.Bj?this.zd.yq(h.id,!1):null!==(ob=this.zd.tt.get(null===(Ta=h.id)||void 0===Ta?void 0:Ta.toString()))&&void 0!==ob?ob:W.a.nil);Vb&&h&&this.BEj(Vb.id,h.id,Kb,bc=>{bc=bc.ia(lc.a.gX,W.a.nil);return!bc||bc.equals(W.a.nil)||b.id.equals(bc)})}NPh(b,h=!1){var v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc;u.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const gd=this.Bva(b),rd=this.Bva(gd.parentNode);let je=W.a.nil,Ld=W.a.nil;
var Qd=rd.currentNode.ia(lc.a.contentControlNode,[]);const ge=new zb.a;for(let gg=0;gg<Qd.length;gg++)ge.add(Qd[gg]);if(h){if(54!==rd.currentNode.type){je=Di.a.Bj?this.zd.yq(rd.currentNode.id,!0):this.zd.Ps.get(null===(v=rd.currentNode.id)||void 0===v?void 0:v.toString());Ld=Di.a.Bj?this.zd.yq(rd.currentNode.id,!1):this.zd.tt.get(null===(D=rd.currentNode.id)||void 0===D?void 0:D.toString());Qd=this.Zt(je);for(v=this.Zt(Ld);Qd&&55===Qd.type;)je=Di.a.Bj?this.zd.yq(Qd.id,!0):this.zd.Ps.get(null===(Q=
Qd.id)||void 0===Q?void 0:Q.toString()),Qd=this.Zt(je);for(;v&&55===v.type;)Ld=Di.a.Bj?this.zd.yq(v.id,!1):this.zd.tt.get(null===(ba=v.id)||void 0===ba?void 0:ba.toString()),v=this.Zt(Ld)}Q=this.Bva(b);if(Q.Sb(26)){ba=new zb.a;for(ba.add(Q.currentNode);Q.vf(26);)ba.add(Q.currentNode);for(var ze of ba)this.NPh(ze,h)}}else if(je=Di.a.Bj?this.zd.yq(b.id,!0):this.zd.Ps.get(null===(ta=b.id)||void 0===ta?void 0:ta.toString()),Ld=Di.a.Bj?this.zd.yq(b.id,!1):this.zd.tt.get(null===(Ta=b.id)||void 0===Ta?void 0:
Ta.toString()),h=this.HZl(ge,b.id),ze=this.Bva(b),ze.Sb(26))for(Q=this.Bva(ze.currentNode),ba=Q.currentNode,Qd=b;ba;)v=ze.currentNode,ge.insert(h++,v.id),ba=Q.vf(26),D=this.Bva(v),54!==rd.currentNode.type?v.setValue(lc.a.H7,rd.currentNode.id):v.removeProperty(lc.a.H7),hk.g(D,rd,Qd,26),Qd=D.currentNode,ba&&(ze.set(ba),ze.m1(this.Cva().currentNode));54!==rd.currentNode.type&&(h=Di.a.Bj?this.zd.yq(rd.currentNode.id,!0):null!==(Kb=this.zd.Ps.get(null===(ob=rd.currentNode.id)||void 0===ob?void 0:ob.toString()))&&
void 0!==Kb?Kb:W.a.nil,ob=Di.a.Bj?this.zd.yq(rd.currentNode.id,!1):null!==(bc=this.zd.tt.get(null===(Vb=rd.currentNode.id)||void 0===Vb?void 0:Vb.toString()))&&void 0!==bc?bc:W.a.nil,h.equals(b.id)&&(Di.a.Bj?this.zd.kE(rd.currentNode.id,je,!0):this.zd.Ps.set(null===(Dc=rd.currentNode.id)||void 0===Dc?void 0:Dc.toString(),je)),ob.equals(b.id)&&(Di.a.Bj?this.zd.kE(rd.currentNode.id,Ld,!1):this.zd.tt.set(null===(Oc=rd.currentNode.id)||void 0===Oc?void 0:Oc.toString(),Ld)));gd.Cg();u.ULS.sendTraceTag(528537621,
368,50,"Disconnected nodeToDelete");this.remove(ge,b.id);Qd=Array(ge.count);for(Vb=0;Vb<ge.count;Vb++)Qd[Vb]=ge.J(Vb);rd.currentNode.setValue(lc.a.contentControlNode,Qd);$B.a.PFa(b.id)}drk(b,h,v,D,Q,ba,ta=null){var Ta,ob,Kb,Vb,bc,Dc,Oc,gd;let rd,je;h?(rd=this.Zt(h.objectId),je=this.Bva(rd)):(je=this.Cva(),rd=je.currentNode);const Ld=this.JZj.create(1074135145);ta&&Ld.properties.Vw(ta.properties);54!==rd.type&&Ld.setValue(lc.a.H7,rd.id);ta?je.yGb(Ld,v,26,ta.id):je.LH(Ld,v,26);Di.a.contentControlAroundTableFix?
(this.aHj(b,Ld.id,Q,!0),this.aHj(b,Ld.id,ba,!1)):(Di.a.Bj?this.zd.kE(Ld.id,Q,!0):this.zd.Ps.set(null===(Ta=Ld.id)||void 0===Ta?void 0:Ta.toString(),Q),Di.a.Bj?this.zd.kE(Ld.id,ba,!1):this.zd.tt.set(null===(ob=Ld.id)||void 0===ob?void 0:ob.toString(),ba));b.Kf&&(h&&(v=Di.a.Bj?this.zd.yq(rd.id,!0):null!==(Vb=this.zd.Ps.get(null===(Kb=rd.id)||void 0===Kb?void 0:Kb.toString()))&&void 0!==Vb?Vb:W.a.nil,Kb=Di.a.Bj?this.zd.yq(rd.id,!1):null!==(Dc=this.zd.tt.get(null===(bc=rd.id)||void 0===bc?void 0:bc.toString()))&&
void 0!==Dc?Dc:W.a.nil,v.equals(Q)&&(Di.a.Bj?this.zd.kE(rd.id,Ld.id,!0):this.zd.Ps.set(null===(Oc=rd.id)||void 0===Oc?void 0:Oc.toString(),Ld.id)),Kb.equals(ba)&&(Di.a.Bj?this.zd.kE(rd.id,Ld.id,!1):this.zd.tt.set(null===(gd=rd.id)||void 0===gd?void 0:gd.toString(),Ld.id))),this.BEj(Q,ba,Ld.id,Qd=>{Qd=Qd.ia(lc.a.gX,W.a.nil);const ge=h?h.objectId:null;return!Qd||Qd.equals(W.a.nil)||Qd.equals(ge)}));Q=this.Bva(Ld);ba=Array(D.count);for(bc=D.count-1;0<=bc;bc--)ba[bc]=D.J(bc).objectId,Dc=this.Zt(D.J(bc).objectId),
Dc=this.Bva(Dc),Dc.currentNode.setValue(lc.a.H7,Ld.id),hk.g(Dc,Q,null,26);0<ba.length&&Ld.setValue(lc.a.contentControlNode,ba);Vq.Xb.isFeatureEnabled(38)&&(b.UId&&Ld.setValue(lc.a.h3b,b.UId),b.xff&&Ld.setValue(lc.a.qFd,!0));return Ld}aHj(b,h,v,D){12===this.Zt(v).type?this.zd.kE(h,v,D):(this.zd.Rmg(h,v,D),this.zd.kE(h,D?b.start.node.id:b.end.node.id,D))}wgo(b,h,v,D,Q){b.setValue(lc.a.F8,h);b.setValue(lc.a.j3b,!0);b.setValue(lc.a.TAb,!0);b.setValue(lc.a.Tw,v);b.setValue(lc.a.Peb,yx[0]);b.setValue(lc.a.Lfa,
!0);b.setValue(lc.a.VAb,YA.a[Q]);D&&b.setValue(lc.a.Ppb,D);b.setValue(lc.a.k3b,0)}CEj(b,h=null,v=null){h&&(Di.a.Bj?this.zd.kE(b,h,!0):this.zd.Ps.set(b.toString(),h));v&&(Di.a.Bj?this.zd.kE(b,v,!1):this.zd.tt.set(b.toString(),v))}bQh(b){if(!b||!b.count||!b.J(0))return null;const h=this.Vsf(b);for(let v=0;v<b.count;v++)this.nh.WGa(b.J(v));return h}Vsf(b){if(!b||!b.J(0))return null;const h=this.Wc.yk();h.set(b.J(0));h.vd();h.sc();return h.nJ()?h.currentNode:null}b7l(b){const h=this.Wc.yk();h.set(b);
h.vd();h.sc();h.sc();return h}ioh(b,h,v){const D=new zb.a;for(let Q=0;Q<v;Q++){h=this.tK.Wib(b,h,!0,null);if(!h||!b.Qd())return null;const ba=b.currentNode;b.sc();b.sc();D.add(ba)}return D}N8b(b){const h=this.Wc.yk();h.set(b);for(h.zb(7);h.sc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}vci(b){const h=this.Wc.yk();h.set(b);h.vd();return(b=h.HSa())?b.id:null}Vqf(b){const h=this.Wc.yk();h.set(b);return h.zb(7)?h:null}Zt(b){return this.oi.value.Db(b)}C5b(){if(!Vq.E_g){var b=
this.Cva();b&&this.ikg(b);Vq.E_g=!0}}qTa(b){return this.Gqd.qTa(b)}wzk(b,h){const v=this.Wc.yk();v.set(b.node);const D=this.Wc.yk();D.set(h.node);v.vd();D.vd();const Q=this.Wc.yk();Q.set(v.currentNode);const ba=this.Wc.yk();ba.set(D.currentNode);const ta=Ig.returnToLowestCommonTableCell(v,D);return ta?(Q.vd(),ba.vd(),{returnValue:({ll:b}=this.vAb(Q,!0,ta,b)).returnValue&&({ll:h}=this.vAb(ba,!1,ta,h)).returnValue,Z8c:b,CKc:h}):{returnValue:({ll:b}=this.vAb(v,!0,null,b)).returnValue&&({ll:h}=this.vAb(D,
!1,null,h)).returnValue,Z8c:b,CKc:h}}vAb(b,h,v,D){let Q=null,ba=b.jd(16);for(;ba!==v;){if(h&&Ph.TableCellReader.Awi(b)||!h&&Ph.TableCellReader.YDf(b))Q=b.jd(14);else return{returnValue:!1,ll:D};ba=b.jd(16)}Q&&(D=Pe.a.create(Q));return{returnValue:!0,ll:D}}ikg(b){if(b.Sb(26)){for(this.ikg(b);b.vf(26);)this.ikg(b);b.sc()}}remove(b,h){for(let v=0;v<b.count;v++)if(b.J(v).toString()===h.toString()){b.removeAt(v);break}}Bva(b){const h=this.Wc.yk();h.set(b);h.m1(this.Cva().currentNode);return h}HZl(b,h){for(let v=
0;v<b.count;v++)if(b.J(v).equals(h))return v;return-1}BEj(b,h,v,D){b=this.FQl(b,h);for(h=0;h<b.count;h++)D(b.J(h))&&(v?b.J(h).setValue(lc.a.gX,v):b.J(h).removeProperty(lc.a.gX),this.qjd.instance&&this.qjd.instance.Mui&&b.J(h).Tk(16,!0))}FQl(b,h){const v=new zb.a;var D=this.Zt(b);const Q=this.Zt(h);if(!D||!Q)return v;const ba=({kXc:ta}=this.xNd(D,Q)).returnValue;D=ta[ba];if(14===D.type)v.add(D);else if(15===D.type&&1<=ba){const Ta=ta[ba-1];1===rh.TableReader.fg(Ta)&&v.add(Ta)}var ta=ne.GraphIterator.$a(ba>=
ta.length-1?D:ta[ba+1]);ta.zb(7);for(D=nc.a.Qs(ta,D);D.moveNext()&&D.currentNode!==Q;)14===D.currentNode.type&&v.add(D.currentNode);if(!W.a.Zp(h,b)&&14===Q.type)for(ta=ne.GraphIterator.$a(Q),D=nc.a.Qs(ta,Q);D.moveNext();)14===D.currentNode.type&&v.add(D.currentNode);return v}xNd(b,h){b=this.Zgb(b);h=this.Zgb(h);let v=0;for(;v<b.length&&v<h.length&&b[v]===h[v];++v);return{returnValue:0<v?v-1:v,kXc:b,k8f:h}}Zgb(b){const h=[];h.push(b);b=ne.GraphIterator.$a(b);for(b.zb(7);b.sc();)h.push(b.currentNode);
h.reverse();return h}static get Xb(){return null!=Vq.wyg?Vq.wyg:Vq.wyg=Ga.a.instance.Na("Box4.IFeatureHelper")}dIc(b,h,v=!1){b=this.MWg.instance.fbl(b);v?(v=Xs.a.Chl,b.setValue(lc.a.SPc,v)):v=b.ia(lc.a.SPc,null);h.setValue(lc.a.c_a,v)}bZk(b,h){b=b.ia(lc.a.c_a,null);b=this.I$.z8h(b);b=de.ParagraphReader.text(b);this.dIc(b,h)}iFj(b,h){if(h){var v=h.ia(lc.a.c_a,null);v?Yz(h)?this.dIc(b,h):this.MWg.instance.GWo(v,b):(v=this.I$.ZSl())?h.setValue(lc.a.c_a,v):this.dIc(b,h,!0)}}}Vq.E_g=!1;Object(n.a)(Vq,
"ContentControlGraphManager",null,[613]);class pu{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){this.Xve=Kb;this.sra=null;this.hOm=(Vb,bc)=>{if(this.ZX)return this.iOm(Vb,bc);if(!Vb||!Vb.count)return u.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let Dc=!0;switch(bc){case 0:bc=this.WK(Vb.J(0),Vb.J(Vb.count-1),1);if((Vb=this.WK(Vb.J(0),Vb.J(Vb.count-1),3))&&0<Vb.count){if(!Vb.J(0).isSupported||!Vb.J(0).isEditable){Dc=!1;break}for(Vb=Vb.J(0);Vb;)this.W3c(bc,Vb.id),Vb=this.getById(Vb.parentId)}if(bc)for(var Oc of bc)if(!Oc.isSupported||
!Oc.isEditable){Dc=!1;break}break;case 1:if(Vb.J(0).contextId!==Zb.a.Tc){u.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");Dc=!1;break}(bc=this.WK(Vb.J(0),Vb.J(0),1))&&0<bc.count&&(Dc=!1);break;case 2:if(Vb.J(0).contextId!==Zb.a.Tc){u.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Dc=!1;break}(bc=this.WK(Vb.J(0),Vb.J(0),3))&&0<bc.count&&
(Dc=!1);break;case 3:case 4:bc=this.MPd(Vb.J(0),!0);Oc=this.MPd(Vb.J(Vb.count-1),!1);if(!bc||!Oc){u.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");Dc=!1;break}if((bc=this.WK(bc,bc,3))&&0<bc.count){Dc=!1;break}if((bc=this.WK(Oc,Oc,3))&&0<bc.count){Dc=!1;break}if(bc=this.Zl.WK(Vb.J(0),Vb.J(Vb.count-1),1))for(const gd of bc)if(!gd.fha){Dc=!1;break}break;default:Dc=!1}return Dc};pu.vx=b;pu.oi=h;this.Rg=v;this.jr=D;this.Zl=Q;this.R1=
ba;this.I$=ta;this.Qf=Ta;this.Do=ob}get UPa(){return!!this.Qf.instance&&this.Qf.instance.UPa}get soa(){return!!this.Qf.instance&&this.Qf.instance.soa}get OXd(){return!!this.Qf.instance&&this.Qf.instance.OXd}get ZX(){return!!this.Qf.instance&&this.Qf.instance.ZX}get RXd(){return!!this.Qf.instance&&this.Qf.instance.RXd}ZGb(){return!!this.Qf.instance&&this.Qf.instance.ZGb}Ila(b,h,v=null,D=null,Q=!1){if(!this.UPa)return{returnValue:2,id:0};b=this.Rg.rna(b,!0);h=this.Rg.rna(h,!1);if(!b||!h)return{returnValue:2,
id:0};b=Pe.a.create(b);h=Pe.a.create(h);return this.Wmh(b,h,v,D,Q,0,!1)}jqk(b,h,v=0,D=!1){return this.UPa&&b&&h?this.Wmh(b,h,null,null,!1,v,D):{returnValue:2,id:0}}SYa(b,h=null,v=0,D=!1){let Q=0;if(!this.UPa)return{returnValue:2,id:Q};const ba=this.R1.gBb(h,pu.vx,pu.oi,this.Rg,this.jr,this.Zl,this.I$,this.UPa,this.OXd);ba.type=v;ba.start=b;ba.end=b;ba.lu=b.node.id;ba.kz=b.node.id;ba.Kf=!1;return this.Zl.Wnh(ba,h,D)?(Q=ba.id,{returnValue:0,id:Q}):{returnValue:2,id:Q}}crk(b,h=null){if(!this.UPa||!this.zKm(b))return{returnValue:2,
id:0};var v=b.J(0).contextId===Zb.a.endOfParagraph?b.J(1):b.J(0);const D=b.J(b.count-1);if(this.j9e(b,Zb.a.paragraph)||this.j9e(b,Zb.a.endOfParagraph)){b=v.node.id;let Q=D.node.id;const ba=b.equals(Q);v=this.Zl.Xtj(v,!0);void 0!==v&&null!==v&&(b=v,Q=ba?b:Q);this.Zl.Xtj(D,!1);h.setValue(lc.a.F8,!0);return this.Ila(b,Q,h)}return v!==D||v.contextId!==Zb.a.Hd&&v.contextId!==Zb.a.Tc?{returnValue:2,id:0}:(h.setValue(lc.a.F8,!1),this.SYa(v,h))}getById(b){if(!this.soa)return null;const h=this.Rg.hOc(this.Rg.Cva(),
v=>v.getValue(lc.a.Tw)===b,!0);return 0<h.count?this.Zl.OQ(h.J(0)):null}getByTitle(b){if(!this.soa)return null;const h=this.Rg.hOc(this.Rg.Cva(),D=>D.ia(lc.a.Oeb,null)===b,!1),v=new zb.a;for(const D of h)v.add(this.Zl.OQ(D));return v}getByTag(b){if(!this.soa)return null;const h=this.Rg.hOc(this.Rg.Cva(),D=>D.ia(lc.a.Reb,null)===b,!1),v=new zb.a;for(const D of h)v.add(this.Zl.OQ(D));return v}WK(b,h,v,D=!1){return this.soa?this.ZX?this.Zl.tna(b,h,v):this.Zl.WK(b,h,v,D):null}WT(b,h){return this.Zl.WT(b,
h)}ZKl(){if(!this.soa)return null;const b=this.Rg.hOc(this.Rg.Cva(),()=>!0,!1),h=new zb.a;for(const v of b)h.add(this.Zl.OQ(v));return h}HMb(b){if(!this.UPa)return u.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Zl.fya(b)?0:2}Jil(b){if(!this.UPa)return 2;b=this.getById(b);return this.Zl.deleteContentControl(b)?0:2}trk(b){this.Zl.k8i(b)}xJk(b){this.sra=b;this.sra.PVn(this.hOm)}TQl(b){if(!this.ZGb())return null;
let h;var v=b.bF();h=this.MPd(v.J(v.count-1),!1);v=this.jr.OOc(v.J(v.count-1).node,h.cpBegin).Jb;b=this.Cem(v,b);if(-1===b)return null;h.Eb=b;h.Rb=h.Eb;return h}iOm(b,h){if(!b||!b.count)return u.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.PIm(b);case 3:case 4:case 6:return this.jQm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==Zb.a.Tc?(u.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),
!1):this.yxi(b.J(0),5===h,!1);default:return!1}}PIm(b){const h=this.Zl.tna(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var v=h.J(0);if(!v.isSupported||!v.isEditable)return!1}b=this.Zl.tna(b.J(0),b.J(b.count-1),1);for(v=0;h&&v<h.count;v++)this.W3c(b,h.J(v).id);if(b)for(const D of b)if(!D.isSupported||!D.isEditable)return!1;return!0}jQm(b,h){var v=b.J(0),D=b.J(b.count-1),Q=v.oj,ba=D.Yo;if(-1===Q||-1===ba)return!1;Q=this.Do.o8(v.node,Q,v.Eb);ba=this.Do.o8(D.node,ba,D.Rb);var ta=-1,Ta=Math.min(Q.count,
ba.count);for(--Ta;0<=Ta;Ta--){const ob=Q.J(Ta).ke,Kb=ba.J(Ta).ke;if(ob.equals(Kb)){ta=Ta;break}}if(-1<ta&&(Ta=this.Zl.OQ(Q.J(ta).contentControlNode),!Ta.isEditable||!Ta.isSupported||Ta.GM&&!this.tIm(Ta,b)))return!1;v=this.Zl.tna(v,D,1);for(D=0;D<=ta;D++)this.W3c(v,this.Zl.OQ(Q.J(D).contentControlNode).id);for(D=ta+1;D<Q.count;D++){Ta=this.Zl.OQ(Q.J(D).contentControlNode);if(!Ta.isEditable||!Ta.fha||!Ta.isSupported||Ta.GM)return!1;this.W3c(v,Ta.id)}for(Q=ta+1;Q<ba.count;Q++){ta=this.Zl.OQ(ba.J(Q).contentControlNode);
if(!ta.isEditable||!ta.fha||!ta.isSupported||ta.GM)return!1;this.W3c(v,ta.id)}if(v)for(const ob of v)if(!ob.isSupported||!ob.fha)return!1;return h&&(b=this.MPd(b.J(0),!0))?this.yxi(b,!0,!0):!0}tIm(b,h){h=this.Do.Y6l(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.ke)}yxi(b,h,v){return(b=this.Zl.tna(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.RXd&&h&&!b.Kf||!v&&b.GM||Di.a.eZf&&h&&1===b.type)?!1:!0}MPd(b,h){if(!b)return null;let v=null;switch(b.contextId){case Zb.a.paragraph:v=
h?Pe.a.Rc(b.node,0):Pe.a.jw(b.node);break;case Zb.a.endOfParagraph:v=Pe.a.jw(b.node);break;case Zb.a.Hd:v=h?Pe.a.Rc(b.node,b.cpBegin):Pe.a.Rc(b.node,b.cpEnd);break;case Zb.a.Tc:v=b}v&&(v.Rb=v.Eb=h?b.Eb:b.Rb);return v}W3c(b,h){if(b)for(const v of b)if(v.id===h){b.remove(v);break}}Cem(b,h){if(!b)return-1;let v=-1;for(let D=0;D<b.length;D++)if(b.J(D).ke.equals(h.objectId)&&!1===b.J(D).Mc){v=D;if(h.Kf&&0<D&&b.J(D-1).Kf&&!b.J(D-1).Mc)return-1;break}return v}zKm(b){if(void 0===b||null===b)return!1;for(let h=
0;h<b.count;h++){const v=b.J(h).contextId;if(v!==Zb.a.paragraph&&v!==Zb.a.endOfParagraph&&v!==Zb.a.Hd&&v!==Zb.a.Tc||0<h&&h<b.count-1&&v===Zb.a.Hd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===Zb.a.endOfParagraph&&1===b.count||this.j9e(b,Zb.a.Tc)&&1<b.count?!1:!0}j9e(b,h){for(const v of b)if(v.contextId===h)return!0;return!1}Wmh(b,h,v=null,D=null,Q=!1,ba=0,ta=!1){let Ta=0;var ob=h.node;let Kb=Pe.a.create(b.node);ob=Pe.a.create(ob);if(Di.a.contentControlAroundTableFix){if(!({Z8c:Kb,
CKc:ob}=this.Xve.RCh(Kb,ob)).success)return{returnValue:2,id:Ta}}else if(!({Z8c:Kb,CKc:ob}=this.Rg.wzk(Kb,ob)).returnValue)return{returnValue:2,id:Ta};const Vb=this.R1.gBb(v,pu.vx,pu.oi,this.Rg,this.jr,this.Zl,this.I$,this.UPa,this.OXd);Vb.type=ba;Vb.start=b;Vb.end=h;Vb.lu=Kb.node.id;Vb.kz=ob.node.id;Vb.Kf=!0;Vb.UId=D;Vb.xff=Q;return this.Zl.Wnh(Vb,v,ta)?(Ta=Vb.id,{returnValue:0,id:Ta}):{returnValue:2,id:Ta}}}pu.vx=null;pu.oi=null;Object(n.a)(pu,"ContentControlManager",null,[612]);var dz=c(625),qu=
c(142),Ar=c(187);class bA extends Sys.EventArgs{constructor(b){super();this.nOh=b}}Object(n.a)(bA,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class Ys{constructor(){this.AQi=0;this.y_i=null}}Object(n.a)(Ys,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const ru=b=>!(null===b||void 0===b?0:b.length),cA=b=>null==b?!1:[...b].some(h=>h.Mc),Ow=b=>null==b?!1:[...b].some(h=>!h.Mc);class vi{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld,Qd,ge,ze,gg,Kg,Ll,Em){this.lj=
Ll;this.pbh=[];this.zOe=[];this.vx=b;this.oi=h;this.Rg=v;this.jr=D;this.R1=Q;this.Be=ob;this.Uy=Kb;this.ib=ba;this.xE=ta;this.eBa=Ta;this.I$=Oc;this.Jyb=gd;this.afa=Vb;this.nI=bc;this.ga=Dc;this.Do=rd;this.Qf=je;this.yh=Ld;this.eb=Qd;this.Gc=ge;this.Akh=ze;this.ld=gg;this.zd=Kg;this.nI&&(this.nI.addHandler(dz.a.GMb,Object(z.a)(this,this.ZWi,"onShowingPlaceholder")),this.nI.addHandler(dz.a.cde,Object(z.a)(this,this.hWi,"onRemoveWhenEdited")),Em.execute(up=>{this.vE=up}))}get hx(){return this.vx.value}get vj(){return this.oi.value}get ZX(){return!!this.Qf.instance&&
this.Qf.instance.ZX}get W_(){return!!this.ld&&this.ld.isFeatureEnabled(31)}dispose(){this.nI&&(this.nI.removeHandler(dz.a.GMb,Object(z.a)(this,this.ZWi,"onShowingPlaceholder")),this.nI.removeHandler(dz.a.cde,Object(z.a)(this,this.hWi,"onRemoveWhenEdited")))}WK(b,h,v,D=!1){if(this.ZX)return this.tna(b,h,v);if(!b||!h)return null;const Q=this.Rg.rna(b.node.id,!0);var ba=this.Rg.rna(h.node.id,!1);if(!Q||!ba)return null;b=b.contextId===Zb.a.endOfParagraph?b:Pe.a.Rc(Q,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===
Zb.a.endOfParagraph?h:Pe.a.Rc(ba,-1===h.cpEnd?ba.characterData.length:h.cpEnd);ba=null;switch(v){case 0:ba=this.aVl(b,h);break;case 1:ba=this.i7l(b,h);break;case 3:ba=this.Zci(b,h,D);break;case 2:ba=this.Gfm(b,h);break;case 4:ba=this.Aof(b,h,!1)}return ba}tna(b,h,v){if(!b||!h||b.contextId!==Zb.a.endOfParagraph&&(b=this.wIh(b,!0),!b)||h.contextId!==Zb.a.endOfParagraph&&(h=this.wIh(h,!1),!h))return null;let D=null;switch(v){case 0:D=this.bVl(b,h);break;case 1:D=this.j7l(b,h);break;case 3:D=this.$ci(b,
h);break;case 2:D=this.Hfm(b,h);break;case 4:D=this.Aof(b,h,!0)}return D}wIh(b,h){var v=this.Rg.rna(b.node.id,h);if(!v)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Eb):(h=-1===b.cpEnd?v.characterData.length:b.cpEnd,b=b.Rb);v=Pe.a.Rc(v,h);v.Eb=b;v.Rb=b;return v}aVl(b,h){const v=new zb.a;if(b.contextId===Zb.a.endOfParagraph||h.contextId===Zb.a.endOfParagraph||b.equals(h))return v;const D=new wl.a,Q=this.KDb(b,b),ba=this.KDb(h,h);for(let ta=0;ta<Q.count;ta++)if(Q.J(ta).Mc)for(let Ta=0;Ta<ba.count;Ta++)ba.J(Ta).Mc||
Q.J(ta).ke.equals(ba.J(Ta).ke)&&(!Q.J(ta).Kf||this.Rg.mQa(Q.J(ta).ke,b.node.id,!0)&&this.Rg.mQa(ba.J(Ta).ke,h.node.id,!1))&&this.Iyd(v,D,Q.J(ta).ke);return v}bVl(b,h){const v=new zb.a;if(b.contextId===Zb.a.endOfParagraph||h.contextId===Zb.a.endOfParagraph||b.equals(h)&&b.Eb===b.Rb||-1===b.Eb||-1===h.Rb)return v;var D=b.node.pa.Qh(b.cpBegin),Q=h.node.pa.Qh(h.cpEnd);D&&D.Jb&&0<D.Jb.length&&b.Eb<=D.Jb.length&&Q&&Q.Jb&&0<Q.Jb.length&&h.Rb<=Q.Jb.length&&(b=b.Eb,h=h.Rb,b===D.Jb.length&&b--,0<h&&h--,D=D.Jb.J(b),
Q=Q.Jb.J(h),D.Mc&&!Q.Mc&&W.a.Zp(D.ke,Q.ke)&&D.rp&&Q.rp&&(Q=D.contentControlNode)&&v.add(this.OQ(Q)));return v}i7l(b,h){const v=new zb.a,D=new wl.a,Q=this.KDb(b,h);for(let ba=0;ba<Q.count;ba++)this.Iyd(v,D,Q.J(ba).ke);b=this.Zci(b,h,!1,!1);for(const ba of b)D.contains(ba.objectId)||(v.add(ba),D.add(ba.objectId));return v}j7l(b,h){const v=new zb.a,D=new wl.a,Q=this.Jnf(b,h);for(let ba=0;ba<Q.count;ba++)this.uYe(v,D,Q.J(ba));b=this.$ci(b,h);for(const ba of b)D.contains(ba.objectId)||(v.add(ba),D.add(ba.objectId));
return v}Zci(b,h,v,D=!0){const Q=new zb.a;b.equals(h)&&(v=!1);const ba=new wl.a;let ta=!1;b=this.KDb(null,b,!0,v);h=this.KDb(h,null,v,!0);for(v=b.count-1;0<=v;v--){for(let Ta=0;Ta<h.count&&!(b.J(v).ke.equals(h.J(Ta).ke)&&(b.J(v),this.Iyd(Q,ba,b.J(v).ke)&&(ta=!this.Rg.Zt(b.J(v).ke).ia(lc.a.H7,null),D||ta)));Ta++);if(0<Q.count&&(D||ta))break}return Q}$ci(b,h){const v=new zb.a,D=new wl.a,Q=b.node;var ba=h.node;const ta=h.contextId===Zb.a.endOfParagraph?ba.characterData.length:h.cpEnd;b=this.Do.o8(Q,
b.contextId===Zb.a.endOfParagraph?Q.characterData.length:b.cpBegin,b.Eb);h=this.Do.o8(ba,ta,h.Rb);ba=b.count>h.count?h.count:b.count;for(--ba;0<=ba;ba--)b.J(ba).ke.equals(h.J(ba).ke)&&this.uYe(v,D,b.J(ba));return v}Gfm(b,h){const v=new zb.a;let D=new wl.a;const Q=this.KDb(b,h);let ba=0,ta=null;if(b.equals(h))return v;for(b=0;b<Q.count;b++)!Q.J(b).Mc||Q.J(b).Kf&&!this.Rg.mQa(Q.J(b).ke,Q.J(b).Ib.paragraph.id,!0)?Q.J(b).Mc||Q.J(b).Kf&&!this.Rg.mQa(Q.J(b).ke,Q.J(b).Ib.paragraph.id,!1)||(ba--,0>ba?(ba=
0,D=new wl.a):!ba&&ta&&Q.J(b).ke.equals(ta)&&this.Iyd(v,D,ta)):(ba||(ta=Q.J(b).ke),ba++);return v}Hfm(b,h){const v=new zb.a;if(b.equals(h)&&b.Eb===h.Rb)return v;let D=new wl.a;b=this.Jnf(b,h);h=0;let Q=null;for(let ba=0;ba<b.count;ba++){const ta=b.J(ba);!ta.Mc||ta.Kf&&!this.Rg.mQa(ta.ke,ta.Ib.paragraph.id,!0)?ta.Mc||ta.Kf&&!this.Rg.mQa(ta.ke,ta.Ib.paragraph.id,!1)||(h--,0>h?(h=0,D=new wl.a):!h&&Q&&ta.ke.equals(Q.ke)&&this.uYe(v,D,Q)):(h||(Q=ta),h++)}return v}Aof(b,h,v){const D=new zb.a;b=v?this.Jnf(b,
h):this.KDb(b,h);h=0;for(v=0;v<b.count;v++){var Q=b.J(v);Q.rp&&(Q.Mc?h++:(h--,0>h?h=0:(Q=this.OQ(Q.contentControlNode))&&D.add(Q)))}return D}KDb(b,h,v=!0,D=!0){const Q=new zb.a,ba=this.WT(b,h);if(!ba.count)return Q;let ta,Ta,ob,Kb;for(let Vb=0;Vb<ba.count;Vb++){ta=0;Ta=ba.J(Vb).characterData.length;ob=Kb=!0;if(b&&ba.J(Vb).id.equals(b.node.id)){if(b.contextId===Zb.a.endOfParagraph)continue;0<=b.cpBegin&&(ta=b.cpBegin)}h&&ba.J(Vb).id.equals(h.node.id)&&0<=h.cpEnd&&(Ta=h.cpEnd);Vb||(ob=v);Vb!==ba.count-
1||h&&h.contextId===Zb.a.endOfParagraph||(Kb=D);Q.addRange(this.Knf(ba.J(Vb),ta,Ta,ob,Kb))}return Q}Jnf(b,h){const v=new zb.a,D=this.WT(b,h);let Q,ba,ta;for(let ob=0;ob<D.count;ob++){const Kb=D.J(ob);if(Kb.pa.length){var Ta=Kb.pa.J(Kb.pa.length-1);Q=0;ba=Kb.characterData.length;ta=0;Ta=Ta&&Ta.Jb?Ta.Jb.length:0;b&&Kb.id.equals(b.node.id)&&(Q=b.oj,ta=b.Eb);h&&Kb.id.equals(h.node.id)&&(ba=h.Yo,Ta=h.Rb);v.addRange(this.Lnf(Kb,Q,ba,ta,Ta))}}return v}Knf(b,h,v,D=!0,Q=!0,ba=!0){const ta=new zb.a;b=b.pa;
for(let Ta=0;Ta<b.length;Ta++){if(b.J(Ta).cp<h)continue;if(b.J(Ta).cp>v)break;const ob=b.J(Ta);if(ob.Jb&&0<ob.Jb.length&&(ob.cp!==h||D)&&(ob.cp!==v||Q))for(let Kb=0;Kb<ob.Jb.length;Kb++){const Vb=ob.Jb.J(Kb);(ba||Vb.Mc)&&ta.add(Vb)}}return ta}Lnf(b,h,v,D,Q){const ba=new zb.a;b=b.pa;for(let ta=0;ta<b.length;ta++){if(b.J(ta).cp<h)continue;if(b.J(ta).cp>v)break;const Ta=b.J(ta);if(Ta.Jb&&0<Ta.Jb.length){let ob=0,Kb=Ta.Jb.length;Ta.cp===h&&-1!==D&&(ob=D);for(Ta.cp===v&&-1!==Q&&(Kb=Q);ob<Kb&&ob<Ta.Jb.length;ob++)ba.add(Ta.Jb.J(ob))}}return ba}Iyd(b,
h,v){let D=null;if(h.contains(v)||!(D=this.vj.Db(v)))return!1;b.add(this.OQ(D));h.add(v);return!0}uYe(b,h,v){let D=null;!h.contains(v.ke)&&(D=v.contentControlNode)&&(b.add(this.OQ(D)),h.add(v.ke))}ABj(b,h){let v,D=!1;v=({O4a:h,N4a:b,N7c:D}=this.BBj(b,h,!1,D)).returnValue||D;D&&(v=v||({O4a:h,N4a:b,N7c:D}=this.BBj(h,b,!0,D)).returnValue);return{returnValue:v,O4a:h,N4a:b}}BBj(b,h,v,D){var Q,ba,ta,Ta;let ob,Kb;if(v)return ob=Kb=null,{returnValue:!1,O4a:Kb,N4a:ob,N7c:!1};let Vb=!1;Kb=b;ob=h;const bc=b.cpBegin,
Dc=h.cpEnd;D=!1;var Oc=v?this.m3h(h):this.nLl(b);let gd=!1,rd=!1,je=0,Ld=0;for(const Qd of Oc)for(Oc=0;Oc<Qd.pa.length;Oc++){const ge=Qd.pa.J(Oc);!rd&&Qd.id.equals(h.node.id)&&(rd=!0);if(!gd&&(Qd.id.equals(h.node.id)&&-1!==Dc&&ge.cp>Dc||rd&&!Qd.id.equals(h.node.id)))if(gd=!0,je!==Ld)Vb=!0;else return{returnValue:!1,O4a:Kb,N4a:ob,N7c:D};if((!Qd.id.equals(b.node.id)||ge.cp>=bc||-1===bc)&&ge.Jb)for(let ze=0;ze<ge.Jb.length;ze++){const gg=ge.Jb.J(ze),Kg=this.vj.Db(gg.ke);if(!Kg.getValue(lc.a.F8)||(!gg.Mc||
this.Rg.mQa(Di.a.Bj?this.zd.yq(Kg.id,!0):null!==(ba=this.zd.Ps.get(null===(Q=Kg.id)||void 0===Q?void 0:Q.toString()))&&void 0!==ba?ba:W.a.nil,Qd.id,!0))&&(gg.Mc||this.Rg.mQa(Di.a.Bj?this.zd.yq(Kg.id,!1):null!==(Ta=this.zd.tt.get(null===(ta=Kg.id)||void 0===ta?void 0:ta.toString()))&&void 0!==Ta?Ta:W.a.nil,Qd.id,!1))){gg.Mc?je++:je--;if(Vb&&je===Ld)return{O4a:Kb,N4a:ob}=this.e9k(b.node,Qd,b.cpBegin,ge.cp),{returnValue:!0,O4a:Kb,N4a:ob,N7c:D};!v&&je<Ld&&(D=!0,Ld--)}}}return{returnValue:Vb,O4a:Kb,N4a:ob,
N7c:D}}e9k(b,h,v,D){let Q;h.id.equals(b.id)?b=0<v||D<de.ParagraphReader.textLength(h)?Q=Pe.a.createTextRange(h,v,D):Q=Pe.a.create(h):(Q=0<v?Pe.a.createTextRange(b,v,de.ParagraphReader.textLength(b)):Pe.a.create(b),b=D<de.ParagraphReader.textLength(h)?Pe.a.createTextRange(h,0,D):Pe.a.create(h));return{O4a:Q,N4a:b}}k3l(b){var h,v,D,Q;const ba=b.cpBegin,ta=this.m3h(b);for(let ob=ta.count-1;0<=ob;ob--){const Kb=ta.J(ob);for(let Vb=Kb.pa.length-1;0<=Vb;Vb--){const bc=Kb.pa.J(Vb);if((!Kb.id.equals(b.node.id)||
bc.cp<=ba||-1===ba&&!bc.cp)&&bc.Jb){var Ta=bc.Jb.length-1;for((bc.cp===ba||-1===ba&&!bc.cp)&&this.ZX&&Kb.id.equals(b.node.id)&&(Ta=b.Eb-1);0<=Ta;Ta--){const Dc=bc.Jb.J(Ta),Oc=this.vj.Db(Dc.ke);if(Dc.Mc){if(Oc.getValue(lc.a.F8)&&!this.Rg.mQa(Di.a.Bj?this.zd.yq(Oc.id,!0):null!==(Q=this.zd.Ps.get(null===(D=Oc.id)||void 0===D?void 0:D.toString()))&&void 0!==Q?Q:W.a.nil,Kb.id,!0))continue;return null}if(!Oc.getValue(lc.a.F8)||this.Rg.mQa(Di.a.Bj?this.zd.yq(Oc.id,!1):null!==(v=this.zd.tt.get(null===(h=
Oc.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil,Kb.id,!1))return this.OQ(Oc)}}}}return null}OQ(b){if(!b)return null;this.Rg.C5b();return this.R1.gBb(b,this.vx,this.oi,this.Rg,this.jr,this,this.I$,this.afa,this.Jyb)}WT(b,h){b=this.l3h(b,h,vi.vEb(12));if(!b)return null;h=new zb.a;for(const v of b)h.add(v);return h}lLl(b,h){const v=vi.u_l();return this.l3h(Pe.a.create(b.node),Pe.a.create(h.node),v)}l3h(b,h,v){if(!v||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var D=
b.node;if(D&&v(D)){var Q;return Q=new zb.a,Q.add(D),Q}}D=Object.assign(new Ys,{AQi:35,y_i:v});b=b?b.node:null;h=h?h.node:null;Q=this.ram(b,h);if(!Q)return null;h=this.zzk(h,v,vi.Jyh,D);return this.hLl(b,h,Q,v,vi.Jyh,D)}ram(b,h){return(b=b?this.P$h(b):this.P$h(h))?b.jd(35):this.Rg.S5l()}zzk(b,h,v,D){if(!b)return null;h(b)||(h=this.iLl(b,h,v,D),h.count&&(b=h.J(h.count-1)));return b}hLl(b,h,v,D,Q,ba){b?(b=ne.GraphIterator.$a(b),b.zb(7),v=nc.a.Qs(b,v)):v=nc.a.Zo(v);Q&&v.oo(Q,ba);for(Q=new zb.a;v.moveNext()&&
(D(v.currentNode)&&Q.add(v.currentNode),!h||!v.currentNode.id.equals(h.id)););return Q}iLl(b,h,v,D){b=nc.a.Zo(b);v&&b.oo(v,D);for(v=new zb.a;b.moveNext();)h(b.currentNode)&&v.add(b.currentNode);return v}P$h(b){b=ne.GraphIterator.$a(b);return b.zb(35)?b:null}jmi(b,h){b=this.WT(b,h);for(const v of b)if((b=this.Rg.Vqf(v))&&b.Tga(4))return!0;return!1}Wnh(b,h=null,v=!1){if(!b)return!1;let D=b.start;var Q=b.end;if(!We.SelectionEditor.jv(D)&&D.contextId!==Zb.a.paragraph||!We.SelectionEditor.jv(Q)&&Q.contextId!==
Zb.a.paragraph||!this.ZX&&({O4a:D,N4a:Q}=this.ABj(b.start,b.end)).returnValue||this.ZX&&!({start:D,end:Q}=this.YRk(D,Q)).returnValue)return!1;b.start=D;b.end=Q;const ba=this.XIm(D,Q);if(this.ZX){var ta=this.tna(b.start,b.end,3);var Ta=this.tna(b.start,b.end,2)}else ta=this.WK(b.start,b.end,3),Ta=this.WK(b.start,b.end,2);const ob=ta&&0<ta.count?ta.J(0):null,Kb=Ta&&0<Ta.count?Ta.J(0):null;if(v)return this.FTc(b,0,ta)?!0:!1;if(this.FTc(b,0,ta)){v=(v=Object(Ka.a)(aA,this.k3l(b.start)))?this.Rg.Zt(v.objectId):
null;Ta=this.Rg.drk(b,ob,v,Ta,b.lu,b.kz,h);this.lj.jdc(Ta);if(b.Kf)for(Q=this.WT(b.start,b.end),v=0;v<Q.count;v++)if(this.ZX){ta=ob?ob.objectId:null;const Vb=this.t$h(ta,Q.J(v),!0);this.jr.Cta(Q.J(v),Ta.id,0,!0,!0,void 0,void 0,void 0,void 0,Vb);ta=this.t$h(ta,Q.J(v),!1);this.jr.Cta(Q.J(v),Ta.id,Q.J(v).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ta)}else this.jr.Cta(Q.J(v),Ta.id,0,!0,!0),this.jr.Cta(Q.J(v),Ta.id,Q.J(v).characterData.length,!0,!1);else this.ZX?(v=-1===D.Eb?0:D.Eb,this.jr.Cta(b.start.node,
Ta.id,D.cpBegin,!1,!0,void 0,void 0,void 0,void 0,v),this.jr.Cta(b.end.node,Ta.id,Q.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ba?v+1:Q.Rb)):(this.jr.Cta(b.start.node,Ta.id,b.start.cpBegin,!1,!0),this.jr.Cta(b.start.node,Ta.id,b.start.cpEnd,!1,!1));h||this.Rg.wgo(Ta,b.Kf,b.id,this.Rg.N8b(this.Rg.Zt(b.lu)),b.type);1===b.type&&this.jr.WPo(b.start.node,D.oj,D.Yo);b.objectId=Ta.id;h=this.Rg.Cva().currentNode;h.hasProperty(lc.a.rHc)||h.setValue(lc.a.rHc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);
!Di.a.dkb||0!=b.type&&1!=b.type||b.mCi||this.Rg.iFj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Ta);ob&&this.sGj(ob.contentControlNode,b);Kb&&this.sGj(Ta,Kb);ba&&this.ga.Qb(Eb.a.f8c,2,b.id);OC.a.RHh()&&this.vE&&this.vE.fireEvent(3,{node:Ta});return!0}return!1}deleteContentControl(b){if(!this.FTc(b,3))return u.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.lj.fad(b.contentControlNode))return!0;b.GM&&(b.GM=!1);const h=this.ib.gb.kb;b=b.bF();const v=
new Rp.Selection(b.toArray(),!0);let D=!1;this.ib.wNb(()=>{this.ib.setSelection(v);if(32===this.ga.processAction(Eb.a.CH,2)){if(this.Akh.instance){const Q=this.Akh.instance.cbi(h,v,this.ib.gb.kb);this.ib.MRo(new qu.SelectionCollection([Q],0))}D=!0}});return D}fya(b,h=!1,v=!1){if(this.FTc(b,2)){if(b.GM)return u.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const D=Di.a.pr?b.contentControlNode:this.Rg.Zt(b.objectId);let Q=
new zb.a;h&&(Q=b.Tmf());Q.add(b);if(v||!this.lj.fad(b.contentControlNode)){D&&D.anchor&&this.Rg.MPh(D,h);for(const ba of Q)b=this.WT(ba.start,ba.end),this.jr.Uil(b,ba.objectId);this.p5i(Q)}u.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}u.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}Cbg(b,h,v=!1){var D;if(this.FTc(b,1)){let Kb=!1;h||(Kb=!0,{Iro:Q,returnValue:h}=this.VEb(b),Q&&this.Rg.Cva().currentNode.setValue(lc.a.rHc,h));
var Q=b.k5h().toArray();for(var ba=0;ba<Q.length;ba++)this.fya(Q[ba],!0);ba=this.Xzo(h);Q=!v;if(b.Kf){var ta=this.WT(b.start,b.end);if(!ta.count)return!1;if(1===ta.count&&w.AFrameworkApplication.JD){ba=ba.join(" ");if(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.rtfSupportCA",!1))ba=h;this.jr.replaceTextRange(Pe.a.createTextRange(ta.J(0),0,ta.J(0).characterData.length),ba,void 0,Q)}else{D=this.Rg.b7l(ta.J(0));h=ta.J(0).V6b();ta=this.Rg.bQh(ta);
D=this.Rg.ioh(D,ta,ba.length);for(ta=0;ta<D.count;ta++){this.jr.replaceTextRange(Pe.a.createTextRange(D.J(ta),0,0),ba[ta],void 0,Q);for(var Ta=0;Ta<h.count;Ta++)this.jr.Cta(D.J(ta),h.J(Ta),0,!0,!0),this.jr.Cta(D.J(ta),h.J(h.count-Ta-1),D.J(ta).characterData.length,!0,!1)}b.FXo(D.J(0).id,D.J(D.count-1).id);Q=this.xE.ue(D.J(0),0);this.ib.setSelection(Q)}}else{ta=0;1<ba.length&&u.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");
h=b.start;D=h.node;for(var ob=0;ob<D.pa.length&&h.contextId===Zb.a.Hd;ob++)if(Ta=D.pa.J(ob),Ta.cp===h.cpBegin&&Ta.blob){ta++;for(ob+=1;ob<D.pa.length;ob++)if(Ta=D.pa.J(ob),Ta.cp>h.cpBegin&&Ta.cp<=h.cpEnd)if(Ta.blob)ta++;else break;else if(Ta.cp>h.cpEnd)break;break}if(0<ta&&ta+h.cpBegin<h.cpEnd)D=Pe.a.createTextRange(h.node,h.cpBegin,h.cpBegin+ta),h=Pe.a.createTextRange(h.node,h.cpBegin+ta,h.cpEnd),this.jr.replaceTextRange(h,ba[0],void 0,Q),this.jr.replaceTextRange(D,"",void 0,Q);else if(0<ta&&ta+
h.cpBegin===h.cpEnd)for(this.jr.replaceTextRange(b.start,ba[0],void 0,Q),Q=0;Q<D.pa.length;Q++){if(ba=D.pa.J(Q),ba.cp===h.cpBegin){ba.blob=null;break}}else w.AFrameworkApplication.JD?(ba=ba.join(" "),this.jr.replaceTextRange(b.start,ba,void 0,Q)):this.jr.replaceTextRange(b.start,ba[0],void 0,Q)}this.$0b(b,Kb||v);let Vb;this.EMn((Vb=new zb.a,Vb.add(b),Vb));return!0}return!1}$0b(b,h){const v=this.jr.OOc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(v){const D=this.Rg.Zt(b.objectId);if(h){h=
this.Uy.MC(b.start.node);let Q=h.Pi(Xs.a.cZf);Q||(Q=h.Rva(Xs.a.nCn));Q&&(this.Be.Bfa(v.formatting),this.Be.D6a(v.formatting,Q));D&&(b.GM=!0)}else D&&b.GM&&(this.t6n(b,v),b.GM=!1)}else u.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}t6n(b,h){b=this.Rg.Zt(b.objectId);let v=null;b&&(v=b.ia(lc.a.UAb,W.a.nil));this.Be.Bfa(h.formatting);v&&!v.equals(W.a.nil)&&(b=this.oi.value.Db(v),h.formatting=b)}VEb(b){let h=!1;b=b.placeholderText;this.WRm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,
h=!0);return{returnValue:b,Iro:h}}BXn(b,h=!0){this.afa&&(h&&this.xXn(b),this.FXn(b))}CXn(b){if(this.afa&&(b=this.WK(b,b,4)))for(const h of b)this.fya(h,!1)}Qln(b,h){if(h&&!b.Mc&&(this.Rg.C5b(),(b=b.Ib.paragraph.Jc.Db(b.ke))&&b.anchor)){this.Rg.MPh(b);b=this.R1.gBb(b,this.vx,this.oi,this.Rg,this.jr,this,this.I$,this.afa,this.Jyb);let v;this.p5i((v=new zb.a,v.add(b),v))}}hWi(b,h){this.Rg.C5b();b=this.Rg.Zt(h.ke);const v=this.OQ(b);if(v&&v.isValid()&&v.removeWhenEdited){const D=this.Gc.Oc(7);D.Cb(b);
this.fya(v,!1);h.state=2;D.dispose()}}ZWi(b,h){this.Rg.C5b();b=this.Rg.Zt(h.ke);this.aHm(b)&&(b=b.ia(lc.a.Tw,0),this.ga&&(this.ga.Qb(Eb.a.f8c,2,b),vi.Ld.b0e()))}aHm(b){return b&&b.isConnected&&!b.ia(lc.a.I7,!1)?Di.a.pr?this.QXd(b)&&!b.Nu:this.QXd(b):!1}QXd(b){b=this.R1.gBb(b,this.vx,this.oi,this.Rg,this.jr,this,this.I$,this.afa,this.Jyb);if(!b.isValid())return!1;if(b.Kf){if(b.lu.toString()===b.kz.toString()){var h=this.Rg.Zt(b.lu);if(!h)return u.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),
!1;if(12===h.type&&1===h.pa.length)return this.Nui(h.pa.J(0),b.objectId)}}else{h=b.start;if(!h)return u.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.Rg.Zt(b.lu).pa.Qh(h.cpBegin),this.Nui(h,b.objectId)}return!1}Nui(b,h){b=b?b.Jb:null;if(!b)return!1;const v=b.kJ(h,!0);return-1<v&&v+1<b.length&&b.J(v+1).ke.toString()===h.toString()}k8i(b){this.zOe.push(b)}Xtj(b,h){if(void 0===b||null===b||b.contextId!==
Zb.a.Hd)return null;b=Pe.a.Rc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<de.ParagraphReader.textLength(b.node)?this.Rg.qTa(b):null}select(b,h){if(b&&!b.equals(W.a.nil)){var v=this.Rg.Zt(b);if(v&&55===v.type){v=this.OQ(v);if(v.Kf)v=this.cNl(v);else{v=v.start;Di.a.Pj&&(v.contextId=Zb.a.Hd);if(!v)return;v=this.xE.io(v)}if(v&&v.length)return this.Tjj(v.Oa,b,h,!0,!0),this.Tjj(v.Pc,b,h,!1,!1),this.ib.setSelection(v),v}}}Xao(b,h){if(!We.SelectionEditor.gf(b)||b.Eb!==b.Rb)return!1;const v=
b.Eb;return-1===v?!1:(b=this.Do.N0a(b.node,b.cpBegin,v,!h))&&h===b.Mc?(h=this.OQ(b.contentControlNode),this.select(b.ke,!h.isEditable),!0):!1}cNl(b){var h=this.Rg.DOa(b.lu,!0);b=this.Rg.DOa(b.kz,!1);if(!h||!b)return null;h=this.lLl(Pe.a.create(h),Pe.a.create(b));if(!h||!h.count)return null;b=new zb.a;for(let v=0;v<h.count;v++){let D;if(12===h.J(v).type)D=v===h.count-1?Pe.a.createTextRange(h.J(v),0,de.ParagraphReader.textLength(h.J(v))):Pe.a.create(h.J(v)),this.yh&&(D.Eb=this.yh.Yq(D.node,!0),D.Rb=
this.yh.Yq(D.node,!1));else if(15===h.J(v).type)D=Ar.TableNodeContext.create(h.J(v));else continue;b.add(D)}return new Rp.Selection(b.toArray(),!0)}Vfo(b){if(b&&!b.equals(W.a.nil)&&(this.Rg.C5b(),(b=this.Rg.Zt(b))&&55===b.type&&b.isConnected)){var h=b.ia(lc.a.I7,!1);b.setValue(lc.a.I7,!1);h&&this.CSn(b)}}CSn(b){var h,v;const D=Di.a.Bj?this.zd.yq(b.id,!0):null!==(v=this.zd.Ps.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil;D.equals(W.a.nil)||(h=this.Rg.rna(D,!0))&&(b=this.jr.wof(h,
b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Ib,h.formatting=b.MQ?b.MQ.Ef(h):new Ov.a(h,W.a.nil))}d9i(b){if(b=this.m6h(b))for(const h of b)this.lj.vcg()&&(h.GM=!1),this.fya(h,!1)}j6h(b){const h=new zb.a;if(b=this.m6h(b))for(const v of b)h.add(v.contentControlNode);return h}DXn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.eb.kl(b),v=this.eb.PD(b);if(this.yh&&h&&v){b=this.yh.Yq(h,!0);const D=this.yh.Yq(v,!1);h=Pe.a.create(h);v=Pe.a.create(v);h.Eb=b;v.Rb=D;if(b=this.tna(h,v,4))for(const Q of b)this.fya(Q,
!1)}}}oLl(b){var h,v,D,Q;const ba=Di.a.Bj?this.zd.yq(b.id,!0,b.loading):null!==(v=this.zd.Ps.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil;b=Di.a.Bj?this.zd.yq(b.id,!1,b.loading):null!==(Q=this.zd.tt.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==Q?Q:W.a.nil;if(ba.equals(W.a.nil)||b.equals(W.a.nil))return new zb.a;D=this.Rg.rna(ba,!0);Q=this.Rg.rna(b,!1);return D&&Q?this.WT(Pe.a.create(D),Pe.a.create(Q))||new zb.a:new zb.a}DOa(b,h){return this.Rg.DOa(b,
h)}Bqf(b,h){if(b&&55===b.type&&(b=this.OQ(b),b=h?b.start:b.end)){const v=Pe.a.Rc(b.node,h?b.oj:b.Yo);v.Eb=v.Rb=(h?b.Eb:b.Rb)+(h?-1:1);return v}return null}QQl(b){return(b=this.OQ(b))?b.start:null}Tjj(b,h,v,D,Q){if((b.contextId===Zb.a.Hd||b.contextId===Zb.a.Tc||b.contextId===Zb.a.paragraph)&&(Q=b.node.pa.Qh(Q?b.oj:b.Yo))&&Q.Jb)for(let ba=0;ba<Q.Jb.length;ba++){const ta=Q.Jb.J(ba);if(ta.ke.equals(h)&&ta.rp)if(D&&ta.Mc){b.Eb=v?ba:ba+1;break}else if(!D&&!ta.Mc){b.Rb=v?ba+1:ba;break}}}EMn(b){for(let h=
0;h<this.pbh.length;++h)(0,this.pbh[h])(this,new bA(b))}p5i(b){for(let h=0;h<this.zOe.length;++h)(0,this.zOe[h])(this,new bA(b))}FXn(b){b=Pe.a.create(b);if(b=this.WK(b,b,4))for(const h of b)h.Kf||this.fya(h,!1)}xXn(b){if(b=b.V6b())for(let v=0;v<b.count;v++){var h=this.Rg.Zt(b.J(0));h=this.R1.gBb(h,this.vx,this.oi,this.Rg,this.jr,this,this.I$,this.afa,this.Jyb);this.fya(h)}}nLl(b){return this.WT(b,null)}FTc(b,h,v=null){let D=!0;try{if(!b)return u.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),
!1;u.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.fha));if(!Di.a.pr&&this.eBa&&jr.a.instance.J(1)&&this.eBa.eR(this.vx.value))return u.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.jOm(h)&&this.kOm(h)&&!this.bHm(b))return!1;if(!v){const ta=this.X6l(b);ta&&(v=new zb.a,v.add(ta))}var Q=this.Rg.vci(b.start.node);const ba=this.Rg.vci(b.end.node);
if(Q&&ba&&!Q.equals(ba)||!Q&&ba||Q&&!ba)return!1;Q=!0;if(v&&0<v.count){if(!v.J(0).isSupported)return!1;Q=v.J(0).isEditable}switch(h){case 0:D=this.xEm(b,Q);break;case 1:D=(this.W_||!this.QYd(b))&&b.isSupported&&b.isEditable&&this.duh(b)&&this.Qui(b);w.AFrameworkApplication.JD||(D=D&&!this.jmi(b.start,b.end));break;case 2:const ta=b.mCi?!0:b.isSupported;D=(this.W_||!this.QYd(b))&&ta&&b.fha&&Q;u.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:D=b.isSupported&&b.fha&&Q&&this.duh(b)&&this.Qui(b)&&
!this.jmi(b.start,b.end)}}catch(ba){u.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ba),D=!1}return D}kOm(b){return!(w.AFrameworkApplication.JD&&1===b)}jOm(b){return!(this.ZX&&(!b||2===b||3===b))}xEm(b,h){if(Di.a.eZf)return this.yEm(b,h);let v=!0;if(!this.W_&&this.QYd(b))v=!1;else if(this.ZX)this.ZX?b.Kf||We.SelectionEditor.jv(b.start)||b.start.contextId===Zb.a.endOfParagraph?b.Kf&&(b.start.contextId!==Zb.a.paragraph&&b.start.contextId!==
Zb.a.endOfParagraph||b.end.contextId!==Zb.a.paragraph&&b.end.contextId!==Zb.a.endOfParagraph)&&(v=!1):v=!1:v=h?this.eui(b):!1;else if(!(b.Kf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))v=!1;else if(b.Kf&&(b.start.contextId!==Zb.a.paragraph||b.end.contextId!==Zb.a.paragraph||b.start.equals(b.end)&&!de.ParagraphReader.textLength(b.start.node)))v=!1;else if(b.start.contextId===Zb.a.Tc||b.end.contextId===Zb.a.Tc||b.start.contextId===Zb.a.endOfParagraph||b.end.contextId===Zb.a.endOfParagraph)v=
!1;return v}yEm(b,h){return(this.W_||!this.QYd(b))&&this.zEm(b)&&this.BKm(b)&&h&&!this.TLm(b)&&this.eui(b)?!0:!1}BKm(b){var h;const v=b.start,D=v.contextId,Q=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.Kf?D!==Zb.a.paragraph&&D!==Zb.a.endOfParagraph||Q!==Zb.a.paragraph&&Q!==Zb.a.endOfParagraph?!1:!0:We.SelectionEditor.jv(v)||D===Zb.a.endOfParagraph?!0:!1}m6h(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.yh&&(this.eb.lm(h)&&12===h.node.type&&(h.Eb=this.yh.Yq(h.node,
!0)),this.eb.lm(b)&&12===b.node.type&&(b.Rb=this.yh.Yq(b.node,!1)));return this.tna(h,b,4)}duh(b){b=b.Tmf();for(const h of b)if(!h.isSupported||!h.fha)return!1;return!0}bHm(b){if(this.ABj(b.start,b.end).returnValue)return!1;const h=this.WK(b.start,b.end,2);if(!h)return!0;for(const v of h)if(!v.objectId.equals(b.objectId)&&(v.Kf&&(v.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||v.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===de.ParagraphReader.textLength(v.end.node)))||
!v.Kf&&(b.start.node.id.equals(v.start.node.id)&&(-1!==b.start.cpBegin?v.start.cpBegin===b.start.cpBegin:!v.start.cpBegin)||b.end.node.id.equals(v.end.node.id)&&(-1!==b.end.cpEnd?v.end.cpEnd===b.end.cpEnd:v.end.cpEnd===de.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Qui(b){if(b.Kf){var h=this.Rg.Zt(b.lu),v=this.Rg.Zt(b.kz);let D=null;if(12===h.type&&12===v.type){h=this.Rg.N8b(h);h=this.Rg.Zt(h);v=this.Rg.N8b(v);v=this.Rg.Zt(v);if(!h||!v)return!1;16===h.type&&16===v.type&&h.id.equals(v.id)&&
(D=h)}b=this.WT(b.start,b.end);if(!b.count)return!1;for(const Q of b)if(b=this.Rg.N8b(Q),b=this.Rg.Zt(b),!b||!(16!==b.type||D&&b.id.equals(D.id)))return!1}return!0}QYd(b){return b.Kf?!1:(b=b.start.node)?!b.ia(lc.a.zjb,!0):!0}zEm(b){return 1!==b.type?!0:b.lu.equals(b.kz)&&de.ParagraphReader.Vb(b.start.node)&&!this.hqm(b)?!0:!1}hqm(b){const h=b.start;var v=h.node;const D=v.pa;if(b.Kf){if(v.Us||v.Uga||v.hasBookmark)return!0;for(var Q of D)if(this.omi(Q))return!0;return!1}b=h.oj;v=h.Yo;let ba=Q=null;
for(const ta of D.tDi(b,v))if(!(ta.cp<b))if(ta.cp===b)Q=ta;else if(ta.cp===v)ba=ta;else if(this.omi(ta))return!0;return this.iqm(h,Q,ba)?!0:!1}omi(b){return ru(b.Jb)&&ru(b.tf)&&ru(b.Gh)&&ru(b.ed)&&null==b.hyperlink&&!b.Pm&&null==b.blob?!1:!0}iqm(b,h,v){if(null==h&&null==v)return!1;const D=b.Eb;b=b.Rb;return null!=h&&(h.Jb&&D<h.Jb.length||null!=h.blob)||null!=v&&v.Jb&&0<b||null!=h&&null!=v&&(cA(h.tf)&&Ow(v.tf)||cA(h.Gh)&&Ow(v.Gh)||!ru(h.ed)&&!ru(v.ed)&&[...h.ed].some(Q=>0===Q.xg)&&[...v.ed].some(Q=>
3===Q.xg)||null!=h.hyperlink&&v.Pm)?!0:!1}TLm(b){var h,v;return(null!==(v=null===(h=this.WK(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==v?v:[]).some(D=>1===D.type)?!0:!1}eui(b){if(!b.Kf)return!0;var h=this.Rg.Zt(b.lu);b=this.Rg.Zt(b.kz);if(Ph.TableCellReader.Qwa(h)||Ph.TableCellReader.Qwa(b)||Kl.a.Noa(h)||Kl.a.Noa(b))return!1;h=this.Rg.N8b(h);h=this.Rg.Zt(h);b=this.Rg.N8b(b);b=this.Rg.Zt(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}X6l(b){if(!b)return null;b=
this.Rg.Zt(b.objectId);if(!b)return null;b=b.ia(lc.a.H7,W.a.nil);return b.equals(W.a.nil)?null:(b=this.Rg.Zt(b))?this.OQ(b):null}m3h(b){return this.WT(null,b)}Xzo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}WRm(b){return b&&""!==b?!1:!0}t$h(b,h,v){h=h.pa.Qh(v?0:h.characterData.length);if(!h)return u.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Jb||!h.Jb.length)return 0;if(!b)return v?0:h.Jb.length;for(let D=0;D<h.Jb.length;D++){const Q=h.Jb.J(D);
if(W.a.Zp(Q.ke,b)&&Q.Mc===v)return v?D+1:D}return v?0:h.Jb.length}YRk(b,h){var v=b.node,D=h.node,Q=b.contextId===Zb.a.paragraph?0:b.cpBegin,ba=h.contextId===Zb.a.paragraph?de.ParagraphReader.textLength(D):h.cpEnd;v=this.Do.o8(v,Q,b.Eb);D=this.Do.o8(D,ba,h.Rb);ba=!v||!v.count;Q=!D||!D.count;if(ba&&Q)return{returnValue:!0,start:b,end:h};if(ba)return{returnValue:this.Bme(b,D.J(D.count-1).ke,!0),start:b,end:h};if(Q)return{returnValue:this.Bme(h,v.J(v.count-1).ke,!1),start:b,end:h};if(v.count===D.count)return v=
v.J(v.count-1),D=D.J(D.count-1),{returnValue:v.ke.equals(D.ke),start:b,end:h};v=(ba=v.count<D.count)?D.J(D.count-1):v.J(v.count-1);return{returnValue:ba?this.Bme(b,v.ke,!0):this.Bme(h,v.ke,!1),start:b,end:h}}Bme(b,h,v){var D=b.node;let Q;if(v){Q=b.contextId===Zb.a.paragraph?0:b.cpBegin;var ba=b.Eb}else Q=b.contextId===Zb.a.paragraph?de.ParagraphReader.textLength(D):b.cpEnd,ba=b.Rb;D=D.pa.Qh(Q);if(-1===ba||!D||!D.Jb||!D.Jb.length)return!1;D=D.Jb;if(v)for(v=ba;v<D.length;v++){ba=D.J(v);if(!ba.Mc)break;
if(ba.ke.equals(h))return b.Eb=v+1,!0}else for(v=ba-1;0<=v;v--){ba=D.J(v);if(ba.Mc)break;if(ba.ke.equals(h))return b.Rb=v,!0}return!1}XIm(b,h){return this.YFk(b,h)&&b.Eb===b.Rb&&(b.contextId===Zb.a.Tc||b.contextId===Zb.a.paragraph&&!b.node.characterData.length)}YFk(b,h){return b.equals(h)&&b.Eb===h.Eb&&b.Rb===h.Rb}sGj(b,h){var v,D,Q,ba,ta,Ta;if(b&&h.Kf){var ob=Di.a.Bj?this.zd.yq(b.id,!0):null!==(D=this.zd.Ps.get(null===(v=b.id)||void 0===v?void 0:v.toString()))&&void 0!==D?D:W.a.nil;v=this.Rg.rna(h.lu,
!0);ob.equals(v?v.id:null)&&(Di.a.Bj?this.zd.kE(b.id,h.objectId,!0):this.zd.Ps.set(null===(Q=b.id)||void 0===Q?void 0:Q.toString(),h.objectId));Q=Di.a.Bj?this.zd.yq(b.id,!1):null!==(ta=this.zd.tt.get(null===(ba=b.id)||void 0===ba?void 0:ba.toString()))&&void 0!==ta?ta:W.a.nil;ba=this.Rg.rna(h.kz,!1);Q.equals(ba?ba.id:null)&&(Di.a.Bj?this.zd.kE(b.id,h.objectId,!1):this.zd.tt.set(null===(Ta=b.id)||void 0===Ta?void 0:Ta.toString(),h.objectId))}}static get Ld(){return null!=vi.bIg?vi.bIg:vi.bIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static vEb(b){return h=>
h.type===b}static u_l(){return b=>12===b.type||15===b.type}static Jyh(b,h){return b.Ve===h.AQi||b.parentNode&&h.y_i(b.parentNode)?!1:!0}}Object(n.a)(vi,"ContentControlOperator",null,[610,10,611]);class m{constructor(b,h,v){this.Wc=b;this.vx=h;this.cwb=v}Rii(b){const h=this.wOc();return h&&b&&this.UPc(h,b)?this.aim(h):null}UPc(b,h,v=!1){if(!b||!h)return!1;do{var D=b.currentNode;if(!D)break;D=D.ia(lc.a.SPc,null);if(D===h||v&&D&&D.includes(h))return!0}while(b.vf(29));return!1}aim(b){var h=b.Sb(1);b.sc();
b=b.gF(1);if(!h||!b)return null;h=Mg.SelectionFactory.adl(h,b);b=We.SelectionEditor.xj(h,!1,!1);return Di.a.dkb&&!b?null:Mg.SelectionFactory.oA(h,b.Pc)}wOc(){const b=this.Wc.yk();b.set(this.vx.value);this.cwb.gP(b);return b.Sb(28)&&b.Sb(29)?b:null}N$h(){const b=this.Wc.yk();b.set(this.vx.value);this.cwb.gP(b);return b.Sb(28)?b:null}z8h(b){const h=this.wOc();if(!h||!b||!this.UPc(h,b,!1))return null;h.Qd();h.Qd();h.Qd();b=h.currentNode;return de.ParagraphReader.Vb(b)?b:null}ZSl(){const b=this.wOc();
return this.UPc(b,Xs.a.gPh,!0)?b.currentNode.getValue(lc.a.SPc):null}}Object(n.a)(m,"GlossaryNavigator",null,[608]);class C{constructor(b,h,v,D,Q,ba){this.jr=b;this.Rg=h;this.Zl=v;this.eb=D;this.oh=Q;this.afa=ba}I6c(b,h,v){if(!this.afa)return 1;if(!({tableNode:Q}=this.pGf(b)).returnValue||!this.oh.HBi(Q,h)||this.a9i(b,h))return 2;var D=this.oh.n3h(h);var Q=D.J(0).V6b();Q&&Q.count||(Q=new zb.a,Q.add(b.objectId));b=this.Rg.bQh(D);v=v.split("\n");h=Object(Ka.a)(ne.GraphIterator,this.Rg.Vqf(h));h=this.Rg.ioh(h,
b,v.length);for(b=0;b<h.count;++b){D=h.J(b);this.jr.replaceTextRange(Pe.a.createTextRange(D,0,0),v[b]);for(let ba=0;ba<Q.count;++ba)this.jr.Cta(D,Q.J(ba),0,!0,!0),this.jr.Cta(D,Q.J(Q.count-ba-1),D.characterData.length,!0,!1)}return 0}a9i(b,h){if(!this.afa)return 1;let v;if(!({tableNode:v}=this.pGf(b)).returnValue||!this.oh.HBi(v,h))return 2;h=this.oh.n3h(h);if(0<h.count&&(h=this.Zl.WK(Pe.a.create(h.J(0)),Pe.a.create(h.J(h.count-1)),2)))for(const D of h)if(D.id!==b.id&&!this.Zl.fya(D,!0))return 2;
return 0}Dbc(b){if(!this.afa||!({tableNode:v}=this.pGf(b)).returnValue)return!1;b=b.Tmf();for(var h of b)if(!h.fha||!h.isSupported)return!1;if(this.oh.RGm(v))return!1;var v=Object(Ka.a)(ne.GraphIterator,this.Rg.Vqf(v));h=new zb.a;this.eb.Jhb(v,!0,!1,h);for(const D of h)if(0<D.ia(lc.a.YCb,0)||this.eb.o1a(D).Jx)return!1;return!0}pGf(b){let h=null;return b&&b.lu.toString()===b.kz.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.Rg.Zt(b.lu))&&14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,
tableNode:null}:{returnValue:!1,tableNode:h}}}Object(n.a)(C,"TableContentControlEditor",null,[329]);class O{RGm(b){let h=!1;const v=new ne.GraphIterator;v.set(b);Ig.forEachCellInTable(v,D=>{if(!Ph.TableCellReader.hg(D)){let Q=sk.OutlineNavigator.c9(D);for(;Q;){if(Cd.OutlineElementReader.MQc(D))return h=!0,!1;Q=D.xi(1)}}return!0});return h}HBi(b,h){const v=new ne.GraphIterator;v.set(h);return Ph.TableCellReader.Qwa(h)&&v.zb(14)&&v.jd(14).id===b.id?!0:!1}n3h(b){const h=new zb.a,v=new ne.GraphIterator;
v.set(b);b=new zb.a;de.ParagraphReader.Jhb(v,!0,!1,b);for(const D of b)h.add(D);return h}}Object(n.a)(O,"TableReader",null,[328]);class ia{constructor(){this.Zl=null}get name(){return"WordEditor.ContentControl"}init(){w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(XA.a.mSa(Object(z.a)(Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").Qln,"onContentControlRangeChanged")),this.Zl=
Ga.a.instance.Na("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Ga.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.Zl&&(this.Zl.dispose(),this.Zl=null)}xc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new my.a(Id.a.Ze)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new PC(Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();
b.ha("WordEditor.ContentControlNodeFactory",()=>new Cs(Ga.a.instance.Sa("Box4.ContentControlConfigSettings"),Ga.a.instance.Sa("Box4.ContentControl.IContentControlOperator"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new Vq(new Fg.a(()=>Ya.App.xa.hb.Uc),new Fg.a(()=>Ya.App.xa.hb.Uc.od),new Ci.a,Rl.PageNavigator.instance,Ga.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ga.a.instance.resolve("Box4.IOutlineEditor"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),
Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Ga.a.instance.Sa("Box4.ContentControlConfigSettings"),Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ga.a.instance.Sa("WordEditor.ContentControl.GlossaryEditor"),Ga.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new m(new Ci.a,new Fg.a(()=>
Ya.App.xa.hb.Uc),Rl.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",()=>new vi(new Fg.a(()=>Ya.App.xa.hb.Uc),new Fg.a(()=>Ya.App.xa.hb.Uc.od),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Th.a.instance,Ga.a.instance.resolve("Box4.ISelectionFactory"),
bi.PageReader.instance,Ga.a.instance.resolve("Box4.IFormattingEditor"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ga.a.instance.Na("Box4.IContentControlDataChangedManager"),w.AFrameworkApplication.va,Ga.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ga.a.instance.resolve("Box4.IContentControlChpHelper"),Ga.a.instance.Sa("Box4.ContentControlConfigSettings"),
Ga.a.instance.Na("Box4.IContentControlReader"),Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ga.a.instance.Sa("Box4.Actors.IVirtualSelectionMerger"),Ga.a.instance.resolve("Box4.IFeatureHelper"),Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Ga.a.instance.Sa("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();
b.ha("WordEditor.ContentControl.ContentControlManager",()=>new pu(new Fg.a(()=>Ya.App.xa.hb.Uc),new Fg.a(()=>Ya.App.xa.hb.Uc.od),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ga.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ga.a.instance.Sa("Box4.ContentControlConfigSettings"),Ga.a.instance.resolve("Box4.IContentControlChpHelper"),Ga.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new $z(Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.Sa("Box4.ContentControlConfigSettings"),Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();
b.ha("WordEditor.ContentControl.GlossaryEditor",()=>new ZB(Ga.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("Box4.TextFormattingHelper"),Ga.a.instance.resolve("Box4.IFormattingEditor"))).as("WordEditor.ContentControl.IGlossaryEditor").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",
()=>new C(Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("Box4.IParagraphReader"),new O,w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();w.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ha("Box4.ContentControlConverter",()=>new NC(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new Zz(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFormattingManager",()=>new zr(new Fg.a(()=>Ya.App.xa.hb.Uc.od),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ga.a.instance.resolve("Box4.Actors.TextFormattingActor"),Ga.a.instance.resolve("Box4.TextFormattingHelper"),w.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").singleInstance()}static main(){N.a.instance.Fc(new ia)}}
Object(n.a)(ia,"ContentControlPackage",null,[1,2]);var e=c(1410),t=c(501),A=c(1755),R=c(774);class da{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(n.a)(da,"UxManagerMenuActionTelemetryData",null,[]);class ua extends Sys.EventArgs{constructor(b,h,v){super();this.definition=b;this.source=h;this.J1k=v}}Object(n.a)(ua,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class Ma extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(n.a)(Ma,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class db{constructor(b,h,v,D,Q,ba,ta=!1,Ta=null,ob=null,Kb=null,Vb=!1,bc=null,Dc=!1,Oc=!0,gd=null,rd=!1,je=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.y_c=this.i_c=this.OXh=this.onScroll=this.onResize=this.u0=this.qxa=this.tGa=this.documentElement=this.JR=this.editingElement=null;this.isFocused=!1;this.FId=null;this.wYf=this.TCf=!1;this.Nne=null;this.C$d=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=v;this.definition=
D;this.wpk=Q;this.BQa=ba;this.TNa=ta;this.Nqj=Ta;this.Oma=ob;this.hostServices=Kb;this.Fuo=Vb;this.eZi=bc;this.arj=Dc;this.Inl=Oc;this.OXh=gd;this.showDictationCommandUx=rd;this.source=je}}Object(n.a)(db,"UxManagerState",null,[]);var vb=c(1617);class Rb{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){this.Ub=b;this.ib=h;this.Nz=v;this.fd=D;this.ae=Q;this.Hb=ba;this.Ti=ta;this.qk=Ta;this.DI=ob;this.NSb=Kb;this.WRe=!1;this._state=this.e1g=null;this.shouldIgnoreFocusEvent=Vb=>{var bc;return this.fd.Bd.rz&&!this.fd.Bd.uU&&
Vb===(null===(bc=this.fd.editingView)||void 0===bc?void 0:bc.editingElement)};this.ra=new cf.a;this.wud=new Va.a;this.szd((Vb,bc)=>{Rb.N3m(v,bc.definition,bc.source)});this.uph((Vb,bc)=>{Rb.M3m(v,bc.definition,bc.source,bc.J1k)});this.Ub.fe(Rb.yMd).TH=!0;w.AFrameworkApplication.va.qa(sc.a.EJc,Zb.a.view,this.EJc.bind(this))}szd(b){this.ra.addHandler(Rb.wMf,b)}C5f(b){this.ra.removeHandler(Rb.wMf,b)}cNn(b,h){this.ra.raiseEvent(Rb.wMf,new Ma(b,h))}uph(b){this.ra.addHandler(Rb.vMf,b)}V_n(b){this.ra.removeHandler(Rb.vMf,
b)}bNn(b,h,v){this.ra.raiseEvent(Rb.vMf,new ua(b,h,v))}cYo(b){var h;if(!b.isDismissed&&b.JR){var v=vb.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(v&&v.length){v=vb.b(v);var D=Id.a.getElementBounds(b.JR);v.width||v.height?v.x+v.width<D.x||v.x>D.x+D.width||v.y+v.height<D.y||v.y>D.y+D.height?this.dismiss():(D=b.target,D.style.left=v.x+"px",D.style.top=v.y+"px",D.style.width=v.width+"px",D.style.height=v.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||u.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(u.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else u.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}h5i(b){b.isDismissed||b.Nne||(b.Nne=new of.a(2,1,1,()=>{b.Nne=null;this.cYo(b)},147),this.Hb.Wb(b.Nne))}tGa(b,h){!b.isDismissed&&b.Inl&&0<h.OJ.length&&(this.dismiss(),u.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}RAk(b){return!!b&&
b.id===Rb.zpk}qxa(b,h){if(b.isDismissed||!h||!h.Gb)return!1;h=h.Gb;const v=h.keyCode,D=!b.isFocused&&!!b.menu,Q=h.altKey||h.ctrlKey||h.shiftKey;let ba=!1;v===zf.a.t1?(this.dismiss(),u.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ba=!0):v!==zf.a.Bs&&v!==zf.a.Aw||!D||Q||!this.RAk(b.definition)?v!==zf.a.uqb&&v!==zf.a.Rmc||!D||Q||(this.Q0f(b),b.menu?(b.menu.focus(),ba=!0,u.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):u.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),u.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ba=!0);ba&&(h.preventDefault(),h.stopPropagation());return ba}i_c(b,h){if(b.isDismissed||!b.menu)return u.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);u.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}y_c(b,h){if(b.isDismissed||!b.menu)return u.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);u.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}u0(b,h){if(b.isDismissed||!h||!h.Gb||!b.menu)return u.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Gb),!b.menu),!1;const v=b.target;b=b.menu.getElementBounds();var D=h.Gb;h=D.clientX;D=D.clientY;v&&Rb.a1i(h,D,Id.a.getElementBounds(v),16)||b&&Rb.a1i(h,D,Rb.mLk(b),4)||this.dismiss();return!1}Eoo(b){var h=vb.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=vb.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=Rb.XHc();b.target=h;b.editingElement=this.fd.editingView.editingElement;b.JR=this.fd.Bd.container;b.documentElement=document.documentElement;b.tGa=(v,D)=>{this.tGa(b,
D)};b.qxa=v=>this.qxa(b,v);b.u0=v=>this.u0(b,v);b.onScroll=()=>{this.h5i(b)};b.onResize=()=>{this.h5i(b)};b.showDictationCommandUx&&(b.i_c=v=>this.i_c(b,v),b.y_c=v=>this.y_c(b,v),this.NSb&&this.NSb.execute(v=>{v.bko(b.i_c);v.dko(b.y_c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.Pw(b.tGa);this.Ti.VZ(b.onResize);this.ae.mb(Sc.a.XF,b.editingElement,b.qxa);b.TNa&&this.qk.mb(Sc.a.wca,b.documentElement,b.u0);lf.a.addHandler(b.JR,"scroll",b.onScroll);b.BQa||this.Q0f(b);
return!0}yFb(b,h){const v=!!b.menu;this.bNn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Ub.currentScope.name===Rb.yMd&&this.Ub.CR(Rb.yMd);b.tGa&&this.ib.DY(b.tGa);b.qxa&&b.editingElement&&this.ae.uc(Sc.a.XF,b.editingElement,b.qxa);this.NSb&&this.NSb.execute(D=>{b.showDictationCommandUx&&(D.Y4n(),D.Z4n());D.hlj(!1,b.showDictationCommandUx)});b.u0&&b.documentElement&&b.TNa&&this.qk.uc(Sc.a.wca,b.documentElement,
b.u0);b.onScroll&&b.JR&&lf.a.removeHandler(b.JR,"scroll",b.onScroll);b.onResize&&this.Ti.Uca(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.JR=null;b.tGa=null;b.qxa=null;b.u0=null;b.onScroll=null;b.onResize=null;b.i_c=null;b.y_c=null;v&&b.Oma&&(b.TCf?b.wYf=!0:b.Oma(b.FId))}H1a(b,h){var v;if(!h)return!1;switch(h.actionType){case zp.b.Toggle:if(h.objectFulfillment===Rb.zJo)return this.WRe=!this.WRe,this.umg(),this.AJc(b),!0;if(h.objectFulfillment===
Rb.DJo)return{value:v}=this.wud.Dc(h.suggestionGroup.type,!1),this.wud.Z(h.suggestionGroup.type,!v),this.AJc(b),!0;break;case zp.b.GiveFeedback:if(A.a.gIm(null===(v=h.suggestionGroup)||void 0===v?void 0:v.type)||R.a.cSm(h.objectName))break;this.focus();this.umg();this.AJc(b);return!0;case zp.b.RevealSuggestions:this.AJc(b)}b.TCf=!0;h=b.wpk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.TCf=!1;h&&this.AJc(b);b.wYf&&(b.wYf=!1,b.Oma(b.FId),b.FId=null);return h}AJc(b){b.u0&&b.documentElement&&b.TNa&&
(this.qk.uc(Sc.a.wca,b.documentElement,b.u0),b.TNa=!1)}yso(b,h){return b.id===t.a.CXe?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}vCj(b){var h;if(this.Eoo(b)){var v=1;w.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(v=3);var D=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(D=b.definition.suggestionGroups[0].type,D=this.wud.nb(D)?this.wud.J(D):b.Fuo);h=!1;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);v={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:Q=>this.H1a(b,Q),onDismiss:Q=>{this.yFb(b,Q)},keepCurrentFocus:b.BQa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.WRe,showDescription:D,showEditorButton:b.arj,showEditorBranding:this.yso(b.definition,b.arj),hostServices:b.hostServices,maxSuggestionGroupNumber:v,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.OXh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.eZi&&b.eZi(v);this.Nz.createContextualUi(v).then(Q=>{this.cNn(b.definition,b.source);b.menu=Q;u.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.Nqj&&b.Nqj();this.NSb&&9!==b.source&&this.NSb.execute(ba=>ba.hlj(!0,b.showDictationCommandUx))}).catch(Q=>{this.yFb(b,{ebp:e.a.Unknown});u.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",Q)});0<b.C$d&&u.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.C$d)}else 5<
++b.C$d?(u.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Hb.Wb(new of.a(2,1,Math.pow(3,b.C$d),()=>{b.isDismissed||this.vCj(b)},146))}get kF(){return!!this._state&&!this._state.isDismissed}set uge(b){this.e1g=b}get $Mm(){return this.e1g}Nlg(b,h){this.kF&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.kF?this._state.definition:null}set definition(b){this.kF&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.kF&&this._state.menu&&(this._state.isFocused||this.Q0f(this._state),this._state.menu.focus())}umg(){this.kF&&this._state.menu&&this._state.menu.updatePosition()}Q0f(b){this.Ub.nL(Rb.yMd,!1);b.isFocused=!0}uqa(b,h,v,D,Q,ba=null,ta=null,Ta=null,ob=!1,Kb=null,Vb=!1,bc=!0,Dc=null,Oc=!1,gd=10){if(!h||this._state&&!this._state.isDismissed)return!1;let rd,je;if(!({paragraphNode:je,start:b,end:rd}=Rb.UMo(b)).returnValue)return!1;this._state=new db(je,b,rd,h,
v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd);this.vCj(this._state);return!0}Lic(b){this._state&&(this._state.FId=b)}EJc(b,h,v){if(1===v)return this.kF?32:0;this.kF&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static N3m(b,h,v){v=new da(v);b.logAction({actionType:zp.b.SessionStart,engagement:zp.a.Try,objectName:Rb.Ixj,objectId:h.id,data:v});if(h.suggestionGroups)for(const D of h.suggestionGroups)b.logAction({actionType:zp.b.Presented,
engagement:zp.a.See,objectName:D.type,objectId:D.id,data:v})}static M3m(b,h,v,D){v=new da(v);b.logAction({actionType:zp.b.SessionEnd,engagement:zp.a.None,objectName:Rb.Ixj,objectId:h.id,data:v},D)}static XHc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static mLk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static a1i(b,h,v,D){const Q=v.y-D,ba=v.x+v.width+D,ta=v.y+v.height+D;return v.x-D<=b&&b<=ba&&Q<=h&&h<=ta}static UMo(b){let h,v;if(!b||!de.ParagraphReader.Vb(b.node)||
b.contextId!==Zb.a.Tc&&b.contextId!==Zb.a.Hd&&b.contextId!==Zb.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};v=b.node;b.contextId!==Zb.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=v.characterData.length);return{returnValue:!0,paragraphNode:v,start:h,end:b}}Vcc(){this.DI&&this.DI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}Rb.zpk="ActionSet";Rb.Ixj="IntentGroup";Rb.yMd="CanvasContextualUxReact";Rb.zJo="Context";Rb.DJo="Description";Rb.wMf="MenuDidOpen";Rb.vMf="MenuDidClose";
Object(n.a)(Rb,"UxManager",null,[]);class xc{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}jn(){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=w.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(62)||w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||w.AFrameworkApplication.K.$("RewriteIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").Pz.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:w.AFrameworkApplication.uiCulture,dataCulture:w.AFrameworkApplication.dataCulture,isRightToLeft:w.AFrameworkApplication.isRtl,ulsLogger:new na.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Sa("Common.IInProductMessagingUIManager").execute(v=>{v.bGi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async v=>{this.W.Sa("Common.ISystemInitiatedFeedback").execute(D=>D.logActivity(v,null))}})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new Rb($c.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Ob.InteractiveViewManager.instance,Yb.KeyInputManager.instance,
w.AFrameworkApplication.pc,w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.f1,this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.Sa("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:w.AFrameworkApplication.uiCulture,
ulsLogger:new na.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new na.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ha("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new na.a})).singleInstance(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(v=>
{u.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",v)})}dispose(){}static main(){N.a.instance.Fc(new xc)}}Object(n.a)(xc,"PackageManager",null,[1,2]);class Uc{constructor(b,h,v,D){this.YAm=(Q,ba,ta)=>{Q=null;ba.view.qe&&(Q=ba.view);if(!Q||!Q.lb)return 8;if(!this.uI.MDf())return 2;if(1===ta)return 32;this.vek.u9k();return 32};this.aMi=(Q,ba,ta)=>{let Ta=null;ba.view.qe&&(Ta=ba.view);if(!Ta||!Ta.lb)return 8;if(!this.uI.MDf())return 2;
if(1===ta)return 32;if(1!==this.uI.v8b(this.ib.gb,!0).count)return 2;ba=new ah.GraphTransaction(15);try{if(ba.Cb(Ta.Yc),!this.uI.XNo(Q===sc.a.WLf))return 8}finally{ba&&ba.dispose()}return 32};this.ga=b;this.ib=h;this.uI=v;this.vek=D}Tb(){this.ga.qa(sc.a.tWd,Zb.a.view,this.YAm);this.ga.qa(sc.a.WLf,Zb.a.view,this.aMi);this.ga.qa(sc.a.bMi,Zb.a.view,this.aMi)}}Object(n.a)(Uc,"IntelligentPlaceholderActor",null,[]);class od{constructor(){this.dpc=new Va.a;this.xfd=new Va.a}nqk(b,h){let v;({value:v}=this.dpc.Dc(b,
v)).returnValue||this.dpc.Z(b,v=new za.a);v.add(h)}Tqk(b,h){this.xfd.nb(b)&&u.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.xfd.Z(b,h)}lqk(b,h,v){this.nqk(b,h);this.Tqk(h,v)}lNl(b){let h;return({value:h}=this.dpc.Dc(b,h)).returnValue?h:null}bQl(b){let h;return({value:h}=this.xfd.Dc(b,h)).returnValue?h:null}E_n(b){let h;if(({value:h}=this.dpc.Dc(b,h)).returnValue){for(const v of h)this.xfd.remove(v);this.dpc.remove(b)}else u.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}
Object(n.a)(od,"IntelligentPlaceholderAtMentionManager",null,[659]);var Xd=c(1671);class ce extends Xd.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Uw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}pqj(b){return!b.ia(lc.a.DG,!1)}lhb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(n.a)(ce,"IntelligentPlaceholderDetailsProvider",Xd.a,[]);var Ce=c(1812),Af=c(2027),vg=c(1816);class bd{constructor(){this.Wza=""}aha(b){this.Wza+=b}Cri(b){this.Wza+=
b}dAf(b){this.Wza+=b}insertImage(b){this.Wza+=b}iri(b){this.Wza+=b}}Object(n.a)(bd,"PlainTextFormatCreator",null,[1219]);var Ae=c(1607),th=c(2026);c(361);var pi=c(1670),Wg=c(1508);class Yg{constructor(){this.Erc=new Va.a}contains(b){return this.Erc.nb(Yg.zHf(b))}add(b){this.Erc.Z(Yg.zHf(b),b)}remove(b){this.Erc.remove(Yg.zHf(b))}XPo(b){for(const h of b.Erc)this.add(h.value)}JXh(){const b=new zb.a;for(const h of this.Erc)b.add(h.value.Xj);return b}static zHf(b){return b.Xj.toString()}}Object(n.a)(Yg,
"CommentRangeSet",null,[]);class Tj extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(n.a)(Tj,"OnFollowUpEventArgs",Sys.EventArgs,[]);class Rk extends Tj{constructor(b,h){super(b);this.lCn=h}}Object(n.a)(Rk,"OnCreateEventArgs",Tj,[]);class Nj extends Tj{constructor(b,h){super(b);this.bQm=h}}Object(n.a)(Nj,"OnResolveEventArgs",Tj,[]);var li=c(217);class kj{}kj.gqe="MentionExperienceDegraded";Object(n.a)(kj,"AtMentionsConstants",null,[]);class nj{constructor(b,h,v,D,Q,ba,ta,Ta,
ob,Kb){this.OYc=b;this.bHk=h;this.a$c=v;this.ACd=D;this.lb=Q;this.yo=ba;this.KWd=ta;this.ksi=Ta;this.uu=ob;this.f1b=Kb;this.QRa=null;this.Zrn=(Vb,bc,Dc)=>{u.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Vb=this.KWd.q2a(Vb,Dc.displayName,Dc.email,Dc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,bc),!0);Vb?u.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.f1b.logKpiFailure("LPPWordEditorKPI",
"FailedToInsertAtMention",{isInternal:!0},{name:kj.gqe,isInternal:!0})};this.Mqn=(Vb,bc)=>{u.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");bc&&this.f1b.Mv(sc.a.XSk);this.KWd.onm(Vb.id,bc)};this.Fmn=()=>{this.yo.Bd.rz&&!this.yo.Bd.uU&&this.yo.editingView.lgf?this.WAh=!0:(this.OYc.reset(),u.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.itn=()=>{u.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.ptk()};this.Lqn=(Vb,bc,Dc,Oc=
new Map)=>{Oc=Object.assign(new wb.a,{extendedProperties:Oc});this.f1b.logKpiFailure("LPPWordEditorKPI",Vb,{isIntentional:bc,isInternal:Dc,additionalValues:Oc},{name:kj.gqe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:bc,isInternal:Dc,additionalValues:Oc})};(b=Ga.a.instance.Na("Box4.IEditStateEventManager"))&&b.addHandler(li.a.Hta,this.w6n.bind(this))}FZd(){return!!this.QRa}w6n(){this.FZd()&&this.WAh&&(this.QRa.updateInputText(this.MWc,!1),this.WAh=!1)}ariaNotify(b,h){this.uu.sendNotification(b,
h)}ptk(){const b=this.yo.editingView.editingElement;if(b){var h=b.getAttribute(Ze.a.AEc);b.setAttribute(Ze.a.AEc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else u.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}VZn(){const b=this.yo.editingView.editingElement;if(b){var h=b.getAttribute(Ze.a.AEc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(Ze.a.AEc,h.join(" ")):b.removeAttribute(Ze.a.AEc)):u.ULS.sendTraceTag(51218127,
323,50,"No aria-controls when dismissing picker?")}else u.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}JWk(){this.VZn();this.QRa&&this.QRa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.QRa=null;this.ksi.qkj(!0)}zce(){this.OYc.k4f(()=>{this.JWk()});this.OYc.a4f((b,h)=>{this.MWc=b;if(this.QRa)1<this.MWc.length&&"@"===this.MWc.trimEnd()?(this.f1b.Mv(sc.a.WSk),this.OYc.reset()):this.QRa.updateInputText(this.MWc,!1);else if(this.f1b.logKpiUsage("LPPWordEditorKPI",
0),this.f1b.Mv(sc.a.xvn),(b=this.SYl(h))&&b.height){h=b.y;const v=b.height,D=document.createElement("div");D.id="PeoplePicker";D.style.position="absolute";D.style.top=h-5+"px";D.style.left=b.x+"px";D.style.height=v+10+"px";document.body.appendChild(D);this.bHk.createPeoplePicker({editingElementId:this.yo.editingView.editingElement.id,containerElement:D,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.Zrn,onPermissionsReceivedCallback:this.Mqn,onDismiss:this.Fmn,onShow:this.itn,onFailure:this.Lqn}).then(Q=>
{Q.updateInputText(this.MWc,!1);this.QRa=Q;this.ksi.qkj(!1)})}});this.OYc.b4f(b=>{if(this.QRa)this.QRa.onKeyDown(b.Gb.rawEvent)})}SYl(b){var h=this.lb.gb;if(!h)return null;h=h.kb;if(!h)return null;h=h.Oa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Ka.a)(144,h);if(!h)return null;h=Object(Ka.a)(184,h.Gj(this.yo.Bd.ic));if(!h)return null;h=Object(Ka.a)(134,h);if(!h)return null;let v=null;try{v=this.a$c.b_(this.ACd.X6b(2,b),h,!1,!1,!1,!1)}catch(D){u.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",
D)}return v}}Object(n.a)(nj,"WordEditorAtMentionsHandler",null,[50]);var si=c(1499);class qi{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd){this.ga=b;this.Wc=h;this.ELa=v;this.ib=D;this.Yp=Q;this.Kd=ba;this.tD=ta;this.jld=Ta;this.Sd=ob;this.qq=Kb;this.eWj=bc;this.oi=Dc;this.Gc=Vb;this.ra=new cf.a;this.ah=Oc;this.FLg=gd;Wg.a.YZe((rd,je)=>{this.DG(je.commentNode,!0)&&this.ra.raiseEvent(qi.q_c)})}Jph(b){this.ra.addHandler(qi.eTi,b)}Cxk(b){this.ra.addHandler(qi.pWi,b)}ixk(b){this.ra.addHandler(qi.Apn,
b)}YZe(b){this.ra.addHandler(qi.q_c,b)}DG(b,h){let v=b.ia(lc.a.DG,!1);h&&(v=v&&!b.ia(lc.a.Waa,!1));return v}Lac(b){return this.Yp.Lac(b)}F4l(b){for(const h of b)for(const v of h)if(qi.QGf(v.contextId))return v.node.Jc;return null}Mam(b,h,v){const D=new Yg,Q=b.Jc;for(let ba=0;ba<b.pa.length;ba++){const ta=b.pa.J(ba);if(ta.cp>=h)break;if(ta.tf&&ta.tf.length)for(let Ta=0;Ta<ta.tf.length;Ta++){const ob=ta.tf.J(Ta);this.DG(Q.Db(ob.Xj),v)&&(ob.Mc?D.add(ob):D.remove(ob))}}return D}Nam(b,h,v,D){const Q=new Yg,
ba=b.Jc;for(let ta=0;ta<b.pa.length;ta++){const Ta=b.pa.J(ta);if(Ta.cp>v)break;if(Ta.tf&&Ta.tf.length)for(let ob=0;ob<Ta.tf.length;ob++){const Kb=Ta.tf.J(ob);this.DG(ba.Db(Kb.Xj),D)&&(Kb.Mc?Ta.cp<v&&Q.add(Kb):Ta.cp<=h&&Q.remove(Kb))}}return Q}wfi(b,h){let v;const D=b.node;b.contextId!==Zb.a.paragraph?(v=b.cpBegin,b=b.cpEnd):(v=0,b=D.characterData.length);return v===b?this.Mam(D,v,h):this.Nam(D,v,b,h)}qPc(b,h){return qi.QGf(b.contextId)?this.wfi(b,h).JXh():new zb.a}v8b(b,h){const v=new Yg;for(const D of b)for(const Q of D)qi.QGf(Q.contextId)&&
v.XPo(this.wfi(Q,h));return v.JXh()}MDf(){var b=this.ib.gb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Oa.node;return de.ParagraphReader.Vb(b)&&!de.ParagraphReader.qua(b)&&this.Yp.ojb(this.ga,!0)?!0:!1}kri(b,h){if(!this.MDf())return null;if(this.Yp.npm())return u.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let v=!1;var D=this.ib.gb.J(0).Oa;D.contextId===Zb.a.Tc?(b=b?We.SelectionEditor.F3(D,!1):null)&&b.iy&&b.Oa.contextId===Zb.a.Hd?this.ib.setSelection(b):
(this.Kd.replaceTextRange(D,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ib.setSelection(Mg.SelectionFactory.LK(D.node,D.cpBegin,D.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):v=!0;this.ah.UBb||Ce.a.instance.qSc();b=this.Yp.nBb(this.ib.gb.kb);if(!b)return null;this.Lac(b)&&this.FLg.Mv(Ua.a.newComment,{succeeded:!0,H7a:29});var Q=this.Wc.Wf(b);const ba=Q.Sb(1);if(!ba||393229!==ba.Qc)return null;Q=Q.Sb(2);if(!Q||
393230!==Q.Qc)return null;this.Jlg(b.Jc,b.id);this.ra.raiseEvent(qi.eTi,new Rk(b,h));v&&(h=D.node,D=D.contextId!==Zb.a.paragraph?D.cpEnd:h.characterData.length,this.ib.setSelection(Mg.SelectionFactory.LK(h,D,D)));return b}tWd(b){return!!this.kri(!0,b)}ESc(b,h,v,D,Q,ba){if(0>h)return!1;D="@"+D;const ta=D+" ",Ta=new ah.GraphTransaction(15);try{Ta.Cb(b);this.Kd.replaceTextRange(Pe.a.createTextRange(b,h,v),ta);this.Sd.rg&&(this.qq.q7e(b,h,h+D.length),this.qq.pqa(b,h+D.length,h+ta.length,1));const ob=
this.tD.hG(Pe.a.createTextRange(b,h,h+D.length),"mailto:"+Q,!1,!0,!1);if(!ob)return!1;const Kb=ob.ew;if(!Kb)return u.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ib.setSelection(Mg.SelectionFactory.LK(b,h,h+D.length));const Vb=this.kri(!1,2);if(!Vb)return!1;ba&&this.jld.lqk(ba,Kb,Vb.id);this.ib.setSelection(Mg.SelectionFactory.ue(b,h+ta.length))}finally{Ta&&Ta.dispose()}return!0}q2a(b,h,v,D){const Q=this.ib.tg;return We.SelectionEditor.gf(Q)?this.ESc(Q.node,
Q.cpBegin-b,Q.cpBegin,h,v,D):!1}N7l(b){if(1===b.length&&b.J(0).iy&&(b=b.J(0).Oa,b.contextId===Zb.a.Tc&&de.ParagraphReader.Vb(b.node))){const h=b.node;for(let v=0;v<h.pa.length;v++){const D=h.pa.J(v);if(D.cp===b.cpBegin){b=D.gRd(!0,!0);if(0<b.length)return b[0].Xj;break}}}return null}cBb(b,h,v){return this.Yp.QHc(b,h,v).returnValue}zNd(b,h,v,D,Q){let ba=!1;const ta=b.characterData;if(h>=ta.length||v>ta.length||v<h)return{returnValue:!1,zOa:ba};let Ta=h,ob=null;for(let Vb=0;Vb<b.pa.length;Vb++){const bc=
b.pa.J(Vb),Dc=bc.cp;if(!(Dc<h)){if(bc.Pm&&ob)try{const Oc=ta.substring(Ta,Dc),gd=new Af.a;gd.fullName=Oc.startsWith("@")?Oc.substr(1):Oc;pi.a(ob,gd);const rd=new vg.a;pi.b(ob,rd);Q&&(rd.contentId=this.eWj.lmf());D.dAf(Oc,gd,rd);ba=!0;ob=null;Ta=Dc}catch(Oc){var Kb=Object.assign(new wb.a,{extendedProperties:new Map});Kb.extendedProperties.set("exception",Oc.message);this.FLg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Kb},{name:kj.gqe,isInternal:!0,additionalValues:Kb})}Dc<=
v&&!ob&&(Kb=Math.min(Dc,v),Kb>Ta&&D.aha(ta.substring(Ta,Kb)),Ta=Dc);bc.hyperlink&&bc.hyperlink.CG&&(ob=bc.hyperlink);if(Dc>=v)break}}return{returnValue:!0,zOa:ba}}y3h(b,h,v,D,Q=-1){var ba=!1,ta=b.Db(h),Ta=b.Db(si.k(ta));ta=b.Db(si.h(ta));Q=0<Q?Q:Number.MAX_VALUE;b=this.cBb(Ta,h,!0);h=this.cBb(ta,h,!1);if(-1===b||-1===h)return{returnValue:!1,zOa:ba};if(Ta===ta)return this.zNd(Ta,b,h,v,D);const ob=this.ELa.zua(Ta,!1,!1);if(!ob)return{returnValue:!1,zOa:ba};Ta=new zb.a;let Kb=0;do Ta.add(ob.Cx),Kb+=
ob.Cx.characterData.length;while(ob.Cx!==ta&&ob.Lba()&&Kb<Q);for(Q=0;Q<Ta.count;Q++)if(ba=Ta.J(Q),ta=ba.characterData,Q)if(Q===Ta.count-1){if(!({zOa:ba}=this.zNd(ba,0,h,v,D)).returnValue)return{returnValue:!1,zOa:ba}}else{if(!({zOa:ba}=this.zNd(ba,0,ta.length,v,D)).returnValue)return{returnValue:!1,zOa:ba};v.aha("\n")}else{if(!({zOa:ba}=this.zNd(ba,b,ta.length,v,D)).returnValue)return{returnValue:!1,zOa:ba};v.aha("\n")}return{returnValue:!0,zOa:ba}}yNd(b,h){const v=new bd;return this.y3h(b,h,v,!1,
-1).returnValue?v.Wza:null}VKd(b,h){var v=b.Db(h);if(!v)return null;b=b.Db(si.h(v));if(!b)return null;h=this.cBb(b,h,!1);if(-1===h)return null;v=b.characterData;if(h>=v.length||!G.a.lca(v.charAt(h))){v=this.Gc.Oc(15);try{v.Cb(b),this.Kd.replaceTextRange(Pe.a.Rc(b,h)," ")}finally{v&&v.dispose()}}return Mg.SelectionFactory.ue(b,h+1)}Jlg(b,h){const v=b.Db(h),D=new Ae.a;this.y3h(b,h,D,!0).returnValue&&(D.aha("\n"),this.Yp.sEj(v,D.E$),this.ra.raiseEvent(qi.Bun))}Lbo(b,h){for(const v of b){if(v.contains(h))return!0;
for(const D of v)for(const Q of h)if(D.node===Q.node&&D.oj>=Q.oj)return!0}return!1}LPh(b,h,v,D,Q){const ba=this.ib.gb.clone(),ta=new yB.a(Ya.App.xa.hb.rc);b=Mg.SelectionFactory.ue(b,h);v=Pe.a.Rc(v,D);b=Mg.SelectionFactory.oA(b,v);this.ib.setSelection(b);v=!this.Lbo(ba,b);return 32===this.ga.Of(ta,Eb.a.CH,2,!0,null,null)?(v?this.ib.IY(ba):Q!==W.a.nil&&(Q=this.VKd(this.oi.value,Q),this.ib.setSelection(Q)),!0):!1}CYn(b,h){var v=b.Db(h);const D=b.Db(si.k(v));b=b.Db(si.h(v));if(D===b){v=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;
var Q=D.characterData.indexOf(v);-1!==Q&&this.LPh(D,Q,b,Q+v.length,h)}}VPh(b,h,v){var D=b.Db(h);if(!D)return!1;const Q=b.Db(si.k(D));b=b.Db(si.h(D));D=this.cBb(Q,h,!0);const ba=this.cBb(b,h,!1);if(-1===D||-1===ba||!this.LPh(Q,D,b,ba,W.a.nil))return!1;v&&this.dQh(h);return!0}dQh(b){this.Yp.e5f(b,!0)}XNo(b){var h=this.F4l(this.ib.gb);if(!h)return!1;const v=this.v8b(this.ib.gb,!0);if(1!==v.count)return!1;const D=h.Db(v.J(0));if(b)h=this.VPh(h,v.J(0),!1);else{const Q=si.k(D),ba=si.h(D);W.a.Zp(Q,ba)||
u.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.d6k(v.J(0));h.Db(Q).Tk(16,!0);h=!0}h&&(D.setValue(lc.a.Waa,!0),this.ra.raiseEvent(qi.pWi,new Nj(D,b)));return h}Qvh(b,h){b=this.v8b(this.ib.gb,!1);h.Mo[qi.DRh]=!!b.count}xUi(b,h){if(h.Mo[qi.DRh]&&de.ParagraphReader.Vb(h.clone)&&(h=h.clone,b=h.Jc)&&(h=Pe.a.createTextRange(h,0,h.characterData.length),h=this.qPc(h,!1),h.count))for(const v of h)(h=b.Db(v))&&h.setValue(lc.a.DG,!1)}MRl(b,h,v){let D;
const Q=({gGc:ob}=this.Yp.QHc(h,v,!0)).returnValue;v=({gGc:D}=this.Yp.QHc(h,v,!1)).returnValue;let ba=null,ta=-1,Ta=-1;for(;ob<D;ob++){const Kb=h.pa.J(ob);if(Kb.hyperlink&&Kb.hyperlink.CG&&Kb.hyperlink.ew===b){ba=Kb.hyperlink;ta=Kb.cp;break}}if(!ba||ta<Q)return{returnValue:!1,GJh:ta,FJh:Ta};for(b=ob;b<h.pa.length;b++){var ob=h.pa.J(b);if(ob.cp>v)break;if(ob.lU){Ta=ob.cp;break}}return{returnValue:-1!==Ta,GJh:ta,FJh:Ta}}BZn(b){var h=this.jld.bQl(b);if(h){var v=null;Ya.App.xa&&(v=Ya.App.xa.hb.Uc.od);
if(v){var D=v.Db(h);h=v.Db(si.k(D));var Q=v.Db(si.h(D));if(h!==Q)u.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({GJh:b,FJh:Q}=this.MRl(b,h,D.id)).returnValue){var ba=new ah.GraphTransaction(7);try{ba.Cb(h);const ta=Pe.a.createTextRange(h,b,Q);this.Kd.replaceTextRange(ta,"");this.Jlg(v,D.id)}finally{ba&&ba.dispose()}this.ib.gb&&0<this.ib.gb.length?(v=this.ib.gb.J(0).Oa,v.node===h?u.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",v.cpBegin,b):
u.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):u.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.setSelection(Mg.SelectionFactory.ue(h,b))}else u.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else u.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else u.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}onm(b,h){if(!h){h=
this.jld.lNl(b);if(!h){u.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const v of h)this.BZn(v)}this.jld.E_n(b)}dLl(){Ce.a.instance.qSc();const b=new zb.a;for(const v of this.Yp.g0e)if(v.Vq!==th.a.beingCreated){var h=W.a.Ff(v.objectId);h=this.oi.value.Db(h);this.DG(h,!0)&&b.add(h)}return b}mbo(b){b=this.Yp.Htf(b);this.ib.setSelection(b)}d6k(b){b?this.oi.value.Db(b).setValue(lc.a.DG,!1):u.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static QGf(b){return b===
Zb.a.Hd||b===Zb.a.Tc||b===Zb.a.paragraph}}qi.DRh="DisableNestedIntelligentPlaceholder";qi.eTi="CreateIntelligentPlaceholder";qi.pWi="ResolveIntelligentPlaceholder";qi.Bun="UpdateIntelligentPlaceholder";qi.q_c="DeleteIntelligentPlaceholder";qi.Apn="MentionAddedToFollowUpEventKey";Object(n.a)(qi,"IntelligentPlaceholderEditor",null,[619,620,621]);class oh{constructor(b,h,v,D){this.rsa=!1;this.Hs=!0;this.ae=null;this.WMa=Q=>{if(!this.Hs||!this.SRk(Q,this.ib.gb))return!1;Q.Gb.preventDefault();Q.Gb.stopPropagation();
this.fd.Bd&&this.fd.Bd.PKc(!1);Q=this.VKd(this.ib.gb);if(!Q)return!1;this.ib.setSelection(Q);return!0};this.fd=b;this.oi=h;this.ib=v;this.C6=D}Pdb(b,h){this.rsa||(b.vwa?(this.Qdb(h),this.rsa=!0):b.ifa(()=>{this.rsa||(this.Qdb(h),this.rsa=!0)}))}dispose(){this.ae&&this.ae.uc(Sc.a.XF,this.fd.editingView.editingElement,this.WMa)}Qdb(b){this.ae=b;this.fd.Bd.Vi&&this.ae.mb(Sc.a.XF,this.fd.editingView.editingElement,this.WMa)}SRk(b,h){if(b.Gb.keyCode!==zf.a.Aw&&b.Gb.keyCode!==zf.a.Bs||1!==h.length||!h.J(0).iy)return!1;
var v=this.C6.v8b(h,!0);if(1!==v.count)return!1;const D=h.J(0).Oa.node;if(!de.ParagraphReader.Vb(D))return!1;b=this.C6.cBb(D,v.J(0),!0);v=this.C6.cBb(D,v.J(0),!1);return h.J(0).Oa.cpBegin<b||h.J(0).Oa.cpEnd>v?!1:!0}VKd(b){b=this.C6.v8b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.C6.VKd(this.oi.value,b)}qkj(b){this.Hs=b}}Object(n.a)(oh,"IntelligentPlaceholderKeyboardListener",null,[618,10]);class Lk{constructor(b,h){this.GCm=v=>{1===v&&this.ga.processAction(Ua.a.newComment,2);2===v&&(this.Jdh.instance?
this.Jdh.instance.Ylc("https://go.microsoft.com/fwlink/?linkid=2154656")&&G.a.yU("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):u.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));v=[Object.assign(new pa.a,{name:"DialogResult",int64:v})];Qe.d(sc.a.x0h,void 0,void 0,void 0,void 0,void 0,v)};this.ga=b;this.Jdh=h}u9k(){const b=new pg.StandardDialog;b.Ad=11;b.Ee(1,WordEditorIntl.WordEditorStrings.L_TryIt);
b.Ee(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Ju(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.GCm);Qe.a("FollowUpsPhaseOutDialogShown")}}Object(n.a)(Lk,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var Pd=c(1477);class he{constructor(b,h,v,D,Q,ba){this.S6=this.xNe=null;this.J4=()=>{this.S6||(this.S6=new of.a(3,1,0,()=>{this.S6=null;this.uUd(this.ib.gb)},130),this.Hb.Wb(this.S6))};this.Gc=b;this.uI=h;
this.ib=v;this.Hb=D;this.NVe=Q;this.oi=ba;this.f2=new yf.a;this.Ds=new Pd.a;this.A$g=new Sg.a(this.f2);this.uI.Jph((ta,Ta)=>{this.vtk(Ta.commentNode)})}vtk(b){b=b.id;const h=this.vdi(this.oi.value,b);h&&this.Ds.Z(b,h)}vdi(b,h){const v=b.Db(h);return!v||this.uI.Lac(v)?null:this.uI.yNd(b,h)}hMk(b){const h=new Pd.a;var v=this.uI.v8b(b,!0);if(!v)return h;b=this.oi.value;for(const D of v)(v=this.vdi(b,D))&&h.Z(D,v);return h}e5f(b){if(this.xNe){const h=this.Gc.Oc(15);try{h.Cb(this.NVe()),this.uI.dQh(this.xNe)}finally{h&&
h.dispose()}}this.xNe=b?this.uI.N7l(b):null}Qnm(b){const h=this.oi.value;if(b=b?this.hMk(b):new Pd.a){var v=new Sg.a(this.f2),D=new Sg.a(this.f2);he.QUl(this.Ds,b,v,D);for(var Q of v)this.Ds.Z(Q,b.J(Q));for(const ba of D)if(v=this.Ds.J(ba),D=this.uI.yNd(h,ba),this.Ds.remove(ba),D&&(b=Q=!1,Pa.a.RPc().equals(D,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,v=!1):v=-1<D.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?Q=!0:!Pa.a.RPc().equals(v,
D),v||Q||b)){D=this.Gc.Oc(15);try{D.Cb(this.NVe()),b?this.uI.VPh(h,ba,!0):(Q&&this.uI.CYn(h,ba),v&&this.uI.Jlg(h,ba))}finally{D&&D.dispose()}}}}O6l(b){const h=new Sg.a(this.f2);for(const v of b)for(const D of v)b=D.node,de.ParagraphReader.Vb(b)&&h.add(b.id);return h}lmm(b){var h=this.oi.value;const v=b?this.O6l(b):new Sg.a(this.f2);if(v){b=new zb.a;for(const ba of this.A$g)if(!v.contains(ba)){var D=h.Db(ba);if(D){D=D.pa;for(let ta=0;ta<D.length;ta++){const Ta=D.J(ta).tf;if(Ta)for(let ob=0;ob<Ta.length;ob++){var Q=
Ta.J(ob);Q.Mc&&(Q=h.Db(Q.Xj))&&Q.ia(lc.a.CCi,!1)&&W.a.Zp(ba,si.h(Q))&&this.uI.Lac(Q)&&b.add(Q)}}}}this.A$g=v;if(b.count){h=this.Gc.Oc(7);try{h.Cb(this.NVe());for(const ba of b)ba.Eg(lc.a.CCi)}finally{h&&h.dispose()}}}}uUd(b){this.e5f(b);this.Qnm(b);this.lmm(b)}LAh(){this.S6&&(this.Hb.We(this.S6),this.S6=null)}eKb(){if(this.S6||this.oi.sxf)this.LAh(),this.uUd(null)}QB(){this.ib.Pw(this.J4);w.AFrameworkApplication.dI(()=>{this.eKb()})}dispose(){this.ib.DY(this.J4);this.LAh()}static QUl(b,h,v,D){for(const Q of h){const ba=
Q.key;b.nb(ba)||v.add(ba)}for(const Q of b)b=Q.key,h.nb(b)||D.add(b)}}Object(n.a)(he,"IntelligentPlaceholderSelectionCache",null,[10]);var dj;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.Cmp=3]="textGesture";b[b.paste=4]="paste";b[b.Y5o=5]="workItemIntent";b[b.kcp=6]="characterTrigger"})(dj||(dj={}));Object(n.b)("IntelligentPlaceholderCreation",dj);class kp{constructor(b,h,v,D){this.nAa=b;this.Jm=h;this.KSb=v;this.vx=D}Lhe(b){return b&&b.Jc&&
b.Jc.id.equals(this.vx.value.od.id)?!0:!1}Hpj(b){return this.Lhe(b)&&b.ia(lc.a.DG,!1)?!0:!1}T4m(){this.KSb.execute(b=>{b.logAction({actionType:zp.b.SessionStart,engagement:zp.a.Offer,objectName:kp.Vkc})})}s2d(b,h){const v=2==h&&this.Lhe(b);if(this.Hpj(b)||v){var D=b.getValue(lc.a.XE);this.KSb.execute(Q=>{Q.logAction({actionType:zp.b.Created,engagement:zp.a.None,objectName:kp.Vkc,objectId:D.toString(),objectFulfillment:dj[h]})})}}v1m(b){if(this.Hpj(b)){var h=b.getValue(lc.a.XE);this.KSb.execute(v=>
{v.logAction({actionType:zp.b.Deleted,engagement:zp.a.None,objectName:kp.Vkc,objectId:h.toString()})})}}L5m(b,h){if(this.Lhe(b)){var v=b.getValue(lc.a.XE);this.KSb.execute(D=>{D.logAction({actionType:zp.b.Resolved,engagement:zp.a.None,objectName:kp.Vkc,objectId:v.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}S6m(b){b===sc.a.tWd&&this.KSb.execute(h=>{h.logAction({actionType:zp.b.Deleted,engagement:zp.a.None,objectName:kp.Vkc,objectFulfillment:kp.XGo})})}L3m(b){if(this.Lhe(b)){var h=b.getValue(lc.a.XE);
this.KSb.execute(v=>{v.logAction({actionType:zp.b.Modified,engagement:zp.a.None,objectName:kp.Vkc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}hJk(){this.T4m();this.nAa.Jph((b,h)=>{this.s2d(h.commentNode,h.lCn)});this.nAa.Cxk((b,h)=>{this.L5m(h.commentNode,h.bQm)});this.nAa.ixk((b,h)=>{this.L3m(h.commentNode)});this.Jm.x0b((b,h)=>{this.S6m(h.actionId)});Wg.a.YZe((b,h)=>{this.v1m(h.commentNode)})}}kp.Vkc="IntelligentPlaceholder";kp.XGo="Undo";Object(n.a)(kp,"IntelligentPlaceholderTelemetry",
null,[]);class qr{constructor(){this.C6=this.bnd=this.Mtd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}xc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new Lk(w.AFrameworkApplication.va,b.Sa("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new od).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new qi(w.AFrameworkApplication.va,new Ci.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Fg.a(()=>Ya.App.xa.hb.Uc.od),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new Uc(w.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new he(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),
w.AFrameworkApplication.pc,()=>Ya.App.xa.hb.rc.Yc,new Fg.a(()=>Ya.App.xa.hb.Uc.od))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new oh(Ob.InteractiveViewManager.instance,new Fg.a(()=>Ya.App.xa.hb.Uc.od),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new kp(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Sa("CanvasContextual.ICanvasContextualController"),new Fg.a(()=>Ya.App.xa.hb.Uc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}jn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Sa("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Tb();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").hJk();this.C6=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");ph.a.Vvk(Object(z.a)(this.C6,this.C6.Qvh,"beforeIntelligentPlaceholderPaste"));ph.a.wzd(Object(z.a)(this.C6,this.C6.xUi,"onIntelligentPlaceholderPaste"));this.Mtd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(97)||this.Mtd.QB();this.bnd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.bnd.Pdb(Ya.App.xa.hb,Yb.KeyInputManager.instance);this.lVn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.Mtd&&this.Mtd.dispose();this.bnd&&this.bnd.dispose();this.C6&&(ph.a.M_n(Object(z.a)(this.C6,this.C6.Qvh,"beforeIntelligentPlaceholderPaste")),ph.a.s0n(Object(z.a)(this.C6,this.C6.xUi,"onIntelligentPlaceholderPaste")))}lVn(b,h,v){b&&b.execute(D=>{D.V4(new ce(h,
v))})}static main(){N.a.instance.Fc(new qr)}}Object(n.a)(qr,"PackageManager",null,[1,2]);var Js=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},Up=c(2072),Tt=c(1955),Yr=c(2033);class zu{}zu.Szo="Search_16x16x32";zu.Kzo="ClosePaneGlyph_16x16x32";Object(n.a)(zu,"SearchBoxIcons",
null,[]);var Px=c(2036),Au=c(2037),Bu=c(2035);class wy{constructor(){this.NUg=null}get key(){return"FIND_HIT"}get Uw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.NUg=b.node.VOa()}qIa(b){let h=null;for(const v of this.NUg)if(v.begin<=b&&b<v.end)return h=Object.assign(new pw.a,{LG:this.key,contentObject:v}),{returnValue:!0,RF:h};return{returnValue:!1,RF:h}}}Object(n.a)(wy,"FindHitDetailsProvider",null,[567,568]);var Qx=c(1643),d=c(1577),r=c(1620);class B{constructor(b,
h,v,D,Q,ba,ta,Ta=null,ob=null){this.gm=null;this.find=(Kb,Vb,bc,Dc,Oc)=>1===bc?32:void 0===Oc||null===Oc?8:Oc.length?this.Qfg(Oc):(this.K5e(Yr.a.initial),32);this.findInDocument=(Kb,Vb,bc,Dc,Oc)=>this.Urj(sc.a.Pob,Kb,Vb,bc,Dc,Oc);this.rBl=(Kb,Vb,bc,Dc,Oc)=>this.Urj(sc.a.Rob,Kb,Vb,bc,Dc,Oc);this.VZh=(Kb,Vb,bc)=>1===bc?32:this.Qfg(this.uo.SOa());this.t2c=(Kb,Vb,bc,Dc,Oc)=>{Kb=!this.uo.jG;Oc[Jl.a.Image16by16Class]=Kb?pd.getImageClass(zu.Szo):pd.getImageClass(zu.Kzo);Oc[Jl.a.LabelText]=Kb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Oc[Jl.a.ApplyLabelTextToControlOnly]=!0;Oc[Jl.a.EnsureControlRoleIsButton]=!0;Oc[Jl.a.On]=!1;return 32};this.vCl=(Kb,Vb,bc)=>{if(1===bc)return 32;this.Sji(!1);return 32};this.GCl=(Kb,Vb,bc)=>{if(1===bc)return 32;this.Sji(!0);return 32};this.C1f=(Kb,Vb,bc,Dc,Oc)=>{Oc[cl.a.Visible]=this.uo.asj;return 32};this.M1f=(Kb,Vb,bc,Dc,Oc)=>{Oc[cl.a.Visible]=this.uo.asj;return 32};this.SSd=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return 32;this.$A.i5c.Xji(Oc);
return 32};this.cancelSearch=(Kb,Vb,bc)=>{if(1===bc)return 32;this.K5e(Yr.a.initial);return 32};this.AGc=(Kb,Vb,bc)=>{if(1===bc)return 32;this.K5e(Yr.a.initial);this.uo.WB(!1);return 32};this.clearSearch=(Kb,Vb,bc)=>{if(1===bc)return this.nGm(Kb===Ua.a.VDh);this.uo.clearSearch();return 32};this.rne=(Kb,Vb,bc)=>{if(1===bc)return 32;switch(Kb){case Ua.a.Yjf:this.uo.matchCase=!this.uo.matchCase;break;case Ua.a.mkf:this.uo.matchWholeWord=!this.uo.matchWholeWord}return this.Qfg(this.uo.SOa())};this.Fae=
(Kb,Vb,bc,Dc,Oc)=>{Oc[Ff.a.On]=this.uo.matchCase;return 32};this.Hae=(Kb,Vb,bc,Dc,Oc)=>{Oc[Ff.a.On]=this.uo.matchWholeWord;return 32};this.n1f=(Kb,Vb,bc,Dc,Oc)=>{Kb=this.uo.matchCase;Vb=this.uo.matchWholeWord;bc="";Kb&&Vb?bc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Kb?bc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Vb&&(bc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Oc[rr.a.Value]=bc;Oc[rr.a.Visible]=Kb||Vb;return 32};this.xgc=(Kb,Vb,bc,Dc,Oc)=>{Kb=this.uo.p2;Vb="";switch(this.uo.jG){case Yr.a.startSearch:Vb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Yr.a.searching:Vb=Kb?this.mtf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Yr.a.searchComplete:Vb=
this.mtf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case Yr.a.tooManyResults:Vb=this.mtf(this.uo.sFa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case Yr.a.noMatchesFound:Vb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case Yr.a.replaceAllInProgress:Vb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case Yr.a.replaceAllComplete:Vb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Oc[rr.a.Value]=
Vb;return 32};this.Gae=(Kb,Vb,bc,Dc,Oc)=>{Oc&&(Oc.CommandValueId=this.uo.SOa());return 32};this.replace=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return this.tFf()?32:8;if(!this.tFf())return 8;Kb=this.uo.YEb();"string"===typeof Oc&&Oc&&(Kb=Oc);u.ULS.sendTraceTag(6033813,312,50,"Replace Called");Qe.a("NavigationPaneReplace");Oc=this.Xwb.replace(Kb);this.uo.cfo(Oc);return 32};this.replaceAll=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return this.iQm()?32:8;Kb=this.uo.YEb();"string"===typeof Oc&&Oc&&(Kb=Oc);Qe.a("NavigationPaneReplace");
this.gm=this.ge.$f("UserAction","ReplaceAll");this.uo.A7(Yr.a.replaceAllInProgress);u.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");r.a.v2n(this.uo.SOa(),this.uo.YEb());this.Xwb.replaceAll(Kb,this.Xrn);return 32};this.Xrn=(Kb,Vb)=>{this.gm&&(this.gm.stop(),this.gm=null);u.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Kb,["TotalCount"]:Vb});r.a.s2n(Kb,Vb);this.uo.A7(Yr.a.replaceAllComplete)};this.z4i=(Kb,Vb,bc,Dc,Oc)=>{Vb=!1;if(!Oc)return 8;
this.uo.gj.isVisible&&(Vb=Kb===sc.a.M2c===this.uo.jPc());Kb!==sc.a.M2c||this.J1g||(Vb=!1);Oc[Ff.a.On]=Vb;return 32};this.o1f=(Kb,Vb,bc,Dc,Oc)=>{if(!Oc||!this.uo.gj.isVisible)return 32;Oc[Ff.a.On]=this.uo.sFa;return 32};this.q1f=(Kb,Vb,bc,Dc,Oc)=>{if(!Oc)return 32;Oc.currentFindReplaceViewType=this.uo.jG;return 32};this.IKn=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return 32;Kb=Oc[Ff.a.On];Oc&&(Oc[Ff.a.On]=this.uo.gj.isVisible);Kb&&!Oc[Ff.a.On]&&(B.RAj(),Qe.a("NavigationPaneCrossClick"));return 32};this.r7a=(Kb,
Vb,bc,Dc,Oc)=>{const gd=this.uo.gj.isVisible;u.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",gd);return gd?this.AGc(Kb,Vb,bc,Dc,Oc):this.Fjc(Kb,Vb,bc,Dc,Oc)};this.Fjc=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return ac.SessionStatusManager.instance.OH?32:8;if(2===bc){w.AFrameworkApplication.Zoa("AutoDetectedHeadingsIsEnabled");B.RAj();this.W4();Qx.FindReplaceUIManager.BPk(Kb,Oc,this.uo.gj.isVisible);Vb=!0;Kb===sc.a.Jjc&&void 0!==Oc&&null!==Oc&&(Vb=Oc);this.uo.WB(!0,Vb);Oc=Bu.a.initial;switch(Kb){case sc.a.Gjc:u.ULS.sendTraceTag(42501022,
367,50,"");Oc=Bu.a.headings;break;case sc.a.Pob:Oc=Bu.a.find;break;case sc.a.Rob:Oc=Bu.a.replace;break;case sc.a.Jjc:Oc=Bu.a.intelligentPlaceholder;break;case sc.a.r7a:Oc=this.uo.f4b,Oc||(u.ULS.sendTraceTag(42501023,367,50,""),Oc=Bu.a.headings)}this.uo.Ojo(Oc,Vb);return 32}return 8};this.fGa=()=>{this.uo.jG&&!this.uo.sFa&&u.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.uo=h;this.$A=v;this.Xwb=D;this.J1g=Q;this.ge=ta;ob&&ob(1,this.fGa,null);this.tKa=Ta}W4(){}Tb(){this.ga.fb(sc.a.b2f,
Zb.a.view,this.IKn,96);this.ga.qa(sc.a.r7a,Zb.a.view,this.r7a);this.ga.qa(sc.a.Gjc,Zb.a.view,this.Fjc);this.ga.qa(sc.a.Pob,Zb.a.view,this.Fjc);this.ga.qa(Eb.a.RLd,Zb.a.view,this.find);this.ga.qa(Ua.a.findInDocument,Zb.a.view,this.findInDocument);this.ga.qa(Eb.a.findOnPage,Zb.a.view,this.VZh);this.ga.fb(Ua.a.jKn,Zb.a.view,this.t2c,97);this.ga.qa(Eb.a.i5d,Zb.a.view,this.vCl);this.ga.qa(Eb.a.V$d,Zb.a.view,this.GCl);this.ga.fb(Eb.a.C1f,Zb.a.view,this.C1f,97);this.ga.fb(Eb.a.M1f,Zb.a.view,this.M1f,97);
this.ga.qa(sc.a.SSd,Zb.a.view,this.SSd);this.ga.qa(Eb.a.lAb,Zb.a.view,this.cancelSearch);this.ga.qa(Ua.a.clearSearch,Zb.a.view,this.clearSearch);this.ga.qa(Ua.a.VDh,Zb.a.application,this.clearSearch);this.ga.qa(sc.a.AGc,Zb.a.view,this.AGc);this.ga.qa(Ua.a.Yjf,Zb.a.view,this.rne);this.ga.qa(Ua.a.mkf,Zb.a.view,this.rne);this.ga.fb(Ua.a.Fae,Zb.a.view,this.Fae,97);this.ga.fb(Ua.a.Hae,Zb.a.view,this.Hae,97);this.ga.fb(sc.a.n1f,Zb.a.view,this.n1f,97);this.ga.fb(sc.a.xgc,Zb.a.view,this.xgc,97);this.ga.fb(sc.a.o1f,
Zb.a.view,this.o1f,97);this.ga.fb(sc.a.q1f,Zb.a.view,this.q1f,97);this.ga.fb(sc.a.p1f,Zb.a.view,this.z4i,97);Object(d.b)()&&this.ga.fb(sc.a.Gae,Zb.a.view,this.Gae,96);this.J1g&&(this.ga.fb(sc.a.Rob,Zb.a.view,this.Fjc,1028),this.ga.fb(sc.a.M2c,Zb.a.view,this.z4i,97),this.ga.fb(sc.a.replace,Zb.a.view,this.replace,1028),this.ga.fb(sc.a.replaceAll,Zb.a.view,this.replaceAll,1028),w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.fb(Ua.a.gkf,Zb.a.view,this.rBl,1028));this.ga.qa(sc.a.Jjc,Zb.a.view,this.Fjc)}O3f(){this.tKa&&this.tKa.execute(b=>{b.V4(new wy)})}Urj(b,h,v,D,Q,ba){if(1===D)return ac.SessionStatusManager.instance.OH?32:8;if(void 0===ba||null===ba)return 8;this.Fjc(b,v,2,Q,ba);b=this.uo;b.iag(ba.CommandValueId);Object(d.b)()&&("MatchCase"in ba&&(b.matchCase=ba.MatchCase),"MatchWholeWord"in ba&&(b.matchWholeWord=ba.MatchWholeWord));return this.VZh(h,v,D,Q,ba)}Qfg(b){if(void 0===b||null===b||!b.length)return 32;
b=Px.a.createQuery(b,this.nKn);if(void 0===b||null===b)return u.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.$A.find(b);return 32}get nKn(){let b=Au.a.none;this.uo.matchCase&&(b|=Au.a.matchCase);this.uo.matchWholeWord&&(b|=Au.a.wholeWordOnly);return b}Sji(b){this.uo.f4b!==Bu.a.headings&&this.uo.p2&&(b?this.$A.i5c.Qjm():this.$A.i5c.Uji())}K5e(b){this.uo.jG&&(this.uo.sFa||u.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.$A.DZa(),this.uo.A7(b))}nGm(b){return this.uo.jG===
Yr.a.replaceAllInProgress||b&&!this.uo.jG?8:32}mtf(b){return String.format(b,this.uo.xgd,this.uo.p2)}tFf(){return this.uo.jPc()&&0<this.uo.p2}iQm(){return this.tFf()&&this.uo.sFa}static RAj(){null!=w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},B.uDa)}static PVl(b,h,v,D){return new B(w.AFrameworkApplication.va,
b,h,v,D,$c.FocusManager.instance(),Ya.App.xa.Gq,Ga.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(w.AFrameworkApplication.ta.xP,w.AFrameworkApplication.ta.xP.mb,"registerHandler"))}static OVl(b,h,v,D){return B.PVl(b,h,v,D)}}B.uDa=5E3;Object(n.a)(B,"FindReplaceActor",null,[]);var T=c(898),ea=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.jC},set:function(h){this.jC=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"last",{get:function(){return this.yWa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,v){this.removeItem(h);v={key:h,Jpa:this.yWa,next:void 0,data:v};this.first||(this.first=v);this.yWa&&(this.yWa.next=v);this.yWa=v;this._map.set(h,v)};b.prototype.insertAfter=function(h,v,D){h=this._map.get(h);if(!h)return!1;D={key:v,Jpa:h,next:h.next,data:D};var Q=h.next;Q&&(Q.Jpa=D);h.next=D;
this._map.set(v,D);return!0};b.prototype.insertBefore=function(h,v,D){h=this._map.get(h);if(!h)return!1;D={key:v,Jpa:h.Jpa,next:h,data:D};var Q=h.Jpa;Q&&(Q.next=D);h.Jpa=D;this._map.set(v,D);return!0};b.prototype.removeItem=function(h){var v=this._map.get(h);v&&(this.first===v&&(this.first=v.next),this.yWa===v&&(this.yWa=v.Jpa),v.Jpa&&(v.Jpa.next=v.next),v.next&&(v.next.Jpa=v.Jpa),this._map.delete(h))};return b}();class Ea{constructor(){this.type="heading"}}Object(n.a)(Ea,"NavPaneHeadingItem",null,
[]);class hb{constructor(){this.type="bookmark"}}Object(n.a)(hb,"NavPaneBookmarkItem",null,[]);class Nb{constructor(b,h,v,D,Q,ba,ta){var Ta,ob;this.eb=b;this.ib=h;this.Ub=v;this.qn=D;this.q9=Q;this.KF=ba;this.c5j=ta;this.xXa=0;this.rpd=new Map;this.LXg=!1;this.Jza=new Map;this.FKg=null===(Ta=w.AFrameworkApplication.K)||void 0===Ta?void 0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.Fbk=null===(ob=w.AFrameworkApplication.K)||void 0===ob?void 0:ob.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",
!1)}get headingsReady(){return this.LXg}set headingsReady(b){this.LXg=b}get TLb(){return this.xXa}get s9(){this.FXb&&0!=this.FXb.length()||(this.FXb=this.iFn());return this.FXb}set s9(b){this.FXb=b}get eic(){return this.Khk}set eic(b){this.eic&&(this.eic.isSelected=!1);b.isSelected=!0;this.Khk=b}Mrf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}iFn(){const b=new ea;if(!this.q9)return b;this.rpd=new Map;let h;const v=[];for(const D of this.q9.paragraphs()){const Q=this.lbi(D,v);null===Q||void 0===
Q?void 0:Q.forEach(ba=>{(h=this.cdi(ba,v))&&"heading"===h.type&&h.indentLevel<ba.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ba.isHidden=!1):(h.isCollapsed=!0,ba.isHidden=!0));b.insert(this.Mrf(ba,D),ba)})}return b}cdi(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}wmg(b){var h;let v=de.ParagraphReader.Ena(b),D=!1;9===v&&this.Jza.has(b.id.toString())&&(v=this.Jza.get(b.id.toString()),D=!0);const Q=null===(h=this.s9.get(b.id.toString()))||void 0===
h?void 0:h.data;if(Q){if(Q.indentLevel===v){h=S.AParagraphNode.IR(b.characterData.trim());b=this.qn.value.HXf(b);if(h!==Q.text||Q.hasBookmark!==b)return Q.text=h,Q.hasBookmark=b,!0;!D&&Q.isPurelyADH&&(Q.isPurelyADH=!1,--this.xXa);return!1}this.G1c();return!0}if(9===v)return this.ZEm(b)?(this.G1c(),!0):!1;this.G1c();return!0}ZEm(b){var h;const v=this.qn.value.n4h(b);b=null!==(h=this.rpd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==v.length)return!0;for(h=0;h<b;++h)if(!this.s9.get(v[h].HOa()))return!0;
return!1}ojl(b){if(this.s9.get(b.id.toString())||this.qn.value.HXf(b))return this.G1c(),!0;this.Jza.has(b.id.toString())&&(this.Jza.delete(b.id.toString()),--this.xXa);return!1}G1c(){const b=new ea;this.xXa=0;if(this.q9){this.rpd=new Map;var h=[],v,D;for(const Q of this.q9.paragraphs()){const ba=this.lbi(Q,h);null===ba||void 0===ba?void 0:ba.forEach(ta=>{var Ta=this.Mrf(ta,Q);D=this.cdi(ta,h);this.J6n(Ta,ta,D);b.insert(Ta,ta);"heading"===(null===v||void 0===v?void 0:v.type)&&(Ta=v,Ta.indentLevel>=
ta.indentLevel&&(Ta.isCollapsed=void 0));v=ta})}}this.s9=b}J6n(b,h,v){var D,Q;if(b=null===(D=this.FXb.get(b))||void 0===D?void 0:D.data)b.isSelected&&(h.isSelected=!0,this.eic=h),h.isHidden=b.isHidden;if(v){if(D=null===(Q=this.FXb.get(this.Mrf(v,v.paragraphNode)))||void 0===Q?void 0:Q.data)v.isCollapsed=D.isCollapsed;v.isCollapsed?h.isHidden=!0:v.isHidden?(v.isCollapsed=!0,h.isHidden=!0):(v.isCollapsed=!1,h.isHidden=!1)}}lbi(b,h){var v=de.ParagraphReader.Ena(b),D=!this.xDf(b);const Q=this.NKm(v)&&
D?!0:!1;D=this.Jza.has(b.id.toString())&&D;const ba=[];if(Q)ba.push(this.bLh(b,v,!1,h));else if(D)this.xXa+=1,this.jLc&&(v=this.Jza.get(b.id.toString()),ba.push(this.bLh(b,v,!0,h)));else{let ta=0;this.qn.value.n4h(b).forEach(Ta=>{const ob=new hb;ob.text=Ta.HOa();ob.isSelected=!1;ob.bookmarkManager=this.qn;ob.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ta+=1;ba.push(ob)});this.rpd.set(b.id.toString(),ta)}return ba}bLh(b,h,v,D){var Q,ba;const ta=new Ea;ta.text=S.AParagraphNode.IR(b.characterData.trim());
ta.indentLevel=h;ta.paragraphNode=b;ta.isSelected=!1;ta.isPurelyADH=v;this.Fbk&&(ta.listMarker=this.dsf(b));ta.hasBookmark=this.qn.value.HXf(b);for(b=null===(Q=D[D.length-1])||void 0===Q?void 0:Q.indentLevel;b&&b>=h;)D.pop(),b=null===(ba=D[D.length-1])||void 0===ba?void 0:ba.indentLevel;(!b||b<h)&&D.push(ta);return ta}xDf(b){return this.eb.Vb(b)&&0===this.eb.textLength(b,9)}Dxl(b){(b=this.s9.get(b))&&(1==b.data.isCollapsed?this.fsj(b):this.Urm(b))}onClickHeading(b){var h;this.eic=b=null===(h=this.s9.get(b))||
void 0===h?void 0:h.data;h=Mg.SelectionFactory.ue(b.paragraphNode,0);this.ib.setSelection(h);this.Ub.mg(gf.AFrame.Pn)}onClickBookmark(b){var h;this.eic=b=null===(h=this.s9.get(b))||void 0===h?void 0:h.data;this.qn.value.Lji(b.text);this.Ub.mg(gf.AFrame.Pn)}onShareHeadingClick(b){var h;w.AFrameworkApplication.te("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");Qe.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.s9.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(lc.a.Lc),
this.c5j.value.cLh(h)}Elg(b,h){const v=b.id.toString(),D=this.Jza.has(v);if(!D||this.Jza.get(v)!==h){this.Jza.set(v,h);if(this.jLc)return this.wmg(b);!this.FKg||D||this.s9.get(v)||(this.xXa+=1)}return!1}Hil(b){const h=b.id.toString(),v=this.Jza.has(h);if(v){this.Jza.delete(h);if(this.jLc)return this.wmg(b);this.FKg&&v&&!this.s9.get(h)&&--this.xXa}return!1}wJo(b){this.jLc=b;this.G1c()}emg(b){var h;const v=null===(h=this.s9.get(b.id.toString()))||void 0===h?void 0:h.data;if(!v)return!1;b=this.dsf(b);
if(v.listMarker===b)return!1;this.PRo();return!0}mdf(b){var h;b=null===(h=this.s9.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}fsj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let v;for(;b&&b.data.indentLevel>h;)v=b,b=v.next,v.data.isHidden=!1,"heading"==v.data.type&&(b=v.data.isCollapsed?this.Zxo(v):this.fsj(v));return b}Urm(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let v;for(;b&&
b.data.indentLevel>h;)v=b,b=v.next,v.data.isHidden=!0}Zxo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}NKm(b){return 0<=b&&8>=b}PRo(){let b=this.s9.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.dsf(h.paragraphNode)}b=b.next}}dsf(b){var h;if(b.VI instanceof T.a)return this.Ahm(null===(h=this.KF.Wkb(b.VI))||void 0===h?void 0:h.T8)}Ahm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}
Object(n.a)(Nb,"NavPaneHeadingsManager",null,[]);var qc=c(1578);class Jc{constructor(){this.Xwb=this.$A=this.atc=this.Lid=this.W=null}get name(){return"WordEditor.FindReplace"}xc(b){this.W=b;const h=new Nb(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),$c.FocusManager.instance(),b.Ue("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.Ue("WordEditor.Actors.HeadingsActor"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",
()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){Jc.Xb.Lp.continueWith(()=>{this.jn()})}jn(){if(Ya.App.apg){const b=Ya.App.Xoe;this.atc=Qx.FindReplaceUIManager.getInstance(b);this.$A=Tt.FindManager.createInstance(this.atc,Up.a.instance,qc.a.instance,!0);this.Xwb=this.$A.UMb;this.Lid=B.OVl(this.atc,this.$A,this.Xwb,b);this.Lid.Tb();this.Lid.W4();this.Lid.O3f();Ya.App.xa.updateCommandUI()}}dispose(){this.atc&&this.atc.dispose()}static get Xb(){return null!=Jc.ryg?Jc.ryg:
Jc.ryg=Ga.a.instance.resolve("Box4.IFeatureHelper")}}Object(n.a)(Jc,"FindReplacePackageManager",null,[1,2]);class fd{constructor(){}lmf(){return"_@_"+sb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}CUo(b,h,v,D){h.efo(b,D);h.Wl(b,Gd.a.e$,!0);h.Wl(b,lc.a.tQa,!0);h.Wl(b,lc.a.fieldInstruction,fd.NYh(v));h.Wl(b,lc.a.gt,15)}lzk(b,h,v,D){const Q=b.jGd(D);h.Wl(Q,Gd.a.e$,!0);h.Wl(Q,lc.a.gt,47);h.Wl(Q,lc.a.fieldInstruction,fd.NYh(v));b=b.jGd(D);h.Wl(b,Gd.a.e$,!0);h.Wl(b,lc.a.gt,16);return[Q.Qj,
b.Qj]}QIl(b,h,v){b=b.jGd(v);h.Wl(b,Gd.a.e$,!0);h.Wl(b,lc.a.VHb,!0);return b.Qj}static NYh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(n.a)(fd,"AtMentionHyperlinkConfigurator",null,[534]);class yd{constructor(b,h,v){this.QAa=b;this.ib=h;this.Dli=this.Tti=this.qFe=!1;this.vKb=this.vKb.bind(this);this.wKb=this.wKb.bind(this);this.FKb=this.FKb.bind(this);v&&v.execute(D=>{this.eVa=D});xp.a.$Ad.Uof.then(D=>{this.Dli=!0;this.Tti=D.isSuccess})}zce(){this.QAa.a4f(this.vKb);this.QAa.b4f(this.wKb);
this.QAa.k4f(this.FKb)}FZd(){return!1}vKb(b,h,v){var D,Q;h=Date.now();if(this.eVa)if(this.Dli&&!this.Tti)u.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ba=null===(Q=null===(D=this.ib.gb)||void 0===D?void 0:D.kb)||void 0===Q?void 0:Q.Pc;ba?(D=ba.node,de.ParagraphReader.Vb(D)?(Q=de.ParagraphReader.text(D),0>v||v>Q.length?u.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):
1<b.length&&"@"===b.trimEnd()?(Qe.c(sc.a.c5k,!0,void 0,void 0,void 0,void 0),this.QAa.reset()):(this.qFe?this.eVa.eVo():(this.qFe=!0,this.eVa.cxo(ba)),this.eVa.Nlg(v,v+b.length),b=Q.substring(0,v)+b,this.eVa.ymf(D,b,v,h))):u.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):u.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else u.ULS.sendTraceTag(537776153,
3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}wKb(b){if(this.eVa)this.eVa.onKeyDown(b)}FKb(){this.qFe=!1;this.eVa&&this.eVa.DEh()}}Object(n.a)(yd,"ContextIQUserInitHandler",null,[50]);var Zd=c(1653);class Wd{constructor(){this.Nz=null}get name(){return"WordEditor.AtMentions"}xc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new fd(b.resolve("Box4.IFeatureHelper"))).singleInstance();const h={crewAlias:Wd.nMj,featureName:Wd.SNj,topLevelKpiName:Wd.RRj,
vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new tv.a(wa.Health.instance,new ds.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()})}dispose(){}jn(){this.W.Sa("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{w.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&w.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));
(h||Zd.a.Bcd())&&this.UZm()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}UZm(){(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").Pz.loadScript("canvasAtMentions")).then(()=>{w.AFrameworkApplication.K.Po(()=>{this.ITn()})})}ITn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:w.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},
useLPP:!0,isTestEnv:this.TSm()};this.Nz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(v=>{v&&Zd.a.Ccd()||!v&&Zd.a.Bcd()?(Zd.a.UBf=!v,this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new yd(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Sa("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance()):
this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new nj(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.Nz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),Ob.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),
this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").zce()})})}TSm(){var b,h;const v=null!==(b=w.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=w.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return v===Wd.aMj&&b===Wd.$Lj}}Wd.aMj="-4";Wd.$Lj="DC2";Wd.nMj="webasynccollabeng";Wd.SNj="AtMentions";Wd.RRj="AtMentionsFeatureUsage";
Object(n.a)(Wd,"PackageManager",null,[1,2]);var pe=c(1686),Je=c(1395);class Le{constructor(b,h,v,D){this.ga=b;this.Te=h;this._augLoopRuntimeManager=v;this.ook=D;this.nta=0;this.$xd=this.cZb=!1;this.yNg=this.uch=this.LJe=this.vch=0;this.csb=null;this.W0j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.J_j=[{id:`${eu.jgc}_${1}`},{id:`${eu.jgc}_${2}`},{id:`${eu.jgc}_${3}`},{id:Je.a.xHd},{id:Je.a.SFd},
{id:Je.a.H9d},{id:Je.a.E9d}];this.TUj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.ufd=new Map;this.e7j=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.oak=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.dYj=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Te.mb(this,pe.SearchSuggestionAnnotation.getTypeName());(w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.ufd.set("InsertLink","InsertLinkFlyout");this.ufd.set("GraphicsEditor","");this.XDj();this.Tb(this.ga)}tHn(b,h){const v=Date.now();this.LJe&&1250>v-this.LJe||this.Yvb||(this.LJe=v,this.csb=b,this.Oud=this.ycm(h),this.z5n(),
this.Q3n())}PC(b,h){if(b.annotationType===pe.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===ib.a.getTypeName()&&(h=Date.now(),b=b.content,this.Yvb&&this.Yvb===b.correlationId)){window.clearTimeout(this.nta);this.Yvb=void 0;var v=this.cZb,D=this.c2l(b),Q=D&&0<D.length;Q&&(this.RVo(D),this.$xd&&(v=!1));v&&this.xbj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.uch,["canvasContextRetrievalTime"]:this.yNg,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.vch,["containsZTM"]:Q,["shouldFallBack"]:this.cZb,["fallBack"]:v};u.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}c2l(b){const h=this.getSuggestions(b.intentSuggestions,pe.IntentIds.ZeroTermMenu,pe.ObjectSemantic.GenericSuggestions,pe.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,v,D){return Array.isArray(b)?b.filter(Q=>Q.intent===
h&&Q.result.semantic===v&&Q.result.type===D).map(Q=>Q.result.value):[]}Tb(b){b.fb(Ua.a.EIi,Zb.a.application,this.R3n.bind(this),96)}ycm(b){const h=[],v=new Map,D=Date.now();for(const Q of b){if(!Q)continue;b=[];const ba={itemsMetadata:new Va.a};for(let ta=0;ta<Q.ControlList.length;ta++){const Ta=Q.ControlList[ta];if(Ta&&!Ta.ExternalId)continue;b.push(Ta.ExternalId);const ob={timeStamp:D,source:"FallbackZeroTermMenu",confidenceScore:-1};ba.itemsMetadata[Ta.ExternalId]=ob;v.set(Ta.ExternalId,ob)}h.push(appChrome.api.menuSection(b,
Q.Title,Q.Lang,Q.Id,ba))}return{sections:h,commands:v}}tAj(b){return this.ufd.has(b)?this.ufd.get(b):b}CIa(b){const h={};for(const v of b)b=this.tAj(v.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Ya.App.xa.XMd(h)}EGm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.W0j.has(b)?this.Oud.commands.has(b):!0}gNh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.csb})}Wgb(b=
!1){b=b?Ik.a.instance.Ysc:Ik.a.instance.Wgb();const h=[],v=Date.now();for(const D of b)D.commandId&&h.push({Id:D.commandId,TimeElapsedSinceClick:(v-D.timeStamp)/1E3,ContentType:D.contentType,CommandSurface:D.commandSurface,InputMethod:D.Ix});return h}uNc(){const b=Ik.a.instance.uNc(),h=[],v=Date.now();for(const D of b)D.controlId&&h.push({Id:D.controlId,TimeElapsedSinceClick:(v-D.timeStamp)/1E3,ContentType:D.contentType,CommandSurface:D.commandSurface,InputMethod:D.Ix});return h}Snf(){const b={semantic:pe.ObjectSemantic.CanvasContext,
type:pe.ObjectSchemaType.WordCanvasContext,value:{contentType:this.csb}};if(this.dYj){const h=Date.now(),v=this.ook.Snf(Th.a.instance.gb.kb);v&&v.value.contentType&&(b.value=v.value);this.yNg=Date.now()-h}return b}s6h(){const b=this.uNc(),h=this.Wgb(),v=this.Wgb(!0),D=[];D.push({semantic:pe.ObjectSemantic.ControlIdHistory,type:pe.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:pe.SequenceType.ControlId,Sequence:b}});D.push({semantic:pe.ObjectSemantic.CommandIdHistory,type:pe.ObjectSchemaType.CommandExecutionSequence,
value:{SequenceType:pe.SequenceType.CommandId,Sequence:h}});D.push({semantic:pe.ObjectSemantic.FilteredCommandIdHistory,type:pe.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:pe.SequenceType.CommandId,Sequence:v}});D.push(this.Snf());return D}XDj(){this._augLoopRuntimeManager.getSession().then(b=>this.sed=b).catch(()=>{this.sed=void 0})}Q3n(){const b=Date.now(),h=this.s6h(),v=[pe.IntentIds.ZeroTermMenu,pe.IntentIds.Logging];this.uch=Date.now()-b;this.Xvj(v,h,"ContextualMenu")}R3n(b,
h,v){2===v&&(b=this.s6h(),this.Xvj([pe.IntentIds.Logging],b,"Floatie"));return 32}Xvj(b,h,v){if(0===b.length||0===h.length)u.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var D=new pe.SearchSuggestionSignal({correlationId:this.BRl(),intents:b,contextObjects:h,entryPoint:v});this.cZb=0<=b.indexOf(pe.IntentIds.ZeroTermMenu);this.vch=Date.now();this.Yvb=D.correlationId;this.nta=window.setTimeout(()=>{this.bsn(D.correlationId)},750);h=new ib.l({parentPath:["Signal",
pe.SearchSuggestionSignal.getTypeName()],items:[{id:sb.a.create().toString(),body:D}]});this.sed&&!this.sed.isClosed?this.sed.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.XDj());u.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:D.correlationId,["shouldFallBack"]:this.cZb,["intents"]:b}))}}BRl(){const b=sb.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",
b);return b}bsn(b){this.Yvb&&this.Yvb===b&&(this.Yvb=void 0,this.cZb&&this.xbj(),u.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.cZb})))}xbj(){const b=this.gNh(this.Oud.sections);appChrome.api.dispatch(b);this.sGh()}sGh(){this.$xd=!0}LYn(b){var h,v;const D=[],Q=new Map;if(!b||0===b.length)return D;for(const ba of b){if(!ba||!ba.controlIds||0===ba.controlIds.length)continue;b={controlIds:[],
id:ba.id,title:ba.title,lang:ba.lang,data:{itemsMetadata:new Va.a}};const ta="CommandsZTM"===ba.id;for(const Ta of ba.controlIds){if(Q.has(Ta))continue;if(ta&&b.controlIds.length>=this.oak)break;const ob=null===(v=null===(h=ba.data)||void 0===h?void 0:h.itemsMetadata)||void 0===v?void 0:v[Ta];Q.set(Ta,ob);b.controlIds.push(Ta);ob&&(b.data.itemsMetadata[Ta]=ob)}0<b.controlIds.length&&D.push(b)}return D}z5n(){this.$xd=!1;if(this.e7j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",
!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}RVo(b){this.$xd||(b=this.MJl(b),0<b.length&&appChrome.api.dispatch(b))}MJl(b){const h=[];let v=[];var D=this.k7l();D&&0<D.length&&v.push(...D);(D=this.HIl())&&v.push(D);Array.isArray(b)&&0<b.length&&(b=this.Aua(b))&&(b.id="CommandsZTM",v.push(b));(b=this.xIl())&&v.push(b);v=this.LYn(v);if(0===v.length)return[];h.push(this.gNh(v));this.sGh();return h}k7l(){var b,h;const v=null===(b=this.Oud)||
void 0===b?void 0:b.sections.filter(D=>{var Q;return null===(Q=D.id)||void 0===Q?void 0:Q.startsWith(eu.iUh)});for(const D of v)if(null===(h=D.data)||void 0===h?0:h.itemsMetadata)for(const Q in D.data.itemsMetadata)D.data.itemsMetadata[Q].source="PassThroughZeroTermMenu";return v}HIl(){const b=this.s2h(this.J_j,"DefaultZeroTermMenu");return this.Aua(b)}xIl(){const b=this.s2h(this.TUj,"AdvertizedZeroTermMenu");return this.Aua(b)}s2h(b,h){const v=[];for(const D of b)D&&this.Dso(D)&&this.Oud.commands.has(D.id)&&
v.push({suggestion:D.id,rankingScore:-1,suggestionSource:h});return v}Dso(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Aua(b){const h=[],v={itemsMetadata:new Va.a},D=Date.now();this.CIa(b);for(const Q of b)b=this.tAj(Q.suggestion),this.EGm(b)&&(h.push(b),v.itemsMetadata[b]={timeStamp:D,source:Q.suggestionSource,confidenceScore:Q.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,v):null}}Object(n.a)(Le,"AugLoopSearchSuggestionManager",
null,[52,323]);class Eg{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}xc(b){this.W=b;this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new Le(w.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>
{xp.a.$k().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){N.a.instance.Fc(new Eg)}}Object(n.a)(Eg,"PackageManager",null,[1,2]);var pj=c(434),ik=c(948);class Wl extends ik.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(n.a)(Wl,"BootMessage",ik.a,[]);var kn=c(1052);class tn{constructor(){this.mQ=null;this.Gpn=b=>{if(b.target===this.mQ)if(void 0===b.data||null===b.data)u.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=F.a(b.data);this.bke(h.api)?this.bed.J(h.api).$3d(h.method,h):u.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){u.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.bed=new Oh.a}eHf(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let v=!1;try{this.mQ=new Worker(b);this.mQ.onmessage=this.Gpn;const D=Object.assign(new Wl,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(D);this.eHf()&&kn.a.CTj(this.mQ);v=!0}catch(D){u.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",D)}return v}postMessage(b){try{const h=F.c(b);this.mQ.postMessage(h)}catch(h){u.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}bke(b){return this.bed.nb(b)}Rpk(b,
h){this.bke(b)&&u.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.bed.Z(b,h)}aMl(b){return this.bke(b)?this.bed.J(b):null}}Object(n.a)(tn,"WebWorker",null,[64]);class Np{constructor(){this.ypg=[]}Gel(b,h){if(h){var v=w.AFrameworkApplication.Bz(b.Igj,7),D=[];for(let Q=0;Q<b.qPb.length;Q++){let ba;switch(b.qPb[Q].format){case 5:case 6:ba=pj.a.bFb(b.qPb[Q].name);break;default:ba=b.qPb[Q].name}D.push(w.AFrameworkApplication.Bz(ba,
b.qPb[Q].format))}try{const Q=URL.createObjectURL(new Blob(["importScripts('"+v+"');"],{type:"application/javascript"})),ba=new tn;if(ba.create(Q,D))for(this.ypg.push(ba),v=0;v<b.ake.length;v++){const ta=h.j8k(ba,b.ake[v]);ta&&ba.Rpk(b.ake[v],ta)}}catch(Q){u.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",Q.message)}}else u.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(n.a)(Np,"WebWorkerCollection",null,
[]);class Xl{constructor(b,h){this.sXe=new Np;if(b){b=b.create();for(let v=0;v<b.length;v++)this.sXe.Gel(b[v],h)}else u.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...v){let D=!1;for(let ba=0;ba<this.sXe.ypg.length;ba++){var Q=this.sXe.ypg[ba];Q.bke(b)&&((Q=Q.aMl(b))?D=Q.callMethod(h,v)||D:u.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}D||u.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(n.a)(Xl,"WebWorkerRouter",null,[24]);class fl extends ik.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(n.a)(fl,"SettingsMessage",
ik.a,[]);class pk{constructor(b){this.mQ=b}}Object(n.a)(pk,"WebWorkerApiMain",null,[]);class Ak extends pk{constructor(b){super(b)}eHf(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return u.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.hRk(h);u.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}$3d(b,h){switch(b){case 14:this.Dmm(h);break;default:u.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}hRk(b){if(2!==b.length)return u.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return u.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new fl,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:w.AFrameworkApplication.userSessionId,LocalCobaltSessionId:yj.a.instance.cP,LocalCobaltMachineId:yj.a.instance.Xkb,LocalCobaltClusterId:yj.a.instance.VIb,LocalCobaltSessionHasBackup:yj.a.instance.Yoa,WaciiEnabledRequests:yj.a.instance.Gja,SettingsRoutedToServer:yj.a.instance.dcg,WacClusterId:w.AFrameworkApplication.Ne.SY});this.mQ.postMessage(b);return!0}Dmm(b){this.eHf()&&
b&&b.result&&(u.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.XZo())}async XZo(){try{const b=await new kn.a.DTj.WorkerUtilsTestClass(10);await b.Ih(5);15==await b.counter?u.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):u.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){u.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(n.a)(Ak,"InitializeWorkerApiMain",pk,[]);class Dj extends ik.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(n.a)(Dj,"CatchUpNetworkRequestWorkerRequestMessage",ik.a,[]);class tj extends pk{constructor(b,h){super(b);this.OFc=h}callMethod(b,h){if(4===b)return b=Object.assign(new Dj,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.mQ.postMessage(b),!0;u.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}$3d(b,h){switch(b){case 5:u.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.OFc.xfo(h);break;default:u.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(n.a)(tj,"CatchUpNetworkRequestWorkerExternalApi",pk,[]);class Mn extends ik.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(n.a)(Mn,"LocalInferenceMessage",ik.a,[]);class Wq{constructor(){this.prediction=this.context=null}}Object(n.a)(Wq,"LocalInferenceOutput",null,[]);class ny{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(n.a)(ny,"TextPredictionConfig",null,[]);class zx{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(n.a)(zx,"TextPredictionSettings",null,[]);class Pw{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(n.a)(Pw,
"TextPredictionDynamicPayload",null,[]);class ez extends pk{constructor(b,h){super(b);this.vok=h}callMethod(b,h){if(!h)return u.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.nRk(h);case 7:return this.iRk(h);case 9:return this.mRk(h);case 10:return this.jRk(h);case 13:return this.kRk(h);case 14:return this.lRk(h);default:return u.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}$3d(b,h){switch(b){case 9:this.Gnm(h);break;default:u.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}Gnm(b){b&&b.prediction&&(b=Object.assign(new Wq,{prediction:b.prediction,context:b.context}),this.vok.lvh().EHn(b))}iRk(b){if(1>b.length)return u.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mn,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.mQ.postMessage(b);return!0}nRk(b){if(1>b.length)return u.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mn,{api:4,method:8,paragraphContent:b});this.mQ.postMessage(b);
return!0}mRk(b){if(2>b.length)return u.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Mn,{api:4,method:9,paragraphContent:b,context:h});this.mQ.postMessage(h);return!0}jRk(b){if(1>b.length)return u.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mn,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.mQ.postMessage(b);return!0}kRk(b){if(1>b.length)return u.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mn,{api:4,method:13,textPredictionConfig:this.B7h(b)});this.mQ.postMessage(b);return!0}lRk(b){if(1>
b.length)return u.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(yb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Mn,{api:4,method:14,textPredictionConfig:this.B7h(b)});this.mQ.postMessage(b);return!0}getConfig(b=null){return Object.assign(new ny,{scriptDirectory:w.AFrameworkApplication.t5+"/intelligence/",settings:Object.assign(new zx,{extendedRankLimit:0}),modelFilesUrl:b})}B7h(b=
null){return Object.assign(new ny,{scriptDirectory:w.AFrameworkApplication.t5+"/intelligence/",settings:Object.assign(new zx,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(n.a)(ez,"LocalInferenceWorkerApiMain",pk,[]);class oy extends pk{constructor(b){super(b);w.AFrameworkApplication.dI(()=>{this.eKb()})}callMethod(b){u.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}$3d(b){u.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}eKb(){const b=Object.assign(new ik.a,{api:3,method:6});this.mQ.postMessage(b)}}Object(n.a)(oy,"ShutdownWorkerApiMain",pk,[]);class Uv{constructor(b){this.container=b}j8k(b,h){let v=null;switch(h){case 0:v=new Ak(b);break;case 2:v=new tj(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:v=new oy(b);break;case 4:v=new ez(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:u.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return v}}Object(n.a)(Uv,"WordWebWorkerApiFactory",null,[665]);var HD=c(320);class Zs{constructor(b,h){this.name=b;this.format=h}}Object(n.a)(Zs,"ImportedScript",null,[]);class QC{constructor(){this.ake=this.qPb=this.Igj=null}}Object(n.a)(QC,"WebWorkerConfig",null,[]);var ID=c(1448);class aC{constructor(b){this.lhh=[];this.i8j=b;if(w.AFrameworkApplication.K){b=w.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
w.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const v=w.AFrameworkApplication.K.jb("ContentBaseUrl")?6:5;var h=w.AFrameworkApplication.K.jb("AppScriptBaseName");const D=b?"":".";if(h){const Q=b?"":"{0}";h+=`${D}${Q}worker.js`;this.lhh.push(new Zs(`MicrosoftAjax${b?"":"DS"}.${Q}js`,v),new Zs(h,v))}else u.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else u.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new QC,{Igj:"workerboot",qPb:this.lhh,ake:[0,2,3,4]});this.i8j&&this.IIm()&&h.qPb.push(new Zs("intelligence/edge-inference-web.js",5));b.push(h);return b}IIm(){return(new HD.a("arrowFunction",()=>{try{Object(ID.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(n.a)(aC,"WordWebWorkerConfigFactory",null,[322]);class ZA{constructor(){this.Ma=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ma.appSettings,w.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}xc(b){this.W=b;this.Ma=this.W.resolve("Common.IAppSettingsManager");const h=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",()=>new Xl(new aC(h),new Uv(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance()}static main(){N.a.instance.Fc(new ZA)}}Object(n.a)(ZA,"WordEditorWorkersPackage",null,[1,2]);var JD=c(1172);
class $A{constructor(){this.Lsd=[]}Pei(b,h){let v=-1,D=null;D=Q=>{Q?h(this.Lsd[v]):(++v,v<this.Lsd.length?this.Lsd[v].a2b(b,D):h(null))};D(!1)}a2b(b,h){this.Pei(b,v=>{h(!!v)})}nhc(b,h,v){this.Pei(b,D=>{if(!D)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");D.nhc(b,h,v)})}woh(b){this.Lsd.push(b)}}Object(n.a)($A,"CompositeExternalContentURLResolver",null,[666,187]);var RC=c(1443);class lv extends RC.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=
null;this.Height=this.Width=0;this.ProviderName=this.IFrameHtml=null}}Object(n.a)(lv,"ExternalContentEmbedResponse",RC.a,[]);var Ax=c(1458),zn=c(1842),pD=c(1841),qD=c(1363),aB=c(707),fz=c(496),Bx=c(170),bC=c(857),Vv;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.hep=3]="externalContentFloatieConversion"})(Vv||(Vv={}));Object(n.b)("ExternalContentConversionContext",Vv);class hh{constructor(){this.xIb=
this.wIb=null;this.Wif=new qD.ExternalContentEmbedRetriever;this.SAc=!0;this.Lsc=this.ko=this.goi=this.foi=this.Nl=this.Gp=null;this.picturePasteRequestSucceeded=()=>{u.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Jfc=()=>{u.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=hh.fna&&hh.fna.u6h()}get zOb(){return this.SAc}set zOb(b){this.SAc=b}x5e(b,h){let v=!1;if(b){switch(b.contextId){case Zb.a.Tc:v=!h;
break;case Zb.a.Hd:v=!0}v&&!bC.a(b.node)&&(v=!1)}return v}iUm(b){const h=b.startsWith(ue.HyperlinkReader.lgc),v=b.startsWith(ue.HyperlinkReader.k2c),D=b.startsWith(ue.HyperlinkReader.wae);return(h||v||D)&&ue.HyperlinkReader.r3a(b)}d6i(){this.ko=W.a.create();hh.uf.oBb(this.ko,4);hh.uf.U4(this.ko,0,hh.uf.zn());this.BGb(this.wIb,3,this.xIb,!0)}HPa(b,h,v){this.ko=W.a.create();hh.uf.oBb(this.ko,v?0:2);hh.uf.U4(this.ko,0,hh.uf.zn());this.Lsc();this.BGb(b,v?0:2,h)}G9d(b,h){this.ko=W.a.create();hh.uf.oBb(this.ko,
1);hh.uf.U4(this.ko,0,hh.uf.zn());this.BGb(b,1,h)}sWd(b,h,v,D){if(!b||!b.isConnected||!ke.ImageReader.Eu(b))return null;const Q=new aB.a;Q.setValue(Ve.a.F9b,v);Q.setValue(Ve.a.BPa,h);Q.d_a=this.foi;Q.Uw=this.goi;Q.providerName=D;Q.t3a=1===v;ne.GraphIterator.$a(b).Jf(Q,2);this.wYc(Q);return Q}b8i(b){this.Lsc=b}Qqe(b,h){const v=hh.W0.B4b(h)||0;h=hh.W0.J_a(h)||0;const D=b.Width/b.Height;1<=D?(b.Width=v,b.Height=v/D):(b.Height=h,b.Width=h/D)}Arg(b,h,v){if(null!=b&&null!=h&&!G.a.jf(v)){var D=hh.TZc.Z7b(v);
w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?D.tqa=!1:D.tqa=!0;D.hideFloatie=!0;this.Qqe(b,h.node);this.g$b(b,h,!1,!1,D,v)}}Qhb(b){return b?b.Qe:0}Qng(b,h,v){let D=null;const Q=b.node;if(!de.ParagraphReader.Vb(Q)||!Q.isConnected)return{returnValue:!1,Zqa:D};if(v)return{returnValue:!0,Zqa:b};v=b.cpBegin;const ba=b.cpEnd,ta=de.ParagraphReader.text(Q);if(0<=v&&ba<=ta.length&&ta.substring(v,ba)===
h)return{returnValue:!0,Zqa:b};const Ta=ta.indexOf(h);return 0<=Ta?(D=Pe.a.createTextRange(Q,Ta,Ta+h.length),{returnValue:!0,Zqa:D}):0<=v&&ba<=ta.length&&this.k9b(b)?{returnValue:!0,Zqa:b}:{returnValue:!1,Zqa:D}}k9b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Pe.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ue.HyperlinkReader.ND(h,!1);if(1===h.length){h=h[0];const v=de.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==v)return!0}return!1}UGf(b){return null==
b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}C7a(b,h){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const v=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");v&&v.execute(D=>{D.logActivity(b,h)})},hh.uDa)}Dpf(b,h){const v=!G.a.D7(h);switch(b){case 1:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}BGb(b,h,v,D=!1){if(this.iUm(v)){var Q=hh.TZc.Z7b(v);if(Q)if(this.UGf(Q)){u.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Ka.a)(Pe.a,b);var ba=!h;this.x5e(b,ba)?this.ZTc(v)?(h=1===h,D=this.CWl(b),Q.hideFloatie=!0,this.g$b(D,
b,ba,h,Q,v)):this.$Zf(b,h,Q,v,D):hh.uf.JQ(this.ko,2,"URL inserted in Non-Embedable context",hh.uf.zn())}else u.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),hh.uf.JQ(this.ko,2,"Size provided is not valid for OEmbed",hh.uf.zn())}else u.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),hh.uf.JQ(this.ko,2,"URL inserted is not valid for ExternalContent",hh.uf.zn())}CWl(b){const h=new lv;h.Width=
hh.W0.B4b(b.node)||0;h.Height=hh.W0.J_a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}ZTc(b){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=hh.Y8&&hh.Y8.ABi(b)}$Zf(b,h,v,D,Q){const ba=!h,ta=1===h,Ta=hh.W0.B4b(b.node)||0,ob=hh.W0.J_a(b.node)||0,Kb=Ax.a.f9e(v.jng,!0,Ta,ob);this.$Xc(b,D,h,!0);this.Wif.eCh(Kb,Vb=>{hh.uf.U4(this.ko,4,hh.uf.zn());hh.uf.P6c(this.ko,this.Qhb(Vb.data));if(Vb=this.f_f(Vb)){u.ULS.sendTraceTag(592307859,
324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var bc=Bx.q(Vb.MediaType);hh.uf.lce(this.ko,7,bc);bc=b;({Zqa:bc}=this.Qng(b,D,ta)).returnValue?(this.$Xc(bc,D,h,!1),null==v.width?0<Ta&&Vb.Width>Ta&&(u.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Vb.Width=Ta):(u.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),
Vb.Width=this.wbd(v.width,Vb.Width,Ta)),null==v.height?0<ob&&Vb.Height>ob&&(u.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Vb.Height=ob):(u.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Vb.Height=this.wbd(v.height,Vb.Height,ob)),hh.fna.I9a||Q?this.g$b(Vb,bc,ba,ta,v,D):(this.wIb=b,this.xIb=D,this.aIc(D))):(u.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
hh.uf.JQ(this.ko,2,"No conversion as the context is no longer valid for the external content conversion",hh.uf.zn()));ta&&this.OZa(bc.node)}else ta&&this.OZa(b.node),hh.uf.JQ(this.ko,1,"URL not oEmbedable",hh.uf.zn())},Vb=>{hh.uf.U4(this.ko,4,hh.uf.zn());hh.uf.P6c(this.ko,this.Qhb(Vb.data));ta&&this.OZa(b.node);u.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Vb.data.we);hh.uf.JQ(this.ko,2,"ExternalContentEmbedRequest failed",hh.uf.zn())},Vb=>{ta&&this.OZa(b.node);
u.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Vb)},this.ko)}wbd(b,h,v){!b&&0<v&&h>v||b>v?(u.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=v):b>v?h=v:b&&b<v&&(h=b);return h}g$b(b,h,v,D,Q,ba){this.Nl=sb.a.create();b.Width=b.Width/b.Height*(b.Height-(fz.a.TQc+fz.a.k3))+2*fz.a.k3;const ta=new ah.GraphTransaction(15);ta.Cb(h.node);ta.fk=sc.a.HPa;const Ta=this.k9b(h);null!=Q.tqa&&!Q.tqa||
D||Ta||(b.Title=""===Q.title||Q.title?Q.title:b.Title,!b.Title&&""!==b.Title)||(h=this.CAf(h,ta,b.Title,ba,v));if(h){D&&(h=this.kdf(h));var ob=this.AGd(h,D);if(ob){v=Bx.q(b.MediaType);var Kb=this.rRd(b,v);this.foi=b.IFrameHtml;this.goi=b.Title;if(ob=this.lAf(ob,Kb,ta,D,ba,v,b.ProviderName))ta.TFa(this.Nl,1),ta.dispose(),this.wIb=h,this.xIb=ba,this.XWf(Q,b,ob),this.OZf(ba,D||Q.hideFloatie,Ta,v,b.Title)}else ta.dispose(),u.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
hh.uf.JQ(this.ko,2,"Could not create IP context on splitting the paragraph",hh.uf.zn())}else hh.uf.JQ(this.ko,2,"GraphNodeContext is null",hh.uf.zn())}rRd(b,h){const v=new fh.DictionaryPropertySet;hh.TO.K$d(v,b.Width,b.Height);b=this.Cpf(h,b.Title);v.setValue(Gd.a.imageAltText,b);v.setValue(lc.a.mU,ye.a.tF());v.setValue(lc.a.imageType,0);return v}lAf(b,h,v,D,Q,ba,ta){if(!b)return null;b=hh.TO.wWd(b,h);if(!b)return v.dispose(),u.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),
hh.uf.JQ(this.ko,2,"The anchored image could not be inserted",hh.uf.zn()),null;v=b.node;Q=this.sWd(v,Q,ba,ta);hh.uf.lmg(this.ko,Q.id);D||this.aag(v);return v}XWf(b,h,v){G.a.D7(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(hh.uf.U4(this.ko,8,hh.uf.zn()),u.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.SId(v,h.Thumbnail))}OZf(b,h,v,D,Q){h||this.aIc(b);this.C7a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");
this.K8d("IsHyperlinkWithNonURLDisplayText",v);this.ariaNotify(D,Q);hh.uf.U4(this.ko,5,hh.uf.zn())}K8d(b,h){u.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new pa.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.zOb&&hh.uu&&(b=this.Dpf(b,h),hh.uu.sendNotification(b,!0))}CAf(b,h,v,D,Q){if(Q){if((Q=ue.HyperlinkReader.ND(b,
!1))&&1!==Q.length)return h.dispose(),u.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;hh.hyperlinkEditor.HR(Q[0].paragraph,Q[0].hyperlink)}return this.s6f(b,v,D)}kdf(b){const h=b.node,v=de.ParagraphReader.text(h);return 0<v.length&&!v.trim().length?(b=Pe.a.createTextRange(h,0,v.length),hh.characterPropertiesEditor.replaceTextRange(b,""),Pe.a.Rc(h,0)):b}AGd(b,h){return h?b:this.Aqf(b)}Aqf(b){const h=de.ParagraphReader.text(b.node),
v=ne.GraphIterator.$a(b.node);if(v.vd()){b=Pe.a.Rc(b.node,b.cpEnd);ig.OutlineElementNavigator.Vd(v);const D=hh.lg.joa(v);hh.nh.X9(v,D,b,!0,!0,!0,!0);""!=h&&hh.nh.yA(v,!1,!0);v.Qd();return Pe.a.Rc(v.currentNode,0)}return null}f_f(b){if(!({group:b}=bk.a.l1(b.data.we)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}s6f(b,h,v){const D=b.cpBegin+h.length;hh.characterPropertiesEditor.replaceTextRange(b,h);b=Pe.a.createTextRange(b.node,b.cpBegin,D);hh.hyperlinkEditor.hG(b,v,!1);return b}Cpf(b,
h){const v=!G.a.D7(h);switch(b){case 1:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}SId(b,h){b.Bi().contentReplicator.forceOutbound(()=>{this.d_f(h,b)},()=>{u.ULS.sendTraceTag(592996173,
324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}wYc(b){b=ne.GraphIterator.$a(b);b.zb(12);b.jd(12);b.Nn.wQ=!0}OZa(b){b.Efc=null}aag(b){b=ne.GraphIterator.$a(b);b.zb(11)&&(b.jd(11),b.vd()&&b.Rj()&&b.Qd()&&de.ParagraphReader.Vb(b.currentNode)&&(b=Mg.SelectionFactory.ue(b.currentNode,0),Th.a.instance.setSelection(b)))}$Xc(b,h,v,D){const Q=b.cpBegin,ba=b.cpEnd;b=de.ParagraphReader.text(b.node).trim();Q||b!==h&&""!==b?Q?ba===b.length?u.ULS.sendTraceTag(590958601,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Vv[v],D):0<Q&&ba<b.length&&u.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Vv[v],D):u.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Vv[v],D):u.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Vv[v],D)}aIc(b){this.I4b();const h=new Vx.a(1,w.AFrameworkApplication.isRtl);h.f1c=b;hh.sgb.h3c(h)}I4b(){const b=new cu.a(!0);hh.t9.PGa(b)}d_f(b,h){if(b=this.Isf(b,h))h=Array(1),h[0]=b,b=zn.a.construct(h,!1,w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null),h=this.qbf(),
this.aob(h,b)}Isf(b,h){if(!h)return u.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Gp=h.Bi();(new ne.GraphIterator).set(h);if(!h.anchor||!h.anchor.eq||!h.anchor.eq.vr)return u.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var v=h.anchor.eq.vr.node;if(!v)return u.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;v=v.ia(nh.a.CJ,Vm.a.Ft);const D=h.getValue(Gd.a.KK),Q=Cf.a.xf(ke.ImageReader.HC(h.properties),0),ba=Cf.a.xf(ke.ImageReader.JH(h.properties),1);return pD.a.construct(h.id.toString(),b,h.ia(Gd.a.imageAltText,""),Q,ba,h.ia(lc.a.UX,""),v,h.ia(lc.a.mU,0),h.ia(lc.a.lha,!1),h.ia(nh.a.bga,-1),h.ia(lc.a.Ykb,Box4Intl.Box4Strings.l_Picture),h.ia(Gd.a.Hwa,!1),D,h.ia(lc.a.runId,1),h.ia(lc.a.Lc,0))}aob(b,h){w.AFrameworkApplication.Ne.tj(b,2,F.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.Jfc,null,void 0,
void 0,void 0,void 0,"26");u.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}qbf(){let b=ja.a.LMc("PicturePaste.ashx");w.AFrameworkApplication.K&&!w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ja.a.fo(b,Yf.a.fileId,this.Gp.sr));b=ja.a.fo(b,Yf.a.cellId,this.Gp.nm.toString());this.Nl||(this.Nl=sb.a.create(),u.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ja.a.fo(b,Yf.a.lX,this.Nl.toString());
b=ja.a.fo(b,Yf.a.classId,(393233).toString());this.Gp.FH&&(b=ja.a.fo(b,Yf.a.FH,this.Gp.FH));b=ja.a.fo(b,Yf.a.Cqb,"1");b=ja.a.fo(b,Sd.a.imageType,"0");b=yj.a.instance.BZe(b);this.Gp.contentReplicator&&this.Gp.contentReplicator.eIb&&(b=ja.a.fo(b,Yf.a.m3e,"1"));b=ja.a.fo(b,Yf.a.Vta,this.Gp.contentReplicator.Bt.toString());b=ja.a.fo(b,Yf.a.Cfc,"0");return b=ja.a.fo(b,Yf.a.XQb,"1")}static get sgb(){return null!=hh.ayg?hh.ayg:hh.ayg=Ga.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get fna(){hh.rAa||
(hh.rAa=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return hh.rAa}static get t9(){return null!=hh.oFg?hh.oFg:hh.oFg=Ga.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get uu(){return null!=hh.Uvg?hh.Uvg:hh.Uvg=Ga.a.instance.resolve("Common.Utils.IAriaNotifier")}static get W0(){return null!=hh.pGg?hh.pGg:hh.pGg=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get TO(){return null!=hh.NAg?hh.NAg:hh.NAg=Ga.a.instance.resolve("WordEditor.IImageEditor")}static get lg(){return hh.nh||
(hh.nh=Ga.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=hh.FAg?hh.FAg:hh.FAg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=hh.Awg?hh.Awg:hh.Awg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get uf(){return null!=hh.jyg?hh.jyg:hh.jyg=Ga.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get TZc(){return null!=hh.aEg?hh.aEg:hh.aEg=Ga.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get Y8(){return null!=
hh.TDg?hh.TDg:hh.TDg=Ga.a.instance.resolve("Fluid.Host.LoopComponentManager")}}hh.nh=null;hh.uDa=5E3;hh.rAa=null;Object(n.a)(hh,"ExternalContentEditor",null,[177]);var gz=c(259),$s=c(1208);class SC{constructor(b,h){this.I9a=!0;this.H4a=v=>{if(null!=v.result)return v.result.Value;u.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.I9a};this.lGa=v=>{v.zo||v.Ci?u.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.Tyh(v.result),u.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.I9a};this.zv=b;this.zK=h}u6h(){const b=new jh.a;this.CAi()&&this.zK?this.zK.y5a(gz.a.BHc).CWRCo(this.H4a,0).CWRCo(this.lGa,8):b.zg(this.I9a)}r1(b){this.zK&&this.zK.r1(gz.a.BHc,new $s.a(gz.a.BHc,b))}$9n(b){this.CAi()&&(this.zv.$ia("saveConvertExternalContentIsEnabled",b.toString()),u.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.Tyh(b),this.r1(b))}CAi(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser");if(w.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)u.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}Tyh(b){this.I9a=b}}Object(n.a)(SC,"ExternalContentSettingInfo",null,[669]);var KD=c(1143);class ep{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(n.a)(ep,"FluidComponentProperties",
null,[]);class Xq{constructor(){this.loopType=this.Uw=this.d_a=this.url=null;this.mediaType=0;this.AKi=null}}Object(n.a)(Xq,"IFrameProps",null,[]);class Zk{static get W0(){return null!=Zk.nGg?Zk.nGg:Zk.nGg=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get TO(){return Zk.Oj||(Zk.Oj=Ga.a.instance.resolve("WordEditor.IImageEditor"))}static get uu(){return null!=Zk.Tvg?Zk.Tvg:Zk.Tvg=Ga.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=
Zk.zAg?Zk.zAg:Zk.zAg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get lg(){return null!=Zk.uEg?Zk.uEg:Zk.uEg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=Zk.ywg?Zk.ywg:Zk.ywg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static r3a(b){const h=b.startsWith(ue.HyperlinkReader.lgc),v=b.startsWith(ue.HyperlinkReader.k2c),D=b.startsWith(ue.HyperlinkReader.wae);return(h||v||D)&&ue.HyperlinkReader.r3a(b)}static x5e(b,h){let v=
!1;if(b){switch(b.contextId){case Zb.a.Tc:v=!h;break;case Zb.a.Hd:v=!0}v&&!bC.a(b.node)&&(v=!1)}return v}static k9b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Pe.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ue.HyperlinkReader.ND(h,!1);if(1===h.length){h=h[0];const v=de.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==v)return!0}return!1}static Cpf(b,h){const v=!G.a.D7(h);switch(b){case 1:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static wYc(b){b=ne.GraphIterator.$a(b);b.zb(12);b.jd(12);b.Nn.wQ=!0}static rRd(b,h,v,D){const Q=new fh.DictionaryPropertySet;Zk.TO.K$d(Q,h,b);b=Zk.Cpf(D,v);Q.setValue(Gd.a.imageAltText,b);Q.setValue(lc.a.mU,ye.a.tF());Q.setValue(lc.a.imageType,
0);return Q}static sWd(b,h,v){if(!b||!b.isConnected||!ke.ImageReader.Eu(b))return null;const D=new aB.a;D.setValue(Ve.a.F9b,h.mediaType);D.setValue(Ve.a.BPa,h.url);D.setValue(wc.a.loopComponentType,h.loopType);D.d_a=h.d_a;D.Uw=h.Uw;D.providerName=v;D.t3a=1===h.mediaType;D.createMode=h.AKi;ne.GraphIterator.$a(b).Jf(D,2);Zk.wYc(D);return D}static AGd(b,h){return h?b:Zk.Aqf(b)}static Aqf(b){const h=de.ParagraphReader.text(b.node),v=ne.GraphIterator.$a(b.node);if(v.vd()){b=Pe.a.Rc(b.node,b.cpEnd);ig.OutlineElementNavigator.Vd(v);
const D=Zk.lg.joa(v);Zk.lg.X9(v,D,b,!0,!0,!0,!0);""!=h&&Zk.lg.yA(v,!1,!0);v.Qd();return Pe.a.Rc(v.currentNode,0)}return null}static aag(b){b=ne.GraphIterator.$a(b);b.zb(11)&&(b.jd(11),b.vd()&&b.Rj()&&b.Qd()&&de.ParagraphReader.Vb(b.currentNode)&&(b=Mg.SelectionFactory.ue(b.currentNode,0),Th.a.instance.setSelection(b)))}static Dpf(b,h){const v=!G.a.D7(h);switch(b){case 1:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Zk.uu&&(b=Zk.Dpf(b,h),Zk.uu.sendNotification(b,!0))}static K8d(b,h,v){u.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:v,dataFields:[Object.assign(new pa.a,
{name:b,bool:h})]}))}}Object(n.a)(Zk,"ExternalContentHelper",null,[]);var Kt=c(728);class fp{constructor(){this.Nl=this.Gp=null}SId(b,h,v){b.Bi().contentReplicator.forceOutbound(()=>{this.d_f(h,b,v)},()=>{u.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}d_f(b,h,v){if(b=this.Isf(b,h))h=Array(1),h[0]=b,v=zn.a.construct(h,v,w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null),b=this.qbf(),this.aob(b,
v)}Isf(b,h){if(!h)return u.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Gp=h.Bi();(new ne.GraphIterator).set(h);if(!h.anchor||!h.anchor.eq||!h.anchor.eq.vr)return u.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var v=h.anchor.eq.vr.node;if(!v)return u.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;v=v.ia(nh.a.CJ,Vm.a.Ft);const D=h.getValue(Gd.a.KK),Q=Cf.a.xf(ke.ImageReader.HC(h.properties),0),ba=Cf.a.xf(ke.ImageReader.JH(h.properties),1);return pD.a.construct(h.id.toString(),b,h.ia(Gd.a.imageAltText,""),Q,ba,h.ia(lc.a.UX,""),v,h.ia(lc.a.mU,0),h.ia(lc.a.lha,!1),h.ia(nh.a.bga,-1),h.ia(lc.a.Ykb,Box4Intl.Box4Strings.l_Picture),h.ia(Gd.a.Hwa,!1),D,h.ia(lc.a.runId,1),h.ia(lc.a.Lc,0))}aob(b,h){w.AFrameworkApplication.Ne.tj(b,2,F.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.Jfc.bind(this),
null,void 0,void 0,void 0,void 0,"26");u.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){u.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}Jfc(){u.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}qbf(){let b=ja.a.LMc("PicturePaste.ashx");w.AFrameworkApplication.K&&!w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ja.a.fo(b,
Yf.a.fileId,this.Gp.sr));b=ja.a.fo(b,Yf.a.cellId,this.Gp.nm.toString());this.Nl||(this.Nl=sb.a.create(),u.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ja.a.fo(b,Yf.a.lX,this.Nl.toString());b=ja.a.fo(b,Yf.a.classId,(393233).toString());this.Gp.FH&&(b=ja.a.fo(b,Yf.a.FH,this.Gp.FH));b=ja.a.fo(b,Yf.a.Cqb,"1");b=ja.a.fo(b,Sd.a.imageType,"0");b=yj.a.instance.BZe(b);this.Gp.contentReplicator&&this.Gp.contentReplicator.eIb&&(b=ja.a.fo(b,Yf.a.m3e,"1"));
b=ja.a.fo(b,Yf.a.Vta,this.Gp.contentReplicator.Bt.toString());b=ja.a.fo(b,Yf.a.Cfc,"0");return b=ja.a.fo(b,Yf.a.XQb,"1")}}Object(n.a)(fp,"ExternalContentThumbnailHelper",null,[]);class Cx extends fp{constructor(){super(...arguments);this.ko=null}static get uf(){return null!=Cx.iyg?Cx.iyg:Cx.iyg=Ga.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}aJj(b,h,v){return Zk.r3a(h)?Zk.x5e(b,v)?!0:(Cx.uf.JQ(this.ko,2,"URL inserted in Non-Embedable context",Cx.uf.zn()),!1):(u.ULS.sendTraceTag(591267584,
324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Cx.uf.JQ(this.ko,2,"URL inserted is not valid for ExternalContent",Cx.uf.zn()),!1)}}Object(n.a)(Cx,"AbstractExternalContentEditor",fp,[177]);var bF=c(1170),TF=c(1173);class Lt extends Cx{constructor(b){super();Lt.LWa=b;this.CJf()}CJf(){this.zng&&TF.a.CJf(Lt.LWa.a7h())}static get paragraphEditor(){return null!=Lt.TEg?Lt.TEg:Lt.TEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}d$k(b,h){h=this.Nai(b,h);this.gri(h,b,5)}HPa(b,
h,v){if(this.aJj(b,h,v)){var D=this.Nai(b,null);D.url=h;this.gri(D,b,v?0:2)}}G9d(b,h){this.HPa(b,h,!1)}gri(b,h,v){this.Nl=sb.a.create();const D=new ah.GraphTransaction(15);D.Cb(h.node);D.fk=sc.a.IAm;const Q=Zk.k9b(h),ba=Bx.q(b.mediaType),ta=Zk.rRd(b.height,b.width,b.title,ba);h=this.tUo(h,1==v);(h=Zk.Oj.wWd(h,ta))?(h=h.node,Zk.sWd(h,{url:b.url,mediaType:ba,Uw:b.title,loopType:b.type,AKi:v},void 0)||u.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),D.TFa(this.Nl,
1),D.dispose(),this.SId(h,b.thumbnail,!1),this.fEn(Q,ba,b.type)):u.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}tUo(b,h){Zk.characterPropertiesEditor.replaceTextRange(b,"");return Zk.AGd(b,h)}fEn(b,h,v){Zk.K8d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Zk.ariaNotify(h,this.qMl(v))}qMl(b){switch(b){case Kt.a.CheckList:return"Checklist Component";case Kt.a.TaskAssignment:return"Task List Component";case Kt.a.Poll:return"Poll Component";
default:return"Fluid Component"}}Nai(b,h){const v=new ep;v.width=Zk.W0.B4b(b.node)||0;Bx.j()?v.height=null!=Lt.LWa&&Lt.LWa.Z6h(h)||Zk.W0.J_a(b.node)||0:v.height=null!=Lt.LWa&&Lt.LWa.Z6h(h)+2*fz.a.k3||Zk.W0.J_a(b.node)||0;v.title="Fluid Component";v.mediaType="fluid";v.type=h;v.thumbnail=this.DWl();v.url=null!=Lt.LWa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return v}DWl(){return Lt.LWa.a7h()}get zng(){return null!=
this.PIg?this.PIg:this.PIg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static ZTc(b){w.AFrameworkApplication.te("2cejb611;b0jjh576");return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Lt.LWa&&Lt.LWa.ABi(b)&&bF.a.fWk(b)}}Object(n.a)(Lt,"FluidComponentEditor",Cx,[]);class cF{get fyl(){return null!=this.$xg?this.$xg:this.$xg=Ga.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get sMd(){return null!=
this.rzg?this.rzg:this.rzg=Ga.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}$Dn(b,h){b&&(Lt.ZTc(h)?this.sMd.HPa(b,h,!0):this.fyl.HPa(b,h,!0))}}Object(n.a)(cF,"PostHyperlinkAutoCorrectStrategy",null,[667]);class TC{a2b(b,h){h(TC.kEn.test(b))}nhc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new lv,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:TC.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}TC.kEn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");TC.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(n.a)(TC,"PowerBIURLResolver",null,[666,187]);class UC{constructor(b){this.Rjh=b}a2b(b,h){let v=!1;try{if(UC.mSm(b)){const D=this.Rjh.Z7b(b);v=null!=D.width&&null!=D.height&&
!!D.thumbnailUrl&&!!D.title&&null!=D.tqa}}catch(D){}h(v)}nhc(b,h){var v=this.Rjh.Z7b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
v.width,v.height,b);v=Object.assign(new lv,{Height:v.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:v.thumbnailUrl,Title:v.title,Width:v.width});h(v)}static mSm(b){for(const h of UC.TDo)if(b.startsWith(h))return!0;return!1}static M7(){return new UC(Ga.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}UC.TDo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(n.a)(UC,"WedgeComponentExperimentsURLResolver",null,[666,
187]);var cC=c(873);class gp{static Krj(b){gp.dyi||gp.addEventListener();const h=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(b,null)})}static addEventListener(){window.addEventListener(gp.AEo,gp.zEo,!0);gp.dyi=!0}static DYk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click()}}gp.JGo="LoopsTeachingCalloutOnInsertTabActivity";gp.S7m="LoopHomeTabFlightActivity";gp.AEo="switchToInsertTabAndClickLoopButtonEvent";gp.dyi=
!1;gp.zEo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const v=null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.mc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new of.a(0,1,v,()=>{gp.DYk()});null===(h=w.AFrameworkApplication.pc)||void 0===h?void 0:h.Wb(b)};Object(n.a)(gp,"FluidComponentsTUIHelper",null,[]);class oE{constructor(b,h,v){this.ga=b;this.N2j=h;this.Ik=v;this.Z0g=!1;this.p5g=1E3;this.q5g=15E3;this.$Re=this.QRe=!0;this.$Re=!!w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.p5g=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.q5g=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Tb(){this.ga.fb(sc.a.mri,Zb.a.Tc,this.eBm.bind(this),1028);this.ga.fb(sc.a.s$d,Zb.a.Tc,
this.s$d.bind(this),1028);this.ga.fb(sc.a.KSc,Zb.a.Tc,this.pAf.bind(this),1028);this.ga.fb(sc.a.xSc,Zb.a.Tc,this.pAf.bind(this),1028);this.ga.fb(sc.a.xAf,Zb.a.Tc,this.pAf.bind(this),1028);this.ga.fb(sc.a.aFi,Zb.a.Tc,this.ZOj.bind(this),1028)}eBm(){return 32}s$d(b,h,v){if(2!==v)return 32;this.$Re&&(this.R$i(),this.bMo());return 32}pAf(b,h,v){var D,Q,ba;if(1===v){if(!this.sYd(b)||!cC.a.Hwi())return u.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(D=
w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&gp.Krj(gp.JGo);if(!h.el||!We.SelectionEditor.gf(h)||(null===(Q=this.Ik)||void 0===Q?0:Q.j_(h))||(null===(ba=this.Ik)||void 0===ba?0:ba.nha(h)))return 2;if(h&&h.node&&bC.a(h.node))return 32}else if(2===v)return this.N2j.d$k(h,oE.BWl(b)),this.R$i(),32;return 2}bMo(){null!=eb.a.instance.getItem("LoopComponentSurveyShowed")&&(this.QRe=!1);if(this.QRe){let b=this.Mai();window.setTimeout(()=>
{b&&"hidden"!==b.visibility&&(this.Z0g=!0)},this.p5g);this.fgk=window.setTimeout(()=>{const h=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");this.Z0g&&h&&h.execute(v=>{(b=this.Mai())&&"hidden"===b.visibility&&(u.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),v.IHa("WordLoopFeedbackSurvey",null),this.QRe=!1,eb.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.q5g)}}Mai(){var b,h;let v=null;try{const D=document.getElementById("Ribbon-LoopComponentDropdown");
D&&(v=Qk.a.uB(null===(h=null===(b=D.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(D){u.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=D?D.toString():""))}return v}R$i(){this.$Re&&window.clearTimeout(this.fgk)}sYd(b){return b===sc.a.xSc||b===sc.a.KSc?bF.a.sYd():!0}ZOj(b,h,v){2===v&&G.a.yU("https://go.microsoft.com/fwlink/?linkid=2194838")&&Ya.App.H8f.Ylc("https://go.microsoft.com/fwlink/?linkid=2194838");
return 32}static BWl(b){switch(b){case sc.a.KSc:return Kt.a.TaskAssignment;case sc.a.xSc:return Kt.a.CheckList;case sc.a.xAf:return Kt.a.Poll;default:return null}}}Object(n.a)(oE,"FluidComponentsActor",null,[]);class Ej extends Cx{constructor(){super();this.xIb=this.wIb=null;this.Wif=new qD.ExternalContentEmbedRetriever;this.Lsc=null;null!=Ej.fna&&Ej.fna.u6h()}d6i(){this.ko=W.a.create();Ej.uf.oBb(this.ko,4);Ej.uf.U4(this.ko,0,Ej.uf.zn());this.BGb(this.wIb,3,this.xIb,!0)}HPa(b,h,v){this.ko=W.a.create();
Ej.uf.oBb(this.ko,v?0:2);Ej.uf.U4(this.ko,0,Ej.uf.zn());this.Lsc();this.BGb(b,v?0:2,h)}G9d(b,h){this.ko=W.a.create();Ej.uf.oBb(this.ko,1);Ej.uf.U4(this.ko,0,Ej.uf.zn());this.BGb(b,1,h)}b8i(b){this.Lsc=b}Qqe(b,h){const v=Ej.W0.B4b(h)||0;h=Ej.W0.J_a(h)||0;const D=b.Width/b.Height;1<=D?(b.Width=v,b.Height=v/D):(b.Height=h,b.Width=h/D)}Arg(b,h,v){if(null!=b&&null!=h&&!G.a.jf(v)){var D=Ej.TZc.Z7b(v);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?D.tqa=!1:D.tqa=!0;D.hideFloatie=!0;this.Qqe(b,h.node);this.g$b(b,h,!1,!1,D,v)}}Qhb(b){return b?b.Qe:0}Qng(b,h,v){let D=null;const Q=b.node;if(!de.ParagraphReader.Vb(Q)||!Q.isConnected)return{returnValue:!1,Zqa:D};if(v)return{returnValue:!0,Zqa:b};v=b.cpBegin;const ba=b.cpEnd,ta=de.ParagraphReader.text(Q);if(0<=v&&ba<=ta.length&&ta.substring(v,ba)===h)return{returnValue:!0,Zqa:b};const Ta=ta.indexOf(h);return 0<=Ta?(D=Pe.a.createTextRange(Q,Ta,Ta+h.length),{returnValue:!0,Zqa:D}):0<=v&&ba<=ta.length&&
Zk.k9b(b)?{returnValue:!0,Zqa:b}:{returnValue:!1,Zqa:D}}UGf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}C7a(b,h){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const v=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");v&&v.execute(D=>{D.logActivity(b,h)})},Ej.uDa)}BGb(b,h,v,D=!1){if(this.aJj(b,v,!h)){var Q=Ej.TZc.Z7b(v);Q&&(this.UGf(Q)?(u.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),
this.$Zf(b,h,Q,v,D)):(u.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Ej.uf.JQ(this.ko,2,"Size provided is not valid for OEmbed",Ej.uf.zn())))}}$Zf(b,h,v,D,Q){const ba=!h,ta=1===h,Ta=Ej.W0.B4b(b.node)||0,ob=Ej.W0.J_a(b.node)||0,Kb=Ax.a.f9e(v.jng,!0,Ta,ob);this.$Xc(b,D,h,!0);this.Wif.eCh(Kb,Vb=>{Ej.uf.U4(this.ko,4,Ej.uf.zn());Ej.uf.P6c(this.ko,this.Qhb(Vb.data));if(Vb=this.f_f(Vb)){u.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var bc=Bx.q(Vb.MediaType);Ej.uf.lce(this.ko,7,bc);bc=b;({Zqa:bc}=this.Qng(b,D,ta)).returnValue?(this.$Xc(bc,D,h,!1),null==v.width?0<Ta&&Vb.Width>Ta&&(u.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Vb.Width=Ta):(u.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Vb.Width=this.wbd(v.width,Vb.Width,Ta)),null==v.height?0<ob&&Vb.Height>ob&&(u.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Vb.Height=ob):(u.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Vb.Height=this.wbd(v.height,Vb.Height,ob)),Ej.fna.I9a||Q?this.g$b(Vb,bc,ba,ta,v,D):(this.wIb=b,this.xIb=D,this.aIc(D))):(u.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Ej.uf.JQ(this.ko,2,"No conversion as the context is no longer valid for the external content conversion",Ej.uf.zn()));ta&&this.OZa(bc.node)}else ta&&this.OZa(b.node),Ej.uf.JQ(this.ko,1,"URL not oEmbedable",Ej.uf.zn())},Vb=>{Ej.uf.U4(this.ko,4,Ej.uf.zn());Ej.uf.P6c(this.ko,this.Qhb(Vb.data));ta&&this.OZa(b.node);u.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Vb.data.we);Ej.uf.JQ(this.ko,2,"ExternalContentEmbedRequest failed",Ej.uf.zn())},Vb=>{ta&&this.OZa(b.node);
u.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Vb)},this.ko)}wbd(b,h,v){!b&&0<v&&h>v||b>v?(u.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=v):b>v?h=v:b&&b<v&&(h=b);return h}g$b(b,h,v,D,Q,ba){this.Nl=sb.a.create();b.Width=b.Width/b.Height*(b.Height-(fz.a.TQc+fz.a.k3))+2*fz.a.k3;const ta=new ah.GraphTransaction(15);ta.Cb(h.node);ta.fk=sc.a.HPa;const Ta=Zk.k9b(h);null!=Q.tqa&&!Q.tqa||
D||Ta||(b.Title=""===Q.title||Q.title?Q.title:b.Title,!b.Title&&""!==b.Title)||(h=this.CAf(h,ta,b.Title,ba,v));if(h){D&&(h=this.kdf(h));var ob=Zk.AGd(h,D);if(ob){v=Bx.q(b.MediaType);var Kb=Zk.rRd(b.Height,b.Width,b.Title,v);(ob=this.lAf(ob,Kb,D,{url:ba,d_a:b.IFrameHtml,Uw:b.Title,mediaType:v},b.ProviderName))?(ta.TFa(this.Nl,1),ta.dispose(),this.wIb=h,this.xIb=ba,this.XWf(Q,b,ob),this.OZf(ba,D||Q.hideFloatie,Ta,v,b.Title)):ta.dispose()}else ta.dispose(),u.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
Ej.uf.JQ(this.ko,2,"Could not create IP context on splitting the paragraph",Ej.uf.zn())}else Ej.uf.JQ(this.ko,2,"GraphNodeContext is null",Ej.uf.zn())}lAf(b,h,v,D,Q){if(!b)return null;b=Ej.TO.wWd(b,h);if(!b)return u.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Ej.uf.JQ(this.ko,2,"The anchored image could not be inserted",Ej.uf.zn()),null;b=b.node;D=Zk.sWd(b,D,Q);Ej.uf.lmg(this.ko,D.id);v||Zk.aag(b);return b}XWf(b,h,v){G.a.D7(b.thumbnailUrl)||
(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Ej.uf.U4(this.ko,8,Ej.uf.zn()),u.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.SId(v,h.Thumbnail,!1))}OZf(b,h,v,D,Q){h||this.aIc(b);this.C7a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Zk.K8d("IsHyperlinkWithNonURLDisplayText",v,"Office.Word.Online.ExternalContent.OEmbedInsertions");Zk.ariaNotify(D,Q);Ej.uf.U4(this.ko,5,Ej.uf.zn())}CAf(b,h,v,
D,Q){if(Q){if((Q=ue.HyperlinkReader.ND(b,!1))&&1!==Q.length)return h.dispose(),u.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Zk.hyperlinkEditor.HR(Q[0].paragraph,Q[0].hyperlink)}return this.s6f(b,v,D)}kdf(b){const h=b.node,v=de.ParagraphReader.text(h);return 0<v.length&&!v.trim().length?(b=Pe.a.createTextRange(h,0,v.length),Zk.characterPropertiesEditor.replaceTextRange(b,""),Pe.a.Rc(h,0)):b}f_f(b){if(!({group:b}=
bk.a.l1(b.data.we)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}s6f(b,h,v){const D=b.cpBegin+h.length;Zk.characterPropertiesEditor.replaceTextRange(b,h);b=Pe.a.createTextRange(b.node,b.cpBegin,D);Zk.hyperlinkEditor.hG(b,v,!1);return b}OZa(b){b.Efc=null}$Xc(b,h,v,D){const Q=b.cpBegin,ba=b.cpEnd;b=de.ParagraphReader.text(b.node).trim();Q||b!==h&&""!==b?Q?ba===b.length?u.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Vv[v],D):0<Q&&ba<b.length&&u.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Vv[v],D):u.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Vv[v],D):u.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Vv[v],D)}aIc(b){this.I4b();const h=new Vx.a(1,w.AFrameworkApplication.isRtl);h.f1c=b;Ej.sgb.h3c(h)}I4b(){const b=new cu.a(!0);Ej.t9.PGa(b)}static get sgb(){return null!=Ej.byg?Ej.byg:Ej.byg=Ga.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get fna(){Ej.rAa||(Ej.rAa=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Ej.rAa}static get t9(){return null!=Ej.pFg?Ej.pFg:Ej.pFg=Ga.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get W0(){return null!=
Ej.oGg?Ej.oGg:Ej.oGg=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get TO(){return null!=Ej.MAg?Ej.MAg:Ej.MAg=Ga.a.instance.resolve("WordEditor.IImageEditor")}static get TZc(){return null!=Ej.$Dg?Ej.$Dg:Ej.$Dg=Ga.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Ej.uDa=5E3;Ej.rAa=null;Object(n.a)(Ej,"ExternalContentEditorV2",Cx,[]);class pE{constructor(){this.ld=this.W=null}get name(){return"WordEditor.ExternalContent"}get Xb(){return this.ld?
this.ld:this.ld=this.W.resolve("Box4.IFeatureHelper")}xc(b){var h;this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new JD.a(Zn.a.instance,kw.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new cF).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new SC(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Ej).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new Lt(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),
b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new oE(w.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),xi.a.instance)).singleInstance(),(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&gp.Krj(gp.S7m)):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new hh).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Xb.Lp.continueWith(()=>
{this.jn()});w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Tb()}dispose(){}W9k(){const b=new $A;this.dVh()&&b.woh(UC.M7());b.woh(new TC);return b}jn(){null==w.AFrameworkApplication.K||w.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new KD.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();
this.dVh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.W9k()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}dVh(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){N.a.instance.Fc(new pE)}}Object(n.a)(pE,"ExternalContentPackage",null,[1,2]);var hz;
(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.Cbp=7]="bar";b[b.qRa=8]="num"})(hz||(hz={}));Object(n.b)("TabStopValues",hz);class tp{}tp.fPh=8;tp.Uhl=1;tp.f8="wwaengidc";tp.kpiName="WordRuler";tp.precision=.0625;tp.FFo=1;tp.o_o="ShowHideRuler";Object(n.a)(tp,"Constants",null,[]);var rD=c(753);class at{static r8b(b,h){if(!at.zVc)return null;switch(b){case "Left":return v=>
{const D=v.rulerCanvasProps;v=v.indents;return{HIb:0,oNb:D.scale-(D.margins[1].value+v[2].value+Math.max(v[0].value,v[1].value)+8*D.precision)}};case "Right":return v=>{const D=v.rulerCanvasProps;v=v.indents;return{HIb:0,oNb:D.scale-(v[2].value+(D.margins[0].value+Math.max(v[0].value,v[1].value))+8*D.precision)}};case "MoveTableColumn":return()=>{let v=0,D=0;if(0===h){var Q={};32===at.oc.Qb(Eb.a.zgc,2,Q)&&(v=Nf.a.Iz(Q.MinIndent),D=Nf.a.Iz(Q.MaxIndent))}else Q={wo:h-1},32===at.oc.Qb(Eb.a.ygc,2,Q)&&
(v=Nf.a.Iz(Q.MinResize),D=Nf.a.Iz(Q.MaxResize));return{HIb:v,oNb:D}};case "Top":return v=>{v=v.rulerCanvasProps;return{HIb:0,oNb:v.scale-(v.margins[1].value+8*v.precision)}};case "Bottom":return v=>{v=v.rulerCanvasProps;return{HIb:0,oNb:v.scale-(v.margins[0].value+8*v.precision)}}}return null}static FRd(b){if(!at.zVc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var v=h.rulerCanvasProps,D=h.indents,Q=h.ipContextIndex;h=v.margins;var ba=v.scale;v=v.precision;
if("MoveTableColumn"!==h[0].type){Q=h[0].value;h=h[1].value+D[2].value;var ta=Q;"LeftIndent"===b&&(ta+=Math.max(D[0].value,D[1].value));D=-1*Q;v=ba-(ta+h+8*v)}else{ba=0;for(ta=0;ta<=Q;ta++)ba+=h[ta].value;ta=0;if("LeftIndent"===b){ta=D[0].value;const Ta=D[1].value;ba+=Math.max(ta,Ta);ta=Math.max(ta,Ta)}h=h[Q+1].value;ta+=D[2].value;D=-1*ba;v=h-ta-v}return{HIb:D,oNb:v}};case "RightIndent":return h=>{var v=h.rulerCanvasProps,D=h.indents,Q=h.ipContextIndex,ba=v.margins;h=v.scale;v=v.precision;if("MoveTableColumn"!==
ba[0].type){var ta=ba[0].value;ba=ba[1].value;Q=D[0].value;var Ta=D[1].value;D=-1*ba;h-=ta+ba+Math.max(Q,Ta)+8*v}else{ta=0;for(Ta=0;Ta<=Q;Ta++)ta+=ba[Ta].value;ba=ba[Q+1].value;Q=D[0].value;Ta=D[1].value;D=-1*(h-ta-ba);h=ba-Math.max(Q,Ta)-v}return{HIb:D,oNb:h}}}return null}static iam(){return b=>{var h=b.rulerCanvasProps,v=b.indents,D=b.ipContextIndex,Q=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==Q[0].type?(D=Q[0].value,Q=Q[1].value+v[2].value,v=Math.min(v[0].value,v[1].value)+b,b=h-(D+
Q+b)):(h=v[2].value,Q=Q[D+1].value,v=Math.min(v[0].value,v[1].value)+b,b=Q-(h+b));return{HIb:v,oNb:b}}}static get oc(){return null!=at.Kvg?at.Kvg:at.Kvg=w.AFrameworkApplication.va}static get zVc(){null==this.Gab&&(w.AFrameworkApplication.Fha("WoRul910;WoRul910cf"),this.Gab=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.Gab}}at.Gab=null;Object(n.a)(at,"RulerPropertyBoundaryHelper",null,[]);var UF=
c(922),bB=c(1475),py=c(1051),Wv=c(1237),VC=c(1238);class Dx{constructor(b,h,v,D,Q,ba){this.Twn="OutlineContainer";this.Ymk="UpdateCustomTabFailed";this.Pwb="ReadRulerPropertiesFailed";this.bnk="UpdateIndentFailed";this.Gjh="UpdateMarginFailed";this.G7d=ta=>{ta.button===Sys.UI.MouseButton.rightButton&&this.oQe.show(new Sys.UI.Point(ta.clientX,ta.clientY),2)};this.PGj=()=>{this.eUa()};this.Wm=b;this.gXb=h;this.ga=v;this.oQe=D;this.Ty=Q;this.IS=ba;this.pUb=null;this.Jw=!!w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.xJ;this.pVi=this.p7d.bind(this);this.ZXi=this.Ys.bind(this);this.OGj=this.eUa.bind(this)}QB(){this.nZe();this.Boh();this.gXb.zl.Ye(10).Go(this.pVi);lf.a.addHandler(this.TWe,Sc.a.scroll,this.PGj);this.Wm.execute(h=>{h.H0(this.ZXi)});const b=[this.usf(),document.getElementById(pc.AppFrame.Gbd),document.getElementById("PageContentContainer")];this.pUb?this.pUb.register(b,this.OGj):py.a(bB.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.pUb=h.createResizeObserver();
this.pUb.register(b,this.OGj);return null})});Ya.App.xa.GI.registerBoundingWindowRectsChanged("documentPanel",(h,v)=>{"undefined"!==v&&this.U7a([1,0])})}usf(){return 1===this.IS.Wu?this.Ydk:this.xdk}get TWe(){return document.getElementById(pc.AppFrame.rUa)}get xdk(){const b=document.getElementsByClassName(this.Twn);return b&&0<b.length?b[0]:null}get Ydk(){var b=this.Ty.k6b;if(!b)return null;b=this.Iao(de.ParagraphReader.RQ(b));return UF.a.Gci(b)}Iao(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+
b+"']"):null}get yN(){return this.Wm&&this.Wm.instance?this.Wm.instance.hj:tp.Uhl}J7b(){const b={};return 32!==this.ga.Qb(Eb.a.KGa,2,b)?(u.ULS.sendTraceTag(529065947,Wv.a.msoulscat_Wac_WordRuler,VC.a.warning,"Unable to read page properties for Ruler"),Dm.recordQosError(this.Pwb,[Dm.Nea],"Unable to read page properties for Ruler"),null):b}dispose(){this.bni();this.gXb.zl.Ye(10).WU(this.pVi);lf.a.removeHandler(this.TWe,Sc.a.scroll,this.PGj);this.Wm.execute(b=>{b.H5a(this.ZXi)});this.pUb&&this.pUb.dispose();
Ya.App.xa.GI.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.U7a([1,0])})}get Dyi(){null==Dx.EFe&&(Dx.EFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&w.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return Dx.EFe}}Dx.EFe=null;Object(n.a)(Dx,"ARuler",null,[425]);var dA=c(290);class Ur extends Dx{constructor(b,h,v,
D,Q,ba,ta){super(b,h,v,Q,ba,ta);this.bP="HorizontalRuler";this.YMj="CustomTabModificationFromRuler";this.AOj="IndentModificationFromRuler";this.fqe="MarginModificationFromRuler";this.gYg=this.fYg=this._tabStops=null;this.gmn=(Ta,ob,Kb)=>{if(!(Ta>=this._tabStops.length)){Ta=this._tabStops[Ta];var Vb="Modify"===Kb?this.ga.Qb(sc.a.Hdc,2,{["tabStop"]:Ta,["value"]:Nf.a.Hv(ob)}):this.ga.Qb(sc.a.B5a,2,Ta);if(32===Vb){ob=1;var bc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",
Kb,hz[Ta.rda]);u.ULS.sendTraceTag(591213271,3014,50,bc)}else ob=0,bc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Kb,hz[Ta.rda]),u.ULS.sendTraceTag(591213272,3014,15,bc),Dm.recordQosError(this.Ymk,[Dm.Nea],"Unable to modify custom tab using ruler");Qe.a(this.YMj,32===Vb,void 0,[Object.assign(new pa.a,{name:"Operation",string:Kb}),Object.assign(new pa.a,{name:"TabType",int64:hz[Ta.rda]})]);Kb=new Map;Kb.set("Command","OnCustomTabChange");Kb.set("Source",this.bP);
Kb.set("Response",bc);wa.Health.instance.recordKpiUsage(tp.kpiName,ob,tp.f8,Kb)}};this.xon=(Ta,ob)=>{var Kb=new rD.a;Kb.unit=1;Kb.value=Nf.a.Hv(ob);ob=8;switch(Ta){case "FirstLineIndent":ob=this.ga.Qb(Eb.a.j7c,2,Kb);break;case "HangingIndent":ob=this.ga.Qb(Eb.a.k7c,2,Kb);break;case "LeftIndent":ob=this.ga.Qb(Eb.a.f2a,2,Kb);break;case "RightIndent":ob=this.ga.Qb(Eb.a.e2a,2,Kb)}let Vb;32===ob?(Kb=1,Vb=String.format("Indents set using Ruler. Indent: {0}",Ta),u.ULS.sendTraceTag(592517017,3014,50,Vb)):
(Kb=0,Vb=String.format("Unable to set indent using Ruler. Indent: {0}",Ta),u.ULS.sendTraceTag(592496523,3014,15,Vb,Ta),Dm.recordQosError(this.bnk,[Dm.Nea],"Unable to set indent using Ruler."));Qe.a(this.AOj,32===ob,void 0,[Object.assign(new pa.a,{name:"Type",string:Ta})]);Ta=new Map;Ta.set("Command","OnIndentChange");Ta.set("Source",this.bP);Ta.set("Response",Vb);wa.Health.instance.recordKpiUsage(tp.kpiName,Kb,tp.f8,Ta)};this.yUf=(Ta,ob,Kb)=>{let Vb;Vb="Left"===Ta?this.ga.Qb(Eb.a.Tia,2,Nf.a.Hv(ob)):
"Right"===Ta?this.ga.Qb(Eb.a.v6a,2,Nf.a.Hv(ob)):Kb?this.ga.Qb(Eb.a.Cke,2,{["columnIndex"]:Kb-1,["width"]:Nf.a.Hv(ob)}):this.ga.Qb(Eb.a.ajc,2,Nf.a.Hv(ob));32===Vb?(ob=1,Kb=String.format("Margins set using Ruler. Margin: {0}",Ta),u.ULS.sendTraceTag(592517018,3014,50,Kb)):(ob=0,Kb=String.format("Unable to set margins using Ruler. Margin: {0}",Ta),u.ULS.sendTraceTag(592496524,3014,15,Kb),Dm.recordQosError(this.Gjh,[Dm.Nea],"Unable to set margins using Ruler."));Qe.a(this.fqe,32===Vb,void 0,[Object.assign(new pa.a,
{name:"Type",string:Ta})]);Ta=new Map;Ta.set("Command","OnMarginChange");Ta.set("Source",this.bP);Ta.set("Response",Kb);wa.Health.instance.recordKpiUsage(tp.kpiName,ob,tp.f8,Ta)};this.aMa=D;this.lr={}}get kU(){return this.fYg}get IEa(){return this.gYg}renderRuler(){this.kU.classList.remove("HideWACHorizontalRulerContainer");this.kU.classList.add("ShowWACHorizontalRulerContainer");var b=this.J7b();if(b){var h=this.yUf,v=this.xon,D=this.gmn,Q=this.Z$c(),ba=this.sBj(),ta=this.rBj();Q&&ba&&ta||(this.lr.disabled=
!0);this.lr.onIndentChange=v;this.lr.onMarginChange=h;this.lr.onTabChange=D;this.eUa();b=Cf.a.Mi(b.Bo,0);this.IEa.style.width=(b*this.yN).toString()+"px";return this.aMa().then(Ta=>{Ta.renderRuler(this.IEa,this.lr)})}}rBj(){const b=[];var h={};if(32!==this.ga.Qb(sc.a.XLb,2,h))return u.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Dm.recordQosError(this.Pwb,[Dm.Nea],"Unable to read paragraph tabs for Ruler"),!1;var v=h.customTabs;if(!v||0>=v.length)return this.lr.tabs=
b,!0;this._tabStops=v;h="";for(const D of v){switch(D.rda){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}v=Cf.a.Z4a(D.THa,0);b.push({["type"]:h,["value"]:v,["getRulerPropertyBoundary"]:at.iam()})}this.lr.tabs=b;return!0}U7a(b){var h;if(this.kU){this.kU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.lr&&delete this.lr.disabled;for(const v of b)switch(v){case 0:b=this.sBj();const D=this.rBj();b&&D||(this.lr.disabled=
!0);break;case 1:this.Z$c()||(this.lr.disabled=!0)}if(null===(h=this.Ty.kb)||void 0===h?0:h.YTc)this.lr.disabled=!0;this.aMa().then(v=>{v.renderRuler(this.IEa,this.lr);return null})}}Z$c(){const b={};var h=this.J7b();if(!h)return!1;b.scale=Nf.a.Iz(h.Bo);b.precision=tp.precision;b.rulerType="Horizontal";if(!this.ovn())return this.lr.ipContextIndex=0,this.lr.permittedUnits=tp.fPh,h=[{["type"]:"Left",["value"]:Nf.a.Iz(h.marginLeft),["getRulerPropertyBoundary"]:at.r8b("Left",0)},{["type"]:"Right",["value"]:Nf.a.Iz(h.marginRight),
["getRulerPropertyBoundary"]:at.r8b("Right",1)}],b.margins=h,this.lr.rulerCanvasProps=b,!0;var v={};h={};var D=this.ga.Qb(Eb.a.T2c,2,v);const Q=this.ga.Qb(Eb.a.jMb,2,h);if(32!==D||32!==Q)return u.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Dm.recordQosError(this.Pwb,[Dm.Nea],"Unable to read table properties for Ruler"),!1;v=v.ColumnWidths;D=h.TablePosition;if(!D||!v||0>=v.length)return u.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),
Dm.recordQosError(this.Pwb,[Dm.Nea],"Cannot show table properties on the ruler as they are null"),!1;h=Array(v.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Nf.a.Iz(D.x/this.yN),["getRulerPropertyBoundary"]:at.r8b("MoveTableColumn",0)};for(D=0;D<v.length;D+=1)h[D+1]={["type"]:"MoveTableColumn",["value"]:Nf.a.Iz(v[D]),["getRulerPropertyBoundary"]:at.r8b("MoveTableColumn",D+1)};this.lr.ipContextIndex=this.Xdm();this.lr.permittedUnits=tp.FFo;b.margins=h;this.lr.rulerCanvasProps=b;return!0}sBj(){var b=
{};if(32!==this.ga.Qb(Eb.a.m5a,2,b))return u.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),Dm.recordQosError(this.Pwb,[Dm.Nea],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=at.FRd("FirstLineIndent");const v={type:"HangingIndent"};v.getRulerPropertyBoundary=at.FRd("HangingIndent");const D={type:"RightIndent"};D.getRulerPropertyBoundary=at.FRd("RightIndent");const Q={type:"LeftIndent"};Q.getRulerPropertyBoundary=
at.FRd("LeftIndent");this.lr.rtl=b.isRtl;b=b.zt;h.value=1===b.specialIndentType?Nf.a.Iz(b.mda+b.zB):2===b.specialIndentType?Nf.a.Iz(b.zB-b.mda):Nf.a.Iz(b.zB);v.value=Nf.a.Iz(b.zB);Q.value=Nf.a.Iz(b.zB);D.value=Nf.a.Iz(b.foa);this.lr.indents=[h,v,D,Q];return!0}Boh(){lf.a.addHandler(this.kU,Sc.a.Lx,this.G7d)}bni(){this.kU&&(this.kU.classList.remove("ShowWACHorizontalRulerContainer"),this.kU.classList.add("HideWACHorizontalRulerContainer"),lf.a.removeHandler(this.kU,Sc.a.Lx,this.G7d));this.aMa().then(b=>
{b.dispose(this.IEa);return null})}Ys(){this.RGj();this.eUa();this.U7a([1,0])}p7d(b,h){b=h.property;if(b===lc.a.Bo||b===lc.a.marginLeft||b===lc.a.marginRight)this.RGj(),this.eUa(),this.U7a([1])}RGj(){var b=this.J7b();b&&(b=Cf.a.Mi(b.Bo,0),this.IEa.style.width=Math.round(b*this.yN).toString()+"px")}eUa(){window.requestAnimationFrame(()=>{var b=this.usf();b&&(b=Id.a.getElementBounds(b),w.AFrameworkApplication.isRtl?this.IEa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+
"px":this.IEa.style.marginLeft=b.x.toString()+"px")})}Xdm(){const b=ne.GraphIterator.$a(this.Ty.k6b);if(b.zb(14))return b.jd(16),hw.a(b,!0);u.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Dm.recordQosError(this.Pwb,[Dm.Nea],"Unable to read table column index for Ruler");return 0}ovn(){let b=!0;const h=this.Ty.kb.oO();if(null===h)return u.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Dm.recordQosError(this.Pwb,[Dm.Nea],"Unable to get Context Iterator for the Ruler"),
!1;for(;h.moveNext()&&b;){const v=ne.GraphIterator.$a(h.current.node);v.vd();b=b&&rh.TableReader.ex(v)}return b}nZe(){if(!this.IEa&&!this.kU){this.fYg=document.createElement("div");this.kU.id=Ur.o5j;this.kU.className=Ur.n5j;this.kU.setAttribute(Ze.a.pfa,WordEditorIntl.WordEditorStrings.L_Ruler);this.kU.setAttribute(Ze.a.qh,Ze.a.Euh);this.kU.classList.add("HideWACHorizontalRulerContainer");if(this.Dyi){var b=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");const h=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");
Qb.a.xba(b,!h)&&this.kU.classList.add(Ur.Hak)}this.gYg=document.createElement("div");this.IEa.className=Ur.m5j;this.IEa.id=Ur.p5j;this.kU.appendChild(this.IEa);b=null;this.Jw&&((b=Object(dA.a)("EditorBars"))&&b.appendChild(this.kU),this.kU.classList.add("regionComposer"));b||(b=document.getElementById(pc.AppFrame.Gbd),b.insertBefore(this.kU,b.firstChild))}}static WE(){return new Ur(Ga.a.instance.Sa("Common.IZoomManager"),Ya.App.Tj,w.AFrameworkApplication.va,Xj.UISurfaces.lfi,Ga.a.instance.resolve("WordEditor.IRulerContextMenu"),
lr.a.instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Ur.gCg?Ur.gCg:Ur.gCg=Ur.WE()}}Ur.o5j="WACHorizontalRulerContainer";Ur.n5j="WACHorizontalRulerContainer";Ur.p5j="WACHorizontalRuler";Ur.m5j="WACHorizontalRuler";Ur.Hak="ModernUxWACHorizontalRulerContainer";Object(n.a)(Ur,"HorizontalRuler",Dx,[]);var Fj=c(949);class Mt extends Dx{constructor(b,h,v,D,Q,ba,ta){super(b,h,v,Q,ba,ta);this.bP="VerticalRuler";this.fqe="MarginModificationFromRuler";this.vkh=
this.ukh=null;this.yUf=(Ta,ob)=>{let Kb=8;"Top"===Ta?Kb=this.ga.Qb(Eb.a.w6a,2,Nf.a.Hv(ob)):"Bottom"===Ta&&(Kb=this.ga.Qb(Eb.a.u6a,2,Nf.a.Hv(ob)));let Vb;32===Kb?(ob=1,Vb=String.format("Margins set using Ruler. Margin: {0}",Ta),u.ULS.sendTraceTag(529065945,3014,50,Vb)):(ob=0,Vb=String.format("Unable to set margins using Ruler. Margin: {0}",Ta),u.ULS.sendTraceTag(529065946,3014,15,Vb),Dm.recordQosError(this.Gjh,[Dm.Nea],"Unable to set margins using Ruler."));Qe.a(this.fqe,32===Kb,void 0,[Object.assign(new pa.a,
{name:"Type",string:Ta})]);Ta=new Map;Ta.set("Command","OnMarginChange");Ta.set("Source",this.bP);Ta.set("Response",Vb);wa.Health.instance.recordKpiUsage(tp.kpiName,ob,tp.f8,Ta)};this.aMa=D;this.lr={}}get A1(){return this.ukh}get OIa(){return this.vkh}renderRuler(){this.A1.classList.remove("HideWACVerticalRulerContainer");this.A1.classList.add("ShowWACVerticalRulerContainer");var b=this.J7b();if(b){var h=this.yUf;this.Z$c()||(this.lr.disabled=!0);this.lr.onMarginChange=h;this.eUa();b=Cf.a.Mi(b.nv,
1);this.OIa.style.height=(b*this.yN).toString()+"px";this.aMa().then(v=>{v.renderRuler(this.OIa,this.lr);return null})}}U7a(b){var h;if(this.A1){this.A1.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.lr&&delete this.lr.disabled;for(const v of b)switch(v){case 1:this.Z$c()?this.eUa():this.lr.disabled=!0}if(null===(h=this.Ty.kb)||void 0===h?0:h.YTc)this.lr.disabled=!0;this.aMa().then(v=>{v.renderRuler(this.OIa,this.lr);return null})}}Z$c(){const b={},h=this.J7b();if(!h)return!1;b.scale=
Nf.a.Iz(h.nv);b.precision=tp.precision;b.rulerType="Vertical";this.lr.ipContextIndex=0;this.lr.permittedUnits=tp.fPh;b.margins=[{["type"]:"Top",["value"]:Nf.a.Iz(h.marginTop),["getRulerPropertyBoundary"]:at.r8b("Top",0)},{["type"]:"Bottom",["value"]:Nf.a.Iz(h.marginBottom),["getRulerPropertyBoundary"]:at.r8b("Bottom",1)}];this.lr.rulerCanvasProps=b;return!0}Boh(){this.nZe();lf.a.addHandler(this.A1,Sc.a.Lx,this.G7d)}bni(){this.A1&&(this.A1.classList.remove("ShowWACVerticalRulerContainer"),this.A1.classList.add("HideWACVerticalRulerContainer"),
lf.a.removeHandler(this.A1,Sc.a.Lx,this.G7d));this.aMa().then(b=>{b.dispose(this.OIa);return null})}Ys(){this.NGj();this.eUa();this.U7a([1])}p7d(b,h){b=h.property;if(b===lc.a.nv||b===lc.a.marginTop||b===lc.a.marginBottom)this.NGj(),this.eUa(),this.U7a([1])}NGj(){var b=this.J7b();b&&(b=Cf.a.Mi(b.nv,1),this.OIa.style.height=Math.round(b*this.yN).toString()+"px")}eUa(){window.requestAnimationFrame(()=>{var b=this.usf();if(b){const h=Id.a.getElementBounds(b);this.OIa.style.height=h.height.toString()+
"px";b=this.Kfm(b);this.OIa.style.marginTop=b+"px"}})}Kfm(b){b=b.getBoundingClientRect().y;const h=this.TWe.getBoundingClientRect().y;return b-h}nZe(){if(!this.OIa&&!this.A1){this.ukh=document.createElement("div");this.A1.id=Mt.Rnk;this.A1.className=Mt.Qnk;this.A1.setAttribute(Ze.a.pfa,WordEditorIntl.WordEditorStrings.L_Ruler);this.A1.setAttribute(Ze.a.qh,Ze.a.Euh);this.A1.classList.add("HideWACVerticalRulerContainer");if(this.Dyi){var b=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");
const h=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Qb.a.xba(b,!h)&&Sys.UI.DomElement.addCssClass(this.A1,Mt.Iak)}this.vkh=document.createElement("div");this.OIa.className=Mt.Pnk;this.OIa.id=Mt.Snk;this.A1.appendChild(this.OIa);b=document.getElementById(pc.AppFrame.Gbd);b.insertBefore(this.A1,b.firstChild)}}static WE(){return new Mt(Ga.a.instance.Sa("Common.IZoomManager"),Ya.App.Tj,w.AFrameworkApplication.va,Xj.UISurfaces.lfi,Ga.a.instance.resolve("WordEditor.IRulerContextMenu"),
lr.a.instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Mt.fCg?Mt.fCg:Mt.fCg=Mt.WE()}}Mt.Rnk="WACVerticalRulerContainer";Mt.Qnk="WACVerticalRulerContainer";Mt.Snk="WACVerticalRuler";Mt.Pnk="WACVerticalRuler";Mt.Iak="ModernUxWACVerticalRulerContainer";Object(n.a)(Mt,"VerticalRuler",Dx,[]);class Dm{constructor(b,h,v,D,Q,ba,ta,Ta,ob){this.ICe=this.hFe=!1;this.bP="RulerActor";this.Cdh=null;this.Goa=!1;this.uYj="ClearAllTabStopsFailed";this.Pfh="ShowHideRulerFailed";
this.SGe=null;this.tDd=(Kb,Vb,bc)=>{if(1===bc)return 32;Kb=this.ga.processAction(sc.a.IMb,2,null);32===Kb?(bc=1,Vb=String.format("Clear all tab stops from ruler"),u.ULS.sendTraceTag(591213266,3014,50,Vb)):(bc=0,Vb=String.format("Unable to clear all tab stop from ruler"),u.ULS.sendTraceTag(591213267,3014,15,Vb),Dm.recordQosError(this.uYj,[Dm.Nea],Vb));const Dc=new Map;Dc.set("Command","ClearAllTabStops");Dc.set("Source",this.bP);Dc.set("Response",Vb);wa.Health.instance.recordKpiUsage(tp.kpiName,bc,
tp.f8,Dc);return Kb};this.ASc=(Kb,Vb,bc)=>{if(1===bc)switch(Kb){case sc.a.M2e:case sc.a.Icf:return 2;default:return 32}Vb=this.oQe.T9l();switch(Kb){case sc.a.$If:var Dc=1;break;case sc.a.l8f:Dc=4;break;case sc.a.g6e:Dc=3;break;default:return u.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Kb=new fv.a(Vb,Dc,0,1);Kb=this.ga.Qb(sc.a.H6c,2,Kb);32===Kb?(bc=1,Vb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",hz[Dc],Vb.toString()),u.ULS.sendTraceTag(591213269,
3014,50,Vb)):(bc=0,Vb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",hz[Dc],Vb.toString()),u.ULS.sendTraceTag(591213270,3014,15,Vb));Dc=new Map;Dc.set("Command","InsertCustomTabStopRuler");Dc.set("Source",this.bP);Dc.set("Response",Vb);wa.Health.instance.recordKpiUsage(tp.kpiName,bc,tp.f8,Dc);return Kb};this.XOb=(Kb,Vb,bc,Dc,Oc)=>this.hFe||1===bc&&sj.a.kha(Vb.$j)?8:this.Goa?this.XQc(Kb,Vb,bc,Dc,Oc):this.uwo(Vb,bc);this.P8n=()=>{this.Goa?u.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Eb.a.XOb,2)?(u.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Dm.recordQosError(this.Pfh,[Dm.Nea],"Ruler could not be enabled")):u.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.XQc=(Kb,Vb,bc)=>{if(1===bc||!this.Goa)return 32;this.Goa=!1;this.pQe.Xfj(!1);this.dab.dispose();this.R_d()&&this.iff();this.QGj();u.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Kb=new Map;Kb.set("Command","HideRuler");Kb.set("Source",this.bP);Kb.set("Response","");wa.Health.instance.recordKpiUsage(tp.kpiName,1,tp.f8,Kb);return 32};this.kbe=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return 32;Oc&&(Oc[Ff.a.On]=this.Goa);return 32};this.Twm=Kb=>{this.Goa=Kb.result};this.QFb=()=>{this.hFe=!1};this.Rmi=()=>{this.hFe=!0};this.ga=b;this.dab=h;this.GWe=v;this.XRb=D;this.oQe=Q;this.pQe=ba;Dm.Qk=Ta;this.EKa=ta;this.IS=ob;this.EKa.dqh(this.Rmi);this.EKa.vzd(this.QFb)}initialize(){this.Tb();
this.Cdh=this.P8n;window.addEventListener("TurnRulerOnAction",this.Cdh,!0);return this.pQe.ham().continueWith(this.Twm,8)}Tb(){this.ga.qa(Eb.a.XOb,Zb.a.view,this.XOb);this.ga.fb(Eb.a.kbe,Zb.a.view,this.kbe,96);this.ga.qa(sc.a.M2e,Zb.a.view,this.ASc);this.ga.qa(sc.a.g6e,Zb.a.view,this.ASc);this.ga.qa(sc.a.tDd,Zb.a.view,this.tDd);this.ga.qa(sc.a.Icf,Zb.a.view,this.ASc);this.ga.qa(sc.a.XQc,Zb.a.view,this.XQc);this.ga.qa(sc.a.$If,Zb.a.view,this.ASc);this.ga.qa(sc.a.l8f,Zb.a.view,this.ASc);Fj.a.hd.addHandler(Fj.a.h7d,
this.a0c.bind(this));this.IS.gzb(this.mWf)}xqi(){this.Goa&&(this.dab.QB(),this.dab.renderRuler(),this.R_d()&&this.vbj())}vbj(){this.GWe.QB();this.GWe.renderRuler()}iff(){this.GWe.dispose()}R_d(){return this.cDi()&&this.isPaginatedView()}cDi(){null==this.SGe&&null!=w.AFrameworkApplication.K&&(this.SGe=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.SGe}XTa(){this.Goa||Ga.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}aX(){this.EKa.y0n(this.Rmi);this.EKa.xaj(this.QFb);this.Goa&&(this.dab.dispose(),this.R_d()&&this.iff())}QGj(){if(this.XRb){const b={};b[tp.o_o]="ToggleButtonModel";this.XRb.WG(b)}}uwo(b,h){if(!Dm.Qk.s8(b.$j))return u.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Dm.recordQosError(this.Pfh,[Dm.Nea],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Goa=!0;this.pQe.Xfj(!0);this.xqi();this.QGj();
u.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.bP);b.set("Response","");wa.Health.instance.recordKpiUsage(tp.kpiName,1,tp.f8,b);return 32}isPaginatedView(){return 1===this.IS.Wu}a0c(b,h){switch(h.documentMode){case "View":this.Goa&&(this.ga.processAction(Eb.a.XOb,2),this.ICe=!0);break;case "Edit":this.ICe&&(this.ga.processAction(Eb.a.XOb,2),this.ICe=!1)}}mWf(b,h){if(Dm.instance.Goa&&Dm.instance.cDi())switch(h.Alb){case 1:Dm.instance.vbj();
break;case 0:Dm.instance.iff()}}static recordQosError(b,h,v){const D=Object.assign(new wb.a,{extendedProperties:new Map});v&&D.extendedProperties.set("exception",v);wa.Health.instance.recordQosError(b,h,!1,!0,!1,!1,D)}static WE(){return new Dm(w.AFrameworkApplication.va,Ur.instance,Mt.instance,Ya.App.xa,Ga.a.instance.resolve("WordEditor.IRulerContextMenu"),Ga.a.instance.Na("WordEditor.Ruler.IRulerSettingInfo"),Ga.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Zn.a.instance,
Ga.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Dm.iBg?Dm.iBg:Dm.iBg=Dm.WE()}}Dm.Qk=null;Dm.Nea="RulerInteractionFailed";Object(n.a)(Dm,"RulerActor",null,[]);class dF{constructor(b,h){this.hAc=null;this.H4a=v=>v.result?v.result.Value.toString():"";this.lGa=v=>{v.zo||v.Ci?(u.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.hAc=!1):(v=v.result,""===v&&w.AFrameworkApplication.K&&(v=w.AFrameworkApplication.K.jb("RulerDefaultOn")),
this.hAc="true"===v.toLowerCase(),u.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.hAc};this.zv=b;this.zK=h}ham(){const b=new jh.a;if(null==this.hAc){if(this.GAi())return this.zK.y5a(gz.a.I5c).CWRCo(this.H4a,0).CWRCo(this.lGa,8);b.zg(!1)}else b.zg(this.hAc);return b.task}r1(b){this.zK.r1(gz.a.I5c,new $s.a(gz.a.I5c,b))}Xfj(b){this.GAi()&&(this.zv.$ia("saveRulerIsEnabled",b.toString()),u.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.r1(b)}GAi(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser");if(w.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)u.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(n.a)(dF,"RulerSettingInfo",null,[370]);class eF{constructor(){this.AZg=this.W=null}get name(){return"WordEditor.Ruler"}xc(b){this.W=b;u.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new dF(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").Lp.continueWith(()=>{this.jn()});this.AZg=Dm.instance.initialize();u.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}jn(){this.AZg.continueWith(()=>{Dm.instance.xqi();Dm.instance.XTa()});u.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Dm.instance.aX();
u.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(n.a)(eF,"PackageManager",null,[1,2]);class qE{constructor(){this.U9b=this.I0b=null}}Object(n.a)(qE,"CreatePickerCustomizationDictionaryOptions",null,[1260]);class rE{}rE.Xg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(rE,"InsertMediaM365DialogHtml",
null,[]);class sD{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je){this.x3=je;this.L9a=null;this.XCf=this.Tmd=!1;this.Qrj=Ld=>{if(Ld.rawEvent&&(Ld=Ld.rawEvent.data))try{const Qd=Sys.Serialization.JavaScriptSerializer.deserialize(Ld,!0),ge=Qd.MessageId?Qd.MessageId.toString():null;Qd&&ge&&(ge===L.a.insertImage||ge===L.a.hAf)&&this.cyc.start(ge===L.a.insertImage?this.sab:this.LZg)}catch(Qd){}};this.QTo=(Ld,Qd,ge,ze,gg)=>{if(1===ge)return 32;this.s1g?Ld=CommonUIStrings.l_OneDriveName:""!==
this.jkd?Ld=this.jkd:(Ld=CommonUIStrings.l_HostGeneric,u.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));gg[cl.a.LabelText]=Ld;return 32};this.TTo=(Ld,Qd,ge,ze,gg)=>{if(1===ge)return 32;if(!w.AFrameworkApplication.KDf())return gg[cl.a.Visible]=!1,32;this.s1g?Ld=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.jkd?Ld=String.format(CommonUIStrings.l_ChangePictureFromHost,this.jkd):
(Ld=CommonUIStrings.l_ChangePictureFromHostGeneric,u.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));gg[cl.a.LabelText]=Ld;return 32};this.RTo=(Ld,Qd,ge,ze,gg)=>{if(1===ge)return 32;w.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(gg[cl.a.Visible]=!1);return 32};this.STo=(Ld,Qd,ge,ze,gg)=>{if(1===ge)return 32;w.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(gg[cl.a.Visible]=
!1);return 32};this.tie=(Ld,Qd,ge)=>{var ze;Qd=this.xuc.value.Afa(Qd);if(1===ge)return Qd&&this.rab.MLm?32:8;if(2!==ge||!Qd)return 8;(null===(ze=w.AFrameworkApplication.K)||void 0===ze?0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("PictureBing");this.L9a=sb.a.create();u.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Ld=this.c_l(Ld,this.L9a);Ld=this.yYe(Ld);Ld=this.dld.tOc(Ld);Ld.correlationId=
this.L9a;Ld.j$b=this.MZg;Ld.Nha=1;return this.rie(Ld,CommonUIStrings.L_PictureInsertTitle,this.sab)};this.Avo=(Ld,Qd,ge)=>{Ld=32===this.ga.Of(Qd,Eb.a.insertHyperlink,1,!1,null,null);if(1===ge)return Ld&&this.rab.xxi?32:8;if(2!==ge||!Ld)return 8;u.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.rie(this.KZg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.LZg)};this.Brj=(Ld,Qd,ge)=>{Ld=this.xuc.value.Afa(Qd);
if(1===ge)return Ld&&this.rab.JDf?32:8;if(2!==ge||!Ld)return 8;u.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.rie(this.KZg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.sab)};this.pie=(Ld,Qd,ge)=>{var ze;Qd=this.xuc.value.Afa(Qd);if(1===ge)return Qd&&this.rab.OLm?32:8;if(2!==ge||!Qd)return 8;u.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===
(ze=w.AFrameworkApplication.K)||void 0===ze?0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("PictureStock");this.L9a=sb.a.create();ge=w.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.cK.isFreemiumUpsellEnabled();ge=this.Tmd?1:ge?0:-1;Ld=this.N1l(Ld,this.L9a,ge);Ld=this.dld.tOc(Ld);Ld.Xg=rE.Xg;Ld.correlationId=this.L9a;Ld.Nha=2;Ld.j$b=this.MZg;Ld.nfa=this.cK;Ld.mIj=ge;return this.rie(Ld,CommonUIStrings.L_PictureInsertTitle,
this.sab)};this.uie=(Ld,Qd,ge)=>{var ze;Qd=this.xuc.value.Afa(Qd);Ld=Ga.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ge)return Qd&&!this.rab.JDf&&Ld&&Ld.RFf()?32:8;if(2!==ge||!Qd||!Ld)return 8;u.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(ze=w.AFrameworkApplication.K)||void 0===ze?0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("PictureOneDrive");this.L9a=
sb.a.create();ge=sD.qkh;ze=!1;w.AFrameworkApplication.LDf()&&(ze=this.bKl());Qd=new qE;Qd.I0b=ze;Qd.U9b=!0;ge=Ld.kaf(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,ge,"Insert Media",1,Qd);Ld.ZOd(ge).then(gg=>{if(null!=gg&&0<gg.length){const Kg=[];for(let Ll=0;Ll<gg.length;Ll++){const Em=gg[Ll][H.a.S0i],up=gg[Ll][H.a.R0i],nv={};nv.Extension=Em;nv.OriginalUrl=up;nv.caption=Em;Kg.push(nv)}this.sab.JPa=Eb.a.c_;this.sab.p2a(Kg)}});return 32};this.sie=(Ld,Qd,ge)=>{var ze;const gg=this.xuc.value.Afa(Qd);
Qd=Ga.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ge)return gg&&Qd&&Qd.RFf()?32:8;if(2!==ge||!gg||!Qd)return 8;ge=Ga.a.instance.Na("Common.App.PhoneLink.IPhoneLinkManager");null!=ge&&ge.Uzl(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));u.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(ze=w.AFrameworkApplication.K)||void 0===ze?
0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("PictureMobile");this.L9a=sb.a.create();ze=sD.qkh;ge=new qE;ge.I0b=!0;ge.U9b=!0;ze=Qd.kaf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,ze,"InsertPictureFromMobile",3,ge);Qd.ZOd(ze).then(Kg=>{if(null!=Kg&&0<Kg.length){var Ll=[];const Em=Ld===Eb.a.xWd;let up=!1;const nv=w.AFrameworkApplication.K.jb("PhoneLinkServiceEndpoint");for(let hD=0;hD<Kg.length;hD++){const hB=
Kg[hD][H.a.S0i],$D=Kg[hD][H.a.R0i],jz={};jz.Extension=hB;jz.OriginalUrl=$D;jz.caption=hB;Ll.push(jz);up||(up=-1!==jz.OriginalUrl.indexOf(nv))}this.sab.JPa=Eb.a.c_;this.sab.p2a(Ll);Ll={};Ll.InsertImageCount=Kg.length;up&&Qe.c(Em?Eb.a.fBm:Eb.a.TTk,void 0,void 0,void 0,void 0,void 0,Ll)}});return 32};this.cyc=D;this.aqd=Q;this.dld=ta;this.KZg=Ta;this.s2=ob;this.ga=b;this.xuc=ba;this.s1g=Dc;this.jkd=gd;this.rab=v;this.sab=Kb;this.LZg=Vb;this.MZg=rd;(this.cK=bc)&&this.cK.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(Ld=>u.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Ld)).then(Ld=>{(this.Tmd=Ld)||this.cK.eya("MsoPremiumStockImages",()=>{this.Tmd=!0;u.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Tb(){(this.rab.JDf||this.rab.xxi)&&this.rab.NLm&&this.mFn();this.kVn();this.jVn();this.ga.fb(Eb.a.MBh,Zb.a.view,this.Brj,1284);this.ga.fb(Eb.a.t4i,
Zb.a.view,this.TTo,1124);this.ga.fb(Eb.a.rAf,Zb.a.view,this.Brj,1284);this.ga.fb(Eb.a.x1f,Zb.a.view,this.QTo,1124);this.ga.fb(Eb.a.nBm,Zb.a.view,this.Avo,1284)}kVn(){this.ga.fb(Eb.a.insertOnlinePicture,Zb.a.view,this.tie,1284);this.ga.fb(Eb.a.uWd,Zb.a.view,this.pie,1284);this.ga.Cia("word_insertOnlinePictures",Eb.a.insertOnlinePicture,Zb.a.view,this.tie,b=>{Ya.App.xa.smc(b,Object(z.a)(new Je.a,(new Je.a).MDb,"getCommandById"))});this.ga.Cia("word_insertOnlinePictures",Eb.a.uWd,Zb.a.view,this.pie,
b=>{Ya.App.xa.smc(b,Object(z.a)(new Je.a,(new Je.a).MDb,"getCommandById"))});this.ga.fb(Eb.a.p6e,Zb.a.view,this.tie,1284);this.ga.fb(Eb.a.r6e,Zb.a.view,this.uie,1284);this.ga.Cia("word_insertOnlinePictures",Eb.a.r6e,Zb.a.view,this.uie);this.ga.fb(Eb.a.s6e,Zb.a.view,this.pie,1284);this.ga.fb(Eb.a.r4i,Zb.a.view,this.RTo,1284);this.ga.fb(Eb.a.s4i,Zb.a.view,this.STo,1284);this.ga.Cia("word_insertOnlinePictures",Eb.a.p6e,Zb.a.view,this.tie);this.ga.Cia("word_insertOnlinePictures",Eb.a.s6e,Zb.a.view,this.pie);
this.ga.fb(Eb.a.tAf,Zb.a.view,this.uie,1284);this.ga.Cia("word_insertOnlinePictures",Eb.a.tAf,Zb.a.view,this.uie,b=>{Ya.App.xa.smc(b,Object(z.a)(new Je.a,(new Je.a).MDb,"getCommandById"))})}jVn(){w.AFrameworkApplication.LDf()&&(this.ga.fb(Eb.a.xWd,Zb.a.view,this.sie,1284),this.ga.fb(Eb.a.q6e,Zb.a.view,this.sie,1284),this.ga.Cia("mso_insertMobileDevicePictures",Eb.a.xWd,Zb.a.view,this.sie,b=>{Ya.App.xa.smc(b,Object(z.a)(new Je.a,(new Je.a).MDb,"getCommandById"))}),this.ga.Cia("mso_insertMobileDevicePictures",
Eb.a.q6e,Zb.a.view,this.sie,b=>{Ya.App.xa.smc(b,Object(z.a)(new Je.a,(new Je.a).MDb,"getCommandById"))}))}mFn(){w.AFrameworkApplication.ta.get_element().appendChild(this.aqd.l0a);lf.a.addHandler(this.aqd.l0a.contentWindow,"message",this.Qrj);this.XCf=!0}c_l(b,h){let v=0;w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb&&5===w.AFrameworkApplication.ta.Nb.Sl&&(v=12);const D=lk.a.og(w.AFrameworkApplication.lcid);return String.format(w.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,
b===Eb.a.insertOnlinePicture?1:0,w.AFrameworkApplication.lcid,D?D.name:"en-us",w.AFrameworkApplication.buildVersion,h,v,w.AFrameworkApplication.K.jb("UserId"))}rie(b,h,v){try{return b.qie(h,v,void 0),u.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(D){return u.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",D.toString()),this.zp(Nl.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}N1l(b,h,v){if(Eb.a.uWd===b)return b=this.s2.Uxh(w.AFrameworkApplication.K.jb("InsertOnlineM365PictureEndpoint"),h.toString(),1,v),this.yYe(b);b=this.s2.Uxh(w.AFrameworkApplication.K.jb("InsertOnlineM365PictureEndpoint"),h.toString(),0,v);return this.yYe(b)}zp(b,h,v){const D=new pg.StandardDialog(!0);D.yt=w.AFrameworkApplication.$ba;D.Ad=0;D.Ee(1,CommonUIStrings.l_DialogClose);D.mx(b,h,v,()=>{})}bKl(){const b=Ga.a.instance.Na("Common.App.PhoneLink.IPhoneLinkManager");
return null!=b?b.cOl():!1}dispose(){this.XCf&&this.aqd.l0a.contentWindow&&(lf.a.removeHandler(this.aqd.l0a.contentWindow,"message",this.Qrj),this.XCf=!1)}yYe(b){return this.x3&&this.x3.$I?(b=new fb.QueryStringBuilder(b),b.Ce("theme","4"),b.toString()):b}}sD.qkh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(sD,"InsertMediaActor",null,[10]);var WC=c(959);class fF extends WC.a{constructor(b,h){super(b,ja.a.getOrigin(h))}Cq(b,h){this.isEnabled()&&this.Daa(this.k7a)&&(this.Av(b),this.OB(b,
h))}}Object(n.a)(fF,"InsertMediaCrossDocumentMessenger",WC.a,[577,62,10]);class LD{getInstance(b,h){return new fF(b,h)}}Object(n.a)(LD,"InsertMediaCrossDocumentMessengerFactory",null,[540]);var VF=c(759);class MD{}MD.Xg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(MD,"InsertMediaDialogHtml",null,[]);var XC;(function(b){b[b.OK=
0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(XC||(XC={}));Object(n.b)("HubbleAction",XC);var eA;(function(b){b[b.unknown=0]="unknown";b[b.bing=1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(eA||(eA={}));Object(n.b)("InsertMediaProviders",eA);class ND extends Vf.a{constructor(b,h,v,D=null,Q=!1){super(!1,!1,Q);this.Ry=null;this.Nsc=!1;this.oYc=this.k0=null;this.$4e="KeepFocusDiv";this.aCd="KeepFocusStartDiv";this.correlationId=
null;this.Nha=0;this.nfa=this.j$b=null;this.mIj=0;this.AIe=null;this.Jon=()=>{this.k0&&(this.k0.style.visibility="visible",window.setTimeout(()=>{if(this.ej){const ba=this.ej.getElementById(this.aCd);ba&&ba.focus()}},0))};this.nca=ba=>{ba.keyCode===Sys.UI.Key.tab&&(ba.target.id!==this.$4e||ba.shiftKey?ba.target.id===this.aCd&&ba.shiftKey&&(ba.preventDefault(),this.ej.getElementById(this.$4e).focus()):(ba.preventDefault(),this.ej.getElementById(this.aCd).focus()))};this.LSi=()=>{u.ULS.sendTraceTag(17662422,
352,100,"OnCancelDialog : Got message.");this.JCb(this.vZa);this.bob(1)};this.ITf=()=>{this.Ry&&(u.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Ry.sendMessage(L.a.dkj,{["CustomHeaders"]:""}))};this.bUi=()=>{this.Ry&&(u.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Ry.sendMessage(L.a.imo,{["SessionId"]:w.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.ZTi=()=>{this.Ry&&(u.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),
this.Ry.sendMessage(L.a.wfo,{["CID"]:""}))};this.dpn=()=>{this.nfa&&(u.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.nfa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.eld=b;this.UTb="";this.s2=v;this.Pea=[];this.nrd=h;this.Xg=D||MD.Xg;this.wg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async qie(b,h){this.UTb=
b;this.Nsc=!1;this.showDialog(this.UTb,null);this.k0=this.n7b(this.kj("insertmediaframe"));if(!this.k0)throw this.JCb(this.vZa),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.aCd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.k0.parentNode.insertBefore(b,this.k0.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.$4e);
b.setAttribute("tabindex","0");this.k0.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.Xdf,"keydown",this.nca);this.k0.src=this.eld;this.k0.style.width="100%";this.k0.style.height="100%";this.k0.frameBorder="0";w.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&aa.a.jj?(this.k0.style.visibility="hidden",this.oYc=this.Jon,lf.a.addHandler(this.k0,"load",this.oYc)):this.k0.style.visibility=
"visible";this.n7b(this.kj("WACDialogButtonPanel")).style.display="none";this.n7b(this.kj("WACDialogTitleText")).style.display="none";2===this.Nha&&(this.n7b(this.kj("WACDialogTitlePanel")).style.display="none",this.n7b(this.kj("WACDialogBodyPanel")).style.padding="0");$c.FocusManager.instance().Ss().scope.TH=!0;this.Ry=this.nrd.getInstance(this.k0.contentWindow,this.eld);this.Ry.Daa("https://osiziwuspersimmon002.blob.core.windows.net");this.Ry.Daa("https://osizewuspersimmon001.blob.core.windows.net");
this.Ry.Daa("https://osizpscuspersimmon000.blob.core.windows.net");this.Ry.Daa("https://cdn.hubblecontent.msit.osi.office.net");this.Ry.Daa("https://cdn.hubblecontent.osi.office.net");this.Ry.Cq(L.a.Mnh,v=>{this.aSi(v,Object(z.a)(h,h.p2a,"insertMediaCallback"))});this.Ry.Cq(L.a.insert,v=>{this.T6d(v,Object(z.a)(h,h.p2a,"insertMediaCallback"))});this.Ry.Cq(L.a.etk,v=>{this.lqn(v)});this.Ry.Cq(L.a.T6h,this.ITf);this.Ry.Cq(L.a.getSessionId,this.bUi);this.Ry.Cq(L.a.B4h,this.ZTi);this.Ry.Cq(L.a.tCd,this.LSi);
2!==this.Nha||this.mIj||(this.Ry.Cq(L.a.CXm,this.dpn),this.AIe=this.nfa.eya("MsoPremiumStockImages",v=>{u.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Ry.sendMessage(L.a.TYo,{["LicenseTier"]:v.toString()})}));this.bob(3)}dispose(){this.nfa&&this.AIe&&this.nfa.Vgc("MsoPremiumStockImages",this.AIe);this.Ry&&(this.Ry.dispose(),this.Ry=null);this.oYc&&(lf.a.removeHandler(this.k0,"load",this.oYc),this.oYc=null);super.dispose()}aSi(b,h){u.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.s2.Szn(b))this.Pea.push(b),this.Nsc&&(h(this.Pea),this.Nsc=!1)}zp(){const b=new pg.StandardDialog(!0);b.yt=w.AFrameworkApplication.$ba;b.Ad=0;b.Ee(1,CommonUIStrings.l_DialogOk);b.Ju(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}bob(b){var h=RegExp("hubble","gi");if(this.j$b&&0<this.j$b.search(h)&&this.correlationId){h=w.AFrameworkApplication.sessionStartInfoSettings;var v={};v.InsertedFiles=this.Pea.length;
v.MediaDetails=this.Pea;v.DialogResult=XC[b];v.DialogMode=this.Arf();v.CorrelationId="{"+this.correlationId.toString()+"}";v.Platform="Wac";v.Provider=eA[this.Nha]||"Unknown";v.AudienceGroup=h&&"AudienceGroup"in h?h.AudienceGroup.toString():"Unknown";v.Ring=h&&"Ring"in h?h.Ring.toString():"Unknown";v.AppId=2;v.Build=w.AFrameworkApplication.buildVersion;v.Locale=lk.a.og(w.AFrameworkApplication.lcid).name;this.rFn().send(JSON.stringify(v))}2===this.Nha&&(v=w.AFrameworkApplication.K.jb("InsertMediaDialogAriaTenantNameSpace"))&&
""!==v&&(h=[],h.push(Object.assign(new pa.a,{name:"InsertedFiles",int64:this.Pea.length})),h.push(Object.assign(new pa.a,{name:"MediaDetails",string:JSON.stringify(this.Pea)})),h.push(Object.assign(new pa.a,{name:"DialogResult",string:XC[b]})),h.push(Object.assign(new pa.a,{name:"DialogMode",string:this.Arf()})),h.push(Object.assign(new pa.a,{name:"CorrelationId",string:this.correlationId.toString()})),h.push(Object.assign(new pa.a,{name:"Provider",string:eA[this.Nha]||"Unknown"})),fa.a.sendTelemetryEvent(Object.assign(new ra.a,
{name:String.format("{0}.{1}",v,this.telemetryEventName),dataFields:h})))}Arf(){return 3===this.Nha?"Icons":5===this.Nha?"ExternalContent":"Images"}n7b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}rFn(){const b=new XMLHttpRequest;b.open("POST",this.j$b,!0);b.setRequestHeader("Content-Type","");return b}T6d(b,h){u.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.JCb(this.vZa);h?this.Pea&&50<this.Pea.length?(this.zp(),
this.bob(0),u.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Pea.length,eA[this.Nha])):this.Pea&&0<this.Pea.length?(h(this.Pea),this.bob(0),u.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Pea.length,eA[this.Nha])):(u.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Nsc=!0,h(this.Pea),this.bob(2)):this.bob(2)}lqn(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,
u.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),fa.a.sendOtelEvent(Object.assign(new VF.a,{otelEvent:b})))}}Object(n.a)(ND,"InsertMediaDialog",Vf.a,[539,10]);class fA{constructor(b,h){this.cEe=b;this.s2=h}tOc(b,h=!1){return new ND(b,this.cEe,this.s2,MD.Xg,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(fA,"InsertMediaDialogFactory",null,[537]);class su{constructor(b,h,v){this.mui=!1;this.correlationId=null;this.Nha=0;this.j$b=null;this.t5j=b;this.vCc=[];this.kkd=
h;this.khh=v.split(";")}async qie(b,h){Array.clear(this.vCc);b=this.t5j.value;b.Daa(this.kkd);b.Av(h.hRc);this.mui||(b.OB(h.hRc,v=>{this.T6d(v,h)}),this.mui=!0);u.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.pNh,{["FileExtensionFilterList"]:this.khh})}jvk(b){Array.contains(this.vCc,b)||this.vCc.push(b)}T6d(b,h){u.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.E_i(b);const v=
[];for(let D=0;D<b.length;D++){const Q=b[D];h.lYd(Q,this.khh)?v.push(Q):this.jvk(h.Qei(Q))}v&&v.length?h.p2a(v):u.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.vCc.length&&(h=this.vCc.join(", "),u.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.$wo(h))}$wo(b){const h=new pg.StandardDialog;h.Ad=0;h.fV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
b),null)}dispose(){}}Object(n.a)(su,"InsertMediaFromHostManager",null,[539,10]);class Zj{constructor(b){this.C6j=b}tOc(){throw Error.notImplemented();}getInstance(){return this.C6j}}Object(n.a)(Zj,"InsertMediaFromHostManagerFactory",null,[536,537]);class gF{constructor(){this.l0a=document.createElement("iframe");this.l0a.src="about:blank";this.l0a.style.visibility="hidden";this.l0a.style.position="absolute";this.l0a.style.zIndex="-100"}}Object(n.a)(gF,"InsertMediaFromHostOneDriveHostFrame",null,[538]);
class hF extends WC.a{constructor(b,h){super(b,"*"===h?h:ja.a.getOrigin(h));this.Pmh(L.a.insertImage);this.Pmh(L.a.hAf)}Ede(){}}Object(n.a)(hF,"InsertMediaFromOneDriveCrossDocumentMessenger",WC.a,[61,62,10]);class OD{}Object(n.a)(OD,"OnlineMediaSearchResult",null,[]);class YC{Uxh(b,h,v,D){const Q=lk.a.og(w.AFrameworkApplication.lcid).name,ba=w.AFrameworkApplication.buildVersion,ta=G.a.YW(w.AFrameworkApplication.K.jb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ta=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;w.AFrameworkApplication.te("ShIns226;ShIns226cf");return String.format(b,w.AFrameworkApplication.lcid,Q,ba,h,YC.are,ta,D,v,Ta)}return String.format(b,w.AFrameworkApplication.lcid,Q,ba,h,YC.are,ta,D,v)}Szn(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new OD,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",
ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}Tzn(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let D=0;D<b.length;D++){var v=b[D];v&&(v=Object.assign(new OD,{Type:v.Extension||"",OriginalUrl:v.SourceUrl||"",Caption:v.caption,Height:v.Height||0,Width:v.Width||0}),h.push(v))}return h}eYf(b){const h=
[];for(let D=0;D<b.data.files.length;D++){var v=b.data.files[D];v&&(v=Object.assign(new OD,{ContentType:v.itemType||"",Type:v.extension||"",OriginalUrl:v.urls&&v.urls.open?v.urls.open:"",Height:v.photo?v.photo.height:0,Width:v.photo?v.photo.width:0}),h.push(v))}return h}lYd(b,h){if(!b)return!1;for(let v=0;v<h.length;v++)if(0<=b.toLowerCase().indexOf(h[v]))return!0;return!1}hFn(b){let h="";if(b)for(let v=0;v<b.length;v++){const D=b[v];D&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',
D.OriginalUrl,D.Width,D.Height))}return h}}YC.are=0;Object(n.a)(YC,"InsertMediaHelper",null,[535]);class iF{constructor(b,h,v,D,Q){this.MLm=b;this.JDf=h;this.xxi=v;this.NLm=D;this.OLm=Q}}Object(n.a)(iF,"InsertMediaSettingsManager",null,[]);class tD{constructor(b){this.Huc=Eb.a.insertHyperlink;this.ga=b}get JPa(){return this.Huc}set JPa(b){this.Huc=b}p2a(b){try{u.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Qb(this.JPa,
2,b[h]);u.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){u.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(n.a)(tD,"InsertOneDriveFileHandler",null,[376]);class jF extends tD{constructor(b){super(b)}get pNh(){return L.a.hAf}get hRc(){return L.a.GAm}E_i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}Qei(){Lc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}lYd(){return!0}C3i(b,h,v){b=v(b);b.length&&(v={},v.Items=b,h.sendMessage(this.hRc,v))}G_i(b){const h=[];for(let v=0;v<b.data.files.length;v++){const D=b.data.files[v];if(D){const Q={};Q.DisplayText=String.format("{0}{1}",D.name,D.extension);Q.Url=this.SDl([D.urls.viewInBrowser,D.urls.open,D.urls.download]);h.push(Q)}}return h}SDl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];u.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(n.a)(jF,
"InsertOneDriveFileHelper",tD,[375,376]);class sE{constructor(b,h,v){this.Huc=Eb.a.c_;this.Rp=null;this.ga=b;this.s2=h;this.Vea=v}get oc(){return this.ga}get uu(){return this.Rp||(this.Rp=Ga.a.instance.resolve("Common.Utils.IAriaNotifier"))}get JPa(){return this.Huc}set JPa(b){this.Huc=b}p2a(b){try{u.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.s2.hFn(b);let v=2;if(h&&0<h.length){const D=new fh.DictionaryPropertySet;
D.setValue(wc.a.jP,h);D.setValue(wc.a.e4,!0);if(this.Vea){const Q=this.Vea.$8c();Q.X0b("insertOnlineImage");D.setValue(wc.a.fua,Q)}v=this.ga.Qb(this.JPa,2,D)}u.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===v,""===h)}catch(h){u.ULS.eD(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(n.a)(sE,"InsertOnlineImageHandler",null,[376]);class PD extends sE{constructor(b,
h,v=null){super(b,h,v)}get pNh(){return L.a.insertImage}get hRc(){return L.a.UAm}E_i(b){return this.s2.Tzn(b)}Qei(b){return b.Type}lYd(b,h){return this.s2.lYd(b.Type,h)}G_i(b){return this.s2.eYf(b)}C3i(b,h,v){v=v(b);if(v.length){b=[];for(let D=0;D<v.length;D++){const Q=v[D],ba={};ba.Extension=Q.Type;ba.SourceUrl=Q.OriginalUrl;ba.caption=Q.Type;ba.SourceUrl=Q.OriginalUrl;ba.Width=Q.Width;ba.Height=Q.Height;b.push(ba)}v={};v.Items=b;h.sendMessage(this.hRc,v)}}}Object(n.a)(PD,"InsertOnlineImageHelper",
sE,[375,376]);class kF{constructor(b,h){this.ktb=b;this.nrd=h}start(b){this.ktb.start({mode:"open",select:"multi",lightbox:"white"},(h,v)=>{this.processResponse(h,v,b)})}processResponse(b,h,v){u.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.nrd.getInstance(window.frames[0].parent,window.document.URL),v.C3i(h,b,D=>v.G_i(D))):u.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(n.a)(kF,"OneDriveFilePickerHelperV5",null,[371]);class lF{constructor(){this.cld=this.W=null}get name(){return"Box4.Media"}xc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new gF).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const h=new iF(Boolean.parse(w.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),w.AFrameworkApplication.KDf(),
!1,w.AFrameworkApplication.zdg(),w.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new kF(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new sD(w.AFrameworkApplication.va,w.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Fg.a(()=>Ga.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),w.AFrameworkApplication.QHb,w.AFrameworkApplication.Woa,
w.AFrameworkApplication.Osm,w.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new fA(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new Zj(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new su(new Fg.a(()=>{if(w.AFrameworkApplication.zdg()){var v=Ga.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").l0a;v=new hF(v.contentWindow,"*")}else v=w.AFrameworkApplication.PX;return v}),w.AFrameworkApplication.zdg()?ja.a.getOrigin(window.document.URL):ja.a.getOrigin(w.AFrameworkApplication.ALb),w.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(LD,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(YC,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new PD(w.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new jF(w.AFrameworkApplication.va)).singleInstance()}init(){this.cld=this.W.resolve("Box4.Media.InsertMediaActor");this.cld.Tb()}dispose(){this.cld&&this.cld.dispose()}}Object(n.a)(lF,"MediaPackage",null,
[1,2]);var QD=c(344);class qy{constructor(){this.i8n="getAddinShortcutsPreference";this.j8n="saveAddinShortcutsPreference";this.k8n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.EKl=6E4;this.f5d=this.Ima=this.V9=null}Yei(b){return String.format(this.k8n,w.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,w.AFrameworkApplication.hm)}executeRequest(b,h,v,D,Q=null){return qy.sQ.k0b(b,h,Q,null,v,D,!1,null,this.EKl)}saveSetting(b,h,v,D,Q){return this.Yfj(b,h,v,null,D,
Q)}startBatchUpdateScope(){this.f5d=[]}saveShortcutInfoArrayBatch(b,h,v){this.o$n(v,b,h)}o$n(b,h,v){const D={action:"",addinId:"",ownerType:0};D.timestamp=(new Date).toUTCString();const Q=this.getShortcutInfoArray(h.toString(),v.toString());b?(D.shortcutInfoArray=b,this.xYe(h,v,b)):Q&&(D.shortcutInfoArray=Q);b={};b[h.toString()]=D;h=new QD.a(v.toString(),b);this.f5d.push(h)}commitBatchUpdateScope(){return this.b8c()?this.q$n().then(()=>{this.M1b();return Promise.resolve(!0)}):this.s$n().then(()=>
{this.M1b();return Promise.resolve(!0)})}q$n(){return this.getSetting().then(b=>{let h=null;if(b&&!({Yu:h}=F.d(b)).returnValue)return u.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const v of this.f5d){(b=h[v.key])||(b={});const D=v.value;for(const Q of lb.a.HO(D))b[Q]=D[Q];h[v.key]=b}this.V9=h;try{return localStorage.setItem("AddinShortcutPreferenceData",F.c(h)),Promise.resolve(!0)}catch(v){return u.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",v),Promise.resolve(!1)}})}s$n(){return this.keo().then(b=>this.Qee(b))}keo(){return this.Ntf().then(b=>{let h=null;b&&(({Yu:h}=F.d(b)).returnValue||u.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const v of this.f5d){(b=h[v.key])||(b={});const D=v.value;for(const Q of lb.a.HO(D))b[Q]=D[Q];h[v.key]=b}this.V9=h;return F.c(h)})}saveShortcutInfoArray(b,h,v){return this.Yfj(0,
"","",v,b,h)}Yfj(b,h,v,D,Q,ba){const ta=this.b8c(),Ta={};Ta.action=v;Ta.addinId=h;Ta.ownerType=b;Ta.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(Q.toString(),ba.toString());0===b&&D?(Ta.shortcutInfoArray=D,this.xYe(Q,ba,D)):h&&(Ta.shortcutInfoArray=h);b={};b[Q.toString()]=Ta;Q=new QD.a(ba.toString(),b);return ta?this.p$n(Q):this.r$n(Q)}p$n(b){return this.getSetting().then(h=>{let v=null;if(h&&!({Yu:v}=F.d(h)).returnValue)return u.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);v||(v={});v[b.key]=b.value;this.V9=v;try{return localStorage.setItem("AddinShortcutPreferenceData",F.c(v)),Promise.resolve(!0)}catch(D){return u.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",D),Promise.resolve(!1)}})}r$n(b){return this.jeo(b).then(h=>this.Qee(h))}jeo(b){return this.Ntf().then(h=>{let v=null;h&&(({Yu:v}=F.d(h)).returnValue||u.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
v||(v={});v[b.key]=b.value;this.V9=v;return F.c(v)})}saveSettings(b){this.V9=F.a(b);this.M1b();return this.b8c()?this.agj(b):this.Qee(b)}agj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return u.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}Qee(b){const h={};h.Wac=b;const v=F.c(h);return new Promise(D=>{try{if(void 0===v||null===v||!v.length||1E6<=v.length)D(!1);else{var Q=this.executeRequest(this.Yei(this.j8n),
2,"SaveAddinShortcutsPreferenceRequest","38",v);Q.continueWith(()=>{if(Q.zo||Q.Ci)u.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),D(!1);else{var ba=Q.result;void 0!==ba.args&&null!==ba.args&&void 0!==ba.args.data&&null!==ba.args.data&&ba.args.data.Qe===ha.a.Jy?D(!0):D(!1)}})}}catch(ba){u.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ba.toString()),D(!1)}})}getSetting(){const b=this.b8c();return this.V9?Promise.resolve(F.c(this.V9)):
b?this.Ebm():this.Ntf()}b8c(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser"),h=w.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}Ebm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return u.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}Ntf(){return new Promise((b,h)=>{try{const v=this.executeRequest(this.Yei(this.i8n),1,"GetSettingRequest","37");v.continueWith(()=>{if(v.zo||
v.Ci)u.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let Q="";var D=v.result;D&&D.args&&D.args.data?D.args.data.Qe!==ha.a.Jy?u.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",D.args.data.Qe):D.args.data.we?(D=F.a(D.args.data.we),D.Wac&&(Q=D.Wac)):u.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):u.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(Q)}})}catch(v){u.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",v.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.b8c(),v=this;return this.getSetting().then(D=>{let Q=null;D&&(Q=F.a(D));if(!Q)return u.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const ba of lb.a.HO(Q)){D=Q[ba.toString()];for(const ta of lb.a.HO(D)){const Ta=D[ta];if(Ta.addinId===b)delete D[ta.toString()];else if(0===Ta.ownerType&&
Ta.shortcutInfoArray){const ob=Ta.shortcutInfoArray,Kb=new zb.a;for(let Vb=0;Vb<ob.length;++Vb)ob[Vb].addinId!==b&&Kb.add(ob[Vb]);Ta.shortcutInfoArray=Kb.toArray()}}lb.a.count(D)||delete D[ba]}v.V9=Q;v.zYn(b);return h?v.agj(F.c(Q)):v.Qee(F.c(Q))})}M1b(){if(this.V9){this.Ima=null;const v=this.V9;for(let D in v){var b=D;const Q=v[D];for(let ba in Q){var h=ba;const ta=Q[ba];ta.shortcutInfoArray&&this.xYe(parseInt(h),parseInt(b),ta.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let h=null;if(b&&!({Yu:h}=F.d(b)).returnValue)return u.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.V9=h;this.M1b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,v){return this.V9&&(v=this.V9[v])&&(h=v[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.V9&&(h=this.V9[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
h,v){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),v)}setShortcutInfoArray(b,h,v){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),v).then(()=>{this.M1b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Ima)return Promise.resolve(!0);var v=this.Ima[b];if(!v)return Promise.resolve(!0);var D=v[h];v=D.modifiers;D=D.keyCode;const Q=this.getShortcutInfoArray(v.toString(),D.toString());if(!Q||!Q.length)return Promise.resolve(!0);let ba=0;for(const ta of Q){if(ta.addinId===
b&&ta.action===h)break;++ba}if(ba>=Q.length)return Promise.resolve(!0);Q.splice(ba,1);return this.saveShortcutInfoArray(v,D,Q).then(()=>{this.M1b();return Promise.resolve(!0)})}xYe(b,h,v){this.Ima||(this.Ima={});for(const D of v){v=D.addinId;const Q=D.action;let ba=this.Ima[v];ba||(ba={});const ta={};ta.modifiers=b;ta.keyCode=h;ba[Q]=ta;this.Ima[v]=ba}}zYn(b){b in this.Ima&&delete this.Ima[b]}isActionCustomized(b,h){return this.Ima&&(b=this.Ima[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,
h){return this.Ima&&(b=this.Ima[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.V9}static instance(){qy.B_e||(u.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),qy.B_e=new qy,qy.sQ=w.AFrameworkApplication.Ne);return qy.B_e}}qy.B_e=null;qy.sQ=null;Object(n.a)(qy,"AddinShortcutsPreferenceSettingHelper",null,[]);class mF{constructor(b,h){this.pgd=null;new zb.a;this.B0g=!0;this.Ejd=b;this.NWg=h}NZe(b){this.NWg.addHandler("GoalChangedEvent",b)}whn(){this.NWg.raiseEvent("GoalChangedEvent")}iCf(b,
h){return this.pgd&&this.B0g?b in this.pgd?this.pgd[b]:"Formality"===h&&this.Ejd.Dtf().formality?!1:!0:!0}bgo(b,h){h===this.Ejd.Dtf().formality&&(this.pgd=b,this.whn())}rUo(b){this.B0g=b}}Object(n.a)(mF,"GoalChangeSource",null,[596,597,598]);var RD=c(982),uD=c(919),WF=c(695);class dC{constructor(b,h,v,D,Q,ba){this.yKa=h;this.yAa=v;this.Te=b;this.dA=D;this.Bg=Q;this.D4j=ba;this.yAa.hHb()&&this.initialize()}initialize(){return this.dA.$k().then(()=>{this.Te.mb(this,RD.a.getTypeName());this.Te.addHandler(this,
uD.a.getTypeName())}).catch(b=>{this.Bg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}PC(b,h){if(h===Ha.a.getTypeName()||h===WF.a.getTypeName())if(!b||!b.content)this.Bg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(ic.a.getTypeNameFor(b.content)===RD.a.getTypeName()||ic.a.getTypeNameFor(b.content)===uD.a.getTypeName())if(ic.a.getTypeNameFor(b.content)===RD.a.getTypeName()){var v=b.content;this.Bg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",v.critiqueConfiguration.formalityGoal);this.yKa.bgo(v.critiqueConfiguration.mapping,v.critiqueConfiguration.formalityGoal)}else if(ic.a.getTypeNameFor(b.content)===uD.a.getTypeName())if(b=b.content,b.features){for(v of b.features)if("Goals"===v.featureName){this.D4j.rUo(!!v.supportType);return}this.Bg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Bg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(n.a)(dC,"GoalsAnnotationHandler",null,[52]);class vD{constructor(b){this.Ma=b}hHb(){return this.Ma.$("EditorGoalsEnabled")}}Object(n.a)(vD,"GoalsGate",null,[595]);var ZC=c(1176),cB=c(1177),eC=c(870);class vt{}vt.HHd=0;vt.NHd="1.0";vt.settingType="Goals";Object(n.a)(vt,"GoalsConstants",null,[]);var iz=c(1064);class nF{constructor(b,h,v,D,Q){this.LXb=null;this.Xwi=!1;this.aah=b;this.Gjd=h;this.Bg=v;this.yAa=D;this.MBe=Q;this.yAa.hHb()?this.QOn():this.yAa.hHb()&&this.d$f(vt.HHd,vt.NHd)}QOn(){new Promise(b=>
{this.aah.jdi(vt.settingType,h=>{this.ROn(h)?(this.d$f(this.LXb.formality,this.LXb.version),b(this.LXb)):(this.d$f(vt.HHd,vt.NHd),b(null))})})}ROn(b){this.Xwi=!0;if(!b||!b.Eob)return this.Bg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Eob.properties;var h=b.getValue(lc.a.Wri);h=parseInt(h);b=b.getValue(lc.a.Xri);if(!this.Gjd.Zng(b))return this.Bg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.LXb=
b=Object.assign(new iz.a,{formality:h,version:b});this.Bg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}d$f(b,h){b=Object.assign(new eC.a,{formality:b,version:h});this.MBe.Bij(b)}o6o(b){if(this.Gjd.Zng(b.version)){var h=ZC.a.x$k(b.version,b.formality.toString());this.aah.loh(Object.assign(new cB.a,{Eob:h,settingType:vt.settingType}))?this.LXb=b:this.Bg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Bg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}$$h(){this.Xwi||this.Bg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.LXb}}Object(n.a)(nF,"GoalsPersistenceHandler",null,[594]);class dB{constructor(b,h,v,D){this.Bg=b;this.NBe=h;this.Gjd=v;this.yAa=D;this.Fjd=Object.assign(new iz.a,{formality:vt.HHd,version:vt.NHd});this.KRe=this.yAa.hHb()}Dtf(){this.KRe&&(this.KRe=!1,this.NBe.$$h()&&(this.Fjd=this.NBe.$$h()));
return this.Fjd}Plo(b){this.KRe=!1;this.Gjd.Zng(b.version)?(this.yAa.hHb()&&this.NBe.o6o(b),this.Fjd=b):(this.Bg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.Fjd=Object.assign(new iz.a,{formality:vt.HHd,version:vt.NHd}))}}Object(n.a)(dB,"GoalsProvider",null,[592,593]);class Ds{constructor(b,h,v,D){this.Te=b;this.dA=h;this.yV=v;this.Bg=D}Bij(b){b=Object.assign(new Ha.a,{parentPath:["Signal",eC.a.getTypeName()],items:[Object.assign(new Hb.a,{body:b})]});
this.XJd(b)}XJd(b){this.dA.$k().then(()=>{this.UXe(b)}).catch(h=>{this.Bg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}UXe(b){this.Te.activateAnnotation(RD.a.getTypeName(),Ds.N0b).then(()=>{this.yV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Hc.a,{operation:b}))}).catch(h=>{this.Bg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}Ds.N0b="GoalSelected";Object(n.a)(Ds,"GoalsSignalSender",null,[335]);class Wj{constructor(){Wj.FWe=
new RegExp(Wj.Mnk)}Zng(b){return!!b.match(Wj.FWe)&&1===b.match(Wj.FWe).length}}Wj.Mnk="[0-9]+[.]?[0-9]*";Wj.FWe=null;Object(n.a)(Wj,"GoalsValidator",null,[334]);class SD{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}xc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new Wj).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new vD(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new dB(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new mF(this.W.resolve("WordEditor.Goals.IGoalReader"),new cf.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new nF(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new dC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new Ds(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){N.a.instance.Fc(new SD)}}
Object(n.a)(SD,"WordEditorGoalsPackage",null,[1,2]);var TD=c(744),tE=c(409);class uE{constructor(){this.annotation=null;this.languages=new Sg.a(Pa.a.ai())}}Object(n.a)(uE,"CritiqueCountWrapper",null,[]);class gA{constructor(){this.Gra=new Va.a}sOd(){return this.Gra}tpi(b,h,v,D){if(this.Gra.nb(v)){this.Gra.J(v).annotation.count+=h;v=this.Gra.J(v).languages;for(var Q of D)v.add(Q)}else Q=W.a.create().toString(),b=Object.assign(new tE.a,{id:Q,categoryName:b,count:h}),this.Gra.add(v,Object.assign(new uE,
{annotation:b,languages:D}))}}gA.Ei=389;Object(n.a)(gA,"BaseCritiquesByTypeCounter",null,[326]);class oF extends gA{constructor(b){super();this.Uwb=new za.a;this.uwe=new za.a;this.Jxd=b}flm(b){const h=b.annotation;if(h&&TD.a(ic.a.getTypeNameFor(h.content))){const v=h.content;if(b.opType===Ha.a.getTypeName()){this.Jxd.G_n(h.parentPath,v);b=v.M_.state;if(60!==b&&70!==b)return this.Uwb.contains(h.id)&&this.Uwb.remove(h.id),this.Gvm(h.id,v),!0;this.Uwb.add(h.id)}else if(b.opType===Ud.a.getTypeName())if(this.Uwb.contains(h.id))this.Uwb.remove(h.id);
else return this.xOh(v.typeId,h.id)}return!1}elm(b){if((b=b.annotation)&&TD.a(ic.a.getTypeNameFor(b.content))){const h=b.content,v=h.M_.state;if((60===v||70===v)&&!this.Uwb.contains(b.id))return this.Uwb.add(b.id),this.xOh(h.typeId,b.id)}return!1}Gvm(b,h){this.uwe.add(b);b=new Sg.a(Pa.a.ai());h.language&&b.add(h.language);this.tpi(h.categoryName,1,h.typeId,b)}xOh(b,h){if(!this.uwe.contains(h))return!1;if(!this.Gra.nb(b))return u.ULS.sendTraceTag(589866503,gA.Ei,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Gra.J(b).annotation.count)return u.ULS.sendTraceTag(589866504,gA.Ei,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.uwe.remove(h);this.Gra.J(b).annotation.count--;return!0}}Object(n.a)(oF,"AlCritiquesByTypeCounter",gA,[664,326]);var XF=c(1002);class UD extends Cq.a{constructor(b,h,v,D,Q,ba,ta,Ta,ob){var Kb;super();this.Te=b;this.Jxd=h;this.ise=
v;this.PRg=D;this.yKa=Q;this.Msa=ba;this.si=ta;this.U$=this.iQg=!1;this.fLe=new Va.a;this.ann=(Vb,bc)=>{this.Jxd.gmm(bc)&&(this.U$=!0,this.rY())};this.Yjn=(Vb,bc)=>{this.ise.flm(bc)&&this.MNb()};this.rTi=()=>{this.MNb()};this.lSf=(Vb,bc)=>{this.ise.elm(bc)&&this.MNb()};this.Xlb=()=>{this.MNb()};this.MNb=()=>{let Vb=!1;this.si.he(()=>{var bc=this.RRl();const Dc=new zb.a;for(const Oc of bc)bc=Object.assign(new XF.a,{id:Oc.id,parentPath:xp.a.hCb,content:Oc,annotationType:ic.a.getTypeNameFor(Oc)}),Dc.add(bc),
Vb||(Vb=0<Oc.count);this.Te.ago(Dc)},"CC:SATH");!this.iQg&&Vb&&(fa.a.sendTelemetryEvent({...(new ra.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.iQg=!0)};this.yHm=(Vb,bc,Dc)=>{const Oc=!this.yKa||this.yKa.iCf(Vb,Dc);Vb=this.Msa&&this.Msa.instance?this.Msa.instance.XXd(Vb,Dc,bc.substr(1,bc.length-2)):!0;return Oc&&Vb};null===Ta||void 0===Ta?void 0:Ta.NZe(this.Xlb);ob.gqa(this,7);null===(Kb=this.Msa)||void 0===Kb?void 0:Kb.execute(Vb=>{Vb.n_e(this.MNb)})}get index(){return 3}run(){this.U$&&
(this.MNb(),this.U$=!1)}SVi(){this.MNb()}y7k(b){let h=0;if(({value:h}=this.fLe.Dc(b.categoryName,0)).returnValue)if(h!==b.count)this.fLe.Z(b.categoryName,b.count);else return!1;else this.fLe.add(b.categoryName,b.count);return!0}RRl(){const b=new Va.a;var h=this.Jxd.sOd();const v=this.ise.sOd();this.Olg(b,h);this.Olg(b,v);this.PRg&&(h=this.PRg.sOd(),this.Olg(b,h));h=new zb.a;for(const D of b.values)this.y7k(D)&&h.add(D);return h}Olg(b,h){for(const Q of h){h=Q.value.annotation;const ba=Q.key;var v=
this.ieo(Q.value.languages);if(!b.nb(h.categoryName)){var D=W.a.create().toString();D=Object.assign(new tE.a,{id:D,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,D)}this.yHm(ba,v,h.categoryName)&&(v=b.J(h.categoryName),v.count+=h.count,v.countsByTypeId[ba]=(v.countsByTypeId[ba]?v.countsByTypeId[ba]:0)+h.count)}}ieo(b){const h=[];let v=0;for(const D of b)h[v++]=D;return F.c(h)}}Object(n.a)(UD,"CritiquesCounter",Cq.a,[662,663]);class VD{constructor(b){this.W1=b}sOd(){const b=
new Va.a,h=new Sg.a(Pa.a.ai()),v=Object.assign(new tE.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.W1.zqc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new uE,{annotation:v,languages:h}));return b}}Object(n.a)(VD,"DictationCritiquesByTypeCounter",null,[327,326]);class pF extends gA{constructor(b){super();this.r9a=new Va.a;this.Te=b}gmm(b){const h=xp.a.WQd(b.nodeId);if(!xp.a.jf(h)){if(b.jgb&&b.jgb.length){let v=null;for(const D of b.jgb)D.errorDetails.W2a()||
(b=this.F6h(D),xp.a.jf(b)||(v||(v=new Va.a),v.nb(b)||v.add(b,new zb.a),v.J(b).add(D)));this.yOh(h);v?this.Sjo(h,v):this.r9a.remove(h)}else{if(!this.r9a.nb(h))return!1;this.yOh(h);this.r9a.remove(h)}return!0}return!1}G_n(b,h){var v;if(({value:v}=this.r9a.Dc(b,v)).returnValue)for(const Q of v)if(b=Q.value,0<b.count&&this.Lof(b.J(0))===h.categoryName)for(v=b.count-1;0<=v;v--){var D=b.J(v).end-b.J(v).begin;b.J(v).begin===h.range.start&&D===h.range.length&&(D=this.F6h(b.J(v)),this.Gra.nb(D)&&(D=this.Gra.J(D).annotation,
D.count=Math.max(0,D.count-1)),b.removeAt(v))}}yOh(b){if(this.r9a.nb(b))for(const v of this.r9a.J(b)){var h=v.key;b=v.value;this.Gra.nb(h)&&(h=this.Gra.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}Sjo(b,h){const v=new Va.a,D=new Va.a;for(const Q of h){h=Q.key;D.add(h,new Sg.a(Pa.a.ai()));for(const ba of Q.value){const ta=ba.end-ba.begin,Ta=this.Lof(ba);this.SUk(b,Ta,ba.begin,ta)?u.ULS.sendTraceTag(589866513,gA.Ei,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,ba.begin,ta):(v.nb(h)||v.add(h,new zb.a),v.J(h).add(ba),D.J(h).add(this.TRl(ba)))}}this.r9a.Z(b,v);for(const Q of this.r9a.J(b))0<Q.value.count&&(b=this.Lof(Q.value.J(0)),this.tpi(b,Q.value.count,Q.key,D.J(Q.key)))}F6h(b){let h=null;b&&(b=Object(Ka.a)(324,b.errorDetails))&&b.ut&&(h=b.ut.TypeId);return h}Lof(b){let h=null;b&&(b=Object(Ka.a)(324,b.errorDetails))&&b.ut&&(h=b.ut.CategoryTitle);return h}TRl(b){let h="";b&&b.errorDetails&&(h=lk.a.og(b.errorDetails.lcid).name);return h}SUk(b,h,v,D){if((b=
this.Te.C3h(b))&&0<b.count)for(const Q of b)if(b=ic.a.getTypeNameFor(Q.content),Q&&TD.a(b)&&(b=Q.content,b.categoryName===h&&b.range.start===v&&b.range.length===D))return!0;return!1}}Object(n.a)(pF,"WacCritiquesByTypeCounter",gA,[325,326]);class vE{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}xc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new pF(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new oF(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new VD(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new UD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Na("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Na("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Sa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),wr.a.instance,this.W.Na("WordEditor.Goals.IGoalChangeSource"),
this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").Pph(b.ann);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").wwk(b.Yjn);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Bph(b.lSf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.kph(b.rTi),h.lph(b.rTi))}}dispose(){}static main(){N.a.instance.Fc(new vE)}}Object(n.a)(vE,
"WordEditorCritiqueCountsPackage",null,[1,2]);class wE{get name(){return"WordEditor.GraphicsEditor"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new wE)}}Object(n.a)(wE,"PackageManager",null,[1,2]);var $C=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class Cp{constructor(b){this.o1j={};this.Ub=b;this.dxb=new ec.a}jOa(b,h){const v=this.Ub.egc,D=parseInt(b);return b&&D!==Rc.ActionManager.Vgf?this.dxb.nb(v)?(b=this.dxb.J(v).Y8b(D,h,2),
32===b||1===b):!1:!1}yFa(b){const h=parseInt(b),v=this.Ub.egc;return b&&h!==Rc.ActionManager.Vgf?this.dxb.nb(v)?32===this.dxb.J(v).Y8b(h,this.o1j,1):!1:!0}N8i(b,h){this.dxb.Z(b,h)}wpj(b){b=parseInt(b);const h=this.Ub.egc;return!!h&&!!this.dxb.J(h)&&this.dxb.J(h).DGm(b)}}Object(n.a)(Cp,"NonCanvasCuiUser",null,[1226,321]);var Ex=c(1203),fC=c(49),wD;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";
b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(wD||(wD={}));Object(n.b)("GalleryType",wD);class mv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(n.a)(mv,"CommonGalleryButtonProps",null,[]);class hA extends mv{constructor(){super();this.tableStyles=this.tableCellStyles=
null;this.columns=0}}Object(n.a)(hA,"AdditionalTableStyleGalleryButtonProps",mv,[]);class or extends hA{constructor(){super()}}Object(n.a)(or,"AdditionalChangeColorsGalleryButtonProps",hA,[]);class xE extends mv{constructor(){super();this.character=null}}Object(n.a)(xE,"AdditionalCharacterCodeGalleryButtonProps",mv,[]);class yE extends mv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(yE,"AdditionalFontStyleGalleryButtonProps",mv,[]);class qF{constructor(){this.selectedId=
this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(n.a)(qF,"AdditionalGalleryProperties",null,[]);class rF extends mv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(n.a)(rF,"AdditionalIconButtonProperties",mv,[]);class gC extends mv{constructor(){super();this.styleDisplayName=null}}Object(n.a)(gC,"AdditionalInkThicknessGalleryButtonProps",
mv,[]);class aD extends mv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(aD,"AdditionalListGallerButtonProps",mv,[]);class Xv extends mv{constructor(){super();this.text=null}}Object(n.a)(Xv,"AdditionalPageNumberGalleryButtonProps",mv,[]);var ms=c(1130);const sF=(b,h)=>{var v=appChrome.selectors.getActiveControlStates();if(v=Object(Ka.a)(Object,v[b])){if((b=Object(Ka.a)(String,v.value))&&b===h)return!1;b=Object(Ka.a)(String,v.selectedKey);if(!h&&!b)return!1;if(b){v=Array.isArray(v.options)?
v.options:null;let D=null;for(let Q=0;Q<v.length;Q++){const ba=Object(Ka.a)(Object,v[Q]);if(Object(Ka.a)(String,ba.key)===b){D=ba;break}}if(D&&Object(Ka.a)(String,D.text)===h)return!1}}return!0},Es=(b,h,v,D)=>{if(0<(D&2)){D=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":D.push(hC(b,v[Ff.a.On]));break;case "CheckboxModel":D.push(appChrome.actions.toggleCheckbox(b,v[Ff.a.On]));break;case "ComboBoxModel":if(w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!sF(b,v[mi.a.Value]))break;(h=v[mi.a.Key])?D.push(appChrome.actions.updateComboBoxKey(b,h,v[mi.a.Value])):D.push(appChrome.actions.updateComboBoxValue(b,v[mi.a.Value]));break;case "FontPickerModel":D.push(appChrome.actions.updateFontPickerSelectedFont(b,v[ms.a.SelectedFont]));break;case "SplitButtonModel":D.push(hC(b,v[Jl.a.On]));break;case "SpinButtonModel":D.push(appChrome.actions.updateSpinButton(b,
v[kh.a.Number],Nf.a.h_a(v[kh.a.UnitType]),v[kh.a.Text],v[kh.a.MaxValue],v[kh.a.Alt]));break;case "ColorPickerModel":D.push(appChrome.actions.updateColorPickerSelectedColor(b,v[Tc.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":D.push(appChrome.actions.updatePageNumberGalleryButtonText(b,v[Fi.a.Text]));break;case "CompoundButtonModel":v[Ff.a.Description]&&D.push(appChrome.actions.updateCompoundButtonDescription(b,v[Ff.a.Description]));Ff.a.On in v&&D.push(hC(b,v[Ff.a.On]));break;case "SliderModel":v.snapToStep?
D.push(appChrome.actions.updateSliderSelectedValue(b,v[$i.Value])):D.push(appChrome.actions.updateSliderValue(b,v[$i.Value],v[$i.MinValue]||0,v[$i.MaxValue],v[$i.Text]));break;case "FlyoutAnchorModel":vm.a.ImageIsVisible in v&&D.push(appChrome.actions.hideFlyoutAnchorIcon(b,!v[vm.a.ImageIsVisible]));Ff.a.On in v&&D.push(hC(b,v[Ff.a.On]));break;case "InputBoxModel":D.push(appChrome.actions.updateInputBoxValue(b,v[Qo.a.Text]))}h=D;var Q=Object(Ka.a)(String,v[Aj.a.iconColor]);void 0!==Q&&null!==Q&&h.push(appChrome.actions.updateIconColor(b,
Q));bD(b,v,D);h=D;(Q=Object(Ka.a)(Object,v[Aj.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,Q));h=D;Q=Object(Ka.a)(String,v[Aj.a.customTooltip]);void 0!==Q&&null!==Q&&h.push(appChrome.actions.setControlCustomTooltip(b,Q));b=D;(v=Array.isArray(v[Aj.a.x3f])?v[Aj.a.x3f]:null)&&b.push.apply(b,v);return D}return null},Fx=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),hC=(b,h)=>appChrome.actions.toggleButton(b,h),bD=(b,h,v)=>{h=Object(Ka.a)(String,h[Aj.a.Icon]);void 0!==h&&
null!==h&&v.push(appChrome.actions.setControlIcon(b,h))};class zE{constructor(b,h,v,D){this.Pl=D;this.Usa=b;this.Zz=h;this.wYb=v;this.Gvc={}}iDn(b,h,v,D,Q=null){const ba=b.ExternalGalleryId||b.ExternalId;var ta=b.ExternalId;D.push(ba);if(appChrome.selectors.isControlDefined(ba))b.GalleryStyle&&Lh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ba,b.GalleryStyle));else{if(4!==b.Type)return;v.push(appChrome.api.createGalleryModel(ba,Object.assign(new qF,{columns:b.Width,sections:[appChrome.api.gallerySection([],
ta)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}v=0;D=!!w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Lh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ta=[];const ob=[],Kb=[],Vb={};for(var Ta of b.GallerySections){ta.push(appChrome.api.gallerySection([],Ta.SectionId,Ta.Title));0===v&&Ta.GalleryButtons&&
0<Ta.GalleryButtons.length&&(v=Ta.GalleryButtons[0].Type);D&&this.Adi(Ta.GalleryButtons,Q,Vb);const bc=this.HYe(ob,Ta.GalleryButtons,Vb);ob.push.apply(ob,this.Osf(bc,ba,Ta.SectionId,!1,v,Q,!0,Vb));Kb.push.apply(Kb,bc)}h.push(appChrome.actions.setGallerySections(ba,ta));h.push.apply(h,ob);h.push.apply(h,this.iqf(ba,wD[v],Kb,null,5===b.Type,!0,null,Vb))}else b.GalleryItems&&0<b.GalleryItems.length&&(v=b.GalleryItems[0].Type),Ta=D?this.Adi(b.GalleryItems,Q,null):null,h.push.apply(h,this.Osf(this.HYe(h,
b.GalleryItems,Ta),ba,ta,!1,v,Q,!1,Ta))}p8l(b,h){const v=[];let D=null,Q=!1;if(!b)return null;const ba=this.Usa.r1c(this.Zz,b.commandId,h);v.push(Fx(b.externalUxCommand,!ba));if(b.previewControlIds){const ob=[];for(let Kb=0;Kb<b.previewControlIds.length;Kb++){var ta={},Ta=b.previewControlIds[Kb];ta.SourceControlId=Ta;const Vb=this.Pl.getCommandByExternalUxId(Ta);this.iRd(Vb||b,ta);ta[Fi.a.On]&&(D=ta.SourceControlId,ta[Fi.a.HighlightOn]&&(Q=!0));bD(Ta,ta,v);if(ta=Object(Ka.a)(px.a,ta[Fi.a.GalleryButtonProps]))ob.push(ta),
ba&&(Ta=this.Usa.r1c(this.Zz,ta.Command,h),ta.IsDisabled=!Ta)}0<ob.length&&v.push.apply(v,this.Osf(this.HYe(v,ob),b.externalUxCommand,b.externalUxCommand,!0,ob[0].Type));v.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,D));Q&&(u.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",D),v.push(appChrome.actions.highlightSelectedFontStyle(D)))}return v}HYe(b,h,v=null){const D=[],Q=[];for(let ta=0;ta<h.length;ta++){const Ta=h[ta],ob=qf.b(Ta.ExternalId)?
Ta.Id:Ta.ExternalId;D.push(ob);const Kb=v&&v[ob]?v[ob].result:-1;switch(Ta.Type){case 1:var ba=Ta;Q.push(appChrome.api.createCharacterCodeGalleryButtonModel(ob,Object.assign(new xE,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,character:ba.Character,style:ba.Style,title:ba.Alt})));break;case 2:ba=Ta;Q.push(appChrome.api.createFontStylesGalleryButtonModel(ob,Object.assign(new yE,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt,previewStyleLabel:ba.PreviewStyleLabel})));
break;case 3:ba=Ta;Q.push(appChrome.api.createInkThicknessGalleryButtonModel(ob,Object.assign(new gC,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt})));break;case 4:ba=Ta;Q.push(appChrome.api.createIconGalleryButtonModel(ob,Object.assign(new rF,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,icon:[ba.Icon],fullIconStyle:ba.FullIconStyle,previewIconStyle:ba.PreviewIconStyle,largePreviewIconStyle:ba.LargePreviewIconStyle,label:ba.LabelText,title:ba.Alt})));
break;case 5:ba=Ta;Q.push(appChrome.api.createListGalleryButtonModel(ob,Object.assign(new aD,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,infoAtLevel:ba.LevelInfo,ariaLabel:ba.Alt})));break;case 6:ba=Ta;Q.push(appChrome.api.createTableStyleGalleryButtonModel(ob,Object.assign(new hA,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt,columns:ba.columns})));break;case 8:ba=Ta;Q.push(appChrome.api.createChangeColorsGalleryButtonModel(ob,Object.assign(new or,
{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt})));break;case 7:ba=Ta,Q.push(appChrome.api.createPageNumberGalleryButtonModel(ob,Object.assign(new Xv,{disabled:-1!==Kb?1>(Kb&1):ba.IsDisabled,text:ba.Text,title:ba.Alt})))}this.Pl.addCommandToMaps(Object.assign(new fC.a(ob,Ta.Command),{queryCommandId:Ta.QueryCommand,menuItemId:Ta.MenuItemId}))}b.push(appChrome.actions.addControls(Q));return D}Osf(b,h,v,D,Q,ba=null,ta=!1,Ta=null){const ob=
[];D?ob.push(appChrome.actions.populateGalleryItems(h,b)):(this.Gvc[h]=!1,ta||(D=!0,appChrome.selectors.isControlDefined(h)&&(D=appChrome.selectors.getGalleryState(h),D=D.disableIndividualButtons?D.disableIndividualButtons:!0),ob.push.apply(ob,this.iqf(h,wD[Q],b,null,5===Q,D,ba,Ta))),ob.push(appChrome.actions.updateGallerySectionItems(h,v,b)));return ob}sXl(b){return this.iqf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}iqf(b,
h,v,D,Q,ba=!0,ta=null,Ta=null){const ob=[];if(b in this.Gvc){if(this.Gvc[b])return delete this.Gvc[b],ob;this.Gvc[b]=!0}let Kb=null,Vb=-1;if(v)({$1h:Vb,returnValue:Kb}=this.Enh(h,v,ob,ba,ta,Ta));else if(D)for(const bc of D)(v=({$1h:Vb}=this.Enh(h,bc.galleryButtons,ob,ba,null,Ta)).returnValue)&&(Kb=v);ob.push(appChrome.actions.updateGallerySelectedId(b,Kb));ba&&ob.push(Fx(b,!1));Q&&0<Vb&&ob.push(appChrome.actions.updateListGalleryTextDirection(b,2===Vb));return ob}zdi(b,h=null){const v={},D={};D.SourceControlId=
b;D.Location=h;b=this.Pl.getCommandByExternalUxId(b);if(!b)return v.result=-1,v.props=D,v;b=this.iRd(b,D);v.result=b;v.props=D;return v}Adi(b,h=null,v=null){v||(v={});for(const D of b)b=qf.b(D.ExternalId)?D.Id:D.ExternalId,v[b]=this.zdi(b,h);return v}Enh(b,h,v,D,Q=null,ba=null){let ta,Ta=null;ta=-1;let ob=!1;for(const Vb of h){var Kb=this.pXl(b);h=ba&&ba[Vb]&&-1!==ba[Vb].result?ba[Vb]:this.zdi(Vb,Q);const bc=h.result;h=h.props;D&&v.push(Fx(Vb,1>(bc&1)));(Kb=Es(Vb,Kb,h,bc))&&v.push.apply(v,Kb);h[Fi.a.On]&&
(Ta=Vb,h[Fi.a.HighlightOn]&&h[Fi.a.HighlightOn]&&(ob=!0));void 0!==h[Aj.a.labelText]&&null!==h[Aj.a.labelText]&&(Kb=this.Pl.getCommandByExternalUxId(Vb),v.push(appChrome.actions.setControlLabel(Kb.externalUxCommand,h[Aj.a.labelText])));h[Fi.a.IsRtl]&&0>ta&&(ta=h[Fi.a.IsRtl])}ob&&(u.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ta),v.push(appChrome.actions.highlightSelectedFontStyle(Ta)));return{returnValue:Ta,$1h:ta}}pXl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}iRd(b,h){h.MenuItemId=b.menuItemId;return this.Usa.Fpa(this.Zz,this.wYb,
b.commandId,b.queryCommandId,h)}}Object(n.a)(zE,"ReactGalleryPoller",null,[]);var eB=c(690),AE=c(656),Qw=c(1695),xD=c(755),Rw=c(1696);class iA{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)(iA,"PopulateFontPickerDataProps",null,[]);var WD=c(282),Vo=c(1858);class tu{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(n.a)(tu,"CommonOptionalButtonProperties",null,[]);class yD extends tu{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(n.a)(yD,"OptionalButtonProperties",tu,[]);class iC extends tu{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(iC,"OptionalCompoundButtonProperties",tu,[]);class cD extends tu{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(n.a)(cD,"OptionalErrorViewProperties",tu,[]);class Qf extends tu{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(Qf,"OptionalFlyoutAnchorProperties",tu,[]);class XD extends tu{constructor(){super();this.isBanner=null}}Object(n.a)(XD,"OptionalLabelProperties",
tu,[]);class jC extends tu{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(n.a)(jC,"OptionalMultipActionButtonProperties",tu,[]);class BE extends yD{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(BE,"OptionalPersonaButtonProperties",yD,[]);class dD extends tu{constructor(){super();this.toggled=!1;
this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(n.a)(dD,"OptionalToggleButtonProperties",tu,[]);var kC=c(1698),CE=c(1697),DE=c(473);class ci{constructor(){this.wFh=this.actions=null;this.OJj=!1}}Object(n.a)(ci,"PopulateActions",null,[]);class zD{rgi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.h9l(b);case "InkButtonModel":return this.g9l(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}h9l(b){const h={};h[Ff.a.On]=appChrome.selectors.getButtonToggleState(b);return h}g9l(b){const h={};h[Ff.a.On]=Lh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(n.a)(zD,"ReactStatePropsSelector",null,[]);class AD{constructor(b,h,v,D,Q){this.Usa=b;this.Zz=h;this.wYb=v;this.Pl=D;this.pTe={};this.Qfk=new zD;this.Owb=Q}Zsj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.pTe}H9l(b,h,v=null){const D=[],Q={};if(!this.Zsj(b)){const ba=b.populationProps.populateQueryCommandId,ta={};ta.MenuId=b.externalUxCommand;ta.IsShadowMenuOpen=this.isShadowMenuOpen(v);if(0<(this.Usa.Fpa(this.Zz,this.wYb,ba,ba,ta,this.a_l(v))&1))if("FontPickerModel"===h)this.pTe[ba]=!0,D.push(AD.U7l(b,ta)),Q[b.externalUxCommand]="FontPickerModel";else if(ta.MenuItems)switch(this.pTe[ba]=!0,h){case "ComboBoxModel":D.push(AD.S7l(b,ta));Q[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":D.push.apply(D,this.yii(b.externalUxCommand,h,ta.MenuItems,Q,v&&"location"in v?v.location:null))}}return Object.assign(new ci,{actions:D,wFh:Q,OJj:this.isShadowMenuOpen(v)})}Xai(b,h,v,D,Q,ba,ta,Ta,ob=null){let Kb=null;const Vb=[];qf.c(b.Title)||(Kb=b.Title);for(let bc=0;bc<b.ControlList.length;bc++){const Dc=Object(Ka.a)(Ro.a,b.ControlList[bc]);
if(!Dc||Dc.ExternalId)ba&&this.TPl(Dc,ba),h.push.apply(h,this.T7l(Dc,ta,Vb,Q,v,D,ob))}return Ta?appChrome.api.menuSection(Vb,Kb,b.Lang):null}yii(b,h,v,D,Q=null){const ba=[],ta=[],Ta=[],ob=[];for(var Kb=0;Kb<v.MenuSectionList.length;Kb++){var Vb=Object(Ka.a)($g.a,v.MenuSectionList[Kb]);Vb&&(Vb=this.Xai(Vb,ba,b,h,ob,D,ta,v.UpdateDynamically,Q),v.UpdateDynamically&&Ta.push(Vb))}Kb=null;v.MenuFooterSection&&(Kb=this.Xai(v.MenuFooterSection,ba,b,h,ob,D,ta,v.UpdateDynamically,Q));v.UpdateDynamically&&ba.push(appChrome.actions.updateMenu(b,
Ta,v.Title,v.AriaLabel,v.ShouldAutoOpen,v.AriaRoleDescription,v.MenuTargetDescriptor,Kb));0<ta.length&&ba.splice(0,0,appChrome.actions.addControls(ta));0<ob.length&&Lh.d("setStatefulSplitButtonMruBypassControls")&&ba.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,ob));return ba}TPl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";
break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Ka.a)(Nz.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}T7l(b,h,v,D,Q,ba,ta=null){const Ta=[];switch(b.ControlType){case 14:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&this.lDn(Object(Ka.a)(xD.a,b),Ta,h,v);break;case 1:case 3:D=Object(Ka.a)(fg.a,b);this.TCn(D,Ta,h,v);D.MenuItemsStatefulData&&Lh.d("setStatefulSplitButtonMenuItemsStatefulData")&&
Ta.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(Q,D.MenuItemsStatefulData));break;case 2:this.EDn(Object(Ka.a)(DE.a,b),Ta,h,v);break;case 6:this.UCn(Object(Ka.a)(kv.a,b),Ta,h,v);break;case 4:this.xDn(Object(Ka.a)(Eo,b),Ta,h,v);break;case 7:this.WCn(Object(Ka.a)(Nz.a,b),Ta,h,v);break;case 12:this.cDn(Object(Ka.a)(Qw.a,b),Ta,h,v);break;case 13:this.uDn(Object(Ka.a)(Rw.a,b),Ta,h,v);break;case 9:Q=Object(Ka.a)(wj.a,b);this.eDn(Q,Ta,h,v);"StatefulSplitButtonModel"===ba&&D.push(Q.ExternalId);
break;case 8:this.Owb.iDn(Object(Ka.a)(an.a,b),Ta,h,v,ta)}return Ta}lDn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Vo.a(b.IconName)),v.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new XD,{isBanner:b.IsBanner,
iconSet:h?h.iconSet:null}))))}TCn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.Xzd()&&((v=this.XOa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Vo.a(v)).iconSet)),
b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(yb.a)(ay,b)?v.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new iC,{iconSet:(new Vo.a(this.XOa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(D=b.DismissHostingSurfaceOnExecute,v.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new yD,
{iconSet:(new Vo.a(this.XOa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==D&&null!==D?D:!0})))),this.Pl.addCommandToMaps(Object.assign(new fC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&Lh.d("setControlLanguage")&&
h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}UCn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Xzd()&&((v=this.XOa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Vo.a(v)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(v.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new dD,{iconSet:(new Vo.a(this.XOa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Pl.addCommandToMaps(Object.assign(new fC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}cDn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Vo.a(b.IconName)),v.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new cD,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}uDn(b,h,v,D){D.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(v={},b.Label&&(v.label=b.Label),b.SecondaryLabel&&(v.secondaryLabel=b.SecondaryLabel),b.Description&&(v.description=b.Description),b.iconSet&&(v.iconSet=b.iconSet),b.Links&&(v.links=b.Links),b.CommandValueId&&(v.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(v.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(v.actionCommandId=b.ActionCommandId),b.CommandId&&(v.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
v))):v.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new jC,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId})))}EDn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,
b.LabelText)),this.Xzd()&&((v=this.XOa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Vo.a(v)).iconSet)),w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?v.push(appChrome.api.createToggleButtonModel(b.ExternalId,
b.LabelText,Object.assign(new dD,{iconSet:(new Vo.a(this.XOa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):v.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new dD,{iconSet:(new Vo.a(this.XOa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.Pl.addCommandToMaps(Object.assign(new fC.a(b.ExternalId,
b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}xDn(b,h,v,D){D.push(b.ExternalId);D=this.w7l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,D,b.LabelText)):Lh.a("createPersonaButtonModel")&&v.push(appChrome.api.createPersonaButtonModel(b.ExternalId,D,b.LabelText,Object.assign(new BE,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}eDn(b,
h,v,D){D.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Xzd()&&((v=this.XOa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Vo.a(v)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,
b.Toggled)));else{D=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const Q=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;v.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new Qf,{iconSet:(new Vo.a(this.XOa(b))).iconSet,keytip:b.KeyTip,hideIcon:D,toggled:Q,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Pl.addCommandToMaps(Object.assign(new fC.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new eB.a(b.PopulateQueryCommand,
b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.yii(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}WCn(b,h,v,D){b.McuLayout&&D.push(b.McuExternalId);D.push(b.ExternalId);D=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(D=this.Qfk.rgi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(v.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new fC.a(b.McuExternalId,
b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),D=b.Width),v.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new fC.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));v=[];const Q=[];for(let ba=0;ba<b.Colors.length;ba++){const ta=b.Colors[ba];ba<D?v.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt)):Q.push(appChrome.api.colorPickerCell(ta.Color,
ta.DisplayColor,ta.Alt))}0<v.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,v));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,Q));b.SelectedColorId&&(0<v.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}XOa(b){return b.Image32by32Class?this.Pl.Z7h(b.Image32by32Class):b.Image16by16Class?this.Pl.Z7h(b.Image16by16Class):
b.ExternalImageId}w7l(b){return b?Object.assign(new CE.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new kC.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}a_l(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}Xzd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static U7l(b,
h){return appChrome.actions.populateFontPickerDataAsync(new Promise((v,D)=>{Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Q=>{Q.isFeatureEnabled(WD.a.JIb,!1).then(ba=>{let ta=h.fonts;ba||Q.isFreemiumUpsellEnabled()||(ta=am.a.Qog(ta,Ta=>Ta.fontType!==WD.a.XZf));ba=Object.assign(new iA,{commandId:b.externalUxCommand,fonts:ta,isSubscriber:ba,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});v(ba)}).catch(D)})}))}static S7l(b,
h){const v=[];for(let D=0;D<h.MenuItems.MenuSectionList.length;D++){const Q=h.MenuItems.MenuSectionList[D];Q.Title&&v.push(appChrome.api.comboBoxHeader("Header-"+D.toString(),Q.Title));for(let ba=0;ba<Q.ControlList.length;ba++){const ta=Object(Ka.a)(AE.a,Q.ControlList[ba]);ta&&v.push(appChrome.api.comboBoxItem(ta.MenuItemId,ta.LabelText,ta.Styles,ta.CommandValueId,ta.AriaLabel,ta.Data,ta.Disabled))}D<h.MenuItems.MenuSectionList.length-1&&v.push(appChrome.api.comboBoxDivider("Divider-"+D.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,
v)}}Object(n.a)(AD,"ReactPopulateQueryCommandPoller",null,[]);class Rj{constructor(b,h,v,D,Q){this.Pl=v;this.Usa=b;this.Zz=h;this.wYb=D;this.Owb=Q}G9l(b,h,v){const D=[];if(this.TGm(h))b=this.Ecm(b,h,v),void 0!==b&&null!==b&&D.push.apply(D,b);else if(b){var Q=this.iRd(b,v);Aj.a.visible in v&&D.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!v[Aj.a.visible]));D.push(Fx(b.externalUxCommand,1>(Q&1)));void 0!==v[Aj.a.labelText]&&null!==v[Aj.a.labelText]&&D.push(appChrome.actions.setControlLabel(b.externalUxCommand,
v[Aj.a.labelText]));void 0!==h&&null!==h&&(Q=Es(b.externalUxCommand,h,v,Q),void 0!==Q&&null!==Q&&D.push.apply(D,Q),"PeopleWell"===h&&this.qtk(b.externalUxCommand,v,D))}return D}IUl(b,h,v){const D=[];switch(h){case "FlyoutAnchorModel":var Q=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ba=appChrome.selectors.getSplitButtonState(b);if(ba=this.Pl.getCommandByExternalUxId(ba.command))v=this.Usa.r1c(this.Zz,ba.commandId,v),D.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,
!v)),D.push(Fx(b,!1));return D;default:return null}h=!1;for(ba in Q)if(Q=this.Pl.getCommandByExternalUxId(ba),qf.c(Q))h=!0;else if(v.SourceControlId=Q.externalUxCommand,this.Usa.r1c(this.Zz,Q.commandId,v))return D.push(Fx(b,!1)),D;D.push(Fx(b,!h));return D}Ecm(b,h,v){switch(h){case "PreviewGalleryModel":return this.Owb.p8l(b,v);case "GalleryModel":return this.Owb.sXl(v)}return null}TGm(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}iRd(b,h){h.MenuItemId=b.menuItemId;return this.Usa.Fpa(this.Zz,
this.wYb,b.commandId,b.queryCommandId,h)}qtk(b,h,v){const D=h[vm.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[vm.a.LabelText];D&&0<D.length&&(h=String.format.apply(null,[h].concat(D)));v.push(this.Vgm(b,h))}Vgm(b,h){return appChrome.actions.updatePeopleWell(this.APl(b),h)}APl(b){const h=[];var v={};b=this.Pl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Usa.Fpa(this.Zz,this.wYb,"1285265560",b,v);v=v.MenuItems;if(!v)return h;v=v.MenuSectionList[0];for(b=0;b<v.ControlList.length;b++){const D=
v.ControlList[b],Q={};Q.name=D.Alt;Q.id=D.MenuItemId;Q.description=D.Description;Q.color=D.ImageBackColor;Q.joinTime=D.JoinTimeInMS;Q.imageUrl=D.ImageUrl;Q.activeStatus=D.ActiveStatus;Q.isAnonymous=D.IsAnonymous;Q.canJump=D.CanJump;Q.upn=D.Upn;h.push(Q)}return h}}Object(n.a)(Rj,"ReactQueryCommandPoller",null,[]);var YF=c(1117);class EE{constructor(b,h,v){this.Pl=b;this.Zz=h;b=new YF.a;this.hkk=new zD;this.Owb=new zE(b,this.Zz,v,this.Pl);this.xbh=new AD(b,this.Zz,v,this.Pl,this.Owb);this.mbh=new Rj(b,
this.Zz,this.Pl,v,this.Owb)}uEa(){const b=[];if(!Lh.c())return b;b.push.apply(b,this.Tgm());var h=this.JTl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const v=this.KTl();for(const D of v)b.push(appChrome.actions.updateControlEnabledDisabledState(D,!0)),delete h[D];b.push.apply(b,this.ESd(h))}return b}s1c(b,h){Lh.c()&&(b=this.ESd(b,h),appChrome.api.dispatch(b))}tZf(b,h,v=null){if(!qf.c(b)&&b.populationProps&&!this.xbh.Zsj(b)){b=this.xbh.H9l(b,
h,v);if(!b.OJj){let D;(D=b.actions).push.apply(D,this.ESd(b.wFh,Lh.g(v)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}ESd(b,h=0){const v=[],D={};if(Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var Q of appChrome.selectors.getActiveGroupIds())for(var ba of appChrome.selectors.getVisibleControlsInGroup(Q))D[ba]=!0;for(let ta in b)Q=ta,ba=b[ta],
0===h&&D[Q]&&(h=2),v.push.apply(v,this.Sgm(Q,ba,h));return v}Sgm(b,h,v=0){const D=[],Q=this.Pl.getCommandByExternalUxId(b);let ba={};appChrome.selectors.isControlDefined(b)&&(ba=this.hkk.rgi(b,h));ba[Ex.a.H7a]=v;qf.c(Q)?(ba.ExternalUxId=b,(b=this.mbh.IUl(b,h,ba))&&0<b.length&&D.push.apply(D,b)):(ba.MenuItemId=Q.menuItemId,ba.SourceControlId=b);D.push.apply(D,this.mbh.G9l(Q,h,ba));return D}Tgm(){const b=[],h=!!w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),v=appChrome.selectors.getContextualTabIds();let D=[];h&&(D=appChrome.selectors.getActiveContextualTabIds());for(let ba=0;ba<v.length;ba++){var Q=this.Pl.ouf(v[ba]);if(Q){Q=this.Zz.yFa(Q);let ta=!0;h&&(ta=0<=Array.indexOf(D,v[ba]));h&&ta===Q||b.push(appChrome.actions.activateDeactivateContextualTab(v[ba],Q))}}return b}JTl(){var b=appChrome.selectors.getSelectedTabId();const h=[],v=this.Pl.ouf(b);
v&&(this.Zz.yFa(v)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}KTl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const v of b)if(b=this.Pl.KXl(v))for(const D of b)this.Zz.yFa(D.commandId)||((b=D.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(D.externalUxGroupId)),h.push.apply(h,b));return h}}Object(n.a)(EE,"ReactRibbonRootPoller",null,[1214]);class eD{constructor(b,h,v=null){this.Zz=this.NAa=this.Ubb=null;this.cYb=
h;b.JMa(this);this.wF=v}get Toa(){this.NAa||(this.NAa=new Date,this.NAa.setTime(0));return this.NAa}set Toa(b){this.NAa=b}get H9(){return 2}get wF(){return this.Zz}set wF(b){this.Zz=b}get Igc(){this.Ubb||(this.Ubb=new EE(this.cYb,this.wF,this.H9));return this.Ubb}Heb(){const b=document.activeElement;jc.a.isEditable(b)&&b.blur()}executeCommand(b,h,v,D,Q,ba,ta,Ta=2){qf.c(this.wF)||(Q=new cr.a,Q.CommandLocation=Ta,Q.InvocationMethod=D,Q.CommandTabName=v,h[Ex.a.H7a]=Ta,this.wF.jOa(b,h,Q,ba,ta),this.a1m(b,
h))}uEa(){return qf.c(this.wF)?[]:this.Igc.uEa()}xm(){const b=this.uEa();0<b.length&&(this.Toa=new Date,appChrome.api.dispatch(b))}Oad(){Lh.c()&&this.Igc.s1c({PeopleWell:"PeopleWell"},18)}Fad(){}a1m(b,h){try{const v=Ga.a.instance.Na("Common.ISystemInitiatedFeedback");if(v&&h){const D=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let Q=(D?"_"+D:"")+(h.SqmControlId?"_"+h.SqmControlId:"");Q=Q.length?Q:"_"+b;v.TJf("Ribbon"+Q)}}catch(v){u.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(v?v.toString():""))}}}Object(n.a)(eD,"ReactRibbonRoot",null,[428,1215]);var YD=c(1622);class tF{constructor(b){this.UWe=this.kCe=!1;this.G9a=null;this.sNg=!1;this.IP=null;this.qsa=!1;this.FOe=b;pf.a.instance.mb(Sc.a.Lx,this.BNc(),Object(z.a)(this,this.Uln,"onContextualUIMouseDown"));(b=Ga.a.instance.Sa("Common.IActionContextProvider"))&&b.execute(h=>{this.IP=h});w.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.ta.Nb.wJ?rj.a.get_instance().xk(16,
()=>{this.p4?this.initializeContextualUI(this.BNc()):rj.a.get_instance().xk(7,()=>{this.initializeContextualUI(this.BNc())})}):rj.a.get_instance().xk(7,()=>{this.initializeContextualUI(this.BNc())})}get X_(){return this.qsa}get p4(){return w.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.ta.Nb.wJ?rj.a.get_instance().isCompleted(16)&&rj.a.get_instance().isCompleted(7):rj.a.get_instance().isCompleted(7)}WRk(){if(this.sNg)return!0;try{return Promise.resolve(null),
this.sNg=!0}catch(b){return!1}}dlg(b){if(!this.p4||this.UWe)return this.PKf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.WRk())return this.PKf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(w.AFrameworkApplication.JD)return this.PKf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.UWe=!0;let h=Ua.a.Hg;switch(b){case 1:h=Ua.a.showContextMenu;break;case 0:h=Ua.a.showFloatie;break;case 2:h=
Ua.a.Bjc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.UWe=!1;Qe.c(h)},0)});return!1}Sii(b){return Xj.UISurfaces.O0a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const v=[];for(const D of b)Array.contains(h,D)||v.push(D);return v}return b})}showFloatie(b,h,v,D=null){this.dlg(0)||this.Sii(h).then(Q=>{if(0>=Q.length)return null;this.gcg(Q).then(()=>{const ba={};ba.target=b;Xj.UISurfaces.O0a().then(ta=>
{appChrome.api.dispatch(ta.showFloatie(ba,v,void 0,this.Brf(),D));this.qsa=!0;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&w.AFrameworkApplication.va&&w.AFrameworkApplication.va.processAction(Ua.a.EIi,2);return null})});return null})}showContextMenu(b,h,v=null,D=null){this.dlg(1)||this.Xqj(b,h,v,D)}Xqj(b,h,v=null,D=null){this.gcg(null).then(()=>{const Q={};Q.target=b;D&&(Q.directionalHint=D);Xj.UISurfaces.O0a().then(ba=>{appChrome.api.dispatch(ba.showContextMenu(Q,
h,v,void 0,this.Brf()));return null})})}Ajc(b,h,v,D=null){this.dlg(2)||this.Sii(h).then(Q=>{0>=Q.length?this.Xqj(b,v,D):this.gcg(Q).then(()=>{const ba={};ba.target=b;const ta={};ta.target=b;Xj.UISurfaces.O0a().then(Ta=>{appChrome.api.dispatch(Ta.showContextualUI(ba,ta,v,void 0,D,this.Brf()));this.qsa=!0;return null})});return null})}PKf(b){u.ULS.sendTraceTag(561394519,340,15,b)}FJc(){this.p4&&Xj.UISurfaces.isLoaded()&&Xj.UISurfaces.O0a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}Xw(){this.p4&&
Xj.UISurfaces.isLoaded()&&Xj.UISurfaces.O0a().then(b=>{this.qsa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}H4b(){this.p4&&Xj.UISurfaces.isLoaded()&&Xj.UISurfaces.O0a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.qsa=!1;return null})}initializeContextualUI(b){return Xj.UISurfaces.O0a().then(h=>{this.kCe||(h.initializeContextualUI(b),this.kCe=!0);return null})}gcg(b){if(!this.kCe)return this.initializeContextualUI(this.BNc()).then(()=>{this.setActiveFloatieGroups(b);return null});
this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var v=[];Xj.UISurfaces.O0a().then(D=>{v.push.apply(v,this.FOe.Igc.ESd(D.selectors.getFloatieOnlyControlsMap(),9));0<v.length&&appChrome.api.dispatch(v);return null})}}BNc(){if(this.G9a)return this.G9a;this.G9a=YD.a("div");this.G9a.id="ReactContextualUIDiv";this.G9a.style.position="absolute";this.G9a.style.zIndex=
"1001";document.body.insertBefore(this.G9a,document.body.firstChild);return this.G9a}Uln(b){b.Gb&&b.Gb.target&&"input"===b.Gb.target.tagName.toLowerCase()&&$c.FocusManager.instance().dD("ribbon");return!1}Brf(){return this.IP?this.IP.contentType:"Unknown"}}Object(n.a)(tF,"ReactContextualUILauncher",null,[1217]);class uF extends ux.a{constructor(){super()}}Object(n.a)(uF,"FloatieBuildOptions",ux.a,[]);class vF extends Vs.a{constructor(){super()}}Object(n.a)(vF,"FloatieBuildContext",Vs.a,[]);var wF=
c(645);class xF extends gh.Builder{constructor(b,h,v){super(b,h,v,null);if(qf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}aoo(b){this.root=b}HMk(){const b=new vF,h=new Yy.a;h.X2c=1;h.handler=Object(z.a)(this,this.gsn,"onReturnFloatieData");h.data=b;this.Mua.Iee(h)}gsn(b){this.IMk(b.s2c,b.wHc);this.floatie.T_h=this;this.floatie.ym();this.floatie.Nc.style.display="none";this.placeholder.appendChild(this.floatie.Nc);this.Xta.continueWith(()=>
{this.Xta.result.hKb(this.floatie)},11);mg.a.instance.mb(Sc.a.pointerDown,this.floatie.Nc,Object(z.a)(this.floatie,this.floatie.$C,"onPointerDown"))}IMk(b,h){b=Vi.a.Fga(b,Vi.a.UNj);if(qf.c(b))throw Error.create("No floatie element was present in the data");b=new Vi.a(b);this.aoo(new ow(b.attributes[Vi.a.id],b.attributes));b=Vi.a.Fga(b.node,Vi.a.Spe);this.t4e(b,h)}t4e(b,h){b=Vi.a.mw(b);for(let v=0;v<b.length;v++){if(this.iQa(b[v]))continue;const D=this.y4e(b[v],h);this.floatie.Jf(D)}}y4e(b,h){var v=
new Vi.a(b);b=new wF.Group(this.floatie,v.attributes[Vi.a.id],v.attributes[Vi.a.FUa],v.attributes[Vi.a.Bnc],v.attributes[Vi.a.AUa],!1,v.name===Vi.a.SRj,!1,v.attributes);v=Vi.a.mw(v.node);for(let D=0;D<v.length;D++)b.Jf(this.SBd(v[D],h));return b}SBd(b,h){b=new Vi.a(b);var v=b.attributes[Vi.a.id];b=Vi.a.mw(b.node);var D=2;2===b.length&&(D=3);v=new vn.a(this.floatie,v,D,2,1);for(D=0;D<b.length;D++){const ba=new Vi.a(b[D]);var Q=Vi.a.Fga(ba.node,Vi.a.Oqb);Q=Vi.a.mw(Q);this.E4e(v.CRd(D+1),Q,ba.attributes[Vi.a.id],
h)}return v}E4e(b,h,v,D){for(v=0;v<h.length;v++){if(this.iQa(h[v]))continue;const Q=new Vi.a(h[v]),ba=this.yfa(h[v],D);ba&&b.Jf(ba.zQ(Q.attributes[Vi.a.Cnc]))}}}Object(n.a)(xF,"FloatieBuilder",gh.Builder,[]);class BD{constructor(b,h){this.uv=null;this.m0k=b;this.Dwe=h;this.pnn=this.C6d.bind(this)}get floatie(){return this.uv}Jeb(b,h,v){h=new mo.CuiHelper(zj.a.tZa,Box4Intl.Box4Strings,null,null,h);const D=new uF;D.UG=v||{};D.UG.floatieshadingColor=!1;const Q=new xF(D,document.body,this.m0k.Nej);Q.Mua=
new Sz.a(b,h);Q.HMk();this.Dwe.execute(ba=>{Q.floatie.wF=ba});Q.floatie.IVn(this.pnn);Q.floatie.WUn(()=>[]);this.uv=Q.floatie;return this.floatie}}Object(n.a)(BD,"AFloatieInitializer",null,[]);class yF extends BD{constructor(b,h,v,D){super(h,v);this.mZf=()=>{this.floatie.xm()};this.Mh=b;this.sI=D}Jeb(b,h,v){if(b=super.Jeb(b,h,v))b.cgc=!0,b.P$d=!0,b.preventDismissOnScroll=!0;this.Mh.XYa(this.mZf);return b}jSc(b,h,v=null){this.sI.Xvh(()=>this.Jeb(b,h,v))}C6d(){this.floatie.cgc=!0}}Object(n.a)(yF,"PasteFloatieInitializer",
BD,[]);var FE=c(808);class Yv{Gya(b,h){this.xSk&&this.xuo(b,h,Yv.zMf,Yv.kb)}xuo(b,h,v,D){switch(v){case 1:case 6:case 2:case 3:case 4:Yv.tgf.show(D,b,h)}}hNi(){switch(Yv.zMf){case 5:case 1:return!0;default:return!1}}Mfl(){return Yv.zMf}get xSk(){return 1!==Ya.App.xa.state}static get tgf(){return null!=Yv.Rxg?Yv.Rxg:Yv.Rxg=Ga.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static d2l(b){if(!b)return 0;if(2===Ya.App.xa.mode){const h=b.Oa.node,v=ne.GraphIterator.$a(h);v.Ep();return $o.e(v.currentNode)?
2:w.AFrameworkApplication.$Qb||!mt.isEmbeddedFileNode(h)||mt.isInvalid(h)?sj.a.dLm(b.Oa)||sj.a.eDf(b.Oa)?6:1:3}return 4}static get kb(){return Th.a.instance.gb.kb}static get zMf(){return Yv.d2l(Yv.kb)}}Object(n.a)(Yv,"SelectionContextMenuProvider",null,[1500]);var fB=c(1838);class fD{constructor(b,h){this.P$d=this.cgc=!1;this.JQc=!0;this.HL=b;this.Pl=h}get isVisible(){return this.HL.X_}get controls(){return null}Xw(){this.HL.Xw();return!0}Ehf(){}K6a(b,h,v,D,Q=null){this.HL.showFloatie(Object.assign(new fB.a,
{x:b.x,y:b.y}),this.Mmf(v),v,Q)}hEb(){return new Sys.UI.Bounds(0,0,0,0)}y3(){return this.Xw()}Mmf(){return[]}}Object(n.a)(fD,"ReactFloatie",null,[441,542]);class gD{constructor(b){this.wgd=null;this.HL=b}dispose(){}y3(){this.HL.H4b();return!0}showContextMenu(b,h){this.Nob(b,h.clientPoint,h.kg)}Nob(b,h,v){this.I6a(b,new Sys.UI.Bounds(h.x,h.y,0,0),v);u.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}I6a(b,h,v,D=null){this.wgd?this.HL.Ajc(Object.assign(new fB.a,{x:h.x,y:h.y}),
this.wgd.Mmf(v),v,b):this.HL.showContextMenu(Object.assign(new fB.a,{x:h.x,y:h.y}),v,b,D);this.wgd=null}Bjc(b,h,v,D){this.wgd=Object(Ka.a)(fD,v);D.Gya(b,h);return!0}w3b(){}}Object(n.a)(gD,"ReactContextMenuController",null,[660,10]);var ZF=c(460);class zF{constructor(){this.Jia=this.text=this.ooa=null}}Object(n.a)(zF,"BusinessBarButtonData",null,[]);class GE{constructor(){this.text=this.ooa=null}}Object(n.a)(GE,"BusinessBarLinkData",null,[]);var HE=c(194);class gB{constructor(b,h,v,D){this.yUg=this.QRg=
this.i$a=this.TPg=null;this.nt=b;this.Nza=h;this.ga=v;this.Ma=D}NYf(){this.u2b();this.XFc();this.v2b()}XFc(){}u2b(){const b=Ya.App.xa.hb.Uc;b&&(this.TPg=this.W7a(this.TPg,1,2===Ya.App.xa.mode&&b.eCf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}lUm(){return w.AFrameworkApplication.ta&&1===w.AFrameworkApplication.ta.mode}v2b(){let b=null;const h=Ya.App.xa.hb.activeSection;if(h){const v=h.n0c;HE.a.wXd(v)?22===v?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===v||20===v?b=aa.a.ui?
Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===v?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===v?b=aa.a.ui?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===v&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):HE.a.Emi(h.JYa)||Ya.App.vm||this.lUm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.yUg=this.W7a(this.yUg,5,!!b,b)}prj(b,h,v,D){b=this.Nza.create(null,
b,null);b.closeable=!0;b.id=23;b.image=3;b.Xyd(h,()=>{Id.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+v)});D&&(b.nma=D);this.nt.fA(b,!0)}kvo(b,h,v){this.prj(b,h,v,null)}wvo(b){b=this.Nza.create(null,b,null);b.closeable=!0;b.id=20;this.nt.fA(b)}Huo(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.i$a||(this.i$a=this.Nza.create(b,h,null),this.i$a.closeable=!0,this.i$a.id=27,this.nt.fA(this.i$a))}Drm(){this.i$a&&
(this.i$a=this.W7a(this.i$a,27,!1,""))}Qdg(b){this.QRg=this.W7a(this.QRg,30,!0,b)}W7a(b,h,v,D,Q=!1,ba="",ta=null,Ta=null,ob=null){v?b?b.message=D:(b=this.Nza.create(ba,D,null),b.id=h,b.closeable=Q,ta&&b.addButton(ta.text,ta.ooa,ta.Jia),Ta&&b.Xyd(Ta.text,Ta.ooa),ob&&(b.nma=ob),this.nt.fA(b,!1)):b&&(this.nt.removeEntry(b),b=null);return b}qYe(b){this.nt.fA(b,void 0)}}Object(n.a)(gB,"BusinessBarController",null,[190]);class lC extends gB{constructor(b,h,v,D){super(b,h,v,D);this.vsa=null}Wqf(b,h,v=null,
D=null,Q=null,ba=2){if(this.vsa)return null;this.vsa=this.Nza.create(h,v||"",null);this.vsa.id=6;this.vsa.image=ba;this.vsa.pZd=!1;b&&(this.vsa.errorCode=b);this.vsa.closeable=!1;h=w.AFrameworkApplication.zF&&this.Ma.$("ShowFeedbackButtonOnKickoutBusinessBar");D?(this.vsa.addButton(D,Q,""),h&&this.vsa.Foh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Dji(b)})):h&&this.vsa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Dji(b)},"");this.nt.fA(this.vsa,void 0,null,null,null);return this.vsa}Dji(b){u.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb(Ua.a.giveFeedback,2,{["ErrorCode"]:b})}static get nf(){return bi.PageReader.instance}}Object(n.a)(lC,"BusinessBarController",gB,[189,190]);class ZD{static get xRi(){const b=G.a.Nj(lk.a.og(w.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(n.a)(ZD,"OdtUtils",null,[]);class AF extends lC{constructor(b,h,v,D){super(b,h,v,D);this.Mrb=this.Gtc=
this.z5g=this.BMa=this.F5g=this.$fh=null;this.l$j="https://go.microsoft.com/fwlink/?linkid=2134357"}NYf(){super.NYf();this.JVk()}XFc(){const b=Ya.App.xa.hb.Uc;if(b){var h=Ya.App.a0;if(Ya.App.hs||Ya.App.vm||h&&w.AFrameworkApplication.kv)this.$fh=this.W7a(this.$fh,4,lC.nf.JVc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.F5g=this.W7a(this.F5g,3,lC.nf.Nac(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.z5g=this.W7a(this.z5g,8,lC.nf.f4k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),lC.nf.xWc(b)?this.BMa||(this.BMa=this.Nza.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.BMa.id=14,this.BMa.closeable=!0,this.BMa.image=3,this.BMa.addButton(Box4Intl.Box4Strings.L_LearnMore,pc.AppFrame.jYm,""),this.nt.fA(this.BMa,!1)):this.BMa&&(this.nt.removeEntry(this.BMa),this.BMa=null)}}JVk(){if(Jd.App.QUc){const b=ZD.xRi,h=this.Nza.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.ysk(b);this.nt.fA(h,!0)}}lvo(b,h){if(Ya.App.xa.hb.Uc){const v=new zF;v.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;v.ooa=()=>{b()};const D=new GE;D.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;D.ooa=()=>{Id.a.openWindow(4,w.AFrameworkApplication.privacyUrl)};this.Gtc=this.W7a(this.Gtc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
v,D,()=>{h()})}}Lrm(){this.Gtc&&(this.Gtc=this.W7a(this.Gtc,25,!1,""))}puo(){if(Ya.App.xa.hb.Uc){const b=new GE;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.ooa=()=>{Id.a.openWindow(4,this.l$j)};this.Mrb||(this.Mrb=this.Nza.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Mrb.id=32,this.Mrb.closeable=!0,this.Mrb.image=3,this.Mrb.Xyd(b.text,b.ooa),this.nt.fA(this.Mrb,!1))}}cY(b){return this.nt.cY(b)}fA(b,
h){this.nt.fA(b,h)}}Object(n.a)(AF,"BusinessBarController",lC,[690,189,190]);class IE{constructor(){this.menuTargetType=null}}Object(n.a)(IE,"MenuTargetDescriptor",null,[]);var Br=c(569);class Ni extends Br.a{constructor(b,h,v,D=!1,Q,ba=null,ta){super();this.m$d=(Ta,ob,Kb,Vb,bc)=>{if(1===Kb)return 32;Ta=bc.Ix;bc=bc.xd;ob=Object.assign(new Yd.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.Qal(ob,Ta,bc.IsShadowMenuOpen);bc.MenuItems=ob;return 32};this.aJn=h;this.sn=v;this.vcb=
ba;this.NFe=D;this.Tb(b);this.c9a=ta;Ni.XXa[1]=Eb.a.mje;Ni.XXa[2]=Eb.a.ZSd;Ni.XXa[3]=Eb.a.Pje}get Orl(){return Je.a.xHd}get Nrl(){return Je.a.SFd}get Prl(){return Je.a.H9d}get rgf(){return Je.a.N_i}Tb(b){b.fb(Eb.a.wZf,Zb.a.application,this.m$d,96);b.fb(Eb.a.p1i,Zb.a.application,this.m$d,96)}show(b,h,v){let D=null,Q=new Sys.UI.Bounds(0,0,0,0);const ba=this.U8l(b);if(ba&&(b=b.Oa.node)&&(b=b.De(Ob.InteractiveViewManager.instance.Bd.ic))){Q=Do.a.Rq(b,ba.end);if(w.AFrameworkApplication.isRtl&&Q.x>h.x||
!w.AFrameworkApplication.isRtl&&Q.x+Q.width<h.x||Q.y+Q.height<h.y)Q=Do.a.Rq(b,ba.end-1);h.x=Q.x+(w.AFrameworkApplication.isRtl?0:Q.width);h.y=Q.y+Q.height;D=6}Br.a.I6a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,Q.width,Q.height),v,D)}I_(b,h){return this.t8c(b)||Ni.WFc(Eb.a.mergeCells)||Ni.WFc(Eb.a.NHa)||this.Beg(b)||this.Sqj(b,h)||Ni.Grj()||Ni.urj(b).returnValue}t8c(b){return 2===Ya.App.xa.mode&&this.HUc(b)}tIc(b,h,v=null){if(xs.AB()&&2===Ya.App.xa.mode){h=this.c9a.CIh(b.Oa);if(!h||!this.uQm()&&!this.ORm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.t8c(b))return;h=this.bei(b)}var D=lk.a.og(h.lcid);const Q=D?D.name:"UNKNOWN";D=Object(yb.a)(nq.a,h)?h.typeId:"";u.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,D,Q);if(b=this.aJn.L3b(b,h))v.push.apply(v,b),this.x6m(h,D)}ORm(b){return b&&(1===b.proofingType||2===b.proofingType)}uQm(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}x6m(b,h){const v=Ni.XXa[b.proofingType];v&&(w.AFrameworkApplication.va.processAction(v,2),u.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",v,h,b.proofingType,xs.AB()))}bei(b){return this.sn.yna(b.Oa).errorDetails}HUc(b){return this.sn.mfe(b)}o7b(){return null}rGd(){}U8l(b){return this.HUc(b)?this.sn.yna(b.Oa):(b=this.o7b(b))?new dc.a(b.Jp,b.cpEnd):null}Beg(b){if(2!==Ya.App.xa.mode||!b)return!1;b=Ew.a.hDa(b.toArray());
return!!Ni.Wg.mT(b,14)}isj(b,h){return 2===h||3===h&&!this.HUc(b)}Sqj(b,h){return 3!==h||this.HUc(b)}G8k(){const b=[];b.push(Object.assign(new fg.a,{ExternalId:this.Orl}));b.push(Object.assign(new fg.a,{ExternalId:this.Nrl}));b.push(Object.assign(new fg.a,{ExternalId:this.Prl}));return b}Vbl(){const b=[];this.NFe&&b.push(Object.assign(new fg.a,{ExternalId:this.rgf}));return b}static get Gd(){return null!=Ni.FDg?Ni.FDg:Ni.FDg=Ga.a.instance.resolve("Box4.List.IListReader")}static get Wg(){return io.ContextSetEditor.instance}static get cLm(){null==
Ni.jFe&&(Ni.jFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Ni.jFe}static get mZc(){null==Ni.Yqb&&(Ni.Yqb=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Ni.Yqb}static get Dta(){null==Ni.l$&&(Ni.l$=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ni.l$}static WFc(b){return 32===w.AFrameworkApplication.va.processAction(b,
1)}static Grj(){return 2===Ya.App.xa.mode&&!!Ya.App.Bv.NI&&Ya.App.Bv.NI.yVc(Eb.a.w8d.toString())}static Irj(b){if(1!==b.length||!b.Oa.el)return!1;b=ne.GraphIterator.$a(b.Oa.node);b.zb(11);b.sc();return b.Nr(4)&&!Ni.Gd.lw(b).listType?!0:!1}static urj(b){let h=!1,v=!1;if(!b)return{returnValue:!1,oib:h,rRc:v};if(Ni.mZc)return Ni.vvo(b,v);if(!(b.iy||Ni.cLm&&2===b.length&&b.Pc.contextId===Zb.a.endOfParagraph))return{returnValue:!1,oib:h,rRc:v};b=b.Oa.clone();h=32===w.AFrameworkApplication.va.Of(b,Eb.a.K4a,
1,!0,null,null);v=32===w.AFrameworkApplication.va.Of(b,Eb.a.insertHyperlink,1,!0,null,null);return{returnValue:h||v,oib:h,rRc:v}}static vvo(b,h){let v;h=b.Oa.clone();v=Ni.Dta&&Ba.l(h);let D=!v&&32===w.AFrameworkApplication.va.Of(h,Eb.a.K4a,1,!0,null,null);if(b.iy||2===b.length&&b.Pc.contextId===Zb.a.endOfParagraph)h=!v&&32===w.AFrameworkApplication.va.Of(h,Eb.a.insertHyperlink,1,!0,null,null);else{h=!0;const Q=b.length;for(let ba=0;ba<Q;ba++){const ta=b.J(ba).clone();if(ta.contextId===Zb.a.paragraph||
ta.contextId===Zb.a.Hd)(v=Ni.Dta&&Ba.l(ta))||(h=32===w.AFrameworkApplication.va.Of(ta,Eb.a.insertHyperlink,1,!0,null,null)&&h);else if(ta.contextId!==Zb.a.endOfParagraph)return h=D=!1,{returnValue:!1,oib:D,rRc:h}}}return{returnValue:D||h,oib:D,rRc:h}}static sQd(b){const h=Object.assign(new $g.a,{ControlList:[]});for(const v of b)h.ControlList.push(Object.assign(new fg.a,{ExternalId:v}));return h}static sG(b){const h=[];for(const v of b)h.push(Object.assign(new fg.a,{ExternalId:v}));return h}}Ni.jFe=
null;Ni.Yqb=null;Ni.l$=null;Ni.XXa=[];Object(n.a)(Ni,"AEditSurfaceContextMenu",Br.a,[]);var UL=c(592),VL=c(856),XL=c(1764);class $F{static b8l(b,h,v){h=[];v.DFn.L3b(v.pLl(b),h);return h}static CTl(b,h,v){const D=[];if(v.t8c(b))return D;v.K.$("WordEditorIdeasCardsIsEnabled")&&!aa.a.At||v.cef.rGd(b,null,h,D);return D}static mcm(b,h,v){const D=[];v.tIc(b,h,D);return D}}Object(n.a)($F,"ContextMenuSectionHelper",null,[]);class Yq{static pTl(b,h,v){h=[];v.lll(b)&&h.push(Object.assign(new fg.a,{ExternalId:"ReviewDesignerSuggestion",
LabelText:v.p$l(b)}));return h}static m2l(){return Ni.WFc(Eb.a.mergeCells)?Ni.sG(["MergeCells"]):Ni.WFc(Eb.a.rje)?Ni.sG(["SplitCells"]):[]}static Vfm(b,h,v){h=[];if(!v.Fh.sHh(b))return h;b=v.Fh.hii(b);h.push(Object.assign(new fg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new fg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static pOl(b,h,v){return w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Oa&&b.Oa.node&&v.Ic&&v.Ic.xQi(b.Oa.node)?Ni.sG(["ShowCatchUpActivitiesForParagraph"]):[]}static jUl(b){return hp.Luo(b)?Ni.sG(["Draw"]):hp.yrj(b)?Ni.sG(["EditIllustration"]):[]}static Uim(b){return hp.hxo(b)?[Object.assign(new wj.a,{ExternalId:"WrapTextMenu"})]:[]}static sRd(b,h,v){return v.Dll(b)?Ni.sG(["CreatePullQuote"]):[]}static getContentControls(b,
h,v){return v.kll()?Ni.sG(["RemoveContentControl"]):[]}static ZPl(){return Ni.sG(["NewComment"])}static JOl(b){const h=[];!hp.Aeg(b)&&hp.ceg(b)&&ac.SessionStatusManager.instance.OH&&b.NH&&h.push(Object.assign(new wj.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static g_l(b,h,v){h=[];!hp.Aeg(b)&&hp.ceg(b)&&ac.SessionStatusManager.instance.OH&&(u.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.NH&&!w.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
h.push(...Ni.sG(["ChangePicture"])):h.push(...v.X$k().ControlList),(b=hp.v$h())&&0<b.length&&(v=v.Fdl(b),null!=v&&h.push(...v.ControlList)));return h}static R8l(){return Ni.Grj()?Ni.sG(["SetProofingLanguage"]):[]}static z$l(b,h,v){return v.tQm&&v.swo(b)?Ni.sG(["Rewrite"]):[]}static N0l(b){return Ni.Irj(b)?Ni.sG(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static G6l(){return hp.Vrj()?Ni.sG(["ParagraphOptions"]):[]}static ZYl(b){return hp.yrj(b)?Ni.sG(["EditIllustration"]):[]}static ecm(b){return hp.Aeg(b)?
Ni.sG(["ShowSmartLookupPane"]):[]}static ggm(b){return hp.Mrj(b)?Ni.sG(["ModernTranslatorSplitButton"]):[]}static iYl(b,h,v){h=[];if(b.iy){const D=b.Oa;if(D.contextId===Zb.a.paragraph||D.contextId===Zb.a.Tc||D.contextId===Zb.a.Hd){b=b.Oa.node;if(!v.zk.Vb(b)||b.ur||""===b.characterData)return h;v.Dff.tPd(b)&&h.push(...Ni.sG(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,v){h=[];if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.iy){const D=
b.Oa;(We.SelectionEditor.gf(D)||We.SelectionEditor.A2a(D))&&v.FKk.POd(b.Oa.node,b.Oa.cpBegin)&&(h.push(...Ni.sG(["DeleteBookmarkContextMenu"])),w.AFrameworkApplication.te("bookmarks-edit-ex;bookmarks-edit-ex-cf"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&h.push(...Ni.sG(["EditBookmarkNameContextMenu"])))}return h}static Iga(b){let h=!1,v=!1;const D=[];({oib:h,rRc:v}=Ni.urj(b)).returnValue&&(h?v?D.push(...Ni.sG(["EditHyperlink","SelectHyperlink",
"OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):D.push(...Ni.sG(["OpenHyperlink"])):v&&(w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost")?D.push(...Ni.sG(["InsertLinkFlyout"])):D.push(...Ni.sG(["InsertLink"]))));return D}static uPl(b,h,v){const D=[];if(!v.Sqj(b,h))return D;2===Ya.App.xa.mode?(D.push(...v.G8k()),D.push(...v.Vbl()),3===h&&v.HUc(b)&&D.push(Object.assign(new fg.a,{ExternalId:"Delete"}))):(!w.AFrameworkApplication.protectFile&&
!w.AFrameworkApplication.KG||w.AFrameworkApplication.ACb)&&D.push(Object.assign(new fg.a,{ExternalId:"Copy"}));return D}static Zmf(b,h,v){return v.Beg(b)&&v.isj(b,h)?Ni.sG(["EditTableAltText"]):[]}static z$h(b,h,v){return v.vll(b)?Ni.sG(["ShowIntentSuggestion"]):[]}static bem(b,h,v){const D=[];v.Beg(b)&&!v.isj(b,h)&&(D.push(Object.assign(new wj.a,{ExternalId:"InsertTableMenu"})),D.push(Object.assign(new wj.a,{ExternalId:"DeleteTableMenu"})),D.push(Object.assign(new wj.a,{ExternalId:"SelectTableMenu"})));
return D}static hem(b,h,v){return hp.Xb.isFeatureEnabled(109)&&v.Jwo(b)?Ni.sG(["UpdateTableOfContents"]):[]}static UUl(b){return hp.Ruo(b)?Ni.sG(["ShowHideEquationToolsPane"]):[]}}Object(n.a)(Yq,"ContextMenuSectionItemHelper",null,[]);class hp extends Ni{get zk(){return this.eb}get Dff(){return this.FVa}constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd,je,Ld,Qd=!1,ge=null,ze=null,gg,Kg,Ll,Em){super(b,h,v,Qd,void 0,ge,gg);this.pId=Em;this.NNe=this.IP=null;this.GXg=!1;this.$ee=new Map;this.fE=
{};this.ilb={};this.ga=b;this.K=D;this.Fh=Q;this.oW=Ta;this.wI=ob;this.Fm=Kb;this.rnk=!!ge;this.cef=Vb;this.DFn=bc;this.zRg=rd;this.cka=je;this.FKk=Ld;this.FVa=Ll;this.eb=Kg;gd&&gd.execute(up=>{this.Vdh=up});Dc&&Dc.execute(up=>{this.NNe=up});this.Ic=ta;this.Lz=Oc;ze&&ze.execute(up=>{this.IP=up});this.Kwm();this.BDn();this.Xzl();this.ADn()}get rgf(){return this.rnk?Je.a.E9d:super.rgf}Pso(){const b=Jd.App.un.hb.rc.lb.gb.kb;return this.t8c(b)&&2!==this.bei(b).errorType}I_(b,h){return super.I_(b,h)||
hp.Vrj()||Ni.Irj(b)||hp.ceg(b)||hp.Mrj(b)}Qal(b,h,v){const D=[];let Q=null;try{Q=Jd.App.un.hb.rc.lb.gb.kb}catch(ba){u.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.pDn(Q,h,D,this.jRl(Q));b.MenuSectionList.push(...D);this.Ejo(b);!v&&this.Vdh&&this.Vdh.tHn(b.MenuTargetDescriptor.menuTargetType,D)}jRl(b){return Ni.WFc(Eb.a.mergeCells)?Sw.rug:b.YTc?Sw.Wqg:b.NH?Sw.ctg:b.tbc()?Sw.Iqg:hp.DCf&&b.J2a?Sw.Bqg:Sw.drg}Y$k(b){b=hp.lal(b);return Object.assign(new fg.a,
{ExternalId:"SmartLookupContextMenu",LabelText:b})}Gdl(b){return(b=hp.TMj(b))?Object.assign(new fg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}X$k(){const b=Object.assign(new $g.a,{ControlList:[]}),h=hp.v$h();b.ControlList.push(this.Y$k(h));return b}Fdl(b){const h=Object.assign(new $g.a,{ControlList:[]});if(b&&0<b.length){b=this.Gdl(b);if(null==b)return null;h.ControlList.push(b)}return h}Nbc(b){return b.NH||2<b.length||!b.length||2===b.length&&!We.SelectionEditor.Gk(b.Pc)||1===b.length&&
We.SelectionEditor.Gk(b.Pc)?!1:this.TGf(b.Oa)}TGf(b){return de.ParagraphReader.Vb(b.node)?""!==de.ParagraphReader.text(b.node).trim():!1}Jwo(b){var h=ne.GraphIterator.$a(b.Oa.node);h=Object(Ka.a)(UL.a,h.currentNode);return b.NH?!1:!!h&&h.ur}Xzl(){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Lz.execute(b=>{b.isFeatureEnabled(VL.a.IPi,
!1).then(h=>{h||u.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.GXg=h;return null})}):u.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get tQm(){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.GXg:!1}swo(b){if(!this.Nbc(b)||
b.J2a||b.tbc())return!1;b=b.Oa;if(de.ParagraphReader.lm(b)||We.SelectionEditor.gf(b)||We.SelectionEditor.ml(b)){b=this.wI.aPa(b);b||(b=w.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}vll(b){if(1!==b.length||aa.a.At)return!1;const h=w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(h&&this.Pso()||xs.AB()&&!this.c9a.CIh(b.Oa))return!1;const v=hp.Xb.isFeatureEnabled(62);
return b.J(0).contextId===Zb.a.Tc&&(h||v)&&0<this.Fm.uOc(b.J(0),0).count||h&&this.o7b(b)?!0:!1}lll(b){return 1===b.length&&this.zRg.uA(b.Oa.node).mha}p$l(b){var h,v;const D=null===(h=this.pId)||void 0===h?void 0:h.fU(null===(v=null===b||void 0===b?void 0:b.Oa)||void 0===v?void 0:v.node);return XL.a.bii(D)}get Fv(){return null!=this.Cxg?this.Cxg:this.Cxg=Ga.a.instance.Na("WordEditor.Designer.IDesignerTaskPane")}Dll(b){if(!this.cka.vvi()||!this.Fv||this.Fv.isVisible||!(1===b.length||2===b.length&&We.SelectionEditor.Gk(b.Pc))||
b.okb||!We.SelectionEditor.ml(b.Oa)&&b.Oa.contextId!==Zb.a.paragraph||b.RAi()||this.zRg.uA(b.Oa.node).mha)return!1;const h=de.ParagraphReader.text(b.Oa.node),v=b.Oa.contextId===Zb.a.paragraph?0:b.Oa.cpBegin,D=b.Oa.contextId===Zb.a.paragraph?h.length:b.Oa.cpEnd-v;return 1>D||1500<D||G.a.jf(G.a.iya(h.substr(v,D)))||1!=js.a.khb(b.Oa.node)?!1:!0}kll(){return 32==this.ga.processAction(Eb.a.V3c,1)}o7b(b){return this.cef.o7b(b)}rGd(b,h,v,D=null){this.t8c(b)||this.cef.rGd(b,h,v,D)}pLl(b){return this.NNe?
this.NNe.qLl(b):[]}Ejo(b){const h=this.IP?this.IP.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new IE,{menuTargetType:h})}static get Xb(){return null!=hp.Pyg?hp.Pyg:hp.Pyg=Ga.a.instance.resolve("Box4.IFeatureHelper")}static get DCf(){if(null!=hp.MCg)var b=hp.MCg;else{var h;b=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=hp.MCg=b}return b}static ceg(b){return w.AFrameworkApplication.Q_&&
!b.J2a&&Ga.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").RTm()}static tRd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=G.a.pz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static lal(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=hp.tRd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static TMj(b){b=hp.tRd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,
b):null}static v$h(){const b=(new vh.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static yrj(b){const h=hp.Xb.isFeatureEnabled(49);return!b.pHc&&h&&!aa.a.At&&(b.J2a||h&&!hp.DCf&&b.NH)}static Luo(b){const h=hp.Xb.isFeatureEnabled(49);return!b.pHc&&h&&!aa.a.At&&hp.DCf&&b.NH}static Aeg(b){return w.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.tbc()}static Mrj(b){return w.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.J2a&&!b.tbc()}static Ruo(b){return b.SAi()&&
w.AFrameworkApplication.ta.Nb.qVc}static Vrj(){return 2===Jd.App.un.mode}static hxo(b){return b.NH}pDn(b,h,v,D){this.ilb[D].forEach(Q=>{const ba=Object.assign(new $g.a,{ControlList:[]}),ta=ba.ControlList;Q.forEach(Ta=>{Ta instanceof uu?v.push(...this.$ee.get(Ta)(b,h,this)):ta.push(...this.fE[Ta](b,h,this))});(null===ta||void 0===ta?0:ta.length)&&v.push(ba)})}ADn(){this.$ee.set(uu.BRb,$F.b8l);this.$ee.set(uu.Mpe,$F.CTl);this.$ee.set(uu.zqe,$F.mcm)}BDn(){this.fE[Rh.Pqb]=Yq.uPl;this.fE[Rh.Dqe]=Yq.bem;
this.fE[Rh.Eqe]=Yq.hem;this.fE[Rh.Lpe]=Yq.pTl;this.fE[Rh.eqe]=Yq.m2l;this.fE[Rh.ype]=Yq.Zmf;this.fE[Rh.Ype]=Yq.g_l;this.fE[Rh.Lcd]=Yq.z$h;this.fE[Rh.Xpe]=Yq.ZYl;this.fE[Rh.yqe]=Yq.ecm;this.fE[Rh.Gqe]=Yq.ggm;this.fE[Rh.lqe]=Yq.R8l;this.fE[Rh.oqe]=Yq.z$l;this.fE[Rh.Ncd]=Yq.N0l;this.fE[Rh.Qcd]=Yq.G6l;this.fE[Rh.mqe]=Yq.sRd;this.fE[Rh.xcd]=Yq.getContentControls;this.fE[Rh.$qe]=Yq.Uim;this.fE[Rh.Npe]=Yq.jUl;this.fE[Rh.Fpe]=Yq.JOl;this.fE[Rh.Fqe]=Yq.Vfm;this.fE[Rh.Epe]=Yq.pOl;this.fE[Rh.vcd]=Yq.getBookmark;
this.fE[Rh.Tpe]=Yq.iYl;this.fE[Rh.Vpe]=Yq.Iga;this.fE[Rh.Nqb]=Yq.ZPl;this.fE[Rh.Lcd]=Yq.z$h;this.fE[Rh.Ope]=Yq.UUl}Kwm(){const b=[Rh.eqe,Rh.ype,Rh.Dqe];this.ilb[Sw.rug]=[[Rh.Pqb],b,[Rh.Nqb],[uu.BRb],[Rh.xcd]];this.ilb[Sw.ctg]=[[Rh.Pqb],[Rh.Fpe,Rh.Npe,Rh.$qe],b,[Rh.Nqb],[uu.BRb]];this.ilb[Sw.Iqg]=[[Rh.Ope],[Rh.Ncd,Rh.Qcd],[Rh.vcd,Rh.Nqb],[uu.BRb]];this.ilb[Sw.drg]=[[Rh.Lcd],[Rh.Lpe],[uu.zqe],[uu.Mpe],[Rh.Pqb],[Rh.Ype,Rh.Xpe,Rh.yqe,Rh.Gqe],[Rh.lqe,Rh.oqe,Rh.Qcd],[Rh.Ncd],b,[Rh.xcd],[Rh.Vpe,Rh.vcd,Rh.Tpe,
Rh.Nqb],[Rh.mqe],[Rh.Fqe],[Rh.Epe],[Rh.Eqe],[uu.BRb]];this.ilb[Sw.Wqg]=[[Rh.Pqb],[Rh.Nqb]];this.ilb[Sw.Bqg]=[[Rh.Pqb],[Rh.Xpe]];this.ilb[Sw.XOj]=[[Rh.Lcd],[Rh.Lpe],[uu.zqe],[uu.Mpe],[Rh.Pqb],[Rh.Fpe],[Rh.Npe],[Rh.$qe],[Rh.Ype],[Rh.yqe],[Rh.Gqe],[Rh.lqe],[Rh.oqe],[Rh.Ope],[Rh.Ncd],[Rh.Qcd],[Rh.Vpe],[Rh.eqe],[Rh.ype],[Rh.Dqe],[Rh.vcd],[Rh.Tpe],[Rh.Nqb],[Rh.mqe],[Rh.xcd],[Rh.Fqe],[Rh.Epe],[Rh.Eqe],[uu.BRb]]}}Object(n.a)(hp,"EditSurfaceContextMenu",Ni,[]);var Sw;(function(b){b[b.rug=1]="TABLE_MULTI_CELL";
b[b.drg=2]="GENERIC";b[b.ctg=3]="PICTURE";b[b.Iqg=4]="EQUATION";b[b.XOj=5]="LEGACY";b[b.Wqg=6]="FLUID";b[b.Bqg=7]="DRAWING"})(Sw||(Sw={}));Object(n.b)("Scenarios",Sw);class uu{}uu.BRb=new uu;uu.Mpe=new uu;uu.zqe=new uu;Object(n.a)(uu,"Sections",null,[]);var Rh;(function(b){b[b.Lcd=1]="INTENT_SUGGESTION";b[b.Pqb=2]="ESSENTIALS";b[b.Ype=3]="INSIGHT";b[b.Xpe=4]="ILLUSTRATION";b[b.yqe=5]="SMART_LOOKUP";b[b.Gqe=6]="TRANSLATE";b[b.lqe=7]="PROOFING";b[b.oqe=8]="REWRITE_SUGGESTIONS";b[b.Ncd=9]="LISTS";b[b.Qcd=
10]="PARAGRAPH_OPTIONS";b[b.eqe=11]="MERGE_SPLIT_CELLS";b[b.ype=12]="ALT_TEXT";b[b.Vpe=13]="HYPERLINK";b[b.vcd=14]="BOOKMARK";b[b.Tpe=15]="HEADING_LINK";b[b.Nqb=16]="COMMENT";b[b.mqe=17]="PULL_QUOTE";b[b.$qe=18]="WRAP_TEXT";b[b.Npe=19]="DRAW";b[b.Fqe=20]="TRACK_CHANGE";b[b.Epe=21]="CATCHUP_ACTIVITIES";b[b.Eqe=22]="TABLE_OF_CONTENTS";b[b.Lpe=23]="DESIGNER_REVIEW";b[b.Dqe=24]="TABLE_ITEMS";b[b.Fpe=25]="CHANGE_PICTURE";b[b.Ope=26]="EQUATION_TOOLS";b[b.xcd=27]="CONTENT_CONTROL"})(Rh||(Rh={}));Object(n.b)("SectionItem",
Rh);class iD extends Br.a{constructor(b,h,v){super();this.ul=null;this.v$d=(D,Q,ba,ta,Ta)=>{if(1===ba)return 32;D=[];Q=[];this.Qso()&&Q.push("InsertTabStopMenuSplitButton");this.Aso()&&Q.push("ClearAllTabStops");Q.push("HideRuler");D.push(iD.sQd(Q));Q=Object.assign(new Yd.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});Q.MenuSectionList.push(...D);Ta.MenuItems=Q;return 32};this.ga=b;this.Wm=h;this.Ty=v;this.Tb()}get dab(){return document.getElementById("WACHorizontalRuler")}get yN(){return this.Wm&&
this.Wm.instance?this.Wm.instance.hj:1}get target(){return this.ul}show(b,h){this.ul=b;Br.a.Nob("RulerContextMenu",b,h);u.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",iD.bP);b.set("Response","Ruler Context menu invoked.");wa.Health.instance.recordKpiUsage(iD.kpiName,1,iD.f8,b)}T9l(){var b=0,h=(this.target.x-Id.a.Enf(this.dab))/this.yN;h=Cf.a.Cy(h,0);var v={},D=this.Ty.k6b,Q=ne.GraphIterator.$a(D);Q.vd();if(!rh.TableReader.ex(Q))return 32===
this.ga.Qb(Eb.a.KGa,2,v)&&(b=v.marginLeft),h-b;b={};Q={};v=this.ga.Qb(Eb.a.T2c,2,b);var ba=this.ga.Qb(Eb.a.jMb,2,Q);if(32!==v||32!==ba)return u.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ba=Q.TablePosition;if(!ba||!b||0>=b.length)return u.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;v=0;Q=ne.GraphIterator.$a(D);Q.zb(14)&&(Q.jd(16),v=hw.a(Q,!0));D=ba.x/this.yN;for(Q=0;Q<v;Q++)D+=b[Q];return h-
D}Tb(){this.ga.fb(sc.a.v$d,Zb.a.application,this.v$d,96)}Qso(){var b={},h={},v=this.ga.Qb(Eb.a.KGa,2,b),D=this.ga.Qb(Eb.a.m5a,2,h);if(32===v&&32===D){D=h.zt;v=Cf.a.Mi(D.foa,0);D=1===D.specialIndentType?Cf.a.Mi(D.zB,0):Cf.a.Mi(D.zB-D.mda,0);const Q=Cf.a.Mi(b.marginLeft,0);b=Cf.a.Mi(b.marginRight,0);const ba=Id.a.Enf(this.dab),ta=Id.a.r4h(this.dab);h.isRtl?(h=ba+this.yN*Math.max(b,b+v),v=ta-this.yN*Math.max(Q,Q+D)):(h=ba+this.yN*Math.max(Q,Q+D),v=ta-this.yN*Math.max(b,b+v));if(this.target.x>=h&&this.target.x<=
v)return!0}return!1}Aso(){var b={};if(32!==this.ga.Qb(sc.a.XLb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static sQd(b){const h=Object.assign(new $g.a,{ControlList:[]});for(const v of b)h.ControlList.push(Object.assign(new fg.a,{ExternalId:v}));return h}}iD.f8="wwaengidc";iD.kpiName="WordRuler";iD.bP="RulerContextMenu";Object(n.a)(iD,"RulerContextMenu",Br.a,[691]);let iB;class Eq{static get wc(){return null!=Eq.kJg?Eq.kJg:Eq.kJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get ZG(){return null!=
Eq.cJg?Eq.cJg:Eq.cJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get rj(){return null!=Eq.VAg?Eq.VAg:Eq.VAg=Ga.a.instance.resolve("Box4.IInsertionPointFormatting")}static V3i(b,h,v){if(1===h)return(b?Eq.nSk(v):Eq.NRk(v))?32:8;(b=Eq.ddm(b,v))&&Eq.xEk(b,v);return 32}static xEk(b,h){const v=new ah.GraphTransaction(15);v.Cb(h);Eq.rj.N5a();Eq.ZG.PJ(b,h,!1);v.dispose()}static nSk(b){b=Eq.wc.No(b);return!!b&&Eq.wc.pg(b)!==hj.StyleReader.wordStyleIdHeading1}static NRk(b){b=Eq.wc.No(b);return!!b&&
Eq.wc.pg(b)!==hj.StyleReader.o8a}static ddm(b,h){const v=Eq.wc.No(h);return v?Eq.wc.MC(h).Pi(Eq.bdm(b,Eq.wc.pg(v))):null}static bdm(b,h){h=Eq.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<Eq.headingsList.count?Eq.headingsList.J(b):null}}Eq.headingsList=(iB=new zb.a,iB.add(hj.StyleReader.wordStyleIdHeading1),iB.add(hj.StyleReader.wordStyleIdHeading2),iB.add(hj.StyleReader.wordStyleIdHeading3),iB.add(hj.StyleReader.l8a),iB.add(hj.StyleReader.m8a),iB.add(hj.StyleReader.n8a),iB.add(hj.StyleReader.Eqb),
iB.add(hj.StyleReader.Fqb),iB.add(hj.StyleReader.o8a),iB);Object(n.a)(Eq,"NavigationPaneEditor",null,[]);class BF extends Br.a{constructor(){super();this.u3=null;this.m$d=(b,h,v,D,Q)=>{if(1===v)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Br.a.j2h("promoteHeading",sc.a.jae,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Br.a.j2h("demoteHeading",
sc.a.kId,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");Q.PopulationXML=b.toString();return 32};this.jae=(b,h,v)=>Eq.V3i(!0,v,this.u3.Bb);this.kId=(b,h,v)=>Eq.V3i(!1,v,this.u3.Bb)}show(b){BF.Ah||(this.w3b(),BF.Ah=!0);Br.a.showContextMenu("mnuNavPaneWordEditor",b)}w3b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+sc.a.x1i;b.Command=""+Ua.a.Pla;Br.a.b9k(b);w.AFrameworkApplication.va.qa(sc.a.x1i,
Zb.a.application,this.m$d);w.AFrameworkApplication.va.qa(sc.a.jae,Zb.a.view,this.jae);w.AFrameworkApplication.va.qa(sc.a.kId,Zb.a.view,this.kId)}}BF.Ah=!1;Object(n.a)(BF,"WordEditorNavigationPaneContextMenu",Br.a,[695]);var Gx=c(279),mC=c(1469),YL=c(449),ZL=c(741),aG=c(1189),PG=c(1694),QG=c(998);class bG{constructor(){this.E8=this.qxi=!1;this.TPb=2;this.rw=0;this.t8a=1}}Object(n.a)(bG,"WrapTextPropertiesData",null,[]);class Yl extends aG.a{constructor(b=null){super(b);this.aeh=new PG.a;this.qlh=new bG;
this.Ahh=new QG.a;this.hCe=!1;this.voi=h=>{const v=new Gx.a;v.ODa=!0;v.aM=h;return v};this.N0=()=>{const h=new Gx.a;h.NFb=!1;h.aM=Eb.a.KGa;h.xd=this.aeh;h.gbc=!0;h.qha=!0;return h};this.T4i=()=>{const h=new Gx.a;h.NFb=this.hCe;this.hCe=!0;h.aM=Eb.a.n5a;h.xd=this.Ahh;h.gbc=!0;h.qha=!0;return h};this.bcd=()=>{const h=new Gx.a;h.NFb=!1;h.aM=sc.a.Dgc;h.xd=this.qlh;h.gbc=!0;h.qha=!0;return h};this.AVd=(h,v)=>{const D=new Gx.a;D.xd=new fh.DictionaryPropertySet;switch(h){case sc.a.IRc:D.xd.setValue(wc.a.Jib,
v[kh.a.Number]);break;case sc.a.BRc:D.xd.setValue(wc.a.Gib,v[kh.a.Number]);break;case sc.a.CRc:D.xd.setValue(wc.a.Hib,v[kh.a.Number]);break;case sc.a.DRc:D.xd.setValue(wc.a.Iib,v[kh.a.Number])}return D};this.yKn=()=>{const h=new Gx.a;h.xd=new fh.DictionaryPropertySet;h.qha=!0;return h}}initialize(){super.initialize();this.kd.Z(sc.a.rIf,mC.a.Tib);this.kd.Z(sc.a.wIf,mC.a.Tib);this.kd.Z(sc.a.yIf,mC.a.Tib);this.kd.Z(sc.a.w1f,Yl.$Ra);this.kd.Z(sc.a.M2c,Yl.$Ra);this.kd.Z(sc.a.p1f,Yl.$Ra);this.kd.Z(Ua.a.mMb,
Yl.$Ra);this.kd.Z(Eb.a.Tae,this.N0);this.kd.Z(Eb.a.Sae,this.N0);this.kd.Z(Eb.a.Rae,this.N0);this.kd.Z(Eb.a.Vae,this.N0);this.kd.Z(Eb.a.Uae,this.N0);this.kd.Z(Eb.a.Qae,this.N0);this.kd.Z(Eb.a.bbe,this.N0);this.kd.Z(Eb.a.abe,this.N0);this.kd.Z(Eb.a.$ae,this.N0);this.kd.Z(Eb.a.Xae,this.N0);this.kd.Z(Eb.a.Yae,this.N0);this.kd.Z(Eb.a.Zae,this.N0);this.kd.Z(Eb.a.J1f,this.N0);this.kd.Z(Eb.a.I1f,this.N0);this.kd.Z(Eb.a.Z0f,this.N0);this.kd.Z(Eb.a.a1f,this.N0);this.kd.Z(Eb.a.$0f,this.N0);this.kd.Z(Eb.a.Y0f,
this.N0);this.kd.Z(Eb.a.x6a,Yl.E9m);this.kd.Z(Eb.a.$Sa,Yl.dyn);this.kd.Z(Eb.a.fob,Yl.V_k);this.kd.Z(Eb.a.Vla,Yl.$Ra);this.kd.Z(Eb.a.vLb,Yl.$Ra);this.kd.Z(Eb.a.dSa,Yl.$Ra);this.kd.Z(Eb.a.Ota,Yl.$Ra);this.kd.Z(Eb.a.Yxa,Yl.$Ra);this.kd.Z(sc.a.z1c,Yl.$Ra);this.kd.Z(sc.a.IMd,mC.a.glf);this.kd.Z(sc.a.JMd,this.S2h);this.Nm.Z(sc.a.x1c,mC.a.SNa);this.Nm.Z(sc.a.y1c,mC.a.SNa);this.kd.Z(Eb.a.nOb,mC.a.k0a);this.kd.Z(Eb.a.mOb,mC.a.k0a);this.kd.Z(Eb.a.uob,mC.a.k0a);this.kd.Z(Eb.a.V1f,this.sF);this.kd.Z(Eb.a.T1f,
this.sF);this.kd.Z(Eb.a.U1f,this.sF);this.kd.Z(Eb.a.rL,Yl.RIn);this.Nm.Z(sc.a.Cbe,Yl.Q3c);this.Nm.Z(sc.a.Dbe,Yl.Q3c);this.Nm.Z(sc.a.Ebe,Yl.Q3c);this.Nm.Z(sc.a.Abe,Yl.Q3c);this.Nm.Z(sc.a.Bbe,Yl.Q3c);this.kd.Z(sc.a.Cbe,this.bcd);this.kd.Z(sc.a.Dbe,this.bcd);this.kd.Z(sc.a.Ebe,this.bcd);this.kd.Z(sc.a.Abe,this.bcd);this.kd.Z(sc.a.Bbe,this.bcd);this.kd.Z(sc.a.kpe,Yl.pnc);this.kd.Z(sc.a.lpe,Yl.pnc);this.kd.Z(sc.a.mpe,Yl.pnc);this.kd.Z(sc.a.npe,Yl.pnc);this.kd.Z(sc.a.ope,Yl.pnc);this.kd.Z(sc.a.ppe,Yl.pnc);
this.kd.Z(sc.a.EHa,Yl.B6b);this.kd.Z(sc.a.nrj,Yl.B6b);this.kd.Z(sc.a.orj,Yl.B6b);this.kd.Z(sc.a.mie,Yl.B6b);this.kd.Z(sc.a.nie,Yl.B6b);this.kd.Z(sc.a.h8c,Yl.B6b);this.kd.Z(sc.a.hnb,this.yKn);this.kd.Z(sc.a.x2c,Yl.oNd);this.kd.Z(sc.a.Jae,Yl.oNd);this.kd.Z(sc.a.Kae,Yl.oNd);this.kd.Z(sc.a.Lae,Yl.oNd);this.kd.Z(sc.a.IRc,this.AVd);this.kd.Z(sc.a.BRc,this.AVd);this.kd.Z(sc.a.CRc,this.AVd);this.kd.Z(sc.a.DRc,this.AVd);this.kd.Z(Eb.a.Yna,this.voi);this.kd.Z(Eb.a.fCb,this.voi);this.kd.Z(sc.a.fnb,Yl.fnb);this.kd.Z(sc.a.vie,
mC.a.k0a);this.kd.Z(Eb.a.Z1f,this.T4i);this.kd.Z(Eb.a.$1f,this.T4i)}clearCache(){super.clearCache();this.hCe=!1;this.aeh=new PG.a;this.qlh=new bG;this.Ahh=new QG.a}Rof(){const b=super.Rof();b.mCa=Yl.mCa;b.iZa=Yl.iZa;return b}static get Exn(){return null!=Yl.EEg?Yl.EEg:Yl.EEg=Ga.a.instance.Na("WordEditor.IPageCommandStringBuilder")}static get Ez(){Yl.gta||(Yl.gta=Ga.a.instance.Na("WordEditor.ITableBorderManager"));return Yl.gta}static $Ra(b,h){b=new Gx.a;b.xd=h;return b}static V6c(b,h,v){h[Ff.a.Description]=
b?b.B9m(v):null}static mCa(b,h){const v=Object(Ka.a)(PG.a,b.xd),D=Object(Ka.a)(YL.a,b.xd),Q=Object(Ka.a)(bG,b.xd),ba=Object(Ka.a)(QG.a,b.xd);let ta=!0;const Ta=Yl.Exn;switch(b.umb){default:ta=aG.a.mCa(b,h);break;case Eb.a.Tae:h[Aj.a.Icon]=v.Fwa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Ff.a.On]=!v.oJb;Yl.V6c(Ta,h,0);break;case Eb.a.Sae:h[Aj.a.Icon]=v.Fwa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Ff.a.On]=1===v.oJb;Yl.V6c(Ta,h,1);break;case Eb.a.Rae:h[Aj.a.Icon]=
v.Fwa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Ff.a.On]=2===v.oJb;Yl.V6c(Ta,h,2);break;case Eb.a.Vae:h[Aj.a.Icon]=v.Fwa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[Ff.a.On]=3===v.oJb;Yl.V6c(Ta,h,3);break;case Eb.a.Uae:h[Aj.a.Icon]=v.Fwa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Ff.a.On]=4===v.oJb;Yl.V6c(Ta,h,4);break;case Eb.a.Qae:h[Aj.a.Icon]=v.Fwa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Ff.a.On]=
5===v.oJb;break;case Eb.a.bbe:h[Ff.a.On]=!v.UKb;h[Ff.a.Description]=Ta?Ta.D0c(0):null;break;case Eb.a.abe:h[Ff.a.On]=1===v.UKb;h[Ff.a.Description]=Ta?Ta.D0c(1):null;break;case Eb.a.$ae:h[Ff.a.On]=2===v.UKb;h[Ff.a.Description]=Ta?Ta.D0c(2):null;break;case Eb.a.Xae:h[Ff.a.On]=3===v.UKb;h[Ff.a.Description]=Ta?Ta.D0c(3):null;break;case Eb.a.Yae:h[Ff.a.On]=4===v.UKb;h[Ff.a.Description]=Ta?Ta.D0c(4):null;break;case Eb.a.Zae:h[Ff.a.On]=5===v.UKb;break;case Eb.a.J1f:h[Ff.a.On]=!v.Fwa;break;case Eb.a.I1f:h[Ff.a.On]=
v.Fwa;break;case Eb.a.Z0f:h[Ff.a.On]=1===v.LGc;break;case Eb.a.a1f:h[Ff.a.On]=2===v.LGc;break;case Eb.a.$0f:h[Ff.a.On]=3===v.LGc;break;case Eb.a.Y0f:h[Ff.a.On]=0===v.LGc;break;case Eb.a.V1f:h[Ff.a.On]=D.zt?!D.zt.specialIndentType:!1;break;case Eb.a.T1f:h[Ff.a.On]=D.zt?1===D.zt.specialIndentType:!1;h[cl.a.Image16by16Class]=D.isRtl?pd.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):pd.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Eb.a.U1f:h[Ff.a.On]=D.zt?2===D.zt.specialIndentType:
!1;h[cl.a.Image16by16Class]=D.isRtl?pd.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):pd.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case sc.a.Cbe:h[Ff.a.On]=1===Q.t8a;break;case sc.a.Dbe:h[Ff.a.On]=8===Q.t8a;break;case sc.a.Ebe:h[Ff.a.On]=9===Q.t8a;break;case sc.a.Abe:h[Ff.a.On]=3===Q.t8a;break;case sc.a.Bbe:h[Ff.a.On]=4===Q.t8a;break;case sc.a.hnb:h[Ff.a.On]=b.xd.ia(wc.a.Bwa,!1);break;case sc.a.fnb:h[mi.a.IsFreeForm]=!0;h[mi.a.Value]=b.xd[rr.a.Value];break;case Eb.a.Z1f:h[Fi.a.On]=
Yl.Ez.p4h(h.MenuItemId)===ba.lineStyle;break;case Eb.a.$1f:h[Fi.a.On]=Yl.Ez.q4h(h.MenuItemId)===ba.xXc}return ta}static E9m(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Gx.a;h.xd=b;return h}static dyn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Gx.a;h.xd=b;return h}static V_k(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Gx.a;h.xd=b;return h}static fnb(){const b=new Gx.a;b.aM=sc.a.fnb;b.xd={};b.qha=!0;b.gbc=!0;return b}static pnc(b,h){const v=new Gx.a;v.xd=new fh.DictionaryPropertySet;let D=1;switch(b){case sc.a.npe:D=1;break;case sc.a.ope:D=8;break;case sc.a.ppe:D=9;break;case sc.a.lpe:D=
3;break;case sc.a.mpe:D=4}v.xd.setValue(wc.a.t8a,D);v.xd.setValue(wc.a.LHa,h[Ff.a.SourceControlId]);return v}static B6b(b,h,v){b=new Gx.a;b.xd=v.InvocationMethod;return b}static RIn(b,h){b=new Gx.a;b.xd=h;return b}static Q3c(){const b=new ZL.a;b.aM=sc.a.Dgc;return b}static oNd(){const b=new Gx.a;b.xd=new fh.DictionaryPropertySet;b.oVc=!0;return b}static iZa(b,h){let v=!0;switch(b.umb){case sc.a.x2c:b=b.xd.ia(wc.a.Jib,0);h[kh.a.Number]=b;h[kh.a.UnitType]=7;break;case sc.a.Jae:b=b.xd.ia(wc.a.Gib,0);
h[kh.a.Number]=b;h[kh.a.UnitType]=7;break;case sc.a.Kae:b=b.xd.ia(wc.a.Hib,0);h[kh.a.Number]=b;h[kh.a.UnitType]=7;break;case sc.a.Lae:b=b.xd.ia(wc.a.Iib,0);h[kh.a.Number]=b;h[kh.a.UnitType]=7;break;default:v=aG.a.iZa(b,h)}return v}}Yl.gta=null;Object(n.a)(Yl,"CuiActionBridge",aG.a,[]);class RG extends Vf.a{constructor(b){super();this.p0k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.Bpo=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.sId=this.mxb=this.l6=this.QWa=this.ARe=null;this.Ub=
b;this.Xg="<div id='AccessibilityHelpDialogBody'></div>";this.wg="AAccessibilityHelpDialog";this.Ad=6;this.Ee(0,CommonUIStrings.l_DialogClose)}get bef(){return null}get yhe(){this.ARe||(this.ARe=this.Xxm());return this.ARe}get vFo(){return 300}get sOi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get rOi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get x_a(){return this.Ub.Ss()}TSa(b){super.TSa(b);this.$Cn()}jTa(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.Tok,
"accHelpDialogResultHandler"));this.RGa();this.setFocus()}setFocus(){this.l6?(this.mxb=this.l6.tBodies[0].firstChild,this.R0(this.mxb)):this.aH&&"none"!==this.aH.style.display?this.R0(this.aH):this.R0(this.Mz)}Zla(){this.ae.mb(Sc.a.fi,this.sId,Object(z.a)(this,this.Klh,"accHelpDialogKeydownHandler"));if(this.l6){this.ae.mb(Sc.a.uh,this.l6,Object(z.a)(this,this.lxj,"tableOnKeyUpHandler"));const b=this.l6.tBodies[0].children;for(let h=0;h<b.length;h++)if(lf.a.addHandler(b[h],Sc.a.focus,Object(z.a)(this,
this.bfj,"rowOnFocusHandler")),lf.a.addHandler(b[h],Sc.a.blur,Object(z.a)(this,this.afj,"rowOnBlurHandler")),aa.a.At){const v=b[h].children;for(let D=0;D<v.length;D++)lf.a.addHandler(v[D],Sc.a.focus,Object(z.a)(this,this.xBh,"cellOnFocusHandler"))}}super.Zla()}Bfb(){this.ae&&(this.ae.uc(Sc.a.fi,this.sId,Object(z.a)(this,this.Klh,"accHelpDialogKeydownHandler")),this.l6&&this.ae.uc(Sc.a.uh,this.l6,Object(z.a)(this,this.lxj,"tableOnKeyUpHandler")));if(this.l6){const b=this.l6.tBodies[0].children;for(let h=
0;h<b.length;h++)if(lf.a.removeHandler(b[h],Sc.a.focus,Object(z.a)(this,this.bfj,"rowOnFocusHandler")),lf.a.removeHandler(b[h],Sc.a.blur,Object(z.a)(this,this.afj,"rowOnBlurHandler")),aa.a.At){const v=b[h].children;for(let D=0;D<v.length;D++)lf.a.removeHandler(v[D],Sc.a.focus,Object(z.a)(this,this.xBh,"cellOnFocusHandler"))}}super.Bfb()}RGa(){this.x_a.scope.ir(this.Ub.vW);this.x_a.scope.ir(this.Ub.wW);this.x_a.scope.bindAction(this.Ub.vW,Ua.a.fDc);this.x_a.scope.bindAction(this.Ub.wW,Ua.a.eDc)}fom(b){if(!this.x_a.Zj||
!this.x_a.Zj.u3)return 2;var h=this.x_a.Zj.u3;if(this.l6&&(h===this.Mz&&b===Ua.a.fDc||h===this.QWa&&b===Ua.a.eDc))this.R0(this.mxb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Ua.a.fDc?h=this.QWa:b===Ua.a.eDc&&(h=this.Mz),h&&this.R0(h);else if(b===Ua.a.fDc)this.x_a.Kdc();else if(b===Ua.a.eDc)this.x_a.Idc();else return 2;return 32}bfj(b){b.target.setAttribute(Ze.a.Hdb,Ze.a.np);Sys.UI.DomElement.removeCssClass(this.mxb,"inactiveRowSelection");this.mxb=b.target}afj(b){b.target.removeAttribute(Ze.a.Hdb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}xBh(b){(b=b.target.parentNode)&&b!==this.mxb&&this.R0(b)}lxj(b){return b.Gb.keyCode===zf.a.Bs?(b.Gb.stopPropagation(),!0):!1}Klh(b){if(!b.Gb)return!1;const h=b.Gb.keyCode;if(b.eventName===Sc.a.fi){b=this.KZl(this.mxb);let v=-1;const D=lb.a.count(this.yhe)-1;h===Sys.UI.Key.down?v=b<D?b+1:0:h===Sys.UI.Key.up?v=0<b?b-1:D:h===Sys.UI.Key.home?v=0:h===Sys.UI.Key.end&&(v=D);-1!==v&&this.R0(this.l6.tBodies[0].children[v])}return!0}Tok(){}$Cn(){this.sId=
document.getElementById("AccessibilityHelpDialogBody")||this.Sp;this.Cdl();this.hdl();this.Xal()}Cdl(){if(this.bef){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.bef;b.appendChild(h);this.gka.appendChild(b)}}hdl(){if(this.yhe&&!lb.a.isEmpty(this.yhe)){this.l6=document.createElement("table");this.l6.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Ze.a.qh,
Ze.a.EEc);b.appendChild(h);var v=jc.a.ZHc(14,this.p0k);h.appendChild(v);v=jc.a.ZHc(14,this.Bpo);h.appendChild(v);this.l6.appendChild(b);b=document.createElement("tbody");h=0;v=this.yhe;for(let ba in v){var D=ba,Q=v[ba];const ta=document.createElement("tr");ta.tabIndex=0;ta.setAttribute(Ze.a.qh,Ze.a.EEc);ta.id="SelectableTableRow"+h++;D=jc.a.ZHc(15,D);ta.appendChild(D);Q=jc.a.ZHc(15,Q);ta.appendChild(Q);b.appendChild(ta)}b.style.maxHeight=this.vFo+"px";this.l6.appendChild(b);this.sId.appendChild(this.l6)}}Xal(){if(this.rOi&&
this.sOi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.QWa=document.createElement("a");this.QWa.innerText=this.rOi;this.QWa.href=this.sOi;this.QWa.target="_blank";this.QWa.id=this.kj("AccessibilityHelpDialogLink");this.QWa.className=gf.AFrame.i0e;b.appendChild(this.QWa);this.Hc.insertBefore(b,this.Hc.lastChild)}}KZl(b){return Number.parseInvariant(b.id.substr(18))}RZ(b,h,v,D=null){b&&h&&v&&(v=D?String.format(v,D):v,b[h]=v)}igi(b,h){return aa.a.fl?h:b}}Object(n.a)(RG,
"AAccessibilityHelpDialog",Vf.a,[1302]);class aE extends RG{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get bef(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}Xxm(){const b=this.igi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.igi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),v={};this.RZ(v,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.RZ(v,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.RZ(v,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.RZ(v,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.RZ(v,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.RZ(v,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.RZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(aE.Xb&&aE.Xb.isFeatureEnabled(62)||w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.RZ(v,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);
return v}static get Xb(){return null!=aE.Jyg?aE.Jyg:aE.Jyg=Ga.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(aE,"AccessibilityHelpDialog",RG,[]);var SH=c(327);class cG{static get Xg(){return Vf.a.qA(cG.Lm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}cG.Lm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(n.a)(cG,"ApplyStylesDialogHtml",null,[]);class JE extends Vf.a{constructor(b,h){super();this.oH=null;this.CBc=!1;this.xyb=this.d9a=this.Yxc=this.ayc=this.SBc=null;this.cFk=(v,D)=>{if(this.mh.hv){if(v){v=D.styleList;D=D.styleText;if(-1===v||G.a.Ug(D)!==G.a.Ug(this.oH[v]))v=this.Cgi(D);D=this.oH[v];v=this.wc.Mr();D=this.wc.pg(v.Rva(D));w.AFrameworkApplication.va.Of(this._context,Eb.a.applyStyle,2,!1,new SH.a,D)}this.mh.x5()}};this.Rtn=v=>{this.CBc?(this.CBc=!1,this.validate()):"value"===v.rawEvent.propertyName&&
(this.CBc=!0,this.LZ.value!==this.SBc&&(this.SBc=this.LZ.value,this.wvh()))};this.kpn=()=>{-1!==this.tla.selectedIndex&&(aa.a.l4&&(this.CBc=!0),this.SBc=this.oH[this.tla.selectedIndex],this.LZ.value=this.oH[this.tla.selectedIndex],this.validate())};this.onKeyDown=v=>{aa.a.SJ?v.keyCode!==zf.a.cC&&v.keyCode!==zf.a.s1||this.d9a||this.xyb||(this.xyb=new of.a(0,1,1,this.i0o),w.AFrameworkApplication.pc.Wb(this.xyb)):aa.a.l4&&v.keyCode===zf.a.cC&&(this.CBc=!0)};this.GG=()=>{this.d9a||(this.d9a=new of.a(0,
1,1,this.HHk),w.AFrameworkApplication.pc.Wb(this.d9a));this.xyb&&(w.AFrameworkApplication.pc.We(this.xyb),this.xyb=null)};this.HHk=()=>{this.d9a=null;this.wvh()};this.i0o=()=>{this.xyb=null;this.validate()};this._context=b;this.ld=h;this.wg="ApplyStylesDialog";this.mh=this._context.view;this.cuf();b=this.gDo();h="";this.oH.length>b&&(h=this.oH[b]);h={["styleText"]:h,["styleList"]:b};this.Xg=cG.Xg;this.Yh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.cFk,h);this.tla=document.getElementById("styleList");
this.IZf();this.tla.selectedIndex=b;this.LZ=document.getElementById("styleText");this.LZ.focus();this.LZ.select();this.Qpd=this.kpn;lf.a.addHandler(this.tla,"change",this.Qpd);this.Ppd=this.onKeyDown;lf.a.addHandler(this.LZ,"keydown",this.Ppd);aa.a.l4?(this.ayc=this.Rtn,lf.a.addHandler(this.LZ,"propertychange",this.ayc),this.SBc=this.oH[b]):(this.Yxc=this.GG,lf.a.addHandler(this.LZ,"keypress",this.Yxc))}get wc(){return null!=this.lJg?this.lJg:this.lJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}gDo(){var b=
this.mh.lb;if(!b||!b.gb)return Lc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.gb.kb;if(!b)return Lc.b(579216409,3018,15,"CurrentSelection is null"),0;de.ParagraphReader.lm(b.Oa)&&(b=We.SelectionEditor.xj(b,!0,!1));b=b.Oa;if(!b||!We.SelectionEditor.jv(b))return Lc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Hn.FormattingReader.Kr(b);(h=Hn.FormattingReader.Ona(h))||(h=this.wc.No(b.node));if(!h)return 0;b=this.wc.vM(h);b=Array.indexOf(this.oH,
b);0>b&&(b=0);return b}IZf(){const b=this.oH.length;for(let h=0;h<b;h++){const v=document.createElement("OPTION");v.value=h.toString();v.text=this.oH[h];this.tla.add(v,null)}}cuf(){var b=Pl.a.Lr();if(b){b=(new Jv.WACStyleSet).TQ(b);var h=b.lO,v=this.ld.isFeatureEnabled(111)&&!!this.wc.Fg;this.oH=[];for(let D=0;D<h;D++){const Q=b.yEa(D);if(this.wc.isHidden(Q))continue;const ba=this.wc.yG(Q);if(!v){if(3===ba)continue}else if(3===ba&&this.wc.pg(Q)===Pv.a.tpg)continue;Array.add(this.oH,this.wc.vM(Q))}this.oH.sort(JE.Y1k)}else Lc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.ayc&&lf.a.removeHandler(this.LZ,"propertychange",this.ayc);this.Ppd&&lf.a.removeHandler(this.LZ,"keydown",this.Ppd);this.Qpd&&lf.a.removeHandler(this.tla,"change",this.Qpd);this.Yxc&&lf.a.removeHandler(this.LZ,"keypress",this.Yxc);this.d9a&&w.AFrameworkApplication.pc.We(this.d9a);this.d9a=this.Yxc=this.tla=this.LZ=this.Ppd=this.ayc=this.Qpd=null;super.dispose()}wvh(){var b=this.LZ.value,h=this.Rvm(b);const v=-1===h?b:this.oH[h];b=b.length;const D=
v.length;this.SBc=v;this.LZ.value=v;this.tla.selectedIndex=h;D>b&&(aa.a.SJ?this.LZ.setSelectionRange(b,D):aa.a.l4&&(h=this.LZ.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",D-b),h.select()));this.validate();this.LZ.focus()}Rvm(b){let h=0,v=this.oH.length,D=-1;for(b=G.a.Ug(b);h<v;){const Q=Math.floor((h+v)/2),ba=JE.G8e(b,this.oH[Q]);if(!ba){D=Q;break}0<ba?h=Q+1:v=Q}if(D>h)for(;!JE.G8e(b,this.oH[D-1])&&(D--,D!==h););return D}validate(){const b=-1===this.Cgi(this.LZ.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}Cgi(b){b=G.a.Ug(b);const h=this.oH.length;for(let v=0;v<h;v++)if(b===G.a.Ug(this.oH[v]))return v;return-1}static G8e(b,h){const v=Math.min(b.length,h.length);b=G.a.Ug(b);h=G.a.Ug(h);for(let D=0;D<v;D++){const Q=G.a.charCodeAt(b,D),ba=G.a.charCodeAt(h,D);if(Q!==ba)return Q-ba}return b.length<=h.length?0:1}static Y1k(b,
h){return JE.G8e(b,h)}}Object(n.a)(JE,"ApplyStylesDialog",Vf.a,[]);var KE=c(317);class TH extends pg.StandardDialog{constructor(b){super();this.zv=b;this.Duo()}Duo(){this.Ad=1;this.cV(1);this.Ee(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Ju(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.vdf.bind(this))}vdf(b){1===b&&this.zv.$ia("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Ci?Lc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.v5n(),Lc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}v5n(){KE.a.sqb="{}"}}Object(n.a)(TH,"DeleteSavedStylesConfirmationDialog",pg.StandardDialog,[]);class UH extends pg.StandardDialog{constructor(b,h){super();this.vdf=Q=>{if(1===Q){Q=new Map;Q.set("Source","DeleteStyleConfirmationDialog");Q.set("Action","DeleteStyle");wa.Health.instance.recordKpiUsage(eq.a.wza,0,eq.a.sB,Q);var ba=
Pl.a.Lr();Q=new ah.GraphTransaction(15);Q.Cb(ba);Q.fk=Eb.a.WBb;this.ZG.QPh(this.Ugh)?Lc.b(578359694,3018,50,"User deleted a style via UI."):(ba=new Map,ba.set("Source","DeleteStyleConfirmationDialog"),ba.set("Action","DeleteStyle"),ba=Object.assign(new wb.a,{extendedProperties:ba}),wa.Health.instance.recordKpiFailure(eq.a.wza,"DeleteStyleFailed",!1,!0,ba),Lc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));Q.dispose()}};h||Lc.b(590128417,3018,10,"styleId is null");
let v=null,D=null;if(this.mh=b.view)D=this.mh.lb;D&&(v=D.gb.kb.Oa);v?(b=v.node)?(this.vK=this.vh.Xs(b))?(this.Ugh=new zb.a,this.Ugh.add(h),this.Euo(h)):Lc.b(590128448,3018,10,"_pageContenNode is null."):Lc.b(590128419,3018,10,"node is null."):Lc.b(590128418,3018,10,"nodeContext is null.")}get ZG(){return null!=this.aJg?this.aJg:this.aJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get wc(){return null!=this.sJg?this.sJg:this.sJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get vh(){return null!=
this.SEg?this.SEg:this.SEg=Rl.PageNavigator.instance}Euo(b){const h=(new Jv.WACStyleSet).TQ(this.vK);h?((b=h.Pi(b))||Lc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.wc.vM(b),this.Ad=4,this.cV(2),this.Ju(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.vdf)):Lc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(n.a)(UH,"DeleteStyleConfirmationDialog",pg.StandardDialog,
[]);class dG{static get Xg(){return Vf.a.qA(dG.Lm)}}dG.Lm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(n.a)(dG,"DeleteStyleDialogHtml",null,[]);class VH extends Vf.a{constructor(b){super();this.vK=this.oH=null;this.Ijl=(h,v)=>{this.mh.hv&&(h?(h=v.styleList,-1!==h&&(h=this.oH[h],v=this.wc.Mr(),h=this.wc.pg(v.Rva(h)),this.rJc.Hjl(this._context,h),this.mh.x5())):this.mh.x5())};this._context=b;this.wg="DeleteStyleDialog";this.Ad=
1;this.Ee(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.mh=this._context.view;this.cuf();this.Xg=dG.Xg;this.Yh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.Ijl,{["styleList"]:0});this.tla=document.getElementById("styleList");this.IZf();this.tla.selectedIndex=0;this.tla.focus()}get wc(){return null!=this.nJg?this.nJg:this.nJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get rJc(){return null!=this.Exg?this.Exg:this.Exg=Ga.a.instance.resolve("WordEditor.UI.IDialogFactory")}IZf(){const b=
this.oH.length;for(let h=0;h<b;h++){const v=document.createElement("OPTION");v.value=h.toString();v.text=this.oH[h];this.tla.add(v,null)}}cuf(){if(this.vK=Pl.a.Lr()){var b=(new Jv.WACStyleSet).TQ(this.vK),h=b.lO;this.oH=[];for(let D=0;D<h;D++){const Q=b.yEa(D);if(!this.wc.isHidden(Q)&&this.wc.je(Q,b)){var v=this.wc.yG(Q);if(2===v||1===v)Q.hasProperty(lc.a.linkedStyle)&&2!==v||(v=Q.ia(lc.a.GK,null))&&0<v.length||this.oH.push(this.wc.vM(Q))}}this.oH.sort()}else Lc.b(578650370,3018,15,"PageContentNode is null")}}
Object(n.a)(VH,"DeleteStyleDialog",Vf.a,[]);var $L=c(764);class WH{constructor(b){this.customData=null;this.zO=b}}Object(n.a)(WH,"PropertySetChangedState",null,[]);class XH{static gHn(b,h,v){if(b&&h){var D=new WH(h),Q=(ba,ta,Ta)=>{v.fHn(ba,ta,Ta,D)};b=new $L.a(h,b);b.Dzd=Q;b.VCd=Q;b.kde=Q;b.fgc()}}}Object(n.a)(XH,"PropertySetChangedManager",null,[]);class YH{constructor(b){this.PLa=b}fHn(b,h,v,D){const Q=this.PLa[b.id.toString()];Q&&Q(b,h,v,D)}}Object(n.a)(YH,"PropertyChangedProcessor",null,[]);const eG=
(b,h,v)=>{const D=lr.a.instance.k6b;if(D){const Q=new ah.GraphTransaction(15);Q.Cb(D);XH.gHn(b,h,new YH(v));Q.dispose()}};class fG{static get Xg(){return Vf.a.qA(fG.Lm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}fG.Lm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(n.a)(fG,"MarginsDialogHtml",null,[]);class pr{static get N4(){return null!=pr.FEg?pr.FEg:pr.FEg=Ga.a.instance.Na("WordEditor.IPageCommands")}static A9m(b,h,v){pr.N4&&null!==v&&pr.N4.Ige(0,v)}static w9m(b,h,v){pr.N4&&null!==v&&pr.N4.Ige(3,v)}static y9m(b,h,v){pr.N4&&null!==v&&pr.N4.Ige(1,v)}static z9m(b,h,v){pr.N4&&null!==v&&pr.N4.Ige(2,v)}static nyn(b,h,v){pr.N4&&null!==v&&pr.N4.$Sa(0,v)}static Oxn(b,h,v){pr.N4&&null!==v&&pr.N4.$Sa(1,v)}static W_k(b,h,v){pr.N4&&null!==v&&(b==qe.a.NE?pr.N4.Pfe(0,
v):b==qe.a.eG?pr.N4.Pfe(1,v):b==qe.a.pma?pr.N4.Pfe(2,v):b==qe.a.separator&&pr.N4.Pfe(3,v))}}Object(n.a)(pr,"PageLevelPropertyChangedHandlers",null,[]);const ZH=[sc.a.d0c,sc.a.c0c,sc.a.x8d,sc.a.y8d,sc.a.Pae,sc.a.Mae,sc.a.Nae,sc.a.Oae];class jA extends Vf.a{constructor(b,h,v,D,Q){super();this.SMc=(ba,ta)=>{var Ta=jA.h2c(ba);ba=Ya.App.Dha;this.Fp.hasProperty(Ta)?(Ta=this.Fp.getValue(Ta),ta[kh.a.Number]=Nf.a.e8a(Ta,ba)):ta[kh.a.Number]=0;ta[kh.a.UnitType]=ba};this.B6c=(ba,ta)=>{this.Fp.setValue(jA.h2c(ba),
Nf.a.wIa(ta[kh.a.Number],ta[kh.a.UnitType]));this.ru.xm()};this.C9m=ba=>{let ta=!1;1===ba&&(Math.abs(this.Fp.getValue(lc.a.marginTop))+Math.abs(this.Fp.getValue(lc.a.marginBottom))+Ya.App.vza<=this.tta.getValue(lc.a.nv)&&this.Fp.getValue(lc.a.marginLeft)+this.Fp.getValue(lc.a.marginRight)+Ya.App.vza<=this.tta.getValue(lc.a.Bo)?eG(this.GAa,this.Fp,jA.k8b()):ta=!0);this.dispose();ta&&this.tHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.x9m)};this.x9m=()=>{Ga.a.instance.resolve("WordEditor.UI.IDialogFactory").wLh(this.GAa,
this.tta,this.E6)};this.wg="MarginsDialog";this.tta=h.clone();this.GAa=b.clone();this.Fp=b.clone();this.E6=v;this.PV=!1;this.ru=Q;this.Xg=fG.Xg;v&&(this.Zqc=$t.a.eQb);this.Yh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.C9m,null);this.oSc();this.USe=document.getElementById("DialogMarginTopSpinner");this.R0(this.USe)}f9(){this.QBd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",sc.a.d0c,sc.a.Pae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.QBd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",sc.a.c0c,sc.a.Mae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.QBd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",sc.a.x8d,sc.a.Nae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.QBd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",sc.a.y8d,sc.a.Oae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}oSc(){for(const b of ZH)Object(qm.a)(b,this.B6c,this.SMc);this.ru.Gpa("DialogMarginTopSpinner");
this.ru.Gpa("DialogMarginBottomSpinner");this.ru.Gpa("DialogMarginLeftSpinner");this.ru.Gpa("DialogMarginRightSpinner")}dispose(){for(const b of ZH)Object(qm.b)(b);this.ru.CY("DialogMarginTopSpinner");this.ru.CY("DialogMarginBottomSpinner");this.ru.CY("DialogMarginLeftSpinner");this.ru.CY("DialogMarginRightSpinner");super.dispose()}QBd(b,h,v,D,Q){v=jA.hNk(h,v,D,Q);this.Azb(v,b,h)}Azb(b,h,v){h=document.getElementById(h);this.ru.QYa(v,b);b=this.ru.$Db(v,"Medium");h.appendChild(b)}static k8b(){return jA.PLa||
(jA.PLa=jA.K3b())}static K3b(){const b={};b[lc.a.marginTop.id.toString()]=pr.A9m;b[lc.a.marginBottom.id.toString()]=pr.w9m;b[lc.a.marginLeft.id.toString()]=pr.y9m;b[lc.a.marginRight.id.toString()]=pr.z9m;return b}static hNk(b,h,v,D){let Q=!0;if(h===sc.a.d0c||h===sc.a.c0c)Q=!1;return bm.j(b,h,v,D,[jA.jNk(Q),jA.iNk(Q)])}static jNk(b){return bm.l("inch",b?"0":"-22","22",".1")}static iNk(b){return bm.l("centimeter",b?"0":"-55.8","55.8","1")}static h2c(b){let h=null;switch(b){case sc.a.d0c:case sc.a.Pae:h=
lc.a.marginTop;break;case sc.a.c0c:case sc.a.Mae:h=lc.a.marginBottom;break;case sc.a.x8d:case sc.a.Nae:h=lc.a.marginLeft;break;case sc.a.y8d:case sc.a.Oae:h=lc.a.marginRight}return h}}jA.PLa=null;Object(n.a)(jA,"MarginsDialog",Vf.a,[]);class gG{static get Xg(){return Vf.a.qA(gG.Lm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}gG.Lm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(gG,"PaperSizeDialogHtml",null,[]);const $H=[sc.a.B8d,sc.a.A8d,sc.a.dbe,sc.a.cbe];class Nt extends Vf.a{constructor(b,h,v,D,Q){super();this.SMc=(ba,ta)=>{var Ta=this.h2c(ba);ba=Ya.App.Dha;this.Fp.hasProperty(Ta)?(Ta=this.Fp.getValue(Ta),ta[kh.a.Number]=Nf.a.e8a(Ta,ba)):ta[kh.a.Number]=0;ta[kh.a.UnitType]=ba};this.B6c=(ba,ta)=>{this.Fp.setValue(this.h2c(ba),Nf.a.wIa(ta[kh.a.Number],ta[kh.a.UnitType]));this.ru.xm()};this.zyn=ba=>{let ta=!1;1===ba&&(this.Fp.getValue(lc.a.nv)>=Ya.App.vza+this.tta.getValue(lc.a.marginTop)+
this.tta.getValue(lc.a.marginBottom)&&this.Fp.getValue(lc.a.Bo)>=Ya.App.vza+this.tta.getValue(lc.a.marginLeft)+this.tta.getValue(lc.a.marginRight)?eG(this.GAa,this.Fp,Nt.k8b()):ta=!0);this.dispose();ta&&this.tHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.yyn)};this.yyn=()=>{Ga.a.instance.resolve("WordEditor.UI.IDialogFactory").aMh(this.GAa,this.tta,this.E6)};this.wg="PaperSizeDialog";this.tta=h.clone();this.GAa=b.clone();this.Fp=b.clone();this.E6=v;this.PV=!1;this.ru=Q;this.Xg=gG.Xg;
v&&(this.Zqc=$t.a.eQb);this.Yh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.zyn,null);this.oSc();this.USe=document.getElementById("DialogWidthSpinner");this.R0(this.USe)}f9(){this.ayh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",sc.a.B8d,sc.a.dbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.ayh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",sc.a.A8d,sc.a.cbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}oSc(){for(const b of $H)Object(qm.a)(b,
this.B6c,this.SMc);this.ru.Gpa("DialogWidthSpinner");this.ru.Gpa("DialogHeightSpinner")}dispose(){for(const b of $H)Object(qm.b)(b);this.ru.CY("DialogWidthSpinner");this.ru.CY("DialogHeightSpinner");super.dispose()}ayh(b,h,v,D,Q){v=Nt.yNk(h,v,D,Q);this.Azb(v,b,h)}Azb(b,h,v){h=document.getElementById(h);this.ru.QYa(v,b);b=this.ru.$Db(v,"Medium");h.appendChild(b)}h2c(b){let h=null;switch(b){case sc.a.A8d:case sc.a.cbe:h=lc.a.nv;break;case sc.a.B8d:case sc.a.dbe:h=lc.a.Bo}return h}static k8b(){return Nt.PLa||
(Nt.PLa=Nt.K3b())}static K3b(){const b={};b[lc.a.Bo.id.toString()]=pr.nyn;b[lc.a.nv.id.toString()]=pr.Oxn;return b}static yNk(b,h,v,D){return bm.j(b,h,v,D,[Nt.ANk(),Nt.zNk()])}static ANk(){return bm.l("inch",Nt.jtj,Nt.zWm,Nt.syo)}static zNk(){return bm.l("centimeter",Nt.jtj,Nt.yWm,Nt.ryo)}}Nt.jtj="0";Nt.zWm="22";Nt.syo=".1";Nt.ryo="1";Nt.yWm="55.8";Nt.PLa=null;Object(n.a)(Nt,"PaperSizeDialog",Vf.a,[]);const aM=RegExp("[{|}|;|\\\\]"),aI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
v=b.lO;let D;for(D=1;D<=v;D++){const Q=h+D;if(!(b.ygi(Q)||b.WRd(Q)||b.ygi(Q+"Char")||b.WRd(Q+"Char")))break}return h+D};class bI extends Vf.a{constructor(b,h,v,D,Q){var ba,ta,Ta,ob;super(!1,!1,!0);this.context=b;this.oc=h;this.k8=v;this.wc=D;this.vh=Q;this.BKd=null;this.h6i=(Kb,Vb)=>{if(this.ie.hv){if(0!==Kb){Kb="string"===typeof Vb.styleText?Vb.styleText:null;Vb=this.j9c;var bc=Kb;const Dc=G.a.iya(bc);let Oc=null;if(0===Dc.length)Oc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<bc.length)Oc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(aM.test(bc))Oc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Vb.Wcm(bc)||Vb.WRd(Dc))Oc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Vb=Oc)?(this.BKd=Vb,Vb=aI(this.j9c),Kb=this.YDb(Kb,Vb),this.BKd=null,this.PV=!1,this.hide(),this.Yh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.h6i,Kb),this.PV=!0):(this.hide(),Vb=new Map,Vb.set("Source","ReactCreateNewStyleDialog"),Vb.set("Action","CreateStyle"),
wa.Health.instance.recordKpiUsage(eq.a.wza,0,eq.a.sB,Vb),this.Yyd(Kb)||(Kb=new Map,Kb.set("Source","ReactCreateNewStyleDialog"),Kb.set("Action","CreateStyle"),Kb=Object.assign(new wb.a,{extendedProperties:Kb}),wa.Health.instance.recordKpiFailure(eq.a.wza,"CreateStyleFailed",!1,!0,Kb)))}else this.hide();this.ie.x5()}};this.wg="CreateNewStyleDialog";this.ie=b.view;(b=null===(ob=null===(Ta=null===(ta=null===(ba=this.ie)||void 0===ba?void 0:ba.lb)||void 0===ta?void 0:ta.gb)||void 0===Ta?void 0:Ta.kb)||
void 0===ob?void 0:ob.Oa)?(ba=b.node)?(this.pageContentNode=this.vh.Xs(ba))?(this.j9c=(new Jv.WACStyleSet).t7h(this.pageContentNode),(this.PJb=this.k8.wLd(b))?(ba=this.PJb.ia(Gd.a.fontSize,22),16>ba?Lc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ba?Lc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ba?Lc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Lc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.u5f(this.PJb),this.pageContentNode&&this.PJb&&(this.L$=!1,ba=aI(this.j9c),ba=this.YDb(ba,ba),this.Yh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.h6i,ba))):Lc.b(592737758,3018,10,"_newStyleProperties is null.")):Lc.b(592737757,3018,10,"_pageContenNode is null."):Lc.b(592725466,3018,10,"node is null."):Lc.b(556917206,3018,10,"nodeContext is null.")}u5f(b){b.Eg(Ve.a.paragraphStyle,Ve.a.hw,...eq.a.Kba())}YDb(b,h){const v=
52<=this.PJb.ia(Gd.a.fontSize,Ao.a.nM),D=qp.a.Qof(this.PJb,"97%",26,!1,!0,v);D["padding-left"]="5px";v||(D["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>D};this.BKd&&(b.errorMessage=this.BKd);return{["id"]:this.wg,["bodyControls"]:b}}Yyd(b){const h=new ah.GraphTransaction(15);h.Cb(this.pageContentNode);
h.fk=Eb.a.pBb;const v=Pl.a.Yyd(b,Pl.a.fei(this.PJb),null,this.pageContentNode);v&&(Lc.b(593078046,3018,50,"User created linked style"),this.j9c=(new Jv.WACStyleSet).t7h(this.pageContentNode),b=G.a.iya(G.a.RX(b)),b=this.j9c.WRd(b),this.oc.Of(this.context,Eb.a.applyStyle,2,!1,new SH.a,this.wc.pg(b)));h.dispose();return v}}Object(n.a)(bI,"ReactCreateNewStyleDialog",Vf.a,[]);class CD extends Vf.a{constructor(b,h=!1,v){super(!1,!1,h);let D=h=this.mK=null;this.wg=CD.id;this.mh=b.view;this.qn=v;this.mh&&
(D=this.mh.lb);D&&D.gb&&D.gb.kb&&(h=D.gb.kb.Oa);h?(b=h.node)?(this.vK=CD.vh.Xs(b))||u.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):u.ULS.sendTraceTag(539762889,3029,10,"node is null"):u.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}U_o(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),v=this.WKl();const D=""===G.a.iya(b),Q=b.length>CD.J$m;v=v.includes(b);h=h.test(b);b=b.startsWith("_");let ba=null;if(D||Q||v||b||!h)ba=D?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
Q?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ba}KFm(b,h){return b?b===h:!1}static get vh(){return Rl.PageNavigator.instance}WKl(){const b=this.qn.wNd(!1),h=[];for(let v=0;v<b.count;v++){const D=b.J(v).ia(lc.a.rt,"");h.push(D)}return h}}CD.id="BookmarkEditDialog";CD.J$m=40;Object(n.a)(CD,
"AEditBookmarkDialog",Vf.a,[]);class cI extends CD{constructor(b,h,v){super(b,!0,v);this.Gze=null;this.TVa="wwaengidc";this.Kvc="ReactCreateEditBookmarkNameDialog";this.L2g="EditBookmarkName";this.wsa="EditBookmarkNameDialog";this.Dte=h;this.qn=v;this.vK&&(this.L$=!1,b=this.YDb(h.properties.ia(lc.a.rt,null)),this.Yh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.j6i.bind(this),b))}j6i(b,h){if(this.mh.hv){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var v;this.Dte.hasProperty(lc.a.rt)?
v=this.Dte.getValue(lc.a.rt):u.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.U_o(b);this.KFm(b,v)?(u.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.Gze=h,v=this.YDb(b),this.Gze=null,this.PV=!1,this.hide(),this.Yh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.j6i.bind(this),v),this.PV=!0):(this.hide(),v=new Map,v.set("Source",this.Kvc),v.set("Action",this.L2g),wa.Health.instance.recordKpiUsage(this.wsa,
0,this.TVa,v),this.KTk(b)||(v=new Map,v.set("Source",this.Kvc),v.set("Action",this.L2g),v=Object.assign(new wb.a,{extendedProperties:v}),wa.Health.instance.recordKpiFailure(this.wsa,"Unable to edit bookmark",!1,!0,v)))}else this.hide();this.mh.x5()}}KTk(b){b=G.a.iya(G.a.RX(b));try{const h=this.qn.gSo(this.Dte,b);if(h)u.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return u.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return u.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}YDb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.Gze;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.wg,["bodyControls"]:h}}}Object(n.a)(cI,"ReactEditBookmarkNameDialog",CD,[]);const hG=(b,h,v)=>{const D=[];if(b.length!==h.length||v&&v.length!==h.length)return D;for(let Q=0;Q<b.length;Q++){const ba={};ba.key=h[Q];
ba.text=b[Q];ba.type="AppComboBoxItem";v&&(ba.ariaLabel=v[Q]);D[Q]=ba}return D},nC=(b,h,v,D,Q)=>({["unitType"]:b,["unitPlaceholder"]:G.a.Y9d(h),["minValue"]:v,["maxValue"]:D,["step"]:Q}),SG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),dI=(b,h,v)=>{let D=!1;b.hasProperty(h)&&b.hasProperty(v)?(v=b.getValue(v),1===v?(b=Number.NaN,h=5,D=!0):(b=b.getValue(h),h=2===v?4:5)):(b=Number.NaN,
h=Ya.App.qFa?4:5);return{Yjc:b,K7a:h,F$b:D}};class eI{constructor(){this.Ctj=this.a_i=this.ZZi=this.Fyn=this.DXf=!1}}Object(n.a)(eI,"Box4PropertySetChangedState",null,[]);class Mm{static get Z9b(){return null!=Mm.QAg?Mm.QAg:Mm.QAg=Ga.a.instance.Na("Box4.IIndentationCommands")}static get DDi(){return null!=Mm.dDg?Mm.dDg:Mm.dDg=Ga.a.instance.Na("Box4.IJustificationCommands")}static get p5(){return null!=Mm.tGg?Mm.tGg:Mm.tGg=Ga.a.instance.Na("Box4.ISpacingCommands")}static AVm(b,h,v){Mm.DDi&&v&&(null===
h||11!==v||10!==h&&9!==h)&&Mm.DDi.gE(v)}static PYm(b,h,v){Mm.p5&&v&&Mm.p5.fD(v)}static i5k(b,h,v){h!=v&&Mm.p5.Jic(v)}static LVm(b,h,v){h!=v&&Mm.p5.U6c(v)}static v2o(b,h,v){h!=v&&Mm.p5.v7c(v)}static JVm(b,h,v){h!=v&&Mm.p5.T6c(v)}static f_i(b,h,v,D){Mm.p5&&void 0!==v&&null!==v&&(b=Mm.hNc(D),!b.DXf&&D.zO.hasProperty(wc.a.rfc)&&D.zO.hasProperty(wc.a.sfc)&&(h=D.zO.getValue(wc.a.sfc),D=D.zO.getValue(wc.a.rfc),b.DXf=!0,Mm.p5.gda(1,h,D)))}static e_i(b,h,v,D){Mm.p5&&void 0!==v&&null!==v&&(b=Mm.hNc(D),!b.Fyn&&
D.zO.hasProperty(wc.a.pfc)&&D.zO.hasProperty(wc.a.qfc)&&(h=D.zO.getValue(wc.a.qfc),D=D.zO.getValue(wc.a.pfc),b.DXf=!0,Mm.p5.gda(0,h,D)))}static YZi(b,h,v,D){Mm.Z9b&&void 0!==v&&null!==v&&(b=Mm.hNc(D),!b.ZZi&&D.zO.hasProperty(wc.a.zGa)&&D.zO.hasProperty(wc.a.AGa)&&(h=D.zO.getValue(wc.a.AGa),D=D.zO.getValue(wc.a.zGa),b.ZZi=!0,Mm.Z9b.Tlj(1,h,D)))}static $Zi(b,h,v,D){Mm.Z9b&&void 0!==v&&null!==v&&(b=Mm.hNc(D),!b.a_i&&D.zO.hasProperty(wc.a.Fmb)&&D.zO.hasProperty(wc.a.Gmb)&&(h=D.zO.getValue(wc.a.Gmb),D=
D.zO.getValue(wc.a.Fmb),b.a_i=!0,Mm.Z9b.Tlj(0,h,D)))}static lfg(b,h,v,D){Mm.Z9b&&void 0!==v&&null!==v&&(b=Mm.hNc(D),!b.Ctj&&D.zO.hasProperty(wc.a.oTa)&&D.zO.hasProperty(wc.a.pTa)&&(h=0,D.zO.hasProperty(wc.a.q5)&&(h=D.zO.getValue(wc.a.q5)),v=D.zO.getValue(wc.a.pTa),D=D.zO.getValue(wc.a.oTa),b.Ctj=!0,Mm.Z9b.Zge(h,v,D)))}static hNc(b){b.customData||(b.customData=new eI);return b.customData}}Object(n.a)(Mm,"ParagraphLevelPropertyChangedHandlers",null,[]);class DD{constructor(){this.PLa=null}q6l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var v=nC("Point",5,0,1584,1),D=nC("Line",4,0,327,1),Q=[v,D];D=SG();var ba=[Box4Intl.Box4Strings.L_SpinnerAuto];v=[""];({Yjc:Ta,K7a:ta,F$b:ob}=dI(b,wc.a.sfc,wc.a.rfc));var ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:Nf.a.h_a(ta),["validUnits"]:Q,["numberFormatInfo"]:D,["validReservedValues"]:ba};ob?ta.reservedValue=ba[0]:ta.value=isNaN(Ta)?"":Ta;h.beforeSpacingSpinButtonProps=ta;({Yjc:Ta,K7a:ta,F$b:ob}=dI(b,wc.a.qfc,wc.a.pfc));Q={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Nf.a.h_a(ta),["validUnits"]:Q,["numberFormatInfo"]:D,["validReservedValues"]:ba};
ob?Q.reservedValue=ba[0]:Q.value=isNaN(Ta)?"":Ta;h.afterSpacingSpinButtonProps=Q;if(ba=Q=b.hasProperty(wc.a.ua))ba=DD.KFa.BEb(b),ba=b.hasProperty(wc.a.ua)&&b.hasProperty(wc.a.J3a)&&2===b.getValue(wc.a.J3a)?!ye.a.ywa(ba,1)&&!ye.a.ywa(ba,1.5)&&!ye.a.ywa(ba,2):!1;if(Q){var Ta=DD.KFa.BEb(b);Q=0;var ob=!1;b.hasProperty(wc.a.ua)&&b.hasProperty(wc.a.J3a)||(ob=!0);ob||(2!==b.getValue(wc.a.J3a)&&(ob=!0),Q=Ta,1>Q&&(ob=!0));ob?Q="":(Ta="multiple",ba||(ye.a.ywa(Q,1)?Ta="1.00":ye.a.ywa(Q,1.5)?Ta="1.50":ye.a.ywa(Q,
2)&&(Ta="2.00")),Q=Ta)}else Q=null;Ta={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:hG([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};Q?Ta.selectedKey=Q:Ta.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ta;Q=0;Ta=!1;b.hasProperty(wc.a.ua)&&b.hasProperty(wc.a.J3a)&&2===b.getValue(wc.a.J3a)&&ba&&(Q=DD.KFa.BEb(b),Ta=!0,1>Q&&(Q=Number.NaN));b=[nC("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:D,["validReservedValues"]:v};Ta?b.value=Q:b.reservedValue=v[0];h.atSpinButtonProps=b;return h}k8b(){return this.PLa||(this.PLa=this.K3b())}K3b(){const b={};b[wc.a.ua.id.toString()]=Mm.PYm;b[wc.a.qfc.id.toString()]=Mm.e_i;b[wc.a.pfc.id.toString()]=Mm.e_i;b[wc.a.sfc.id.toString()]=Mm.f_i;b[wc.a.rfc.id.toString()]=Mm.f_i;return b}static get KFa(){return null!=DD.lDg?DD.lDg:DD.lDg=Ga.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(n.a)(DD,"ReactParagraphDialog",null,[]);const fI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,TG=(b,h,v,D)=>{let Q=Ya.App.Dha;b.hasProperty(h)&&b.hasProperty(v)&&!D?(h=b.getValue(h),b=b.getValue(v),h?2===b?Q=2:h=Nf.a.e8a(h,Q):Ya.App.qFa&&(Q=2)):(h=Number.NaN,Ya.App.qFa&&(Q=2));return{Yjc:h,K7a:Q}},bM=b=>{let h="0";b.hasProperty(wc.a.q5)&&(b=b.getValue(wc.a.q5),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},gI=(b,h)=>{if(h.hasProperty(wc.a.q5)&&2===h.getValue(wc.a.q5)&&h.hasProperty(wc.a.pTa)&&h.hasProperty(wc.a.oTa)&&
b.hasProperty(wc.a.AGa)&&b.hasProperty(wc.a.zGa)){var v=b.getValue(wc.a.AGa),D=b.getValue(wc.a.zGa);v=(new dq.a(D,v)).Lt;D=h.getValue(wc.a.pTa);h=h.getValue(wc.a.oTa);h=(new dq.a(h,D)).Lt;b.setValue(wc.a.AGa,v+h);b.setValue(wc.a.zGa,1)}},hI=b=>{const h=b.getValue(wc.a.AGa);b=b.getValue(wc.a.zGa);return(new dq.a(b,h)).Lt},iI=b=>{const h=b.getValue(wc.a.Gmb);b=b.getValue(wc.a.Fmb);return(new dq.a(b,h)).Lt},jI=(b,h)=>h.hasProperty(wc.a.AGa)&&h.hasProperty(wc.a.zGa)&&h.hasProperty(wc.a.Gmb)&&h.hasProperty(wc.a.Fmb)&&
b.hasProperty(lc.a.marginLeft)&&b.hasProperty(lc.a.marginRight)&&b.hasProperty(lc.a.Bo),cM=b=>b.hasProperty(wc.a.M0c)?b.getValue(wc.a.M0c):!1,dM=b=>b.hasProperty(qe.a.keepWithNext)?b.getValue(qe.a.keepWithNext):!1,eM=b=>b.hasProperty(qe.a.widowControl)?b.getValue(qe.a.widowControl):!1,fM=b=>b.hasProperty(qe.a.keepTogether)?b.getValue(qe.a.keepTogether):!1;class kI extends Vf.a{constructor(b,h,v,D,Q){super(!1,!1,!0);this.plh=null;this.Nyn=()=>{Ga.a.instance.resolve("Box4.UI.IBox4DialogFactory").JGd(this.GAa,
this.tta,this.E6,this.YA)};this.Pyn=(ob,Kb)=>{var Vb,bc,Dc;if(Kb&&(1===ob||2===ob)){if(Kb.alignmentComboBoxProps){var Oc=parseInt(Kb.alignmentComboBoxProps.selectedKey);isNaN(Oc)||fI(Oc)&&this.Fp.setValue(wc.a.rw,Oc)}var gd=Kb.bySpinButtonProps;Oc=!!gd&&""!==gd.value;var rd=Kb.didChangeSpecialIndentationComboBoxValue;if(Kb.specialIndentationComboBoxProps){var je=parseInt(Kb.specialIndentationComboBoxProps.selectedKey);1!==je&&2!==je&&je||!(je||rd||Oc)||this.Fp.setValue(wc.a.q5,je)}if(gd){je=gd.value;
gd=Nf.a.BNa(gd.unitType.toLowerCase());let Ld;0<=je||(je=0);2===gd?Ld=2:(Ld=1,je=Nf.a.wIa(je,gd));if(Oc||rd)this.Fp.setValue(wc.a.pTa,je),this.Fp.setValue(wc.a.oTa,Ld)}Kb.beforeTextSpinButtonProps&&(rd=Kb.beforeTextSpinButtonProps,Oc=Nf.a.BNa(rd.unitType.toLowerCase()),rd=""===rd.value?Number.NaN:rd.value,isNaN(rd)||(je=rd,2===Oc?gd=2:(gd=1,je=Nf.a.wIa(rd,Oc)),this.Fp.setValue(wc.a.AGa,je),this.Fp.setValue(wc.a.zGa,gd)));Kb.afterTextSpinButtonProps&&(rd=Kb.afterTextSpinButtonProps,Oc=Nf.a.BNa(rd.unitType.toLowerCase()),
rd=""===rd.value?Number.NaN:rd.value,isNaN(rd)||(je=rd,2===Oc?gd=2:(gd=1,je=Nf.a.wIa(rd,Oc)),this.Fp.setValue(wc.a.Gmb,je),this.Fp.setValue(wc.a.Fmb,gd)));Kb.beforeSpacingSpinButtonProps&&(Oc=Kb.beforeSpacingSpinButtonProps,rd=Nf.a.BNa(Oc.unitType.toLowerCase()),je=Oc.reservedValue,""!==Oc.value&&(je===Box4Intl.Box4Strings.L_SpinnerAuto?(rd=1,Oc=0):(rd=4===rd?2:4,Oc=Oc.value),this.Fp.setValue(wc.a.sfc,Oc),this.Fp.setValue(wc.a.rfc,rd)));Kb.afterSpacingSpinButtonProps&&(Oc=Kb.afterSpacingSpinButtonProps,
rd=Nf.a.BNa(Oc.unitType.toLowerCase()),je=Oc.reservedValue,""!==Oc.value&&(je===Box4Intl.Box4Strings.L_SpinnerAuto?(rd=1,Oc=0):(rd=4===rd?2:4,Oc=Oc.value),this.Fp.setValue(wc.a.qfc,Oc),this.Fp.setValue(wc.a.pfc,rd)));if(Kb.atSpinButtonProps||Kb.lineSpacingComboBoxProps)if(Oc=Kb.atSpinButtonProps.value,1<Oc)this.Fp.setValue(wc.a.ua,Oc),this.Fp.setValue(wc.a.J3a,2);else if(Oc=Kb.lineSpacingComboBoxProps.selectedKey)Oc="1.00"===Oc?1:"1.50"===Oc?1.5:"2.00"===Oc?2:0,Oc=1<=Oc?Oc:1,this.Fp.setValue(wc.a.ua,
Oc),this.Fp.setValue(wc.a.J3a,2);Kb.contextualSpacingCheckboxProps&&this.Fp.setValue(wc.a.M0c,Kb.contextualSpacingCheckboxProps.checked);(null===(Vb=this.YA)||void 0===Vb?0:Vb.GFa)&&Kb.keepWithNextCheckboxProps&&this.Fp.setValue(qe.a.keepWithNext,Kb.keepWithNextCheckboxProps.checked);(null===(bc=this.YA)||void 0===bc?0:bc.VIa)&&Kb.widowOrphanCheckboxProps&&this.Fp.setValue(qe.a.widowControl,Kb.widowOrphanCheckboxProps.checked);(null===(Dc=this.YA)||void 0===Dc?0:Dc.uha)&&Kb.keepTogetherCheckboxProps&&
this.Fp.setValue(qe.a.keepTogether,Kb.keepTogetherCheckboxProps.checked);gI(this.GAa,this.GAa);gI(this.Fp,this.GAa);Kb="";Vb=this.tta;bc=this.Fp;if(Dc=jI(Vb,bc))Dc=bc.hasProperty(wc.a.pTa)&&bc.hasProperty(wc.a.oTa);Dc?(Dc=bc.getValue(wc.a.pTa),Oc=bc.getValue(wc.a.oTa),Dc=(new dq.a(Oc,Dc)).Lt,Vb=hI(bc)+iI(bc)+Vb.getValue(lc.a.marginRight)+Vb.getValue(lc.a.marginLeft)+Dc+Ya.App.vza<=Vb.getValue(lc.a.Bo)):Vb=jI(Vb,bc)?hI(bc)+iI(bc)+Vb.getValue(lc.a.marginRight)+Vb.getValue(lc.a.marginLeft)+Ya.App.vza<=
Vb.getValue(lc.a.Bo):!0;Vb?eG(this.GAa,this.Fp,this.Mim(this.wRe?this.wRe.K3b():{})):Kb=""!==Kb?Kb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Kb?this.tHa(Kb,this.Nyn):2===ob&&(Qe.c(sc.a.Cjc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Qb(sc.a.Cjc,2,null))}};this.GAa=b.clone();this.Fp=b.clone();this.tta=h.clone();this.E6=v;this.ga=D;this.wRe=new DD;this.YA=Q;b=this.wRe.q6l(this.Fp);h=nC("Inch",3,-11,22,.1);v=nC("Inch",3,0,22,.1);var ba=nC("Centimeter",
1,-27.94,55.88,1);D=nC("Centimeter",1,0,55.88,1);var ta=nC("Character",2,-316.8,316.8,.5);Q=nC("Character",2,0,316.8,.5);h=[h,ba,ta];D=[v,D,Q];v=SG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};ba=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,
Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ta=["1","2","3","6","7"];let Ta=5;Q=this.Fp.hasProperty(wc.a.rw)?this.Fp.getValue(wc.a.rw):0;if(10===Q||9===Q)Q=11;if(w.AFrameworkApplication.lcid===lk.a.og("AR-SA").LCID||11===Q)b.isKashidaSupported=!0,ba[Ta]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ta[Ta]="11",Ta=6;if(w.AFrameworkApplication.lcid===lk.a.og("TH-TH").LCID||13===Q)b.isThaiSupported=!0,ba[Ta]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ta[Ta]="13";ba={["type"]:"AppComboBoxProps",
["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:hG(ba,ta),["allowFreeForm"]:!1};fI(Q)?ba.selectedKey=Q.toString():ba.defaultSelectedKey="";b.alignmentComboBoxProps=ba;if(this.YA.GFa||this.YA.VIa||this.YA.uha)b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};
this.YA.GFa&&(Q={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:dM(this.Fp)},b.keepWithNextCheckboxProps=Q);this.YA.VIa&&(Q={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:eM(this.Fp)},b.widowOrphanCheckboxProps=Q);this.YA.uha&&(Q={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,
["checked"]:fM(this.Fp)},b.keepTogetherCheckboxProps=Q);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};ba=bM(this.Fp);Q="0"===ba;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:hG([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,
Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:ba,["allowFreeForm"]:!1};ta=Ya.App.Dha;ba=0;({Yjc:ba,K7a:ta}=TG(this.Fp,wc.a.pTa,wc.a.oTa,Q));D={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Nf.a.h_a(ta),["validUnits"]:D,["numberFormatInfo"]:v};
D=this.uOb(ba,D);b.bySpinButtonProps=D;Q=Ya.App.Dha;D=0;({Yjc:D,K7a:Q}=TG(this.Fp,wc.a.AGa,wc.a.zGa,!1));Q={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Nf.a.h_a(Q),["validUnits"]:h,["numberFormatInfo"]:v};Q=this.uOb(D,Q);b.beforeTextSpinButtonProps=Q;Q=Ya.App.Dha;D=0;({Yjc:D,K7a:Q}=TG(this.Fp,wc.a.Gmb,wc.a.Fmb,!1));h={["type"]:"AppSpinButtonProps",
["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Nf.a.h_a(Q),["validUnits"]:h,["numberFormatInfo"]:v};h=this.uOb(D,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};v={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:cM(this.Fp)};b.contextualSpacingCheckboxProps=
v;h.dialogButtonsOption=9;h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Yh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.Pyn,h)}Mim(b){return this.plh||(this.plh=this.tbf(b))}tbf(b){var h,v,D;b[wc.a.rw.id.toString()]=Mm.AVm;b[wc.a.zGa.id.toString()]=Mm.YZi;b[wc.a.AGa.id.toString()]=Mm.YZi;b[wc.a.Fmb.id.toString()]=
Mm.$Zi;b[wc.a.Gmb.id.toString()]=Mm.$Zi;b[wc.a.q5.id.toString()]=Mm.lfg;b[wc.a.oTa.id.toString()]=Mm.lfg;b[wc.a.pTa.id.toString()]=Mm.lfg;b[wc.a.M0c.id.toString()]=Mm.i5k;if(null===(h=this.YA)||void 0===h?0:h.GFa)b[qe.a.keepWithNext.id.toString()]=Mm.LVm;if(null===(v=this.YA)||void 0===v?0:v.VIa)b[qe.a.widowControl.id.toString()]=Mm.v2o;if(null===(D=this.YA)||void 0===D?0:D.uha)b[qe.a.keepTogether.id.toString()]=Mm.JVm;return b}uOb(b,h){h.value=isNaN(b)?"":b;return h}}Object(n.a)(kI,"WordReactParagraphDialog",
Vf.a,[]);class Tw extends Vf.a{constructor(b,h,v,D){super(!1,!1,!0);this.T_k=()=>{this.rJc.lKh(this.bqi,this.roe,this.dWc)};this.U_k=(Q,ba)=>{ba&&1===Q&&(ba.columnsCountSpinButtonProps&&this.kY.setValue(qe.a.NE,ba.columnsCountSpinButtonProps.value),ba.columnsWidthSpinButtonProps&&(Q=ba.columnsWidthSpinButtonProps,this.kY.setValue(qe.a.eG,[Nf.a.wIa(Q.value,Nf.a.BNa(Q.unitType.toLowerCase()))])),ba.columnsSpacingSpinButtonProps&&(Q=ba.columnsSpacingSpinButtonProps,this.kY.setValue(qe.a.pma,Nf.a.wIa(Q.value,
Nf.a.BNa(Q.unitType.toLowerCase())))),ba.columnsLineBetweenCheckboxProps&&this.kY.setValue(qe.a.separator,ba.columnsLineBetweenCheckboxProps.checked),this.X_k()&&(ba=Tw.uBd,this.bGk()?eG(this.bqi,this.kY,this.k8b):ba=ba!==Tw.uBd?ba:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ba!==Tw.uBd&&this.tHa(ba,this.T_k)))};this.X_k=()=>this.kY.hasProperty(qe.a.NE)&&this.kY.hasProperty(qe.a.eG)&&this.kY.hasProperty(qe.a.pma)&&this.kY.hasProperty(qe.a.separator);this.KNd=(Q,ba,ta)=>Math.floor((Q-
(ba-1)*ta)/ba);this.Pnf=(Q,ba,ta)=>1==ba?0:Math.floor((Q-ba*ta)/(ba-1));this.Rzk=(Q,ba,ta,Ta)=>{const ob=Q/ba;ta<Tw.Xjc?(ta=Tw.Xjc,Ta=this.Pnf(Q,ba,ta)):ta>ob&&(ta=ob,Ta=this.Pnf(Q,ba,ta));return[ta,Ta]};this.Ozk=(Q,ba,ta,Ta)=>{const ob=(Q-Tw.Xjc*ba)/(ba-1);0>Ta?(Ta=0,ta=this.KNd(Q,ba,Ta)):Ta>ob&&(Ta=ob,ta=this.KNd(Q,ba,Ta));return[ta,Ta]};this.wIa=(Q,ba)=>Nf.a.wIa(Q,Nf.a.BNa(ba));this.wIc=(Q,ba,ta,Ta,ob)=>({["unitType"]:Q,["unitPlaceholder"]:G.a.Y9d(ba),["minValue"]:ta,["maxValue"]:Ta,["step"]:ob});
this.bqi=b.clone();this.kY=b.clone();this.roe=h.clone();this.Bmb=this.roe.getValue(lc.a.Bo)-this.roe.getValue(lc.a.marginLeft)-this.roe.getValue(lc.a.marginRight);this.uJb=Math.floor(this.Bmb/Tw.Xjc);this.dWc=v;this.rJc=D;this.wg=Tw.id;b={};b.getUnitValue=3==Ya.App.Dha?Nf.a.Iz:Nf.a.YTa;b.getCalculatedWidthValue=this.KNd;b.getCalculatedSpacingValue=this.Pnf;b.twipsFromValueAndUnits=this.wIa;b.adjustWidthForLimits=this.Rzk;b.adjustSpacingForLimits=this.Ozk;b.pageContentWidth=this.Bmb;b.maxColumnCount=
this.uJb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.KPl();b.columnsWidthSpinButtonProps=this.OPl();b.columnsSpacingSpinButtonProps=this.MPl();b.columnsLineBetweenCheckboxProps=this.LPl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Yh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.U_k.bind(this),b)}KPl(){var b=[this.wIc("None",0,1,this.uJb,1)];const h=this.Utf(qe.a.NE);
b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Nf.a.h_a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.uOb(h,b)}OPl(){var b=[this.wIc("Inch",3,.5,Nf.a.Iz(this.Bmb),.1),this.wIc("Centimeter",
1,1.27,Nf.a.YTa(this.Bmb),1)];const h=Ya.App.Dha,v=this.Utf(qe.a.eG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Nf.a.h_a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.uOb(v,b)}MPl(){var b=
[this.wIc("Inch",3,0,Nf.a.Iz(this.Bmb-2*Tw.Xjc),.1),this.wIc("Centimeter",1,0,Nf.a.YTa(this.Bmb-2*Tw.Xjc),1)];const h=Ya.App.Dha,v=this.Utf(qe.a.pma);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Nf.a.h_a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.uOb(v,b)}LPl(){const b=this.kY.getValue(qe.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get k8b(){return null!=this.jAg?this.jAg:this.jAg=(()=>this.tbf())()}tbf(){const b={};b[qe.a.NE.id.toString()]=b[qe.a.eG.id.toString()]=b[qe.a.pma.id.toString()]=
b[qe.a.separator.id.toString()]=pr.W_k;return b}bGk(){const b=this.kY.getValue(qe.a.eG),h=this.kY.getValue(qe.a.NE),v=this.kY.getValue(qe.a.pma);let D=0;for(let Q=0;Q<h;Q++)D+=b[0];if(h<=this.uJb&&(h-1)*v+D<=this.Bmb)return!0;u.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],v);return!1}Utf(b){if(this.kY.hasProperty(b)){if(b==qe.a.NE)return this.kY.getValue(b);if(b==qe.a.eG){var h=Ya.App.Dha;b=
this.kY.getValue(qe.a.pma);const v=this.kY.getValue(qe.a.NE);return Nf.a.e8a(this.KNd(this.Bmb,v,b),h)}if(b==qe.a.pma){if(1==this.kY.getValue(qe.a.NE))return 0;h=Ya.App.Dha;b=this.kY.getValue(b);return Nf.a.e8a(b,h)}}return 0}uOb(b,h){h.value=isNaN(b)?Tw.uBd:b;return h}}Tw.id="ColumnsDialog";Tw.uBd="";Tw.Xjc=720;Object(n.a)(Tw,"WordReactColumnsDialog",Vf.a,[]);class lI{o8k(b){new JE(b,Ga.a.instance.resolve("Box4.IFeatureHelper"))}ibl(b,h){new bI(b,h,Ga.a.instance.resolve("Box4.IFormattingReader"),
Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Rl.PageNavigator.instance)}Irl(b,h,v){new cI(b,h,v)}wLh(b,h,v){new jA(b,h,v,Ga.a.instance.resolve("WordEditor.IPageCommands"),Ga.a.instance.resolve("Common.IStandaloneRootController").jda)}aMh(b,h,v){new Nt(b,h,v,Ga.a.instance.resolve("WordEditor.IPageCommands"),Ga.a.instance.resolve("Common.IStandaloneRootController").jda)}lKh(b,h,v){new Tw(b,h,v,Ga.a.instance.resolve("WordEditor.UI.IDialogFactory"))}M7k(b){return new aE(b)}JGd(b,h,v,D){new kI(b,
h,v,w.AFrameworkApplication.va,D)}Djl(){const b=Ga.a.instance.Na("Box4.IRoamingServiceRequestManager");null==b?Lc.b(524834398,3018,10,"Roaming service not resolved."):new TH(b)}Hjl(b,h){new UH(b,h)}wdf(b){return new VH(b)}}Object(n.a)(lI,"DialogFactory",null,[692,693]);class CF extends Vf.a{constructor(b,h){super(!1,!1,!0);this.DSh="DoNotCheckSpellingCheckbox";this.SSh="DocumentChoiceGroup";this.ygd=0;this.TDi="LanguageList";this.documentContext="DocumentContext";this.er="RangeContext";this.Mio=(v,
D)=>{const Q=Ye.a.instance.Ap(Eb.a.llj);if(1!==v)Q.properties.Z("canceled","true");else{v=D[this.TDi].replace(CF.Ctg,"");var ba=parseInt(v),ta=Boolean.parse(D[this.DSh]);D=D[this.SSh];D===this.documentContext?this.gnd.Ego(ba,ta):this.gnd.Olo(ba,ta);Q.properties.Z("PreviousLCID",this.ygd.toString());Q.properties.Z("ChangedLCID",ba.toString());Q.properties.Z("NoProof",ta.toString());this.P2g.Lio(ba,this.ygd);Qe.d(Eb.a.llj,!0,void 0,void 0,void 0,void 0,[Object.assign(new pa.a,{name:"SelectedLcid",string:v}),
Object.assign(new pa.a,{name:"NoProof",string:ta.toString()}),Object.assign(new pa.a,{name:"Context",string:D})]);Ya.App.xa.updateCommandUI(!0)}Q.end()};this.P2g=h;this.gnd=b}eeg(){const b=Array(2);b[0]={["key"]:this.er,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.SSh,
["defaultSelectedKey"]:this.cTl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.ygd=({eJn:this.t_j}=this.gnd.Iam()).returnValue;h.languageListPropsProvider=this.Q_l();h.spellingCheckboxProps={["id"]:this.DSh,["checked"]:!this.t_j,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Yh(Box4Intl.Box4Strings.l_Language,this.Mio,{["id"]:"LanguageDialog",["bodyControls"]:h})}cTl(){return this.gnd.gf()?this.documentContext:this.er}Q_l(){return()=>
{let b,h;const v=({selectedIndex:b,Ytj:h}=this.P2g.P_l(this.ygd)).returnValue;for(let D=0;D<v.length&&D<h;D++)v[D].value=CF.Ctg+v[D].value;return{["id"]:this.TDi,["items"]:v,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}CF.Ctg="recent-";Object(n.a)(CF,"ReactLanguageDialog",Vf.a,[694]);class mI extends BD{constructor(b,h,v,D){super(h,v);this.mZf=()=>{this.floatie.xm()};this.Mh=b;this.sI=D}Jeb(b,h,v){if(b=super.Jeb(b,h,v))b.cgc=!0,b.P$d=!0,b.preventDismissOnScroll=!0;this.Mh.XYa(this.mZf);return b}jSc(b,
h,v=null){this.sI.Xvh(()=>this.Jeb(b,h,v))}C6d(){this.floatie.cgc=!0}}Object(n.a)(mI,"ExternalContentFloatieInitializer",BD,[]);class nI{qLb(){Dm.instance.Goa&&(Ur.instance.U7a([1,0]),Dm.instance.R_d()&&Mt.instance.U7a([1]))}}Object(n.a)(nI,"RulerUser",null,[688]);class oI{constructor(){this.whitelistedControlIds=null}}Object(n.a)(oI,"StatusBarProps",null,[]);class DF{constructor(b,h,v=!0){this.$rd=!1;this.HOe=null;this.Zea=h.WG;this.XSe=h.Wuj;v?rj.a.get_instance().xk(7,()=>{this.eyh(b,h)}):this.eyh(b,
h)}eyh(b,h){window.setTimeout(()=>{wr.a.instance.he(()=>{Xj.UISurfaces.Hcm().then(v=>{const D=Object.assign(new oI,{whitelistedControlIds:h.whitelistedControlIds});v.initializeNewStatusBar(b,D,this.XSe);this.HOe=v;this.$rd=!0;window.setTimeout(()=>{wr.a.instance.he(()=>{const Q=[];if(h.UG){const ba=h.UG;for(let ta in ba)Q.push(appChrome.actions.updateControlHiddenState(ta,ba[ta]));appChrome.api.dispatch(Q)}this.qLb()},"RSB:I2")},0);return null}).catch(()=>{u.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");
return null})},"RSB:I1");if(h.Aqa&&b){DF.tXg||(w.AFrameworkApplication.va.qa(Ua.a.Yuj,Kd.a.frame,Object(z.a)(this,this.Zuj,"statusBarTabAction")),w.AFrameworkApplication.va.qa(Ua.a.Xuj,Kd.a.frame,Object(z.a)(this,this.Zuj,"statusBarTabAction")),DF.tXg=!0);const v=$t.a.fWd(h.Aqa,h.Akj,b,!1);v.TH=!0;this.Lgc(v,Ua.a.Yuj,Ua.a.Xuj)}},0)}qLb(){this.$rd&&this.Zea&&window.setTimeout(()=>{this.Zea(this.HOe.selectors.getStatusBarControlsMap(this.XSe),7)},0)}gob(b,h){this.$rd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,
h))},0)}RU(b){this.$rd&&this.Zea&&window.setTimeout(()=>{const h=this.HOe.selectors.getStatusBarControlsMap(this.XSe);if(h[b]){const v={};v[b]=h[b];this.Zea(v,7)}},0)}Lgc(b,h,v){const D=Yb.KeyInputManager.kc(zf.a.Aw,0),Q=Yb.KeyInputManager.kc(zf.a.Aw,4);b.ir(D);b.ir(Q);b.bindAction(D,h);b.bindAction(Q,v)}Zuj(){return 4}}DF.tXg=!1;Object(n.a)(DF,"ReactStatusBar",null,[]);class pI{constructor(){this.whitelistedControlIds=this.UG=this.WG=null;this.kUm=!1;this.Akj=this.Aqa=this.Wuj=null}}Object(n.a)(pI,
"ReactStatusBarInitOptions",null,[]);var bE=c(441);class qI{constructor(b,h,v,D,Q){this.cYb=this.QLa=this.Ma=null;this.YBo=()=>{const ba=Ya.App.xa.Dp.getRegion(pc.AppFrame.Aqa);ba&&ba.xNf()};this.Fom=(ba,ta,Ta,ob,Kb)=>{if(!Kb)return u.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ta)return 32;Kb&&2===Kb.length&&this.QLa&&this.QLa.gob(Kb[0],Kb[0]);return 32};this.Yad=ba=>{Ya.App.xa.WG(ba)};this.ga=D;wr.a.instance.he(()=>{this.Ma=Q;this.cYb=
this.QLa=null;const ba={};w.AFrameworkApplication.bsj||(ba[bE.a.I8n]=!0);ba.GiveFeedback=!w.AFrameworkApplication.zF;this.Ma.$("OfficeOnlineInGallatinTextVisible")||(ba.CenterStatusLabel=!0);ba[bE.a.tZi]=!0;this.Ma.$("WPMPackageIsEnabled")&&this.Ma.$("WPMStatusBarLabelIsEnabled")||(ba[bE.a.Bpg]=!0);this.Ma.$("AddInCommandsIsEnabled")||(ba[bE.a.osk]=!0);this.Ma.$("WordEditorShowOcsConnectionStatus")||(ba[bE.a.LRf]=!0);ba[bE.a.b3o]=!0;this.Ma.$("ReadingTimeIsEnabled")||(ba[bE.a.x6i]=!0);window.setTimeout(()=>
{this.bzm(b,ba)},0)},"SBU:I")}Tb(){this.ga.fb(Eb.a.Gje,Zb.a.application,this.Fom,96)}bzm(b,h){this.cYb=Ga.a.instance.Na("WordEditor.WordEditorReactCommandDefinitionMapping");const v={};for(const Q in h){var D=h[Q];v[this.$sf(Q)]=D}this.QLa=new DF(b,Object.assign(new pI,{UG:v,WG:this.Yad,kUm:!1,Wuj:"WordEditorStatusBar",Aqa:pc.AppFrame.Aqa,Akj:this.YBo}))}$sf(b){let h="";if(this.cYb){const v=this.cYb.Epf(b);v&&0<v.count&&(h=v.J(0))}return h&&""!==h?h:b}qLb(){this.QLa&&this.QLa.qLb()}gob(b,h){this.QLa&&
this.QLa.gob(this.$sf(b),h)}RU(b){this.QLa&&this.QLa.RU(this.$sf(b))}dispose(){}}Object(n.a)(qI,"StatusBarUser",null,[689,10]);var rI=c(1060);class UG{constructor(b){this.ga=b;this.ga.qa(Ua.a.K4c,Kd.a.frame,Object(z.a)(this,this.K4c,"reportFileMenuPageSwitch"));this.ga.qa(Ua.a.Ybj,Kd.a.frame,Rc.ActionManager.Pf)}K4c(b,h,v,D,Q){this.ga.processAction(this.FVl(Q[rI.a.$8d]),2);return 32}}Object(n.a)(UG,"FileMenuSQMInformation",null,[1251]);class sI extends UG{constructor(b){super(b);this.iUn()}iUn(){this.ga.qa(Ua.a.F6f,
Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.Sbj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.G6f,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.Tbj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.Ubj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.H6f,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.Vbj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.Wbj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.Xbj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.xcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.ycj,
Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.acj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.bcj,Kd.a.frame,Rc.ActionManager.Pf)}FVl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Ua.a.F6f;case "tabHome":case "FileHomePage":return Ua.a.Sbj;case "menuJewelInfo":case "FileInfoPage":return Ua.a.G6f;case "menuJewelNew":case "FileNewPage":return Ua.a.Tbj;case "menuJewelOpen":case "FileOpenPage":return Ua.a.Ubj;case "menuJewelPrint":case "FilePrintPage":return Ua.a.H6f;case "menuJewelSaveAs":case "FileSaveAsPage":return Ua.a.Vbj;
case "menuJewelShare":case "FileSharePage":return Ua.a.Wbj;case "menuJewelTransform":case "FileTransformPage":return Ua.a.Xbj}return Ua.a.Ybj}}Object(n.a)(sI,"WordEditorFileMenuSQMInformation",UG,[]);var tI=c(1058);class VG{constructor(b){this.ga=b;this.ga.qa(Ua.a.L4c,Kd.a.frame,Object(z.a)(this,this.L4c,"reportTabSwitch"));this.ga.qa(Ua.a.scj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.ucj,Kd.a.frame,Rc.ActionManager.Pf)}L4c(b,h,v,D,Q){this.ga.processAction(this.C$l(Q[tI.a.nhg]),2);return 32}}
Object(n.a)(VG,"RibbonSQMInformation",null,[1208]);class uI extends VG{constructor(b){super(b);this.zWn()}zWn(){this.ga.qa(Ua.a.jcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.lcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.J6f,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.mcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.ncj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.ocj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.pcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.qcj,Kd.a.frame,
Rc.ActionManager.Pf);this.ga.qa(sc.a.rcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.K6f,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.tcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(Ua.a.vcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.wcj,Kd.a.frame,Rc.ActionManager.Pf);this.ga.qa(sc.a.kcj,Kd.a.frame,Rc.ActionManager.Pf)}C$l(b){switch(b){case "tabAddins":case "Addins":return Ua.a.jcj;case "tabHome":case "Home":return Ua.a.mcj;case "tabInsert":case "Insert":return Ua.a.ncj;case "tabDeveloper":case "Developer":return Ua.a.lcj;
case "tabPageLayout":case "Layout":return sc.a.ocj;case "tabReferences":case "References":return sc.a.rcj;case "tabReview":case "Review":return sc.a.K6f;case "tabView":case "View":return Ua.a.vcj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return sc.a.tcj;case "tabMailings":case "Mailings":return sc.a.pcj;case "tabWordDesign":case "Design":return sc.a.wcj;case "tabHelp":case "Help":return sc.a.J6f;case "ctabPictureTools":case "Picture":return sc.a.qcj;
case "Copilot":return sc.a.kcj}return Ua.a.ucj}}Object(n.a)(uI,"WordEditorRibbonSQMInformation",VG,[]);class vI{constructor(b=null,h=null,v=null){this.UG=b||{};this.iBj=h||[];this.mBj=v||{}}}Object(n.a)(vI,"RibbonTrimmingProperties",null,[]);class wI{constructor(b,h,v){this.Mua=b;this.UG=h;this.jHf=v}}Object(n.a)(wI,"ReactRibbonJewelProperties",null,[]);class xI{constructor(){w.AFrameworkApplication.va.qa(Ua.a.HQa,Kd.a.frame,Object(z.a)(this,this.sOn,"reactFileMenuOpenFromTellMe"))}sOn(b,h,v,D,Q){if(1===
v)return 32;w.AFrameworkApplication.Fha("54hi9858;4f638686");if(!Q)return 32;b=Q.SourceControlId;17!==Q.UILocation||"New"!==b&&"Open"!==b||(Q=[],Lh.d("setFileMenuSelectedPage")&&("New"===b&&w.AFrameworkApplication.ta?2===w.AFrameworkApplication.ta.Nb.Sl?Q.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):Q.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&w.AFrameworkApplication.ta&&(2===w.AFrameworkApplication.ta.Nb.Sl?Q.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):
Q.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),Q.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(Q));return 32}IEi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}kSa(){return!1}f1i(){}lSh(){}}Object(n.a)(xI,"ReactFileMenu",null,[448]);class yI{caf(){const b=new xI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}
Object(n.a)(yI,"ReactFileMenuFactory",null,[709]);class LE{constructor(b,h,v,D=!1){this.flc=b;this.y0g=this.flc.R2a;this.L5d=Ga.a.instance.Na("Common.IOfficeTrialExperience");this.mJb=Ga.a.instance.Na("Common.IMacOfficeOffer");LE.nue=!1;this.OOm=D;this.ga=h;this.Ub=v}get oc(){return this.ga}get focusManager(){return this.Ub}K1e(){return this.y0g&&!!this.L5d&&!!this.mJb}sUa(b,h){this.flc.Po(()=>{u.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.y0g=!0;this.zif(b,h)});Ga.a.instance.Sa("Common.IOfficeTrialExperience").execute(v=>
{u.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.L5d=v;this.zif(b,h)});Ga.a.instance.Sa("Common.IMacOfficeOffer").execute(v=>{u.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.mJb=v;this.zif(b,h)})}zif(b,h){LE.nue||(this.K1e()?(u.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),LE.nue=!0):u.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}LE.nue=!1;Object(n.a)(LE,"RibbonDependencies",
null,[267]);class WG{constructor(b,h,v){this.ztb=b;this.ga=h;this.Ub=v}}Object(n.a)(WG,"WoncaRibbonUserFactory",null,[94]);class zI{constructor(b,h){this.Ave=b;this.K_b=h}Aob(b){this.Ave.Aob(b);this.K_b&&this.K_b.Aob(b)}S6c(b){this.Ave.S6c(b);this.K_b&&this.K_b.S6c(b)}abd(b){this.Ave.abd(b);this.K_b&&this.K_b.abd(b)}}Object(n.a)(zI,"RibbonCommandTrimmer",null,[96]);var gM=c(1236),hM=c(1150);class AI{constructor(b,h){this.Ma=b;this.rYb=h}Aob(b){aa.a.ui&&6>aa.a.Y1a&&(b.fseaInsertPicture=!0);this.Ma.$("InsertSymbolIsEnabled")||
(b.grpInsertSymbols=!0);this.Ma.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ma.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);cC.a.Wyi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ma.$("InsertOnlinePictureEnabled"),v=w.AFrameworkApplication.KDf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);v?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);v&&h?(b.fseaInsertOnlinePicture=
!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;w.AFrameworkApplication.LDf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);w.AFrameworkApplication.Nlc&&(b.btnOpenInClient=!0);w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")&&this.Olc(b)}S6c(b){b.menuJewel=!0;w.AFrameworkApplication.zF||(b.jbtnGiveFeedback=!0)}Olc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=
!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}abd(b){delete b.menuJewel;w.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);w.AFrameworkApplication.I4c||(b.jbtnReportAbuse=!0);w.AFrameworkApplication.ble||(b.jbtnTermsOfUse=!0);w.AFrameworkApplication.DLd||(b.jbtnFileSharing=!0);w.AFrameworkApplication.znb||(b.jbtnShareRWC=!0);w.AFrameworkApplication.Fjf||w.AFrameworkApplication.rng||(b.jbtnVersion=!0);this.rYb.L5d&&this.rYb.L5d.Iin||(b.btnjTryOffice=
!0,b.btnjTryOfficeForWordEditor=!0);this.rYb.mJb&&this.rYb.mJb.Aro||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);w.AFrameworkApplication.Nlc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Ya.App.hs?"btnjOpenInClient":"btnjEditInClient"]=!0;w.AFrameworkApplication.vMo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")?this.Olc(b):w.AFrameworkApplication.K.$("DirectPrintIsEnabled")?
b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;w.AFrameworkApplication.KG&&(this.Olc(b),b.faShare=!0);if(w.AFrameworkApplication.protectFile||aa.a.uQa||!w.AFrameworkApplication.iRc&&!w.AFrameworkApplication.wjf&&!w.AFrameworkApplication.png)b.jbtnFileEmbed=!0;gM.a.tvm()||(b.btnjClose=!0);w.AFrameworkApplication.QHb?(b.jbtnVersion=!0,u.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):w.AFrameworkApplication.Q_d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&
b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);w.AFrameworkApplication.I2f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ma.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=
!0);const h=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.hAi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(w.AFrameworkApplication.PK||".ODT"===Ya.App.FLc.toUpperCase()||!w.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!hM.a.Yzd||w.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(n.a)(AI,"WoncaCommandTrimmer",null,[96]);var iM=c(1001);c(436);var jM=c(1059),kM=c(1149);class BI{constructor(b,h){this.e2=this.nK=null;
this._clientId=b;this.naa=h}Pvl(){if(!qf.c(this.e2))return this.e2;this.Nhf();this.e2.style.display="block";this.naa&&this.naa.VZ(Object(z.a)(this,this.onResize,"onResize"));return this.e2}onResize(){this.tya()}tya(){this.thf()?(document.getElementById("application").style.minWidth="0px",(new kM.a(this.e2,null,w.AFrameworkApplication.isRtl)).I$n(this.e2)):w.AFrameworkApplication.ta.Nb.wJ||jM.a.J$n(this.e2,w.AFrameworkApplication.isRtl)}thf(){return w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):
!1}Nhf(){if(qf.c(this.nK)){var b;({QQc:b}=$t.a.$$c(!w.AFrameworkApplication.NX)).returnValue?(this.nK=YD.a("div"),this.nK.className=$t.a.hyl,this.nK.id=mo.CuiHelper.$Kd,b.appendChild(this.nK),this.Ghf(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.M8&&!w.AFrameworkApplication.NX&&this.Hhf(),this.Ovl()):w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&u.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}Ovl(){qf.c(this.e2)&&
(this.e2=YD.a("div"),this.e2.className=$t.a.Jjg,this.e2.style.display="none",this.nK.appendChild(this.e2))}Ghf(){Sys.UI.DomElement.addCssClass(this.nK,$t.a.iyl);w.AFrameworkApplication.isRtl&&YD.b(this.nK,"cui-rtl")}Hhf(){Sys.UI.DomElement.addCssClass(this.nK,"FlexBoxLayout")}}Object(n.a)(BI,"HeaderSkeleton",null,[]);var ME=c(618);class XG{constructor(){this.foc=null}tOo(){this.foc||(this.foc=Ga.a.instance.Na("Common.App.AccountSwitching.IAccountSwitching"))||u.ULS.sendTraceTag(589050651,1300,10,
"Unable to resolve IAccountSwitching")}cKl(){this.tOo();return this.foc?this.foc.getCustomAuthConfig():null}static GHm(){return w.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(n.a)(XG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class YG{constructor(){this.qIb=this.cultureName=null}}Object(n.a)(YG,"HeaderCultureInfo",null,[]);var iG=c(1623);class CI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(CI,"SearchInitializationSettings",
null,[]);var NE=c(291);class DI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(n.a)(DI,"DocumentTitleAppProps",null,[]);class EI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=
this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)(EI,"DocumentTitleCalloutAppProps",null,[]);class FI{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=
this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=
this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(n.a)(FI,"HeaderAppProps",null,[]);class GI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(GI,"HeaderControls",null,[]);class HI{constructor(){this.command=this.label=null}}Object(n.a)(HI,"WorkflowButtonAppProps",null,[]);var jG;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";
b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(jG||(jG={}));Object(n.b)("RenameDisableReason",jG);class II{constructor(b=""){this.n9f=this.documentTitleAppProps=this.zpg=null;this.ikk=""!==b?b:Se.a.s5}y9l(b){const h=Ga.a.instance.Na("Common.IExternalUICommandDefinitionMapping").MDb(b);if(h&&0<h.length)return h[0].externalUxCommand;u.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",
b));return null}Dvf(){if(!this.zpg){const b=ME.a();if(b){const h=this.y9l(b.command);h&&(this.zpg=Object.assign(new HI,{command:h,label:b.label}))}}return this.zpg}sRl(){return Object.assign(new GI,{workflowButton:this.Dvf()})}Lmn(){rj.a.get_instance().aI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;w.AFrameworkApplication.va.Qb(Ua.a.DJb,2,b)}X9l(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}TTl(){let b=null,h=null;var v=Ga.a.instance.Na("Common.IRenameProps");v?(v=v.Gei(),0!==v&&(b=this.X9l(v),h=jG[v])):u.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new EI,{breadcrumbBrandName:w.AFrameworkApplication.us.breadcrumbBrandName,breadcrumbBrandUrl:w.AFrameworkApplication.us.breadcrumbBrandUrl,breadcrumbFolderName:w.AFrameworkApplication.us.breadcrumbFolderName,breadcrumbFolderUrl:w.AFrameworkApplication.us.breadcrumbFolderUrl,
hideDocumentTitleInput:w.AFrameworkApplication.ta.Nb.Hrm,isVersionHistoryEnabled:this.Sso(),documentExtension:G.a.Ega(w.AFrameworkApplication.fileName),isMoveEnabled:32===w.AFrameworkApplication.va.processAction(Ua.a.DJb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,openBreadcrumbsInNewTab:w.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}w7h(){if(!this.documentTitleAppProps){const b=w.AFrameworkApplication.us.az;this.documentTitleAppProps=Object.assign(new DI,
{documentTitle:w.AFrameworkApplication.WId?b:G.a.jJ(b),onFirstRender:Object(z.a)(this,this.Lmn,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.TTl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Sso(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.fBi}yqo(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.eBi}zso(){const b=!ME.b()&&!w.AFrameworkApplication.hideHeader&&!w.AFrameworkApplication.Dxf&&(w.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||
w.AFrameworkApplication.K.$("TeamsChatIsEnabled"));u.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}p5k(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});u.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}wTn(b=!1){appChrome.getHeaderApi().then(h=>{const v=Ga.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",
()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",D=>{v.onFlexPaneOpen(D)});h.setHeaderCommandHandler("OnFlexPaneClose",D=>{v.onFlexPaneClose(D)});h.setHeaderCommandHandler("SetCookie",D=>Qb.a.set(D.cookieName,D.value));h.setHeaderCommandHandler("GetCookie",D=>this.uRl(D));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(z.a)(this,this.Dvf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.w7h,"getDocumentTitleAppProps")),
h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Mmn();return null}));iG.a.ZZd()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.qfi,"getSearchInitializationSettings"))})}Mmn(){Ga.a.instance.Sa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.nqb(!1,w.AFrameworkApplication.va.mode)})}uRl(b){b=Qb.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}sdm(){return NE.AppChromeOverrideUtilities.isEnabled?NE.AppChromeOverrideUtilities.YQd("suiteux-shell",
!1):this.ikk+w.AFrameworkApplication.Kia+"suiteux-shell"}onFirstRender(){Ga.a.instance.Sa("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.upo.continueWith(Object(z.a)(this,this.p5k,"continueShellServiceDataAsync"),3)});rj.a.get_instance().aI(15)}onFullyLoaded(){rj.a.get_instance().aI(16)}Gna(b=!1){a:{try{var h=lk.a.og(w.AFrameworkApplication.lcid);if(h){var v=Object.assign(new YG,{cultureName:h.name,qIb:h.qIb});break a}}catch(D){u.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
w.AFrameworkApplication.lcid.toString())}v=Object.assign(new YG,{cultureName:"en-us",qIb:"en"})}h=Ga.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");v=Object.assign(new FI,{appName:CommonUIStrings.l_AppNameShort,culture:v.cultureName,language:v.qIb,isConsumer:!w.AFrameworkApplication.ung,showAppLauncher:ME.h(),showMeControl:ME.g(),hideUserName:w.AFrameworkApplication.ZUd,defaultDocumentTitleToLeft:w.AFrameworkApplication.QOh,assetsContainerOverride:this.sdm(),controls:this.sRl(),
documentTitleAppProps:b?null:this.w7h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.Dvf(),showChatControl:this.zso(),showGoPremiumControl:ME.i(),showDiscoverPremiumButton:ME.f(),enableSearchControl:iG.a.QQm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.yqo(),testTraffic:w.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,
"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:w.AFrameworkApplication.zqo()});!w.AFrameworkApplication.$Qb||w.AFrameworkApplication.Leg?(v.userDisplayName=w.AFrameworkApplication.userName,v.emailAddress=w.AFrameworkApplication.K.jb("UserPrincipalName"),v.userID=w.AFrameworkApplication.K.jb("Puid")||"",v.signOutLink=w.AFrameworkApplication.Leg):w.AFrameworkApplication.signInUrl&&(v.signInLink=w.AFrameworkApplication.signInUrl);iG.a.ZZd()&&
(h=this.qfi(),v.loadTellMeResources=h.loadTellMeResources,v.getTokenRequestDictionary=h.getTokenRequestDictionary,v.enableVanillaSearchBox=w.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),v.userRing=h.userRing);XG.GHm()&&(h=new XG,v.shellAuthProviderConfigPromise=Object(z.a)(h,h.cKl,"getAccountSwitchingConfig"));this.wTn(b);return v}qfi(){if(!this.n9f){const b=new iG.a;let h=w.AFrameworkApplication.K.jb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.n9f=Object.assign(new CI,
{loadTellMeResources:b.N_m(),getTokenRequestDictionary:Object(z.a)(b,b.Dfm,"getTokenRequestDict"),userRing:h})}return this.n9f}}Object(n.a)(II,"ReactSharedHeaderPropsHelper",null,[1416]);class ZG{constructor(){this.label=this.value=null}}Object(n.a)(ZG,"TextInfoSectionField",null,[]);var EF=c(937),lM=c(1211);class $G{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(n.a)($G,"CommandDefinition",null,[]);class JI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=
this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(n.a)(JI,"CommandDefinitionMapping",null,[]);const mM=b=>Object.assign(new JI,{getCommandByExternalUxId:h=>{const v=b.getCommandByExternalUxId(h);return v?Object.assign(new $G,{commandId:parseInt(v.commandId),externalUxCommand:v.externalUxCommand}):Object.assign(new $G,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(Ua.a.Hg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,
"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var nM=c(1389);class KI{}Object(n.a)(KI,"RibbonInitState",null,[]);var LI=c(412),oM=c(1323);class MI{constructor(){}flatten(b){const h=[];for(const v of b)h.push.apply(h,v);return h}}Object(n.a)(MI,"ReactAsyncDispatcher",null,[]);var pM=c(1665);class NI{constructor(b,h){this.Djk=b;this.TYj=h}}Object(n.a)(NI,"ReactExecuteCommandContext",null,[]);class ry{}ry.Trigger="FontTrigger";ry.Name="FontName";ry.Action="FontAction";ry.Level=
"FontLevel";ry.IsPinned="FontIsPinned";Object(n.a)(ry,"FontPickerLogProperties",null,[]);class OI{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb=null,Vb=null){this.zZ=null;this.nfh=!1;this.xze=[];this.ugd=-1;this.Vvd=!1;this.Okk=0;this.cqc=null;this.Xah=!1;this.Yfd=null;this.i5g=!1;this.Lea=b;this.Ubb=h;this.bQe=Object(Ka.a)(1215,b);this.Pl=v;this.Ub=D;Q&&(this.zZ=new pM.a(Q,D));this.ehk=ba;this.h2j=ta;this.Ip=Kb;this.ga=Ta;this.Qub={};this.Ma=ob;this.Cvg=Vb;ob&&(ob.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)||ob.$("EnqueueTasksWhenTaskMgrIsYielding"))&&wi.a.instance.iAd.CWR(()=>this.nfh=!0);ob&&(b=this.Ma.jb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Yu:this.cqc}=F.d(b));this.cqc||(this.cqc={})}get pfe(){return!!window.appChrome&&!!appChrome.selectors}Cgj(){-1!==this.ugd&&window.clearTimeout(this.ugd);this.ugd=window.setTimeout(()=>{for(this.ugd=-1;0<this.xze.length;){if(xb.a.instance.Kv){this.Cgj();break}const b=this.xze.shift();b&&this.executeCommand(b.Djk,b.TYj)}},0)}executeCommand(b,
h){if(xb.a.instance.Kv){if(this.nfh){this.xze.push(new NI(b,h));this.Cgj();return}u.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,lb.a.toJSON(h.payload));if(this.Ma.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const v=this.Pl.getCommandByExternalUxId(b),D=h.modelType;this.Cvg&&this.Cvg.c1m(b,h);v?this.Xwl(b,
v,D,h):this.Ywl(b,D,h);this.OUk(h);this.hMo(h);this.i9m(b,h)}}Ywl(b,h,v){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.mXh(v,b);break;case "ButtonModel":this.Swl(v,b)}}zWo(b,h,v,D,Q){if(v.payload)switch(v.payload.type){case "CoauthorMenuPayload":b.MenuItemId=v.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=v.payload.commandValueId;b.TerminalParentControlId=v.payload.terminalParentControlId;this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)?(h=!0,qf.c(v.payload.dismissHostingSurfaceOnExecute)||(h=v.payload.dismissHostingSurfaceOnExecute),h&&this.n3()):this.n3();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=v.payload.commandValueId;Q=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=v.payload.commandValueId;Q=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=D;return Q}AWo(b,h,v){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=
this.Pl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Pl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":v.CommandId=h.payload.executedControl;v.ControlId=h.payload.executedControl;v.ParentControlId=h.payload.parentControl;v.CloseAllMenus=!0;this.n3();break;case "TellMeSearchResultChangePayload":v.Value=h.payload.searchText;break;case "SmartLookupPayload":v.CommandValueId=h.payload.selectionContextJson}return b}Xwl(b,
h,v,D){var Q=this.ZCn(D,v),ba=h.commandId;const ta={},Ta={};switch(v){case "SplitButtonModel":if(this.oQc(D.payload,Object(z.a)(this,this.DXo,"updateSplitButtonMenuState"),Q))return;ta.MenuItemId=h.menuItemId;this.Fbg(D,ta);break;case "StatefulSplitButtonModel":if(this.oQc(D.payload,Object(z.a)(this,this.JXo,"updateStatefulSplitButtonMenuState"),Q))return;v=D.payload.statefulData;Q=D.payload.statefulMode;"color"===Q?ta.Color=v:"icon"===Q&&(v=this.Pl.getCommandByExternalUxId(v))&&(ta.MenuItemId=v.menuItemId);
break;case "FileMenu":ta.MenuItemId=h.menuItemId;ta.SourceControlId=b;D.payload&&"FileMenuPageSwitchPayload"===D.payload.type&&this.pmm(ba,D.payload,b);break;case "TellMe":ba=this.AWo(ba,D,ta);ta.SourceControlId=b;ta.Location=D.payload.location;break;case "ButtonModel":D.payload&&"TabSwitchPayload"===D.payload.type?this.iom(ta,D):ba=this.zWo(ta,h,D,b,ba);break;case "CompoundButtonModel":ta.MenuItemId=h.menuItemId;ta.CommandValueId=D.payload.commandValueId;ta.SourceControlId=b;this.Fbg(D,ta);this.n3();
break;case "ToggleButtonModel":case "InkButtonModel":ta.MenuItemId=h.menuItemId;ta.SourceControlId=b;this.Fbg(D,ta);this.n3();break;case "FontPickerModel":switch(D.payload.type){case "MenuOpenPayload":ba=this.Pl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;ta[ms.a.FontPickerId]=D.payload.launcherId;break;case "MenuClosePayload":ba=this.Pl.getCommandByExternalUxId("FontPickerMenuClose").commandId;ta[ms.a.FontPickerId]=D.payload.launcherId;break;case "FontPickerFontSelectedPayload":v=D.payload.font;
Q=null;"string"===typeof v?(Q=rp.FontUtils.oRa(v),ta.CommandValueId=Q,Q=rp.FontUtils.GGd(Q)):(v.data?(ta.CommandValueId=v.data.fontToApply,ta.MenuItemId=v.data.themeIndex,ta[ms.a.Formatting]=v.data):ta.CommandValueId=v.name,Q=v);ta.SourceControlId=b;ta[ms.a.RequestUpdateMru]=Q;Ta[ry.Name]=D.payload.nameToLog?D.payload.nameToLog:"string"===typeof v?rp.FontUtils.LXd(v)?"*"+v:rp.FontUtils.LCf(v)?"[EF]":"[MF]":"";Ta[ry.IsPinned]=D.payload.isPinned;Ta[ry.Level]=D.payload.level;this.iKf();break;case "FontPickerFontInfoRequestedPayload":ta.CommandValueId=
D.payload.font.name;ta[ms.a.Trigger]=D.payload.trigger;Ta[ry.Trigger]=D.payload.trigger;Ta[ry.Name]=D.payload.nameToLog;this.iKf();break;case "FontPickerFontPinningPayload":v=D.payload.isPinned;ta.CommandValueId=D.payload.fontKey;ta[ms.a.IsPinned]=v;Ta[ry.Name]=D.payload.nameToLog;Ta[ry.Action]=v?"pin":"unpin";Ta[ry.Level]=D.payload.level;this.iKf();break;default:return}break;case "ComboBoxModel":var ob=D.payload.type;switch(ob){case "MenuOpenPayload":case "MenuPopulatePayload":this.qjc(D.payload.launcherId,
Q)&&(ba={},ba[D.payload.launcherId]=v,this.Ubb.s1c(ba,Lh.g(D.payload)),this.Qub[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":v=D.payload.newValue;if(!v)return;v.value?(ta[mi.a.Value]=v.value,ta[mi.a.IsFreeForm]=!0):(ta[mi.a.Value]=v.text,ta.MenuItemId=v.key,ta.CommandValueId=v.commandValueId);"ComboBoxPreviewPayload"===ob&&(ba=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(D.payload.type){case "ZeroTermContextMenuClosePayload":v=
lb.a.HO(D.payload);for(ob of v)ta[ob]=D.payload[ob];break;default:this.oQc(D.payload,Object(z.a)(this,this.cUo,"updateFlyoutAnchorMenuState"),Q),ta.launcherId=D.payload.launcherId}break;case "InkFlyoutAnchorModel":this.oQc(D.payload,Object(z.a)(this,this.aVo,"updateInkFlyoutAnchorMenuState"),Q);ta.launcherId=D.payload.launcherId;break;case "ColorPickerModel":switch(D.payload.type){case "ColorPickerPayload":ta[Tc.Color]=D.payload.selectedColorId;ta.colorRGB=D.payload.color;break;case "ColorPickerPreviewPayload":ba=
h.commandPreviewId;ta[Tc.Color]=D.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "SpinButtonModel":ta[kh.a.Number]=D.payload.value;ta[kh.a.UnitType]=Nf.a.BNa(D.payload.unitType.toLowerCase());ta[kh.a.Text]=D.payload.reservedValue;break;case "SliderModel":ta[$i.Value]=D.payload.value;break;case "InsertTableModel":ta[lq.a.Rows]=D.payload.rows;ta[lq.a.Columns]=D.payload.columns;break;case "CheckboxModel":ta[Ff.a.On]=D.payload.checked;
ta.MenuItemId=h.menuItemId;ta.TerminalParentControlId=D.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.oQc(D.payload,Object(z.a)(this,this.NWo,"updatePreviewGalleryMenuState"),Q)){ta.launcherId=D.payload.launcherId;break}this.mXh(D,b);return;case "DocumentTitleModel":switch(D.payload.type){case "DocumentTitleRenamePayload":ta.getNewDocumentTitle=D.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ba={};ba[D.payload.launcherId]=v;this.Ubb.s1c(ba,Lh.g(D.payload));this.Qub[b]=
new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ta.MenuItemId=D.payload.url;this.e2m(D.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":ta.MenuItemId=D.payload.assetId;ta.SourceControlId=b;w.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ta.IsPremium=D.payload.isPremium||!1);this.f2m(D.payload.pageId);break;case "CoauthorGallery":ta.RenderTime=D.triggerTime;break;case "PeopleWell":ta.RenderTime=
D.triggerTime;break;case "SyncStatus":ta.SourceControlId=b;break;case "InputBoxModel":ta.Text=D.payload.newValue;break;case "PersonaButtonModel":ta.CommandValueId=D.payload.commandValueId;this.qnm(D.payload);break;case "MultiActionButtonModel":ta.CommandValueId=D.payload.commandValueId;ta.Href=D.payload.href;ta.Type=D.payload.type;ta.TerminalParentControlId=D.payload.terminalParentControlId;this.n3();break;default:return}ba&&!this.isShadowMenuOpen(D.payload)&&(ta.CommandValueId||(ta.CommandValueId=
ta.MenuItemId),h.legacyControlId&&(ta.LegacyId=h.legacyControlId),ta.SourceControlId||(ta.SqmControlId=b),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ta.launcherId&&(h=this.Pl.getCommandByExternalUxId(ta.launcherId))&&(ta.launcherCommandId=parseInt(h.commandId)),D.payload&&!qf.c(D.payload.PRIReadinessCheck)&&(ta.PRIReadinessCheck=D.payload.PRIReadinessCheck,this.Xah=!0),D.payload&&!qf.c(D.payload.shouldTakeFocus)&&(ta[Ex.a.gTa]=D.payload.shouldTakeFocus),
h=this.PYe(D,ta),qf.c(D.triggerTime)||(Ta.TriggerTime=D.triggerTime),D.payload&&!qf.c(D.payload.userActionKey)&&(Ta.userActionKey=D.payload.userActionKey),this.X$f(Ta,D,b,ba),this.bQe.executeCommand(ba,ta,this.getSelectedTabId(),h,!0,()=>{this.uNf(ta,b)},Ta,Lh.g(D.payload)))}X$f(b,h,v,D){if(this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&v&&D&&h.payload){const Q=!qf.c(h.payload.launcherId);v=this.Jfj(this.r4l(Q?h.payload.launcherId:v,
D),D,!1);b.ControlId=v;const ba=h.payload.inputMethod;qf.c(ba)||this.k1m(1===ba,2===ba||3===ba||4===ba,Q||"TabSwitchPayload"===h.payload.type,v)}this.Ma&&this.Ma.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.Jfj(h.payload.terminalParentControlId,D,!0))}k1m(b,h,v,D){this.Yfd||(this.Yfd={});this.Yfd[D]||(this.Yfd[D]=1,h?v?Qe.b("DistinctUserInitiatedNavigationalCommand",null,0,!0,0):Qe.b("DistinctUserInitiatedTerminalCommand",
null,0,!0,0):b&&Qe.b("DistinctUserInitiatedKeyboardCommand",null,0,!0,0));h?v?Qe.b("UserInitiatedNavigationalCommand",null,0,!0,0):Qe.b("UserInitiatedTerminalCommand",null,0,!0,0):b&&Qe.b("UserInitiatedKeyboardCommand",null,0,!0,0)}Jfj(b,h,v){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;u.ULS.sendTraceTag(510247689,207,15,v?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}r4l(b,h){h=parseInt(h);h=Rc.ActionManager.g8e(h)||Rc.ActionManager.Baa(h)||"";return!qf.c(h)&&h in this.cqc?this.cqc[h]:100<b.length?"":b}iKf(){this.Ip&&this.Ip.execute(b=>{b.TJf("ModernFontPickerExperience")})}PYe(b,h){let v=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(v=b.payload.inputMethod,h[Ex.a.Ix]=v);return v}uNf(b,h){const v=Object(Ka.a)(gf.AFrame,w.AFrameworkApplication.ta);if(this.Ub&&this.Npj(b)){if(!this.Ub.currentScope&&v){let D="null";if(b){const Q=
b.Value;delete b.Value;D=lb.a.toJSON(b);qf.c(Q)||(b.Value=Q)}u.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,D,v.W5a)}this.Ub.$kf()}(this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name!==gf.AFrame.Ppa&&v&&this.Ub.currentScope.name!==v.W5a||this.Npj(b))&&this.h_k(b)}Npj(b){return!!b&&!qf.c(b[Ex.a.gTa])&&b[Ex.a.gTa]}h_k(b){Ex.a.Ix in b&&1===b[Ex.a.Ix]&&EF.ShyRibbon.qeb(1,
0)}iom(b,h){Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.n3();this.Lea.xm();if(this.ehk&&this.ga){const v={};v[tI.a.nhg]=h.payload.tabId;this.ga.Qb(Ua.a.L4c,2,v,this.GX(h));qf.c(h.payload.inputMethod)||(this.ga.processAction(Ua.a.scj,2),this.Vvd||this.Mwo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Pl.ouf(h);u.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Ip&&h){const v=
h+"TabSwitchActivity";this.Ip.execute(D=>{D.TJf(v)})}}oQc(b,h,v){const D=b.type;return"MenuClosePayload"===D?!0:"MenuOpenPayload"===D?(h(b,v),!0):!1}qnm(b){b=b.type;"MenuOpenPayload"===b?w.AFrameworkApplication.z9c=!0:"MenuClosePayload"===b&&(w.AFrameworkApplication.z9c=!1)}ZCn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const v=b.payload.launcherId,D=this.Pl.getCommandByExternalUxId(v);return D&&D.populationProps?
((b=this.Ubb.tZf(D,h,b.payload))&&v in this.Qub&&delete this.Qub[v],b):!1}cUo(b,h){const v=b.launcherId;this.qjc(v,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(v),this.rmc(h,v,Lh.g(b)))}aVo(b,h){const v=b.launcherId;this.qjc(v,h)&&(h=Lh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(v):appChrome.selectors.getFlyoutAnchorMenuItems(v),this.rmc(h,v,Lh.g(b)))}NWo(b,h){const v=b.launcherId;this.qjc(v,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(v),this.rmc(h,
v,Lh.g(b)))}DXo(b,h){const v=b.launcherId;this.qjc(v,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(v),this.rmc(h,v,Lh.g(b)))}JXo(b,h){const v=b.launcherId;this.qjc(v,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(v),this.rmc(h,v,Lh.g(b)))}getSelectedTabId(){return this.pfe?appChrome.selectors.getSelectedTabId():null}rmc(b,h,v){this.Ubb.s1c(b,v);this.Qub[h]=new Date}qjc(b,h){let v=!0;b in this.Qub&&(v=this.Qub[b].getTime()<this.Lea.Toa.getTime());return v&&!h&&this.pfe}mXh(b,h){const v=
{};var D=b.payload.selectedGalleryId;const Q=this.Pl.getCommandByExternalUxId(D);if(Q){v.SourceControlId=D;v.MenuItemId=Q.menuItemId;v.SqmControlId=h;Q.legacyControlId&&(v.LegacyId=Q.legacyControlId);b.payload&&!qf.c(b.payload.shouldTakeFocus)&&(v[Ex.a.gTa]=b.payload.shouldTakeFocus);this.T6l(b.payload,v);(D=this.GX(b))||(D={});this.X$f(D,b,h,Q.commandId);const ba=this.PYe(b,v);this.bQe.executeCommand(Q.commandId,v,this.getSelectedTabId(),ba,!0,()=>{this.uNf(v,h)},D,Lh.g(b.payload))}}Swl(b,h){const v=
this.Pl.getCommandByExternalUxId(h);if(v){const D={};D.SourceControlId=h;D.MenuItemId=h;D.SqmControlId=h;b.payload&&!qf.c(b.payload.shouldTakeFocus)&&(D[Ex.a.gTa]=b.payload.shouldTakeFocus);let Q=this.GX(b);Q||(Q={});this.X$f(Q,b,h,v.commandId);const ba=this.PYe(b,D);this.bQe.executeCommand(v.commandId,D,this.getSelectedTabId(),ba,!1,()=>{this.uNf(D,h)},Q,Lh.g(b.payload))}}T6l(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}Fbg(b,h){b.payload&&"toggled"in b.payload&&(h[Ff.a.On]=
b.payload.toggled)}i9m(b,h){if("MenuOpen"===b){if(this.zZ&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.zZ.onMenuOpen()}else if("MenuClose"===b&&this.zZ)this.zZ.onMenuClose()}n3(){this.zZ&&this.zZ.SSf()}GX(b){let h=null;qf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}pmm(b,h,v){if(this.h2j&&this.ga){const D={};D[rI.a.$8d]=v;this.ga.Qb(Ua.a.K4c,2,D)}this.rmc(h.pageControlIdMap,b,Lh.g(h))}f2m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Ua.a.xcj,
2);break;case "FileNewPage":this.ga.processAction(Ua.a.ycj,2)}}e2m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Ua.a.acj,2);break;case "FileOpenPage":this.ga.processAction(Ua.a.bcj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}Mwo(b){if(w.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Ip.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Vvd=!0;else{if(w.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.Ip.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.Okk)){this.Vvd=!0;return}w.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Ua.a.$Ob,2)&&(this.Vvd=!0)}}OUk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.Xah&&appChrome.PRIToastManager.dismissToast()}hMo(b){!this.i5g&&this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",!1)&&(b=Lh.g(b.payload),31===b||14===b||15===b||2===
b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.i5g=!0)}}Object(n.a)(OI,"ReactExecuteCommandHandler",null,[]);class PI{constructor(){this.fileMenu=null}get oqb(){return 0}get X3a(){return 0}get $Fa(){return!1}tya(){}kzj(){}r_(){return!1}Ckj(){}y3(){return!1}FIa(b){return this.fileMenu&&this.fileMenu.kSa(b)?!0:!1}get kja(){return!1}gob(){}VXd(){return!1}get CFd(){return null}set CFd(b){}ufa(){}nba(){}pvf(){return null}dOa(){}refresh(){}get controls(){return null}Ngc(){return!1}Heb(){}xm(){}get wF(){return null}set wF(b){}Fad(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(n.a)(PI,"ReactRibbonExternal",null,[427,374,428]);class QI{constructor(b,h,v,D){this.Ub=b;this.ga=h;this.Jkh=v;this.sYb=D}initialize(){this.ga.qa(Ua.a.s5c,Kd.a.frame,Object(z.a)(this,this.xej,"ribbonMoveForwardAction"));this.ga.qa(Ua.a.r5c,Kd.a.frame,Object(z.a)(this,this.wej,"ribbonMoveBackwardAction"));this.ga.qa(Ua.a.lee,Kd.a.frame,Object(z.a)(this,this.tej,"ribbonEscAction"));var b=$t.a.fWd(this.sYb,null,this.Jkh,!1);b.TH=!0;this.Lgc(b,Ua.a.s5c,Ua.a.r5c);b.bindAction(Yb.KeyInputManager.kc(zf.a.IIa,
0),Ua.a.lee);b=this.Ub.fe(gf.AFrame.Ppa);b.TH=!0;this.Lgc(b,Ua.a.S_a,Ua.a.S_a);pf.a.instance.mb(Sc.a.Lx,this.Jkh,Object(z.a)(this,this.msn,"onRibbonMouseDown"));b=Z.a.instance;Lh.a("enterKeytipMode")&&b.gko(this.sYb,()=>{appChrome.api.enterKeytipMode(!1)});Lh.a("exitKeytipMode")&&b.cko(this.sYb,()=>{appChrome.api.exitKeytipMode();EF.ShyRibbon.qeb(1,0)});w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa&&(b=Object(Ka.a)($c.FocusManager,this.Ub))&&b.Vwk(Object(z.a)(this,this.tnn,"onFocusScopeChanged"))}tnn(b,
h){if((b=Object(Ka.a)(gf.AFrame,w.AFrameworkApplication.ta))&&h.fQi&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa){const v=appChrome.selectors.getShyState();v.isActive&&h.fQi.name===b.W5a&&EF.ShyRibbon.qeb(v.state,1)}}xej(){return 4}wej(){return 4}tej(){Lh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa&&appChrome.selectors.getShyState().isActive&&EF.ShyRibbon.qeb(1,0),this.Ub.mg(gf.AFrame.Pn));return 4}Lgc(b,h,v){const D=
Yb.KeyInputManager.kc(zf.a.Aw,0),Q=Yb.KeyInputManager.kc(zf.a.Aw,4);b.ir(D);b.ir(Q);b.bindAction(D,h);b.bindAction(Q,v)}msn(b){b.Gb&&b.Gb.target&&"input"!==b.Gb.target.tagName.toLowerCase()&&b.Gb.preventDefault();return!1}dispose(){this.ga.Qv(Ua.a.s5c,Kd.a.frame,Object(z.a)(this,this.xej,"ribbonMoveForwardAction"));this.ga.Qv(Ua.a.r5c,Kd.a.frame,Object(z.a)(this,this.wej,"ribbonMoveBackwardAction"));this.ga.Qv(Ua.a.lee,Kd.a.frame,Object(z.a)(this,this.tej,"ribbonEscAction"))}}Object(n.a)(QI,"ReactRibbonFocusManager",
null,[10]);class oC{constructor(b,h,v,D,Q,ba,ta,Ta=null,ob=!0,Kb=null,Vb=null){this.G$a=this.Wwd=this.xve=this.Lea=null;this.Peh=[];this.Xsd=null;this.WLa=b;this.YJe=h;this.sYb=v;this.Ub=D;this.ga=Q;this.Pl=ba;this.Lea=Kb?Kb:new eD(dv.instance,this.Pl);this.Evc=ta;this.ddh=new PI;this.XLa=Ta;this.LRe=ob;new MI;this.DUg=Vb;rj.a.get_instance().xk(7,Object(z.a)(this,this.ulo,"setRibbonPostInteractiveReady"));rj.a.get_instance().xk(7,Object(z.a)(this,this.U5m,"logRibbonLoadedActivity"));rj.a.get_instance().xk(19,
Object(z.a)(this,this.I0m,"logAppLoadedActivity"));w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&rj.a.get_instance().xk(7,Object(z.a)(this,this.NWn,"registerSubComponentReporting"));rj.a.get_instance().xk(7,Object(z.a)(this,this.bMn,"queueSettingsDependentActions"))}initialize(b,h,v=null){this.LRe||this.aI(5);v?v.then(()=>{this.pbj()}).catch(()=>u.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
LI.a.e$c(LI.a.e$c(ak.Task.WAA(this.kGi(b),this.jGi(oC.jZj)),()=>this.jGi(oC.CVj)),()=>this.kGi(h)).continueWith(()=>{this.pbj()},11)}dispose(){this.zPo();this.G$a&&this.G$a.lSh();this.Xsd&&this.Xsd.dispose();for(const b of this.Peh)rj.a.get_instance().dXk(b);w.AFrameworkApplication.va.Qv(Ua.a.B3n,Kd.a.frame,Rc.ActionManager.Pf)}jGi(b){return Ga.a.instance.resolve("Common.ISharedDependencyLoader").Pcc(w.AFrameworkApplication.Bz(b,2))}kGi(b){return""===b?ak.Task.M3(!0):Ga.a.instance.resolve("Common.ISharedDependencyLoader").Pcc(w.AFrameworkApplication.Bz(b,
3))}ezm(){(this.XLa||this.Evc)&&appChrome.api.dispatch(this.sii());this.tno();Lh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(w.AFrameworkApplication.t5);this.Lea.xm()}pbj(){this.ezm();this.LRe&&(appChrome.renderAppChrome(this.WLa,Lh.e()),this.aI(10));this.Tmh();this.u4e();this.LRe&&this.aI(5);this.qqi()}qqi(){this.Ub&&this.ga&&this.sYb&&(this.Xsd=new QI(this.Ub,this.ga,this.WLa,this.sYb),this.Xsd.initialize())}get q5c(){return this.ddh}setCommandDefinitionMapping(){if(Lh.a("setCommandDefinitionMapping")){const b=
mM(this.Pl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa&&Lh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.Sfc()})}Tmh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Ka.a)(eD,this.Lea);this.xve=new OI(this.Lea,b.Igc,this.Pl,this.Ub,this.YJe,Ga.a.instance.Na("Common.IRibbonSQMInformation"),Ga.a.instance.Na("Common.IFileMenuSQMInformation"),
w.AFrameworkApplication.va,w.AFrameworkApplication.K,Ga.a.instance.Sa("Common.ISystemInitiatedFeedback"),null);this.EJk();this.mlm()}EJk(){this.Wwd=appChrome.api.bindCommandHandler((b,h)=>{this.xve.executeCommand(b,h)})}zPo(){this.Wwd&&(this.Wwd(),this.Wwd=null)}tno(){appChrome.api.initializeLogger(new na.a)}uEa(){return this.Lea?this.Lea.uEa():[]}Sfc(){wr.a.instance.he(()=>{let b=null;wr.a.instance.he(()=>{b=this.uEa()},"RB:GA");b&&0<b.length&&(this.Lea.Toa=new Date,wr.a.instance.he(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.G$a&&wr.a.instance.he(()=>{this.G$a.f1i()},"RB:J")},"RB:PFSU")}Oad(){this.Lea.Oad()}hKb(){}Bpk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}sii(){var b=w.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(v=>
{v.isFeatureEnabled("ConnectedServices",!0).then(D=>{D&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.l8h());b=new nM.a(this.Pl);this.XLa.UG&&(oM.a.yMo(this.XLa.UG),h.push.apply(h,b.rNd(this.XLa.UG)));if(this.XLa.iBj)for(const v of this.XLa.iBj)h.push(appChrome.actions.updateGallerySectionHiddenState(v.Z1h,v.Pkp,v.Tmp));h.push.apply(h,b.$2h(this.XLa.mBj));
return h}l8h(){const b=[];if(this.Evc&&this.Evc.UG){const v=this.Evc.UG;for(let D in v){var h=v[D];const Q=this.Pl.Epf(D);if(Q)for(let ba of Q)b.push(appChrome.actions.updateControlHiddenState(ba,h))}}return b}CIa(b){b&&this.Lea.Igc.s1c(b,0)}tZf(b){this.Lea.Igc.tZf(this.Pl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}dol(){const b=w.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=w.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.yXo(b,
"Shared"===(h.SharingStatus||"")))}bMn(){w.AFrameworkApplication.K.Po(()=>{this.dol()})}yXo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}aI(b){rj.a.get_instance().aI(b);this.Peh.push(b)}ulo(){Lh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new KI,{postRibbonInteractiveReady:!0})))}u4e(){this.Evc&&this.DUg&&(this.G$a=this.DUg.caf(),this.ddh.fileMenu=this.G$a)}AXm(b,h){this.G$a&&this.G$a.IEi(b,h)}h8f(b,
h,v){if(1===v)return 32;this.lmj(!0);this.Sfc();w.AFrameworkApplication.ta.updateCommandUI();return 32}i8f(b,h,v){if(1===v)return 32;this.lmj(!1);this.Glo();this.Sfc();w.AFrameworkApplication.ta.updateCommandUI();return 32}mkg(b,h,v){if(1===v)return 32;(b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback"))&&b.execute(D=>{D.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}Glo(){Qb.a.eTa(w.AFrameworkApplication.K.jb("IsSimplifiedRibbonOnCookieName"),"true",Qb.a.cRa)}lmj(b){Qb.a.eTa(w.AFrameworkApplication.K.jb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),Qb.a.cRa)}U5m(){if(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.$q){const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),w.AFrameworkApplication.Zoa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),w.AFrameworkApplication.Zoa("69a7h198;dfd7j584"));
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFreemiumUpsellEnabled()&&w.AFrameworkApplication.Zoa("5fjej882;e0jjh200")})}}I0m(){this.ga.qa(Ua.a.mkg,Kd.a.frame,Object(z.a)(this,this.mkg,"triggerModeSwitcherTUI"));const b=Qb.a.xba(w.AFrameworkApplication.K.jb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const h=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");
h&&(w.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(v=>{v.logActivity("VNextStylesOn",null)}),h.execute(v=>{v.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):w.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(v=>{v.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}NWn(){rj.a.get_instance().xk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();
for(let v in b){var h=v;const D=b[v];if(D)for(const Q of D)w.AFrameworkApplication.va.w_(Q)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):w.AFrameworkApplication.va.$jo(Q,this.wbl(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}wbl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}mlm(){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Lh.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&w.AFrameworkApplication.Ffc.XXe){const b=w.AFrameworkApplication.Ffc.XXe,h=w.AFrameworkApplication.Ffc.qmh;h.payload||(h.payload={});const v=h.payload.launcherId?h.payload.launcherId:b;oC.zej.nb(v)?oC.zej.J(v)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.xve.executeCommand(b,h))}}}oC.jZj="common";oC.CVj="appChrome";oC.zej=new lM.a(Pa.a.RPc());
Object(n.a)(oC,"ReactRibbonUser",null,[175,123,10]);class aH extends oC{constructor(b,h,v,D,Q,ba,ta,Ta,ob=null,Kb=!0,Vb=null,bc=null){super(b,h,D,Q,ba,ta,Ta,ob,Kb,Vb,bc);this.ujd=null;this.ztb=v;this.ztb.execute(Dc=>{this.ujd=Dc});this.ztb.execute(Dc=>{this.Lea.wF=Dc})}uEa(){return this.ujd?(this.ujd.clearCache(),super.uEa()):[]}hKb(b){if(!b)throw Error.argumentNull();this.ztb.execute(h=>{b.wF=h})}}Object(n.a)(aH,"ReactRibbonUser",oC,[]);var qM=c(995);class FF extends aH{constructor(b,h,v,D,Q,ba,
ta,Ta,ob,Kb=!0,Vb=null,bc=null){super(h,b.A3,D,pc.AppFrame.aqa,Q.focusManager,Q.oc,ta,Ta,ob,Kb,Vb,bc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.VCe=b;this.naa=ba;Q.sUa(()=>{this.hXo();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?rj.a.get_instance().xk(7,()=>{this.hqi()}):this.hqi()},null)}get qCf(){return!!w.AFrameworkApplication.K.appSettings.BootActivityNavigationId}hqi(){this.B$k();this.caf();
this.yTn()}hXo(){this.WLa.classList.add("FlexBoxLayout");this.VCe.vna().classList.add("cui-exth");this.VCe.vna().classList.add("FlexBoxLayout");this.VCe.vna().classList.add("ScrollableRibbon")}B$k(){w.AFrameworkApplication.NX||this.Edl()}Edl(){if(!w.AFrameworkApplication.NX){var b=(new BI(FF.chk,this.naa)).Pvl(),h=$t.a.fWd(pc.AppFrame.vPa,null,b,!0);h.TH=!0;this.Lgc(h,Ua.a.s5c,Ua.a.r5c);h.bindAction(Yb.KeyInputManager.kc(zf.a.IIa,0),Ua.a.lee);py.a(1,()=>{this.Q1n(b)})}}Q1n(b){const h=new II;appChrome.renderSharedHeader(b,
h.Gna()).then(this.Qef.bind(this))}Y9i(){w.AFrameworkApplication.ta.Nb.dBi?appChrome.getHeaderApi().then(b=>{document.getElementById(w.AFrameworkApplication.ugb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new qM.a).Qef()}Qef(){this.qCf&&w.AFrameworkApplication.Zoa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.qCf&&w.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(rj.a.get_instance().xk(12,this.Y9i.bind(this),11),u.ULS.sendTraceTag(42316515,
338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.Y9i()}Lgc(b,h,v){const D=Yb.KeyInputManager.kc(zf.a.Aw,0),Q=Yb.KeyInputManager.kc(zf.a.Aw,4);b.ir(D);b.ir(Q);b.bindAction(D,h);b.bindAction(Q,v)}caf(){const b=!!this.XLa&&"FileMenu"in this.XLa.mBj;w.AFrameworkApplication.ta.Nb.nQa&&!b&&py.a(1,this.p1n.bind(this))}p1n(){const b=[];if(w.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new ZG,{label:CommonUIStrings.L_DiagnosticsSessionId,
value:w.AFrameworkApplication.userSessionId}),Object.assign(new ZG,{label:CommonUIStrings.L_DiagnosticsBuild,value:w.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.l8h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}yTn(){this.ga.qa(Ua.a.ETa,Zb.a.view,this.ETa.bind(this));this.ga.qa(Ua.a.h8f,Zb.a.view,this.h8f.bind(this));this.ga.qa(Ua.a.i8f,Zb.a.view,this.i8f.bind(this))}activateRibbonTab(b){this.Bpk(b)}Sfc(){rj.a.get_instance().isCompleted(7)&&
this.ujd&&(ch.a.mark(4893),qp.a.MWo(),super.Sfc(),ch.a.mark(4894))}ETa(b,h,v,D,Q){if(2===Q[Ex.a.Ix]){if(v=Object(Ka.a)(yB.a,h))D=Object(Ka.a)(Uz.a,v.view);else return u.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,lb.a.join(Q," ",":")),8;if(D&&""!==D.gJ)sj.a.kha(h)&&sj.a.kac()||(this.Ub.mg(D.gJ),appChrome.selectors.getShyState().isActive&&EF.ShyRibbon.qeb(0,1));else return u.ULS.sendTraceTag(38549529,
338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(v.view),b,lb.a.join(Q," ",":"),this.o_l(v.view)),8}return 32}o_l(b){return b?"is ContentEditableView: "+b.Sj+" is Editing View: "+b.xwa+" is HtmlView: "+b.U2a+" is InteractiveView: "+b.qe+" is NavigationPaneView: "+b.sNm+" is PageView: "+b.Vi+" is WordNavigationPaneHeadingsView "+b.W_d:"null view"}}FF.chk="WACRibbon";Object(n.a)(FF,"ReactRibbonUser",
aH,[174,175,123,10]);class RI extends FF{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc=null,gd,rd){super(b,h,v,D,Q,ba,ta,Ta,ob,!1,Kb,Oc);this.mBk=()=>{this.Ip&&this.Ip.execute(je=>{je.logActivity("WordShyRibbon",null)});return 32};this.rym=()=>{ji.a.instance.rf(fi.a.Ezm,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(je=>{var Ld;this.XLa&&je.push.apply(je,this.sii());(this.Dfh||this.Efh)&&this.vcb&&je.push.apply(je,this.sOl());je.push(appChrome.actions.setControlCustomTooltip(Je.a.iYm,
CommonUIStrings.l_LoopsLearnMoreTooltip));w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Ioa&&this.Ooo();var Qd=null===(Ld=w.AFrameworkApplication.K)||void 0===Ld?void 0:Ld.jb("ReactShyRibbonPreferenceCookieName");Ld=Qb.a.get(Qd);w.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.wJ&&""===Ld&&w.AFrameworkApplication.te("66h8i182;1ha8c781");je.push.apply(je,this.uEa());
je.push(appChrome.actions.setControlBehaviorAttached(!0));const ge=Ga.a.instance.resolve("WordEditor.IModeSwitcherControl");Ld=ge.SZl();w.AFrameworkApplication.te("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(Qd=appChrome.selectors.getModeSwitcherMode())&&Qd!==Ld.activeMode&&u.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${Ld.activeMode}, Actual: ${Qd}`);
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(Qd=$t.a.fWd(Ap.a.Nsj,null,document.getElementById("WACToolbarContainer"),!1),Qd.TH=!0,this.kPn(Qd,Ua.a.s5c,Ua.a.r5c));"Suggest"===Ld.activeMode||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===Ld.activeMode?appChrome.getUpdateAppModeAndTabsActions(Ld,!0).then(ze=>{appChrome.api.dispatch(je.concat(ze));ge.QMi();
this.vqi()}):(je.push(appChrome.actions.updateModeSwitcher(Ld)),appChrome.api.dispatch(je),ge.QMi(),this.vqi())})};this.vcb=Vb;this.Dfh=bc;this.Efh=Dc;this.Ip=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");this.Hb=gd;this.iBe=rd}Dzm(){u.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");rj.a.get_instance().aI(5);const b=this.qCf&&w.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;rj.a.get_instance().xk(b,this.rym,11);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",
!1)&&this.otk()}otk(){this.Hb.Wb(new of.a(5,1,0,()=>{this.iBe.execute(b=>{b.Eko()})}))}sOl(){const b=[];this.Dfh&&(b.push(appChrome.actions.setButtonSecondaryText(Je.a.xHd,this.vcb.qsm)),b.push(appChrome.actions.setButtonSecondaryText(Je.a.SFd,this.vcb.psm)),b.push(appChrome.actions.setButtonSecondaryText(Je.a.H9d,this.vcb.rsm)));this.Efh&&b.push(appChrome.actions.setButtonSecondaryText(Je.a.E9d,this.vcb.ssm));return b}Ooo(){this.Ip&&appChrome.api.isSmallDevice()?this.Ip.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",
null)}):this.Ip.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});w.AFrameworkApplication.va.fb(Ua.a.Arh,Kd.a.frame,this.mBk,96)}kPn(b,h,v){const D=Yb.KeyInputManager.kc(zf.a.Aw,0),Q=Yb.KeyInputManager.kc(zf.a.Aw,4);b.ir(D);b.ir(Q);b.bindAction(D,h);b.bindAction(Q,v)}vqi(){w.AFrameworkApplication.Ffc.yPo();this.Tmh();this.u4e();this.qqi();rj.a.get_instance().aI(7);ji.a.instance.efa(fi.a.gEc,fi.a.W7n,(new Date).getTime())}CIa(b){if(b){const h=this.o9h();try{super.CIa(b)}finally{null===
h||void 0===h?void 0:h.dispose()}}}uEa(){const b=this.o9h();try{return super.uEa()}finally{null===b||void 0===b?void 0:b.dispose()}}o9h(){var b;let h=void 0;const v=null===(b=Ya.App.Tj)||void 0===b?void 0:b.zl;v&&(h=new ah.GraphTransaction(Ya.App.Yvi()&&Ya.App.CDf?0:2),h.set(v));return h}}Object(n.a)(RI,"ReactRibbonUser",FF,[]);class SI extends WG{constructor(b,h,v,D,Q,ba,ta,Ta){super(b,h,v);this.NFe=w.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&aa.a.i4;this.Pl=Q;this.FOe=ba;this.Hb=
ta;this.iBe=Ta}Pcl(b,h){const v=new LE(w.AFrameworkApplication.K,this.ga,this.Ub,this.NFe),D=new iM.a(v);return this.ldl(b,h,D,v)}ldl(b,h,v,D){var Q=new zI(new AI(w.AFrameworkApplication.K,D),v);v=this.azm(Q);const ba={};Q.Aob(ba);Q=!aa.a.i4;const ta=aa.a.zq||aa.a.jj;var Ta=aa.a.fl;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ta=aa.a.ui||Ta);Ta=new FE.a(Ta);b=new RI(b,h,WordEditorIntl.WordEditorStrings,this.ztb,D,b,this.Pl,v,new vI(ba),this.FOe,Ta,Q,ta,new yI,this.Hb,this.iBe);
b.Dzm();return b}azm(b){const h={};b.S6c(h);b.abd(h);return new wI(null,h,"jewelWordEditor")}}Object(n.a)(SI,"WordEditorRibbonUserFactory",WG,[]);class bH{constructor(b,h){this.Zz=b;this.kpd=h}jOa(b,h,v,D=null,Q=null){return this.kpd.wpj(b)?this.kpd.jOa(b,h,v,D,Q):this.Zz.jOa(b,h,v,D,Q)}yFa(b,h=null){return this.kpd.wpj(b)?this.kpd.yFa(b):this.Zz.yFa(b,h)}}Object(n.a)(bH,"RootCuiUser",null,[321]);class TI extends bH{constructor(b,h){super(b,h)}clearCache(){this.Zz.clearCache()}}Object(n.a)(TI,"WordGeneralCuiUser",
bH,[320,321]);var rM=c(1460);class kG{static getSelectedText(){const b=(new vh.a).Etf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static tRd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=G.a.pz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(n.a)(kG,"SearchUtils",null,[]);class sy extends fD{constructor(b,h,v){super(b,v);this.lI=h}Mmf(b){const h=[],v=Th.a.instance.gb.kb,D=!!this.lI&&this.lI.yVc(Eb.a.j6e.toString()),Q=!!this.lI&&this.lI.yVc(Eb.a.kMb.toString()),
ba=!D&&!v.J2a&&sy.j6a.hNi(),ta=!!this.lI&&this.lI.yVc(Ua.a.newComment.toString())||!!Ce.a.instance&&(3===Ce.a.instance.mode||2===Ce.a.instance.mode),Ta=v.SAi()&&w.AFrameworkApplication.ta.Nb.qVc;var ob=!1;if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){ob=!!v&&(v.iy||2===v.length&&We.SelectionEditor.Gk(v.Pc));var Kb=kG.getSelectedText();ob=ob&&0<Kb.length&&60>Kb.length}b=(Kb=3===b||aa.a.ui||w.AFrameworkApplication.Dlf)&&
sy.tgf.I_(v,b);Kb&&h.push(this.Pl.iEa("ClipboardGroup")[0].externalUxGroupId);ba&&(h.push(this.Pl.iEa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Pl.iEa("StylesGroup")[0].externalUxGroupId));ob&&h.push(this.Pl.iEa("DefineGroup")[0].externalUxGroupId);D&&h.push(this.Pl.iEa("PictureToolsGroup")[0].externalUxGroupId);Q&&h.push(this.Pl.iEa("TableToolsGroup")[0].externalUxGroupId);Ta&&h.push(this.Pl.iEa("EquationToolsGroup")[0].externalUxGroupId);ta&&h.push(this.Pl.iEa("CommentGroup")[0].externalUxGroupId);
b&&h.push(this.Pl.iEa("ContextMenuGroup")[0].externalUxGroupId);rM.a.Kui&&sy.fIm&&h.push(this.Pl.iEa("DesignerGroup")[0].externalUxGroupId);return h}static get tgf(){return null!=sy.Qxg?sy.Qxg:sy.Qxg=Ga.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get j6a(){return null!=sy.YFg?sy.YFg:sy.YFg=Ga.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static jSc(b,h,v,D){b.AJk(()=>sy.Jeb(h,v,D))}static Jeb(b,h,v){return new sy(b,h,v)}static get fIm(){null===this.LEe&&(w.AFrameworkApplication.te("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),
this.LEe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.LEe}}sy.LEe=null;Object(n.a)(sy,"WordReactFloatie",fD,[]);class cH{constructor(){this.Yda=this.tBc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").NYf();const h=Ya.App.Bv.NI,v=Ya.App.xa;sy.jSc(v,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));
this.Yda=this.W.Na("Box4.IContextMenuController");const D=new yF(v,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),Q={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:Q["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:Q["floatie.gbMatchDocumentFormattingButton"]=
!1;break;case 3:Q["floatie.gbUseSmartPasteButton"]=!1}D.jSc("PasteFloatieData",null,Q);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new mI(v,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).jSc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");rj.a.get_instance().xk(7,()=>{this.tBc=this.W.resolve("WordEditor.UI.StatusBarUser");this.tBc.Tb()})}dispose(){this.tBc&&(this.tBc.dispose(),
this.tBc=null);this.Yda&&(this.Yda.dispose(),this.Yda=null)}xc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new AF(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),w.AFrameworkApplication.va,w.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();let h=aa.a.fl;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=aa.a.ui||h);b.ha("Box4.UI.ShortcutHintMapping",
()=>new FE.a(h));const v=aa.a.zq||aa.a.jj,D=w.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(aa.a.i4||v),Q=w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new xs(Ga.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ga.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new cf.a)).singleInstance();b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new hp(w.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),
b.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Q?b.Sa("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),b.Na("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),
b.Sa("Box4.IPresenceDataManager"),b.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Sa("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),D,v?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ga.a.instance.Sa("Common.IActionContextProvider"),Ga.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),
b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Na("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();b.ha("Box4.ISelectionContextMenuProvider",()=>new Yv).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new Yl(w.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();b.ha("WordEditor.UI.DialogFactory",()=>new lI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();
b.ha("Common.NonCanvasCuiUser",()=>new Cp($c.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new TI(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new qI(Ya.App.xa.bgg,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,Ya.App.xa)).as("WordEditor.IStatusBarUser").singleInstance();
b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new BF).singleInstance();const ba=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",()=>new eD(dv.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ba)).singleInstance();const ta=b.Sa("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",()=>new SI(ta,w.AFrameworkApplication.va,$c.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),
b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),w.AFrameworkApplication.pc,b.Sa("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();b.ha("WordEditor.UI.ReactLanguageDialog",()=>new CF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new uI(w.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").singleInstance();
b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new sI(w.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new nI).as("WordEditor.IRulerUser");b.ha("WordEditor.UI.RulerContextMenu",()=>new iD(w.AFrameworkApplication.va,Ga.a.instance.Sa("Common.IZoomManager"),lr.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();b.ha("Common.IReactContextualUILauncher",()=>new tF(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();
b.ha("Box4.IContextMenuController",()=>new gD(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){w.AFrameworkApplication.te("5b6i5792;30d4f535");Cl.instance.eVh();Cl.instance.chf();N.a.instance.Fc(new cH,6)}}Object(n.a)(cH,"WordEditorUIPackage",null,[1,2]);var sM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",
ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},
children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",
Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},ED={};ED.xnc=function(){function b(){return ta()&&(gd()||3<=(bc()?rd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function v(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function D(Gf){Gf=(new RegExp(Gf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ai=-1;
null!=Gf&&2<=Gf.length&&(Ai=parseFloat(Gf[1]),isNaN(Ai)&&(Ai=-1));return Ai}function Q(){UI||(UI=!0,VI=D("Windows Phone"));return 8<=VI}function ba(){return"function"==typeof navigator.msLaunchUri&&!v()&&!Oc()&&!Ta()}function ta(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ta(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ob(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Kb(){return ob()?
8==window.document.documentMode:!1}function Vb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function bc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Dc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Oc(){var Gf=window.navigator.userAgent.toLowerCase();return 0<=Gf.indexOf("android")&&0<=Gf.indexOf("chrome")}function gd(){return 3<=(Vb()?rd("firefox/"):0)}function rd(Gf){var Ai=window.navigator.userAgent.toLowerCase(),Jj=Ai.indexOf(Gf);
return 0<=Jj?parseInt(Ai.substring(Jj+Gf.length,Ai.length)):0}function je(Gf,Ai,Jj,Nk,Wo){if(Nk&&null!=Ai)Ai();else if(ba())navigator.msLaunchUri(Gf,Ai,Jj);else if(!(Dc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ta())||Ta())Qd(Gf,Ai,Jj);else if(Dc()&&Wo)a:{try{window.open(Gf,"_self")}catch(Fs){null!=Jj&&Jj();break a}null!=Ai&&Ai()}else Ld(Gf,Ai,Jj)}function Ld(Gf,Ai,Jj){var Nk=document.getElementById("OICLinkTag");
null==Nk&&(Nk=document.createElement("a"),Nk.id="OICLinkTag",Nk.style.visibility="hidden",Nk.href="",0==(Fq.Options&ty.SupportsTopTargetNavigation)||Fq.NoBrowserModalDialogs?Nk.target="_blank":Nk.target="_top",document.body.appendChild(Nk),null!=Nk.addEventListener&&Nk.addEventListener("click",function(Wo){null!=Wo.stopPropagation&&Wo.stopPropagation()},!1));try{Nk.href=Gf,Nk.dispatchEvent(new MouseEvent("click"))}catch(Wo){null!=Jj&&Jj();return}null!=Ai&&Ai()}function Qd(Gf,Ai,Jj){var Nk=document.getElementById("OICFrame");
null==Nk&&(Nk=document.createElement("iframe"),Nk.className="ObjectInDialog",Nk.style.visibility="hidden",Nk.src="about:blank",document.body.appendChild(Nk),Nk.id="OICFrame");try{Nk.contentWindow.location.href=Gf}catch(Wo){null!=Jj&&Jj();return}null!=Ai&&Ai()}function ge(Gf){return 0!=(Gf.Options&ty.SkipProtocolHandler)||Kb()}function ze(Gf){return Gf===FD.ReadOnly||Gf===FD.ReadWrite}function gg(Gf,Ai,Jj,Nk){var Wo;try{var Fs=new ActiveXObject("SharePoint.OpenDocuments.4");return(Wo=Fs.ViewDocument3(window.self,
Gf,Ai,Nk))?(OE(pC.O14ActiveX),Op.None):Op.Failed}catch(Vr){}if(ty.O14Only===(Jj&ty.O14Only))return Fq.DescriptiveUnattemptedEnums?Op.O14AttemptFailure:Op.Unattempted;try{return Fs=new ActiveXObject("SharePoint.OpenDocuments.3"),(Wo=Fs.ViewDocument3(window.self,Gf,Ai,Nk))?(OE(pC.O12ActiveX),Op.None):Op.Failed}catch(Vr){}if(ty.O12UpOnly===(Jj&ty.O12UpOnly))return Fq.DescriptiveUnattemptedEnums?Op.O12UpOnlyFail:Op.Unattempted;try{return Fs=new ActiveXObject("SharePoint.OpenDocuments.2"),(Wo=ze(Ai)?Fs.ViewDocument2(window.self,
Gf,Nk):Fs.EditDocument2(window.self,Gf,Nk))?(OE(pC.O11ActiveX),Op.None):Op.Failed}catch(Vr){}return Fq.DescriptiveUnattemptedEnums?Op.ActiveXUnattempted:Op.Unattempted}function Kg(Gf,Ai,Jj,Nk,Wo){Gf==Cr.Visio&&Jj==FD.ReadWrite&&(Jj=FD.WriteOnly);Nk=Nk||v()&&!Q();if(!Nk){Nk="";if(Gf==Cr.PowerPoint){Gf=Nk;Nk=Fq.DocumentExtension;Jj=ze(Jj);var Fs=new Set([".pot",".potm",".potx"]),Vr=new Set([".pps",".ppsm",".ppsx"]);Jj=Jj&&Fs.has(Nk)?"nft|ofc|":Jj&&Vr.has(Nk)?"ofv|ofs|t|":!Jj&&Vr.has(Nk)?"ofe|ofs|t|":
Jj?"ofv|ofc|":"ofe|";Jj=Gf+Jj}else Jj=ze(Jj)?Nk+"ofv|ofc|":Nk+"ofe|";Nk=Jj;Fq.NewTelemetryDataIsEnabled&&(Jj=Fq.SessionOrigin?"or|"+Fq.SessionOrigin:"",Jj+=Fq.ClickTime?"ct|"+Fq.ClickTime:"",Jj+=Fq.CorrelationId?"cid|"+Fq.CorrelationId:"",Wo+=Em(Jj));Wo+=Em(Nk+"u|")}Wo+=Em(Ai);Ai=window.location.href;Jj=Ai.toLowerCase().indexOf("&wdlor=");-1!=Jj?(Jj+=7,Gf=Ai.indexOf("&",Jj),Ai=-1==Gf?Ai.substr(Jj):Ai.substring(Jj,Gf)):Ai=void 0;if(null!=Ai&&"undefined"!=typeof Ai){Jj="";try{Jj=decodeURIComponent(Ai)}catch(PE){}0<
Jj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Jj)&&(Wo=Wo+"|f|"+Jj)}return Wo}function Ll(Gf,Ai,Jj,Nk,Wo,Fs){var Vr=WI(Gf);if(null==Vr)return cE(Fq.DescriptiveUnattemptedEnums?Op.ProtocolHandlerIsNull:Op.Unattempted,Fq.Application),!1;Gf=Kg(Gf,Ai,Jj,Nk,Vr);je(Gf,up,nv,Wo,Fs);return!0}function Em(Gf){if(ta()&&Dc()){var Ai="";try{Ai=decodeURI(Gf)}catch(Jj){}if(Ai==Gf)return encodeURI(Gf)}return Gf}function up(){OE(pC.ProtocolHandler)}function nv(){Fq.Options|=ty.SkipProtocolHandler;
XI(Fq,QE,RE)}function hD(){null!=dH&&dH(pC.RoamingProtocolHandler)}function hB(){null!=eH&&eH(Op.ControlNeeded)}function $D(){var Gf=document.getElementById("npSharePointPlugin");if(null==Gf){Gf="application/x-sharepoint";ta()&&3<=(bc()?rd("version/"):0)&&jz("application/x-sharepoint-webkit",!0)&&(Gf="application/x-sharepoint-webkit");if(!jz(Gf,!0))if(ta()&&jz("application/officelive",!0))Gf="application/officelive";else return null;var Ai=document.createElement("object");Ai.id="npSharePointPlugin";
Ai.type=Gf;Ai.style.width="0px";Ai.style.height="0px";Ai.style.setProperty("visibility","hidden","");document.body.appendChild(Ai);Gf=document.getElementById("npSharePointPlugin")}return Gf}function jz(Gf,Ai){var Jj=window.navigator.mimeTypes;if(null==Jj)return!1;Gf=Jj[Gf];return!Gf||Ai&&!Gf.enabledPlugin?!1:!0}function lG(Gf){try{if(null!=new ActiveXObject(Gf))return!0}catch(Ai){}return!1}function fH(Gf){switch(Gf){case Cr.OneNote:return"OneNote.Notebook";default:return""}}function WI(Gf){if(Gf!=
Cr.OneNote&&v()&&!Q())return"office:";switch(Gf){case Cr.Excel:return"ms-excel:";case Cr.OneNote:return"onenote:";case Cr.PowerPoint:return"ms-powerpoint:";case Cr.Visio:return"ms-visio:";case Cr.Word:return"ms-word:";case Cr.Project:return"ms-project:";case Cr.Publisher:return"ms-publisher:";case Cr.Infopath:return"ms-infopath:";case Cr.Access:return"ms-access:";default:return""}}function tM(Gf){switch(Gf){case Cr.Excel:return"root\\office15\\excel.exe";case Cr.PowerPoint:return"root\\office15\\powerpnt.exe";
case Cr.Visio:return"root\\office15\\visio.exe";case Cr.Word:return"root\\office15\\winword.exe";case Cr.Project:return"root\\office15\\winproj.exe";case Cr.Publisher:return"root\\office15\\mspub.exe";case Cr.Infopath:return"root\\office15\\infopath.exe";case Cr.Access:return"root\\office15\\msaccess.exe";default:return null}}function XI(Gf,Ai,Jj){Fq=Gf;QE=Ai;RE=Jj;if(Gf.DocumentUrl){var Nk=Jj=Ai=Gf.DocumentUrl;try{Nk=decodeURIComponent(Gf.DocumentUrl)}catch(SE){}try{Jj=encodeURI(Gf.DocumentUrl)}catch(SE){}Ai=
Ai+""+Gf.CorrelationIdForWinClient;Nk+=Gf.CorrelationIdForWinClient;Jj+=Gf.CorrelationIdForWinClient;Gf.Mode===FD.ReadWrite&&ty.CheckoutRequired===(Gf.Options&ty.CheckoutRequired)&&(Gf.Mode=FD.ForceCheckout);ty.HostIsEditOnly===(Gf.Options&ty.HostIsEditOnly)&&(Gf.Mode=FD.WriteOnly);if(ge(Gf)?0:ta()&&(Gf.Application==Cr.OneNote||jz("application/x-sharepoint-protocolhandler",!1)||jz("application/x-sharepoint-webkit-protocolhandler",!1))||ba()||Oc()||!(b()||gd()||"ActiveXObject"in window&&!v()||Dc())||
15<=mG())Ll(Gf.Application,Gf.EncodeUrl?Jj:Ai,Gf.Mode,Gf.Application==Cr.OneNote,Gf.SilentExternalHandler,Gf.NavigateUsingWindowOpen);else{var Wo;if(Wo=Kb())a:{var Fs=Gf.EncodeUrl?Ai:Nk,Vr=Gf.Mode,PE=fH(Gf.Application);try{Wo=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Fs,Vr,PE);break a}catch(SE){}Wo=!1}if(Wo)OE(pC.O15ActiveX);else{if(b()||gd()){var Ot=Gf.EncodeUrl?Ai:Nk;Nk=Gf.Mode;Wo=fH(Gf.Application);Fs=$D();if(null==Fs)Ot=Fq.DescriptiveUnattemptedEnums?Op.PluginIsNull:
Op.Unattempted;else{Vr=!1;try{Vr=Fs.ViewDocument3(window.self,Ot,Nk,Wo)}catch(SE){}if(!Vr)try{Vr=ze(Nk)?Fs.ViewDocument2(window.self,Ot,Wo):Fs.EditDocument2(window.self,Ot,Wo)}catch(SE){}Vr?(OE(pC.NpapiPlugin),Ot=Op.None):Ot=Op.Failed}}else{try{Ot=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ot&&Ot.SaveSSOCreds()}catch(SE){}Ot=gg(Gf.EncodeUrl?Ai:Nk,Gf.Mode,Gf.Options,fH(Gf.Application))}if(Ot!=Op.None){if(Nk=Gf.CouldUseRoamingApps)YI||(YI=!0,ZI=D("Windows NT")),Nk=6.1<=ZI&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(ob()||gd()||Dc());if(Nk&&Gf.Application!=Cr.OneNote){if(!ED.xnc.A7o()){cE(Op.ControlNeeded,Fq.Application);return}if(Gf.RoamingAppsLauncher){"undefined"==typeof Gf.RoamingAppsLauncher||null==Gf.RoamingAppsLauncher?cE(Fq.DescriptiveUnattemptedEnums?Op.RoamingLauncherIsNull:Op.Unattempted,Fq.Application):"undefined"==typeof Gf.RoamingBitsUrl||null==Gf.RoamingBitsUrl?ED.xnc.$8o(Gf.DocumentUrl,Gf.RoamingAppsLauncher,Gf.Application,Gf.ApplicationParameters,QE,RE):ED.xnc.YOj(Gf.DocumentUrl,Gf.RoamingAppsLauncher,
Gf.RoamingApplicationExe,Gf.ApplicationParameters,Gf.RoamingPlatform,Gf.RoamingBitsUrl,QE,RE);return}if(!Gf.ContinueIfLauncherIsNull){cE(Op.LauncherNeeded,Fq.Application);return}}ty.NoProtocolHandlerFallback==(Gf.Options&ty.NoProtocolHandlerFallback)||ge(Gf)||ob()||ta()&&!(Fq.DescriptiveUnattemptedEnums?Ot>=Op.O14Unattempted&&Ot<=Op.DocumentUrlIsNull:Ot==Op.Unattempted)?cE(Ot,Fq.Application):Ll(Gf.Application,Gf.EncodeUrl?Jj:Ai,Gf.Mode,Gf.Application==Cr.OneNote,Gf.SilentExternalHandler,Gf.NavigateUsingWindowOpen)}}}}else cE(Fq.DescriptiveUnattemptedEnums?
Op.DocumentUrlIsNull:Op.Unattempted,Fq.Application)}function OE(Gf){null!=QE&&QE(Gf)}function cE(Gf,Ai){"undefined"==typeof Ai&&(Ai=null);null!=RE&&RE(Gf,Ai)}function mG(){var Gf=0;if(b()||gd()||Dc()){var Ai=$D();try{null!=Ai&&(Gf=Ai.GetOfficeVersion())}catch(Jj){}}else lG("SharePoint.OpenDocuments.5")?Gf=15:lG("SharePoint.OpenDocuments.4")?Gf=14:lG("SharePoint.OpenDocuments.3")?Gf=12:lG("SharePoint.OpenDocuments.2")&&(Gf=11);return Gf}function $I(){return ta()&&(jz("application/x-sharepoint",!0)||
jz("application/x-sharepoint-webkit",!0))}var aJ="",bJ="",cJ="",QE,RE,dH,eH,Fq,YI,ZI,UI,VI,FD={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ty={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Op={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},pC={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Cr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:FD,OpenDocumentOptions:ty,OpenDocumentFailureType:Op,OpenDocumentControl:pC,OfficeApplication:Cr,EditDocumentInClient:XI,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Cr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=
this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:mG,IsO14MacPluginInstalled:$I,OfferOfficeInDialog:function(){return h()&&11>=mG()},OfferOfficeNoIntrusive:function(){return h()&&15>mG()},OfferMacOffice:function(){return ta()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!$I()},InstallRoamingControl:function(){Vb()?window.InstallTrigger.install({Office:{URL:bJ}}):Qd(cJ,null,null)},CanUseRoamingControl:function(){if(ba())return!0;if(Dc())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Vb()){var Gf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Gf);var Ai=document.createEvent("Events");Ai.initEvent("RoamingOfficeInstalled",!0,!1);Gf.dispatchEvent(Ai);return!!Gf.getAttribute("installed")}if(ob())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Jj){}return!1},InitUrls:function(Gf,Ai,Jj){aJ=Gf;bJ=Jj;cJ=Ai},LaunchRoamingApps:function(Gf,
Ai,Jj,Nk,Wo,Fs){ED.xnc.YOj(Gf,Ai,tM(Jj),Nk,"x86",aJ,Wo,Fs)},LaunchRoamingApps2:function(Gf,Ai,Jj,Nk,Wo,Fs,Vr,PE){var Ot="";null!=Nk&&(Ot+=" "+Nk);null!=Gf&&(Ot+=' "'+Gf+'"');if(ba()||Dc())dH=Vr,eH=PE,Vr='office: "'+(Fs+'" "')+(Jj+'" "ROAMING"'),Vr+=' "'+Ai+'"',Vr+=' "'+Wo+'"',Vr+=" "+Ot,je(Vr,hD,hB,!1,!1);else if(Vb())Gf=document.createElement("RoamingExtensionElement"),Gf.setAttribute("cabUrl",Fs),Gf.setAttribute("app",Jj),Gf.setAttribute("licensingEntitlements",Ai),Gf.setAttribute("platform",Wo),
Gf.setAttribute("args",Ot),document.documentElement.appendChild(Gf),Ai=document.createEvent("Events"),Ai.initEvent("RoamingOfficeLaunch",!0,!1),Gf.dispatchEvent(Ai),null!=Vr&&Vr(pC.RoamingFFExtension);else if(ob()){if(Gf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Gf)try{Gf.HrConfigureSingle(Fs,Jj,Ai,Wo,Ot),null!=Vr&&Vr(pC.RoamingActiveX)}catch(SE){}}else null!=PE&&PE(Op.Failed)},ShouldShowDialog:function(){return!v()},NavigateToUrlUsingClickingOnATag:Ld,OpenDocumentWithProtocolHandler:Ll,
OpenDocumentWithProtocolHandlerNoCallBack:function(Gf,Ai,Jj,Nk){var Wo=WI(Gf);if(null==Wo)return cE(Fq.DescriptiveUnattemptedEnums?Op.ProtocolHandlerNoCallbackIsNull:Op.Unattempted,Fq.Application),!1;Gf=Kg(Gf,Ai,Jj,Nk,Wo);je(Gf,null,null,!1,!1);return!0}}}();ED.ClientUtils=ED.xnc;var uM=c(1479);class nG{constructor(b,h,v){this.ga=b;this.l8j=h;this.G6=v}Tb(){this.ga.qa(Ua.a.tryMacOffice,Kd.a.frame,Object(z.a)(this,this.xun,"onTryMacOffice"));this.ga.qa(Ua.a.cCj,Kd.a.frame,Object(z.a)(this,this.LXi,
"onTryMacOfficeFromViewer"));this.ga.qa(Ua.a.bCj,Kd.a.frame,Object(z.a)(this,this.LXi,"onTryMacOfficeFromViewer"))}xun(b,h,v,D,Q){if(1===v)return 32;Q?(b=Q.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Id.a.om(ja.a.a1a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&Id.a.om(ja.a.a1a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.LEi();return 32}LXi(b,h,v){if(1===v)return 32;switch(b){case Ua.a.cCj:Id.a.om(ja.a.a1a(15),"_blank",
void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Ua.a.bCj:Id.a.om(ja.a.a1a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}LEi(){Id.a.om(nG.C8m,"_blank",void 0,"LaunchMacTrialWindow")}get R7c(){return this.l8j&&aa.a.fl&&!aa.a.$Ef&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Aro(){const b=this.R7c;b||w.AFrameworkApplication.Rm.qfo();return b}get zro(){return this.R7c}static get C8m(){return ja.a.q8("522401")}}Object(n.a)(nG,"MacOfficeOffer",null,[1326]);class oG{constructor(b,
h,v){this.ga=b;this.q8j=h;this.cK=null;(this.nxd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(D=>{this.cK=D});this.G6=v}Tb(){this.ga.qa(Ua.a.tryOffice,Kd.a.frame,Object(z.a)(this,this.yun,"onTryOffice"));this.ga.qa(Ua.a.Lkg,Kd.a.frame,Object(z.a)(this,this.Lkg,"tryOfficeThroughTellMe"));this.ga.qa(Ua.a.hCj,Kd.a.frame,
Object(z.a)(this,this.iCj,"tryOfficeThroughViewer"));this.ga.qa(Ua.a.gCj,Kd.a.frame,Object(z.a)(this,this.iCj,"tryOfficeThroughViewer"))}yun(b,h,v,D,Q){if(this.nxd&&1===v)return this.isFreemiumUpsellEnabled&&this.S7c?32:8;2===v&&(Q?(b=Q.SourceControlId,"btnjTryOfficeForWordEditor"===b?Id.a.om(ja.a.a1a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?Id.a.om(ja.a.a1a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.xIf()):this.xIf());return 32}Lkg(b,
h,v,D,Q){if(this.nxd&&1===v)return this.isFreemiumUpsellEnabled&&this.S7c?32:8;2===v&&(Q?(b=Q.SourceControlId,Id.a.om(ja.a.q8("862405")+this.R6l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Id.a.om(ja.a.q8("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}iCj(b,h,v){if(this.nxd&&1===v)return this.isFreemiumUpsellEnabled&&this.S7c?32:8;if(2===v)switch(b){case Ua.a.hCj:Id.a.om(ja.a.a1a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Ua.a.gCj:Id.a.om(ja.a.a1a(24),
"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Iin(){return this.S7c}get Hin(){return this.S7c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get S7c(){return this.q8j&&!aa.a.fl}get isFreemiumUpsellEnabled(){let b=!1;this.cK&&(b=this.cK.isFreemiumUpsellEnabled());return b}xIf(b=null){let h=0;b&&(h=b);Id.a.om(oG.z0l(h),"_blank",void 0,"LaunchOfficeOffer")}R6l(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=
2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=
16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=
29}return 0===h?"":String.format("&pc={0:D}",h)}static z0l(b){if(aa.a.ui)switch(b){case 1:return ja.a.q8("393806");case 2:return ja.a.q8("393810");case 3:return ja.a.q8("393809");case 5:return ja.a.q8("393805")}else if(aa.a.CM)switch(b){case 1:return ja.a.q8("521979");case 3:return ja.a.q8("521980");case 5:return ja.a.q8("521978");case 2:return ja.a.q8("522490")}else{if(2===b)return ja.a.q8("517778");if(1===b)return ja.a.a1a(30)}return ja.a.q8("522402")}}Object(n.a)(oG,"OfficeTrialExperience",null,
[1327]);class dJ{xc(b){b.register(oG,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Rd(()=>new oG(w.AFrameworkApplication.va,w.AFrameworkApplication.FEf,w.AFrameworkApplication.lcid));b.register(nG,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Rd(()=>new nG(w.AFrameworkApplication.va,w.AFrameworkApplication.syi,w.AFrameworkApplication.lcid))}}Object(n.a)(dJ,"OpenInClientConfiguration",null,[2]);class eJ{constructor(b=
!1,h=!1,v=!1,D=!1,Q=!0,ba=!1,ta=!0,Ta=!0,ob=!0,Kb=!1,Vb=!1,bc=!1,Dc=!1,Oc=!1,gd=!1,rd=!1,je=!1,Ld=!1,Qd=null,ge=null,ze=null,gg=null,Kg=null,Ll=null,Em=null,up=null,nv=null){this.W$b=!1;this.iek=b;this.nek=h;this.Bik=v;this.zik=D;this.uik=Q;this.vik=ba;this.xik=ta;this.yik=Ta;this.wik=ob;this.Mik=Kb;this.gjk=Vb;this.Lik=bc;this.Bkk=Dc;this.Fik=Oc;this.A6j=gd;this.$ik=rd;this.hjk=je;this.fYj=Ld;this.Dik=Qd;this.Kik=ge;this.Aik=Kg;this.Iik=ze;this.Cik=gg;this.Hik=Ll;this.Jik=Em;this.Eik=up;this.Gik=
nv}get O_i(){return this.iek}get BAn(){return this.nek}get spj(){return this.Bik}get rpj(){return this.zik}get Lqo(){return this.uik}get Mqo(){return this.vik}get Oqo(){return this.xik}get Pqo(){return this.yik}get Nqo(){return this.wik}get Kob(){return this.Fik}get Uzm(){return this.A6j}get $pj(){return this.$ik}get Dqj(){return this.hjk}get YSk(){return this.fYj}get vpj(){return this.Mik}get Wso(){return this.gjk}get Yqo(){return this.Lik}get iwj(){return this.Bkk}get tpj(){return this.Dik||Object(z.a)(this,
this.whc,"returnFalse")}get Xqo(){return this.Kik||Object(z.a)(this,this.whc,"returnFalse")}get Wqo(){return this.Iik||Object(z.a)(this,this.U7f,"returnTrue")}get Rqo(){return this.Cik||Object(z.a)(this,this.U7f,"returnTrue")}get Qqo(){return this.Aik||Object(z.a)(this,this.whc,"returnFalse")}get Vqo(){return this.Hik||Object(z.a)(this,this.U7f,"returnTrue")}get upj(){return this.Jik||Object(z.a)(this,this.whc,"returnFalse")}get Sqo(){return this.Eik||Object(z.a)(this,this.whc,"returnFalse")}get Uqo(){return this.Gik||
Object(z.a)(this,this.whc,"returnFalse")}U7f(){return!0}whc(){return!1}}Object(n.a)(eJ,"HtmlTranslatorSettings",null,[766]);class jB{constructor(b,h,v,D,Q,ba,ta){this.Xf=b;this.characterPropertiesEditor=h;this.SW=v;this.ajf=D;this.lj=Q;this.Ld=ba;this.VQ=ta}$Am(b,h){var v;b=h.view;h=h.$j;if(!h||!this.Xf.gwi(h,!0)||this.ajf&&this.ajf.instance&&this.ajf.instance.tU(h))return 2;var D=jB.V6a?!jB.L_.Ewa(h):!0;this.SW&&D&&this.SW.amc(h.node,zf.a.Bs,h.cpBegin);D=h.node;(null===(v=this.VQ)||void 0===v?0:
v.replaceText)&&this.VQ.ebc(D)?(v=D.pa.U_a(h.cpBegin),this.VQ.replaceText(D,v,v,hr.a.sXc)):this.characterPropertiesEditor.Zga(h,Q=>new hr.a(Q));if(this.Ld.rg){v=new ah.GraphTransaction(15);try{v.Cb(h.node),this.lj.pqa(h.node,h.cpBegin,h.cpBegin+1,1)}finally{v&&v.dispose()}}D=h.node;v=h.cpEnd+1;" "===de.ParagraphReader.text(D).charAt(v)&&(D=Pe.a.createTextRange(D,v,v+1),this.characterPropertiesEditor.replaceTextRange(D,"\u00a0"));h=Pe.a.Rc(h.node,v);b.lb.setSelection(Mg.SelectionFactory.io(h));return 32}static get L_(){return null!=
jB.GAg?jB.GAg:jB.GAg=Ga.a.instance.resolve("Box4.IHyperlinkStrategy")}static get V6a(){null==jB.ola&&(jB.ola=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return jB.ola}}jB.ola=null;Object(n.a)(jB,"InsertLineBreakStrategy",null,[]);class Zv{static get lg(){return null!=Zv.mEg?Zv.mEg:Zv.mEg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}static get Wg(){return io.ContextSetEditor.instance}static get lj(){return null!=Zv.JHg?Zv.JHg:Zv.JHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ld(){return null!=
Zv.nIg?Zv.nIg:Zv.nIg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static xBm(b,h,v,D,Q){if(Q&&Q.hasProperty(wc.a.targetObject)){var ba=h.view.Yc.Jc.Db(Q.getValue(wc.a.targetObject));ba=Pe.a.create(ba)}else ba=Zv.Wg.mT(h.$j,11);if(!ba)return 8;b=w.AFrameworkApplication.va.Of(ba,b,v,!0,D,Q);if(32===b&&2===v){if(!h.view.qe)return 2;h=h.view;D=h.lb.tg;if(D=Zv.Wg.mT(D,11)){v=new Km.a;v.set(D.node);v.vd();if(Q&&Q.hasProperty(wc.a.targetObject))for(Q=Q.Hf(wc.a.targetObject);!v.currentNode.id.equals(Q)&&
v.sc()&&(ig.OutlineElementNavigator.Vd(v),11===v.Ve););ig.OutlineElementNavigator.q0(v,!1,!1);Q=We.SelectionEditor.QDa(v,!0);Q=de.ParagraphReader.Xt(Q)?Mg.SelectionFactory.ue(Q,0):Mg.SelectionFactory.uq(Q);h.lb.setSelection(Q)}}return b}static vWd(b,h,v,D,Q){b=b===Eb.a.HSc;h=h.node;if(Q&&Q.hasProperty(wc.a.targetObject)&&!h.id.equals(Q.Hf(wc.a.targetObject)))return 2;if(1===v)return 32;v=new ne.GraphIterator;v.set(h);v.zb(10);Zv.lg.yA(v,b,!0);Zv.Ld.rg&&(v=ig.OutlineElementNavigator.Ge(v),Zv.lj.sOb(v,
1));return 32}}Object(n.a)(Zv,"InsertOutlineElementStrategy",null,[]);class pG{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.wri=(bc,Dc,Oc)=>{var gd,rd;if(null===(gd=this.J$)||void 0===gd?0:gd.splitParagraph)return this.J$.splitParagraph(Oc,Dc.cpBegin,{Eb:Dc.Eb,Rb:Dc.Rb});gd=!Dc.cpBegin;Oc=Dc.cpBegin===de.ParagraphReader.textLength(Oc);const je=!(null===(rd=Ya.App.qd)||void 0===rd||!rd.Qo);let Ld=!0;je&&gd&&!Oc?(Ld=!1,rd=new ne.GraphIterator,rd.Zc(bc),rd.vd(),this.nh.yA(rd,!0,!1)):rd=this.nh.joa(bc);
this.nh.X9(bc,rd,Dc,!1,!0,Ld,!1,!0);!je||gd||Oc||(bc=io.ContextSetEditor.instance.jOd(Dc),Ya.App.qd.Qp.QF(bc));return rd};this.YY=h;this.z1j=b;this.Sz=ba;this.u$j=Q;this.nh=v;this.u_j=D;this.Ik=ta;this.ib=Ta;this.xE=ob;this.wqc=Kb;this.J$=Vb}Ifn(b,h,v,D,Q){if(!h.view.qe)return 2;h=h.view;let ba=null;h.Vi&&(ba=h);const ta=h.lb.tg;var Ta=!0;let ob=!1,Kb=null;if(!ta)return 2;const Vb=new ah.GraphTransaction(15);Vb.Cb(h.Yc);let bc=null;2===v&&(bc=new Km.a,bc.set(ta.node),bc.vd(),Kb=new ir.a(bc),ig.OutlineElementNavigator.Vd(bc),
Ta=Cd.OutlineElementReader.isEmpty(bc,!1),{Lpj:Ta,fKj:ob}=this.u_j.Mpj(bc,Ta,yt.a.NEb,-1,ta));b=w.AFrameworkApplication.va.Of(ta,b,v,!1,D,Q);Ta&&32===b&&2===v&&(ob||ig.OutlineElementNavigator.aGa(bc,!1,!We.SelectionEditor.gf(ta),!1),ob&&Kb&&Kb.restore(bc),this.Sz.freeze(),(v=Mg.SelectionFactory.ho(bc.currentNode,!0))||u.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.lb.setSelection(v),this.Sz.bIa(),this.z1j.Pg.iF());ba&&(Ta||ba.b5(),ba.editingView&&ba.uU&&(ba.editingView.cI=
!0));hs.GrippersManager.instance.OQb(1);Vb.dispose();return b}newLine(b,h,v){b=!1;if(ke.ImageReader.g4(h)||ke.ImageReader.x2a(h))h=this.c6k(h),b=!0;const D=h;if((h=We.SelectionEditor.gf(h))&&this.Ik.gh&&!this.Ik.yNm(D))return 2;if(1===v)return 32;const Q=D.node,ba=new ne.GraphIterator;ba.set(Q);ba.vd();ig.OutlineElementNavigator.Vd(ba);v=new ah.GraphTransaction(15);v.ku(ba);h?(this.wqc.instance&&this.wqc.instance.tIa(D),de.ParagraphReader.Vb(Q)&&D.cpBegin===de.ParagraphReader.textLength(Q)&&Ba.m(D)&&
9===de.ParagraphReader.Ena(Q)&&this.Sz.c7k(D),Hg.ListItemReader.Ig(ba)?this.u$j.execute(ba,D,Q,this.wri):this.wri(ba,D,Q),this.YY&&this.YY.amc(Q,zf.a.Bs,D.cpBegin),b&&(ig.OutlineElementNavigator.Ur(ba,!1,!1),b=ba.Sb(2),(b=this.xE.ue(b,0))&&this.ib.setSelection(b))):this.nh.yA(ba,!0,!0);v.dispose();Ya.App.xa&&Ya.App.xa.updateCommandUI();return 32}c6k(b){if(ke.ImageReader.g4(b))var h=Pe.a.Rc(b.node,b.cpBegin);else{h=de.ParagraphReader.vQ(b.node);var v=h.properties.Hf(lc.a.jq);b=b.node.properties.getValue(lc.a.runId);
v=pG.Jof(b,v,h.pa);h=Pe.a.Rc(h,v)}return h}static ikf(b,h){let v=0;for(;v<h.length&&!(b<h[v]);)v++;return v}static Jof(b,h,v){let D=0;b=pG.ikf(b,h);let Q=0;if(b===h.length)Q=v.length-1;else for(;Q<v.length;){h=v.J(Q);if(h.formatting&&h.formatting.pe===b)break;Q++}Q<v.length&&(D=v.J(Q).cp);return D}}Object(n.a)(pG,"NewLineStrategy",null,[]);class dE{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd,rd){this.Jm=null;this.Cla=b;this.aid=ta;this.dpd=new pG(this,h,v,D,Q,ba,Ta,Vb,bc,gd,rd);this.JZg=new jB(Ta,
ob,h,Kb,Dc,Oc,rd)}get Pg(){return this.Jm||(this.Jm=this.Cla())}Tb(){const b=w.AFrameworkApplication.va,h=Object(z.a)(this.dpd,this.dpd.newLine,"newLine");b.fb(Eb.a.enter,Zb.a.view,Object(z.a)(this.aid.value,this.aid.value.awl,"enterView"),1124);b.fb(Eb.a.Roj,Zb.a.view,Object(z.a)(this.aid.value,this.aid.value.ypo,"shiftEnterView"),1124);b.qa(Eb.a.newLine,Zb.a.view,Object(z.a)(this.dpd,this.dpd.Ifn,"newLineView"));b.qa(Eb.a.newLine,Zb.a.Tc,h);b.qa(Eb.a.newLine,Zb.a.image,h);b.qa(Eb.a.newLine,Zb.a.Hd,
h);b.qa(Eb.a.newLine,Zb.a.anchoredObject,h);b.qa(Eb.a.newLine,Zb.a.embeddedFile,h);b.qa(Eb.a.newLine,Zb.a.ink,h);b.qa(Eb.a.newLine,Zb.a.paragraph,h);b.qa(Eb.a.newLine,Zb.a.iFrame,h);b.qa(Eb.a.newLine,Zb.a.unsupportedObject,h);b.Vc(Eb.a.newLine,1124);b.fb(Eb.a.DSc,Zb.a.view,Object(z.a)(this.JZg,this.JZg.$Am,"insertLineBreakView"),1028);b.qa(Eb.a.HSc,Zb.a.view,Zv.xBm);b.qa(Eb.a.HSc,Zb.a.outlineElement,Zv.vWd);b.Vc(Eb.a.HSc,1092)}static get instance(){return null!=dE.JBg?dE.JBg:dE.JBg=dE.Rl()}static Rl(){return new dE(()=>
Ga.a.instance.resolve("Box4.IUndoManager"),Ga.a.instance.Na("Box4.IAutoCorrectScheduler"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),Ga.a.instance.resolve("Box4.List.ICursorMovementValidator"),Ga.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ga.a.instance.resolve("Box4.IInsertionPointFormatting"),Ga.a.instance.Ue("Box4.Actors.IEnterViewStrategy"),xi.a.instance,Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.Sa("Box4.IExternalSelectionManager"),Th.a.instance,Ga.a.instance.resolve("Box4.ISelectionFactory"),
Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.Sa("Box4.IContentControlConverter"),Ga.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(n.a)(dE,"EnterActor",null,[]);var gH=c(1392),hH=c(877);class jk{static get paragraphEditor(){return null!=jk.UEg?jk.UEg:jk.UEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get p5(){return null!=jk.sGg?jk.sGg:jk.sGg=Ga.a.instance.Na("Box4.ISpacingCommands")}static get xTa(){return null!=
jk.DGg?jk.DGg:jk.DGg=Ga.a.instance.Na("Box4.Styles.IWACStyleReader")}static get KFa(){return null!=jk.nDg?jk.nDg:jk.nDg=Ga.a.instance.Na("Box4.ILineSpacingHelper")}static get lj(){return null!=jk.SHg?jk.SHg:jk.SHg=Ga.a.instance.Na("Box4.TrackChange.ITrackChangeEditor")}static get Ld(){return null!=jk.tIg?jk.tIg:jk.tIg=Ga.a.instance.Na("Box4.TrackChange.ITrackChangeManager")}static get Ch(){return Ga.a.instance.Na("WordEditor.ClientPagination.IClientPaginationSettings")}static Tb(){var b,h,v;const D=
w.AFrameworkApplication.va;D.qa(Eb.a.hJf,Zb.a.view,Cg.a.dw);D.Vc(Eb.a.hJf,1028);D.qa(Eb.a.fD,Zb.a.view,Cg.a.dw);D.qa(Eb.a.fD,Zb.a.paragraph,jk.GAd);D.Vc(Eb.a.fD,1036);D.qa(Eb.a.Jic,Zb.a.paragraph,jk.BDk);D.qa(Eb.a.Jic,Zb.a.view,Cg.a.dw);D.Vc(Eb.a.Jic,1036);if(null===(b=jk.Ch)||void 0===b?0:b.GFa)D.qa(Eb.a.U6c,Zb.a.paragraph,jk.f1e),D.qa(Eb.a.U6c,Zb.a.view,Cg.a.dw);if(null===(h=jk.Ch)||void 0===h?0:h.VIa)D.qa(Eb.a.v7c,Zb.a.paragraph,jk.B1e),D.qa(Eb.a.v7c,Zb.a.view,Cg.a.dw);if(null===(v=jk.Ch)||void 0===
v?0:v.uha)D.qa(Eb.a.T6c,Zb.a.paragraph,jk.e1e),D.qa(Eb.a.T6c,Zb.a.view,Cg.a.dw);D.qa(Eb.a.sZe,Zb.a.view,jk.gzk);D.Vc(Eb.a.sZe,1036);D.qa(Eb.a.p5f,Zb.a.view,jk.$0n);D.Vc(Eb.a.p5f,1036);D.qa(Eb.a.rZe,Zb.a.view,jk.fzk);D.Vc(Eb.a.rZe,1036);D.qa(Eb.a.o5f,Zb.a.view,jk.Z0n);D.Vc(Eb.a.o5f,1036);D.qa(Eb.a.cTa,Zb.a.view,Cg.a.dw);D.qa(Eb.a.cTa,Zb.a.paragraph,jk.GAd);D.Vc(Eb.a.cTa,1036);D.qa(Eb.a.bTa,Zb.a.view,Cg.a.dw);D.qa(Eb.a.bTa,Zb.a.paragraph,jk.GAd);D.Vc(Eb.a.bTa,1036);D.qa(Eb.a.qje,Zb.a.view,jk.pje);D.qa(Eb.a.qje,
Zb.a.paragraph,jk.pje);D.Vc(Eb.a.qje,1028);D.qa(Eb.a.vfg,Zb.a.view,jk.pje);D.qa(Eb.a.vfg,Zb.a.paragraph,jk.pje);D.Vc(Eb.a.vfg,1028);D.qa(Eb.a.hje,Zb.a.view,Cg.a.dw);D.qa(Eb.a.hje,Zb.a.paragraph,jk.Lth);D.Vc(Eb.a.hje,1028);D.qa(Eb.a.gje,Zb.a.view,Cg.a.dw);D.qa(Eb.a.gje,Zb.a.paragraph,jk.Lth);D.Vc(Eb.a.gje,1028)}static Lth(b,h,v,D,Q){if(1===v)return 32;b===Eb.a.hje?b=Eb.a.cTa:b===Eb.a.gje&&(b=Eb.a.bTa);return jk.GAd(b,h,v,D,jk.$zn(Q))}static $zn(b){var h=b.indexOf(",");const v=b.substring(0,h);b=b.substring(h+
1,b.length);h=new gH.a;h.value=parseFloat(v);h.unit=parseInt(b);return h}static pje(b,h,v,D,Q){if(2===v){h=Q[kh.a.Text];v=Q[kh.a.Number];Q=Q.Increment;D=new gH.a;let ba=!1;""===h||Q&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(D.value=0,D.unit=Ya.App.qFa?2:4,ba=!0):v||Q||(D.value=0,D.unit=1,ba=!0);ba&&(w.AFrameworkApplication.va.Qb(b===Eb.a.qje?Eb.a.cTa:Eb.a.bTa,2,D),Ya.App.xa.updateCommandUI())}return 32}static GAd(b,h,v,D,Q){if(!({gy:v}=Cg.a.Ncg(v,h)).returnValue)return v;h=h.node;switch(b){case Eb.a.fD:jk.paragraphEditor.fD(h,
new hH.a(2,Q));break;case Eb.a.cTa:b=new hH.a(Q.unit,Q.value);jk.paragraphEditor.eob(h,b);break;case Eb.a.bTa:b=new hH.a(Q.unit,Q.value),jk.paragraphEditor.dob(h,b)}D&&js.a.Epb&&(D.ns|=js.a.khb(h));return 32}static gzk(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=jk.zgi(h);if(!b)return u.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(lc.a.Ji,240)/20)?b:jk.Mhl;jk.p5.gda(1,b,4);return 32}static $0n(b,
h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");jk.p5.gda(1,0,4);return 32}static fzk(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=jk.zgi(h);if(!b)return u.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(lc.a.sa,240)/20;jk.p5.gda(0,b?b:12,4);return 32}static Z0n(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");
jk.p5.gda(0,0,4);return 32}static f1e(b,h,v,D,Q){if(2==v){if("boolean"!==typeof Q)return 16;b=h.node;h=null;jr.a.instance.J(1)&&(h=b.MD());jk.paragraphEditor.f1e(b,Q);h&&jk.lj.dV(b,h,jk.Ld.rg)}return 32}static B1e(b,h,v,D,Q){if(2==v){if("boolean"!==typeof Q)return 16;b=h.node;h=null;jr.a.instance.J(1)&&(h=b.MD());jk.paragraphEditor.B1e(b,Q);h&&jk.lj.dV(b,h,jk.Ld.rg)}return 32}static e1e(b,h,v,D,Q){if(2==v){if("boolean"!==typeof Q)return 16;b=h.node;h=null;jr.a.instance.J(1)&&(h=b.MD());jk.paragraphEditor.e1e(b,
Q);h&&jk.lj.dV(b,h,jk.Ld.rg)}return 32}static BDk(b,h,v,D,Q){if(2==v){if("boolean"!==typeof Q)return 16;b=new Map;b.set("Value",Q.toString());wa.Health.instance.recordKpiUsage(Uj.a.tkb.AJo,0,Uj.a.sB,b);h=h.node;b=null;jr.a.instance.J(1)&&(b=h.MD());h.hasProperty(lc.a.iw)&&h.removeProperty(lc.a.iw);jk.KFa.qOd(h)!==Q&&h.setValue(lc.a.iw,Q);(Q=jk.KFa.O7b(h,!0))&&Q.Tk(4,!0);(Q=jk.KFa.O7b(h,!1))&&Q.Tk(4,!0);b&&jk.lj.dV(h,b,jk.Ld.rg)}return 32}static zgi(b){b=b.view;return b.qe&&(b=b.lb)&&b.gb.kb?jk.xTa.No(b.gb.kb.Oa.node):
null}}jk.Mhl=12;Object(n.a)(jk,"SpacingActor",null,[]);class fJ{process(){}}Object(n.a)(fJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[38]);class gJ{constructor(b){this.Be=b}Nho(b,h){this.Be.Sia(b,h.cache.rG);this.Be.RA(b,h.cache.fontSize)}BEb(){return null}qEa(){return null}z8b(){return null}$T(){return null}}Object(n.a)(gJ,"FormattingStewardBridge",null,[42]);class hJ{xc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new fJ).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",
()=>new gJ(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(n.a)(hJ,"WoncaActorsConfiguration",null,[2]);class iJ{constructor(b,h,v,D,Q,ba,ta,Ta){this.ga=b;this.xXj=h;this.wXj=v;this.KMg=D;this.lek=Q;this.Oqd=ba;this.pek=ta;this.qek=Ta}get oc(){return this.ga}BLk(b){this.oc.Kpa(b,this.xXj,null,null)}zLk(b){this.oc.Kpa(b,this.wXj,null,null)}c_(b,h,v){v?this.oc.Kpa(b,this.KMg,h,null):this.oc.Qb(this.KMg,2,h)}DAn(b,h){this.oc.Kpa(b,this.Oqd,h,null)}u9(b,h){this.oc.Kpa(b,this.pek,h,null)}Pmb(b,
h){this.oc.Kpa(b,this.qek,h,null)}iYf(b,h=!1){const v=new fh.DictionaryPropertySet;v.setValue(wc.a.jP,b);v.setValue(wc.a.e0i,!0);v.setValue(wc.a.M2a,h);this.oc.Qb(this.lek,2,v)}}Object(n.a)(iJ,"ClipboardCommands",null,[1679]);class jJ{}Object(n.a)(jJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1571]);class kJ{constructor(b){this.ga=b}get oc(){return this.ga}Tlj(b,h,v){let D=0;b?1===b&&(D=Eb.a.f2a):D=Eb.a.e2a;b=new rD.a;b.unit=v;b.value=h;this.oc.Qb(D,2,b)}Zge(b,h,v){let D=0;1===b?D=Eb.a.mOb:
2===b?D=Eb.a.uob:b||(D=Eb.a.nOb);b=new rD.a;b.unit=v;b.value=h;this.oc.Qb(D,2,b)}}Object(n.a)(kJ,"IndentationCommands",null,[1616]);var qG;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]=
"numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(qG||(qG={}));Object(n.b)("Justification",qG);class lJ{constructor(b){this.XKa={};this.ga=b;this.Fwm()}get oc(){return this.ga}gE(b){b=this.XKa[qG[b]];void 0!==b&&null!==b&&this.oc.processAction(b,2)}Fwm(){this.XKa.left=Eb.a.leftJustify;this.XKa.center=Eb.a.centerJustify;this.XKa.right=Eb.a.rightJustify;this.XKa.both=Eb.a.fullJustify;this.XKa.lowKashida=Eb.a.oIb;this.XKa.mediumKashida=Eb.a.oIb;this.XKa.highKashida=
Eb.a.oIb;this.XKa.distribute=Eb.a.LJc;this.XKa.thaiDistribute=Eb.a.p7c}}Object(n.a)(lJ,"JustificationCommands",null,[1611]);class mJ{constructor(b){this.ga=b}fD(b){this.ga.Qb(Eb.a.fD,2,b)}Jic(b){this.ga.Qb(Eb.a.Jic,2,b)}U6c(b){this.ga.Qb(Eb.a.U6c,2,b)}v7c(b){this.ga.Qb(Eb.a.v7c,2,b)}T6c(b){this.ga.Qb(Eb.a.T6c,2,b)}gda(b,h,v){this.ga.Qb(b?Eb.a.cTa:Eb.a.bTa,2,Object.assign(new gH.a,{value:h,unit:v}))}}Object(n.a)(mJ,"SpacingCommands",null,[1494]);class nJ{constructor(b,h,v){this.oc=b;this.nKc=h;this.lsl=
v;this.Dvn=(D,Q,ba)=>{if(1===ba)return this.nKc.ZZ?32:8;this.nKc.C_m();this.lsl().Muo(this.nKc.rUl());return 32}}Tb(){this.oc.fb(Eb.a.smb,Zb.a.application,this.Dvn,1028)}}Object(n.a)(nJ,"EditorSettingsUIActor",null,[]);class oJ extends Vf.a{constructor(b,h){super(!1,!1,!0);this.nsl=b;this.IQa=h;this.msl=v=>{1!==v?u.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.nsl.TRo(),u.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async Muo(b){const h=await this.IQa.KIb;
b={["id"]:"SettingsDialog",["uiLanguage"]:w.AFrameworkApplication.uiCulture,["selectedLanguage"]:lk.a.og(w.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.pWc,["editorSettings"]:b};this.Yh(Box4Intl.Box4Strings.l_EditorSettings,this.msl,b);u.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(n.a)(oJ,"EditorSettingsDialog",Vf.a,[]);class pJ{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd){this.jwb=this.Gyc=this.Lpc=null;this.sSe=0;this.wEe=!1;
this.ra=new cf.a;this.yYd=!1;this.Ru=b;this.Sz=h;this.Be=v;this.Ks=D;this.eb=Q;this.If=ta;this.Kd=Ta;this.Ik=ob;this.ld=Kb;this.Sd=Vb;this.qq=bc;this.xW=Dc;this.Uy=Oc;this.Do=gd}get Ntl(){return this.ld?this.ld.isFeatureEnabled(42):!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get Ilf(){return null!=this.Fzg?this.Fzg:this.Fzg=Ga.a.instance.resolve("Box4.IFormatPainterStrategy")}get bR(){return this.wEe}set bR(b){this.wEe!==b&&(this.wEe=this.yYd=
b,this.ra.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Xvk(b){this.ra.addHandler("FormatPainterBrushActiveStatusChanged",b)}Q0i(b){const h=b.Oa;u.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var v=h.node;b=this.Iyi(b);if(this.Ilf.Gro(h.contextId,b))try{this.jwb=this.eb.o1a(v)}catch(D){throw u.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",D.message),D;}this.Gyc=this.Uy.No(v);v=Hn.FormattingReader.Kr(h);v.yn&&(this.Lpc=Object(Ka.a)(Iz.a,
v.yn.clone()));this.sSe=b?Zb.a.paragraph:h.contextId}hth(b){if(b){const v=this.Iyi(b);for(let D=0;D<b.length;D++){const Q=b.J(D);if(null===Q||void 0===Q?0:Q.el)this.rzb(Q,v);else if(0==(null===Q||void 0===Q?void 0:Q.length))u.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",Q);else if(Q)for(let ba=0;ba<Q.length;ba++){var h=Q.getContext(ba);if(null===h||void 0===h?0:h.$w){if(h)for(let ta=0;ta<h.length;ta++)Q.addContext(h.getContext(ta))}else(null===h||void 0===
h?0:h.el)?this.rzb(h,v):u.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}kth(b,h){if(h){var v=b.node,D=v.pa.last,Q=this.Kd.f0a(v),ba=Q.Ef(Q.Ib);this.lth(Q,h,null);jr.a.instance.J(1)&&this.qq.XNb(v,D,b.cpBegin,b.cpEnd,ba,Q,this.Sd.rg)}}PDk(b,h,v){if(h||v)0<Ba.g(b).length&&u.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.xW.XZ(b,D=>{this.lth(D,h,v)})}lth(b,h,v){this.Be.Bfa(b);b.yn&&b.yn.removeProperty(Gd.a.highlight);
this.Be.a7e(b);v&&(v=v.wl().clone(),v.Eg(...eq.a.Kba()),this.Vw(b,v));this.Vw(b,h)}Vw(b,h){if(h){var v=b.paragraph.Jc;if(v){var D=b.yn;D=D?Object(Ka.a)(Gs.a,D.clone()):Iz.a.zNa(1179725);for(const ba of h.Hl())if(ba!==lc.a.ew&&ba!==lc.a.fieldInstruction&&ba!==Gd.a.DB&&ba!==Gd.a.j4&&ba!==lc.a.F2a&&ba!==Gd.a.eL&&ba!==lc.a.B3a&&ba!==lc.a.noProof){if(ba===Ve.a.hw){var Q=h.ia(Ve.a.hw,W.a.nil);if(Q!==W.a.nil)if(Q=v.Db(Q)){if(Q=new Tq.a(Q),Q=this.Uy.vM(Q),Q===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(Q=
this.Uy.MC(b.paragraph).Rva(Q)){D.DNa(Q.wl(),...eq.a.Kba());continue}else u.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else u.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}D.setValue(ba,h.Hf(ba))}D.BFa?h=v.GR(D,!0):(v.Lu(D),h=D);b.Qj=h.id}}}Iyi(b){return!b.iy&&b.Pc.contextId!==Zb.a.endOfParagraph}reset(){this.jwb=this.Gyc=this.Lpc=null;this.sSe=Zb.a.none}rzb(b,h){if(b.contextId===
Zb.a.Tc||b.contextId===Zb.a.Hd)var v=this.Ik.I8(b);else if(b.contextId===Zb.a.paragraph)v=this.Ik.DZd(b);else if(b.contextId===Zb.a.endOfParagraph)v=this.Ik.iYd(b);else{u.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}u.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(v)u.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{v=Object(Ka.a)(S.AParagraphNode,b.node);var D=!1;v&&(D=b.contextId===
Zb.a.Hd&&!!v&&!b.cpBegin&&b.cpEnd===this.eb.textLength(v));if(h=this.Ilf.Kpo(this.sSe,b.contextId,h,D))try{de.ParagraphReader.Vb(v)?(this.Gyc&&this.Ru.PJ(this.Gyc,v,!0),this.Ks.Dth(v,this.jwb)):u.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(Q){throw u.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",Q.message),Q;}D=b;b.contextId===Zb.a.paragraph?D=Pe.a.createTextRange(v,0,de.ParagraphReader.textLength(v)):
b.contextId===Zb.a.Tc&&(D=this.Sz.Itf(b),D=Th.a.mBb(D));if(D&&D.contextId===Zb.a.Hd){if(Di.a.sFd){const Q=this.Do.bRd(D);Q&&(D=Q)}try{this.PDk(D,this.Lpc,h?null:this.Gyc)}catch(Q){throw u.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",Q.message),Q;}}if(b.contextId===Zb.a.paragraph||b.contextId===Zb.a.endOfParagraph)h=new ne.GraphIterator,h.set(v),h.vd(),h.jd(11),D=Hg.ListItemReader.Ig(h),v=!de.ParagraphReader.textLength(v),u.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",
D,v),D?(this.If.fP(h),this.If.eca(h.currentNode)&&this.kth(b,this.Lpc)):this.Ntl&&this.kth(b,this.Lpc)}}}Object(n.a)(pJ,"FormatPainter",null,[1646]);var vM=c(109);class eE{constructor(b,h,v,D,Q,ba,ta,Ta=!1,ob,Kb,Vb){this.Bmd=!1;this.WAe=new yu.a;this.tmm=()=>{this.xS.bR=!1;return 32};this.umm=(bc,Dc,Oc)=>{bc=!1;if(Dc=this.Ty.I3){switch(Dc.contextId){case Zb.a.Hd:case Zb.a.paragraph:case Zb.a.endOfParagraph:case Zb.a.Tc:bc=!0}bc&&We.SelectionEditor.ml(Dc)&&Ba.b(Dc)&&(this.rd.Yb(Oe.a.hn,{["Reason"]:Fe.a.nHc}),
bc=!1);bc&&de.ParagraphReader.oU(Dc)&&(this.rd.Yb(Oe.a.hn,{["Reason"]:Fe.a.hO}),bc=!1)}if(1===Oc||!bc)return bc?32:8;6!==this.ga.AD?(this.xS.bR?u.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(u.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.xS.Q0i(this.Ty.kb),this.Bmd||(this.Mh.WYa(this.MEj),(Oc=this.Mh.hb.tu)&&Oc.Vi&&Oc.oph(this.LEj),this.Bmd=!0)),this.xS.bR=!this.xS.bR):(u.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),
this.xS.Q0i(this.Ty.kb),this.xS.bR=!1);return 32};this.smm=(bc,Dc,Oc,gd,rd)=>{if(6===this.ga.AD||this.xS.bR){u.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.AD);bc=this.Mh.Gq.$f("UserAction","FormatPainterApply");if(eE.Xb&&eE.Xb.DA(116)){rd=rd?rd.KeepBrushActive:!1;Oc=null;this.Ty.kb&&2===this.Ty.kb.trigger&&(rd=rd||this.xS.yYd,this.xS.yYd&&We.SelectionEditor.km(this.Ty.kb)&&(Oc=We.SelectionEditor.F3(this.Ty.kb.Oa,!1)))&&(Oc.trigger=2);this.xS.yYd=
!1;if(rd||2!==this.Ty.kb.trigger)Dc=new ah.GraphTransaction(15),Oc&&Oc.Oa?(Dc.set(Oc.Oa.node.pj),this.ib.setSelection(Oc)):Dc.set(this.Ty.k6b.pj),Oc=Mg.SelectionFactory.io(this.ib.tg),this.xS.hth(Oc),Dc.dispose();this.xS.bR=rd}else rd=new ah.GraphTransaction(15),rd.set(this.Ty.k6b.pj),Dc=Mg.SelectionFactory.io(this.ib.tg),this.xS.hth(Dc),this.xS.bR=!1,rd.dispose();bc.stop()}return 32};this.MEj=()=>{this.l8d(this.xS.bR)};this.LEj=()=>{this.l8d(this.xS.bR)};this.Mh=b;this.Ub=h;this.ga=v;this.rd=D;this.Ty=
Q;this.xS=ba;this.ib=ta;this.G7j=Ta;this.Ux=ob;this.rx=Kb;this.C_j=Vb}get EVg(){return aa.a.du||aa.a.VZd?"url("+this.T8h()+"), pointer":'url("'+this.T8h()+'"), pointer'}T8h(){return this.rx?this.Ux.Dva(zj.a.vg("FormatPainterText.cur"),zj.a.vg("FormatPainterTextDarkMode.cur"),new vM.a(sl.a.SK())):zj.a.vg("FormatPainterText.cur")}Tb(){const b=this.Ub.fe(pc.AppFrame.YE);b.bindAction(Yb.KeyInputManager.kc(zf.a.IIa,0),Eb.a.Hlf);b.bindAction(Yb.KeyInputManager.kc(zf.a.Uqb,6),Eb.a.ZMd);this.G7j||b.bindAction(Yb.KeyInputManager.kc(zf.a.Xqb,
6),Eb.a.A0a);this.ga.fb(Eb.a.ZMd,Zb.a.view,this.umm,1028);this.ga.fb(Eb.a.A0a,Zb.a.view,this.smm,1028);this.ga.fb(Eb.a.Hlf,Zb.a.view,this.tmm,1028);this.xS.Xvk(()=>{this.Ymg(this.xS.bR)});this.rx&&this.C_j.uzd(()=>{this.l8d(this.xS.bR)})}Ymg(b){const h=this.Mh.Gq.$f("UserAction","FormatPainterUpdateCursor");this.l8d(b);this.Mh.updateCommandUI();h.stop()}KEj(b,h){for(let v=0;v<b.length;v++)this.JEj(b[v],h);(b=this.Mh.hb.tu)&&b.qe&&this.JEj(b.rh.editingElement,h)}JEj(b,h){b.style.cursor=h?this.EVg:
""}l8d(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const v=h[h.length-2].style.cursor===this.EVg;if(this.Mh.hb.isEditingAllowed||this.Mh.hb.ry){if(b&&!v||!b&&v)this.KEj(h,b),this.gFj(b);b||!this.Bmd||this.WAe.count||(this.Mh.naj(this.MEj),(b=this.Mh.hb.tu)&&b.Vi&&b.S_n(this.LEj),this.Bmd=!1)}else v&&(this.KEj(h,!1),this.gFj(!1))}}gFj(b){const h=this.Mh.hb.tu;h&&(b?this.WAe.add(h.Yc.Al):this.WAe.remove(h.Yc.Al))}static get Xb(){return null!=eE.Byg?eE.Byg:eE.Byg=Ga.a.instance.Na("Box4.IFeatureHelper")}}
Object(n.a)(eE,"FormatPainterActor",null,[]);class kA{constructor(b,h,v){this.Tm=v}awl(b,h,v,D,Q){var ba;if(!({ie:v,selected:ba,gy:ob,zUc:Ta}=this.Vpj(h,v,!1)).returnValue)return ob;ch.a.mark(5013);var ta=kA.Wg.dO(ba);for(let Kb=0;Kb<ta.length;++Kb){if(!ta[Kb].isValid)continue;const Vb=ta[Kb].iterator;Vb.Ep();if(dh.OutlineReader.fx(Vb))return this.BWh(v,Vb)}var Ta=Di.a.tFd&&Ta?Eb.a.DSc:this.PUl();if(ba.$w||We.SelectionEditor.ml(ba)||de.ParagraphReader.lm(ba)&&!We.SelectionEditor.G8(ba)){if(kA.Xb&&
kA.Xb.isFeatureEnabled(25)&&io.ContextSetEditor.instance.Feg(ba).returnValue)return 8;var ob=this.CWh(h,v,b,D,Q,Ta)}else if(We.SelectionEditor.Gk(ba))ob=this.AWh(h,v,b,D,Q,Ta);else if(We.SelectionEditor.gf(ba)){ob=new ne.GraphIterator;ob.set(ba.node);ob.zb(10);ta=ue.HyperlinkReader.ND(ba,!1);if(0<ta.length){if(!ta[0].hyperlink)return u.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",ta[0].cpBegin,ta[0].cpEnd),8;Ya.App.Jgb(ta[0].hyperlink.url);return 32}Ph.TableCellReader.Z_(ob)&&
(Ig.returnToContainingCell(ob),Ph.TableCellReader.jha(ob)&&(ta=new ne.GraphIterator,ta.Zc(ob),Ig.returnToContainingRow(ta),dh.OutlineReader.EA(ob,ba,!1)&&Kl.a.Bwi(ta)&&0>=ba.Eb&&(Ta=Eb.a.HSc,Ig.returnToContainingTable(ob),ig.OutlineElementNavigator.Vd(ob),Q||(Q=new fh.DictionaryPropertySet),Q.Zg(wc.a.targetObject,ob.currentNode.id))));ob=this.DWh(h,v,b,D,Q,Ta)}else We.SelectionEditor.G8(ba)&&(ob=w.AFrameworkApplication.va.Of(h,Eb.a.newLine,2,!1,D,Q));ch.a.mark(5014);return ob}Vpj(b,h,v){let D=null,
Q=null,ba=!1;if(1===h)return{returnValue:!1,ie:D,selected:Q,gy:32,zUc:ba};if(!b.view.qe)return{returnValue:!1,ie:D,selected:Q,gy:2,zUc:ba};D=b.view;Q=D.lb.tg;return!Q||!kA.Xf.gwi(Q,v)||Di.a.tFd&&kA.Xf.nha(Q,ta=>ba=ta)&&!ba?{returnValue:!1,ie:D,selected:Q,gy:2,zUc:ba}:this.Tm&&this.Tm.instance&&this.Tm.instance.tU(Q)?{returnValue:!1,ie:D,selected:Q,gy:4,zUc:ba}:{returnValue:!0,ie:D,selected:Q,gy:2,zUc:ba}}ypo(b,h,v,D,Q){let ba,ta;if(!({ie:v,selected:ba,gy:ta}=this.Vpj(h,v,!0)).returnValue)return ta;
const Ta=kA.Wg.dO(ba);for(let ob=0;ob<Ta.length;++ob){if(!Ta[ob].isValid)continue;const Kb=Ta[ob].iterator;Kb.Ep();if(dh.OutlineReader.fx(Kb))return this.BWh(v,Kb)}ba.$w||We.SelectionEditor.ml(ba)?ta=this.CWh(h,v,b,D,Q,Eb.a.DSc):We.SelectionEditor.Gk(ba)?ta=this.AWh(h,v,b,D,Q,Eb.a.DSc):We.SelectionEditor.gf(ba)?ta=this.DWh(h,v,b,D,Q,Eb.a.DSc):We.SelectionEditor.G8(ba)&&(ta=w.AFrameworkApplication.va.Of(h,Eb.a.newLine,2,!1,D,Q));return ta}BWh(b,h){b.lb.setSelection(Mg.SelectionFactory.ho(h.currentNode,
!1));return 32}CWh(b,h,v,D,Q,ba){const ta=new ah.GraphTransaction(15);ta.fk=v;ta.Cb(h.Yc);h=new fh.DictionaryPropertySet;h.setValue(wc.a.QJc,!0);h=w.AFrameworkApplication.va.Of(b,Eb.a.CH,2,!0,D,h);32===h&&(h=w.AFrameworkApplication.va.Of(b,ba,2,!1,D,Q));ta.dispose();return h}AWh(b,h,v,D,Q,ba){const ta=new ah.GraphTransaction(15);ta.fk=v;ta.Cb(h.Yc);h.lb.setSelection(We.SelectionEditor.xj(h.lb.gb.J(0),!1,!1));b=w.AFrameworkApplication.va.Of(b,ba,2,!1,D,Q);ta.dispose();return b}DWh(b,h,v,D,Q,ba){const ta=
new ah.GraphTransaction(15,v);ta.fk=v;ta.Cb(h.Yc);b=w.AFrameworkApplication.va.Of(b,ba,2,!1,D,Q);ta.dispose();return b}static get Wg(){return io.ContextSetEditor.instance}static get Xf(){return xi.a.instance}static get Xb(){return null!=kA.xyg?kA.xyg:kA.xyg=Ga.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(kA,"AEnterViewStrategy",null,[1675]);class qJ extends kA{constructor(b,h,v){super(b,h,v)}PUl(){return Eb.a.newLine}}Object(n.a)(qJ,"EnterViewStrategy",kA,[]);class iH{constructor(b){this.nl=
this.transaction=null;this.ie=b;this.yHc=this.qo=0}}Object(n.a)(iH,"SelectAllArguments",null,[]);class jD{constructor(b,h,v){this.Kxn=b;this.cYm=h;this.Ts=v;this.Kxl=(D,Q,ba)=>Q.view.Vi?this.ogb(Q,ba,this.Auj):this.Zao(Q,ba);this.Z1c=(D,Q)=>Q.qo?1===Q.qo?(Q.ie.lb.h7c(Q.nl,D),Q.qo=2,!0):2===Q.qo?(Q.ie.lb.gb.w_a=Q.nl.w_a,this.Pg.iF(),Q.transaction.rHa(D),Q.qo=3,Q.transaction.dispose(),ch.a.mark(5799),!0):!1:(Q.transaction=this.Ts.Oc(2),Q.transaction.Cb(Q.ie.Yc),Q.qo=1,!0);this.Zao=(D,Q)=>{if(1===Q)return 32;
if(!D.view.qe)return 2;D=D.view;return D.lb&&D.lb.gb&&D.lb.gb.kb?this.Auj(D).inProgress?1:32:8};this.Auj=D=>{w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");D.Vi&&u.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");D=new Mf.a(null,this.iIn,new iH(D));D.Jl("SelectAllInOutline");D.run();return D};this.iIn=(D,Q)=>{if(!Q.qo)return Q.nl=Mg.SelectionFactory.$ao(Q.ie.lb.gb.kb),Q.transaction=this.Ts.Oc(2),Q.transaction.Cb(Q.ie.Yc),Q.qo=1,!0;
if(1===Q.qo){if(!Q.yHc)return Q.ie.lb.setSelection(Q.nl.J(0),D),++Q.yHc,!0;if(Q.yHc<Q.nl.length)return Q.ie.lb.juk(Q.nl.J(Q.yHc),D),++Q.yHc,!0;Q.qo=2}return 2===Q.qo?(Q.ie.lb.gb.w_a=Q.nl.w_a,this.Pg.iF(),Q.transaction.rHa(D),Q.qo=3,Q.transaction.dispose(),!0):!1}}get Pg(){return this.cYm.value}Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.Gya,Kd.a.frame,jD.Wqj);b.qa(Eb.a.scg,Kd.a.frame,jD.Wqj);b.fb(Eb.a.ogb,Zb.a.view,this.Kxl,2);b.fb(Eb.a.hCa,Zb.a.view,gf.AFrame.Hg,100);b.fb(Eb.a.zNf,Zb.a.view,
jD.zNf,4)}ogb(b,h,v){if(1===h)return 32;if(!b.view.qe)return 2;h=b.view;if(!h.lb)return 8;const D=h.lb.gb;if(!D||!D.length)return 8;ch.a.mark(5798);Ya.App.xa.hb.isEditingAllowed||Ya.App.xa.hb.ry||h.Vi?b=We.SelectionEditor.Xrf(D):($c.FocusManager.instance().dD(gf.AFrame.Pn),b=Mg.SelectionFactory.ihj(h.Yc));if(!b)return 8;D.w_a||u.ULS.sendTraceTag(39098305,324,50,"Progress selection start");v&&this.Kxn.xHb(We.SelectionEditor.Q6h(b))?v=v(h):(v=new iH(h),v.nl=b,v=new Mf.a(null,this.Z1c,v),v.Jl("ExpandSelection"),
v.run());return v.inProgress?1:32}static get j6a(){return null!=jD.XFg?jD.XFg:jD.XFg=Ga.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static zNf(b,h,v){if(1===v)return 32;if(!h.view.qe)return 8;b=h.view;h=Mg.SelectionFactory.ho(b.root.graphNode,!0);if(!h)return 8;b.lb.setSelection(h);return 32}static Wqj(){var b=Ya.App.xa.hb.tu;if(!b.qe)return 2;if(b.qe&&1!==Ya.App.xa.state){ch.a.mark(4668);var h=b.lb.gb.kb;if(!h&&w.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;
h=We.SelectionEditor.l3(h);let v=h.x,D=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)v=b.x,D=b.y;jD.j6a.Gya(new Sys.UI.Point(v,D),1);ch.a.mark(4669)}return 32}}Object(n.a)(jD,"SelectAllHandlers",null,[1499]);class rJ{gge(){}}Object(n.a)(rJ,"FontNameFormattingStrategyNoop",null,[1645]);var sJ=c(863);class rG{constructor(b,h,v,D,Q,ba){this.xwh=this.Awh=null;this.Vr=b;this.wwh=h;this.qKk=v;this.AKk=D;this.Awh=Q;
this.xwh=ba}}Object(n.a)(rG,"BookmarkHighlightContext",null,[]);class tJ extends dk.a{constructor(){super()}get Oba(){return!0}get yib(){return 5}get X1a(){if(null!=this.o2)return this.o2;this.o2=[];this.o2.push(new Vk.a($l.a.xBd,$l.a.xBd));this.o2.push(new Vk.a($l.a.x3e,$l.a.x3e));this.o2.push(new Vk.a($l.a.bFc,$l.a.bFc));return this.o2}rGa(b,h){this.Oba&&wr.a.instance.he(()=>{const v=this.Cu.jDa;var D=this.Cu.TWc;if(v)if(5===v.type){D=v.xA;if(v.JJ&&v.JJ.Vr.includes(b))for(const Q of h.LGa("*"))this.Cu.pSa(Q);
D&&D.Vr.includes(b)&&this.oob(h,v.action,D,b)}else D&&5===D.type&&3===v.action&&D.xA.Vr.includes(b)&&this.oob(h,0,D.xA,b)},"BHA:OPHC")}wQa(b){return Object(yb.a)(rG,b)}p1a(b,h){if(b)for(const v of b.Vr)h.add(v)}oob(b,h,v,D){0===h&&b.htmlElement&&wr.a.instance.he(()=>{const Q=b.LGa("*"),ba=Q.length,ta=$l.a.xBd;var Ta=D.id===v.Awh,ob=D.id===v.xwh;let Kb=!1;var Vb=0,bc=[];const Dc=Array(ba);for(let rd=0;rd<ba;rd++){var Oc=Q[rd];const je=Nh.a(Oc);Dc[rd]=je;const Ld=Oc.classList;if(0!=Dc[rd]){const Qd=
!Ld.contains($l.a.pG),ge=ei.a.Db(Oc,$l.a.Mzb);ge&&bc.push(...ge);if(Ta){let ze;if((ze=ei.a.Db(Oc,$l.a.zBd))&&ge&&1===ze.length&&1===ge.length&&ze[0].equals(ge[0]))continue;ze&&(Vb+=ze.length,1===je?Ld.add($l.a.x3e):Ld.add(ta));if(ge)for(const gg of ge)this.yXd(v,gg)&&(Vb--,Kb&&Ld.add($l.a.bFc));0!==Vb&&Qd&&Ld.add(ta)}if(!Ta&&!ob&&v.AKk.has(D.id))if((Oc=ei.a.Db(Oc,$l.a.Mzb))&&Kb){Ld.add(ta);for(const ze of Oc)if(this.yXd(v,ze)){Ld.add($l.a.bFc);break}}else Qd&&Ld.add(ta)}Kb=!Ld.contains($l.a.agb)}if(ob&&
!Ta){Ta=new Set;for(var gd of bc)this.yXd(v,gd)&&Ta.add(gd);Kb=!1;for(bc=0;0!==Ta.size&&bc<ba;bc++){Vb=Q[bc];gd=Vb.classList;if(0!=Dc[bc])if(ob=!1,Vb=ei.a.Db(Vb,$l.a.Mzb)){for(const rd of Vb)this.yXd(v,rd)&&(Ta.delete(rd),ob=!0);0!==Ta.size&&gd.add(ta);Kb&&ob&&gd.add($l.a.bFc)}else gd.contains($l.a.pG)||gd.add(ta);Kb=!gd.contains($l.a.agb)}}},"BHA:SPH")}yXd(b,h){for(const v of b.qKk)if(h.equals(v))return!0;return!1}}Object(n.a)(tJ,"BookmarkHighlightActor",dk.a,[564]);var sG=c(1861),uJ=c(1648);class tG{constructor(b,
h,v,D,Q,ba,ta,Ta,ob,Kb){var Vb;this.uui=!1;this.Yf=b;this.Yz=h;this.eb=Q;this.DV=ba;this.Oj=ta;this.ge=Ta;this.ld=Kb;this.Ma=ob;this.uui=null!==(Vb=null===ob||void 0===ob?void 0:ob.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==Vb?Vb:!1}W9f(b,h,v,D){const Q=b.cmh(h);if(Q){var ba=Object(yb.a)(uJ.a,b),ta=this.ge.$f("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ba,v)),Ta=h.$j.node,ob=()=>
{v||this.removeImage(h.$j,Q.getId())};ba=tG.Rxh();D=this.oyh(Q.getId().toString(),Ta,D,v);try{b.rsh(D,h)}catch(Kb){u.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Kb.message);this.zp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Yf.tj(ba,2,D.toString(),{},!0,0,Kb=>{u.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");
b.Mec(Kb,Q,()=>{this.zp(b.xRd())},ob,Ta,h,ta)},Kb=>{const Vb=415===Kb.data.Qe;let bc="";Kb&&Kb.data&&Kb.data.wj&&"X-CorrelationId"in Kb.data.wj&&Kb.data.wj["X-CorrelationId"]&&(bc=Kb.data.wj["X-CorrelationId"]);b.ppa(`Graphics editor request failed. HttpStatus [${Kb.data.Qe}], ResponseData [${Kb.data.we}], CorrelationId [${bc}]`,Q,Ta,ob,()=>{this.zp(Vb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.xRd())},ta,Vb)},null)}else this.zp(b.xRd())}Hco(b,h,v){return new Promise((D,
Q)=>{var ba=b.$j,ta=null;ta=this.uui&&Jf.a.tEf(ba)?ba.getContext(0).node:ba.node;ba=tG.Rxh();ta=this.oyh(h.toString(),ta,v,!1);ta.Ce(sG.a.W9e,"2");this.Yf.tj(ba,2,ta.toString(),{},!0,0,Ta=>{u.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");D(Ta.data.we)},Ta=>{u.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ta.data.Qe}, ResponseData ${Ta.data.we}`);
this.zp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);Q(null)},null)})}oyh(b,h,v,D){const Q=h.Bi(),ba=new fb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");w.AFrameworkApplication.dfa(ba);ba.Ce(sG.a.strict,this.ALm(h)?"true":"false");ba.Ce(Yf.a.nodeId,b);ba.Ce(Yf.a.cellId,Q.nm.toString());ba.Ce(Yf.a.fileId,Q.sr);ba.Ce(Yf.a.lX,v.toString());ba.Ce(sG.a.xxl,D?"true":"false");if(b=!!this.ld&&this.ld.isFeatureEnabled(49)){ba.Ce(Sd.a.U0i,b.toString());if(b=this.ld.isFeatureEnabled(89))ba.Ce(Sd.a.TBn,
b.toString()),ba.Ce(Sd.a.Wtm,"true");this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ba.Ce(Sd.a.bCn,"true")}ba.Ce(Sd.a.Ivh,"true");yj.a.instance.czb(ba);return ba}ALm(b){if(!this.Yz)return!1;b=this.Yz.Xs(b);return!!b&&b.Hf(lc.a.dGf)}removeImage(b,h){b.cpBegin===b.cpEnd-1&&this.Oj.Xgc(b.node,h,this.eb,this.DV)}zp(b){const h=new pg.StandardDialog;h.Ad=0;h.mx(Nl.a.egf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);
Ya.App.xa.updateCommandUI()}static Rxh(){const b=new fb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");w.AFrameworkApplication.dfa(b);return b.toString()}}Object(n.a)(tG,"GraphicsEditorRequestManager",null,[719]);class vJ extends PD{constructor(b,h){super(b,h);this.JPa=Eb.a.insertHyperlink}p2a(b){null!=b&&0<b.length&&this.oc.Qb(this.JPa,2,b[0])}gMj(b,h,v){const D=lk.a.og(w.AFrameworkApplication.lcid).name;b=String.format(b,w.AFrameworkApplication.lcid,D,w.AFrameworkApplication.buildVersion,
h,YC.are,v);b+="&flipgrid=1&ted=1";w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new fb.QueryStringBuilder(b),b.JI("stream2","1"),w.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&b.JI("enablegetcustomheader","1"),b=b.toString());return b}}Object(n.a)(vJ,"InsertHubbleMediaHelper",PD,[]);class wJ{constructor(b,h,v,D,Q,ba,ta){this.ga=b;this.Ma=h;this.dld=v;this.s2=D;this.nid=Q;this.Ik=ba;this.wWj=ta}Tb(){this.ga.fb(sc.a.wYi,
Zb.a.Tc,this.awn.bind(this),1028);this.ga.fb(sc.a.tri,Zb.a.Tc,this.pBm.bind(this),1028)}pBm(b,h,v,D,Q){if(1!==v){if(null==Q)return 16;if(!h.el||!We.SelectionEditor.gf(h))return 2;b=this.DUl(Q);Q=Q.OriginalUrl;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.nid.Arg(b,h,Q)}return 32}hSj(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}DUl(b){const h=new lv;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}awn(b,h,v){var D,Q;if(1!==v)h=G.a.YW(this.Ma.jb("UserId")).toString(),h=this.s2.gMj(this.Ma.appSettings.InsertVideoHubbleEndpoint,sb.a.create().toString(),h),this.s2.JPa=sc.a.tri,h=this.dld.tOc(h,!0),h.correlationId=sb.a.create(),
h.Nha=5,h.qie(null,this.s2,this.wWj),fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new pa.a,{name:"ActionId",int64:b})]})),this.hSj();else if(!(h&&h.node&&bC.a(h.node))||(null===(D=this.Ik)||void 0===D?0:D.j_(h))||(null===(Q=this.Ik)||void 0===Q?0:Q.nha(h)))return 2;return 32}}Object(n.a)(wJ,"OnlineMediaActor",null,[]);const wM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net",
"https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class xJ extends ND{constructor(b,h,v,D=null,Q=!1){super(b,h,v,D,Q);this.Stc=null;this.ITf=()=>{this.Ry&&(u.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!this.JBa} time: ${(new Date).getTime()-this.ii}`),
this.Ry.sendMessage(L.a.dkj,{["CustomHeaders"]:this.JBa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}GDb(){const b={};b.insertMediaServiceEndpoint=this.eld;b.iFrameId="mediaiframe";return b}async qie(b,h,v){v&&await this.refreshToken(v);this.UTb=b;this.Stc=h;this.Nsc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.GDb(),["componentIsVisibleCallback"]:this.fQj.bind(this)};this.Yh(this.UTb,null,b)}fQj(){this.k0=this.n7b(this.kj("mediaiframe"));let b=this.eld;
if(w.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),v=wM[h.protocol+"//"+h.host];v?b=v:u.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.Ry=this.nrd.getInstance(this.k0.contentWindow,b);this.Ry.Cq(L.a.Mnh,h=>{this.aSi(h,this.Stc.p2a.bind(this.Stc))});this.Ry.Cq(L.a.insert,h=>{this.T6d(h,this.Stc.p2a.bind(this.Stc))});this.Ry.Cq(L.a.T6h,this.ITf.bind(this));this.Ry.Cq(L.a.getSessionId,this.bUi.bind(this));this.Ry.Cq(L.a.B4h,this.ZTi.bind(this));
this.Ry.Cq(L.a.tCd,this.LSi.bind(this));this.bob(3)}bob(b){const h=[];h.push(Object.assign(new pa.a,{name:"DialogResult",string:XC[b]}));h.push(Object.assign(new pa.a,{name:"DialogMode",string:this.Arf()}));h.push(Object.assign(new pa.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new pa.a,{name:"Provider",string:eA[this.Nha]||"Unknown"}));fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){this.ii=
(new Date).getTime();try{const h=await b.PY("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(this.JBa=h.Token);u.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!this.JBa} time: ${(new Date).getTime()-this.ii}`)}catch(h){u.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ii} error: ${h} `)}}}Object(n.a)(xJ,"OnlineMediaDialog",ND,
[]);class yJ{constructor(b,h){this.cEe=b;this.s2=h}tOc(b,h=!1){return new xJ(b,this.cEe,this.s2,null,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(yJ,"OnlineMediaDialogFactory",null,[725]);class zJ extends dx{constructor(){super(1,3);this.HL=Ga.a.instance.resolve("Common.IReactContextualUILauncher");this.Sxj=!1}K6a(){w.AFrameworkApplication.va.processAction(sc.a.Ejc,2)}hKd(){this.V_h&&!this.uv&&(this.uv=this.oKa())}XKd(){if(this.uv&&this.uv.isVisible){var b=Object(Ka.a)(Jk.Control,this.uv.controls["ExternalContentFloatie.FlyoutAnchor"]);
b.behavior.Yw(b.phb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)u.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(Ze.a.NAd)||"",Ze.a.fM===h&&b.click())}}X_(){return this.HL.X_}}Object(n.a)(zJ,"ExternalContentFloatieManager",dx,[]);class ns{constructor(){ns.Rym()}get wc(){return null!=this.rJg?
this.rJg:this.rJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Uw(){return null}Vlc(b){var h=null;if(!de.ParagraphReader.sh(b))return{returnValue:!1,vma:h};if((b=this.wc.No(b.currentNode))&&2===this.wc.yG(b)){const v=this.wc.pg(b);ns.lQ.contains(v)&&(h=this.wc.vM(b),h=Object.assign(new ex.a,{LG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,vma:h}}WDb(b,h){let v=null;h&&b.contentId.equals(h.contentId)||(v=b.contentObject);return v}static Rym(){ns.lQ=
new wl.a;ns.lQ.add(hj.StyleReader.styleIdHeading1);ns.lQ.add(hj.StyleReader.styleIdHeading2);ns.lQ.add(hj.StyleReader.styleIdHeading3);ns.lQ.add(hj.StyleReader.b7a);ns.lQ.add(hj.StyleReader.lPb);ns.lQ.add(hj.StyleReader.mPb);ns.lQ.add(hj.StyleReader.qkc);ns.lQ.add(hj.StyleReader.pkc);ns.lQ.add(hj.StyleReader.wordStyleIdHeading1);ns.lQ.add(hj.StyleReader.wordStyleIdHeading2);ns.lQ.add(hj.StyleReader.wordStyleIdHeading3);ns.lQ.add(hj.StyleReader.l8a);ns.lQ.add(hj.StyleReader.m8a);ns.lQ.add(hj.StyleReader.n8a);
ns.lQ.add(hj.StyleReader.Eqb);ns.lQ.add(hj.StyleReader.Fqb);ns.lQ.add(hj.StyleReader.o8a);ns.lQ.add(hj.StyleReader.s8a);ns.lQ.add(hj.StyleReader.knc)}}ns.lQ=null;Object(n.a)(ns,"ParagraphStyleDetailsProvider",null,[677,568]);class AJ{constructor(b,h,v,D){this.tKa=b;this.Z9j=h;this.g$j=v;this.h$j=D}P3f(){this.tKa.execute(b=>{b.Rgc(this.Z9j.value);b.Rgc(new ns);b.Rgc(this.h$j.value);b.V4(this.g$j.value)})}}Object(n.a)(AJ,"AccessibilityActor",null,[]);class BJ{constructor(b,h,v){this.ei=null;this.d8c=
(D,Q,ba)=>{if(1===ba)return 32;this.ei=this.Brc.value.M7k(this.Ub);if(!this.ei)return u.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.ei.jTa();return 32};this.Llh=D=>this.ei?this.ei.fom(D):2;this.ga=b;this.Brc=h;this.Ub=v}Tb(){if(w.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Yb.KeyInputManager.kc(zf.a.Tqb,5);this.Ub.fe(gf.AFrame.Pn).ir(b);this.Ub.fe(gf.AFrame.vp).bindAction(b,Ua.a.d8c);this.ga.qa(Ua.a.d8c,Kd.a.frame,this.d8c);this.ga.qa(Ua.a.fDc,
Kd.a.frame,this.Llh);this.ga.qa(Ua.a.eDc,Kd.a.frame,this.Llh)}}}Object(n.a)(BJ,"AccessibilityHelpDialogActor",null,[]);var xM=c(1039),yM=c(1403);class CJ{constructor(b,h){this.R4j=b.mc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.oUj=xM.a.cF(26,5,new yM.a)}BY(){this.ga.BY(this)}G4(){}E4(b){const h=+b.endTime-+b.startTime;if(h>this.R4j){let v="";switch(b.behavior){case 1:v="E";break;case 2:v="X";break;case 3:v="A"}(b=Rc.ActionManager.Baa(b.actionId))&&b.length||(b="UnknownAction");this.oUj.track(h,
b+"_"+v)}}}Object(n.a)(CJ,"ActionHangDetector",null,[30]);var DJ=c(1482);class EJ extends Re{constructor(b){super(b,void 0,w.AFrameworkApplication.K_a,new Ng(b,!1))}get k4a(){return this.WXd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:this.hYd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Gcc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get AXc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get AIc(){return w.AFrameworkApplication.K_a?
"UIFontDialogTextLarge":null}get WXd(){return 1===w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get hYd(){return 2===w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}cKf(){u.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");w.AFrameworkApplication.Fha("t1shrdnl;t2shrdnl;c-shrdnl")}dKf(){u.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}VXc(){u.ULS.sendTraceTag(19462214,
324,50,"Download a copy dialog button clicked");w.AFrameworkApplication.va.processAction(Ua.a.ATh,2)}p$e(){this.i8({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}JUh(){this.i8({SourceControlId:"Share"},{ControlId:"Share"})}i8(b,h){const v=w.AFrameworkApplication.va;v.AD=8;v.Qb(Ua.a.i8,2,b,h)}}Object(n.a)(EJ,"DownloadACopyDialog",Re,[]);var uG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";
b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(uG||(uG={}));Object(n.b)("OfficeApplication",uG);var GF;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(GF||(GF={}));Object(n.b)("OpenDocumentMode",GF);class FJ extends Vf.a{constructor(){super(!1,!1,!0)}u8d(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",
["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",
["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Yh("Send feedback to Microsoft",this.iko.bind(this),b);return new Promise(v=>{this.Zbk=v})}iko(b,h){1===b&&this.tP(h.selectedReason)}dispose(){super.dispose();this.Zbk()}tP(b){const h={},v={},D={},Q={},ba={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=sb.a.create().toString();ba.reason=b;const ta={},Ta={numberOfOptions:5};Ta.selectedRating=
b;ta.rating=[Ta];Q.surveySpecificData=JSON.stringify(ta);D.extendedManifestData=JSON.stringify(Q);h.application=D;ba.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ba;h.telemetry=this.Vzb();h.web=this.lFc();v["Content-Type"]="application/json";this.OGa(JSON.stringify(h),v)}Faa(b,h,v,D){h&&b&&D&&v&&D in h&&(b[v]=h[D])}Vzb(){const b=w.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=w.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.Faa(h,b,"audienceGroup",
"AudienceGroup");this.Faa(h,b,"osBuild","OsVersion");this.Faa(h,b,"platform","Platform");this.Faa(h,b,"processSessionId","WACSessionID");return h}lFc(){const b=w.AFrameworkApplication.sessionStartInfoSettings,h={};this.Faa(h,b,"browser","Browser");this.Faa(h,b,"browserVersion","BrowserVersion");this.Faa(h,b,"dataCenter","WACDatacenter");return h}OGa(b,h,v=0){let D=0;3<v||(1===v?D=200:1<v&&(D=200+500*(v-1)),w.AFrameworkApplication.pc.Wb(new of.a(2,1,D,()=>{w.AFrameworkApplication.Ne.tj("https://petrol.office.microsoft.com/v1/feedback",
2,b,h,!1,2,()=>{u.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.OGa(b,h,v+1);u.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",v)},null)})))}}Object(n.a)(FJ,"WordOpenInClientFeedbackDialog",Vf.a,[]);var GJ=c(1758);const TE=b=>{for(let h=0;h<b.children.length;h++){const v=b.children[h];v.style.position="relative";v.style.top=(v.parentNode.offsetHeight-v.offsetHeight)/2+"px"}},vG=b=>b.Gb.keyCode===zf.a.Bs||
b.Gb.keyCode===zf.a.JIa?(b.zf.click(),!0):!1,HF=(b,h,v,D,Q,ba,ta)=>{const Ta=document.createElement("a");Ta.className="ProtocolLaunchingDialogButtonAnchor";Ta.className+=" OICDialog";Ta.id=b;Ta.setAttribute(Ze.a.qh,Ze.a.f3);Ta.style.padding="0";Ta.style.margin="0";D&&HJ(Q,h,v,D,Ta);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=Q;Ta.appendChild(b);Ta.tabIndex=0;ba&&Sh.a.instance.mb(Sc.a.click,Ta,ba);ta&&Yb.KeyInputManager.instance.mb(Sc.a.uh,Ta,ta);return Ta},
HJ=(b,h,v,D,Q)=>{var ba=document.createElement("img");ba.alt=b;ba.className=pd.getImageClassWithCluster(v,D);ba.src=h;ba.setAttribute(Ze.a.qh,Ze.a.$y);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ba);ba=document.createElement("span");ba.className="ProtocolLaunchingDialogIconContainer";ba.appendChild(b);Q.appendChild(ba)};class wG{static get Xg(){return Vf.a.qA(wG.Lm,CommonUIStrings.l_OICLaunchDialogTitle)}}wG.Lm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(wG,"OICLaunchDialogHtml",null,[]);class IJ extends Vf.a{constructor(b){super();this.CSb=this.Crb=null;this.sS=!1;this.nq=b;this.Xg=wG.Xg;this.Ad=5;this.wg="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.Yin,"oicLaunchDialogResultHandler"));this.jlj();this.e5("ProtocolLaunchingDialogTitle");4!==w.AFrameworkApplication.ta.Nb.WNa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.R0(this.Crb);u.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}f9(){this.Crb=HF("BtnRichClient",this.nq.NJc,this.nq.URc,this.nq.Tyf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.zWi,"onRichClientButtonClick"),vG);document.getElementById("OICLaunchRichClient").appendChild(this.Crb);TE(this.Crb);this.CSb=HF("BtnReturn",this.nq.NJc,this.nq.URc,this.nq.Yoi,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.tWi,"onReturnButtonClick"),
vG);document.getElementById("OICReturnToApp").appendChild(this.CSb);TE(this.CSb)}tWi(){this.hide();this.nq.ohc();return!0}zWi(){u.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();w.AFrameworkApplication.va.processAction(Ua.a.jNb,2);return!0}Yin(){this.nq.ohc()}dispose(){this.sS||(this.Crb&&(Sh.a.instance.uc(Sc.a.click,this.Crb,Object(z.a)(this,this.zWi,"onRichClientButtonClick")),Yb.KeyInputManager.instance.uc(Sc.a.uh,this.Crb,vG)),this.CSb&&(Sh.a.instance.uc(Sc.a.click,
this.CSb,Object(z.a)(this,this.tWi,"onReturnButtonClick")),Yb.KeyInputManager.instance.uc(Sc.a.uh,this.CSb,vG)),super.dispose(),this.sS=!0)}}Object(n.a)(IJ,"OICLaunchDialog",Vf.a,[]);class xG{static get Xg(){return Vf.a.qA(xG.Lm,CommonUIStrings.l_OICDialogTitle)}}xG.Lm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(xG,"ProtocolLaunchingDialogV2Html",null,[]);class JJ extends Vf.a{constructor(b){super();this.BSb=this.NUa=null;this.sS=!1;this.m9a=null;this.nq=b;this.Xg=xG.Xg;this.Ad=5;this.wg="ProtocolLaunchingDialog";this.Zqc="OICRetryDialog";w.AFrameworkApplication.pc.LFb&&w.AFrameworkApplication.pc.restart();w.AFrameworkApplication.pc.Wb(new of.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.L0f,"protocolLaunchingDialogResultHandler"));this.jlj();this.e5("Issues");
this.n0h();u.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}f9(){const b=document.getElementById("Issues");if(b){HJ("",this.nq.NJc,this.nq.URc,this.nq.Tyf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.nq.jYi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);TE(b);b.style.display="none"}w.AFrameworkApplication.ta.Nb.Fji?
(this.BSb=HF("GiveFeedback",this.nq.NJc,this.nq.URc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.F6d,"onGiveFeedbackClick"),Object(z.a)(this,this.dUi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.BSb),TE(this.BSb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===w.AFrameworkApplication.ta.Nb.WNa||w.AFrameworkApplication.Rml?document.getElementById("ButtonEdit").style.display="none":(this.NUa=
HF("Edit",this.nq.NJc,this.nq.URc,"",2===w.AFrameworkApplication.ta.Nb.Sl?4===w.AFrameworkApplication.ta.Nb.WNa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===w.AFrameworkApplication.ta.Nb.WNa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.FTi,"onEditClick"),Object(z.a)(this,this.ITi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.NUa),TE(this.NUa));0===w.AFrameworkApplication.ta.Nb.WNa&&
!w.AFrameworkApplication.FEf&&b&&(b.style.display="none")}o0h(){return this.m9a?(this.R0(this.m9a),!0):!1}n0h(){return this.NUa?(this.R0(this.NUa),!0):!1}ITi(b){return this.JSf(b,0)}dUi(b){return this.JSf(b,2)}sWi(b){return this.JSf(b,1)}JSf(b,h){let v=!1;if(b.Gb.keyCode===zf.a.Bs||b.Gb.keyCode===zf.a.JIa)b.zf.click(),v=!0;else if(b.Gb.keyCode===Sys.UI.Key.down||b.Gb.keyCode===Sys.UI.Key.up)switch(h){case 1:v=this.n0h();break;case 0:v=this.o0h()}return v}FTi(){this.hide();4===w.AFrameworkApplication.ta.Nb.WNa?
(u.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.nq.ohc()):(u.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.nq.jQc());return!0}F6d(){u.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}rUf(){ZF.Redirect.showHelp("OICFailure");return!0}E7d(){u.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";w.AFrameworkApplication.va.processAction(Ua.a.jNb,2);return!0}L0f(){this.nq.ohc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.m9a=HF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.E7d,"onRetryOICClick"),Object(z.a)(this,this.sWi,"onRetryOICKeyUp")),b.appendChild(this.m9a),TE(this.m9a),this.NUa||this.o0h())}}dispose(){this.sS||(this.NUa&&
(Sh.a.instance.uc(Sc.a.click,this.NUa,Object(z.a)(this,this.FTi,"onEditClick")),Yb.KeyInputManager.instance.uc(Sc.a.uh,this.NUa,Object(z.a)(this,this.ITi,"onEditKeyUp"))),this.BSb&&(Sh.a.instance.uc(Sc.a.click,this.BSb,Object(z.a)(this,this.F6d,"onGiveFeedbackClick")),Yb.KeyInputManager.instance.uc(Sc.a.uh,this.BSb,Object(z.a)(this,this.dUi,"onGiveFeedbackKeyUp"))),this.m9a&&(Sh.a.instance.uc(Sc.a.click,this.m9a,Object(z.a)(this,this.E7d,"onRetryOICClick")),Yb.KeyInputManager.instance.uc(Sc.a.uh,
this.m9a,Object(z.a)(this,this.sWi,"onRetryOICKeyUp"))),super.dispose(),this.sS=!0)}}Object(n.a)(JJ,"ProtocolLaunchingDialog",Vf.a,[]);class yG extends pg.StandardDialog{constructor(b){super();this.nq=b;this.wg="ProtocolLaunchingDialog";w.AFrameworkApplication.pc.LFb&&w.AFrameworkApplication.pc.restart();w.AFrameworkApplication.ta.Nb.Fji&&this.Ork(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.F6d,"onGiveFeedbackClick"));yG.Gli?(this.Ad=12,this.Ee(1,CommonUIStrings.l_CloseFile),
this.Ee(2,CommonUIStrings.l_OICDialogContinueHere),this.Ee(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ad=4,this.Ee(1,CommonUIStrings.l_OICDialogContinueHere),this.Ee(2,CommonUIStrings.l_OICDialogLaunchAgain));this.llb(CommonUIStrings.l_OICDialog2ndTitle,5===this.nq.jYi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.L0f,"protocolLaunchingDialogResultHandler"),null)}F6d(b){u.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.OTi(b)}E7d(){u.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");w.AFrameworkApplication.va.processAction(Ua.a.jNb,2)}L0f(b){yG.Gli?3===b?this.Ydj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.Ydj():(1===b||0===b)&&this.continueEditing()}closeDocument(){u.ULS.sendTraceTag(577783557,211,50,"Closing the document");w.AFrameworkApplication.va.Qb(Ua.a.close,2,lh.a)}Ydj(){u.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.E7d,
"onRetryOICClick"),0)}continueEditing(){4===w.AFrameworkApplication.ta.Nb.WNa||w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===w.AFrameworkApplication.ta.mode?(u.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.nq.ohc()):(u.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.nq.jQc())}static get Gli(){return w.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===w.AFrameworkApplication.va.processAction(Ua.a.close,
1)}}Object(n.a)(yG,"StandardProtocolLaunchingDialog",pg.StandardDialog,[]);class KJ{}Object(n.a)(KJ,"EditDocumentInClientParams",null,[]);class jH{static $Th(b,h,v,D,Q,ba,ta=!1,Ta=!1,ob="",Kb=!1,Vb=!1,bc=!1,Dc="",Oc="",gd="",rd=!1,je=""){const Ld=new KJ;Ld.DocumentUrl=b;Ld.DocumentExtension=je;Ld.Mode=h;Ld.Options=v;Ld.Application=D;Ld.SilentExternalHandler=ta;Ld.EncodeUrl=Ta;Ld.CorrelationIdForWinClient=ob;Ld.NavigateUsingWindowOpen=Kb;Ld.DescriptiveUnattemptedEnums=Vb;Ld.NoBrowserModalDialogs=bc;
Ld.SessionOrigin=Dc;Ld.CorrelationId=Oc;Ld.ClickTime=gd;Ld.NewTelemetryDataIsEnabled=rd;MSOJS.ClientUtils.EditDocumentInClient(Ld,Q,ba)}}Object(n.a)(jH,"ClientUtils",null,[]);var zM=c(537),LJ=c(943);class fE{constructor(b){this.nXa=this.$rc=this.Upc=null;this.mtc=!1;this.tye=this.kJe=this.i8g=null;this.dfd=this.My=this.Wtd="";this.application=this.Qy=0;this.hEo=this.ahg=!1;this.FZo=b&&w.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");w.AFrameworkApplication.va.w_(Ua.a.jNb)||w.AFrameworkApplication.va.qa(Ua.a.jNb,
Kd.a.frame,Object(z.a)(this,this.k7n,"retryOpenInClientAction"));this.Dsj=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("SilentExternalHandler")}get jYi(){return this.Qy}Wmo(b,h="",v=""){this.My=v||sb.a.create().toString();this.Wtd=h||zM.a.Obi();this.dfd=b}k7n(b,h,v){return h.contextId!==Kd.a.frame?2:1===v?32:this.jNb()}get options(){let b=0;w.AFrameworkApplication.j4n&&(b|=1);w.AFrameworkApplication.pYi&&(b|=4);this.aEo()&&(b|=64);return b}aEo(){return!(2===this.application&&w.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get NJc(){return w.AFrameworkApplication.Vs}get URc(){return w.AFrameworkApplication.Pba}get Yoi(){return""}get Tyf(){return""}get gEo(){return w.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get QHo(){return this.i8g||
(this.i8g=Ga.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.ahg||this.Uwl()}ohc(){this.hEo||this.xXh()}z6i(b){return this.FZo&&aa.a.ui?(new IJ(this),32):this.qGh(b)}qGh(b){const h=({Wpb:b}=this.hXm(b)).returnValue;u.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}begin(b,h,v,D,Q,ba,ta=""){this.Upc=b;this.tye=ta;this.$rc=h;this.nXa=ba;this.application=v;this.Qy=D;return w.AFrameworkApplication.HTh?(this.FEi(),32):w.AFrameworkApplication.Woa&&
!w.AFrameworkApplication.Cni?(w.AFrameworkApplication.ueg(),8):this.Ovh(Q)}get Xin(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}jNb(){this.Xin&&this.K0m();return this.qGh(this.mtc)}rij(){const b=new LJ.a(L.a.openInClient);b.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();b.Values[WC.a.ONh]=w.AFrameworkApplication.userSessionId;return this.nXa.value.send(b)?32:8}K0m(){wa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new wb.a,{inStaging:!0}))}zdo(b){const h=new LJ.a(L.a.B1o);h.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();h.Values[WC.a.ONh]=w.AFrameworkApplication.userSessionId;h.Values[H.a.A1o]=b;this.nXa.value.send(h)}hXm(b){this.mtc=b;this.zdo(5===this.Qy?fE.Kvn:fE.Qvn);return 5===this.Qy?this.gXm():this.kXm()}gXm(){this.PEi();return{returnValue:32,Wpb:"HostEditUrl,"}}kXm(){let b;var h=b="";w.AFrameworkApplication.Hoh&&(h="|f|"+w.AFrameworkApplication.userSessionId);
const v=w.AFrameworkApplication.K.$("IsAssignmentMode")&&w.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||w.AFrameworkApplication.jWc||aa.a.uQa,D=w.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),Q=w.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(w.AFrameworkApplication.va.e5d){var ba=w.AFrameworkApplication.va.GX(3588168074);ba&&this.Wmo(ba.epochClickTime,ba.sessionOrigin,ba.correlationId);this.FJi()}if(w.AFrameworkApplication.$1i){b+="NewOrder,";
ba=8;this.nXa&&this.nXa.value&&this.nXa.value.isEnabled()&&w.AFrameworkApplication.UQb&&(b+="Post,",ba=this.rij());if(32===ba)return{returnValue:ba,Wpb:b};u.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return w.AFrameworkApplication.us.l9?(u.ULS.shipAssertTag(5566816,211,!!w.AFrameworkApplication.us.l9),b+="HostUrl,",{returnValue:w.AFrameworkApplication.ta.HU(!0,w.AFrameworkApplication.us.l9),Wpb:b}):this.Upc?(u.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
w.AFrameworkApplication.userSessionId),b+="DocUrl,",jH.$Th(this.Upc,this.Qy,this.options,this.application,Object(z.a)(this,this.HTi,"onEditInClientSuccess"),Object(z.a)(this,this.GTi,"onEditInClientFailure"),this.Dsj,w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,v,D,Q,this.Wtd,this.My,this.dfd,w.AFrameworkApplication.va.e5d,this.tye),{returnValue:32,Wpb:b}):{returnValue:8,Wpb:b}}b+="OldOrder,";if(!this.Upc&&w.AFrameworkApplication.us.l9)return this.nXa&&this.nXa.value&&this.nXa.value.isEnabled()&&
w.AFrameworkApplication.UQb?(b+="Post,",h=this.rij()):(u.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(u.ULS.shipAssertTag(22595484,211,!!w.AFrameworkApplication.us.l9),b+="HostUrl,",{returnValue:w.AFrameworkApplication.ta.HU(!0,w.AFrameworkApplication.us.l9),Wpb:b}):{returnValue:h,Wpb:b};u.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId);b+="DocUrl,";jH.$Th(this.Upc,
this.Qy,this.options,this.application,Object(z.a)(this,this.HTi,"onEditInClientSuccess"),Object(z.a)(this,this.GTi,"onEditInClientFailure"),this.Dsj,w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,v,D,Q,this.Wtd,this.My,this.dfd,w.AFrameworkApplication.va.e5d,this.tye);return{returnValue:32,Wpb:b}}o3n(b){w.AFrameworkApplication.Rm.setDw(8981,b)}HTi(b){this.o3n(b);u.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.gEo||this.PEi(),
this.FJi()):this.ahg||this.closeApplication()}GTi(b,h=0){u.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const v=!!this.$rc&&!this.mtc;let D=0;1===b&&(D=2);6<=b&&13>=b&&(D=1,1===h&&(this.ahg=!0));this.QHo.Hin?(u.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",D),GJ.a.instance.vbl(this.mtc?Object(z.a)(this,this.MRi,"oicErrorDialogHandlerCloseForced"):
Object(z.a)(this,this.NRi,"oicErrorDialogHandlerNoCloseForced"),v?Object(z.a)(this,this.GUi,"onLaunchDownload"):null,this.wRh(!1)?Object(z.a)(this,this.Ctm,"iHaveOfficeButtonHandler"):null,D,h)):(u.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",D),GJ.a.instance.tbl(this.mtc?Object(z.a)(this,this.MRi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.NRi,"oicErrorDialogHandlerNoCloseForced"),v?Object(z.a)(this,this.GUi,"onLaunchDownload"):null,D))}}FJi(){try{const b=
[Object.assign(new pa.a,{name:"CorrelationId",string:this.My}),Object.assign(new pa.a,{name:"SessionOrigin",string:this.Wtd}),Object.assign(new pa.a,{name:"ClickTime",string:this.dfd}),Object.assign(new pa.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Qe.a("OpenInClientCompleted",!0,0,b)}catch(b){u.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}PEi(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.lF&&w.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new yG(this):new JJ(this)}MRi(){this.closeApplication()}NRi(){this.ohc()}GUi(){this.FEi()}Ctm(){return this.wRh(!0)}wRh(b){const h=(aa.a.uUc||aa.a.du)&&!!w.AFrameworkApplication.zId;h&&b&&(Id.a.om(w.AFrameworkApplication.zId,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}fE.Qvn="OpenInDesktop";fE.Kvn="OpenInBrowser";Object(n.a)(fE,"AOpenInClientOperation",null,[]);class kH extends fE{constructor(b,h,v=!1){super(v);this.d6j=b;this.c6j=h}get Yoi(){return this.c6j}get Tyf(){return this.d6j}Uwl(){w.AFrameworkApplication.va.Qb(Ua.a.close,
2,lh.a)}xXh(){}Ovh(b){return this.z6i(b)}FEi(){u.ULS.shipAssertTag(5566817,211,!!this.$rc);w.AFrameworkApplication.$ba?w.AFrameworkApplication.ta.HU(!0,this.$rc):Id.a.om(this.$rc,void 0,void 0,"LaunchDownload")}jQc(){w.AFrameworkApplication.ta.Nb.jQc()}}Object(n.a)(kH,"OpenInClientOperation",fE,[]);class MJ extends kH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.GXn=b=>{u.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Ya.App.lV.forceOutbound(this.AYi,
this.h0m,b)};this.h0m=b=>{u.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new pg.StandardDialog;h.Ad=0;h.mx(Nl.a.bQo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.f0m:this.g0m)};this.f0m=()=>{w.AFrameworkApplication.va.Qb(Ua.a.close,2,lh.c)};this.g0m=()=>{Ya.App.xa.refreshDocument(null)};this.AYi=b=>{w.AFrameworkApplication.z9c=!0;u.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.z6i(b)}}qJk(b){Ya.App.Tj.s4a.T9b||Ya.App.qd.ZB.Ao?(u.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.AYi(b)):Lv.a.LQ(4,!0,this.GXn,null,b)}Ovh(b){this.qJk(b);return 32}xXh(){Ya.App.xa.refreshDocument(null)}}Object(n.a)(MJ,"OpenInWordOperation",kH,[]);const NJ=(b,h)=>{u.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[Ff.a.On]=bi.PageReader.instance.kv(h);bi.PageReader.instance.kv(h)?b[Ff.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:
b[Ff.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},AM=(b,h,v,D,Q)=>{if(!Ya.App.xa||!Ya.App.xa.hb||!w.AFrameworkApplication.wn.$gb)return 8;h=Ya.App.xa.hb.Uc;if(!h)return 8;if(b===Eb.a.vae&&2===v){b=new ah.GraphTransaction(15);try{b.Cb(h),bi.PageReader.instance.HJo(h)}finally{b&&b.dispose()}NJ(Q,h)}return 32},BM=(b,h,v,D,Q)=>{if(!Ya.App.xa||!Ya.App.xa.hb)return 8;b=Ya.App.xa.hb.Uc;if(!b)return 8;Q[Ff.a.Alt]=w.AFrameworkApplication.wn.$gb?"":CommonUIStrings.l_ProtectDocumentToolTip;
NJ(Q,b);return 32};class OJ extends DJ.a{constructor(b,h){super(b,h);this.q1g=!1;this.lVi=(v,D,Q,ba,ta)=>{var Ta;if(D.contextId!==Kd.a.frame)return 2;if(!(Ya.App.vGc||w.AFrameworkApplication.us.l9||w.AFrameworkApplication.UQb||this.q1g))return u.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.q1g=!0,8;if(1===Q)return ac.SessionStatusManager.instance.Aj?8:32;let ob=!1;void 0!==ta&&null!==ta&&(ob=ta);if(null===(Ta=w.AFrameworkApplication.K)||void 0===Ta?0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",
!1))(new FJ).u8d().then(()=>this.OKb(v,ob));else return this.OKb(v,ob);return 32};this.zmc=(v,D,Q)=>{2==Q&&(Qe.a("OpenFileFromPC"),Ya.App.Jgb(w.AFrameworkApplication.breadcrumbBrandUrl));return 32};this.Yol=v=>{this.z1m();if(!w.AFrameworkApplication.jWc&&w.AFrameworkApplication.ta.Nb.Fcg(Ua.a.downloadACopy.toString()))this.yya(!0,L.a.download,!0,{});else if(w.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let D=w.AFrameworkApplication.nCb;v&&v.FileDownloadUrl&&(D=v.FileDownloadUrl.toString());
new EJ(D)}else super.downloadACopy(0,null,2,null,null)};this.ARk=v=>{super.workflow(0,null,2,null,v)};this.DI=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback")}Tb(){super.Tb();this.ga.qa(Eb.a.openInClient,Kd.a.frame,this.lVi);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Vc(Eb.a.openInClient,12288);var b=this.ga;b.fb(Eb.a.vae,Zb.a.application,AM,4);b.fb(Eb.a.O1f,Zb.a.application,BM,96);this.ga.qa(Ua.a.CWf,
Kd.a.frame,this.lVi);this.ga.qa(Eb.a.zmc,Zb.a.view,this.zmc)}OKb(b,h){u.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new MJ).begin(Ya.App.vGc,w.AFrameworkApplication.nCb,uG.Word,b===Ua.a.CWf?GF.OpenInBrowser:GF.WriteOnly,h,new Fg.a(()=>this.PX))}lBd(b){return Ti.a.instance.KCa()?!0:Ya.App.xa.Nfj(1,pc.AppFrame.zZk,b)}downloadACopy(b,h,v,D,Q){if(2===v){if(!w.AFrameworkApplication.nCb&&!w.AFrameworkApplication.ta.Nb.Fcg(Ua.a.downloadACopy.toString()))return 8;
Lv.a.LQ(2,!0,this.Yol,null,Q);this.cqe();return 32}return super.downloadACopy(b,h,v,D,Q)}cqe(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.DI&&(u.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.DI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}z1m(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=
this.DI&&this.DI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,v,D,Q){return 2===v?(Lv.a.LQ(13,!0,this.ARk,null,Q),32):super.workflow(b,h,v,D,Q)}}Object(n.a)(OJ,"AppFrameCommandUIActor",DJ.a,[]);class PJ extends pg.StandardDialog{constructor(){super();this.Ad=0;this.llb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
null,null)}}Object(n.a)(PJ,"WheresTheSaveButtonDialog",pg.StandardDialog,[]);const CM=(b,h,v)=>{if(1===v)return 32;new PJ;return 32};var lH=c(539),QJ=c(1372);class bt extends Jp.a{constructor(b,h,v,D,Q,ba,ta=null){var Ta,ob;super();this.Ccc=ta;this.gXj=50;this.hXj=56;this.Yyc="px";this.Rse="aria-label";this.jJa="BookmarkIndicator";this.$Xg="HighlightBookmarkedContent";this.k5j="HighlightBookmark";this.TVa="wwaengidc";this.CKk="Bookmark_24";this.eb=b;this.ig=v;this.qk=h;this.YV=D;this.Tz=Q;this.lXj=
null===(Ta=w.AFrameworkApplication.K)||void 0===Ta?void 0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.cXj=null===(ob=w.AFrameworkApplication.K)||void 0===ob?void 0:ob.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.Tz&&this.Tz.rzd(this.LB.bind(this));this.vI=ba}$po(b){if(b.Cj){for(const h of b.Qg.Qi)if(this.epj(h))return!0;return!1}return this.epj(b.htmlElement)}Hob(b){let h=!1;w.AFrameworkApplication.te("bookmarks-core-ex;bookmarks-core-ex-cf");
this.lXj&&wr.a.instance.he(()=>{h=this.$po(b)},"BIA:SCIVE");return h}epj(b){return bt.TRe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}bfb(b){const h=[];wr.a.instance.he(()=>{const v=b.geb(0,this.vI?this.hXj:this.gXj,this.zoom);h.push(this.gDa(b.M4,v,b.$mc[0].y-b.Vba[0].y))},"BIA:CIs");return h}gDa(b,h,v){const D=b.fh.ownerDocument,Q=Xn.a.createElement(D,Rn.a.div);Q.className=this.vI?bt.kXj:bt.Fte;bt.Fte;Q.style.left=h+this.Yyc;
Q.style.top=v+this.Yyc;this.vI?(h=Xn.a.createElement(D,Rn.a.div),Lh.a("renderIcon")&&appChrome.api.renderIcon(this.CKk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=Xn.a.createElement(D,Rn.a.b2a),h.src=zj.a.vg(bt.Bed),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.Rse,"Bookmark");Q.appendChild(h);b={context:new rG([],Q,new Set,new Set,null,null),NRf:b,container:Q};this.vI||(this.qk.mb(Sc.a.rR,h,this.onMouseEnter),this.qk.mb(Sc.a.hL,h,this.npa));this.ig.eE(Sc.a.click,
Q,this.hGa.bind(this),b);return Q}ADd(){const b=Object.assign(new Gi.a,{action:1,type:5,xA:null,JJ:this.Vda});this.Vda=null;this.YV.yF(b)}LB(b,h){this.Vda&&(h.h0a.zf.classList.contains("BookmarkHighlightSelected")||this.ADd())}onMouseEnter(b){if(null==b)return!1;b=b.zf;b.parentElement.classList.add(bt.vMg);b.src=zj.a.vg(bt.eXj);return!0}npa(b){if(null==b)return!1;b=b.zf;b.parentElement.classList.remove(bt.vMg);b.src=zj.a.vg(bt.Bed);return!0}hGa(b){this.t5a(this.$Xg,this.k5j);if(null==b){var h=new Map;
h.set("Source",this.jJa);h=Object.assign(new wb.a,{additionalValues:h});wa.Health.instance.recordKpiFailure(this.$Xg,"Unable to highlight bookmarked content",!1,!0,h);return!1}w.AFrameworkApplication.te("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.cXj){h=b.Ro.context;if(bt.l3a(h,this.Vda))return!0;h=this.rqf(b.Ro.NRf,h,b.Ro.container);b=Object.assign(new Gi.a,{action:0,type:5,xA:h,JJ:this.Vda});this.Vda=h;this.YV.yF(b);return!0}return!1}rqf(b,h,v){h={ywh:new Set,WKb:new Set,Bwh:null,
v3e:null};const D=this.eb.ow(b.Bb,!0,!1),Q=[];if(D)for(const ba of D)Q.push(ba);this.jtk(b,h,Q);h=new rG(Q,v,h.ywh,h.WKb,h.Bwh,h.v3e);this.Vda&&this.Vda.Vr===Q&&(v.className+=String.format(" {0}",bt.fXj),this.Vda=h);return h}jtk(b,h,v){if(b.Cj){const Q=new Set;for(const ba of b.Qg.Qi)ba.querySelectorAll("*").forEach(Q.add,Q);b=Array.from(Q.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let D=[];h.WKb.add(v[0].id);h.Bwh=v[0].id;h.v3e=v[0].id;b.forEach(Q=>{const ba=
ei.a.Db(Q,$l.a.zBd);if(ba)for(const ta of ba)D.push(ta),h.ywh.add(ta);if(!D.length)return!0;Q=ei.a.Db(Q,$l.a.Mzb);if(!Q)return!0;D=QJ.a.Ugc(D,Q)});for(b=this.eb.jg(v[v.length-1],!1,!0);D.length&&b;)h.WKb.add(b.id),h.v3e=b.id,v.push(b),this.Ccc.value.Gj(b).htmlElement.querySelectorAll("."+$l.a.u3e).forEach(Q=>{(Q=ei.a.Db(Q,$l.a.Mzb))&&(D=QJ.a.Ugc(D,Q))}),b=this.eb.jg(b,!1,!0)}t5a(b,h){const v=new Map;v.set("Source",this.jJa);v.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.TVa,v)}static l3a(b,
h){return!!h&&!!b&&b.wwh===h.wwh}}bt.vMg="WordBookmarkIndicatorContainerHovered";bt.fXj="WordBookmarkIndicatorContainerSelected";bt.Bed="BookmarkDefault.png";bt.eXj="BookmarkHover.png";bt.TRe=!0;bt.Fte="WordBookmarkIndicatorContainer";bt.kXj="WordBookmarkSvgIndicatorContainer";Object(n.a)(bt,"BookmarkIndicatorActor",Jp.a,[712]);class RJ{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb=null,Vb=null,bc=null,Dc=null,Oc=null,gd=null,rd=null){this.n2="_";this.hte="Bookmark";this.EWj=/^BOOKMARK\d+$/i;this.jJa="BookmarkRibbonOptions";
this.aXj="BookmarkFloatieOptions";this.bQg="CreateBookmarkOnRange";this.cQg="CreateBookmarkOnView";this.aQg="CreateBookmarkOnIP";this.zwe="CreateBookmark";this.TVa="wwaengidc";this.Ofh="ShowHideBookmarksOnDocument";this.mRg="DeleteBookmark";this.$_j="DeleteBookmarkAction";this.mjk="ShowHideBookmarks";this.Nfh="ShowBookmarksFloatie";this.jjk="ShowBookmarksFloatieAction";this.RSg="EditBookmark";this.Z0j="EditBookmarkAction";this.z3e="BookmarksUsage";this.GKk="InsertTabSwitchActivity";this.YBm="Insert";
this.XRb=b;this.ga=h;this.ib=v;this.qn=D;this.vx=Q;this.B6=ba;this.Gc=ta;this.HL=Ta;this.Ip=Vb;this.uMg=ob;this.Ie=Kb;this.k6=Oc;this.Kn=bc;this.fd=Dc;this.gS=gd;this.Ik=rd}get hx(){return this.vx.value}Tb(){this.CBf()&&(this.ga.qa(sc.a.ENa,Zb.a.view,this.ENa.bind(this)),this.ga.fb(Ua.a.ETa,Zb.a.application,this.jMo.bind(this),96),this.ga.qa(sc.a.ENa,Zb.a.Hd,this.A8k.bind(this)),this.ga.qa(sc.a.ENa,Zb.a.Tc,this.z8k.bind(this)),this.ga.qa(sc.a.deleteBookmark,Zb.a.view,this.deleteBookmark.bind(this)),
this.ga.qa(sc.a.ngf,Zb.a.view,this.Hrl.bind(this)),this.ga.fb(sc.a.Mqj,Zb.a.view,this.qvo.bind(this),1028),this.ga.fb(sc.a.Bae,Zb.a.application,this.Bae.bind(this),96),this.ga.fb(sc.a.cie,Zb.a.Tc,this.cie.bind(this),1028),this.ga.fb(Eb.a.P0d,Zb.a.view,this.P0d.bind(this),1028),this.ga.fb(sc.a.dVd,Zb.a.view,this.dVd.bind(this),1028),this.ga.Vc(sc.a.ENa,1028))}jMo(b,h,v,D,Q){return Q&&Q.NewContextId===this.YBm?(this.i2d(this.GKk),32):2}ENa(b,h,v,D,Q){var ba,ta;b=this.ib.tg;if(!b||b.contextId===Zb.a.anchoredObject)return 2;
if(1===v)return sj.a.kha(h)||(null===(ba=this.Ik)||void 0===ba?0:ba.j_(b))||(null===(ta=this.Ik)||void 0===ta?0:ta.nha(b))?8:32;h=this.ib.gb.kb;if(!h||this.Ie.km(h))return 2;this.cYc(Q,"User is trying to create bookmark from UILocation : {0}");this.t5a(this.cQg,this.zwe);if(h&&this.qn.oYe(this.HOa(),h))return this.i2d(this.z3e),32;Q=new Map;Q.set("Source",this.jJa);Q=Object.assign(new wb.a,{additionalValues:Q});wa.Health.instance.recordKpiFailure(this.cQg,"Unable to create bookmark",!1,!0,Q);return 8}A8k(b,
h,v,D,Q){if(1===v)return 32;if(Zb.a.Hd!==h.contextId)return 8;this.cYc(Q,"User is trying to create bookmark from UILocation : {0}");b=this.ib.gb.kb;if(!b)return 2;this.t5a(this.bQg,this.zwe);if(this.qn.oYe(this.HOa(),b))return this.i2d(this.z3e),32;b=new Map;b.set("Source",this.jJa);b=Object.assign(new wb.a,{additionalValues:b});wa.Health.instance.recordKpiFailure(this.bQg,"Unable to create bookmark for range",!1,!0,b);return 8}z8k(b,h,v,D,Q){if(1===v)return 32;if(Zb.a.Tc!==h.contextId)return 8;this.cYc(Q,
"User is trying to create bookmark from UILocation : {0}");b=this.ib.gb.kb;if(!b)return 2;this.Ie.km(b)&&(h=b.Oa,this.Ie.ckb(h)?(b=this.Ie.F3(h,!1),b||(u.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Ie.F3(h,!0))):u.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.t5a(this.aQg,this.zwe);if(this.qn.oYe(this.HOa(),b))return this.i2d(this.z3e),32;b=new Map;b.set("Source",this.jJa);b=Object.assign(new wb.a,
{additionalValues:b});wa.Health.instance.recordKpiFailure(this.aQg,"Unable to create bookmark for IP",!1,!0,b);return 8}Bae(b,h,v,D,Q){1===v&&32;Q[Ff.a.On]=bt.TRe;return 32}qvo(b,h,v,D,Q){if(1===v)return 32;this.t5a(this.Ofh,this.mjk);(b=Q[Ff.a.On])||u.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");bt.TRe=b;b=Rl.PageNavigator.instance.MO(this.hx);if(null!==b)return this.l3c(b),this.XRb.WG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.jJa);b=
Object.assign(new wb.a,{additionalValues:b});wa.Health.instance.recordKpiFailure(this.Ofh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,v,D,Q){if(this.CBf()){b=this.ib.gb.kb;if(!b)return 2;b=b.Oa;b=this.qn.POd(b.node,b.cpBegin);if(1===v)return b?32:8;this.cYc(Q,"User is trying to delete bookmark from UILocation : {0}");this.HL.X_&&(u.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.HL.Xw());this.t5a(this.mRg,this.$_j);b||u.ULS.sendTraceTag(545118156,
3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.qn.t9i(b.id))return this.uMg&&this.uMg.ADd(),32;v=new Map;v.set("Source",this.jJa);v=Object.assign(new wb.a,{additionalValues:v});wa.Health.instance.recordKpiFailure(this.mRg,"Unable to delete bookmark",!1,!0,v);return 8}return 2}Hrl(b,h,v,D,Q){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.ib.gb.kb;if(!b)return 2;
b=b.Oa;b=this.qn.POd(b.node,b.cpBegin);if(1===v)return b?32:8;this.cYc(Q,"User is trying to edit bookmark from UILocation : {0}");this.HL.X_&&(u.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.HL.Xw());this.t5a(this.RSg,this.Z0j);b||u.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.k6.value.Irl(h,b,this.qn),32;h=new Map;h.set("Source",this.jJa);h=Object.assign(new wb.a,{additionalValues:h});wa.Health.instance.recordKpiFailure(this.RSg,
"Unable to edit bookmark",!1,!0,h);return 8}return 2}cYc(b,h){b&&b.UILocation&&u.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}cie(b,h,v,D,Q){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===v&&32;this.t5a(this.Nfh,this.jjk);if(h.contextId===Zb.a.Tc)return b=Array(1),b.push("Bookmarks"),this.HL.showFloatie(Q.location,b,1),32;Q=new Map;Q.set("Source",this.aXj);Q=Object.assign(new wb.a,{additionalValues:Q});wa.Health.instance.recordKpiFailure(this.Nfh,
"Unable to show bookmark floatie",!1,!0,Q);return 8}return 2}P0d(b,h,v,D,Q){let ba;return 1===v?(wr.a.instance.he(()=>{ba=this.ga.Of(h,Eb.a.insertHyperlink,v,!0,D,Q);32!==ba&&(ba=this.ga.Of(h,sc.a.ENa,v,!0,D,Q))},"BA:LFE"),ba):8}dVd(b,h,v){var D;if(1===v)return 32;if(b=this.ib.gb.kb){b=b.Oa.node;if(h=this.VXh(b))return h.click(),32;u.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.qn.POd(b,0)){b=this.gS.Wdb.get(null===(D=b.id)||void 0===D?void 0:D.toString());
D=Rl.PageNavigator.instance.MO(this.hx).Jc.Db(b);if(D=this.VXh(D))return D.click(),32;u.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else u.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}VXh(b){let h;b=this.Kn.Gl(b).Gj(this.fd.Bd.ic);b.Bjb&&(b=b.htmlElement.querySelectorAll("div."+bt.Fte),0<b.length&&(h=b[0]));return h}l3c(b){const h=lH.b(b);if(h){var v=this.Gc.Oc(2);try{for(v.Cb(b);h.moveNext();){if(!de.ParagraphReader.sh(h.iterator))continue;
const D=h.currentNode;this.Fql(D)&&this.B6.r$b(D,!0)}}finally{v&&v.dispose()}}}Fql(b){for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(null!=D.Gh)for(let Q=0;Q<D.Gh.length;Q++){var h=D.Gh.J(Q);if(null!=h&&(h=b.Jc.Db(h.kn).ia(lc.a.rt,""),!G.a.jf(h)&&!h.startsWith(this.n2)))return!0}}}HOa(){var b=this.qn.wNd(!1);const h=[];for(let v=0;v<b.count;v++){const D=b.J(v).ia(lc.a.rt,"");this.EWj.test(D)&&h.push(D)}return 0<h.length?(h.sort((v,D)=>v.localeCompare(D,void 0,{numeric:!0})),b=parseInt(h[h.length-
1].substring(this.hte.length)),this.hte+(b+1)):this.hte+1}t5a(b,h){const v=new Map;v.set("Source",this.jJa);v.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.TVa,v)}i2d(b){this.CBf()&&this.Ip&&this.Ip.execute(h=>{h.logActivity(b,null)})}CBf(){w.AFrameworkApplication.te("bookmarks-core-ex;bookmarks-core-ex-cf");return w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(n.a)(RJ,"BookmarkActor",null,[]);class SJ{constructor(b,
h,v){this.oc=b;this.Tll=h;this.Tf=v;this.e8e=this.e8e.bind(this)}Tb(){this.oc.qa(sc.a.rIf,Zb.a.view,this.e8e)}e8e(b,h,v,D,Q){return 1===v?32:(b=this.Tf.s8(h.$j))?(Q=3===Q.Ix,this.Tll.value.lKh(this.V8l(b),this.Hhm(b),Q),32):2}V8l(b){const h=new fh.DictionaryPropertySet;h.setValue(qe.a.NE,this.Tf.Yg(b));h.setValue(qe.a.eG,this.Tf.yga(b));h.setValue(qe.a.pma,this.Tf.jhb(b));h.setValue(qe.a.separator,this.Tf.MRd(b));return h}Hhm(b){const h=new fh.DictionaryPropertySet;h.setValue(lc.a.marginLeft,this.Tf.mJ(b));
h.setValue(lc.a.marginRight,this.Tf.ZK(b));h.setValue(lc.a.Bo,this.Tf.$t(b));return h}}Object(n.a)(SJ,"ColumnsDialogActor",null,[]);class TJ{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){this.Wo=b;this.I$=h;this.Be=v;this.jr=D;this.Zl=Q;this.Kd=ba;this.Gc=ta;this.ve=Ta;this.ga=ob;this.H7j=Kb;this.IZj=Vb}get oCf(){return this.H7j}Tb(){this.ga.fb(Eb.a.f8c,Zb.a.view,this.vAm.bind(this),96);this.ga.fb(Eb.a.V3c,Zb.a.view,this.V3c.bind(this),4);this.ga.fb(Eb.a.yAd,Zb.a.view,this.yAd.bind(this),1028)}yAd(b,h,
v,D,Q){if(!Di.a.C9e)return 8;b=Q.FormattingActionId;Q=Q.FormattingActionData;if(!h.view||!h.view.qe)return 2;h=h.view;if(!(b&&Q&&h.lb&&h.lb.gb.kb))return 8;h=this.Zl.j6h(h.lb.gb.kb.toArray());for(const ba of h){h=ba.ia(lc.a.Tw,0);v=this.Wo.getById(h);if(!v)return u.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.IZj.hTo(v,b,Q))return u.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}vAm(b,h,v,D,
Q){h=this.Wo.getById(Q);if(!h)return 8;v=h.contentControlNode;if(!v)return 8;if(v.ia(lc.a.I7,!1))return 2;D=this.Wo.TQl(h);if(!D)return 8;Q=this.Gc.Oc(7);Q.Cb(D.node);if(!this.oCf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Kd.replaceTextRange(D,b),Di.a.dkb?this.Zl.$0b(h,!0):this.$0b(h),v.setValue(lc.a.I7,!0),Q.dispose(),32;const ba=new fh.DictionaryPropertySet;ba.setValue(wc.a.Jji,D);var ta=v.ia(lc.a.c_a,"");ta=this.I$.Rii(ta);if(!ta)return this.jr.replaceTextRange(D,
WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Di.a.pr?b:void 0),Di.a.dkb?this.Zl.$0b(h,!0):this.$0b(h),v.setValue(lc.a.I7,!0),Q.dispose(),32;ba.setValue(wc.a.Ivf,ta);if(1<ta.length&&!h.Kf)return Q.dispose(),8;this.a7k(ba);v.setValue(lc.a.I7,!0);Q.dispose();return 32}V3c(b,h,v){b=h.view.qe?h.view:null;if(!b||!b.lb)return 8;const [D,Q]=this.bbm(b.lb.gb);if(0===D.length)return 8;if(1===v){for(var ba of D){var ta=Q.get(ba.parentId);if(this.Rui(ba,ta))return 32}return 8}if(2===v){v=this.Ayo(D,
Q);ba=this.Gc.Oc(15);ba.Cb(b.Yc);for(ta of v)v=Q.get(ta.parentId),this.Rui(ta,v)&&this.Wo.HMb(ta.id);ba.dispose();return 32}return 2}bbm(b){var h,v,D=[];for(const ba of b)D.push(...(null!==(h=this.Zl.tna(ba.Oa,ba.Pc,1))&&void 0!==h?h:[]));if(0===D.length)return[D,new Map];h=[];for(const ba of b)h.push(...(null!==(v=this.Zl.tna(ba.Oa,ba.Pc,3))&&void 0!==v?v:[]));b=new Map(D.map(ba=>[ba.id,ba]));if(0===h.length)return[D,b];const Q=new Map(h.map(ba=>[ba.id,ba]));D=D.filter(ba=>!Q.has(ba.id));b=new Map([...b,
...Q]);return 0==D.length?[[h[0]],b]:[D,b]}$0b(b){const h=this.jr.OOc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.ve.MC(b.start.node).Pi(Xs.a.cZf))this.Be.Bfa(h.formatting),this.Be.D6a(h.formatting,b)}else u.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}a7k(b){this.ga.Qb(Eb.a.showPlaceholderGlossary,2,b)}Rui(b,h){return b.fha&&b.ZPm&&(!h||h.isEditable)}Ayo(b,h){const v=(D,Q)=>null==D||null==Q||D.id===Q.id?!1:D.id===Q.parentId||v(h.get(D.parentId),
Q);return b.slice().sort((D,Q)=>v(D,Q)?1:v(Q,D)?-1:0)}}Object(n.a)(TJ,"ContentControlActor",null,[]);class IF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.mzk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.XIo="Interested in this feature?"}Tb(){this.ga.qa(sc.a.ocf,Zb.a.view,this.ODm.bind(this))}ODm(b,
h,v){2===v&&(Object(Qe.c)(sc.a.ocf),b=new pg.StandardDialog,b.Ad=4,b.Ee(1,this.primaryButtonText),b.Ee(2,this.secondaryButtonText),b.qDc(this.mzk,null),b.Ju(this.XIo,null,0,this.jba));return 32}jba(b){1===b&&(Object(Qe.a)("CountMeIn_CustomizeRibbon",!0),G.a.yU(IF.KHj)&&Id.a.om(IF.KHj))}}IF.KHj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(n.a)(IF,"CustomizeRibbonActor",null,[]);var kB=c(1070);class mH extends Vf.a{constructor(b,h,v){super(!1,!1,!0);
this.o4g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,kB.a.e0e,kB.a.d0e,kB.a.f0e];this.SVj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,kB.a.EAk,kB.a.DAk,kB.a.GAk];this.OKg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Cjc=()=>{new mH(this.ga,this.PTe,this.lrc)};this.PZl=()=>{const D=[];for(const Q of this.PTe)D.push(this.B5(Q));return D};this.HXo=D=>{const Q=new Set;this.Ura="";for(const ba of D)if(""!==
ba.position){const ta=this.Sbi(ba.position);if(0>ta||22<ta){this.Ura=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(Q.has(ta)){this.Ura=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.lJo(ba)),Q.add(ta)}else{this.Ura=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Ura&&(this._tabStops=[],this.PTe=D)};this.egl=(D,Q)=>{try{if(1===D){if(""!==this.Ura)throw Error.create(this.Ura);Q.DefaultTabStop&&(this.lrc=
kB.a.v8f(Q.DefaultTabStop),this.Z_o(this.lrc));if(32!==this.ga.Qb(sc.a.CQb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Nf.a.Hv(this.lrc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ba){this.tHa(ba.message,this.Cjc)}};this.ga=b;this.PTe=h;this._tabStops=[];this.lrc=v;this.Ura="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.GDb()};this.Yh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.egl,b)}B5(b){return{["position"]:b.position,["alignment"]:b.alignment,
["leader"]:b.leader}}Sbi(b){return Math.floor(100*parseFloat(b))/100}lJo(b){return new fv.a(Nf.a.Hv(this.Sbi(b.position)),kB.a.Pdm(b.alignment),kB.a.Ndm(b.leader),1)}Z_o(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Qb(Eb.a.KGa,2,h)){var v=h.marginLeft;const D=Cf.a.Mi(h.marginRight,0);v=Cf.a.Mi(v,0);h=Cf.a.Mi(h.Bo,0);if(Cf.a.Sba(b,0,!1)>=h-D-v)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}GDb(){return{["getInitState"]:this.PZl,["updateState"]:this.HXo,["validPositions"]:this.jgi(-Infinity,Infinity,"Position"),["validAlignments"]:this.F5h(this.OKg,this.OKg,null,"Alignment"),["validLeaders"]:this.F5h(this.o4g,this.o4g,this.SVj,"Leader"),["defaultTabStopSpinButtonProps"]:this.jgi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.lrc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}jgi(b,
h,v){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:v,["unitType"]:"Inch",["validUnits"]:[nC("Inch",3,b,h,.1)],["numberFormatInfo"]:SG()}}F5h(b,h,v,D){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:D,["options"]:hG(b,h,v)}}}Object(n.a)(mH,"CustomTabDialog",Vf.a,[]);class UJ{constructor(b,h,v){this.Hdc=(D,Q,ba,ta,Ta)=>{if(2!==ba)return 8;if(!Ta)return 16;D=Ta.tabStop;Ta=Ta.value;if(!D)return 16;Qe.c(sc.a.Hdc);Ta=new fv.a(Ta,
D.rda,D.Voa,D.ohg);Q=Q.node;this.eAa.B5a(Q,D);this.eAa.nWd(Q,Ta);return 32};this.H6c=(D,Q,ba,ta,Ta)=>{if(2===ba){if(!Ta)return 16;this.eAa.nWd(Q.node,Ta);return 32}return 8};this.XLb=(D,Q,ba,ta,Ta)=>{D=this.eAa.t6i(Q.node);if(!("customTabs"in Ta))return Ta.customTabs=D,32;Q=Ta.customTabs;if(!Q||0>=Q.length||!D||0>=D.length)return Ta.customTabs=null,32;ba=[];for(const ob of Q)for(const Kb of D)if(Kb.THa===ob.THa&&Kb.ohg===ob.ohg&&Kb.rda===ob.rda){ba.push(ob);break}Ta.customTabs=ba;return 32};this.B5a=
(D,Q,ba,ta,Ta)=>{if(2===ba){if(!Ta)return 16;Qe.c(sc.a.B5a);this.eAa.B5a(Q.node,Ta);return 32}return 8};this.IMb=(D,Q)=>{this.eAa.IMb(Q.node);return 32};this.CQb=(D,Q,ba,ta,Ta)=>{if(2===ba){if(!Ta)return 16;D=Ta.tabStops;ba=Ta.defaultTabStopLength;Q=Q.node;ta=!1;const ob=this.eAa.t2n(Q,D);Ta.defaultTabStopLengthSaved||(ta=this.tK.xgo(Q,ba),Ta.defaultTabStopLengthSaved=!0);ob&&Qe.d(sc.a.CQb,!0,void 0,void 0,void 0,void 0,[Object.assign(new pa.a,{name:"Custom Tab Stops Count",string:D.length.toString()})]);
if(null==ta)return u.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ta&&(this.v4c&&this.v4c.ati(),this.Ld.Ls(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Qe.d(sc.a.CQb,!0,void 0,void 0,void 0,void 0,[Object.assign(new pa.a,{name:"Default Tab Stop Length",string:ba.toString()})]));return 32}return 8};this.Yqj=(D,Q,ba)=>{if(2!==ba)return 8;D={};if(32!==this.ga.Qb(sc.a.xX,2,D))return u.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;Q={};if(32!==this.ga.Qb(Eb.a.KGa,2,Q))return u.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;D=kB.a.v8f(Nf.a.Iz(D.defaultTabStop));ba={};ba.defaultTabStopLength=D;ba.sectionPropertiesData=Q;if(32!==this.ga.Qb(sc.a.Wng,2,ba))return u.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ba.isParagraphValid)return u.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.eAa.tHa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;Q={};if(32!==this.ga.Qb(sc.a.XLb,2,Q))return u.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(Q=Q.customTabs)||(Q=[]);Q=kB.a.Odm(Q);new mH(this.ga,Q,D);Qe.c(sc.a.Cjc,!0);return 32};this.JOm=(D,Q,ba,ta,Ta)=>{if(2!==ba)return 8;if(!Ta)return 16;if(Ta.isParagraphValid)return 32;ba={};if(32!==this.ga.Of(Q,Eb.a.m5a,2,!1,null,ba))return 16;D=Ta.sectionPropertiesData;Q=Ta.defaultTabStopLength;var ob=ba.zt;ta=ob.foa;
ob=1===ob.specialIndentType?ob.zB:ob.zB-ob.mda;const Kb=D.marginLeft,Vb=D.marginRight;ba.isRtl?(ba=Cf.a.Mi(Math.max(Vb,Vb+ta),0),ta=Cf.a.Mi(Math.max(Kb,Kb+ob),0)):(ba=Cf.a.Mi(Math.max(Kb,Kb+ob),0),ta=Cf.a.Mi(Math.max(Vb,Vb+ta),0));D=Cf.a.Mi(D.Bo,0);Q=Cf.a.Sba(Q,0,!1);Ta.isParagraphValid=Q<D-ba-ta;return 32};this.ga=b;this.eAa=h;this.tK=v}get Ld(){return null!=this.XHg?this.XHg:this.XHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get v4c(){return null!=this.HFg?this.HFg:
this.HFg=Ga.a.instance.Na("WordEditor.Actors.RenderParagraphsContainingTabs")}Tb(){const b=v=>vz.OutlineElementGeneralizer.qna(v.gb,!0),h=Ya.App.MTa.YHc(b,!0);this.ga.qa(sc.a.XLb,Zb.a.view,Ya.App.MTa.YHc(b,!1));this.ga.fb(sc.a.XLb,Zb.a.paragraph,this.XLb,96);this.ga.qa(sc.a.B5a,Zb.a.view,h);this.ga.fb(sc.a.B5a,Zb.a.paragraph,this.B5a,96);this.ga.qa(sc.a.IMb,Zb.a.view,h);this.ga.fb(sc.a.IMb,Zb.a.paragraph,this.IMb,96);this.ga.qa(sc.a.H6c,Zb.a.view,h);this.ga.fb(sc.a.H6c,Zb.a.paragraph,this.H6c,96);
this.ga.qa(sc.a.Hdc,Zb.a.view,h);this.ga.fb(sc.a.Hdc,Zb.a.paragraph,this.Hdc,96);this.ga.qa(sc.a.CQb,Zb.a.view,h);this.ga.fb(sc.a.CQb,Zb.a.paragraph,this.CQb,96);this.ga.qa(sc.a.Wng,Zb.a.view,h);this.ga.fb(sc.a.Wng,Zb.a.paragraph,this.JOm,96);this.ga.qa(sc.a.Cjc,Zb.a.view,this.Yqj);this.ga.qa(sc.a.Jri,Zb.a.view,this.Yqj)}}Object(n.a)(UJ,"CustomTabActor",null,[]);var DM=c(118),zG=c(620);class VJ{constructor(b,h,v,D,Q,ba,ta,Ta,ob){this.ga=b;this.Bxd=v;this.oJa=(this.aZb=Q)&&D;this.rn=ba;this.aT=ta;
this.D_j=Ta;this.rx=ob;this.sLg=h;this.sLg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.IKf(!0),this.$Jf(!0)):(this.aZb&&Lh.a("isSharedUXDarkModeOn")?(this.rn.$I=appChrome.api.isSharedUXDarkModeOn(),this.IKf(!0)):this.rn.$I=!1,this.oJa?this.$Jf(!0):this.rn.CTa=!1);w.AFrameworkApplication.dI(()=>{this.eKb()});this.oJa&&Lh.a("dispatch")&&appChrome.api.dispatch(this.Bwj([]))}Tb(){this.oJa&&(this.ga.qa(sc.a.BJo,Zb.a.view,this.sgl.bind(this)),this.ga.qa(sc.a.F7c,
Zb.a.view,this.F7c.bind(this)),this.ga.fb(sc.a.P2c,Zb.a.view,this.P2c.bind(this),96));this.aZb&&(this.ga.qa(sc.a.G7c,Zb.a.view,this.G7c.bind(this)),this.ga.fb(sc.a.nbe,Zb.a.view,this.nbe.bind(this),96))}DDm(b){if(!this.kro(b))return!1;const h=rl.a.instance.Oc(2);try{h.Cb(b.root);const v=ne.GraphIterator.$a(b.root.graphNode),D=jo.a.$p(v);for(;D.moveNext();){const Q=Object(Ka.a)(DM.a,D.currentNode);Q&&Q.rJ(b.ic,20,!0)}}finally{h&&h.dispose()}return!0}kro(b){return b&&b.root&&b.hv?b.Vi||b.wDf||b.Mwi||
b.Sj:!1}m4n(){let b=!1;this.Bxd.forEach(h=>{this.DDm(h)&&(b=!0)});return b}CJo(){u.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.rn.$I?"dark":"light");return this.rn.$I?zG.a.xDc(1):zG.a.F9i(1)}tjg(){const b=this.rn.Qaa;u.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.m4n()||(b?!zG.a.xDc(0):!zG.a.F9i(0)))return!1;this.D_j.hNn(b);return!0}Bwj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.rn.$I));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.Ngi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.rn.CTa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):u.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){u.ULS.sendTraceTag(527282835,3023,10,h)}return b}sgl(){return this.tjg()?
32:8}G7c(b,h,v){if(1===v)return 32;b=this.aT.$f("UserAction","sharedUXDarkModeToggle");if(Lh.a("toggleSharedUXDarkMode"))u.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),Lh.a("isSharedUXDarkModeOn")?this.rn.$I=appChrome.api.isSharedUXDarkModeOn():this.rn.$I=!this.rn.$I,u.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.rn.$I);else return 8;appChrome.getHeaderApi().then(D=>{D.hasOwnProperty("refreshThemeOverride")&&
D.refreshThemeOverride()});this.CJo()||u.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.oJa&&!this.rn.CTa&&(this.tjg()||u.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Ya.App.xa.WG(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.rn.$I));this.oJa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.rn.$I));b.stop();u.ULS.sendTraceTag(555885377,3023,50,"{0}",b.ti);Qe.b(this.rn.$I?"DarkModeOn":"DarkModeOff");return 32}F7c(b,h,v){if(1===v)return 32;b=this.aT.$f("UserAction","sharedUXDarkModeSwitchBackground");u.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.rn.CTa=!this.rn.CTa;if(!this.tjg())return 8;h={};h.DarkModeSwitchBackground=this.rx?"ButtonModel":"ToggleButtonModel";Ya.App.xa.WG(h);b.stop();u.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.ti);u.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.rn.CTa);Qe.b(this.rn.CTa?"DarkCanvasOff":"DarkCanvasOn");return 32}nbe(b,h,v,D,Q){if(1===v)return 32;if(!Q)return 2;Lh.a("isSharedUXDarkModeOn")&&(this.rn.$I=appChrome.api.isSharedUXDarkModeOn());Q&&(Q[Ff.a.On]=this.rn.$I);return 32}P2c(b,h,v,D,Q){if(1===v)return 32;if(!Q)return 2;!this.rx&&Q&&(Q[Ff.a.On]=this.rn.CTa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.rn.$I));
this.oJa&&this.Bwj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.Ngi(!1)));appChrome.api.dispatch(b);return 32}Ngi(b){const h={};this.rn.CTa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}eKb(){this.aZb&&this.IKf(!1);this.oJa&&this.$Jf(!1)}IKf(b){var h;u.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.rn.$I?"dark":"light",this.rn.tDa);b&&this.rn.$I!=(null===(h=this.sLg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&u.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.rn.$I?"dark":"light",this.rn.tDa)}$Jf(b){u.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.rn.Qaa?"dark":"light",this.rn.rgl)}}Object(n.a)(VJ,"DarkModeActor",null,[]);var WJ=c(1588);
class AG{constructor(){this.Height=this.Width=0}static construct(b,h){const v=new AG;v.Width=b;v.Height=h;return v}}Object(n.a)(AG,"ViewportInfo",null,[]);class nH extends jt.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}al(){return 85}static construct(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){const bc=new nH;bc.ContractVersion=b;
bc.DocumentContent=h;bc.EnhancementId=v;bc.World=D;bc.ScalingFactor=Q;bc.DesktopViewportInfo=AG.construct(ba,ta);bc.MobileViewportInfo=AG.construct(Ta,ob);bc.MinParagraphCount=Kb;bc.ContentCulture=Vb;return bc}}Object(n.a)(nH,"SwayPreviewRequest",jt.a,[]);var EM=c(590);class GD{static get Xg(){return Vf.a.qA(Ya.App.instance&&Ya.App.instance.aHf?GD.Wll:GD.Lm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,
GD.y9n,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}GD.y9n=zj.a.vg("progress.gif");GD.Lm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
GD.Wll="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(n.a)(GD,"DigitalPrintDialogHtml",null,[]);class Hx{constructor(b,h,v,D){this.fontFamily=b;this.a5c=h;this.fontWeight=v;this.fontStyle=D}}Object(n.a)(Hx,"FontInfo",null,[]);class ct{constructor(b,h,v,D){this.styleName=b;this.title=h;this.WIo=v;this.krm=D}}Object(n.a)(ct,"StyleVisualInfo",null,[]);class gE extends Vf.a{constructor(b,h,v,D,Q=!0){super();this.v6=this.Pq=this.Gka=this.v2=this.gkd=this.rhh=this.yvd=this.GTe=this.HTe=this.ZSe=this.xZb=this.gMa=this.N2=this.OYb=null;this.uWe=this.$Oe=
!1;this.ajd=null;this.dql=()=>{this.igj(0)};this.cql=(ba,ta)=>{this.igj(ta)};this.EXi=ba=>{this.R$h(ba)===Sys.UI.Key.enter&&(this.KVf(ba),ba.preventDefault(),ba.stopPropagation())};this.XTi=ba=>{((ba=ba.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ba.id||ba.id===ml.a.wdd)||aa.a.At)&&this.gMa&&this.aOb(this.gMa)};this.YTi=ba=>{const ta=this.R$h(ba);ta!==Sys.UI.Key.tab&&ta!==Sys.UI.Key.left&&ta!==Sys.UI.Key.right&&ta!==Sys.UI.Key.up&&ta!==Sys.UI.Key.down||this.eom(ta)||(ba.preventDefault(),
ba.stopPropagation(),this.Dnn(ta))};this.HTf=()=>{this.uWe||(this.uWe=!0,u.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),lf.a.removeHandler(this.N2,Sc.a.scroll,this.HTf))};this.rUf=()=>{u.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.KVf=ba=>{ba.preventDefault();ba.stopPropagation();w.AFrameworkApplication.va.processAction(Eb.a.uRh,2);ba.target?(ba="button"===ba.target.tagName.toLowerCase()?ba.target:ba.target.parentNode)&&ba.id!==this.OYb&&(u.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.OYb,ba.id),this.NBh(ba),this.hMh()):u.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.Bml=ba=>{const ta=(new Date).getTime()-this.IRg;ji.a.instance.rf(fi.a.Dml,ta);ba?this.kdo():(u.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),w.AFrameworkApplication.va.processAction(Eb.a.tRh,2))};
this.ido=()=>{this.Cwo();try{const ba=gE.XSh.Ayl(),ta=nH.construct(2,ba,this.OYb,"VerticalWorld",.3,1366,600,330,280,20,gE.XSh.oTb.name);w.AFrameworkApplication.Ne.tj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Ya.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature),2,EM.b(ta),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.iGn,this.C2i,ta)}catch(ba){u.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ba.message)}};
this.iGn=ba=>{var ta=null;({group:ta}=bk.a.l1(ba.data.we)).returnValue?(ta=ta.Responses[0],ta.Succeeded?(this.I2d(ba.data,fi.a.uEo),this.xeb(),this.amj(this.GTe,ta.PreviewHtml),this.amj(this.yvd,ta.PreviewHtmlMobile)):this.C2i(null)):u.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.C2i=()=>{this.Dwo();this.HTe.style.background="#E6E6E6";this.rhh.style.background="#E6E6E6"};this.Xg=GD.Xg;this.wg="DigitalPrintDialog";u.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.zfk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.UTb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.Ikk=v;this.Wsc=D;this.Ee(1,this.zfk);this.Yh(this.UTb,this.Bml,null);this.bym();this.bDo();this.IRg=(new Date).getTime();Q&&Lv.a.LQ(14,!1,this.dql,this.cql,null);this.nzm();this.Dwm();this.m_m();this.GJf();this.d_m();this.hMh()}get sva(){return this.ajd}igj(b){if(!this.$Oe){const h=
(new Date).getTime()-this.IRg;ji.a.instance.rf(fi.a.Cml,h);b?u.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Uh.a[b])):u.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.vZa.disabled=!1}}bym(){this.xZb=document.getElementById("digitalPrintStatusMessageDiv");this.ZSe=document.getElementById("digitalPrintStatusMessageIconDiv");this.HTe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.GTe=document.getElementById("swayDesktopPreviewHtmlHolder");this.yvd=document.getElementById("swayMobilePreviewHtmlHolder");this.rhh=document.getElementById("swayMobilePreviewWrapperDiv");this.N2=document.getElementById("swayGallery");this.N2.setAttribute("tabindex","0");lf.a.addHandler(this.N2,Sc.a.scroll,this.HTf);this.N2.setAttribute(Ze.a.qh,Ze.a.xuh);this.v2=document.getElementById("digitalPrintLearnMoreLink");this.v2.href="https://go.microsoft.com/fwlink/?linkid=871972";lf.a.addHandler(this.v2,
Sc.a.click,this.rUf);this.Gka=new zb.a;this.gkd=document.getElementById("homeWrapper");this.e5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Wsc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}nzm(){this.Pq=new zb.a;this.Pq.add(new ct("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Pq.add(new ct("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Pq.add(new ct("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Pq.add(new ct("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Pq.add(new ct("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Pq.add(new ct("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Pq.add(new ct("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Pq.add(new ct("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Pq.add(new ct("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Pq.add(new ct("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Pq.add(new ct("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Pq.add(new ct("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Pq.add(new ct("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Pq.add(new ct("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Pq.add(new ct("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Pq.add(new ct("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Pq.add(new ct("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Pq.add(new ct("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Pq.add(new ct("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Pq.add(new ct("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Pq.add(new ct("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Pq.add(new ct("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}Dwm(){this.v6=
new zb.a;this.v6.add(new Hx("universc","universc","normal","normal"));this.v6.add(new Hx("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.v6.add(new Hx("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.v6.add(new Hx("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.v6.add(new Hx("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.v6.add(new Hx("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.v6.add(new Hx("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.v6.add(new Hx("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.v6.add(new Hx("ArialNova","ArialNova","normal","normal"));this.v6.add(new Hx("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.v6.add(new Hx("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.v6.add(new Hx("RockwellNova","RockwellNova","normal","normal"));
this.v6.add(new Hx("SabonNRegLT","SabonNRegLT","normal","normal"));this.v6.add(new Hx("DaytonaThin","DaytonaThin","100","normal"))}m_m(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const v of this.v6)h+=String.format(this.Ikk,v.fontFamily,v.a5c,v.fontWeight,v.fontStyle);b.innerText=h;this.gkd.appendChild(b)}d_m(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
zj.a.vg("SwayPreviewFrame.svg")),v=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",zj.a.vg("SwayPreviewFrameHC.svg"));b.innerText=h+v;aa.a.zq&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.gkd.appendChild(b)}R$h(b){return b?b.keyCode:window.event.keyCode}hide(){this.u4f();super.hide()}u4f(){if(this.N2&&!this.$Oe){for(let b=0;b<this.Gka.count;b++)lf.a.removeHandler(this.Gka.J(b),
Sc.a.click,this.KVf),lf.a.removeHandler(this.Gka.J(b),Sc.a.fi,this.EXi);lf.a.removeHandler(this.N2,Sc.a.fi,this.YTi);lf.a.removeHandler(this.N2,Sc.a.focus,this.XTi);lf.a.removeHandler(this.v2,Sc.a.click,this.rUf);this.uWe||lf.a.removeHandler(this.N2,Sc.a.scroll,this.HTf);this.$Oe=!0}}GJf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",zj.a.oLk());this.gkd.appendChild(b);for(const h of this.Pq)this.CGd(this.N2,h);this.R0(this.N2);
this.NBh(this.N2.firstChild);this.N2.firstChild.focus();lf.a.addHandler(this.N2,Sc.a.fi,this.YTi);lf.a.addHandler(this.N2,Sc.a.focus,this.XTi)}CGd(b,h){const v=document.createElement("button");v.className="swayGalleryItem swayClip136x90 swayImageBorderButton";v.setAttribute(Ze.a.Hdb,Ze.a.fM);v.setAttribute("title",h.title);v.setAttribute(Ze.a.qh,Ze.a.Auh);v.id=h.styleName;b.appendChild(v);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=zj.a.vg("swayPublish.png");b.setAttribute(Ze.a.qh,Ze.a.$y);b.setAttribute("unselectable","on");b.setAttribute(Ze.a.gA,Ze.a.np);b.id=h.styleName+"img";v.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.WIo;b.setAttribute(Ze.a.gA,Ze.a.np);b.setAttribute("unselectable","on");b.setAttribute(Ze.a.qh,Ze.a.$y);v.appendChild(b);const D=document.createElement("label");D.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;D.className=h.krm;D.setAttribute(Ze.a.gA,
Ze.a.np);b.setAttribute("unselectable","on");D.setAttribute(Ze.a.qh,Ze.a.$y);v.appendChild(D);lf.a.addHandler(v,Sc.a.click,this.KVf);lf.a.addHandler(v,Sc.a.fi,this.EXi);this.Gka.add(v)}Dnn(b){const h=this.sva;this.yFl(b,h,!w.AFrameworkApplication.isRtl)||this.AFl(b,h,!w.AFrameworkApplication.isRtl)||this.vFl(b,h)||this.wFl(b,h)}eom(b){return b===Sys.UI.Key.tab?(this.sva&&this.sva!==this.gMa&&(this.sva.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.ajd=this.gMa),!0):!1}yFl(b,
h,v){return b===Sys.UI.Key.right&&v||b===Sys.UI.Key.left&&!v?(b=(b=h.nextSibling)||this.N2.firstChild,this.aOb(b),!0):!1}AFl(b,h,v){return b===Sys.UI.Key.left&&v||b===Sys.UI.Key.right&&!v?(b=(b=h.previousSibling)||this.N2.lastChild,this.aOb(b),!0):!1}vFl(b,h){return b===Sys.UI.Key.down?(b=this.Gka.indexOf(h),h=b+2,h<this.Gka.count?(b=this.Gka.J(h))&&this.aOb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Gka.J(h))&&this.aOb(b)),!0):!1}wFl(b,h){b===Sys.UI.Key.up&&(b=this.Gka.indexOf(h),h=b-2,0<=h?(b=this.Gka.J(h))&&
this.aOb(b):(h=b?20+b-1:this.Gka.count-1,(b=this.Gka.J(h))&&this.aOb(b)))}aOb(b){this.sva&&this.sva.id!==this.gMa.id&&(this.sva.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.ajd=b;this.sva.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.sva.focus()}bDo(){this.vZa.className="WACDialogButtonNormal swayPrintToWebButton";this.vZa.setAttribute("tabindex","0");this.Mz.className="WACDialogButtonNormal swayCancelButton";
this.Mz.setAttribute("tabindex","0");this.vZa.disabled=!0}NBh(b){this.sva&&(this.sva.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.gMa&&(this.gMa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.gMa.setAttribute(Ze.a.Hdb,Ze.a.fM));this.OYb=b.id;this.gMa=b;this.gMa.setAttribute(Ze.a.Hdb,Ze.a.np);this.ajd=b;this.sva.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}hMh(){xb.a.instance.Wb(new of.a(2,
1,50,this.ido))}amj(b,h){b.innerHTML=h}kdo(){u.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.OYb));w.AFrameworkApplication.va.processAction(Eb.a.vRh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Ya.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature,w.AFrameworkApplication.userSessionId,this.OYb);Id.a.openWindow(4,b)}I2d(b,h){ji.a.instance.rf(h,+b.rT-+b.MH)}Dwo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.xeb();this.xZb.innerText=b;this.xZb.style.display="block"}Cwo(){this.xeb();this.ZSe.style.display="block";this.xZb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.xZb.style.display="block"}xeb(){this.HTe.style.background="";this.yvd.style.background="";jc.a.f_(this.GTe);jc.a.f_(this.yvd);this.xZb.style.display="none";this.ZSe.style.display="none"}static get XSh(){return null!=gE.Kxg?gE.Kxg:gE.Kxg=
Ga.a.instance.Na("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(n.a)(gE,"DigitalPrintDialog",Vf.a,[]);class oH{constructor(b,h){this._context=this.Bk=null;this.Oue=0;this.afd=!1;this.mgh=null;this.digitalPrint=(v,D,Q,ba,ta)=>{if(1===Q)return w.AFrameworkApplication.KG?8:32;this.mgh=ta.SourceControlId;if(w.AFrameworkApplication.K.$("IsAnonymousUser"))return u.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.Qob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=D;if(oH.gNm())return u.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.aaf(),32;switch(this.Oue){case 1:u.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.aaf();break;case 2:u.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.Qob(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.afd=!1,this.Bk=(new fo.a).create(),this.Bk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Bk.rL(CommonUIStrings.l_DefaultDialogTitle,this.WVk,null),w.AFrameworkApplication.Ne.tj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Ya.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.YVk,this.XVk,null)}return 32};this.WVk=()=>{this.afd=!0;u.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.YVk=v=>{if(!this.afd){this.Bk.close();var D=null;this.I2d(v.data,fi.a.tEo);({group:D}=bk.a.l1(v.data.we)).returnValue?(v=D.Responses[0],u.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",v.HasLicense,v.Succeeded),v.Succeeded?(this.Oue=v.HasLicense?1:2,2===this.Oue?this.Qob(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.aaf()):this.Qob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(u.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Qob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.XVk=v=>{this.afd||(this.Bk.close(),u.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.I2d(v.data,fi.a.sEo),this.Qob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.k6=h}Tb(){w.AFrameworkApplication.protectFile?u.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")?u.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(Eb.a.digitalPrintToSway,Zb.a.view,this.digitalPrint,4),this.ga.fb(Eb.a.uRh,Zb.a.view,Rc.ActionManager.FQ,4),this.ga.fb(Eb.a.vRh,
Zb.a.view,Rc.ActionManager.FQ,4),this.ga.fb(Eb.a.tRh,Zb.a.view,Rc.ActionManager.FQ,4),this.ga.fb(Ua.a.yId,Zb.a.view,Rc.ActionManager.FQ,4))}aaf(){u.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.mgh);new gE(this._context,this.ga,w.AFrameworkApplication.K.jb("SwayFontDownloadUrlTemplate"),w.AFrameworkApplication.K.jb("FileSource"))}Qob(b){const h=new pg.StandardDialog;h.Ad=0;h.cja(CommonUIStrings.l_DefaultDialogTitle,
b,null)}I2d(b,h){ji.a.instance.rf(h,+b.rT-+b.MH)}static gNm(){return"OneDriveWOPI"===w.AFrameworkApplication.K.jb("FileSource")}}Object(n.a)(oH,"DigitalPrintActor",null,[]);class XJ{constructor(){this.fjh=null}ZJi(){u.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}uCj(b){if(!b)return u.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.SCi(b.errorDetails))return!1;this.fjh=Object(Ka.a)(nq.a,b.errorDetails).typeId;return!0}Jhe(b){return this.SCi(b)?
Object(Ka.a)(nq.a,b).typeId===this.fjh:!1}SCi(b){if(!b)return u.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Ka.a)(nq.a,b);return b?b.token&&b.typeId?!0:(u.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(u.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(n.a)(XJ,"DoNotCheckThisCritiqueTypeStrategy",null,[713]);class YJ extends Vf.a{constructor(b,h,v){super(!1,!1,!0);this.oc=b;this.fna=v;this.N0j="DocumentChoiceGroup";this.gTg="EmbededContent";
this.EYg="HyperLink";this.LHe=v.I9a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.GDb()};this.rXj=this.dyl.bind(this);this.Ee(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Yh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.rXj,b)}GDb(){const b=Array(2);b[0]={["key"]:this.gTg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.EYg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.N0j,["defaultSelectedKey"]:this.LHe?this.gTg:this.EYg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}dyl(b,h){1===b?(this.LHe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?sc.a.nOa:sc.a.tgb,this.oc.processAction(b,2),this.LHe=h.isExternalContentSelected,fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new pa.a,{name:"ActionId",int64:b})]}))),this.fna.$9n(h.isExternalContentSelected)):0===b&&u.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(n.a)(YJ,"ExternalContentDefaultSettingsDialog",Vf.a,[]);class dt{constructor(b,h,v,D,Q){this.HL=Ga.a.instance.resolve("Common.IReactContextualUILauncher");this.Drb=Ff.a.On;this.Ejc=()=>{const ba=Array(1);ba.push("ExternalContent");var ta=Ga.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").UOa();ta=Object.assign(new fB.a,{x:ta.x,y:ta.y});this.HL.showFloatie(ta,ba,1);return 32};this.TFb=()=>{this.HL.X_&&this.HL.Xw();return 32};this.y4i=(ba,ta,Ta,ob,Kb)=>{if(ta="object"===
typeof Kb?Kb:null)ba===sc.a.l1f?(ba=dt.AWa!==sc.a.nOa&&dt.AWa!==sc.a.tgb,ta[this.Drb]=dt.AWa===sc.a.nOa||ba):ba===sc.a.m1f&&(ta[this.Drb]=dt.AWa===sc.a.tgb);return 32};this.MXh=(ba,ta,Ta)=>{1!==Ta&&(ba===sc.a.tgb&&dt.AWa!==sc.a.tgb?(u.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Jm.undo()&&(ta=new Vx.a(1,w.AFrameworkApplication.isRtl),ta.f1c="ExternalContent",dt.sgb.h3c(ta))):ba===sc.a.nOa&&dt.AWa!==sc.a.nOa&&(u.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.ZTg.d6i()),dt.AWa=ba);fa.a.sendTelemetryEvent(Object.assign(new ra.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new pa.a,{name:"behavior",string:Ta.toString()}),Object.assign(new pa.a,{name:"ActionId",int64:ba})]}));return 32};this.ga=b;this.Jm=h;this.ZTg=D;this.d7j=Q;this.qXj=this.eyl.bind(this);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.ZTg.b8i(()=>{this.reset()})}Tb(){this.ga.fb(sc.a.l1f,Zb.a.view,this.y4i,97);this.ga.fb(sc.a.m1f,Zb.a.view,this.y4i,97);this.ga.fb(sc.a.LXh,Zb.a.view,this.qXj,1028);this.ga.fb(sc.a.nOa,Zb.a.view,this.MXh,1028);this.ga.fb(sc.a.tgb,Zb.a.view,this.MXh,1028);this.d7j||(this.ga.fb(sc.a.Ejc,Zb.a.view,this.Ejc,96),this.ga.fb(sc.a.TFb,Zb.a.view,this.TFb,96))}Wuo(b){new YJ(this.ga,b,dt.fna)}eyl(b,h,v){1!==v&&this.Wuo(dt.AWa);return 32}static get sgb(){return null!=dt.cyg?dt.cyg:dt.cyg=Ga.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get fna(){dt.rAa||
(dt.rAa=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return dt.rAa}reset(){dt.AWa=null!=dt.fna?dt.fna.I9a?sc.a.nOa:sc.a.tgb:sc.a.nOa}}dt.AWa=sc.a.nOa;dt.rAa=null;Object(n.a)(dt,"ExternalContentActor",null,[]);class hE extends lt{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){super(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc);this.gTc=Dc;this.MKd=!1;this.ZZg=null}D3c(){this.MKd||(super.D3c(),this.MKd=!0)}Zme(){this.MKd&&(super.Zme(),hE.eUh&&this.ZZg&&hE.eUh.removeHandler(li.a.Hta,
this.ZZg),this.MKd=!1)}DQb(){if(this.gTc){this.tua.X_&&this.tua.Xw();const b=new Vx.a(0,w.AFrameworkApplication.isRtl);b.location=this.V4a.UOa();this.showFloatie(null,b)}else this.tua.X_&&w.AFrameworkApplication.va.processAction(sc.a.TFb,2),w.AFrameworkApplication.va.processAction(sc.a.Ejc,2);this.Jbc=!1}Xw(b){!this.xFe&&(b&&(this.V4a.OAf(),this.tDj()),this.tua.X_||this.TKa)&&(this.TKa=!b,this.Zme(),this.gTc?this.tua.Xw():w.AFrameworkApplication.va.processAction(sc.a.TFb,2))}showFloatie(b,h){h||(h=
new Vx.a(0,w.AFrameworkApplication.isRtl));h.location||(h.location=this.V4a.UOa());if(!h.location)return!1;this.TKa&&(this.TKa=!1,this.D3c());this.gTc?(b=Array(1),b.push("ExternalContent"),this.tua.showFloatie(this.V4a.UOa(),b,1)):w.AFrameworkApplication.va.processAction(sc.a.Ejc,2);return!0}RIc(){if(!this.Jbc){const b=new of.a(3,1,this.sOh,()=>{this.DQb()},196);xb.a.instance.Wb(b);this.Jbc=!0}}Eia(){this.gTc?this.tua.X_&&this.tua.Xw():w.AFrameworkApplication.va.processAction(sc.a.TFb,2);this.RIc()}ENb(){this.gTc?
this.tua.X_&&this.tua.Xw():w.AFrameworkApplication.va.processAction(sc.a.TFb,2);this.RIc()}static get eUh(){return null!=hE.Pxg?hE.Pxg:hE.Pxg=Ga.a.instance.resolve("Box4.IEditStateEventManager")}}Object(n.a)(hE,"ExternalContentFloatieEventManager",lt,[]);class iE extends tw{constructor(b,h,v,D,Q){super(b,h,v,D,Q)}Fzh(){if(!this.ib||!this.ib.gb||!this.ib.gb.kb)return u.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.gb.kb.Oa,
h=!b.cpBegin&&!b.cpEnd;let v=b.node;if(v&&h&&!v.tJ){do v=this.Mdi(v);while(v&&!v.tJ&&Object(yb.a)(S.AParagraphNode,v)&&!v.characterData.trim().length)}let D="";const Q=Object(Ka.a)(S.AParagraphNode,v);Q&&(D=Q.characterData.length===b.cpBegin||h?Q.characterData.trimEnd():Q.characterData.substring(0,b.cpBegin).trimEnd());h=Q?D.length:b.cpBegin;b=Object.assign(new wA,{Mxa:Object(Ka.a)(144,(Q?Object(Ka.a)(144,Q):Object(Ka.a)(144,v))||b.node),Dfc:h});return this.Upf(b)}L9h(b,h){let v=null;const D=Object(Ka.a)(184,
b.Mxa.Gj(h.ic));if(!D)return null;if(Object(yb.a)(S.AParagraphNode,b.Mxa)){const Q=Object(Ka.a)(S.AParagraphNode,b.Mxa);if(Q.wQ){if(b=Object(Ka.a)(au.a,de.ParagraphReader.WOa(Q)))(b=Object(Ka.a)(184,b.Gj(h.ic)))&&(v=b.getBounds()),v&&(v.height+=iE.W_h,v.width-=iE.REl);return v}h=Object(Ka.a)(134,D);if(!h)return null;try{if(v=this.jta.b_(b.Dfc,h,0<b.Dfc,!1,!1,!1))v.height+=iE.W_h}catch(ba){u.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ba),
v=null}}v||(v=D.getBounds());return v}}iE.W_h=65;iE.REl=100;Object(n.a)(iE,"ExternalContentFloatiePositionProvider",tw,[]);class ZJ{constructor(b,h,v,D,Q,ba){this.O6f=(ta,Ta,ob)=>{if(1===ob)return w.AFrameworkApplication.protectFile||w.AFrameworkApplication.KG||w.AFrameworkApplication.yoa||ac.SessionStatusManager.instance.Aj?8:32;if(ta===Eb.a.print)ta=1;else if(ta===sc.a.aKc)ta=0;else if(ta===sc.a.kJd)ta=2;else return 8;return this.K9n(ta)};this.ga=b;this.k6=h;this.LUb=v;this.v0j=D;this.WRg=Q;this.GXj=
ba;this.DI=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback")}Tb(){w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.v0j||w.AFrameworkApplication.KG?(document.body.classList.add("WACStopPrinting"),""!==this.WRg&&this.GXj.wvo(this.WRg)):(this.ga.qa(Eb.a.print,Zb.a.application,this.O6f),this.ga.qa(sc.a.aKc,Zb.a.application,this.O6f),this.ga.qa(sc.a.kJd,Zb.a.application,this.O6f))}K9n(b){const h=w.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Ya.App.qd&&Ya.App.qd.ZB.Ao)return 8;
this.LUb.AXd=!1;this.LUb.PJj.start();Lv.a.LQ(5,!0,Object(z.a)(this.LUb,this.LUb.S3n,"requestFileDownload"),Object(z.a)(this.LUb,this.LUb.sKb,"onForceSaveFailed"),b);this.cqe();return 32}cqe(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.DI&&(u.ULS.sendTraceTag(509145741,306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.DI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(n.a)(ZJ,"FileDownloadActor",
null,[]);class $J extends Ah{constructor(b,h=null){super(b,!0,h,!1)}get syf(){return null}get k4a(){return w.AFrameworkApplication.K_a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Gcc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Jzd(){return null}}Object(n.a)($J,"DownloadAsPdfDialog",Ah,[]);class $v{constructor(){this._url=this.pv=null;this.OXa=this.NXa=0;this.adb=!1;this.makeRequest=
()=>{w.AFrameworkApplication.Ne.tj(this._url,1,null,null,!0,2,this.EKb,this.ppa,null)};this.EKb=b=>{$v.T4c();const h=b.data.Fia;let v=null;if(h)try{v=h.selectSingleNode("/docdata/status")}catch(D){}v&&("InProgress"===v.text&&22>this.NXa++||"ServiceBusy"===v.text&&3>this.OXa++)?this.eHa(1E3*(this.NXa+this.OXa)):this.pv(!0,v?v.text:null,b.data)};this.ppa=b=>{this.adb?($v.qBa||($v.Oab=new Date,$v.qBa=!0,$v.WS=1),18E4>(new Date).getTime()-$v.Oab.getTime()?this.retryOnFailure(4<=$v.WS?2E4:1E3):this.E1a(b.data)):
4>$v.WS?this.retryOnFailure(2E3):this.E1a(b.data)}}send(b,h,v){this._url=b;this.pv=h;this.adb=v;this.makeRequest(null)}eHa(b){b=new of.a(2,1,b,this.makeRequest);w.AFrameworkApplication.pc.Wb(b)}retryOnFailure(b){this.eHa(b);$v.WS++}E1a(b){this.pv(!1,null,b)}static mba(b,h){(new $v).send(b,h,!1)}static T4c(){$v.qBa=!1;$v.WS=0}}$v.Oab=null;$v.qBa=!1;$v.WS=0;Object(n.a)($v,"ClientRequestWithRetry",null,[]);class aK extends Re{constructor(b){super(b,void 0,w.AFrameworkApplication.K_a)}get k4a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get Gcc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get AXc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get AIc(){return w.AFrameworkApplication.K_a?
"UIFontDialogTextLarge":null}cKf(){u.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}dKf(){u.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}VXc(){u.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get gXc(){return ZD.xRi}get Ikb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get FNi(){return!w.AFrameworkApplication.K_a}}Object(n.a)(aK,"DownloadAsOdtDialog",Re,[]);class bK{constructor(b,h){this.F$a=this.GYa=
null;this.P6a=v=>{1===Ya.App.xa.state||this.GYa||(this.GYa=(new fo.a).create(),v=v.customData,this.L0m(v),1===v?this.GYa.message=this.Gsb.EQ.isEnabled?w.AFrameworkApplication.K_a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:v?2===v&&(this.GYa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.GYa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.GYa.rL(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.AXd=!0};this.v0=(v,D,Q)=>{this.ggg("Success. Save and Conversion Complete.");Q=new fb.QueryStringBuilder(Q.request.get_url());w.AFrameworkApplication.dfa(Q);Q=Q.toString();const ba=this.f4n(Q);this.Pma(ba);2!==ba&&this.Gsb.RGn();!v||D?this.m5(ba):this.AXd?(this.AXd=!1,this.F$a=null):(this.F$a&&w.AFrameworkApplication.pc.We(this.F$a),this.F$a=null,this.iol(Q,ba))};this.AXd=!1;this.Gsb=b;this.PJj=h.YQa("UserAction","WordEditorForceSaveAndPrint")}Pma(b){this.GYa&&
(this.W0m(b),this.GYa.close(),this.GYa=null)}m5(b){if(1!==Ya.App.xa.state){this.Y1m(b);const h=new pg.StandardDialog;h.Ad=0;h.Ee(1,CommonUIStrings.l_DialogClose);h.mx(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}ltf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return u.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}S3n(b){var h=w.AFrameworkApplication.rootQuerySignature;
h&&""!==h?(h="WordViewer/request."+this.Vif(b)+"?"+h+"&type="+this.ltf(b)+"&rndm="+sb.a.create(),1===b&&this.Gsb.Qto()&&(h+="&useNamedAction=1"),w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&rp.FontUtils.zhe()&&(1===b||!b)&&(0<rp.FontUtils.cOh&&(h+="&cfcVer="+rp.FontUtils.cOh),rp.FontUtils.bOh&&(h+="&cfcUrl="+rp.FontUtils.bOh),rp.FontUtils.dOh&&(h+="&cfcEncData="+rp.FontUtils.dOh)),$v.mba(h,this.v0),this.F$a||(this.F$a=new of.a(2,1,500,this.P6a),this.F$a.customData=
b,w.AFrameworkApplication.pc.Wb(this.F$a))):(this.ggg("failed. QuerySignature is empty."),this.m5(b))}Vif(b){return 2===b?"odt":"pdf"}sKb(){this.ggg("Failed. force save failed.")}f4n(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;u.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}ggg(b){u.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.PJj.stop()}iol(b,h){const v=new zb.a;v.add("access_token");v.add("access_token_ttl");1!==Ya.App.xa.state&&(1===h?this.Gsb.gwo(b,v):h?2===h&&new aK(b):new $J(b))}dispose(){}L0m(b){switch(b){case 0:u.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:u.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:u.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:u.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}W0m(b){switch(b){case 0:u.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:u.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:u.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:u.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}Y1m(b){switch(b){case 0:u.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:u.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:u.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:u.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(n.a)(bK,"FileDownloadManager",null,[]);class jE{get key(){return"LIST"}get Uw(){return Box4Intl.Box4Strings.l_ListContentTitle}Vlc(b){let h=null;const v=jE.Gd.lw(b);if(!v)return{returnValue:!1,vma:h};b=this.K0l(b,v);h=Object.assign(new ex.a,{LG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,vma:h}}WDb(b,h){b=b.contentObject;const v=this.v_l(b.Jx),D=new sf.a;h?(h=h.contentObject,h.level!==b.level?(D.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),D.add(v)):h.id.equals(b.id)&&h.Jx.listType===b.Jx.listType||D.add(v)):(D.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),D.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),D.add(v));return D.toArray().join(" ")}v_l(b){let h="";const v=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Fu);else if(1===b.listType)switch(v){case 1:h=this.tyh;break;case 2:h=this.JOk;break;case 3:h=this.KOk;break;default:h=
this.tyh}return h}static get Gd(){return null!=jE.ADg?jE.ADg:jE.ADg=Ga.a.instance.resolve("Box4.List.IListReader")}}Object(n.a)(jE,"ListDetailsProvider",null,[677,568]);class cK{constructor(){this.Jx=this.listId=this.id=null;this.level=0}}Object(n.a)(cK,"ListItemInfo",null,[]);class dK extends jE{constructor(b){super();this.s6=b}get tyh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get JOk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get KOk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}K0l(b,
h){const v=this.s6.vB(b);return Object.assign(new cK,{id:b.currentNode.id,listId:new W.a(sb.a.nil,v.listID),Jx:h,level:v.level+1})}}Object(n.a)(dK,"FlatListDetailsProvider",jE,[]);class eK{constructor(b,h){this.ga=b;this.If=h}get wc(){return null!=this.oJg?this.oJg:this.oJg=Ga.a.instance.Na("Box4.Styles.IWACStyleReader")}Tb(){}}Object(n.a)(eK,"FormattingActor",null,[]);var FM=c(1158),UE=c(1322),GM=c(1702);class fK{constructor(b,h,v,D,Q,ba,ta,Ta){this.Fb=b;this.gik=h;this.Gc=v;this.Otb=D;this.Eo=Q;
this.Ma=ba;this.ld=ta;this.c8j=Ta}Mec(b,h,v,D,Q,ba,ta){u.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.ti});this.Otb.then(()=>{this.gik(b.data.we);u.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.ti});ta.stop()})}ppa(b,h,v,D,Q,ba,ta){ba.stop();Q();ta?(this.vBn(h,v),u.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:ke.ImageReader.ZOa(h.Fb)})):u.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:ke.ImageReader.ZOa(h.Fb)})}rsh(b,h){b.Ce(sG.a.W9e,"1");if(this.ld&&this.ld.isFeatureEnabled(49)){var v=this.Eo.Zm(h.$j);v=this.Eo.mk(v);b.Ce(Sd.a.gt,UE.a[v]);5===v&&this.TCk(b,h)}this.c8j&&b.Ce(Sd.a.JVd,"true")}cmh(){return new GM.a(this.Fb.id,this.Fb)}xRd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}vBn(b,h){const v=this.Gc.Oc(7,Eb.a.skm);v.Cb(h);
b.Fb.setValue(lc.a.zHh,!0);v.dispose()}TCk(b,h){var v=h.$j;h=this.Eo.Zm(v);var D=v.node;const Q=(v=this.Eo.tEa(h,D.Jc,!1))?this.Eo.lEa(v):"";if(""===Q)throw u.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");D=(D=this.Eo.tEa(h,D.Jc,!0))?this.Eo.lEa(D):"";b.Ce(Sd.a.efc,Q);b.Ce(Sd.a.TJj,D);v=v.ia(Ve.a.RYh,"");""!==v&&b.Ce(Sd.a.extension,v);b.Ce(Sd.a.width,this.Eo.dF(h).toString());b.Ce(Sd.a.height,this.Eo.wG(h).toString());
b.Ce(Sd.a.o1c,this.Eo.Nhb(h).toString());v=this.Ma.$("WordEditorImageCropIsEnabled");b.Ce(Sd.a.oNh,v.toString());v&&(v=this.Eo.Bba(h),b.Ce(Sd.a.top,v.top.toString()),b.Ce(Sd.a.bottom,v.bottom.toString()),b.Ce(Sd.a.left,v.left.toString()),b.Ce(Sd.a.right,v.right.toString()));v=this.Ma.$("WordEditorImageRotateIsEnabled");b.Ce(Sd.a.Wej,v.toString());v&&(b.Ce(Sd.a.angle,this.Eo.A_(h).toString()),b.Ce(Sd.a.flipH,this.Eo.G5(h,lc.a.CQc,!1)?"true":"false"),b.Ce(Sd.a.flipV,this.Eo.G5(h,lc.a.OQc,!1)?"true":
"false"));b.Ce(Sd.a.LUh,"true")}}Object(n.a)(fK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[736]);class gK{constructor(){this.vKa=null}CJk(b){this.vKa=b}teardown(){null!=this.vKa&&(this.vKa.teardown(),this.vKa=null);this.$Ne=null}getGraphicData(){return this.vKa?this.vKa.getGraphicData():null}IXn(){null!=this.$Ne&&this.setGraphicData(this.$Ne)}setGraphicData(b){this.$Ne=b;if(this.vKa)try{this.vKa.setGraphicData(b)}catch(h){u.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else u.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.vKa?this.vKa.hasEdits():!1}}Object(n.a)(gK,"GraphicsEditorGC2HostUser",null,[738]);var HM=c(1703),IM=c(1076),JM=c(1373),KM=c(784),LM=c(1464),MM=c(1075);class hK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(n.a)(hK,"GC2ScriptLoader",null,[]);class pH{constructor(b,
h,v){this.ove=b;this._context=h;this.ULa=v}closeEditor(){this.ove&&(this.ove(),this.ove=null)}logActivity(b,h,v,D){Qe.a(b,h,v,D)}logTrace(b,h,v,D){u.ULS.sendTraceTag(575522531,3001,pH.G7m(h),D)}isEnabled(b){const h=w.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");case "ShapeLocksSchema":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ga.a.instance.resolve("Box4.IFontServiceParser").w0a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",
h);b=rp.FontUtils.qmf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(v=>"premium"!==v.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return wa.Health.instance}getFonts(b){const h=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),v=h?"msofp_hier":"msofp",D=`${Ga.a.instance.resolve("Box4.IFontServiceParser").w0a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(v,D);rp.FontUtils.Nmh();
rp.FontUtils.onh({});b=rp.FontUtils.pmf(()=>!1,(Q,ba)=>ba).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.y3k()));return b}y3k(){const b=rp.FontUtils.qmf(()=>!1,()=>"").fonts.map((h,v)=>{const D=h.name;h=h.displayName;const Q=rp.FontUtils.Loa(D);return Object.assign(new AE.a,{MenuItemId:rp.FontUtils.ehj+v,CommandValueId:D,LabelText:h||D,Styles:{["optionText"]:{["fontFamily"]:h&&!Q?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:D})});return Object.assign(new $g.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,
Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.$j;var v=ke.ImageReader.Zm(h);if(this.fLm(v,h,b)&&(v=ke.ImageReader.G5(v,wc.a.tpa,""),v.length))return Promise.resolve(v);v=new fb.QueryStringBuilder("/we/GetImage.ashx?");v.a0b(h.node.Bi().sr);v.Ce(Sd.a.zHd,b);w.AFrameworkApplication.dfa(v);v.Ce(Yf.a.Cqb,"1");yj.a.instance.czb(v);v.Ce(Sd.a.qOh,"true");const D=v.toString();return new Promise((Q,ba)=>{this.ULa.tj(D,1,null,null,!1,2,ta=>{Q(ta.data.we)},ta=>{ba(ta.data.Qe.toString())},
null)})}getPlaceholders(){const b={};b.PictureDownloading=zj.a.vg("progress.gif");b.PictureInvalid=zj.a.vg("CancelRequest.32x32x32.png");return b}getTheme(){const b=Rl.PageNavigator.instance.Xs(this._context.view.Yc).properties.ia(lc.a.ple,"");return 0===b.length?[]:b.split(" ").map(h=>Ya.App.FAb[h])}static G7m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}fLm(b,h,v){const D=h.node.Jc;h=ke.ImageReader.DQd(b,D,!1);b=ke.ImageReader.DQd(b,
D,!0);return v===h||v===b}}Object(n.a)(pH,"GraphicsEditorApp",null,[745]);class iK extends Vf.a{constructor(b,h,v,D,Q){super(!1,!1,!0);this.closeEditor=()=>{this.aIh();this.dispose()};this.jba=ba=>{this.aIh(2===ba)};this.W$a=b;this.L4j=h;this.WYg=v;this._context=D;this.ULa=Q}mvo(b){return new Promise((h,v)=>{this.Yh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.jba,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(D,Q)=>this.LKk(Q,b),["onload"]:D=>{this.onLoad(D,h,v)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.W$a.IXn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,v){b?(this.W$a.CJk(b),h(b)):(u.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),v(null))}LKk(b,h){const v=w.AFrameworkApplication.K,D=MM.a();D.loadScriptWithRetryHandler=b;const Q=new pH(this.closeEditor,this._context,this.ULa),ba={["bootConfig"]:Object.assign(new JM.a,
{scriptBaseUrl:NE.AppChromeOverrideUtilities.isEnabled?NE.AppChromeOverrideUtilities.nQd(w.AFrameworkApplication.lcid):w.AFrameworkApplication.t5+w.AFrameworkApplication.lcid+"/",isMLRRibbonMode:w.AFrameworkApplication.ta.Nb.sjc,isCombinedBundleEnabled:w.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new hK(new IM.DynamicScriptLoader(D)),["publicPath"]:w.AFrameworkApplication.t5,["appSettings"]:v.appSettings,["logger"]:new na.a,["featureGateManager"]:Object.assign(new KM.a,
{getBooleanFeatureGate:Object(z.a)(v,v.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(v,v.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(v,v.getStringFeatureGate,"getStringFeatureGate")}),["app"]:Q,["resolveScript"]:(ta,Ta)=>LM.a.resolveScript(ta,Ta),["initialTabId"]:h};v.$("DynamicBundlesIsEnabled")&&(h=w.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||w.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ba.dynamicBundlesPath=
NE.AppChromeOverrideUtilities.isEnabled?NE.AppChromeOverrideUtilities.Xhc+h:v.jb("StaticContentUrl")+h);return new Promise((ta,Ta)=>{b("gc2",w.AFrameworkApplication.Bz("gc2.js",5),"anonymous",5,!1).then(()=>{ta(ba)}).catch(()=>{u.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ta(null)})})}aIh(b){b=this.W$a.hasEdits()&&!b;this.L4j(b?this.W$a.getGraphicData():null,!!this.WYg,this.WYg,b)}}Object(n.a)(iK,"ReactGraphicsEditorDialog",Vf.a,[]);class jK{constructor(b,
h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc,gd=!1){this.d2h=gd;this.Otb=this._context=null;this.nvo=(rd,je,Ld,Qd,ge)=>{var ze,gg,Kg;const Ll=!!ge&&Object(yb.a)(W.a,ge);try{if(1===Ld){const up=je.view;return this.Oj.Afa(je)&&up.features.gke?32:8}this.w8j=4===(null===ge||void 0===ge?void 0:ge.InputMethod)?!0:!1;Ya.App.instance&&Ya.App.instance.lHb&&(this.d2h||FM.a.ngb(()=>{this.d2h=!0}));u.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Ll}`);performance.mark("LaunchStart");this._context=
je;const Em=new iK(this.W$a,this.TSf,Ll?ge:null,je,this.Yf);rd=null;if(Ll&&(null===(ze=w.AFrameworkApplication.K)||void 0===ze?0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const up=null===(Kg=null===(gg=je.view.lb)||void 0===gg?void 0:gg.gb)||void 0===Kg?void 0:Kg.kb;if(null===up||void 0===up?0:up.NH)rd="Draw"}this.Otb=Em.mvo(rd).then(()=>{u.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Ll}`)}).catch(()=>
{this.cSh()});if(!Ll){const up=hB=>{this.Otb.then(()=>{this.RWi(hB,!1)})};if(w.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return up(JSON.stringify({elements:[]})),32;let nv=null;nv=Rl.PageNavigator.instance.Xs(je.view.Yc);const hD=nv.properties.ia(lc.a.e2h,"");if(0<hD.length)return up(hD),32;this.SBe.Hco(je,W.a.create(),sb.a.create()).then(hB=>{const $D=this.Gc.Oc(0,Eb.a.dQc);$D.Cb(nv);nv.setValue(lc.a.e2h,hB);$D.dispose();
up(hB);return null}).catch(hB=>{u.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",hB.toString(),Ll);this.cSh()})}return 32}catch(Em){return u.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Em.toString(),Ll),8}};this.$lm=(rd,je,Ld,Qd,ge)=>{if(!je.view.features.gke)return 32;u.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.aUh(ge,je);return 32};
this.Zlm=(rd,je,Ld,Qd,ge)=>{var ze,gg,Kg;const Ll=je.view;if(null===(ze=w.AFrameworkApplication.K)||void 0===ze?0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(ze=null===(Kg=null===(gg=null===Ll||void 0===Ll?void 0:Ll.lb)||void 0===gg?void 0:gg.gb)||void 0===Kg?void 0:Kg.kb,null===ze||void 0===ze||!ze.J2a)return 8;return this.Hki(rd,je,Ld,Qd,ge)};this.Hki=(rd,je,Ld)=>{if(1===Ld)return je.view.features.gke?32:8;if(2===Ld){rd=ke.ImageReader.Zm(je.$j);if(!rd)return 2;
u.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.aUh(rd,je);return 32}return 2};this.RWi=(rd,je=!0)=>{this.W$a.setGraphicData(rd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");rd=performance.getEntriesByName("EditorLaunch");u.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${je} Duration: ${rd[rd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.TSf=(rd,je,Ld,Qd)=>{var ge;this.W$a.teardown();if(je&&this._context){var ze=this._context.view.lb.tg,gg=ze.node;ze.el&&de.ParagraphReader.Vb(gg)&&(ze=null===(ge=this.gQ)||void 0===ge?void 0:ge.uA(gg),27==(null===ze||void 0===ze?void 0:ze.role)&&u.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",Qd,Qd?" Everything deleted: "+(0==(null===rd||void 0===rd?void 0:rd.json.length)):""))}if(Qd)if(u.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(rd)if(Qd=rd.json,ge=rd.width,gg=rd.height,Qd.length||je)if(!Qd.length&&je)if(je=this._context.$j){je=je.node;if(ke.ImageReader.C8(je)){if(!this.Oj.aYn(je,new ne.GraphIterator,xi.a.instance,WJ.DeleteActor.N_b)){u.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Oj.Xgc(je,Ld,this.eb,this.DV)){u.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}u.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else u.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ze=new HM.a(this._context,w.AFrameworkApplication.ta.GEa,!0,this.Oj,this.Ma,Rl.PageNavigator.instance),rd=sb.a.create(),Ld=new uJ.a(ze,Qd,this.dK,this.Jm,rd,rl.a.instance,je,Ld,this.Oj,this.Eo,ge,gg,this.Ma,this.DV,this.ld,Ya.App.instance.lHb,Ya.App.instance.Vyf),this.SBe.W9f(Ld,this._context,je,rd),this.Pqa(),this.w8j&&this.fMo();else u.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else u.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else u.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ma=h;this.SBe=v;this.Oj=D;this.dK=Q;this.Jm=ba;this.W$a=new gK;this.Gc=Ta;this.eb=ob;this.DV=Kb;this.Eo=Vb;this.ld=Dc;this.Yf=bc;this.gQ=Oc}Tb(){var b;let h=!0;this.Ma.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.ld&&this.ld.isFeatureEnabled(49));
h&&!aa.a.At&&(this.ga.fb(sc.a.graphicsEditor,Zb.a.view,this.nvo,4),this.ga.fb(Eb.a.pgf,Zb.a.view,this.$lm,4),this.ga.fb(sc.a.cUh,Zb.a.view,this.Zlm,4),(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.fb(sc.a.Z4b,Zb.a.view,this.Hki,4))}cSh(){const b=new pg.StandardDialog;b.Ad=0;b.mx(Nl.a.egf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);Ya.App.xa.updateCommandUI()}aUh(b,h){var v=b.ia(nh.a.Y4,1);const D=b.ia(Ve.a.O_,0);v&&1!==D?b.ia(lc.a.zHh,!1)?(h=new pg.StandardDialog,h.Ad=0,h.mx(Nl.a.egf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Ya.App.xa.updateCommandUI(),u.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:ke.ImageReader.ZOa(b)})):(this.ga.Qb(sc.a.graphicsEditor,2,b.id),
this.Otb||(u.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.Otb=new Promise(Q=>{Q(null)})),v=sb.a.create(),b=new fK(b,this.RWi,rl.a.instance,this.Otb,this.Eo,this.Ma,this.ld,Ya.App.instance.f4(this.Eo.mk(b))),this.SBe.W9f(b,h,!0,v)):u.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Pqa(){const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):
u.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}fMo(){const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):u.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(n.a)(jK,"GraphicsEditorActor",null,[]);var NM=c(514);class kK{constructor(b,h,v){this.TVa="wwaengidc";this.lgd="CreateLinkForHeading";this.i_j="CreateLinkForHeadingAction";this.p1j="\ufffc";this.FVa=
b;this.ga=h;this.eb=v}Tb(){this.ga.qa(sc.a.eIc,Zb.a.paragraph,this.dbf.bind(this));this.ga.qa(sc.a.eIc,Zb.a.Hd,this.dbf.bind(this));this.ga.qa(sc.a.eIc,Zb.a.Tc,this.dbf.bind(this));this.ga.Vc(sc.a.eIc,1028)}dbf(b,h,v){b=h.node;if(1===v)return this.$xi(b)?32:8;this.XQn(this.lgd,this.i_j);if(!this.$xi(b))return u.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;v=b.getValue(lc.a.Lc);if(!v)return u.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),
v=new Map,v.set("Source",this.lgd),v=Object.assign(new wb.a,{additionalValues:v}),wa.Health.instance.recordKpiFailure(this.lgd,"Unable to create sharable link as paragraph id is missing",!1,!0,v),8;this.cLh(v);return 32}cLh(b){b=String.format('{{"{0}":"{1}"}}',NM.a.heading,b);this.ga.Qb(Ua.a.i8,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}$xi(b){return!this.eb.Vb(b)||this.eb.fUc(b)||this.eb.qac(b)||b.ur||""===b.characterData||b.characterData===this.p1j||!this.FVa.tPd(b)?
!1:!0}XQn(b,h){const v=new Map;v.set("Source",this.lgd);v.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.TVa,v)}}Object(n.a)(kK,"HeadingsActor",null,[]);class lK{qso(b){return de.ParagraphReader.qua(this.k9h(b))}M6c(b,h,v){if(b=de.ParagraphReader.WOa(this.k9h(b)))h=b.De(h),Object(yb.a)(714,h)&&(Bx.m(b)?h.Hmo(v):h.M6c())}k9h(b){return b&&b.el&&b?b.node:null}}Object(n.a)(lK,"IFrameFocusStrategy",null,[715]);class mK{constructor(b){this.JBa=null;this.Bkd=b}ZJi(){u.ULS.sendTraceTag(25007835,
375,50,"Ignore all spelling error triggered")}uCj(b){if(!b)return u.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return u.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return u.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.JBa=G.a.Ble(b.errorDetails.token,b.errorDetails.lcid);this.Bkd.add(this.JBa,b.errorDetails.lcid);return!0}Jhe(b){return b?
b.token?G.a.Ble(b.token,b.lcid)===this.JBa:(u.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(u.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(n.a)(mK,"IgnoreAllProofingErrorStrategy",null,[713]);var OM=c(1383),PM=c(566),nK=c(529);class oK{constructor(b,h){this.filename=b;this.blob=h}}Object(n.a)(oK,"UploadBlobParameters",null,[]);class pK extends Ol{constructor(b,h,v,D,Q,ba,ta,Ta=null){super(b,h,v,null,Q,ba,!1);this.C9j="DragAndDrop";
this.BUg="FileName";this.EUg=0;this.Ljh=null;this.aoe=this.C4b=!1;this.LSg=D;this.xah=Ta}get bP(){return this.C9j}get fileExtension(){return this.BUg}get fileSize(){return this.EUg}get IHj(){return this.Ljh}q9c(b){const h=new oK(this.LSg.name,this.LSg);b.Vvj(h);this.Ljh=b.Ycb}sOa(b,h){this.xah&&this.xah();super.sOa(b,h)}e0o(b){const h=!!b&&this.pza(b.name,null)&&this.Ung(b,null);b&&(this.BUg=b.name,this.EUg=b.size);h||this.t2d();return h}}Object(n.a)(pK,"DragDropInsertImageUploader",Ol,[]);class et{constructor(b,
h,v,D,Q,ba,ta){this.LRc=ba;this.MR=ta;this.F3d=this.G3d=this.c4d=this.d4d=0;this.ga=null;this.Wff=(Ta,ob,Kb)=>{if(Ya.App.CId)return 8;Ta=ob.node;return 1===Kb?Ta?32:2:2===Kb?(Kb=ke.ImageReader.Zm(ob),ob=ke.ImageReader.POc(Kb,ob.node.Bi().od,w.AFrameworkApplication.K,w.AFrameworkApplication.ta.GEa),Iy(ob),32):2};this.IBm=(Ta,ob,Kb)=>{var Vb;const bc=this.Oj.Afa(ob);if(2===Kb&&bc){if(Eb.a.aR===Ta||Eb.a.TCd===Ta)w.AFrameworkApplication.Woa?w.AFrameworkApplication.ueg():((null===(Vb=w.AFrameworkApplication.K)||
void 0===Vb?0:Vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&$n.a.instance.D5a("PictureLocal"),this.dcl(ob));return 32}return 1!==Kb||Eb.a.aR!==Ta&&Eb.a.TCd!==Ta?2:bc?32:2};this.CGb=(Ta,ob,Kb,Vb,bc)=>this.Oj.Afa(ob)?1===Kb?32:this.Oj.wAf(ob,bc)?32:2:2;this.amo=()=>{if(this.ib&&this.ib.gb&&this.ib.gb.kb){const Ta=this.ib.gb.kb.Oa;Ta&&this.ib.setSelection(Mg.SelectionFactory.ue(Ta.node,Ta.cpBegin))}};this.nrl=(Ta,ob,Kb,Vb,bc)=>{u.ULS.sendTraceTag(42530333,307,50,
"Drag and drop local content");if((Ta=bc.DataTransfer)&&Ta.files&&0<Ta.files.length){u.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ta.files.length));for(Kb=0;Kb<Ta.files.length;Kb++)Vb=Ta.files[Kb],0<=G.a.Ug(Vb.type).indexOf("image")&&this.VAm(Vb,ob)&&(Vb=this.ib.gb.kb.Oa,this.ib.setSelection(Mg.SelectionFactory.ue(Vb.node,Vb.cpBegin+1)));this.XIa();return 32}u.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.$Bn=(Ta,ob,Kb,Vb,bc)=>
{if(2===Kb)return w.AFrameworkApplication.va.Of(ob.$j,Ta,Kb,!0,Vb,bc);if(!ob.view.qe)return 8;Ta=ob.view;if(!Ta.lb)return 8;Ta=et.Wg.dO(Ta.lb.tg);return 1===Ta.length&&this.cO(Ta[0])?(this.e5m(),this.mWc||et.VYf(!0),32):8};this.Qkm=(Ta,ob,Kb)=>{if(!this.cO(ob))return 8;const Vb=ke.ImageReader.Zm(ob),bc=ke.ImageReader.dF(Vb),Dc=ke.ImageReader.wG(Vb);Ta=Ta===Eb.a.eUd;u.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ta});if(1===Kb)return this.nf.b4||ke.ImageReader.Y2a(Vb)?2:Ta&&
bc<this.G3d&&Dc<this.F3d||!Ta&&bc>this.d4d&&Dc>this.c4d?32:2;Kb=Ta?1.1:.9;this.setSize(Vb,ob,bc*Kb,Dc*Kb,!0);return 32};this.pgc=(Ta,ob,Kb,Vb,bc)=>{if(!this.pCa(ob))return 8;Ta=ke.ImageReader.Zm(ob);ob=ke.ImageReader.pEa(Ta);Kb=ke.ImageReader.oEa(Ta);if(0>=ob||0>=Kb)return 2;Ta=ke.ImageReader.dF(Ta)/ob*100;bc.setValue(wc.a.SRc,Ta);return 32};this.N9b=(Ta,ob,Kb,Vb,bc)=>{if(!this.pCa(ob))return 8;Ta=ke.ImageReader.Zm(ob);if(1===Kb)return this.nf.b4||ke.ImageReader.Y2a(Ta)?2:32;u.ULS.sendTraceTag(20459937,
322,50,"Change image scale.");Kb=bc.ia(wc.a.SRc,-1)/100;Vb=bc.ia(wc.a.Soi,!1);const Dc=bc.ia(wc.a.Pyf,!0);bc=bc.ia(wc.a.Qyf,!0);if(0>=Kb)return et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.NGb}),2;const Oc=ke.ImageReader.pEa(Ta),gd=ke.ImageReader.oEa(Ta),rd=ke.ImageReader.dF(Ta),je=ke.ImageReader.wG(Ta);if(0>=Oc||0>=gd)return et.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.NGb}),2;Vb?(Vb=Dc?Kb*rd:rd,Kb=bc?Kb*je:je):(Vb=Dc?Kb*Oc:rd,Kb=bc?Kb*gd:je);this.setSize(Ta,ob,Vb,Kb);Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(ob.node);this.XIa();
return 32};this.bMb=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;Ta=ke.ImageReader.Zm(ob);Ta=ke.ImageReader.wG(Ta);if(0>=Ta)return 2;bc.setValue(wc.a.MEa,Ta);return 32};this.MEa=(Ta,ob,Kb,Vb,bc)=>{if(!this.pCa(ob))return 8;Ta=ke.ImageReader.Zm(ob);if(1===Kb)return this.nf.b4||ke.ImageReader.Y2a(Ta)?2:32;u.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Kb=bc.ia(wc.a.MEa,0);bc=ke.ImageReader.X2a(Ta);if(0>=Kb)return et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.NGb}),2;Vb=ke.ImageReader.pEa(Ta);
const Dc=ke.ImageReader.oEa(Ta),Oc=ke.ImageReader.dF(Ta);var gd=ke.ImageReader.wG(Ta);gd=Oc/gd;if(0>=Vb||0>=Dc)if(et.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.NGb}),this.Upj(Ta))return 2;this.setSize(Ta,ob,bc?Kb*gd:Oc,Kb);Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(ob.node);Ya.App.xa.updateCommandUI();return 32};this.cMb=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;Ta=ke.ImageReader.Zm(ob);Ta=ke.ImageReader.dF(Ta);if(0>=Ta)return 2;bc.setValue(wc.a.NEa,Ta);return 32};this.NEa=(Ta,ob,Kb,Vb,bc)=>{if(!this.pCa(ob))return 8;Ta=
ke.ImageReader.Zm(ob);if(1===Kb)return this.nf.b4||ke.ImageReader.Y2a(Ta)?2:32;u.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Kb=bc.ia(wc.a.NEa,0);bc=ke.ImageReader.X2a(Ta);if(0>=Kb)return et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.NGb}),2;Vb=ke.ImageReader.pEa(Ta);const Dc=ke.ImageReader.oEa(Ta);var Oc=ke.ImageReader.dF(Ta);const gd=ke.ImageReader.wG(Ta);Oc=gd/Oc;if(0>=Vb||0>=Dc)if(et.Ic.Yb(Oe.a.n1,{["Reason"]:Fe.a.NGb}),this.Upj(Ta))return 2;this.setSize(Ta,ob,Kb,bc?Kb*Oc:gd);Ya.App.qd.Qo&&
Ya.App.qd.Qp.QF(ob.node);Ya.App.xa.updateCommandUI();return 32};this.eMb=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;Ta=ke.ImageReader.Zm(ob);Ta=ke.ImageReader.X2a(Ta);bc.setValue(wc.a.VX,Ta);return 32};this.VX=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;Ta=ke.ImageReader.Zm(ob);if(1===Kb&&this.nf.b4)return 2;Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(ob.node);bc&&(ob=bc.ia(wc.a.VX,!0),u.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Oj.Xkj(Ta,ob),Ya.App.xa.updateCommandUI());return 32};
this.l5a=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;Ta=ke.ImageReader.Zm(ob);Ta=ke.ImageReader.BX(Ta);bc.setValue(wc.a.Eib,Ta);return 32};this.Eib=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;if(1===Kb)return this.nf.b4?2:32;if(Ya.App.qd.Qo&&(Ta=ob.node.ia(nh.a.CJ,Vm.a.Ft),Ta!==Vm.a.Ft&&(Ta=Ya.App.qd.Qp.Dhb(Ta),nK.CoauthLockEditor.getInstance().G6a(Ta))))return et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),2;Ta=ke.ImageReader.Zm(ob);bc=bc.ia(wc.a.Eib,null);this.Oj.nio(Ta,ob,bc);u.ULS.sendTraceTag(21297027,
322,50,"Change image alt text.");this.Ld.Ls(13);return 32};this.k5a=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;Ta=ke.ImageReader.Zm(ob);Ta=ke.ImageReader.YOa(Ta);bc.setValue(wc.a.UX,Ta);return 32};this.UX=(Ta,ob,Kb,Vb,bc)=>{if(!this.cO(ob))return 8;if(1===Kb)return this.nf.b4?2:32;if(Ya.App.qd.Qo&&(Ta=ob.node.ia(nh.a.CJ,Vm.a.Ft),Ta!==Vm.a.Ft&&(Ta=Ya.App.qd.Qp.Dhb(Ta),nK.CoauthLockEditor.getInstance().G6a(Ta))))return et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.RE}),2;Ta=ke.ImageReader.Zm(ob);bc=bc.ia(wc.a.UX,
null);this.Oj.mio(Ta,ob,bc);u.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Ld.Ls(13);return 32};this.f6a=(Ta,ob,Kb)=>{var Vb,bc;if(1===Kb)return 32;if(!ob.view.qe)return u.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ta),8;ob=ob.view;Kb=null===(bc=null===(Vb=ob.lb)||void 0===Vb?void 0:Vb.gb)||void 0===bc?void 0:bc.J(0);if(!Kb)return u.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ta),8;bc=Kb.Oa;Vb=this.MR.$f("UserAction",
Ta.toString());let Dc;Ta==Eb.a.u9f?Dc=this.LRc.f6a(bc,2):Ta==Eb.a.x9f?(Dc=this.LRc.f6a(bc,0),5==Dc&&(Dc=this.LRc.f6a(bc,2))):Ta==Eb.a.y9f&&(Dc=this.LRc.f6a(bc,1),5==Dc&&(Dc=this.LRc.f6a(bc,3)));switch(Dc){case 4:bc=32;ob.b5();break;case 5:bc=2;break;default:bc=8}Vb.stop();u.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",Dc,Vb.ti,Ta);return bc};this.Oj=b;this.Tm=h;this.Ld=v;this.Pg=D;this.ib=Q;this.Nh=Fp.a.getInstance(tm.a)}get nf(){return bi.PageReader.instance}get qba(){return this.Tm.instance}get oc(){return this.ga}mzm(){this.d4d=
Cf.a.Tl(1,0);this.c4d=Cf.a.Tl(1,1);this.G3d=Cf.a.Tl(1920,0);this.F3d=Cf.a.Tl(1280,1)}Tb(b){this.ga=b;const h=this.$Bn,v=this.IBm,D=this.CGb,Q=this.Qkm;b.fb(Eb.a.aR,Zb.a.view,v,1284);b.qa(Eb.a.CGb,Zb.a.Tc,D);b.qa(Eb.a.u9f,Zb.a.view,this.f6a);b.qa(Eb.a.x9f,Zb.a.view,this.f6a);b.qa(Eb.a.y9f,Zb.a.view,this.f6a);b.qa(Eb.a.CGb,Zb.a.image,D);b.Vc(Eb.a.CGb,1284);b.fb(Eb.a.TCd,Zb.a.view,v,1284);b.fb(Eb.a.j6e,Zb.a.view,h,1028);this.nr(b,Eb.a.eUd,Q);this.nr(b,Eb.a.Heg,Q);this.nr(b,Eb.a.pgc,this.pgc);this.nr(b,
Eb.a.bMb,this.bMb);this.nr(b,Eb.a.cMb,this.cMb);this.nr(b,Eb.a.l5a,this.l5a);this.nr(b,Eb.a.k5a,this.k5a);this.nr(b,Eb.a.N9b,this.N9b);this.nr(b,Eb.a.nge,this.MEa);this.nr(b,Eb.a.oge,this.NEa);this.nr(b,Eb.a.Q6c,this.Eib);this.nr(b,Eb.a.ZNb,this.UX);this.nr(b,Eb.a.eMb,this.eMb);this.nr(b,Eb.a.VX,this.VX);this.nr(b,Eb.a.Wff,this.Wff);b.fb(Eb.a.OTh,Zb.a.view,this.nrl,4);b.Vc(Eb.a.eUd,4);b.Vc(Eb.a.Heg,4);b.Vc(Eb.a.pgc,69);b.Vc(Eb.a.bMb,69);b.Vc(Eb.a.cMb,69);b.Vc(Eb.a.eMb,69);b.Vc(Eb.a.l5a,69);b.Vc(Eb.a.k5a,
69);b.Vc(Eb.a.VX,4);b.Vc(Eb.a.N9b,4);b.Vc(Eb.a.nge,4);b.Vc(Eb.a.oge,4);b.Vc(Eb.a.Q6c,4);b.Vc(Eb.a.ZNb,4);this.mzm();this.mWc&&Th.a.instance.Pw(this.sRk)}nr(b,h,v){b.qa(h,Zb.a.image,v);b.qa(h,Zb.a.iDb,v);b.qa(h,Zb.a.Hd,v);b.qa(h,Zb.a.anchoredObject,v)}dcl(b){new Ol(b,xb.a.instance,w.AFrameworkApplication.K,null,this.Pg,this.ga)}n0o(b){return this.nf.b4?(et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.fzl}),!1):et.Xf.j_(b)?(et.Ic.Yb(Oe.a.hn,
{["Reason"]:Fe.a.RE}),!1):this.qba&&this.qba.tU(b)?(et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.externalSelection}),!1):!0}jLm(b){const h=ke.ImageReader.Zm(b);return h&&5===ke.ImageReader.mk(h)&&this.Wvi(b,h)}Wvi(b,h){(h=!ke.ImageReader.G7b(h)&&!ke.ImageReader.WYd(h))||et.Ic.Yb(Oe.a.hn,{["Reason"]:Fe.a.GHh});return h&&this.n0o(b)}VAm(b,h){var v,D;h=new pK(h,xb.a.instance,w.AFrameworkApplication.K,b,this.Pg,this.ga,this.ib,this.amo);if(h.e0o(b))(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.$("ShouldLogPicturesExtendedHealthKpis"))&&
this.Nh.logKpiUsage({kpiName:tm.c.OEa,kpiType:0});else return(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new wb.a,{extendedProperties:b}),this.Nh.logKpiFailure({kpiName:tm.c.OEa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:tm.c.L9b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:null}})):wa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),u.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new lo.a(document.body,Object(z.a)(h,h.Wec,"onUploadFrameInitialized"),Object(z.a)(h,h.hza,"uploadResponseReceived"),w.AFrameworkApplication.K,!1,void 0,nl.a(w.AFrameworkApplication.K));return!0}cO(b){return this.jLm(b)}pCa(b){const h=ke.ImageReader.Zm(b);if(!h)return!1;const v=Ga.a.instance.Na("Box4.IFeatureHelper"),
D=ke.ImageReader.mk(h);return 5===D||10===D||48===D||11===D||v&&v.isFeatureEnabled(49)&&4===D?this.Wvi(b,h):!1}get mWc(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}sRk(){et.VYf(!0)}setSize(b,h,v,D,Q=!1){Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(h.node);const ba=ke.ImageReader.X2a(b);let ta=1;v>this.G3d?ta=this.G3d/v:v<this.d4d&&(ta=this.d4d/v);let Ta=1;D>this.F3d?Ta=this.F3d/D:D<this.c4d&&(Ta=this.c4d/
D);if(ba||Q)ta=Math.min(ta,Ta),Ta=Math.min(ta,Ta);1!==ta&&(v*=ta);1!==Ta&&(D*=Ta);this.uff(b,h,v,D)}uff(b,h,v,D){this.Oj.mmo(b,h,v,D)}e5m(){u.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}XIa(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}Upj(b){const h=
ke.ImageReader.pEa(b);b=ke.ImageReader.oEa(b);return 0>=h||0>=b}static get Wg(){return io.ContextSetEditor.instance}static get Xf(){return xi.a.instance}static get Ic(){return Ye.a.instance}}et.VYf=null;Object(n.a)(et,"ImageActor",null,[]);var qH=c(1156),rH=c(1157),QM=c(1090);class BG{constructor(b,h,v,D,Q){this.imagePropertySet=b;this.graphNode=h;this.qgf=v;this.wkm=D;this.DMc=Q;if(this.w2a=Ya.App.instance&&Ya.App.instance.w2a())this.nBe=new QM.a(this.Lr(),BG.ync)}rotate(b){this.Hha("rotate");if(null===
this.imagePropertySet||void 0===this.qgf||void 0===this.DMc)return this.mY("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.imagePropertySet.$Eb();if(0!==b){const v=this.DMc.Nim();v.rotation=b;try{if(!this.Wth(v,h))return this.mY("rotate","Failed to apply and update"),!1}catch(D){return this.mY("rotate",D.stack?D.stack:D.message?D.message:D.toString()),!1}}return!0}resize(b,h){this.Hha("resize");if(null===this.imagePropertySet||void 0===this.qgf||
void 0===this.DMc)return this.mY("resize","Argument(s) invalid"),!1;const v=this.getGraphicData("resize");if(void 0===v)return!1;let D=0;var Q=0;({width:D,height:Q}=ke.ImageReader.yhb(this.imagePropertySet));b/=D;h/=Q;Q=this.DMc.Oim();Q.scale=this.DMc.$bm();Q.scale.width=b;Q.scale.height=h;try{if(!this.Wth(Q,v))return this.mY("resize","Failed to apply and update"),!1}catch(ba){return this.mY("resize",ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}return!0}static get ync(){return Ga.a.instance.Na("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.w2a){const h=
this.nBe.Phi();return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.mY(b,h.stack?h.stack:h.message?h.message:h.toString())}}Wth(b,h){this.qgf.apply(b,h);b=this.imagePropertySet.JDb(h);if(void 0===b)return!1;this.jSo(b);return!0}jSo(b){const h=new ah.GraphTransaction(15);h.Cb(this.graphNode);this.imagePropertySet.setValue(qe.a.gU,b.gU);this.wkm.f$n(b.QXh,b.Uwa,this.imagePropertySet);h.dispose()}Lr(){return Rl.PageNavigator.instance.Xs(this.graphNode)}Hha(b){const h=
this.yrg;h.edit=b;u.ULS.sendTraceTag(509657553,322,50,"{0}",h)}mY(b,h){const v=this.yrg;v.message=h;v.edit=b;u.ULS.sendTraceTag(509666444,322,15,"{0}",v)}get yrg(){return{["id"]:ke.ImageReader.ZOa(this.imagePropertySet),["type"]:ke.ImageReader.mk(this.imagePropertySet)}}}Object(n.a)(BG,"EditWithGC2Command",null,[]);class sH{f$n(b,h,v){this.o_m(b,h);this.i$n(v)}o_m(b,h){this.EH=Array(4);this.EH[0]=b.Egf;this.EH[2]=b.Ggf;this.EH[1]=b.Fgf;this.EH[3]=b.Dgf;this.lOa=b.lOa;this.mOa=b.mOa;(this.Uwa=h)&&
this.W5k()}i$n(b){b.setValue(qe.a.Vva,Math.round(this.lOa).toString());b.setValue(qe.a.Wva,Math.round(this.mOa).toString());const h=Array(4);this.EH.forEach((v,D)=>{h[D]=Math.round(v).toString()});b.setValue(qe.a.mPa,h);b.setValue(qe.a.I2a,this.Uwa)}W5k(){this.rEo();const b=this.lOa/2,h=this.mOa/2;this.lOa%2&&0===this.mOa%2?(--this.EH[0],++this.EH[2]):this.mOa%2&&0===this.lOa%2&&(++this.EH[0],--this.EH[2]);this.EH[0]+=b-h;this.EH[1]-=b-h;this.EH[2]+=h-b;this.EH[3]-=h-b}rEo(){const b=this.lOa;this.lOa=
this.mOa;this.mOa=b}}Object(n.a)(sH,"GraphicsExtents",null,[]);var CG=c(688),qK=c(516),RM=c(515),SM=c(1466);class Zq extends et{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){super(b,h,D,ba,ta,Ta,ob);this.k5g=!1;this.LAa=this.haa=null;this.yw=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;if(1===Dc)return this.nf.b4?2:32;Vb=parseInt(gd);u.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Vb);this.std.eMn(bc,ke.ImageReader.Zm(bc),Vb);this.RXc(bc);this.XIa();return 32};this.Qde=(Vb,bc,Dc)=>{if(!this.cO(bc))return 8;
u.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Vb=ke.ImageReader.Zm(bc);if(1===Dc)return this.nf.b4?2:32;Dc=ke.ImageReader.zhb(Vb);1===Dc?(Dc=new ah.GraphTransaction(15),Dc.Cb(bc.node),ke.ImageReader.N$b()?Vb.setValue(lc.a.kLb,""):this.oK.NYn(Vb),Dc.dispose(),this.Kzc.create(Vb,bc).yw(Lf.a.fdj),this.RXc(bc)):2===Dc&&this.Kzc.create(Vb,bc).yw(Lf.a.fdj);return 32};this.zmm=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;Vb=ke.ImageReader.Zm(bc);if(1===Dc)return this.nf.b4||ke.ImageReader.xac(Vb)?
2:32;gd&&(this.oK.r$c(Vb,bc),u.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Ya.App.xa.updateCommandUI());this.XIa();return 32};this.Amm=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;if(1===Dc)return this.nf.b4?2:32;Vb=ke.ImageReader.Zm(bc);if(gd){Dc=ke.ImageReader.CXd(ke.ImageReader.Zm(bc));u.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Dc);Oc=gd.ia(wc.a.Jib,0);const rd=gd.ia(wc.a.Gib,0),je=gd.ia(wc.a.Hib,0);gd=gd.ia(wc.a.Iib,0);const Ld=ke.ImageReader.Bba(Vb),
Qd=Ld.bottom,ge=Ld.left,ze=Ld.right;if(Oc===Ld.top&&rd===Qd&&je===ge&&gd===ze)return u.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;Dc?(new qH.a(Vb,new rH.a)).ggo(Oc,rd,je,gd,this.fmn,bc):this.std.VLn(bc,ke.ImageReader.Zm(bc),Oc,rd,je,gd);this.RXc(bc);Ya.App.xa.updateCommandUI()}return 32};this.mUd=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;Oc=ke.ImageReader.Zm(bc);if(1===Dc)return this.nf.b4||ke.ImageReader.xac(Oc)?2:32;if(gd){u.ULS.sendTraceTag(22552775,
322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.oK.Bwa()||this.oK.r$c(Oc,bc);switch(Vb){case sc.a.IRc:Vb=gd.ia(wc.a.Jib,-1);Dc=0;break;case sc.a.BRc:Vb=gd.ia(wc.a.Gib,-1);Dc=1;break;case sc.a.CRc:Vb=gd.ia(wc.a.Hib,-1);Dc=2;break;case sc.a.DRc:Vb=gd.ia(wc.a.Iib,-1);Dc=3;break;default:return 8}this.oK.RUo(Vb,Dc);this.RXc(bc);Ya.App.xa.updateCommandUI()}return 32};this.hnb=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;ke.ImageReader.Zm(bc);gd&&(Vb=this.oK.Bwa(),gd.setValue(wc.a.Bwa,
Vb));return 32};this.ogc=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;Vb=ke.ImageReader.Zm(bc);if(gd){if(this.oK.Bwa())({top:rd,bottom:Dc,left:Vb,right:bc}=this.oK.hSl());else{Oc=Cf.a.xf(ke.ImageReader.dF(Vb),0);var rd=Cf.a.xf(ke.ImageReader.wG(Vb),1);bc=ke.ImageReader.Bba(Vb);const je=Math.max(bc.top,0);Dc=Math.max(bc.bottom,0);Vb=Math.max(bc.left,0);bc=Math.max(bc.right,0);Oc=1E5*Oc/(1E5-(Vb+bc));const Ld=1E5*rd/(1E5-(je+Dc));rd=Math.floor(je*Ld/1E5);Dc=Math.floor(Dc*Ld/1E5);Vb=Math.floor(Vb*Oc/
1E5);bc=Math.floor(bc*Oc/1E5)}gd.setValue(wc.a.Jib,rd);gd.setValue(wc.a.Gib,Dc);gd.setValue(wc.a.Hib,Vb);gd.setValue(wc.a.Iib,bc)}return 32};this.Z8b=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;if(1===Dc){if(this.nf.b4)return 2;this.B7m();return 32}Vb=ke.ImageReader.Zm(bc);this.oK.Bwa()&&this.oK.r$c(Vb,bc);Vb=gd.ia(wc.a.LHa,"");gd=gd.ia(wc.a.t8a,0);u.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:gd,["SourceControlId"]:Vb});switch(gd){case 1:this.oK.eno(bc);break;case 8:this.oK.khe(bc,
1,1);break;case 9:this.oK.khe(bc,1,3);break;case 3:this.oK.khe(bc,2,void 0,!0);break;case 4:this.oK.khe(bc,2,void 0,!1)}this.XIa();Ya.App.xa.updateCommandUI();return 32};this.Dgc=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;Vb=ke.ImageReader.Zm(bc);bc=ke.ImageReader.g4(bc);Dc=ke.ImageReader.E8(Vb);Oc=ke.ImageReader.L8b(Vb);Vb=ke.ImageReader.Ex(Vb);return this.TLn(bc,Dc,Oc,Vb,gd)?32:8};this.Cmm=(Vb,bc,Dc,Oc,gd)=>{var rd;if(!this.pCa(bc))return 8;Oc=ke.ImageReader.Zm(bc);if(1===Dc)return ac.SessionStatusManager.instance.Aj?
8:this.nf.b4||ke.ImageReader.yac(Oc)?2:32;this.oK.Bwa()&&this.oK.r$c(Oc,bc);if(this.Uwi(Oc)&&(Dc=null===(rd=x())||void 0===rd?void 0:rd.F3b(),rd=new BG(Oc,bc.node,Dc,new sH,y()),Dc=gd.ia(wc.a.qJ,0),rd.rotate(Dc)))return 32;if(gd){Dc=gd.ia(wc.a.PRc,0);const je=ke.ImageReader.CXd(Oc);u.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",Dc,je);rd=ke.ImageReader.A_(Oc);let Ld=ke.ImageReader.APd(Oc),Qd=ke.ImageReader.kEb(Oc);switch(Dc){case 0:rd=gd.ia(wc.a.qJ,0);break;case 2:rd-=
90;rd=xh.c(rd);break;case 1:rd+=90;rd=xh.c(rd);break;case 4:Ld=!Ld;break;case 3:Qd=!Qd;break;case 5:rd+=gd.ia(wc.a.qJ,0),rd=xh.c(rd)}je?(new qH.a(Oc,new rH.a)).Alo(rd,Ld,Qd,this.rsn,bc):Dc?this.Kzc.create(Oc,bc).Jko(rd,Ld,Qd):(gd=sb.a.create(),Dc=new ah.GraphTransaction(15,Eb.a.imageRotate),Dc.Cb(bc.node),this.oK.wio(Oc,rd),this.std.aMn(bc,ke.ImageReader.Zm(bc),rd,gd),Dc.TFa(gd,1),Dc.fk=Vb,Dc.dispose());this.XIa();this.RXc(bc);Ya.App.xa.updateCommandUI()}return 32};this.dMb=(Vb,bc,Dc,Oc,gd)=>{if(!this.cO(bc))return 8;
Vb=ke.ImageReader.Zm(bc);Vb=ke.ImageReader.A_(Vb);if(0>Vb)return 2;gd.setValue(wc.a.qJ,Vb);return 32};this.rsn=(Vb,bc,Dc,Oc)=>{if(Vb){const gd=new ah.GraphTransaction(15,Eb.a.imageRotate);gd.Cb(Oc.node);bc.setValue(wc.a.nAb,JSON.stringify(Dc));bc.setValue(wc.a.au,Vb);this.oK.rge(bc,Dc.rotationAngle,Dc.x9b,Dc.Ymc);this.zDb(bc);gd.dispose()}};this.csn=(Vb,bc,Dc,Oc)=>{if(Vb){const gd=new ah.GraphTransaction(15);gd.Cb(Oc.node);bc.setValue(wc.a.nAb,JSON.stringify(Dc));bc.setValue(wc.a.au,Vb);this.oK.Yfe(bc,
Dc.Nme,Dc.vad);this.zDb(bc);gd.dispose()}};this.fmn=(Vb,bc,Dc,Oc)=>{if(Vb){const gd=new ah.GraphTransaction(15);gd.Cb(Oc.node);bc.setValue(wc.a.nAb,JSON.stringify(Dc));bc.setValue(wc.a.au,Vb);this.oK.qio(bc,Math.round(Dc.Iua*CG.a.ifb),Math.round(Dc.Fua*CG.a.ifb),Math.round(Dc.Gua*CG.a.ifb),Math.round(Dc.Hua*CG.a.ifb));this.zDb(bc);gd.dispose()}};this.A1c=(Vb,bc,Dc,Oc,gd)=>{if(!this.pCa(bc))return 8;if(1===Dc)return 32;Vb=bc.contextId===Zb.a.view?bi.PageReader.instance.JQd(bc):Rl.PageNavigator.instance.Xs(bc.node);
if(!Vb)return 8;Dc=ke.ImageReader.Zm(bc);bc=this.Ho.mdi(sl.a.ZT(bc),Dc);Zq.T0i.KNb=bc;this.tVc&&this.recentColors.Kne(bc);bc=Zq.T0i.EMc(Vb,Ya.App.FAb);if(!bc)return 8;gd.MenuItems=bc;return 32};this.R9=(Vb,bc,Dc,Oc,gd)=>{if(!this.pCa(bc))return 8;if((Oc=ke.ImageReader.Zm(bc))&&ke.ImageReader.qy(Oc))return 2;if(1===Dc)return 32;if(2!==Dc)return 2;if(!gd)return u.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Dc=new ah.GraphTransaction(15);Dc.Cb(bc.node);const rd=Zq.o7a.iua(bc.node,
gd);this.Ho.R9(Oc,gd,bc,rd);this.zDb(Oc);Dc.dispose();Vb==Eb.a.Z6c&&this.recentColors.UYa(gd);this.cdd();this.XIa();return 32};this.bia=(Vb,bc,Dc)=>{if(!this.pCa(bc))return 8;if(1===Dc)return 32;Ya.App.xa.Xw();Zq.x9a=new Mx.a("PictureBorder",Eb.a.Z6c);Zq.x9a.zjc(0);return 32};this.Uia=(Vb,bc,Dc,Oc,gd)=>{if(!this.pCa(bc))return 8;if(1===Dc)return 32;if((Vb=ke.ImageReader.Zm(bc))&&ke.ImageReader.qy(Vb))return 2;if(!gd)return u.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),
8;Dc=new ah.GraphTransaction(15);Dc.Cb(bc.node);this.Ho.Uia(Vb,gd,bc);this.zDb(Vb);Dc.dispose();this.cdd();this.XIa();return 32};this.z6a=(Vb,bc,Dc,Oc,gd)=>{if(!this.pCa(bc))return 8;if(1===Dc)return 32;if((Vb=ke.ImageReader.Zm(bc))&&ke.ImageReader.qy(Vb))return 2;if(!gd)return u.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;Dc=new ah.GraphTransaction(15);Dc.Cb(bc.node);this.Ho.z6a(Vb,gd,bc);this.zDb(Vb);Dc.dispose();this.cdd();this.XIa();return 32};this.Yce=(Vb,bc,
Dc)=>{if(!this.pCa(bc))return 8;if(1===Dc)return 32;Vb=ke.ImageReader.Zm(bc);Dc=new ah.GraphTransaction(15);Dc.Cb(bc.node);ke.ImageReader.j9b(Vb)&&(this.Ho.Yce(Vb),this.zDb(Vb));Dc.dispose();this.cdd();this.XIa();return 32};this.oK=b;this.Kzc=v;this.std=Q;Zq.Mh=Kb;et.VYf=Zq.aCn}get recentColors(){return null!=this.DFg?this.DFg:this.DFg=Ga.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get Ho(){this.haa||(this.haa=new qK.a);return this.haa}Tb(b){super.Tb(b);this.nr(b,Eb.a.yw,this.yw);b.Vc(Eb.a.yw,
4);this.nr(b,Eb.a.Qde,this.Qde);this.nr(b,sc.a.kpe,this.Z8b);b.Vc(sc.a.kpe,4);this.nr(b,sc.a.lpe,this.Z8b);this.nr(b,sc.a.mpe,this.Z8b);this.nr(b,sc.a.npe,this.Z8b);this.nr(b,sc.a.ope,this.Z8b);this.nr(b,sc.a.ppe,this.Z8b);this.nr(b,sc.a.Dgc,this.Dgc);b.Vc(sc.a.Dgc,101);this.nr(b,sc.a.imageCrop,this.zmm);b.Vc(sc.a.imageCrop,4);this.nr(b,sc.a.hnb,this.hnb);b.Vc(sc.a.hnb,101);this.nr(b,sc.a.Eoi,this.Amm);this.nr(b,sc.a.IRc,this.mUd);this.nr(b,sc.a.BRc,this.mUd);this.nr(b,sc.a.CRc,this.mUd);this.nr(b,
sc.a.DRc,this.mUd);this.nr(b,sc.a.x2c,this.ogc);b.Vc(sc.a.x2c,101);this.nr(b,sc.a.Jae,this.ogc);b.Vc(sc.a.Jae,101);this.nr(b,sc.a.Kae,this.ogc);b.Vc(sc.a.Kae,101);this.nr(b,sc.a.Lae,this.ogc);b.Vc(sc.a.Lae,101);this.nr(b,Eb.a.imageRotate,this.Cmm);b.Vc(Eb.a.imageRotate,4);this.nr(b,Eb.a.dMb,this.dMb);b.Vc(Eb.a.dMb,101);this.nr(b,Eb.a.A1c,this.A1c);b.Vc(Eb.a.A1c,4);this.nr(b,Eb.a.R9,this.R9);b.Vc(Eb.a.R9,4);this.nr(b,Eb.a.Z6c,this.R9);b.Vc(Eb.a.Z6c,4);this.nr(b,Eb.a.FWf,this.bia);b.Vc(Eb.a.FWf,4);
this.nr(b,Eb.a.Xxa,this.Xxa.bind(this));b.Vc(Eb.a.Xxa,4);this.nr(b,Eb.a.Uia,this.Uia);b.Vc(Eb.a.Uia,4);this.nr(b,Eb.a.fMb,this.fMb.bind(this));b.Vc(Eb.a.fMb,4);this.nr(b,Eb.a.z6a,this.z6a);b.Vc(Eb.a.z6a,4);this.nr(b,Eb.a.PQf,this.Yce);b.Vc(Eb.a.PQf,4)}uff(b,h,v,D){var Q;u.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+ke.ImageReader.CXd(b));this.oK.Bwa()&&this.oK.r$c(b,h);if(this.Uwi(b)){const ba=null===(Q=x())||void 0===Q?void 0:Q.F3b();if((new BG(b,h.node,ba,new sH,y())).resize(v,
D))return}ke.ImageReader.qy(b)?(b=sb.a.create(),Q=new ah.GraphTransaction(15),Q.Cb(h.node),this.std.$Ln(h,ke.ImageReader.Zm(h),v,D,b),Q.TFa(b,1),Q.dispose()):ke.ImageReader.wjc(b)?(new qH.a(b,new rH.a)).klo(v,D,this.csn,h):(super.uff(b,h,v,D),this.Ld.Ls(13))}cO(b){if(!b.el)return!1;var h=b.node;return(h=Ya.App.instance&&Ya.App.instance.lHb?h instanceof op.a||h instanceof SM.a?h:null:Object(Ka.a)(op.a,h))&&Bx.n(h)?(et.Ic.Yb(OM.a.hn,{["Reason"]:PM.a.hO}),!1):super.cO(b)}static aCn(b){b&&!Zq.Svb&&(Zq.Mh.XYa(Zq.Tlb),
Zq.Svb=!0)}TLn(b,h,v,D,Q){return Q?(Q.qxi=b,Q.E8=h,Q.TPb=v,Q.rw=D,Q.t8a=Zq.Vim(Q),!0):!1}Uwi(b){b=ke.ImageReader.mk(b);const h=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return Ya.App.instance&&Ya.App.instance.f4(b)?(w.AFrameworkApplication.te("editswithgc2;editswithgc2cf"),h):!1}RXc(b){Ya.App.qd.Qo&&Ya.App.qd.Qp.QF(b.node)}B7m(){this.k5g||(u.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.k5g=!0)}zDb(b){const h=RM.a.instance.nif(b);
this.oK.pge(b,h[0],h[1],h[2],h[3])}Xxa(b,h,v,D,Q){2===v&&(b=ke.ImageReader.Zm(h),this.Ho.dSj(Q,b));return 32}fMb(b,h,v,D,Q){2===v&&(b=ke.ImageReader.Zm(h),this.Ho.cSj(Q,b));return 32}cdd(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get o7a(){return null!=
Zq.BHg?Zq.BHg:Zq.BHg=Zh.a.instance}static get T0i(){Zq.GV||(Zq.GV=new yz.a("PictureBorder"),Zq.TEa(Zq.GV));return Zq.GV}static Vim(b){if(b.qxi)b=1;else switch(b.TPb){case 2:b=b.E8?3:4;break;case 1:b=1===b.rw?8:3===b.rw?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=0}return b}static TEa(b){b.OW(3,Eb.a.R9);b.OW(4,Eb.a.R9);b.OW(5,Eb.a.Z6c);b.OW(6,Eb.a.R9);b.bzb(bw.a.instance,1)}get tVc(){null==this.LAa&&(w.AFrameworkApplication.te("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),
this.LAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.LAa}}Zq.Svb=!1;Zq.GV=null;Zq.x9a=null;Zq.Tlb=()=>{Zq.Mh.ahc(Zq.Tlb);Zq.Svb=!1;if(Lh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else u.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};
Object(n.a)(Zq,"ImageActor",et,[]);class ln{static get paragraphEditor(){return null!=ln.XEg?ln.XEg:ln.XEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get MA(){return null!=ln.hFg?ln.hFg:ln.hFg=Ga.a.instance.resolve("Box4.IParagraphIndentationReader")}static get B0(){return ln.paragraphEditor.gq}static get Pg(){return null!=ln.DIg?ln.DIg:ln.DIg=Ga.a.instance.resolve("Box4.IUndoManager")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Eb.a.QLb,Zb.a.view,Cg.a.dw);b.qa(Eb.a.QLb,Zb.a.paragraph,
ln.Tla);b.Vc(Eb.a.QLb,1036);b.qa(Eb.a.XBb,Zb.a.view,Cg.a.dw);b.qa(Eb.a.XBb,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.XBb,1036);b.qa(Eb.a.yfb,Zb.a.view,Cg.a.dw);b.qa(Eb.a.yfb,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.yfb,1036);b.qa(Eb.a.Wgc,Zb.a.view,Cg.a.dw);b.qa(Eb.a.Wgc,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.Wgc,1036);b.qa(Eb.a.$3c,Zb.a.view,Cg.a.dw);b.qa(Eb.a.$3c,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.$3c,1036);b.qa(Eb.a.f2a,Zb.a.view,Cg.a.dw);b.qa(Eb.a.f2a,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.f2a,1036);b.qa(Eb.a.Nib,Zb.a.view,
Cg.a.dw);b.qa(Eb.a.Nib,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.Nib,1036);b.qa(Eb.a.e2a,Zb.a.view,Cg.a.dw);b.qa(Eb.a.e2a,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.e2a,1036);b.qa(Eb.a.tge,Zb.a.view,ln.oje);b.qa(Eb.a.tge,Zb.a.paragraph,ln.oje);b.Vc(Eb.a.tge,1028);b.qa(Eb.a.Cag,Zb.a.view,ln.oje);b.qa(Eb.a.Cag,Zb.a.paragraph,ln.oje);b.Vc(Eb.a.Cag,1028);b.qa(Eb.a.mOb,Zb.a.view,Cg.a.dw);b.qa(Eb.a.mOb,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.mOb,1036);b.qa(Eb.a.uob,Zb.a.view,Cg.a.dw);b.qa(Eb.a.uob,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.uob,
1036);b.qa(Eb.a.nOb,Zb.a.view,Cg.a.dw);b.qa(Eb.a.nOb,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.nOb,1036);b.qa(Eb.a.mfg,Zb.a.view,Cg.a.dw);b.Vc(Eb.a.mfg,1028);b.qa(Eb.a.j7c,Zb.a.view,Cg.a.dw);b.qa(Eb.a.j7c,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.j7c,1036);b.qa(Eb.a.k7c,Zb.a.view,Cg.a.dw);b.qa(Eb.a.k7c,Zb.a.paragraph,ln.Tla);b.Vc(Eb.a.k7c,1036)}static oje(b,h,v,D,Q){2===v&&""===Q[kh.a.Text]&&(b=b===Eb.a.tge?Eb.a.f2a:Eb.a.e2a,h=new rD.a,h.value=0,h.unit=Ya.App.qFa?2:1,w.AFrameworkApplication.va.Qb(b,2,h),Ya.App.xa.updateCommandUI());
return 32}static Tla(b,h,v,D,Q){if(!({gy:v}=Cg.a.Ncg(v,h)).returnValue)return v;h=h.node;switch(b){case Eb.a.QLb:ln.B0.E0f(h,!0);break;case Eb.a.XBb:ln.B0.E0f(h,!1);break;case Eb.a.yfb:ln.B0.yfb(h);break;case Eb.a.Wgc:ln.B0.dda(h,0);break;case Eb.a.$3c:ln.B0.job(h,0);break;case Eb.a.Nib:case Eb.a.f2a:v=new ne.GraphIterator;v.set(h);v.zb(11);let ba=Q.value;Q=Q.unit;b===Eb.a.Nib&&(ba=(new dq.a(Q,ba)).Lt+ln.MA.vG(h).Lt,Q=1);ln.B0.Dya(v,Q,ba);break;case Eb.a.e2a:ln.B0.$Nb(h,Q.unit,Q.value);break;case Eb.a.mOb:Q?
(b=(new dq.a(Q.unit,Q.value)).Lt,ln.B0.dda(h,b)):ln.MA.fPd(h).Lt||ln.B0.dda(h,dh.OutlineReader.xX(h));break;case Eb.a.uob:Q?(b=(new dq.a(Q.unit,Q.value)).Lt,ln.B0.job(h,b)):ln.MA.vG(h).Lt||ln.B0.job(h,dh.OutlineReader.xX(h));break;case Eb.a.nOb:ln.B0.dda(h,0);break;case Eb.a.j7c:b=Q;b=(new dq.a(b.unit,b.value)).Lt;ln.B0.sbg(h,1,b);break;case Eb.a.k7c:b=Q,b=(new dq.a(b.unit,b.value)).Lt,ln.B0.sbg(h,2,b)}ln.Pg.iF();D&&js.a.Epb&&(D.ns|=js.a.khb(h));return 32}}Object(n.a)(ln,"IndentationActor",null,[]);
var rK=c(380),TM=c(64),DG=c(417),UM=c(1199);class Dr{constructor(b){this.gXa=this.UBa=this.Oxc=null;this.Ykh=!1;this.T$d=h=>{if(this.UBa)if(h===Ua.a.S$d)$c.FocusManager.instance().getRegion(gf.AFrame.c5a).Kdc();else if(h===Ua.a.R$d)$c.FocusManager.instance().getRegion(gf.AFrame.c5a).Idc();else return 2;else return 2;return 32};this._frame=b}oBo(){if(this.Ykh)this.OEi();else{const b=Xa.a.create(w.AFrameworkApplication.K.jb("WopiBootstrapUrl"));b.UZ((h,v)=>{v.succeeded?(this.Ykh=!0,this.OEi()):u.ULS.sendTraceTag(40436806,
323,10,"Failed to download word.boot.js")});Ib.a.rX(b)}}OEi(){if(this.Oxc)u.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.bra;this.UBa=document.createElement("div");b.parentNode.insertBefore(this.UBa,b);this.gXa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:w.AFrameworkApplication.K.jb("FileName"),reactRoot:this.UBa});this.gXa.setWebpackPublicPath(w.AFrameworkApplication.t5);this.gXa.renderDocumentPanel()}}y_l(b){const h=
{};h.Container=b;h.BootstrapperUrl=w.AFrameworkApplication.K.jb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.zqb;b={};b.HostName=w.AFrameworkApplication.K.jb("FileSource");b.HostSessionId=w.AFrameworkApplication.K.jb("HostSessionId");b.UserId=w.AFrameworkApplication.K.jb("UserId");b.DocumentClickTime=new Date(this._frame.mlb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=w.AFrameworkApplication.K.jb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,
Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.mlb;h.Diagnostics=b;b={};b.WopiSrc=w.AFrameworkApplication.K.jb("WopiSrc");b.AccessToken=w.AFrameworkApplication.K.jb("AccessToken");b.AccessTokenTtl=w.AFrameworkApplication.K.jb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=v=>{Dr.JW=v;this.gXa.setMaxPage(Dr.JW.GetPageCount());
this.gXa.setCurrentPage(Dr.JW.GetCurrentPage());this.gXa.setPageControlVisible(!0);Dr.JW.RegisterEventHandler("PageChanged",D=>{this.gXa.setCurrentPage(D.newPage)});Dr.JW.RegisterEventHandler("BrowserEvent",D=>{27===D.keyCode?this.closeViewer():D.button&&1!==D.button||this.UBa.click()});v=this._frame.mlb-(new Date).getTime();u.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",v);this.Tb();$c.FocusManager.instance().nL(gf.AFrame.c5a,!0);this.buildFocusRegion();this.RGa($c.FocusManager.instance().fe(gf.AFrame.c5a));
this.UBa.click()};h.FnOnInitializeFailure=(v,D)=>{u.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",v.toString(),D.toString());this.closeViewer()};return h}buildFocusRegion(){const b=$c.FocusManager.instance();var h=b.getRegion(gf.AFrame.c5a);h=[2,3];const v=b.fe(gf.AFrame.c5a),D=new Ie.DOMFocusListing(()=>this.UBa);D.Tpa=!0;for(const Q of h)D.Xm(Q);h=b.ema(()=>this.UBa,v,D);h.oSa();h.oR=!0;h.ZZa=!0;D.Iy(D.pga)}Tb(){w.AFrameworkApplication.va.qa(Ua.a.S$d,Kd.a.frame,this.T$d);w.AFrameworkApplication.va.qa(Ua.a.R$d,
Kd.a.frame,this.T$d)}RGa(b){b.ir($c.FocusManager.instance().vW);b.ir($c.FocusManager.instance().wW);b.bindAction($c.FocusManager.instance().vW,Ua.a.S$d);b.bindAction($c.FocusManager.instance().wW,Ua.a.R$d)}loadViewer(b){b=this.y_l(b);this.Oxc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.Oxc.Complete(b.WopiInfo)}closeViewer(){$c.FocusManager.instance().CR(gf.AFrame.c5a);Dr.JW&&(Dr.JW.Dispose(),Dr.JW=null,w.AFrameworkApplication.va.Qv(Ua.a.S$d,Kd.a.frame,this.T$d),w.AFrameworkApplication.va.Qv(Ua.a.R$d,
Kd.a.frame,this.T$d));this.Oxc&&(this.UBa.parentNode.removeChild(this.UBa),this.UBa=this.Oxc=null)}printAction(){u.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");w.AFrameworkApplication.va.processAction(Eb.a.print,2)}downloadPdfAction(){u.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");w.AFrameworkApplication.va.processAction(sc.a.aKc,2)}downloadCopyAction(){u.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");w.AFrameworkApplication.va.processAction(Ua.a.downloadACopy,
2)}zoomInAction(){if(Dr.JW){let b=Dr.JW.GetZoomLevel();b+=.2;Dr.JW.SetZoomLevel(b)}}zoomOutAction(){if(Dr.JW){let b=Dr.JW.GetZoomLevel();b-=.2;Dr.JW.SetZoomLevel(b)}}setPage(b){if(Dr.JW){const h=Dr.JW.GetPageCount();1>b?(Dr.JW.SetCurrentPage(1),this.gXa.setCurrentPage(1)):1<=b&&b<=h?Dr.JW.SetCurrentPage(b):(Dr.JW.SetCurrentPage(h),this.gXa.setCurrentPage(h))}}static getInstance(b){Dr.YNe||(Dr.YNe=new Dr(b));return Dr.YNe}}Dr.JW=null;Dr.YNe=null;Object(n.a)(Dr,"PreviewPanelActor",null,[]);class Gq{static get rJj(){return null!=
Gq.YIg?Gq.YIg:Gq.YIg=w.AFrameworkApplication.K.jb("ClassicViewModePreferenceCookieName")}static Tb(b,h){b.fb(Eb.a.readingMode,Kd.a.frame,Gq.MKj,128);b.qa(Eb.a.rke,Kd.a.frame,Gq.MKj);Gq.JN=h;b.qa(sc.a.GXm,Kd.a.frame,Gq.tcc);b.qa(sc.a.tcc,Kd.a.frame,Gq.tcc);b.qa(sc.a.bXc,Kd.a.frame,Gq.bXc);b.fb(sc.a.OKn,Kd.a.frame,Gq.ugc,96);b.fb(sc.a.ugc,Kd.a.frame,Gq.ugc,96);b.fb(sc.a.Y2c,Kd.a.frame,Gq.Y2c,96)}static MKj(b,h,v){if(h.contextId!==Kd.a.frame)return 2;h=Jd.App.un;switch(b){case Eb.a.readingMode:if(!h.zqb)return 8;
if(1===v)return ac.SessionStatusManager.instance.Aj?8:32;b=(new Date).getTime();wi.a.instance.nSn(b);h.mlb=b;w.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Lv.a.LQ(3,!0,Gq.JFn,null,h):Lv.a.LQ(3,!0,Gq.zPi,null,h);return 32;case Eb.a.rke:return 32;default:return 2}}static zPi(b){DG.a()?Gq.whm(b):Gq.Dwj(b)}static whm(b){const h={};h[H.a.$xf]=Gq.rJj;w.AFrameworkApplication.PO().execute(v=>{v.Av(L.a.ayf);v.qQo(L.a.ayf);v.OB(L.a.ayf,D=>{Gq.yUk(D,b)});v.sendMessage(L.a.FYl,h)})}static yUk(b,
h){b.Values[H.a.$xf]===Gq.rJj&&("true"===b.Values[H.a.Pni]?Gq.Dwj(h):(Gq.FTo(),Gq.DEo()))}static FTo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};w.AFrameworkApplication.te("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static DEo(){w.AFrameworkApplication.kv=
!0;Ya.App.xa.b$(1);Ya.App.xa.hb.tu&&Ya.App.xa.hb.tu.Vi&&Ya.App.xa.hb.tu.Pzf();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Ya.App.xa.updateCommandUI();UM.PageView.FAj(w.AFrameworkApplication.K)}static Dwj(b){try{const h=new Va.a;let v,D;w.AFrameworkApplication.LJj?(v=Ya.App.hostUrl,D=3):(v=b.zqb,D=1);b.mlb&&h.add(w.AFrameworkApplication.jNf,b.mlb.toString());w.AFrameworkApplication.cCf&&h.add(w.AFrameworkApplication.V9e,"1");w.AFrameworkApplication.F5e&&
h.add(w.AFrameworkApplication.P3k,"1");h.add(rK.a.Jng,rK.a.userSessionData);h.add(w.AFrameworkApplication.W$d,w.AFrameworkApplication.userSessionId);const Q=w.AFrameworkApplication.K.jb(w.AFrameworkApplication.vja);Q&&h.add(w.AFrameworkApplication.SCj,Q);u.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");DG.b(w.AFrameworkApplication.K)?DG.d("view",h,DG.c):(v=ja.a.eoh(v,h),w.AFrameworkApplication.LJj?Id.a.om(v,Id.a.dra(D),void 0,"AuthenticationLostDuringSession"):Id.a.openWindow(D,v,!1,
void 0,TM.a.Vaj))}catch(h){}}static JFn(b){u.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ga.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Pz.loadScript("previewPanel")).catch(()=>{u.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Gq.zPi(b)}).then(()=>{Dr.getInstance(b).oBo()})}static tcc(b,h,v){if(1===v)return 32;Gq.JN.akj(1);Ya.App.xa.updateCommandUI();
return 32}static bXc(b,h,v){if(1===v)return 32;Gq.JN.akj(0);Ya.App.xa.updateCommandUI();return 32}static ugc(b,h,v,D,Q){if(1===v)return 32;Q[Ff.a.On]=1===Gq.JN.Wu;return 32}static Y2c(b,h,v,D,Q){if(1===v)return 32;Q[Ff.a.On]=!Gq.JN.Wu;return 32}}Gq.JN=null;Object(n.a)(Gq,"MainViewModeActor",null,[]);class sK{constructor(b,h,v){this.D9m=(D,Q,ba,ta,Ta)=>1===ba?32:(D=this.Qk.s8(Q.$j))?(Ta=3===Ta.Ix,this.k6.value.wLh(this.W8l(D),this.lFb(D),Ta),32):2;this.ga=b;this.k6=h;this.Qk=v}Tb(){this.ga.qa(sc.a.wIf,
Zb.a.view,this.D9m);this.ga.fb(sc.a.Pae,Zb.a.view,qm.d,96);this.ga.fb(sc.a.Mae,Zb.a.view,qm.d,96);this.ga.fb(sc.a.Nae,Zb.a.view,qm.d,96);this.ga.fb(sc.a.Oae,Zb.a.view,qm.d,96);this.ga.qa(sc.a.d0c,Zb.a.view,qm.c);this.ga.qa(sc.a.c0c,Zb.a.view,qm.c);this.ga.qa(sc.a.x8d,Zb.a.view,qm.c);this.ga.qa(sc.a.y8d,Zb.a.view,qm.c)}W8l(b){const h=new fh.DictionaryPropertySet;h.setValue(lc.a.marginTop,this.Qk.Cna(b));h.setValue(lc.a.marginBottom,this.Qk.Lva(b));h.setValue(lc.a.marginLeft,this.Qk.mJ(b));h.setValue(lc.a.marginRight,
this.Qk.ZK(b));return h}lFb(b){const h=new fh.DictionaryPropertySet;h.setValue(lc.a.Bo,this.Qk.$t(b));h.setValue(lc.a.nv,this.Qk.wB(b));return h}}Object(n.a)(sK,"MarginsDialogActor",null,[]);class tK{constructor(b,h,v,D){this.ga=b;this.$c=h;this.DLa=v;this.y_j=D;this.Xvd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],VPj:["Summary","Updates","Challenges","Opportunities","What's Next"],iSj:["Highlights","Itinerary","Food","Activities"],mOj:["Introduction","Step 1",
"Step 2","Step 3"]}}Tb(){this.ga.fb(sc.a.cOi,Zb.a.Tc,this.sEk.bind(this),1028);this.ga.fb(sc.a.gNf,Zb.a.Tc,this.qEc.bind(this),1028);this.ga.fb(sc.a.eNf,Zb.a.Tc,this.qEc.bind(this),1028);this.ga.fb(sc.a.dNf,Zb.a.Tc,this.qEc.bind(this),1028);this.ga.fb(sc.a.hNf,Zb.a.Tc,this.qEc.bind(this),1028);this.ga.fb(sc.a.fNf,Zb.a.Tc,this.qEc.bind(this),1028)}sEk(){return null===this.$c.instance?2:32}qEc(b,h,v){var D;if(1===v){if(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",
!1))return 32}else if(2===v){switch(b){case sc.a.gNf:this.rWd(this.Xvd.Resume);break;case sc.a.eNf:this.rWd(this.Xvd.VPj);break;case sc.a.hNf:this.rWd(this.Xvd.iSj);break;case sc.a.dNf:this.rWd(this.Xvd.mOj);break;case sc.a.fNf:this.y_j.M5b(Q=>{Q.IHa("WordMiniTemplateSurvey",null)})}return 32}return 2}rWd(b){const h=new ah.GraphTransaction(15);try{const v=Ya.App.xa.hb.rc.Yc;let D=v,Q;for(Q=nc.a.Zo(v);Q.moveNext();){const ta=Q.currentNode;if(de.ParagraphReader.gUc(ta)&&de.ParagraphReader.Vb(ta)){D=
ta;break}}h.Cb(D);const ba=this.$c.instance.DDc(b,D,!0).toArray();this.YGl(ba)}finally{h.dispose()}}YGl(b){for(const h of b)this.DLa.instance.Iaa(h.node,4)}}Object(n.a)(tK,"MiniTemplateActor",null,[]);class tH{constructor(b){this.s$c=(h,v,D)=>{if(1===D)return 32;h=w.AFrameworkApplication.ta;if(!h)return 32;h.nBd();tH.a$n(h);return 32};this.ga=b}Tb(){this.ga.qa(sc.a.s$c,Zb.a.view,this.s$c)}static a$n(b){const h=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");var v=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");
v=Qb.a.xba(h,!v);Qb.a.eTa(h,(!v).toString(),Qb.a.cRa);v?u.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):u.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Qe.d(sc.a.s$c,!0,void 0,void 0,void 0,void 0,[Object.assign(new pa.a,{name:"ModernUxExperimentPreference",string:(!v).toString()})]);b.refreshDocument(null)}}Object(n.a)(tH,"ModernUxActor",null,[]);var VM=c(1063),ft=c(1699);class uK{constructor(b,h,v,D){this.bje=Nf.a.Hv(1)/
6;this.Rko=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;if(ta=this.Tf.s8(ba.$j)){if(0<=ob&&ob<ft.a.F0.length){ba=new ah.GraphTransaction(15);ba.Cb(ta);ba.fk=Q;Q=ft.a.F0[ob].nvb;Ta=ft.a.F0[ob].lvb;const Kb=ft.a.F0[ob]._marginLeft;ob=ft.a.F0[ob].mvb;this.b9d(Q,Ta,this.Tf.wB(ta))&&this.b9d(Kb,ob,this.Tf.$t(ta))?(this.zE.w6a(ta,Q),this.zE.u6a(ta,Ta),this.zE.Tia(ta,Kb),this.zE.v6a(ta,ob),this.Sd.Ls(11)):this.tHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ba.dispose()}else return 2;return 32}u.ULS.sendTraceTag(520618525,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j);return 2};this.Sko=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;if(ta=this.Tf.s8(ba.$j)){if(0<=ob&&ob<ft.a.Ipa.length)ba=new ah.GraphTransaction(15),ba.Cb(ta),ba.fk=Q,Q=(Ta=this.Tf.xUc(ta))?ft.a.Ipa[ob].Jsa:ft.a.Ipa[ob].CLa,ob=Ta?ft.a.Ipa[ob].CLa:ft.a.Ipa[ob].Jsa,this.b9d(this.Tf.Lva(ta),this.Tf.Cna(ta),ob)&&this.b9d(this.Tf.mJ(ta),this.Tf.ZK(ta),Q)?(this.zE.Zag(ta,Q),this.zE.Yag(ta,ob),this.Sd.Ls(11)):this.tHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),
ba.dispose();else return 2;return 32}u.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j);return 2};this.lko=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;if(ta=this.Tf.s8(ba.$j)){ba=this.Tf.xUc(ta);Ta=new ah.GraphTransaction(15);Ta.Cb(ta);Ta.fk=Q;this.zE.klj(ta,ob);if(ob&&!ba||!ob&&ba){Q=this.Tf.$t(ta);ob=this.Tf.wB(ta);this.zE.Zag(ta,ob);this.zE.Yag(ta,Q);Q=this.Tf.Cna(ta);ob=this.Tf.Lva(ta);const Kb=this.Tf.mJ(ta),Vb=this.Tf.ZK(ta);ba?(this.zE.w6a(ta,w.AFrameworkApplication.isRtl?
Kb:Vb),this.zE.u6a(ta,w.AFrameworkApplication.isRtl?Vb:Kb),this.zE.Tia(ta,w.AFrameworkApplication.isRtl?ob:Q),this.zE.v6a(ta,w.AFrameworkApplication.isRtl?Q:ob)):(this.zE.w6a(ta,w.AFrameworkApplication.isRtl?Vb:Kb),this.zE.u6a(ta,w.AFrameworkApplication.isRtl?Kb:Vb),this.zE.Tia(ta,w.AFrameworkApplication.isRtl?Math.abs(Q):ob),this.zE.v6a(ta,w.AFrameworkApplication.isRtl?ob:Q));this.Sd.Ls(11)}Ta.dispose();return 32}u.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.$j);return 2};this.IXd=(Q,ba,ta)=>{if(1===ta)return 1===this.IS.Wu?32:8};this.fob=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;ta=this.Tf.s8(ba.$j);if(!ta)return u.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j),2;ba=new ah.GraphTransaction(15);ba.Cb(ta);ba.fk=Q;Q=Math.floor(this.Tf.$t(ta)/720);if(0>ob||ob>Q)return 2;this.zE.UNb(ta,ob);this.sjd.execute(Kb=>{Kb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.Sfe=(Q,ba,ta,Ta,ob)=>
{if(1===ta)return 32;ta=this.Tf.s8(ba.$j);if(!ta)return u.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j),2;ba=new ah.GraphTransaction(15);ba.Cb(ta);ba.fk=Q;Q=ob[0];Ta=this.Tf.$t(ta);if(720>Q||Q>Ta)return 2;this.zE.Hic(ta,ob);this.sjd.execute(Kb=>{Kb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.Rfe=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;ta=this.Tf.s8(ba.$j);if(!ta)return u.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.$j),2;ba=new ah.GraphTransaction(15);ba.Cb(ta);ba.fk=Q;Q=this.Tf.$t(ta);Ta=this.Tf.Yg(ta);if(0>ob||ob>(Q-720*Ta)/(Ta-1))return 2;this.zE.Ofo(ta,ob);this.sjd.execute(Kb=>{Kb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.Qfe=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;ta=this.Tf.s8(ba.$j);if(!ta)return u.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j),2;ba=new ah.GraphTransaction(15);ba.Cb(ta);ba.fk=Q;if(null==ob)return 2;this.zE.fmo(ta,
ob);this.sjd.execute(Kb=>{Kb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.KGa=(Q,ba,ta,Ta,ob)=>{if(Q=this.Tf.s8(ba.$j))return ob.marginTop=this.Tf.Cna(Q),ob.marginBottom=this.Tf.Lva(Q),ob.marginLeft=this.Tf.mJ(Q),ob.marginRight=this.Tf.ZK(Q),ob.Bo=this.Tf.$t(Q),ob.nv=this.Tf.wB(Q),ob.Fwa=this.Tf.xUc(Q),ob.NE=this.Tf.Yg(Q),ob.pma=this.Tf.jhb(Q),ob.Q_k=this.Tf.MRd(Q),ob.oJb=this.T1l(ob),ob.UKb=this.Y5l(ob),ob.LGc=this.NPl(ob),32;u.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.$j);return 2};this.Jge=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;if(ta=this.Tf.s8(ba.$j)){ba=new ah.GraphTransaction(15);ba.Cb(ta);switch(Q){case Eb.a.w6a:this.zE.w6a(ta,ob);break;case Eb.a.u6a:this.zE.u6a(ta,ob);break;case Eb.a.Tia:this.zE.Tia(ta,ob);break;case Eb.a.v6a:this.zE.v6a(ta,ob)}this.Sd.Ls(11);ba.dispose();return 32}u.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j);return 2};this.Slj=(Q,ba,ta,Ta,ob)=>{if(1===ta)return 32;if(ta=this.Tf.s8(ba.$j)){ba=
new ah.GraphTransaction(15);ba.Cb(ta);let Kb=Ta=0;switch(Q){case Eb.a.abg:Kb=ob;this.zE.Zag(ta,Kb);Ta=this.Tf.wB(ta);break;case Eb.a.$ag:Ta=ob,this.zE.Yag(ta,Ta),Kb=this.Tf.$t(ta)}this.zE.klj(ta,Ta<Kb);this.Sd.Ls(11);ba.dispose();return 32}u.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.$j);return 2};this.zE=b;this.Sd=h;this.IS=v;this.sjd=D}get Tf(){return Zn.a.instance}U1l(b){var h=Ya.App.oEf,v=h?1:3,D=w.AFrameworkApplication.numberFormat;let Q=ft.a.F0[b].nvb;
var ba=ft.a.F0[b].lvb;var ta=ft.a.F0[b]._marginLeft;b=ft.a.F0[b].mvb;Q=h?Nf.a.YTa(Q):Nf.a.Iz(Q);ba=h?Nf.a.YTa(ba):Nf.a.Iz(ba);ta=h?Nf.a.YTa(ta):Nf.a.Iz(ta);b=h?Nf.a.YTa(b):Nf.a.Iz(b);h=G.a.YDa(Q,v,D);ba=G.a.YDa(ba,v,D);ta=G.a.YDa(ta,v,D);v=G.a.YDa(b,v,D);D={};D.top=h;D.bottom=ba;D.left=ta;D.right=v;return D}B9m(b){const h=WordRibbonStrings.PageMarginsTop,v=WordRibbonStrings.PageMarginsBottom,D=WordRibbonStrings.PageMarginsLeft,Q=WordRibbonStrings.PageMarginsRight;b=this.U1l(b);return[[h,b.top,v,b.bottom],
[D,b.left,Q,b.right]]}D0c(b){var h=Ya.App.oEf,v=h?1:3;const D=w.AFrameworkApplication.numberFormat;let Q=ft.a.Ipa[b].Jsa;b=ft.a.Ipa[b].CLa;Q=h?Nf.a.YTa(Q):Nf.a.Iz(Q);b=h?Nf.a.YTa(b):Nf.a.Iz(b);h=G.a.YDa(b,v,D);v=G.a.YDa(Q,v,D);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,v)}Tb(){const b=w.AFrameworkApplication.va;b.fb(Eb.a.x6a,Zb.a.view,this.Rko,4);b.fb(Eb.a.$Sa,Zb.a.view,this.Sko,4);b.fb(Eb.a.setOrientation,Zb.a.view,this.lko,4);b.fb(Eb.a.KGa,Zb.a.view,this.KGa,96);b.qa(Eb.a.w6a,
Zb.a.view,this.Jge);b.qa(Eb.a.u6a,Zb.a.view,this.Jge);b.qa(Eb.a.Tia,Zb.a.view,this.Jge);b.qa(Eb.a.v6a,Zb.a.view,this.Jge);b.qa(Eb.a.abg,Zb.a.view,this.Slj);b.qa(Eb.a.$ag,Zb.a.view,this.Slj);b.fb(Eb.a.IXd,Zb.a.view,this.IXd,4);b.qa(Eb.a.fob,Zb.a.view,this.fob);b.qa(Eb.a.Sfe,Zb.a.view,this.Sfe);b.qa(Eb.a.Rfe,Zb.a.view,this.Rfe);b.qa(Eb.a.Qfe,Zb.a.view,this.Qfe)}b9d(b,h,v){return v>=b+h+Ya.App.vza}T1l(b){let h=5;for(let v=0;v<ft.a.F0.length;v++)if(ft.a.F0[v].nvb===b.marginTop&&ft.a.F0[v].lvb===b.marginBottom&&
ft.a.F0[v]._marginLeft===b.marginLeft&&ft.a.F0[v].mvb===b.marginRight){h=v;break}return h}Y5l(b){let h=5;b=new VM.a(Math.min(b.Bo,b.nv),Math.max(b.Bo,b.nv));for(let v=0;v<ft.a.Ipa.length;v++)if(this.cyn(b,ft.a.Ipa[v])){h=v;break}return h}NPl(b){let h=0;switch(b.NE){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}cyn(b,h){return ye.a.$ti(b.CLa,Math.max(h.CLa-this.bje,0),h.CLa+this.bje)&&ye.a.$ti(b.Jsa,Math.max(h.Jsa-this.bje,0),h.Jsa+this.bje)}tHa(b){if(!ml.a.lM){const h=new pg.StandardDialog;
h.Ad=0;h.fV(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(n.a)(uK,"PageActor",null,[708]);class vK{constructor(b){this.ga=b}get oc(){return this.ga}Ige(b,h){let v=0;b?1===b?v=Eb.a.Tia:2===b?v=Eb.a.v6a:3===b&&(v=Eb.a.u6a):v=Eb.a.w6a;this.oc.Qb(v,2,h)}$Sa(b,h){let v=0;1===b?v=Eb.a.$ag:b||(v=Eb.a.abg);this.oc.Qb(v,2,h)}Pfe(b,h){let v=0;switch(b){case 0:v=Eb.a.fob;break;case 1:v=Eb.a.Sfe;break;case 2:v=Eb.a.Rfe;break;case 3:v=Eb.a.Qfe}this.oc.Qb(v,2,h)}}Object(n.a)(vK,"PageCommands",null,[707]);
class wK{constructor(b,h,v){this.byn=(D,Q,ba,ta,Ta)=>1===ba?32:(D=this.Qk.s8(Q.$j))?(Ta=3===Ta.Ix,this.k6.value.aMh(this.X8l(D),this.lFb(D),Ta),32):2;this.ga=b;this.k6=h;this.Qk=v}Tb(){this.ga.qa(sc.a.yIf,Zb.a.view,this.byn);this.ga.fb(sc.a.dbe,Zb.a.view,qm.d,96);this.ga.fb(sc.a.cbe,Zb.a.view,qm.d,96);this.ga.qa(sc.a.B8d,Zb.a.view,qm.c);this.ga.qa(sc.a.A8d,Zb.a.view,qm.c)}X8l(b){const h=new fh.DictionaryPropertySet;h.setValue(lc.a.Bo,this.Qk.$t(b));h.setValue(lc.a.nv,this.Qk.wB(b));return h}lFb(b){const h=
new fh.DictionaryPropertySet;h.setValue(lc.a.marginTop,Math.abs(this.Qk.Cna(b)));h.setValue(lc.a.marginBottom,Math.abs(this.Qk.Lva(b)));h.setValue(lc.a.marginLeft,this.Qk.mJ(b));h.setValue(lc.a.marginRight,this.Qk.ZK(b));return h}}Object(n.a)(wK,"PaperSizeDialogActor",null,[]);class VE{constructor(b,h,v,D){this.ga=b;this.k6=h;this.aW=v;this.YA=D}Tb(){this.ga.fb(Eb.a.ucc,Zb.a.view,this.Qyn.bind(this),1028);this.ga.qa(Eb.a.ucc,Zb.a.paragraph,this.Oyn.bind(this));this.ga.fb(Eb.a.zLn,Zb.a.view,qm.d,96);
this.ga.fb(Eb.a.ALn,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.FKn,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.GKn,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.Dzo,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Czo,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.iwn,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.jwn,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Vvn,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Bzo,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Wvn,Zb.a.view,qm.c,96)}Oyn(b,h,v,D,Q){if(1===v)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.QBj(h);Q=3===Q.Ix;this.k6.value.JGd(this.fPc(b),
this.lFb(h),Q,this.YA);return 32}Qyn(b,h,v,D,Q){b=h.view.lb;if(!b||VE.Xf.V$b(b.tg))return 8;if(VE.Wg.qza(de.ParagraphReader.oU,b.tg))return VE.Ic.Yb(Oe.a.kf,{["Reason"]:Fe.a.hO}),8;if(1===v)return 3===this.ga.mode||2===this.ga.mode?32:8;v=b.gb.kb;h=this.QBj(h);Q=3===Q.Ix;if(1===v.length&&We.SelectionEditor.gf(v.J(0)))return v=v.J(0).node,this.k6.value.JGd(this.fPc(v),this.lFb(h),Q,this.YA),32;b=[];for(D=0;D<v.length;D++){const ba=v.J(D);(!D&&We.SelectionEditor.Gk(ba)||de.ParagraphReader.lm(ba)||We.SelectionEditor.ml(ba))&&
b.push(ba.node)}if(!b.length)return 8;v=Array(b.length);for(D=0;D<b.length;D++)v[D]=this.fPc(b[D]);v=zy.APropertySet.E$h(v);this.k6.value.JGd(v,this.lFb(h),Q,this.YA);return 32}fPc(b){var h,v,D;const Q=new fh.DictionaryPropertySet;Q.setValue(wc.a.rw,de.ParagraphReader.Ex(b));const ba=this.aW.qEa(b);var ta=ba.lineSpacing;Q.setValue(wc.a.J3a,ta.unit);Q.setValue(wc.a.ua,ta.value);ta=ba.beforeSpacing;Q.setValue(wc.a.rfc,ta.unit);Q.setValue(wc.a.sfc,ta.value);ta=ba.afterSpacing;Q.setValue(wc.a.pfc,ta.unit);
Q.setValue(wc.a.qfc,ta.value);Q.setValue(wc.a.M0c,ba.iw);(null===(h=this.YA)||void 0===h?0:h.GFa)&&Q.setValue(qe.a.keepWithNext,de.ParagraphReader.keepWithNext(b));(null===(v=this.YA)||void 0===v?0:v.VIa)&&Q.setValue(qe.a.widowControl,de.ParagraphReader.hnc(b));(null===(D=this.YA)||void 0===D?0:D.uha)&&Q.setValue(qe.a.keepTogether,de.ParagraphReader.keepTogether(b));return Q}static get Xf(){return xi.a.instance}static get Wg(){return io.ContextSetEditor.instance}static get Ic(){return Ye.a.instance}}
Object(n.a)(VE,"AParagraphDialogActor",null,[]);class xK extends VE{constructor(b,h,v,D,Q,ba){super(b,h,v,ba);this.Qk=D;this.Xo=Q}Tb(){super.Tb();this.ga.fb(Eb.a.G4i,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.H4i,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.LKn,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.Lvm,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Nvm,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.zzo,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Azo,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.cwn,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.lwn,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.kwn,
Zb.a.view,qm.c,96);this.ga.fb(Eb.a.Ezo,Zb.a.view,qm.c,96);this.ga.fb(Eb.a.BLn,Zb.a.view,qm.d,96);this.ga.fb(Eb.a.CLn,Zb.a.view,qm.d,96)}QBj(b){return this.Qk.s8(b.$j)}fPc(b){const h=super.fPc(b);var v=this.Xo.$T(b);const D=this.Xo.vG(b);h.setValue(wc.a.zGa,1);h.setValue(wc.a.AGa,v.Lt-D.Lt);v=this.Xo.t1a(b);h.setValue(wc.a.Fmb,v.unit);h.setValue(wc.a.Gmb,v.value);b=this.Xo.z8b(b);b.specialIndentType&&(h.setValue(wc.a.q5,b.specialIndentType),h.setValue(wc.a.oTa,b.unit),h.setValue(wc.a.pTa,b.value));
return h}lFb(b){const h=new fh.DictionaryPropertySet;h.setValue(lc.a.Bo,this.Qk.$t(b));h.setValue(lc.a.nv,this.Qk.wB(b));h.setValue(lc.a.marginTop,Math.abs(this.Qk.Cna(b)));h.setValue(lc.a.marginBottom,Math.abs(this.Qk.Lva(b)));h.setValue(lc.a.marginLeft,this.Qk.mJ(b));h.setValue(lc.a.marginRight,this.Qk.ZK(b));return h}}Object(n.a)(xK,"ParagraphDialogActor",VE,[]);class yK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.cZd=h}}Object(n.a)(yK,"AfterPasteEventArgs",Sys.EventArgs,[]);
class zK{constructor(b){this.FEe=this.KEe=null;this.nid=b}get sMd(){return null!=this.qzg?this.qzg:this.qzg=Ga.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get ZHm(){this.KEe||(this.KEe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate(Vt.a.qQh,!1));return this.KEe}get UXd(){this.FEe||(this.FEe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(Vt.a.vQh));return this.FEe}YHn(b){if(b&&Cd.OutlineElementReader.Dh(b.qva)&&Cd.OutlineElementReader.Dh(b.Akb)){this.sIn(b);
var h=new Km.a;for(h.Zc(b.qva);h&&h.currentNode;){const v=this.XQd(h),D=de.ParagraphReader.Vb(v);D&&de.ParagraphReader.Neb(v)&&this.WHn(v);const Q=h.currentNode.id===b.Akb.currentNode.id;D&&(this.ZHm||this.UXd)&&v.pj.Dga(v.type).Jbe(new yK(v,Q));if(Q)break;ig.OutlineElementNavigator.Ur(h,!1,!1)}}}WHn(b){u.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.Efc;b=Pe.a.Rc(b,0);Lt.ZTc(h)?
this.sMd.G9d(b,h):this.nid.G9d(b,h)}sIn(b){if(b.qva.currentNode&&b.Akb.currentNode&&b.qva.currentNode.id===b.Akb.currentNode.id){const h=this.XQd(b.qva);de.ParagraphReader.Vb(h)?this.$Hn(h,b.FAn,b.EAn):u.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}$Hn(b,h,v){u.ULS.shipAssertTag(590956771,307,0<=h);u.ULS.shipAssertTag(590958592,307,0<=v);var D=de.ParagraphReader.text(b);if(""!==D){var Q=Pe.a.createTextRange(b,h,v);Q=ue.HyperlinkReader.ND(Q,!1);if(1===
Q.length){const ba=Q[0];Q=D.substring(h,v).trim();D=D.substring(ba.cpBegin,ba.cpEnd).trim();h=Q===D;Q=Pe.a.createTextRange(b,ba.cpBegin,ba.cpEnd);if(ba.hyperlink&&h&&!ue.HyperlinkReader.r3a(D))b=ba.hyperlink.url;else if(h)b=D;else{u.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}Lt.ZTc(b)?this.sMd.HPa(Q,b,!1):this.nid.HPa(Q,b,!1)}else u.ULS.sendTraceTag(590958597,307,50,
"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",Q.length)}}XQd(b){const h=ig.OutlineElementNavigator.Ge(b);ig.OutlineElementNavigator.Vd(b);return h}}Object(n.a)(zK,"PastedContentsProcessorPostMergeAfterPaste",null,[706]);class uH extends Yk{constructor(b,h,v,D,Q,ba,ta,Ta){super(D);this.EQe=7;this.Mw=this.Bsc=null;this.mDe=0;this.jDe=b;this.Ik=h;this.sn=v;this.ge=Q;this.sUj=ta;this.wXa=Ta;this.M2=
this.ge.YQa("UserAction","WordIgnoreAll")}fcg(b){this.jDe.ZJi();this.Bsc=this.sn.yna(b);this.wXa.woi(this.Bsc,null,!1);return this.jDe.uCj(this.Bsc)?(this.M2.start(),this.Mw=new ah.GraphTransaction(15),this.Mw.Cb(b.node),!0):!1}$$d(b){this.LLb(b.node);return!0}V1c(b){this.LLb(b);return!0}aae(b){this.LLb(b.node)}cig(b){this.Mw.dispose();this.Bsc.errorDetails.Spb(b.actionId);this.M2.stop();u.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",
this.mDe,this.M2.ti,this.Bsc.errorDetails.proofingType));return!0}Zjc(b,h){if(super.Zjc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}dei(b){if(b&&b.type!==this.EQe){const h=ne.GraphIterator.$a(b);return h.zb(this.EQe)?h.jd(this.EQe):b}return b}hLm(b,h){return this.jDe.Jhe(h.errorDetails)&&!this.Ik.I8(Pe.a.createTextRange(b,h.begin,h.end))}LLb(b){if(b){var h=this.sn.Q3(b,v=>this.hLm(b,v));this.sUj?this.sn.xnb(b,h,!0):0<h.length&&(b.Tk(4,!0),this.sn.TJb(b));this.mDe+=h.length}}}
Object(n.a)(uH,"IgnoreAllCallbackSteps",Yk,[]);class AK{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){this.H2c=(Oc,gd,rd,je,Ld)=>{if(1===rd)return 32;Oc=this.wI.aPa(gd.view.lb.tg);if(Oc=lk.a.og(Oc))Ld[cl.a.LabelText]=Oc.displayName;return 32};this.Yna=(Oc,gd,rd,je,Ld,Qd)=>{const ge=new uH(this.Q5j,this.Ik,this.sn,this.Ie,this.ge,this.oW,0,this.wXa);return new Mo(Oc,gd,rd,je,Ld,Qd,ge,this.ga,this.ib,this.Ie,"IgnoreAllOperation")};this.fCb=(Oc,gd,rd,je,Ld,Qd)=>{const ge=new uH(this.J0j,this.Ik,this.sn,
this.Ie,this.ge,this.oW,1,this.wXa);return new Mo(Oc,gd,rd,je,Ld,Qd,ge,this.ga,this.ib,this.Ie,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ik=h;this.ib=v;this.Ie=D;this.sn=Q;this.wI=ba;this.ge=ta;this.Q5j=Ta;this.J0j=ob;this.YVb=Kb.lVc;this.oW=Kb;this.wXa=Vb;this.nFe=bc;this.c9a=Dc}Tb(){this.nFe&&(xs.AB()?this.ga.fb(Eb.a.Yna,Zb.a.Tc,this.Ytm.bind(this),1028):this.ga.fT(Eb.a.Yna,Zb.a.view,this.Yna,1028));this.YVb&&this.ga.fT(Eb.a.fCb,Zb.a.view,this.fCb,1028);this.ga.fb(sc.a.H2c,Zb.a.view,this.H2c,
96)}Ytm(b,h,v,D,Q){if(1===v)return 32;u.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.c9a.kwf(Q?Q:h,null,zp.b.IgnoreAll);return 32}}Object(n.a)(AK,"ProofingActor",null,[]);var kD=c(1185),WM=c(1701);class lD{constructor(b,h,v,D,Q,ba,ta,Ta,ob){this.nq=this.bMa=this.$ud=this.avd=null;this.lE=this.Gs=this.sq=0;this.N$a=this.M$a=!1;this.uaa=this.S9a=this.R9a=this.P9a=this.T9a=0;this.dud=null;this.Rda=this.pW=this.Qq=this.aQ=0;this.Nl=null;this.aub=0;this.sVf=Kb=>{var Vb;if(5===
this.aub){const bc=Object.assign(new wb.a,{extendedProperties:new Map});bc.extendedProperties.set("status",Kb.data.status.toString());bc.extendedProperties.set("httpStatus",Kb.data.Qe.toString());(null===(Vb=w.AFrameworkApplication.K)||void 0===Vb?0:Vb.$("ShouldLogPicturesExtendedHealthKpis"))?(Vb={name:tm.c.CVd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:bc},bc.extendedProperties.set("ErrorLevel","warning"),this.Nh.logKpiFailure({kpiName:tm.c.J9b,
errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:bc},optionalVeto:Vb})):wa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,bc)}u.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Kb.data.status,["HttpStatus"]:Kb.data.Qe,["Id"]:Kb.data.id,["ResponseData"]:Kb.data.we},UE.a[this.aub]);this.gee()};this.Oj=v;this._image=b;this._context=h;this.Mmd=!1;(b=lD.vh.Xs(h.node))&&
b.Hf(lc.a.dGf)&&(this.Mmd=!0);this.vuc=D.$("ImageDataURLPresentationIsEnabled");this.Oek=D.$("WordOartPostRequestIsEnabled");this.Ma=D;this.kr=Q;this.ge=ba;this.Sd=ta;this.Jm=Ta;this.dK=ob;this.Nh=Fp.a.getInstance(tm.a);this.zym();this.D7d=this.Mec.bind(this)}zym(){this.nq="";this.sq=ke.ImageReader.dF(this._image);this.Gs=ke.ImageReader.wG(this._image);this.uaa=ke.ImageReader.Nhb(this._image);this.lE=ke.ImageReader.A_(this._image);this.M$a=ke.ImageReader.APd(this._image);this.N$a=ke.ImageReader.kEb(this._image);
const b=ke.ImageReader.Bba(this._image);this.T9a=Math.max(b.top,0);this.P9a=Math.max(b.bottom,0);this.R9a=Math.max(b.left,0);this.S9a=Math.max(b.right,0);this.Nl=sb.a.nil;this.bMa=null;this.aub=ke.ImageReader.mk(this._image)}RBd(b,h){return(new WM.a(this.kr,this.aub,this.Ma,this.sq,this.Gs,this.lE,this.uaa,this.T9a,this.P9a,this.R9a,this.S9a,this.M$a,this.N$a,this.Mmd)).build(this._context.node,this._image,b,h)}resize(b,h){this.nq="Resize";this.Aje();ch.a.mark(this.e8b());this.sq=b;this.Gs=h;this.sendMessage(!1,
this.D7d)}yw(b){this.nq="Styles";this.Aje();ch.a.mark(this.e8b());this.uaa=b;this.sendMessage(!1,this.D7d)}Jko(b,h,v){this.nq="Rotation";this.Aje();this.lE=b;this.M$a=h;this.N$a=v;this.sendMessage(!1,this.D7d)}Iko(b,h){this.nq="SwordRequestManager";this.Aje();this.bMa=b;this.lE=h.angle;this.sq=h.width;this.Gs=h.height;this.uaa=h.styleId;this.T9a=h.top;this.P9a=h.bottom;this.R9a=h.left;this.S9a=h.right;this.Nl=h.lX;this.sendMessage(!1,this.D7d)}sendMessage(b,h){if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var v=
this.afb(v);const D=ke.ImageReader.Ina(this._image,this.Ma,this.kr);D?kD.a.sob(this._image,D,4):this._image.setValue(nh.a.xOa,!0);v.dispose()}this.Luj(b);ch.a.mark(this.e8b());b=new fb.QueryStringBuilder(this.RBd(b,!0));this.vuc&&b.Ce(Sd.a.qOh,"true");this.Oek?(v=new fb.QueryStringBuilder("WordOart.ashx"),w.AFrameworkApplication.Ne.tj(v.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.sVf,null)):w.AFrameworkApplication.Ne.tj(b.toString(),1,
"",null,!0,0,h,this.sVf,null)}afb(b){b=this.Nl&&this.Nl!==sb.a.nil?new ah.GraphTransaction(7,Eb.a.imageRotate):new ah.GraphTransaction(15);b.Cb(this._context.node);return b}get hOj(){const b=new ah.GraphTransaction(3);b.Cb(this._context.node);return b}gee(){this.HKc();this.UJd();const b=this.hOj;var h=ke.ImageReader.vva(this._image,this._context.node.Jc,this.Ma,this.kr);this._image.setValue(nh.a.xOa,!1);this._image.setValue(wc.a.JRc,h);this._image.setValue(wc.a.qJ,-1);this._image.setValue(nh.a.Y4,
1);h=ke.ImageReader.Ina(this._image,this.Ma,this.kr);this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(wc.a.a$d),this._image.removeProperty(wc.a.Z9d),h&&kD.a.sob(this._image,h,3));b.dispose();lD.zp();this.bMa&&this.bMa()}Luj(b){this.ge&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.avd=this.ge.$f("WebServiceCall",b))}HKc(){this.avd&&(this.avd.stop(),this.avd=null)}Aje(){if(this.ge){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",
this.nq,UE.a[this.aub]);this.$ud=this.ge.$f("WebServiceCall",b)}}UJd(){this.$ud&&(this.$ud.stop(),this.$ud=null)}static get vh(){return Rl.PageNavigator.instance}static zp(){const b=new pg.StandardDialog;b.Ad=0;b.mx(Nl.a.YBn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Ya.App.xa&&Ya.App.xa.updateCommandUI()}}Object(n.a)(lD,"RenderedImageEditOperation",null,[742]);var vH=c(298),JF=c(504);class BK extends lD{constructor(b,h,v,D,Q,ba,ta,Ta,ob){super(b,
h,v,D,Q,ba,ta,Ta,ob)}sendMessage(b,h){Object(vH.a)(()=>{let v;v=this.afb(v);this._image.setValue(nh.a.Y4,0);v.dispose()});this.Luj(b);ch.a.mark(this.e8b());b=new fb.QueryStringBuilder("WordOart.ashx");this.XYg=this.Uhb(!0,!1);b=new JF.a(b.toString(),2,this.Uhb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");w.AFrameworkApplication.Ne.send(b).dya(h,v=>{this.sVf(v)})}Mec(b){try{const h=
JSON.parse(b.data.ESa);this.K4j=h[Sd.a.cQc];this.kok=h[Sd.a.width];this.d5j=h[Sd.a.height];this.XKg=h[Sd.a.ZDc];this.jsc=Array(4);this.jsc[0]=h[Sd.a.Rfb];this.jsc[1]=h[Sd.a.Sfb];this.jsc[2]=h[Sd.a.Tfb];this.jsc[3]=h[Sd.a.Qfb];this.q2g=void 0!==h[Sd.a.Uwa]?"true"===h[Sd.a.Uwa].toLowerCase():null;Object(vH.a)(()=>{this.Qad();this._context.node.Bi().contentReplicator.forceOutbound(()=>{this.pDl()},null,null)})}catch(h){u.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
h.message,this.nq,ke.ImageReader.mk(this._image)),this.gee()}}Q6d(){u.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Qad(){let b;b=this.afb(b);this._image.setValue(qe.a.gU,this.K4j);this.XKg&&this._image.setValue(qe.a.bAd,this.XKg);this._image.setValue(qe.a.Vva,this.kok);this._image.setValue(qe.a.Wva,this.d5j);this._image.setValue(qe.a.mPa,this.jsc);this.X5j&&this._image.setValue(wc.a.iGb,this.X5j);kD.a.sob(this._image,this.XYg,3);this._image.setValue(lc.a.Ofb,this.XYg);
this.q2g?this._image.setValue(qe.a.I2a,this.q2g):this._image.removeProperty(qe.a.I2a);this.TWk();b.dispose()}TWk(){this._image.removeProperty(wc.a.au);this._image.removeProperty(wc.a.qJ);this._image.removeProperty(wc.a.a$d);this._image.removeProperty(wc.a.Z9d)}pDl(){this.dK.sHa(this._context);if(this.Nl&&this.Nl!==sb.a.nil){const b=this._context.node.Bi(),h=new W.a(this.Nl,1);this.Jm.U2b(b,h)}this.Sd.Ls(13);this.HKc();this.UJd();ch.a.mark(this.d8b());Object(vH.a)(()=>{let b;b=this.afb(b);this._image.setValue(nh.a.Y4,
1);b.dispose()});this.bMa&&this.bMa()}Uhb(b,h){b=new fb.QueryStringBuilder(this.RBd(b,h));b.Ce(Sd.a.JVd,"true");return b.toString()}e8b(){return 51511}d8b(){return 51512}}Object(n.a)(BK,"RenderedGraphicEditOperation",lD,[]);class CK extends lD{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){super(b,h,v,D,Q,ba,ta,Ta,ob);this.XTg=null;this.Q6d=Vb=>{const bc=this.RBd(!0,!1);let Dc;Dc=this.afb(Dc);this._image.setValue(lc.a.cAd,this.dud);var Oc=Ga.a.instance.Na("Box4.IFeatureHelper");Oc&&Oc.isFeatureEnabled(49)&&
this._image.setValue(lc.a.aLd,this.XTg);this.Ma.$("WordEditorImageRotateIsEnabled")&&this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Oj.rge(this._image,this.lE,this.M$a,this.N$a);const gd=ke.ImageReader.Ina(this._image,this.Ma,this.kr),rd=()=>{gd&&kD.a.sob(this._image,gd,3);kD.a.sob(this._image,bc,3);this.Oj.pge(this._image,Nf.a.oG(this.aQ),Nf.a.oG(this.pW),Nf.a.oG(this.Qq),Nf.a.oG(this.Rda));this._image.setValue(lc.a.Ofb,bc);ke.ImageReader.qy(this._image)||this._image.setValue(lc.a.PEa,
1);this.Oj.Yfe(this._image,this.sq,this.Gs);this.Ma.$("WordEditorImageRotateIsEnabled")&&!this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Oj.rge(this._image,this.lE,this.M$a,this.N$a);2===Vb.data.status&&ke.ImageReader.Y_(Vb.data.we)&&(this._image.setValue(wc.a.au,Vb.data.we),Vb.data.request&&this._image.setValue(wc.a.iGb,kD.a.tLc("POST"===Vb.data.request.get_httpVerb()?Vb.data.request.get_body():Vb.data.request.get_url())));this.bMa&&this.bMa();this.dK.sHa(this._context);if(this.Nl&&
this.Nl!==sb.a.nil){const je=this._context.node.Bi(),Ld=new W.a(this.Nl,1);this.Jm.U2b(je,Ld)}this.Sd.Ls(13);this.HKc();this.UJd();ch.a.mark(this.d8b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nl&&this.Nl!==sb.a.nil&&(Oc=this._context.node.Bi())&&Oc.contentReplicator){Dc.dispose();Oc.contentReplicator.forceOutbound(()=>{let je;je=this.afb(je);rd();je.dispose()},null,null);return}rd();Dc.dispose()};this.fPe=Kb}e8b(){return 51511}d8b(){return 51512}Mec(b){try{var h=JSON.parse(b.data.we);
const Q=Sys.Net.XMLDOM("string"===typeof h[Sd.a.zrh]?h[Sd.a.zrh]:null);this.dud="string"===typeof h[Sd.a.dAd]?h[Sd.a.dAd]:null;const ba=Ga.a.instance.Na("Box4.IFeatureHelper");ba&&ba.isFeatureEnabled(49)&&(this.XTg="string"===typeof h[Sd.a.S5b]?h[Sd.a.S5b]:null);aa.a.At&&Q.setProperty("SelectionNamespaces","xmlns:mc='"+Lf.a.jBk+"'");const ta=Q.selectSingleNode("/mc:AlternateContent");if(!ta)throw So.a.argument("Alternate content element could not be retrieved!");const Ta=ta.firstChild;if(!Ta)throw So.a.argument("Alternate content choice element could not be retrieved!");
const ob=Ta.firstChild;if(!ob)throw So.a.argument("Drawing element could not be retrieved!");var v=ob.firstChild;if(!v)throw So.a.argument("Inline element could not be retrieved!");h=b=null;const Kb=RegExp("effectExtent"),Vb=RegExp("extent");for(const Dc of v.childNodes)-1!==Dc.nodeName.search(Kb)&&(b=Dc),-1!==Dc.nodeName.search(Vb)&&(h=Dc);if(!b||!h)throw So.a.argument("Effect extent or extent could not be retrieved!");this.aQ=parseInt(b.selectSingleNode("@l").text);this.pW=parseInt(b.selectSingleNode("@r").text);
this.Qq=parseInt(b.selectSingleNode("@t").text);this.Rda=parseInt(b.selectSingleNode("@b").text);const bc=xh.c(this.lE);if(45<=bc&&135>=bc||225<=bc&&315>=bc){const Dc=parseInt(h.selectSingleNode("@cx").text);var D=parseInt(h.selectSingleNode("@cy").text);v=Dc/2;D/=2;this.aQ-=v-D;this.pW+=v-D;this.Qq-=D-v;this.Rda+=D-v}}catch(Q){u.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",Q.message,this.nq,UE.a[this.fPe]);this.gee();return}this.sendMessage(!0,
this.Q6d)}}Object(n.a)(CK,"RenderedDrawingEditOperation",lD,[]);class DK extends lD{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){super(b,h,v,D,Q,ba,ta,Ta,ob);this.haa=null;this.Q6d=bc=>{var Dc;const Oc=this.RBd(!0,!1);let gd;gd=this.afb(gd);this._image.setValue(lc.a.kLb,this.dud);const rd=ke.ImageReader.Ina(this._image,this.Ma,this.kr);(null===(Dc=w.AFrameworkApplication.K)||void 0===Dc?0:Dc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Nh.logKpiSuccess({kpiName:tm.c.J9b});const je=()=>{rd&&kD.a.sob(this._image,
rd,3);kD.a.sob(this._image,Oc,3);this.Oj.pge(this._image,Nf.a.oG(this.aQ),Nf.a.oG(this.pW),Nf.a.oG(this.Qq),Nf.a.oG(this.Rda));this._image.setValue(lc.a.Ofb,Oc);ke.ImageReader.qy(this._image)||this._image.setValue(lc.a.PEa,1);this._image.setValue(lc.a.o1c,this.uaa);this._image.setValue(wc.a.Rum,-1);this.ld.isFeatureEnabled(89)&&ke.ImageReader.j9b(this._image)&&this.Ho.Yce(this._image);this._image.setValue(nh.a.xOa,!1);this.Oj.Yfe(this._image,this.sq,this.Gs);this.Ma.$("WordEditorImageRotateIsEnabled")&&
this.Oj.rge(this._image,this.lE,this.M$a,this.N$a);this.Ma.$("WordEditorImageCropIsEnabled")&&this.Oj.yag(this._image,this.T9a,this.P9a,this.R9a,this.S9a);2===bc.data.status&&ke.ImageReader.Y_(bc.data.we)&&(this._image.setValue(wc.a.au,bc.data.we),bc.data.request&&this._image.setValue(wc.a.iGb,kD.a.tLc("POST"===bc.data.request.get_httpVerb()?bc.data.request.get_body():bc.data.request.get_url())));this.bMa&&this.bMa();this.dK.sHa(this._context);if(this.Nl&&this.Nl!==sb.a.nil){const Ld=this._context.node.Bi(),
Qd=new W.a(this.Nl,1);this.Jm.U2b(Ld,Qd)}this.Sd.Ls(13);this.HKc();this.UJd();ch.a.mark(this.d8b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nl&&this.Nl!==sb.a.nil&&(Dc=this._context.node.Bi())&&Dc.contentReplicator){gd.dispose();Dc.contentReplicator.forceOutbound(()=>{let Ld;Ld=this.afb(Ld);je();Ld.dispose()},null,null);return}je();gd.dispose()};this.fPe=Kb;this.ld=Vb}e8b(){return 7988}d8b(){return 7989}get Ho(){this.haa||(this.haa=new qK.a);return this.haa}Mec(b){var h;
try{const v=b.data.Fia;this.dud=b.data.we;aa.a.At&&v.setProperty("SelectionNamespaces","xmlns:pic='"+Lf.a.WBn+"'");const D=v.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.aQ=parseInt(D.selectSingleNode("@l").text);this.pW=parseInt(D.selectSingleNode("@r").text);this.Qq=parseInt(D.selectSingleNode("@t").text);this.Rda=parseInt(D.selectSingleNode("@b").text)}catch(v){b=Object.assign(new wb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",v.message);b.extendedProperties.set("operation",
this.nq);(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:tm.c.CVd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.Nh.logKpiFailure({kpiName:tm.c.J9b,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):wa.Health.instance.recordQosError("PictureSwordResponseInvalid",
["ImageEditFailed"],!1,!0,!1,!1,b);u.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",v.message,this.nq,UE.a[this.fPe]);this.gee();return}this.HKc();ch.a.mark(this.d8b());this.sendMessage(!0,this.Q6d)}}Object(n.a)(DK,"RenderedPictureEditOperation",lD,[]);class EK{constructor(b,h,v,D,Q,ba,ta,Ta){this.Oj=b;this.Ma=h;this.kr=v;this.ge=D;this.Sd=Q;this.Jm=ba;this.dK=ta;this.ld=Ta}create(b,h){const v=ke.ImageReader.mk(b);return Jd.App.instance.f4(v)?
new BK(b,h,this.Oj,this.Ma,this.kr,this.ge,this.Sd,this.Jm,this.dK):10===v||11===v||48===v||4===v?new CK(b,h,this.Oj,this.Ma,this.kr,this.ge,this.Sd,this.Jm,this.dK,v):5===v?new DK(b,h,this.Oj,this.Ma,this.kr,this.ge,this.Sd,this.Jm,this.dK,v,this.ld):null}}Object(n.a)(EK,"Factory",null,[705]);class FK{constructor(){this.RJc=b=>{const h=window.performance.now(),v=Pl.a.Lr();if(v){b=lH.a(b.customData,v);b=nc.a.Qs(b,v);var D=0,Q=new ah.GraphTransaction(3);try{for(Q.Cb(v);b.moveNext();){if(!de.ParagraphReader.sh(b.iterator))continue;
const ba=b.currentNode;this.nTh(ba)&&(D++,ba.Tk(4,!0));const ta=window.performance.now()-h;if(2500<D||100<ta){this.Zwb=null;this.$2c(ba);break}}}finally{Q&&Q.dispose()}}else Lc.b(570450380,3018,10,"PageContentNode not found")};this.Zwb=null}ati(){const b=Pl.a.Lr();this.l3c(b);this.$2c(null)}$2c(b){this.Zwb&&(w.AFrameworkApplication.pc.We(this.Zwb),this.Zwb=null);this.Zwb=new of.a(1,1,1,this.RJc,198);this.Zwb.customData=b;w.AFrameworkApplication.pc.Wb(this.Zwb)}l3c(b){const h=lH.b(b);if(h){var v=new ah.GraphTransaction(3);
try{for(v.Cb(b);h.moveNext();){if(!de.ParagraphReader.sh(h.iterator))continue;const D=h.currentNode;this.nTh(D)&&D.Tk(4,!0)}}finally{v&&v.dispose()}}}nTh(b){b=b.XG;for(const h of b)if(h.Bjb)return 0<h.uPb;return!1}}Object(n.a)(FK,"RenderParagraphsContainingTabs",null,[]);class GK{constructor(b,h){this.aye=!0;this.Vqc=null;this.Gpl=()=>{this.Vqc=null;this.aye=!0;this.cMa&&this.cMa.fUa(!Ya.App.QO())};this.V7a=(v,D,Q)=>{if(1===Q)return 32;2===Q&&(v=!1,Ya.App.QO()?this.aye=!1:this.aye?v=!0:this.oYo(),
this.cMa&&this.cMa.fUa(v));return 32};this.ga=b;this.cMa=h}Tb(){this.ga.fb(Ua.a.V7a,Zb.a.application,this.V7a,1124)}oYo(){this.Vqc?w.AFrameworkApplication.pc.We(this.Vqc):this.Vqc=new of.a(4,1,5E3,this.Gpl);w.AFrameworkApplication.pc.Wb(this.Vqc)}}Object(n.a)(GK,"SaveStatusActor",null,[]);class HK{get T8f(){return null!=this.RFg?this.RFg:this.RFg=Ga.a.instance.Na("Box4.ISaveStyleManager")}get v4n(){return this.u4n||(this.u4n=Ga.a.instance.Na("Box4.IResetAndDeleteStyleManager"))}get Gn(){return null!=
this.NGg?this.NGg:this.NGg=Ga.a.instance.Na("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(v,D,Q)=>{v=Pl.a.UHb(D);if(1===Q||v)return v?8:32;this.k6.value.o8k(D);return 32};this.pBb=(v,D,Q)=>{v=Pl.a.UHb(D);if(1===Q||v)return v?8:32;this.k6.value.ibl(D,this.ga);return 32};this.wdf=(v,D,Q)=>{v=Pl.a.UHb(D)||this.jqo();if(1===Q||v)return v?8:32;this.k6.value.wdf(D);return 32};this.ga=b;this.k6=h}get wc(){return null!=this.CJg?this.CJg:this.CJg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}Tb(){this.ga.fb(Eb.a.applyStyles,
Zb.a.view,this.applyStyles,1028);this.ga.fb(Eb.a.pBb,Zb.a.view,this.pBb,4);this.ga.fb(Eb.a.WBb,Zb.a.view,this.wdf,4);this.ga.fb(Eb.a.S8f,Zb.a.view,this.w$n.bind(this),4);this.ga.fb(Eb.a.m7f,Zb.a.view,this.n7f.bind(this),4);this.ga.fb(Eb.a.rdf,Zb.a.view,this.Ejl.bind(this),4)}w$n(b,h,v){b=Pl.a.UHb(h)||this.oqo();if(1===v||b)return b?8:32;this.T8f.v$n();return 32}n7f(b,h,v){b=Pl.a.UHb(h)||this.mqo();if(1===v||b)return b?8:32;this.v4n.n7f();return 32}Ejl(b,h,v){b=Pl.a.UHb(h)||this.iqo();if(1===v||b)return b?
8:32;this.k6.value.Djl();return 32}iqo(){return"{}"===KE.a.sqb?!0:!1}mqo(){if(0==KE.a.y4.size)return!0;var b=KE.a.y4;const h=this.wc.Mr();let v=0;for(const D of b.values())b=h.Pi(D),this.wc.je(b,h)||v++;return 0==v?!0:!1}oqo(){var b=KE.a.sqb,h=KE.a.y4;const v=this.wc.Mr();if(0==h.size)return!0;if(!({Yu:b}=F.d(b)).returnValue)return u.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const Q of h.values()){h=
v.Pi(Q);var D=b[Q];if(null==D)return!1;if(D=Pl.a.XRd(D)){if(h=Pl.a.NNc(h,v),Pl.a.KUc(h,D))return!1}else u.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}jqo(){var b=Pl.a.Lr();if(!b)return Lc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new Jv.WACStyleSet).TQ(b);const h=b.lO;for(let D=0;D<h;D++){var v=b.yEa(D);if(this.wc.isHidden(v)||!this.wc.je(v,b))continue;const Q=this.wc.yG(v);if(2===Q||1===Q)if(!v.hasProperty(lc.a.linkedStyle)||
2===Q)if(v=v.ia(lc.a.GK,null),!(v&&0<v.length))return!1}return!0}}Object(n.a)(HK,"StylesActor",null,[]);class EG{constructor(b){this.qke=(h,v,D)=>{h=w.AFrameworkApplication.ta;if(1===D)return 1!==h.mode||ac.SessionStatusManager.instance.Aj?2:32;wa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,EG.sB,null);const Q={};Q[H.a.$xf]=w.AFrameworkApplication.K.jb("ClassicViewModePreferenceCookieName");Q[H.a.Pni]="true";w.AFrameworkApplication.PO().execute(ba=>{ba.sendMessage(L.a.ACo,Q)});return w.AFrameworkApplication.va.processAction(Eb.a.readingMode,
2)};this.ga=b}Tb(){this.ga.qa(sc.a.qke,Zb.a.view,this.qke)}}EG.sB="wwaengidc";Object(n.a)(EG,"SwitchToClassicViewModeActor",null,[]);class IK{constructor(b,h,v,D,Q,ba,ta,Ta,ob){this.angle=v;this.styleId=D;this.width=b;this.height=h;this.top=Q;this.bottom=ba;this.left=ta;this.right=Ta;this.lX=ob}}Object(n.a)(IK,"SWordData",null,[]);class JK{constructor(b,h){this.Ak=this.r2=this.mq=null;this.uPe=this.eXb=!1;this.aQ=this.pW=this.Rda=this.Qq=this.uaa=this.Gs=this.sq=this.lE=0;this.Nl=null;this.v0=()=>
{this.uPe=!1;this.eXb&&this.LKc()};this.Eo=b;this.Kzc=h;this.pqi()}pqi(){this.pW=this.aQ=this.Rda=this.Qq=this.uaa=this.Gs=this.sq=this.lE=-1;this.Nl=sb.a.nil}LKc(){this.uPe||(this.x0o(),this.ycl(),this.eXb=!1)}ycl(){this.Ak=new IK(this.sq,this.Gs,this.lE,this.uaa,this.Qq,this.Rda,this.aQ,this.pW,this.Nl);this.Kzc.create(this.r2,this.mq).Iko(this.v0,this.Ak);this.uPe=!0;let b;Object(yb.a)(3,this.r2)?b=UE.a[ke.ImageReader.mk(this.r2)]:(u.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
b="generic");u.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.sq,this.Gs,this.lE,this.uaa,this.Qq,this.Rda,this.aQ,this.pW,b);this.pqi()}x0o(){this.sq=-1!==this.sq?this.sq:this.r2.ia(wc.a.NEa,-1);this.Gs=-1!==this.Gs?this.Gs:this.r2.ia(wc.a.MEa,-1);this.sq=-1!==this.sq?this.sq:this.Eo.dF(this.r2);this.Gs=-1!==this.Gs?this.Gs:this.Eo.wG(this.r2);this.lE=-1!==this.lE?
this.lE:this.Eo.A_(this.r2);this.uaa=-1!==this.uaa?this.uaa:this.Eo.Nhb(this.r2);const b=this.Eo.Bba(this.r2);this.Qq=-1!==this.Qq?this.Qq:b.top;this.Rda=-1!==this.Rda?this.Rda:b.bottom;this.aQ=-1!==this.aQ?this.aQ:b.left;this.pW=-1!==this.pW?this.pW:b.right}aMn(b,h,v,D){this.mq=b;this.lE=v;this.eXb=!0;this.r2=h;this.Nl=D;this.LKc()}$Ln(b,h,v,D,Q){this.mq=b;this.eXb=!0;this.r2=h;this.Nl=Q;this.r2.setValue(wc.a.NEa,v);this.r2.setValue(wc.a.MEa,D);this.LKc()}eMn(b,h,v){this.mq=b;this.eXb=!0;this.r2=
h;this.uaa=v;this.LKc()}VLn(b,h,v,D,Q,ba){this.mq=b;this.Qq=v;this.Rda=D;this.aQ=Q;this.pW=ba;this.eXb=!0;this.r2=h;h=b=0;({width:b,height:h}=this.Eo.yhb(this.r2));this.sq=b-(Q+ba)/1E5*b;this.Gs=h-(v+D)/1E5*h;this.LKc()}}Object(n.a)(JK,"SWordRequestManager",null,[701]);class KF{constructor(b,h,v,D=null,Q=null,ba=null,ta=null,Ta=null,ob=null,Kb=null){this.Jm=null;this.kkh=!1;this.cFo=(Vb,bc,Dc,Oc,gd)=>{if(1===Dc)return 32;const rd=Vb===Eb.a.tcg;if(!bc.view.qe)return 2;const je=bc.view,Ld=je.lb,Qd=
Ld.tg;if(!Qd||KF.Xf.j_(Qd))return 2;if(this.Tm&&this.Tm.instance&&this.Tm.instance.tU(Qd))return 4;Vb=null;var ge=Rc.ActionManager.nxa;let ze=!1;var gg=We.SelectionEditor.gf(Qd);if(Qd.$w){if(Ld.gb.vJ&&(ge=Qd.getContext(0),Vb=new ne.GraphIterator,Vb.set(ge.node),Vb.Ep(),ge=rd?Eb.a.z9f:Eb.a.efe),ge=this.LTe.yGn(ge),ge===Rc.ActionManager.nxa){var Kg=KF.Wg.mT(Qd,16);Kg?(rd&&(ge=Eb.a.S4d),Vb=new ne.GraphIterator,Vb.set(Kg.node),Vb.vd()):ge=rd?Eb.a.JG:Eb.a.qO}}else if(Qd.el)if(Vb=new ne.GraphIterator,Vb.set(Qd.node),
We.SelectionEditor.mu(Vb),dh.OutlineReader.kQa(Qd))ge=rd?Eb.a.z9f:Eb.a.efe;else{if(this.hDe&&this.hDe.qso(Qd))return this.hDe.M6c(Qd,je.ic,rd),32;ke.ImageReader.y2a(Qd)?ge=rd?Eb.a.y9f:Eb.a.x9f:(ge=rd?this.LTe.jkm(Vb,Qd,ge,bc):this.LTe.ikm(Vb,Qd,ge,bc),Cd.OutlineElementReader.Dh(Vb)&&Qd.contextId===Zb.a.Tc&&(ze=Cd.OutlineElementReader.EA(Vb,Qd,!1)),Kg=Hg.ListItemReader.Ig(Vb)&&ze,ge!==Rc.ActionManager.nxa||Ph.TableCellReader.Moa(Vb)||Kg||(this.kkh||(u.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),
this.kkh=!0),w.AFrameworkApplication.va.processAction(Eb.a.Mqi,2),this.jri(bc)))}else return 2;if(!rd&&ge===Rc.ActionManager.nxa&&Ph.TableCellReader.Moa(Vb))if(Ig.returnToCell(Vb),Ph.TableCellReader.eQa(Vb)||rh.TableReader.oxi(Vb)&&Ph.TableCellReader.YDf(Vb)){if(ge=this.Apk(),!ge)return 2}else ge=Eb.a.tPi;if(ge===Rc.ActionManager.nxa)return 2;switch(ge){case Eb.a.tPi:case Eb.a.S4d:Oc=ge===Eb.a.S4d;gg&&this.I1&&this.YY&&(gg=this.I1.Tjf(Qd,-1,!0,zf.a.Aw))&&this.YY.wgj(gg);Dc=32;Ig.returnToCell(Vb);
Ig.moveToNextOrPreviousCell(Vb,Oc)&&(gg=!0,Oc=!1,dh.OutlineReader.fxf(Vb)||(sk.OutlineNavigator.FNf(Vb,!1),ig.OutlineElementNavigator.Ge(Vb),de.ParagraphReader.Xt(Vb.currentNode)&&(gg=!1,de.ParagraphReader.textLength(Vb.currentNode)||(Oc=!0)),Oc||Ig.returnToCell(Vb)),Oc?Vb=Mg.SelectionFactory.ue(Vb.currentNode,0):(Vb=Mg.SelectionFactory.uq(Vb.currentNode),!gg&&We.SelectionEditor.Gk(Vb.Pc)&&(gg=Vb.toArray(),Array.removeAt(gg,gg.length-1),Vb=new Rp.Selection(gg,Vb.Nf))),Ld.setSelection(Vb));break;case Eb.a.z9f:case Eb.a.efe:ge===
Eb.a.efe?sk.OutlineNavigator.UOi(Vb,!1):sk.OutlineNavigator.UOi(Vb,!0);Ld.setSelection(Mg.SelectionFactory.uq(Vb.currentNode));Dc=32;break;case Eb.a.R8c:Dc=w.AFrameworkApplication.va.Of(bc,ge,Dc,!0,Oc,gd);break;default:if(Dc=w.AFrameworkApplication.va.Of(bc,ge,Dc,!0,Oc,gd),!ze&&gg&&(ge===Eb.a.JG||ge===Eb.a.qO)){const Ll=We.SelectionEditor.l3(Ld.gb.kb).y;Ya.App.Pgc(()=>{this.den(Ld,je,Ll)})}}32===Dc&&bc.view.qe&&this.Pg.iF();return Dc};this.Cla=b;this.LTe=h;this.Tm=v;this.I1=D;this.YY=Q;this.OTe=ba;
this.gJa=ta;this.ld=Ta;this.Gc=ob;this.hDe=Kb}get Pg(){return this.Jm||(this.Jm=this.Cla())}Tb(){const b=w.AFrameworkApplication.va,h=this.cFo;b.fb(Eb.a.tab,Zb.a.view,h,1124);b.fb(Eb.a.tcg,Zb.a.view,h,1124);b.qa(Eb.a.Mqi,Zb.a.view,Rc.ActionManager.Pf)}den(b,h,v){if(b&&h){var D=b.gb.kb;We.SelectionEditor.l3(D).y<v?(h=We.SelectionEditor.OLc(h,D,!1),h=We.SelectionEditor.pva(h,{OA:!1,ys:!1,GC:!1,jE:!0})):h=We.SelectionEditor.PLc(h,D,!1);b.setSelection(h)}}Apk(){return Eb.a.s2a}jri(){}gZc(b,h,v){if(b&&
h){var D=b.gb.kb;We.SelectionEditor.l3(D).y<v?(h=We.SelectionEditor.OLc(h,D,!1),h=We.SelectionEditor.pva(h,{OA:!1,ys:!1,GC:!1,jE:!0})):h=We.SelectionEditor.pva(D,{OA:!1,ys:!1,GC:!1,jE:!0});b.setSelection(h)}}static get Xf(){return xi.a.instance}static get Wg(){return io.ContextSetEditor.instance}}Object(n.a)(KF,"TabActor",null,[]);class wH{constructor(b){this.Auc=b}get gq(){return this.Auc}yGn(b){return b}jkm(b,h,v,D){const Q=D.view,ba=Q.lb.gb.kb;if(Ph.TableCellReader.Moa(b))return this.ixi(b,D)?
Eb.a.JG:Eb.a.S4d;ig.OutlineElementNavigator.Vd(b);if(We.SelectionEditor.gf(h))Cd.OutlineElementReader.EA(b,h,!1)&&this.Xpj(b)?v=Eb.a.QLb:We.SelectionEditor.DVc(Q,ba)&&this.gq.jAb(b)?v=Eb.a.JG:We.SelectionEditor.DVc(Q,ba)&&(v=Eb.a.JG);else if(We.SelectionEditor.ml(h)){if(!this.gq.jAb(b))return v;We.SelectionEditor.wjb(h)?v=Eb.a.JG:We.SelectionEditor.gCi(h)&&(v=this.Xpj(b)?Eb.a.QLb:Eb.a.JG)}else this.gq.jAb(b)&&(v=Eb.a.JG);return v}ikm(b,h,v,D){if(Ph.TableCellReader.Z_(b))return this.ixi(b,D)?Eb.a.qO:
v;ig.OutlineElementNavigator.Vd(b);if(We.SelectionEditor.gf(h))Cd.OutlineElementReader.EA(b,h,!1)&&(!Hg.ListItemReader.Ig(b)&&Cd.OutlineElementReader.isEmpty(b,!1)?v=Rc.ActionManager.nxa:this.hqo(b)?v=Eb.a.yfb:this.gpj(b)?v=Eb.a.XBb:this.gq.Z1b(b)&&(v=Eb.a.qO));else if(We.SelectionEditor.ml(h)){if(!this.gq.Z1b(b))return v;We.SelectionEditor.wjb(h)?v=Eb.a.qO:We.SelectionEditor.gCi(h)&&(v=this.gpj(b)?Eb.a.XBb:Eb.a.qO)}else this.gq.Z1b(b)&&(v=Eb.a.qO);return v}Xpj(b){return Hg.ListItemReader.Ig(b)?!1:
0<Cd.OutlineElementReader.R3(b)?!0:!1}gpj(b){if(Hg.ListItemReader.Ig(b))return!1;const h=Cd.OutlineElementReader.R3(b);b=dh.OutlineReader.xX(b.currentNode);return h<b?!0:!1}hqo(b){return Hg.ListItemReader.Ig(b)?!1:0<Cd.OutlineElementReader.vG(b)?!0:!1}static Jr(){return new wH(yt.a.NEb)}ixi(b,h){if(this.FPm){h=h.view;const v=h.lb.gb.kb,D=new ne.GraphIterator;D.Zc(b);ig.OutlineElementNavigator.Vd(D);if(Hg.ListItemReader.Ig(D)&&We.SelectionEditor.DVc(h,v))return!0}return!1}get FPm(){var b;w.AFrameworkApplication.te("egdi3422;7g6fa693");
return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(n.a)(wH,"TabActorPromoteDemoteStrategy",null,[710]);class kE extends KF{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc){super(b,h,v,D,Q,ba,ta,Ta,ob,Kb);this.p7d=(Oc,gd)=>{Oc=gd.property;!this.v4c||Oc!==lc.a.Bo&&Oc!==lc.a.marginLeft&&Oc!==lc.a.marginRight||this.v4c.ati()};this.xX=(Oc,gd,rd,je,Ld)=>{Oc=dh.OutlineReader.xX(this.B6l(gd));Ld.defaultTabStop=
Oc;return 32};this.gXb=Vb;this.ga=Dc;this.QB();this.ga.qa(sc.a.xX,Zb.a.view,this.xX)}get v4c(){return null!=this.GFg?this.GFg:this.GFg=Ga.a.instance.Na("WordEditor.Actors.RenderParagraphsContainingTabs")}QB(){this.gXb.zl.Ye(10).Go(this.p7d)}jri(b){const h=b.view,v=h.lb;b=v.tg;if(this.gJa&&this.Gc){var D=this.Gc.Oc(15);D.Cb(b.node);b.contextId===Zb.a.Hd&&w.AFrameworkApplication.va.processAction(Eb.a.CH,2);this.gJa.AWd(v.tg);D.dispose();var Q=We.SelectionEditor.l3(v.gb.kb).y;Ya.App.Pgc(()=>{this.gZc(v,
h,Q)})}}B6l(b){return b.view.lb.gb.kb.Oa.node}static get instance(){return null!=kE.tCg?kE.tCg:kE.tCg=kE.Rl()}static Rl(){return new kE(()=>Ga.a.instance.resolve("Box4.IUndoManager"),wH.Jr(),Ga.a.instance.Sa("Box4.IExternalSelectionManager"),Ga.a.instance.resolve("Box4.IAutoCorrectRules"),Ga.a.instance.resolve("Box4.IAutoCorrectScheduler"),Ga.a.instance.Na("Box4.ITabPresenterFactory"),Ga.a.instance.Na("Box4.IBlobEditor"),Ga.a.instance.Na("Box4.IFeatureHelper"),Ga.a.instance.Na("Box4.Graph.GraphTransactionFactory"),
Ga.a.instance.Na("Box4.Actors.IIFrameFocusStrategy"),Ya.App.Tj,Ga.a.instance.Na("Box4.ITabRenderer"),w.AFrameworkApplication.va)}}Object(n.a)(kE,"TabActor",KF,[]);class Ix{static get qt(){return null!=Ix.Lvg?Ix.Lvg:Ix.Lvg=Ga.a.instance.resolve("Box4.IAppFrame")}static initialize(){Dt.a.nbc=Ix.CQm;Dt.a.Kke=Ix.u3o}static CQm(b){return!rh.TableReader.xLm(b)}static Tlb(){Ix.qt.ahc(Ix.Tlb);Ix.Svb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&
0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static u3o(b){var h,v,D;b&&((null===(h=lr.a.instance.kb)||void 0===h?0:h.DFa)||(null===(v=lr.a.instance.kb)||void 0===v?0:v.qw)||(null===(D=lr.a.instance.kb)||void 0===D?0:D.$Hb))&&!Ix.Svb&&(Ix.qt.XYa(Ix.Tlb),Ix.Svb=!0)}}Ix.Svb=!1;Object(n.a)(Ix,"TableActor",null,[]);var XM=c(912);class xH{iDl(b,h,v,D){return b?this.KBl(h,v,D):this.jDl(h,v,D)}SZh(b,h,v,D,Q){return b?this.MCl(h,v,D,Q):this.zCl(h,v,D,Q)}wCl(b){let h=
!1;var v=b.Nf?b.Me.Pc:b.Me.Oa;b=new ne.GraphIterator;b.set(v.node);b.zb(14);v=null;Ph.TableCellReader.dca(b)?Ph.TableCellReader.pHb(b)||(h=!0,v=Ig.moveToNextRow(b)):v=Ig.moveToNextColumn(b);return{returnValue:v,xen:h}}HCl(b){var h=b.Nf?b.Me.Pc:b.Me.Oa;const v=new ne.GraphIterator;v.set(h.node);v.zb(14);h=null;Ph.TableCellReader.jha(v)?Ph.TableCellReader.iha(v)||(h=new ne.GraphIterator,h.set(b.ACa.node),h.zb(14),b=Kl.a.xs(h),Kl.a.xs(v)>b?(Ig.moveToPreviousRow(v),Ig.moveToLastColumn(v),h=v.currentNode):
h=Ig.moveToPreviousRow(v)):h=Ig.moveToPreviousColumn(v);return h}f_h(b,h){var v=b.Nf?b.Me.Pc:b.Me.Oa;b=new ne.GraphIterator;b.set(v.node);b.zb(14);v=null;h?Ph.TableCellReader.iha(b)||(v=Ig.moveToPreviousRow(b)):Ph.TableCellReader.pHb(b)||(v=Ig.moveToNextRow(b));return v}nIb(b,h,v){for(;Ph.TableCellReader.hg(b);)if(h){if(v&&b.zwa(1)||!v&&b.Gwa(1))return null;v?Ig.moveToPreviousColumn(b):Ig.moveToNextColumn(b)}else{if(Ph.TableCellReader.q4(b.currentNode)){const D=new ne.GraphIterator;D.Zc(b);if(this.nIb(D,
!0,!0)||this.nIb(D,!0,!1)){b.Zc(D);break}}else{if(!v&&Ig.moveToControllingCell(b,2))break;if(v&&Ig.moveToControllingCell(b))break}if(v&&Ph.TableCellReader.iha(b)||!v&&Ph.TableCellReader.pHb(b))return null;v?Ig.moveToPreviousRow(b):Ig.moveToNextRow(b)}return b.currentNode}h6b(b,h){if(!Kl.a.isTableRow(b))return null;b=ne.GraphIterator.$a(b.currentNode);b.zb(14);let v;const D=rh.TableReader.BB(b.origin);do v=h?Ig.moveToPreviousRow(b):Ig.moveToNextRow(b);while(D&&v&&Kl.a.YPa(b));return v}slb(b,h,v,D,
Q){let ba=null;ig.OutlineElementNavigator.Vd(b);const ta=Cd.OutlineElementReader.isRtl(b.currentNode);if(v)if(Ig.returnToCell(b),h=Ph.TableCellReader.dca(b),v=Ph.TableCellReader.jha(b),Q||!ta&&v||ta&&D&&h)Ig.returnToContainingRow(b),(D=this.h6b(b,!0))?ba=Mg.SelectionFactory.ho(D,!h):Q&&(ig.OutlineElementNavigator.Vd(b),Q=new Km.a,Q.Zc(b),(b=ig.OutlineElementNavigator.q0(Q,!1,!1))&&(ba=Mg.SelectionFactory.ho(b,!1)));else{do ta?Ig.moveToNextColumn(b):Ig.moveToPreviousColumn(b);while(Ph.TableCellReader.hg(b)&&
!Ph.TableCellReader.iha(b));Ph.TableCellReader.hg(b)||(ba=Mg.SelectionFactory.ho(b.currentNode,!ta))}else Cd.OutlineElementReader.EA(b,h,ta)||We.SelectionEditor.gf(h)||Ig.returnToCell(b),ba=Mg.SelectionFactory.ho(b.currentNode,!ta);return ba}rlb(b,h,v,D,Q){let ba=null;ig.OutlineElementNavigator.Vd(b);const ta=Cd.OutlineElementReader.isRtl(b.currentNode);if(v)if(Ig.returnToCell(b),v=Ph.TableCellReader.dca(b),h=Ph.TableCellReader.jha(b),Q||!ta&&D&&v||ta&&!D&&h)Ig.returnToContainingRow(b),(D=this.h6b(b,
!1))?ba=Mg.SelectionFactory.ho(D,h):(ig.OutlineElementNavigator.Vd(b),D=new Km.a,D.Zc(b),(b=ig.OutlineElementNavigator.Ur(D,!1,!1))&&(ba=Mg.SelectionFactory.ho(b,!0)));else{do ta?Ig.moveToPreviousColumn(b):Ig.moveToNextColumn(b);while(Ph.TableCellReader.hg(b)&&!Ph.TableCellReader.dca(b));Ph.TableCellReader.hg(b)||(ba=Mg.SelectionFactory.ho(b.currentNode,ta))}else Cd.OutlineElementReader.EA(b,h,!ta)||We.SelectionEditor.gf(h)||Ig.returnToCell(b),ba=Mg.SelectionFactory.ho(b.currentNode,ta);return ba}}
Object(n.a)(xH,"ATableCellSelectionStrategy",null,[1693]);class KK extends xH{constructor(){super()}zCl(b,h,v,D){let Q=b.kb,ba=null;if(b.qw)if(h)if(2===Q.Me.Qha&&!Q.Nf&&Q.Me.Pc.equals(Q.ACa))Q=Mg.SelectionFactory.uMh(Q.ACa.node,!1);else{var ta=({xen:b}=this.wCl(Q)).returnValue;ta&&(Ph.TableCellReader.Qr(ta)&&(ta=ne.GraphIterator.$a(ta),ta.zb(14),ta=!b&&this.nIb(ta,!0,!1)?ta.currentNode:b||Ig.moveToNextRow(ta)?this.nIb(ta,!1,!1):null),ta&&(ba=Mg.SelectionFactory.io(Ar.TableNodeContext.create(ta),Q.Nf)))}else Q=
b.tda,b=ne.GraphIterator.$a(Q.Me.Pc.node),b.zb(14),Ph.TableCellReader.nFa(b.currentNode)&&Ig.moveToLastGhostCell(b,2),(ta=Ig.moveToNextColumn(b))?(b=Ph.TableCellReader.q4(ta),Ph.TableCellReader.Qr(ta)&&!b&&(ta=ne.GraphIterator.$a(ta),ta.zb(14),ta=Ig.moveToControllingCell(ta)),b?Q=Mg.SelectionFactory.ho(Q.Me.Pc.node,!1):ba=Mg.SelectionFactory.ho(ta,!0)):(ta=Q.Me.Pc.node,ba=Mg.SelectionFactory.ho(ta,!1));else b=h&&Q.Nf||!h&&!Q.Twa?Q.Me.Pc:Q.Me.Oa,Kl.a.Noa(b.node)&&(b=ne.GraphIterator.$a(b.node),(ta=
this.h6b(b,!1))?ba=h?Mg.SelectionFactory.io(Ar.TableNodeContext.create(ta),Q.Nf):Mg.SelectionFactory.ho(ta,!0):Q=We.SelectionEditor.xj(Mg.SelectionFactory.uq(b.currentNode),!1,!0));return ba?ba:D?We.SelectionEditor.g6b(Q,!1,h,!0):We.SelectionEditor.pva(Q,{OA:!h,ys:h,GC:v,jE:!0})}MCl(b,h,v,D){let Q=b.kb;var ba=null;if(b.qw)h?1===Q.Me.Qha&&Q.Nf&&Q.Me.Oa.equals(Q.ACa)||(ba=this.HCl(Q),(ba=this.QZh(Q,ba))||Q.Nf&&(Q=Q.gMc())):(Q=b.tda,ba=Mg.SelectionFactory.ho(Q.Me.Oa.node,!0));else if(h){var ta=(Q.Nf?
Q.Me.Pc:Q.Me.Oa).node;b=ne.GraphIterator.$a(ta);We.SelectionEditor.mu(b);Kl.a.Noa(ta)&&(Q.Nf&&1===Q.Me.Qha&&Q.Twa?(ba=Kl.a.tB(ta).toArray(),(ba=this.QZh(Q,0<=ba.length-2?ba[ba.length-2]:null))||Q.Nf&&(Q=Q.gMc())):(ta=this.h6b(b,!0))?ba=Mg.SelectionFactory.io(Ar.TableNodeContext.create(ta),Q.Nf):Q=Mg.SelectionFactory.ho(b.currentNode,!0))}else ba=We.SelectionEditor.xj(Q,!0,!1);return ba?ba:D?We.SelectionEditor.g6b(Q,!0,h,!0):We.SelectionEditor.TDa(Q,{OA:!h,ys:h,GC:v,jE:!0})}QZh(b,h){if(!h)return null;
var v=h;Ph.TableCellReader.Qr(h)&&(v=ne.GraphIterator.$a(h),v.zb(14),v=this.nIb(v,!0,!0)?v.currentNode:Ph.TableCellReader.nga(h));return v?Mg.SelectionFactory.io(Ar.TableNodeContext.create(v),b.Nf):null}jDl(b,h,v){let D=h.kb,Q=null;if(h.qw){var ba=h.iX>h.VHa;if(v)if(2===h.length&&1===h.tda.Me.Qha&&ba)D=We.SelectionEditor.xj(D,!0,!1);else{if(h=this.f_h(D,!0))Ph.TableCellReader.Qr(h)&&(h=ne.GraphIterator.$a(h),h.zb(14),h=this.nIb(h,!1,!0)),h&&(Q=Mg.SelectionFactory.io(Ar.TableNodeContext.create(h),
D.Nf));Q||D.Nf&&(D=D.gMc())}else ba&&(D=h.tda)}else h=v&&D.Nf?D.Me.Pc:D.Me.Oa,Kl.a.Noa(h.node)&&(h=ne.GraphIterator.$a(h.node),(ba=this.h6b(h,!0))?Q=v?Mg.SelectionFactory.io(Ar.TableNodeContext.create(ba),D.Nf):Mg.SelectionFactory.ho(ba,!0):v&&(D=Mg.SelectionFactory.ho(h.currentNode,!0)));return Q?Q:We.SelectionEditor.cfb(b,D,!1,v,v)}KBl(b,h,v){let D=h.kb,Q=null;if(h.qw){const ba=h.iX<h.VHa;if(v)if(2===h.length&&1===h.tda.Me.Qha&&ba)D=We.SelectionEditor.xj(D,!1,!1);else{if(h=this.f_h(D,!1))Ph.TableCellReader.Qr(h)&&
(h=ne.GraphIterator.$a(h),h.zb(14),h=this.nIb(h,!1,!1)),h&&(Q=Mg.SelectionFactory.io(Ar.TableNodeContext.create(h),D.Nf))}else ba&&(D=h.tda)}else h=!v||D.Nf?D.Me.Pc:D.Me.Oa,Kl.a.Noa(h.node)&&(h=ne.GraphIterator.$a(h.node),(h=this.h6b(h,!1))&&(Q=v?Mg.SelectionFactory.io(Ar.TableNodeContext.create(h),D.Nf):Mg.SelectionFactory.ho(h,D.Twa)));return Q?Q:We.SelectionEditor.cfb(b,D,!0,v,v)}}Object(n.a)(KK,"TableCellSelectionStrategy",xH,[]);class LK{constructor(b){this.rL=(h,v,D,Q,ba)=>{if(1===D)return 32;
h=(new fo.a).create();v="";switch(ba.DialogType){case "DirectPrintPreparingPDF":v=CommonUIStrings.l_DirectPrintPreparingPDF;ba=CommonUIStrings.l_DefaultDialogTitle;break;default:ba=CommonUIStrings.l_DefaultDialogTitle}h.message=v;h.rL(ba,null,null);return 32};this.ga=b}Tb(){this.ga.fb(Eb.a.rL,Zb.a.view,this.rL,1028)}}Object(n.a)(LK,"UIAutomationActor",null,[]);class MK{constructor(b,h,v,D){this.eb=b;this.gJa=h;this.hpc=v;this.w6=D}Ckg(b,h,v){return this.hpc.tOm(h)?v?!0:b&&this.eb.sh(b)?(b=this.jw(b.currentNode),
this.gJa.xri(b),!0):!1:!1}zwf(b,h){return this.hpc.uwl(b,h)}Gwf(b){b&&this.eb.sh(b)&&(b=this.jw(b.currentNode),this.gJa.AWd(b))}jw(b){return Pe.a.jw(b)}Q9(b,h,v){this.w6.U_i&&this.hpc.Qvi(v)&&(this.w6.Q9(b,h),b.setValue(wc.a.hwi,!0))}Ege(){}wYd(b){return this.hpc.wYd(b)}get EZd(){return this.hpc.EZd}fD(){}gda(){}Zge(){}get tqj(){return!1}}Object(n.a)(MK,"WordEditorPasteStewardBridge",null,[696]);class NK{constructor(b){this.ra=new cf.a;this.Lfj="WordFileSaveAsButtonClicked";this.w3o=()=>{this.ra.raiseEvent(this.Lfj,
null);return 32};this.ga=b}Tb(){w.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(sc.a.KKj,Kd.a.frame,this.w3o)}Xxk(b){this.ra.addHandler(this.Lfj,b)}}Object(n.a)(NK,"WordFileSaveAsActor",null,[]);class OK extends Cy{constructor(){super()}rEc(b,h,v,D,Q,ba,ta){return Pr.a.Gfc(h,v,D,Q,ba,ta)}}Object(n.a)(OK,"WordIndentationActorExtension",Cy,[]);class yH{constructor(){this.tmd=null}get name(){return"WordEditor.Actors"}init(){var b;Ob.InteractiveViewManager.instance.editingView.t4b=
!0;w.AFrameworkApplication.va.qa(sc.a.s2o,Kd.a.frame,CM);this.W.resolve("WordEditor.Actors.DeleteActor").Tb(w.AFrameworkApplication.va);dE.instance.Tb();ln.Tb();Gq.Tb(w.AFrameworkApplication.va,this.W.resolve("WordEditor.IMainViewModeManager"));jk.Tb();kE.instance.Tb();XM.a.Tb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Tb(w.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Tb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Tb();w.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&
this.W.resolve("Box4.Actors.FormatPainterActor").Tb();w.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Tb();w.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&w.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.oW.NZd=!0);w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Tb();
w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Tb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Tb();this.W.resolve("Common.IOfficeTrialExperience").Tb();this.W.resolve("Common.IMacOfficeOffer").Tb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Tb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Tb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Tb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Tb();
this.W.resolve("WordEditor.Actors.StylesActor").Tb();(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Tb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Tb();this.W.resolve("WordEditor.Actors.ProofingActor").Tb();this.W.resolve("WordEditor.Actors.PageActor").Tb();this.W.resolve("WordEditor.Actors.DarkModeActor").Tb();this.W.resolve("WordEditor.Actors.ImageActor").Tb(w.AFrameworkApplication.va);
this.W.resolve("WordEditor.Actors.FormattingActor").Tb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Tb();this.W.resolve("WordEditor.Actors.ContentControlActor").Tb();this.W.resolve("WordEditor.Actors.CustomTabActor").Tb();this.W.resolve("WordEditor.Actors.BookmarkActor").Tb();this.W.resolve("WordEditor.Actors.HeadingsActor").Tb();this.W.resolve("Box4.Indicator.IIndicatorManager").x5a(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Tb();
this.W.resolve("WordEditor.Actors.AccessibilityActor").P3f();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Tb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Tb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Tb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").BY();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Tb();
w.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.iTn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb();this.YV.w5a(this.bXj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");w.AFrameworkApplication.te("bookmarks-core-ex;bookmarks-core-ex-cf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.cpm()&&Ya.App.xa.hb.HVh();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",
!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Tb();Ya.App.xa.updateCommandUI();Ix.initialize()}dispose(){}iTn(){this.ld.Lp.isCompleted?this.ld&&this.ld.isFeatureEnabled(49)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb():this.ld.Lp.continueWith(()=>{this.ld&&this.ld.isFeatureEnabled(49)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb(),Ya.App.xa.updateCommandUI())})}get NOm(){if(null==this.tmd)if(this.ld)if(this.ld.Lp.isCompleted)this.tmd=this.ld.isFeatureEnabled(3);
else return!1;else this.tmd=!1;return this.tmd}xc(b){var h,v;this.W=b;this.ld=b.Na("Box4.IFeatureHelper");this.oW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.oW.lVc=w.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new hJ).xc(b);b.ha("Box4.IClipboardCommands",()=>new iJ(w.AFrameworkApplication.va,Eb.a.l4e,Eb.a.hFc,Eb.a.c_,Eb.a.hYf,
Eb.a.paste,Eb.a.u9,Eb.a.Pmb)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const D=b.resolve("Common.IAppSettingsManager");return new tA(!0,D.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const D=b.resolve("Common.IAppSettingsManager"),Q=ba=>!ba.W$b;return new eJ(D.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,D.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,
!0,ba=>ba.W$b,()=>!1,Q,Q,Q,Q,void 0,()=>this.NOm,ba=>!ba.W$b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new MK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new zK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),
b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new jJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();b.ha("Box4.IIndentationCommands",()=>new kJ(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new lJ(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.ISpacingCommands",()=>new mJ(w.AFrameworkApplication.va)).singleInstance();
b.ha("WordEditor.IPageCommands",()=>new vK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new HK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new IF(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.DigitalPrintActor",
()=>new oH(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new bK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new uM.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",()=>new ZJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),w.AFrameworkApplication.K.$("DisablePrint"),w.AFrameworkApplication.K.jb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).singleInstance();
b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new xK(w.AFrameworkApplication.va,b.Ue("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Zn.a.instance,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new sK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Zn.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",
()=>new SJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Zn.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new Fj.a(b.Sa("Common.ISystemInitiatedFeedback"),sJ.a.l7b())).as("WordEditor.IModeSwitcherControl").singleInstance();b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new wK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Zn.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new mK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();
b.register(XJ,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new AK(w.AFrameworkApplication.va,xi.a.instance,Ga.a.instance.resolve("Box4.ISelectionManager"),Lo.a.instance,Ga.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ga.a.instance.resolve("Box4.ILanguageReader"),Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ga.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ga.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),
this.oW,Ga.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),w.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ga.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").Pz.loadScript("EditorSettingsManager")).then(()=>{const D=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");D.wwm();
D.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new nJ(w.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new oJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();w.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&w.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Tb()});b.ha("WordEditor.Actors.PageActor",
()=>new uK(Ga.a.instance.resolve("Box4.IWordSectionEditor"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"),Ga.a.instance.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",()=>new VJ(w.AFrameworkApplication.va,w.AFrameworkApplication.K,Ya.App.yda,!!Ya.App.instance&&Ya.App.instance.mFa,!!Ya.App.instance&&Ya.App.instance.HVc,
Ga.a.instance.resolve("Box4.IDarkModeState"),Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ga.a.instance.resolve("Box4.DarkModeEventsManager"),!!Ya.App.instance&&Ya.App.instance.Doa)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new dK(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",()=>new AJ(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),b.Ue("WordEditor.FlatListDetailsProvider"),b.Ue("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),
b.Ue("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new OJ(w.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>new Zq(b.resolve("WordEditor.IImageEditor"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),
b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),w.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new NK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new EK(b.resolve("WordEditor.IImageEditor"),w.AFrameworkApplication.K,
w.AFrameworkApplication.ta.GEa,Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new WJ.DeleteActor(Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.Sa("Box4.ContentControlConfigSettings"),Ga.a.instance.Sa("Box4.IContentControlEditor"),
Ga.a.instance.resolve("Box4.IDynamicRangeEditor"),Ga.a.instance.Sa("WordEditor.Bookmark.IBookmarkManager"),Ga.a.instance.resolve("Box4.IHyperlinkEditor"),Ga.a.instance.resolve("Box4.IHyperlinkStrategy"),Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("Box4.IParagraphIndentationReader"),Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).singleInstance();
this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new JK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),w.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new KK).as("Box4.ITableCellSelectionStrategy").singleInstance();w.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new pJ(b.resolve("Box4.Styles.IWACStyleEditor"),
b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),xi.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),
b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").singleInstance();b.ha("Box4.Actors.FormatPainterActor",()=>new eE(Ya.App.xa,$c.FocusManager.instance(),w.AFrameworkApplication.va,Ye.a.instance,lr.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Ya.App.instance&&Ya.App.instance.Doa,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new eK(w.AFrameworkApplication.va,
b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",()=>new LK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new GK(w.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new qJ(b.Na("Box4.IAutoCorrectScheduler"),b.Ue("Box4.IUndoManager"),b.Sa("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",
()=>new jD(bi.PageReader.instance,b.Ue("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance();b.ha("WordEditor.Actors.ContentControlActor",()=>new TJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.va,w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new BJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),$c.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new rJ).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new tG(w.AFrameworkApplication.Ne,Rl.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),w.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();
b.ha("WordEditor.Actors.GraphicsEditorActor",()=>new jK(w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),w.AFrameworkApplication.Ne,
this.ld,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new FK).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new UJ(w.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new kK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),w.AFrameworkApplication.va,
b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>new RJ(Ya.App.xa,w.AFrameworkApplication.va,Th.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Fg.a(()=>Ya.App.xa.hb.Uc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Lo.a.instance,this.W.Sa("Common.ISystemInitiatedFeedback"),
b.resolve("Box4.IOutlineElementNavigator"),Ob.InteractiveViewManager.instance,this.W.Ue("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),xi.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var D,Q;return new bt(b.resolve("Box4.IParagraphReader"),pf.a.instance,Sh.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(Q=null===(D=Ya.App.instance)||void 0===D?void 0:D.WC)&&void 0!==
Q?Q:!1,new Fg.a(()=>Ya.App.xa.hb.rc))}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new lK).singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new iE(Th.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Ob.InteractiveViewManager.instance,Id.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new dt(w.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.K,
b.resolve("Wonca.ExternalContent.IExternalContentEditor"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new zJ).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new CJ(w.AFrameworkApplication.K,w.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").singleInstance();
b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new hE(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),Ob.InteractiveViewManager.instance,mw.a.instance(),w.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ya.App.Tj.zl.Ye(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),
b.resolve("Box4.SelectionManager"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new OK).as("Box4.Actors.IIndentationActorExtension").singleInstance();w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",
!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new tH(w.AFrameworkApplication.va)).singleInstance());w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new EG(w.AFrameworkApplication.va)).singleInstance();(new dJ).xc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new yJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();
b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new vJ(w.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new wJ(w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),xi.a.instance,w.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?
Ga.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).singleInstance();(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))&&b.ha("WordEditor.Actors.MiniTemplateActor",()=>new tK(w.AFrameworkApplication.va,b.Sa("WordEditor.Extension.IInsertApiOperations"),b.Sa("WordEditor.Designer.Style.IParagraphDesigner"),sJ.a.l7b())).singleInstance();this.bXj=new tJ;this.YV=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){N.a.instance.Fc(new yH)}}
Object(n.a)(yH,"WordEditorActorsPackage",null,[1,2]);class PK{constructor(b){this.dvc=!1;this.eUi=()=>{this.dvc=!0;this.es.jde(this.eUi)};this.es=b;this.es.izb(this.eUi)}}Object(n.a)(PK,"GraphFullyConnectedGetter",null,[721]);class Xf{constructor(){this.m4g=Object.assign(new so.a,{})}hrk(b,h){let v;const D=b&1023;({value:v}=this.m4g.Dc(D,0)).returnValue||Xf.yjm().contains(D)||u.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,D);v+=h;this.m4g.Z(D,v);return v}static yjm(){Xf.ovd||
(Xf.ovd=new za.a,Xf.qc(0),Xf.qc(1),Xf.qc(2),Xf.qc(3),Xf.qc(4),Xf.qc(5),Xf.qc(6),Xf.qc(7),Xf.qc(8),Xf.qc(9),Xf.qc(10),Xf.qc(11),Xf.qc(12),Xf.qc(13),Xf.qc(14),Xf.qc(15),Xf.qc(16),Xf.qc(17),Xf.qc(18),Xf.qc(19),Xf.qc(20),Xf.qc(21),Xf.qc(22),Xf.qc(23),Xf.qc(24),Xf.qc(25),Xf.qc(26),Xf.qc(27),Xf.qc(28),Xf.qc(29),Xf.qc(30),Xf.qc(31),Xf.qc(32),Xf.qc(33),Xf.qc(34),Xf.qc(35),Xf.qc(36),Xf.qc(37),Xf.qc(38),Xf.qc(39),Xf.qc(40),Xf.qc(41),Xf.qc(42),Xf.qc(43),Xf.qc(44),Xf.qc(45),Xf.qc(46),Xf.qc(47),Xf.qc(48),Xf.qc(49),
Xf.qc(50),Xf.qc(51),Xf.qc(52),Xf.qc(53),Xf.qc(54),Xf.qc(55),Xf.qc(56),Xf.qc(57),Xf.qc(58),Xf.qc(59),Xf.qc(60),Xf.qc(61),Xf.qc(62),Xf.qc(63),Xf.qc(64),Xf.qc(65),Xf.qc(66),Xf.qc(67),Xf.qc(68),Xf.qc(69),Xf.qc(70),Xf.qc(71),Xf.qc(72),Xf.qc(73),Xf.qc(74),Xf.qc(75),Xf.qc(76),Xf.qc(77),Xf.qc(78),Xf.qc(79),Xf.qc(80),Xf.qc(81),Xf.qc(82),Xf.qc(83),Xf.qc(84),Xf.qc(85),Xf.qc(86),Xf.qc(87),Xf.qc(88),Xf.qc(89),Xf.qc(90),Xf.qc(91),Xf.qc(92),Xf.qc(93),Xf.qc(94),Xf.qc(95),Xf.qc(96),Xf.qc(97),Xf.qc(98),Xf.qc(99),Xf.qc(100),
Xf.qc(101),Xf.qc(102),Xf.qc(103),Xf.qc(104),Xf.qc(105),Xf.qc(106),Xf.qc(107),Xf.qc(108),Xf.qc(109),Xf.qc(110),Xf.qc(111),Xf.qc(112),Xf.qc(113),Xf.qc(114),Xf.qc(115),Xf.qc(116),Xf.qc(117),Xf.qc(118),Xf.qc(119),Xf.qc(120),Xf.qc(121),Xf.qc(122),Xf.qc(124),Xf.qc(126),Xf.qc(127),Xf.qc(128),Xf.qc(129),Xf.qc(130),Xf.qc(131),Xf.qc(132),Xf.qc(133),Xf.qc(134),Xf.qc(135),Xf.qc(136),Xf.qc(140),Xf.qc(145),Xf.qc(146),Xf.qc(147));return Xf.ovd}static qc(b){Xf.ovd.add(b&1023)}}Xf.ovd=null;Object(n.a)(Xf,"LanguagePerParagraphModel",
null,[]);class QK{constructor(){this.Edg=!1;this.ZCd=this.YCd=this.tRb=0;this.JCi=!0;this.W5o=0}}Object(n.a)(QK,"UpdateWordCountStateResult",null,[]);class RK extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(n.a)(RK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class SK{constructor(){this.QBh=this.PBh=this.wordCount=-1;this.sCb=this.rxh=0;this.rCb=1;this.m_i=1033}}Object(n.a)(SK,"WordCountCache",null,[]);class TK extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(n.a)(TK,"WordCountChangedEventArg",Sys.EventArgs,[]);class UK{constructor(){this.gnc=this.JCa=0}}Object(n.a)(UK,"CharsCountResult",null,[]);class VK{constructor(){this.cp=0;this.inc=null;this.B7=this.C7=0}}Object(n.a)(VK,"TextChunkResult",null,[]);class WK{constructor(){this.yKj=this.C7=this.B7=this.wordCount=0}}Object(n.a)(WK,"WordCountStateForParagraph",null,[]);class zH{constructor(){this.c$=this.pJ=this.C7=this.B7=this.AR=this.wordCount=0;this.currentNode=null;this.iX=-1;this.cp=0;this.zYf=
[];this.rCb=this.sCb=this.uZa=this.uYf=this.vYf=0;this.iI=this.Owi=!1;this.Jqb=new zb.a;this.C3a=new zb.a}}Object(n.a)(zH,"WordCountState",null,[]);class $q{constructor(b,h,v,D,Q,ba){this.OAo=1E3;this.ra=new cf.a;this.Iyb=null;this.Gre=0;this.Y2j="\ue000";this.Vrc=!1;this.Wwe=this.Lwe=this.Kgd=0;this.uQg=this.CQg=null;this.Hwe=this.Gwe=this.Qwe=0;this.Ipl=ta=>{this.Iyb=null;this.wff(ta.customData)};this.KF=h;this.m1j=new RegExp(S.AParagraphNode.BC,"g");this.Gd=b;this.taskManager=D;this.Om=v;this.IYa=
ba;this.hWa=Q.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Nhk=Q.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.Wcj()}get HUm(){return!!this.Iyb}get UNa(){return this.Vrc}set UNa(b){this.Vrc=b}get vyd(){return this.Gre}set vyd(b){this.Gre=b}get zQa(){return!this.Gre}get jy(){return this.Kgd}get CBb(){return this.Lwe}get GBb(){return this.Wwe}get Vfl(){return this.CQg}get Sbf(){return this.uQg}get GIc(){return this.Qwe}get EIc(){return this.Gwe}get X3b(){return this.Hwe}izb(b){this.ra.addHandler($q.Roe,
b)}jde(b){this.ra.removeHandler($q.Roe,b)}s_e(b){this.ra.addHandler($q.Xog,b)}U0n(b){this.ra.removeHandler($q.Xog,b)}eId(){this.dId();this.Wcj()}Wcj(){this.Qwe=this.Hwe=this.Gwe=this.Wwe=this.Lwe=this.Kgd=-1}adf(){this.Eje(this.OAo)}e9c(){const b=new zH;b.Owi=!0;this.dId();this.wff(b)}Eje(b,h=null){this.zQa&&(this.HUm&&(h=null,this.dId()),h||(h=new zH),b=new of.a(3,1,b,this.Ipl,this.vxj),b.customData=h,this.Bvk(b))}dId(){this.Iyb&&(this.taskManager.We(this.Iyb),this.Iyb=null)}BHj(b,h,v,D,Q,ba=!0,
ta=-1,Ta=-1,ob=-1,Kb=1033){const Vb=new QK;Vb.tRb=v;Vb.YCd=Q;Vb.ZCd=D;if(!b.cp&&h.Tbd&&ba&&!this.Bei(h))return $q.IYo(b,h.Tbd),Vb.JCi=!0,Vb;D=0<=Ta&&0<=ob?{yd:Ta,endCp:ob}:void 0;v=this.LKl(h,D);D&&(Ta=D.yd,ob=D.endCp);v=0<=ob?v.substring(0,ob):v;ob=0<=Ta&&0<=ob?v.substring(Ta,ob):v;D=b.cp>=Ta?b.cp:Ta;Q=b.zYf||[];ba=0<b.vYf?b.vYf:0;let bc=0<b.uYf?b.uYf:0,Dc=[];b.iI=!1;do{this.IYa.update();if(!b.Owi&&(Vb.tRb+Dc.length/2>$q.a3o||this.IYa.vlb())){let rd;Q=(rd=Q).concat.apply(rd,Dc);b.cp=D;b.zYf=Q;b.uYf=
bc;b.vYf=ba;b.iX=ta;b.currentNode=h;this.Eje($q.x6o,b);Vb.Edg=!0;b.iI=!0;return Vb}if((!D||D===Ta)&&0<v.length&&D<v.length){Q.push(yA.a.instance.Muf(v,D));var Oc=this.Bei(h);if(0<=ta&&!D&&Oc){b.wordCount+=1;Vb.tRb+=1;const rd=this.Gd.DX(Oc);Oc=this.KF.RZc(rd,Oc);Oc=$q.dGd(Oc);b.C7+=Oc.JCa+1;b.B7+=Oc.JCa-Oc.gnc}}Oc=this.Zii(v,D,$q.AWk);D=Oc.cp;let gd;Dc=(gd=Dc).concat.apply(gd,Oc.inc);ba+=Oc.C7;bc+=Oc.B7}while(-1!==D);b=this.mpk(b,Q,Dc,v,ob,Vb.tRb,Vb.YCd,Vb.ZCd,h,-1===ta,Kb);Vb.tRb=b.wordCount;Vb.YCd=
b.B7;Vb.ZCd=b.C7;Vb.W5o=b.yKj;return Vb}GSh(b,h){const v=de.ParagraphReader.textLength(h,9);if(v){h=Ba.e(h);var D=0;for(let Q=0;Q<h.length;Q++)if(this.Fib&&5===h[Q].Bh&&b.pJ++,$q.Opo(h[Q])){D++;break}h.length!==v?b.AR++:b.AR+=D}}fpj(b){this.vyd=this.lqo(b.uZa,b.wordCount)?1:0;return!!this.vyd}XXi(b){this.Kgd=b.wordCount;this.Lwe=b.pJ;this.Wwe=b.c$;this.Hwe=b.C7;this.Gwe=b.B7;this.Qwe=b.AR;this.CQg=b.Jqb;this.uQg=b.C3a;this.X5i(b)}X5i(b){this.ra.raiseEvent($q.Roe,new TK(b))}W5i(){this.ra.raiseEvent($q.Xog,
new RK(!1))}lqo(b,h){if(aa.a.At||aa.a.du||aa.a.PH)return!1;(h/=2)||(h=1);return(h?b/h:0)>$q.L$m?!0:!1}get Fib(){const b=!this.PLf||1===this.PLf&&this.Nhk;return this.hWa&&b}hbi(b,h){let v=1033,D=0;b=h.Zqf(b);h=new Xf;for(let Q=0;Q<b.length;Q++){const ba=h.hrk(b[Q].lcid,b[Q].end-b[Q].begin);D<ba&&(D=ba,v=b[Q].lcid)}return v}mpk(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){var bc;h=(bc=h).concat.apply(bc,v);v=yA.a.instance.aji(h,D);b.wordCount+=v.wordCount;Q=$q.dGd(Q);bc=Q.JCa-Q.gnc;const Dc=Q.JCa;b.B7+=bc;b.C7+=Dc;
ba+=v.wordCount;ta+=Q.JCa-Q.gnc;Ta+=Q.JCa;b.uZa+=v.uZa;const {Grl:Oc,jKo:gd}=$q.lpk(h,D);b.sCb+=Oc;b.rCb+=gd;b.C3a.add(Vb);b.Jqb.add(v.wordCount);Kb&&$q.zPk(Dc,bc,ob,v,Oc,gd,Vb);b.cp=0;b.zYf=[];b=new WK;b.B7=ta;b.C7=Ta;b.wordCount=ba;b.yKj=v.wordCount;return b}LKl(b,h){let v=this.x2n(b);v=de.ParagraphReader.Bgb(b,9,v,h);return this.PYn(v)}x2n(b){var h=de.ParagraphReader.text(b);b=Ba.e(b);if(0<b.length){h=h.split("");for(let D=0;D<b.length;++D){let Q=!0;var v=!0;const ba=b[D];if(1===ba.Bh)v=ba,v=22!==
v.kind&&2!==v.kind;else if(5===ba.Bh)Q=!1;else if(7===ba.Bh||10===ba.Bh)h[ba.Ib.cp]=this.Y2j,Q=!1;if(Q){if(ba.Ib.cp>=h.length)return"";h[ba.Ib.cp]=v?" ":"C"}}h=h.join("")}return h}PYn(b){return b.replace(this.m1j,"")}Zii(b,h,v){const D=b.length-h<=v;var Q=D?b.length:h+v;const ba=new VK;if(Q<h)return ba.cp=-1,ba;ba.inc=yA.a.instance.Fnf(b,h,Q);Q=$q.dGd(b.substr(h,Q));ba.C7=Q.JCa;ba.B7=Q.JCa-Q.gnc;if(!ba.inc.length&&!D)return v===b.length-h?ba:this.Zii(b,h,b.length-h);ba.cp=D||!ba.inc.length?-1:ba.inc[ba.inc.length-
1].cp;return ba}Bvk(b){this.Iyb=b;this.taskManager.Wb(this.Iyb)}Bei(b){if(b=b.VI){const h=this.Gd.DX(b);if(h&&h.qz)return b}return null}static Opo(b){return 11===b.Bh}static IYo(b,h){b.wordCount+=h.wordCount;b.B7+=h.PBh;b.C7+=h.QBh;b.uZa+=h.rxh;b.sCb+=h.sCb;b.rCb+=h.rCb;b.C3a.add(h.m_i);b.Jqb.add(h.wordCount)}static zPk(b,h,v,D,Q,ba,ta){const Ta=new SK;Ta.wordCount=D.wordCount;Ta.QBh=b;Ta.PBh=h;Ta.rxh=D.uZa;Ta.sCb=Q;Ta.rCb=ba;Ta.m_i=ta;v.Tbd=Ta}static dGd(b){const h=b.length,v=new UK;for(let Q=0;Q<
h;Q++){var D=b.charCodeAt(Q);v.JCa++;if(55296<=D&&56319>=D&&(D=Q+1<h?b.charCodeAt(Q+1):0,56320<=D&&57343>=D)){Q++;continue}G.a.lca(b.charAt(Q))&&v.gnc++}return v}static lpk(b,h){let v=0,D=0;for(let Q=0;Q<b.length;++Q){const ba=b[Q],ta=ba.AL;(3===ta||2===ta)&&ba.cp<h.length&&(++v,G.a.dac(h.charCodeAt(ba.cp))&&++D)}return{Grl:D,jKo:v}}}$q.Roe="wctek";$q.Xog="wcac";$q.x6o=1;$q.AWk=400;$q.a3o=90;$q.L$m=.1;Object(n.a)($q,"WordCountManagerBase",null,[740]);class XK extends $q{constructor(b,h,v,D,Q,ba,ta,
Ta,ob,Kb,Vb){super(b,h,v,Q,ob,Kb);this.U0h=this.Evd=this.ila=null;this.opa=()=>{this.adf()};this.ib=D;this.rd=ta;this.Ehh=Ta;this.wI=Vb;this.ib.Pw(this.opa);this.aGe=ob.$("ReadingTimeIsEnabled")}get vxj(){return 66}hzm(){if(this.ila)return!0;if(!this.ib||!this.ib.gb)return this.rd&&(Ya.App.GXd||w.AFrameworkApplication.Lk?this.rd.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.rd.Yb("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.ib.gb.clone();this.ila=b.oO(!0);if(!this.ila||!this.ila.NA())return this.dId(),!1;this.Ehh&&(this.Evd=this.Ehh.create(h=>b.oO(h),this.Om));this.ila.moveNext();return!0}get PLf(){return 1}e5k(b){return b===Zb.a.Hd||b===Zb.a.paragraph?!0:this.Fib&&(b===Zb.a.iDb||b===Zb.a.image||b===Zb.a.anchoredObject)}wff(b){this.IYa.reset();if(this.hzm()){for(this.Fib&&this.Evd&&(this.Evd.Dpl(b,this.IYa)||this.Eje(1,b));this.ila.current;){const D=-1===b.iX?0:b.iX;let Q=0;var h=this.ila.current;if(!this.e5k(h.contextId)){this.ila.moveNext();
continue}if(this.Fib&&ke.ImageReader.y2a(h)){b.pJ++;this.ila.moveNext();continue}if(!de.ParagraphReader.Vb(h.node)){this.ila.moveNext();continue}const ba=h.node;if(this.UNa&&this.U0h&&this.U0h.Z0a(ba))this.ila.moveNext();else{if(this.Fib&&h.isValid){var v=ne.GraphIterator.$a(ba);for(v.Sb(6);!v.Pr;)ke.ImageReader.Eu(v.currentNode)&&b.pJ++,v.xi(6)}v=this.aGe?this.hbi(ba,this.wI):1033;h=this.BHj(b,ba,0,0,0,this.BYd(h),D,h.cpBegin,h.cpEnd,v);if(h.JCi&&(Q+=1,100<Q)){b.iX=D+1;this.Eje(1,b);return}if(h.Edg)return;
this.GSh(b,ba);this.ila.moveNext()}}this.Evd=this.ila=null;this.fpj(b)?(this.Kgd=-1,this.W5i()):this.XXi(b)}}BYd(b){let h=!1;b.contextId===Zb.a.paragraph?h=!0:b.contextId===Zb.a.Hd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(n.a)(XK,"SelectionWordCountManager",$q,[]);class FG{constructor(b,h){this.QVb=!1;this.Vxb=null;b&&h&&(this.JZb=b(!1),this.Wc=h,this.JZb.moveNext())}Dpl(b,h){if(!b||!this.JZb||!this.JZb.current)return!0;do{const v=this.JZb.current;if(v.contextId===Zb.a.tableRow||
v.contextId===Zb.a.tableCell){for(this.Vxb||this.qzm(v.node);this.Vxb.moveNext();)if(14===this.Vxb.currentNode.type&&b.c$++,h.update(),h.vlb())return!1;this.E7k(v,b);this.Vxb=null}this.JZb.moveNext()}while(this.JZb.current);return!0}E7k(b,h){const v=this.Wc.Wf(b.node);v.zb(14);b.contextId===Zb.a.tableRow&&(Kl.a.Bwi(v)&&(this.QVb=!0),Kl.a.dZd(v)&&this.QVb&&(this.QVb=!1,h.c$++));b.contextId===Zb.a.tableCell&&(Ph.TableCellReader.UTc(v)&&(this.QVb=!0),Ph.TableCellReader.eQa(v)&&this.QVb&&(this.QVb=!1,
h.c$++))}qzm(b){this.Vxb=nc.a.Zo(b);14===b.type?this.Vxb.oo(FG.ILc,b):this.Vxb.oo(FG.ILc,null)}static ILc(b){return b.parentNode?!0:!1}}Object(n.a)(FG,"TableCountSelectionTraverser",null,[741]);class YK{constructor(b){this.hWa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.hWa?new FG(b,h):null}}Object(n.a)(YK,"TableCountSelectionTraverserFactory",null,[720]);class ZK extends $q{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb){super(b,h,v,Q,ob,Kb);this.c3o=bc=>{if(bc.Pr)return!0;
bc=bc.role;return 1===bc||2===bc||this.Fib&&6===bc||3===bc||4===bc||5===bc||!this.UNa&&(7===bc||8===bc)};this.ga=D;this.Mdk=ba;this.xmk=ta;this.dQg=Ta;this.wI=Vb;this.ga.fb(sc.a.wKj,Zb.a.application,Rc.ActionManager.Pf,64);this.ga.fb(sc.a.xKj,Zb.a.application,Rc.ActionManager.Pf,64);this.aGe=ob.$("ReadingTimeIsEnabled")}get vxj(){return 63}get PLf(){return 0}wff(b){this.IYa.reset();b.iI=!1;var h=this.Mdk();bi.PageReader.instance.xHb(h)||(this.eId(),this.W5i());h=this.Om.Gva(h,7,7).currentNode;var v=
this.gal(b.currentNode,h);h=this.xmk(v,h);h.oo(this.c3o,null);let D=v=0;for(var Q=0;h.moveNext();)if(h.currentNode&&this.Gd.eca(h.currentNode)){var ba=this.Gd.DX(h.currentNode);if(ba.qz){var ta=this.Gd.DEb(h.currentNode);if(ta&&(ta=ta.pa.last,(null===ta||void 0===ta?0:ta.Uh)&&(Jd.App.rP&&ta.gi||ta.gR)))continue;b.wordCount+=1;if(ba=this.KF.RZc(ba,h.currentNode))ba=$q.dGd(ba),b.C7+=ba.JCa+1,b.B7+=ba.JCa-ba.gnc;v+=1;D+=b.C7;Q+=b.B7}}else if(this.Fib&&h.currentNode&&ke.ImageReader.Eu(h.currentNode))b.pJ++;
else if(this.Fib&&h.currentNode&&rh.TableReader.CU(h.currentNode))b.c$++;else if(h.currentNode&&de.ParagraphReader.Vb(h.currentNode)){ba=h.currentNode;ta=this.aGe?this.hbi(ba,this.wI):1033;Q=this.BHj(b,ba,v,D,Q,!0,-1,-1,-1,ta);if(Q.Edg){b.iI=!0;w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.GSh(b,ba);v=Q.tRb;D=Q.ZCd;Q=Q.YCd}this.fpj(b)?(this.eId(),this.p3n(),this.X5i(b)):this.XXi(b)}gal(b,h){b?(b=this.dQg(b),
b.zb(7)):b=this.dQg(h);return b}p3n(){switch(this.vyd){case 1:this.ga.processAction(sc.a.wKj,2);break;case 2:this.ga.processAction(sc.a.xKj,2)}}}Object(n.a)(ZK,"TotalWordCountManager",$q,[]);class $K{constructor(){this.Vhj=this.Uhj=this.N9f=this.Whj=this.Gzj=this.Hzj=this.Ezj=this.Fzj=0}get pRi(){return this.L7b(this.Whj,this.Hzj,"WC")}get Qhn(){return this.L7b(this.Uhj,this.Ezj,"NumCharsNoSp")}get Rhn(){return this.L7b(this.N9f,this.Fzj,"NumCharsWithSp")}get Whn(){return this.L7b(this.Vhj,this.Gzj,
"NumParagraphs")}L7b(b,h,v){const D=this.zbd(h,v).toLocaleString();return 0<this.N9f?(b=this.Xng(b,h,v),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),D)):D}Xng(b,h,v){b=this.zbd(b,v);return b>h?(u.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",v),h):b}zbd(b,h){0>b&&u.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(n.a)($K,"DocumentStats",null,[]);class GG{static Z$e(b){return Vf.a.qA(GG.Lm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.pRi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.Qhn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.Rhn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.Whn)}}GG.Lm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(n.a)(GG,"DocumentStatsDialogHtml",null,[]);class aL extends Vf.a{constructor(b){super();this.sS=!1;this.kql=()=>{};this.NF=b}Kuo(){this.wg="DocumentStatsDialog";this.Xg=GG.Z$e(this.NF);this.Ad=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.kql);this.e5("DocumentStatsTable")}f9(){}dispose(){this.sS||(super.dispose(),this.sS=!0)}}Object(n.a)(aL,"DocumentStatsDialog",Vf.a,[]);class bL{constructor(b,h,v,D,Q,ba,ta,Ta,ob){this.Jgh=this.Mtc=this.Vrc=this.PVb=this.$Ge=
!1;this.Zec=()=>{this.Sne()};this.rpa=()=>{this.Sne()};this.ymo=()=>{this.Jgh=!0;return 32};this.c2f=()=>this.es.zQa?32:8;this.Z2c=(Kb,Vb,bc,Dc,Oc)=>{if(1===bc)return this.es.zQa?32:8;Oc[Ff.a.On]=this.cHf;return 32};this.Cle=(Kb,Vb,bc)=>{if(1===bc)return this.es.zQa?32:8;this.cHf?this.inl():this.Ctl();Ya.App.xa.WG({ShowWordCount:"CheckboxModel"});return 32};this.Pjc=(Kb,Vb,bc)=>{if(1===bc)return sj.a.kha(Vb)?8:this.es.zQa?32:8;if(this.Jgh)return w.AFrameworkApplication.va.processAction(sc.a.t8d,2),
32;Kb=this.ge.$f("UserAction","Show Word Count Dialog");Kb.start();this.es.e9c();this.kQ.e9c();this.es.jy!==this.kQ.jy?u.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):u.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Vb=this.D9k();(new aL(Vb)).Kuo();Kb.stop();return 32};this.o2c=(Kb,Vb,bc,Dc,Oc)=>{Oc||u.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===bc)return 32;if(!this.es.zQa)return Oc[cl.a.Visible]=
!1,32;Oc[cl.a.Visible]=!0;this.cHf?(Kb=this.es.jy,0>Kb?Kb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Kb?(Vb=this.kQ?this.kQ.jy:-1,Kb=0<Vb?this.nbm(Kb,Vb):String.format(1===Kb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.Nee(Kb))):Kb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.Nee(Kb))):Kb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Oc[cl.a.LabelText]=Kb;return 32};
this.owe=ta;this.pwe=ba;this.es=b;this.kQ=h;this.uBc=v;this.mkk=Q;this.kQ.s_e(this.Zec);this.es.s_e(this.Zec);this.kQ.izb(this.rpa);this.es.izb(this.rpa);this.ge=Ta;this.UNa=D;this.hWa=ob.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Qcf(){return!aa.a.k4}Tb(){const b=w.AFrameworkApplication.va;b.qa(sc.a.Cle,Zb.a.application,this.Cle);b.qa(sc.a.Pjc,Zb.a.view,this.Pjc);b.fb(sc.a.Z2c,Zb.a.application,this.Z2c,96);b.fb(sc.a.o2c,Zb.a.application,this.o2c,96);b.fb(sc.a.c2f,Zb.a.application,
this.c2f,96);b.qa(sc.a.bVh,Zb.a.application,this.ymo)}get UNa(){return this.Vrc}set UNa(b){this.Vrc=b;this.es.UNa=b;this.kQ.UNa=b}Ctl(){this.es.zQa&&(this.Rnj(!0),this.Sne(),this.es.e9c())}D9k(){const b=new $K;b.Hzj=this.es.jy;b.Fzj=this.es.X3b;b.Ezj=this.es.EIc;b.Gzj=this.es.GIc;b.Whj=this.kQ.jy;b.Uhj=this.kQ.EIc;b.N9f=this.kQ.X3b;b.Vhj=this.kQ.GIc;return b}JUl(){return this.owe("WACWordCountEnabled",this.Qcf)}dge(b){this.pwe("WACWordCountEnabled",b?"true":"false",Qb.a.cRa)}get cHf(){this.PVb||(this.$Ge=
this.JUl(),this.PVb=!0);return this.$Ge}Rnj(b){this.dge(b);this.$Ge=b;this.PVb=!0}inl(){this.es.eId();this.kQ.eId();this.Rnj(!1);this.Sne()}get RJ(){return null!=this.wGg?this.wGg:this.wGg=(()=>this.uBc())()}Sne(){this.Mtc||(u.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.Iel()),this.Mtc=!0);this.RJ&&this.RJ.RU(this.mkk)}Iel(){const b={["words"]:this.es.jy,["charsWithSpaces"]:this.es.X3b,["charsWithNoSpaces"]:this.es.EIc,["paragraphs"]:this.es.GIc};this.hWa&&(b.images=this.es.CBb,
b.tables=this.es.GBb);return b}Nee(b){try{return b.toLocaleString()}catch(h){u.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}nbm(b,h){h>b&&(u.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.Nee(h),this.Nee(b))}}Object(n.a)(bL,"WordCountActor",
null,[]);class cL extends Cq.a{constructor(b,h,v,D){super();this.uY=(Q,ba)=>{if(ba.property===Gd.a.mo||ba.property===Gd.a.Hn)Q=ba.node,ba=Jd.App.un.hb.rc,ba.hv&&ba.Yc&&ba.Yc.Jc&&Q.Jc&&Q.Jc.id===ba.Yc.Jc.id&&this.mWh(Q)};this.xVi=(Q,ba)=>{this.mWh(ba.node)};this.eqn=(Q,ba)=>{ba.property!==wc.a.GA&&ba.property!==lc.a.lv||this.rY()};this.w6d=()=>{this.rY()};this.k2=b;this.es=h;this.lq=v;this.hWa=D.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}zz(){var b=this.lq.Ye(12);b.Go(this.uY);b.Vt(this.xVi);
b.Ow(this.xVi);b=this.lq.Ye(22);b.Go(this.eqn);b.Vt(this.w6d);b.Ow(this.w6d);this.hWa&&this.BVn();this.k2.gqa(this,7)}BVn(){var b=[19,14];for(const h of b)b=this.lq.Ye(h),b.Vt(this.w6d),b.Ow(this.w6d)}get index(){return 1}run(){this.es.adf()}mWh(b){b.Tbd=null;this.rY()}}Object(n.a)(cL,"WordCountAppEventCoordinator",Cq.a,[]);class AH{}AH.npk="AccurateWordCountButton";Object(n.a)(AH,"WordCountConstants",null,[]);class dL{constructor(b,h){this.es=b;this.kQ=h}getInstance(b){switch(b){case 1:return this.kQ;
case 0:return this.es;default:return this.es}}}Object(n.a)(dL,"WordCountManagerFactory",null,[319]);class BH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}xc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new YK(h)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var v=new qb.a(10,Id.a.Ze);const D=new ZK(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Ci.a,w.AFrameworkApplication.va,w.AFrameworkApplication.pc,()=>Jd.App.un.hb.rc.Yc,nc.a.Qs,ne.GraphIterator.$a,h,v,Ga.a.instance.resolve("Box4.ILanguageReader"));v=new XK(Ga.a.instance.resolve("Box4.List.IListReader"),Ga.a.instance.resolve("Box4.IListMarkerUtility"),new Ci.a,Th.a.instance,w.AFrameworkApplication.pc,ju.a.instance,Ye.a.instance,Ga.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,v,Ga.a.instance.resolve("Box4.ILanguageReader"));return new dL(D,v)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new PK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=Ya.App.xa.hb;b.vwa?this.eja():b.ifa(()=>{this.eja()})}eja(){if(Ya.App.Tj){var b=Ya.App.Tj.zl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),v=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
D=Ga.a.instance.resolve("Common.IAppSettingsManager");(new bL(h,v,()=>Ga.a.instance.Na("WordEditor.IStatusBarUser"),this.MTl(),AH.npk,Qb.a.eTa,Qb.a.xba,Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),D)).Tb();(new cL(fs.GraphTransactionManager.instance,h,b,D)).zz();h.adf()}else u.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else u.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}MTl(){var b=
Jd.App.un.hb;if(!b)return u.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.rc;if(!b)return u.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.Yc;return b?b.ia(lc.a.UNa,!1):(u.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){N.a.instance.Fc(new BH)}}Object(n.a)(BH,"PackageManager",null,[1,2]);var YM=c(2034);class eL{constructor(b){this.LQe=null;b.Sa("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.LQe=h})}lkj(b){this.LQe&&this.LQe.wqf().handleDocumentContentAugloopAnnotation(b)}}
Object(n.a)(eL,"DocumentContentExtractionManager",null,[543]);class Qh{}Qh.wyo="mso_smartLookup";Qh.channelId="SmartLookup";Qh.vyo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Qh.ltj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Qh.mtj="https://uci.cdn.office.net/mirrored/smartlookup/";Qh.uyo="https://hedwigtestserver.blob.core.windows.net/builds/";Qh.tyo="http://localhost:8080/";Qh.G8c="current";Qh.ktj="next";Qh.wyn=2;Qh.nfc=1;Qh.ofc=CommonUIStrings.L_SmartLookupPaneTitle;
Qh.XB="InsightsTaskPane";Qh.Whg="InsightsTaskPaneData";Qh.qyf="InsightsContentFrame";Qh.width=400;Qh.pcn="ApplicationPropertiesRequest";Qh.Acn="SelectionRequest";Qh.vcn="PageRendered";Qh.ocn="ApplicationProperties";Qh.zcn="Selection";Qh.Ccn="Telemetry";Qh.Bcn="TakeFocus";Qh.ucn="LostFocus";Qh.rcn="Keyboard";Qh.scn="LegalAgreed";Qh.U5o="WordWac";Qh.lvn="OneNoteWAC";Qh.ZXf="yes";Qh.Gxj="appCorrelationId";Qh.UGo="clientCorrelationId";Qh.Hxj="message";Qh.kFi="Microsoft::Office::Insights::LegalAgreed";
Object(n.a)(Qh,"InsightsConstants",null,[]);var LF=c(1611);class WE{}Object(n.a)(WE,"ActivityContractInfo",null,[]);class Pt{}Object(n.a)(Pt,"BrowserPaneDataField",null,[]);class XE{}Object(n.a)(XE,"BrowserPaneTelemetryEvent",null,[]);class Zl{static Dz(b,h){const v=new XE;v.eventName="Diagnostics";v.isActivity=!1;v.activityContract=Object.assign(new WE,{success:!0});const D=[],Q=new Pt;Q.name="Message";Q.dataType=0;Q.value=b;b=new Pt;b.name="Level";b.dataType=0;b.value=Zl.getLevelString(h);Array.add(D,
Q);Array.add(D,b);v.dataFields=D;Zl.sendTelemetryEvent(v)}static lij(b,h){const v=new XE;v.eventName=b;v.isActivity=!1;v.activityContract=Object.assign(new WE,{success:!0});b=[];const D=new Pt;D.name="AppCorrelationId";D.dataType=0;D.value=h;Array.add(b,D);v.dataFields=b;Zl.sendTelemetryEvent(v)}static Nco(b,h,v,D,Q,ba){const ta=new XE;ta.eventName="LaunchPaneWithError";ta.isActivity=!1;ta.activityContract=Object.assign(new WE,{success:!0});const Ta=[],ob=new Pt;ob.name="IsNetworkConnected";ob.dataType=
0;ob.value=b?"true":"false";b=new Pt;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Pt;h.name="EntryPoint";h.dataType=0;h.value=v;v=new Pt;v.name="RuntimeVersion";v.dataType=0;v.value=D;D=new Pt;D.name="IsFirstRelease";D.dataType=1;D.value=Q?"true":"false";Q=new Pt;Q.name="IsZeroTerm";Q.dataType=1;Q.value=ba?"true":"false";ba=new Pt;ba.name="IsClientSideRendering";ba.dataType=1;ba.value="false";Array.add(Ta,ob);Array.add(Ta,h);Array.add(Ta,b);Array.add(Ta,v);Array.add(Ta,
D);Array.add(Ta,Q);Array.add(Ta,ba);ta.dataFields=Ta;Zl.sendTelemetryEvent(ta)}static Q9f(b,h,v){const D=new XE;D.eventName="CDNDownloadLatency";D.isActivity=!0;D.activityContract=Object.assign(new WE,{duration:v,success:!0});v=[];const Q=new Pt;Q.name="CDNHostname";Q.dataType=0;Q.value=b;b=new Pt;b.name="Filename";b.dataType=0;b.value=h;Array.add(v,Q);Array.add(v,b);D.dataFields=v;Zl.sendTelemetryEvent(D,1)}static kic(b,h,v,D,Q,ba,ta,Ta){const ob=new XE;ob.eventName="LaunchPane";ob.isActivity=!0;
ob.activityContract=Object.assign(new WE,{duration:h,success:!0});h=[];const Kb=new Pt;Kb.name="AppCorrelationId";Kb.dataType=0;Kb.value=b;b=new Pt;b.name="EntryPoint";b.dataType=0;b.value=v;v=new Pt;v.name="IsServerSideRendering";v.dataType=1;v.value="true";const Vb=new Pt;Vb.name="UxVersion";Vb.dataType=0;Vb.value=D;D=new Pt;D.name="FeatureGates";D.dataType=0;D.value=Q;Q=new Pt;Q.name="IsFirstRelease";Q.dataType=1;Q.value=ba?"true":"false";ba=new Pt;ba.name="IsZeroTerm";ba.dataType=1;ba.value=ta?
"true":"false";ta=new Pt;ta.name="IsClientSideRendering";ta.dataType=1;ta.value=Ta?"true":"false";Array.add(h,Kb);Array.add(h,b);Array.add(h,v);Array.add(h,Vb);Array.add(h,D);Array.add(h,Q);Array.add(h,ba);Array.add(h,ta);ob.dataFields=h;Zl.sendTelemetryEvent(ob)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Zl.b2m(b.eventName);else{var v=-1<b.eventName.indexOf(Zl.Fxj)?b.eventName:Zl.Fxj+b.eventName,D=Zl.MSl(b.dataFields);b.isActivity?(b=Object.assign(new Ji.a,{name:v,samplingPolicy:h,
dataFields:D,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),fa.a.sendActivityEvent(b)):(b=Object.assign(new ra.a,{name:v,samplingPolicy:h,dataFields:D}),fa.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static MSl(b){const h=[];if(b&&0<b.length)for(const v of b)(b=dn.a.Aga(v.name,v.value,Zl.C6k(v.dataType)))&&Array.add(h,b);return h}static C6k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static b2m(b){const h=Ga.a.instance.Na("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):u.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Zl.Fxj="Office.Insights.SmartLookup.";Object(n.a)(Zl,"TelemetryUtils",null,[]);var YE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(YE||(YE={}));Object(n.b)("EntryPoint",YE);var Qt=c(1540),Jx=c(1554);class ov{static YX(b,h,v,D,Q,ba){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;if(Q.value.mto())return Zl.Dz("Skipping Serplet launch",10),32;h=ba;if(!h)return 8;b=ov.EDb();if(v=h.CommandValueId)try{h=F.a(v)}catch(ta){return u.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",v),8}v=h;h.selection||(h.neighborhood?v=Object.assign(new Qt.a,{selection:h}):
(h=Q.value.qEb(),v.selection=Object.assign(new Jx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));v.selection.clientDetectedLanguage=Q.value.u$h();return ov.O5b(ba,null,v,b,0,Q)}static O5b(b,h,v,D,Q,ba){const ta={};ta.controlId=b?b.SourceControlId:"shortcut";v&&(ta.entryPoint=YE[v.entryPoint]);u.ULS.sendTraceTag(594044172,1303,50,ov.RT("Show insights",D,ta));h?ba.value.Dvo(h,D,Q):v&&(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ba.value.$to(v,D):ba.value.Evo(v,D,Q));return 32}static RT(b,h,v=null){b={["appCorrelationId"]:h,["message"]:b};if(v)for(let D in v)b[D]=v[D];return F.c(b)}static EDb(){return sb.a.create().toString()}}Object(n.a)(ov,"InvokingPaneUtils",null,[]);class fL{}Object(n.a)(fL,"LaunchDataInDoc",null,[]);class gL{}Object(n.a)(gL,"LaunchDataPasteAsSlide",null,[]);class hL{}Object(n.a)(hL,"LaunchDataSlidesCompression",null,[]);var vu=c(1530);class CH{constructor(b,h,v,D,Q,ba,ta,Ta,ob){this.Xrc=this.mkd=
this.Ew=null;this.kC=b;this.ga=h||w.AFrameworkApplication.va;this.fp=v;this.Ub=D;this.N1g=Ta;this.Jxc=Q;this.Ma=ba;this.Hb=ta;this.lym();this.bWa=new Fg.a(()=>new fm.a(ob.value,Object(z.a)(this,this.FEb,"getMoreInfoEventReceived")))}Tb(){this.ga.qa(Ua.a.rCm,Kd.a.frame,Object(z.a)(this,this.Bvo,"showInsights"));this.ga.qa(Ua.a.sCm,Kd.a.frame,Object(z.a)(this,this.Cvo,"showInsightsForTellMe"));this.ga.qa(Ua.a.definitions,Kd.a.frame,Object(z.a)(this,this.Auo,"showDefinitions"));this.ga.qa(Ua.a.Ycf,Kd.a.frame,
Object(z.a)(this,this.Buo,"showDefinitionsForTellMe"));this.ga.qa(Ua.a.beg,Kd.a.frame,Object(z.a)(this,this.beg,"showInsightsForSuggestion"));this.N1g&&(this.ga.qa(Ua.a.B8,Kd.a.frame,Object(z.a)(this,this.YX,"invokeSmartLookupPane")),this.ga.qa(Ua.a.dTc,Kd.a.frame,Object(z.a)(this,this.dTc,"invokeInDocSerplet")),this.ga.qa(Ua.a.fTc,Kd.a.frame,Object(z.a)(this,this.fTc,"invokeSerpletRibbon")),this.ga.qa(Ua.a.eTc,Kd.a.frame,Object(z.a)(this,this.eTc,"invokeSerpletContextMenu")),this.ga.qa(Ua.a.mBf,
Kd.a.frame,Object(z.a)(this,this.mBf,"invokeSerpletTellMeZeroTerm")),this.ga.qa(Ua.a.lBf,Kd.a.frame,Object(z.a)(this,this.lBf,"invokeSerpletTellMeNotes")),this.ga.qa(Ua.a.$Wd,Kd.a.frame,Object(z.a)(this,this.$Wd,"invokeImageSerpletContextMenu")),this.ga.qa(Ua.a.dXd,Kd.a.frame,Object(z.a)(this,this.dXd,"invokeSynonymsSerpletContextMenu")),this.ga.qa(Ua.a.ZWd,Kd.a.frame,Object(z.a)(this,this.ZWd,"invokeDictionarySerpletContextMenu")),this.ga.qa(Ua.a.fXd,Kd.a.frame,Object(z.a)(this,this.fXd,"invokeZeroTermSerpletContextMenu")),
this.ga.qa(Ua.a.YWd,Kd.a.frame,Object(z.a)(this,this.YWd,"invokeDefinitionSearchFromFloatie")),this.ga.qa(Ua.a.cXd,Kd.a.frame,Object(z.a)(this,this.cXd,"invokeSerpletBrowseFiles")),this.ga.qa(Ua.a.aXd,Kd.a.frame,Object(z.a)(this,this.aXd,"invokeInDocSerpletWithLaunchData")),this.ga.qa(Ua.a.xbe,Kd.a.frame,Object(z.a)(this,this.xbe,"queryToggleSerplet")),this.ga.qa(Ua.a.sge,Kd.a.frame,Object(z.a)(this,this.sge,"setInDocSearchParameter")),this.ga.qa(Ua.a.kBf,Kd.a.frame,Object(z.a)(this,this.kBf,"invokeSerpletSlidesCompression")),
this.ga.qa(Ua.a.jBf,Kd.a.frame,Object(z.a)(this,this.jBf,"invokeSerpletPasteAsNewSlide")),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.qa(Ua.a.nti,Kd.a.frame,Object(z.a)(this,this.cEm,"invokeSmartLookupPaneConversations")),this.ga.qa(Ua.a.WWd,Kd.a.frame,Object(z.a)(this,this.WWd,"invokeAutoLaunchSearchRequest"))),this.jUn().continueWith(()=>{w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.updateCommandUI(!0)}))}xnh(){this.ga.fb(Ua.a.iFa,
Kd.a.frame,Object(z.a)(this,this.iFa,"invokeFilesSerplet"),4);this.ga.fb(Ua.a.dBf,Kd.a.frame,Object(z.a)(this,this.iFa,"invokeFilesSerplet"),4);this.ga.fb(Ua.a.iti,Kd.a.frame,Object(z.a)(this,this.SDm,"invokeLinkFilesSerplet"),4);if(this.Ma.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ma.$("SmartLookupTokenPrefetchIsEnabled")){const b=of.a.Q7(0,Object(z.a)(this,this.a2i,"prefetchToken"),0,177);this.Hb.Wb(b)}}CZe(){Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.qa(Ua.a.iFa,Kd.a.frame,Object(z.a)(this,this.eBf,"invokeFilesSerpletUnavailable")),this.ga.qa(Ua.a.dBf,Kd.a.frame,Object(z.a)(this,this.eBf,"invokeFilesSerpletUnavailable")),this.ga.qa(Ua.a.iti,Kd.a.frame,Object(z.a)(this,this.eBf,"invokeFilesSerpletUnavailable")))}a2i(b){u.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Wlc().then(h=>{let v=1;if(h)u.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.i$f("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ma.mc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{u.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.i$f("SmartLookupFiles: Token prefetch failed",!1);v=parseInt(b.data||"1");if(v>this.Ma.mc("SmartLookupTokenRenewalRetryThreshold",5)){u.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.i$f("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Ma.mc("SmartLookupTokenRetryWaitDurationInMinutes",10);v++}h=new of.a(3,1,h,Object(z.a)(this,this.a2i,"prefetchToken"),177);h.data=v.toString();this.Hb.Wb(h)})}i$f(b="",h=!1){this.Jxc.execute(v=>{v&&v.iic("PrefetchToken",h,0,"SmartLookup",b)})}Wlc(){return this.Jxc?new Promise(b=>{this.Jxc.execute(h=>{if(h){var v=Date.now();h.getToken("SmartLookup",this.Ma.jb("SmartLookupShredderServiceEndpoint")).then(D=>{b(!!D&&0<D.length);h.iic("TryGetTokenInternal",!!D&&0<D.length,Date.now()-
v,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}jUn(){const b=new jh.a;if(this.Ma.$("BrowserSupportsInsightsPaneSSO"))this.xnh(),b.zg(!0);else{if(!this.Jxc)return u.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.zg(!1),this.CZe(),b.task;this.Jxc.execute(h=>{h?h.getToken("SmartLookup",this.Ma.jb("SmartLookupShredderServiceEndpoint")).then(v=>{u.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!v&&0<v.length);v&&0<v.length?(this.xnh(),b.zg(!0)):this.CZe()}):(u.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.zg(!1),this.CZe())})}return b.task}Bvo(b,h,v,D,Q){if(1===v)return w.AFrameworkApplication.ta&&w.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!w.AFrameworkApplication.zHc?8:this.kC.value.Bxi()?32:8;b=ov.EDb();h=this.kC.value.qEb();return this.N1g?(h=Object.assign(new Jx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Qt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new vu.a,
{landingTab:"All"})}),ov.O5b(Q,null,h,b,0,this.kC)):ov.O5b(Q,h,null,b,0,this.kC)}Auo(b,h,v,D,Q){if(1===v)return this.kC.value.Bxi()?32:8;b=ov.EDb();h=this.kC.value.qEb();return ov.O5b(Q,h,null,b,1,this.kC)}Cvo(b,h,v,D,Q){return 1===v?32:this.yXh(Q,0)}Buo(b,h,v,D,Q){return 1===v?32:this.yXh(Q,1)}yXh(b,h){const v=ov.EDb(),D=b.CommandValueId;let Q;try{Q=F.a(D)}catch(ba){return u.ULS.sendTraceTag(6295941,1303,15,ov.RT(String.format("Insights parameters [{0}] is not in proper format.",D),v)),8}return ov.O5b(b,
Q,null,v,h,this.kC)}beg(b,h,v,D,Q){if(1===v)return 32;if(!Q)return 8;b=Q.query?Q.query:"";h=ov.EDb();v=new LF.a;v.neighborhood=b;v.mentionStart=0;v.mentionLength=b.length;return ov.O5b(Q,v,null,h,0,this.kC)}SDm(b,h,v,D){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;const Q=w.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ba=this.kC.value.e1a();return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new vu.a,{landingTab:"File"}),entryPoint:Q?32:10}))}iFa(b,h,v,D){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;const Q=w.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ba=this.kC.value.e1a();return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new vu.a,{landingTab:Q?"Slide":"File"}),entryPoint:Q?20:10}))}eBf(){return 2}dTc(b,h,v,D,Q){if(1===
v)return ac.SessionStatusManager.instance.Aj?8:32;const ba=this.kC.value.e1a();Q=void 0===Q||null===Q?18:19;return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new vu.a,{landingTab:"Indoc"}),entryPoint:Q}))}aXd(b,h,v,D,Q){Q=Q.CommandValueId;if(!Q||Q&&this.Xrc&&Q.query===this.Xrc.query&&Q.matchCase===this.Xrc.matchCase&&Q.matchWholeWordOnly===this.Xrc.matchWholeWordOnly)return 32;
const ba=this.kC.value.e1a();return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new vu.a,{landingTab:"Indoc",data:Object.assign(new fL,{type:4,query:Q.query,matchCase:Q.matchCase,matchWholeWord:Q.matchWholeWordOnly})}),entryPoint:18}))}xbe(b,h,v,D,Q){Q&&(Q[Ff.a.On]=this.kC.value.yHb);return 32}sge(b,h,v,D,Q){if(b=Q.CommandValueId)this.Xrc=b;return 32}cEm(b,
h,v){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;b=this.kC.value.e1a();b=Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new vu.a,{landingTab:"All"})});this.kC.value.x0d(b);return 32}WWd(b,h,v){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;b=this.kC.value.e1a();b=Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new vu.a,{landingTab:"All",data:w.AFrameworkApplication.nCb})});h=ov.EDb();this.kC.value.NNb(b,h);return 32}fTc(b,h,v,D){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;const Q=this.kC.value.w$h();return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:Q.mentionLength}),entryPoint:4,launchData:Object.assign(new vu.a,{landingTab:"All"})}))}eTc(b,
h,v,D){return this.YX(b,h,v,D,Object.assign(new Qt.a,{entryPoint:5,launchData:Object.assign(new vu.a,{landingTab:"All"})}))}mBf(b,h,v,D){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;const Q=this.kC.value.e1a();return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:0}),launchData:Object.assign(new vu.a,{landingTab:"All"}),entryPoint:26}))}ZWd(b,h,v,D){return 1===v?(b=this.kC.value.qEb())&&0<
b.mentionLength?32:8:this.YX(b,h,v,D,Object.assign(new Qt.a,{entryPoint:22,launchData:Object.assign(new vu.a,{landingTab:"All"})}))}YWd(b,h,v,D){return 1===v?(b=this.kC.value.qEb())&&0<b.mentionLength?32:8:this.YX(b,h,v,D,Object.assign(new Qt.a,{entryPoint:7,launchData:Object.assign(new vu.a,{landingTab:"All"})}))}$Wd(b,h,v,D){return this.YX(b,h,v,D,Object.assign(new Qt.a,{launchData:Object.assign(new vu.a,{landingTab:"Image"}),entryPoint:9}))}dXd(b,h,v,D){return this.YX(b,h,v,D,Object.assign(new Qt.a,
{launchData:Object.assign(new vu.a,{landingTab:"All"}),entryPoint:24}))}lBf(b,h,v,D){return this.YX(b,h,v,D,Object.assign(new Qt.a,{launchData:Object.assign(new vu.a,{landingTab:"Notes"}),entryPoint:33}))}fXd(b,h,v,D){if(1===v)return ac.SessionStatusManager.instance.OH?32:8;const Q=this.kC.value.e1a();return this.YX(b,h,v,D,Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:0}),launchData:Object.assign(new vu.a,{landingTab:"All"}),
entryPoint:27}))}kBf(b,h,v,D,Q){if(!Q)return 8;const ba=Q.url;Q=Q.selectedSlideIDs;return this.YX(b,h,v,D,Object.assign(new Qt.a,{launchData:Object.assign(new vu.a,{landingTab:"All",data:Object.assign(new hL,{type:6,url:ba,selectedSlideIDs:Q})}),entryPoint:37}))}jBf(b,h,v,D,Q){if(!Q)return 8;const ba=Q.Selection;Q=Q.CurrentDocTitle;return this.YX(b,h,v,D,Object.assign(new Qt.a,{launchData:Object.assign(new vu.a,{landingTab:"All",data:Object.assign(new gL,{type:5,selection:ba,currentDocTitle:Q})}),
entryPoint:36}))}YX(b,h,v,D,Q){return ov.YX(b,h,v,D,this.kC,Q)}cXd(b,h,v){if(1===v)return 32;this.Ew||this.bWa.value.Yj("Browse File from Search pane",!0);if(!this.mkd||""===this.mkd)return u.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Id.a.om(this.mkd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}FEb(b){this.Ew||3!==b.state||(this.Ew=b,this.mkd=this.Ew.Lca)}lym(){const b=this.Ub.fe(Qh.XB);b.parent=gf.AFrame.vp;b.ffa(Object(z.a)(this,this.jic,
"sendIFrameTakeFocusMessage"));this.fp.gT(Qh.XB)}jic(){document.activeElement.blur();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Vjb||(this.kC.value.sho(),this.kC.value.Lco())}dispose(){this.kC.value&&this.kC.value.dispose()}}Object(n.a)(CH,"InsightsActor",null,[10]);const DH=b=>{b=b.split("-");return b[b.length-1]},$M=()=>{var b=HG();if(b)return Promise.resolve(b);b=MF().replace("SearchWeb","searchweb");b=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Qh.ktj+"/":b+Qh.G8c+"/";b+="version.json";if(aa.a.voa)return ZM(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Zl.Dz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(v=>v.json()).catch(()=>{Zl.Dz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(v=>{v=F.b(JSON.stringify(v));
return v.version?v.version:""},v=>{Zl.Dz("InsightsUtils - Failed to deserialize version: "+v.toString(),10);u.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+v.toString());return""}).then(v=>v)}catch(h){return Zl.Dz("InsightsUtils - Failed to download version.json: "+h.toString(),10),u.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},ZM=b=>{const h=w.AFrameworkApplication.Ne;return new Promise(v=>{const D=
new JF.a(b,1,null,null,!0,2,null);h.send(D).dya(Q=>{Q&&Q.data?Q.data.we||(Zl.Dz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+Q.data.Qe,10),v("")):(Zl.Dz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),v(""));try{const ba=F.b(Q.data.we);ba.version&&v(ba.version)}catch(ba){Zl.Dz("InsightsUtils - Failed to deserialize version: "+ba.toString(),10),v("")}},Q=>{Q&&Q.data?Zl.Dz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
Q.data.Qe,10):Zl.Dz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);v("")})})},IG=()=>w.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),JG=()=>{const b=MF();return IG()||w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")?b+HG()+"/":w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Qh.ktj:b+Qh.G8c},HG=()=>IG()?"dev":w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")?w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion").split("/")[1]:w.AFrameworkApplication.K.jb("SmartLookupClientVersion"),EH=b=>{var h=3===w.AFrameworkApplication.ta.Nb.Sl?"wordwac":2===w.AFrameworkApplication.ta.Nb.Sl?"pptwac":"excelwac";var v=lk.a.og(w.AFrameworkApplication.lcid);const D=v?v.name:"en-us";v=MF();const Q=mD();h="main_ssr_wac.html?appName="+h+"&culture="+D;return"LOCAL"===Q?
v+h:v+((""!==b?b:Qh.G8c)+"/")+h},aN=b=>MF()+(""!==b?b:Qh.G8c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",MF=()=>{switch(mD()){case "LOCAL":return Qh.tyo;case "PR":const b=w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion").split("/");return Qh.uyo+b[0]+"/";case "INT":return Qh.vyo;case "EDOG":return Qh.ltj;default:return Qh.mtj}},bN=()=>{if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(mD()){case "EDOG":return Qh.ltj;
case "PROD":return Qh.mtj;default:return""}},mD=()=>{if(w.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(w.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(w.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")&&w.AFrameworkApplication.K.jb("SmartLookupPRIntentSvc"))return"PR";if(IG())return"LOCAL";switch(Object(Ka.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=w.AFrameworkApplication.K.jb("UserPrincipalName");b=G.a.Ug(b);const h=w.AFrameworkApplication.K.Sw("SmartLookupINTEnabledForSKITeam")?w.AFrameworkApplication.K.KC("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},iL=()=>{let b;b=w.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":w.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":w.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":mD();const h=w.AFrameworkApplication.K.jb("IntentServiceEndpoint"),v=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return w.AFrameworkApplication.K.jb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(v?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(v?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},cN=()=>{const b=mD(),h=w.AFrameworkApplication.K.jb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class jL{sendTelemetryEvent(b){Zl.sendTelemetryEvent(b)}}
Object(n.a)(jL,"OtelTelemetrySink",null,[581]);class kL{}Object(n.a)(kL,"ApplicationProperties",null,[]);class lL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(n.a)(lL,"CurrentDocumentProperties",null,[]);class mL{}Object(n.a)(mL,"EnterpriseUserInfo",null,[]);class nL{}Object(n.a)(nL,"FeatureGates",null,[]);class FH{constructor(b,h){this.mv=this.Gi=null;this.Oda="Search";this.rLi=!0;this.yyb=h;this.Lz=b;this.Lz.execute(v=>{v.isFeatureEnabled("mso_sendASmile",!0).then(D=>
{this.rLi=D}).catch(D=>{Zl.Dz("SearchHelper - Failed to check if Feedback feature is enabled: "+D.toString(),15)})});b=iL();h=w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.mv={};const v=this.ybm();if(v&&0<v.length)for(let D=0;D<v.length;D++){const Q=v[D],ba=this.Lbm(Q);switch(ba.toLowerCase()){case "true":this.mv[Q]=
!0;break;case "false":this.mv[Q]=!1;break;default:this.mv[Q]=ba}}this.mv.EnableInDocumentSearch=h;this.mv.EnableInDocumentSearchReplace=!0;this.mv.EnableInDocumentParamLocalSearch=!0;this.mv.EnableInDocumentQuerySuggest=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.mv.EnableInDocumentQuestionGeneration=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.mv.EnableInDocumentExperiment1=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.mv.EnableInDocumentExperiment2=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.mv.EnableInDocumentExperiment3=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.mv.EnableZeroTermAutoRefresh=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.mv.EnableTap3SZeroTerm=w.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.mv.EnableLocalSearch=!0;this.mv.EnableInDocumentStickyFilters=!0;this.mv.IntentServiceEndpoint=b;this.mv.EnablePDFShredding=w.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.mv.FilterNonPPTFilesForReuseSlides=w.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.mv.UXBundleVersion=HG();this.mv.SmartLookupServicePath=JG();this.mv.EnableAcronymSearch=
!0;this.mv.UseAltAnswerEndpoint1=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.mv.UseAltAnswerEndpoint2=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.mv.UseAltAnswerEndpoint3=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.mv.UseNextUXVersion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.mv.IgnoreNeighborhoodContext=w.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.mv.ShowDebugInfo="INT"===mD();this.mv.DebugCommands=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.mv.ChangeGates=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.mv.QnaInMixSection=!0;this.mv.EnableNoteSearch=w.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.mv.EnableWikiL2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.mv.EnableFilteringOutRedundantKPE=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.mv.EnableZeroTermEntitySuggestion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.mv.RankingModels=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.mv.EnableClientSideRendering=!0}else this.Gi=new nL,this.Gi.EnableInDocumentSearch=h,this.Gi.EnableInDocumentSearchReplace=
!0,this.Gi.EnableInDocumentParamLocalSearch=!0,this.Gi.EnableInDocumentQuerySuggest=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Gi.EnableInDocumentQuestionGeneration=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Gi.EnableInDocumentExperiment1=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Gi.EnableInDocumentExperiment2=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Gi.EnableInDocumentExperiment3=
h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Gi.EnableZeroTermAutoRefresh=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Gi.EnableTap3SZeroTerm=w.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Gi.EnableLocalSearch=!0,this.Gi.EnableInDocumentStickyFilters=!0,this.Gi.IntentServiceEndpoint=b,this.Gi.EnablePDFShredding=w.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Gi.FilterNonPPTFilesForReuseSlides=w.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Gi.UXBundleVersion=HG(),this.Gi.SmartLookupServicePath=JG(),this.Gi.EnableAcronymSearch=
!0,this.Gi.UseAltAnswerEndpoint1=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Gi.UseAltAnswerEndpoint2=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Gi.UseAltAnswerEndpoint3=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Gi.UseNextUXVersion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Gi.IgnoreNeighborhoodContext=w.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Gi.ShowDebugInfo="INT"===mD(),this.Gi.DebugCommands=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Gi.ChangeGates=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Gi.QnaInMixSection=!0,this.Gi.EnableNoteSearch=w.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Gi.EnableWikiL2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Gi.EnableFilteringOutRedundantKPE=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Gi.EnableZeroTermEntitySuggestion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Gi.RankingModels=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Gi.EnableClientSideRendering=!0,this.Gi.SharedSerpletFeatureGate1=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Gi.SharedSerpletFeatureGate2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Gi.SharedSerpletFeatureGate3=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Gi.SharedSerpletFeatureGate4=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Gi.SharedSerpletFeatureGate5=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Gi.SharedSerpletFeatureGate6=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Gi.SharedSerpletFeatureGate7=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Gi.SharedSerpletFeatureGate8=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Gi.SharedSerpletFeatureGate9=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Gi.SharedSerpletFeatureGate10=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Gi.SharedSerpletFeatureGate11=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Gi.SharedSerpletFeatureGate12=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Gi.SharedSerpletFeatureGate13=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Gi.SharedSerpletFeatureGate14=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Gi.SharedSerpletFeatureGate15=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Gi.SharedSerpletFeatureGate16=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Gi.SharedSerpletFeatureGate17=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Gi.SharedSerpletFeatureGate18=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Gi.SharedSerpletFeatureGate19=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Gi.SharedSerpletFeatureGate20=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Gi.SharedSerpletFeatureGate21=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Gi.SharedSerpletFeatureGate22=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Gi.SharedSerpletFeatureGate23=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Gi.SharedSerpletFeatureGate24=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Gi.SharedSerpletFeatureGate25=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Gi.SharedSerpletFeatureGate26=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Gi.SharedSerpletFeatureGate27=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Gi.SharedSerpletFeatureGate28=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Gi.SharedSerpletFeatureGate29=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Gi.SharedSerpletFeatureGate30=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Gi.SharedSerpletFeatureGate31=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Gi.SharedSerpletFeatureGate32=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Gi.SharedSerpletFeatureGate33=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Gi.SharedSerpletFeatureGate34=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Gi.SharedSerpletFeatureGate35=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Gi.SharedSerpletFeatureGate36=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Gi.SharedSerpletFeatureGate37=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Gi.SharedSerpletFeatureGate38=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Gi.SharedSerpletFeatureGate39=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Gi.SharedSerpletFeatureGate40=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Lwc=Ga.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.blb=FH.isEnterpriseUser();this.TQa=w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint");this.ELf=ja.a.z_(w.AFrameworkApplication.K.jb("AppCatalogUrl")||"");this.z8m=w.AFrameworkApplication.K.jb("UserPrincipalName");this.blb&&this.Wfi()}Lbm(b){return w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}ybm(){const b=w.AFrameworkApplication.K.u0a,h=w.AFrameworkApplication.K.KC("SmartLookupFlightKeywordList"),v=[];if(b&&h&&0<h.length)for(let Q in b){var D=
{key:Q,value:b[Q]};D=D&&D.key?D.key:"";for(let ba=0;ba<h.length;ba++)if(-1<D.toLowerCase().indexOf(h[ba].toLowerCase())){const ta=D.split(".");ta&&4===ta.length&&Array.add(v,ta[ta.length-1])}}return v}Rtf(b,h,v,D){return new Promise(Q=>{this.IRm().then(ba=>{const ta=new kL;ta.anid="";ta.applicationName=3===w.AFrameworkApplication.ta.Nb.Sl?"WORD":"POWERPNT";ta.applicationVersion=w.AFrameworkApplication.buildVersion;ta.appCorrelationId=b?b:ov.EDb();ta.themePlatform="web";ta.lcid=w.AFrameworkApplication.lcid;
ta.launchUtcTime=(new Date).toUTCString();w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ta.featureGates=F.c(this.mv):ta.featureGates=F.c(this.Gi);var Ta=lk.a.og(w.AFrameworkApplication.lcid);Ta=Ta?Ta.name:null;ta.market=DH(Ta);ta.uiLanguage=Ta;ta.sessionId=w.AFrameworkApplication.userSessionId;ta.themeId=v;ta.parentalControl="yes";ta.processorOnlyMode=ba;ta.isEditingAllowed=h.isEditingAllowed();ta.isFeedbackEnabled=this.rLi;ta.isClientSideRendering=18===D||19===D||15===D;ta.disableClipboard=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&w.AFrameworkApplication.KG&&!w.AFrameworkApplication.ACb;ta.accessToken=this.blb?this.Wfi():"";ba=new mL;ba.CountryCode=DH(Ta);ba.ServiceEndpoint=this.TQa;ba.IsGoLocal=w.AFrameworkApplication.K.$("IsGoLocalEnvironment");ba.IsEnabled=this.blb;ba.IsEnterpriseEnabled=this.blb;ba.TenantRoot=this.ELf;ba.Upn=this.z8m;Ta=mD();ba.IsEUDB="PROD"===Ta&&""!==w.AFrameworkApplication.K.jb("IntentServiceEndpoint");
ta.enterpriseUserInfo=ba;ba=new lL;ba.filePath=w.AFrameworkApplication.K.jb("EditDocInClientUrl");ba.docName=w.AFrameworkApplication.K.jb("FileName");ba.author=99!==D?h.author():null;ba.createdDate=99!==D?h.createdDate():null;ta.currentDocument=ba;Q(ta)})})}IRm(){return new Promise(b=>{this.Lz?this.Lz.execute(h=>{h.isFeatureEnabled(Qh.wyo,!0).then(v=>{b(!v)}).catch(v=>{Zl.Dz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+v.toString(),10);b(!0)})}):b(!0)})}fBn(b){this.Lwc&&
this.blb&&this.wSd(this.TQa).then(h=>{b(h)})}Wfi(){return"Dev Box"===w.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.Lwc?this.Lwc.Afm(this.Oda,this.TQa):""}wSd(b){return"Dev Box"===w.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.Lwc?this.Lwc.getToken(this.Oda,b):Promise.resolve("")}rPc(){return this.yyb?this.yyb.getVersion():""}uVl(){return w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?F.c(this.mv):F.c(this.Gi)}static isEnterpriseUser(){const b=w.AFrameworkApplication.K.jb("SovereignEnvironmentName"),h=w.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(n.a)(FH,"SearchHelper",null,[544]);class lE{constructor(){lE._instance=
""}getVersion(){return lE._instance}Ino(b){lE._instance=b}}lE._instance=null;Object(n.a)(lE,"SmartLookupVersion",null,[]);class oL{}Object(n.a)(oL,"ConfigurationProvider",null,[]);class ZE{constructor(b){ZE._instance=b}wqf(){return ZE._instance}}ZE._instance=null;Object(n.a)(ZE,"SearchHostRuntime",null,[]);class GH{constructor(){this.oea=this.cSb=this.W=null}get name(){return"Common.App.Insights"}xc(b){this.W=b;const h=Tb.a.Bp(Ga.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>")),v=
w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||w.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(CH,"Common.App.Insights.InsightsActor").singleInstance().Rd(()=>new CH(b.Ue("Common.App.Insights.IInsightsManager"),w.AFrameworkApplication.va,Z.a.instance,$c.FocusManager.instance(),b.Sa("Common.App.SearchCommon.ISearchOAuthManager"),w.AFrameworkApplication.K,xb.a.instance,v,new Fg.a(()=>h.result)));b.register(543,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Rd(()=>
new eL(b));v&&(b.register(lE,"Common.App.Insights.SmartLookupVersion").singleInstance().Rd(()=>new lE),b.register(544,"Common.App.SearchCommon.ISearchHelper").singleInstance().Rd(()=>new FH(Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Na("Common.App.Insights.SmartLookupVersion"))))}init(){w.AFrameworkApplication.Q_&&(this.cSb=this.W.Na("Common.App.Insights.InsightsActor"),this.cSb.Tb())}VSn(){if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").wSd(b).then(h=>{var v={};v.Authorization="Bearer "+h;h=cN();const D=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);v=new JF.a(h+("?isTelemetryOnly="+D),1,null,v,!0,2,null);w.AFrameworkApplication.Ne.send(v).dya(()=>{Zl.Dz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
D,50)},Q=>{Zl.Dz("InsightsPackage - Failed to send refreshmemory API request. Error: "+Q.toString(),10)})})}}Zql(){this.NCm();this.VSn()}NCm(){$M().then(b=>{if(""!==b){const h=this.W.Na("Common.App.Insights.SmartLookupVersion");h&&h.Ino(b)}this.lJd();this.cSb=this.W.resolve("Common.App.Insights.InsightsActor");b=aN(b);b=Xa.a.create(b);b.UZ((h,v)=>{v.succeeded?this.Foo()&&this.prefetchZeroTerm():Zl.Dz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+v.vF,10);this.cSb.Tb()});
Ib.a.rX(b)})}Foo(){const b=Object.assign(new oL,{channelId:Qh.channelId,approvedOriginPattern:IG()?"^(http)?://(localhost:8080)$":w.AFrameworkApplication.K.jb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const v=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),D=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Q=new zb.a;h&&Q.add(h);v&&Q.add(v);D&&Q.add(D);h=iL();try{const ba=new jL,ta=SmartLookupHostRuntime.setup(b,
Q.toArray(),!0,h,ba);this.W.register(ZE,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Rd(()=>new ZE(ta));return!0}catch(ba){return Zl.Dz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ba,10),!1}}prefetchZeroTerm(){if(w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Ga.a.instance.Na("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),v=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.Rtf(null,v,0,99).then(D=>{b.wqf().prefetchZeroTerm(D,w.AFrameworkApplication.userSessionId,JG(),!0,"Indoc",null)})}else Zl.Dz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}lJd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=EH(b.rPc());b=b.rPc();b=MF()+(""!==b?b:Qh.G8c)+"/scripts/microsoft.office.smartlookup.ssr.js";
const v=bN();aa.a.voa?this.Yql(h,b):(this.Wql(h,v),this.Xql(b,v))}Wql(b,h){const v=new Sys.Net.WebRequest;v.set_httpVerb("GET");const D={};D.method=v.get_httpVerb();v.set_url(b);const Q=(new Date).getTime();try{window.fetch(v.getResolvedUrl(),D).then(()=>{""!==h&&Zl.Q9f(h,b,(new Date).getTime()-Q);this.W.Na("Common.App.Insights.SmartLookupVersion")})}catch(ba){Zl.Dz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ba.toString(),10)}}Xql(b,h){var v=new Sys.Net.WebRequest;
v.set_httpVerb("GET");const D={};D.method=v.get_httpVerb();v.set_url(b);let Q=-1;if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))v=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),xb.a.instance.Wb(new of.a(5,1,v,()=>{const ba=Xa.a.create(b);ba.RZe(()=>{Q=Date.now()});ba.UZ((ta,Ta)=>{Ta.succeeded?""!==h&&Zl.Q9f(h,b,Date.now()-Q):Zl.Dz("InsightsPackage - Failed to prefetch JS file.",
10)});Ib.a.rX(ba)}));else{Q=Date.now();try{window.fetch(v.getResolvedUrl(),D).then(()=>{""!==h&&Zl.Q9f(h,b,Date.now()-Q)})}catch(ba){Zl.Dz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ba.toString(),10)}}}Yql(b,h){if(aa.a.voa){var v=w.AFrameworkApplication.Ne;b=new JF.a(b,1,null,null,!0,2,null);v.send(b).dya(D=>{D&&D.data?D.data.we?this.W.Na("Common.App.Insights.SmartLookupVersion"):Zl.Dz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
D.data.Qe,10):Zl.Dz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},D=>{D&&D.data?Zl.Dz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+D.data.Qe,10):Zl.Dz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});w.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new JF.a(h,1,null,null,!0,2,null),v.send(h).dya(D=>{D&&D.data?D.data.we||Zl.Dz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
D.data.Qe,10):Zl.Dz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},D=>{D&&D.data?Zl.Dz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+D.data.Qe,10):Zl.Dz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.cSb&&this.cSb.dispose()}}Object(n.a)(GH,"InsightsPackage",null,[1,2]);var pL=c(1592);class qL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(n.a)(qL,"DocumentContentParams",null,[]);var KG=c(1862),rL=c(403),$E=c(719),wu;(function(b){b.EUa="SearchProvider";b.F8a="TextSummarization"})(wu||(wu={}));Object(n.b)("WorkflowType",wu);var Uw;(function(b){b.Success="Success";b.Frg="Invoked";b.Error="Error"})(Uw||(Uw={}));Object(n.b)("LogType",Uw);var uy;(function(b){b.XLj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.Brg="InvalidAnnotation";b.BRj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(uy||(uy={}));Object(n.b)("ErrorReason",uy);class NF{constructor(b){this.WSh=b;this.qTf=this.qTf.bind(this);this.nmb=this.nmb.bind(this);this.KHo=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.Jao=Date.now();this.Unb=sb.a.create().toString();this.log({aK:wu.EUa,logType:Uw.Frg,success:!0,correlationId:this.Unb});
var b=mD().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new ib.l({parentPath:["Signal",KG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new KG.SearchProviderSignal({correlationId:this.Unb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.$gj=window.setTimeout(()=>{this.onError(wu.EUa,Uw.Error,uy.Timeout)},1500)}catch(h){window.clearTimeout(this.$gj),this.onError(wu.EUa,Uw.Error,
uy.Other,this.T7h(h))}}async generateDocumentSummaryDetails(){try{if(!NF.UVc)return null;this.JHo=Date.now();this.log({aK:wu.F8a,logType:Uw.Frg,success:!0});await this.activateAnnotation();const b=new ib.l({parentPath:["Signal",$E.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new $E.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.cyj=window.setTimeout(()=>{this.onError(wu.F8a,Uw.Error,uy.Timeout)},
this.KHo);return new Promise(h=>{this.vkc=h})}catch(b){window.clearTimeout(this.cyj),this.onError(wu.F8a,Uw.Error,uy.Other,this.T7h(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get UVc(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get MRm(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.C$b){await xp.a.$k();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new rL.a,{annotationType:KG.SearchProviderAnnotation.getTypeName(),handler:this.qTf}))];NF.UVc&&h.push(b(Object.assign(new rL.a,{annotationType:$E.TextSummaryAnnotation.getTypeName(),handler:this.nmb})));await Promise.all(h);this.C$b=!0}}nmb(b){var h,v,D;if(this.vkc)if(this.czi(b)){if(b=b.items[0],$E.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.cyj),
b=b.body,b.status!==$E.Result.Success)this.onError(wu.F8a,Uw.Error,this.$Ul(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({aK:wu.F8a,logType:Uw.Success,success:!0});var Q=null!==b.summary&&""!==b.summary,ba=NF.MRm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===$E.TTSStatus.Success&&null!==(null===(v=b.tts)||void 0===v?void 0:v.base64Audio)&&""!==(null===(D=b.tts)||void 0===D?void 0:D.base64Audio);this.vkc({succeeded:Q,summary:Q?b.summary:null,audioSucceeded:ba,
audioBase64:ba?b.tts.base64Audio:null});this.vkc=null}}else this.log({aK:wu.F8a,logType:Uw.Error,success:!1,AKd:uy.Brg})}qTf(b){if(this.czi(b)&&(b=b.items[0],KG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.$gj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Unb)this.log({aK:wu.EUa,logType:Uw.Error,AKd:uy.XLj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Unb!==b.correlationId)this.log({aK:wu.EUa,logType:Uw.Error,AKd:uy.BRj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.DKh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({aK:wu.EUa,logType:Uw.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Unb=void 0;this.WSh.lkj(h)}else this.onError(wu.EUa,
Uw.Error,uy.Brg)}$Ul(b){switch(b.status){case "BlockedByPrefilter":return uy.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return uy.BlockedByQualityCheck;default:return uy.Other}}czi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.aK){case wu.EUa:var h=this.Jao;break;case wu.F8a:h=this.JHo;break;default:h=-1}const v=Date.now(),D=h?v-h:-1;h=[Object.assign(new pa.a,{name:"WorkflowType",string:b.aK}),Object.assign(new pa.a,{name:"LogType",string:b.logType}),
Object.assign(new pa.a,{name:"ErrorReason",string:b.AKd}),Object.assign(new pa.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new pa.a,{name:"Message",string:b.message}),Object.assign(new pa.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new pa.a,{name:"StartTime",int64:h}),Object.assign(new pa.a,{name:"EndTime",int64:v}),Object.assign(new pa.a,{name:"Duration",int64:D})];Object(Qe.a)("AugloopSearchProviderData",b.success,D,h)}T7h(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}DKh(b=
"",h="",v=""){return Object.assign(new qL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:v})}onError(b,h,v,D){h={aK:b,logType:h,success:!1,message:D,AKd:v};switch(b){case wu.EUa:if(!this.Unb)break;h.correlationId=this.Unb;this.log(h);this.Unb=void 0;this.gzl();break;case wu.F8a:if(!this.vkc)break;this.log(h);this.vkc(null);this.vkc=null;break;default:return null}}gzl(){this.WSh.lkj(this.DKh())}}Object(n.a)(NF,"AugloopSearchProviderManager",null,[]);class LG{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(n.a)(LG,"DocumentContentSearchResults",null,[]);class HH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,v,D,Q){this.selectRange(h,v,D,Q)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,v=>{h(Object.assign(new LG,{results:v,totalResultCount:v.length,hasTooManyResults:100<v.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,v=>{h(Object.assign(new LG,{results:v,
totalResultCount:v.length,hasTooManyResults:v.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(n.a)(HH,"BaseDocumentContentExecutor",null,[1268,369]);var IH=c(2071),sL=c(1461);class MG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(n.a)(MG,"DocumentContentSearchParams",null,[]);class JH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(n.a)(JH,"DocumentSelection",null,[]);class tL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(n.a)(tL,"IAuthorProperties",null,[]);var mE=c(678);class KH{constructor(){this.WLc=this.p8e=0}}Object(n.a)(KH,"CommentFindResultIndexInfo",null,[]);const LH=b=>{b.setSelection(We.SelectionEditor.xj(b.gb.kb,!0,!1))},uL=b=>{b=IH.a.cRd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class vL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(n.a)(vL,"DocumentContentSearchResult",null,[]);var dN=c(1819);class wL{constructor(){this.authorEmail=this.authorName=this.cDb=this.u8e=null}}Object(n.a)(wL,"CommentFindResults",null,[]);class xL{constructor(){this.end=this.begin=0}}Object(n.a)(xL,"FindResultOffset",null,[]);class aw{constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb){this.pue=this.pv=this.rAe=this.$A=null;this.Iih=0;this.XL=null;this.gqc=new zb.a;this.YOg=null;this.Qu=b;this.eb=h;this.ncb=v;this.Jea=
Q;this.PUb=ba;this.ltb=ta;this.$h=Ta;this.ga=ob;this.ib=Kb}AYl(b,h){var v;const D=[];if(12!=b.type)return D;const Q=Hn.FormattingReader.j3h(b);let ba=null,ta=-1;var Ta=Sl.a.auto;for(let Kb=0;Kb<=Q.length;Kb++){let Vb=-1;var ob=Sl.a.auto;Kb<Q.length&&(ob=Q[Kb],Vb=ob.cp,ob=null===(v=ob.formatting)||void 0===v?void 0:v.cache,ob=(null===ob||void 0===ob?0:ob.IFb)?ob.highlight:(null===ob||void 0===ob?0:ob.tPa)?ob.Tv:Sl.a.auto);if(Ta!=ob){if(Ta!=Sl.a.auto){ba||(ba=this.ltb.hEa(b.id));-1==Vb&&(Vb=ba.length);
Ta=this.ncb.QGd(ba,ta,Vb,"");const bc={};bc.context=Ta.BFd;bc.startOffsetInContext=Ta.$de;bc.endOffsetInContext=Ta.Yde-1;D.push({data:bc,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ta,endOffsetInParagraph:Vb-1})}ta=Vb;Ta=ob}}return D}get Xaa(){return this.YOg}initialize(){this.$A=Tt.FindManager.createInstance(this,this.Jea,qc.a.instance,!1,!0)}search(b,h){this.$A.DZa();this.jFf(b)?(this.pv=h,this.XL=new zb.a,b=this.Uaf(b),this.$A.find(b)):h(null)}searchV2(b,h){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.$A.DZa();if(this.jFf(b)){this.pxi()&&this.ga.Qb(Ua.a.sge,2,{CommandValueId:b});this.pue=h;this.Iih=b.totalResultLimit;this.XL=new zb.a;b=this.Uaf(b);this.YOg=new so.a;this.$A.find(b);h=this.Jea.I1c(b.text);h=this.Jea.dLb(h);b=this.PUb.n8b(h.join("|"),b);h=this.$h.BO();for(let D=0;D<h.length;D++){const Q=h[D],ba=uL(Q);var v=this.ltb.dib(ba,b);const ta=this.ltb.dib(Q.author,b);if(!v&&!ta){u.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ba,!b);continue}v=ta?ta:
v;let Ta="",ob="";ta&&(Ta=Q.author,ob=Q.authorId);for(const Kb of v)v=dN.a.createInstance(Kb.begin,Kb.end,W.a.Ff(Q.objectId),D,32,!1),this.gqc.add(v),this.Xaa.nb(D)||this.Xaa.add(D,Object.assign(new wL,{u8e:ba,cDb:[],authorName:Ta,authorEmail:ob}))}}else h(null)}get KZh(){null==this.rAe&&(this.rAe=Tt.FindManager.createInstance(this,this.Jea,qc.a.instance));return this.rAe}pxi(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}zac(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.jFf(b);b=h?this.Uaf(b):null;var v={};this.pxi()&&this.ga.Qb(sc.a.b2f,2,v);if(v[Ff.a.On]){if(h){h={};v={};var D={};this.ga.Qb(sc.a.Gae,2,h);this.ga.Qb(Ua.a.Fae,2,v);this.ga.Qb(Ua.a.Hae,2,D);if(b.text!=h.CommandValueId||b.matchCase!=v[Ff.a.On]||b.matchWholeWord!=D[Ff.a.On])LH(this.ib),this.ga.Qb(Ua.a.findInDocument,
2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else v=this.KZh,v.DZa(),h&&v.find(b)}selectNextPrevHighlight(b){const h=this.KZh;return 0<h.Kj.qja?(b?h.VSd():h.WSd(),h.Kj.bYe-1):-1}Uaf(b){let h=Au.a.none;b.matchCase&&(h|=Au.a.matchCase);b.matchWholeWordOnly&&(h|=Au.a.wholeWordOnly);return Px.a.createQuery(b.query,h)}jFf(b){return b&&!!b.query&&0<b.query.length}nhe(){}Gfe(){}reset(){}kkf(){}d6b(){if(this.pv){var b=this.EKh(this.XL);this.pv(b)}if(this.pue){b=new LG;
const h=this.XL.count+this.gqc.count>this.Iih;b.totalResultCount=this.XL.count+this.gqc.count;b.hasTooManyResults=h;h||(this.XL.RC(this.XL.count,this.gqc),b.results=this.EKh(this.XL));this.pue(b);this.gqc.clear()}}EKh(b){var h;const v=[];var D=Object.assign(new mE.a,{UO:!1,Tba:!0,doa:this.zac(),VO:!0});D=this.eb.gEa(this.Qu.value,D);for(const ta of b){var Q=ta.begin;let Ta=ta.end;var ba=void 0;b=-1;let ob=null,Kb=0;if(32===ta.type){ob=aw.t8e;Kb=3;b=D.count+ta.wPa;const Vb=({begin:Q,end:Ta}=pL.a.O9i(this.Xaa.J(ta.wPa).u8e,
Q,Ta)).returnValue;ba=this.ncb.QGd(Vb,Q,Ta,d.a(ta.type));this.Xaa.J(ta.wPa).u8e=Vb;this.Xaa.J(ta.wPa).cDb.push(Object.assign(new xL,{begin:Q,end:Ta}))}else{if(2===ta.type||4===ta.type)Kb=2===ta.type?1:2,ob=aw.uxf;if(8===ta.type||16===ta.type)Kb=8===ta.type?6:5,ob=aw.aRf;for(ba=0;ba<D.count;ba++)if(D.J(ba).id===ta.nodeId){b=ba;break}ba=this.ncb.RGd(ta)}Q=(null===(h=this.Xaa)||void 0===h?0:h.nb(ta.wPa))?this.Xaa.J(ta.wPa):null;if(0<=b||(null===Q||void 0===Q?0:Q.authorName))b=Object.assign(new vL,{snippet:ba.BFd,
subdocumentId:ob,subdocumentType:Kb,startOffsetInSnippet:ba.$de,endOffsetInSnippet:ba.Yde-1,paragraphIndex:b,startOffsetInParagraph:ta.begin-ba.$de,endOffsetInParagraph:ta.end-ba.Yde-1,authorName:Q?Q.authorName:"",authorEmail:Q?Q.authorEmail:""}),v.push(b)}v.sort((ta,Ta)=>ta.paragraphIndex===Ta.paragraphIndex?ta.startOffsetInParagraph-Ta.startOffsetInParagraph:ta.paragraphIndex-Ta.paragraphIndex);return v}update(){}tOa(b,h){switch(b){case 0:h&&0<h.length&&!this.XL&&(u.ULS.sendTraceTag(570975814,313,
15,"Results container list is null"),this.XL=new zb.a);for(const v of h)this.XL.add(v)}}tob(){}dispose(){}}aw.t8e="Comment";aw.uxf="HeaderFooter";aw.aRf="Note";aw.Toi="Image";Object(n.a)(aw,"WordDocumentSearchProcessor",null,[533,10,541]);class yL extends HH{get LR(){return!this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}zac(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",
!1)}constructor(b,h,v,D,Q,ba,ta,Ta,ob,Kb,Vb,bc,Dc,Oc){super();this.Ma=Kb;this.fMa=null;this.uY=(gd,rd)=>{gd=rd.node;rd=rd.property;this.Rcg(gd)&&rd===Gd.a.mo&&this.AFb(gd,3)};this.Yha=(gd,rd)=>{gd=rd.node;!rd.rCf&&this.Rcg(gd)&&this.AFb(gd,1)};this.gmb=(gd,rd)=>{gd=rd.node;this.Rcg(gd)&&this.AFb(gd,2)};this.Qu=b;this.eb=h;this.fd=v;this.ib=D;this.xE=Q;this.sl=Ta;this.Ub=ob;this.f7=ba;this.mC=ta;this.$h=Vb;this.H6j=bc;this.adh=W.a.create();this.Bce(this.uY,this.Yha,this.gmb);Oc&&Oc.execute(gd=>this.Vka=
gd);Dc.execute(gd=>{this.WXa=gd})}submitDocumentContentExtractionSignal(){this.WXa&&this.WXa.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.WXa?this.WXa.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.WXa?this.WXa.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.cU(this.C6l());for(const v of this.$h.BO()){var h=IH.a.cRd(v.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");
b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new mE.a,{UO:!1,Tba:!1,VO:!0}),v=this.eb.gEa(this.Qu.value,h);h=[];const D=[];for(var Q=0;Q<v.count;++Q){var ba=v.J(Q);h.push(...this.xZl(ba,Q));D.push(...this.f7.AYl(ba,Q))}v=[];Q=this.$h.BO();for(ba=0;ba<Q.length;ba++)v.push(this.$Pl(Q[ba]));Q={};Q.images=h;Q.comments=v;Q.highlights=D;b(Q)}selectRange(b,h,v,D,Q){const ba=Date.now(),ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};
try{this.aTa();if(0>b||0>h||0>v||0>D||b>v||b===v&&h>D)throw Error("Provided select range offsets incorrect");const Oc=Object.assign(new mE.a,{UO:!1,Tba:!0,doa:this.zac(),VO:!0}),gd=this.eb.gEa(this.Qu.value,Oc);if(v>=gd.count){const rd=Ga.a.instance.resolve("Common.Comments.ICommentModel").BO(),je=v-gd.count;if(je<rd.length){Q=-1;if(this.f7.Xaa.nb(je)){const Qd=this.f7.Xaa.J(je).cDb;for(var Ta=0;Ta<Qd.length;Ta++)if(Qd[Ta].begin===h){Q=Ta;break}}this.fMa=-1!==Q?Object.assign(new KH,{p8e:je,WLc:Q}):
null;const Ld=rd[je];w.AFrameworkApplication.va.processAction(sc.a.BT,2);w.AFrameworkApplication.va.Qb(sc.a.z3,2,null);w.AFrameworkApplication.va.Qb(sc.a.selectComment,2,Object.assign(new sL.a,{commentId:Ld.id,K9:2,LR:this.LR}))}}else{this.fMa=null;var ob=gd.J(b),Kb=gd.J(v);if(!this.N_d(ob,h)||!this.N_d(Kb,D))throw Error("Provided select range offsets incorrect");w.AFrameworkApplication.va.processAction(sc.a.BT,2);this.GJo(ob);var Vb=this.xE.ue(ob,h);Ta=this.xE.oA(Vb,Pe.a.Rc(Kb,D+1));if(Q){const rd=
Ta.toArray();h=[];for(const je of rd)h.push(this.RQd(je.node));h.join(" ").includes(Q)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}var bc=this.sl.value.tu,Dc=this.ib.gb.kb;Dc&&Dc.equals(Ta)&&this.fd.ida(bc,null);this.fd.ida(bc,Ta);ta.duration=Date.now()-ba;this.logMessage(ta)}}catch(Oc){ta.success=!1,ta.message=Oc.stack,ta.duration=Date.now()-ba,this.logMessage(ta)}}search(b,h){this.aTa();this.f7.search(Object.assign(new MG,{query:b}),h)}searchV2(b,h){this.aTa();
this.f7.searchV2(Object.assign(new MG,{query:b}),h)}selectNextPrevHighlight(b){this.aTa();return this.f7.selectNextPrevHighlight(b)}searchWithParam(b,h){this.aTa();this.f7.search(b,h)}searchWithParamV2(b,h){this.aTa();this.f7.searchV2(b,h)}highlight(b){this.aTa();this.f7.highlight(Object.assign(new MG,{query:b}))}highlightWithParam(b){this.aTa();this.f7.highlight(b)}getRevision(){return this.adh.toString()}getSelectedText(){const b=this.H6j.getSelectedText();return Object.assign(new Jx.a,{neighborhood:b.neighborhood,
mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new mE.a,{UO:!1,Tba:!0,doa:this.zac(),VO:!0}),h=({Vr:ba}=this.ibm(b)).returnValue;if(h)return h;var v=this.ib.gb.kb;if(!v||!v.length)return null;h=v.Oa;v=v.Pc;let D=-1,Q=-1;var ba=ba||this.eb.gEa(this.Qu.value,b);b=null;for(let ta=0;ta<ba.count;ta++){const Ta=ba.J(ta);-1===D&&h.node.id===Ta.id&&(D=ta,b=Ta);-1===Q&&v.node.id===Ta.id&&(Q=ta)}ba=null;5===(null===b||void 0===b?void 0:b.Uma)&&(ba=aw.uxf);
if(1===(null===b||void 0===b?void 0:b.Uma)||2===(null===b||void 0===b?void 0:b.Uma))ba=aw.aRf;return Object.assign(new JH,{subdocumentId:ba,startParagraphIndex:D,startParagraphOffset:h.oj,endParagraphIndex:Q,endParagraphOffset:v.Yo})}clearDocumentSelection(){LH(this.ib)}selectRangeV2(b,h,v,D,Q,ba){const ta=Date.now(),Ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.aTa();if(0>h||0>v||0>D||0>Q||h>D||h===D&&v>Q)throw Error("Provided select range offsets incorrect");
var ob=Object.assign(new mE.a,{UO:!1,Tba:!0,doa:this.zac(),VO:!0});const Dc=this.eb.gEa(this.Qu.value,ob);if(b==aw.t8e)this.nhj(v,D,Dc.count);else{ob=this.fMa=null;var Kb={};Kb.subdocumentId=b;Kb.startParagraphIndex=h;Kb.startParagraphOffset=v;Kb.endParagraphIndex=D;Kb.endParagraphOffset=Q;ob=b==aw.Toi?this.$9h(Dc.J(h),{isFloatingImage:!1,imageId:"",...Kb}):this.Hhi(Dc.J(h),Dc.J(D),{clickedPassage:ba,...Kb},Ta);var Vb=this.sl.value.tu,bc=this.ib.gb.kb;(null===bc||void 0===bc?0:bc.equals(ob))&&this.fd.ida(Vb,
null);this.fd.ida(Vb,ob)}Ta.duration=Date.now()-ta;this.logMessage(Ta)}catch(Dc){Ta.success=!1,Ta.message=Dc.stack,Ta.duration=Date.now()-ta,this.logMessage(Ta)}}selectRangeV3(b){const h=Date.now(),v={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.aTa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>
b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var D=Object.assign(new mE.a,{UO:!1,Tba:!0,doa:this.zac(),VO:!0});const ta=this.eb.gEa(this.Qu.value,D);if(b.subdocumentId==aw.t8e)this.nhj(b.startParagraphOffset,b.endParagraphIndex,ta.count);else{D=this.fMa=null;D=b.subdocumentId==aw.Toi?this.$9h(ta.J(b.startParagraphIndex),b):this.Hhi(ta.J(b.startParagraphIndex),ta.J(b.endParagraphIndex),b,v);var Q=this.sl.value.tu,ba=this.ib.gb.kb;(null===ba||void 0===ba?0:ba.equals(D))&&
this.fd.ida(Q,null);this.fd.ida(Q,D)}v.duration=Date.now()-h;this.logMessage(v)}catch(ta){v.success=!1,v.message=ta.stack,v.duration=Date.now()-h,this.logMessage(v)}}C6l(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},v=Object.assign(new mE.a,{UO:!1,Tba:!1,VO:!0});h.duration=Date.now()-b;this.logMessage(h);return this.eb.gEa(this.Qu.value,v)}cU(b){const h=Date.now(),v={activityName:"GetParagraphContent",success:!0,message:"",duration:0},D=new zb.a;for(const Q of b)D.add(this.RQd(Q));
v.duration=Date.now()-h;this.logMessage(v);return D}$9h(b,h){if(h.isFloatingImage)return h=W.a.Ff(h.imageId),b=b.Jc.Db(h),b=Mg.SelectionFactory.uq(b);const v=this.xE.ue(b,h.startParagraphOffset);return b=this.xE.oA(v,Pe.a.Rc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new df.a(b,"O365",h,b);if(!this.Vka||!this.Vka.getPersonaIconPropertiesArray)return null;b=await this.Vka.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new tL,{authorImageURL:b[0].authorImageURL,
authorColor:b[0].authorColor,authorID:b[0].authorID}):null}Hhi(b,h,v,D){if(!this.N_d(b,v.startParagraphOffset)||!this.N_d(h,v.endParagraphOffset))throw Error("Provided select range offsets incorrect");v.subdocumentId==aw.uxf?w.AFrameworkApplication.va.Qb(sc.a.Ekb,2,new It.a(b)):w.AFrameworkApplication.va.processAction(sc.a.BT,2);v.subdocumentId==aw.aRf?32===w.AFrameworkApplication.va.Qb(sc.a.J4a,2,new It.a(b))&&w.AFrameworkApplication.va.processAction(sc.a.KMd,2):w.AFrameworkApplication.va.Qb(sc.a.z3,
2,null);b=this.xE.ue(b,v.startParagraphOffset);h=this.xE.oA(b,Pe.a.Rc(h,v.endParagraphOffset+1));if(v.clickedPassage){b=h.toArray();const Q=[];for(const ba of b)Q.push(this.RQd(ba.node));Q.join(" ").includes(v.clickedPassage)||(D.success=!1,D.message="The text in clicked passage does not match the selected hit")}return h}nhj(b,h,v){const D=Ga.a.instance.resolve("Common.Comments.ICommentModel").BO();h-=v;if(h<D.length){v=-1;if(this.f7.Xaa.nb(h)){const Q=this.f7.Xaa.J(h).cDb;for(let ba=0;ba<Q.length;ba++)if(Q[ba].begin===
b){v=ba;break}}this.fMa=-1!==v?Object.assign(new KH,{p8e:h,WLc:v}):null;b=D[h];w.AFrameworkApplication.va.processAction(sc.a.BT,2);w.AFrameworkApplication.va.Qb(sc.a.z3,2,null);w.AFrameworkApplication.va.Qb(sc.a.selectComment,2,Object.assign(new sL.a,{commentId:b.id,K9:2,LR:this.LR}))}}aTa(){this.Ub&&(this.Ub.currentScope&&this.Ub.currentScope.name===Qh.XB||this.Ub.mg(Qh.XB))}fXo(){this.adh=W.a.create()}RQd(b){if(b.YGb)return"";b=this.eb.text(b);return S.AParagraphNode.IR(b," ")}N_d(b,h){b=this.RQd(b);
return h<b.length}AFb(b,h){switch(h){case 1:case 2:case 3:this.fXo()}}logMessage(b){const h=[Object.assign(new pa.a,{name:"Message",string:b.message})];Object(Qe.a)(b.activityName,b.success,b.duration,h)}Rcg(b){return!b.YGb&&this.OUc(b)}OUc(b){const h=this.Qu.value;return!!h&&!!h.od&&!!b.Jc&&b.Jc.id.equals(h.od.id)}GJo(b){this.eb.fUc(b)?32===w.AFrameworkApplication.va.Qb(sc.a.J4a,2,new It.a(b))&&w.AFrameworkApplication.va.processAction(sc.a.KMd,2):w.AFrameworkApplication.va.Qb(sc.a.z3,2,null)}Bce(b,
h,v){this.mC&&(this.mC.Go(b),this.mC.Vt(h),this.mC.Ow(v))}ibm(b){let h=null;var v=this.Ub?this.Ub.currentScope.name:"";if(!this.$h.jt||v!==gf.AFrame.Gr&&v!==gf.AFrame.rM)return{returnValue:null,Vr:h};v=Array.indexOf(this.$h.BO(),this.$h.jt);if(0>v)return{returnValue:null,Vr:h};h=this.eb.gEa(this.Qu.value,b);var D=IH.a.cRd(this.$h.jt.text[0]).split("\n");b=0;D=(1===D.length?D[0]:D.join(" ")).length-1;this.fMa&&v===this.fMa.p8e&&this.f7.Xaa.nb(v)&&this.f7.Xaa.J(v).cDb.length>this.fMa.WLc&&(b=this.f7.Xaa.J(v).cDb[this.fMa.WLc].begin,
D=this.f7.Xaa.J(v).cDb[this.fMa.WLc].end);return{returnValue:Object.assign(new JH,{startParagraphIndex:h.count+v,startParagraphOffset:b,endParagraphIndex:h.count+v,endParagraphOffset:D,subdocumentId:"Comment"}),Vr:h}}xZl(b,h){const v=[];if(12!=b.type)return v;v.push(...this.XZl(b,h));v.push(...this.AWl(b,h));return v}AWl(b,h){const v=[],D=ne.GraphIterator.$a(b);if(!D.wA())return v;let Q=D.Qd();for(;Q;){if(!this.XPa(Q)){Q=D.xt();continue}const ba=Q.properties;ba&&ke.ImageReader.nUc(ba)&&v.push(this.qAj(ba,
h,0,b.Jc,!0,Q.id.toString()));Q=D.xt()}return v}XPa(b){if(19!==b.type)return!1;b=ne.GraphIterator.$a(b);if(!b.wA())return!0;let h=b.Qd();for(;h;){if(59===h.type)return!1;h=b.xt()}return!0}XZl(b,h){const v=[],D=b.Jc;if(D){if(!b.hasProperty(Gd.a.Hn))return v;var Q=b.ia(Gd.a.Hn,null);if(!Q)return v;b=b.ia(Gd.a.zm,null);for(let ta=0;ta<Q.length;++ta){var ba=Q[ta];if(!ba)continue;ba=D.Db(ba);if(!ba||!ke.ImageReader.nUc(ba))continue;let Ta=0;0!=ta&&b&&ta-1<b.length&&(Ta=b[ta-1]);v.push(this.qAj(ba,h,Ta,
D,!1,""))}return v}}qAj(b,h,v,D,Q,ba){D=(new Sys.Net.WebRequest).getResolvedUrl()+ke.ImageReader.vva(b,D,this.Ma,w.AFrameworkApplication.ta.GEa);const ta=b.ia(wc.a.au,""),Ta={};Ta.base64Encoding=ta;Ta.url=D;Ta.width=ke.ImageReader.HC(b);Ta.height=ke.ImageReader.JH(b);Ta.altText=ke.ImageReader.BX(b);Ta.description=ke.ImageReader.YOa(b);Ta.imageId=ba;Ta.isFloatingImage=Q;return{data:Ta,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:v,endOffsetInParagraph:v+1}}$Pl(b){return{data:{comment:uL(b),
authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(n.a)(yL,"WordDocumentContentExecutor",HH,[]);class NG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(n.a)(NG,"BaseDocumentHelper",null,[447]);class zL extends NG{constructor(b){super();this.lIl=b}get T4b(){const b=this.lIl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Ya.App.xa.hb.isEditingAllowed}author(){var b;
return null===(b=this.T4b)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.T4b)||void 0===b?void 0:b.creationDate}}Object(n.a)(zL,"WordDocumentHelper",NG,[]);class AL{constructor(b){this.PKi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.iAf(b.htmlText)}getId(){return"InsertContentExecutor"}iAf(b){return this.executeCommand(Eb.a.nCa,b)}executeCommand(b,h){const v=new fh.DictionaryPropertySet;v.setValue(wc.a.jP,h);v.setValue(wc.a.Nia,!1);h=this.PKi.processAction(b,1);32===
h&&(h=this.PKi.Qb(b,2,v));return h}}Object(n.a)(AL,"WordInsertContentExecutor",null,[368,369]);var eN=c(1704),fN=c(1705);class BL{constructor(b,h,v,D,Q){this.Wqc="undefined";this.kcg="Something went wrong with retrieving a summary. Please try again.";this.dEm=(ba,ta,Ta,ob,Kb)=>ov.YX(ba,ta,Ta,ob,this.kC,Kb);this.gie=(ba,ta,Ta,ob,Kb)=>{if(1===Ta)return this.I7j?32:8;ba=kG.getSelectedText();ba=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,kG.tRd(ba));Kb[cl.a.LabelText]=
ba;return 32};this.zmf=(ba,ta,Ta)=>{if(1===Ta)return 32;const ob={};this.WXa?this.WXa.generateDocumentSummary().then(Kb=>{Kb||(Kb=this.kcg,u.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));ob.additionalData=this.B$e(Kb);this.ga.Qb(Ua.a.i8,2,ob)}).catch(()=>{u.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");ob.additionalData=this.B$e(this.kcg);this.ga.Qb(Ua.a.i8,2,ob)}):(u.ULS.sendTraceTag(509723397,1303,
15,"Share with summary: Search provider manager is unavailable."),ob.additionalData=this.B$e(this.kcg),this.ga.Qb(Ua.a.i8,2,ob));return 32};this.rLo=(ba,ta,Ta)=>{if(!this.CLi)return u.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Ta)return this.mTm()?32:2;if(2===Ta)this.CLi.wSd(this.Ma.jb("SmartLookupShredderServiceEndpoint")).then(ob=>{ob={token:ob,files:F.c(this.EVl()),type:"MultiFilesDeckGeneration"};ob=Object.assign(new eN.a,{selection:Object.assign(new Jx.a,
{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new vu.a,{landingTab:"All",data:ob}),entryPoint:38});this.ga.Qb(Ua.a.B8,2,ob);return 32}).catch(()=>{u.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.kC=b;this.ga=h||w.AFrameworkApplication.va;this.Ma=v;this.r7j=(this.Jw=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.xJ)&&!!this.Ma&&this.Ma.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");
this.I7j=!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);D&&D.execute(ba=>{this.WXa=ba});this.CLi=Q}Tb(){this.ga.fb(sc.a.Cvh,Kd.a.frame,this.dEm,1028);this.ga.fb(sc.a.gie,Kd.a.frame,this.gie,1028);this.ga.fb(sc.a.q2h,Kd.a.frame,this.zmf,1028);this.ga.fb(sc.a.rAj,Kd.a.frame,this.rLo,1028);this.r7j&&(this.Wqc=Ya.App.xa.GI.getWindowMode(),this.MVh(this.Wqc),Ya.App.xa.GI.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.Wqc&&(this.Wqc=
h,this.MVh(this.Wqc))}))}mTm(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}MVh(b){"DP"===b&&Xj.UISurfaces.Bu().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Qb(sc.a.Cvh,2,{SourceControlId:"smartlookupAuto"});return null})}B$e(b){return{["documentSummary"]:b}}EVl(){const b=new fN.a("docx",
w.AFrameworkApplication.K.jb("EditDocInClientUrl"),w.AFrameworkApplication.K.jb("BreadcrumbBrandUrl"),"",w.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(n.a)(BL,"WordInsightsActor",null,[]);class aF{constructor(){this.hgd=this.$P=null}e1a(){return this.qEb()}w$h(){return this.qEb()}u$h(){return null}Dvo(b,h,v){this.$P||(this.$P=this.zGd());this.$P.qP(b,h,v)}Evo(b,h,v){this.$P||(this.$P=this.zGd());this.$P.leg(b,h,v)}$to(b,
h){this.hgd||(this.hgd=null);this.hgd&&this.hgd.leg(b,h)}NNb(b,h){this.$P||(this.$P=this.zGd());this.$P.NNb(b,h)}x0d(b){this.$P||(this.$P=this.zGd());this.$P.x0d(b)}Lco(){this.$P&&this.$P.jic()}sho(){this.$P&&this.$P.fge()}mto(){var b=w.AFrameworkApplication.K.mc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-aF.tEi<=b;b||(aF.tEi=window.performance.now());return b}dispose(){this.$P&&(this.$P.dispose(),this.$P=null)}get yHb(){return this.$P?this.$P.isVisible:!1}}
aF.tEi=0;Object(n.a)(aF,"InsightsManager",null,[1295,10]);class OF{constructor(b,h,v,D,Q,ba=!0,ta=null,Ta=null){this.T5=this.wE=this.QKa=null;this.Cvc=!1;this.oea=null;this.Ub=h;this.eWb=ba;this.kSg=Ta?Ta:new NG;this.Lz=ta;this.fp=b;this.eWb&&(Ga.a.instance.Na("Common.App.SearchCommon.SearchHostRuntime")&&(this.oea=Ga.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").wqf()),this.ocb=Ga.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.yyb=this.ocb.rPc())}bmb(b){if(this.eWb){b=
b.rawEvent;try{var h=F.a(b.data)}catch(v){u.ULS.sendTraceTag(595161728,1303,15,this.RT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.wE&&(b=this.wE.entryPoint);this.ocb.Rtf(this.T5,this.kSg,this.M8b(),b).then(v=>{h.data=v;this.Vmb(h)});break;case 118:h.data=this.wE?this.wE:Object.assign(new Qt.a,{selection:Object.assign(new Jx.a,{neighborhood:this.QKa.neighborhood,mentionStart:this.QKa.mentionStart,mentionLength:this.QKa.mentionLength})});
this.Vmb(h);break;case 103:b=F.a(Object(Ka.a)(String,h.data));Zl.sendTelemetryEvent(b);break;case 206:this.ocb.wSd(h.data).then(v=>{h.data=v;this.Vmb(h)});break;case 112:h.data.shiftPressed?(aa.a.jj&&document.activeElement.blur(),this.fp.kUd(0,null,2,null,null),u.ULS.sendTraceTag(592545156,1303,50,this.RT("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.fp.kQc(0,null,2,null,null),u.ULS.sendTraceTag(592545155,1303,50,this.RT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Wna()}}}U5c(b){if(this.oea){var h=
0;this.wE&&(h=this.wE.entryPoint);this.ocb.Rtf(this.T5,this.kSg,this.M8b(),h).then(v=>{Zl.lij("SearchFromHost",this.T5);this.wE.launchData||(this.wE.launchData=new vu.a);const D=JG();try{this.oea.search(this.wE,v,w.AFrameworkApplication.userSessionId,D,b),this.ocb.fBn(Q=>{Zl.lij("SearchFromHostWithToken",this.T5);this.oea.searchAuthenticatedProviders(this.wE,v,w.AFrameworkApplication.userSessionId,D,null,Q)})}catch(Q){Zl.Dz("BaseSmartLookupPane - Fail to search from host. Error: "+Q,10)}}).catch(v=>
{Zl.Dz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+v.toString(),10)})}}kic(b){if(this.eWb){var h=Zl,v=h.kic,D=this.T5;b=Math.round(window.performance.now()-b);var Q=this.wE?YE[this.wE.entryPoint]:"",ba=this.ocb.rPc(),ta=this.ocb.uVl(),Ta=this.wE?this.wE.entryPoint:0;v.call(h,D,b,Q,ba,ta,w.AFrameworkApplication.l0e,this.Cvc,18===Ta||19===Ta||15===Ta)}}}Object(n.a)(OF,"BaseSmartLookupPane",null,[432,10]);class PF{constructor(b){this.messageType=null;this.messageType=
b}}Object(n.a)(PF,"InsightsMessage",null,[]);class QF extends PF{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(n.a)(QF,"InsightsMessageWithContent",PF,[]);class CL extends QF{constructor(b){super(Qh.ocn,b)}}Object(n.a)(CL,"InsightsMessageAppProperties",QF,[]);class DL extends QF{constructor(b){super(Qh.zcn,b)}}Object(n.a)(DL,"InsightsMessageSelection",QF,[]);class EL extends PF{constructor(){super(Qh.Bcn)}}Object(n.a)(EL,"InsightsMessageTakeFocus",PF,[]);class RF extends OF{constructor(b,
h,v,D,Q=null,ba=null,ta=null,Ta=!0,ob=null,Kb=null){super(h,v,Q,ba,ta,Ta,ob,Kb);this.ffd=this.cB=this.gj=null;this.wqd=!1;this.gld=b;this.juc=this.eWb?EH(this.yyb):w.AFrameworkApplication.tCm;this.d_();this.Z3f();this.Rp=D;this.$Qg=0}get isVisible(){return!1}d_(){this.gj=this.gld.vIc();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Vjb&&this.gj.NVn(b=>{b===this.gj&&(this.fge(),this.jic())});this.Nzf(this.gj.uTa.jwh);this.gj.xm()}Nzf(b){b.style.overflow="hidden";const h=ka.a.createElement("iframe");
Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.cB=h;b.appendChild(this.cB);this.cB.id=Qh.qyf}Z3f(){lf.a.addHandler(this.cB,"load",Object(z.a)(this,this.amb,"onIFrameLoad"));lf.a.addHandler(this.cB,"error",Object(z.a)(this,this.$lb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,this.bmb,"onIFrameMessage"))}plg(){lf.a.removeHandler(this.cB,"load",Object(z.a)(this,this.amb,"onIFrameLoad"));lf.a.removeHandler(this.cB,"error",Object(z.a)(this,
this.$lb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.bmb,"onIFrameMessage"))}dispose(){this.cB&&(this.plg(),this.cB.parentNode.removeChild(this.cB),this.cB=null);this.gj&&(this.gld.M4b(this.gj),this.gj=null)}qP(b,h,v){this.T5=h;this.ffd=null;this.$Qg=v;this.Cvc=!b.mentionLength;this.wqd=!1;u.ULS.sendTraceTag(6295947,1303,50,this.RT("Start to show Insights"));this.QKa=b;this.juc&&this.juc.length?this.cB.src=this.juc:(this.cB.src=RF.jRi,u.ULS.sendTraceTag(6295948,1303,15,
this.RT("The Insights URL config setting is null or empty")));this.Rp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.gj.hY||this.gj.g4f(Object(z.a)(this,this.Kon,"onInsightsTaskPaneHidden"));this.eWb&&this.U5c(!1);b=window.performance.now();this.gld.showTaskPane(this.gj);this.gj.xm();this.kic(b)}leg(b,h,v){this.wE=b;this.qP(Object.assign(new LF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,v)}NNb(){}x0d(){}jic(){this.cB.src===
this.juc&&this.wqd&&(this.Ub.mg(Qh.XB),this.Vmb(new EL))}fge(){this.cB&&$c.FocusManager.WJ(this.cB.contentWindow)}Hcf(){this.cB.src=RF.jRi;this.gj.ym()}Wna(){this.gld.hideTaskPane(this.gj);this.Hcf()}Kon(b){b===this.gj&&this.Wna()}amb(){u.ULS.sendTraceTag(6295951,1303,50,this.RT("The iframe is successfully loaded in Insights task pane"))}$lb(){u.ULS.sendTraceTag(6295952,1303,15,this.RT("The iframe failed to load in Insights task pane"))}bmb(b){const h=b.rawEvent;if(h.source===this.cB.contentWindow)if(this.eWb)super.bmb(b);
else{let v;try{v=F.a(h.data)}catch(D){u.ULS.sendTraceTag(6295953,1303,15,this.RT("Message data [{0}] failed to deserialize.",h.data));return}if(qf.c(v.messageType))u.ULS.sendTraceTag(6295954,1303,15,this.RT("Message data [{0}] is in wrong format.",h.data));else switch(v.messageType){case Qh.pcn:this.Vmb(new CL(this.f_l()));break;case Qh.Acn:this.Vmb(new DL(this.QKa));break;case Qh.vcn:this.wqd=!0;this.fge();this.jic();u.ULS.sendTraceTag(6295955,1303,50,this.RT("Insights pane rendering is completed"));
break;case Qh.Ccn:b=v.messageContent;this.ffd=b.clientCorrelationId;this.T5!==b.appCorrelationId&&u.ULS.sendTraceTag(6403778,1303,15,this.RT("App correlation ID on client {0} does not match one on server {1}",this.T5,b.appCorrelationId));break;case Qh.ucn:v.messageContent?(aa.a.jj&&document.activeElement.blur(),this.fp.kUd(0,null,2,null,null),u.ULS.sendTraceTag(6604741,1303,50,this.RT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.fp.kQc(0,null,2,null,null),u.ULS.sendTraceTag(6604742,
1303,50,this.RT("Insights UX lost focus through Ctrl + F6")));break;case Qh.rcn:v.messageContent.keyCode===zf.a.IIa&&this.Wna();break;case Qh.scn:try{this.wqd=!1,localStorage.setItem(Qh.kFi,"true")}catch(D){u.ULS.sendTraceTag(17961859,1303,10,this.RT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}f_l(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.T5;3===w.AFrameworkApplication.ta.Nb.Sl?b.applicationName=Qh.U5o:4===w.AFrameworkApplication.ta.Nb.Sl&&(b.applicationName=
Qh.lvn);b.applicationVersion=w.AFrameworkApplication.buildVersion;var h=lk.a.og(w.AFrameworkApplication.lcid);h=h?h.name:null;b.market=DH(h);b.uiLanguage=h;b.sessionId=w.AFrameworkApplication.userSessionId;b.parentalControl=Qh.ZXf;b.clientType="user";b.legalAgreed=this.n0l();b.defaultDefineTab=1===this.$Qg?"true":null;return b}RT(b,...h){const v={};this.T5&&(v[Qh.Gxj]=this.T5);this.ffd&&(v[Qh.UGo]=this.ffd);v[Qh.Hxj]=String.format.apply(null,[b].concat(h));return F.c(v)}M8b(){return 5}n0l(){try{const b=
localStorage.getItem(Qh.kFi);return!!b&&"true"===b}catch(b){return u.ULS.sendTraceTag(17961860,1303,10,this.RT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Vmb(b){b=F.c(b);this.cB.contentWindow.postMessage(b,ja.a.getOrigin(this.juc))}}RF.jRi="about:blank";Object(n.a)(RF,"InsightsPane",OF,[]);class FL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(n.a)(FL,"SmartLookupTaskPaneProps",null,[]);class GL{}Object(n.a)(GL,"ActionDescriptor",null,[]);class HL extends OF{constructor(b,
h,v,D=null,Q=null,ba=null,ta=!0,Ta=null,ob=null){super(h,v,D,Q,ba,ta,Ta,ob);this.dUe=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.wGf;this.Is=this.VOe=!1;this.pak=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.nak=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.sak=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.rak=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ta||Zl.Dz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.fBa=b;this.JYg=EH(this.yyb)}get isVisible(){return this.Is}NNb(b,h){this.wE=b;this.QKa=b=Object.assign(new LF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.Cvc=!b.mentionLength;this.T5=h;this.U5c(!1)}x0d(b){this.wE=
b;this.Kjc(Object.assign(new LF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}qP(b,h){this.T5=h;this.Kjc(b,!0)}leg(b,h,v){this.wE=b;this.qP(Object.assign(new LF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,v)}Wna(){this.eda();this.fBa.hideTaskPane()}Kjc(b,h){ac.SessionStatusManager.instance.OH&&this.oea?(this.QKa=b,this.Cvc=!b.mentionLength,b=
window.performance.now(),this.initialize(),this.isVisible?w.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.fBa.updateTaskPane(null),h&&this.tdo()):(h&&this.U5c(!1),this.VOe=!this.VOe,this.fBa.updateTaskPane(this.jA())):(h&&this.U5c(this.isVisible),this.fBa.showTaskPane(this.jA())),this.kic(b)):(this.fBa.showTaskPane(this.jA()),Zl.Nco(ac.SessionStatusManager.instance.OH,!!this.oea,this.wE?YE[this.wE.entryPoint]:"",this.ocb.rPc(),w.AFrameworkApplication.l0e,this.Cvc))}tdo(){if(!this.wE){const b=
Object.assign(new Jx.a,{neighborhood:this.QKa.neighborhood,mentionStart:this.QKa.mentionStart,mentionLength:this.QKa.mentionLength});this.wE=Object.assign(new Qt.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.U5c(this.isVisible)}Xco(){const b=new GL;b.transactionId=this.T5;b.actionType=15;b.channelId=Qh.channelId;this.Vmb(b)}bmb(b){const h=b.rawEvent;document.getElementById(Qh.XB)&&h.source!==document.getElementById(Qh.XB).contentWindow||this.AOn(b)}AOn(b){const h=b.rawEvent;let v;
try{v=F.b(h.data)}catch(D){u.ULS.sendTraceTag(545604257,1303,15,this.RT("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(v.actionType){case 32:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(jc.a.oFb()>=this.pak?this.fBa.updateTaskPane(this.nbf(this.nak)):jc.a.oFb()>=this.sak&&this.fBa.updateTaskPane(this.nbf(this.rak)));break;case 33:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&this.fBa.updateTaskPane(this.nbf(v.data));break;case 42:this.fBa.updateTaskPane(this.Qdl(v.data));break;case 43:this.fBa.updateTaskPane(this.jA());break;default:super.bmb(b)}}dispose(){}initialize(){this.d_();this.aja()}d_(){this.fBa.vIc()}aja(){const b=this.Ub.fe(Qh.XB);b.parent=gf.AFrame.vp;b.TH=!0}zho(){this.Ub.mg(Qh.XB)}eda(){this.p3a()&&this.Ub.mg(this.Ub.yT)}Z3f(){$addHandler(window,"message",Object(z.a)(this,this.bmb,"onIFrameMessage"))}plg(){$removeHandler(window,"message",Object(z.a)(this,
this.bmb,"onIFrameMessage"))}p3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===Qh.XB}Vmb(b){b=F.c(b);document.getElementById(Qh.XB)&&document.getElementById(Qh.XB).contentWindow.postMessage(b,ja.a.getOrigin(this.JYg))}RT(b,...h){const v={};this.T5&&(v[Qh.Gxj]=this.T5);v[Qh.Hxj]=String.format.apply(null,[b].concat(h));return F.c(v)}M8b(){return Lh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}DXi(){if(this.oea)this.oea.onPaneThemeChanged(this.M8b());return Lh.a("getTheme")?
appChrome.api.getTheme():null}jic(){}fge(){document.getElementById(Qh.XB)&&$c.FocusManager.WJ(document.getElementById(Qh.XB).contentWindow)}$lb(){Zl.Dz("ReactSmartLookupPane - Iframe component failed to load.",10)}amb(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Zl.Dz("ReactSmartLookupPane - Onload detected no network.",50)}nUl(){return this.wE?10===this.wE.entryPoint?2===w.AFrameworkApplication.ta.Nb.Sl?
CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.wE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.wE.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.wE.entryPoint||38===this.wE.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}jA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&
(b=this.nUl());const h=new FL;h.src=this.JYg;h.id=Qh.XB;h.refreshPane=this.VOe;h.onError=Object(z.a)(this,this.$lb,"onIFrameError");h.onLoad=Object(z.a)(this,this.amb,"onIFrameLoad");h.title=b;ac.SessionStatusManager.instance.OH?this.oea||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new uo.a,{title:b,hideHeader:!1,width:Qh.width,location:Qh.wyn,contentProps:h,
isModernPane:!0,onOpen:()=>{this.zho();this.Is=!0;this.Z3f();Lh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.DXi,"onThemeIdChanged"));w.AFrameworkApplication.ta.updateCommandUI();if(this.oea)this.oea.onPaneStateChanged(!0)},onClose:()=>{this.Xco();this.eda();this.Is=!1;this.plg();Lh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.DXi,"onThemeIdChanged"));w.AFrameworkApplication.ta.updateCommandUI();
if(this.oea)this.oea.onPaneStateChanged(!1)}});this.dUe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}Qdl(b){const h=this.jA();h.title=b;h.contentProps.title=b;return h}nbf(b){const h=this.jA();h.resizeWidth=b;return h}}Object(n.a)(HL,"ReactSmartLookupPane",OF,[]);class IL{vIc(){const b=new mo.CuiHelper(zj.a.tZa,WordEditorIntl.WordEditorStrings);return Wn.a.instance.OMh(Qh.XB,Qh.nfc,Qh.width,Qh.Whg,b)}showTaskPane(b){Wn.a.instance.showTaskPane(b)}hideTaskPane(b){Wn.a.instance.hideTaskPane(b)}M4b(b){Wn.a.instance.M4b(Qh.XB,
b)}}Object(n.a)(IL,"WordInsightsPaneHandler",null,[410]);class JL{vIc(){Wn.a.instance.INa()}showTaskPane(b){Xj.UISurfaces.Bu().then(h=>{h.showTaskPane(Qh.XB,b);return null})}updateTaskPane(b=null){Xj.UISurfaces.Bu().then(h=>{h.setSelectedTaskPane(Qh.XB);b&&h.updateTaskPane(Qh.XB,b);return null})}hideTaskPane(){Xj.UISurfaces.Bu().then(b=>{b.hideTaskPane(Qh.XB,2);return null})}}Object(n.a)(JL,"WordReactSmartLookupPaneHandler",null,[411]);class KL extends aF{constructor(b,h){super();this.wx=b;this.ib=
h}zGd(){const b=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.pFf?new HL(new JL,Z.a.instance,$c.FocusManager.instance(),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ga.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ga.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new RF(new IL,Z.a.instance,$c.FocusManager.instance(),Ga.a.instance.resolve("Common.Utils.IAriaNotifier"),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ga.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ga.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ga.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}qEb(){return this.wx.getSelectedText()}u$h(){if(!this.ib||!this.ib.gb||1>this.ib.gb.length)return null;var b=this.ib.gb.kb.Oa;b=null==b?null:Hn.FormattingReader.Kr(b);return(b=null==b?null:lk.a.og(Hn.FormattingReader.language(b)))?b.name:""}e1a(){return this.wx.Etf()}w$h(){return this.wx.Etf()}Bxi(){return this.wx.EHm()}}Object(n.a)(KL,"WordInsightsManager",aF,[]);var gN=c(213);class LL{}Object(n.a)(LL,"CommandMetadataResponse",null,
[]);class nE{constructor(){this.tyf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){gN.PrivacyDialogManager.die()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=new LL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));
if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const v=appChrome.selectors.getControlIconSet(b.commandId),D=Array(2);D[0]=v["default"];D[1]=v.icon32;h.svgData=this.getCommandIconSvg(D)}catch(v){return null}return h}getCommandIconSvg(b){if(!this.tyf)return"";
for(let h=0;h<b.length;h++){const v=b[h];if(v in this.tyf)return this.tyf[v]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const v={};v.featureArea=nE.yzl;h.telemetryGroup=v;h.appData=b;return h}}nE.Xmi="FA000000012";nE.queryPrefix="AssetID=";nE.yzl="SearchPane";Object(n.a)(nE,"BaseSerpletExecutor",null,[422,369]);
class ML extends nE{constructor(b,h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(Eb.a.BIb,2,null);break;case 1:this.ga.Qb(sc.a.YOb,2,null);break;case 2:this.ga.Qb(Eb.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb(Ua.a.cXd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb(Ua.a.FNb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(Ua.a.gkf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};LH(this.ib);this.ga.Qb(Ua.a.gkf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(Ua.a.findInDocument,2,h)}openNavigationPane(){this.ga.Qb(sc.a.Gjc,2,null)}openSerpletTaskPane(){this.ga.Qb(Ua.a.nti,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb(Ua.a.WWd,2,null)}getAllIcons(){const b=
{};for(const v of Object.keys(window))if(v.startsWith("word")){var h=window[v];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(D=>b[D.id]=JSON.stringify(D)))}return b}}Object(n.a)(ML,"WordSerpletExecutor",nE,[]);class NL extends GH{constructor(){super();this.tMe=null;this.Mx=()=>{w.AFrameworkApplication.Q_&&(this.Zql(),xp.a.$k().then(()=>this.tMe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){w.AFrameworkApplication.Q_&&(this.tMe.Na("WordEditor.Insights.WordInsightsActor").Tb(),
w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&w.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?w.AFrameworkApplication.K.Po(this.Mx):super.init())}xc(b){super.xc(b);this.tMe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new vh.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new AL(w.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new ML(w.AFrameworkApplication.va,Th.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new NF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new aw(new Fg.a(()=>Ya.App.xa?Ya.App.xa.hb.Uc:null),b.resolve("Box4.IParagraphReader"),
pL.a.instance,w.AFrameworkApplication.K,Up.a.instance,YM.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),w.AFrameworkApplication.va,Th.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new yL(new Fg.a(()=>Ya.App.xa?Ya.App.xa.hb.Uc:null),b.resolve("Box4.IParagraphReader"),Ob.InteractiveViewManager.instance,Th.a.instance,b.resolve("Box4.ISelectionFactory"),h,Ya.App.Tj.zl.Ye(12),new Fg.a(()=>Ya.App.xa.hb),$c.FocusManager.instance(),
w.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.Sa("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordInsightsManager",()=>new KL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();
b.ha("WordEditor.Insights.WordInsightsActor",()=>new BL(b.Ue("Common.App.Insights.IInsightsManager"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new zL(b.Sa("WordEditor.Extension.DocumentProperties"))).singleInstance()}}Object(n.a)(NL,"WordInsightsPackage",GH,[]);class hN{}Object(n.a)(hN,"ScalingStep",null,[]);class OL{constructor(b,
h,v){this.Ouc=!1;this.IP=null;this.HBc=this.RVb=!1;this.eYa=[];this.Nde=D=>{this.C$&&this.C$!==D&&appChrome.api.dispatch(this.mfi(!1))};h.execute(D=>{this.IP=D});b.Pw(Object(z.a)(this,this.Ssn,"onProcessSetSelectionFinished"));this.Ip=v}s8b(b,h,v){const D=[];for(const Q of b)D.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:Q},v));return D}Hdi(b){const h=[];for(let v=0;4>v;v++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>
v?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}mfi(b){const h=[];if(b)switch(this.C$){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.Hdi("PictureStyles"));h.push(...this.s8b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.eYa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.s8b(b,
"MoveToOverflow"));break;case "Table":this.HBc||h.push(...this.Hdi("TableStyles"));h.push(...this.s8b(this.eYa,"DropLabel",this.HBc?0:void 0));b=this.eYa.slice().reverse();h.push(...this.s8b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.s8b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.eYa.slice().reverse(),h.push(...this.s8b(b,"MoveToOverflow"))}else for(const v of this.eYa)h.push(appChrome.actions.removeControlScalingStepsFromTab(v,"Home"));return h}Cad(b){const h={};for(const v of b)try{h[v]=
appChrome.selectors.getModelType(v)}catch(D){this.EG("Error","GetModelType failed for "+v)}Ya.App.xa.XMd(h)}KRo(b){if(0!==b.length){var h=[],v={},D=!1;for(const Q of b)try{if(appChrome.selectors.isControlDefined(Q))v[Q]=appChrome.selectors.getModelType(Q);else{D=!0;break}}catch(ba){this.EG("Error","GetModelType failed for "+Q);D=!0;break}if(D)this.C$=void 0,this.gne(!1);else{if("Image"===this.C$&&!this.RVb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.RVb=!0;else if(this.RVb){h.push(appChrome.actions.updateGroupHiddenState("Font",
!1));D=appChrome.selectors.getVisibleControlsInGroup("Font");for(const Q of D)v[Q]=appChrome.selectors.getModelType(Q);this.RVb=!1}Ya.App.xa.XMd(v);this.eYa=b;v=[];for(const Q of b)appChrome.selectors.isControlDisabled(Q)&&v.push(Q);0<v.length&&this.EG("Disabled",v.join(","));0<this.eYa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.eYa)),h.push(...this.mfi(!0)),this.Ouc=!0);appChrome.api.dispatch(h)}}}gne(b){if(b||
this.Ouc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.Ouc=b;if("Image"===this.C$||this.RVb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const v=appChrome.selectors.getVisibleControlsInGroup("Font");this.Cad(v)}this.RVb=!b}appChrome.api.dispatch(h)}}XTa(){this.Ouc&&this.Ip&&this.Ip.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}Ssn(b,h){!w.AFrameworkApplication.ta.Nb.sjc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.IP&&h.nl&&h.nl.kb&&0!==h.nl.length?(b=()=>{let v=[],D=!1;var Q=this.IP.contentType,ba=appChrome.selectors.getActiveContextualTabIds();Q.includes("Image")?(this.Nde("Image"),this.C$&&"Image"===this.C$?D=!0:(v="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.C$="Image")):Q.includes("Table")&&0<=ba.indexOf("Table")?(Q=!(lr.a.instance.kb.DFa||lr.a.instance.kb.qw||
lr.a.instance.kb.$Hb),(ba="Table"===this.C$&&Q!==this.HBc)?this.Nde("TableCellEdit"):this.Nde("Table"),!this.C$||"Table"!==this.C$||ba?(Q?(v=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.HBc=!0):(v="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.HBc=!1),this.C$="Table"):D=!0):
Q.includes("Hyperlink")&&(this.Nde("Hyperlink"),this.C$&&"Hyperlink"===this.C$?D=!0:(v=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.C$="Hyperlink"));D?this.Ouc||(this.Cad(this.eYa),this.gne(!0),this.XTa()):0<v.length?(this.KRo(v),this.XTa()):this.gne(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.gne(!1)}EG(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new Ji.a;h.name="Events";
h.dataFields=dn.a.yC(b);h.durationMs=window.performance.now();fa.a.pHa(h,"TellMeWAC.")}}Object(n.a)(OL,"AdaptiveTabGroupUpdater",null,[]);class PL{constructor(){this.W=null;this.$jn=()=>{w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new OL(this.W.resolve("Box4.ISelectionManager"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}xc(b){this.W=b}init(){py.a(1,this.$jn)}dispose(){}}Object(n.a)(PL,"PackageManager",null,[1,2]);const iN=(b,h,v)=>1===v?32:2===v?(c.e(4).then(c.bind(null,2053)).then(D=>{D.createAndShowDevToolsMenu()}),32):2;class MH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))w.AFrameworkApplication.va.qa(sc.a.Ndg,Kd.a.frame,iN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(4).then(c.bind(null,2053))}dispose(){}xc(){}static main(){N.a.instance.Fc(new MH)}}Object(n.a)(MH,"WordDevToolsPackage",null,[1,2]);c(575);class NH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(n.a)(NH,"FormattingData",null,[]);class QL extends NH{constructor(){super();this.hyperlinkData=null}}Object(n.a)(QL,"RichContentCommandData",
NH,[]);class Oi{constructor(){Oi.Zi.add(sc.a.h7a);Oi.Zi.add(sc.a.tPb);Oi.Zi.add(sc.a.Akc);Oi.Zi.add(sc.a.mV);Oi.Zi.add(sc.a.HQf);Oi.Zi.add(sc.a.r_f);Oi.Zi.add(sc.a.deleteComment);Oi.Zi.add(sc.a.cJc);Oi.Zi.add(sc.a.hdf);Oi.Zi.add(sc.a.xie);Oi.Zi.add(sc.a.r7a);Oi.Zi.add(sc.a.Ndg);Oi.Zi.add(sc.a.YOb);Oi.Zi.add(sc.a.Udg);Oi.Zi.add(sc.a.aKc);Oi.Zi.add(sc.a.kJd);Oi.Zi.add(Eb.a.digitalPrintToSway);Oi.Zi.add(Eb.a.openInClient);Oi.Zi.add(Eb.a.print);Oi.Zi.add(Eb.a.vae);Oi.Zi.add(Eb.a.O1f);Oi.Zi.add(Eb.a.readingMode);
Oi.Zi.add(Eb.a.BIb);Oi.Zi.add(Ua.a.fzj);Oi.Zi.add(Ua.a.tellMe);Oi.Zi.add(Ua.a.V9c);Oi.Zi.add(Ua.a.FNb);Oi.Zi.add(Ua.a.giveFeedback);Oi.Zi.add(Ua.a.d8c);Oi.Zi.add(Ua.a.Gdg);Oi.Zi.add(Ua.a.Pog);Oi.Zi.add(Ua.a.i8);Oi.Zi.add(Ua.a.newComment);Oi.Zi.add(Ua.a.T7e);Oi.Zi.add(Ua.a.HQa);Oi.Zi.add(Ua.a.G6f);Oi.Zi.add(Ua.a.F6f);Oi.Zi.add(Ua.a.H6f);Oi.Zi.add(Ua.a.yId);Oi.Zi.add(Ua.a.Pla);Oi.Zi.add(Ua.a.Lie);Oi.Zi.add(Ua.a.grj);Oi.Zi.add(Ua.a.close);Oi.Zi.add(Ua.a.mbe);Oi.Zi.add(Ua.a.Cae);Oi.Zi.add(Ua.a.C8d);Oi.Zi.add(Ua.a.Gie);
Oi.Zi.add(Ua.a.Kie);Oi.Zi.add(Ua.a.HLb);Oi.Zi.add(Ua.a.renameFile);Oi.Zi.add(Ua.a.e$b);Oi.Zi.add(Ua.a.teg);Oi.Zi.add(Ua.a.Njc);Oi.Zi.add(Ua.a.downloadACopy);Oi.Zi.add(Ua.a.Thc);Oi.Zi.add(Ua.a.t$d);Oi.Zi.add(Ua.a.mMb);Oi.Zi.add(Ua.a.V4i);Oi.Zi.add(Ua.a.UEh);Oi.Zi.add(Ua.a.YDd);Oi.Zi.add(Ua.a.S7e);Oi.Zi.add(Ua.a.WEh);Oi.Zi.add(Ua.a.VEh);Oi.Zi.add(Ua.a.T7e);Oi.Zi.add(Ua.a.ZDd);Oi.Zi.add(sc.a.tpe);Oi.Zi.add(sc.a.Mpg);Oi.Zi.add(sc.a.zoomToPageWidth);Oi.Zi.add(sc.a.D9f);Oi.Zi.add(sc.a.fnb);Oi.Zi.add(sc.a.Fbe);
Oi.Zi.add(sc.a.Cja);Oi.Zi.add(Ua.a.Mib);Oi.Zi.add(Ua.a.sfb);Oi.Zi.add(Ua.a.Qjc);Oi.Zi.add(Ua.a.tLj);Oi.Zi.add(Ua.a.b5i);Oi.Zi.add(Eb.a.tLb);Oi.Zi.add(Eb.a.bia)}}Oi.Zi=new Set;Object(n.a)(Oi,"CommentRibbonCommands",null,[]);class RL{constructor(b,h,v,D,Q){this.DQi=b;this.Xh=h;this.Jo=v;this.lf=D;this.kIo=Q;this.tYb=null;this.Lza=new ec.a(0);this.zrb=new ec.a(0);this.Lte=new ec.a(0);this.aWe=!1;this.Axm();this.yWn()}DGm(b){return this.tYb&&this.Jo.oy?!Oi.Zi.has(b):!1}Y8b(b,h,v){if(b===Ua.a.Hg)return 32;
if(!this.Lza.nb(b)&&!this.zrb.nb(b)||!this.tYb)return 2;const D=this.zrb.nb(b);var Q=D?this.zrb.J(b):this.Lza.J(b);const ba=D?2:this.Lte.J(v);D||1!==ba||(this.aKm(Ya.App.xa.Dp.currentScope.name)||Ya.App.xa.Dp.mg(this.Xh.$m?gf.AFrame.Gr:gf.AFrame.rM),Ya.App.xa.updateCommandUI(!0));v=new QL;switch(Q){case 1:v.highlight={color:this.lei(h.Color)};break;case 6:v.fontColor={color:this.lei(h.Color)}}Q=this.tYb.executeCommand(Q,ba,v);2===Q&&D&&(b===Eb.a.mgc?h[Ff.a.On]=!!v.bold:b===Eb.a.sgc?h[Ff.a.On]=!!v.italic:
b===Eb.a.Cgc?h[Ff.a.On]=!!v.underline:b===Eb.a.wgc?h[Ff.a.On]=!!v.strikethrough:b===Eb.a.HY?h[Ff.a.On]=!!v.highlight:b===Eb.a.Sv&&(h[Ff.a.On]=!!v.fontColor));return 2===Q?32:1===Q?2:8}DTn(b){this.tYb=b;this.tYb.registerSelectionChangeHandler(()=>{this.aWe||(this.aWe=!0,Ya.App.xa.updateCommandUI(!0),this.aWe=!1)});this.tYb.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case zf.a.KRb:case zf.a.ORb:case zf.a.Xqe:case zf.a.HUa:Ya.App.xa.updateCommandUI(!0)}h.key!==zf.a.cC&&h.key!==zf.a.s1||Ya.App.xa.updateCommandUI(!0)})}yWn(){this.DQi.N8i(gf.AFrame.Gr,
this);this.DQi.N8i(gf.AFrame.rM,this)}Axm(){this.Lza.Z(Eb.a.bold,0);this.Lza.Z(Eb.a.setItalic,3);this.Lza.Z(Eb.a.strikethrough,4);this.Lza.Z(Eb.a.underline,5);this.Lza.Z(Eb.a.HY,1);this.Lza.Z(Eb.a.bua,1);this.Lza.Z(Eb.a.Sv,6);this.Lza.Z(Eb.a.Cfa,6);this.Lza.Z(Eb.a.lqa,6);this.zrb.Z(Eb.a.mgc,0);this.zrb.Z(Eb.a.sgc,3);this.zrb.Z(Eb.a.wgc,4);this.zrb.Z(Eb.a.Cgc,5);this.Lte.Z(1,0);this.Lte.Z(2,1)}aKm(b){return b===gf.AFrame.Gr||b===gf.AFrame.rM}lei(b){return b?Sl.a.VE(this.kIo.iua(this.lf.Yc,b)):""}}
Object(n.a)(RL,"CommentRibbonCommandHandler",null,[313,314]);class OH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").x2f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").D9("OnCommentRenderedOnce",()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}xc(b){this.W=
b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new RL(this.W.Na("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),Jd.App.un.hb.rc,Zh.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new Oi).singleInstance()}static main(){N.a.instance.Fc(new OH)}}Object(n.a)(OH,"PackageManager",null,[1,2]);var jN=c(1951);class SF{constructor(b,
h){this.vhl=2E3;this.fmh=null;this.MXf=b.n_i;this.maxLength=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.vhl);h&&h.execute(v=>{this.fmh=v})}Snf(b){b=this.jOl(b,this.maxLength);return{semantic:pe.ObjectSemantic.CanvasContext,type:pe.ObjectSchemaType.WordCanvasContext,value:b}}jOl(b,h){try{return this.iOl(b,h)}catch(v){return u.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",v),null}}obm(b,h){const v={b0a:[],
oxa:0,selection:{start:null,end:null},cursor:null,tiles:[]},D=b.length;for(let ba=0;ba<D;ba++){const ta=b.J(ba);var Q=ta.node;if(!de.ParagraphReader.Vb(Q)||Array.contains(v.b0a,Q.Al))continue;v.b0a.push(Q.Al);const Ta=de.ParagraphReader.textLength(Q);if(v.oxa+Ta>h)break;Q=this.MXf.ZAb(Q);v.tiles.push(Q);v.oxa+=Ta;1!==D||v.cursor||(v.cursor=SF.xSl(ta,v.tiles.length-1));null===v.selection.start&&0===ba&&(v.selection.start=this.BPc(ta,!0,v.tiles.length-1));null===v.selection.end&&ba===D-1&&(v.selection.end=
this.BPc(ta,!1,v.tiles.length-1))}return v}n3l(b,h,v){const D={h$c:[],Byj:[],oxa:0};var Q=b.J(0).node;let ba=b.J(b.length-1).node;for(b=h;0<b&&(Q||ba);){var ta=SF.z3i(Q,!0,b,v);if(Q=ta.node)Q=this.MXf.ZAb(Q),D.h$c.push(Q),b-=ta.oxa,Q=ta.node,v=ta.b0a;ta=SF.z3i(ba,!1,b,v);if(ba=ta.node)v=this.MXf.ZAb(ba),D.Byj.push(v),b-=ta.oxa,ba=ta.node,v=ta.b0a}D.oxa=h-b;return D}kOl(b,h){let v=0;var D=this.obm(b,h);const Q={tiles:D.tiles,selection:D.selection,cursor:D.cursor};v+=D.oxa;D=D.b0a;v<h&&(b=this.n3l(b,
h-v,D),Q.tiles.unshift.apply(Q.tiles,b.h$c),Q.tiles.push.apply(Q.tiles,b.Byj),Q.selection.start&&(Q.selection.start.index+=b.h$c.length),Q.selection.end&&(Q.selection.end.index+=b.h$c.length),Q.cursor&&(Q.cursor.index+=b.h$c.length));return Q}iOl(b,h){var v;if(!b)return null;b=this.kOl(b,h);return{contentType:null===(v=this.fmh)||void 0===v?void 0:v.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}BPc(b,h,v){if(b.contextId===Zb.a.Hd||b.contextId===Zb.a.paragraph||b.contextId===
Zb.a.Tc){if(h&&-1!==b.oj)return{index:v,offset:b.oj};if(!h&&-1!==b.Yo)return{index:v,offset:b.Yo}}return null}static xSl(b,h){return b.contextId===Zb.a.Tc?{index:h,offset:b.oj}:null}static z3i(b,h,v,D){D={node:null,oxa:0,b0a:D};if(!b||0>=v||!D.b0a)return D;do D.node=de.ParagraphReader.jg(b,h,!1,!1),D.oxa=D.node?de.ParagraphReader.textLength(D.node):0,b=D.node;while(D.node&&(Array.contains(D.b0a,D.node.Al)||!de.ParagraphReader.Vb(D.node)||!D.oxa));D.node&&(D.oxa>v?D.node=null:D.b0a.push(D.node.Al));
return D}}Object(n.a)(SF,"Box4CanvasContextProvider",null,[308]);class PH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}xc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new SF(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Sa("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){N.a.instance.Fc(new PH)}}Object(n.a)(PH,"Box4CanvasContextPackage",null,[1,2]);class SL{constructor(b,h){this.Xv={};this.F_b=
this.utd=0;this.LHd=3E4;this.start=()=>{0!=this.Eyb.size&&0===this.F_b&&(this.F_b=window.setInterval(this.p9n,this.LHd),u.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.p9n=()=>{if(0!=this.Eyb.size)if(this.$e.Ao)u.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var v=50;this.Xv.ScanTime=Date.now();this.Xv.NumWatchDogs=this.Eyb.size;this.Xv.WatchDogManagerScanNumber=++this.utd;this.Eyb.forEach(async(D,Q)=>{this.Xv[Q]=await D.zdn();D.uUm()||(v=15)});
u.ULS.sendTraceTag(520974674,306,v,JSON.stringify(this.Xv))}};this.$e=b;this.bXe=new Map;this.Eyb=new Map;h.execute(v=>{this.il=v;this.il.ZYa((D,Q)=>{this.IX(Q)})})}IX(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.F_b||(u.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),this.stop()):(this.stop(),this.start(),this.x5n(),u.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,
b.newState))}stop(){0!==this.F_b&&(window.clearInterval(this.F_b),this.F_b=0);u.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}zuk(b,h){this.bXe.set(b,h)}$5n(){this.REn(this.bXe)}get NAk(){return this.bXe.size===this.Eyb.size}REn(b){b.forEach((h,v)=>{h.execute(D=>{D?(this.Eyb.set(v,D),this.start()):u.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",v)})})}x5n(){this.Eyb.forEach(b=>{b&&b.O5a()});u.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}}Object(n.a)(SL,"WatchDogManager",
null,[26]);class QH{constructor(){this.W=this.Dyb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.Dyb=this.W.resolve(this.name);this.Bzm()}dispose(){this.Dyb&&this.Dyb.stop()}xc(b){this.W=b;b.ha(this.name,this.Eel.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance()}static main(){N.a.instance.Fc(new QH)}gJj(){if(!this.Dyb.NAk){const b=[];let h=0;this.ptd.forEach((v,D)=>{v&&(this.W.Na(D)||(b[h++]=D))});if(0<b.length)if(this.oro){const v=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").fR;
u.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,v)}else u.ULS.sendTraceTag(512550819,306,10,"{0} did not resolve",b)}}Eel(){return new SL(this.W.resolve("Common.ISessionStatus")||ac.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}rvk(){if(this.jto)window.setTimeout(this.gJj.bind(this),this.e2o);else{const b=new of.a(1,1,12E4,this.gJj.bind(this),216);w.AFrameworkApplication.pc.Wb(b)}}yvk(){this.ptd=new Map;this.ptd.set("WordEditor.RunawayDataLossMonitorWatchDog",
Ya.App.vm||Ya.App.hs);this.ptd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",!0)}Bzm(){this.yvk();this.xvk(this.ptd,this.Dyb.zuk.bind(this.Dyb));this.Dyb.$5n();this.rvk()}xvk(b,h){b.forEach((v,D)=>{v&&h(D,this.W.Sa(D))})}get jto(){return null!=this.hGg?this.hGg:this.hGg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToJSSchedulingForWatchdogEnabled",!1)}get e2o(){return null!=this.XJg?this.XJg:this.XJg=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",
3E5)}get oro(){return null!=this.fGg?this.fGg:this.fGg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LogDataLossForWatchDogEnabled",!1)}}Object(n.a)(QH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");
Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");
Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");P.main();Type.registerNamespace("Common.App.WopiIdentity");qa.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Db.main();Object(jN.a)(!1);rb.main();Sa.main();Ab.main();MH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");ad.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Dg.main();Type.registerNamespace("Common.App.WildFire");xd.main();Type.registerNamespace("Common.App.BrowserInfoLogger");oe.main();Type.registerNamespace("Common.App.HostNotification");Xc.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");wh.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");nd.main();Type.registerNamespace("CNT");sm.main();Type.registerNamespace("Common.App.NewAndOpen.Core");N.a.instance.Fc(new Fm);Type.registerNamespace("Common.App.NewAndOpen.UX");N.a.instance.Fc(new sh);Type.registerNamespace("Common.App.OneDriveFilePickerApi");gi.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");fe.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");mm.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");oc.main();Type.registerNamespace("CADWLTR");Mc.main();Type.registerNamespace("Common.App.DirectPrint");N.a.instance.Fc(new fj);Type.registerNamespace("Common.App.SearchOAuthManager");Lg.main();Gk.main();Ml.main();Bn.main();Cn.main();Wi.main();N.a.instance.Fc(new uf);Rf.main();cd.main();Hj.main();
N.a.instance.Fc(new ld);Type.registerNamespace("Common.App.SaveStatus");N.a.instance.Fc(new kq);Type.registerNamespace("Common.App.EventsCacheManager");no.main();Type.registerNamespace("CUIB");Og.main();Type.registerNamespace("CommandUI.TaskPane");try{N.a.instance.Fc(new ed(Ya.App.xa.hb))}catch(b){u.ULS.shipAssertTag(575930383,3016,!1,b.message)}Zm.main();Type.registerNamespace("Common.App.Insights");Ij;N.a.instance.Fc(new mp);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");aj("Begin");N.a.instance.Fc(new Xw);try{N.a.instance.Fc(new bq(rj.a.get_instance(),Ya.App.xa.hb,Ya.App.xa.Nb))}catch(b){u.ULS.shipAssertTag(575930384,3016,!1,b.message)}Qa.main();N.a.instance.Fc(new vd);Bo.main();yn.main();Jn.main();iw.main();Zw.main();Yt.main();zz.main();Et.main();N.a.instance.Fc(new yw);Ft.main();Jy.main();Hv.main();
Ny.main();PH.main();OH.main();N.a.instance.Fc(new Ez);N.a.instance.Fc(new Tf);Qy.main();EA.main();lu.main();N.a.instance.Fc(new PB);N.a.instance.Fc(new el);gy;Nw.main();ia.main();xc.main();qr.main();Js;N.a.instance.Fc(new Jc);N.a.instance.Fc(new Wd);Eg.main();ZA.main();pE.main();N.a.instance.Fc(new eF);N.a.instance.Fc(new lF);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=qy;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");SD.main();vE.main();wE.main();$C;cH.main();sM;window.MSOJS=ED;yH.main();BH.main();N.a.instance.Fc(new NL);N.a.instance.Fc(new PL);(async()=>{w.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(26).then(c.bind(null,2062)).then(b=>{b.initializeOnDemandPackage()})})();QH.main();eo.main()},2071:function(E,K,c){E=c(0);var l=c(7),f=c(1607);class a{static get lan(){return 50}static cRd(x){if(""===x)return"";let y=0,n="";try{const u=f.a.bEb(x);
for(const z of u.ops)if(a.CG(z))y||(n+=a.fWl(z.attributes.atmention.fullName)),y+=1;else{const w=z.insert?z.insert:"";" "!==w&&0<w.length&&(y=0,n+=w)}}catch(u){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return n}static iQl(x){x=a.cRd(x);return 0<x.length&&x.split(" ").length<=a.lan?x:null}static fWl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static CG(x){return!!x.attributes&&!!x.attributes.atmention}}
Object(E.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(K,"a",function(){return k});class k extends a{constructor(){super()}static QDb(x,y,n=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Df||""===y.Df;return 0<x.length&&y&&!n?a.iQl(x):null}}Object(E.a)(k,"CommentSmartReplyHelpers",a,[])},948:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.method=this.api=0}}Object(E.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19660862/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll1.js.map