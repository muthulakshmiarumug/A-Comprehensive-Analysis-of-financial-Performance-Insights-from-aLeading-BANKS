/*! For license information please see odcwachostwebpack.js.LICENSE.txt */
(function(e){function t(t){for(var r,i,s=t[0],o=t[1],u=t[2],a=0,f=[];a<s.length;a++){i=s[a];Object.prototype.hasOwnProperty.call(c,i)&&c[i]&&f.push(c[i][0]);c[i]=0}for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);b&&b(t);for(;f.length;)f.shift()();h.push.apply(h,u||[]);return n()}function n(){for(var e,t=0;t<h.length;t++){for(var n=h[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==c[s]&&(r=!1)}if(r){h.splice(t--,1);e=p(p.s=n[0])}}return e}var r=window,i=r.require;function s(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var o=document.currentScript,u=s(o&&o.src||i&&i.toUrl("")),a=s(r.__backupBaseUrl),f=i&&i.s.contexts._,l={},c={odcwachostwebpack:0},h=[];function p(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};e[t].call(n.exports,n,n.exports,p);n.l=!0;return n.exports}var d=[[34],[],[29],[3,"ondemand.resx-ondemand"],[52,"ondemand.resx-ondemand"]];p.ee=function(e,t,n){return Promise.all((Array.isArray(e)?e:d[e]).map(function(e){return p.e(e)})).then(n?p.t.bind(0,t,n):p.bind(0,t))};p.e=function(e){var t=f&&f.config.paths[e]&&f.nameToUrl(e)||(function(e){return p.p+""+e+".js"})(e);function n(e){var n=[],i=c[e];if(0!==i)if(i)n.push(i[2]);else{var s=new Promise(function(t,n){i=c[e]=[t,n]});n.push(i[2]=s);var o,u=document.createElement("script");u.charset="utf-8";u.timeout=120;p.nc&&u.setAttribute("nonce",p.nc);u.src=t;0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var a=new Error;o=function(t){u.onerror=u.onload=null;clearTimeout(f);var n=c[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+i+")";a.name="ChunkLoadError";a.type=r;a.request=i;n[1](a)}c[e]=void 0}};var f=setTimeout(function(){o({type:"timeout",target:u})},12e4);u.onerror=u.onload=o;var l=r.__odspSriHashes;if(l){var h=l[r.__odsp_culture+"/"+e]||l[e];h&&(u.integrity=h)}document.head.appendChild(u)}return Promise.all(n)}return n(e).catch(function(i){var s=r.__integrityViolationCallBack;s&&s(i.request);var o=a&&t.replace(u,a);if(o&&o!==t){t=o;return n(e)}return Promise.reject(i)})};p.m=e;p.c=l;p.d=function(e,t,n){p.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})};p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:!0})};p.t=function(e,t){1&t&&(e=p(e));if(8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);p.r(n);Object.defineProperty(n,"default",{enumerable:!0,value:e});if(2&t&&"string"!=typeof e)for(var r in e)p.d(n,r,function(t){return e[t]}.bind(null,r));return n};p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};p.d(t,"a",t);return t};p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};p.p="/";p.oe=function(e){console.error(e);throw e};var v=p.p;Object.defineProperty(p,"p",{get:function(){if(window.require&&window.require.toUrl){var e=window.require.toUrl("");v=("/"!==e.slice(-1)?e+"/":e)+"odcwachostwebpack.manifest/"}return v}});var m=window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[],g=m.push.bind(m);m.push=t;m=m.slice();for(var y=0;y<m.length;y++)t(m[y]);var b=g;h.push([431,"plt.resx-plt","plt.react","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"]);n()})(Array(0).concat([function(e,t,n){"use strict";n.d(t,"r",function(){return i});n.d(t,"e",function(){return s});n.d(t,"s",function(){return o});n.d(t,"n",function(){return u});n.d(t,"t",function(){return a});n.d(t,"i",function(){return f});n.d(t,"o",function(){return l});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function u(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function a(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})}function f(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}}Object.create;function l(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)if(r||!(i in t)){r||(r=Array.prototype.slice.call(t,0,i));r[i]=t[i]}return e.concat(r||Array.prototype.slice.call(t))}Object.create},,function(e,t,n){"use strict";n.d(t,"ne",function(){return f});n.d(t,"e",function(){return c});n.d(t,"r",function(){return h});n.d(t,"s",function(){return p});n.d(t,"a",function(){return d});n.d(t,"d",function(){return v});n.d(t,"m",function(){return m});n.d(t,"w",function(){return y});n.d(t,"N",function(){return b});n.d(t,"k",function(){return E});n.d(t,"C",function(){return S});n.d(t,"o",function(){return x});n.d(t,"O",function(){return T});n.d(t,"_",function(){return N});n.d(t,"P",function(){return C});n.d(t,"H",function(){return k});n.d(t,"M",function(){return L});n.d(t,"B",function(){return A});n.d(t,"j",function(){return O});n.d(t,"F",function(){return M});n.d(t,"I",function(){return _});n.d(t,"q",function(){return D});n.d(t,"U",function(){return P});n.d(t,"R",function(){return H});n.d(t,"D",function(){return B});n.d(t,"z",function(){return j});n.d(t,"W",function(){return F});n.d(t,"V",function(){return I});n.d(t,"ee",function(){return q});n.d(t,"Z",function(){return R});n.d(t,"J",function(){return U});n.d(t,"Q",function(){return z});n.d(t,"Y",function(){return W});n.d(t,"G",function(){return X});n.d(t,"L",function(){return V});n.d(t,"A",function(){return $});n.d(t,"n",function(){return J});n.d(t,"h",function(){return K});n.d(t,"S",function(){return Q});n.d(t,"x",function(){return G});n.d(t,"T",function(){return Y});n.d(t,"t",function(){return Z});n.d(t,"g",function(){return ee});n.d(t,"E",function(){return te});n.d(t,"v",function(){return ne});n.d(t,"$",function(){return re});n.d(t,"i",function(){return ie});n.d(t,"K",function(){return se});n.d(t,"f",function(){return oe});n.d(t,"X",function(){return ue});n.d(t,"p",function(){return ae});n.d(t,"y",function(){return fe});n.d(t,"c",function(){return le});n.d(t,"l",function(){return ce});n.d(t,"b",function(){return he});n.d(t,"u",function(){return de});n.d(t,"ie",function(){return ge});n.d(t,"te",function(){return we});var r=n(112),i=n(356),s=n(6),o=n(247),u=n(28);n.d(t,"re",function(){return u.n});var a=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,f=window.Flight&&"odclightspeedwebpack"===window.Flight.manifest,l=o.e,c={ODC:"AddTelemetryHeaders"},h=(s.e.isActivated("BF7BE655-7F9F-40C8-920B-C4088F784512","05/05/2022","Prefer cookie API calls using proxy in File Picker"),{ODB:1371}),p=(u.n,s.e.isActivated("95195f4e-8936-409f-bc5e-d98fad1cef73","08/18/2021","KillSwitch for consuming exposed Default click control handler in OneDriveItemsScopeApp"),{ODC:"DisableDomainLowering"}),d={ODB:1114},v=(s.e.isActivated("93C317DF-466B-47B2-96C0-2E9BB53EB3D3","05/05/2022","Use river flow in Tiles List media group"),!a&&u.i,s.e.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event."),{ODC:!u.r&&"UseItemsScopeInRecent",ODB:1191}),m=(!!u.r&&s.e.isActivated("70C000B4-CC40-4BC4-99BF-77B1C9D91115","08/01/2022","Disable photos pivot in winApp"),s.e.isActivated("728AC795-2069-44D4-B387-4B82D9E1D930","06/29/2022","Use layer projection for Sites in ODB"),s.e.isActivated("C7DDA4BE-D28B-4151-A22F-0BD7727B012D","1/26/2022","Use cross-site File Browser for Sites in ODB"),s.e.isActivated("0f4230b0-8301-4560-aac8-39a4782d0e1f","01/10/2022","Time-to-File Metrics for File Browsing"),{ODB:-1065}),g=(u.n,{ODB:!u.r&&1177}),y=(u.r,{ODB:-990,ODC:"ForceEnableAria"}),b=(u.n,s.e.isActivated("3dac8e1f-9e31-454a-a297-e150a263791b","11/16/2021","Enable ItemsScope AutoAction."),s.e.isActivated("482DE0D2-5BC9-4258-8129-745BEA91C66D","10/21/2021","Enable ItemsScope AutoAction"),s.e.isActivated("482DE0D2-5BC9-4258-8129-745BEA91C66D","10/21/2021","Enable ItemsScope AutoAction"),!u.r&&s.e.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated."),u.r,s.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),{ODB:!!a&&-1520}),w=(u.r,void 0===n.p),E=(u.n&&!a&&!u.r||!u.n&&w&&s.e.isActivated("608E1D31-70F0-4B48-9EC3-CDCC41EA17E2","8/30/2021","Refresh the page in a SPList when closing previewer when the user is using AMD."),s.e.isActivated("9ACCAC8B-D74D-43A2-98AA-457EADAF074D","11/5/2021","Initialze logging with OAuth support"),s.e.isActivated("F7A1F6FE-3272-4B0E-AD26-70E8322C5D8F","09/15/2022","Ensure components use getDriveQuotaKey method to get the key"),s.e.isActivated("72B58EAF-775A-4B01-BFF4-A083818DDF86","05/05/2022","Use on-demand implementation for DefaultClickAction"),{ODB:60393}),S=(u.r,{ODB:90007}),x=(l.ODB,u.n,{ODC:!s.e.isActivated("0DEAC9E8-4230-49B1-869A-55EE7D4256FC","10/22/2021","Disable silent auth frame in ODC itemsscope for anonymous users")}),T={ODC:"UseItemsScopeInAlbums"},N={ODC:"UseItemsScopeInAllPhotosEnableIE"},C={ODC:"UseItemsScopeInAllPhotosEnableMobile"},k={ODC:"UseItemsScopeInAllPhotosEnableSafari"},L={ODC:"UseItemsScopeInAllPhotos"},A={ODC:"UseItemsScopeInAllTags"},O={ODC:u.r?"EnableLightspeedInOneDriveWinApp":"UseItemsScope",ODB:!u.r||1413},M={ODC:"UseItemsScopeInPlaces"},_={ODB:!0,ODC:!u.r&&"UseItemsScopeInShared"},D={ODC:"UseItemsScopeInSingleAlbum"},P={ODC:"UseItemsScopeInSingleTag"},H={ODC:"UseItemsScopeInSinglePlace"},B={ODC:"UseItemsScopeInAllPhotosEnableInFilePicker"},j={ODB:!u.r},F={ODB:851},I={ODC:"UseNewShareDialogForWinApp"},q={ODB:!0,ODC:"WACHostMoveToFolder"},R={ODB:!0,ODC:"WACHostCommonFilePicker"},U={ODB:894,ODC:"UseOneUpTextEditor",OneDrive:!0},z=(u.r,u.n,{ODC:"UseVroomInItemsScopeAllPhotos"}),W={ODC:"UseVroomInItemsScopeSingleTag"},X={ODC:"UseVroomInItemsScopeSinglePlace"},V={ODC:"UpdateOdcPhotoApiForConvergence"},$={ODC:"UpdateOdcVaultApiForConvergence"},J={ODC:"ApplyItemsScopeToRecycleBin"},K={ODB:u.n?453:-453,ODC:"EnableFloodgate"},Q={ODC:"NPSCampaignDogfood"},G={ODC:"NPSCampaignForceNomination"},Y={ODC:"NPSSuiteSurvey"},Z={ODC:"AllPhotosFpsCampaign"},ee={ODB:60101,ODC:"FPSMoveCopy"},te={ODC:"NLQSSurvey"},ne=(s.e.isActivated("65FF4CD5-ED32-43CD-B171-29E55A13704A","03/30/2023","Always use MondoPrefetch"),s.e.isActivated("a22e84e5-8586-40bd-8095-9c90ab3fad2b","12/08/2020","Use the new tile design in the more shared libraries page"),{ODC:"EnableSearchInFilePickerHosts",ODB:1128}),re=(s.e.isActivated("0DC77B68-0CAB-4063-B386-57EFD9F26BF1","10/12/2022","Store viewParams in subEntityId"),{ODB:!!a&&60491,ODC:!1}),ie=(s.e.isActivated("74355188-3458-42A4-9DB6-5666BA79B5EB","03/02/2022","Moves transition resources to the KnockoutResourceScope as a preparation for OnDemand Knockout"),{ODB:60472});u.n,s.e.isActivated("f8821413-7078-41bf-b2f4-f23a04fb160a","05/11/2021","Log error in PrefetchListData method"),s.e.isActivated("be72c753-c1ba-4ab0-ad2a-8b72581fe3a0","05/30/2021","Remove fixed height from suite nav at 400% zoom");var se={ODB:!1,ODC:"UseTokenCacheForOAuth",OneDrive:!1},oe={ODC:"EnableCooldownAfterAuthFlow"},ue={ODC:"UseNewShareDialog"},ae={ODC:"EnableMsaOauthErrorRedirect"},fe={ODC:"FamilySharing"},le=(s.e.isActivated("4149C961-3AC9-4275-B8FD-F9FD97843F5A","01/06/2023","Enable cookie refresh in Teams File Browser"),s.e.isActivated("CC7D2937-5E6E-4604-AAC5-E5A8DD34BFFB","11/08/2022","Flush telemetry before notifying Picker host"),{Fallback:!s.e.isActivated("2A89B57A-0069-4F50-AAD5-3B931C8EF512","03/08/2023","Enable open on drag-hover")}),ce={Fallback:!s.e.isActivated("00783027-B2E9-4B88-82FB-C2921BF253B2","03/18/2023","Enable Drag/Drop copy")},he=(s.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),s.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),{ODC:"FixRumOneScenarioIdForOneUp"}),pe=(s.e.isActivated("60FAB98B-2A5D-4153-B69A-46A9C7C4B6D7","11/17/2021","Use SelectionHelper to get the current item"),s.e.isActivated("CCA9C934-1E36-4308-B93D-0025EAAECC37","11/17/2021","Use SelectionHelper to get the current item in AddToAlbumExecutor"),s.e.isActivated("EB5778E9-2AB1-4A93-AED8-64615D06F8D6","03/01/2022","Show notification banner in Lightspeed"),s.e.isActivated("71881921-E770-4A04-A8CD-CA451918151D","12/14/2022","Make upsell related API calls in prefetch"),[F]),de={ODB:60674},ve=function(){var e,t,n,r,i=(e=navigator.userAgent,t=e.substring(e.indexOf("OneDriveWinApp")),n=t&&t.split("/"),{winappMajorVersion:(r=u.r&&(n.length>1?n[1].split("."):t))?parseInt(r[0],10):"-1",winappMinorVersion:r?parseInt(r[1],10):"-1",winappPatchVersion:r?parseInt(r[2],10):"-1"}),s=i.winappMajorVersion,o=i.winappMinorVersion;return!(s<19||19===s&&(o<23||23===o&&i.winappPatchVersion<7))},me=u.s&&u.s.IsIEDisabledForItemsScope,ge=function(e){return s.e.isActivated("ff60da5f-a9ea-432e-9d7b-d58b8f7519ba","2/19/2021","ServiceConfigSettingKillSwitch")?1===Number(ye(e)):1===Number(ye(e))||"true"===ye(e)},ye=function(e){if(u.s&&u.s.farmSettings)return u.s.farmSettings[e]},be=function(e){return e.serviceSetting?ge(e.serviceSetting):(!me||e!==F)&&(i.e.isFeatureEnabled(e)||(function(e){if(pe.some(function(t){return!(t.ODB&&t.ODB!==e.ODB||t.ODC&&t.ODC!==e.ODC)})){var t=window.location.search;t&&"?"===t.charAt(0)&&(t=t.substr(1));var n=r.e(t),i=n&&n.TryNewFeature;return"true"===i||"1"===i}return!1})(e))},we=u.r?function(e){if(!ve())return!1;switch(e){case j:case g:return be(e={ODB:1211});case I:return be(e={ODC:"UseNewShareDialogForWinApp"});default:return be(e)}}:be},,,function(e,t,n){"use strict";n.d(t,"j",function(){return o});n.d(t,"B",function(){return u});n.d(t,"H",function(){return a});n.d(t,"W",function(){return f});n.d(t,"y",function(){return l});n.d(t,"I",function(){return c});n.d(t,"F",function(){return h});n.d(t,"O",function(){return p});n.d(t,"M",function(){return d});n.d(t,"A",function(){return v});n.d(t,"p",function(){return m});n.d(t,"t",function(){return g});n.d(t,"$",function(){return y});n.d(t,"S",function(){return b});n.d(t,"x",function(){return w});n.d(t,"L",function(){return E});n.d(t,"P",function(){return S});n.d(t,"z",function(){return x});n.d(t,"s",function(){return T});n.d(t,"D",function(){return N});n.d(t,"a",function(){return C});n.d(t,"m",function(){return k});n.d(t,"C",function(){return L});n.d(t,"N",function(){return A});n.d(t,"k",function(){return O});n.d(t,"R",function(){return M});n.d(t,"w",function(){return _});n.d(t,"b",function(){return D});n.d(t,"d",function(){return P});n.d(t,"q",function(){return H});n.d(t,"K",function(){return B});n.d(t,"n",function(){return j});n.d(t,"Z",function(){return F});n.d(t,"E",function(){return I});n.d(t,"te",function(){return q});n.d(t,"h",function(){return R});n.d(t,"v",function(){return U});n.d(t,"o",function(){return z});n.d(t,"u",function(){return W});n.d(t,"i",function(){return X});n.d(t,"f",function(){return V});n.d(t,"g",function(){return $});n.d(t,"c",function(){return J});n.d(t,"T",function(){return K});var r=n(6),i=n(2);n.d(t,"e",function(){return i.n});n.d(t,"r",function(){return i.a});n.d(t,"l",function(){return i.h});n.d(t,"_",function(){return i.N});n.d(t,"U",function(){return i.k});n.d(t,"X",function(){return i.L});n.d(t,"V",function(){return i.A});n.d(t,"J",function(){return i.j});n.d(t,"Q",function(){return i.X});n.d(t,"G",function(){return i.V});n.d(t,"Y",function(){return i.J});n.d(t,"ee",function(){return i.Q});n.d(t,"ne",function(){return i.te});n(320);var s=window._spPageContextInfo,o={Fallback:!0},u={},a={ODC:"ODCRequestAccess"},f={ODC:!0},l={ODB:833,ODC:"EnableTeachingBubbles"},c={ODC:"PhotosSearchBubble"},h={ODC:"OneRmO365UpsellEnabled"},p=(i.re,{ODC:"EnableAtMentionTeachingUIAA"}),d={ODC:"EnableAtMentionTeachingUIAB"},v={ODC:"EnableAtMentionTeachingUI"},m={ODC:!0,ODB:!1},g={ODC:"AttachGroupIdToSharedByKey"},y={ODC:"UseFluidDevPreview"},b={ODC:"FamilySharing"},w={ODC:"FamilySharingWacKS"},E={ODC:"ManageAccessRevampConsumer"},S={ODC:"ODCHideNonPremiumLinkFeatures"},x={ODC:"SharingTooltipCalloutKS"},T={ODC:"Enable3SonWacWord"},N={ODC:"ODCFacepileFeature"},C=(i.re||s.listBaseTemplate,r.e.isActivated("63D3DE85-2D59-4622-8BD4-CEEC395F89D6","10/21/2021","Enable anonymous report concern command"),{ODC:"EnableEnhancedMobileUpsell"}),k={ODC:"EnableSecurityMomentLightbox"},L=(r.e.isActivated("b8c885e0-1292-4bba-a624-d365f85bf140","05/27/2021","Show the new create shared library UI in ODB"),r.e.isActivated("5b1beb70-aac8-4da3-a4e2-151c7e55cd53","Fallback to global canManageLinks logic"),{ODB:1142}),A={ODB:1052},O={ODB:1227},M={ODB:772},_={ODC:"EnableVroomEmailSettings"},D={ODC:"EnableVroomDocFormatSettings"},P={ODC:"EnablePhotoStream"},H={ODC:"ReadOnlyItemsStore",ODB:-17},B={ODB:1417},j=(r.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view"),{ODC:"DisablePremiumUserFactUpdate"}),F={ODC:"UsePagingTokenForSearch"},I={ODB:!0,ODC:"EnableZipFilePreviewing",OneDrive:!0},q={ODB:817,ODC:!0,OneDrive:!0},R=(r.e.isActivated("cce0d731-4a47-460e-b5d5-c31fdf4d347a","9/11/2020","Pass through clientId to hosted OneUp WAC app"),r.e.isActivated("53c310fe-1add-42fe-9e42-26b35764ed1a","12/14/2020","Pass through docClickTime to hosted OneUp WAC app"),r.e.isActivated("bcc0651f-a0de-430b-8435-1afc9875b682","08/03/2021","Pass through uih to hosted OneUp WAC app"),r.e.isActivated("731D9A2D-7DDD-4DE8-98D1-D454F59246E7","05/30/2022","Pass through EmbeddingPageSessionInfo and EmbeddingPageOrigin to hosted OneUp WAC app"),r.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),r.e.isActivated("f50a33e2-f57e-4b97-a36d-d6a3be9e5240","02/09/2021","Add forced new token while trying to get token"),r.e.isActivated("97048ac2-781a-4ee8-8f5d-46995f622c82","05/24/2021","Use GraphDatasource to get and refresh driveAccessToken"),r.e.isActivated("d6cee8cb-7162-4dee-a43b-63adeeb1971d","01/27/2021","Sets a query param (correlationId) which can help debug client errors using service logs"),r.e.isActivated("eae1b7c5-a0b3-43b0-839c-30cfbc2e5a9d","4/12/2021","Add sending of playbackSessionId and content category as qsp"),r.e.isActivated("276f3e59-6a18-4296-b221-d9fbe60eca97","2/9/2021","Use a window.fetch  request to check for cors errors"),r.e.isActivated("71913f76-47d4-4293-a492-2205b7c1e655","3/18/2021","Enable sending of heartbeat telemetry"),r.e.isActivated("bdfc077e-7152-4772-874e-1936725cde1f","3/24/2021","Enable max retries check on RequestManager in Dashling."),r.e.isActivated("9d46a6f9-9676-41ed-a4b5-3c01c1080993","3/1/2021","Use the height specified in the adaptation set as the resolution, rather than parsing it from the resolutionId"),r.e.isActivated("d4be6831-a0f7-40f7-b77b-5ad215b528c9","8/19/2020","Control if video dashling telemetry is enabled"),r.e.isActivated("20f62141-0df7-4eb3-943c-ff45219c1ee1","8/19/2020","Control if video dashling decryptor v2 is disabled"),r.e.isActivated("f6b9287b-5835-460b-8651-ae3b92ec34ce","9/14/2020","Control if video dashling supports parallel key call"),r.e.isActivated("336583dd-00a6-40dd-beea-2f2068fb2f0c","8/19/2020","Control if video dashling cdn ref ids telemetry is enabled"),r.e.isActivated("c56be611-10e0-4cde-8a46-1244a42f47b3","9/28/2020","Control if video dashling telemetry info is enabled"),r.e.isActivated("b8133a0d-36a6-4a4d-ba26-fb4563484d41","11/11/2020","Control if video refresh token is enabled"),r.e.isActivated("22f8bf4b-d19c-4c1f-a5a7-cb2fd36c8d6c","10/05/2020","Control if force Meta params are enabled"),r.e.isActivated("351ee0af-7950-49cf-a8f7-2fa77e44fb97","11/05/2020","Control if smart playback is enabled"),r.e.isActivated("45a43ec1-f520-41e6-9f94-4d14af7ccf6d","9/30/2020","Control if video dashling optimizations are enabled"),r.e.isActivated("411555f8-233c-4f56-97f4-586835b5e130","04/03/2021","Retry video metadata call with the access token provided in the playback URLs"),r.e.isActivated("cc74fd4e-2d38-4443-a603-78c3c5024447","09/01/2020","Call MeTa to verify captions exist before showing UI toggle"),r.e.isActivated("c1063c7b-5a82-4f68-84ca-3920d6541988","2/11/2021","Controls teams meeting recordings fallback to ffmpeg when media foundation unsuccessful"),r.e.isActivated("0f853474-6c72-4456-ac06-ed2da32c4d44","3/9/2021","Identify OneUpPlayer to MeTA transcode service"),r.e.isActivated("174C413E-7F06-49B2-AFBE-D1C3E6972EBA","11/24/2021","Disable SK compliance video block for ODC"),r.e.isActivated("dbecc8cc-2bf6-4a33-bedf-9f71faa71fdf","1/5/2021","Controls DASH playback on Safari"),r.e.isActivated("ce53700c-4498-49ef-b738-21131fdc2551","5/30/2021","Enable pretranscode support"),r.e.isActivated("398DDB43-D6A8-4060-8F69-378A0AEF845A","03/25/2022","Display request access button when no permission (403)"),r.e.isActivated("d047b4a4-477a-4da6-b18c-1eb7daf19cc8","11/03/2021","Add request access button to OneUp curtain"),{ODC:"EnableLivePhotoVideos"}),U={ODC:"EnableSamsungMotionPhotoVideos"},z=(r.e.isActivated("0b6f3eb5-90ef-4e77-81d9-2286c06c3257","07/20/2021","Engagement Telemetry Enhancement for 1up according to ask from OnePlayer"),r.e.isActivated("ca5833b4-d7d9-406d-8e36-fc28548b52a2","10/21/2020","Update video autoplay behavior"),{ODC:"EnableEditControlTeachingBubble"}),W={ODB:!r.e.isActivated("9ffb3b8b-fbfe-4c66-bd3a-34f3451d6037","02/06/2023","Killswitch to enable teaching bubble for PDF editing")},X={ODB:!r.e.isActivated("260364a3-3855-4555-95ad-fc012bfe8d0c","01/06/2022","Enable ER Bug fixes for Universal Annotations"),ODC:!1,OneDrive:!1,Fallback:!1},V=(r.e.isActivated("bd34a99e-6762-42ac-9795-c2123340281b","11/17/2021","Enable FFMPEG transcoding for all HLS sessions"),r.e.isActivated("ac5fc96a-ba27-41c2-8211-39a2d12bd2b0","2/17/2022","When the browser is Safari, force the video files to play using native player"),r.e.isActivated("1ba50e39-1615-4340-82c7-765408f11243","4/27/2022","When progressive playback is used, add cross origin anonymous to the video element"),{ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1}),$=(r.e.isActivated("F6679A55-17E3-4F3B-BECF-7B969EB307C2","02/08/2022","Check if the teams meeting recording has an expiration date."),r.e.isActivated("0c7f0abb-bacf-45f2-814d-61bb1e84f2f5","8/1/2021","move target up to solve keybinding issues"),r.e.isActivated("2a642dc2-93e1-41f8-b6e1-d7c4c9acecd2","09/08/2022","View button for opening uploaded video in SWA in new tab"),r.e.isActivated("3cf3efe2-3050-4c01-8597-317ed1e0acc2","28/08/2022","Open button for opening moved/copied video in SWA in new tab"),r.e.isActivated("b2895e2b-5ca4-448b-955c-38d728d7e7b2","23/12/2022","Do not show links in SWA upload popup and panel for destination directories"),r.e.isActivated("4678edfd-5753-410d-a418-5ce8e9368075","10/03/2022","Refactoring code for open button showing after moved/copied video in SWA"),r.e.isActivated("f2e15bcb-b2af-40ee-90fa-4d0e27ac3b99","09/13/2022","Opening Video Settings automatically after opening uploaded video"),r.e.isActivated("461e4739-e857-4d71-88da-805c7c90b75e","10/06/2022","Having only one item in new menu dropdown if other is turned off"),r.e.isActivated("D095D1B3-A17F-441B-8855-D465ED3CA91F","12/15/2021",""),{ODB:!r.e.isActivated("483a92b4-201c-4b8c-b657-3fe2ce288672","4/22/2022","Show teaching bubble for TMR files consistently before user closes it."),ODC:!1,OneDrive:!1,Fallback:!1}),J=(r.e.isActivated("a6183b15-1c4c-4fe0-b52c-b263235d6c3d","5/11/2022","Use UTC time zone for TMR"),r.e.isActivated("744d1129-5df2-4930-b056-7bc0fb82151b","5/11/2022","Feature to check if video codec is in the list of unsupported by browser"),{ODB:!1,ODC:"EnableGraphApiGetEmbedInfo",OneDrive:!1,Fallback:!1}),K={ODB:!1,ODC:!r.e.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly.")};r.e.isActivated("b2ac1c0f-d8e1-4f24-9d57-41afa45a5f66","10/11/2022","Killswitch to enable prefetching video with low bitrate"),r.e.isActivated("25c1f6db-47d7-4e6b-b85e-80d4815265b1","9/29/2022","Killswitch to add error handling for getrequestparametersasync call in prefetch"),r.e.isActivated("60fdf489-9918-46ee-8151-5a98bc049a81","10/26/2022","Killswitch to add logging for error in fetch operation"),r.e.isActivated("3ed78801-a94e-47e9-9ea5-82939e22db18","03/14/2023","Allows forProviderPromise to complete before ecsProviderPromise"),r.e.isActivated("51ee2bb9-9d53-45e8-a198-02a1d377f01d","1/23/2023","Remove tooltip from new button on command bar")},function(e,t,n){"use strict";var r=n(16);t.e=r.e},function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"H",function(){return v.w});n.d(t,"e",function(){return O});n.d(t,"v",function(){return M});n.d(t,"m",function(){return _});n.d(t,"o",function(){return D});n.d(t,"w",function(){return P});n.d(t,"T",function(){return H});n.d(t,"S",function(){return B});n.d(t,"k",function(){return j});n.d(t,"C",function(){return F});n.d(t,"r",function(){return I});n.d(t,"O",function(){return q});n.d(t,"n",function(){return R});n.d(t,"A",function(){return U});n.d(t,"M",function(){return z});n.d(t,"l",function(){return W});n.d(t,"s",function(){return X});n.d(t,"u",function(){return V});n.d(t,"p",function(){return $});n.d(t,"a",function(){return J});n.d(t,"x",function(){return K});n.d(t,"D",function(){return Q});n.d(t,"c",function(){return G});n.d(t,"g",function(){return Y});n.d(t,"b",function(){return Z});n.d(t,"f",function(){return ee});n.d(t,"i",function(){return te});n.d(t,"_",function(){return ne});n.d(t,"d",function(){return re});n.d(t,"y",function(){return ie});n.d(t,"L",function(){return se});n.d(t,"N",function(){return oe});n.d(t,"h",function(){return ue});n.d(t,"E",function(){return fe});n.d(t,"P",function(){return le});var r,i=n(0),s=n(9),o=n(26),u=n(88),a=n(8),f=n(80),l=n(12);(function(e){e[e.AllMyPhotos=0]="AllMyPhotos";e[e.Albums=1]="Albums";e[e.allTags=2]="allTags";e[e.allPlaces=3]="allPlaces";e[e.allPeople=4]="allPeople";e[e.singleAlbum=5]="singleAlbum";e[e.singleTag=6]="singleTag";e[e.singlePlace=7]="singlePlace";e[e.singlePerson=8]="singlePerson";e[e.onThisDay=9]="onThisDay";e[e.onThisMonth=10]="onThisMonth";e[e.lastWeekPreviousYears=11]="lastWeekPreviousYears"})(r||(r={}));var c,h=r;(function(e){e[e.Feed=0]="Feed";e[e.Story=1]="Story"})(c||(c={}));var p,d=c,v=n(20),m=n(5),g=n(27),y=n(106),b=n(122),w=n(66),E=n(95),S=n(113),x=n(65),T=n(16),N=n(252),C=(n(361),n(74));(function(e){e[e.all=31]="all";e[e.folders=2]="folders";e[e.photos=8]="photos";e[e.documents=16]="documents";e[e.music=32]="music"})(p||(p={}));var k={ch:"https://www.microsoft.com/de-ch/microsoft-schweiz/unternehmen/impressum.aspx",at:"https://www.microsoft.com/de-at/unternehmen/rechtliches/impressum-corp.aspx",de:"https://www.microsoft.com/germany/siteservices/impressum/default.mspx"},L=T.e.isActivated("B658585F-0A1A-4AAD-A6C8-5C88474A1FA7","11/08/2021","Restrict OneUp page type assignment to the default scenario in the switch statement"),A=!T.e.isActivated("04490DD5-293D-4466-9D41-2C7345A66BC3","02/17/2022","Default doesCidMatchViewerId to false in case of unauth shared scenarios with no CID in URL"),O=T.e.isActivated("E29AAB51-52AB-4E89-8A66-5BCC6CA3B5F4","02/06/2023","Preserve view params start with wd and pass it to wac");T.e.isActivated("DFFB77B6-8059-4C5F-B2B3-8E96E04C4B1F","01/30/2023","Add check for the largest files view");function M(e){var t;void 0===e&&(e={});var n=((t={}).id=e.id||"root",t.cid=e.cid||v.w,t.driveId=e.driveId||"",t.groupId=e.groupId||"",t.qt="".concat(e.qt||"").toLowerCase(),t.did=e.did||"",t.q=e.q||"",t.sft=e.sft||"",t.beginDate=e.beginDate||"",t.endDate=e.endDate||"",t.ft=e.ft||"",t.ext=e.ext||"",t.df=e.df||"",t.sp=e.sp||"",t.ocid=e.ocid||"",t["WT.mc_id"]=e["WT.mc_id"]||"",t.locationFilter=e.locationFilter||"",t.tagFilter=e.tagFilter||"",t.onThisDay=e.onThisDay||"",t.onThisMonth=e.onThisMonth||"",t.lastWeekPreviousYears=e.lastWeekPreviousYears||"",t.scope=e.scope||"",t.useUtilityFiltering=void 0===e.useUtilityFiltering?"":e.useUtilityFiltering,t.startDate=e.startDate||"",t.internalPath=e.internalPath||"",t.psId=e.psId||"",t.u=e.u||"",t.searchsessionid=e.searchsessionid||"",t.mojDate=e.mojDate||"",t.moj=e.moj||"",t.acType=e.acType||"",t.psId=e.psId,t.psPostId=e.psPostId,t.psRIds=e.psRIds||"",t.pssc=e.pssc||"",t);return s.t(n,void 0,!0)}function _(e){return s.e(e)}function D(e){var t=Object(i.e)({},e);if(t.parId||t.parQt||t.parCid){delete t.id;delete t.qt;delete t.internalPath;if(t.parId){t.id=t.parId;delete t.parId}if(t.parQt){t.qt=t.parQt;delete t.parQt}if(t.parCid){t.cid=t.parCid;delete t.parCid}}delete t.u;return M(t)}function P(e,t){var n;switch(e.v){case"1":case"FolderPickerView":case"2":case"FilePickerView":case"pickerconsent":n=l.e.FilePicker;break;case"3":n=l.e.Files;break;case"photos":n=l.e.Photos;break;case"photoStream":n=l.e.PhotoStream;break;case"managestorage":n=l.e.StorageInfo;break;case"photopreferences":n=l.e.PhotoPreferences;break;case"tagpreferences":n=l.e.TagPreferences;break;case"error":n=l.e.Error;break;case"RansomwareDetection":n=l.e.RansomwareDetection;break;case"syncplaceholders":n=l.e.SyncPlaceholders;break;case"upgrade":n=l.e.StorageOptions;break;case"restore":n=l.e.Restore;break;case"TextFileEditor":n=l.e.TextFileEditor;break;case"syncpremiumupsell":n=l.e.SyncOnboarding;break;case"validatepermission":n=l.e.ValidatePermission;break;case"requestaccess":n=l.e.RequestAccess;break;case"unlock":n=l.e.Unlock;break;case"ManageVault":n=l.e.ManageVault;break;case"traceme":n=l.e.TraceMe;break;case"convergence":n=l.e.Convergence;break;case"documentoptions":n=l.e.DocumentOptions;break;case"devicebackups":n=l.e.DeviceBackups;break;case"search":n=l.e.Search;break;case"NotificationOptions":n=l.e.NotificationOptions;break;default:if(Object(v.u)())n=l.e.AccountChooser;else{if(!L&&W(e)&&t)return l.e.OneUp;n=l.e.Files}}return L&&W(e)&&t?l.e.OneUp:n}function H(e){var t;switch(_(D(e)).qt){case"mru":t=a.e.Recent;break;case"recyclebin":t=a.e.RecycleBin;break;case"sharedby":t=a.e.SharedWithMe;break;case"sharedbyme":t=a.e.SharedByMe;break;case"search":t=a.e.Search;break;case"allmyphotos":t=a.e.AllMyPhotos;break;case"photostream":t=a.e.PhotoStream;break;case"selection":t=a.e.Selection;break;default:t=Object(v.l)(e)||Object(v.c)(e)||!T.e.isActivated("4D0BEE0C-FCE7-4D8F-B6C7-3BC94830A252")&&(Object(v.a)(e)||Object(v.g)(e)||Object(v.y)(e)||Object(v.b)(e))?a.e.AllMyPhotos:Object(v.u)()?"false"===e.load_login?a.e.AccountChooserMobileSDK:a.e.AccountChooserPicker:a.e.Files}return t}function B(e){return"photos"===e.v&&Object(f.e)(H(e))?h.AllMyPhotos:Object(v.c)(e)?h.allTags:Object(v.b)(e)?h.singleTag:Object(v.l)(e)?h.allPlaces:Object(v.y)(e)?h.singlePlace:Object(v.d)(e)?h.onThisDay:Object(v.v)(e)?h.onThisMonth:Object(v.p)(e)?h.lastWeekPreviousYears:Object(v.f)(e)?h.AllMyPhotos:Object(v.a)(e)?h.Albums:Object(v.g)(e)?h.singleAlbum:"photos"===e.v?h.AllMyPhotos:null}function j(e,t){return t===l.e.Photos?"".concat(h[B(e)]):t===l.e.PhotoStream?"".concat(d[(function(e){return e.psId?d.Story:d.Feed})(e)]):""}function F(e){var t,n;void 0===e&&(e=a.e.Files);var r=((t={})[a.e.Files]="",t[a.e.Recent]="mru",t[a.e.SharedWithMe]="sharedby",t[a.e.SharedByMe]="sharedbyme",t[a.e.RecycleBin]="recyclebin",t[a.e.AllMyPhotos]="allmyphotos",t[a.e.PhotoStream]="photostream",t[a.e.Selection]="selection",t);return M(((n={}).qt=r[e],n))}function I(e){return e.authkey}function q(e){return!(e.mid||e.mcid||"sharedby"!==e.qt&&R(e)||U(e))}function R(e){var t=e.cid;return!(A&&!t&&v.h)&&(function(e){var t=v.w;return!e||Object(N.e)(e,t)})(t)}function U(e){return Object(v.f)(e)||Object(v.a)(e)||Object(v.g)(e)||Object(v.c)(e)||Object(v.l)(e)||Object(v.d)(e)||Object(v.v)(e)||Object(v.p)(e)}function z(e){return!(!e.mid||!e.mcid)}function W(e){var t=null;if(e.parId||e.parQt||e.parCid){(t={}).id=e.id;t.qt=e.qt;t.cid=e.cid;t.internalPath=e.internalPath;Object(m.ne)(m.X)&&(t.driveId=e.driveId);delete t.u}return t&&M(t)||null}function X(e){var t=e.action||"";return g.e[t.toLowerCase()]||g.t.none}function V(){return window.location.protocol+"//"+window.location.host}function $(e){var t=e.itemKey,n=e.itemInfo,r=e.page,s=e.action,o=e.preserveAction,u=void 0!==o&&o,c=e.viewParams,h=n||{},d=h.itemIsPlaceholder,m=h.itemVirtualItemType,b=h.itemExtension,E=h.itemType,S=_(t),x=Object(i.e)({},S),T=K(c);void 0!==r&&(T.v=(function(e,t){var n,r=t.v;switch(e){case l.e.FilePicker:n=ae(r)?r:"FilePickerView";break;case l.e.TextFileEditor:n="TextFileEditor";break;case l.e.Photos:n="photos";break;case l.e.RansomwareDetection:n="RansomwareDetection";break;default:case l.e.Files:}return n})(r,c));var N=!1,C=!!b&&Object(y.t)(b,E);if(d)switch(x.id){case"tags":case"places":case"albums":T.v="photos";N=!0}else{"TextFileEditor"===T.v&&(C||(T.v=""));switch(m){case w.e.Album:case w.e.AlbumRoot:case w.e.Tag:case w.e.TagsRoot:T.v="photos";N=!0}}if("allmyphotos"===S.qt){x.v="photos";N=!0;if("true"===S.onThisDay||"true"===S.onThisMonth||"true"===S.lastWeekPreviousYears){c&&c.startDate&&(x.startDate=c.startDate);c&&c.cid&&(x.cid=c.cid)}}if("photostream"===S.qt){x.v="photoStream";x.psShareId=c.psShareId}var k=H(S);C||!n||N||k===a.e.Search||k===a.e.AllMyPhotos||k===a.e.PhotoStream||(x.v="");!C&&Object(f.e)(k)&&("photos"!==T.v&&"photoStream"!==T.v||Object(v.n)(S)!==p.photos.toString())&&(x.v="");ae(T.v)&&(x.v=T.v);delete T.scope;delete x.u;var L=X(c);s?x.action=s&&g.t[s]&&g.t[s].toLowerCase()||"":u&&L&&(L===g.t.showProperties&&x.o||(x.action=g.t[L].toLowerCase()));Object(i.e)(T,x);return T}function J(e,t){var n=[];n.push(V());switch(e){case 0:n.push("/");break;case 1:n.push(u.r);break;case 2:n.push(ee());break;default:n.push(ee())}n.push("?");n.push(t);return n.join("")}function K(e){var t,n=((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.redeem=e.redeem,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t.simulateunauth=e.simulateunauth,t);for(var r in e)0===r.indexOf("EXPExperimentTest_e")&&(n[r]=e[r]);var i=e["WT.mc_id"],s=e.ocid;if(i){n["WT.mc_id"]=i;n.ocid=s||i}if(!O)for(var o in e)o.startsWith("wd")&&(n[o]=e[o]);return n}function Q(e,t){void 0===t&&(t=!1);return t||o.t.si?te(ne(e)):e}function G(){var e=C.e.getMarket(),t=e&&e.split("-")[1];return t&&k[t.toLowerCase()]}function Y(){return"https://go.microsoft.com/fwlink/?linkid=2100224"}function Z(e){var t,n=e.wtcParam,r=e.viewParams,i=e.hideLeftNav,o=((t={}).ocid=r.ocid||r["WT.mc_id"]||n,t.v="upgrade",t.hideLeftNav=i,t);return Q("#"+s.t(o,null,!0))}function ee(){return window.location.pathname}function te(e){var t=o.t.signInUrl;if(window.location.href.indexOf("iam=")>-1){t+="&redirect_uri={0}";e=V()+"/business"}else t+="&ru={0}&wreply={0}";return S.n(t,b.e.encodeURIComponent(e||window.location.href))}function ne(e){0===e.indexOf("#")&&(e=J(2,e.substring(1)));return e}function re(e){var t=e.additionalViewParams,n=$(Object(i.e)({},e));t&&Object(x.e)(n,t);t&&t.sc||delete n.sc;return"#"+s.t(n,null,!0)}function ie(){return V()+"/marketblockerror.aspx"}function se(e){var t={};t.id=e.id;t.challengeToken=e.authkey;t.v="validatepermission";return V()+"?"+s.t(t,null,!0)}function oe(e){var t={};t.id=e.id;t.challengeToken=e.authkey;t.v="requestaccess";return V()+"?"+s.t(t,null,!0)}function ue(e){void 0===e&&(e={});var t=Object(i.e)({},e),n=e.ithint;if(n){switch(n.split(",")[0]){case"album":t.v="photos"}delete t.ithint}a.e.AllMyPhotos===H(e)&&(t.v="photos");switch(e.v){case"pickerconsent":t.v="pickerconsent";break;case"FolderPickerView":case"1":t.v="FolderPickerView";break;case"FilePickerView":case"2":t.v="FilePickerView";break;case"RansomwareDetection":t.v="RansomwareDetection";break;case"3":delete t.v}return t}function ae(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t}function fe(){var e={qt:"photostream",v:"photoStream"};return V()+"?"+s.t(e,null,!0)}function le(e){void 0===e&&(e={filters:[]});for(var t=[],n=[],r=0,i=0,s=e.filters;i<s.length;i++){"string"==typeof(a=s[i])?t.push(a):n.push(a)}if(!t.length)for(var o=0,u=n;o<u.length;o++){var a;switch(a=u[o]){case E.e.folder:r|=7;break;case E.e.audio:r|=32;break;case E.e.media:r|=8;break;case E.e.document:r|=16;break;case E.e.any:r|=p.all}}var f=t.join(";"),l="".concat(r||""),c={};f&&(c.ext=f);l&&(c.ft=l);return c}},function(e,t,n){"use strict";var r=n(173);n.d(t,"e",function(){return r.e})},,,,function(e,t,n){"use strict";var r;(function(e){e[e.Loading=0]="Loading";e[e.Files=1]="Files";e[e.FilePicker=2]="FilePicker";e[e.FolderPicker=3]="FolderPicker";e[e.Photos=4]="Photos";e[e.TextFileEditor=5]="TextFileEditor";e[e.AccountChooser=6]="AccountChooser";e[e.StorageInfo=7]="StorageInfo";e[e.StorageOptions=8]="StorageOptions";e[e.AppData=9]="AppData";e[e.Error=10]="Error";e[e.SyncOnboarding=11]="SyncOnboarding";e[e.Share=12]="Share";e[e.OneUp=14]="OneUp";e[e.PhotoPreferences=15]="PhotoPreferences";e[e.Embed=16]="Embed";e[e.SyncPlaceholders=17]="SyncPlaceholders";e[e.Restore=18]="Restore";e[e.ValidatePermission=20]="ValidatePermission";e[e.RansomwareDetection=21]="RansomwareDetection";e[e.Settings=22]="Settings";e[e.Unlock=23]="Unlock";e[e.MobileAppUpsell=24]="MobileAppUpsell";e[e.FileRequest=26]="FileRequest";e[e.CreateList=27]="CreateList";e[e.ManageVault=28]="ManageVault";e[e.RequestAccess=29]="RequestAccess";e[e.TraceMe=30]="TraceMe";e[e.FileBrowser=31]="FileBrowser";e[e.TagPreferences=32]="TagPreferences";e[e.PhotoStream=33]="PhotoStream";e[e.Convergence=34]="Convergence";e[e.DocumentOptions=35]="DocumentOptions";e[e.DeviceBackups=37]="DeviceBackups";e[e.Search=38]="Search";e[e.NotificationOptions=39]="NotificationOptions";e[e.ContentAssembly=40]="ContentAssembly";e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup";e[e.SharingSettings=301]="SharingSettings";e[e.SyncSettings=302]="SyncSettings";e[e.StorageSettings=303]="StorageSettings";e[e.AccessPolicySettings=304]="AccessPolicySettings";e[e.ComplianceSettings=305]="ComplianceSettings";e[e.NotificationSettings=306]="NotificationSettings";e[e.GeoLocations=307]="GeoLocations"})(r||(r={}));var i=r;t.e=i},,,function(e,t,n){var r,i,s;!(function(o){var u=this||(0,eval)("this"),a=u.document,f=u.navigator,l=u.jQuery,c=u.JSON;(function(o){i=[t,n],void 0!==(s="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=s)})(function(e,t){function n(e,t){return(null===e||typeof e in g)&&e===t}function r(e,t){var n;return function(){n||(n=m.a.setTimeout(function(){n=o;e()},t))}}function i(e,t){var n;return function(){clearTimeout(n);n=m.a.setTimeout(e,t)}}function s(e,t){t&&t!==y?"beforeChange"===t?this.Lb(e):this.Ha(e,t):this.Mb(e)}function h(e,t){null!==t&&t.k&&t.k()}function p(e,t){var n=this.Ic,r=n[x];r.S||(this.lb&&this.Na[t]?(n.Qb(t,e,this.Na[t]),this.Na[t]=null,--this.lb):r.r[t]||n.Qb(t,e,r.s?{ia:e}:n.wc(e)))}function d(e,t,n,r){m.d[e]={init:function(e,i,s,o,u){var a,f;m.m(function(){var s=i(),o=m.a.c(s),l=(o=!n!=!o,!f);(l||t||o!==a)&&(l&&m.va.Aa()&&(f=m.a.ua(m.e.childNodes(e),!0)),o?(l||m.e.da(e,m.a.ua(f)),m.Ka(r?r(u,s):u,e)):m.e.xa(e),a=o)},null,{i:e});return{controlsDescendantBindings:!0}}};m.h.ta[e]=!1;m.e.V[e]=!0}var v,m=void 0!==e?e:{};m.b=function(e,t){for(var n=e.split("."),r=m,i=0;i<n.length-1;i++)r=r[n[i]];r[n[n.length-1]]=t};m.G=function(e,t,n){e[t]=n};m.version="3.5.0-pre";m.b("version",m.version);m.options={deferUpdates:!1,useOnlyNativeEvents:!1};m.a=(function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){e.__proto__=t;return e}function r(e,t,n,r){var i=e[t].match(g)||[];m.a.q(n.match(g),function(e){m.a.pa(i,e,r)});e[t]=i.join(" ")}var i={__proto__:[]}instanceof Array,s="function"==typeof Symbol,h={},p={};h[f&&/Firefox\/2/i.test(f.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");e(h,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)p[t[n]]=e});var d={propertychange:!0},v=a&&(function(){for(var e=3,t=a.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return 4<e?e:o})(),g=/\S+/g;return{ec:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Tb:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},Ma:function(e,t){var n=m.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Ub:function(e){for(var t=[],n=0,r=(e=e||[]).length;n<r;n++)0>m.a.o(t,e[n])&&t.push(e[n]);return t},fb:function(e,t){for(var n=[],r=0,i=(e=e||[]).length;r<i;r++)n.push(t(e[r],r));return n},La:function(e,t){for(var n=[],r=0,i=(e=e||[]).length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},pa:function(e,t,n){var r=m.a.o(m.a.zb(e),t);0>r?n&&e.push(t):n||e.splice(r,1)},ka:i,extend:t,Ya:n,Za:i?n:t,D:e,Ca:function(e,t){if(!e)return e;var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n],n,e));return r},ob:function(e){for(;e.firstChild;)m.removeNode(e.firstChild)},lc:function(e){for(var t=((e=m.a.W(e))[0]&&e[0].ownerDocument||a).createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(m.$(e[n]));return t},ua:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++){var s=e[n].cloneNode(!0);i.push(t?m.$(s):s)}return i},da:function(e,t){m.a.ob(e);if(t)for(var n=0,r=t.length;n<r;n++)e.appendChild(t[n])},sc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var r=n[0],i=r.parentNode,s=0,o=t.length;s<o;s++)i.insertBefore(t[s],r);s=0;for(o=n.length;s<o;s++)m.removeNode(n[s])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],r=e[e.length-1];for(e.length=0;n!==r;)e.push(n),n=n.nextSibling;e.push(r)}}return e},uc:function(e,t){7>v?e.setAttribute("selected",t):e.selected=t},ab:function(e){return null===e||e===o?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},od:function(e,t){e=e||"";return!(t.length>e.length)&&e.substring(0,t.length)===t},Nc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return m.a.Nc(e,e.ownerDocument.documentElement)},Rb:function(e){return!!m.a.Tb(e,m.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Xb:function(e){return m.onError?function(){try{return e.apply(this,arguments)}catch(e){throw m.onError&&m.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(m.a.Xb(e),t)},bc:function(e){setTimeout(function(){m.onError&&m.onError(e);throw e},0)},p:function(e,t,n){var r=m.a.Xb(n);n=v&&d[t];if(m.options.useOnlyNativeEvents||n||!l)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){r.call(e,t)},s="on"+t;e.attachEvent(s,i);m.a.F.oa(e,function(){e.detachEvent(s,i)})}else e.addEventListener(t,r,!1);else l(e).bind(t,r)},Da:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;n=!("input"!==m.a.A(e)||!e.type||"click"!=t.toLowerCase())&&("checkbox"==(n=e.type)||"radio"==n);if(m.options.useOnlyNativeEvents||!l||n)if("function"==typeof a.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=a.createEvent(p[t]||"HTMLEvents")).initEvent(t,!0,!0,u,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else l(e).trigger(t)},c:function(e){return m.H(e)?e():e},zb:function(e){return m.H(e)?e.t():e},cb:function(e,t,n){var i;t&&("object"==typeof e.classList?(i=e.classList[n?"add":"remove"],m.a.q(t.match(g),function(t){i.call(e.classList,t)})):"string"==typeof e.className.baseVal?r(e.className,"baseVal",t,n):r(e,"className",t,n))},$a:function(e,t){var n=m.a.c(t);null!==n&&n!==o||(n="");var r=m.e.firstChild(e);!r||3!=r.nodeType||m.e.nextSibling(r)?m.e.da(e,[e.ownerDocument.createTextNode(n)]):r.data=n;m.a.Sc(e)},tc:function(e,t){e.name=t;if(7>=v)try{e.mergeAttributes(a.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Sc:function(e){9<=v&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Oc:function(e){if(v){var t=e.style.width;e.style.width=0;e.style.width=t}},jd:function(e,t){e=m.a.c(e);t=m.a.c(t);for(var n=[],r=e;r<=t;r++)n.push(r);return n},W:function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t},$b:function(e){return s?Symbol(e):e},sd:6===v,ud:7===v,C:v,gc:function(e,t){for(var n=m.a.W(e.getElementsByTagName("input")).concat(m.a.W(e.getElementsByTagName("textarea"))),r="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],s=n.length-1;0<=s;s--)r(n[s])&&i.push(n[s]);return i},fd:function(e){return"string"==typeof e&&(e=m.a.ab(e))?c&&c.parse?c.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!c||!c.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return c.stringify(m.a.c(e),t,n)},gd:function(t,n,r){var i=(r=r||{}).params||{},s=r.includeFields||this.ec,o=t;if("object"==typeof t&&"form"===m.a.A(t)){o=t.action;for(var u=s.length-1;0<=u;u--)for(var f=m.a.gc(t,s[u]),l=f.length-1;0<=l;l--)i[f[l].name]=f[l].value}n=m.a.c(n);var c=a.createElement("form");c.style.display="none";c.action=o;c.method="post";for(var h in n)(t=a.createElement("input")).type="hidden",t.name=h,t.value=m.a.Eb(m.a.c(n[h])),c.appendChild(t);e(i,function(e,t){var n=a.createElement("input");n.type="hidden";n.name=e;n.value=t;c.appendChild(n)});a.body.appendChild(c);r.submitter?r.submitter(c):c.submit();setTimeout(function(){c.parentNode.removeChild(c)},0)}}})();m.b("utils",m.a);m.b("utils.arrayForEach",m.a.q);m.b("utils.arrayFirst",m.a.Tb);m.b("utils.arrayFilter",m.a.La);m.b("utils.arrayGetDistinctValues",m.a.Ub);m.b("utils.arrayIndexOf",m.a.o);m.b("utils.arrayMap",m.a.fb);m.b("utils.arrayPushAll",m.a.ra);m.b("utils.arrayRemoveItem",m.a.Ma);m.b("utils.extend",m.a.extend);m.b("utils.fieldsIncludedWithJsonPost",m.a.ec);m.b("utils.getFormFields",m.a.gc);m.b("utils.peekObservable",m.a.zb);m.b("utils.postJson",m.a.gd);m.b("utils.parseJson",m.a.fd);m.b("utils.registerEventHandler",m.a.p);m.b("utils.stringifyJson",m.a.Eb);m.b("utils.range",m.a.jd);m.b("utils.toggleDomNodeCssClass",m.a.cb);m.b("utils.triggerEvent",m.a.Da);m.b("utils.unwrapObservable",m.a.c);m.b("utils.objectForEach",m.a.D);m.b("utils.addOrRemoveItem",m.a.pa);m.b("utils.setTextContent",m.a.$a);m.b("unwrap",m.a.c);Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice(0);r.push.apply(r,arguments);return t.apply(e,r)}});m.a.f=new(function(){function e(e,i){var s=e[n];if(!s||"null"===s||!r[s]){if(!i)return o;s=e[n]="ko"+t++;r[s]={}}return r[s]}var t=0,n="__ko__"+(new Date).getTime(),r={};return{get:function(t,n){var r=e(t,!1);return r===o?o:r[n]},set:function(t,n,r){r===o&&e(t,!1)===o||(e(t,!0)[n]=r)},clear:function(e){var t=e[n];return!!t&&(delete r[t],e[n]=null,!0)},I:function(){return t+++n}}});m.b("utils.domData",m.a.f);m.b("utils.domData.clear",m.a.f.clear);m.a.F=new(function(){function e(e,t){var r=m.a.f.get(e,n);r===o&&t&&(r=[],m.a.f.set(e,n,r));return r}function t(n){if(r=e(n,!1))for(var r=r.slice(0),s=0;s<r.length;s++)r[s](n);m.a.f.clear(n);m.a.F.cleanExternalData(n);if(i[n.nodeType])for(r=n.firstChild;n=r;)r=n.nextSibling,8===n.nodeType&&t(n)}var n=m.a.f.I(),r={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{oa:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},rc:function(t,r){var i=e(t,!1);i&&(m.a.Ma(i,r),0==i.length&&m.a.f.set(t,n,o))},$:function(e){if(r[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];m.a.ra(n,e.getElementsByTagName("*"));for(var s=0,o=n.length;s<o;s++)t(n[s])}return e},removeNode:function(e){m.$(e);e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){l&&"function"==typeof l.cleanData&&l.cleanData([e])}}});m.$=m.a.F.$;m.removeNode=m.a.F.removeNode;m.b("cleanNode",m.$);m.b("removeNode",m.removeNode);m.b("utils.domNodeDisposal",m.a.F);m.b("utils.domNodeDisposal.addDisposeCallback",m.a.F.oa);m.b("utils.domNodeDisposal.removeDisposeCallback",m.a.F.rc);(function(){var e=[0,"",""],t=[1,"<table>","</table>"],n=[3,"<table><tbody><tr>","</tr></tbody></table>"],r=[1,"<select multiple='multiple'>","</select>"],i={thead:t,tbody:t,tfoot:t,tr:[2,"<table><tbody>","</tbody></table>"],td:n,th:n,option:r,optgroup:r},s=8>=m.a.C;m.a.ma=function(t,n){var r;if(l){if(l.parseHTML)r=l.parseHTML(t,n)||[];else if((r=l.clean([t],n))&&r[0]){for(var o=r[0];o.parentNode&&11!==o.parentNode.nodeType;)o=o.parentNode;o.parentNode&&o.parentNode.removeChild(o)}}else{(r=n)||(r=a);o=r.parentWindow||r.defaultView||u;var f,c=m.a.ab(t).toLowerCase(),h=r.createElement("div");f=(c=c.match(/^<([a-z]+)[ >]/))&&i[c[1]]||e;c=f[0];f="ignored<div>"+f[1]+t+f[2]+"</div>";"function"==typeof o.innerShiv?h.appendChild(o.innerShiv(f)):(s&&r.appendChild(h),h.innerHTML=f,s&&h.parentNode.removeChild(h));for(;c--;)h=h.lastChild;r=m.a.W(h.lastChild.childNodes)}return r};m.a.Cb=function(e,t){m.a.ob(e);if(null!==(t=m.a.c(t))&&t!==o)if("string"!=typeof t&&(t=t.toString()),l)l(e).html(t);else for(var n=m.a.ma(t,e.ownerDocument),r=0;r<n.length;r++)e.appendChild(n[r])}})();m.b("utils.parseHtmlFragment",m.a.ma);m.b("utils.setHtml",m.a.Cb);m.M=(v={},{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);v[t]=e;return"\x3c!--[ko_memo:"+t+"]--\x3e"},zc:function(e,t){var n=v[e];if(n===o)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return n.apply(null,t||[]),!0}finally{delete v[e]}},Ac:function(e,t){var n=[];(function e(t,n){if(t)if(8==t.nodeType)null!=(r=m.M.nc(t.nodeValue))&&n.push({Mc:t,dd:r});else if(1==t.nodeType)for(var r=0,i=t.childNodes,s=i.length;r<s;r++)e(i[r],n)})(e,n);for(var r=0,i=n.length;r<i;r++){var s=n[r].Mc,o=[s];t&&m.a.ra(o,t);m.M.zc(n[r].dd,o);s.nodeValue="";s.parentNode&&s.parentNode.removeChild(s)}},nc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}});m.b("memoization",m.M);m.b("memoization.memoize",m.M.wb);m.b("memoization.unmemoize",m.M.zc);m.b("memoization.parseMemoText",m.M.nc);m.b("memoization.unmemoizeDomNodeAndDescendants",m.M.Ac);m.Z=(function(){function e(){if(r)for(var e,t=r,i=0;s<r;)if(e=n[s++]){if(s>t){if(5e3<=++i){s=r;m.a.bc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=r}try{e()}catch(e){m.a.bc(e)}}}function t(){e();s=r=n.length=0}var n=[],r=0,i=1,s=0;return{scheduler:u.MutationObserver?(function(e){var t=a.createElement("div");new MutationObserver(e).observe(t,{attributes:!0});return function(){t.classList.toggle("foo")}})(t):a&&"onreadystatechange"in a.createElement("script")?function(e){var t=a.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null;a.documentElement.removeChild(t);t=null;e()};a.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Xa:function(e){r||m.Z.scheduler(t);n[r++]=e;return i++},cancel:function(e){(e-=i-r)>=s&&e<r&&(n[e]=null)},resetForTesting:function(){var e=r-s;s=r=n.length=0;return e},nd:e}})();m.b("tasks",m.Z);m.b("tasks.schedule",m.Z.Xa);m.b("tasks.runEarly",m.Z.nd);m.ya={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return m.B({read:e,write:function(r){clearTimeout(n);n=m.a.setTimeout(function(){e(r)},t)}})},rateLimit:function(e,t){var n,s,o;"number"==typeof t?n=t:(n=t.timeout,s=t.method);e.eb=!1;o="notifyWhenChangesStop"==s?i:r;e.Ua(function(e){return o(e,n)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.eb||(e.eb=!0,e.Ua(function(t){var n;return function(){m.Z.cancel(n);n=m.Z.Xa(t);e.notifySubscribers(o,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var g={undefined:1,boolean:1,number:1,string:1};m.b("extenders",m.ya);m.xc=function(e,t,n){this.ia=e;this.gb=t;this.Lc=n;this.S=!1;m.G(this,"dispose",this.k)};m.xc.prototype.k=function(){this.S=!0;this.Lc()};m.J=function(){m.a.Za(this,b);b.rb(this)};var y="change",b={rb:function(e){e.K={};e.Ob=1},Y:function(e,t,n){var r=this;n=n||y;var i=new m.xc(r,t?e.bind(t):e,function(){m.a.Ma(r.K[n],i);r.Ia&&r.Ia(n)});r.sa&&r.sa(n);r.K[n]||(r.K[n]=[]);r.K[n].push(i);return i},notifySubscribers:function(e,t){(t=t||y)===y&&this.Ib();if(this.Qa(t))try{m.l.Vb();for(var n,r=this.K[t].slice(0),i=0;n=r[i];++i)n.S||n.gb(e)}finally{m.l.end()}},Oa:function(){return this.Ob},Vc:function(e){return this.Oa()!==e},Ib:function(){++this.Ob},Ua:function(e){var t,n,r,i=this,o=m.H(i);i.Ha||(i.Ha=i.notifySubscribers,i.notifySubscribers=s);var u=e(function(){i.Nb=!1;o&&r===i&&(r=i());t=!1;i.tb(n,r)&&i.Ha(n=r)});i.Mb=function(e){i.Nb=t=!0;r=e;u()};i.Lb=function(e){t||(n=e,i.Ha(e,"beforeChange"))}},Qa:function(e){return this.K[e]&&this.K[e].length},Tc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;m.a.D(this.K,function(e,n){"dirty"!==e&&(t+=n.length)});return t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;e&&m.a.D(e,function(e,n){var r=m.ya[e];"function"==typeof r&&(t=r(t,n)||t)});return t}};m.G(b,"subscribe",b.Y);m.G(b,"extend",b.extend);m.G(b,"getSubscriptionsCount",b.Tc);m.a.ka&&m.a.Ya(b,Function.prototype);m.J.fn=b;m.jc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers};m.b("subscribable",m.J);m.b("isSubscribable",m.jc);m.va=m.l=(function(){function e(e){r.push(n);n=e}function t(){n=r.pop()}var n,r=[],i=0;return{Vb:e,end:t,qc:function(e){if(n){if(!m.jc(e))throw Error("Only subscribable things can act as dependencies");n.gb.call(n.Hc,e,e.Dc||(e.Dc=++i))}},w:function(n,r,i){try{return e(),n.apply(r,i||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Ta:function(){if(n)return n.Ta}}})();m.b("computedContext",m.va);m.b("computedContext.getDependenciesCount",m.va.Aa);m.b("computedContext.isInitial",m.va.Ta);m.b("ignoreDependencies",m.rd=m.l.w);var w=m.a.$b("_latestValue");m.N=function(e){function t(){if(0<arguments.length)return t.tb(t[w],arguments[0])&&(t.ga(),t[w]=arguments[0],t.fa()),this;m.l.qc(t);return t[w]}t[w]=e;m.a.ka||m.a.extend(t,m.J.fn);m.J.fn.rb(t);m.a.Za(t,E);m.options.deferUpdates&&m.ya.deferred(t,!0);return t};var E={equalityComparer:n,t:function(){return this[w]},fa:function(){this.notifySubscribers(this[w])},ga:function(){this.notifySubscribers(this[w],"beforeChange")}};m.a.ka&&m.a.Ya(E,m.J.fn);var S=m.N.hd="__ko_proto__";E[S]=m.N;m.Pa=function(e,t){return null!==e&&e!==o&&e[S]!==o&&(e[S]===t||m.Pa(e[S],t))};m.H=function(e){return m.Pa(e,m.N)};m.Ba=function(e){return!!("function"==typeof e&&e[S]===m.N||"function"==typeof e&&e[S]===m.B&&e.Wc)};m.b("observable",m.N);m.b("isObservable",m.H);m.b("isWriteableObservable",m.Ba);m.b("isWritableObservable",m.Ba);m.b("observable.fn",E);m.G(E,"peek",E.t);m.G(E,"valueHasMutated",E.fa);m.G(E,"valueWillMutate",E.ga);m.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");e=m.N(e);m.a.Za(e,m.la.fn);return e.extend({trackArrayChanges:!0})};m.la.fn={remove:function(e){for(var t=this.t(),n=[],r="function"!=typeof e||m.H(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var s=t[i];r(s)&&(0===n.length&&this.ga(),n.push(s),t.splice(i,1),i--)}n.length&&this.fa();return n},removeAll:function(e){if(e===o){var t=this.t(),n=t.slice(0);this.ga();t.splice(0,t.length);this.fa();return n}return e?this.remove(function(t){return 0<=m.a.o(e,t)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||m.H(e)?function(t){return t===e}:e;this.ga();for(var r=t.length-1;0<=r;r--)n(t[r])&&(t[r]._destroy=!0);this.fa()},destroyAll:function(e){return e===o?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=m.a.o(e,t)}):[]},indexOf:function(e){var t=this();return m.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ga(),this.t()[n]=t,this.fa())}};m.a.ka&&m.a.Ya(m.la.fn,m.N.fn);m.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){m.la.fn[e]=function(){var t=this.t();this.ga();this.Wb(t,e,arguments);var n=t[e].apply(t,arguments);this.fa();return n===t?this:n}});m.a.q(["slice"],function(e){m.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}});m.b("observableArray",m.la);m.ya.trackArrayChanges=function(e,t){function n(){if(!s){s=!0;i=e.notifySubscribers;e.notifySubscribers=function(e,t){t&&t!==y||++a;return i.apply(this,arguments)};var t=[].concat(e.t()||[]);u=null;r=e.Y(function(n){n=[].concat(n||[]);if(e.Qa("arrayChange")){var r;(!u||1<a)&&(u=m.a.ib(t,n,e.hb));r=u}t=n;u=null;a=0;r&&r.length&&e.notifySubscribers(r,"arrayChange")})}}e.hb={};t&&"object"==typeof t&&m.a.extend(e.hb,t);e.hb.sparse=!0;if(!e.Wb){var r,i,s=!1,u=null,a=0,f=e.sa,l=e.Ia;e.sa=function(t){f&&f.call(e,t);"arrayChange"===t&&n()};e.Ia=function(t){l&&l.call(e,t);"arrayChange"!==t||e.Qa("arrayChange")||(i&&(e.notifySubscribers=i,i=o),r.k(),s=!1)};e.Wb=function(e,t,n){function r(e,t,n){return i[i.length]={status:e,value:t,index:n}}if(s&&!a){var i=[],o=e.length,f=n.length,l=0;switch(t){case"push":l=o;case"unshift":for(t=0;t<f;t++)r("added",n[t],l+t);break;case"pop":l=o-1;case"shift":o&&r("deleted",e[l],l);break;case"splice":t=Math.min(Math.max(0,0>n[0]?o+n[0]:n[0]),o);o=1===f?o:Math.min(t+(n[1]||0),o),f=t+f-2,l=Math.max(o,f);for(var c=[],h=[],p=2;t<l;++t,++p)t<o&&h.push(r("deleted",e[t],t)),t<f&&c.push(r("added",n[p],t));m.a.fc(h,c);break;default:return}u=i}}}};var x=m.a.$b("_state");m.m=m.B=function(e,t,n){function r(){if(0<arguments.length){if("function"!=typeof i)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");i.apply(s.pb,arguments);return this}m.l.qc(r);(s.T||s.s&&r.Ra())&&r.aa();return s.U}"object"==typeof e?n=e:(n=n||{},e&&(n.read=e));if("function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var i=n.write,s={U:o,T:!0,Sa:!1,Fb:!1,S:!1,Wa:!1,s:!1,kd:n.read,pb:t||n.owner,i:n.disposeWhenNodeIsRemoved||n.i||null,wa:n.disposeWhen||n.wa,mb:null,r:{},L:0,dc:null};r[x]=s;r.Wc="function"==typeof i;m.a.ka||m.a.extend(r,m.J.fn);m.J.fn.rb(r);m.a.Za(r,T);n.pure?(s.Wa=!0,s.s=!0,m.a.extend(r,N)):n.deferEvaluation&&m.a.extend(r,C);m.options.deferUpdates&&m.ya.deferred(r,!0);s.i&&(s.Fb=!0,s.i.nodeType||(s.i=null));s.s||n.deferEvaluation||r.aa();s.i&&r.ba()&&m.a.F.oa(s.i,s.mb=function(){r.k()});return r};var T={equalityComparer:n,Aa:function(){return this[x].L},Qb:function(e,t,n){if(this[x].Wa&&t===this)throw Error("A 'pure' computed must not be called recursively");this[x].r[e]=n;n.Ga=this[x].L++;n.na=t.Oa()},Ra:function(){var e,t,n=this[x].r;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e]).ia.Vc(t.na))return!0},cd:function(){this.Fa&&!this[x].Sa&&this.Fa()},ba:function(){return this[x].T||0<this[x].L},md:function(){this.Nb||this.cc()},wc:function(e){if(e.eb&&!this[x].i){var t=e.Y(this.cd,this,"dirty"),n=e.Y(this.md,this);return{ia:e,k:function(){t.k();n.k()}}}return e.Y(this.cc,this)},cc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[x].dc),this[x].dc=m.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[x],n=t.wa;if(!t.Sa&&!t.S){if(t.i&&!m.a.nb(t.i)||n&&n()){if(!t.Fb){this.k();return}}else t.Fb=!1;t.Sa=!0;try{this.Rc(e)}finally{t.Sa=!1}t.L||this.k()}},Rc:function(e){var t=this[x],n=t.Wa?o:!t.L,r={Ic:this,Na:t.r,lb:t.L};m.l.Vb({Hc:r,gb:p,m:this,Ta:n});t.r={};t.L=0;r=this.Qc(t,r);this.tb(t.U,r)&&(t.s||this.notifySubscribers(t.U,"beforeChange"),t.U=r,t.s?this.Ib():e&&this.notifySubscribers(t.U));n&&this.notifySubscribers(t.U,"awake")},Qc:function(e,t){try{var n=e.kd;return e.pb?n.call(e.pb):n()}finally{m.l.end(),t.lb&&!e.s&&m.a.D(t.Na,h),e.T=!1}},t:function(){var e=this[x];(e.T&&!e.L||e.s&&this.Ra())&&this.aa();return e.U},Ua:function(e){m.J.fn.Ua.call(this,e);this.Fa=function(){this.Lb(this[x].U);this[x].T=!0;this.Mb(this)}},k:function(){var e=this[x];!e.s&&e.r&&m.a.D(e.r,function(e,t){t.k&&t.k()});e.i&&e.mb&&m.a.F.rc(e.i,e.mb);e.r=null;e.L=0;e.S=!0;e.T=!1;e.s=!1;e.i=null}},N={sa:function(e){var t=this,n=t[x];if(!n.S&&n.s&&"change"==e){n.s=!1;if(n.T||t.Ra())n.r=null,n.L=0,n.T=!0,t.aa(),t.Ib();else{var r=[];m.a.D(n.r,function(e,t){r[t.Ga]=e});m.a.q(r,function(e,r){var i=n.r[e],s=t.wc(i.ia);s.Ga=r;s.na=i.na;n.r[e]=s})}n.S||t.notifySubscribers(n.U,"awake")}},Ia:function(e){var t=this[x];t.S||"change"!=e||this.Qa("change")||(m.a.D(t.r,function(e,n){n.k&&(t.r[e]={ia:n.ia,Ga:n.Ga,na:n.na},n.k())}),t.s=!0,this.notifySubscribers(o,"asleep"))},Oa:function(){var e=this[x];e.s&&(e.T||this.Ra())&&this.aa();return m.J.fn.Oa.call(this)}},C={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};m.a.ka&&m.a.Ya(T,m.J.fn);var k=m.N.hd;m.m[k]=m.N;T[k]=m.m;m.Yc=function(e){return m.Pa(e,m.m)};m.Zc=function(e){return m.Pa(e,m.m)&&e[x]&&e[x].Wa};m.b("computed",m.m);m.b("dependentObservable",m.m);m.b("isComputed",m.Yc);m.b("isPureComputed",m.Zc);m.b("computed.fn",T);m.G(T,"peek",T.t);m.G(T,"dispose",T.k);m.G(T,"isActive",T.ba);m.G(T,"getDependenciesCount",T.Aa);m.pc=function(e,t){if("function"==typeof e)return m.m(e,t,{pure:!0});(e=m.a.extend({},e)).pure=!0;return m.m(e,t)};m.b("pureComputed",m.pc);(function(){function e(n,r,i){i=i||new t;if("object"!=typeof(n=r(n))||null===n||n===o||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var s=n instanceof Array?[]:{};i.save(n,s);(function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)})(n,function(t){var u=r(n[t]);switch(typeof u){case"boolean":case"number":case"string":case"function":s[t]=u;break;case"object":case"undefined":var a=i.get(u);s[t]=a!==o?a:e(u,r,i)}});return s}function t(){this.keys=[];this.Jb=[]}m.yc=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;m.H(e)&&10>t;t++)e=e();return e})};m.toJSON=function(e,t,n){e=m.yc(e);return m.a.Eb(e,t,n)};t.prototype={save:function(e,t){var n=m.a.o(this.keys,e);0<=n?this.Jb[n]=t:(this.keys.push(e),this.Jb.push(t))},get:function(e){return 0<=(e=m.a.o(this.keys,e))?this.Jb[e]:o}}})();m.b("toJS",m.yc);m.b("toJSON",m.toJSON);m.j={u:function(e){switch(m.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?m.a.f.get(e,m.d.options.xb):7>=m.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?m.j.u(e.options[e.selectedIndex]):o;default:return e.value}},ha:function(e,t,n){switch(m.a.A(e)){case"option":switch(typeof t){case"string":m.a.f.set(e,m.d.options.xb,o);"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__;e.value=t;break;default:m.a.f.set(e,m.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":""!==t&&null!==t||(t=o);for(var r,i=-1,s=0,u=e.options.length;s<u;++s)if((r=m.j.u(e.options[s]))==t||""==r&&t===o){i=s;break}(n||0<=i||t===o&&1<e.size)&&(e.selectedIndex=i);break;default:null!==t&&t!==o||(t="");e.value=t}}};m.b("selectExtensions",m.j);m.b("selectExtensions.readValue",m.j.u);m.b("selectExtensions.writeValue",m.j.ha);m.h=(function(){function e(e){123===(e=m.a.ab(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,n=[],o=e.match(r),u=[],a=0;if(o){o.push(",");for(var f,l=0;f=o[l];++l){var c=f.charCodeAt(0);if(44===c){if(0>=a){n.push(t&&u.length?{key:t,value:u.join("")}:{unknown:t||u.join("")});t=a=0;u=[];continue}}else if(58===c){if(!a&&!t&&1===u.length){t=u.pop();continue}}else 47===c&&l&&1<f.length?(c=o[l-1].match(i))&&!s[c[0]]&&((o=(e=e.substr(e.indexOf(f)+1)).match(r)).push(","),l=-1,f="/"):40===c||123===c||91===c?++a:41===c||125===c||93===c?--a:t||u.length||34!==c&&39!==c||(f=f.slice(1,-1));u.push(f)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,s={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Va:function(r,i){function s(e,r){var i;if(!l){var c=m.getBindingHandler(e);if(c&&c.preprocess&&!(r=c.preprocess(r,e,s)))return;(c=o[e])&&(i=r,0<=m.a.o(t,i)?i=!1:(c=i.match(n),i=null!==c&&(c[1]?"Object("+c[1]+")"+c[2]:i)),c=i);c&&a.push("'"+e+"':function(_z){"+i+"=_z}")}f&&(r="function(){return "+r+" }");u.push("'"+e+"':"+r)}var u=[],a=[],f=(i=i||{}).valueAccessors,l=i.bindingParams,c="string"==typeof r?e(r):r;m.a.q(c,function(e){s(e.key||e.unknown,e.value)});a.length&&s("_ko_property_writers","{"+a.join(",")+" }");return u.join(",")},bd:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ea:function(e,t,n,r,i){e&&m.H(e)?!m.Ba(e)||i&&e.t()===r||e(r):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](r)}}})();m.b("expressionRewriting",m.h);m.b("expressionRewriting.bindingRewriteValidators",m.h.ta);m.b("expressionRewriting.parseObjectLiteral",m.h.yb);m.b("expressionRewriting.preProcessBindings",m.h.Va);m.b("expressionRewriting._twoWayBindings",m.h.ea);m.b("jsonExpressionRewriting",m.h);m.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.h.Va);(function(){function e(e){return 8==e.nodeType&&s.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,r){for(var i=n,s=1,o=[];i=i.nextSibling;){if(t(i)&&0==--s)return o;o.push(i);e(i)&&s++}if(!r)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var r=n(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var i=a&&"\x3c!--test--\x3e"===a.createComment("test").text,s=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,u={ul:!0,ol:!0};m.e={V:{},childNodes:function(t){return e(t)?n(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,r=(t=m.e.childNodes(t)).length;n<r;n++)m.removeNode(t[n]);else m.a.ob(t)},da:function(t,n){if(e(t)){m.e.xa(t);for(var r=t.nextSibling,i=0,s=n.length;i<s;i++)r.parentNode.insertBefore(n[i],r)}else m.a.da(t,n)},oc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},ic:function(t,n,r){r?e(t)?t.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?t.insertBefore(n,r.nextSibling):t.appendChild(n):m.e.oc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){e(n)&&(n=r(n));return n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Uc:e,qd:function(e){return(e=(i?e.text:e.nodeValue).match(s))?e[1]:null},mc:function(n){if(u[m.a.A(n)]){var i=n.firstChild;if(i)do{if(1===i.nodeType){var s,o=null;if(s=i.firstChild)do{if(o)o.push(s);else if(e(s)){var a=r(s,!0);a?s=a:o=[s]}else t(s)&&(o=[s])}while(s=s.nextSibling);if(s=o)for(o=i.nextSibling,a=0;a<s.length;a++)o?n.insertBefore(s[a],o):n.appendChild(s[a])}}while(i=i.nextSibling)}}}})();m.b("virtualElements",m.e);m.b("virtualElements.allowedBindings",m.e.V);m.b("virtualElements.emptyNode",m.e.xa);m.b("virtualElements.insertAfter",m.e.ic);m.b("virtualElements.prepend",m.e.oc);m.b("virtualElements.setDomNodeChildren",m.e.da);(function(){m.R=function(){this.Gc={}};m.a.extend(m.R.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||m.g.getComponentNameForNode(e);case 8:return m.e.Uc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return m.g.Pb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return m.g.Pb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return m.e.qd(e);default:return null}},parseBindingsString:function(e,t,n,r){try{var i,s=this.Gc,o=e+(r&&r.valueAccessors||"");if(!(i=s[o])){var u,a="with($context){with($data||{}){return{"+m.h.Va(e,r)+"}}}";u=new Function("$context","$element",a);i=s[o]=u}return i(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}});m.R.instance=new m.R})();m.b("bindingProvider",m.R);(function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return m.a.Ca(m.l.w(e),function(t,n){return function(){return e()[n]}})}function r(t,r,i){return"function"==typeof t?n(t.bind(null,r,i)):m.a.Ca(t,e)}function i(e,t){return n(this.getBindings.bind(this,e,t))}function s(e,t,n){var r,i=m.e.firstChild(t),s=m.R.instance,o=s.preprocessNode;if(o){for(;r=i;)i=m.e.nextSibling(r),o.call(s,r);i=m.e.firstChild(t)}for(;r=i;)i=m.e.nextSibling(r),a(e,r,n)}function a(e,t,n){var r=!0,i=1===t.nodeType;i&&m.e.mc(t);(i&&n||m.R.instance.nodeHasBindings(t))&&(r=f(t,null,e,n).shouldBindDescendants);r&&!h[m.a.A(t)]&&s(e,t,!i)}function f(e,n,r,s){var u,a,f=m.a.f.get(e,p);if(!n){if(f)throw Error("You cannot apply bindings multiple times to the same element.");m.a.f.set(e,p,!0)}!f&&s&&m.vc(e,r);if(n&&"function"!=typeof n)u=n;else{var l=m.R.instance,c=l.getBindingAccessors||i,h=m.B(function(){(u=n?n(r,e):c.call(l,e,r))&&r.P&&r.P();return u},null,{i:e});u&&h.ba()||(h=null)}if(u){var d=h?function(e){return function(){return t(h()[e])}}:function(e){return u[e]},v=function(){return m.a.Ca(h?h():u,t)};v.get=function(e){return u[e]&&t(d(e))};v.has=function(e){return e in u};s=(function(e){var t=[],n={},r=[];m.a.D(e,function i(s){if(!n[s]){var o=m.getBindingHandler(s);o&&(o.after&&(r.push(s),m.a.q(o.after,function(t){if(e[t]){if(-1!==m.a.o(r,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));i(t)}}),r.length--),t.push({key:s,hc:o}));n[s]=!0}});return t})(u);m.a.q(s,function(t){var n=t.hc.init,i=t.hc.update,s=t.key;if(8===e.nodeType&&!m.e.V[s])throw Error("The binding '"+s+"' cannot be used with virtual elements");try{"function"==typeof n&&m.l.w(function(){var t=n(e,d(s),v,r.$data,r);if(t&&t.controlsDescendantBindings){if(a!==o)throw Error("Multiple bindings ("+a+" and "+s+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");a=s}}),"function"==typeof i&&m.B(function(){i(e,d(s),v,r.$data,r)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+s+": "+u[s]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:a===o}}function c(e){return e&&e instanceof m.Q?e:new m.Q(e)}m.d={};var h={script:!0,textarea:!0,template:!0};m.getBindingHandler=function(e){return m.d[e]};m.Q=function(e,t,n,r,i){function s(){var i=l?e():e,s=m.a.c(i);t?(t.P&&t.P(),m.a.extend(f,t),f.P=a):(f.$parents=[],f.$root=s,f.ko=m);f.$rawData=i;f.$data=s;n&&(f[n]=s);r&&r(f,t,s);return f.$data}var u,a,f=this,l="function"==typeof e&&!m.H(e);i&&i.exportDependencies?s():(a=m.B(s,null,{wa:function(){return u&&!m.a.Rb(u)},i:!0})).ba()&&(f.P=a,a.equalityComparer=null,u=[],a.Bc=function(e){u.push(e);m.a.F.oa(e,function(e){m.a.Ma(u,e);u.length||(a.k(),f.P=a=o)})})};m.Q.prototype.createChildContext=function(e,t,n,r){return new m.Q(e,this,t,function(e,t){e.$parentContext=t;e.$parent=t.$data;e.$parents=(t.$parents||[]).slice(0);e.$parents.unshift(e.$parent);n&&n(e)},r)};m.Q.prototype.extend=function(e){return new m.Q(this.P||this.$data,this,null,function(t,n){t.$rawData=n.$rawData;m.a.extend(t,"function"==typeof e?e():e)})};m.Q.prototype.Zb=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var p=m.a.f.I(),d=m.a.f.I();m.vc=function(e,t){if(2!=arguments.length)return m.a.f.get(e,d);m.a.f.set(e,d,t),t.P&&t.P.Bc(e)};m.Ja=function(e,t,n){1===e.nodeType&&m.e.mc(e);return f(e,t,c(n),!0)};m.Ec=function(e,t,n){n=c(n);return m.Ja(e,r(t,n,e),n)};m.Ka=function(e,t){1!==t.nodeType&&8!==t.nodeType||s(c(e),t,!0)};m.Sb=function(e,t){!l&&u.jQuery&&(l=u.jQuery);if(t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||u.document.body;a(c(e),t,!0)};m.kb=function(e){switch(e.nodeType){case 1:case 8:var t=m.vc(e);if(t)return t;if(e.parentNode)return m.kb(e.parentNode)}return o};m.Kc=function(e){return(e=m.kb(e))?e.$data:o};m.b("bindingHandlers",m.d);m.b("applyBindings",m.Sb);m.b("applyBindingsToDescendants",m.Ka);m.b("applyBindingAccessorsToNode",m.Ja);m.b("applyBindingsToNode",m.Ec);m.b("contextFor",m.kb);m.b("dataFor",m.Kc)})();(function(e){function t(t,r){var o,u=i.hasOwnProperty(t)?i[t]:e;u?u.Y(r):((u=i[t]=new m.J).Y(r),n(t,function(e,n){var r=!(!n||!n.synchronous);s[t]={definition:e,$c:r};delete i[t];o||r?u.notifySubscribers(e):m.Z.Xa(function(){u.notifySubscribers(e)})}),o=!0)}function n(e,t){r("getConfig",[e],function(n){n?r("loadComponent",[e,n],function(e){t(e,n)}):t(null,null)})}function r(t,n,i,s){s||(s=m.g.loaders.slice(0));var o=s.shift();if(o){var u=o[t];if(u){var a=!1;if(u.apply(o,n.concat(function(e){a?i(null):null!==e?i(e):r(t,n,i,s)}))!==e&&(a=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(t,n,i,s)}else i(null)}var i={},s={};m.g={get:function(n,r){var i=s.hasOwnProperty(n)?s[n]:e;i?i.$c?m.l.w(function(){r(i.definition)}):m.Z.Xa(function(){r(i.definition)}):t(n,r)},Yb:function(e){delete s[e]},Kb:r};m.g.loaders=[];m.b("components",m.g);m.b("components.get",m.g.get);m.b("components.clearCachedDefinition",m.g.Yb)})();(function(){function e(e,t,n,r){function s(){0==--u&&r(o)}var o={},u=2,a=n.template;n=n.viewModel;a?i(t,a,function(t){m.g.Kb("loadTemplate",[e,t],function(e){o.template=e;s()})}):s();n?i(t,n,function(t){m.g.Kb("loadViewModel",[e,t],function(e){o[f]=e;s()})}):s()}function n(e){switch(m.a.A(e)){case"script":return m.a.ma(e.text);case"textarea":return m.a.ma(e.value);case"template":if(r(e.content))return m.a.ua(e.content.childNodes)}return m.a.ua(e.childNodes)}function r(e){return u.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function i(e,n,r){"string"==typeof n.require?t||u.require?(t||u.require)([n.require],r):e("Uses require, but no AMD loader is present"):r(n)}function s(e){return function(t){throw Error("Component '"+e+"': "+t)}}var o={};m.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(m.g.ub(e))throw Error("Component "+e+" is already registered");o[e]=t};m.g.ub=function(e){return o.hasOwnProperty(e)};m.g.pd=function(e){delete o[e];m.g.Yb(e)};m.g.ac={getConfig:function(e,t){t(o.hasOwnProperty(e)?o[e]:null)},loadComponent:function(t,n,r){var o=s(t);i(o,n,function(n){e(t,o,n,r)})},loadTemplate:function(e,t,i){e=s(e);if("string"==typeof t)i(m.a.ma(t));else if(t instanceof Array)i(t);else if(r(t))i(m.a.W(t.childNodes));else if(t.element)if(t=t.element,u.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)i(n(t));else if("string"==typeof t){var o=a.getElementById(t);o?i(n(o)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,n){(function e(t,n,r){if("function"==typeof n)r(function(e){return new n(e)});else if("function"==typeof n[f])r(n[f]);else if("instance"in n){var i=n.instance;r(function(){return i})}else"viewModel"in n?e(t,n.viewModel,r):t("Unknown viewModel value: "+n)})(s(e),t,n)}};var f="createViewModel";m.b("components.register",m.g.register);m.b("components.isRegistered",m.g.ub);m.b("components.unregister",m.g.pd);m.b("components.defaultLoader",m.g.ac);m.g.loaders.push(m.g.ac);m.g.Cc=o})();(function(){function e(e,n){if(r=e.getAttribute("params")){var r=t.parseBindingsString(r,n,e,{valueAccessors:!0,bindingParams:!0}),i=(r=m.a.Ca(r,function(t){return m.m(t,null,{i:e})}),m.a.Ca(r,function(t){var n=t.t();return t.ba()?m.m({read:function(){return m.a.c(t())},write:m.Ba(n)&&function(e){t()(e)},i:e}):n}));i.hasOwnProperty("$raw")||(i.$raw=r);return i}return{$raw:{}}}m.g.getComponentNameForNode=function(e){var t=m.a.A(e);if(m.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=m.a.C&&e.tagName===t))return t};m.g.Pb=function(t,n,r,i){if(1===n.nodeType){var s=m.g.getComponentNameForNode(n);if(s){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:s,params:e(n,r)};t.component=i?function(){return o}:o}}return t};var t=new m.R;9>m.a.C&&(m.g.register=(function(e){return function(t){a.createElement(t);return e.apply(this,arguments)}})(m.g.register),a.createDocumentFragment=(function(e){return function(){var t,n=e(),r=m.g.Cc;for(t in r)r.hasOwnProperty(t)&&n.createElement(t);return n}})(a.createDocumentFragment))})();(function(e){var t=0;m.d.component={init:function(e,n,r,i,s){function o(){var e=u&&u.dispose;"function"==typeof e&&e.call(u);a=u=null}var u,a,f=m.a.W(m.e.childNodes(e));m.a.F.oa(e,o);m.m(function(){var r,i,l=m.a.c(n());"string"==typeof l?r=l:(r=m.a.c(l.name),i=m.a.c(l.params));if(!r)throw Error("No component name specified");var c=a=++t;m.g.get(r,function(t){if(a===c){o();if(!t)throw Error("Unknown component '"+r+"'");(function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=m.a.ua(t);m.e.da(n,e)})(r,t,e);var n=(function(e,t,n,r){var i=e.createViewModel;return i?i.call(e,r,{element:t,templateNodes:n}):r})(t,e,f,i);t=s.createChildContext(n,void 0,function(e){e.$component=n;e.$componentTemplateNodes=f});u=n;m.Ka(t,e)}})},null,{i:e});return{controlsDescendantBindings:!0}}};m.e.V.component=!0})();var L={class:"className",for:"htmlFor"};m.d.attr={update:function(e,t){var n=m.a.c(t())||{};m.a.D(n,function(t,n){var r=!1===(n=m.a.c(n))||null===n||n===o;r&&e.removeAttribute(t);8>=m.a.C&&t in L?(t=L[t],r?e.removeAttribute(t):e[t]=n):r||e.setAttribute(t,n.toString());"name"===t&&m.a.tc(e,r?"":n.toString())})}};(function(){m.d.checked={after:["value","attr"],init:function(e,t,n){function r(){var r=e.checked,s=h?i():r;if(!m.va.Ta()&&(!u||r)){var o=m.l.w(t);if(f){var a=l?o.t():o;c!==s?(r&&(m.a.pa(a,s,!0),m.a.pa(a,c,!1)),c=s):m.a.pa(a,s,r);l&&m.Ba(o)&&o(a)}else m.h.Ea(o,n,"checked",s,!0)}}var i=m.pc(function(){return n.has("checkedValue")?m.a.c(n.get("checkedValue")):n.has("value")?m.a.c(n.get("value")):e.value}),s="checkbox"==e.type,u="radio"==e.type;if(s||u){var a=t(),f=s&&m.a.c(a)instanceof Array,l=!(f&&a.push&&a.splice),c=f?i():o,h=u||f;u&&!e.name&&m.d.uniqueName.init(e,function(){return!0});m.m(r,null,{i:e});m.a.p(e,"click",r);m.m(function(){var n=m.a.c(t());e.checked=f?0<=m.a.o(n,i()):s?n:i()===n},null,{i:e});a=o}}};m.h.ea.checked=!0;m.d.checkedValue={update:function(e,t){e.value=m.a.c(t())}}})();m.d.class={update:function(e,t){var n=m.a.ab(m.a.c(t()));m.a.cb(e,e.__ko__cssValue,!1);e.__ko__cssValue=n;m.a.cb(e,n,!0)}};m.d.css={update:function(e,t){var n=m.a.c(t());null!==n&&"object"==typeof n?m.a.D(n,function(t,n){n=m.a.c(n);m.a.cb(e,t,n)}):m.d.class.update(e,t)}};m.d.enable={update:function(e,t){var n=m.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}};m.d.disable={update:function(e,t){m.d.enable.update(e,function(){return!m.a.c(t())})}};m.d.event={init:function(e,t,n,r,i){var s=t()||{};m.a.D(s,function(s){"string"==typeof s&&m.a.p(e,s,function(e){var o,u=t()[s];if(u){try{var a=m.a.W(arguments);r=i.$data;a.unshift(r);o=u.apply(r,a)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(s+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}};m.d.foreach={kc:function(e){return function(){var t=e(),n=m.a.zb(t);if(!n||"number"==typeof n.length)return{foreach:t,templateEngine:m.X.sb};m.a.c(t);return{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:m.X.sb}}},init:function(e,t){return m.d.template.init(e,m.d.foreach.kc(t))},update:function(e,t,n,r,i){return m.d.template.update(e,m.d.foreach.kc(t),n,r,i)}};m.h.ta.foreach=!1;m.e.V.foreach=!0;m.d.hasfocus={init:function(e,t,n){function r(r){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var s;try{s=i.activeElement}catch(e){s=i.body}r=s===e}i=t();m.h.Ea(i,n,"hasfocus",r,!0);e.__ko_hasfocusLastValue=r;e.__ko_hasfocusUpdating=!1}var i=r.bind(null,!0),s=r.bind(null,!1);m.a.p(e,"focus",i);m.a.p(e,"focusin",i);m.a.p(e,"blur",s);m.a.p(e,"focusout",s)},update:function(e,t){var n=!!m.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),m.l.w(m.a.Da,null,[e,n?"focusin":"focusout"]))}};m.h.ea.hasfocus=!0;m.d.hasFocus=m.d.hasfocus;m.h.ea.hasFocus=!0;m.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.Cb(e,t())}};d("if");d("ifnot",!1,!0);d("with",!0,!1,function(e,t){return e.Zb(t)});m.d.let={init:function(e,t,n,r,i){t=i.extend(t);m.Ka(t,e);return{controlsDescendantBindings:!0}}};m.e.V.let=!0;var A,O={};m.d.options={init:function(e){if("select"!==m.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function r(){return m.a.La(e.options,function(e){return e.selected})}function i(e,t,n){var r=typeof t;return"function"==r?t(e):"string"==r?e[t]:n}function s(t,r){if(d&&l)m.j.ha(e,m.a.c(n.get("value")),!0);else if(p.length){var i=0<=m.a.o(p,m.j.u(r[0]));m.a.uc(r[0],i);d&&!i&&m.l.w(m.a.Da,null,[e,"change"])}}var u=e.multiple,a=0!=e.length&&u?e.scrollTop:null,f=m.a.c(t()),l=n.get("valueAllowUnset")&&n.has("value"),c=n.get("optionsIncludeDestroyed");t={};var h,p=[];l||(u?p=m.a.fb(r(),m.j.u):0<=e.selectedIndex&&p.push(m.j.u(e.options[e.selectedIndex])));f&&(void 0===f.length&&(f=[f]),h=m.a.La(f,function(e){return c||e===o||null===e||!m.a.c(e._destroy)}),n.has("optionsCaption")&&null!==(f=m.a.c(n.get("optionsCaption")))&&f!==o&&h.unshift(O));var d=!1;t.beforeRemove=function(t){e.removeChild(t)};f=s;n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(f=function(e,t){s(0,t);m.l.w(n.get("optionsAfterRender"),null,[t[0],e!==O?e:o])});m.a.Bb(e,h,function(t,r,s){s.length&&(p=!l&&s[0].selected?[m.j.u(s[0])]:[],d=!0);r=e.ownerDocument.createElement("option");t===O?(m.a.$a(r,n.get("optionsCaption")),m.j.ha(r,o)):(s=i(t,n.get("optionsValue"),t),m.j.ha(r,m.a.c(s)),t=i(t,n.get("optionsText"),s),m.a.$a(r,t));return[r]},t,f);m.l.w(function(){l?m.j.ha(e,m.a.c(n.get("value")),!0):(u?p.length&&r().length<p.length:p.length&&0<=e.selectedIndex?m.j.u(e.options[e.selectedIndex])!==p[0]:p.length||0<=e.selectedIndex)&&m.a.Da(e,"change")});m.a.Oc(e);a&&20<Math.abs(a-e.scrollTop)&&(e.scrollTop=a)}};m.d.options.xb=m.a.f.I();m.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){m.a.p(e,"change",function(){var r=t(),i=[];m.a.q(e.getElementsByTagName("option"),function(e){e.selected&&i.push(m.j.u(e))});m.h.Ea(r,n,"selectedOptions",i)})},update:function(e,t){if("select"!=m.a.A(e))throw Error("values binding applies only to SELECT elements");var n=m.a.c(t()),r=e.scrollTop;n&&"number"==typeof n.length&&m.a.q(e.getElementsByTagName("option"),function(e){var t=0<=m.a.o(n,m.j.u(e));e.selected!=t&&m.a.uc(e,t)});e.scrollTop=r}};m.h.ea.selectedOptions=!0;m.d.style={update:function(e,t){var n=m.a.c(t()||{});m.a.D(n,function(t,n){null!==(n=m.a.c(n))&&n!==o&&!1!==n||(n="");e.style[t]=n})}};m.d.submit={init:function(e,t,n,r,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");m.a.p(e,"submit",function(n){var r,s=t();try{r=s.call(i.$data,e)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}};m.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.$a(e,t())}};m.e.V.text=!0;(function(){if(u&&u.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=u.opera&&u.opera.version&&parseInt(u.opera.version()),n=u.navigator.userAgent,r=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>m.a.C)var s=m.a.f.I(),a=m.a.f.I(),f=function(e){var t=this.activeElement;(t=t&&m.a.f.get(t,a))&&t(e)},l=function(e,t){var n=e.ownerDocument;m.a.f.get(n,s)||(m.a.f.set(n,s,!0),m.a.p(n,"selectionchange",f));m.a.f.set(e,a,t)};m.d.textInput={init:function(e,n,s){function u(t,n){m.a.p(e,t,n)}function a(){c||(h=e.value,c=m.a.setTimeout(f,4))}function f(){clearTimeout(c);h=c=o;var t=e.value;p!==t&&(p=t,m.h.Ea(n(),s,"textInput",t))}var c,h,p=e.value,d=9==m.a.C?a:f;10>m.a.C?(u("propertychange",function(e){"value"===e.propertyName&&d(e)}),8==m.a.C&&(u("keyup",f),u("keydown",f)),8<=m.a.C&&(l(e,d),u("dragend",a))):(u("input",f),5>r&&"textarea"===m.a.A(e)?(u("keydown",a),u("paste",a),u("cut",a)):11>t?u("keydown",a):4>i&&(u("DOMAutoComplete",f),u("dragdrop",f),u("drop",f)));u("change",f);m.m(function t(){var r=m.a.c(n());null!==r&&r!==o||(r="");h!==o&&r===h?m.a.setTimeout(t,4):e.value!==r&&(p=r,e.value=r)},null,{i:e})}};m.h.ea.textInput=!0;m.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}})();m.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++m.d.uniqueName.Jc;m.a.tc(e,n)}}};m.d.uniqueName.Jc=0;m.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],i=n.get("valueUpdate"),s=!1,o=null;i&&("string"==typeof i&&(i=[i]),m.a.ra(r,i),r=m.a.Ub(r));var u=function(){o=null;s=!1;var r=t(),i=m.j.u(e);m.h.Ea(r,n,"value",i)};!m.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=m.a.o(r,"propertychange")||(m.a.p(e,"propertychange",function(){s=!0}),m.a.p(e,"focus",function(){s=!1}),m.a.p(e,"blur",function(){s&&u()}));m.a.q(r,function(t){var n=u;m.a.od(t,"after")&&(n=function(){o=m.j.u(e);m.a.setTimeout(u,0)},t=t.substring(5));m.a.p(e,t,n)});var a=function(){var r=m.a.c(t()),i=m.j.u(e);if(null!==o&&r===o)m.a.setTimeout(a,0);else if(r!==i)if("select"===m.a.A(e)){var s=n.get("valueAllowUnset");(i=function(){m.j.ha(e,r,s)})();s||r===m.j.u(e)?m.a.setTimeout(i,0):m.l.w(m.a.Da,null,[e,"change"])}else m.j.ha(e,r)};m.m(a,null,{i:e})}else m.Ja(e,{checkedValue:t})},update:function(){}};m.h.ea.value=!0;m.d.visible={update:function(e,t){var n=m.a.c(t()),r="none"!=e.style.display;n&&!r?e.style.display="":!n&&r&&(e.style.display="none")}};A="click",m.d[A]={init:function(e,t,n,r,i){return m.d.event.init.call(this,e,function(){var e={};e[A]=t();return e},n,r,i)}};m.O=function(){};m.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")};m.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")};m.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||a).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new m.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new m.v.qa(e);throw Error("Unknown template type: "+e)};m.O.prototype.renderTemplate=function(e,t,n,r){e=this.makeTemplateSource(e,r);return this.renderTemplateSource(e,t,n,r)};m.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")};m.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text());e.text(t);e.data("isRewritten",!0)};m.b("templateEngine",m.O);m.Gb=(function(){function e(e,t,n,r){e=m.h.yb(e);for(var i=m.h.ta,s=0;s<e.length;s++){var o=e[s].key;if(i.hasOwnProperty(o)){var u=i[o];if("function"==typeof u){if(o=u(e[s].value))throw Error(o)}else if(!u)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+m.h.Va(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')";return r.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Pc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return m.Gb.ed(e,t)},n)},ed:function(r,i){return r.replace(t,function(t,n,r,s,o){return e(o,n,r,i)}).replace(n,function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",i)})},Fc:function(e,t){return m.M.wb(function(n,r){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&m.Ja(i,e,r)})}}})();m.b("__tr_ambtns",m.Gb.Fc);(function(){m.v={};m.v.n=function(e){if(this.n=e){var t=m.a.A(e);this.bb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}};m.v.n.prototype.text=function(){var e=1===this.bb?"text":2===this.bb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?m.a.Cb(this.n,t):this.n[e]=t};var e=m.a.f.I()+"_";m.v.n.prototype.data=function(t){if(1===arguments.length)return m.a.f.get(this.n,e+t);m.a.f.set(this.n,e+t,arguments[1])};var t=m.a.f.I();m.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(m.a.f.get(e,t)||{}).jb||(3===this.bb?e.content:4===this.bb?e:o);m.a.f.set(e,t,{jb:arguments[0]})};m.v.qa=function(e){this.n=e};m.v.qa.prototype=new m.v.n;m.v.qa.prototype.text=function(){if(0==arguments.length){var e=m.a.f.get(this.n,t)||{};e.Hb===o&&e.jb&&(e.Hb=e.jb.innerHTML);return e.Hb}m.a.f.set(this.n,t,{Hb:arguments[0]})};m.b("templateSources",m.v);m.b("templateSources.domElement",m.v.n);m.b("templateSources.anonymousTemplate",m.v.qa)})();(function(){function e(e,t,n){var r;for(t=m.e.nextSibling(t);e&&(r=e)!==t;)n(r,e=m.e.nextSibling(r))}function t(t,n){if(t.length){var r=t[0],i=t[t.length-1],s=r.parentNode,o=m.R.instance,u=o.preprocessNode;if(u){e(r,i,function(e,t){var n=e.previousSibling,s=u.call(o,e);s&&(e===r&&(r=s[0]||t),e===i&&(i=s[s.length-1]||n))});t.length=0;if(!r)return;r===i?t.push(r):(t.push(r,i),m.a.za(t,s))}e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||m.Sb(n,e)});e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||m.M.Ac(e,[n])});m.a.za(t,s)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,r,i,o,u){u=u||{};var a=(e&&n(e)||i||{}).ownerDocument,f=u.templateEngine||s;m.Gb.Pc(i,f,a);if("number"!=typeof(i=f.renderTemplate(i,o,u,a)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");a=!1;switch(r){case"replaceChildren":m.e.da(e,i);a=!0;break;case"replaceNode":m.a.sc(e,i);a=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+r)}a&&(t(i,o),u.afterRender&&m.l.w(u.afterRender,null,[i,o.$data]));return i}function i(e,t,n){return m.H(e)?e():"function"==typeof e?e(t,n):e}var s;m.Db=function(e){if(e!=o&&!(e instanceof m.O))throw Error("templateEngine must inherit from ko.templateEngine");s=e};m.Ab=function(e,t,u,a,f){if(((u=u||{}).templateEngine||s)==o)throw Error("Set a template engine before calling renderTemplate");f=f||"replaceChildren";if(a){var l=n(a);return m.B(function(){var s=t&&t instanceof m.Q?t:new m.Q(t,null,null,null,{exportDependencies:!0}),o=i(e,s.$data,s);s=r(a,f,o,s,u);"replaceNode"==f&&(l=n(a=s))},null,{wa:function(){return!l||!m.a.nb(l)},i:l&&"replaceNode"==f?l.parentNode:l})}return m.M.wb(function(n){m.Ab(e,t,u,n,"replaceNode")})};m.ld=function(e,n,s,u,a){function f(e,n){t(n,c);s.afterRender&&s.afterRender(n,e);c=null}function l(t,n){c=a.createChildContext(t,s.as,function(e){e.$index=n});return r(null,"ignoreTargetNode",i(e,t,c),c,s)}var c;return m.B(function(){var e=m.a.c(n)||[];void 0===e.length&&(e=[e]);e=m.a.La(e,function(e){return s.includeDestroyed||e===o||null===e||!m.a.c(e._destroy)});m.l.w(m.a.Bb,null,[u,e,l,s,f])},null,{i:u})};var u=m.a.f.I();m.d.template={init:function(e,t){var n=m.a.c(t());if("string"==typeof n||n.name)m.e.xa(e);else{if("nodes"in n){if(n=n.nodes||[],m.H(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=m.e.childNodes(e);n=m.a.lc(n);new m.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var s=t();n=!0;r=null;"string"==typeof(t=m.a.c(s))?t={}:(s=t.name,"if"in t&&(n=m.a.c(t.if)),n&&"ifnot"in t&&(n=!m.a.c(t.ifnot)));"foreach"in t?r=m.ld(s||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.Zb(t.data,t.as):i,r=m.Ab(s||e,i,t,e)):m.e.xa(e);i=r;(t=m.a.f.get(e,u))&&"function"==typeof t.k&&t.k();m.a.f.set(e,u,i&&i.ba()?i:o)}};m.h.ta.template=function(e){return 1==(e=m.h.yb(e)).length&&e[0].unknown||m.h.bd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"};m.e.V.template=!0})();m.b("setTemplateEngine",m.Db);m.b("renderTemplate",m.Ab);m.a.fc=function(e,t,n){if(e.length&&t.length){var r,i,s,o,u;for(r=i=0;(!n||r<n)&&(o=e[i]);++i){for(s=0;u=t[s];++s)if(o.value===u.value){o.moved=u.index;u.moved=o.index;t.splice(s,1);r=s=0;break}r+=s}}};m.a.ib=(function(){function e(e,t,n,r,i){var s,o,u,a,f,l=Math.min,c=Math.max,h=[],p=e.length,d=t.length,v=d-p||1,g=p+d+1;for(s=0;s<=p;s++)for(a=u,h.push(u=[]),f=l(d,s+v),o=c(0,s-1);o<=f;o++)u[o]=o?s?e[s-1]===t[o-1]?a[o-1]:l(a[o]||g,u[o-1]||g)+1:o+1:s+1;l=[];c=[];v=[];s=p;for(o=d;s||o;)d=h[s][o]-1,o&&d===h[s][o-1]?c.push(l[l.length]={status:n,value:t[--o],index:o}):s&&d===h[s-1][o]?v.push(l[l.length]={status:r,value:e[--s],index:s}):(--o,--s,i.sparse||l.push({status:"retained",value:t[o]}));m.a.fc(v,c,!i.dontLimitMoves&&10*p);return l.reverse()}return function(t,n,r){r="boolean"==typeof r?{dontLimitMoves:r}:r||{};n=n||[];return(t=t||[]).length<n.length?e(t,n,"added","deleted",r):e(n,t,"deleted","added",r)}})();m.b("utils.compareArrays",m.a.ib);(function(){function e(e,t,n,r,i){var s=[],u=m.B(function(){var o=t(n,i,m.a.za(s,e))||[];0<s.length&&(m.a.sc(s,o),r&&m.l.w(r,null,[n,o,i]));s.length=0;m.a.ra(s,o)},null,{i:e,wa:function(){return!m.a.Rb(s)}});return{ca:s,B:u.ba()?u:o}}var t=m.a.f.I(),n=m.a.f.I();m.a.Bb=function(r,i,s,u,a){function f(e,t){S=p[t];b!==t&&(N[e]=S);S.qb(b++);m.a.za(S.ca,r);g.push(S);E.push(S)}function l(e,t){if(e)for(var n=0,r=t.length;n<r;n++)t[n]&&m.a.q(t[n].ca,function(r){e(r,n,t[n].ja)})}i=i||[];u=u||{};var c,h=m.a.f.get(r,t)===o,p=m.a.f.get(r,t)||[],d=m.a.fb(p,function(e){return e.ja}),v=m.a.ib(d,i,u.dontLimitMoves),g=[],y=0,b=0,w=[],E=[];i=[];for(var S,x,T,N=[],C=(d=[],0);x=v[C];C++)switch(T=x.moved,x.status){case"deleted":T===o&&((S=p[y]).B&&(S.B.k(),S.B=o),m.a.za(S.ca,r).length&&(u.beforeRemove&&(g.push(S),E.push(S),S.ja===n?S=null:i[C]=S),S&&w.push.apply(w,S.ca)));y++;break;case"retained":f(C,y++);break;case"added":T!==o?f(C,T):(S={ja:x.value,qb:m.N(b++)},g.push(S),E.push(S),h||(d[C]=S))}m.a.f.set(r,t,g);l(u.beforeMove,N);m.a.q(w,u.beforeRemove?m.$:m.removeNode);for(C=0,h=m.e.firstChild(r);S=E[C];C++){S.ca||m.a.extend(S,e(r,s,S.ja,a,S.qb));for(y=0;v=S.ca[y];h=v.nextSibling,c=v,y++)v!==h&&m.e.ic(r,v,c);!S.Xc&&a&&(a(S.ja,S.ca,S.qb),S.Xc=!0)}l(u.beforeRemove,i);for(C=0;C<i.length;++C)i[C]&&(i[C].ja=n);l(u.afterMove,N);l(u.afterAdd,d)}})();m.b("utils.setDomNodeChildrenFromArrayMapping",m.a.Bb);m.X=function(){this.allowTemplateRewriting=!1};m.X.prototype=new m.O;m.X.prototype.renderTemplateSource=function(e,t,n,r){if(t=9>m.a.C||!e.nodes?null:e.nodes())return m.a.W(t.cloneNode(!0).childNodes);e=e.text();return m.a.ma(e,r)};m.X.sb=new m.X;m.Db(m.X.sb);m.b("nativeTemplateEngine",m.X);(function(){m.vb=function(){var e=this.ad=(function(){if(!l||!l.tmpl)return 0;try{if(0<=l.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1})();this.renderTemplateSource=function(t,n,r,i){i=i||a;r=r||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=t.data("precompiled");s||(s=t.text()||"",s=l.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s));t=[n.$data];n=l.extend({koBindingContext:n},r.templateOptions);(n=l.tmpl(s,t,n)).appendTo(i.createElement("div"));l.fragments={};return n};this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"};this.addTemplate=function(e,t){a.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")};0<e&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};m.vb.prototype=new m.O;var e=new m.vb;0<e.ad&&m.Db(e);m.b("jqueryTmplTemplateEngine",m.vb)})()})})()},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"r",function(){return u});n.d(t,"n",function(){return a});n.d(t,"i",function(){return f});var r,i,s=n(96),o=n(83);(function(e){e.App_LoadingStatus="App_LoadingStatus";e.SetOverlayContent="SetOverlayContnet";e.UI_CheckUserAccessAndGrantPermissions="UI_CheckUserAccessAndGrantPermissions";e.GetAccessToken="GetAccessToken";e.App_GetCustomAuthConfig="App_GetCustomAuthConfig";e.App_RefreshSessionInfo="App_RefreshSessionInfo";e.File_Rename="File_Rename";e.UI_CopyAndEdit="UI_CopyAndEdit";e.App_WopiInfoFromUrl="App_WopiInfoFromUrl";e.Edit_Notification="Edit_Notification";e.UI_FileEmbed="UI_FileEmbed";e.UI_ShareForm="UI_ShareForm";e.UI_SignIn="UI_SignIn";e.User_Activity="User_Activity";e.App_WopiDavUrlFromIds="App_WopiDavUrlFromIds";e.UI_FileVersions="UI_FileVersions";e.UI_FileProperties="UI_FileProperties";e.App_PushState="App_PushState";e.App_SwitchMode="App_SwitchMode";e.UI_Sharing="UI_Sharing";e.App_MoveToFolder="App_MoveToFolder";e.App_FilePicker="App_FilePicker"})(r||(r={}));(function(e){e.BlurFocus="BlurFocus";e.Host_AccessibilityLoopComplete="Host_AccessibilityLoopComplete";e.GrabFocus="GrabFocus";e.CanEmbed="CanEmbed";e.PostAccessToken="PostAccessToken";e.App_PopState="App_PopState";e.Host_RefreshSessionInfo="Host_RefreshSessionInfo";e.CheckUserAccessAndGrantPermissions_Result="CheckUserAccessAndGrantPermissions_Result";e.Host_WopiInfoFromUrl="Host_WopiInfoFromUrl";e.Host_DavUrlFromIds=" Host_DavUrlFromIds";e.Host_SetCustomAuthConfig="Host_SetCustomAuthConfig";e.SetOverlayContent="SetOverlayContent";e.Host_PerfTiming="Host_PerfTiming";e.Host_PostmessageReady="Host_PostmessageReady";e.Host_MoveToFolder="Host_MoveToFolder";e.Host_FilePicker="Host_FilePicker"})(i||(i={}));function u(){return{CorrelationId:o.e.generate(),MessageId:i.GrabFocus}}function a(){return{CorrelationId:o.e.generate(),MessageId:i.BlurFocus}}function f(e){var t;return function(n,r,i){return t?t(n,r,i):s.t.resolve(e()).then(function(e){return(t=e)(n,r,i)})}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"r",function(){return f});n.d(t,"s",function(){return l});n.d(t,"u",function(){return c});n.d(t,"l",function(){return p});n.d(t,"c",function(){return d});n.d(t,"f",function(){return v});n.d(t,"a",function(){return m});n.d(t,"g",function(){return g});n.d(t,"b",function(){return y});n.d(t,"y",function(){return b});n.d(t,"d",function(){return w});n.d(t,"v",function(){return E});n.d(t,"p",function(){return S});n.d(t,"m",function(){return x});n.d(t,"t",function(){return T});n.d(t,"n",function(){return N});n(88);var r=n(127),i=n(8),s=n(47);n.d(t,"o",function(){return s.n});n.d(t,"i",function(){return s.t});n.d(t,"h",function(){return s.i});n.d(t,"w",function(){return s.s});function o(e){var t=Object(s.r)(),n=u();return a("https://".concat(t).concat(n,"/redir?resid=").concat(e))}function u(){return 2===Object(r.e)()?"storage.live-int.com":"onedrive.live.com"}function a(e){return"u!".concat(window.btoa(e).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))}function f(e){void 0===e&&(e="v1.0");return"https://graph.microsoft.com/".concat(e)}function l(){return"https://substrate.office.com"}function c(){return"/picker/accountchooser"===document.location.pathname.toLowerCase()}function h(e){return"photos"===e.v}function p(e){return"places"===e.id&&h(e)}function d(e){return"tags"===e.id&&h(e)}function v(e){return"allmyphotos"===e.qt||"allmyphotos"===e.parQt}function m(e){return"albums"===e.id&&h(e)}function g(e){return!!e.id&&"albums"!==e.id&&"tags"!==e.id&&"places"!==e.id&&!!e.cid&&h(e)&&!v(e)}function y(e){return v(e)&&!!e.tagFilter&&h(e)}function b(e){return!!e.locationFilter&&h(e)}function w(e){return!!e.onThisDay&&h(e)}function E(e){return!!e.onThisMonth&&h(e)}function S(e){return!!e.lastWeekPreviousYears&&h(e)}function x(e){return e===i.e.RecycleBin}function T(e){var t=e.id;if(t){var n=t.indexOf("!");if(n>-1)return t.slice(0,n)}}function N(e){return e.ft}},function(e,t,n){"use strict";var r,i=n(0),s=n(30),o=n(12),u=n(8),a=n(80),f=n(39),l=n(66),c=n(27);(function(e){e[e.iosappstore=0]="iosappstore"})(r||(r={}));var h,p,d=r,v=n(5),m=n(9),g=n(113),y=n(122);(function(e){e[e.all=0]="all";e[e.folders=1]="folders";e[e.photos=2]="photos";e[e.documents=3]="documents";e[e.music=4]="music"})(h||(h={}));(function(e){e[e.anyDate=0]="anyDate";e[e.oneDay=1]="oneDay";e[e.oneWeek=2]="oneWeek";e[e.oneMonth=3]="oneMonth";e[e.oneYear=4]="oneYear"})(p||(p={}));var b=n(256),w=n(112),E=n(192),S=n(95),x=n(26),T=n(4),N=n(143),C=n(76),k=n(56),L=n(106),A=n(7);var O,M=n(252),_=n(20),D=n(88),P=n(127),H=n(65),B=n(16);(function(e){e[e.current=0]="current";e[e.focus=1]="focus";e[e.external=2]="external"})(O||(O={}));function j(e){var t=e.itemInfo,n=e.urlType,r=void 0===n?"default":n,i=e.preserveAction,u=void 0!==i&&i,a=e.viewParams,l=t.itemType,h=e.action,p=void 0===h?u&&Object(A.s)(a)||void 0:h,d=(function(e){var t;switch(e){case s.e.Media:t=O.focus;break;case s.e.Folder:case s.e.Error:t=O.current;break;default:t=O.external}return t})(l),v=!!B.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||l!==s.e.Media;a.mid&&v&&(d=O.current);return(function(e,t){var n=t.itemInfo,r=t.parentItemInfo,i=t.viewParams,u=t.useOneUpTextEditor,a=t.queryType,l=t.page,h=void 0===l?Object(A.w)(i):l,p=n.itemKey,d=n.itemExtension,v=n.itemType;if(e!==O.current&&h===o.e.FilePicker)return"";var g,y=Object(A.m)(p);if(Object(_.m)(a)&&!Object(_.m)(Object(A.T)(y)))return"";if(d&&Object(L.t)(d,v))e=u&&h!==o.e.TextFileEditor?O.focus:O.external;else if(h===o.e.TextFileEditor&&Object(A.s)(i)===c.t.createTextDocument)return"#"+m.t(i,null,!0);switch(e){case O.current:g=(function(e){var t=e.itemInfo,n=e.preserveAction,r=e.action,i=e.viewParams,s=e.page,o=e.additionalViewParams,u=t.itemKey;if(t.itemIsStub){var a=Object(A.l)(i);if(a){if(Object(A.s)(i)===c.t.locate)return"";delete i.viewer;return R({itemInfo:{itemKey:a},parentItemInfo:t,action:c.t.locate,viewParams:i})}}return Object(A.d)({itemKey:u,itemInfo:t,preserveAction:n,action:r,viewParams:i,page:s,additionalViewParams:o})})(t);break;case O.focus:g=q(t);break;default:g=(function(e){var t,n=e.itemInfo,r=e.viewParams,i=I({itemInfo:n,parentItemInfo:e.parentItemInfo}),o=n.itemKey,u=n.openItemByDefault,a=n.itemExtension,l=n.itemType,h=n.itemErrorType,p=n.itemOpenUrl;t=l===s.e.Error?(function(e){var t,n=e.itemKey,r=e.viewParams;switch(e.itemErrorType||f.e.requestFailed){case f.e.marketBlocked:return Object(A.y)();case f.e.userNotReady:return Object(A._)(Object(A.d)({itemKey:n,viewParams:r}));case f.e.accessDenied:var i=r.lor;return i&&i.toLowerCase()===D.n?"?".concat("v","=").concat("error","&").concat("type","=").concat(D.t):Object(A.D)(Object(A.d)({itemKey:n,viewParams:r,additionalViewParams:(t={},t.sc=r.sc||"",t)}));case f.e.authenticationExpired:return Object(A.D)(Object(A.d)({itemKey:n,viewParams:r}),!0);case f.e.userSuspended:var s=Object(A.s)(r)===c.t.feedback?c.t.feedback:void 0;return x.t.si?Object(A.D)(Object(A.d)({itemKey:n,viewParams:r,action:s}),!0):Object(A.d)({itemKey:n,action:s,viewParams:r});case f.e.passwordRequired:return Object(A.L)(r);case f.e.requestAccess:return Object(A.N)(r)}return Object(A.d)({itemKey:n,viewParams:r})})({itemKey:o,viewParams:r,itemErrorType:h}):a&&Object(L.t)(a,l)?F({itemInfo:n,parentItemInfo:i,viewParams:r}):void 0===u||u?u&&p&&-1===p.indexOf("redir.aspx")||a&&(".fluid"===a.toLowerCase()||".loop"===a.toLowerCase())?p:q({itemInfo:n,parentItemInfo:i,action:c.t.locate,viewParams:r}):q({itemInfo:n,parentItemInfo:i,action:c.t.defaultClick,viewParams:r});return t})({itemInfo:n,parentItemInfo:r,viewParams:i})}return g})(l===s.e.Error?O.external:"existing"===r?(function(e){var t;t=Object(A.l)(e)?O.focus:O.current;return t})(a):"focus"===r||p?p&&p!==c.t.locate&&d===O.current?d:O.focus:d,e)}function F(e){var t=e.itemInfo,n=e.parentItemInfo,r=e.viewParams,i=n&&n.itemKey,s=Object(A.p)({itemKey:t.itemKey,itemInfo:t,page:o.e.TextFileEditor,viewParams:r}),u=Object(A.m)(i||"");s.parId=u.id;var a=m.t(s,null,!0);return"TextFileEditor"!==r.v?Object(A.a)(2,a):"#"+a}function I(e){var t=e.itemInfo,n=e.parentItemInfo;return B.e.isActivated("6DCD168B-9EA1-4AD3-A81F-12E38ED97BF2","10/21/2021","Use getParentItemInfo")?n:n&&n.itemKey!==t.itemKey&&n||t.parentFolderItemInfo}function q(e){var t,n=e.itemInfo,r=I({itemInfo:n,parentItemInfo:e.parentItemInfo}),s=!1;B.e.isActivated("1065E6DF-81FE-4F4A-BB9A-625CC03793AA","10/21/2021","Compute URL using AllPhotos parentKey")||(s=Boolean("photos"===e.viewParams.v&&(n.itemIsVideo||n.itemIsPhoto)&&"allmyphotos"!==e.viewParams.qt&&!e.viewParams.parId&&!e.viewParams.parQt&&r&&!r.itemIsAlbum));var o=e;if(s){var u=Object(A.v)(((t={}).qt="allmyphotos",t.id="root",t.cid=A.H,t));o=Object(i.e)(Object(i.e)({},e),{parentItemInfo:{itemKey:u}})}return R(o)}function R(e){var t=e.itemInfo,n=e.parentItemInfo,r=e.viewParams,s=e.additionalViewParams,o=n&&n.itemKey||"",u=Object(A.m)(t.itemKey),a=Object(A.p)(Object(i.e)(Object(i.e)({},e),{itemKey:o,itemInfo:n}));s&&Object(H.e)(u,s);r&&r.commentId&&(u.commentId=r.commentId);u.parId=a.id;u.parQt=a.qt;if(u.cid!==a.cid){u.parCid=a.cid;delete a.cid}delete a.internalPath;delete a.qt;delete a.id;delete u.u;var f=a.action;if(f)if(r&&r.commentId&&"showproperties"===f.toLowerCase()){delete a.action;u.o=D.i}else{delete a.action;u.action=f}else u.o=D.i;return"#"+m.t(u,a,!0)}var U=n(193),z=n(53),W=n(60);function X(){var e="".concat("ps-hasProvision-").concat(Object(W.e)(A.H));return localStorage.getItem(e)}function V(){return Object(v.ne)(v.w)||(function(){if(!B.e.isActivated("D5468AE0-1714-40CA-A48A-0C7FB08CB87C","08/26/2022","Disable Photo Story for Converged User")&&Object(z.e)(A.H))return!1;var e=!B.e.isActivated("51EBAB33-7AA2-422B-A5FF-BF99D5296EC4","02/15/2022","Enable Photo story for users who were invited")&&"true"===X(),t=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{t=t||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return!t&&(Object(v.ne)(v.d)||e)})()}var $,J,K=n(249),Q=n(382),G=n(29),Y=window.$Config&&window.$Config.isINT,Z=window.FilesConfig&&window.FilesConfig.skyApiDomain,ee=window.FilesConfig&&window.FilesConfig.storageDomain,te=window.FilesConfig&&window.FilesConfig.mpcDomain;(function(e){e[e.DateCreated=0]="DateCreated";e[e.DateModified=1]="DateModified"})(J||(J={}));var ne=B.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),re=!B.e.isActivated("71CADB9F-8CE9-47DA-A4A3-0340D883A255","03/02/2023","Propogates redeemTokem if available in WAC open URLs"),ie=!B.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(v.ne)(v.J),se=new T.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new T.e(Object(v.ne)(v.Y))}),oe=new T.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new T.e(!ne)}),ue=new T.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new T.e(ie)}),ae=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var n=this,r=t.navigation,i=void 0===r?this.resources.consume(k.e):r,s=t.useOneUpTextEditor,o=void 0===s?this.resources.consume(se):s,u=t.enableFastOneUp,a=void 0===u?this.resources.consume(ue):u,f=t.useRefactoredDefaultClickUrl,l=void 0===f?this.resources.consume(oe):f;this._navigation=i;this._useOneUpTextEditor=o;this._enableFastOneUp=a;this._useRefactoredDefaultClickUrl=l;this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?A.u:this.getCurrentPageBaseUrl);this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName;this._events=new C.e(this);(this._mayBeFastOneUp=this._enableFastOneUp&&Object(v.ne)(v.J)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){if(!n.getFocusItemKey(n._navigation.viewParams)){n._mayBeFastOneUp=!1;n._events.off(n._navigation)}})}e.getKey=function(e){void 0===e&&(e={});return Object(A.v)(e)};e.getKeyParams=function(e){return Object(A.m)(e)};e.getIsSyncUserBusiness=function(e){return"b"===e.pt};e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0};e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t};e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"};e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"};e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"};e.getImpressumUrl=function(){return Object(A.c)()};e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+m.t({resid:e})};e.encodeSharingUrl=function(e){return Object(_.e)(e)};e.getThumbnailUrl=function(t,n,r,i){i=i||r;return g.n(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,m.t({width:r,height:i,cropmode:"center"}))};e.getVroomBaseUrl=function(e){return Object(_.o)(e)};e.getAutoRedeemRedirectUrl=function(t){var n="",r=t.viewParams,i=r.id,s=r.cid,o=r.action;r.autoredeeem&&i&&s&&o&&(n=e.getAutoRedeemLoginUrl(i,s,o,t));return n};e.getAutoRedeemLoginUrl=function(t,n,r,i){var s,o=e._getAutoRedeemUrl(t,n,r,!1,i.viewParams),u=((s={}).ru=o,s.wreply=o,s);return x.t.signInUrl+"&"+m.t(u,null,!0)};e.getAutoRedeemLogoutUrl=function(t,n,r,i){var s,o=e._getAutoRedeemUrl(t,n,r,!0,i.viewParams),u=((s={}).lru=o,s);return x.t.autoRedeemSignOut+"&"+m.t(u,null,!0)};e.getCookieDomain=function(){return window.$Config.sd};e.getEnvironment=function(){return Object(P.e)()};e.areCidsEqual=function(e,t){return Object(M.e)(e,t)};e._getAutoRedeemUrl=function(e,t,n,r,i){var s,o=((s={}).id=e,s.cid=t,s.action=n,s.authkey=i.authkey,s);r&&(o.autoredeeem="1");return window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.t(o,null,!0)};e.prototype.getDefaultRootItemId=function(){return"root"};e.prototype.getKey=function(t){return e.getKey(t)};e.prototype.getKeyParams=function(e){return Object(A.m)(e)};e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var r,i,s=((r={resid:e,ithint:t}).challengeToken=n,r.v="requestaccess",r),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.t(s,null,!0),u=((i={}).lru=o,i);return x.t.autoRedeemSignOut+"&"+m.t(u,null,!0)};e.prototype.getItemHintRedirectViewParams=function(e){void 0===e&&(e={});return Object(A.h)(e)};e.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(A.T)(e)};e.prototype.getPhotoType=function(e){return Object(A.S)(e)};e.prototype.getPageType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return Object(A.w)(e,this._mayBeFastOneUp||t)};e.prototype.getViewerType=function(e){return(function(e){var t=e.viewer;switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}})(e)};e.prototype.saveViewerType=function(e){return(function(e){var t;return(t={}).viewer=e,t})(e)};e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(A.l)(e)};e.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(A.o)(e)};e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),r=this.getKeyParams(t);delete n.u;delete r.u;return this.getKey(n)===this.getKey(r)};e.prototype.getRootItemKey=function(e){void 0===e&&(e=u.e.Files);return Object(A.C)(e)};e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(_.m)(e):e===u.e.RecycleBin};e.prototype.isCurrentQueryPhotoStream=function(e){void 0===e&&(e=this._navigation.viewParams);return"photostream"===e.qt};e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!B.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(A.M)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(A.n)(e)};e.prototype.isCurrentQueryRecent=function(e){void 0===e&&(e=this._navigation.viewParams);return"mru"===e.qt};e.prototype.isCurrentQuerySharedWithMe=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(A.O)(e)};e.prototype.isCurrentQuerySharedByMe=function(e){void 0===e&&(e=this._navigation.viewParams);return"sharedbyme"===e.qt};e.prototype.isCurrentQuerySharedFilesRoot=function(e){void 0===e&&(e=this._navigation.viewParams);return"sharedbyme"===e.qt||"sharedby"===e.qt};e.prototype.isCurrentQueryRecycleBin=function(e){void 0===e&&(e=this._navigation.viewParams);return"recyclebin"===e.qt};e.prototype.getDisableQueryAlteration=function(e){void 0===e&&(e=this._navigation.viewParams);return!1};e.prototype.isCurrentQuery=function(e,t){void 0===t&&(t=this._navigation.viewParams);switch(e){case u.e.Files:return this.isCurrentQueryFiles();case u.e.Recent:return this.isCurrentQueryRecent();case u.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case u.e.SharedByMe:return this.isCurrentQuerySharedByMe();case u.e.RecycleBin:return this.isCurrentQueryRecycleBin();case u.e.Photos:case u.e.AllMyPhotos:return Object(A.A)(t);case u.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===u.e[e].toString().toLowerCase()}};e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:o.e.Files}))};e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(z.e)(A.H)&&!Object(v.ne)(v.e)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:o.e.Files}))};e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:o.e.Files}))};e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var r=Object(i.e)({},this._navigation.viewParams);t||delete r.psShareId;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=r.psShareId,n.psPostId=r.psPostId,n.pssc=r.pssc,n)),{page:o.e.PhotoStream,viewParams:r}))};e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(i.e)({},this._navigation.viewParams);e||delete n.psShareId;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:o.e.PhotoStream,viewParams:n}))};e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+m.t(n,null,!0)};e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var r,s=Object(i.e)({},this._navigation.viewParams);delete s.psShareId;return this._requireAuthentication(this.getItemUrl(this.getKey(((r={}).qt="photostream",r.v="photoStream",r.mojDate=e,r.moj=t,r.psRIds=n.join(","),r)),{page:o.e.PhotoStream,viewParams:s}))};e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:o.e.Photos}))};e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:o.e.Photos}))};e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:o.e.Photos}))};e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:o.e.Photos}))};e.prototype.getOnThisDayQueryUrl=function(e,t){var n,r;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:o.e.Photos,additionalViewParams:(r={},r.sc=e&&e.sc||"",r)}))};e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))};e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))};e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))};e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:o.e.Photos})};e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:o.e.Files}))};e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(K.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:o.e.Files}))};e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"};e.prototype.getOptionsUrl=function(e){void 0===e&&(e=this._navigation.viewParams);return this.getNewManageStorageUrl()};e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"};e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+m.t(t,null,!0);return this._requireAuthentication(n)};e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+m.t(t,null,!0);return this._requireAuthentication(n)};e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+m.t(t,null,!0);return this._requireAuthentication(n)};e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(v.ne)(v.b)&&Object(z.e)(A.H)){var t=((e={}).v="documentoptions",e),n="#"+m.t(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"};e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"};e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)};e.prototype.getNotificationOptionsUrl=function(){var e;if(V()){var t=((e={}).v="NotificationOptions",e),n="#"+m.t(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/NotificationOptions"};e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"};e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"};e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),r="#"+m.t(n,null,!0);return this._requireAuthentication(r)};e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){void 0===t&&(t=this._navigation.viewParams);return Object(A.b)({wtcParam:e,viewParams:t,hideLeftNav:n})};e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var r=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+m.t(r,null,!0);return this._requireAuthentication(i)};e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"};e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+m.t(n)};e.prototype.getUserInfoApiUrl=function(){return Object(U.e)()};e.prototype.setUserInfoApiUrl=function(){return Object(U.t)()};e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"};e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,r=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),s=x.t.canary,o={cid:n,authKey:r,ticket:i,resid:e.id,canary:s};if(e.video){var u=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,u)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+m.t(o,null,!0)};e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+m.t(n,null,!0)};e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+m.t(t,null,!0)};e.prototype.getPermissionsUrl=function(t,n){var r;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),s=((r={}).id=t.id,r);i&&(s.authkey=i);return e.skyApiBaseUrl+"GetPermissions?"+m.t(s)};e.prototype.getSearchQueryUrl=function(e,t){var n,r=e.query,i=e.dateFilter,s=e.conversationId,o=e.largestSize,u=e.filter;u||(u=Object(A.A)(this._navigation.viewParams)?h.photos:h.all);var a=((n={}).qt="search",n.q=r,n.searchsessionid=s,n.ft=A.t[h[u]],n);if("number"==typeof i&&i!==p.anyDate){var f=new Date,l=this._getDateDuration(i,f);a.df=J[J.DateCreated];a.beginDate=l.toISOString();a.endDate=f.toISOString()}o&&(a.sp="size");return this.getItemUrl(this.getKey(a),t)};e.prototype.getSearchFilterQueryUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);return this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})};e.prototype.isSearchFilterApplied=function(e,t){void 0===t&&(t=this._navigation.viewParams);return this.getContextualFilter(t)===String(A.t[h[e]])};e.prototype.getSearchByDateFilterQueryUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);return this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:h[String(A.t[this.getContextualFilter(t)])],dateFilter:e})};e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e};e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A.s)(e);var t=e.action||"";return c.e[t.toLowerCase()]||c.t.none};e.prototype.getQueryParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.q};e.prototype.getCommentIdParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.commentId};e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]};e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(S.e.folder);16==(16&n)&&t.push(S.e.document);8==(8&n)&&t.push(S.e.media);for(var r=0,i=(e.ext||"").split(";");r<i.length;r++){var s=i[r];t.push(s)}return{filters:t}};e.prototype.saveItemTypeFilter=function(e){void 0===e&&(e={filters:[]});return Object(A.P)(e)};e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")};e.prototype.saveUsersFilter=function(e){var t={};t.userFilters=e&&e.join(";#");return t};e.prototype.saveDateDurationFilter=function(e){return{}};e.prototype.getDateDurationFilter=function(e){return""};e.prototype.getIAmValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.iam};e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"};e.prototype.getCidFromResourceId=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(_.t)(e)};e.prototype.getCreateTextDocumentUrl=function(t,n,r){void 0===r&&(r=this._navigation.viewParams);var i={};i.id=t;i.cid=n;i.iam=this.getIAmParamValue(r);i.action=e.createTextDocumentActionValue;i.v="TextFileEditor";var s=m.t(i,null,!0);return this._getCurrentPageUrl(2,s)};e.prototype.getCreateDocumentInTabUrl=function(e,t,n,r){var i;void 0===r&&(r=this._navigation.viewParams);var s,o=this.getAuthKeyParamValue(r),u=this.getTicketParamValue(r),a=this.getIAmParamValue(r),f=r.qt,l=1===e.documentFormat?"odf":"",h=((i={}).cid=e.ownerId,i.wacqt=f||"",i.wdo=1,i);if(n){s="?";h.id=e.id;var p=void 0;switch(t){case"w":p=c.t.createWord;break;case"x":p=c.t.createExcel;break;case"p":p=c.t.createPowerPoint;break;case"n":p=c.t.createOneNote}h.action=p&&c.t[p].toLowerCase()||""}else{s="/create.aspx?";h.parId=e.id;h.nd=t+l}o&&(h.authkey=o);u&&(h.ticket=u);a&&(h.iam=a);return s+m.t(h)};e.prototype.getDownloadItemUrl=function(e,t,n,r){void 0===r&&(r=this._navigation.viewParams);if(e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(r),s=this.getTicketParamValue(r),o=this.getIAmParamValue(r),u={cid:e.ownerId,authKey:i,ticket:s,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+m.t(u,null,!0)};e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),r=this.getTicketParamValue(t),i=this.getIAmParamValue(t),s=x.t.canary,o={cid:e.ownerId,authKey:n,ticket:r,iam:i,resid:e.id,canary:s,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+m.t(o,null,!0)};e.prototype.getVersionHistoryUrl=function(e,t,n){var r,s;void 0===n&&(n=this._navigation.viewParams);var o=this.getIAmParamValue(n),u=this.getAuthKeyParamValue(n),a=n.redeem,f=Object(i.e)(Object(i.e)({cid:e,resid:t,iam:o},u?((r={}).authkey=u,r):{}),re&&a?((s={}).redeem=a,s):{});return"/versions.aspx?"+m.t(f,null,!0)};e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var r,i=n.forceReadOnly,s=void 0!==i&&i,o=e.properties.commandsSupported,u=(void 0===o?{}:o).defc,a=e.openUrl;if(s)r="view.aspx";else switch(u){case"2":r="edit.aspx";break;default:r="view.aspx"}var f=(null==e?void 0:e.itemId)||(null==e?void 0:e.id);if(f){var l=new G.t("/".concat(r));l.setQueryParameter("resid",f);var c=this.getAuthKeyParamValue(t);c&&l.setQueryParameter("authkey",c);var h=t.redeem;re&&h&&l.setQueryParameter("redeem",h);if(!A.e)for(var p in t)p.startsWith("wd")&&l.setQueryParameter(p,t[p]);return l.toString()}var d=Object(b.t)(e),v=a.indexOf("?")>0?"&":"?";return a.replace("redir.aspx",r).replace("download.aspx",r)+v+m.t({app:d,wdo:1,wacqt:t.qt},null,!0)};e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var r,s,o,u;void 0===t&&(t=this._navigation.viewParams);if(!B.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(z.e)(e.ownerId)){var a=null!==(o=null===(s=e.properties)||void 0===s?void 0:s.path)&&void 0!==o?o:null===(u=e.itemFromServer)||void 0===u?void 0:u.webDavUrl;return Object(Q.e)(e.appMap,a,e.extension,!0,!1)}var f=this.getAuthKeyParamValue(t),l=this.getIAmParamValue(t),c=t.redeem,h=Object(i.e)({cid:n,resid:e.id,authKey:f,iam:l,autoRedirect:"false"},re&&c?((r={}).redeem=c,r):{});return this.getCurrentPageBaseUrl()+"/openinclient?"+m.t(h,null,!0)};e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""};e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+m.t(n,null,!0)};e.prototype.getDownloadAsZipPostUrl=function(t,n,r){void 0===r&&(r=this._navigation.viewParams);var i=g.n(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),s=r,o={authKey:s.authkey,ticket:s.ticket,iam:this.getIAmParamValue(s),application:n};return i+"?"+m.t(o,null,!0)};e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId};e.prototype.getSharedByUrl=function(e,t,n){var r,s;return this.getItemUrl(this.getKey(Object(i.e)(((r={}).qt="sharedby",r.id=e,r.cid=t,r),n?((s={}).groupId=n,s):{})))};e.prototype.getExternalUrl=function(t){var n=d[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n};e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?g.n(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+y.e.encodeURIComponent(n):g.n(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+y.e.encodeURIComponent(n)};e.prototype.getAppSubfolder=function(){return"odc"};e.prototype.getDefaultClickUrl=function(e,t){var n,r,o,u,a,f,l,h,p,d;void 0===t&&(t={});var g,y=t.viewParams,b=void 0===y?this._navigation.viewParams:y,w=t.itemSet,E=t.urlType,S=void 0===E?"default":E,x=t.preserveAction,T=void 0!==x&&x,N=t.action,C=void 0===N?T&&this.getAutoActionType(b)||void 0:N;if(!e||!e.key)return"";Object(v.ne)(v.V)&&Object(z.e)(A.H)&&"PersonalVault"===(null===(f=null===(a=null===(u=e.itemFromServer)||void 0===u?void 0:u.remoteItem)||void 0===a?void 0:a.sharepointIds)||void 0===f?void 0:f.webRelativeListUrl)&&(e=Object(i.e)(Object(i.e)({},e),{key:m.t((n={},n.mcid=m.e(e.key).cid,n.mid=m.e(e.key).id,n.cid=null===(l=e.graph)||void 0===l?void 0:l.driveId,n.id=null===(h=e.graph)||void 0===h?void 0:h.itemId,n))}));if(b.sb){!this.isCurrentQuery(e.queryType,b)||(e=Object(i.e)(Object(i.e)({},e),{key:m.t(Object(i.e)(Object(i.e)({},m.e(e.key)),(r={},r.sb=b.sb,r.sd=b.sd,r)))}))}if(b.mcid){this.getKeyParams(e.key).cid===(b.cid||b.parCid)&&(e=Object(i.e)(Object(i.e)({},e),{key:m.t(Object(i.e)(Object(i.e)({},m.e(e.key)),(o={},o.mcid=b.mcid,o.mid=b.mid,o)))}))}if(this._useRefactoredDefaultClickUrl){var k=null===(d=null===(p=null==e?void 0:e.properties)||void 0===p?void 0:p.commandsSupported)||void 0===d?void 0:d.defc,L=w&&w.item.peek(),M=L&&L.key!==e.key&&L||e.UNSAFE_parent,_=M&&M.key,D=void 0;k&&(D="1"===k);return j({itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:D},parentItemInfo:M&&{itemKey:_,itemIsAlbum:M.isAlbum,itemIsPlaceholder:M.isPlaceholder,itemIsStub:M.isStub,itemVirtualItemType:M.virtualItemType,itemExtension:M.extension,itemType:M.type,itemOpenUrl:M.openUrl,itemErrorType:M.error&&M.error.type},preserveAction:T,action:C,viewParams:b,page:t.page,useOneUpTextEditor:this._useOneUpTextEditor,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:S})}var P=this._getDefaultUrlFormat(e),H=!!B.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==s.e.Media;b.mid&&H&&(P=O.current);g=e.type===s.e.Error?O.external:"existing"===S?this._getCurrentUrlFormat(b):"focus"===S||C?C&&C!==c.t.locate&&P===O.current?P:O.focus:P;return this._getItemClickUrl(e,w,g,t)};e.prototype.getTagUrl=function(e){var t,n="";n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:o.e.Photos}))};e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A.i)(e);var t=x.t.signInUrl;if(window.location.href.indexOf("iam=")>-1){t+="&redirect_uri={0}";e=this.getCurrentPageBaseUrl()+"/business"}else t+="&ru={0}&wreply={0}";return g.n(t,y.e.encodeURIComponent(e||window.location.href))};e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(A.g)()};e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+m.t(n,null,!0)};e.prototype.getCurrentSiteUrl=function(){return window.location.href};e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host};e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(A.y)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"};e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(A.L)(this._navigation.viewParams);var e={};e.id=this._navigation.viewParams.id;e.challengeToken=this._navigation.viewParams.authkey;e.v="validatepermission";return this.getCurrentPageBaseUrl()+"?"+m.t(e,null,!0)};e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(A.N)(this._navigation.viewParams);var e={};e.id=this._navigation.viewParams.id;e.challengeToken=this._navigation.viewParams.authkey;e.v="requestaccess";return this.getCurrentPageBaseUrl()+"?"+m.t(e,null,!0)};e.prototype.handleFatalErrorDuringViewLoad=function(){if(0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1)this._setFatalErrorCookie(0,!0);else if(0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1){this._setFatalErrorCookie(3,!1);window.top.location=document.location.href}else if(0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1){this._setFatalErrorCookie(2,!1);location.reload(!0)}else{this._setFatalErrorCookie(1,!1);window.top.location=document.location.href}};e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)};e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});if(this._useRefactoredDefaultClickUrl){var n=t.viewParams,r=void 0===n?this._navigation.viewParams:n,s=t.item;return Object(A.d)(Object(i.e)(Object(i.e)({},t),{itemKey:e,itemInfo:s&&{itemKey:s.key,itemIsPlaceholder:s.isPlaceholder,itemVirtualItemType:s.virtualItemType,itemExtension:s.extension,itemType:s.type},viewParams:r}))}var o=this._getItemQueryParams(e,t),u=t.additionalViewParams;u&&u.sc?Object(H.e)(o,u):delete o.sc;return"#"+m.t(o,null,!0)};e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+m.t(n,null,!0)};e.prototype.getApiName=function(){return"Vroom"};e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)};e.prototype.getAppliedDateFilter=function(e){void 0===e&&(e=this._navigation.viewParams);var t;if(!e.df)return p.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=p.oneDay;break;case 30:t=p.oneMonth;break;case 7:t=p.oneWeek;break;case 365:t=p.oneYear}return t};e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"};e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(Y?"live-int":"live",".com/?rru=hip")};e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"};e.prototype.isSearchPassThrough=function(e){void 0===e&&(e=this._navigation.viewParams);return!!e.sp};e.prototype.isLargestFilesView=function(e){void 0===e&&(e=this._navigation.viewParams);return"size"===e.sp};e.prototype.getNavLinkClickUrl=function(e){return""};e.prototype.qualifyUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A._)(e);0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1)));return e};e.prototype.getSignInUrlWithAction=function(e,t){var n=t||x.t.si;if(!n)return"";var r=w.t(n),i=m.e(r),s=i.wreply,o=w.t(s),u=m.e(o);u.action=c.t[e];i.wreply="".concat(w.n(s),"?").concat(m.t(u));return"".concat(w.n(n),"?").concat(m.t(i))};e.prototype.getNewPlaceholderItemKey=function(){var t;return m.t(((t={}).id="placeHolder ".concat(e.placeholderId++),t))};e.prototype.getIAmParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.iam};e.prototype.getAuthKeyParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(A.r)(e)};e.prototype.getTicketParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.ticket};e.prototype.getReferrer=function(e){void 0===e&&(e=this._navigation.viewParams);return e.referrer};e.prototype.getContextualFilter=function(e){void 0===e&&(e=this._navigation.viewParams);return this._useRefactoredDefaultClickUrl?Object(_.n)(e):e.ft};e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")};e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,r=t.viewParams;if(this._useRefactoredDefaultClickUrl)return F({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:r});var i=this._getItemQueryParams(e.key,{item:e,page:o.e.TextFileEditor,viewParams:r}),s=n||e.UNSAFE_parent,u=this.getKeyParams(s&&s.key||"");i.parId=u.id;var a=m.t(i,null,!0);return"TextFileEditor"!==r.v?this._getCurrentPageUrl(2,a):"#"+a};e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))};e.prototype.getMpcOneDriveUrl=function(){return"".concat(te,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")};e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,r=n.item,s=n.page,o=n.action,f=n.preserveAction,h=void 0!==f&&f,p=n.viewParams,d=void 0===p?this._navigation.viewParams:p,v=this.getKeyParams(e),m=Object(i.e)({},v),g=Object(A.x)(d);void 0!==s&&(g.v=this._getPageParamValue(s,d));var y=!1,b=Object(L.n)(null==r?void 0:r.extension,null==r?void 0:r.type);if(r&&!r.isPlaceholder){"TextFileEditor"===g.v&&(b||(g.v=""));switch(r.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:g.v="photos";y=!0}}else switch(m.id){case"tags":case"places":case"albums":g.v="photos";y=!0}if("allmyphotos"===v.qt){m.v="photos";y=!0;if("true"===v.onThisDay||"true"===v.onThisMonth||"true"===v.lastWeekPreviousYears){d&&d.startDate&&(m.startDate=d.startDate);d&&d.cid&&(m.cid=d.cid)}}if("photostream"===v.qt){m.v="photoStream";m.psShareId=d.psShareId}var w=this.getQueryType(v);b||!r||y||w===u.e.Search||w===u.e.AllMyPhotos||w===u.e.PhotoStream||(m.v="");!b&&Object(a.e)(w)&&("photos"!==g.v&&"photoStream"!==g.v||this.getContextualFilter(v)!==A.t.photos.toString())&&(m.v="");this._isFilePickerPage(g.v)&&(m.v=g.v);delete m.u;var E=this.getAutoActionType(d);o?m.action=o&&c.t[o]&&c.t[o].toLowerCase()||"":h&&E&&(E===c.t.showProperties&&m.o||(m.action=c.t[E].toLowerCase()));Object(H.e)(g,m);return g};e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case p.oneDay:n.setDate(n.getDate()-1);break;case p.oneMonth:n.setDate(n.getDate()-30);break;case p.oneWeek:n.setDate(n.getDate()-7);break;case p.oneYear:n.setDate(n.getDate()-365)}return n};e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";");document.cookie=n};e.prototype._getCurrentUrlFormat=function(e){void 0===e&&(e=this._navigation.viewParams);return this.getFocusItemKey(e)?O.focus:O.current};e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case s.e.Media:t=O.focus;break;case s.e.Folder:case s.e.Error:t=O.current;break;default:t=O.external}return t};e.prototype._getItemClickUrl=function(e,t,n,r){var i=r.viewParams,s=void 0===i?this._navigation.viewParams:i,u=r.page,a=void 0===u?this.getPageType(s):u;if(n!==O.current&&a===o.e.FilePicker)return"";var f,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(L.n)(e.extension,e.type))n=this._useOneUpTextEditor&&a!==o.e.TextFileEditor?O.focus:O.external;else if(a===o.e.TextFileEditor&&this.getAutoActionType(s)===c.t.createTextDocument)return"#"+m.t(s,null,!0);switch(n){case O.current:f=this._getCurrentItemUrl(e,r);break;case O.focus:f=this._getFocusItemUrl(e,t,r);break;default:f=this._getDefaultItemUrl(e,{itemSet:t,viewParams:s})}return f};e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,r=n.preserveAction,i=n.action,s=n.viewParams,o=void 0===s?this._navigation.viewParams:s,u=n.page,a=n.additionalViewParams;if(e.isStub){var f=this.getFocusItemKey(o);if(f)return this.getAutoActionType(o)===c.t.locate?"":this._getFocusItemUrlFromKey(f,e,{action:c.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:r,action:i,viewParams:o,page:u,additionalViewParams:a})};e.prototype._getFocusItemUrl=function(t,n,r){var i,s=this._getParentItem(t,n),o=!!r.viewParams&&Boolean("photos"===r.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==r.viewParams.qt&&!r.viewParams.parId&&!r.viewParams.parQt&&s&&!s.isAlbum),u={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?u:s,r)};e.prototype._getFocusItemUrlFromKey=function(t,n,r){var i=void 0===r?{}:r,s=i.preserveAction,o=void 0!==s&&s,u=i.action,a=i.viewParams,f=void 0===a?this._navigation.viewParams:a,l=i.additionalViewParams,c=n&&n.key||"",h=this.getKeyParams(t),p=this._getItemQueryParams(c,{item:n,preserveAction:o,action:u,viewParams:f});f&&f.commentId&&(h.commentId=f.commentId);h.parId=p.id;h.parQt=p.qt;if(h.cid!==p.cid){h.parCid=p.cid;delete p.cid}delete p.internalPath;delete p.qt;delete p.id;delete h.u;var d=p.action;if(d)if(f&&f.commentId&&"showproperties"===d.toLowerCase()){delete p.action;h.o=e.oneUpOverlayValue}else{delete p.action;h.action=d}else h.o=e.oneUpOverlayValue;l&&Object(H.e)(h,l);return"#"+m.t(h,p,!0)};e.prototype._getPageParamValue=function(e,t){var n,r=t.v;switch(e){case o.e.FilePicker:n=this._isFilePickerPage(r)?r:"FilePickerView";break;case o.e.TextFileEditor:n="TextFileEditor";break;case o.e.Photos:n="photos";break;case o.e.RansomwareDetection:n="RansomwareDetection";break;default:case o.e.Files:}return n};e.prototype._getErrorItemUrl=function(t,n){var r;void 0===n&&(n=this._navigation.viewParams);switch(t&&t.error&&t.error.type||f.e.requestFailed){case f.e.marketBlocked:return this.getMarketBlockedUrl();case f.e.userNotReady:return this.qualifyUrl(this.getItemUrl(t.key));case f.e.accessDenied:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(r={},r.sc=n.sc||"",r)}));case f.e.authenticationExpired:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case f.e.userSuspended:var s=this.getAutoActionType(n)===c.t.feedback?c.t.feedback:void 0;return x.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:s}),!0):this.getItemUrl(t.key,{action:s});case f.e.passwordRequired:return this.getValidatePermissionUrl();case f.e.requestAccess:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)};e.prototype._getDefaultItemUrl=function(e,t){var n,r,i=void 0===t?{}:t,o=i.itemSet,u=i.viewParams,a=void 0===u?this._navigation.viewParams:u,f=this._getParentItem(e,o);if(e.type===s.e.Error)r=this._getErrorItemUrl(e,a);else if(Object(L.n)(e.extension,e.type))r=this.getTextEditorItemUrl(e,{parentItem:f,viewParams:a});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,h=(null==l?void 0:l.defc)||"";r=h&&"1"!==h?this._getFocusItemUrl(e,o,{action:c.t.defaultClick,viewParams:a}):"1"===h&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,o,{action:c.t.locate,viewParams:a})}return r};e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(A.a)(t,n);var r=[];r.push(this.getCurrentPageBaseUrl());switch(t){case 0:r.push("/");break;case 1:r.push(e.nextSiteUrlPrefix);break;case 2:r.push(this._getCurrentUrlPathName());break;default:r.push(this._getCurrentUrlPathName())}r.push("?");r.push(n);return r.join("")};e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(A.f)():window.location.pathname};e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t};e.prototype._requireAuthentication=function(e,t){void 0===t&&(t=!1);return this._useRefactoredDefaultClickUrl?Object(A.D)(e,t):t||x.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e};e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent};e.dependencies={navigation:k.e,useOneUpTextEditor:se,useRefactoredDefaultClickUrl:oe,enableFastOneUp:ue};e.oneUpOverlayValue=D.i;e.EXTERNAL_URL_FORMAT="/externalredirector?alias=";e.skyApiBaseUrl=Z+"/API/2/";e.viewerId=A.H;e.storageBaseUrl=ee;e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com";e.tagsFeedbackBaseUrl="https://storage.live.com";e.peopleBaseUrl="https://people.onedrive.com";e.nextSiteUrlPrefix=D.r;e.scenarioName="odweb";e.locateActionName="locate";e.linkOriginParamValue="shorturl";e.linkNotSupportedParamValue="linknotsupported";e.createTextDocumentActionValue="createTextDocument";e.contentTypeByLayoutType=(($={}).photo=E.n,$.list=E.t,$.grid=E.e,$);e.placeholderId=0;return e})();t.e=ae,Object(N.i)("UrlDataSource",ae)},,,function(e,t,n){"use strict";n.d(t,"n",function(){return s});n.d(t,"u",function(){return o});n.d(t,"p",function(){return u});n.d(t,"i",function(){return a});n.d(t,"f",function(){return f});n.d(t,"l",function(){return l});n.d(t,"c",function(){return c});n.d(t,"h",function(){return h});n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});n.d(t,"s",function(){return v});n.d(t,"r",function(){return m});n.d(t,"a",function(){return g});n.d(t,"o",function(){return y});var r=n(4),i=(n(204),new r.t("itemComment"),n(178)),s=(new r.t("list"),new r.t("oAuthTokenDataSource"),new r.t("siteScripts"),n(319),n(235),new r.t("recentList"),new r.t("folder"),new r.t("appsItem"),new r.t("externallySharedItem"),new r.t("popularItem"),new r.t("subsiteItem"),new r.t("mostViewsItem"),new r.t("mostViewersItem"),new r.t("settings"),new r.t("getItem")),o=new r.t("items"),u=(new r.t("versionControl"),new r.t("versionHistory"),new r.t("vault")),a=i.e,f=(new r.t("peopleCardFactory"),new r.t("peopleCard"),new r.t("language"),new r.t("languagePicker"),new r.t("leftNav"),new r.t("search"),new r.t("sharing")),l=(new r.t("sharingLightSpeed"),new r.t("sharingData")),c=(new r.t("groups"),new r.t("suiteNav"),new r.t("iosMobileAppPath"),new r.t("url")),h=(new r.t("universalAnnotation"),new r.t("download"),new r.t("footer"),new r.t("manifests"),new r.t("itemActivityFeed"),new r.t("itemActivityFeedHelper"),new r.t("itemActivityFeedSharingHelper"),new r.t("userInfo")),p=(new r.t("storageInfo"),new r.t("storageOptions"),new r.t("album"),new r.t("tag"),new r.t("shareByLink"),new r.t("folderItemCount"),new r.t("photo"),new r.t("subscriptions"),new r.t("analytics"),new r.t("feedback"),new r.t("sendFeedback"),new r.t("embed")),d=(new r.t("application"),new r.t("policyTip"),new r.t("policyTipLightSpeed"),new r.t("customAction"),new r.t("taxonomy"),new r.t("web"),new r.t("floodgate"),new r.t("shortcutsDS"),new r.t("encoding"),new r.t("rating"),new r.t("publish"),new r.t("videoItem"),new r.t("sites"),new r.t("copy"),new r.t("upsell"),new r.t("notifications"),new r.t("command"),new r.t("processFilters"),new r.t("quota"),new r.t("itemColumn"),new r.t("bundle"),new r.t("itemPicker"),new r.t("site"),new r.t("pushChannel"),new r.t("itemAutoRefresh"),new r.t("loginApp"),new r.t("mruRecent"),new r.t("pdf"),new r.t("zip"),new r.t("url2"),new r.t("attachments"),new r.t("spotlight"),new r.t("error"),new r.t("promotedPhotos"),new r.t("fileHandler"),new r.t("fileHandlerFromCache"),new r.t("recycleBin"),new r.t("deleteRestore")),v=new r.t("instrumentation"),m=(new r.t("shadowCall"),new r.t("graph")),g=(new r.t("formula"),new r.t("appUrl"),new r.t("graphUrl"),new r.t("batchUploaderType"),new r.t("vroomItemIdentityProcessor"),new r.t("preAuth"),new r.t("peopleService"),new r.t("schema")),y=(new r.t("restore"),new r.t("restore"),new r.t("restoreActivities"),new r.t("inAppMessaging"),new r.t("notificationSettings"),new r.t("itemInvalidator"));new r.t("itemUpdator"),new r.t("wopiFrame"),new r.t("wrs"),new r.t("excel"),new r.t("winAppCommunicator"),new r.t("wip"),new r.t("worker"),new r.t("checkUserAccessDataSource"),new r.t("userExpiration"),new r.t("itemMuteNotificationDataSource"),new r.t("ticketRedeemer"),new r.t("recommendList"),new r.t("reportAbuse"),new r.t("requestReview"),new r.t("listsFomeFREDataSource"),new r.t("removeFromShareWithMeList")},function(e,t,n){"use strict";var r=n(96),i=n(18),s=n(85),o=n(307),u=n(0),a=n(102),f=n(9),l=n(26),c={canary:l.t.canary,Accept:"application/json",AppId:l.t.appId,"Cache-Control":"private","X-ForceCache":"1"};l.t.oauthToken&&(c["X-Auth"]=l.t.oauthToken);function h(e){var t=Object(u.e)(Object(u.e)({},c),e||{}),n=(function(){var e=window.location.search,t="";if(e){var n=f.e(e.substring(1)).iam,r=a.get("aad_auth:"+n);if(r){var i=r.indexOf("id_token=");t=r.substring(i+"id_token=".length,r.indexOf("&",i))}}return t})();n&&(t.Authorization="Bearer "+n);l.t.canary&&l.t.canary!==t.canary&&(t.canary=l.t.canary);return t}function p(e,t){var n=e.useDefaultHeaders?h(e.headers):e.headers||{};return{onData:t,payload:{url:e.url,cb:t,v:e.requestType,verb:e.requestType,headers:n,postString:e.postData,cbp:e.progressCallback,timeout:6e4}}}var d=(function(){function e(){}e.prototype.canHandleRequest=function(e){return!0};e.prototype.handleRequest=function(e,t){var n=new o.e(t);try{var r=new XMLHttpRequest;e.withCredentials&&(r.withCredentials=!0);r.open(e.requestType||"GET",e.url,!0);e.responseType&&(r.responseType=e.responseType);r.timeout=6e4;var i=e.useDefaultHeaders?h(e.headers):e.headers||{};i.Accept||r.setRequestHeader("Accept","application/json;odata=verbose");e.postData&&!i["Content-Type"]&&r.setRequestHeader("Content-Type","application/json;odata=verbose");for(var s in i)i[s]&&r.setRequestHeader(s,i[s]);r.onreadystatechange=function(){4===r.readyState&&n.complete(r)};r.send(e.postData)}catch(e){n.error(e)}return n.getPromise()};return e})(),v=n(32),m=n(76),g=(function(){function e(e){this._proxySetup=!1;this._eventGroup=new m.e(window);this._requests=[];this._onAttach=e.onAttach;this._onReady=e.onReady;this._initIframeIfNotExist(e.source);window.$Network||(window.$Network={Proxy:{_registerProxy:y},onhttperror:{fire:function(){}}});window.NextNetworkRegisterProxy=y}e.prototype.createRequest=function(e){this._proxySetup?this._doRequest(e):this._requests.push(e)};e.prototype.reloadIframe=function(e){var t=this._iframe.src;document.body.removeChild(this._iframe);this._proxySetup=!1;this._iframe=void 0;this._initIframeIfNotExist(e||t)};e.prototype._attachToIframe=function(e){var t=this;this._eventGroup.on(e,"iframeReady",function(){t._eventGroup.off(e);t._onProxyReady()});this._onAttach&&this._onAttach(e)};e.prototype._onProxyReady=function(){this._onReady&&this._onReady();this._proxySetup=!0;for(var e=0,t=this._requests;e<t.length;e++){var n=t[e];this.createRequest(n)}this._requests=[]};e.prototype._doRequest=function(e){this._iframe.contentWindow.fetchXML(e.payload,null,null,e.onData)};e.prototype._initIframeIfNotExist=function(e){if(!this._iframe){this._iframe=(function(e,t){(e=document.createElement("iframe")).style.display="none";e.src=t;return e})(this._iframe,e);this._attachToIframe(this._iframe);document.body.insertBefore(this._iframe,document.body.firstChild)}};return e})();function y(e){var t=e.frameElement;m.e.raise(t,"iframeReady")}var b=n(2),w={resultCode:"Proxy Timeout",message:"The SkyApiXmlProxy content failed to load within 15 seconds."},E={resultCode:"IFrame load failure",message:"The SkyApiXmlProxy content failed to execute correctly."},S=window.FilesConfig&&window.FilesConfig.skyApiDomain,x=Object(b.te)(b.s),T=(function(){function e(){this._requests=[]}e.prototype.canHandleRequest=function(e){return e.indexOf(S)>-1};e.prototype.handleRequest=function(e,t){var n=this,r=new o.e(function(){n._removeSignal(r);t()});if(this._proxyFailure||x)this._bypassProxy(r,e);else{this._requests.push({signal:r,options:e});e.useDefaultHeaders=!0;var i=p(e,function(e){n._removeSignal(r);r.complete(e)});this._initialize();this._xmlProxy.createRequest(i)}return r.getPromise()};e.prototype.getHandlerContentWindow=function(){return this._iframe&&C(this._iframe)?this._iframe.contentWindow:null};e.prototype._initialize=function(){var e=this;this._xmlProxy||(this._xmlProxy=new g({source:N(!1),onAttach:this._attachToIframe.bind(this),onReady:function(){window.clearTimeout(e._timeout);e._qos&&e._qos.end({resultType:i.t.Success});e._requests=[]}}))};e.prototype._bypassProxy=function(e,t){this._basicRequestor||(this._basicRequestor=new d);var n;t.disableLogging||(n=new s.e({url:t.url,name:t.qosName||"DataRequest.NoSkyProxy."+t.apiName}));t.withCredentials=!0;t.useDefaultHeaders=!0;this._basicRequestor.handleRequest(t,function(){n&&n.end({resultType:i.t.ExpectedFailure});e.cancel()}).then(function(t){e.complete(t);n&&n.end({resultType:i.t.Success})},function(t){e.error(t);n&&n.end({resultType:i.t.Failure})})};e.prototype._attachToIframe=function(e){var t=this;this._iframe=e;var n=this._hasReloaded?"SkyApiXmlProxyRetry":"SkyApiXmlProxy";this._qos=new i.e({name:n});this._timeout=window.setTimeout(function(){t._proxyFailed(w)},15e3);e.onload=function(){if(!C(e)){window.clearTimeout(t._timeout);if(t._hasReloaded)t._proxyFailed(E);else{t._handleError(E);t._reloadIframe(N(!0))}}}};e.prototype._removeSignal=function(e){this._requests=this._requests.filter(function(t){return e!==t.signal})};e.prototype._reloadIframe=function(e){this._hasReloaded=!0;window.clearTimeout(this._timeout);this._timeout=void 0;this._xmlProxy.reloadIframe(e)};e.prototype._handleError=function(e){this._qos.end({error:e.message,resultCode:e.resultCode,resultType:i.t.Failure});this._qos=void 0;v.e.logError(e.message)};e.prototype._proxyFailed=function(e){this._handleError(e);this._proxyFailure={isProxyFailure:!0,message:e.message};for(var t=0,n=this._requests;t<n.length;t++){var r=n[t];this._bypassProxy(r.signal,r.options)}this._requests=[]};return e})();function N(e){var t=e?"cache=".concat((function(e){try{return String.fromCharCode.apply(null,(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(e)).map(function(e){return e%26+"A".charCodeAt(0)}))}catch(e){return""}})(6),"&"):"";return"".concat(S,"/xmlproxy.htm?").concat(t,"domain=").concat(document.domain)}function C(e){try{for(var t=e.contentDocument.getElementsByTagName("script"),n=0;n<t.length;n++){var r=t[n];if(r&&r.src&&r.src.indexOf("xmlproxy.js")>=0)return!0}}catch(e){return!1}return!1}var k=n(29),L=Object(b.te)(b.s),A=(function(){function e(){}e.prototype.canHandleRequest=function(e){return e.indexOf("storage.live.com")>-1};e.prototype.handleRequest=function(e,t){var n=new o.e(t);if(L)this._bypassProxy(n,e);else{var r=this._getProxy(e.url);e.useDefaultHeaders=!0;var i=p(e,function(e){n.complete(e)});r.createRequest(i)}return n.getPromise()};e.prototype._getProxy=function(e){var t=new k.t(e);this._xmlProxy||(this._xmlProxy=new g({source:t.getScheme()+"://"+t.getHost()+"/xmlproxy.htm?domain="+document.domain}));return this._xmlProxy};e.prototype._bypassProxy=function(e,t){this._basicRequestor||(this._basicRequestor=new d);var n;t.disableLogging||(n=new s.e({url:t.url,name:t.qosName||"BaseStorageRequest."+t.apiName}));t.withCredentials=!0;this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:i.t.ExpectedFailure});e.cancel()}).then(function(t){e.complete(t);null==n||n.end({resultType:i.t.Success})},function(t){e.error(t);null==n||n.end({resultType:i.t.Failure})})};return e})(),O=Object(b.te)(b.s),M=(function(){function e(){this._xmlProxies={}}e.prototype.canHandleRequest=function(e){return e.indexOf(".users.storage.live.com")>-1};e.prototype.handleRequest=function(e,t){var n=new o.e(t);if(O)this._bypassProxy(n,e);else{var r=this._getProxy(e.url);e.useDefaultHeaders=!0;var i=p(e,function(e){n.complete(e)});r.createRequest(i)}return n.getPromise()};e.prototype._getProxy=function(e){var t=new k.t(e),n=t.getHost();this._xmlProxies[n]||(this._xmlProxies[n]=new g({source:t.getScheme()+"://"+t.getHost()+"/xmlproxy.htm?domain="+document.domain}));return this._xmlProxies[n]};e.prototype._bypassProxy=function(e,t){this._basicRequestor||(this._basicRequestor=new d);var n;t.disableLogging||(n=new s.e({url:t.url,name:t.qosName||"StorageRequest."+t.apiName}));t.withCredentials=!0;this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:i.t.ExpectedFailure});e.cancel()}).then(function(t){e.complete(t);null==n||n.end({resultType:i.t.Success})},function(t){e.error(t);null==n||n.end({resultType:i.t.Failure})})};return e})(),_=n(179),D=[{Constructor:T},{Constructor:M},{Constructor:A},{Constructor:d}],P=(function(){function e(){}e.prototype.send=function(e){return H(e)};e.prototype.sendPost=function(e,t,n){return H({apiName:e,url:t,requestType:"POST",postData:n})};e.prototype.sendPostUrlEncoded=function(e,t,n){return H({apiName:e,url:t,requestType:"POST",postData:n,headers:{"Content-Type":"application/x-www-form-urlencoded;"}})};return e})();t.e=P;function H(e){e.requestType=e.requestType||"GET";var t;if(!e.disableLogging){var n=e.url;n=n&&n.replace(/authkey=[^&]+&?/gi,"");t=new s.e({url:n,name:e.qosName||"DataRequest."+e.apiName})}var o,u=(function(e){for(var t=0,n=D;t<n.length;t++){var r=n[t];r.instance||(r.instance=new r.Constructor);if(r.instance.canHandleRequest(e.url))return r.instance}})(e),a=u.getHandlerContentWindow&&u.getHandlerContentWindow(),f=(o=a||window)&&o.performance||void 0,l=f&&f.now();return u.handleRequest(e,function(){t&&t.end({resultType:i.t.ExpectedFailure})}).then(function(n){if(!e.returnRawXHR)return(function(e){var t,n=e.data,s=e.apiEvent;if(!n||0===n.status){s.end({error:"Unkown client side request error (status code 0)",resultType:i.t.ExpectedFailure});return r.t.reject({message:"Promise failed with empty error response",url:n&&n.responseURL||"",status:0,data:void 0})}if(200===n.status||201===n.status){var o=JSON.parse(n.responseText);s&&s.end({resultType:i.t.Success});return o}var u="",a="";try{var f=JSON.parse(n.responseText);t=f&&f.error||f;u=f&&f.transactionId||"";a=n.getResponseHeader("MS-CV")||""}catch(e){t={message:n.responseText}}var l=t,c=t&&t.items;if(c)for(var h=0,p=c;h<p.length;h++){var d=p[h];if(d.error){l=d.error;break}}l||(l={});l.transactionId=u;l.msCorrelationVector=a;var v={errorCode:l&&l.code||"",errorTitle:""},m=e.isErrorExpectedCallback&&e.isErrorExpectedCallback(v);s&&(function(e,t,n,r){var s={resultCode:n&&n.code||"",resultType:r?i.t.ExpectedFailure:i.t.Failure,extraMetrics:{httpStatus:e.status,httpStatusText:e.statusText}};if(n&&n.items)for(var o=0,u=n.items;o<u.length;o++){var a=u[o];if(a.error){n=a.error;break}}if(n){s.error=n.debugMessage||n.message;s.extraData={stack:n.stackTrace,isExpected:n.isExpected,transactionId:n.transactionId,msCorrelationVector:n.msCorrelationVector}}t.end(s)})(n,s,l,m);return r.t.reject({message:"Promise failed without error handler",url:n.responseURL||"",status:n.status,data:t})})({data:n,apiEvent:t,isErrorExpectedCallback:e.isErrorExpectedCallback});var s=Object(_.e)(e.url,l,a);t&&t.end({resultType:i.t.Success,extraData:{rawRequestDuration:s.duration,performanceEntry:JSON.stringify(s)}});return n},function(n){if(n&&n.isProxyFailure){t.end({error:n.message,resultType:i.t.ExpectedFailure});return r.t.reject(n.message)}if(t){var s=Object(_.e)(e.url,l,a),o=n&&n.message||n||"Unkown error occurred while creating API request";t.end({error:o,resultType:i.t.Failure,extraData:{rawRequestDuration:s.duration,performanceEntry:JSON.stringify(s)}})}return r.t.reject(n)})}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(29),i=n(4),s=window&&window.FilesConfig||{};s.skyDrivePickerOAuth||(s.skyDrivePickerOAuth="oauth");!s.oauthToken&&window&&(s.oauthToken=new r.t(window.location.href).getQueryParameter("access_token"));var o=s,u=window&&window.$Config||{};new i.t({name:"".concat("Config",".files"),factory:new i.e(o)}),new i.t({name:"".concat("Config",".config"),factory:new i.e(u)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.none=0]="none";e[e.locate=1]="locate";e[e.defaultClick=2]="defaultClick";e[e.download=3]="download";e[e.share=4]="share";e[e.sharing=5]="sharing";e[e.sendSurvey=6]="sendSurvey";e[e.createTextDocument=7]="createTextDocument";e[e.createWord=8]="createWord";e[e.createExcel=9]="createExcel";e[e.createExcelForm=10]="createExcelForm";e[e.createPowerPoint=11]="createPowerPoint";e[e.createOneNote=12]="createOneNote";e[e.openInExcel=13]="openInExcel";e[e.openInWord=14]="openInWord";e[e.openInPowerPoint=15]="openInPowerPoint";e[e.openInOneNote=16]="openInOneNote";e[e.openInVisio=17]="openInVisio";e[e.openInProject=18]="openInProject";e[e.openInPublisher=19]="openInPublisher";e[e.openInOffice=20]="openInOffice";e[e.embed=21]="embed";e[e.reportAbuse=22]="reportAbuse";e[e.addToShared=23]="addToShared";e[e.editBrowser=24]="editBrowser";e[e.feedback=25]="feedback";e[e.versionHistory=26]="versionHistory";e[e.showProperties=27]="showProperties";e[e.edit=28]="edit";e[e.editNew=29]="editNew"})(r||(r={}));var i={};for(var s in r)if("number"==typeof r[s]){var o=s,u=r[o];i[o.toLowerCase()]=u}t.t=r},function(e,t,n){"use strict";n.d(t,"s",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"n",function(){return u});n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n(16),i=window._spPageContextInfo,s=(function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return e})(),o=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,u=!i||"21"===i.webTemplate&&700===i.listBaseTemplate,a=(window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,{Fallback:!r.e.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")}),f=(r.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),{ODB:s?-60903:60903})},,function(e,t,n){"use strict";var r;(function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut";e[e.Album=9]="Album";e[e.MultiShare=10]="MultiShare"})(r||(r={}));t.e=r},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.requestFailed=0]="requestFailed";e[e.authenticationExpired=1]="authenticationExpired";e[e.accessDenied=2]="accessDenied";e[e.marketBlocked=3]="marketBlocked";e[e.userSuspended=4]="userSuspended";e[e.userNotReady=5]="userNotReady";e[e.passwordRequired=6]="passwordRequired";e[e.mfaRequired=7]="mfaRequired";e[e.insufficientVaultQuota=8]="insufficientVaultQuota";e[e.requestAccess=9]="requestAccess"})(r||(r={}))},,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return h});var r=n(0),i=n(23),s=n(205);n.d(t,"t",function(){return s.e});var o=n(131),u=n(103),a=n(125);n.d(t,"e",function(){return a});var f=n(4),l=n(143),c=(function(e){Object(r.r)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(u.e):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,s=n;i<s.length;i++){var u=s[i],f=t[u],l=new o.e(u),c=this._getStoreItem(u);if(c){c.UNSAFE_parent;var h=Object(r.s)(c,["UNSAFE_parent"]);Object(a.default)(l,h)}Object(a.default)(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];Object(a.default)(l,v)}e[u]=l}for(var m=0,g=n;m<g.length;m++){var y=(l=e[u=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new o.e(y);e[y]=b;l.UNSAFE_parent=b}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var w=0,E=n;w<E.length;w++){u=E[w];delete(f=t[u]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=Object(r.e)(Object(r.e)({},i.t.dependencies),{itemsStore:u.e});return t})(i.t),h=new f.t({name:"ItemTaskObserver",factory:new l.n(c)})},,function(e,t,n){"use strict";n.d(t,"i",function(){return u});n.d(t,"s",function(){return a});n.d(t,"n",function(){return f});n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});n.d(t,"r",function(){return h});var r=n(53),i=n(26),s=n(127),o=(n(60),(null===i.t||void 0===i.t?void 0:i.t.mpcDomain)||"https://my.microsoftpersonalcontent.com"),u="UnAuth"===(null===i.t||void 0===i.t?void 0:i.t.hcid),a=!u&&(null===i.t||void 0===i.t?void 0:i.t.hcid)||"";function f(e){var t=e.apiVersion,n=e.driveId,i=e.includeViewerId,s=void 0!==i&&i,u=e.migrationState,f=void 0!==u&&u;n&&"me"!==n||(n=a);if(Object(r.e)(n)||f){"v1.0"===t&&(t="v2.0");return s?(function(e){void 0===e&&(e="v2.0");return"".concat(o,"/personal/").concat(a,"/_api/").concat(e)})(t):c(t)}return l(t)}function l(e){void 0===e&&(e="v1.0");var t=h(),n=2===Object(s.e)()?"storage.live-int.com":"api.onedrive.com";return"https://".concat(t).concat(n,"/").concat(e)}function c(e){void 0===e&&(e="v2.0");return"".concat(o,"/_api/").concat(e)}function h(){switch(Object(s.e)()){case 3:return"soak2.test.";case 4:return"soak3.test.";case 2:return"newapi.dev.";default:return""}}},function(e,t,n){"use strict";var r=n(435);t.e=r.e},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(4).t)("navigation")},,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(4),i=new r.t("ODCUrlDataSource"),s=(new r.t("ODCRecycleBinDataSource"),new r.t("ODCItemDataSource"))},,function(e,t,n){"use strict";var r;(function(e){e[e.AlbumRoot=0]="AlbumRoot";e[e.TagsRoot=1]="TagsRoot";e[e.Album=2]="Album";e[e.Tag=3]="Tag";e[e.FaceRoot=4]="FaceRoot";e[e.Location=5]="Location"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";var r;(function(e){e[e.white=1]="white";e[e.themePrimary=2]="themePrimary";e[e.neutralLighterAlt=3]="neutralLighterAlt";e[e.themeTertiary=4]="themeTertiary"})(r||(r={}));t.e=r},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(173);function i(e){return e===r.e.Search}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"i",function(){return i});n.d(t,"r",function(){return s});n.d(t,"n",function(){return o});n.d(t,"t",function(){return u});var r=String.fromCharCode(9),i="OneUp",s="/next",o="shorturl",u="linknotsupported"},,,,,,,function(e,t,n){"use strict";var r=n(336);n.d(t,"e",function(){return r.e})},,,function(e,t,n){"use strict";n.d(t,"u",function(){return i});n.d(t,"r",function(){return s});n.d(t,"s",function(){return o});n.d(t,"t",function(){return u});n.d(t,"o",function(){return a});n.d(t,"n",function(){return f});n.d(t,"e",function(){return l});n.d(t,"i",function(){return c});var r=n(4),i=(new r.t("provider.suiteNav"),new r.t("provider.peopleCard"),new r.t("provider.shareByLink"),new r.t("provider.groupsLeftNav"),new r.t("provider.publishingSiteProvider"),new r.t("provider.userInfo")),s=(new r.t("provider.tag"),new r.t("provider.photo"),new r.t("provider.notification"),new r.t("provider.notificationManager"),new r.t("provider.instrumentation")),o=new r.t("provider.teachingBubble"),u=(new r.t("provider.feedback"),new r.t("provider.embed")),a=(new r.t("provider.storageInfo"),new r.t("provider.storageOptions"),new r.t("provider.subscriptions"),new r.t("provider.customAction"),new r.t("provider.taxonomy"),new r.t("provider.thumbnail")),f=(new r.t("provider.appsItem"),new r.t("provider.externallySharedItem")),l=(new r.t("provider.popularItem"),new r.t("provider.mostViewsItem"),new r.t("provider.mostViewersItem"),new r.t("provider.subsiteItem"),new r.t("provider.itemHistory"),new r.t("provider.spotlight"),new r.t("provider.error"),new r.t("provider.publish"),new r.t("provider.bundleLoader")),c=(new r.t("provider.upsell"),new r.t("provider.profile"),new r.t("provider.processFilters"),new r.t("provider.userState"));new r.t("provider.ransomwareDetection"),new r.t("provider.promotedPhotos"),new r.t("provider.site"),new r.t("provider.graphToken"),new r.t("provider.dragAndDropRobot"),new r.t("provider.recycleBin"),new r.t("provider.premiumState"),new r.t("provider.mruRecent"),new r.t("provider.userExpiration"),new r.t("provider.requestReview")},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(1),i=Object(r.createContext)({});function s(){return Object(r.useContext)(i)}function o(e){var t=e.dispatcher,n=e.children;return r.createElement(i.Provider,{value:{dispatcher:t}},n)}},,function(e,t,n){var r;(function(i,s){"use strict";var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};t._document=e.document;t._cacheKeyPrefix="cookey.";t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");t.defaults={path:"/",secure:!1};t.get=function(e){t._cachedDocumentCookie!==t._document.cookie&&t._renewCache();return t._cache[t._cacheKeyPrefix+e]};t.set=function(e,n,r){(r=t._getExtendedOptions(r)).expires=t._getExpiresDate(void 0===n?-1:r.expires);t._document.cookie=t._generateCookieString(e,n,r);return t};t.expire=function(e,n){return t.set(e,void 0,n)};t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&void 0!==e.secure?e.secure:t.defaults.secure}};t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())};t._getExpiresDate=function(e,n){n=n||new Date;"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e));if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e};t._generateCookieString=function(e,t,n){var r=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));r+=(n=n||{}).path?";path="+n.path:"";r+=n.domain?";domain="+n.domain:"";r+=n.expires?";expires="+n.expires.toUTCString():"";return r+=n.secure?";secure":""};t._getCacheFromString=function(e){for(var n={},r=e?e.split("; "):[],i=0;i<r.length;i++){var s=t._getKeyValuePairFromCookieString(r[i]);void 0===n[t._cacheKeyPrefix+s.key]&&(n[t._cacheKeyPrefix+s.key]=s.value)}return n};t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=t<0?e.length:t;return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}};t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie);t._cachedDocumentCookie=t._document.cookie};t._areEnabled=function(){var e="1"===t.set("cookies.js",1).get("cookies.js");t.expire("cookies.js");return e};t.enabled=t._areEnabled();return t},u="object"==typeof i.document?o(i):o;void 0!==(r=function(){return u}.call(t,n,t,e))&&(e.exports=r)})("undefined"==typeof window?this:window)},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(131),s=n(75),o=n(134),u=n(4),a=n(143),f=n(9),l=n(149),c=n(30),h=n(246),p=n(125),d=n(5),v=Object(d.ne)(d.q);function m(e){return e&&e.item&&e.item.peek().key}function g(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var y=(function(e){Object(r.r)(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new o.e({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(r.o)([e],t,!1))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&g(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&g(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(r.o)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],s=void 0;if(n.vault&&n.vault.root){(s=new i.e(n.key)).name=n.name;s.displayName=n.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(n,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case c.e.Folder:case c.e.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),f=a.item&&a.item.peek(),l=f&&f.key;if(l&&(l===e||s&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(f);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e);Object(p.default)(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];v&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);for(var s=function(t){var n="".concat("item=").concat(t),r=v?"".concat("item_write=").concat(t):n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=l.t;o.setValue(r,u);s=v?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,a=Object(h.e)(Object(r.o)([e.key],t,!0));u<a.length;u++){var f=a[u];s(f)}return i[0]};return t})(s.e),b=new u.t({name:"ItemsStore",factory:new a.r(y)})},function(e,t,n){"use strict";var r;(function(e){e[e.Left=0]="Left";e[e.Top=0]="Top";e[e.Right=1]="Right";e[e.Bottom=2]="Bottom";e[e.Center=4]="Center";e[e.VerticalCenter=8]="VerticalCenter";e[e.BottomCenter=6]="BottomCenter";e[e.BottomRight=3]="BottomRight";e[e.RightVerticalCenter=9]="RightVerticalCenter"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(1),i=n(100),s=n(307),o=Object(r.createContext)({clear:function(){throw new Error("Missing clear function in WacMessagePresenterContext")},cache:null});function u(){return Object(r.useContext)(o)}function a(e){var t=e.eventType,n=e.children,u=Object(i.t)().dispatcher,a=Object(r.useState)(null),f=a[0],l=a[1],c=r.useCallback(function(){l(null)},[l]),h=r.useCallback(function(e){var t=new s.e;l({message:e,signal:t});var n=t.getPromise();n.then(c,c);return n},[l]);Object(r.useEffect)(function(){if(u&&t){u.addEventListener(t,h);return function(){u.removeEventListener(t,h)}}},[u,t,h]);return r.createElement(o.Provider,{value:{cache:f,clear:c}},f&&c?n:null)}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});n.d(t,"t",function(){return a});var r=n(37),i={abap:"text/plain",ada:"text/plain",adp:"text/plain",ahk:"text/plain",as:"text/plain",as3:"text/plain",asc:"text/plain",ascx:"text/xml",asm:"text/plain",asp:"text/plain",awk:"text/plain",bash:"text/plain",bash_login:"text/plain",bash_logout:"text/plain",bash_profile:"text/plain",bashrc:"text/plain",bat:"text/x-bat",bib:"text/plain",bsh:"text/x-java",build:"text/plain",builder:"text/plain",c:"text/x-cpp","c++":"text/x-c++src",capfile:"text/plain",cc:"text/x-c++src",cfc:"text/plain",cfm:"text/plain",cfml:"text/plain",cl:"text/plain",clj:"text/plain",cls:"text/plain",cmake:"text/plain",cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:"text/plain",cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:"text/plain",db:"text/plain",ddl:"text/plain",di:"text/plain",dif:"text/plain",diff:"text/plain",disco:"text/xml",dml:"text/plain",dtd:"text/xml",dtml:"text/xml",el:"text/plain",emakefile:"text/plain",erb:"text/plain",erl:"text/plain",f:"text/plain",f90:"text/plain",f95:"text/plain",fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:"text/plain",gemspec:"text/ruby",gitconfig:"text/x-ini",go:"text/plain",groovy:"text/plain",gvy:"text/plain",h:"text/x-cpp","h++":"text/x-c++hdr",haml:"text/plain",handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:"text/plain",hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:"text/plain",hs:"text/plain",htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:"text/plain",inc:"text/html",inf:"text/plain",ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:"text/plain",jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:"text/plain",jsx:"text/javascript",l:"text/plain",less:"text/x-less",lhs:"text/plain",lisp:"text/plain",log:"text/plain",lst:"text/plain",ltx:"text/plain",lua:"text/x-lua",m:"text/plain",mak:"text/plain",make:"text/plain",markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:"text/plain",mli:"text/plain",mll:"text/plain",mly:"text/plain",mm:"text/plain",mud:"text/plain",nfo:"text/plain",opml:"text/xml",osascript:"text/plain",osts:"text/javascript",out:"text/plain",p:"text/plain",pas:"text/plain",patch:"text/plain",php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:"text/plain",plist:"text/plain",pm:"text/plain",pod:"text/plain",pp:"text/plain",profile:"text/plain",properties:"text/plain",ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:"text/plain",r:"text/plain",rake:"text/plain",rb:"text/ruby",rbx:"text/plain",rc:"text/plain",re:"text/plain",reg:"text/plain",rest:"text/plain",resw:"text/xml",resx:"text/xml",rhtml:"text/plain",rjs:"text/plain",rprofile:"text/plain",rpy:"text/plain",rss:"text/xml",rst:"text/plain",rxml:"text/plain",s:"text/plain",sass:"text/scss",scala:"text/plain",scm:"text/plain",sconscript:"text/plain",sconstruct:"text/plain",script:"text/plain",scss:"text/scss",sgml:"text/xml",sh:"text/plain",shtml:"text/html",sml:"text/xml",sql:"text/plain",sty:"text/plain",t:"text/plain",tcl:"text/plain",tex:"text/plain",text:"text/plain",textile:"text/plain",tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:"text/plain",vb:"text/x-vb",vi:"text/plain",vim:"text/plain",wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:"text/plain",xslt:"text/plain",yaml:"text/plain",yaws:"text/plain",yml:"text/plain",zsh:"text/plain"};function s(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}function o(e){e=s(e);return i.hasOwnProperty(e)}function u(e,t){return!!e&&a(e,t)}function a(e,t){return o(e)&&(t===r.e.File||t===r.e.Media||t===r.e.Unknown)}}],Array(20),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=window.FilesConfig&&window.FilesConfig.env;function i(){switch(r&&r.toLowerCase()){case"soak3":return 4;case"soak2":return 3;case"dev":return 2;case"df":return 1;default:return 0}}},,,,function(e,t,n){"use strict";var r=n(8),i=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.e.Files;this.displayType=r.e.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.e=i},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r;(function(e){e[e.NotCreated=-1]="NotCreated";e[e.Created=0]="Created";e[e.BubbleShown=1]="BubbleShown";e[e.FreShown=2]="FreShown"})(r||(r={}));var i="oneDriveVault",s="canary"},,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});n.d(t,"n",function(){return a});var r=n(33),i=n(124),s=n(3),o=new r.e("odspNextApp",{}),u=o.serialize({}),a=(new r.e("odspNextPage",{pageType:i.e}),new r.e("OdbSettingsNav",{}),new r.e("OdbSettingsNavSetGroup",{}),new r.e("odspNextPage",{setingsPageType:i.e}),new s.e("disableFastOneUp"),new s.e("resourceScopeFacet"));new s.e("defaultGraphEndpoint"),new s.e("hasPageLoad"),new s.e("isLightspeedApp"),new s.e("sessionId"),new s.e("disallowCookies"),new s.e("enableClaimsChallenge"),new s.e("overrideUseIdentityAuthForVroomFlightEnabled"),new s.e("overrideUseSelfIssuedTokenForSPOWebAuth"),new s.e("nucleusOfflineFacet"),new s.e("offlineDetectionFacet"),new s.e("allowAutomateCrossDomainFacet"),new s.e("spPageContextItem")},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(356),i=window._spPageContextInfo,s=function(e){if(i&&i.farmSettings)return i.farmSettings[e]},o=function(e){return e.serviceSetting?(t=e.serviceSetting,1===Number(s(t))||"true"===s(t)):r.e.isFeatureEnabled(e);var t}},,,,,,function(e,t,n){"use strict";var r;(function(e){e[e.defaultValue=0]="defaultValue";e[e.displayName=1]="displayName";e[e.dateModified=2]="dateModified";e[e.dateCreated=3]="dateCreated";e[e.size=4]="size";e[e.itemType=5]="itemType";e[e.dateTaken=6]="dateTaken";e[e.owner=7]="owner";e[e.userArranged=8]="userArranged";e[e.dateAccessed=9]="dateAccessed";e[e.relevancy=10]="relevancy";e[e.dateDeleted=11]="dateDeleted";e[e.location=12]="location";e[e.dateShared=13]="dateShared";e[e.sharer=14]="sharer"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(112),i=n(16),s={showFre:"showFre",showPremiumPositioning:"showPremiumPositioning",showNewFeaturesExperience:"showNewFeaturesExperience",showWelcomeExperience:"showWelcomeExperience",showFamiliesFre:"showFamiliesFre",showGroupsFre:"showGroupsFre",showHolidayPosFre:"showHolidayPosFre",showQuotaLevelUpsellFre:"showQuotaLevelUpsellFre",upsellOverride:"upsell",resetUpsellParams:"resetUpsells",spoSandbox:"spoSandbox",showPwaInstallDialog:"showPwaInstallDialog"};function o(e,t){var n;void 0===t&&(t={});return(null===(n=window.__testHooks)||void 0===n?void 0:n[e])||t[e]||void 0}i.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations")||(function(){if(!window.__testHooks){window.__testHooks={};var e=location.search?location.search.substring(1):"",t=Object(r.e)(e);for(var n in s)t[n]&&(window.__testHooks[n]=t[n])}})()},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(4).t)("pageContext")},function(e,t,n){"use strict";n(0),n(1);var r=n(187);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.n})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"i",function(){return s});n.d(t,"n",function(){return o});n.d(t,"e",function(){return u});n.d(t,"r",function(){return a});var r=n(4),i=(new r.t("currentItem"),new r.t("currentItemSet"),new r.t("groupThrottle")),s=(new r.t("focusItem"),new r.t("focusItemSet"),new r.t("dataManagerMapper"),new r.t("viewParams")),o=(new r.t("originalViewParams"),new r.t("itemsSelection")),u=(new r.t("selectionIndexResolver"),new r.t("autoFillParams"),new r.t("actionMap")),a=(new r.t("slideshowState"),new r.t("isDebugWindowVisible"),new r.t("canUserSelect"),new r.t("promiseTracker"),new r.t("currentPage"),new r.t("currentSelectionModelGroup"),new r.t("useMobileList"));new r.t("disableDotDotDotHeroCommand"),new r.t("disableShareHeroCommand"),new r.t("uploadActionHandler"),new r.t("vaultTeachingBubble"),new r.t("currentView"),new r.t("currentLayout"),new r.t("backToClassicUrl"),new r.t("isItemSetRendered"),new r.t("isPremiumUpsellVisible"),new r.t("isFamiliesOrGroupsFreVisible"),new r.t("isVaultFreVisible"),new r.t("hasUpsellBeenShownAlready"),new r.t("canModifySchema"),new r.t("displayImageTileNames"),new r.t("isSharingSectionExpanded"),new r.t("hasSeenPositioningThisSession"),new r.t("mobileUpsellDismissedThisSession"),new r.t("mobileOfficeAppUpsellDismissedThisSession"),new r.t("didUserEnterPasswordForFile")},,function(e,t,n){"use strict";var r;(function(e){e[e.Files=0]="Files";e[e.Recent=1]="Recent";e[e.DocumentLibraries=2]="DocumentLibraries";e[e.SharedWithMe=3]="SharedWithMe";e[e.DocsInCommon=4]="DocsInCommon";e[e.RecycleBin=5]="RecycleBin";e[e.Photos=6]="Photos";e[e.Search=7]="Search";e[e.AllMyPhotos=8]="AllMyPhotos";e[e.AccountChooserPicker=9]="AccountChooserPicker";e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK";e[e.Popular=11]="Popular";e[e.RecentUnpopular=12]="RecentUnpopular";e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin";e[e.Apps=14]="Apps";e[e.Subsites=15]="Subsites";e[e.RecentActivity=18]="RecentActivity";e[e.ExternallyShared=19]="ExternallyShared";e[e.SharedByMe=20]="SharedByMe";e[e.Favorites=21]="Favorites";e[e.DetailsPane=22]="DetailsPane";e[e.Channels=24]="Channels";e[e.PhotoStream=25]="PhotoStream";e[e.PhoneLink=26]="PhoneLink";e[e.DefaultDocLib=27]="DefaultDocLib";e[e.ListSyncIssues=28]="ListSyncIssues";e[e.OneDriveHome=29]="OneDriveHome";e[e.TeamsDownloads=30]="TeamsDownloads";e[e.MyLists=31]="MyLists";e[e.Selection=32]="Selection";e[e.People=33]="People";e[e.Meetings=34]="Meetings";e[e.RecentLists=35]="RecentLists";e[e.MyOrganizationAssets=36]="MyOrganizationAssets"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(4),i=n(143),s=n(181),o=new r.t({name:"platformDetection",factory:new i.r(s.e)})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;function i(){void 0===r&&(r=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||(function(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}})());return r}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(4),i=n(143),s=new r.t("identity");new r.t({name:"IdentityDataSource.key",loader:new i.t(function(){return n.ee([26],470).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";var r=n(0),i=n(13),s=(function(e){Object(r.r)(t,e);function t(t,n){return e.call(this,t,n)||this}return t})((function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){var e=this.value?Object(i.y)(this.value):void 0;0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")};e.prototype.getExtraClasses=function(){return this.extraClasses};e.prototype.toString=function(){return this.value};return e})());t.e=s},,,function(e,t,n){"use strict";var r=n(236);n.d(t,"e",function(){return r.e})},,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});var r="List",i="Grid",s="Album"},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=(window.FilesConfig&&window.FilesConfig.skyApiDomain)+"/API/2/";function i(){return r+"GetUserInfo"}function s(){return r+"SetUserInfo"}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(4).t)("engagementHandlers")},function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r=1,i=10},function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(4),i=n(191),s=new(n(33).e)("photosExperimentHelperKeyFacet",{}).serialize({}),o=new(n(3).e)("photosExperimentHelper"),u=n(5);n(140),n(56);var a=n(2),f=n(175),l=new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:a.re?Object(a.te)(a.j)||Object(a.te)(a.z):Object(a.te)(a.W)}}}}),c=(new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:a.re?Object(a.te)(a.j):Object(a.te)(a.W)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInRecentPivot"),factory:{dependencies:{},create:function(){return{instance:Object(a.te)(a.d)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(a.te)(a.I)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!a.re&&Object(a.te)(a.z)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:f.e},create:function(e){return{instance:Object(a.te)(a.M)&&(!e.platformDetection.isIE||Object(a.te)(a._))&&(!e.platformDetection.isSafari||Object(a.te)(a.H))&&(!e.platformDetection.isMobile||Object(a.te)(a.P))}}}})),h=(new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.q)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.U)&&e.isItemsScopeEnabledInAllPhotosPivot}}}})),p=new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.R)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.D)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.B)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.F)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.te)(a.O)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:function(e){var t=e(Object(i.e)(function(e){return e.demandItemFacet(o,s)}));return Object(u.ne)(u.ee)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:h},create:function(e){return{instance:Object(a.te)(a.Y)&&e.isItemsScopeEnabledInSingleTagView}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:p},create:function(e){return{instance:Object(a.te)(a.G)&&e.isItemsScopeEnabledInSinglePlaceView}}}})}],Array(26),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(4).t)("urlLite")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._value=e;this._observers=new Set}e.prototype.get=function(){return this._value};e.prototype.set=function(e){this._value=e;this._observers.forEach(function(e){e()})};e.prototype.subscribe=function(e){var t=this;this._observers.add(e);return function(){t._observers.delete(e)}};return e})()},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r,i=n(4),s=n(143),o=n(235),u=n(118),a=new i.t("".concat("MicroServiceDataSource.key",".microServiceDataSource")),f=n(96),l=n(178),c=n(55),h=n(137);(function(e){e.unauthUser="unauthUser"})(r||(r={}));var p=n(151),d={ODB:n(247).e.ODB?1651:60021},v=Object(p.e)(d)&&Object(p.e)({ODB:-671}),m=(function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===u.e.aad){if(t&&v){var i=new h.e(t).authority;return this._identityDataSource.getSharePointToken(i)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return f.t.resolve()})}else if(n===u.e.msa)return this._identityDataSource.getSessionToken();return f.t.reject(new c.e({code:r.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))};e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)};e.dependencies={identityDataSource:l.e,microServiceDataSource:a.optional};return e})(),g=Object(s.i)("SessionManagementProvider",m),y=n(209),b=n(334),w=n(250),E=n(236),S=new i.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:b.e},create:function(e){var t=new w.e,n=new E.e(e.offlineDetection.offline);t.attach(e.offlineDetection.onChange(function(e){n.set(e)}));return{instance:n,disposable:t}}}}),x=new i.t({name:"cookieOrigin",factory:new i.e(window.location.origin)}),T=new i.t({name:"".concat("VroomDataRequestor",".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:S},create:function(e){return{instance:function(){return f.t.resolve(e.isOfflineStateObservable.get())}}}}}),N=Object(s.i)("VroomDataRequestor",y.e,{sessionManagementProvider:g.optional,urlDataSource:o.e.optional,cookieOrigin:x,isOffline:T})},function(e,t,n){"use strict";n.d(t,"e",function(){return A});var r=n(0),i=n(118),s=n(122),o=n(96),u=n(307),a=n(18),f=n(4),l=n(143),c=n(29),h=new f.t("TokenFetcher.key"),p=n(317),d=n(2),v=n(25),m=n(161),g=n(76),y=n(111),b=n(71),w=n(337),E=n(102),S=n(20),x=n(16),T=!x.e.isActivated("CC480577-4503-4791-A14F-03B120625613","04/29/2022","Use config anon check instead"),N=!x.e.isActivated("51FC098A-B1A9-4476-B1F9-A8A3A0120F40","03/01/2023","Set substrate token expiration time manually to an hour"),C=new f.t({name:"".concat("IdentityDataSource",".enableCooldownAfterAuthFlow"),factory:new f.e(Object(d.te)(d.f))}),k=new f.t({name:"".concat("IdentityDataSource",".enableTokenCache"),factory:new f.e(Object(d.te)(d.K))}),L=(function(){function e(e,t){var n=this;this._getResouceByTokenType=function(e){switch(e){case"graph_auth:":return Object(S.r)();case"substrate_auth:":return Object(S.s)();default:return Object(S.i)()}};this._enableCooldownAfterAuthFlow=t.enableCooldownAfterAuthFlow;this._tokenFetcher=t.tokenFetcher;t.enableTokenCache&&(this._tokenCache=new p.t);this._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0};this._authFrameAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0,"phone_link:":0,"substrate_auth:":0};this._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0};this._scope=new y.e;this._async=this._scope.attach(new b.e);if(this.getIdentity().type===i.e.msa){var r=this._scope.attach(new g.e(this));this._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname;r.on(window,"message",this._onMessageReceived);this._sessionId=$Config.authSessionId||"0";if(!x.e.isActivated("DA868920-AFA9-4023-A5F0-16185C12D46B","10/21/2021","Web canary refresh")){this._lastCanaryRefreshTime=Date.now();r.on(window,"focus",function(){if(Date.now()-n._lastCanaryRefreshTime>6e4){n._lastCanaryRefreshTime=Date.now();n._refreshCanary()}})}}Object(m.t)(m.e.spoSandbox)&&this.signOut()}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.getIdentity=function(){var e=i.e.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?i.e.aad:i.e.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};e.prototype.getSignInUrl=function(){return FilesConfig.si};e.prototype.signOut=function(){this._expireAuthCookie("msa_auth:");this._expireAuthCookie("graph_auth:");this._expireAuthCookie("substrate_auth:")};e.prototype.getSessionToken=function(e,t,n){void 0===e&&(e=!1);void 0===t&&(t=!1);var r=t?"msa_strong_auth:":"msa_auth:";return this._getToken(r,this._getResouceByTokenType(r),e,n)};e.prototype.getGraphToken=function(e){var t=e.forceRefresh,n=void 0!==t&&t,r=e.claimsChallenge;return this._getToken("graph_auth:",this._getResouceByTokenType("graph_auth:"),n,r)};e.prototype.getPhoneLinkToken=function(e){var t=e.resource,n=e.forceRefresh,r=void 0!==n&&n,i=e.claimsChallenge;return this._getToken("phone_link:",t,r,i)};e.prototype.getSubstrateToken=function(e,t){return this._getToken("substrate_auth:",this._getResouceByTokenType("substrate_auth:"),t)};e.prototype.getAuthUrl=function(e,t){var n=new c.t("https://login.live.com/oauth20_authorize.srf");n.setQueryParameter("client_id","00000000481710A4");n.setQueryParameter("res","success");n.setQueryParameter("resuictx","selection");n.setQueryParameter("response_type","token");if(this.getIdentity().type===i.e.msa){var r="sa.html";t?r="saroot.html":"soak2"===FilesConfig.env?r="sasoak2.html":"soak3"===FilesConfig.env?r="sasoak3.html":"dev"===FilesConfig.env&&(r="sadev.html");n.setQueryParameter("redirect_uri","https://p.sfx.ms/".concat(r));t||"msa_strong_auth:"===e||n.setQueryParameter("display","none");var s=void 0;switch(e){case"msa_auth:":case"msa_strong_auth:":s="dev"===FilesConfig.env||FilesConfig.isSpoSandbox?"onedrive-devbox.access":"msa_strong_auth:"===e?"onedrive_implicit_forceSA.access":"onedrive_implicit.access";break;case"graph_auth:":if(Object(d.te)(d.X)){s="contacts.read Files.ReadWrite people.read";Object(w.e)()&&(s+=" Mail.Read");Object(d.te)(d.y)&&(s+=" Family.Read")}else s="contacts.read";break;case"substrate_auth:":s="https://substrate.office.com/M365.Access"}n.setQueryParameter("scope",s);x.e.isActivated("EF2D0BBC-FA1F-44F7-A93D-899C2AB1F098","","")||n.setQueryParameter("login_hint",$Config.email);return n.toString()}return $Config.silentAuth};e.prototype.refreshAuthTicket=function(){this._silentAuthRpsIframe&&document.body.removeChild(this._silentAuthRpsIframe);this._rpsIFrameQosEvent=new a.e({name:"IdentityDataSource.refreshAuthTicket"});this._silentAuthRpsIframe=document.createElement("iframe");var e=$Config.silentAuth;this._silentAuthRpsIframe.src=e.replace(s.e.encodeURIComponent("{{RU}}"),s.e.encodeURIComponent("https://onedrive.live.com/sa?msaCallback=1"));document.body.appendChild(this._silentAuthRpsIframe)};e.prototype._refreshCanary=function(){(new v.e).send({apiName:"getPageContext",url:"/getpagecontext"}).then(function(e){e.canary&&FilesConfig.canary!==e.canary&&(FilesConfig.canary=e.canary)})};e.prototype._getToken=function(e,t,n,s){if(!this._tokenFetcher){if(this.getIdentity().type===i.e.aad)return o.t.reject("Unable to get a token for a business account");if(Object(d.te)(d.o)&&this.getIdentity().type===i.e.anonymous)return o.t.reject("Unable to silent auth anonymous unauth users.")}var f;switch(e){case"graph_auth:":f="Graph";break;case"msa_strong_auth:":f="MSAStrong";break;case"phone_link:":f="PhoneLink";break;case"substrate_auth:":f="Substrate";break;default:f="MSA"}var l=new a.e({name:"IdentityDataSource.get".concat(f,"Token")}),c=this._getTokenFromCache(e),h=c.token,p=c.shouldRefresh,v=c.hadCookie;if(n||s){h=void 0;var m=this._tokenRefreshCooldowns[e];m&&m.complete()}if((p||!h)&&!this._pendingSignals[e]){var g=this._pendingSignals[e]=new u.e;this._tokenFetcher?this._tokenFetcher.getToken({resource:t,tokenType:f,name:f,claimsChallenge:s}).then(function(e){g.complete(Object(r.e)({accessToken:e.access_token},"WLID1.1"===e.scheme?{wlidToken:e.access_token}:{}))},function(e){g.error(e)}):this._setupSilentAuthIframe(e)}if(h){l.end({resultType:a.t.Success,resultCode:p?"withinExpiration":"cached",error:v?void 0:"noCookie"});return o.t.resolve({accessToken:h})}return this._pendingSignals[e].getPromise().then(function(e){l.end({resultType:a.t.Success,resultCode:"fullRefresh"});return e},function(e){l.end({resultType:a.t.Failure,error:e&&e.message});return o.t.reject(e)})};e.prototype._writeTokenToCache=function(e,t,n){this._writeAuthCookie(e,t,n);var r=Date.now()+1e3*(N&&"substrate_auth:"===e?3600:n);if(this._tokenCache){var i=this._getTokenCacheKey(e);this._tokenCache.setValue(i,{value:t,expiration:r})}};e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var n=Date.now(),r=this._getTokenCacheKey(e),i=this._tokenCache.getValue(r,n);if(i)return{token:i.value,shouldRefresh:n+6e4>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}};e.prototype._writeAuthCookie=function(e,t,n){var r=this._getTokenCacheKey(e),i=Date.now()+1e3*(N&&"substrate_auth:"===e?3600:n);E.set(r,t,{path:"/",secure:!0,expires:new Date(i).toUTCString()})};e.prototype._getTokenFromCookie=function(e){var t=this._getTokenCacheKey(e);return E.get(t)};e.prototype._expireAuthCookie=function(e){var t=this._getTokenCacheKey(e);E.expire(t,{secure:!0,path:"/"})};e.prototype._getTokenCacheKey=function(e){return e+this.getIdentity().id+this._sessionId};e.prototype._onMessageReceived=function(e){if(this._silentAuthRpsIframe&&e.source===this._silentAuthRpsIframe.contentWindow&&e.origin===window.location.origin&&e.data){var t=this._rpsIFrameQosEvent;if("MSA_AuthenticationSuccess"===e.data){this._refreshCanary();t.end({resultType:a.t.Success})}else"MSA_AuthenticationError"===e.data&&t.end({resultType:a.t.Failure,resultCode:"error"})}else if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){t=this._currentIFrameQosEvent;var n="",r=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source){n=e.data.token;r=parseInt(e.data.expiresIn,10)}else{if("string"!=typeof e.data)return;var i=e.data.split(" ");if(2===i.length){n=i[0];r=parseInt(i[1],10)}else if(1===i.length){var s=i[0].split("&");t.end({resultType:a.t.Failure,resultCode:"error"});if(0===s[0].indexOf("error=access_denied")){var o=T?null===$Config||void 0===$Config?void 0:$Config.anonId:E.get("ANON");Object(d.te)(d.p)&&o&&window.open(this.getAuthUrl(this._silentAuthIframeTokenType,!0),"_self")}return}}if(!!n&&r>0){this._writeTokenToCache(this._silentAuthIframeTokenType,n,r);t.end({resultType:a.t.Success});var u=this._pendingSignals[this._silentAuthIframeTokenType];u&&u.complete({accessToken:n})}else t.end({resultType:a.t.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}};e.prototype._setupSilentAuthIframe=function(e){var t=this;if(!this._silentAuthIframe){this._authFrameAttempts[e]++;this._silentAuthIframeTokenType=e;var n=this._tokenRefreshCooldowns[e];o.t.resolve(n&&n.getPromise()).then(function(){var n=t._currentIFrameQosEvent=new a.e({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:e,attemptCount:t._authFrameAttempts[e]}});t._silentAuthIframe=document.createElement("iframe");t._silentAuthIframe.style.display="none";t._silentAuthIframe.src=t.getAuthUrl(e);document.body.appendChild(t._silentAuthIframe);t._silentAuthIframeTimeoutId=t._async.setTimeout(function(){t._silentAuthIframeTimeoutId=void 0;n.end({resultType:a.t.Failure,resultCode:"timeout"});if(t._authFrameAttempts[e]<5){t._removeSilentAuthIframe(e,!1);t._setupSilentAuthIframe(e)}else t._removeSilentAuthIframe(e,!0)},3e4)})}};e.prototype._removeSilentAuthIframe=function(e,t){this._silentAuthIframeTokenType=void 0;if(this._silentAuthIframe){document.body.removeChild(this._silentAuthIframe);this._silentAuthIframe=void 0}if(void 0!==this._silentAuthIframeTimeoutId){this._async.clearTimeout(this._silentAuthIframeTimeoutId);this._silentAuthIframeTimeoutId=void 0}if(this._enableCooldownAfterAuthFlow){var n=this._tokenRefreshCooldowns[e]=new u.e;this._async.setTimeout(function(){n.complete()},3e4)}if(t){var r=this._pendingSignals[e];r&&r.error(new Error("Timed out acquiring OAuth token."));this._pendingSignals[e]=void 0;this._authFrameAttempts[e]=0;this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["msa_strong_auth:"]?this._setupSilentAuthIframe("msa_strong_auth:"):this._pendingSignals["graph_auth:"]?this._setupSilentAuthIframe("graph_auth:"):this._pendingSignals["substrate_auth:"]&&this._setupSilentAuthIframe("substrate_auth:")}};e.dependencies={enableCooldownAfterAuthFlow:C,enableTokenCache:k,tokenFetcher:h.optional};return e})(),A=Object(l.i)("IdentityDataSource",L)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o="".concat(s);if(!t[o]){t[o]=!0;n.push(s)}}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={ODB:window._spModuleLink&&-1!==["ODBLightSpeedWebPack","ODBOneDrive"].indexOf(window._spModuleLink.manifestName)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(4),i=n(2),s=new r.t({name:"".concat("SharedItemsScopeExperiment.key",".isUseItemsScopeInSharedEnabled"),factory:new r.e(Object(i.te)(i.I))})},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.trackSignal=function(e){this.attach({dispose:function(){e.cancel()}});return e};return t})(n(111).e);t.e=i},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return y});n(289),n(180);var r,i,s,o,u,a=n(82),f=n(282);n.d(t,"e",function(){return f.e});var l="ms-word",c="onenote|UsePlain",h="ms-powerpoint",p="ms-excel",d="ms-visio",v="ms-publisher",m="ms-project";(r={})[l]=a.p,r[c]=a.s,r[h]=a.u,r[p]=a.n,r[d]=a.c;(i={})[l]=a.h,i[c]=a.i,i[h]=a.o,i[p]=a.t,i[d]=a.l,i[v]=a.f,i[m]=a.a,i["ms-infopath"]=a.r;var g=((s={})[l]="Word",s[c]="OneNote",s[h]="PowerPoint",s[m]="Project",s[d]="Visio",s[p]="Excel",s);function y(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":g[e.appMap]||"Word"}(o={})[l]="WordLogo",o[c]="OneNoteLogo",o[h]="PowerPointLogo",o[p]="ExcelLogo",o[d]="VisioLogo",o[v]="Page",(u={})[l]="svg/word_16x1.svg",u[c]="svg/onenote_16x1.svg",u[h]="svg/powerpoint_16x1.svg",u[p]="svg/excel_16x1.svg",u[d]="svg/visio_16x1.svg",u[v]="Page",u.Stream="svg/stream_16x1.svg"}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(148),s=n(128),o=n(4),u=n(143),a=new o.t({name:"".concat("Engagement",".engagementSource"),factory:new o.e(i.e)}),f=n(204),l=new o.t({name:"".concat("Engagement",".useEngagementSystem"),factory:new o.e(!0)}),c={engagementHandlers:f.e.optional},h=new o.t({name:"".concat("Engagement",".engagementHelper"),loader:{load:function(){return Object(r.t)(void 0,void 0,void 0,function(){var e;return Object(r.i)(this,function(t){switch(t.label){case 0:return[4,n.ee([35],725)];case 1:e=t.sent().EngagementHelper;return[2,{dependencies:c,create:function(t){var n=t.engagementHandlers;return{instance:new e({},{handlers:n})}}}]}})})}}}),p=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._isEnabled=n.isEnabled;r._getEngagementHelper=n.getEngagementHelper;r._getEngagementHandlers=n.getEngagementHandlers;r._isEnabled&&r._getEngagementHelper().catch(function(){});return r}t.prototype.logData=function(e){var t=this;void 0===e&&(e={});this._isEnabled?this._getEngagementHelper().then(function(n){n.fromSource({contexts:t.contexts}).logData(e)}).catch(function(){}):e.name&&s.e.logData(e)};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},isEnabled:this._isEnabled,getEngagementHelper:this._getEngagementHelper,getEngagementHandlers:this._getEngagementHandlers})};t.dependencies={engagementSource:a,isEnabled:l,getEngagementHelper:h.async.lazy,getEngagementHandlers:f.e.optional.async.lazy};return t})(i.t),d=Object(u.i)("Engagement",p)},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return pe});var r,i,s=n(284),o=n(0),u=n(71),a=n(96),f=n(307),l=n(152),c=n(143),h=n(4),p=n(250).e,d=n(18),v=n(321),m=n(16),g=m.e.isActivated("06BB39DE-57D9-40CA-B107-2EBFF4CE4AF5","11/10/2022","Point logSuccess, logUnexpectedFailure, and logExpectedFailure to use logEndData"),y=m.e.isActivated("68B68656-3621-421B-9045-10B503504CEC","12/17/2022","Log and end a Qos Event when AppQos logs an end event without a start.");function b(e,t,n){void 0===n&&(n=!1);if(!r){var s=e||{name:"App"},u=d.e.withContext(function(e){return t?Object(o.e)(Object(o.e)({},e),{Workload:t}):e});r=new u(s);n&&(i=new v.e({scenario:"AppBoot",pillar:"Boot"}))}return r}function w(e){var t=e.workload;if(!r){b(void 0,t);if(!y){new d.e({name:"AppQosWithoutStart"}).end({resultType:d.t.Failure})}}e&&r.end(e);i&&e&&i.end({resultType:e.resultType,errorCode:null==e?void 0:e.resultCode,extraData:null==e?void 0:e.extraData})}var E=new h.t("BootOptions"),S=n(63),x=(function(){function e(e,t){this.isPageLoaded=!1;this.isPageRenderingComplete=!1;this._pltSignal=new f.e;this._renderingCompleteSignal=new f.e;this._async=new u.e;this._resources=t.resources;this._immediatePageLoadedCallbacks=[];this._scope=new p;this._scope.attach(this._async);this._scope.trackSignal(this._pltSignal);this._scope.trackSignal(this._renderingCompleteSignal)}e.prototype.pageLoaded=function(e){var t,n,i,s=this;if(e)if("string"==typeof e)t=e;else{t=e.name;n=e.workload;i=e.error}if(!this.isPageLoaded){t&&l.e.plt(t);(function(e){if(g){var t=(e||{}).workload;r||b(void 0,t);r.end(e||{resultType:d.t.Success})}else w(e||{resultType:d.t.Success})})(Object(o.e)({resultType:d.t.Success},n?{workload:n}:{}));this.isPageLoaded=!0;this.pageLoadError=i;var u=this._resources.consume(E.optional);u&&u.onEUPL&&u.onEUPL();for(var f=[],c=this._immediatePageLoadedCallbacks.shift();c;){f.push(this._scope.trackPromise(c()));c=this._immediatePageLoadedCallbacks.shift()}a.t.all(f).then(function(){s._async.setImmediate(function(){return s._pltSignal.complete()})})}};e.prototype.pageRenderingIsComplete=function(e){var t=this;this._async.setImmediate(function(){return t._renderingCompleteSignal.complete()})};e.prototype.waitForPLT=function(){var e=this,t=this._pltSignal;return t.getPromise().catch(function(n){return n instanceof S.e&&t!==e._pltSignal?e.waitForPLT():a.t.reject(n)})};e.prototype.waitForPageRenderingComplete=function(){var e=this,t=this._renderingCompleteSignal;return t.getPromise().catch(function(n){return n instanceof S.e&&t!==e._renderingCompleteSignal?e.waitForPageRenderingComplete():a.t.reject(n)})};e.prototype.reset=function(){this.isPageLoaded=!1;this.pageLoadError=void 0;var e=this._pltSignal,t=this._renderingCompleteSignal;this._pltSignal=new f.e;this._renderingCompleteSignal=new f.e;e.error(new S.e({message:"Reset page load state."}));t.error(new S.e({message:"Reset page load state."}))};e.prototype.addImmediatePageLoadedCallback=function(e){if(this.isPageLoaded)throw"Cannot add immediate page loaded call back after page has already loaded";if(this._immediatePageLoadedCallbacks.length>3)throw"Too many callbacks registered!";this._immediatePageLoadedCallbacks.push(e)};e.prototype.dispose=function(){this._scope.dispose()};return e})(),T=Object(c.i)("PageLoadMonitor",x,{resources:h.i}),N=n(79),C=n(342),k=n(12),L=n(8),A=n(24),O=n(144),M=new O.e("storeKeyToNavigationUrl",{url:O.t}),_=new h.t("storeKeyToUrlControlHandler"),D=n(140),P=new h.t("IItemsScopeKeyConverter"),H=new O.e("itemKeyToStoreKey",{storeKey:O.t}),B=n(340),j=new h.t("ItemsScopeAddon"),F=new h.t("IItemCacheConfiguration"),I=n(186),q=new h.t({name:"ItemProvider.key",loader:new c.t(function(){return n.ee(1,318).then(function(e){return e.resourceKey})})}),R=new h.t({name:"KnockoutStoreItemControlHandler",factory:{dependencies:{resources:h.i},create:function(e){var t=e.resources;return{instance:Object(I.t)(function(){return Object(o.t)(void 0,void 0,void 0,function(){var e,n;return Object(o.i)(this,function(r){switch(r.label){case 0:return[4,t.consumeAsync(q)];case 1:e=r.sent();n=function(){return{getItem:function(t){return e.getItemSync({parentKey:t,ignoreChildren:!0}).item}}};return[2,Object(I.e)()(function(){return function(){return n}})]}})})})}}}}),U=(new h.t({name:"KnockoutStoreItemControlHandler",factory:{dependencies:{itemProvider:q},create:function(e){var t=e.itemProvider;function n(e,n){return{getItem:function(e){return t.getItemSync({parentKey:e,ignoreChildren:!0}).item}}}return{instance:Object(I.e)()(function(){return function(){return n}})}}}}),new O.e("knockoutStoreItem",{getItem:O.t})),z=n(383),W=n(191),X=n(539),V=(n(1),n(51)),$=n(188),J=n(34),K=n(372),Q=n(341),G=n(58),Y=new h.t("rumOneHelper"),Z=(new h.t("rumOneListsHomeHelper"),new h.t("RUMOneScenarioPrefix"),n(550)),ee=n(2),te=n(532),ne=n(73),re=n(175),ie=n(373),se=n(123),oe=window._spPageContextInfo,ue=m.e.isActivated("69cccbd8-2920-4c21-ac9a-62ff791a6c06","11/16/2022","set debounce render to be false"),ae={resources:h.i},fe=new h.t({name:"".concat("ItemCacheConfiguration",".webConfiguration"),factory:{dependencies:{},create:function(){return{instance:Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)({},Q.e.pack(new Z.e)),$.t.pack(Object(K.e)())),{}),J.s.pack({enablePageLoadBarrier:!0}))}}}}),le=(new h.t({name:"ItemCacheConfiguration",factory:{dependencies:ae,create:function(e){var t=e.resources;return{instance:Object(N.e)(function(){return function(e){var n,r=new te.e,i=t.consume(re.e),s=Object(ee.ie)("ExternalService_isitemscopefilecardenabled");r.resolveItems({items:(n={},n[ne.e]=Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)({},J.i.pack({reportRUMOnePerfData:!1,logRenderEndTime:function(e,n){var r=t.consume(Y.optional);r&&r.logRUMOneForItemsScopeListView(e,n)}})),J.s.pack({enablePageLoadBarrier:!0})),G.d.pack({language:V.e.language,cultureLCID:V.e.cultureLCID})),G.c.pack(!0)),G.u.pack(!0)),G.p.pack(!0)),G.f.pack(!!ue)),G.r.pack(!0)),G.h.pack(Object(ee.te)(ee.m))),G.l.pack(!0)),G.a.pack(!0)),G.o.pack(s&&!i.isMobile)),G.i.pack(Object(ee.te)(ee.l))),G.s.pack(Object(ee.te)(ee.c))),G.n.pack(!0)),ie.e.pack({showInPLT:Object(ee.te)(ee.u)||1===Object(se.n)(90158,oe)})),G.t.pack(.1)),n)});e(r.execute())}})}}}}),new h.t({name:"".concat("ItemCacheStoreBase",".oneItemCacheInstance"),factory:{dependencies:{},create:function(){return{instance:{created:!1}}}}})),ce=new h.t({name:"".concat("ItemCacheStoreBase",".storeBase"),factory:{dependencies:{webConfiguration:fe,oneItemCacheInstance:le},create:function(e){var t=e.webConfiguration,n=e.oneItemCacheInstance;if(n.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");n.created=!0;var r=Object(X.e)({configuration:t});return{instance:r,disposable:r}}}}),he={urlRoutingAddon:new h.t({name:"".concat("ItemCacheStore",".urlRoutingAddon"),factory:{dependencies:{itemsScopeKeyConverter:P,storeKeyToUrlControlHandler:_},create:function(e){var t=e.itemsScopeKeyConverter,n=e.storeKeyToUrlControlHandler;return{instance:Object(N.e)(function(){return function(e){e(Object(C.e)(D.t,H)(t.itemKeyToStoreKeyControlHandler));e(Object(C.e)(D.t,B.e)(t.viewParamsToItemKeyControlHandler));e(Object(C.e)(D.t,M)(n));e(z.e)}})}}}}),itemsScopeAddon:j,itemCacheConfiguration:F,itemCacheStoreBase:ce,knockoutStoreItemAddon:new h.t({name:"".concat("ItemCacheStore",".knockoutStoreItemAddon"),factory:{dependencies:{knockoutStoreItemControlHandler:R},create:function(e){var t=e.knockoutStoreItemControlHandler;return{instance:Object(N.e)(function(){return function(e){e(Object(C.e)(D.t,U)(t))}})}}}}),pageLoadAddon:new h.t({name:"".concat("ItemCacheStore",".pageLoadAddon"),factory:{dependencies:{pageLoadMonitor:T,resources:h.i},create:function(e){var t=e.resources,n=e.pageLoadMonitor;return{instance:Object(N.e)(function(){return function(e){e(Object(s.r)({waitIndefinitely:!0})).then(function(){var r=(function(e){var t=e.consume(A.c);return"".concat(k.e[t.getPageType()]||"Default","-").concat(L.e[t.getQueryType()]||"Default")})(t);n.pageLoaded({name:r,error:e(Object(W.e)(function(e){return Object(s.e)(e)}))})})}})}}}})},pe=new h.t({name:"ItemCacheStore",factory:{dependencies:he,create:function(e){var t=e.pageLoadAddon,n=e.urlRoutingAddon,r=e.itemsScopeAddon,i=e.itemCacheConfiguration,s=e.itemCacheStoreBase,o=e.knockoutStoreItemAddon;s.dispatch(i);s.dispatch(n);s.dispatch(o);s.dispatch(r);s.dispatch(t);return{instance:s}}}})},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(292),i=n(1),s=n(100);function o(e){var t=e.targetOrigin,n=e.logOnly,o=e.iframeElem,u=e.allowedOrigins,a=e.migrationState,f=Object(s.t)().dispatcher;Object(i.useEffect)(function(){if(o){var e=new r.t({targetOrigin:t,logOnly:n,iframeElem:o,allowedOrigins:u,migrationState:a});e.attach(f);e.start();e.sendHostReadyMessage();return function(){e.dispose();e.deattach()}}},[n,o,u,f]);return null}function u(e){var t=e.application,n=e.session,o=e.migrationState,u=Object(s.t)().dispatcher;Object(i.useEffect)(function(){if(t&&n&&u){var e=Microsoft.Office[t.name].CommandIds,i=new r.e({application:t,session:n,migrationState:o,commandIds:e});i.attach(u);i.start();return function(){i.dispose();i.deattach()}}},[t,n,u]);return null}},function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(83),s=n(19),o=n(96),u=n(18),a=n(36),f=n(128),l=(function(){function e(e){var t=this;this.handleMessage=function(e){return Object(r.t)(t,void 0,void 0,function(){var t,n,i,s,l,c,h,p,d,v;return Object(r.i)(this,function(r){switch(r.label){case 0:Object(a.e)("WacPostMessageSource receive message: ",e.data);t=new u.e({name:"WacHost.Message.Post.".concat(e.type)});if(!this.validate(e)){Object(a.e)("WacPostMessageSource invalid message: ",e.data);t.end({resultType:u.t.ExpectedFailure,resultCode:"WAC Post message source/origin is invalid",extraData:{origin:e.origin}});return[2]}try{n=JSON.parse(e.data)}catch(n){Object(a.e)("WacPostMessageSource invalid message data: ",e.data);t.end({resultType:u.t.Failure,resultCode:"WAC Post message data is invalid",extraData:{data:e.data,Error:null==n?void 0:n.message}});return[2]}if(this.logOnly){Object(a.e)("WacPostMessageSource log message only: ",e.data);t.end({resultType:u.t.Success,resultCode:"WAC post message handling success",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(c=n.Values)||void 0===c?void 0:c.wdUserSession)}});return[2]}f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Receive.").concat(n.MessageId),usageType:"Click",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(h=n.Values)||void 0===h?void 0:h.wdUserSession)}});r.label=1;case 1:r.trys.push([1,6,,7]);if(!this.dispatcher){Object(a.e)("WacPostMessageSource ignore message cause no dispatcher: ",e.data);t.end({resultType:u.t.Success,resultCode:"Application message handling skip",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(p=n.Values)||void 0===p?void 0:p.wdUserSession)}});return[2]}if(!(i=this.dispatcher.dispatch(n.MessageId,n.Values)))return[3,5];s=void 0;return o.t.isPromise(i)?[4,i]:[3,3];case 2:s=r.sent();return[3,4];case 3:s=i;r.label=4;case 4:s&&this.receive(s,e.source,e.origin);r.label=5;case 5:t.end({resultType:u.t.Success,resultCode:"WAC post message handling success",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(d=n.Values)||void 0===d?void 0:d.wdUserSession)}});return[3,7];case 6:l=r.sent();Object(a.e)("WacPostMessageSource message error: ",l);t.end({resultType:u.t.Failure,resultCode:"WAC Post message handling error",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(v=n.Values)||void 0===v?void 0:v.wdUserSession),Error:null==l?void 0:l.message}});return[3,7];case 7:return[2]}})})};this.logOnly=e.logOnly;this.targetOrigin=e.targetOrigin;this.allowedOrigins=e.allowedOrigins;this.iframeElem=e.iframeElem;this.migrationState=e.migrationState}e.prototype.attach=function(e){this.deattach();this.dispatcher=e;e.attach(this)};e.prototype.deattach=function(){if(this.dispatcher){this.dispatcher.deattach(this);this.dispatcher=void 0}};e.prototype.start=function(){window.addEventListener("message",this.handleMessage)};e.prototype.dispose=function(){window.removeEventListener("message",this.handleMessage)};e.prototype.sendHostReadyMessage=function(){if(this.iframeElem)try{this.receive({CorrelationId:i.e.generate(),MessageId:s.t.Host_PostmessageReady})}catch(e){console.log(e)}};e.prototype.receive=function(e,t,n){if(!this.logOnly){f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Send.").concat(e.MessageId),usageType:"Click",extraData:{SendTime:Date.now(),CorrelationId:null==e?void 0:e.CorrelationId}});t=t||this.iframeElem.contentWindow;n=n||this.targetOrigin;t&&n&&t.postMessage(JSON.stringify(Object(r.e)(Object(r.e)({},e),{SendTime:Date.now()})),n)}};e.prototype.validate=function(e){var t=this.allowedOrigins,n=this.iframeElem,r=e.origin,i=e.source;if(!n||i!==n.contentWindow){Object(a.e)("WacPostMessageSource invalid message cause invalid source");return!1}if(t){if(-1===t.findIndex(function(e){return r.toLowerCase()===e.toLowerCase()})){Object(a.e)("WacPostMessageSource invalid message cause invalid origin");return!1}}return!0};return e})(),c=(function(){function e(e){var t=this;this.handleMessage=function(e){return Object(r.t)(t,void 0,void 0,function(){var t,n,i,s,l,c,h,p,d;return Object(r.i)(this,function(r){switch(r.label){case 0:Object(a.e)("WacPostMessageSource receive message: ",e.data);t=new u.e({name:"WacHost.Message.Application.".concat(e.type)});n=e.type,i=e.data;f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Receive.").concat(n),usageType:"Click",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(c=i.Values)||void 0===c?void 0:c.wdUserSession)}});r.label=1;case 1:r.trys.push([1,6,,7]);if(!this.dispatcher){t.end({resultType:u.t.Success,resultCode:"Application message handling skip",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(h=i.Values)||void 0===h?void 0:h.wdUserSession)}});return[2]}if(!(s=this.dispatcher.dispatch(n,i)))return[3,5];l=void 0;return o.t.isPromise(s)?[4,s]:[3,3];case 2:l=r.sent();return[3,4];case 3:l=s;r.label=4;case 4:l&&this.receive(l);r.label=5;case 5:t.end({resultType:u.t.Success,resultCode:"Application message handling success",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(p=i.Values)||void 0===p?void 0:p.wdUserSession)}});return[3,7];case 6:r.sent();Object(a.e)("WacPostMessageSource receive message: ",e.data);t.end({resultType:u.t.Failure,resultCode:"Application message handling error",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(d=i.Values)||void 0===d?void 0:d.wdUserSession)}});return[3,7];case 7:return[2]}})})};this.application=e.application;this.session=e.session;this.migrationState=e.migrationState;this.commandIds=e.commandIds}e.prototype.attach=function(e){this.deattach();this.dispatcher=e;e.attach(this)};e.prototype.deattach=function(){if(this.dispatcher){this.dispatcher.deattach(this);this.dispatcher=void 0}};e.prototype.start=function(){this.application.addEventListener(this.handleMessage)};e.prototype.dispose=function(){this.application.removeEventListener(this.handleMessage)};e.prototype.receive=function(e){f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Send.").concat(e.MessageId),usageType:"Click",extraData:{SendTime:Date.now(),CorrelationId:null==e?void 0:e.CorrelationId}});this.runCommand(e)};e.prototype.runCommand=function(e){var t=e.MessageId,n=e.Values,r=this.getCommandId(t);r&&this.session.run(r,n)};e.prototype.getCommandId=function(e){var t=this.commandIds;switch(e){case s.t.BlurFocus:return t.blurFocus;case s.t.Host_AccessibilityLoopComplete:return t.continueAccessibilityLoop;case s.t.GrabFocus:return t.grabFocus;case s.t.CanEmbed:return t.sendEmbeddedViewUrl;case s.t.PostAccessToken:return t.sendAccessToken;case s.t.App_PopState:return t.popState;case s.t.Host_RefreshSessionInfo:return t.sendSessionInfo;case s.t.CheckUserAccessAndGrantPermissions_Result:return t.sendUserAccessAndPermissions;case s.t.Host_WopiInfoFromUrl:return t.sendWopiInfo;case s.t.Host_DavUrlFromIds:return t.sendDavUrl;case s.t.Host_SetCustomAuthConfig:return t.sendCustomAuthConfig;case s.t.Host_MoveToFolder:return t.moveToFolder;case s.t.Host_FilePicker:return t.completeSharedFilePicker}};return e})()}],Array(17),[function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return l});n.d(t,"t",function(){return h});var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},i="undefined"==typeof window?e:window,s=i&&i.CSPSettings&&i.CSPSettings.nonce,o=(function(){var e=i.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};e.runState||(e=r(r({},e),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}}));e.registeredThemableStyles||(e=r(r({},e),{registeredThemableStyles:[]}));i.__themeState__=e;return e})(),u=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,a=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function f(e){var t=a();e();var n=a();o.perf.duration+=n-t}function l(e,t){void 0===t&&(t=!1);f(function(){var n=Array.isArray(e)?e:v(e),r=o.runState,i=r.mode,s=r.buffer,u=r.flushTimer;if(t||1===i){s.push(n);u||(o.runState.flushTimer=setTimeout(function(){o.runState.flushTimer=0;f(function(){var e=o.runState.buffer.slice();o.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&c(t)})},0))}else c(n)})}function c(e,t){o.loadStyles?o.loadStyles(d(e).styleString,e):(function(e){if("undefined"==typeof document)return;var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),r=d(e),i=r.styleString,u=r.themable;n.setAttribute("data-load-themed-styles","true");s&&n.setAttribute("nonce",s);n.appendChild(document.createTextNode(i));o.perf.count++;t.appendChild(n);var a=document.createEvent("HTMLEvents");a.initEvent("styleinsert",!0,!1);a.args={newStyle:n};document.dispatchEvent(a);var f={styleElement:n,themableStyle:e};u?o.registeredThemableStyles.push(f):o.registeredStyles.push(f)})(e)}function h(e){o.theme=e;(function(){if(o.theme){for(var e=[],t=0,n=o.registeredThemableStyles;t<n.length;t++){var r=n[t];e.push(r.themableStyle)}if(e.length>0){(function(e){void 0===e&&(e=3);if(3===e||2===e){p(o.registeredStyles);o.registeredStyles=[]}if(3===e||1===e){p(o.registeredThemableStyles);o.registeredThemableStyles=[]}})(1);c([].concat.apply([],e))}}})()}function p(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function d(e){var t=o.theme,n=!1;return{styleString:(e||[]).map(function(e){var r=e.theme;if(r){n=!0;var i=t?t[r]:void 0,s=e.defaultValue||"inherit";t&&!i&&console,0;return i||s}return e.rawString}).join(""),themable:n}}function v(e){var t=[];if(e){for(var n=0,r=void 0;r=u.exec(e);){var i=r.index;i>n&&t.push({rawString:e.substring(n,i)});t.push({theme:r[1],defaultValue:r[2]});n=u.lastIndex}t.push({rawString:e.substring(n)})}return t}}).call(this,n(390))},,,,,function(e,t,n){"use strict";var r,i=n(0),s=n(23),o=n(96),u=n(251),a=n(228),f=n(67),l=n(307),c=n(25),h=(function(){function e(){}e.start=function(e){var t=new l.e(function(){for(var e=0,t=i;e<t.length;e++){t[e].cancel()}}),n=e.items.slice(),r=e.parallelRequests||1,i=[];function s(e){var t=i.indexOf(e);t>=0&&i.splice(1,t)}function o(){var r=new c.e,u=n.splice(0,e.batchSize),a=JSON.stringify(e.getPostData(u)),f=r.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:a,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){s(f);e.onBatchComplete&&e.onBatchComplete(u);n.length?o():t.complete()},function(e){s(f);(function(e){t.error(e)})(e)});i.push(f)}for(var u=0;n.length>0&&u<r;u++)o();return t.getPromise()};return e})(),p=n(48),d=n(66),v=n(30),m=n(338),g=n(133),y=n(369);(function(e){e.AppleLivePhoto="AppleLivePhoto";e.SamsungMotionPhoto="SamsungMotionPhoto"})(r||(r={}));var b,w=n(4),E=n(143),S=new w.t({name:"VaultDataSource.key",loader:new E.t(function(){return n.ee(1,378).then(function(e){return e.resourceKey})})}),x=n(62),T=n(8),N=n(80),C=n(21),k=n(16),L=n(113),A=n(256),O=n(379),M=n(51);(function(e){e[e.unRes=0]="unRes";e[e.doc=1]="doc"})(b||(b={}));var _=n(9),D=b[b.unRes],P=b[b.doc],H=(function(e){Object(i.r)(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.processThumbnailSet=function(e,t){for(var n={},r={},s=0,o=e.thumbnails;s<o.length;s++){var u=o[s];n[u.name]=u;if(0===u.name.indexOf("scaled")){r[u.name.substring("scaled".length).toLowerCase()]=u}}var a,f={thumbnailSet:e,thumbnailsByType:n,thumbnailsBySize:r,item:t},l=n[D],c=n[P];l?a=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(l,f):this._getUnResThumbnail(l,f):c?a=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(Object(i.e)(Object(i.e)({},c),{width:t.video.width,height:t.video.height}),f):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(Object(i.e)(Object(i.e)({},c),{width:t.photo.width,height:t.photo.height}),f):this._getDocThumbnail(c,f):Object.keys(r).length&&(a=this._getScaledThumbnail(f));return a};t.prototype.getProcessFiltersUrl=function(e,t){for(var n,r=0,i=e.thumbnails;r<i.length;r++){var s=i[r];"custom"===s.name&&(n=s)}return n?this._createSizedUrl(e.baseUrl,n.url,{width:n.width,height:n.height}):""};t.prototype._getOriginalThumbnail=function(e,t){var n=t.item.photo.originalUrl||t.item.urls&&t.item.urls[g.e[g.e.download]];return n?{width:t.item.photo.width,height:t.item.photo.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(e,r){return{width:t.item.photo.width,height:t.item.photo.height,url:n}}}:this._getUnResThumbnail(e,t)};t.prototype._getUnResThumbnail=function(e,t){var n=this;return{width:e.width,height:e.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:e.width,height:e.height,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,r)}}}};t.prototype._getDocThumbnail=function(e,t){var n=this;return{width:0,height:0,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:0,height:0,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,{width:r.width,height:Math.max(r.height,2048)})}}}};t.prototype._getScaledThumbnail=function(e){var t,n=this,r=[];for(var i in e.thumbnailsBySize){var s=e.thumbnailsBySize[i];switch(i){case"largest":t=s;break;default:r.push(s)}}r.sort(function(e,t){return e.width*e.height-t.width*t.height});t=t||r[r.length-1];var o=e.item.photo||t;return{url:this._createUrl(e.thumbnailSet.baseUrl,t.url),width:o.width,height:o.height,getAligned:function(i,s){for(var u,a=i.width*i.height,f=0,l=r;f<l.length;f++){var c=l[f];if(c.width*c.height>.9*a){u=c.url;break}}return{width:o.width,height:o.height,url:n._createUrl(e.thumbnailSet.baseUrl,u||t.url)}}}};t.prototype._createSizedUrl=function(e,t,n){var r={width:Math.ceil(n.width),height:Math.ceil(n.height)};n.width===n.height&&(r.cropMode="center");return this._createUrl(e,t,r)};t.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})};t.prototype._createUrl=function(e,t,n){void 0===n&&(n={});var r="".concat(e).concat(t),i=_.t(n)?r.indexOf("?")>-1?"&":"?":"";return"".concat(r).concat(i).concat(_.t(n))};t.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,n=void 0===t?"":t,r=e.photo;return".gif"===n.toLowerCase()&&!!r};return t})(s.t),B=n(5),j=n(64),F=n(24),I=n(130),q=n(263),R=1e3;function U(e){var t=!1;if(e)switch(e.errorCode){case 2:case 101:case 102:case 103:case 152:case 161:case 162:case 200:case 201:case 202:case 209:case 1e3:case 1006:case 1007:case 2006:case 3e3:case 3403:case 9017:case 10001:case 10002:case 10004:case 10006:case 10009:case 10011:case 10012:case 10013:case 10027:t=!0}return t}(function(e){Object(i.r)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(j.t);return n}t.prototype.addToAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.removeFromAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.createAlbum=function(e,n){var r=this,i=this._getIdsFromKeyArray(n),s=i.slice(0,20),u={id:null,name:e,items:s,action:t.CREATE_ALBUM_ACTION};return(new c.e).send({requestType:"POST",postData:JSON.stringify(u),apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(u.action),url:this._getModifyAlbumUrl(),isErrorExpectedCallback:U}).then(function(e){if(!n||n&&n.length<20)return e;s=i.slice(20);var u={id:e.id,items:s,action:t.ADD_TO_ALBUM_ACTION,name:null};return r._handleRequest(s,u).then(function(t){return e},function(e){var t={errorType:q.e.other,error:new Error(e.data.message)};return o.t.wrapError(t)})},function(e){var t=q.e.other;e.data.code===R&&(t=q.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return o.t.wrapError(n)})};t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new c.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),r=new c.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(i.action),url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:U})};t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var r=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return _.t(r,void 0,!0)};t.prototype.setCoverPhoto=function(e,n){var r=this._getModifyAlbumUrl(),i=new c.e,s={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(s.action),url:r,requestType:"POST",postData:JSON.stringify(s),isErrorExpectedCallback:U}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return o.t.wrapError(t)})};t.prototype._handleRequest=function(e,n){var r=this._getModifyAlbumUrl();return h.start({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(n.action),url:r,batchSize:20,items:e,isErrorExpectedCallback:U,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})};t.prototype._getModifyAlbumUrl=function(){return C.e.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME};t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return _.e(e).id})};t.ADD_TO_ALBUM_ACTION="Add";t.CREATE_ALBUM_ACTION="Create";t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";t.REMOVE_FROM_ALBUM_ACTION="Remove";t.SET_COVER_PHOTO_ACTION="SetCoverPhoto";t.MODIFY_ALBUM_API_NAME="ModifyAlbum";t.ALBUMS_ID="albums"})(s.t);var z,W=n(246),X=n(45),V=n(106),$=((z={}).at="1",z.ata="1",z.de="3",z.defc="1",z.dl="3",z.em="3",z.mc="1",z.rfa="1",z.rn="1",z.sh="1",z.vo="1",[".jfif",".jfif-tbnl",".jpe",".jpg",".jpeg"]);function J(e){return $.some(function(t){return e.toLowerCase()===t})}var K=n(297);function Q(e,t,n){var r=window.FilesConfig&&window.FilesConfig.df?"s":"p";return"https://southcentralus1-media".concat(r,".svc.ms/transform/").concat(e,"?provider=odc&cs=V2VifE9EQw==&inputFormat=").concat(t,"&docid=").concat(encodeURIComponent(n))}var G=n(528);function Y(e){if("number"==typeof e)return Object(G.e)(e)}var Z=n(118),ee=!k.e.isActivated("B11CEEB1-B225-42EF-A0A0-0892C41C07F1","07/15/2022","Force item redemption for skyapi items when the user is anonymous"),te={0:p.e.Owner,1:p.e.Edit,2:p.e.View,3:p.e.Submitter,4:p.e.CoOwner,5:p.e.None},ne=(function(e){Object(i.r)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.getRootItemTitle,i=void 0===r?n._getRootItemTitle:r,s=t.getItemKeyExtension,o=void 0===s?n._getItemKeyExtension:s;n._getRootItemTitle=i;n._getItemKeyExtension=o;n._urlDataSource=n.resources.consume(j.t);n._identityDataSource=n.resources.consume(F.i);n._thumbnailProcessor=new(n.managed(H));return n}t.prototype.processItemResult=function(e){var t=this,n=e.requestKey,s=e.itemFromServer,o=e.requestMetadata,u=e.setItemKey,a=e.skipSettingChildren,l=e.isPrimaryRequestedItem,c=e.isPlaceholder,h=e.observer,m=this._urlDataSource.getKeyParams(n),b=e.queryType,w=void 0===b?this._urlDataSource.getQueryType(m):b;if(s){var E=this.getItemKey({requestKey:n,itemFromServer:s}),x={key:E},k=s.itemStatus;x.itemStatus=k;var _="";s.locatedIn?_=s.locatedIn:s.deletedFromLocation?_="/"===s.deletedFromLocation[0]?s.deletedFromLocation.substr(1):s.deletedFromLocation:s.ownerCid&&s.ownerCid===C.e.viewerId?_=f.e:s.ownerName&&(_=L.n(f.c,s.ownerName));var D=s.internalPath;D&&(x.internalPath=D);var P=this._identityDataSource.getIdentity(),H=s.ownerCid||P.id,j=this._getNormalizedId(s);x.id=j;var F="root"===s.id?s.rootResourceId||"root":j,q=s.resourcePartitionCid||H;x.itemId=F;void 0!==s.mruId&&(x.mruState={mruId:s.mruId,app:s.mruApp,type:s.mruType});x.graph={itemId:F,driveId:q,driveType:"personal"};x.statistics={views:s.visitorViews};x.eTag=s.eTag;x.isSharerFolder=s.isSharerFolder;x.parentKey=this._getParentKey(s,{requestKeyParams:m});var R=this._getVirtualItemType(s);x.virtualItemType=R;var U=this._isPhotosRoot(s,{requestKeyParams:m}),z=this._isPhotosSubRoot(s,{requestKeyParams:m,isPhotosRoot:U}),V=this._getIsRootFolder(s,{isPhotosSubRoot:z});x.isRootFolder=V;var $=s.name,G="";x.comments={count:s.commentCount||0,settings:{isCommentDisabled:s.commentSettings&&s.commentSettings.commentingDisabled&&!!s.commentSettings.commentingDisabled.isDisabled}};l||(x.isStub=s.isPlaceholder);var ne=s.iconType?A.e[s.iconType.toLowerCase()]:"";x.appMap=ne;var re=this._getItemType(s,ne),ie=s.extension||"";x.extension=ie;x.size=Number(s.size);var se,oe=s.sharingLevelValue;x.sharingType=oe;x.isBundle=!!s.isBundle;x.locations=s.locations;x.creatorName=s.creatorName;x.caption=s.caption||"";x.itemFromServer=s;(s.photo||s.video||s.isAlbum)&&(se=s.tags||[]);x.tags=se;x.ocr=s.ocr;x.urls=s.urls;var ue=s.userRole in te?te[s.userRole]:p.e.None;if("MountPoint"===s.groupFolderType){ue=p.e.Edit;x.mountPoint={}}x.vault=s.vault;var ae=s.vault;ae&&ae.root&&this.resources.consumeAsync(S).then(function(e){e.setVaultLockState(ae)});x.defaultSubText=this._getDefaultSubText(ue,oe,s.sharingLevel);x.location=_;x.ownerId=H;x.ownerName=s.ownerName||"";x.uploadOwnerId=q;x.specialFolderCanonicalName=s.specialFolderCanonicalName||"";x.isSpecialFolder=!!s.isSpecialFolder;var fe={};if(V){if(C.e.areCidsEqual(x.ownerId,C.e.viewerId)){$=this._getRootItemTitle(E);ue=p.e.Owner}else $=f.l;o&&(x.taskStatus={restoreAllCount:o.restoreAllWorkItemCount,deleteAllCount:o.deleteAllWorkItemCount})}if(o){x.tokenNeedsRedeeming=o.tokenNeedsRedeeming;x.tokenType=o.tokenType}ee&&P.type===Z.e.anonymous&&(x.tokenNeedsRedeeming=!0);if(s.settings){fe.allPhotosFolderId=s.settings.allPhotosFolderId;fe.allPhotosSortAscending=s.settings.allPhotosSortAscending}s.displayQuotaExceeded&&(fe.quota={display:{exceeded:s.displayQuotaExceeded,remaining:s.displayQuotaRemaining,total:s.displayQuotaTotal,used:s.displayQuotaUsed,size:s.displaySize},exceeded:s.quotaExceeded,remaining:s.quotaRemaining,status:s.quotaStatus,total:s.quotaTotal});fe.ghostId=s.ghostId;if(s.thumbnailSet){x.thumbnail=this._thumbnailProcessor.processThumbnailSet(s.thumbnailSet,s);var le=this._thumbnailProcessor.getProcessFiltersUrl(s.thumbnailSet,s);le&&(x.processFilters={thumbnailUrl:le})}var ce=s.folder;if(ce){var he=[];x.folder={childCount:ce.childCount,documentCount:ce.documentCount,folderCount:ce.folderCount,photoCount:ce.photoCount,totalCount:ce.totalCount,covers:he};var pe=ce.covers;if(pe)for(var de=0,ve=pe;de<ve.length;de++){var me=ve[de],ge=this._thumbnailProcessor.processThumbnailSet(me,s);ge&&he.push(ge)}}var ye,be=s.photo;be&&(ye={width:be.width,height:be.height,cameraMake:be.cameraMake,cameraModel:be.cameraModel,exposureNumerator:be.exposureNumerator,exposureDenominator:be.exposureDenominator,focalLength:be.focalLength,focalRatio:be.focalRatio,iso:be.iso,originalUrl:s.urls[g.e[g.e.open]],displayDateTaken:be.displayDateTaken,dateTaken:be.dateTaken,quality:X.e.optional(be.quality?{isBad:be.quality.isBad}:void 0),isLivePhoto:X.e.optional(be.isLivePhoto),isSamsungMotionPhoto:X.e.optional(be.isSamsungMotionPhoto)});x.photo=ye;(null==be?void 0:be.isLivePhoto)&&Object(B.ne)(B.h)?x.video=Object(i.e)(Object(i.e)({},(function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:r.AppleLivePhoto}})(be)),s.video):(null==be?void 0:be.isSamsungMotionPhoto)&&Object(B.ne)(B.v)?x.video=Object(i.e)(Object(i.e)({},(function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:r.SamsungMotionPhoto}})(be)),s.video):x.video=s.video;x.audio=s.audio;x.panorama=s.panorama;x.geoLocation=s.location;var we=s.textEditorMimeType;x.textEditorMimeType=we;var Ee=!!s.isAlbum;x.isAlbum=Ee;var Se,xe=s.photo||s.video,Te=Y(s.dateModifiedOnClient),Ne=Y(s.creationDate),Ce=Y(s.lastAccess),ke=Y(s.dateShared),Le=Y(s.dateDeleted),Ae=Y(s.dateExpires),Oe=xe&&Y(xe.dateTaken),Me=s.displayModifiedDate,_e=s.displayCreationDate,De=s.displayLastAccess,Pe=s.displayDateShared,He=s.displayDateDeleted,Be=s.displayExpiryDate;try{Te&&(Me=Object(I.e)(Te));Ne&&(_e=Object(I.t)(Ne));Ce&&(De=Object(I.t)(Ce));ke&&(Pe=Object(I.t)(ke));Le&&(He=Object(I.t)(Le));Ae&&(Be=Object(I.t)(Ae));Oe&&(Se=Object(I.e)(Oe,!1,!1,!0))}catch(e){}x.dateModifiedValue=s.dateModifiedOnClient;x.dateModifiedTime=x.vault&&x.vault.root?"":Te;x.dateCreatedTime=Ne;x.dateAccessedTime=Ce;x.dateSharedTime=ke;x.dateDeletedTime=Le;x.dateExpiresTime=Ae;x.dateModified=x.vault&&x.vault.root?x.vault.isLocked?" ":"Unlocked":Me;x.dateCreated=_e;x.dateAccessed=De;x.dateShared=Pe;x.dateDeleted=He;x.dateExpires=Be;if(xe){x.dateTakenTime=X.e.optional(Oe);x.dateTaken=X.e.optional(Se)}x.itemFromServer=s;x.lifeCycleStatus=X.e.optional(this._getItemLifeCycleStatus(x));var je={},Fe={};if(s.isAlbumRoot){Fe.dl=!0;Fe.sh=!0;Fe.rn=!0}if((null==be?void 0:be.isLivePhoto)&&Object(B.ne)(B.h)){Fe.aol=!0;Fe.rot=!0;Fe.vo=!0;je.acp="1"}(be||s.video)&&(je.ata="1");be&&!J(x.extension)&&(Fe.rot=!0);if(s.commands)for(var Ie=s.commands.split(","),qe=0;qe<Ie.length;qe+=2){Ie[qe]in Fe||(je[Ie[qe]]=Ie[qe+1])}else"root"===x.id&&Object(N.e)(w)&&(je.defc="1");if(s.audio){delete je.pl;je.defc="1"}var Re,Ue,ze,We=!!je.orr;x.isViolation=We;x.queryType=w;x.displayType=!ce||1!==ce.category||w===T.e.Files&&V?w:T.e.Photos;x.queryType===T.e.Recent&&V&&(je.defc="1");if(re===v.e.Folder&&!x.isStub)switch(ue){case p.e.Owner:case p.e.CoOwner:case p.e.Edit:ze=x.queryType===T.e.Files||x.queryType===T.e.SharedWithMe&&!V;break;default:ze=!1}x.sharingRole=ue;x.isDropEnabled=ze;x.iconName=O.e({type:re,extension:ie,sharingType:oe,textEditorMimeType:we});x.iconName=this._isFluidFile(s)?"fluid":x.iconName;x.documentFormat=s.docFormat||0;R===d.e.AlbumRoot&&($=y.e);D&&(G=M.e.isRightToLeft?D.slice(0).reverse().join(" < "):D.join(" > "));c||(x.isPlaceholder=!1);x.isDraggable=x.queryType===T.e.Files&&!x.mountPoint;if(ce){x.childCount=s.estimatedResultCount||ce.totalCount;x.category=ce.category;Re=[];ce.itemGroupings&&(Ue=ce.itemGroupings.map(function(e){var n=e.itemGroups,r=Object(i.s)(e,["itemGroups"]);return Object(i.e)(Object(i.e)({},r),{itemGroups:n.map(function(e){return Object(i.e)(Object(i.e)({},e),{state:t.observables.create({isCollapsed:!1})})})})}));var Xe={};if(ce.children&&!a)for(var Ve=0,$e=ce.children;Ve<$e.length;Ve++){var Je=$e[Ve],Ke=this.processItemResult({observer:h,requestKey:n,itemFromServer:Je,queryType:w,requestMetadata:o,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;Re.push(Ke);Xe[Ke.key]={newTag:this.getNewTagIfExists(Je),autoAlbumTag:this.getAutoAlbumTagIfExists(Je)}}if(R===d.e.AlbumRoot){for(var Qe={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Ge=[],Ye=0,Ze=[],et=Math.max(3,10-Re.length),tt=0,nt=Re;tt<nt.length;tt++){var rt=nt[tt],it=Xe[rt.key];if(it&&it.newTag&&it.autoAlbumTag)if(++Ye>et){Ge.push(rt);Qe.count++}else Ze.push(rt);else Ze.push(rt)}Qe.startIndex=Ze.length;Re=Ze.concat(Ge);var st={name:"newAutoAlbumsGrouping",itemGroups:[Qe]};Ue.push(st)}}else s.name&&this._isFluidFile(s)?x.openUrl=this._generateOpenUrlForFluidFile(s.name,q,F):s.urls&&(s.urls.oneNoteWeb?x.openUrl=s.urls.oneNoteWeb:x.openUrl=s.urls.viewInBrowser);var ot=ie&&ie.toLowerCase(),ut=ot&&ot.slice(1);if(".pdf"===ot||".ai"===ot&&je.dl){je.defc="1";x.openUrl=this._urlDataSource.getDownloadItemUrl({key:E,id:F,ownerId:H,extension:ie},FilesConfig.canary,!0);Object(B.ne)(B.te)&&(re=v.e.Media)}var at,ft,lt="".concat(C.e.getVroomBaseUrl({apiVersion:"v1.0",driveId:q}),"/drives/").concat(q,"/items/").concat(F);if(Object(B.ne)(B.E)&&(".zip"===ot||".rar"===ot)){je.defc="1";re=v.e.Media;x.zip=X.e.optional((at=ut,(ft=lt)?{downloadZipContentsUrl:Q("zipcontent",at,ft),zipMetaDataUrl:Q("zipmetadata",at,ft)}:void 0))}var ct=(function(e,t){var n=K.e(e),r=K.t(e);if(n||r)return{canConvert:n,canRenderNative:r,conversionUrl:n&&t?"".concat(Q("glb",e,t),"&{.authParams}"):void 0}})(ut,lt);if(ct){re=v.e.Media;x.model3d=ct;je.defc="1"}x.type=re;x.thumbnail&&"4"===je.defc&&(je.defc="1");!l&&s.isPlaceholder&&(je.defc="1");if("allmyphotos"===m.qt&&x.id===m.id){je.defc="1";$=""}var ht=ce?ce.childCount:0;x.name=$;x.displayName=G||"".concat($).concat(ie);s.estimatedResultCount&&(ht=Re.length+(s.folder&&s.folder.startIndex||0));if(s.isRecycled&&s.folder&&!ht){ht=Re.length;x.childCount=ht}fe.newTag=this.getNewTagIfExists({tags:se});fe.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:Ee,tags:se});var pt=[E];u&&n&&pt.push(n);e.keyAlias&&pt.push(e.keyAlias);var dt=!0;"allmyphotos"===m.qt&&x.id===m.id&&(dt=!1);fe.commandsSupported=X.e.replace(je);x.properties=fe;for(var vt=0,mt=Object(W.e)(pt);vt<mt.length;vt++){var gt=mt[vt];h.update([new X.t(gt).succeed({item:dt?x:{key:E}})])}var yt=s.hasMoreResults?""+s.estimatedResultCount:"";"search"===m.qt&&s.folder&&s.folder.pagingToken&&(yt=s.folder.pagingToken);s.isRecycled&&s.folder&&s.folder.hasMoreRecycledItems&&(yt=s.folder.pagingToken);return{item:{key:E},children:Re,groupings:Ue,totalChildren:ht,nextRequestToken:yt}}};t.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var n=e.tags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if("__Auto"===s.tag){t=s;break}}return t};t.prototype.getNewTagIfExists=function(e){var t=e.tags,n=null;if(t)for(var r=0,i=t;r<i.length;r++){var s=i[r];if("__New"===s.tag){n=s;break}}return n};t.prototype.getItemKey=function(e){var t,n,r,s,o,u=e.itemFromServer,a=e.requestKey,f=this._urlDataSource.getKeyParams(a);if(u.isAlbumRoot)o=this._urlDataSource.getKey(((t={}).id="albums",t.tagFilter=f.tagFilter,t));else if(u.isTagsRoot)o=this._urlDataSource.getKey(((n={}).id="tags",n));else{var l=this._getItemKeyExtension(u,a),c=u.ownerCid,h=u.internalPath,p=void 0===h?[]:h,d=this._getNormalizedId(u),v=this._urlDataSource.isCurrentQuery(T.e.SharedWithMe,f);if(v&&"1209427492"===u.ownerDCid&&"0000000048166624"===u.ownerCid){d="1209427492";c="0000000048166624"}o=this._urlDataSource.getKey(Object(i.e)(Object(i.e)(Object(i.e)({},l),((r={}).id=d,r.cid=c,r.internalPath=p.join(","),r)),Object(B.ne)(B.t)&&v&&u.groupId?((s={}).u="group_".concat(u.groupId),s):{}))}return o};t.prototype._generateOpenUrlForFluidFile=function(e,t,n){var r=Object(B.ne)(B.$)?"https://dev.fluidpreview.office.net/p":"https://fluidpreview.office.net/p",i=encodeURIComponent(btoa("spo:https://api.onedrive.com")),s=encodeURIComponent(e),o=encodeURIComponent(t),u=encodeURIComponent(n);return"".concat(r,"/").concat(i,"/").concat(o,"/").concat(u,"/").concat(s)};t.prototype._getDefaultSubText=function(e,t,n){var r;switch(e){case p.e.Owner:r=t===m.e.Private?"":x.l;break;case p.e.View:r=x.t;break;case p.e.Edit:case p.e.CoOwner:r=x.e;break;default:r=""}return r};t.prototype._getItemType=function(e,t){return e.isPlaceholder?v.e.Folder:17===e.itemType?v.e.OneNote:e.folder?v.e.Folder:e.video||e.photo||e.audio?v.e.Media:t||this._isTextEditorFile(e)||this._isFluidFile(e)?v.e.File:e.thumbnailSet?v.e.Media:v.e.File};t.prototype._isFluidFile=function(e){return!!e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase())};t.prototype._isTextEditorFile=function(e){return Object(V.e)(e.extension||"")};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._getRootItemTitle=function(e){return a.e};t.prototype._getNormalizedId=function(e){return e.id&&e.id.indexOf("!")>=0?e.id.toUpperCase():e.id};t.prototype._getParentKey=function(e,t){var n,r,i=t.requestKeyParams;e.isRecycled&&"root"!==e.id?r=this._urlDataSource.getRootItemKey(T.e.RecycleBin):e.isSharerFolder?r=this._urlDataSource.getRootItemKey(T.e.SharedWithMe):e.isAlbumRoot?r=void 0:e.parentId&&(r=this._urlDataSource.getKey(((n={}).id=e.parentId,n.cid=e.ownerCid,n.ft=i.ft,n.ext=i.ext,n)));return r};t.prototype._getVirtualItemType=function(e){var t;e.isAlbumRoot?t=d.e.AlbumRoot:e.isAlbum?t=d.e.Album:e.isTagsRoot&&(t=d.e.TagsRoot);return t};t.prototype._getIsRootFolder=function(e,t){var n=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!n};t.prototype._isPhotosRoot=function(e,t){var n=t.requestKeyParams;return"allmyphotos"===n.qt&&e.id===n.id};t.prototype._isPhotosSubRoot=function(e,t){var n=t.requestKeyParams;return t.isPhotosRoot&&(!!n.tagFilter||!!n.locationFilter)};t.prototype._getItemLifeCycleStatus=function(e){var t={};this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0);return t};t.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5};return t})(s.t);var re=n(15),ie=n(339),se=n(136),oe=n(89),ue=n(370),ae=n(171),fe=n(175);function le(e,t,n){void 0===n&&(n={});var r;if(n){var s=(function(e,t){var n,r=t.consume(fe.e).isMobile&&!!t.consume(ae.r.optional),s=Object(i.e)(Object(i.e)({},he("type","","FileTypeIcon",!1)),{minWidth:r?48:16,width:r?48:16,isIcon:!0,fieldType:oe.e.FileIcon}),o=de(!0),u=ge(!0),a=ve(),l=pe(!0),c=Object(i.e)(Object(i.e)({},he("_shareHeroCommand","","_shareHeroCommand",!1)),{isIcon:!0,minWidth:16,width:16,fieldType:oe.e.ShareCommand}),h=de(!1),p=ge(!1),d=pe(!1),v=Object(i.e)(Object(i.e)({},he("dateTaken",ue.e,"dateTaken",!0)),{fieldType:oe.e.DateTime}),m=r?ce(s,[[o],[u,l,a]],Object(i.o)(Object(i.o)(Object(i.o)(Object(i.o)([],"userArranged"===e?[me()]:[],!0),[o,u],!1),"dateTaken"===e?[v]:[],!0),[l,a],!1)):Object(i.o)(Object(i.o)(Object(i.o)(Object(i.o)(Object(i.o)(Object(i.o)([],"userArranged"===e?[me()]:[],!0),[s,o],!1),[c],!1),[u],!1),"dateTaken"===e?[v]:[],!0),[a,l],!1),g=r?ce(s,[[o],[u,l,a]],[o,u,v,l,a]):Object(i.o)(Object(i.o)(Object(i.o)(Object(i.o)([],"userArranged"===e?[me()]:[],!0),[s,o],!1),[c],!1),[u,v,a,l],!1),y=Object(i.e)(Object(i.e)({},he("dateAccessed",f.n,"dateAccessed",!0)),{fieldType:oe.e.DateTime}),b=Object(i.e)(Object(i.e)({},he("location",f.r,"",!1)),{showTooltip:!0}),w=r?ce(s,[[o],[y,l,a]],[o,y,l,a]):[s,o,y,u,b,l],E=ve(),S=[s,o,E,l],x=[s,o,E,l],N=r?ce(s,[[h],[p,d,a]],[h,p,d,a]):[s,h,a,p,b,d],C=Object(i.e)(Object(i.e)({},he("location",f.o,"location",!0)),{width:300,showTooltip:!0}),k=Object(i.e)(Object(i.e)({},he("dateDeleted",f.t,"dateDeleted",!0)),{fieldType:oe.e.DateTime}),L=r?ce(s,[[o],[l,k,C]],[o,k,l,C]):[s,o,C,k,l];return(n={})[T.e.Files]=m,n[T.e.Photos]=g,n[T.e.Recent]=w,n[T.e.SharedWithMe]=S,n[T.e.DocsInCommon]=x,n[T.e.Search]=N,n[T.e.RecycleBin]=L,n})(n.defaultSortField,t);e.type===v.e.Folder&&(r=s[e.displayType]||s[T.e.Files]);r&&(r=r.map(function(e){return Object(i.e)(Object(i.e)({},e),n.isSortEnabled?(e.internalName||e.key)===n.sortField?{isSorted:!0,isAscending:n.isAscending}:{isSorted:!1}:{sortable:!1})}))}return r}function ce(e,t,n){for(var r=[],s=0;s<t.length;s++)for(var o=0,u=t[s];o<u.length;o++){var a=u[o];r.push(Object(i.e)(Object(i.e)({},a),{customRowNumber:s}))}for(var f=[e,Object(i.e)(Object(i.e)({},he("","","",!1)),{width:900,customFields:r})],l=0,c=n;l<c.length;l++){var h=c[l];f.push(Object(i.e)(Object(i.e)({},h),{isVisible:!1,isVisibleMobile:!1}))}return f}function he(e,t,n,r,i){return{key:e,name:t,internalName:n,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:r,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:oe.e.Text,filterable:!1,isFocused:re.observable(!1)}}function pe(e){return Object(i.e)(Object(i.e)({},he("size",f.a,"size",e)),{isHtml:!0,fieldType:oe.e.FileSize,sortable:e})}function de(e){return Object(i.e)(Object(i.e)({},he("displayName",f.s,"displayName",e)),{isCollapsable:!1,minWidth:220,width:440,fieldType:oe.e.Name,sortable:e,hasListItemMenu:!0})}function ve(){return Object(i.e)(Object(i.e)({},he("defaultSubText",f.u,"",!1)),{fieldType:oe.e.Shared})}function me(){return Object(i.e)(Object(i.e)({},he("",f.f,"userArranged",!0)),{isVisible:!1,isVisibleMobile:!1})}function ge(e){var t=f.i;return Object(i.e)(Object(i.e)(Object(i.e)({},he("dateModified",t,"dateModified",e)),{sortable:e,sortDescFirst:e,fieldType:oe.e.DateTime}),"ml"==="".concat(M.e.language).toLowerCase()?{width:150}:{})}var ye,be=n(103);(function(e){e[e.defaultValue=0]="defaultValue";e[e.ascending=1]="ascending";e[e.descending=2]="descending"})(ye||(ye={}));var we,Ee,Se,xe=ye,Te=n(157),Ne=n(39),Ce=(function(e){Object(i.r)(t,e);function t(t){return e.call(this,t)||this}t.prototype.processError=function(e){var t,n=e.requestKey,r=e.error,i=e.itemName,s=e.observer;switch(r&&r.data&&r.data.code||0){case 101:case 102:case 103:case 152:t=Ne.e.authenticationExpired;break;case 161:t=Ne.e.mfaRequired;break;case 162:t=Ne.e.insufficientVaultQuota;break;case 200:t=Ne.e.userSuspended;break;case 201:t=Ne.e.userNotReady;break;case 202:t=Ne.e.marketBlocked;break;case 3e3:case 10009:t=Ne.e.accessDenied;break;case 3403:t=Ne.e.passwordRequired;break;case 3404:t=Ne.e.requestAccess;break;case 9017:break;default:t=Ne.e.requestFailed}var o=this.getError(r,i);s.update([new X.t(n).succeed({item:{key:n,type:v.e.Error,error:{type:t,data:o},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]);return{error:o,key:n}};t.prototype.getError=function(e,t){var n,r,i,s=e&&e.data&&e.data.code||0;switch(s){case 209:n=x.d;r=x.p;break;case 509:n=x.h;break;case 1e3:n=x.i;break;case 1006:n=x.s;break;case 2005:case 2006:n=x.f;break;case 3e3:n=x.a;r=x.u;break;case 9001:n=Object(L.n)(x.o,t);break;case 9006:n=x.c;break;default:n=x.r;r=x.n}if(161===s){i=e&&e.data&&e.data.exceptionData&&e.data.exceptionData.fixItUrl||null;this.resources.consumeAsync(F.p).then(function(e){return e.setVaultLockState({root:void 0,isLocked:!0},void 0,!0)})}return{errorCode:s,errorTitle:n,errorDetailedText:r,actionUrl:i}};return t})(s.t);(function(e){e[e.spam=0]="spam";e[e.nudityOrPornography=1]="nudityOrPornography";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation";e[e.other=4]="other";e[e.copyrightInfringement=5]="copyrightInfringement"})(Ee||(Ee={}));(function(e){e[e.malwareOrViruses=0]="malwareOrViruses";e[e.sexuallyInappropriate=1]="sexuallyInappropriate";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childSexualExploitation=3]="childSexualExploitation";e[e.other=4]="other";e[e.terroristContent=5]="terroristContent";e[e.fraudOrSpam=6]="fraudOrSpam";e[e.hateSpeech=7]="hateSpeech";e[e.imminentHarm=8]="imminentHarm";e[e.copyrightInfringement=9]="copyrightInfringement"})(Se||(Se={}));var ke;(function(e){e[e.File=0]="File";e[e.PhotoStreamComment=1]="PhotoStreamComment";e[e.PhotoStreamFile=2]="PhotoStreamFile"})(ke||(ke={}));(we={})[ke.PhotoStreamComment]="Comment",we[ke.PhotoStreamFile]="PhotoStreamFile";var Le=n(192),Ae=(function(){function e(){this._urlDataSource=this.resources.consume(F.c)}e.prototype.getDefaultGetItemContext=function(e){var t=this._urlDataSource.getCurrentItemKey(e),n=this._urlDataSource.getKeyParams(t),r=this._urlDataSource.getOwnerId(t,e),i=this._urlDataSource.getQueryType(n);return{groupingType:this._getGroupingType(r),isAscending:void 0,pageSize:this._getPageSize(i),ownerId:r,parentKey:t,queryType:i,resultSetOptions:void 0,revision:0,sortField:void 0,startIndex:0,startKey:void 0}};e.prototype._getPageSize=function(e){switch(e){case T.e.Search:return 50;default:return 100}};e.prototype._getGroupingType=function(e){var t=this._getLocalStorageValue("".concat("ItemsStoreonedrive.web.files.filesquerytype",".").concat(e.toLowerCase())),n=JSON.parse(t||"{}");return t&&n[T.e[T.e.Files]]!==Le.e?0:1};e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}};return e})(),Oe=n(152),Me=n(56),_e=n(26),De=n(102),Pe=(function(){function e(){this._urlDataSource=this.resources.consume(j.t);this._navigation=this.resources.consume(Me.e)}e.prototype.getFetchUrl=function(e,t,n){var r="".concat(e.sortField?Te.e[e.sortField]:Te.e.defaultValue),i=null===e.isAscending||void 0===e.isAscending?xe.defaultValue.toString():e.isAscending?xe.ascending.toString():xe.descending.toString(),s=this._urlDataSource.getKeyParams(e.parentKey),o=this._urlDataSource.getQueryType(s);Object(N.e)(o)&&(e.groupingType=0);var u=1===e.groupingType?"0,1,2":"0",a={caller:C.e.viewerId,sb:n?"":r,ps:e.pageSize,sd:i,gb:u,d:"1",m:_e.e.mkt,iabch:"1",pi:"5",path:1,lct:1,rset:C.e.scenarioName,v:t};(n||Object(B.ne)(B.Z)&&o===T.e.Search)&&(a.pagingToken=e.requestToken||"");De.get("BadgerAuth")||(a.urlType=0);e.startKey?a.sid=this._urlDataSource.getKeyParams(e.startKey).id:void 0!==e.startIndex&&(a.si=e.startIndex);var f=this._urlDataSource.getAuthKeyParamValue(),l=this._urlDataSource.getTicketParamValue(),c=this._urlDataSource.getReferrer();f&&(a.authKey=f);l&&(a.ticket=l);Object(N.e)(o)&&c&&(a.searchreferrer=c);if(e.filters){e.filters.tagFilter&&(a.tagFilter=e.filters.tagFilter);e.filters.locationFilter&&(a.tagFilter=e.filters.locationFilter)}var h=e.parentKey||"",p=this._urlDataSource.getKeyParams(h);delete p.u;o===T.e.Recent&&delete p.ext;Object(N.e)(o)&&!p.sp&&(a.includeSharedItems=1);if(p.sp){a.searchpassthru="sortby=largestsize";delete p.sp}n&&o===T.e.RecycleBin&&(p.qt="recyclebinv2");5!==this._urlDataSource.getAppliedDateFilter()&&delete p.endDate;return C.e.skyApiBaseUrl+"GetItems?"+_.t(p,a)};e.prototype.triggerGetItemsIfApplicable=function(e,t){var n=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams),r=this._urlDataSource.getKeyParams(n);if(this._urlDataSource.getQueryType(r)===T.e.Files&&!this._navigation.viewParams.v){var i=new c.e,s=new(this.resources.injected(Ae)),o={};o["X-SkyApiOriginId"]=t;var u=s.getDefaultGetItemContext(this._navigation.viewParams);u.skipCache=!0;var a=this.getRequestVersion(u),f=this.getFetchUrl(u,a,!1);Oe.e.mark("Prefetch.GetItems.Started");e[f]=i.send({apiName:"GetItems",url:f,headers:o,isErrorExpectedCallback:U}).then(function(e){Oe.e.mark("Prefetch.GetItems.Done");return e});this.persistResultVersion(u,a)}};e.prototype.getRequestVersion=function(e){var t=He(e.ownerId),n=t?JSON.parse(this._getLocalStorageValue(t)||"{}"):{},r=String(Math.random()),i=this._urlDataSource.getKeyParams(e.parentKey),s=this._urlDataSource.getQueryType(i);return e.skipCache||s===T.e.RecycleBin?r:n[e.parentKey&&e.parentKey.toLowerCase()]||r};e.prototype.persistResultVersion=function(e,t){if(e.ownerId){var n=He(e.ownerId),r=JSON.parse(this._getLocalStorageValue(n)||"{}");r[e.parentKey.toLowerCase()]=t;this._persistResultVersion(n,JSON.stringify(r))}};e.prototype.removeBrowserCacheResultVersion=function(e,t){if(e){var n=He(e),r=JSON.parse(this._getLocalStorageValue(n)||"{}");delete r[t.toLowerCase()];this._persistResultVersion(n,JSON.stringify(r))}};e.prototype._persistResultVersion=function(e,t){try{window.localStorage[e]=t}catch(e){}};e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}};return e})();function He(e){return e&&"OneDrive.GetItemsVersionLookup.".concat(e.toLowerCase())}var Be={},je=String(Math.random()),Fe=new w.t("MoveCopyCapabilities");(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){return this.resources.consume(Fe)};t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())};t.prototype.hasMatchingId=function(e,t){return e===t.id};t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var n=new c.e,r=Ie(e);return n.send({apiName:"CopyItemsAsync",url:t,requestType:"POST",postData:JSON.stringify(r),isErrorExpectedCallback:function(e){switch(e.errorCode){case 2001:return!0;default:return!1}}})};t.prototype._getCopyItemsAsyncUrl=function(){return C.e.skyApiBaseUrl+"CopyItemsAsync"}})(s.t);function Ie(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}var qe=n(283),Re=n(208),Ue=new w.t({name:"".concat("AlbumsInvalidator.key",".albumsInvalidator"),loader:new E.t(function(){return n.ee([6],718).then(function(e){return e.resourceKey})})}),ze=n(300),We=n(47),Xe=n(278),Ve=n(138),$e=n(53),Je=n(20),Ke=n(7),Qe=0,Ge=(function(e){Object(i.r)(t,e);function t(){var t=e.call(this)||this;t._itemDataSourceHelper=new(t.managed(Pe));t.isLargeRecycleBin=re.observable(!1);t._pendingGetItemRequests={};t._itemsStore=t.resources.consume(be.e);t._urlDataSource=t.resources.consume(j.t);t._identity=t.resources.consume(F.i);t._itemResultProcessor=new(t.managed(ne))({getRootItemTitle:t.getRootItemTitle.bind(t),getItemKeyExtension:t._getItemKeyExtension.bind(t)});t._itemErrorProcessor=new(t.managed(Ce));t._rotationSemaphore=new qe.e;return t}t.getServerDocumentType=function(e){var t;switch(e){case se.e.Word:t="w";break;case se.e.Excel:t="x";break;case se.e.PowerPoint:t="p";break;case se.e.OneNote:t="n";break;case se.e.ExcelSurvey:t="f"}return t};t.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),n=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(n,t,e)};t.prototype.getSpecifiedItems=function(e){return null};t.prototype.getColumns=function(e,t){void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer));return le(e,this.resources,t)};t.prototype.deleteItems=function(e){var t=this,r=this._urlDataSource.getKeyParams(e.parentKey);if(Object($e.e)(We.s)&&Object(B.ne)(B.X)&&("allmyphotos"===r.qt||["places".toString(),"tags".toString()].indexOf(r.id)>=0)){var i=this.resources.consume(Xe.e);return new o.t(function(t,r){n.ee([36],730).then(function(t){var n=t.deleteItems;return i.dispatch(n({items:Object(Ve.e)(e.items,function(e){return{currentItemSetKey:e.graph.itemId}},function(e){return ze.e.serialize({endpoint:Object(We.e)("v2.0"),driveId:e.graph.driveId,itemId:e.graph.itemId})})}))}).then(function(){t(e.items.map(function(e){return e.graph.itemId}))}).catch(function(e){r(e)})})}var s=e.items;s&&s[0].key&&!s[0].id&&(s=s.map(function(e){return t._itemsStore.getItem(e.key).peek()}));return h.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:s,getPostData:function(t){return{deletionType:e.deletionType?e.deletionType:ie.e.Recycle,targetId:r.id,cid:C.e.viewerId,group:0,overrideLock:!!e.overrideLock,items:t.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,n=e;t<n.length;t++){n[t].eTag=""}}})};t.prototype.renameItem=function(e){var t=this,r=this._urlDataSource.getKeyParams(e.parentKey),i=e.item.name,s=e.newName+e.item.extension,u=e.item.extension;if(e.nameHasExtension){var a=e.newName.lastIndexOf(".");if(a>0){u=e.newName.substr(a+1);Array.isArray(_e.t.createTextDocumentExts)&&_e.t.createTextDocumentExts.indexOf(u)>=0&&(s=e.newName)}}if(Object($e.e)(We.s)&&Object(B.ne)(B.X)&&("allmyphotos"===r.qt||["places".toString(),"tags".toString()].indexOf(r.id)>=0)){var f=this.resources.consume(Xe.e),l=ze.e.serialize({endpoint:Object(We.e)("v2.0"),driveId:e.item.graph.driveId,itemId:e.item.graph.itemId});return new o.t(function(t,r){return n.ee([37],731).then(function(t){var n,r,i=t.renameItem;return f.dispatch(i({items:(n={},n[l]={names:(r={},r[e.item.name]={newName:e.newName,newExtension:u},r)},n)}))}).then(function(){t(e.newName)}).catch(function(e){r(e)})})}var h=this._getUpdateItemsUrl(),p=new c.e,d=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:s,lid:r.id,rset:C.e.scenarioName,ownerId:e.ownerId});return p.send({apiName:"UpdateItem",url:h,requestType:"POST",postData:d,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){if(t.resources.consume(Re.e)){var r=e.item.id;e.item.isAlbum&&void 0!==r&&t.resources.consumeAsync(Ue).then(function(e){e.invalidateAlbumName(r)})}return n},function(e){return o.t.wrapError(t._itemErrorProcessor.getError(e,i).errorTitle)})};t.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new c.e).send({apiName:"GetOpenInClientDetails",url:t})};t.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),n=new c.e,r=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:C.e.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.reportAbuse=function(e){var t=this,n=this._getReportAbuseUrl(),r=new c.e,i=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:C.e.viewerId,group:0,desc:e.desc,ref:window.location.href,photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||ke.File});return r.send({apiName:"ReportAbuse",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.t.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.requestReview=function(e){var t=this,n=this._getRequestReviewUrl(),r=window.$Config,i=new c.e,s=JSON.stringify({email:r.email,ids:e.items.map(function(e){return e.id}),photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||ke.File});return i.send({apiName:"OwnerRequestReview",url:n,requestType:"POST",postData:s,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.t.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.updateBundle=function(e){var t=this,n=this._getUpdateBundleUrl(),r=new c.e,i=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return r.send({apiName:"UpdateBundle",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.t.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),n=new c.e,r=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return n.sendPost("AbdicatePermissions",t,r)};t.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),n=new c.e,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:C.e.viewerId,group:e.target.isGroup?1:0});return n.sendPost("AddFavorites",t,i)};t.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),n=new c.e,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:C.e.viewerId,group:e.target.isGroup?1:0});return n.sendPost("RemoveFavorites",t,i)};t.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),n=new c.e,r=JSON.stringify({id:e.item.id,category:e.category,cid:C.e.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.updateItemProperty=function(e){var t,n,r=this._getUpdateItemsUrl(),i=new c.e;Object(B.ne)(B.J)&&(n=_.e(e.item.parentKey));var s={id:e.item.id,lid:(null===(t=e.item.UNSAFE_parent)||void 0===t?void 0:t.id)||(null==n?void 0:n.id),overrideLock:(!!e.overrideLock).toString(),rset:C.e.scenarioName};s[e.propertyName]=e.propertyValue||"";var o=e.qosPostfix?"UpdateItem_"+e.qosPostfix:"UpdateItem";return i.sendPost(o,r,JSON.stringify(s))};t.prototype.createFolder=function(e){var t=this,n=this._getCreateFolderUrl(),r=this._urlDataSource.getKeyParams(e.parent.key),i=new c.e,s=[];if(e.selectedPeople&&e.selectedPeople.length>0)for(var u=0,a=e.selectedPeople;u<a.length;u++){var f=a[u];s.push({role:2,type:0,email:f.email})}var l={ownerCid:this._identity.getIdentity().id,message:e.sharingNote,requireSignIn:!0,entities:s},h=JSON.stringify({parentId:r.id,cid:r.cid,group:0,name:e.folderName,permissionsInfo:e.selectedPeople&&e.selectedPeople.length>0?l:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return i.send({apiName:"AddFolder",url:n,requestType:"POST",postData:h,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){n=n.items||n.item;var r=new(t.resources.consume(X.n)),i=t._getItemResult({requestKey:e.parent.key,itemFromServer:n,queryType:T.e.Files,keyAlias:e.keyAlias,isPrimaryRequestedItem:!0,observer:r});r.flush();return i?r.getItem({key:i.item.key}):null},function(e){return o.t.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createDocument=function(e,n,r){var i=this;if(n===se.e.Text)return o.t.wrap(this._createTextDocument(e));var s=this._getCreateDocumentUrl(),u=t.getServerDocumentType(n),a=new c.e,f=this._urlDataSource.getKeyParams(e),l=JSON.stringify({parentId:f.id,nameConflict:r?0:2,overrideLock:!1,cid:f.cid,group:0,name:r,docType:u});return a.send({apiName:"CreateDocument",url:s,requestType:"POST",postData:l,isErrorExpectedCallback:this._isErrorExpected}).then(function(t){var r="";if((t=t.items||t.item)&&t.length>0){var s=new(i.resources.consume(X.n)),o=i._getItemResult({requestKey:e,itemFromServer:t[0],queryType:T.e.Files,isPrimaryRequestedItem:!0,observer:s});s.flush();r=(r=s.getItem({key:o.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view","");n===se.e.OneNote&&(r+="&nd=1")}return r},function(e){return o.t.wrapError(i._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createCustomDocument=function(e,t,n){return null};t.prototype.createShortcut=function(e,t,n){return null};t.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(j.t).getCreateTextDocumentUrl(t.id,t.cid)};t.prototype.createDocumentInTab=function(e,n,r){var i,s=t.getServerDocumentType(e);if(e===se.e.Text)i=this._createTextDocument(n.key);else{i=this.resources.consume(j.t).getCreateDocumentInTabUrl(n,s,r)}return i};t.prototype.getFilterData=function(e,t,n){return null};t.prototype.restoreItems=function(e){var t=this._urlDataSource.getKeyParams(e.parentKey);return h.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:e.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(n){var r={targetId:t.id,cid:C.e.viewerId,group:0,items:n.map(function(e){return e.id}),recycleBinItems:n.map(function(e){return{deletedFromLocation:e.location===f.e?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:e.retainAcls||!1};e.nameConflict&&(r.nameConflict=e.nameConflict);return r}})};t.prototype.restoreAll=function(e){var t=this._getRestoreAllUrl(),n=new c.e;return new o.t(function(e,r){n.sendPost("RestoreAll",t,"").then(function(){e(!0)},r)})};t.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())};t.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())};t.prototype.removeFromRecent=function(e){for(var t,n=this._getRemoveFromRecentUrl(),r=new c.e,i=[],s=0;s<e.items.length;s++)i.push(e.items[s].id);t=JSON.stringify({items:i});return r.sendPost("RemoveFromMRU",n,t)};t.prototype.removeMountPoint=function(e){var t,n=this._getRemoveMountPointUrl(),r=new c.e;t=JSON.stringify({id:e.item.properties.ghostId||e.item.id});return r.sendPost("RemoveMountPoint",n,t)};t.prototype.createMountPoint=function(e){var t,n=this,r=this._getCreateMountPointUrl(),i=new c.e,s=this._urlDataSource.getAuthKeyParamValue();t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:s});return i.sendPost("MountFolder",r,t).then(function(e){var t=new(n.resources.consume(X.n)),r=e?n._getItemResult({requestKey:"",itemFromServer:e.item,queryType:T.e.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;t.flush();return r?t.getItem({key:r.key}):null},function(e){return o.t.wrapError(e)})};t.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),n=new c.e;return(e.workItemIds?n.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):n.send({apiName:"GetWorkProgress",url:t})).then(function(e){return Object(i.e)(Object(i.e)({},e),{progress:e.progress.map(function(e){var t,n,r;if("Completed"===e.status){var s=e.targetResourceId;if(s){var o=Object(Je.t)(((t={}).id=s,t));r={key:Object(Ke.v)(((n={}).cid=o,n.id=s,n))}}}return Object(i.e)(Object(i.e)({},e),{createdItem:r})})})})};t.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();(new c.e).sendPost("CancelWork",t,JSON.stringify(e));return o.t.wrap(!0)};t.prototype.getItemOcrTextContent=function(e){var t=new c.e,n=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",C.e.skyApiBaseUrl+"GetDownloadUrl",n).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return u.e.start({url:t,json:null}).then(function(e){var t=window.DOMParser,n=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return n&&n.textContent})})};t.prototype.updateItemOcrInfo=function(e,t,n){var r,i=this._getUpdateItemsUrl(),s=new c.e,o=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:n,lid:null===(r=e.UNSAFE_parent)||void 0===r?void 0:r.id,rset:C.e.scenarioName});return s.sendPost("UpdateItem",i,o)};t.prototype.processReferral=function(e,t){var n=this._getProcessReferralUrl(),r=new c.e,i={inviterId:e};t&&""!==t&&(i.inviteSrc=t);return r.sendPost("ProcessReferral",n,JSON.stringify(i))};t.prototype.rotateItems=function(e){for(var t=this,n=new(this.resources.consume(X.n)),r=this._getRotateItemUrl(),s=[],u=function(u){var f=a.peekUnwrapObservable(a._itemsStore.getItem(u.key)),l=++Qe;if(f.thumbnail){var h=f.orientedThumbnail;h=h?Object(i.e)(Object(i.e)({},h),{rotation:h.rotation+e.rotation,version:l}):{rotation:e.rotation,thumbnail:Object(i.e)({},f.thumbnail),version:l};n.update([new X.t(u.key).succeed({item:{key:u.key,orientedThumbnail:X.e.replace(h)}})])}var p=new c.e,d=JSON.stringify({targetId:u.id,numberOfClockwiseRotations:-e.rotation,cid:C.e.viewerId,rset:C.e.scenarioName});s.push(a._rotationSemaphore.enqueue(function(){return p.sendPost("ChangeImageOrientation",r,d).then(function(e){var r=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)),i=r.itemFromServer&&r.itemFromServer.commands;e.item.commands=i||e.item.commands;t._itemResultProcessor.processItemResult({observer:n,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:u.key});var s=r.orientedThumbnail;s&&s.version===l&&n.update([new X.t(u.key).succeed({item:{key:u.key,orientedThumbnail:X.e.remove()}})]);return r},function(r){var i=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)).orientedThumbnail;if(i){i=i.version===l?X.e.remove():{rotation:i.rotation-e.rotation};n.update([new X.t(u.key).succeed({item:{key:u.key,orientedThumbnail:i}})])}var s=new Error(r.data.message);s.data={key:u.key,error:r.data};return o.t.wrapError(s)})}))},a=this,f=0,l=e.items;f<l.length;f++){u(l[f])}n.flush();return o.t.all(s).then(function(e){n.flush();if(t.resources.consume(Re.e))for(var r=function(e){var n=_.e(e.key);t.resources.consumeAsync(F.o).then(function(e){e.invalidateItems(_.t(n))})},i=0,s=e;i<s.length;i++){r(s[i])}return e.map(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(e.key));n&&n.UNSAFE_parent&&t._itemDataSourceHelper.removeBrowserCacheResultVersion(n.ownerId,n.UNSAFE_parent.key);return n})},function(e){n.flush();var t=new Error;t.data=Object.keys(e).map(function(t){return e[t].data});return o.t.wrapError(t)})};t.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),n=this._getRedeemPermissionTokenUrl(),r=new c.e,i={id:e.item.id,authKey:t};return r.sendPost("RedeemPermissionToken",n,JSON.stringify(i))};t.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==C.e.viewerId});return 0===t.length?o.t.wrap(null):h.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:C.e.viewerId,ids:e.map(function(e){return e.id})}}})};t.prototype.getRootItemTitle=function(e){return a.e};t.prototype._getRootFileId=function(){return"root"};t.prototype._getParentItemId=function(){return""};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._handleMoveCopyApiRequest=function(e,t,n){for(var r,s=new c.e,u=t.items.map(function(e){return e.id}),a=Ie(t),f=[],l=new qe.e,h=function(){var o=u.splice(0,100);a.items=o;var c=JSON.stringify(a);!1!==t.ackMoveIfShared&&(r={prefer:"Block-Move-Into-Vault-If-Shared"});var h=l.enqueue(function(){return s.send({apiName:e,url:n,requestType:"POST",headers:r,postData:c,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:return!0;case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[Object(i.e)(Object(i.e)({},e),{error:e.data})]}})});f.push(h)};u.length;)h();return o.t.all(f).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})};t.prototype._getItem=function(e,t,n){var r,s=this,u=String(Math.random()),a=((r={})["X-SkyApiOriginId"]=u,r),f=this._pendingGetItemRequests[e];if(!f){var l=Be[e];if(l){u=je;delete Be[e]}var h=void 0;h=!k.e.isActivated("4AE305A7-991F-4556-87DE-C1DDF1D5F01A","10/21/2021","Override invalid SkyAPI root item request")&&this._isInvalidRootItemRequest(e)?this._getMockItemNotFoundResponse(e):!n.skipCache&&l||(new c.e).send({apiName:"GetItems",qosName:n.qosName,url:e,headers:a,isErrorExpectedCallback:U});var p=!1;f=h.then(function(r){p=!0;Oe.e.mark("ItemsDataSource.GetItems.Normalizing");var o,a=r.originId,f=r.items||r.item&&[r.item]||[];if(f&&f.length>0){for(var l=new(s.resources.consume(X.n)),c=void 0,h=f.length-1;h>=0;h--){var d=0===h;if(!f[0].isBundle||d){var m=h>0,g=s._getItemResult({observer:l,requestKey:n.parentKey,itemFromServer:f[h],queryType:n.queryType,requestMetadata:{tokenNeedsRedeeming:r.tokenNeedsRedeeming,tokenType:r.tokenType,restoreAllWorkItemCount:r.restoreAllWorkItemCount||0,deleteAllWorkItemCount:r.deleteAllWorkItemCount||0},setItemKey:!m,skipSettingChildren:m,isPrimaryRequestedItem:d});d&&(c=g)}}l.flush();if(c&&c.item){var y=l.getItem({key:c.item.key}),b=f[0],w=s._getDefaultSortInformation(b);if(n.sortField){var E=w&&w.defaultSortField;w={sortField:n.sortField,defaultSortField:E,isAscending:n.isAscending,isSortEnabled:!s.isLargeRecycleBin.peek()}}var S=void 0;w&&(S=w.isAscending);var x=a!==u;x||y.type!==v.e.Folder||s._itemDataSourceHelper.persistResultVersion(n,t);var T=le(y,s.resources,w),N=void 0;if(T&&w)for(var C=0,k=T;C<k.length;C++){var L=k[C];if(L.internalName===w.sortField){N=L.key;break}}o=Object(i.e)(Object(i.e)({},c),{schema:T,startIndex:b.folder?b.folder.startIndex:n.startIndex,isFromBrowserCache:x,sortField:N,isAscending:S})}}delete s._pendingGetItemRequests[e];return o},function(t){delete s._pendingGetItemRequests[e];var r=new(s.resources.consume(X.n)),i=s._itemErrorProcessor.processError({requestKey:n.parentKey,error:t,observer:r}).error;r.flush();return o.t.wrapError(i)});p||(this._pendingGetItemRequests[e]=f)}return f};t.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}};t.prototype._getDefaultSortInformation=function(e){var t;e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(Te.e).length/2>e.folder.defaultSort&&(t={sortField:Te.e[e.folder.defaultSort],defaultSortField:Te.e[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===xe.ascending.toString(),isSortEnabled:!0});return t};t.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)};t.prototype._getCreateDocumentUrl=function(){return C.e.skyApiBaseUrl+"CreateDocument"};t.prototype._getCreateFolderUrl=function(){return C.e.skyApiBaseUrl+"AddFolder?lct=1"};t.prototype._getDeleteItemsUrl=function(){return C.e.skyApiBaseUrl+"DeleteItems"};t.prototype._getUpdateViewCountUrl=function(){return C.e.skyApiBaseUrl+"UpdateViewCount"};t.prototype._getRestoreItemsUrl=function(){return C.e.skyApiBaseUrl+"RestoreItems"};t.prototype._getOpenInClientDetailsUrl=function(){return C.e.skyApiBaseUrl+"GetOpenInClientDetails"};t.prototype._getRequestReviewUrl=function(){return C.e.skyApiBaseUrl+"OwnerRequestReview"};t.prototype._getReportAbuseUrl=function(){return C.e.skyApiBaseUrl+"ReportAbuse"};t.prototype._getRemoveFromSharedListUrl=function(){return C.e.skyApiBaseUrl+"AbdicatePermissions"};t.prototype._getAddCoverPhotoUrl=function(){return C.e.skyApiBaseUrl+"AddFavorites"};t.prototype._getRemoveCoverPhotoUrl=function(){return C.e.skyApiBaseUrl+"RemoveFavorites"};t.prototype._getUpdateItemsUrl=function(){return C.e.skyApiBaseUrl+"UpdateItem?lct=1"};t.prototype._getUpdateBundleUrl=function(){return C.e.skyApiBaseUrl+"UpdateBundle"};t.prototype._getCopyItemsUrl=function(){return C.e.skyApiBaseUrl+"CopyItemsAsync"};t.prototype._getMoveItemsUrl=function(){return C.e.skyApiBaseUrl+"MoveItems"};t.prototype._getRemoveFromRecentUrl=function(){return C.e.skyApiBaseUrl+"RemoveFromMRU"};t.prototype._getRemoveMountPointUrl=function(){return C.e.skyApiBaseUrl+"RemoveMountPoint"};t.prototype._getCreateMountPointUrl=function(){return C.e.skyApiBaseUrl+"AddFolder"};t.prototype._getRestoreAllUrl=function(){return C.e.skyApiBaseUrl+"RestoreAll"};t.prototype._getWorkProgressUrl=function(e){return C.e.skyApiBaseUrl+"GetWorkProgress?type="+e.type};t.prototype._getRotateItemUrl=function(){return C.e.skyApiBaseUrl+"ChangeImageOrientation"};t.prototype._getCancelWorkUrl=function(){return C.e.skyApiBaseUrl+"CancelWork"};t.prototype._getProcessReferralUrl=function(){return C.e.skyApiBaseUrl+"ProcessReferral"};t.prototype._getRedeemPermissionTokenUrl=function(){return C.e.skyApiBaseUrl+"RedeemPermissionToken"};t.prototype._isInvalidRootItemRequest=function(e){var t=new URL(e);return"root"===t.searchParams.get("id")&&t.searchParams.has("caller")&&t.searchParams.has("cid")&&!C.e.areCidsEqual(t.searchParams.get("caller"),t.searchParams.get("cid"))};t.prototype._getMockItemNotFoundResponse=function(e){return o.t.reject({message:"Promise failed without error handler",url:e,status:500,data:{code:3e3,debugMessage:"Item not found or access denied.",isExpected:!0,message:"This item might have been deleted, expired, or you might not have permission to access it. Contact the owner of this item for more information.",stackTrace:""}})};return t})(s.t);t.e=Ge},,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(75),i=(function(){function e(){this._state={}}e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]};e.prototype.setValue=function(e,t){t?this._state[e]=t:delete this._state[e]};return e})(),s=(function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new r.e("Identity.OAuth.".concat(t),n)}e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)};e.prototype.setValue=function(e,t){t?this._store.setValue(e,t):this._store.remove(e)};return e})()},function(e,t,n){"use strict";n.r(t);n.d(t,"encodeItemSetParentKeyKey",function(){return R});n.d(t,"resourceKey",function(){return z});var r,i=n(0),s=(n(277),n(23));(function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"})(r||(r={}));var o,u=r,a=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();(function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.pointInTimeRestore=3]="pointInTimeRestore";e[e.restoreItems=4]="restoreItems";e[e.uploadItems=5]="uploadItems";e[e.moveItems=6]="moveItems";e[e.copyItems=7]="copyItems";e[e.rotateItems=8]="rotateItems";e[e.addItemsToAlbum=9]="addItemsToAlbum";e[e.addCoverPhotos=10]="addCoverPhotos";e[e.removeCoverPhotos=11]="removeCoverPhotos";e[e.createAlbumFromFolder=12]="createAlbumFromFolder";e[e.createColumn=13]="createColumn";e[e.editColumn=14]="editColumn";e[e.deleteColumn=15]="deleteColumn";e[e.checkInItem=16]="checkInItem";e[e.checkOutItem=17]="checkOutItem";e[e.undoCheckOutItem=18]="undoCheckOutItem";e[e.createFolder=19]="createFolder";e[e.updateBundle=20]="updateBundle";e[e.shareItem=21]="shareItem";e[e.reportAbuse=22]="reportAbuse";e[e.requestReview=23]="requestReview";e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto";e[e.createAlbum=25]="createAlbum";e[e.uploadVideos=26]="uploadVideos";e[e.saveItem=27]="saveItem";e[e.createItem=28]="createItem";e[e.publishItem=29]="publishItem";e[e.unPublishItem=30]="unPublishItem";e[e.applyOfficeLens=31]="applyOfficeLens";e[e.removeOfficeLens=32]="removeOfficeLens";e[e.updateMetadata=33]="updateMetadata";e[e.makeHomepage=34]="makeHomepage";e[e.triggerFlow=35]="triggerFlow";e[e.downloadAsZip=36]="downloadAsZip";e[e.saveAutoAlbum=37]="saveAutoAlbum";e[e.discardAutoAlbum=38]="discardAutoAlbum";e[e.addToOneDrive=39]="addToOneDrive";e[e.removeFromSharedList=40]="removeFromSharedList";e[e.setupApprovalFlow=41]="setupApprovalFlow";e[e.setupReminderFlow=42]="setupReminderFlow";e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore";e[e.sharingReport=44]="sharingReport";e[e.editViewColumns=45]="editViewColumns";e[e.runModelOnItems=46]="runModelOnItems";e[e.importModel=47]="importModel";e[e.downloadItem=48]="downloadItem";e[e.deleteSmartTemplate=49]="deleteSmartTemplate";e[e.publishSmartTemplate=50]="publishSmartTemplate";e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate";e[e.universalAnnotationSync=52]="universalAnnotationSync"})(o||(o={}));var f=o,l=n(96);function c(){return l.t.wrap()}var h=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,o=t.isAvailable,u=void 0===o?r.create(!0):o,a=t.onExecute,f=void 0===a?c:a;n.count=s;n.isAvailable=u;n._onExecute=f.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=c};t.prototype.execute=function(){return this._onExecute()};return t})(s.t),p=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,{})||this,r=n.observables;n.name=t.name;n.iconName=t.iconName;n.state=r.create(u.created);n.warning=r.create("");n.error=r.create();n.count=r.create(1);var s=Object(i.e)({minimum:0,maximum:0,current:0},t.progress||{});n.progress={minimum:r.create(s.minimum),maximum:r.create(s.maximum),current:r.create(s.current)};n.type=r.create(t.type||f.multiple);n.batch=t.batch||new a;n._initializeActions(t.actions);n.payloads=r.create(t.payloads||{});n.visibility=r.create(t.visibility||0);return n}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new h({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(s.t),d=n(163),v=n(248),m=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(v.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||f.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return u[t.state()]}),r=e.addDisposable(d.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(d.t(t.progress.maximum,e.progress.maximum)),s=e.addDisposable(d.t(t.progress.current,e.progress.current)),o=e.addDisposable(d.e(n,e.states)),a=e.addDisposable(d.n(t.error,e.error)),f=e.addDisposable(d.t(t.count,e.count)),l=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();i.dispose();s.dispose();o.dispose();l.dispose();a.dispose();f.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?u.started:e.created?u.created:e.failed?u.failed:e.completed?u.completed:e.canceled?u.canceled:u.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new h({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return l.t.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||l.t.wrap()}))}}))};return t})(s.t),g=n(143),y=(function(e){Object(i.r)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new a;r._observers=i.createArray();var o=r.operations=i.createArray(),u=r.scope.attached(m),f=r.groups=r.addDisposable(v.e.group(o,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new u({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(m))({batch:s,operations:f});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new p(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=Object(i.o)([],e.operations.peek(),!0);this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],s=i.state.peek();if(s===u.completed||!e&&(s===u.expired||s===u.canceled||s===u.failed))for(var o=i.operations.peek(),a=void 0,f=0;f<o.length;f++){a=!0;var l=o[f];if(s===u.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(o[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(s.t),b=Object(g.i)("OperationProvider",y),w=n(131),E=n(103),S=n(171),x=n(24),T=n(4),N=(new T.t("dataStore"),new T.t("userSettingsStore"),new T.t("userInfoStore"),new T.t("smartFiltersStore")),C=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n.errorType=t.errorType||0;n.payloads=t.payloads||{};return n}return t})(n(55).e),k=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0},L=n(15),A=n(149),O=function(e,t,n){this.key=e||"";this.content=L.observable(new k(n));this.content.equalityComparer=A.t;this.schema=L.observableArray([]);this.schema.equalityComparer=A.e;this.context=L.utils.extend({},t);this.contentTypes=L.observableArray([]);this.isPlaceholder=!0;this.version=0};function M(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}var _=n(355),D=n(205),P=n(307),H=new T.t({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:s.n},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}}),B=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&M(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);if(t.remoteItem||t.isMountPointFolder){s[l].peek().isMountPointFolder=!0;s[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl}c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,n,r,i){var s=this._isExpandingGroup?r.group:null,o=r.itemsPerGroup,u=e&&e.length>0?e[0].itemGroups:null,a=null;u&&u.length>0&&u[u.length-1].isPlaceholder&&(a=u.pop());var f=this._mergeGroupings(e,t,i,n);if(s&&f){f[0].isAllCollapsed(!1);s.state({isCollapsed:!1})}if(n&&n.length>0&&!n[n.length-1]&&(u=f&&f.length>0?f[0].itemGroups:null)&&u.length>0){var l=u[u.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var c=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),h=f[0].isAllCollapsed.peek();if(c||this._isFetchingNextGroup||h){var p=l.startIndex+l.count;a?a.startIndex=p:a={groupingId:"__next__",startIndex:p,count:1,isPlaceholder:!0,state:L.observable({isCollapsed:!1})};n.length<p&&(n.length=p+1);u.push(a)}}return f};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})(),j=n(352),F=n(2),I=n(249),q=n(16),R=new T.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new T.e(Object(F.te)(F.$))}),U=(function(e){Object(i.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._encodeItemSetParentKey=n.encodeItemSetParentKey||!1;r._smartFiltersStore=n.smartFiltersStore;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function r(e,t){t&&(n+="&".concat(e,"=").concat(t))}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var s=new w.e(n),o=e.queryType,u=void 0===o?s.queryType:o;s.queryType=u;this._store.setItem(s);r=this._store.getItem(n)}if(!i){var a=r.peek(),f=a&&a.folder,l=f&&f.childCount||0;(i=new O(t,e,l)).item=r;var c=e.needSchema;if(void 0===c||c){var h=this._schemaDataSource,p=h&&h.getColumns(a);p&&p.length>0&&i.schema(p)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,r=n.triggerFetch,s=void 0!==r&&r,o=n.emptyAllOtherSets,u=void 0!==o&&o,a=n.refreshSchema,f=void 0!==a&&a,l=n.updateGrouping,c=void 0!==l&&l,h=n.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(s){var d=this._store.getItemSetFromItemKey(e);this._getItem(Object(i.e)(Object(i.e)({parentKey:e},d&&d.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return l.t.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return l.t.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new D.e(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return l.t.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(i.t)(t,void 0,void 0,function(){return Object(i.i)(this,function(t){switch(t.label){case 0:this.invalidateItem(e.parentKey);return this.resources.consume(I.e)?[4,this.resources.consumeAsync(x.o)]:[3,2];case 1:t.sent().invalidateItems(e.parentKey);t.label=2;case 2:return[2,n]}})})})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new a,n=this._operationProvider.register({name:e.item.name||"",type:f.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(u.started);n.progress.maximum(1);return r.then(function(e){n.state(u.completed);n.progress.current(1);return e},function(e){n.state(u.failed);n.error(new C({message:e}));return l.t.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new a,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:f.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(u.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(u.completed)}var a=e.items[0].UNSAFE_parent;a&&t.invalidateItem(a.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new C({message:e}));i.state(u.failed)}return l.t.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,f.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,f.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new D.e(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new O(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var n,r=this,s=_.e(e),o=this._store;if(e.keyAlias){n=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=n.peek().key}else n=this.getItemSync(e).item;var u=e.skipCache,a=void 0!==u&&u,f=this.getItemSetKey(e),c=e.itemSetProjections?this.getItemSetKey(e,!0):f,h=this._getItemSet(f,e),p=h&&h.content.peek().items,d=e.isTokenBasedApi||!!h&&!!h.isTokenBasedApi,v=!a&&n&&!n.peek().revision&&h&&!h.isExpired&&!h.isPlaceholder&&(!e.requestAllChildren||M(p,{start:0,end:p.length})),m=e.startIndex,g=void 0===m?0:m,y=e.pageSize,b=void 0===y?100:y,w=e.endIndex||g+b;w=p&&p.length>0&&!d?Math.min(p.length,w):w;g=Math.max(0,Math.min(w,g));var E=!q.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")?h&&!h.isExpired?o.getNextRequestToken(c):void 0:o.getNextRequestToken(c);e.requestToken="end"===E?"":E;var S=new B(e,o,d,t.TOKEN_BASED_API_EXTRA_ITEMS);S.initialize(h,g);var T=!1,N=h&&h.content.peek();if(N&&(1===N.partialResultStatus||2===N.partialResultStatus)){T=!0;1===N.partialResultStatus&&h.content({items:N.items,groupings:N.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(v&&!T&&S.isResultSetValid(p,{start:g,end:w}))return l.t.wrap(h);if(n&&n.peek().isStub){var C=e.startKey;if(C){if(o.getItem(C)){h.content.peek().items=[o.getItem(C)];h.isPlaceholder=!0;h.isExpired=!1;var k=this._schemaDataSource,L=k&&k.getColumns(n.peek());L&&L.length>0&&h.schema(L);h.content.valueHasMutated&&h.content.valueHasMutated()}}return l.t.wrap(h)}var A=h&&!h.isExpired&&h.content.peek().groupings;A&&A.length>0&&(e.isGrouped=!0);this._normalizeContext(e,p,g,w,!v);var D=this._getRequestKey(e),H=this._pendingGetItemRequests[D];if(H)return e.itemSetProjections?H.getPromise().then(function(t){return r.computeProjectedItemSet(f,t,e)}):H.getPromise();d&&!E&&(e.startIndex=0);this._pendingGetItemRequests[D]=H=new P.e;this.resources.consumeAsync(x.n.bypass).then(function(t){return t.getItem(Object(i.e)(Object(i.e)({},e),{itemSetKey:f}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);f=r.getItemSetKey(s)}var i=e.itemSetProjections?r.getItemSetKey(e,!0):f;n=o.getItem(e.parentKey);var u=o.getItemSet(i);v=!(!n||!u);var a=S.computeNewChildren(t,e,u,i,!!v),l=a.allChildren,c=a.hasNextRequestToken;c&&(d=c);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!v){(u=new O(i,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=d;o.setItemSet(i,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;u.schema(m&&m.length>0&&m||[]);t.customViewRenderer?u.customViewRenderer=r.observables.create(t.customViewRenderer):u.customViewRenderer=r.observables.create(void 0)}var g=t.groupings;d&&e.mergeGroupings&&(g=S.computeNewGroupings(u.content.peek().groupings,t.groupings,l,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var y=u.content.peek(),b=y.partialResultStatus,w=y.partialResultRequestCount,E=void 0===w?0:w;if(!(g&&g.length&&!!g[0])){if(c&&(t.children&&t.children.length<30||!t.children)){var x=E+1;x<=5?E=x:b=1}else void 0===b||0===b||c?2===b&&t.children&&30===t.children.length&&(b=0):b=3}u.content({items:l,groupings:g,partialResultRequestCount:E,partialResultStatus:b});var T=u.version,N=void 0===T?0:T;u.version=N+1}delete r._pendingGetItemRequests[D];if(e.requestAllChildren&&!M(l,{start:0,end:t.totalChildren})){var C=_.e(e),k=C.startIndex,L=void 0===k?0:k;C.startIndex=L+100;return r._getItem(C)}if(t.isFromBrowserCache){s.skipCache=!0;return r._getItem(s)}e.itemSetProjections&&(u=r.computeProjectedItemSet(f,u,e));return u},function(e){delete r._pendingGetItemRequests[D];return l.t.wrapError(e)}).then(function(e){H.complete(e)},function(t){r._groupThrottle&&!r._groupThrottle()&&t&&t.errorCode===Number(j.e.queryThrottled)&&!e.noGroupReplace?r._groupThrottle(!0):H.error(t)});return H.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new a,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),f=n.call(this,e),l=0,c=o;l<c.length;l++){c[l].state(u.started)}return f.then(function(t){r.invalidateItem(s.key);(null==e?void 0:e.itemsScopeInvalidate)&&r.resources.consumeAsync(x.o).then(function(e){e.invalidateItems(null==s?void 0:s.key)});for(var n=0,i=o;n<i.length;n++){var a=i[n];a.progress.current(1);a.state(u.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(u.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return l.t.resolve(this.resources.consumeAsync(x.u))};t.dependencies=Object(i.e)(Object(i.e)({},s.t.dependencies),{groupThrottle:S.t.optional,schemaDataSource:x.a.optional,itemsStore:E.e,operationProvider:b,smartFiltersStore:N.optional,updateQuota:H,encodeItemSetParentKey:R.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(s.t),z=(t.default=U,Object(g.i)("ItemProvider",U))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(4).t)("people")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={ODB:!n(16).e.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")}},,,,,,,,,,,function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=(function(){try{if(!Object.assign)return!1;var e=new String("abc");e[5]="de";if("5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e});return"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}})()?Object.assign:function(e,t){for(var n,u,a=o(e),f=1;f<arguments.length;f++){n=Object(arguments[f]);for(var l in n)i.call(n,l)&&(a[l]=n[l]);if(r){u=r(n);for(var c=0;c<u.length;c++)s.call(n,u[c])&&(a[u[c]]=n[u[c]])}}return a}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(434),i=n(4),s=n(143),o=new i.t({name:"offlineDetection",factory:new s.r(r.e)})},,,,function(e,t,n){"use strict";var r;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(r||(r={}));t.e=r},function(e,t,n){"use strict";var r;(function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(144),i=new r.e("viewParamsToItemKey",{itemKey:r.t})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(4),i=n(183),s=n(240),o=new r.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(s.e.notConfigured)}}}})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s.e});var r;(function(){function e(){}e.DefaultLocale="en-US";e.TeamsListClientName="Teams.List";e.TeamsPagesClientName="Teams.Page";e.TeamsFileClientName="Teams.File";e.PageContextKey="_spPageContextInfo"})();(function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.Page=2]="Page";e[e.Portal=3]="Portal";e[e.File=4]="File"})(r||(r={}));var i=function(){};r.None,new i;r.None;location.search,n(468),n(288),n(151),location.search;var s=n(177)},function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r,i=n(0),s=n(23),o=n(143),u=n(15),a=n(96),f=n(307),l=n(69);(function(e){e[e.normal=0]="normal";e[e.blocker=1]="blocker";e[e.vaultBlocker=2]="vaultBlocker"})(r||(r={}));var c=r,h=function(){this.icon=null;this.isAvailable=u.observable(!0);this.isVisible=u.observable(!0);this.isDefault=!1;this.automationId="";this.instrumentationId="";this.isExecuting=u.observable(!1);this.isLink=!1;this.execute=function(){return a.t.wrap(1)}},p=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n.state=u.observable(1);var r=t.title,i=t.titleAction,s=t.titleIcon,o=t.titleIconAriaLabel,a=t.customCssClasses,l=t.actions,p=void 0===l?[]:l,d=t.component,v=t.control,m=t.isDismissable,g=void 0===m||m,y=t.isSoftDismissable,b=void 0===y||y,w=t.isDismissableOnResize,E=void 0!==w&&w,S=t.isDismissableOnScroll,x=void 0!==S&&S,T=t.size,N=void 0===T?"Small":T,C=t.automationId,k=t.executeDefaultAction,L=void 0===k||k,A=t.isCallout,O=t.isOverlayHidden,M=void 0!==O&&O,_=t.overlayColor,D=void 0===_?"rgba(255,255,255,.4)":_,P=t.invokerEvent,H=t.calloutHeight,B=t.instrumentationId,j=void 0===B?"":B,F=t.shouldPreserveFocus,I=void 0===F||F,q=t.stayAsPopup,R=void 0!==q&&q,U=t.template,z=void 0===U?1:U,W=t.style,X=void 0===W?c.normal:W,V=t.focusOnPrimaryAction,$=void 0!==V&&V,J=t.dismissOnEsc,K=void 0!==J&&J;n.title=u.isObservable(r)?r:u.observable(r);n.titleAction=i;n.titleIcon=s;n.titleIconAriaLabel=o;n.customCssClasses=a;n.actions=p;n.component=d;n.control=v;n.isDismissable=g;n.isSoftDismissable=b;n.isDismissableOnResize=E;n.isDismissableOnScroll=x;n.size=N;n.automationId=C||"";n.executeDefaultAction=L;n.isCallout=!!A&&!!P;n.isOverlayHidden=M;n.overlayColor=D;n.invokerEvent=P;n.calloutHeight=H;n.instrumentationId=j;n.shouldPreserveFocus=u.isObservable(I)?I:u.observable(I);n.stayAsPopup=R;n.template=z;n.style=X;n.focusOnPrimaryAction=$;n.dismissOnEsc=K;n.actions=n.actions.map(function(e){return u.utils.extend(new h,e)});n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,r=n.actions;t<r.length;t++){r[t].isVisible()&&(e=!0)}return e},{disposeWhen:function(){return 1!==n.state()}});var Q=new f.e;n.createComputed(function(){var e=n.state();1!==e&&(2===e?Q.complete():Q.cancel())});n._promise=Q.getPromise();n.events.on(document,"keydown",n._keyDownEvent);return n}t.prototype.complete=function(){this.state(2)};t.prototype.dismiss=function(){this.state(3)};t.prototype.wait=function(){return this._promise};t.prototype._keyDownEvent=function(e){e.keyCode===l.e.escape&&this.dismissOnEsc&&this.state(3)};return t})(s.t),d=n(4),v=n(183),m=new d.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new v.e(!1)}}}}}),g=(function(e){Object(i.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogs=[];r.currentDialog=r.observables.create();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,r=new p(e);if(e.queueDialog){t.push(r);1===t.length&&n(r)}else{t.unshift(r);n(r)}var i=function(){var e=t.indexOf(r);if(e>=0){t.splice(e,1);n(t[0])}r.dispose()};r.wait().then(i,i);return r};t.dependencies=Object(i.e)(Object(i.e)({},s.t.dependencies),{needsOverlayContent:m});return t})(s.t),y=Object(o.i)("DialogProvider",g)},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.text;return n}return t})(n(223).e),s=n(226).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(4).t)("clientName")}],Array(24),[function(e,t,n){(function(){function t(e,t){var n,r,i,s,o,u,a,f;n=3&e.length;r=e.length-n;i=t;o=3432918353;u=461845907;f=0;for(;f<r;){a=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24;++f;i=27492+(65535&(s=5*(65535&(i=(i^=a=(65535&(a=(a=(65535&a)*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*u+(((a>>>16)*u&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16)}a=0;switch(n){case 3:a^=(255&e.charCodeAt(f+2))<<16;case 2:a^=(255&e.charCodeAt(f+1))<<8;case 1:i^=a=(65535&(a=(a=(65535&(a^=255&e.charCodeAt(f)))*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*u+(((a>>>16)*u&65535)<<16)&4294967295}i^=e.length;i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295;i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295;return(i^=i>>>16)>>>0}var n=t;n.v2=function(e,t){for(var n,r=e.length,i=t^r,s=0;r>=4;){n=1540483477*(65535&(n=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+((1540483477*(n>>>16)&65535)<<16);i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16));r-=4;++s}switch(r){case 3:i^=(255&e.charCodeAt(s+2))<<16;case 2:i^=(255&e.charCodeAt(s+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(s)))+((1540483477*(i>>>16)&65535)<<16)}i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16);return(i^=i>>>15)>>>0};n.v3=t;e.exports=n})()},,function(e,t,n){"use strict";n.r(t);n.d(t,"STORAGE_KEY_EXPIRATION",function(){return z});n.d(t,"resourceKey",function(){return J});var r=n(0),i=n(23),s=n(31),o=n(24),u=n(128),a=n(349),f=n(44),l=n(180),c=n(155),h=n(103),p=n(143),d=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.UNSAFE_parent&&s.UNSAFE_parent.key)}return n};e.dependencies={itemsStore:h.e};return e})(),v=Object(p.i)("ItemParentHelper",d),m=n(208),g=n(75),y=n(132),b=(function(e){Object(r.r)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;r.isVaultDisabled=r.createObservable(void 0);r.vaultFreState=r.createObservable(y.n.NotCreated);r.vaultQuota=r.createObservable(void 0);r.isOverQuota=r.createPureComputed(r._computeIsOverQuota);r.showVaultLockNotification=r.createObservable(!1);r.showVaultFreMessage=r.createObservable(!1);r.storageKeyPrefix=y.t+r._identityDataSource.getIdentity().id;r.dataStore=new g.e(r.storageKeyPrefix,s.e.local);r.isVaultOpen=r.createObservable(!!r.dataStore.getValue("expirationtime",s.e.local));return r}t.prototype._computeIsOverQuota=function(){var e=this.vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0};return t})(i.t),w=Object(p.i)("VaultStore",b,Object(r.e)(Object(r.e)({},i.t.dependencies),{identityDataSource:o.i})),E=n(56),S=n(96),x=n(12),T=n(8);function N(e,t){var n;switch(e){case x.e.Files:n="Files";break;case x.e.Restore:n="Restore";break;case x.e.RansomwareDetection:n="RansomwareDetection";break;case x.e.ManageVault:n="ManageVault";break;default:n=""}return t?"".concat(n,"-").concat(T.e[t]):"".concat(n)}var C=n(98),k=n(318),L=n(241),A=n(350),O=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.html=t.html;return n}return t})(n(223).e),M=n(226).e({tagName:"ms-html-container",template:'<div class="HTMLContainer" data-bind="html:html"></div>',viewModel:O}),_=n(165),D=n(29),P=n(348),H=n(6),B=n(2),j=n(351),F=n(220),I=n(20),q=n(53),R=n(47),U=n(360),z="expirationtime",W=["ManageVault","Restore","RansomwareDetection"],X=!H.e.isActivated("CD980492-57E1-4F11-95BA-27FBECF1987D","01/25/2022","Enable item invalidate after vault actions in ODC lightspeed"),V=!H.e.isActivated("41127D76-546C-4B0D-A56E-271886E91F4A","02/18/2022","Enable quota invaludate in ODC lightspeed when needed"),$=(function(e){Object(r.r)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._clientName=n.clientName;r._identityDataSource=n.identityDataSource;r._vroomDataRequestor=n.vroomDataRequestor;r._itemStore=n.itemStore;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;r._dialogProvider=n.dialogProvider;r._userInfoProvider=n.userInfoProvider;r._itemParentHelper=n.itemParentHelper;r._bundleLoader=n.bundleLoader;r._isItemsScopeEnabled=n.isItemsScopeEnabled;r._vaultStore=n.vaultStore;r._storageKeyPrefix=r._vaultStore.storageKeyPrefix;r._dataStore=r._vaultStore.dataStore;r._isVaultOpen=r._vaultStore.isVaultOpen;r._vaultFreState=r._vaultStore.vaultFreState;r._vaultSuggestCardState=r.createObservable(0);r._vaultQuota=r._vaultStore.vaultQuota;r._quotaLoaded=r.createComputed(r._computeQuotaLoaded);r._isVaultDisabled=r._vaultStore.isVaultDisabled;r._isLocking=!1;r._isOneDriveWinApp=Object(P.e)();r.isOverQuota=r._vaultStore.isOverQuota;r._showVaultLockNotification=r._vaultStore.showVaultLockNotification;r._showVaultFreMessage=r._vaultStore.showVaultFreMessage;r.createComputed(r._calculateFreMessage);r.events.on(window,"storage",r._onStorageChange);r.createBackgroundComputed(r._updateVaultQuota);r.fetchIsVaultDisabled();r._isVaultOpen.peek()&&(r._getExpiration()<Date.now()?r.lockVault(void 0,!0):r._handleVaultUnlock());return r}t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))};t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))};t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))};t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))};t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))};t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))};t.prototype.getVaultItem=function(){return this._vaultItem};t.prototype.isVaultOpen=function(){return this._isVaultOpen};t.prototype.isVaultDisabled=function(){return this._isVaultDisabled};t.prototype.freState=function(){return this._vaultFreState};t.prototype.suggestCardState=function(){return this._vaultSuggestCardState};t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()};t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1);t||this._showVaultFreMessage(e);this._setVaultIconFre(e)};t.prototype.unlockVault=function(e,t){var n=this;return this.getVault(!1,!0).then(function(i){if(!i||!i.vault||i.vault.isLocked||e){var s;s=e?n._identityDataSource.getSessionToken(!0):n._isOneDriveWinApp?S.t.resolve({wlidToken:t}):S.t.resolve({accessToken:t});var o={};n._isOneDriveWinApp&&(o.Prefer="Include-Feature=Vault");Object(B.te)(B.e)&&(o=Object(r.e)(Object(r.e)(Object(r.e)({},o),{Scenario:F.e.OpenVault,ScenarioType:F.t.ActiveUserOperation}),n._clientName?{Application:n._clientName}:{}));return s.then(function(t){return n._vroomDataRequestor.send(Object(r.e)({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",headers:o,requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:n._postProcessUnlockQos.bind(n),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}},Object(B.te)(B.A)&&Object(q.e)(R.s)?n.getUnlockVaultV2RequestData():{})).then(function(){n.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:1200});if(!e){var t=n._urlDataSource.getRootItemKey();n._invalidateItems(t)}return S.t.resolve({})}).catch(function(e){n._handleVaultLock();return S.t.reject(e)})})}n.setVaultLockState(i.vault,!!t)})};t.prototype.setVaultLockState=function(e,t,n){void 0===t&&(t=!1);if(!this._isLocking){var r=this._isVaultOpen.peek(),i=e.isLocked;if(i||r)i&&r&&this._handleVaultLock(!1,n);else{var o=e.expirationInSeconds||1200,u=Date.now()+1e3*o;this._dataStore.setValue(z,u,s.e.local);this._handleVaultUnlock(t)}}};t.prototype.lockVault=function(e,t){var n=this;this._isLocking=!0;this._navToRootIfInVault();if(e){var i=this._urlDataSource.getPageType(this._navigation.viewParams),s=this._urlDataSource.getQueryType(this._navigation.viewParams);u.e.logData({name:"Vault.Autolocked",extraData:{location:N(i,s)}})}var o=this._vaultItem?S.t.resolve(this._vaultItem):this.getVault(),a={};this._isOneDriveWinApp&&(a.Prefer="Include-Feature=Vault");Object(B.te)(B.e)&&(a=Object(r.e)(Object(r.e)(Object(r.e)({},a),{Scenario:F.e.CloseVault,ScenarioType:F.t.ActiveUserOperation}),this._clientName?{Application:this._clientName}:{}));return o.then(function(i){return n._vroomDataRequestor.send(Object(r.e)({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",headers:a,requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}},Object(B.te)(B.A)&&Object(q.e)(R.s)?n.getLockVaultV2RequestData():{})).then(function(){n._isLocking=!1;n._handleVaultLock(t)}).catch(function(e){n._isLocking=!1;403===e.status?n._handleVaultLock(t):n._showLockFailed();return n._isExpectedError(e)?S.t.resolve():S.t.reject(e)})})};t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)};t.prototype.extendLock=function(){return this.unlockVault(!0)};t.prototype.getVault=function(e,t,n,r){var i=this,s={};e&&(s.Prefer="auto-create-special-folder");this._isOneDriveWinApp&&(s.Prefer=s.Prefer+",Include-Feature=Vault");n=n||"GET";return(Object(B.te)(B.A)&&Object(q.e)(R.s)?this.getVaultV2(e,r):this._vroomDataRequestor.send({apiName:r?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:s,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)})).then(function(e){var t,n;if(e){(null===(n=null===(t=null==e?void 0:e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.id)&&(e.createdBy.user.id=e.createdBy.user.id.toUpperCase());i._vaultItem=e}return e}).catch(function(e){return t?null:S.t.reject(e)})};t.prototype.getQuota=function(){var e=this,t={};this._isOneDriveWinApp&&(t.Prefer="Include-Feature=Vault");return this._vroomDataRequestor.send({apiName:"drive",path:"/drive?select=quota/vault",headers:t,requestType:"GET"}).then(function(t){var n=t&&t.quota&&t.quota.vault;e._vaultQuota(n);return n})};t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===y.n.Created)return e.getVault(!0).then(function(t){e.setVaultState(y.n.Created);e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();e._invalidateItems(n,{triggerFetch:!0});return t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s);e._vaultSuggestCardState(n.c)})};t.prototype.fetchIsVaultDisabled=function(){var e=this;if(void 0!==this._isVaultDisabledPromise)return this._isVaultDisabledPromise;this._isVaultDisabledPromise=this._userInfoProvider.getUserFact(46).then(function(t){if(t)return e.getVault(!1,!1,"HEAD").then(function(){e._isVaultDisabled(!1);return!1}).catch(function(t){var n=404===t.status;e._isVaultDisabled(n);return n});e._isVaultDisabled(!0);return!0});return this._isVaultDisabledPromise};t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){var n=e._urlDataSource.getRootItemKey();e._invalidateItems(n,{triggerFetch:!0});e._isVaultDisabled(!1);return t})};t.prototype.disableVault=function(e){var t=this;if(Object(B.te)(B.A)&&Object(q.e)(R.s))return e?this.disableVaultV2():S.t.resolve("confirmToken");var n={};e&&(n.If="(<".concat(e,">)"));this._isOneDriveWinApp&&(n.Prefer="Include-Feature=Vault");return this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo();t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new D.t(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n){0;return n}}return S.t.reject(e)})};t.prototype.setVaultState=function(e,t){var n=void 0;if(void 0!==e&&e>this._vaultFreState.peek()){this._vaultFreState(e);n=e}t&&this._vaultSuggestCardState(t);var r={s:n||this._vaultFreState.peek(),c:t||this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(r))};t.prototype.reset=function(){0;return S.t.resolve(!1)};t.prototype.toggleDebug=function(){0};t.prototype._onNavigationChange=function(){var e=this._getCurrentItem(),t=this._navigation.viewParams,n=this._isVaultOpen.peek();if(e){n&&(!e.vault&&W.indexOf(t&&t.v)<=-1?this._detatchIdleEvents():this._attachIdleEvents());if(e.vault&&e.vault.root){if(!this._vaultRootLoadEventFiled){u.e.logData({name:"Vault.Unlocked.Loaded"});this._vaultRootLoadEventFiled=!0}}else this._vaultRootLoadEventFiled=!1}};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(2).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(C.i));return!0}return!1};t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();if(this._quotaLoaded()&&e&&this._isVaultOpen()){this.getQuota();if(B.ne&&V){var t=this._getCurrentItem();this.resources.consumeAsync(o.o).then(function(e){e.invalidateQuota(null==t?void 0:t.key)})}}};t.prototype._isDebug=function(){0;return!1};t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue(z,s.e.local)};t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4);this._expirationLockTimerId=this.async.setTimeout(function(){0;e.lockVault(!0)},this._getExpiration()-Date.now())};t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId);this.async.clearTimeout(this._expirationLockTimerId)};t.prototype._resetExpirationTimers=function(){0;this._stopExpirationTimers();this._startExpirationTimers()};t.prototype._attachIdleEvents=function(){if(!this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0);this.events.on(document,"mousemove",this._resetLastActivity,!0);this.events.on(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!0;0}};t.prototype._detatchIdleEvents=function(){if(this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0);this.events.off(document,"mousemove",this._resetLastActivity,!0);this.events.off(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!1;0}};t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()};t.prototype._verifyLockExpiration=function(){var e=this;0;if(this._isDebug())this._showLockWarning();else if(Date.now()-this._lastActivity<9e5){0;this.extendLock().then(function(){e._resetExpirationTimers()})}else this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){0;var r=Date.now()+1e3*n;e._dataStore.setValue(z,r,s.e.local);e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){0;return e.lockVault()})};t.prototype._showLockFailed=function(){var e=this,t=this._dialogProvider.requestDialog({title:_.s,component:{name:M.tagName,params:{html:'<span class="ms-fontColor-error">'.concat(_.r,"</span>")}},actions:[{name:_.i,execute:function(){return S.t.resolve(2)},isAvailable:this.observables.create(!0),icon:new l.e("CheckMark"),isDefault:!0}],isSoftDismissable:!1});t.wait().then(function(){if(2===t.state.peek()){e.async.clearTimeout(e._retryLockVault);e._retryLockVault=e.async.setTimeout(function(){e.lockVault()},500)}})};t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:_.n,component:{name:A.e.tagName,params:{text:_.e}},actions:[{name:_.t,execute:function(){u.e.logData({name:"Vault.StillHere.Extend"});return e.extendLock().then(function(){e._resetExpirationTimers();return S.t.resolve(2)})},isAvailable:this.observables.create(!0),icon:new l.e("Cancel"),isDefault:!0}],isSoftDismissable:!1});u.e.logData({name:"Vault.StillHere.Shown"});this._warningDialog.wait().catch(function(){3===e._warningDialog.state.peek()&&u.e.logData({name:"Vault.StillHere.Dismiss"})})};t.prototype._handleVaultLock=function(e,t){this._cleanLocalLockInfo(t);this._showVaultLockNotification(!e)};t.prototype._cleanLocalLockInfo=function(e){var t=this;this._isVaultOpen(!1);this._dataStore.remove(z,s.e.local);this._stopExpirationTimers();e||this._navToRootIfInVault();this.events.off(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!1;this._getVaultIconFre()||this._showVaultFreMessage(!1);this._detatchIdleEvents();this._warningDialog&&this._warningDialog.dismiss();Object.keys(T.e).map(function(e){var n=t._urlDataSource.getRootItemKey(T.e[e]);t._invalidateItems(n)});var n=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"vault"))){var r=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([r])}else n&&this._invalidateItems(n.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()};t.prototype._navToRootIfInVault=function(){var e=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"))){var t=this._urlDataSource.getRootItemKey(),n=this._urlDataSource.getItemUrl(t);this._navigation.navigateTo({url:n})}};t.prototype._invalidateItems=function(e,t){var n=this;this._isItemsScopeEnabled()?this.resources.consumeAsync(o.o).then(function(r){r.invalidateItems(e);Object(B.te)(B.A)&&Object(q.e)(R.s)&&r.invalidateCurrentItemSet();B.ne&&X&&n._itemProvider.invalidateItem(e,t);var i=n._getCurrentItem();(null==i?void 0:i.vault)&&r.invalidateItems(i.key)}):this._itemProvider.invalidateItem(e,t)};t.prototype._handleVaultUnlock=function(e){var t=this;void 0===e&&(e=!1);this._isVaultOpen(!0);this._resetExpirationTimers();var n=this._urlDataSource.getRootItemKey();this._invalidateItems(n,{triggerFetch:!0});if(!this._navEventAttached){this.events.on(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!0;this._onNavigationChange()}this.getQuota();this._warningDialog&&this._warningDialog.dismiss();var r=this._getCurrentItem();if(r&&(r.vault||r.isPlaceholder||r.error&&r.error.data&&161===r.error.data.errorCode||r.queryType===T.e.RecycleBin&&"root"===r.id)){this._invalidateItems(r.key,{triggerFetch:!0});var i=this._urlDataSource.getFocusItemKey(this._navigation.viewParams);i&&this._invalidateItems(i,{purgeCache:!0})}this._showVaultLockNotification(!1);u.e.logData({name:"Vault.Unlocked.Succeeded"});if(this._getVaultIconFre()&&!e){this.async.setTimeout(function(){t._showVaultFreMessage(!0)},5e3);this._setVaultIconFre(!1)}};t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,r=e.newValue;if(t===this._storageKeyPrefix+y.e&&r)try{var i=JSON.parse(r);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}if(t===this._storageKeyPrefix+z)if(r){if(!n||r>n){this._dataStore.getValue(z,s.e.local)||this._dataStore.setValue(z,parseInt(r,10),s.e.local);this._handleVaultUnlock()}}else this._isVaultOpen.peek()&&this._handleVaultLock()};t.prototype._calculateFreMessage=function(){var e=this;this._getVaultIconFre()&&this.async.setTimeout(function(){e._showVaultFreMessage(!0)},5e3)};t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))};t.prototype._getVaultIconFre=function(){return this._dataStore.getValue("vaultMenuCalloutMessageShow",s.e.local)};t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue("vaultMenuCalloutMessageShow",e,s.e.local):this._dataStore.remove("vaultMenuCalloutMessageShow",s.e.local)};t.prototype._postProcessQos=function(e,t){this._isExpectedError(t)&&(e.resultType=f.e.ExpectedFailure);return e};t.prototype._postProcessUnlockQos=function(e,t){this._isExpectedUnlockError(t)&&(e.resultType=f.e.ExpectedFailure);return e};t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=Object(c.r)(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1};t.prototype._isExpectedUnlockError=function(e){var t=Object(c.r)(e);if("vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())){u.e.logData({name:"Vault.Unlock.MaxExtensionError"});return!0}return!1};t.prototype.enableVaultV2=function(e){var t=this;return this._vroomDataRequestor.send({endpoint:Object(I.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:e?"CreateVault":"EnableVault",path:"/oneDrive.createVault",requestType:"POST",breakCache:!0,apiVersion:"v2.1",qosExtraData:{requestType:"POST"},postProcessQos:this._postProcessQos.bind(this),useAuthorizationHeaders:!0}).then(function(){t.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:1200})})};t.prototype.disableVaultV2=function(){var e,t=this;return(null===(e=this._identityDataSource)||void 0===e?void 0:e.getSessionToken(!0)).then(function(e){return t._vroomDataRequestor.send({endpoint:Object(I.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"deleteVault",path:"/oneDrive.disableVault",requestType:"POST",breakCache:!0,apiVersion:"v2.1",qosExtraData:{requestType:"POST"},postProcessQos:t._postProcessQos.bind(t),useAuthorizationHeaders:!0,accessToken:e}).then(function(){t._cleanLocalLockInfo();t._isVaultDisabled(!0)}).catch(function(e){return S.t.reject(e)})})};t.prototype.getUnlockVaultV2RequestData=function(){return{endpoint:Object(I.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.unlockVaultV2",path:"/oneDrive.unlockVault"}};t.prototype.getLockVaultV2RequestData=function(){return{endpoint:Object(I.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.lockVaultV2",path:"/oneDrive.lockVault"}};t.prototype.getVaultV2=function(e,t){var n=this,i={Prefer:"Include-Feature=AddToOneDrive"};return(e||t?this.enableVaultV2(e):S.t.resolve()).then(function(){return n._vroomDataRequestor.send({endpoint:Object(I.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"GetVault",path:"/drive/items/root/children?select=*,containingDrivePolicyScenarioViewpoint&filter=remoteItem/containingDrivePolicyScenarioViewpoint/PolicyScenarioId eq '".concat("fa0c6428-7a2e-4a42-a9cc-52f48021d0ba","'"),headers:i,breakCache:!0,apiVersion:"v2.1",useAuthorizationHeaders:!0})}).then(function(e){var t;if(0===e.length)return S.t.reject({status:404,message:"Vault not found"});var n=e[0];return Object(r.e)(Object(r.e)({},n),{vault:Object(U.e)(null===(t=n.remoteItem)||void 0===t?void 0:t.containingDrivePolicyScenarioViewpoint)})})};return t})(i.t),J=(t.default=$,Object(p.i)("VaultDataSource",$,Object(r.e)(Object(r.e)({},i.t.dependencies),{clientName:j.e.optional,identityDataSource:o.i,vroomDataRequestor:L.e,itemStore:h.e,vaultStore:w,urlDataSource:o.c,navigation:E.e,itemProvider:k.resourceKey,dialogProvider:a.e,userInfoProvider:C.u,itemParentHelper:v,bundleLoader:C.e,isItemsScopeEnabled:m.t.lazy})))},,,,,,,,,,,,function(e,t){var n;n=(function(){return this})();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}],Array(36),[function(e,t,n){"use strict";e.exports=n(428)},function(e,t,n){"use strict";var r,i,s,o;if("object"==typeof performance&&"function"==typeof performance.now){var u=performance;t.unstable_now=function(){return u.now()}}else{var a=Date,f=a.now();t.unstable_now=function(){return a.now()-f}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,h=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e);l=null}catch(e){throw setTimeout(h,0),e}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(h,0))};i=function(e,t){c=setTimeout(e,t)};s=function(){clearTimeout(c)};t.unstable_shouldYield=function(){return!1};o=t.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,d=window.clearTimeout;if("undefined"!=typeof console){var v=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills");"function"!=typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,g=null,y=-1,b=5,w=0;t.unstable_shouldYield=function(){return t.unstable_now()>=w};o=function(){};t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var E=new MessageChannel,S=E.port2;E.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();w=e+b;try{g(!0,e)?S.postMessage(null):(m=!1,g=null)}catch(e){throw S.postMessage(null),e}}else m=!1};r=function(e){g=e;m||(m=!0,S.postMessage(null))};i=function(e,n){y=p(function(){e(t.unstable_now())},n)};s=function(){d(y);y=-1}}function x(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<C(i,t)))break e;e[r]=t,e[n]=i,n=r}}function T(e){return void 0===(e=e[0])?null:e}function N(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var s=2*(r+1)-1,o=e[s],u=s+1,a=e[u];if(void 0!==o&&0>C(o,n))void 0!==a&&0>C(a,o)?(e[r]=a,e[u]=n,r=u):(e[r]=o,e[s]=n,r=s);else{if(!(void 0!==a&&0>C(a,n)))break e;e[r]=a,e[u]=n,r=u}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var k=[],L=[],A=1,O=null,M=3,_=!1,D=!1,P=!1;function H(e){for(var t=T(L);null!==t;){if(null===t.callback)N(L);else{if(!(t.startTime<=e))break;N(L),t.sortIndex=t.expirationTime,x(k,t)}t=T(L)}}function B(e){P=!1;H(e);if(!D)if(null!==T(k))D=!0,r(j);else{var t=T(L);null!==t&&i(B,t.startTime-e)}}function j(e,n){D=!1;P&&(P=!1,s());_=!0;var r=M;try{H(n);for(O=T(k);null!==O&&(!(O.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=O.callback;if("function"==typeof o){O.callback=null;M=O.priorityLevel;var u=o(O.expirationTime<=n);n=t.unstable_now();"function"==typeof u?O.callback=u:O===T(k)&&N(k);H(n)}else N(k);O=T(k)}if(null!==O)var a=!0;else{var f=T(L);null!==f&&i(B,f.startTime-n);a=!1}return a}finally{O=null,M=r,_=!1}}var F=o;t.unstable_IdlePriority=5;t.unstable_ImmediatePriority=1;t.unstable_LowPriority=4;t.unstable_NormalPriority=3;t.unstable_Profiling=null;t.unstable_UserBlockingPriority=2;t.unstable_cancelCallback=function(e){e.callback=null};t.unstable_continueExecution=function(){D||_||(D=!0,r(j))};t.unstable_getCurrentPriorityLevel=function(){return M};t.unstable_getFirstCallbackNode=function(){return T(k)};t.unstable_next=function(e){switch(M){case 1:case 2:case 3:var t=3;break;default:t=M}var n=M;M=t;try{return e()}finally{M=n}};t.unstable_pauseExecution=function(){};t.unstable_requestPaint=F;t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=M;M=e;try{return t()}finally{M=n}};t.unstable_scheduleCallback=function(e,n,o){var u=t.unstable_now();"object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?u+o:u:o=u;switch(e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}e={id:A++,callback:n,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1};o>u?(e.sortIndex=o,x(L,e),null===T(k)&&e===T(L)&&(P?s():P=!0,i(B,o-u))):(e.sortIndex=a,x(k,e),D||_||(D=!0,r(j)));return e};t.unstable_wrapCallback=function(e){var t=M;return function(){var n=M;M=t;try{return e.apply(this,arguments)}finally{M=n}}}},function(e,t,n){var r,i,s;!(function(o){"use strict";function u(e,t,n,r,i,s,o){this.inputItem=t,this.stateArrayIndex=n,this.mappingOptions=i,this.arrayOfState=s,this.outputObservableArray=o,this.outputArray=this.outputObservableArray.peek(),this.isIncluded=null,this.suppressNotification=!1,this.outputArrayIndex=e.observable(r),this.disposeFuncFromMostRecentMapping=null,this.mappedValueComputed=e.computed(this.mappingEvaluator,this),this.mappedValueComputed.subscribe(this.onMappingResultChanged,this),this.previousMappedValue=this.mappedValueComputed.peek()}function a(e,t){if(!e)return null;switch(e.status){case"added":return e.index;case"deleted":return e.index+t;default:throw new Error("Unknown diff status: "+e.status)}}function f(e,t,n,r,i,s,o,a,f){var l="number"==typeof t.moved,c=l?n[t.moved]:new u(e,t.value,r,i,s,o,a);return o.splice(r,0,c),c.isIncluded&&f.splice(i,0,c.mappedValueComputed.peek()),l&&(c.stateArrayIndex=r,c.setOutputArrayIndexSilently(i)),c}function l(e,t,n,r,i){var s=t.splice(n,1)[0];s.isIncluded&&i.splice(r,1),"number"!=typeof e.moved&&s.dispose()}function c(e,t,n){return e.stateArrayIndex=t,e.setOutputArrayIndexSilently(n),n+(e.isIncluded?1:0)}function h(e,t,n,r,i,s){return t.subscribe(function(t){if(t.length){for(var o=(function(e,t){for(var n={},r=0;r<e.length;r++){var i=e[r];"added"===i.status&&"number"==typeof i.moved&&(n[i.moved]=t[i.moved])}return n})(t,n),u=0,h=t[0],p=0,d=h&&(function(e,t,n){return n.length&&t[e.index]?t[e.index].outputArrayIndex.peek():n.length})(h,n,r),v=h.index;h||v<n.length;v++)if(a(h,p)===v){switch(h.status){case"added":f(e,h,o,v,d,s,n,i,r).isIncluded&&d++,p++;break;case"deleted":l(h,n,v,d,r),p--,v--;break;default:throw new Error("Unknown diff status: "+h.status)}h=t[++u]}else v<n.length&&(d=c(n[v],v,d));i.valueHasMutated()}},null,"arrayChange")}function p(e,t){var n=[],r=[],i=e.observableArray(r),s=this.peek();if("function"==typeof t&&(t={mapping:t}),t.mappingWithDisposeCallback){if(t.mapping||t.disposeItem)throw new Error("'mappingWithDisposeCallback' cannot be used in conjunction with 'mapping' or 'disposeItem'.")}else if(!t.mapping)throw new Error("Specify either 'mapping' or 'mappingWithDisposeCallback'.");for(var o=0;o<s.length;o++){var a=s[o],f=new u(e,a,o,r.length,t,n,i),l=f.mappedValueComputed.peek();n.push(f),f.isIncluded&&r.push(l)}var c=h(e,this,n,r,i,t),p=e.computed(i).extend({trackArrayChanges:!0}),d=p.dispose;return p.dispose=function(){c.dispose(),e.utils.arrayForEach(n,function(e){e.dispose()}),d.call(this,arguments)},v(e,p),p}function d(e,t){return p.call(this,e,function(e){return t(e)?e:g})}function v(e,t){return e.utils.extend(t,e[y]),t}function m(e){e.projections={_exclusionMarker:g},(function(e){function t(e,t){return function(){return t.apply(this,[e].concat(Array.prototype.slice.call(arguments,0)))}}e[y]={map:t(e,p),filter:t(e,d)}})(e),v(e,e.observableArray.fn)}var g={};u.prototype.dispose=function(){this.mappedValueComputed.dispose(),this.disposeResultFromMostRecentEvaluation()},u.prototype.disposeResultFromMostRecentEvaluation=function(){if(this.disposeFuncFromMostRecentMapping&&(this.disposeFuncFromMostRecentMapping(),this.disposeFuncFromMostRecentMapping=null),this.mappingOptions.disposeItem){var e=this.mappedValueComputed();this.mappingOptions.disposeItem(e)}},u.prototype.mappingEvaluator=function(){null!==this.isIncluded&&this.disposeResultFromMostRecentEvaluation();var e;if(this.mappingOptions.mapping)e=this.mappingOptions.mapping(this.inputItem,this.outputArrayIndex);else{if(!this.mappingOptions.mappingWithDisposeCallback)throw new Error("No mapping callback given.");var t=this.mappingOptions.mappingWithDisposeCallback(this.inputItem,this.outputArrayIndex);if(!("mappedValue"in t))throw new Error("Return value from mappingWithDisposeCallback should have a 'mappedItem' property.");e=t.mappedValue,this.disposeFuncFromMostRecentMapping=t.dispose}var n=e!==g;return this.isIncluded!==n&&(null!==this.isIncluded&&this.moveSubsequentItemsBecauseInclusionStateChanged(n),this.isIncluded=n),e},u.prototype.onMappingResultChanged=function(e){e!==this.previousMappedValue&&(this.isIncluded&&this.outputArray.splice(this.outputArrayIndex.peek(),1,e),this.suppressNotification||this.outputObservableArray.valueHasMutated(),this.previousMappedValue=e)},u.prototype.moveSubsequentItemsBecauseInclusionStateChanged=function(e){var t,n,r=this.outputArrayIndex.peek();if(e)for(this.outputArray.splice(r,0,null),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()+1);else for(this.outputArray.splice(r,1),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()-1)},u.prototype.setOutputArrayIndexSilently=function(e){this.suppressNotification=!0,this.outputArrayIndex(e),this.suppressNotification=!1};var y="_ko.projections.cache";(function(){if(void 0!==e.exports){var o=n(15);m(o),e.exports=o}else i=[n(15)],void 0!==(s="function"==typeof(r=m)?r.apply(t,i):r)&&(e.exports=s)})()})()},,function(e,t,n){"use strict";n.r(t);var r={};n.r(r);n.d(r,"ODB_LEFT_NAV",function(){return Re});n.d(r,"NEW_OFFICE_FILE",function(){return Ue});n.d(r,"ODC_PHOTOS_SEARCH",function(){return ze});n.d(r,"DOCSET_PROPERTIES_PANE",function(){return We});n.d(r,"PHOTO_LAYOUT",function(){return Ve});n.d(r,"ODC_MOBILE_APP_UPSELL",function(){return Je});n.d(r,"ODC_WEB_COMMENTS",function(){return Ke});n.d(r,"EXPIRING_SHARING_LINKS",function(){return Qe});n.d(r,"FLOW_REQUEST_SIGNOFF",function(){return Ge});n.d(r,"FLOW_REMIND_ME",function(){return Ye});n.d(r,"FLOW_ODB_COMMAND_BAR_COACHMARK",function(){return Ze});n.d(r,"RECENT_VIEW",function(){return tt});n.d(r,"LEFT_NAV_SITE_PINNING",function(){return nt});n.d(r,"GO_TO_SITE",function(){return rt});n.d(r,"ADD_TO_ONEDRIVE_COMMAND",function(){return it});n.d(r,"ADD_TO_ONEDRIVE_COMMAND_CFT",function(){return st});n.d(r,"PHOTO_EDIT",function(){return ot});n.d(r,"PDF_EDIT",function(){return ut});n.d(r,"LAUNCH_BUSINESS_APPS_SETUP_WIZARD_COMMAND",function(){return at});n.d(r,"METADATA_SEARCH_TEACHING_BUBBLE",function(){return ft});n.d(r,"CONTENT_QUERY_DISCOVERY_TEACHING_BUBBLE",function(){return lt});n.d(r,"CONTENT_QUERY_DISCOVERY_TEACHING_BUBBLE_SECONDARY",function(){return ct});n.d(r,"METADATA_SEARCH_QUERYABLE_FIELD",function(){return ht});n.d(r,"ADD_SMART_TEMPLATE",function(){return pt});n.d(r,"GENERATE_CAAE_DOCUMENT",function(){return dt});n.d(r,"MODERN_TEMPLATE_VIEW_INFO",function(){return vt});n.d(r,"USE_UNIVERSAL_ANNOTATION",function(){return mt});n.d(r,"TMR_EXPIRATION_DATE_EDIT",function(){return gt});n.d(r,"PHOTO_STORY",function(){return yt});n.d(r,"SHARE_TO_TEAMS",function(){return bt});n.d(r,"BACK_UP_YOUR_PC_FILES",function(){return wt});n.d(r,"SETUP_DOCUMENT_ANALYSIS_FLOW_COMMAND",function(){return Et});var i,s=n(0),o=n(1),u=n(87),a=n(265),f=n(303),l=n(29),c=n(102),h=n.n(c),p=n(378),d=n(132);(function(e){e[e.Valid=0]="Valid";e[e.Expiring=1]="Expiring";e[e.Locked=2]="Locked";e[e.Unlocked=3]="Unlocked";e[e.Extended=4]="Extended";e[e.Ended=5]="Ended"})(i||(i={}));var v,m=(function(){function e(e,t){var n=this;this.listeners=[];this.checkExpiration=function(){n.fetchExpirationTime().then(function(e){e?e-12e4<Date.now()?n.notifyExpiring():n.handleVaultExtended():n.notifyLocked()},function(){n.notifyExpiring()})};this.handleVaultLocked=function(){n.stopTimers();n.notifyLocked()};this.handleVaultUnlocked=function(){n.notifyUnlocked()};this.handleVaultExtended=function(){n.stopTimers();n.startTimers();n.notifyExtended()};this.handleStorageEvent=function(e){if(e.key===n.expirationTimeStorageKey){var t=e.newValue,r=e.oldValue;t?r?t>r&&n.handleVaultExtended():n.handleVaultUnlocked():n.handleVaultLocked()}};this.wacDataSource=t;this.storagePrefix="".concat(d.t).concat(e);this.expirationTimeStorageKey="".concat(this.storagePrefix).concat(p.STORAGE_KEY_EXPIRATION)}e.prototype.setup=function(){var e=this;this.addStorageEventListener();return this.syncExpirationTime().then(function(){e.startTimers()})};e.prototype.dispose=function(){this.removeStorageEventListener();this.stopTimers()};e.prototype.addEventListener=function(e){-1===this.listeners.findIndex(function(t){return t===e})&&this.listeners.push(e)};e.prototype.removeEventListener=function(e){var t=this.listeners.findIndex(function(t){return t===e});-1!==t&&this.listeners.splice(t)};e.prototype.extendVault=function(){var e=this;return this.wacDataSource.request("/drive/special/vault/action.unlockVault","POST",!0).then(function(){return e.syncExpirationTime()}).then(function(){return e.handleVaultExtended()}).catch(function(){e.handleVaultLocked()})};e.prototype.onUserActivity=function(){this.extendVault()};e.prototype.notify=function(e){for(var t=0,n=this.listeners;t<n.length;t++){(0,n[t])(e)}};e.prototype.notifyExpiring=function(){this.notify(i.Expiring)};e.prototype.notifyLocked=function(){this.notify(i.Locked)};e.prototype.notifyUnlocked=function(){this.notify(i.Unlocked)};e.prototype.notifyExtended=function(){this.notify(i.Extended)};e.prototype.syncExpirationTime=function(){var e=this;return this.fetchExpirationTime().then(function(t){t&&e.setExpirationTime(t)})};e.prototype.fetchExpirationTime=function(){return this.wacDataSource.request("/drive/special/vault","GET",!0).then(function(e){var t=e[0];if(t.vault.expirationInSeconds)return Date.now()+1e3*t.vault.expirationInSeconds})};e.prototype.getExpirationTime=function(){return Number(window.localStorage.getItem(this.expirationTimeStorageKey))};e.prototype.setExpirationTime=function(e){try{e&&window.localStorage.setItem(this.expirationTimeStorageKey,String(e))}catch(e){console.log(e)}};e.prototype.startTimers=function(){this.stopTimers();var e=this.getExpirationTime();if(e){var t=e-Date.now();this.expirationTimerId=window.setTimeout(this.checkExpiration,t-12e4);this.lockedTimerId=window.setTimeout(this.handleVaultLocked,t)}};e.prototype.stopTimers=function(){if(this.expirationTimerId){window.clearTimeout(this.expirationTimerId);this.expirationTimerId=void 0}if(this.lockedTimerId){window.clearTimeout(this.lockedTimerId);this.lockedTimerId=void 0}};e.prototype.addStorageEventListener=function(){window.addEventListener("storage",this.handleStorageEvent)};e.prototype.removeStorageEventListener=function(){window.removeEventListener("storage",this.handleStorageEvent)};return e})();(function(e){e[e.JSApiBootNotStart=0]="JSApiBootNotStart";e[e.JSApiBootStarted=1]="JSApiBootStarted";e[e.JSApiBootPendingComplete=2]="JSApiBootPendingComplete";e[e.JSApiBootSuccess=3]="JSApiBootSuccess";e[e.JSApiBootFailed=4]="JSApiBootFailed"})(v||(v={}));var g=(function(){function e(e,t,n){void 0===e&&(e="Unknown");void 0===n&&(n=v.JSApiBootNotStart);this.reset(e,t,n)}e.prototype.update=function(e){if(this.data&&e)for(var t in e)this.data[t]=e[t]};e.prototype.reset=function(e,t,n){void 0===e&&(e="Unknown");void 0===n&&(n=v.JSApiBootNotStart);this.data={bootState:n,entryPoint:e,userClickTime:t}};return e})(),y=n(18),b=n(307);function w(e,t){var n=new b.e,r=new y.e({name:"WacHost.JsApiScriptLoad"}),i=document.createElement("script");i.onload=function(){r.end({resultType:y.t.Success,resultCode:"JS API script Load Completed"});n.resolve(void 0)};i.onerror=function(){document.body.removeChild(i);r.end({resultType:y.t.Failure,resultCode:"JS API script Load Failure"});t({bootState:void 0,resultType:y.t.Failure,resultCode:"LoadFailed",errorInfo:"Failed to load JsApi"});n.reject(void 0)};i.onabort=function(){document.body.removeChild(i);r.end({resultType:y.t.Failure,resultCode:"JS API script Load Abort"});t({bootState:void 0,resultType:y.t.Failure,resultCode:"LoadFailed",errorInfo:"Failed to load JsApi Abort"});n.reject(void 0)};i.src=e;document.body.appendChild(i);return n.getPromise()}function E(e,t,n){try{return t.UseV2?(function(e,t,n){var r=new y.e({name:"WacHost.JsApiScriptBootstrap"}),i=S(t,n),s={host:{storageHostName:t.HostName,capabilities:t.capabilities},user:{id:t.UserId},bootstrapperUrl:t.BootstrapperUrl},o=Microsoft.Office[t.Application].createApplication(s),u={hostSessionId:t.HostSessionId},a=o.createSession(u),f={appUrl:t.ApplicationUrl,file:{name:t.FileName,getUrl:t.FileGetUrl,getUrlExpiry:t.FileGetUrlExpiry,size:t.FileSize,eTag:t.ETag,uniqueId:t.UniqueId},container:e,wopi:{source:t.WopiSrc,accessToken:t.AccessToken,expiry:t.AccessTokenExpiry},bootParams:{readOnly:t.ReadOnly,viewOnly:t.ViewOnly},ownerId:t.OwnerId,diagnostics:{entryPoint:n.entryPoint,userClickTime:n.userClickTime,hostPageNavigationStartTime:n.hostPageNavigationStartTime,hostPageFetchStartTime:n.hostPageFetchStartTime,hostPageResponseStartTime:n.responseStartTime,hostPageFirstFlushTime:n.hostPageFirstFlushTime,officeBootstrapperStartTime:n.officeBootstrapperStartTime,officeBootstrapperEndTime:n.officeBootstrapperEndTime,officeInitializationTime:n.officeInitializationTime,hostInitializeCallTime:n.hostInitializeCallTime,hostCompleteCallTime:void 0},sessionContext:t.SessionContext};return a.boot(f).then(function(e){var n;if(i){clearTimeout(i);i=null}if("success"===e.completion){r.end({resultType:y.t.Success,resultCode:"JS API script bootstrap success"});t.triggerLogEvent({bootState:v.JSApiBootSuccess,resultType:y.t.Success,resultCode:"Success"});var s=null===(n=a.diagnostics)||void 0===n?void 0:n.appInitDiagnostics,u={documentLoadedTime:null==s?void 0:s.documentLoadedTime,appCompletedTime:null==s?void 0:s.appCompletedTime};return{application:o,session:a,wacAppDiagnostics:u}}r.end({resultType:y.t.Failure,resultCode:"JS API script bootstrap not completed",extraData:{error:e.error,completion:e.completion}});t.triggerLogEvent({bootState:v.JSApiBootFailed,resultType:y.t.Failure,resultCode:"InitFailed",error:e.error});return Promise.reject(e.error)},function(e){if(i){clearTimeout(i);i=null}r.end({resultType:y.t.Failure,resultCode:"JS API script bootstrap failure",extraData:{error:e}});t.triggerLogEvent({bootState:v.JSApiBootFailed,resultType:y.t.Failure,resultCode:"InitFailed",error:e});return Promise.reject(e)})})(e,t,n):(function(e,t,n){var r=new b.e,i=new y.e({name:"WacHost.JsApiScriptBootstrap"}),s=S(t,n),o={BootstrapperUrl:t.BootstrapperUrl,Container:e,SessionInformation:{HostName:t.HostName,HostSessionId:t.HostSessionId,UserId:t.UserId,OwnerId:t.OwnerId,SessionContext:t.SessionContext,SupportsCustomAuthConfig:t.capabilities.customAuthConfig,SupportsCommonFilePicker:t.capabilities.commonFilePicker,SupportsMoveToFolder:t.capabilities.moveToFolder},ApplicationUrl:t.ApplicationUrl,WopiPrecheckInfo:{DocUniqueId:t.UniqueId,ETag:t.ETag,FileName:t.FileName,FileGetUrl:t.FileGetUrl,FileGetUrlExpiry:t.FileGetUrlExpiry,FileSize:t.FileSize,ReadOnly:t.ReadOnly,ViewOnly:t.ViewOnly},WopiInfo:{WopiSrc:t.WopiSrc,AccessToken:t.AccessToken,AccessTokenExpiry:new Date(t.AccessTokenExpiry)},ApplicationCustomSettings:{UnifiedAppEnabled:t.AppEnabled},Diagnostics:{entryPoint:n.entryPoint,userClickTime:n.userClickTime,hostPageNavigationStartTime:n.hostPageNavigationStartTime,hostPageFetchStartTime:n.hostPageFetchStartTime,hostPageResponseStartTime:n.responseStartTime,hostPageFirstFlushTime:n.hostPageFirstFlushTime,officeBootstrapperStartTime:n.officeBootstrapperStartTime,officeBootstrapperEndTime:n.officeBootstrapperEndTime,officeInitializationTime:n.officeInitializationTime,hostInitializeCallTime:n.hostInitializeCallTime,hostCompleteCallTime:void 0},FnOnInitializeSuccess:function(e,n){if(s){clearTimeout(s);s=null}i.end({resultType:y.t.Success,resultCode:"JS API script bootstrap success"});t.triggerLogEvent({bootState:v.JSApiBootSuccess,resultType:y.t.Success,resultCode:"Success"});var o={documentLoadedTime:null==n?void 0:n.documentLoadedTime,appCompletedTime:null==n?void 0:n.appCompletedTime};r.resolve({application:u,wacAppDiagnostics:o})},FnOnInitializeFailure:function(e){if(s){clearTimeout(s);s=null}i.end({resultType:y.t.Failure,resultCode:"JS API script bootstrap failure"});t.triggerLogEvent({bootState:v.JSApiBootFailed,resultType:y.t.Failure,resultCode:"InitFailed",error:e});r.reject(void 0)},FnOnAppModeSwitched:function(e){t.onModeSwitched({NewMode:e})},FnIsFeatureEnabled:t.capabilities.isFeatureEnabled},u=Microsoft.Office[t.Application].Application.InitializeWopiPending(o);o.Diagnostics.hostCompleteCallTime=Date.now();u.Complete(o.WopiInfo);return r.getPromise()})(e,t,n)}catch(e){var r=(null==e?void 0:e.message)||"Error during JsApi initialize.";t.triggerLogEvent({bootState:v.JSApiBootFailed,resultType:y.t.Failure,resultCode:"BootException",errorInfo:r})}}function S(e,t){var n=setTimeout(function(){n=null;new y.e({name:"WacHost.JsApiScriptBootstrap",startTimeOverride:t.officeInitializationTime}).end({resultType:y.t.Failure,resultCode:"JS API script bootstrap timeout"});t.bootState===v.JSApiBootPendingComplete&&e.triggerLogEvent({bootState:v.JSApiBootFailed,resultType:"visible"===document.visibilityState?y.t.Failure:y.t.ExpectedFailure,resultCode:"Timeout",errorInfo:"Timeout"})},15e4);return n}var x=n(96),T=n(36),N=(function(){function e(){this.sources=[];this.handlers={}}e.prototype.attach=function(e){var t=this;Object(T.e)("MessageDispatcher: attached source ",e);-1===this.sources.findIndex(function(t){return e===t})&&this.sources.push(e);return function(){t.deattach(e)}};e.prototype.deattach=function(e){Object(T.e)("MessageDispatcher: deattached source ",e);var t=this.sources.findIndex(function(t){return e===t});-1!==t&&this.sources.splice(t,1)};e.prototype.dispatch=function(e,t){return Object(s.t)(this,void 0,void 0,function(){var n,r,i,o;return Object(s.i)(this,function(s){switch(s.label){case 0:Object(T.e)("MessageDispatcher dispatch message: ",e,t);s.label=1;case 1:s.trys.push([1,8,,9]);if(!(n=this.handlers[e]))return[3,6];Object(T.e)("MessageDispatcher handle event: ",e,t);if(!(r=n(t)))return[3,5];i=void 0;return x.t.isPromise(r)?[4,r]:[3,3];case 2:i=s.sent();return[3,4];case 3:i=r;s.label=4;case 4:Object(T.e)("MessageDispatcher receive response: ",e,i);return[2,i];case 5:return[3,7];case 6:Object(T.e)("MessageDispatcher ignore event: ",e,t);s.label=7;case 7:return[3,9];case 8:o=s.sent();Object(T.e)("MessageDispatcher unhandled error: ",o);throw o;case 9:return[2]}})})};e.prototype.respond=function(e){for(var t=0,n=this.sources;t<n.length;t++){n[t].receive(e)}};e.prototype.addEventListener=function(e,t){Object(T.e)("MessageDispatcher add event handler: ",e);this.handlers[e]=t};e.prototype.removeEventListener=function(e,t){Object(T.e)("MessageDispatcher remove event handler: ",e);this.handlers[e]=void 0};e.prototype.dispose=function(){this.sources=[];this.handlers={}};return e})(),C=n(19),k=n(455),L=n(362),A=n(48),O=n(138),M=n(7),_=(function(){function e(e,t,n){this._apiUrlBase=e;this._identityDataSource=t;this._badgerToken=n}e.prototype.getItem=function(e,t,n,r,i,s,o){var u,a=this;void 0===o&&(o=!0);u=r?"/drives/"+encodeURIComponent(e)+"/items/root:/".concat(r):"/drives/"+encodeURIComponent(e)+"/items/".concat(t);u+="?action=".concat(n,"&$select=*,openWith,webDavUrl");var f=(null==i?void 0:i.wd)||(null==s?void 0:s.getQueryParameter("wd"));f&&(u+="&wd=".concat(f));var l=(null==i?void 0:i.wdorigin)||(null==i?void 0:i.wdOrigin)||(null==s?void 0:s.getQueryParameter("wdorigin"))||(null==s?void 0:s.getQueryParameter("wdOrigin"));l&&(u+="&wdorigin=".concat(l));return this.request(u,"GET",o).then(function(e){var t=e[0];return a._buildOneDriveItemFromResponse(t)},function(e){var t=e[0];Object(T.e)("Error: cannot get item info from vroom call: ",t);return null})};e.prototype.getWopiInfoWithItemId=function(e,t){var n="/items/".concat(e,"/driveItem?$select=openWith");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,r=t.webDavUrl,i=t.id,s=t.parentReference;return n&&n.wac?{driveId:s.driveId,itemId:i,webDavUrl:r,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:x.t.reject({driveId:null==s?void 0:s.driveId,itemId:i,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],r=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return x.t.reject({error:{Id:r,Details:i}})})};e.prototype.getWopiInfoWithUrl=function(e,t){var n="/shares/".concat(e,"/driveItem?$select=openWith,parentReference,id");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,r=t.webDavUrl,i=t.id,s=t.parentReference;return n&&n.wac?{driveId:s.driveId,itemId:i,webDavUrl:r,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:x.t.reject({driveId:null==s?void 0:s.driveId,itemId:i,webDavUrl:r,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],r=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return x.t.reject({error:{Id:r,Details:i}})})};e.prototype.getWopiDavURLWithDriveIdItemId=function(e,t,n){var r="/drives/".concat(e,"/items/").concat(t,"?$select=openWith,webDavUrl");return this.request(r,"GET",n).then(function(n){var r=n[0],i=r.openWith,s=r.webDavUrl;return i&&i.wac?{driveId:e,itemId:t,webDavUrl:s,accessToken:i.wac.accessToken,accessTokenExpiry:i.wac.accessTokenExpiry,wopiSrc:i.wac.wopiSrc}:x.t.reject({driveId:e,itemId:t,webDavUrl:s,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],r=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return x.t.reject({error:{Id:r,Details:i}})})};e.prototype.request=function(e,t,n){var r=this;void 0===t&&(t="POST");void 0===n&&(n=!1);return this.createHeaders(n).then(function(n){return new x.t(function(i,o){return Object(s.t)(r,void 0,void 0,function(){var r,u;return Object(s.i)(this,function(s){switch(s.label){case 0:return[4,fetch("".concat(this._apiUrlBase).concat(e),{method:t,headers:n})];case 1:return[4,(r=s.sent()).json()];case 2:u=s.sent();r.ok?i([u,r]):o([null==u?void 0:u.error,r]);return[2]}})})})})};e.prototype.createHeaders=function(e){var t={Accept:"application/json"};e&&(t.Prefer="Include-Feature=Vault");if(this._badgerToken){t.Authorization="Badger ".concat(this._badgerToken.token);return x.t.resolve(t)}return this._identityDataSource.getSessionToken().then(function(e){t.Authorization="Bearer ".concat(e.accessToken);return t})};e.prototype._buildOneDriveItemFromResponse=function(e){var t,n;if(!e){Object(T.e)("Error: the item info is null");return null}var r=e.id,i=e.name,s=e.folder,o=e.thumbnails,u=e.size,a=e.description,f=e.root,l=e.eTag,c=e.parentReference,h=c&&c.driveId,p={key:Object(M.v)((t={},t.id=r,t.driveId=h,t))},d=c.id?Object(M.v)(((n={}).id=c.id,n.driveId=h,n)):void 0;p.parentKey=d;p.sharingRole=this._getSharingRole(e);var v=(s?{extension:""}:k.t(i)).extension;p.itemId=r;var m=c&&c.driveType;p.graph={itemId:r,driveId:h,driveType:m};var g=f?L.e:i;p.name=i;p.displayName=g;p.extension=v;p.size=u;p.caption=a||"";p.ownerId=h;p.isRootFolder=!!f;p.eTag=l;if(s){var y=s.childCount;p.folder={childCount:y};if(o&&o.length>0){p.folder.covers=[];for(var b=0,w=o;b<w.length;b++){var E=w[b];p.folder.covers.push(E.large)}}p.childCount=y}p.vault=e.vault;p.itemFromServer=e;return p};e.prototype._getSharingRole=function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,r=Object(O.e)(n||[],function(){return!0});return r.owner?A.e.Owner:r.write?A.e.Edit:r.read?A.e.View:A.e.None}return A.e.Owner};return e})(),D=n(9),P=n(135),H=n(538),B=n(160),j=n(380),F=n(527),I=n(381);function q(e){var t=e.vault,n=e.dispatcher,r=Object(o.useState)(i.Valid),s=r[0],u=r[1];Object(o.useEffect)(function(){if(t){t.setup();t.addEventListener(u);return function(){t.dispose();t.removeEventListener(u)}}},[t,u]);var a=null;switch(s){case i.Expiring:a=o.createElement(R,{onExtend:function(){t.extendVault();n.respond(Object(C.r)())},onClose:function(){window.location.href="/"},onLayerDidMount:function(){n.respond(Object(C.n)())},onDismiss:function(){window.location.href="/"}});break;case i.Locked:a=o.createElement(U,{onUnlock:function(){window.location.reload()},onClose:function(){window.location.href="/"},onLayerDidMount:function(){n.respond(Object(C.n)())},onDismiss:function(){window.location.href="/"}});break;case i.Unlocked:window.location.reload();break;case i.Extended:a=null}return o.createElement("div",null,a)}function R(e){var t=e.onExtend,n=e.onClose,r=e.onLayerDidMount,i=e.onDismiss;return o.createElement(z,{title:P.r,subText:P.e,onOk:t,okText:P.n,onCancel:n,cancelText:P.t,onLayerDidMount:r,onDismiss:i})}function U(e){var t=e.onUnlock,n=e.onClose,r=e.onLayerDidMount,i=e.onDismiss;return o.createElement(z,{title:P.o,subText:P.i,onOk:t,okText:P.u,onCancel:n,cancelText:P.s,onLayerDidMount:r,onDismiss:i})}function z(e){var t=e.title,n=e.subText,r=e.okText,i=e.onOk,s=e.cancelText,u=e.onCancel,a=e.onLayerDidMount,f=e.onDismiss;return o.createElement(H.e,{minWidth:480,hidden:!1,type:B.e.normal,modalProps:{isOpen:!0,isBlocking:!0,layerProps:{onLayerDidMount:a}},onDismiss:f,dialogContentProps:{title:t,subText:n}},o.createElement(j.e,null,r?o.createElement(F.e,{onClick:i,text:r}):null,s?o.createElement(I.e,{onClick:u,text:s}):null))}var W=n(4),X=new W.n({owner:"OneDriveRoot",useFactoriesOnKeys:!0}),V=(n(402),n(56)),$=n(143),J=n(24),K=n(64),Q=n(242),G=n(21),Y=n(168),Z=n(98),ee=n(315),te=n(8),ne=n(469),re=(function(e){Object(s.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getItem=function(t){var n,r=this._urlDataSource.getKeyParams(t.parentKey),i=this._urlDataSource.getQueryType(r);t.qosName=t.qosName||"Odc.".concat(te.e[i],".ItemDataSource.getItem");switch(i){case te.e.SharedWithMe:n=this._getSharedDataSource().then(function(e){return e.getItem(t)});break;case te.e.Recent:n=this._getRecentDataSource().then(function(e){return e.getItem(t)});break;case te.e.RecycleBin:n=this._getRecycleBinDataSource().then(function(e){return e.getItem(t)});break;case te.e.Search:n=this._getSearchDataSource().then(function(e){return e.getItem(t)});break;default:n=e.prototype.getItem.call(this,t)}return n};t.prototype._getRecentDataSource=function(){var e=this,t=x.t.resolve(n.ee([43],703)).then(ne.e).then(function(t){return new(e.managed(t))});this._getRecentDataSource=function(){return t};return t};t.prototype._getSearchDataSource=function(){var e=this,t=x.t.resolve(n.ee([45,"ondemand.resx-ondemand"],704)).then(ne.e).then(function(t){return new(e.managed(t))});this._getSearchDataSource=function(){return t};return t};t.prototype._getRecycleBinDataSource=function(){var e=this,t=x.t.resolve(n.ee([44],705)).then(ne.e).then(function(t){return new(e.managed(t))});this._getRecycleBinDataSource=function(){return t};return t};t.prototype._getSharedDataSource=function(){var e=this,t=x.t.resolve(n.ee([46],706)).then(ne.e).then(function(t){return new(e.managed(t))});this._getSharedDataSource=function(){return t};return t};return t})(ee.e),ie=n(23),se=n(241),oe=(function(e){Object(s.r)(t,e);function t(t){return e.call(this,t)||this}t.prototype.getThumbnails=function(e,t,n){void 0===n&&(n=null);var r=t.map(ue).join(",");return this.resources.consume(se.e).send({apiName:"thumbnails",path:"/drives/".concat(e.driveId,"/items/").concat(e.itemId,"/thumbnails?select=").concat(r).concat(n?"&authkey=".concat(n):""),needsAuthorization:!n})};t.prototype.getThumbnailForLargestDimension=function(e,t,n){return n?this.getThumbnailForSize(e,t,999999):this.getThumbnailForSize(e,999999,t)};t.prototype.getThumbnailForSize=function(e,t,n){var r="c".concat(t,"x").concat(n);return e.value[0][r]};return t})(ie.t);function ue(e){return"c".concat(e.width||999999,"x").concat(e.height||999999)}var ae=n(86),fe=n(118),le=n(12),ce=n(164),he=n(22),pe=n(68),de=n(207),ve=n(104),me=n(5),ge=n(123),ye=n(2),be=n(28),we=n(151),Ee=n(167),Se={pageContext:Ee.e},xe=new W.t({name:"spartanSharedWithMeExperiment",factory:{dependencies:Se,create:function(e){return{instance:Object(ge.t)(90050,e.pageContext)}}}}),Te=n(301),Ne=n(177),Ce={pageContext:Ee.e};var ke=new W.t({name:"isSpartanSharedWithMeSupported",factory:{dependencies:Ce,create:function(e){return{instance:function(){return t=e.pageContext,n=t&&(t.isExternalGuestUser||t.isAnonymousGuestUser),!(!t||n||Object(Te.t)(t.env2)||Object(Te.e)(t.env2)||Object(Ne.e)()||!t.isMySiteOwner);var t,n}}}}}),Le={pageContext:Ee.e},Ae={isSpartanSharedWithMeSupported:ke,spartanSharedWithMeExperiment:xe,newSpartanSharedWithMeExperiment:new W.t({name:"newSpartanSharedWithMeExperiment",factory:{dependencies:Le,create:function(e){return{instance:Object(ge.t)(90168,e.pageContext)}}}})},Oe=function(e){var t=e.isSpartanSharedWithMeSupported,n=e.spartanSharedWithMeExperiment,r=e.newSpartanSharedWithMeExperiment,i=t()&&(Object(we.e)(be.t)||!!n.variantToDisplay||!!r.variantToDisplay);Oe=function(){return i};return i};new W.t({name:"isSpartanSharedWithMeEnabled",factory:{dependencies:Ae,create:function(e){return{instance:function(){return Oe(e)}}}}});var Me=function(e,t){var n=window._spPageContextInfo;return n&&!(!Object(ye.te)(t)||!Object(ge.n)(e,n))},_e=n(202),De=n(375),Pe=n(171),He=n(221);var Be=n(264);var je,Fe=n(42),Ie=n(546),qe=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([49,"ondemand.resx-ondemand"],732)];case 1:return[2,e.sent().PsOnboardingTeachingBubbleContent]}})})}),Re={campaignGuid:"49FEA7F9-6B31-4C2C-95EC-A9246E51D22C",startDate:new Date(2014,8,29),endDate:new Date(2016,4,1),title:he.j,bodyCopy:he.B,flag:me.B,colorVariation:pe.e.themePrimary},Ue={campaignGuid:"1c2b5f74-1c33-4297-8199-97c78c2284c2",bodyCopy:he.l,flag:me.j,colorVariation:pe.e.themePrimary,isDismissable:!0,isCoachmark:!0},ze={campaignGuid:"D3F55EC7-C130-456E-8F27-2EA31F2D5B8D",startDate:new Date(2016,2,23),endDate:new Date(2019,2,23),bodyCopy:he.R,flag:me.I,colorVariation:pe.e.themePrimary},We={campaignGuid:"DB44A538-E6D0-4AC6-B735-3D77161E6E83",killSwitchGuid:"714AF444-CE4B-4A21-AFB9-71CAA861CC3D",title:he.h,bodyCopy:he.c,colorVariation:pe.e.themePrimary,flag:me.r,alignment:ve.e.Left,isCoachmark:!0,isDismissable:!0,name:"DOCSET_PROPERTIES_PANE"},Xe=new ce.e(100,de.e/2+4),Ve={campaignGuid:"C847EA02-D118-4C3E-A73E-8B2C5D9944DA",bodyCopy:he.q,flag:me.j,colorVariation:pe.e.themePrimary,alignment:ve.e.Right,offset:Xe},$e=new ce.e(de.e/2+4,0),Je={campaignGuid:"523F0995-B7E2-4612-BEA5-A7EF9F949C64",title:he.M,bodyCopy:he.O,flag:me.a,alignment:ve.e.Left,offset:$e},Ke={campaignGuid:"FE1795D2-BC90-4CB0-9E1E-043738D734C8",teachingBubbleContentAs:function(e){var t=Object(Y.t)(),n=t.consume(Pe.e),r=t.consume(De.e),i=e.defaultRender,u=e.onDismiss,a=Object(s.s)(e,["defaultRender","onDismiss"]),f=Object(_e.e)(function(e){r.isPending=!0;var i=new(t.injected(n.ShowPropertiesAction))({useToggleBehavior:!1});i.execute(e);i.dispose();u(e)}),l=Object(_e.e)(function(e){r.isPending=!0;u(e)});if(u)return i?o.createElement(i,Object(s.e)({},a,{headline:He.t,hasCondensedHeadline:!1,onDismiss:u,primaryButtonProps:{text:He.n,onClick:f},secondaryButtonProps:{text:He.r,onClick:l}}),He.e):void 0},isDismissable:!0,flag:me.O,experimentData:Object(me.ne)(me.A)?void 0:{name:"AtMentionTeachingUIExperiment",startDate:"8/24/2021"},aaToABExperimentFlight:me.M,directionalHint:Fe.e.bottomAutoEdge,persistentBeak:!0},Qe={campaignGuid:"A4776EC9-2059-4971-AB9C-4003C3C7B3D8",title:he.d,bodyCopy:he.p,colorVariation:pe.e.themePrimary,flag:me.j,alignment:ve.e.Left,maxUserViewCount:1,isPremiumFeature:!0},Ge={campaignGuid:"A41001BA-6205-4730-A670-C89DD0D8451F",killSwitchGuid:"0EC0ED2B-06D2-4375-91E6-3CFF7E48B37D",experimentData:{name:"flowRequestSignOffCoachmarkExperiment2",startDate:"01/22/2019"},flag:me.k,maxUserViewCount:1,title:he.S,isCoachmark:!0,isDismissable:!0,bodyCopy:he.E,automateExperimentBodyCopy:he.u,name:"FLOW_REQUEST_SIGNOFF"},Ye={campaignGuid:"87802041-45CB-4304-BFD1-E2E98E3CB31B",killSwitchGuid:"98802041-45CB-4304-BFD1-E2E98E3CB31C",compatibleCampaign:Ge,experimentData:{name:Object(me.ne)(me.K)?"flowRemindMeCoachmarkExperiment":"".concat("flowRemindMeCoachmarkExperiment").concat(2),startDate:Object(me.ne)(me.K)?"10/17/2018":"01/22/2019"},flag:me.C,maxUserViewCount:1,title:he.w,isCoachmark:!0,isDismissable:!0,bodyCopy:he.b,automateExperimentBodyCopy:he.o,name:"FLOW_REMIND_ME"},Ze={campaignGuid:"FD86A6D7-F3D9-47EC-994C-D01AAB624F28",killSwitchGuid:"B35D963C-9FFD-4154-9A9B-E112B67E5BCA",experimentData:{name:Object(me.ne)(me.K)?"flowOdbCommandBarCoachmarkExperiment":"".concat("flowOdbCommandBarCoachmarkExperiment").concat(2),startDate:Object(me.ne)(me.K)?"10/17/2018":"01/22/2019"},flag:me.N,maxUserViewCount:1,title:he.y,isCoachmark:!0,isDismissable:!0,bodyCopy:he.g,automateExperimentBodyCopy:he.s,name:"FLOW_ODB_COMMAND_BAR_COACHMARK"},et=new ce.e(0,-40),tt={campaignGuid:"696ee2ba-076d-400c-ae9a-0b28e71f567b",title:he.z,bodyCopy:he.U,colorVariation:pe.e.themePrimary,flag:me.j,alignment:ve.e.Left,offset:et},nt={campaignGuid:"108dfc30-090d-4ab7-8575-372a28d7ee3a",title:he.A,bodyCopy:he.L,colorVariation:pe.e.themePrimary,flag:me._,alignment:ve.e.Left},rt={campaignGuid:"976ef592-f66a-4d08-b837-ba3f9cda70fb",title:he.k,bodyCopy:he.C,colorVariation:pe.e.themePrimary,flag:me.j,alignment:ve.e.Left},it={campaignGuid:"94a29c48-ae93-44cc-94fa-bb106da7bb2d",flag:me.j,title:he.i,isCoachmark:!0,illustrationImage:{src:"".concat(window.require.toUrl("odsp-media/images/addtoonedrive/add2od_1x.gif")),alt:he.i,height:200},coachMarkStyles:function(e){var t=e.isCollapsed;return{entityHost:t&&{backgroundColor:"#0078D4"},childrenContainer:{selectors:{".ms-TeachingBubble-subText":{color:"#FFFFFF"},".ms-TeachingBubble-headline":{color:"#FFFFFF"},".ms-TeachingBubble-closebutton":{color:"#FFFFFF",selectors:{":hover":{color:"#FFFFFF"}}}}},rotateAnimationLayer:{selectors:{svg:{fill:t?"#0078D4":"#7BDCEE"}}}}},teachingBubbleStyles:{closeButton:{color:"#0078D4"}},isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,disableCondensedHeadline:!0,bodyCopy:he.r,name:"ADD_TO_ONEDRIVE_COMMAND"},st=Object(s.e)(Object(s.e)({},it),{campaignGuid:"dcd7409f-bd4d-4b95-aeb4-f1156656b0ab",name:"ADD_TO_ONEDRIVE_COMMAND_CFT"}),ot={campaignGuid:"ac1f12bf-bc9e-41f9-84e9-49351392a052",title:he.I,bodyCopy:he.F,flag:me.o,directionalHint:Fe.e.bottomAutoEdge,colorVariation:pe.e.themePrimary,alignment:ve.e.Right,offset:Xe,isCoachmark:!0,persistentBeak:!0,isDismissable:!0},ut={campaignGuid:"3aead293-1016-42fe-9e98-182280ae809c",flag:me.u,colorVariation:pe.e.themePrimary,directionalHint:Fe.e.bottomAutoEdge,isCoachmark:!0,persistentBeak:!0,isDismissable:!0,teachingBubbleContentAs:function(e){var t=e.defaultRender,n=e.onDismiss,r=Object(s.s)(e,["defaultRender","onDismiss"]),i=Object(_e.e)(function(e){n(e)});return t?o.createElement(t,Object(s.e)({},r,{headline:Be.t,primaryButtonProps:{text:Be.n,onClick:i},onDismiss:n}),Be.e):void 0},name:"PDF_EDIT"},at={campaignGuid:"8c5ffbba-577b-4a30-86bf-d93c02942877",flag:me.j,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:he.v,bodyCopy:he.m,name:"LAUNCH_BUSINESS_APPS_SETUP_WIZARD_COMMAND",defaultFact:{d:!1,v:0}},ft={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:me.j},lt={campaignGuid:"dcdd7a79-f0a6-4b88-94e2-a76178bd5eee",flag:me.j},ct={campaignGuid:"c75fc458-8c94-4e75-91c9-6be5e94cf2e4",flag:me.j},ht={campaignGuid:"6f376cef-52b4-4abc-b6e9-aca8686e5220",flag:me.j},pt={campaignGuid:"b23b2ba7-87e7-44f1-a635-bf05c7fcde4e",flag:me.j,title:he.n,bodyCopy:he.e,primaryButtonText:he.t,isDismissable:!0,maxUserViewCount:5,name:"ADD_SMART_TEMPLATE"},dt={campaignGuid:"c8896a46-5b51-474d-8b52-f7a9629c1751",flag:me.j,title:he.N,bodyCopy:he.x,primaryButtonText:he.T,isDismissable:!0,maxUserViewCount:5,name:"GENERATE_CAAE_DOCUMENT"},vt={campaignGuid:"f3d86546-dd2d-47aa-a3e8-9f1ce1afda52",flag:me.j,title:he.P,bodyCopy:he._,primaryButtonText:he.D,isDismissable:!0,maxUserViewCount:5,name:"MODERN_TEMPLATE_VIEW_INFO"},mt={campaignGuid:"447eb215-1e48-45cd-8644-8c83c604d4c1",bodyCopy:he.Y,colorVariation:pe.e.themePrimary,flag:me.i,directionalHint:Fe.e.bottomRightEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,maxUserViewCount:5,name:"USE_UNIVERSAL_ANNOTATION"},gt={campaignGuid:Object(me.ne)(me.g)?"5ee0205b-23b6-4867-a5ce-7fff50bb50b2":"bbc4c8cc-da34-424a-92ab-43ae518c1c7b",title:he.G,bodyCopy:he.Q,colorVariation:pe.e.themePrimary,flag:me.f,directionalHint:Fe.e.bottomRightEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,maxUserViewCount:Object(me.ne)(me.g)?1e3:1,name:"TMR_EXPIRATION_DATE_EDIT"},yt={campaignGuid:"65fe39bb-0669-4b21-a67d-a30c4ce3b959",flag:me.j,directionalHint:Fe.e.rightCenter,isCoachmark:!1,isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,teachingBubbleContentAs:qe,name:"PHOTO_STORY"},bt={campaignGuid:"59b0a6bb-d54c-48cc-a13e-8df743f6ffa3",killSwitchGuid:"8e80b4eb-f274-48fa-befa-3fca46573a91",title:he.K,bodyCopy:he.J,primaryButtonText:he.$,secondaryButtonText:he.H,colorVariation:pe.e.themePrimary,experimentId:90022,flag:me.U,alignment:ve.e.Left,isCoachmark:!0,isDismissable:!0,name:"SHARE_TO_TEAMS"},wt={campaignGuid:"4c0cab92-8ab5-426e-ad64-860c49ec2a8a",title:he.f,bodyCopy:he.a,colorVariation:pe.e.themePrimary,flag:me.j,alignment:ve.e.Left,isCoachmark:!0,directionalHint:Fe.e.rightBottomEdge,isDismissable:!0,persistentBeak:!0},Et={campaignGuid:"21432b3b-ab4f-4a12-a4fa-f25b4de9cfef",flag:me.j,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:he.V,bodyCopy:he.W,primaryButtonText:he.X,maxUserViewCount:5,name:"SETUP_DOCUMENT_ANALYSIS_FLOW_COMMAND",defaultFact:{d:!1,v:0}},St={ODC:"DisableTeachingBubbleForTABTest"},xt={ODB:-834},Tt=n(6),Nt=n(128),Ct=n(75),kt=n(31),Lt=n(323),At=n(183),Ot=(function(){function e(e,t){void 0===e&&(e={});this._dataStore=new Ct.e("TeachingBubbleProvider",kt.e.session);this._identityDataSource=t.identityDataSource;this._userInfoProvider=t.userInfoProvider;this._navigation=t.navigation;this.currentBubble=new At.e(void 0);this._bubbles=[];this._navigation.viewParams.resetAllBubbles&&this._resetAllBubbles();var n=this._navigation.viewParams.resetBubbleByGuid;n&&this._resetBubbleByGuid(n)}e.prototype.showNextBubble=function(){var e=this.getNextBubble();this.clearCurrentBubble();for(;e&&this.hasBubbleBeenSeenThisSession(e.campaign);)e=this.getNextBubble();e&&this._setCurrentBubble(e)};e.prototype.getNextBubble=function(){return this._bubbles.pop()};e.prototype.clearCurrentBubble=function(){this.currentBubble&&this.currentBubble.set(null)};e.prototype.addBubble=function(e){var t=this,n=e.bubble;return n?this.shouldBubbleBeAdded(n,!1).then(function(n){if(n){t._addBubbleToQueue(e);return!0}return!1}):x.t.wrap(!1)};e.prototype.shouldBubbleBeAdded=function(e,t,n,r,i){var s=this;void 0===i&&(i=!0);if(Object(me.ne)(St)||Object(me.ne)(xt))return x.t.wrap(!1);if(r){var o=this._checkShouldBubbleBeAdded(e,t,r);return x.t.wrap(o)}return this._userInfoProvider.getBubbleUserFact(e,n,i).then(function(n){return s._checkShouldBubbleBeAdded(e,t,n)})};e.prototype.markBubbleAsDismissed=function(e){var t=this;return this._userInfoProvider.getBubbleUserFact(e).then(function(n){n.d=!0;var r=t._userInfoProvider.setBubbleUserFact(e,n);t.markBubbleAsSeen(e);Nt.e.logData({name:"TeachingBubble.Dismissed",extraData:{campaignGuid:e.campaignGuid}});t.showNextBubble();return r})};e.prototype.markBubbleAsSeen=function(e){var t=this;this.markBubbleAsSeenThisSession(e);return this._userInfoProvider.getBubbleUserFact(e).then(function(n){n.v++;Nt.e.logData({name:"TeachingBubble.Seen",extraData:{campaignGuid:e.campaignGuid}});return t._userInfoProvider.setBubbleUserFact(e,n)})};e.prototype.hasBubbleBeenSeen=function(e){return this._userInfoProvider.getBubbleUserFact(e).then(function(e){return e.v>0})};e.prototype.hasBubbleBeenSeenToday=function(e){var t=this._dataStore.getValue(this.getTeachingBubbleCampaignSessionSeenTimeKey(e),kt.e.local);return!!t&&(t-(new Date).getTime())/864e5<1};e.prototype.markBubbleAsSeenThisSession=function(e){this._dataStore.setValue(this.getTeachingBubbleCampaignSessionSeenKey(e),!0);this._dataStore.setValue(this.getTeachingBubbleCampaignSessionSeenTimeKey(e),(new Date).getTime(),kt.e.local)};e.prototype.hasBubbleBeenSeenThisSession=function(e){return this._dataStore.getValue(this.getTeachingBubbleCampaignSessionSeenKey(e))};e.prototype.getTeachingBubbleCampaignSessionSeenKey=function(e){return"Seen"+e.campaignGuid};e.prototype.getTeachingBubbleCampaignSessionSeenTimeKey=function(e){return"SeenTime"+e.campaignGuid};e.prototype._checkShouldBubbleBeAdded=function(e,t,n){var r=!this._identityDataSource||this._identityDataSource.getIdentity().type!==fe.e.anonymous,i=e.maxUserViewCount||de.t,s=Object(me.ne)(me.y)||t,o=Object(me.ne)(e.flag)||!(!e.experimentId||!Me(e.experimentId,e.flag)),u=!e.killSwitchGuid||!Tt.e.isActivated(e.killSwitchGuid);return s&&r&&n&&o&&u&&!this.hasBubbleBeenSeenThisSession(e)&&this._isExperimentEnabled(e)&&!n.d&&n.v<i};e.prototype._isExperimentForceEnabled=function(e){if(!e)return!1;var t=e.getExperimentData();return t&&t.name&&!!this._navigation.viewParams[t.name]};e.prototype._isExperimentEnabled=function(e){if(!e.experimentData)return!0;var t=this._getExperiment(e);return!t||(this._isExperimentForceEnabled(t)||t.IsExperimentOn())};e.prototype._getExperiment=function(t){if(t.experimentData&&t.experimentData.name){var n=t.experimentData.name;e.experiments[n]||(e.experiments[n]=new Lt.e(t.experimentData,t.aaToABExperimentFlight));return e.experiments[n]}};e.prototype._resetBubbleCampaignUserFact=function(e){this._userInfoProvider.setBubbleUserFact(e,{d:!1,v:0})};e.prototype._resetCampaignSeenSessionStorage=function(e){this._dataStore.remove(this.getTeachingBubbleCampaignSessionSeenKey(e))};e.prototype._resetAllBubbles=function(){var e=this;this._iterateThroughBubbles(function(t){e._resetBubbleCampaignUserFact(t);e._resetCampaignSeenSessionStorage(t)})};e.prototype._resetBubbleByGuid=function(e){var t=this;this._iterateThroughBubbles(function(n){if(n.campaignGuid===e){t._resetBubbleCampaignUserFact(n);t._resetCampaignSeenSessionStorage(n)}})};e.prototype._iterateThroughBubbles=function(e){for(var t in r)r[t].campaignGuid&&e(r[t])};e.prototype._setCurrentBubble=function(e){this.currentBubble.set(e)};e.prototype._addBubbleToQueue=function(e){var t=e.bubble,n=e.element;this._bubbles.unshift({campaign:t,anchorElement:n});this.currentBubble.get()||this.showNextBubble()};e.dependencies={identityDataSource:J.i.optional,userInfoProvider:Z.u,navigation:V.e};e.experiments={};return e})(),Mt=Object($.i)("TeachingBubbleProvider",Ot),_t=new W.t({name:"FloodgateDataSource.key",loader:new $.t(function(){return n.ee([25,"ondemand.resx-ondemand"],717).then(function(e){return e.resourceKey})})}),Dt=n(20),Pt=(function(){function e(e,t){this._navigation=t.navigation;this._mayBeFastOneUp=!!Object(ye.te)(ye.b)&&!!this.getFocusItemKey(this._navigation.viewParams);this._isFastOneUp=this._mayBeFastOneUp}e.prototype.checkIsFastOneUp=function(){return this._isFastOneUp};e.prototype.resetIsFastOneUp=function(){this._isFastOneUp=!1};e.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(M.o)(e)};e.prototype.getKey=function(e){return Object(M.v)(e)};e.prototype.getKeyParams=function(e){return Object(M.m)(e)};e.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(M.T)(e)};e.prototype.getPageType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return Object(M.w)(e,this._mayBeFastOneUp||t)};e.prototype.getSubQueryType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return Object(M.k)(e,t)};e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);var t=null;if(e.parId||e.parQt||e.parCid){(t={}).id=e.id;t.qt=e.qt;t.cid=e.cid;t.internalPath=e.internalPath;delete t.u}return t&&Object(M.v)(t)||null};e.prototype.getRootItemKey=function(e){void 0===e&&(e=te.e.Files);return Object(M.C)(e)};e.prototype.getDefaultRootItemId=function(){return"root"};e.prototype.getApiBaseUrl=function(e){return Object(Dt.o)(e)};e.prototype.getNavLinkClickUrl=function(e){return""};e.dependencies={navigation:V.e,resources:W.i};return e})(),Ht=Object($.i)("UrlDataSourceLite",Pt),Bt=n(344),jt=n(240),Ft=n(16),It=!Ft.t.isActivated("261E9FAA-0D80-41B7-A45F-FD8A6AE6327C","04/04/2021","Capture referral origin information"),qt=(function(e){Object(s.r)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(V.e);n._identityDataSource=n.resources.consume(Q.e);n._urlDataSourceLite=n.resources.consume(Ht);n._teachingBubbleProvider=n.resources.consume(Mt);n._firstRunExperienceStatus=n.resources.consume(Bt.e);return n}t.prototype.getEngagementData=function(e){var t=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"],n={referralOrigin:t};return e===le.e[le.e.StorageOptions]?Object(s.e)({purchaseSource:t},It&&t&&n):It&&t?n:void 0};t.prototype.userExecuteAction=function(e){var t=this;if(Object(me.ne)(me.l)&&e){var n=e.name;this.resources.consumeAsync(_t).then(function(e){0===n.indexOf("Upload")&&(n="Upload");if(t._identityDataSource.getIdentity().type!==fe.e.anonymous){"NewSession"===n&&t._isValidNpsSurveyContext()&&e.recordUserAction("NewNpsSession");t._isMeaningfulNpsAction(n)&&e.recordUserAction("MeaningfulNpsAction");"Navigation"===n&&Object(Dt.f)(t._navigation.viewParams)&&e.recordUserAction("EnteredAllPhotosView")}e.recordUserAction(n)})}};t.prototype.userSeeItem=function(e){};t.prototype._isValidNpsSurveyContext=function(){var e=this._urlDataSourceLite.getPageType(),t=e===le.e.Files||e===le.e.Photos;return!this._teachingBubbleProvider.currentBubble.get()&&this._firstRunExperienceStatus.get()!==jt.e.visible&&t};t.prototype._isMeaningfulNpsAction=function(e){return"Open.File"===e||"Open.Media"===e||/OpenIn[a-zA-z]+/.test(e)||"Upload"===e||"CreateFolder"===e||/Create[a-zA-Z]+DocumentAction/.test(e)};return t})(ae.e),Rt=n(133),Ut=n(302),zt=n(218),Wt=(function(){function e(){}e.prototype.trackUserAction=function(e){if(!this._hasReported)if(this._startEngagement){var t=this._getActionName(e);if(t){this._endEngagement=e;this._report(t)}}else"ItemsView.Load"===e.name&&("101"!==e.listTemplateId&&"700"!==e.listTemplateId&&"Recent"!==e.objectType&&"Files-RecentSpartan"!==e.currentPage&&"Files-Home"!==e.currentPage&&"SharedWithMe"!==e.objectType&&"Files-SharedWithMeSpartan"!==e.currentPage&&"SharedByMe"!==e.objectType&&"Files-SharedByMeSpartan"!==e.currentPage&&"Files-Favorites"!==e.currentPage||(this._startEngagement=e))};e.prototype._getActionName=function(e){switch(e.name){case"Open.File":case"Open.Media":return"Open";case"Open":if("File"!==e.objectType)return;return"Open";case"CopyLink":case"CopyTo":case"CreateDocument":case"CreateFolder":case"Delete":case"Download":case"ItemPicker.Complete":case"MoveTo":case"OpenInOfficeClient":case"OpenInOfficeOnline":case"OpenInImmersiveReader":case"Upload":case"Rename":case"Share":case"Favorite":case"Unfavorite":return e.name;case"ShareAction":return"Share";case"CopyLinkAction":return"CopyLink";case"OpenItemAction":return"Open";case"UploadFileAction":case"UploadFolderAction":return"Upload"}};e.prototype._report=function(e){if(this._startEngagement&&this._endEngagement){Nt.e.logData(Object(s.e)(Object(s.e)({},this._endEngagement),{action:e,name:"TimeToFile",isIntentional:!0,extraData:Object(s.e)(Object(s.e)({"TimeToFile.Duration":performance.now()},this._endEngagement.extraData),Object(O.t)(this._startEngagement.extraData,function(e){return e},function(e){return"extraData"===e?void 0:"entry.".concat(e)}))}));this._hasReported=!0}};return e})(),Xt=Object($.i)("TimeToFileReporter",Wt,{}),Vt=n(80),$t=n(83),Jt=new W.t({name:"SearchSession.key",factory:new W.e($t.e.generate())}),Kt=n(273),Qt=n(212),Gt=n(10),Yt=Object(Qt.e)({eventName:"Page,",shortEventName:"Page"},{previousName:Gt.e.String,currentName:Gt.e.String}),Zt=n(547),en=!Ft.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),tn={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},nn=(function(e){Object(s.r)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t)||this;r.searchSessionStarted=!1;r._dataStore=new Ct.e("",kt.e.session);r._instrumentationDataSource=n.instrumentationDataSource||r.resources.consume(J.s.optional);r._pageEvent=void 0;r._engagement=n.engagement||r.resources.consume(Kt.e);r._searchSession=n.searchSession||r.resources.consume(Jt.optional);r._timeToFileReporter=n.timeToFileReporter||r.resources.consume(Xt);return r}t.prototype.logStartSearchOnSubmit=function(){var e,t;if(!this.searchSessionStarted){var n={name:"StartSearchSession",location:"NA",usageType:zt.e[zt.e.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession();this._engagement.logData(n)}null===(t=null===(e=this._instrumentationDataSource)||void 0===e?void 0:e.onSearchStarted)||void 0===t||t.call(e)};t.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};t.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};t.prototype.userViewPage=function(e){var t=e.name,n="(none)";if(this._pageEvent){n=this._pageEvent.data.currentName;this._pageEvent.end();this.userExecuteAction({name:"NavigatePage"})}this._pageEvent=new Yt({currentName:t,previousName:n});this._engagement.logData({name:"Page.View",location:"NA",usageType:zt.e[zt.e.Click],currentPage:t,previousPage:n,extraData:this._getExtraData(t,e)})};t.prototype.userSeeItem=function(e){var t,n;if(this._instrumentationDataSource){this._instrumentationDataSource.userSeeItem(e);Object(Vt.e)(e.queryType)&&(null===(n=(t=this._instrumentationDataSource).logSearchResultsRendered)||void 0===n||n.call(t))}};t.prototype.userExecuteAction=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userExecuteAction(e);this._timeToFileReporter&&this._timeToFileReporter.trackUserAction({name:e.name,currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:this.getEngagementData()||{}})};t.prototype.userClickItem=function(e){var t=Rt.e[Rt.e.bingClickInstrumentation];if(Object(Vt.e)(e.queryType)&&e.urls&&e.urls[t]){var n=new y.e({name:"SearchResultClickItem"});Ut.e(e.urls[t]).done(function(){n.end({resultType:y.t.Success})},function(){n.end({resultType:y.t.Failure,extraData:{url:e.urls[t]}})})}this._logOfficeDocAge(e)};t.prototype.userClickSuggestion=function(e){if(e){var t=new y.e({name:"SearchSuggestionClickItem"});Ut.e(e).done(function(){t.end({resultType:y.t.Success})},function(){t.end({resultType:y.t.Failure,extraData:{url:e}})})}};t.prototype.getEngagementData=function(e){return this._getExtraData(void 0,e)};t.prototype.logSearchResultsRendered=function(){var e,t;null===(t=null===(e=this._instrumentationDataSource)||void 0===e?void 0:e.logSearchResultsRendered)||void 0===t||t.call(e)};t.prototype._getExtraData=function(e,t){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName(),t):null};t.prototype._startSearchSession=function(){this.searchSessionStarted=!0};t.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var n=en?Object(Zt.e)(t):t,r=this._engagement;r.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:n,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(tn[t]){var i=new Date(e.dateModifiedValue),s=Math.ceil(((new Date).getTime()-i.getTime())/1e3);s>0&&r.logData({name:"OfficeDocument.Clicked",extraData:{extension:n,age:s,dateModified:e.dateModifiedValue}})}}}catch(e){}};t.dependencies=Object(s.e)(Object(s.e)({},ae.e.dependencies),{instrumentationDataSource:J.s.optional,engagement:Kt.e,searchSession:Jt.optional,timeToFileReporter:Xt});return t})(ae.e),rn=nn;Object($.i)("InstrumentationProvider",nn);(function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"})(je||(je={}));var sn,on=je;(function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"})(sn||(sn={}));var un,an=sn,fn=window.$Config&&window.$Config.isINT,ln="https://messaging-int.msonerm.com/",cn="https://dynmsg.modpim.com/",hn=((un={})[an.NewBrandFRE]={id:an.NewBrandFRE,type:on.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return"".concat(fn?ln:cn,"api/v1/messaging/web/message?puid=").concat(e.upsellUserId,"&locale=").concat(e.market,"&Source=OneDriveFRE")},shouldSendMessageOnClose:!0,renderType:0},un[an.OneRmO365Upsell]={id:an.OneRmO365Upsell,type:on.ONEUNIT,ramp:me.F,checkThrottle:function(e){return Object(me.ne)(me.F)},getUpsellIframeUrl:function(e){return"".concat(fn?ln:cn,"api/v1/messaging/web/message?puid=").concat(e.upsellUserId,"&locale=").concat(e.market,"&data=").concat(encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable})),"&Source=OneDriveWebBanner")},shouldSendMessageOnClose:!0,renderType:1},un),pn=(function(e){Object(s.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=Ft.t.isActivated("8dba7267-c081-480e-9601-f659d6395db5","09/09/2020","Add dependencies to UserInfoProvider and UserInfoDataSource");r.dataSource=!i&&n&&n.dataSource||r.resources.consume(J.h);r.canPersistUserInfo=r.dataSource.canPersistUserInfo();return r}t.prototype.getAnid=function(){return this.dataSource.getAnid()};t.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){t._cachedUserInfo=e;return e},function(e){return x.t.wrapError(null)}):x.t.wrap(null):x.t.wrap(this._cachedUserInfo)};t.prototype.setUserInfo=function(e,t,n,r,i){return this.dataSource.setUserInfoWithUserFacts(e,t,n,r,i)};t.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};t.prototype.getBubbleUserFact=function(e,t,n){return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(e,t,n):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n],s=e.campaignGuid;if(i.id&&i.id.toLowerCase()===s.toLowerCase())return JSON.parse(i.data)}return{d:!1,v:0}},function(e){return x.t.wrapError(null)})};t.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};t.prototype.getSurveyStatusUserFact=function(e,t,n){return t?x.t.resolve({activated:!1,dateLastModified:new Date}):this.dataSource.getSurveyStatusUserFact?this.dataSource.getSurveyStatusUserFact(e):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n];if(i.id&&i.id.toLowerCase()===e.toLowerCase())return{activated:JSON.parse(i.data).a,dateLastModified:new Date(i.modifiedDate)}}return{activated:!1,dateLastModified:new Date}})};t.prototype.setSurveyStatusUserFact=function(e,t){return this.dataSource.setSurveyStatusUserFact?this.dataSource.setSurveyStatusUserFact(e,t):this.setUserInfo(47,3,null,e,JSON.stringify({a:t.activated}))};t.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};t.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};t.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};t.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};t.prototype.updateUpsellData=function(e,t,n){return this.dataSource.updateUpsellData(e,t,n)};t.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};t.prototype.getUserFact=function(e){return this.dataSource.getUserFact(e)};t.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};t.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};t.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};t.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};t.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?hn[e.variation]:e};t.prototype.sendShowUpsell=function(e,t,n){return this.dataSource.sendShowUpsell(e,t,n)};t.prototype.sendCloseUpsell=function(e,t,n){return this.dataSource.sendCloseUpsell(e,t,n)};t.prototype.getMarket=function(){return this.dataSource.getMarket()};t.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};t.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};t.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};t.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};t.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};t.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};t.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};t.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};t.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};t.dependencies={dataSource:J.h};return t})(ae.e),dn=pn,vn=(Object($.i)("UserInfoProvider",pn),n(25)),mn=n(74),gn=n(193),yn=n(161),bn=!Ft.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations"),wn=window.$Config&&window.$Config.isINT,En=1;Object(me.ne)(me.m)&&(En=2);var Sn=(function(e){Object(s.r)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._pendingRequests={};r._currentParamUpsells={};r._navigation=r.resources.consume(V.e);return r}t.prototype.canPersistUserInfo=function(){return!0};t.prototype.getCurrentParamUpsells=function(){return this._currentParamUpsells};t.prototype.setCurrentParamUpsells=function(e){this._currentParamUpsells=e};t.prototype.getAnid=function(){return mn.e.getAnid()};t.prototype.getMarket=function(){return mn.e.getMarket()};t.prototype.getLanguage=function(){return mn.e.getLanguage()};t.prototype.isNewUser=function(){return mn.e.isNewUser()};t.prototype.isAuthenticated=function(){return mn.e.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this,n=Object(gn.e)(),r=e?n+"?v="+Math.random():n,i=new vn.e;if(this._pendingRequests[n])return this._pendingRequests[n];if(!this.isAuthenticated()||!e&&this._cachedUserInfo)return x.t.wrap(this._cachedUserInfo);var s=i.send({apiName:"GetUserInfo",url:r}).then(function(e){delete t._pendingRequests[n];t._cachedUserInfo=e;if(e&&e.notifications)for(var r=0,i=e.notifications;r<i.length;r++){var s=i[r];7===s.type&&s.param&&(t._currentParamUpsells=JSON.parse(s.param))}if(e&&e.info)for(var o=0,u=e.info;o<u.length;o++){var a=u[o];24===a.type&&(t._positioningData=a)}return e},function(e){delete t._pendingRequests[n];return x.t.wrapError(e)});this._pendingRequests[n]=s;return s};t.prototype.setUserInfo=function(e){var t=Object(gn.t)();return(new vn.e).sendPostUrlEncoded("SetUserInfo",t,JSON.stringify(e)).then(function(e){return!(!e||e.error)})};t.prototype.setUserInfoWithUserFacts=function(e,t,n,r,i){var s={type:e,action:t};n&&(s.param=n);i&&(s.data=i);r&&(s.id=r);n&&7===e&&(this._currentParamUpsells=JSON.parse(n));return this.setUserInfo(s)};t.prototype.sendShowUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"SHOWED")};t.prototype.sendCloseUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"CLOSE")};t.prototype.resetUpsellUserFact=function(){return this.setUserInfoWithUserFacts(7,3,JSON.stringify({}))};t.prototype.handleUpdateUpsellData=function(e,t,n){var r=this.getUpsellVariationIfApplicable(e),i=this._currentParamUpsells[r.id];if(i){t&&(i.d=1);n&&i.v++}else this._currentParamUpsells[r.id]={d:t?1:0,v:n?1:0}};t.prototype.updateUpsellData=function(e,t,n){this.handleUpdateUpsellData(e,t,n);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.hasUserFact=function(e){var t=this;return this.getUserInfo(!1).then(function(n){var r=!1;if(!t._cachedUserInfo)throw new Error("CachedUserInfo is not defined when trying to access user fact");(r=t._cachedUserInfo.info.some(function(t){return t.type===e&&t.isSet}))||(r=t._cachedUserInfo.rewards.some(function(t){return t.type===e&&t.isSet}));return r})};t.prototype.getUserFact=function(e){return this.getUserInfo(!1).then(function(t){if(t&&t.info)for(var n=t.info,r=0;r<n.length;r++)if(n[r].type===e)return n[r];return null})};t.prototype.getIsPremium=function(e){return this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=e.info,n=0;n<t.length;n++)if(35===t[n].type)return!0;return!1})};t.prototype.getUpsellToShow=function(e){var t=this._checkForParamOverrides();return null!==t?x.t.wrap(t):this.checkThrottle(hn[an.OneRmO365Upsell]).then(function(e){return e?hn[an.OneRmO365Upsell]:null})};t.prototype.getUpsellViewCount=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=0;t._currentParamUpsells[n.id]&&(r=t._currentParamUpsells[n.id].v);return r},function(e){return null})};t.prototype.getUpsellDismissed=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=!1;t._currentParamUpsells[n.id]&&(r=!!t._currentParamUpsells[n.id].d);return r},function(e){return null})};t.prototype.checkThrottle=function(e){var t=this._navigation.viewParams,n=this.getUpsellDismissed(e),r=this.getUpsellViewCount(e);return x.t.all({didUserDismiss:n,viewCount:r}).then(function(n){var r=n.didUserDismiss,i=n.viewCount;return null!==r&&null!==i&&e.checkThrottle({viewCount:i,didUserDismiss:r,viewParams:t,market:$Config.mkt})})};t.prototype.getUpsellIframeSrc=function(e,t){var n=this;return this.getUserInfo(!1).then(function(r){if(e.getUpsellIframeUrl)return n.getIsPremium(!1).then(function(r){return e.getUpsellIframeUrl({anid:n.getAnid(),market:$Config.mkt,override:0,isNewUser:n.isNewUser(),upsellUserId:$Config.upsellUserId,variationId:e.id,availableUpsells:hn,isO365:r,bytesAvailable:n._getTotalQuotaInBytes(t),bytesUsed:n._getQuotaUsedInBytes(t)})})})};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?hn[e.variation]:e};t.prototype.getUpsellDismissedById=function(e,t){return x.t.wrap(void 0)};t.prototype.getUpsellViewCountById=function(e,t){return x.t.wrap(void 0)};t.prototype.markUpsellAsSeen=function(e){return x.t.wrap(void 0)};t.prototype.markUpsellAsDismissed=function(e){return x.t.wrap(void 0)};t.prototype.getFirstRunExperienceDismissed=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=!1;e._currentParamUpsells[an.FirstRunExperienceDialog]&&(n=!!e._currentParamUpsells[an.FirstRunExperienceDialog].d);return n},function(e){return!0})};t.prototype.getFirstRunExperienceViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=0,r=e._currentParamUpsells[an.FirstRunExperienceDialog];r&&(n=r.v);return n})};t.prototype.updateFirstRunExperienceData=function(e,t){this.handleUpdateFirstRunExperienceData(e,t);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.handleUpdateFirstRunExperienceData=function(e,t){var n=this._currentParamUpsells[an.FirstRunExperienceDialog];if(n){e&&(n.d=1);t&&n.v++}else this._currentParamUpsells[an.FirstRunExperienceDialog]={d:e?1:0,v:t?1:0}};t.prototype.hasPositioningBeenViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){return!!e._positioningData},function(e){return!0})};t.prototype.datePositioningViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t)return new Date(t.createdDate+"z")})};t.prototype.getPremiumUpsellsViewed=function(){return x.t.all({hasPositioningViewed:this.hasPositioningBeenViewed(),hasNewFeaturesViewed:this.getMostRecentNewFeaturesUpsellViewed()})};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t){if(t.param){return JSON.parse(t.param).v>=En}return!1}return!0},function(e){return!0})};t.prototype.setPositioningUserFactWithParams=function(e){if(Object(me.ne)(me.n))return x.t.resolve(!0);var t={v:0};this._positioningData&&this._positioningData.param&&(t=JSON.parse(this._positioningData.param));e&&(t.v=En);return this.setUserInfoWithUserFacts(24,3,JSON.stringify(t),"78f745e2-e4f9-4734-8a08-454e12832a22")};t.prototype.getExpiringSharingLinksSeen=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=e._currentParamUpsells[an.ExpiringSharingLinks];return n&&!!n.d},function(e){return!0})};t.prototype.setExpiringSharingLinksSeen=function(){var e=this._currentParamUpsells[an.ExpiringSharingLinks];e?e.d=1:this._currentParamUpsells[an.ExpiringSharingLinks]={d:1,v:1};this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype._checkForParamOverrides=function(){var e=this._navigation.viewParams,t=Tn(yn.e.upsellOverride,e);if(t)return hn[t];Tn(yn.e.resetUpsellParams,e)&&this.resetUpsellUserFact();return null};t.prototype._getTotalQuotaInBytes=function(e){return e&&e.properties&&e.properties.quota&&e.properties.quota.total};t.prototype._getQuotaUsedInBytes=function(e){var t=this._getTotalQuotaInBytes(e);return t?t-e.properties.quota.remaining:null};t.prototype._sendUpsell=function(e,t,n,r){var i=new vn.e,s=wn?ln:cn,o={CampaignId:e.CampaignID,ContentId:e.MessageID,Id:t,Locale:n,Source:"OneDriveWebBanner",TransactionID:e.TransactionID,Type:0,UserAction:r},u="".concat(s,"api/v1/messaging/web/useraction?").concat(D.t(o));return i.sendPost("OneRM",u,"").then(function(e){return!0},function(e){return!1})};return t})(ie.t),xn=Sn;function Tn(e,t){return bn?Object(yn.t)(e,t):t[e]}Object($.i)("UserInfoDataSource",Sn);var Nn=(function(e){Object(s.r)(t,e);function t(t){var n=e.call(this,t)||this;n._embedDataSource=n.resources.consume(J.t);return n}t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)};t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)};return t})(ie.t),Cn=Object(o.createContext)({});function kn(e){var t=e.diagnostics,n=e.children;return o.createElement(Cn.Provider,{value:{diagnostics:t}},n)}var Ln=n(291);function An(e){var t,n,r=Object(o.useRef)(null),i=Object(o.useState)(null),s=i[0],u=i[1],a=Object(o.useState)(null),f=a[0],c=a[1],h=Object(o.useState)(null),p=h[0],d=h[1],m=e.bootstrapParams,g=Object(o.useContext)(Cn).diagnostics,b=Object(o.useRef)(e.onStart),w=Object(o.useRef)(e.onSucceed),S=Object(o.useRef)(e.onFailed),x=Object(o.useRef)(e.onTimeout);Object(o.useEffect)(function(){b.current=e.onStart;w.current=e.onSucceed;S.current=e.onFailed;x.current=e.onTimeout},[e.onStart,e.onSucceed,e.onFailed,e.onTimeout]);Object(o.useEffect)(function(){return(function(){var e;if(r.current&&g){null===(e=b.current)||void 0===e||e.call(b);var t,n=Date.now();g.update({bootState:v.JSApiBootStarted,officeInitializationTime:n,hostInitializeCallTime:n});E(r.current,m,g.data).then(function(e){var n,i=e.application,s=e.session,o=e.wacAppDiagnostics;g.update({wacHostCompleteTime:Date.now(),wacAppDiagnostics:o});t=function(){if(i&&i.Dispose){i.Dispose();i=null}};var a=r.current.querySelector("iframe");u(a);c(i);d(s);null===(n=w.current)||void 0===n||n.call(w)},function(e){var t;g.update({wacHostCompleteTime:Date.now()});null===(t=S.current)||void 0===t||t.call(S,e)});g.update({bootState:v.JSApiBootPendingComplete});var i=function(){var e;(null===(e=g.data)||void 0===e?void 0:e.bootState)===v.JSApiBootPendingComplete&&m.triggerLogEvent({bootState:v.JSApiBootFailed,resultType:y.t.ExpectedFailure,resultCode:"UserNavAway",errorInfo:"User navigate away"})};window.addEventListener("beforeunload",i);return function(){window.removeEventListener("beforeunload",i);t&&t()}}})()},[g,m]);return o.createElement(o.Fragment,null,o.createElement("div",{id:"WACContainer",ref:r}),o.createElement(Ln.e,{targetOrigin:(t=m.ApplicationUrl,n=new l.t(t,{queryCaseInsensitive:!0}),n.getLeftPart(l.e.authority)),logOnly:m.UseV2,iframeElem:s,allowedOrigins:m.AllowedOrigins,migrationState:m.MigrationState}),o.createElement(Ln.t,{application:f,session:p,migrationState:m.MigrationState}))}var On=n(100);function Mn(e){var t=e.context,n=e.eventType,r=e.handler,i=Object(On.t)().dispatcher,s=Object(o.useCallback)(function(e){return r(e,t,i)},[r,t,i]);Object(o.useEffect)(function(){if(i&&n){i.addEventListener(n,s);return function(){i.removeEventListener(n,s)}}},[i,n,s]);return null}var _n,Dn=n(535),Pn=n(105);(function(e){e.COB_UpdateUI="COB_UpdateUI";e.COB_SyncPageContext="COB_SyncPageContext"})(_n||(_n={}));var Hn=n(47),Bn=n(127),jn=n(178),Fn=(function(e){Object(s.r)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})};t.dependencies=Object(s.e)(Object(s.e)({},ae.e.dependencies),{identityDataSource:jn.e});return t})(ae.e),In=Object($.i)("GraphTokenProvider",Fn),qn=(function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"};return e})(),Rn=new W.t({name:"GraphUrlDataSource",factory:new $.r(qn)}),Un=n(209),zn=Object($.i)("GraphDataRequestor",Un.e,{sessionManagementProvider:In,urlDataSource:Rn}),Wn=(Un.e,n(345)),Xn=(function(e){Object(s.r)(t,e);function t(){var t=e.call(this)||this;t._dataRequestor=t.resources.consume(zn);t._urlDataSource=t.resources.consume(K.t);return t}t.prototype.getEmbedInfo=function(e){return Object(s.t)(this,void 0,x.t,function(){var t,n,r,i,o=this;return Object(s.i)(this,function(u){switch(u.label){case 0:return Object(me.ne)(me.c)?[4,this.resources.consumeAsync(J.i)]:[3,3];case 1:t=u.sent();this._dataRequestor=new Un.t({},{urlDataSource:{getApiBaseUrl:function(){return"https://graph.microsoft.com/beta"}},sessionManagementProvider:{getToken:function(){return Object(s.t)(o,void 0,x.t,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return t?[4,t.getGraphToken({})]:[3,2];case 1:return[2,e.sent()];case 2:return[2,x.t.reject("Could not retrieve identity data source")]}})})}}});this._sharingService=new Wn.e({},{dataRequestor:this._dataRequestor});return[4,this._sharingService.getPermissions(e.id)];case 2:n=u.sent();return[2,this._parsePermissions(n)];case 3:r=new vn.e;i=this._urlDataSource.getEmbedInfoUrl(e);return[2,r.send({apiName:"GetEmbedInfo",url:i,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return o._isExpected(e)?null:x.t.wrapError(e)})]}})})};t.prototype.createEmbedLink=function(e){var t=this,n={type:"embed"};return this._getItemUrl(e).then(function(e){var r="".concat(e,"/createLink");return t._dataRequestor.send({path:r,apiName:"createLink",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n||{}),getErrorAsMessage:!0}).then(function(e){var t=e.link,n=void 0===t?{}:t,r=n.webHtml,i=void 0===r?"":r,s=n.webUrl;return{embedCode:i,embedUrl:void 0===s?"":s}})})};t.prototype._parsePermissions=function(e){for(var t,n=0,r=e;n<r.length;n++){var i=r[n];if("embed"===(null===(t=i.link)||void 0===t?void 0:t.type))return{embedCode:i.link.webHtml,embedUrl:i.link.webUrl}}};t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code};t.prototype._getItemUrl=function(e,t){return x.t.resolve(this.resources.consumeAsync(J.r).then(function(n){return n.getItemUrl(e,{apiVersion:t})}))};return t})(ie.t),Vn={EnableWacJsApiV2:{ODC:"EnableWacJsApiV2"},EnableWacOfficeWebLoader:{ODC:"EnableWacOfficeWebLoader"},EnableWacUnifiedApps:{ODC:"EnableWacUnifiedApps"},Word:{WacHostFlightWordWordJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Word_WordJsApiV2NoWrapper"},WacHostFlightWordWordJsApiV2:{ODC:"Wac_HostFlight_Word_WordJsApiV2"},WacHostFlightWordODCShareLinkPreload:{ODC:"Wac_HostFlight_Word_ODCShareLinkPreload"},WacHostFlightWordWordScriptsPreload:{ODC:"Wac_HostFlight_Word_WordScriptsPreload"},WacJsApiWordView:{ODC:"Wac_JsApi_Word_View"},WacJsApiWordEdit:{ODC:"Wac_JsApi_Word_Edit"},WacJsApiWordEditNew:{ODC:"Wac_JsApi_Word_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedWord:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Word"}},Excel:{WacHostFlightExcelExcelJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Excel_ExcelJsApiV2NoWrapper"},WacHostFlightExcelExcelJsApiV2:{ODC:"Wac_HostFlight_Excel_ExcelJsApiV2"},WacHostFlightExcelExcelLandingPageOfflineTelemetry:{ODC:"Wac_HostFlight_Excel_ExcelLandingPageOfflineTelemetry"},WacHostFlightExcelInstantShell:{ODC:"Wac_HostFlight_Excel_InstantShell"},WacHostFlightExcelODCShareLinkPreload:{ODC:"Wac_HostFlight_Excel_ODCShareLinkPreload"},WacHostFlightExcelExcelAdaptiveLayoutDownload:{ODC:"Wac_HostFlight_Excel_ExcelAdaptiveLayoutDownload"},WacHostFlightExcelExcelLandingPageObserver:{ODC:"Wac_HostFlight_Excel_ExcelLandingPageObserver"},WacJsApiExcelView:{ODC:"Wac_JsApi_Excel_View"},WacJsApiExcelEdit:{ODC:"Wac_JsApi_Excel_Edit"},WacJsApiExcelEditNew:{ODC:"Wac_JsApi_Excel_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedExcel:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Excel"}},PowerPoint:{WacHostFlightPowerPointPowerPointJsApiV2NoWrapper:{ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2NoWrapper"},WacHostFlightPowerPointPowerPointJsApiV2:{ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2"},WacHostFlightPowerPointODCShareLinkPreload:{ODC:"Wac_HostFlight_PowerPoint_ODCShareLinkPreload"},WacJsApiPowerPointView:{ODC:"Wac_JsApi_PowerPoint_View"},WacJsApiPowerPointEdit:{ODC:"Wac_JsApi_PowerPoint_Edit"},WacJsApiPowerPointEditNew:{ODC:"Wac_JsApi_PowerPoint_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedPowerPoint:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_PowerPoint"}},OneNote:{WacHostFlightOneNoteOneNoteJsApiV2NoWrapper:{ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2NoWrapper"},WacHostFlightOneNoteOneNoteJsApiV2:{ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2"},WacHostFlightOneNoteODCShareLinkPreload:{ODC:"Wac_HostFlight_OneNote_ODCShareLinkPreload"},WacJsApiOneNoteView:{ODC:"Wac_JsApi_OneNote_View"},WacJsApiOneNoteEdit:{ODC:"Wac_JsApi_OneNote_Edit"},WacJsApiOneNoteEditNew:{ODC:"Wac_JsApi_OneNote_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedOneNote:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_OneNote"}},Visio:{WacHostFlightVisioVisioJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Visio_VisioJsApiV2NoWrapper"},WacHostFlightVisioVisioJsApiV2:{ODC:"Wac_HostFlight_Visio_VisioJsApiV2"},WacHostFlightVisioODCShareLinkPreload:{ODC:"Wac_HostFlight_Visio_ODCShareLinkPreload"},WacJsApiVisioView:{ODC:"Wac_JsApi_Visio_View"},WacJsApiVisioEdit:{ODC:"Wac_JsApi_Visio_Edit"},WacJsApiVisioEditNew:{ODC:"Wac_JsApi_Visio_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedVisio:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Visio"}},WacSendPerformanceLog:{ODC:"WacSendPerformanceLog"}};function $n(e,t,n){var r=e.replace(/_/g,"").replace(/\{0\}/g,t).replace(/\{1\}/g,n);return Vn[t][r]}function Jn(e){return!!e&&Object(ye.te)(e)}function Kn(e,t,n){return Jn($n(e,t,n))}var Qn=n(60),Gn=n(172),Yn=n(377),Zn=n(189),er=n(153);var tr=n(49),nr=n(321),rr=n(53),ir=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([7],685)];case 1:return[2,e.sent().handleAppLoadingStatus]}})})}),sr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([16],686)];case 1:return[2,e.sent().handleSetOverlayContent]}})})}),or=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([9],687)];case 1:return[2,e.sent().handleCopyAndEdit]}})})}),ur=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([10],688)];case 1:return[2,e.sent().handleDavUrlFromIds]}})})}),ar=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([11],689)];case 1:return[2,e.sent().handleEditNotification]}})})}),fr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([14],690)];case 1:return[2,e.sent().handleGetCustomAuthConfig]}})})}),lr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([15],691)];case 1:return[2,e.sent().handleRefreshSessionInfo]}})})}),cr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([13],692)];case 1:return[2,e.sent().handleFileRename]}})})}),hr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([17],693)];case 1:return[2,e.sent().handleSignIn]}})})}),pr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([18],694)];case 1:return[2,e.sent().handleUserActivity]}})})}),dr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([21],695)];case 1:return[2,e.sent().handleWopiInfoFromUrl]}})})}),vr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([12],696)];case 1:return[2,e.sent().handleFileProperties]}})})}),mr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([19],697)];case 1:return[2,e.sent().handleVersionHistory]}})})}),gr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([20],698)];case 1:return[2,e.sent().handleWacClose]}})})}),yr=Object(C.i)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([8],699)];case 1:return[2,e.sent().handleAppPushState]}})})}),br=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee(2,719)];case 1:return[2,e.sent().WacGrantAccessDialog]}})})}),wr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee(2,719)];case 1:return[2,e.sent().WacShareDialog]}})})}),Er=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([28,"ondemand.resx-ondemand"],728)];case 1:return[2,e.sent().WacEmbedDialog]}})})}),Sr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([30,"ondemand.resx-ondemand"],700)];case 1:return[2,e.sent().WacQuotaDialog]}})})}),xr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([31,"ondemand.resx-ondemand"],711)];case 1:return[2,e.sent().WacRedeemDialog]}})})}),Tr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([27],729)];case 1:return[2,e.sent().LegacyWacApplication]}})})}),Nr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([24],721)];case 1:return[2,e.sent().COBWacApplication]}})})}),Cr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee(3,715)];case 1:return[2,e.sent().WacFilePickerDialog]}})})}),kr=Object(Ie.e)(function(){return Object(s.t)(void 0,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,n.ee(3,715)];case 1:return[2,e.sent().WacMoveToFolderPickerDialog]}})})});Object(Dn.e)();Object(a.e)();var Lr,Ar,Or="https://onedrive.live.com",Mr=new l.t(window.location.href);(function(e){e.View="View";e.Edit="Edit";e.EditNew="EditNew";e.BinaryConvert="BinaryConvert"})(Lr||(Lr={}));function _r(e,t,n){var r,i,o,u,a,f,c,h,p;return Object(s.t)(this,void 0,x.t,function(){var d,v,m,g,y,b,w,E,S;return Object(s.i)(this,function(x){switch(x.label){case 0:d=window.WacConfig;v=(null===(r=d.viewParams)||void 0===r?void 0:r.cid)||(null==t?void 0:t.cid);m=(null===(i=d.viewParams)||void 0===i?void 0:i.id)||(null==t?void 0:t.resid);if(!Ur())return[3,2];"editnew"!==(null===(o=null==t?void 0:t.action)||void 0===o?void 0:o.toLowerCase())&&"editnew"!==(null===(u=null==Mr?void 0:Mr.getQueryParameter("action"))||void 0===u?void 0:u.toLowerCase())||(d.OriginalMode="EditNew");return[4,e.getItem(v,m,d.OriginalMode,d.RelativePath,t,Mr)];case 1:if(!(y=x.sent()))return[2,null];if(!(function(e){var t,n,r,i=window.WacConfig,o=null===(n=null===(t=e.itemFromServer)||void 0===t?void 0:t.openWith)||void 0===n?void 0:n.wac;if(!o){Object(T.e)("Error: the wopiInfo is null");return!1}var u=!1;if(Jn(Vn.EnableWacUnifiedApps)){u=!1;if(o.bootstrapperUrl&&Kn("Wac_JsApi_{0}_{1}",o.appName,i.OriginalMode)){u=!0;i.OriginalMode===Lr.Edit&&Jn($n("EnableWacUseOpenUrlInPlaceOfEditForUnified_{0}",o.appName))&&(o.applicationUrl||(u=!1))}}var a=!1;u&&(a=!0);var f=!1;a&&Jn(Vn.EnableWacJsApiV2)&&(Jn($n("Wac_HostFlight_{0}_{0}JsApiV2",o.appName))||Jn($n("Wac_HostFlight_{0}_{0}JsApiV2NoWrapper",o.appName)))&&(f=!0);i.UseUnifiedApps=a?1:0;i.BootWithJsApiV2=f?1:0;i.Application=o.appName;i.OpenInClientAction="OpenIn"+o.appName;var c,h=e.itemId;if(i.RelativePath){var p=new l.t(i.CloseUrl);p.setQueryParameter("id",h);i.CloseUrl=p.toString();(p=new l.t(i.FilePropertiesUrl)).setQueryParameter("id",h);i.FilePropertiesUrl=p.toString();(p=new l.t(i.FileVersionUrl)).setQueryParameter("resid",h);i.FileVersionUrl=p.toString();(p=new l.t(i.EditUrl)).setQueryParameter("resid",h);i.EditUrl=p.toString();(p=new l.t(i.ViewUrl)).setQueryParameter("resid",h);i.ViewUrl=p.toString();i.viewParams.id=h}var d=JSON.parse(i.PageTitleTypeList);for(var v in d)if(-1!==d[v].indexOf(o.appName)){c=d[v];break}i.PageTitleType=c;if(a){var m;m={WordJsApiV2NoWrapper:Jn(Vn.Word.WacHostFlightWordWordJsApiV2NoWrapper)?1:0,WordJsApiV2:Jn(Vn.Word.WacHostFlightWordWordJsApiV2)?1:0,WordScriptsPreload:Jn(Vn.Word.WacHostFlightWordWordScriptsPreload)?1:0,ExcelJsApiV2NoWrapper:Jn(Vn.Excel.WacHostFlightExcelExcelJsApiV2NoWrapper)?1:0,ExcelJsApiV2:Jn(Vn.Excel.WacHostFlightExcelExcelJsApiV2)?1:0,ExcelLandingPageOfflineTelemetry:Jn(Vn.Excel.WacHostFlightExcelExcelLandingPageOfflineTelemetry)?1:0,InstantShell:Jn(Vn.Excel.WacHostFlightExcelInstantShell)?1:0,ExcelAdaptiveLayoutDownload:Jn(Vn.Excel.WacHostFlightExcelExcelAdaptiveLayoutDownload)?1:0,ExcelLandingPageObserver:Jn(Vn.Excel.WacHostFlightExcelExcelLandingPageObserver)?1:0,PowerPointJsApiV2NoWrapper:Jn(Vn.PowerPoint.WacHostFlightPowerPointPowerPointJsApiV2NoWrapper)?1:0,PowerPointJsApiV2:Jn(Vn.PowerPoint.WacHostFlightPowerPointPowerPointJsApiV2)?1:0,OneNoteJsApiV2NoWrapper:Jn(Vn.OneNote.WacHostFlightOneNoteOneNoteJsApiV2NoWrapper)?1:0,OneNoteJsApiV2:Jn(Vn.OneNote.WacHostFlightOneNoteOneNoteJsApiV2)?1:0,VisioJsApiV2NoWrapper:Jn(Vn.Visio.WacHostFlightVisioVisioJsApiV2NoWrapper)?1:0,VisioJsApiV2:Jn(Vn.Visio.WacHostFlightVisioVisioJsApiV2)?1:0,ODCShareLinkPreload:Jn($n("Wac_HostFlight_{0}_ODCShareLinkPreload",o.appName))?1:0};i.Unified=Object(s.e)(Object(s.e)({},i.Unified),{WacApplication:o.appName,WacBootstrapperUrl:o.bootstrapperUrl,UserId:$Config.hcid,OwnerId:e.ownerId,ApplicationUrl:zr(o.applicationUrl,e.size),PageTitle:c.replace("{0}",e.name),ETag:e.eTag,FileName:e.name,FileGetUrl:o.fileGetUrl,FileGetUrlExpiry:null===(r=o.fileGetUrlExpiry)||void 0===r?void 0:r.toString(),FileSize:e.size,WopiSrc:o.wopiSrc,AccessToken:o.accessToken,AccessTokenExpiry:o.accessTokenExpiry,HostFlights:m,AppEnabled:u?1:0,ResourceId:h})}else i.Unified=void 0;return!0})(y))return[2,null];(function(e){var t,n=window.WacConfig;document.title=n.PageTitleType.replace("{0}",null==e?void 0:e.name);var r=void 0,i=JSON.parse(n.IconPathList);for(var s in i)if(-1!==i[s].key.indexOf(n.Application)){r=i[s].value;break}if(r){var o=document.head.querySelector('link[rel="icon"]');if(null!==o)o.href=r;else{(o=document.createElement("link")).rel="icon";o.href=r;o.type="image/x-icon";document.head.appendChild(o)}}if(window.history&&window.history.replaceState){var u=new l.t(window.location.href);u.getQueryParameter("resid")&&(null===(t=n.viewParams)||void 0===t?void 0:t.id)&&u.setQueryParameter("resid",n.viewParams.id,!0);window.history.replaceState(null,document.title,u.toString())}})(y);"Other"===(null===(a=n.data)||void 0===a?void 0:a.entryPoint)&&(g=Hr())&&n.update({entryPoint:g.entryPoint});m=(null===(f=d.viewParams)||void 0===f?void 0:f.id)||(null==t?void 0:t.resid);return[2,{id:y.itemId,name:y.name,eTag:y.eTag,key:"id=".concat(m),vault:y.vault,urls:{dav:null===(c=y.itemFromServer)||void 0===c?void 0:c.webDavUrl},sharingType:y.sharingType,ownerId:y.ownerId,folder:y.folder,video:y.video,photo:y.photo,itemFromServer:y.itemFromServer,parentKey:y.parentKey,graph:{itemId:y.itemId,driveId:(null===(p=null===(h=y.itemFromServer)||void 0===h?void 0:h.parentReference)||void 0===p?void 0:p.driveId)||Object(Qn.e)(v)}}];case 2:y=JSON.parse(d.GetItemsResponse).items[0];b=Object(M.v)(((E={}).id=y.id,E.cid=d.viewParams.cid,E));w=y.parentId?Object(M.v)(((S={}).id=y.parentId,S.cid=d.viewParams.cid,S)):void 0;return[2,{id:y.id,name:y.name,eTag:y.eTag,key:b,parentKey:w,vault:y.vault,urls:y.urls,sharingType:y.sharingLevelValue,ownerId:y.ownerCid,folder:y.folder?{}:void 0,video:y.video,photo:y.photo,graph:{itemId:y.id,driveId:Object(Qn.e)(v)}}]}})})}function Dr(){return Object(s.t)(this,void 0,void 0,function(){var e,t;return Object(s.i)(this,function(n){switch(n.label){case 0:e=2===Object(Bn.e)();t="https://api.badger".concat(e?"d":"p",".svc.ms/v1.0/token");return[4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appid:"00000000-0000-0000-0000-0000481710a4"})})];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}})})}function Pr(e,t,n){return Object(s.t)(this,void 0,void 0,function(){var r,i;return Object(s.i)(this,function(s){switch(s.label){case 0:r=Object(Hn.e)();i="".concat(r,"/shares/u!").concat(n);return[4,fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Badger ".concat(e.token):"Bearer ".concat(t.accessToken),Prefer:"autoredeem"}})];case 1:return[4,s.sent().json()];case 2:return[2,s.sent()]}})})}function Hr(){var e,t;try{var n=localStorage.getItem("ODCWac_ST");if(n){localStorage.removeItem("ODCWac_ST");return{entryPoint:"SDX.Skydrive*Root",clickTime:Number(n)}}var r=h.a.get("BP"),i=D.e(r),s=i.ST,o=i.FR;if(s&&o&&(o.indexOf("WC.Hotmail*WACCopy")>-1||o.indexOf("SDX.Skydrive*Root")>-1)){return{clickTime:Number(s),entryPoint:o}}if(null===(t=null===(e=window.WacConfig)||void 0===e?void 0:e.Unified)||void 0===t?void 0:t.ApplicationUrl){var u=new l.t(window.WacConfig.Unified.ApplicationUrl),a=u.getQueryParameter("wdorigin")||u.getQueryParameter("wdOrigin");if(a)return{entryPoint:a}}return{entryPoint:"Other"}}catch(e){return{entryPoint:"Other"}}}function Br(e,t){var n,r=1===(null===(n=e.Ramps)||void 0===n?void 0:n.WacUseShareTestEndpoint)?"https://www.onedrive-tst.com":"https://www.onedrive.com",i=t.sharedevhost;i&&(r="https://www.onedrive-tst.com");return{origin:r,devHost:i,height:402,width:320}}function jr(e){var t,n,r=this,i=e.redeemDialogHandleRef,o=e.diagnostics,u=e.viewParams,a=e.item,f=e.resourceScope,l=e.wacDataSource,c=e.vault,h=window.Flight,p=window.FilesConfig,d=window.$Config,v=window.WacConfig,m=f.consume(J.i).getIdentity().type!==fe.e.anonymous;return{diagnostics:o,viewParams:u,callerCid:d.hcid,env:p.env,enableInteractiveAuthFlow:1===(null===(t=h.Ramps)||void 0===t?void 0:t.WacAddinInteractiveAuthFlow),email:d.email,pageTitleType:v.PageTitleType,wacIframeDomain:null===(n=v.Unified)||void 0===n?void 0:n.ApplicationUrl,Mode:v.Mode,ViewUrl:v.ViewUrl,EditUrl:v.EditUrl,FileVersionUrl:v.FileVersionUrl,FilePropertiesUrl:v.FilePropertiesUrl,CloseUrl:v.CloseUrl,SignInUrl:p.signInUrl,autoRedeemSignOut:p.autoRedeemSignOut,autoRedeemUrl:p.autoRedeemUrl,authKey:p.authKey,item:a,refreshItem:function(e){return Object(s.t)(r,void 0,void 0,function(){var e,t,n,r,i,o;return Object(s.i)(this,function(s){switch(s.label){case 0:e=(null===(n=v.viewParams)||void 0===n?void 0:n.cid)||(null==u?void 0:u.cid)||(null===(r=v.Migration)||void 0===r?void 0:r.hcid);t=(null===(i=v.viewParams)||void 0===i?void 0:i.id)||(null==u?void 0:u.resid)||(null===(o=v.Migration)||void 0===o?void 0:o.id);return[4,l.getItem(e,t,v.OriginalMode,v.RelativePath,u,Mr)];case 1:s.sent().key="id=".concat(t);return[2]}})})},wacDataSource:l,isAuthenticated:m,vault:c,Ramps:h.Ramps,shareDialog:Br(window.Flight,u),redeemDialogHandleRef:i}}(function(e){e[e.Initial=0]="Initial";e[e.Loading=1]="Loading";e[e.Loaded=2]="Loaded";e[e.Failed=3]="Failed"})(Ar||(Ar={}));function Fr(e){var t=Object(o.useState)(function(){return new y.e({name:"ODCWacHost.Bootstrap"})})[0],n=e.item,r=e.vault,i=e.diagnostics,f=e.viewParams,c=e.wacDataSource,h=e.bootstrapperUrl,p=e.resources,d=Object(o.useRef)(null),v=Object(o.useState)(function(){return jr({redeemDialogHandleRef:d,diagnostics:i,viewParams:f,item:n,resourceScope:p,wacDataSource:c,vault:r})}),m=v[0],g=v[1],b=Object(o.useCallback)(function(e){window.WacConfig.Mode=e.NewMode;Object(a.t)({Mode:window.WacConfig.Mode||window.WacConfig.OriginalMode});g(function(t){return Object(s.e)(Object(s.e)({},t),{Mode:e.NewMode})})},[g]),E=function(e){if(e){e.bootState&&i.update({bootState:e.bootState});(function(e,t){var n,r=e.resultType,i=e.resultCode,s=e.errorInfo,o=e.error;new y.e({name:"".concat(Ur()?"COB":"ODC",".Wac.Init"),startTimeOverride:null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.hostInitializeCallTime}).end({resultType:r,resultCode:i,error:s,extraData:{error:o?JSON.stringify(o):""}})})(e,i);(function(e,t){var n=e.resultType,r=e.resultCode,i=e.errorInfo,s=e.error,o=window.WacConfig,u=o.Unified,a=window.Flight;new nr.e({scenario:"DocOpenODC",extraData:{clientId:null==u?void 0:u.WacApplication}}).end({resultType:n,errorCode:r,extraData:{HostSessionId:null==u?void 0:u.HostSessionId,FileSize:null==u?void 0:u.FileSize,errorInfo:i,error:s?JSON.stringify(s):"",action:o.Mode||o.OriginalMode,session:a.session,xid:a.xid}})})(e)}},S=Object(o.useState)(function(){var e,t=window.WacConfig,n=t.Unified,r=window.Flight,i=Ur(),s=new l.t(n.ApplicationUrl),o=void 0;i&&s&&(o=decodeURIComponent(s.getQueryParameter("sc")));return{UseV2:!!t.BootWithJsApiV2,UserId:n.UserId,SessionContext:o,MigrationState:i,HostName:n.HostName,HostSessionId:n.HostSessionId,OwnerId:n.OwnerId,AppEnabled:n.AppEnabled,capabilities:{isFeatureEnabled:function(e){return!(!n||!n.HostFlights)&&!!n.HostFlights[e]},customAuthConfig:!!(null===(e=r.Ramps)||void 0===e?void 0:e.WacSupportCustomAuthConfig),commonFilePicker:Jn(ye.Z),moveToFolder:Jn(ye.ee)},BootstrapperUrl:n.WacBootstrapperUrl,Application:n.WacApplication,ApplicationUrl:n.ApplicationUrl,FileName:n.FileName,FileGetUrl:n.FileGetUrl,FileGetUrlExpiry:n.FileGetUrlExpiry,FileSize:n.FileSize,ETag:n.ETag,UniqueId:n.ResourceId,WopiSrc:n.WopiSrc,AccessToken:n.AccessToken,AccessTokenExpiry:n.AccessTokenExpiry,ReadOnly:n.ReadOnly,ViewOnly:n.ViewOnly,onModeSwitched:b,triggerLogEvent:E}})[0],x=Object(o.useState)(Ar.Initial),T=x[0],k=x[1],L=Object(o.useState)(function(){return new N})[0],A=Object(o.useCallback)(function(e){e.state?L.respond({MessageId:C.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:$t.e.generate()}):window.history&&window.history.back()},[L]);Object(o.useEffect)(function(){window.addEventListener("popstate",A);return function(){window.removeEventListener("popstate",A)}},[L]);Object(o.useEffect)(function(){(function(){Object(s.t)(this,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);if(T!==Ar.Initial)return[2];k(Ar.Loading);i.update({officeBootstrapperStartTime:Date.now()});return[4,w(h,E)];case 1:e.sent();i.update({officeBootstrapperEndTime:Date.now()});k(Ar.Loaded);return[3,3];case 2:e.sent();i.update({officeBootstrapperEndTime:Date.now()});k(Ar.Failed);return[2];case 3:return[2]}})})})()},[T,h,i]);var O=(function(){var e,t,n,r,i=window.WacConfig;return(null===(r=null===(t=null===(e=window.Microsoft)||void 0===e?void 0:e.Office)||void 0===t?void 0:t[null===(n=null==i?void 0:i.Unified)||void 0===n?void 0:n.WacApplication])||void 0===r?void 0:r.EventIds)||{}})();return o.createElement(Y.e,{resources:p},o.createElement(kn,{diagnostics:i},o.createElement(On.e,{dispatcher:L},T===Ar.Loaded?o.createElement(An,{bootstrapParams:S,onSucceed:function(){var e,n;window.g_WACDone=!0;(null===(e=window.WacConfig)||void 0===e?void 0:e.IsOverQuota)&&(function(e){var t="wac-quota-dialog",n=document.getElementById(t);if(!n){(n=document.createElement("div")).id=t;document.body.append(n)}u.render(o.createElement(Sr,{fileSize:e}),n)})(null===(n=window.WacConfig.Unified)||void 0===n?void 0:n.FileSize);t.end({resultType:y.t.Success,resultCode:"WacApplication bootstrap succeed",extraData:{diagnostics:m.diagnostics.data}});(function(e){var t,n,r,i;if(!Jn(Vn.WacSendPerformanceLog))return;if(!(null==e?void 0:e.data))return;var s,o=window.WacConfig,u=e.data;if(u.userClickTime)s=u.userClickTime;else{if(!u.hostPageNavigationStartTime)return;s=u.hostPageNavigationStartTime}var a="".concat(Ur()?"COB":"ODC",".Wac.Perf"),f=function(e,t){new y.e({name:"".concat(a,".").concat(e),startTimeOverride:Date.now()-(t-s)}).end({resultType:y.t.Success,resultCode:"Success",extraData:{userClickTime:u.userClickTime,hostPageNavigationStartTime:u.hostPageNavigationStartTime,ServerStartTime:o.ServerStartTime?Number(o.ServerStartTime):void 0,name:e,time:t}})};u.userClickTime&&f("userClickTime",u.userClickTime);u.hostPageNavigationStartTime&&f("hostPageNavigationStartTime",u.hostPageNavigationStartTime);u.hostPageFirstFlushTime&&f("hostPageFirstFlushTime",u.hostPageFirstFlushTime);u.officeBootstrapperStartTime&&f("officeBootstrapperStartTime",u.officeBootstrapperStartTime);u.officeBootstrapperEndTime&&f("officeBootstrapperEndTime",u.officeBootstrapperEndTime);u.officeInitializationTime&&f("officeInitializationTime",u.officeInitializationTime);(null===(t=u.wacAppDiagnostics)||void 0===t?void 0:t.documentLoadedTime)&&f("documentLoadedTime",null===(n=u.wacAppDiagnostics)||void 0===n?void 0:n.documentLoadedTime);(null===(r=u.wacAppDiagnostics)||void 0===r?void 0:r.appCompletedTime)&&f("appCompletedTime",null===(i=u.wacAppDiagnostics)||void 0===i?void 0:i.appCompletedTime);u.wacHostCompleteTime&&f("wacHostCompleteTime",u.wacHostCompleteTime);if(!u.serverStartTime)return;s=u.serverStartTime;u.serverStartTime&&f("serverStartTime",u.serverStartTime);u.pageTaskCompleteTime&&f("pageTaskCompleteTime",u.pageTaskCompleteTime);u.responseCompleteTime&&f("responseCompleteTime",u.responseCompleteTime)})(i)},onFailed:function(){window.g_WACDone=!1;t.end({resultType:y.t.Failure,resultCode:"WacApplication bootstrap failed",extraData:{diagnostics:m.diagnostics.data}})}}):null,o.createElement(xr,{redeemDialogHandleRef:d,callerCid:m.callerCid,item:n,signInUrl:m.SignInUrl,autoRedeemSignOut:m.autoRedeemSignOut,autoRedeemUrl:m.autoRedeemUrl,authKey:m.authKey}),o.createElement(Pn.e,{eventType:O.UserAccessAndPermissions},o.createElement(br,Object(s.e)({itemName:n.name,listItemId:n.id},m.shareDialog))),o.createElement(Mn,{eventType:O.SetOverlayContent,handler:sr,context:m}),o.createElement(Mn,{eventType:O.CopyAndEdit,handler:or,context:m}),o.createElement(Mn,{eventType:O.Edit,handler:or,context:m}),o.createElement(Mn,{eventType:O.GetDavUrlFromIds,handler:ur,context:m}),o.createElement(Mn,{eventType:O.UserEditActivity,handler:ar,context:m}),o.createElement(Pn.e,{eventType:O.FileEmbed},o.createElement(Er,{item:m.item})),o.createElement(Mn,{eventType:O.GetCustomAuthConfig,handler:fr,context:m}),o.createElement(Mn,{eventType:O.RefreshSessionInfo,handler:lr,context:m}),o.createElement(Mn,{eventType:O.FileRenamed,handler:cr,context:m}),o.createElement(Pn.e,{eventType:O.Share},o.createElement(wr,Object(s.e)({itemName:n.name,listItemId:n.id},m.shareDialog))),Jn(ye.ee)?o.createElement(Pn.e,{eventType:O.MoveToFolder},o.createElement(kr,{item:n})):null,Jn(ye.Z)?o.createElement(Pn.e,{eventType:O.SharedFilePicker},o.createElement(Cr,{item:n})):null,o.createElement(Mn,{eventType:O.SignIn,handler:hr,context:m}),o.createElement(Mn,{eventType:O.UserActivity,handler:pr,context:m}),o.createElement(Mn,{eventType:O.FileVersions,handler:mr,context:m}),o.createElement(Mn,{eventType:O.GetWopiInfoFromUrl,handler:dr,context:m}),o.createElement(Mn,{eventType:O.UI_Close,handler:gr,context:m}),o.createElement(Rr,{context:m,updateWacAppMode:b}))),o.createElement(q,{vault:r,dispatcher:L}))}function Ir(e){var t=e.item,n=e.vault,r=e.diagnostics,i=e.viewParams,u=e.wacDataSource,a=e.applicationUrl,f=e.applicationParams,l=e.resources,c=Object(o.useRef)(null),h=Object(o.useState)(function(){return jr({redeemDialogHandleRef:c,diagnostics:r,viewParams:i,item:t,resourceScope:l,wacDataSource:u,vault:n})}),p=h[0],d=h[1],v=Object(o.useCallback)(function(e){d(function(t){return Object(s.e)(Object(s.e)({},t),{Mode:e.NewMode})})},[d]),m=Object(o.useState)(function(){return new N})[0],g=Object(o.useCallback)(function(e){e.state?m.respond({MessageId:C.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:$t.e.generate()}):window.history&&window.history.back()},[m]);Object(o.useEffect)(function(){window.addEventListener("popstate",g);return function(){window.removeEventListener("popstate",g)}},[m]);return o.createElement(Y.e,{resources:l},o.createElement(kn,{diagnostics:r},o.createElement(On.e,{dispatcher:m},o.createElement(Tr,{applicationUrl:a,params:f,migrationState:Ur()}),o.createElement(xr,{redeemDialogHandleRef:c,callerCid:p.callerCid,item:t,signInUrl:p.SignInUrl,autoRedeemSignOut:p.autoRedeemSignOut,autoRedeemUrl:p.autoRedeemUrl,authKey:p.authKey}),o.createElement(Rr,{context:p,updateWacAppMode:v}))),o.createElement(q,{vault:n,dispatcher:m}))}function qr(e){var t=e.token,n=e.diagnostics,r=e.wacDataSource,i=e.viewParams,u=e.migration,a=e.resources,f=Object(o.useRef)(null),l=Object(o.useState)(function(){return jr({redeemDialogHandleRef:f,diagnostics:n,viewParams:i,resourceScope:a,wacDataSource:r})}),c=l[0],h=l[1],p=Object(o.useCallback)(function(e){h(function(t){return Object(s.e)(Object(s.e)({},t),{Mode:e.NewMode})})},[h]),d=Object(o.useState)(function(){return new N})[0],v=Object(o.useCallback)(function(e){e.state?d.respond({MessageId:C.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:$t.e.generate()}):window.history&&window.history.back()},[d]);Object(o.useEffect)(function(){window.addEventListener("popstate",v);return function(){window.removeEventListener("popstate",v)}},[d]);var m=Object(o.useCallback)(function(e){if(e){var t=e.page,n=e.item,r=e.wopiContext;n.id="".concat(u.hcid,"!s").concat(n.id.slice(1,-1).replace(/-/g,""));var i=t.title,o=t.faviconLink,a=t.queryUrl;i&&(document.title=i);if(o){var f=document.head.querySelector('link[rel="icon"]');if(null!==f)f.href=o;else{(f=document.createElement("link")).rel="icon";f.href=o;f.type="image/x-icon";document.head.appendChild(f)}}if(a){-1===a.indexOf("?cid=")&&-1===a.indexOf("&cid=")&&(a+="&cid="+u.hcid);var l=location.href.substring(0,location.href.indexOf(location.search)+1);window.history.replaceState({},"",l+a)}new y.e({name:"Convergence.WacOpen"}).end({resultType:y.t.Success,resultCode:"Success",error:""});h(function(e){return Object(s.e)(Object(s.e)({},e),{item:Object(s.e)(Object(s.e)({},n),{graph:{itemId:n.id,driveId:Object(Qn.e)(u.hcid)}}),wacIframeDomain:r.WebAppUrl})})}},[h,u.hcid]);return o.createElement(Y.e,{resources:a},o.createElement(On.e,{dispatcher:d},t.accessToken?o.createElement(Nr,{docAspxUrl:u.DocAspxUrl,token:t}):null,c.item?o.createElement(xr,{redeemDialogHandleRef:f,callerCid:c.callerCid,item:c.item,signInUrl:c.SignInUrl,autoRedeemSignOut:c.autoRedeemSignOut,autoRedeemUrl:c.autoRedeemUrl,authKey:c.authKey}):null,o.createElement(Mn,{eventType:_n.COB_SyncPageContext,handler:m,context:c}),o.createElement(Rr,{context:c,updateWacAppMode:p})))}function Rr(e){var t=e.context,n=e.updateWacAppMode;if(!t.item)return null;var r=t.item;return o.createElement(o.Fragment,null,o.createElement(Pn.e,{eventType:C.e.UI_CheckUserAccessAndGrantPermissions},o.createElement(br,Object(s.e)({itemName:r.name,listItemId:r.id},t.shareDialog))),o.createElement(Mn,{eventType:C.e.SetOverlayContent,handler:sr,context:t}),o.createElement(Mn,{eventType:C.e.App_LoadingStatus,handler:ir,context:t}),o.createElement(Mn,{eventType:C.e.UI_CopyAndEdit,handler:or,context:t}),o.createElement(Mn,{eventType:C.e.App_WopiDavUrlFromIds,handler:ur,context:t}),o.createElement(Mn,{eventType:C.e.App_WopiInfoFromUrl,handler:dr,context:t}),o.createElement(Mn,{eventType:C.e.Edit_Notification,handler:ar,context:t}),o.createElement(Pn.e,{eventType:C.e.UI_FileEmbed},o.createElement(Er,{item:t.item})),o.createElement(Mn,{eventType:C.e.App_GetCustomAuthConfig,handler:fr,context:t}),o.createElement(Mn,{eventType:C.e.App_RefreshSessionInfo,handler:lr,context:t}),o.createElement(Mn,{eventType:C.e.File_Rename,handler:cr,context:t}),o.createElement(Pn.e,{eventType:C.e.UI_Sharing},o.createElement(wr,Object(s.e)({itemName:r.name,listItemId:r.id},t.shareDialog))),Jn(ye.ee)?o.createElement(Pn.e,{eventType:C.e.App_MoveToFolder},o.createElement(kr,{item:r})):null,Jn(ye.Z)?o.createElement(Pn.e,{eventType:C.e.App_FilePicker},o.createElement(Cr,{item:r})):null,o.createElement(Mn,{eventType:C.e.UI_SignIn,handler:hr,context:t}),o.createElement(Mn,{eventType:C.e.User_Activity,handler:pr,context:t}),o.createElement(Mn,{eventType:C.e.UI_FileVersions,handler:mr,context:t}),o.createElement(Mn,{eventType:C.e.UI_FileProperties,handler:vr,context:t}),o.createElement(Mn,{eventType:C.e.App_PushState,handler:yr,context:t}),o.createElement(Mn,{eventType:C.e.App_SwitchMode,handler:n,context:t}))}function Ur(){var e=window.WacConfig;return!!e&&(!!e.MigrationState||!!e.Migration)}function zr(e,t){return(function(e){if(!Ur())return e;if(!Ft.e.isActivated("F1ECDFC1-79AA-4298-BF16-D19171FA771C","3/8/2023","KillSwitch to Update Language Param from mkt")&&$Config.mkt){var t=new l.t(e);t.setQueryParameter("ui",$Config.mkt,!0);t.setQueryParameter("rs",$Config.mkt,!0);return t.toString()}return e})((function(e){if(!Ur())return e;try{var t=new l.t(e),n=JSON.parse(t.getQueryParameter("sc"));n=n?Object(s.e)(Object(s.e)({},n),{pmo:n.pmo||Or}):{pmo:Or};t.setQueryParameter("sc",encodeURIComponent(JSON.stringify(n)),!0);return t.toString()}catch(t){Object(T.e)("can not add sessionContext: ",t);return e}})((function(e,t){if(!Ur())return e;if(0===t){var n=new l.t(e);n.setQueryParameter("new","1",!0);return n.toString()}return e})(e,t)))}function Wr(){window.location.href="https://onedrive.live.com/error.html"}(function(){var e,t,r,i,c,h,p,d,v;Object(s.t)(this,void 0,void 0,function(){var y,b,w,E,S,x,N,C,k,L,A,O,M,D,P,H,B,j,F,I,q,R,U,z,W,Y,ee,te,ne,ie,se;return Object(s.i)(this,function(s){switch(s.label){case 0:s.trys.push([0,14,,15]);y=window.WacConfig;b=(function(){var e,t=Hr();e=t?new g(t.entryPoint,t.clickTime):new g;var n=window.$Config,r=window.WacConfig;e.update({serverStartTime:(null==r?void 0:r.ServerStartTime)?Number(null==r?void 0:r.ServerStartTime):void 0,pageTaskCompleteTime:(null==r?void 0:r.WacPageTaskCompleteTime)?Number(null==r?void 0:r.WacPageTaskCompleteTime):void 0,responseStartTime:n.pageResponseStartTime?Number(n.pageResponseStartTime):void 0,responseCompleteTime:n.pageResponseCompleteTime?Number(n.pageResponseCompleteTime):void 0,hostPageFirstFlushTime:Date.now()});if(window.performance&&window.performance.timing){var i=window.performance.timing;e.update({hostPageFetchStartTime:i.fetchStart,hostPageNavigationStartTime:i.navigationStart})}return e})();if(window.history&&window.history.replaceState){w=window.location.href.replace(/&(wdo|wdfre)=\d+/gi,"");window.history.replaceState(null,document.title,w)}(function(e){e.expose(V.e,new f.e);e.expose(J.h,new(e.injected(xn)));e.expose(Z.u,new(e.injected(dn)));e.exposeFactory(J.i,new $.e(Q.e));e.expose(K.t,new(e.injected(G.e)));e.exposeFactory(J.c,new $.e(K.t));var t=new(e.injected(re));e.expose(J.n,t);e.expose(J.u,t);e.expose(J.e,t);e.expose(J.a,t);e.expose(K.e,t);e.expose(Z.o,new(e.injected(oe)));e.expose(J.s,new(e.injected(qt)));e.expose(Z.r,new(e.injected(rn)));e.exposeAsync(J.r,new $.t(function(){return n.ee([42],701).then(function(e){return e.resourceKey})}));e.expose(J.t,new(e.injected(Xn)));e.expose(Z.t,new(e.injected(Nn)))})(X);E=new f.e;S=E.viewParams;x=Object(Hn.n)({apiVersion:"v1.0",driveId:(null===(e=y.viewParams)||void 0===e?void 0:e.cid)||(null==S?void 0:S.cid)||(null===(t=y.Migration)||void 0===t?void 0:t.hcid),includeViewerId:!1,migrationState:Ur()});N=X.consume(J.i);C=N.getIdentity().type===fe.e.anonymous;k=void 0;L=void 0;if(!(S&&S.redeem&&Ur()))return[3,8];s.label=1;case 1:s.trys.push([1,7,,8]);return C?[4,Dr()]:[3,3];case 2:k=s.sent();return[3,5];case 3:return[4,N.getSessionToken()];case 4:L=s.sent();s.label=5;case 5:return[4,Pr(k,L,S.redeem)];case 6:(null==(A=s.sent())?void 0:A.error)&&(function(e,t){var n;if(e&&e.innerError&&"sharingPasswordRequired"===e.innerError.code)if(0===(null===(n=e["@error.fixItUrl"])||void 0===n?void 0:n.indexOf(Or)))window.location.href=e["@error.fixItUrl"];else{var r=new l.t(Or);r.setQueryParameter("v","validatepermission",!0);r.setQueryParameter("redeem",null==t?void 0:t.redeem,!0);r.setQueryParameter("migratedtospo","true",!0);r.setQueryParameter("cid",null==t?void 0:t.cid,!0);r.setQueryParameter("id",null==t?void 0:t.resid,!0);r.setQueryParameter("ithint",null==t?void 0:t.ithint,!0);window.location.href=r.toString()}})(A.error,S);return[3,8];case 7:O=s.sent();Object(T.e)("can not acquire badger token or session token, can not complete redeem operation: ",O);Wr();return[2];case 8:M=new _(x,N,k);(D=document.createElement("div")).id="app";document.body.append(D);if(!y.Migration)return[3,12];if(!k)return[3,9];H={accessToken:k.token,isBadger:!0};return[3,11];case 9:return[4,N.getSessionToken()];case 10:H=s.sent();s.label=11;case 11:P=H;u.render(o.createElement(qr,{diagnostics:b,token:P,wacDataSource:M,viewParams:S,authSessionId:$Config.authSessionId,email:$Config.email,migration:y.Migration,resources:X}),D);return[2];case 12:return[4,_r(M,S,b)];case 13:if(!(B=s.sent())){Wr();return[2]}j=void 0;j=C?tr.e.ConsumerAnonymous:Object(rr.e)($Config.hcid)?tr.e.ConsumerOnSPO:tr.e.Consumer;Object(a.t)({ClientName:"WacHost.".concat(null===(r=y.Unified)||void 0===r?void 0:r.WacApplication),Application:y.Application,Mode:y.Mode||y.OriginalMode,OriginalMode:y.OriginalMode,AccountType:tr.e[j]});F=(function(e){var t=Object(er.n)(),r=t.ariaEnvironment,i=t.version,s=t.ariaContext,o=e.clientName;if(r&&"dev"!==i||Object(ye.te)(ye.w)){var u=Object(Yn.e)({clientName:o,ariaEnvironment:r,ariaContext:s,ariaLoader:function(){return n.ee(0,710,7)},disableCookies:s.disableCookies,tenantToken:"prod"===r?Zn.e.prod:Zn.e.ppe});u.attach(Object(Gn.e)());return u}return null})({clientName:null===(i=y.Unified)||void 0===i?void 0:i.WacApplication});(null===(c=y.Unified)||void 0===c?void 0:c.HostSessionId)&&F&&F.updateContext({customerPromiseSessionId:null===(h=y.Unified)||void 0===h?void 0:h.HostSessionId,accountType:tr.e[j]});I=!!B.vault;q=I?new m($Config.unid,M):void 0;R=null===(p=y.Unified)||void 0===p?void 0:p.WacBootstrapperUrl;if(!y.UseUnifiedApps||!y.Unified){if(Ur()){U=null===(v=null===(d=B.itemFromServer)||void 0===d?void 0:d.openWith)||void 0===v?void 0:v.wac;Y=zr(U.applicationUrl,B.size);(z={}).access_token=U.accessToken;z.access_token_ttl=U.accessTokenExpiry;z.owner_id=B.ownerId;z.user_id=$Config.hcid;y.Legacy={Url:Y,Params:z}}if(!y.Legacy){W="Edit"===y.OriginalMode;Y=W?B.urls.wacIframeEdit:B.urls.wacIframeView;ee={};null==(te=W?B.urls.wacIframeEditPostParameters:B.urls.wacIframeViewPostParameters)||te.split("&").forEach(function(e){var t=e.split("=");ee[decodeURIComponent(t[0])]=decodeURIComponent(t[1])});y.Legacy={Url:Y,Params:ee}}ne=y.Legacy.Url;ie=y.Legacy.Params;u.render(o.createElement(Ir,{item:B,vault:q,viewParams:S,wacDataSource:M,diagnostics:b,resources:X,applicationUrl:ne,applicationParams:ie}),D);return[2]}u.render(o.createElement(Fr,{item:B,vault:q,viewParams:S,wacDataSource:M,bootstrapperUrl:R,diagnostics:b,resources:X}),D);return[3,15];case 14:se=s.sent();Object(T.e)("error when rendering app: ",se);return[2];case 15:return[2]}})})})()}]));define("ODCWacHostWebpack",[],{});