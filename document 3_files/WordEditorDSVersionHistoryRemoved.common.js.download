/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1487:function(E,K,c){c.d(K,"a",function(){return n});E=c(0);var l=c(2),f=c(1964),a=c(48),k=c(7),x=c(1616),y=c(1575);class n{static MIa(u,z){u||(k.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",z),n.ag())}static Tmc(u,z){u&&u.count||(k.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",z),n.ag())}static w1(u,z){n.MIa(u,z);u.isConnected||(k.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",z),n.Wk())}static Qx(u,z){null===u&&(k.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",z),n.nd())}static Umc(u,z){u&&""!==u||(k.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",z),n.nd())}static nUa(u,z){if(null===u||0>=u)k.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",z,u),n.nd()}static mUa(u,z){if(null===u||0>u)k.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",z,u),n.nd()}static EP(u){if("number"===typeof u)return u;n.nd();return 0}static KIa(u,z,w){n.Umc(u,z);var F=f.a.uua(u);F=""!==F?F:u;"#"!==F.charAt(0)&&(F="#"+F);let G=!1;if(7>F.length)G=!0;else for(let H=1;7>H;H++){const L=F.charAt(H);if(!("0"<=L&&"9">=L||"A"<=L&&"F">=L||"a"<=L&&"f">=L)){G=!0;break}}if(G)throw k.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",w.appId,z,u),OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return n.zFn(F)}static zFn(u){return u.substring(5,7)+u.substring(3,5)+u.substring(1,3)}static JM(u,z,w=0,F=!0){k.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:u,["BlobSize"]:w,["Latency"]:z,["ExecutionStatus"]:F})}static iN(u){return(new Date).getTime()-u}static ag(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.generalException,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static nd(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static wk(u=""){if("Getter"!==u)throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static Jpb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.Ryb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static Wk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.XUm,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static Wig(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notSupported,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static nlc(u,z,w="",F=""){u="AppId:"+u+",";u=(""!==w?u+("Property"+w):u+"Method")+(":"+z+", currently is not allowed on Word Wac");""!==F&&(u+=" for Parameter:"+F);k.ULS.sendTraceTag(19415938,369,15,u);"Getter"!==w&&n.jD()}static jD(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notAllowed,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static rIo(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.rwn,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static yi(){return l.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static Xbd(){return l.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static Voe(){return l.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get uza(){return a.a.eZf}static DHc(u){u=(u||
"").replace(RegExp("\\r","g"),"\\r");u=u.replace(RegExp("\\n","g"),"\\n");return u=u.replace(RegExp("\\v","g"),"\\v")}static ckc(u){return u.split(RegExp("\r\n|\r|\n"))}static J7i(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static y3f(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static ySn(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorRangeTextEnabled",
!1)}static nua(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}static m3o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomXmlPartApiIsEnabled",!1)}static cEl(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixGetHtmlStyleBug",!1)}static RHh(){var u;l.AFrameworkApplication.te("46ab6280;fg4g7862");return null===(u=l.AFrameworkApplication.K)||void 0===u?
void 0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static Ckf(){l.AFrameworkApplication.te("241fi198;754i3702");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",!1)}static BMc(){l.AFrameworkApplication.te("0cdc8638;0cdc8638");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static FKj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentInsertFileFromBase64ApiIsEnabled",
!1)}static q3o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",!1)}static p3o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",!1)}static qNh(){var u;l.AFrameworkApplication.te("aa6dc483;d84c1847");return null===(u=l.AFrameworkApplication.K)||void 0===u?void 0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static s3o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",
!1)}static Jvj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static OKc(u){null!==u&&void 0!==u&&u.length&&u.some(z=>-1===n.m$c(z))&&n.nd()}static Phf(u,z){null!=u&&(u=n.m$c(u),k.ULS.sendTraceTag(509616404,369,50,`${z}.insertContentControl(${x.a[u]})`),-1===u&&n.nd())}static m$c(u,z=-1){switch(u){case 96:return 1;case 31:return 0;default:return z}}}n.Okb="\r";n.KUh=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);n.Lha=9;Object(E.a)(n,
"Utility",null,[])},1498:function(E,K,c){c.d(K,"f",function(){return w});c.d(K,"e",function(){return F});c.d(K,"d",function(){return G});c.d(K,"g",function(){return H});c.d(K,"h",function(){return L});c.d(K,"a",function(){return I});c.d(K,"j",function(){return N});c.d(K,"i",function(){return P});c.d(K,"c",function(){return M});c.d(K,"b",function(){return J});var l=c(56),f=c(7),a=c(1505);c.n(a);E=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},
{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];K=[{role:1,QG:{default:"Unknown",BJ:null}},{role:2,QG:{default:"Title",BJ:Box4Intl.Box4Strings.L_StyleWordTitle}},
{role:3,QG:{default:"Subtitle",BJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,QG:{default:"Heading1",BJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,QG:{default:"Heading2",BJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,QG:{default:"Heading3",BJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,QG:{default:"Heading4",BJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,QG:{default:"Heading5",BJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,QG:{default:"Heading6",BJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},
{role:10,QG:{default:"Heading7",BJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,QG:{default:"Heading8",BJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,QG:{default:"Heading9",BJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,QG:{default:"BodyText",BJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,QG:{default:"Caption",BJ:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,QG:{default:"ListItem",BJ:null}},{role:16,QG:{default:"SubtleEmphasis",BJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},
{role:17,QG:{default:"Emphasis",BJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,QG:{default:"IntenseEmphasis",BJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,QG:{default:"Strong",BJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,QG:{default:"Quote",BJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,QG:{default:"IntenseQuote",BJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,QG:{default:"SubtleReference",BJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,
QG:{default:"IntenseReference",BJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,QG:{default:"BookTitle",BJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,QG:{default:"NoSpacing",BJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const k=new Map(K.map(V=>[V.QG.default,V.role])),x=new Map(K.map(V=>[V.role,V.QG.default])),y=new Map(K.map(V=>[V.role,V.QG.BJ])),n=new Map(E.map(V=>[V.roleType,V.role])),u=new Map(E.map(V=>[V.role,V.roleType])),z=(V,X,W)=>V.has(X)?V.get(X):W,w=V=>z(k,V,1),
F=V=>z(n,V,1),G=V=>z(u,V,a.RoleType.Unknown),H=V=>z(x,V,"Unknown"),L=V=>z(y,V,null),I=V=>{switch(V){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},N=V=>{switch(V){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";
case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},P=V=>{switch(V){case 13:return l.StyleReader.wordStyleIdNormal;
case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.s8a;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.knc;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.l8a;case 8:return l.StyleReader.m8a;case 9:return l.StyleReader.n8a;case 10:return l.StyleReader.Eqb;case 11:return l.StyleReader.Fqb;case 12:return l.StyleReader.o8a;case 16:return l.StyleReader.r8a;case 17:return l.StyleReader.wUa;
case 18:return l.StyleReader.p8a;case 19:return l.StyleReader.rpg;case 20:return l.StyleReader.sRb;case 21:return l.StyleReader.q8a;case 22:return l.StyleReader.spg;case 23:return l.StyleReader.qpg;case 24:return l.StyleReader.ppg;case 25:return l.StyleReader.rRb;case 14:return l.StyleReader.VKj;default:return f.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+H(V)),"Unknown"}},M=V=>{switch(V){case 18:case 21:case 23:return!0;default:return!1}},J=V=>4<=V&&12>=V},1499:function(E,
K,c){c.d(K,"c",function(){return H});c.d(K,"b",function(){return L});c.d(K,"t",function(){return N});c.d(K,"r",function(){return J});c.d(K,"q",function(){return V});c.d(K,"g",function(){return X});c.d(K,"d",function(){return W});c.d(K,"o",function(){return U});c.d(K,"n",function(){return Y});c.d(K,"a",function(){return ca});c.d(K,"e",function(){return aa});c.d(K,"i",function(){return fa});c.d(K,"m",function(){return pa});c.d(K,"s",function(){return ra});c.d(K,"j",function(){return la});c.d(K,"k",
function(){return qa});c.d(K,"h",function(){return La});c.d(K,"v",function(){return Pa});c.d(K,"u",function(){return Ka});c.d(K,"p",function(){return ja});c.d(K,"f",function(){return va});c.d(K,"l",function(){return xa});E=c(22);var l=c(58),f=c(112),a=c(131);K=c(392);var k=c(37),x=c(8),y=c(48),n=c(418),u=c(6),z=c(7),w=c(1508),F=c(1605);const G=()=>document.getElementById(a.AppFrame.rUa),H=new K.a,L=`.ParaWrappingDiv .${k.a.nJd}`,I=E.a.instance.Ue("Box4.CommentParagraphMapping"),N=[Box4Intl.Box4Strings.l_HK_Bold,
Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let P=void 0;const M=()=>{if(void 0===P){let ma;try{ma=CSS.supports("selector(:not(* *))")}catch(Ja){ma=!1}ma||z.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");P=ma}return P},J=ma=>!!ma&&!!ma.Df,V=(ma,Ja,oa,za)=>{if(!ma||!ma.objectId)return!1;
const Fa=oa.Db(l.a.Ff(ma.objectId)),kb=w.a.A8b(Fa,!0),fb=w.a.A8b(Fa,!1);if(!kb||!fb||kb===fb&&kb!==Ja||!x.ParagraphReader.XUc(Ja,kb,fb))return!1;ma=!0;var lb=!1;kb===Ja&&(lb=w.a.yba(Fa,oa,!0),ma=ma&&!!lb&&lb.Ib.cp<=za,lb=!!lb&&lb.Ib.cp===za);Ja===fb&&(Ja=w.a.yba(Fa,oa,!1),ma=ma&&!!Ja&&Ja.Ib.cp>za,lb=lb&&!!Ja&&Ja.Ib.cp===za);return ma||lb},X=ma=>{if(!ma)return null;ma=f.a.Db(ma,k.a.UGc);return null!==ma&&void 0!==ma?ma:[]},W=ma=>ma?f.a.Db(ma,k.a.vEd):null,U=(ma,Ja)=>{if(!ma)return-1;for(let oa=0;oa<
ma.length;oa++)if(ma[oa].vfc.equals(Ja))return oa;return-1},Y=(ma,Ja)=>{if(!ma)return-1;for(let oa=0;oa<ma.length;oa++)if(ma[oa].psi.equals(Ja))return oa;return-1},ca=ma=>`Comment Object Id: ${ma.objectId}`,aa=(ma=!1)=>va(G(),ma),fa=()=>y.a.Pj?Array.from(G().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")):ha()?Array.from(G().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):
[],pa=(ma,Ja=!1)=>{if(ma.Cj){for(const oa of ma.Qg.Qi)if(xa(oa,Ja))return!0;return!1}return xa(ma.htmlElement,Ja)},ra=ma=>!!ma&&!!ma.ia(u.a.iM,null),la=()=>{const ma=new Set,Ja=fa();for(let oa=0;oa<Ja.length;oa++)X(Ja[oa]).forEach(za=>{ma.add(za.toString())});return ma},qa=(ma,Ja)=>Ja?Na(ma,!0,Ja):sa(ma,!0),La=(ma,Ja)=>Ja?Na(ma,!1,Ja):sa(ma,!1),Pa=(ma,Ja)=>{wa(ma,Ja,!0);n.a.isEnabled&&!ma.rjb&&z.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${ma.id} StartParaId: ${Ja}`)},
Ka=(ma,Ja)=>{wa(ma,Ja,!1);n.a.isEnabled&&!ma.rjb&&z.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${ma.id} EndParaId: ${Ja}`)},Na=(ma,Ja,oa)=>{var za,Fa;const kb=ma.id.toString();return Ja?n.a.isEnabled?null!==(za=I.value.XZa.get(kb))&&void 0!==za?za:oa:ma.ia(u.a.rTa,oa):n.a.isEnabled?null!==(Fa=I.value.WZa.get(kb))&&void 0!==Fa?Fa:oa:ma.ia(u.a.hva,oa)},sa=(ma,Ja)=>{const oa=ma.id.toString();return Ja?n.a.isEnabled?I.value.XZa.get(oa):ma.getValue(u.a.rTa):n.a.isEnabled?
I.value.WZa.get(oa):ma.getValue(u.a.hva)},wa=(ma,Ja,oa)=>{const za=ma.id.toString();n.a.isEnabled?ma.rjb||(oa?I.value.XZa:I.value.WZa).set(za,Ja):ma.setValue(oa?u.a.rTa:u.a.hva,Ja)},ja=ma=>n.a.isEnabled?I.value.XZa.has(ma.objectId)&&I.value.WZa.has(ma.objectId):!0,ha=()=>0===F.a.Fj||2===F.a.Fj,va=(ma,Ja)=>{if(Ja&&(ha()||y.a.Pj)){if(M())return Array.from(ma.querySelectorAll(y.a.Pj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));Ja=y.a.Pj?ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart"):ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const oa=
Ja.length;if(0<oa){ma=ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const za=[];let Fa=0;for(let kb=0,fb=ma.length;kb<fb;kb++){const lb=ma[kb];Fa<oa&&Ja[Fa]===lb?++Fa:za.push(lb)}return za}}return Array.from(ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},xa=(ma,Ja)=>{if(Ja&&(ha()||y.a.Pj)){if(M())return!!ma.querySelector(y.a.Pj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");Ja=y.a.Pj?ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length:ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;
if(0<Ja)return Ja!==ma.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ma.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1502:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(2),f=c(1804),a=c(19);class k{static H8h(){return k.Vyk+"_"+f.a.fRc+"_"+a.a.YW(l.AFrameworkApplication.userName)+"_"}static b3h(x){return x+"_"+f.a.fRc+"_"+a.a.YW(l.AFrameworkApplication.userName)+"_"}static Zdi(){return k.JGn+
"_"+f.a.fRc+"_"+a.a.YW(l.AFrameworkApplication.userName)+"_"}}k.Lla="ack0";k.Nla="ack1";k.Ezd="ack2";k.Vyk="ack3";k.ODc="ack4";k.wqh="ack7";k.pIf="ack8";k.Pqj="ack9";k.z2e="ack10";k.Oqj="ack13";k.KEi="ack14";k.Gzd="AddinDetailsRefreshed";k.Tyk="DdaMethod";k.Syk="ControlId";k.Hzd="OsfcontrolId";k.A_e="SecurityOrigin";k.D0b="ak0";k.Zyk="ak1";k.zqh="ak2";k.PDc="ak4";k.vqh="Office.AutoShowTaskpaneWithDocument";k.xqh="value";k.Yyk="errorCode";k.Arl="SourceControlId";k.yrl="OsfControl";k.zrl="RibbonUpdaterData";
k.qle="AddinShared";k.JGn="__OSF_PRIVATECATALOG_ADDINIDS";Object(E.a)(k,"AddinConstantsString",null,[])},1504:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1822),K);f(c(1823),K);E.exports.ErrorCode||Object.defineProperty(E.exports,"ErrorCode",{enumerable:!0,get:function(){return E.exports.ErrorCode}});E.exports.FormattingSuggestionType||Object.defineProperty(E.exports,"FormattingSuggestionType",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionType}});E.exports.FormattingSuggestionsAnnotation||Object.defineProperty(E.exports,"FormattingSuggestionsAnnotation",{enumerable:!0,
get:function(){return E.exports.FormattingSuggestionsAnnotation}});E.exports.FormattingSuggestionsRange||Object.defineProperty(E.exports,"FormattingSuggestionsRange",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionsRange}});E.exports.FormattingSuggestionsSummaryAnnotation||Object.defineProperty(E.exports,"FormattingSuggestionsSummaryAnnotation",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionsSummaryAnnotation}})},1505:function(E,K,c){var l=this&&this.dC||(Object.create?
function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1806),K);f(c(1807),K);E.exports.DocumentRoleDetectionAnnotation||Object.defineProperty(E.exports,
"DocumentRoleDetectionAnnotation",{enumerable:!0,get:function(){return E.exports.DocumentRoleDetectionAnnotation}});E.exports.RoleDetectionAnnotation||Object.defineProperty(E.exports,"RoleDetectionAnnotation",{enumerable:!0,get:function(){return E.exports.RoleDetectionAnnotation}});E.exports.RoleDetectionCustomMetadata||Object.defineProperty(E.exports,"RoleDetectionCustomMetadata",{enumerable:!0,get:function(){return E.exports.RoleDetectionCustomMetadata}});E.exports.RoleDetectionSettings||Object.defineProperty(E.exports,
"RoleDetectionSettings",{enumerable:!0,get:function(){return E.exports.RoleDetectionSettings}});E.exports.RoleType||Object.defineProperty(E.exports,"RoleType",{enumerable:!0,get:function(){return E.exports.RoleType}})},1508:function(E,K,c){E=c(0);var l=c(22),f=c(80),a=c(58),k=c(2),x=c(720),y=c(135),n=c(239),u=c(602),z=c(9),w=c(5),F=c(249),G=c(8),H=c(418),L=c(361),I=c(1167),N=c(75),P=c(61),M=c(1766),J=c(1809),V=c(1810),X=c(15),W=c(6),U=c(588),Y=c(7),ca=c(110),aa=c(244),fa=c(77),pa=c(1668);class ra extends Sys.EventArgs{constructor(wa,
ja){super();this.graphNode=wa;this.s0k=ja}}Object(E.a)(ra,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class la extends Sys.EventArgs{constructor(wa,ja){super();this.graphNode=wa;this.qZk=ja}}Object(E.a)(la,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var qa=c(1199),La=c(1499),Pa=c(1569);class Ka extends Sys.EventArgs{constructor(wa){super();this.commentNode=wa}}Object(E.a)(Ka,"OnDeleteEventArgs",Sys.EventArgs,[]);class Na extends Sys.EventArgs{constructor(wa){super();this.commentNode=wa}}Object(E.a)(Na,
"OnPasteEventArgs",Sys.EventArgs,[]);c.d(K,"a",function(){return sa});class sa{static get characterPropertiesEditor(){return null!=sa.rwg?sa.rwg:sa.rwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get hd(){return null!=sa.Zxg?sa.Zxg:sa.Zxg=new f.a}static get UCa(){return Pa.a.instance}static get vj(){return z.App.xa.hb.Uc.od}static get Xb(){return null!=sa.Zyg?sa.Zyg:sa.Zyg=l.a.instance.Na("Box4.IFeatureHelper")}static isComment(wa){return 40===wa.Ve}static KXd(wa){return 40===wa.type}static RBf(wa){return!!wa&&
39===wa.Ve}static bTf(wa,ja){ja.property===X.a.ef&&(sa.XGb=!1)}static fTf(wa,ja){ja&&!wa.Mc&&sa.IPh(wa)}static IPh(wa){const ja=wa.Ib.paragraph.Jc;wa=ja.Db(wa.Xj);sa.NKc();wa&&wa.anchor&&sa.deleteComment(wa,ja)}static zaf(wa){const ja=new w.GraphIterator;ja.set(wa.Bi());sa.UCa.o4a(ja);return ja}static deleteComment(wa,ja){wa?(sa.NKc(),sa.ZHd(wa,ja),wa.anchor&&(sa.hd.raiseEvent(sa.q_c,new Ka(wa)),ja=wa.ia(W.a.XE,0),Y.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${wa.id}`),
sa.cPg.add(ja.toString()),ja=new w.GraphIterator,ja.set(wa),ja.zb(39),ja.Cg())):Y.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static YHm(wa){return sa.cPg.contains(wa)}static ZHd(wa,ja){sa.NKc();const ha=sa.yba(wa,ja,!0);ja=sa.yba(wa,ja,!1);sa.wnb(ha);sa.wnb(ja);ha&&ja&&ha.Ib===ja.Ib&&Y.ULS.sendTraceTag(50619292,327,10,`comment ${wa.id} start and end range objects belonged to same chp`)}static wnb(wa){if(wa&&wa.Ib.tf){wa.Ib.tf.remove(wa);const ja=wa.Ib.paragraph;0<=wa.pe&&wa.pe<
ja.xe.length&&(wa.Ib.cp||1!==ja.xe.length||(ja.xe.WX(0,4),ja.xe.jq.Z(1,F.CharacterPropertiesEditor.LM),ja.xe.$s.Z(1,F.CharacterPropertiesEditor.tR)),ja.xe.removeAt(wa.pe,4));ja.Xl()}}static Akn(wa,ja){if(ja){var ha=ja.paragraph;wa=ja.cpBegin;var va=ja.cpEnd;if(ha&&G.ParagraphReader.Vb(ha)&&(ha=ha.pa)){ja.Mo[sa.HEd]||(ja.Mo[sa.HEd]=[]);ja=ja.Mo[sa.HEd];for(let ma=0;ma<ha.length;ma++){const Ja=ha.J(ma).tf;if(!Ja)continue;const oa=Ja.length;var xa=ha.J(ma).cp;if(xa<wa||xa>va)for(xa=0;xa<oa;xa++)ja.push(Ja.J(xa))}}}}static Ljn(wa,
ja){if(ja&&(wa=ja.Mo[sa.HEd]))for(ja=0;ja<wa.length;ja++)sa.IPh(wa[ja])}static yba(wa,ja,ha){if(!wa)return null;const va=ha?La.k(wa,a.a.nil):La.h(wa,a.a.nil);ja=ja.Db(va);return ja?sa.Ava(ja,wa.id,ha):(ha||Y.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${wa.id} Anchor Id: ${va} ${sa.XHm(va)}`),null)}static XHm(wa){return H.a.isEnabled?`isDeletedParagraph: ${sa.jQh.has(wa.toString())}`:""}static Ava(wa,ja,ha){for(let va=0;va<wa.pa.length;va++){const xa=wa.pa.J(va);if(xa.tf)for(let ma=
0;ma<xa.tf.length;ma++)if(xa.tf.J(ma).Xj.equals(ja)&&ha===xa.tf.J(ma).Mc)return xa.tf.J(ma)}return null}static A8b(wa,ja){if(!wa)return null;ja=ja?La.k(wa,a.a.nil):La.h(wa,a.a.nil);return wa.Jc.Db(ja)}static vNc(wa,ja,ha,va=null){const xa=!va;for(let ma=0;ma<wa.pa.length;ma++){const Ja=wa.pa.J(ma);if(Ja.cp>=ja&&Ja.tf)for(let oa=0;oa<Ja.tf.length;oa++){const za=Ja.tf.J(oa).Xj.toString();if(Ja.tf.J(oa).Mc===ha&&(xa||va.contains(za)))return Ja.tf.J(oa)}}return null}static $_l(wa,ja,ha,va){for(let xa=
0;xa<wa.pa.length;xa++){const ma=wa.pa.J(xa);if(ma.cp>ja)break;if(ma.cp===ja&&ma.tf)for(let Ja=ma.tf.length-1;0<=Ja;Ja--){const oa=ma.tf.J(Ja).Xj.toString();if(ma.tf.J(Ja).Mc===ha&&va.contains(oa))return ma.tf.J(Ja)}}return null}static X_b(wa,ja,ha,va){let xa=null;for(let ma=0;ma<wa.pa.length;ma++){let Ja=wa.pa.J(ma);if(Ja.cp>=ha){Ja.cp>ha||!Ja.formatting?(xa=sa.characterPropertiesEditor.MY(wa,ma,ha,xa),Ja=wa.pa.J(ma)):xa=Ja.formatting;Ja.tf||(Ja.tf=new L.a(Ja));sa.Gyd(ja,Ja.tf,xa.Qj,va);break}Ja.formatting&&
(xa=Ja.formatting)}}static Gyd(wa,ja,ha,va){ha=ja.Ib.paragraph;const xa=new I.a(ja.Ib,null,wa,va);for(let ma=0;ma<ja.length;ma++)if(ja.J(ma).Xj===wa&&ja.J(ma).Mc===va){Y.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",wa,va);break}ja.add(xa);ha.Xl();xa.pe?ha.xe.WX(xa.pe-1,4):ha.xe.hoa(xa.pe,4);ha.xe.jq.Z(xa.pe,F.CharacterPropertiesEditor.LM);ha.xe.$s.Z(xa.pe,F.CharacterPropertiesEditor.tR);return xa}static NKc(){if(!sa.XGb){var wa=
new w.GraphIterator;wa.set(z.App.xa.hb.Uc);sa.UCa.o4a(wa);if(wa.Sb(1))for(;wa.vf(1););sa.XGb=!0}}static cCl(wa){const ja=new w.GraphIterator;ja.set(z.App.xa.hb.Uc);sa.UCa.o4a(ja);if(39!==ja.Ve)return!1;let ha;if(ha=ja.Sb(1)){if(ha.id.equals(wa))return!0;for(;ha=ja.vf(1);)if(ha.id.equals(wa))return!0}return!1}static BKb(wa,ja){sa.U3c(ja)}static gQj(wa,ja){H.a.isEnabled&&(wa=ja.node)&&(ja=G.ParagraphReader.RQ(wa),sa.Zee(ja)&&sa.jQh.add(wa.id.toString()))}static Zee(wa){return 0<wa?document.querySelector("div.PageContentContainer p[paraid='"+
wa+"']"):null}static U3c(wa){sa.J4f(G.ParagraphReader.PDb(wa));let ja=null;var ha=new w.GraphIterator;ha.set(wa);if(ha.Ep()&&(ha=N.a.Qs(ha,ha.origin),ha.moveNext()))for(;ha.moveNext();)if(G.ParagraphReader.sh(ha.iterator)){ja=ha.iterator.currentNode;break}if(ja){wa=G.ParagraphReader.PDb(wa);for(const va of wa)va.Mc&&(wa=va.Ib.paragraph.Jc.Db(va.Xj))&&(sa.wnb(va),sa.X_b(ja,wa.id,0,!0),La.v(wa,ja.id))}}static J4f(wa){for(const ja of wa)if(!ja.Mc){wa=ja.Ib.paragraph.Jc;const ha=wa.Db(ja.Xj);sa.deleteComment(ha,
wa)}}static QQd(wa,ja){const ha=[];if(!wa)return Y.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),ha;if(!wa.isConnected)return Y.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),ha;const va=sa.yba(wa,sa.vj,!0),xa=sa.yba(wa,sa.vj,!1);if(!va||!xa)return Y.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${wa.id}`),ha;wa=!1;let ma=va.Ib.paragraph;for(;ma&&(!ja||!ja(ma,ma===va.Ib.paragraph));){ma===va.Ib.paragraph&&(wa=!0);wa&&ha.push(ma);if(ma===
xa.Ib.paragraph)break;ma=G.ParagraphReader.jg(ma,!1)}return ha}static cTf(wa,ja){ja.Mo.Comments||(ja.Mo.Comments={});sa.h6d(ja.operation,ja.DYi,ja.original,ja.clone,ja.Mo.Comments,!0)}static eTf(wa,ja){ja.Mo.Comments||(ja.Mo.Comments={});sa.h6d(ja.operation,ja.DYi,ja.original,ja.clone,ja.Mo.Comments,!1)}static vln(wa,ja){ja.Mo.Comments||(ja.Mo.Comments={});wa=ja.Mo.Comments;if((ja=Object.keys(wa))&&0<ja.length)for(let ha=0;ha<ja.length;ha++){const va=wa[ja[ha].toString()];va&&(va.Xj=null,sa.wnb(va))}}static h6d(wa,
ja,ha,va,xa,ma){const Ja=ha.Jc;var oa=G.ParagraphReader.PDb(va);oa.sort((ab,Ga)=>ab.Ib.cp<Ga.Ib.cp||ab.Ib.cp===Ga.Ib.cp&&ab.Mc?-1:ab.Ib.cp===Ga.Ib.cp&&ab.Mc===Ga.Mc?0:1);const za=new fa.a,Fa=new aa.a,kb=sa.Xb.isFeatureEnabled(115);for(const ab of oa)if(Object(ca.a)(qa.PageView,P.InteractiveViewManager.instance.Bd)){var fb=Ja.Db(ab.Xj);if(fb&&fb.isConnected)if(ab.Mc)xa[ab.Xj.toString()]=ab;else{var lb=fb.ia(W.a.XE,0);oa=ma?sa.R1c(fb,va,wa,ja):sa.W1c(fb,va,wa,ja);if(ma)kb&&(lb=w.GraphIterator.$a(va),
lb.zb(25)&&lb.jd(25)&&pa.a.hd.raiseEvent(pa.a.dTi,new ra(lb.currentNode,oa.getValue(W.a.XE))));else{if(kb){var sb=oa.ia(W.a.XE,0);lb&&sb&&(Fa.nb(lb)?Fa.J(lb)!==sb&&Y.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",lb,sb,Fa.J(lb)):Fa.add(lb,sb))}oa.setValue(W.a.pjb,!0);fb.ia(W.a.r8e,null)||(lb=fb.ia(W.a.uNa,null))&&oa.setValue(W.a.r8e,lb);oa.setValue(W.a.uNa,k.AFrameworkApplication.userSessionId)}lb=
ab.Xj.toString();sb=xa[lb];ab.Xj=oa.id;if(!ma){ab.$u=null;fb=fb.getValue(W.a.zH);const Ga=oa.getValue(W.a.zH);xa[fb]=Ga;if(fb=oa.ia(W.a.iM,null))za.nb(fb)||za.add(fb,[]),za.J(fb).push(oa)}La.u(oa,va.id);va.id||Y.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");sb?(sb.Xj=oa.id,ma||(sb.$u=null),La.v(oa,sb.Ib.paragraph.id),delete xa[lb]):(sa.X_b(va,oa.id,ab.Ib.cp,!0),La.v(oa,va.id))}else Y.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",
sa.cCl(ab.Xj),!fb)),ab.Xj=null,sa.wnb(ab)}else ab.Xj=null,sa.wnb(ab);if(!ma){for(const ab of za){wa=ab.key;ja=ab.value;for(const Ga of ja)Ga.setValue(W.a.iM,xa[wa])}0<Fa.count&&kb&&(ha=w.GraphIterator.$a(ha),ha.zb(25)&&ha.jd(25)&&pa.a.hd.raiseEvent(pa.a.DVi,new la(ha.currentNode,Fa)))}va.ak()}static Dhf(wa,ja){if(wa.zb(25)&&wa.jd(25)&&!wa.Nr(16)){const ha=w.GraphIterator.$a(ja);ha.zb(39);ha.jd(39);ja=U.a(ha.currentNode,ja.Bi().Jc,!0);wa.Jf(ja,16)}}static q$e(wa,ja){var ha=ja.Bi().od;ha=U.a(wa,ha,
!0);ja=w.GraphIterator.$a(ja);sa.Dhf(ja,wa);ja.Sb(16);ja.Y2(ha,1,wa.id);return ha}static R1c(wa,ja,ha,va){sa.NKc();ja=sa.q$e(wa,ja);ja.rjb=!0;sa.Zwl(wa,ja,ha,va);return ja}static Zwl(wa,ja,ha,va){wa=new M.a(w.GraphIterator.$a(wa),w.GraphIterator.$a(ja),{});wa.COb=!0;ha=new x.a(ha,va,new J.a(wa,null));ha.Jh=!0;ha.Jl("ExecuteInternalCommentCopy");ha.run()}static W1c(wa,ja,ha,va){sa.NKc();var xa=ja.Bi().od;ja=w.GraphIterator.$a(ja);ja.zb(7);ja.jd(7);ja.Sb(16);xa=U.a(wa,xa,!0);xa.Zg(W.a.zH,y.a.create().toString());
xa.Zg(W.a.commentId,n.a.tF());let ma=!1;sa.QCi(xa.Hf(W.a.XE))?ma=!0:xa.Zg(W.a.XE,sa.qpf());ja.Jf(xa,1);sa.$wl(wa,xa,ha,va);ja.Fi(xa);ja.gF(1);ja.hhb(2);ja.Sb(2);xa.setValue(W.a.zH,ja.currentNode.Hf(W.a.Lc).toString());sa.hd.raiseEvent(sa.Jqn,new Na(xa));ma&&this.hOh.add(xa.id.toString());return xa}static $wl(wa,ja,ha,va){wa=new V.a(w.GraphIterator.$a(wa),w.GraphIterator.$a(ja),null,null);ha=new x.a(ha,va,wa);ha.Jh=!0;ha.Jl("ExecuteInternalCommentPaste");ha.run()}static qpf(){const wa=n.a.Hgc(1,this.pMi);
return sa.QCi(wa)?wa:sa.qpf()}static QCi(wa){if(!wa)return!1;if(z.App.xa){const ja=new w.GraphIterator;ja.set(z.App.xa.hb.Uc);sa.UCa.o4a(ja);let ha=ja.Qd();for(;ha;){if(ha.Hf(W.a.XE)===wa)return!1;ha=ja.Rj()}}return!0}static YZe(wa){sa.hd.addHandler(sa.q_c,wa)}}sa.Jqn="OnPaste";sa.q_c="OnDelete";sa.HEd="CommentRangesToTrimOutsideSelection";sa.cPg=new u.a;sa.XGb=!1;sa.pMi=2147483646;sa.hOh=new Set;sa.jQh=new Set;Object(E.a)(sa,"CommentEditor",null,[])},1513:function(E,K,c){c.d(K,"a",function(){return l});
E=c(0);class l extends Sys.EventArgs{constructor(f){super();this.data=f}}Object(E.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1517:function(E,K,c){c.d(K,"a",function(){return y});E=c(0);var l=c(6),f=c(286),a=c(1176),k=c(1080),x=c(7);class y{constructor(n,u,z,w){this.aYm=n;this.DCm=u;this.CCm=z;this.J0i=w}Hfc(n,u,z,w,F){n?(n=this.gIc(n,u,z),null!==n&&(w=this.G$e(w,n,F),this.CCm.setState(this.aYm.value,w))):x.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}gIc(n,u,z){return 0>z?(x.ULS.sendTraceTag(539018900,
389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):f.a.pIc(n.ia(l.a.Lc,-1),n.ia(l.a.sj,-1),u,z,u,z,n)}G$e(n,u,z){return Object.assign(new k.a,{annotationType:n,contentDescriptor:u,state:z})}uBf(n,u,z,w,F){if(n){var G=n.ia(l.a.Lc,-1),H=n.ia(l.a.sj,-1);-1===G||-1===H?F(null):(n=this.gIc(n,u,z),null===n?F(0):this.DCm.M_c(n,w,L=>{F(L)}))}else x.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}ABn(n){if(n){var u=a.a.t9k(n);this.J0i.loh({Eob:u,settingType:n})||x.ULS.shipAssertTag(521416710,
3016,!1,"Persist Designer suppression setting failed")}}sRm(n){return new Promise(u=>{this.J0i.jdi(n,z=>{(null===z||void 0===z?0:z.Eob)?u(z.Eob):u(null)})})}}y.O0f="WordDesignerPullQuotesAnnotation";y.JOh="WordDesignerDefaultAnnotation";y.Kgg="WordDesignerSuggestedImageAnnotation";y.nyj="WordDesignerThemeImageAnnotation";y.xgg="WordDesignerStylizedTitleAnnotation";y.V2b="WordDesignerComplexDecoratorAnnotationType";y.zQh="DesignerPaneSuppressionSetting";Object(E.a)(y,"PersistenceHelperImpl",null,[1003])},
1518:function(E,K,c){function l(I){return 1===(null===I||void 0===I?void 0:I.Fq)||3===(null===I||void 0===I?void 0:I.Fq)}E=c(0);var f=c(39),a=c(44),k=c(31),x=c(7),y=c(1618),n;(function(I){I[I.initial=0]="initial";I[I.k1o=.1]="viewingOriginal";I[I.IFk=.5]="applying";I[I.applied=1]="applied";I[I.accepted=2]="accepted";I[I.rejected=3]="rejected";I[I.skp=4]="roleChanged";I[I.Dgp=5]="invalidated"})(n||(n={}));Object(E.b)("ReviewIntentState",n);const u=I=>{switch(I){case n.k1o:return n.rejected;case n.IFk:return n.applied;
default:return I}};var z=c(134);c.d(K,"d",function(){return F});c.d(K,"e",function(){return l});c.d(K,"b",function(){return G});c.d(K,"c",function(){return H});c.d(K,"a",function(){return L});class w{constructor(I,N,P=null,M,J=!0){this.id=I;this.Fq=N;this.hE=P;this.Ud=M;this.mHm=J;this.gxi=!1;this.eEi=f.a.Ze()}gmi(){return!1}PQa(I){this.sca(n[u(I)]);this.N2d(I)}N2d(I){1===I&&this.hE&&this.Ud&&(this.mHm?(this.Ud.KEm()&&this.hE.execute(N=>{N.logActivity(z.a.cTj,null)}),2===this.Fq&&this.Ud.vSm()?this.hE.execute(N=>
{N.logActivity(z.a.sTj,null)}):1===this.Fq&&this.Ud.rOm()?this.hE.execute(N=>{N.logActivity(z.a.mTj,null)}):0===this.Fq&&this.Ud.pKm()&&this.hE.execute(N=>{N.logActivity(z.a.gTj,null)})):4===this.Fq&&this.Ud.hIm()&&this.hE.execute(N=>{N.logActivity(z.a.eTj,null)}))}aYc(){6E4>f.a.Ze()-this.eEi?this.sca("removed"):x.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Fq,"removedButKept")}M2m(){this.gxi||(this.sca("hovered"),this.gxi=!0)}sca(I){this.eEi=f.a.Ze();x.ULS.sendTraceTag(540357460,
3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Fq,I);a.a(z.a.Rkl,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.Fq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:I})])}}Object(E.a)(w,"DesignerSuggestion",null,[]);class F extends w{constructor(I,N=1,P=null,M,J=!1,V=0,X=""){super(I,N,P,M,J);this.i5a=V;this.l2c=X}}Object(E.a)(F,"PullQuoteSuggestion",w,[]);class G extends w{constructor(I,N,P,M=null,J,V){super(I,2,M,
J);this.zM=N;this.baseUrl=P;this.B_d=V;this.selectedIndex=0;this.tkc=z.a.nxm}Evm(){x.ULS.shipAssertTag(527708514,3016,this.tkc===z.a.ein,`${this.tkc}`);this.tkc=Math.min(this.zM.length,z.a.I3d)}gmi(){return this.tkc<Math.min(this.zM.length,z.a.I3d)}nEb(I){return I>=this.zM.length?(x.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.zM[I].imageId}Ouf(I){return I>=this.zM.length?(x.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.zM[I].thumbnailId}BX(I){return I>=this.zM.length?
(x.ULS.shipAssertTag(527708545,3016,!1),null):this.zM[I].altText?this.zM[I].altText:this.zM[I].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}bZl(I){var N;return I>=this.zM.length?(x.ULS.shipAssertTag(527210446,3016,!1),0):null!==(N=this.zM[I].score)&&void 0!==N?N:0}PQa(I){if(!this.B_d){const N=n[u(I)];x.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",
this.id,N);a.a(z.a.Bkl,!0,void 0,[Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:N})])}super.PQa(I)}}Object(E.a)(G,"ImageSuggestion",w,[]);class H extends w{constructor(I,N=null,P,M,J=null){super(I,0,N,P,M);this.metadata=J;this.LNi=!1}PQa(I){this.LNi||(this.LNi=!0,this.metadata&&a.a(z.a.j$k,!0,0,this.metadata.concat([Object.assign(new k.a,{name:"ID",string:this.id.toString()})])));super.PQa(I)}}Object(E.a)(H,"InconsistencySuggestion",w,[]);
class L extends w{constructor(I,N=null,P,M=!1,J){super(I,4,N,P,M);this.nAn=J}PQa(I){this.DDo=I;super.PQa(I)}}Object(E.a)(L,"DesignerPasteSuggestion",w,[])},1520:function(E,K,c){c.d(K,"a",function(){return l});const l={EFh:"CommentDeepLinkNavigationFailed",tEd:"CommentDataLoss",P2b:"CommentExperienceDegraded",ljf:"CommentsFeatureUsage",v8e:"CommentThreadInProgress",IEd:"CommentReplyInProgress",HFh:"CommentEditInProgress",uEd:"CommentDeepLink",CFh:"CommentCommit",Q2b:"CommentLoad",WFh:"CommentInitialization"}},
1521:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.kq="SpellingErrorV2";l.tfg="SpellingErrorV2Themed";l.j5k="ContextualSpellingAndGrammarErrorV2";l.Q9e="ContextualSpellingAndGrammarErrorV2Themed";l.Nzd="AdvancedProofingIssueV2Themed";l.q6i="AdvancedProofingIssueV2Themed";l.similarityReviewed="SimilarityReviewed";l.Fsj="SimilarityReviewedThemed";l.similarityUnreviewed="SimilarityUnreviewed";l.Gsj="SimilarityUnreviewedThemed";l.$jc="SpellingErrorHighlight";l.V8b="GrammarErrorHighlight";
l.wdb="CritiqueIndicatorHighlight";l.p6i="ReactiveRewriteIndicatorHighlight";l.wxo="SimilarityHighlight";l.xxo="SimilarityReviewedHighlight";l.cBd="IdeasSuggestionConfirmation";Object(E.a)(l,"CanvasContextualCssClasses",null,[])},1522:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x=!1,y=!1,n=!1,u=!1,z=null){this.ll=f;this.source=a;this.BQa=k;this.lfa=x;this.Ujc=y;this.vif=n;this.TNa=u;this.Lo=z}}Object(E.a)(l,"ContextualIntentInvocationParameters",null,[])},1523:function(E,
K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x,y=null,n=null,u=null,z=0,w=0){this.C4=this.alc=this.yGa=this.xR=null;this.DH=z;this.dce=f;this.KRa=a;this.n7a=k;x&&(this.xR=x);null!=y&&(this.yGa=y);null!=n&&(this.alc=n);u&&(this.C4=u);this.shapeId=w}}Object(E.a)(l,"AnchorData",null,[])},1525:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.completion=new Promise((f,a)=>{this.resolve=f;this.reject=a})}}Object(E.a)(l,"ControlledPromise",null,[])},
1528:function(E,K,c){c.d(K,"a",function(){return w});E=c(0);var l=c(19),f=c(177),a=c(9),k=c(529),x=c(43),y=c(17),n=c(23),u=c(235),z=c(8);class w{constructor(F,G,H,L,I){this.bGb=F;this.G1a=G;this.ovb=H;this.Hka=L;this.Kd=I;this.r4g=0;this.V$a=null;this.Shk=!1;this.$3g=!0;this.VZg=null;this.sZc=this.Jnd=!0;this.j0g=!1;this.kyc=F?F.innerText:z.ParagraphReader.text(G)}get VC(){throw Error.notImplemented("The inherit class should have the default value.");}set VC(F){}get IIb(){return this.r4g}Tnj(F){this.r4g=
F}get kb(){return this.V$a}set kb(F){this.V$a=F}get FG(){return this.ovb}get m0(){return this.Hka}get ywi(){return this.j0g}get ECi(){return!1}get Fxa(){return this.kyc}get rto(){return!0}invoke(){this.j0g=!0;if(this.bGb&&this.bGb.parentNode&&!this.VC){var F=this.bGb.innerText;if(this.sZc&&l.a.substring(this.kyc,this.ovb,this.Hka)!==l.a.substring(F,this.ovb,this.Hka))return 0;this.eCb(this.bGb);this.Tnj(this.bGb.innerText.length-F.length);return 1}this.Jnd||f.a.instance.Yb("MatchTextIsNotTheSame",
{["Reason"]:"MatchTextIsNotTheSame"});if(!this.$3g)return f.a.instance.Yb("AbortedAction",{["Reason"]:this.VZg}),0;var G=z.ParagraphReader.text(this.G1a);F=G.length;var H=this.kyc.length,L=l.a.substring(this.kyc,this.ovb,this.Hka).trimEnd();G=l.a.substring(G,this.ovb,this.Hka).trimEnd();this.rto&&L===G&&this.Hka>H&&(this.Hka=H);if(this.sZc&&L!==G)if(H=L.replace(RegExp('"',"g"),""),H===l.a.substr(G,0,H.length))this.Hka-=2;else return 0;if(a.App.qd.Qo&&k.CoauthLockEditor.getInstance().G6a(w.Xf.d7b(this.G1a)))return 0;
H=new x.GraphTransaction(15);H.Cb(this.G1a);H.fk=this.commandId;this.Rma(this.G1a);this.Tnj(z.ParagraphReader.textLength(this.G1a)-F);this.V$a&&!this.Shk&&y.SelectionEditor.km(this.V$a)&&(G=this.V$a.Oa,F=G.cpBegin,L=G.cpEnd,G=G.node,G===this.G1a&&this.IIb&&(F>=this.Hka&&(F+=this.IIb),L>=this.Hka&&(L+=this.IIb),this.V$a=n.SelectionFactory.LK(G,F,L)));H.dispose();return 2}GIj(){this.Jnd=this.GCh()}eCb(){}GCh(){var F=z.ParagraphReader.text(this.G1a);const G=l.a.substring(this.kyc,this.ovb,this.Hka).trimEnd();
F=l.a.substring(F,this.ovb,this.Hka).trimEnd();return G===F}static get Xf(){return u.a.instance}}Object(E.a)(w,"AAutoCorrectAction",null,[716])},1529:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(28),f=c(7);class a{constructor(k){this.ll=k}static create(k){if(!k)return f.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(E.a)(a,"ShowReviewArgs",null,[])},1530:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.data=this.landingTab=
null}}Object(E.a)(l,"LaunchData",null,[])},1534:function(E,K,c){c.d(K,"c",function(){return a});c.d(K,"a",function(){return k});c.d(K,"b",function(){return x});E=c(0);var l=c(1517);class f{constructor(y,n,u){this.suggestion=y;this.Fq=n;this.paragraphNode=u}get role(){switch(this.Fq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(E.a)(f,"AddEnhancementActionData",null,[]);class a extends f{constructor(y,n,u,z,w,F=1){super(y,F,n);this.i5a=u;this.l2c=z;this.callback=w}}Object(E.a)(a,
"AddPullQuoteActionData",f,[]);class k extends f{constructor(y,n,u=0){super(y,2,n);this.$na=u}}Object(E.a)(k,"AddCoverPhotoActionData",f,[]);class x{constructor(y,n,u,z,w){this.suggestion=y;this.Vr=n;this.o$b=u;this.TSc=z;this.IAd=w}get annotationType(){switch(this.suggestion.Fq){case 1:case 3:return l.a.O0f;case 2:return l.a.Kgg;default:return l.a.JOh}}get XQa(){return this.Vr&&1<=this.Vr.length?this.Vr[0]:null}}Object(E.a)(x,"AddDesignerSuggestionActionData",null,[])},1538:function(E,K,c){c.d(K,
"a",function(){return l});E=c(0);class l{}Object(E.a)(l,"OAuthResult",null,[])},1539:function(E,K,c){c.r(K);c.d(K,"FindManagerHelper",function(){return y});E=c(0);var l=c(7),f=c(110),a=c(9),k=c(152),x=c(1043);c=c(1818);class y extends c.a{constructor(){super()}get Uc(){return a.App.xa.hb.Uc}get vj(){return a.App.xa.hb.Uc.od}get Boa(){return a.App.xa.hb.Boa()}get $Bf(){return a.App.xa.hb.rc.Vi}lZe(n){a.App.Tj.zl.JMa(n)}F4d(n,u,z){return x.b(n,u,z)}Ikg(n,u,z){if(1===z){if(!y.vh.Jkg(n))return!1}else if(!(n.Ve===
u||n.zb(u)&&n.jd(u)))return!1;return Object(f.a)(58,n.currentNode)||this.F4d(n,u,z)?!0:!1}hEa(n){return this.vj.Db(n).hEa()}bAi(n,u,z,w){if(!n||n.matchCase!==z.matchCase||n.matchWholeWord!==z.matchWholeWord||w.length!==u.length)return!0;for(n=0;n<w.length;n++){if(w[n]!==u[n])return!0;if(z.matchCase){if(w[n]!==u[n])return!0}else if(w[n].toLocaleLowerCase()!==u[n].toLocaleLowerCase())return!0}return!1}mAi(n,u,z,w){if(!n||n.matchWholeWord&&!z.matchWholeWord||n.matchCase&&!z.matchCase||w.length!==u.length)return!1;
if(n.matchWholeWord)return n.matchCase?u[0]===w[0]:w[0].toLocaleLowerCase()===u[0].toLocaleLowerCase();for(let F=0;F<w.length;F++)if(n.matchCase){if(!w[F].startsWith(u[F]))return!1}else if(!w[F].toLocaleLowerCase().startsWith(u[F].toLocaleLowerCase()))return!1;n.matchCase===z.matchCase&&n.matchWholeWord===z.matchWholeWord&&1===u.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});return!0}Bce(n,u,z){const w=a.App.Tj.zl.Ye(12);w.Go(n);w.Vt(u);
w.Ow(z)}static get vh(){return k.PageNavigator.instance}static get instance(){y.ltb||(y.ltb=new y);return y.ltb}}y.ltb=null;Object(E.a)(y,"FindManagerHelper",c.a,[])},1540:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(2);class f{constructor(){this.currentDocumentPath=l.AFrameworkApplication.K.jb("EditDocInClientUrl")}}Object(E.a)(f,"SmartLookupApplicationInterface",null,[])},1541:function(E,K,c){c.d(K,"a",function(){return P});E=c(0);var l=c(720),f=c(5),a=c(1766),k=c(1809),x=c(1810),
y=c(203),n=c(8),u=c(43),z=c(137),w=c(152),F=c(538),G=c(6),H=c(588),L=c(78),I=c(157),N=c(528);class P{constructor(M,J,V,X,W){P.kYd=!1;this.sE=M;this.EMe=J;this.DMe=V;this.Wc=X;this.p3j=W}Iho(M,J){this.sE.toa(M)&&M.properties.setValue(G.a.nna,J)}D5b(){if(!P.kYd){var M=this.Eci();for(var J=M.Sb(7);J;J=M.xi(7))for(J=M.Sb(8);J;J=M.xi(8));P.kYd=!0}}Eci(){const M=this.Wc.yk();M.set(this.p3j());P.vh.gP(M);return M}Pu(){const M=this.Eci();this.DMe.G4d(M);this.l2n(M.currentNode);P.kYd=!1}qHn(M){this.D5b();
if(M.isConnected){var J=this.S3(M);if(J=this.sE.aOc(M,J)){var V=this.Wc.yk();V.set(J);V.zb(25);M.anchor&&(V.set(M),V.zb(37),V.Cg())}}}Pul(M,J){if(M.zb(25)&&M.jd(25)&&!M.Nr(7)){const V=f.GraphIterator.$a(J);V.zb(37);V.jd(37);J=H.a(V.currentNode,J.Bi().Jc,!0);M.Jf(J,7)}}dxl(M,J,V,X){M=new a.a(f.GraphIterator.$a(M),f.GraphIterator.$a(J),{});M.COb=!0;V=new l.a(V,X,new k.a(M,null));V.Jh=!0;V.Jl("ExecuteInternalFootnoteEndnoteCopy");V.run()}q$e(M,J){J=J.Ib.paragraph;var V=J.Bi().od;V=H.a(M,V,!0);J=f.GraphIterator.$a(J);
this.Pul(J,M);J.Sb(7);J.Jf(V,8);return V}R1c(M,J,V,X){this.D5b();const W=this.S3(M);if(!this.sE.aOc(this.sE.Oci(M),W))return null;J=this.q$e(M,J);this.dxl(M,J,V,X);return J}W1c(M,J,V,X){this.D5b();var W=J.Ib.paragraph;const U=W.Bi().od;W=f.GraphIterator.$a(W);W.zb(7);W.jd(7);this.D4d(W,J.S3());J=H.a(M,U,!0);W.Jf(J,8);this.exl(M,J,V,X);return J}exl(M,J,V,X){M=new x.a(f.GraphIterator.$a(M),f.GraphIterator.$a(J),null,null);V=new l.a(V,X,M);V.Jh=!0;V.Jl("ExecuteInternalFootnoteEndnotePaste");V.run()}D4d(M,
J){M.Sb(7);this.sE.Lwi(M,J)||M.vf(7)}M$h(M,J){const V=this.Wc.yk();V.set(J);V.zb(7);V.jd(7);this.D4d(V,M);return V}sbi(M,J,V){return this.Bbi(M,J,V,!1)}s8l(M,J,V){return this.Bbi(M,J,V,!0)}Bbi(M,J,V,X){var W=this.Wc.yk();let U=null,Y=!1;W.set(M);W.Ep();W.jd(8);W.Qd();for(W=y.a.Qs(W,W.ibd(8));W.moveNext();){if(n.ParagraphReader.Vb(W.currentNode)){const aa=W.currentNode;var ca=L.i(aa,7);for(const fa of ca){if(aa===M){ca=fa.Ib.cp;if(X&&ca>=J)return U;ca>=J&&-1!==J&&(Y=!0)}if(fa.S3()===V){if(!X&&Y)return fa;
U=fa}}aa===M&&(Y=!0)}if(X&&Y)return U}return null}l2n(M){const J=new u.GraphTransaction(3);J.Cb(M);M=y.a.Zo(P.vh.Xs(M));let V=1,X=1;for(;M.moveNext();){var W=M.currentNode;if(W&&n.ParagraphReader.Vb(W)){W=L.i(W,7);for(const U of W){W=U.T3();const Y=U.S3()?V++:X++;this.Iho(W,Y)}}}J.dispose()}S3(M){return this.sE.toa(M)?M.properties.getValue(G.a.K3):0}static $Wl(){return new P(N.a.instance,z.PageReader.instance,w.PageNavigator.instance,new F.a,P.mKl)}static mKl(){return I.App.un.hb.Uc}static get vh(){return w.PageNavigator.instance}static get instance(){return null!=
P.zBg?P.zBg:P.zBg=P.$Wl()}}P.kYd=!1;Object(E.a)(P,"FootnoteEndnoteEditorInteractive",null,[393])},1547:function(E,K,c){E=c(0);class l{static F3l(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(E.a)(l,"EventReceiverIdCounter",null,[]);c.d(K,"a",function(){return f});class f{constructor(a,k){this.DUb=a;this._id=l.F3l();this.Qgk=k}get id(){return this._id}notify(a,k){this.Qgk(a,k)}Yj(a,k){return this.DUb.sKn(a,k?this:null)}}Object(E.a)(f,"EventReceiver",null,[602])},1550:function(E,
K,c){c.d(K,"a",function(){return H});E=c(0);var l=c(7),f=c(9),a=c(529),k=c(36),x=c(58),y=c(2028),n=c(2),u=c(1508),z=c(1520),w=c(116),F=c(593),G=c(1499);class H{static R4m(){const L=document.getElementsByClassName(F.a.QWf);if(L&&L.length){var I=L[0].clientWidth;for(let N=1;N<L.length;N++){if(L[N].clientWidth!==I||N===L.length-1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",L[N].clientWidth-I,L.length);break}I=L[N].clientWidth}}}static Prg(L,I,N){L&&(L=f.App.qd.Qp.urf(L),a.CoauthLockEditor.getInstance().G6a(L)&&
l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${I.objectId} added to a locked ${N?"start":"end"} paragraph. Lock Type ${L.Type.toString()}`))}static K0o(L,I,N){var P=I.Db(x.a.Ff(L.objectId));if(P){var M=u.a.yba(P,I,!0);I=u.a.yba(P,I,!1);null!==M&&void 0!==M&&M.$u||(M=G.k(P),l.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${M}, CommentObjectId: ${L.objectId}`),H.IIi(N));null!==I&&void 0!==I&&I.$u||(P=G.h(P),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${P}, CommentObjectId: ${L.objectId}`),
H.IIi(N))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${L.objectId}`)}static IIi(L){L.logKpiFailure(z.a.CFh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:z.a.tEd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static X3m(L,I,N){0!==L.size&&L.forEach(P=>{I.has(P)||H.b4m(P,N)})}static b4m(L,I){I.Db(x.a.Ff(L))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${L}`)}static mVk(L){const I=new Set;
L.forEach(N=>{N&&N.pj&&((N=H.uci(N))?I.add(N):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});I.forEach(N=>{const P=N.ia(w.a.z8e,[]);0===N.ia(w.a.x8e,[]).length&&0===P.length&&l.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${N.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static ZTm(L,I,N,P){L=N.N5h(L);if(!L)return!1;N=G.k(L,x.a.nil);P=P.Db(N);I.has(N.toString())&&l.ULS.sendTraceTag(539800643,
327,15,`Para Node ${N} missing comment reference for comment ${L.id}`);return P&&P.pj?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${N} with missing comment reference for comment ${L.id} is in a invalid state ${P?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static uci(L){let I;try{I=k.OutlineElementNavigator.Gl(L)}catch(N){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${L.id} OutlineNode failed to retrieve ${N}`)}return I}static hUl(L){var I;switch(null===(I=L.iz)||void 0===
I?void 0:I.sessionType){case y.a.create:return z.a.v8e;case y.a.reply:return z.a.IEd;case y.a.edit:return z.a.HFh}}static xCh(L){if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(L=L[1])&&0!==L.length){var I=new Set;for(let N=0;N<L.length;N++)I.add(L[N].UserId);L.length>I.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${L.length-I.size}`)}}}Object(E.a)(H,"CommentDiagnosticHelpers",null,[])},1551:function(E,
K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.open="open";l.refresh="refresh";l.L8f="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.Kaf="createNew";Object(E.a)(l,"ReasonList",null,[])},1552:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{static Y$c(f){if(!f)return"{NULL}";const a=f.length;if(600>=a)return f;const k=a-195;return f.substring(0,400)+"[...]"+f.substring(k,a)}}Object(E.a)(l,"LogUtils",null,[])},1553:function(E,K,c){c.d(K,"b",function(){return l});c.d(K,
"a",function(){return f});c.d(K,"c",function(){return a});const l=(k,x,y,n,u,z,w,F)=>{var G=1;if(!k&&!x||!y||!n)return G;u&&z?(z=y+k,G=n+x,k=1/y,x=1/n,u=k>x?k:x,1>z?z=1:1920<z&&(z=1920),1>G?G=1:1280<G&&(G=1280),k=z-y,x=G-n,F?(y=z/y,n=G/n,G=Math.abs(y-w)<Math.abs(n-w)?y:n):G=Math.abs(k/y)>Math.abs(x/n)?z/y:G/n,G<u&&(G=u)):u?(w=y+k,1>w?w=1:1920<w&&(w=1920),G=w/y):z&&(w=n+x,1>w?w=1:1280<w&&(w=1280),G=w/n);return G},f=(k,x)=>{k=Math.atan2(x.y-k.y,x.x-k.x);0>k&&(k+=2*Math.PI);return k},a=k=>{k%=360;0>
k&&(k+=360);return k}},1554:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}Object(E.a)(l,"SmartLookupSelection",null,[])},1556:function(E,K,c){c.d(K,"a",function(){return N});E=c(0);var l=c(22),f=c(889),a=c(538),k=c(32),x=c(152),y=c(6),n=c(42),u=c(15),z=c(7),w=c(110),F=c(73),G=c(55),H=c(469),L=c(144),I=c(1044);class N{constructor(P,M,J,V,X,W){this.dok=P;this.ve=M;this.Tvf=J;this.qLa=V;this.JBe=X;this.IBe=W}get vk(){return null!=this.eHg?this.eHg:this.eHg=l.a.instance.resolve("WordEditor.ITableEditor")}get Ld(){return null!=
this.hIg?this.hIg:this.hIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.OHg?this.OHg:this.OHg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get jRb(){return this.dok.value}get Nbd(){return this.ve.value}nYk(P){const M=this.jRb.C8b(P,f.a.n5d);M&&(this.C6a(M,P),this.Fya(1696,P))}C6a(P,M,J=!0){const V=this.jRb.Thb(M);if(V&&(P=this.Nbd.pg(P),V.Pi(P))){const X=this.jRb.aU(M);let W="Unknown";this.jRb.hta.value&&(W=
this.jRb.hta.value.nb(P)?P:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:W,["RowCount"]:this.JBe(M),["ColumnCount"]:this.IBe(M),["HR"]:!!(X&32),["FC"]:!!(X&128),["TR"]:!!(X&64),["LC"]:!!(X&256),["BR"]:!(X&512),["BC"]:!(X&1024),["TableId"]:M.id.toString()});J&&this.Yia(M);this.Tmg(M,V);J=V.Pi(P);M.properties.setValue(y.a.tableStyle,J.id);this.m7e(M);M.tT.z8(!0)}}m7c(P,M,J){if(P=this.jRb.C8b(J,P))this.Fya(M,J),this.C6a(P,J)}Fya(P,M,J=!0){J&&this.Yia(M);M.properties.setValue(y.a.tableLook,
P);z.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(P&32),["FC"]:!!(P&128),["TR"]:!!(P&64),["LC"]:!!(P&256),["BR"]:!(P&512),["BC"]:!(P&1024),["TableId"]:M.id.toString()});M.tT.z8(!0)}Tmg(P,M){(P=this.qLa(P))&&M.Yic(P)}m7e(P){if(P.isConnected){P.hasProperty(n.a.Tv)&&P.removeProperty(n.a.Tv);this.r5f(P);this.f4c(P);P=this.Tvf.Wf(P);for(var M=P.Sb(1);M;){for(M=P.Sb(1);M;)M.hasProperty(u.a.yH)&&M.removeProperty(u.a.yH),M.hasProperty(y.a.Gqa)&&M.removeProperty(y.a.Gqa),this.sSa(M),this.f4c(M),M=P.xi(1);M=
P.xi(1)}}}jSd(P){let M=P.ia(n.a.NRa,null);if(M)return M;if(P=this.Nbd.pg(P))if(M=({value:M}=this.jRb.hta.value.Dc(P,M)).returnValue?M:null)return M;return P}ujj(P,M,J,V,X){P.properties.setValue(M.style,J);P.properties.setValue(M.size,V*L.a.A1b);P.properties.setValue(M.color,X)}Yia(P){if(this.Ld.rg){var M;Object(w.a)(H.a,P)&&(M=Object(F.a)(H.a,P))&&(M=M.FR())&&this.lj.Yia(P,M)}}r5f(P){P.Eg(y.a.Wa,y.a.Xa,y.a.Fqa,y.a.ob,y.a.pb,y.a.Dqa,y.a.Ua,y.a.Va,y.a.Cqa,y.a.qb,y.a.rb,y.a.Eqa,y.a.tb,y.a.ub,y.a.Nya,
y.a.Lb,y.a.Mb,y.a.Oya)}sSa(P){P.Eg.apply(P,this.vk.a6e)}f4c(P){P.Eg(y.a.Ca,y.a.za,y.a.Aa,y.a.Ba,y.a.uP,y.a.QR,y.a.WHa,y.a.UHa)}static yuf(){return new N(l.a.instance.Ue("WordEditor.IWACTableStyleReader"),l.a.instance.Ue("Box4.Styles.IWACStyleReader"),new a.a,Object(G.a)(N.vh,N.vh.Xs,"navigateToPageContentNode"),k.TableReader.fg,k.TableReader.Yg,I.a.instance)}static get vh(){return x.PageNavigator.instance}static get instance(){return null!=N.xCg?N.xCg:N.xCg=N.yuf()}}Object(E.a)(N,"WACTableStyleEditor",
null,[381,382])},1557:function(E,K,c){c.d(K,"a",function(){return N});E=c(0);var l=c(112),f=c(2),a=c(540),k=c(238),x=c(335),y=c(1521),n=c(767),u=c(303),z=c(501),w=c(855);c.n(w);var F=c(603),G=c(1398),H=c(1653),L=c(102),I;(function(P){P[P.Spelling=0]="Spelling";P[P.Grammar=1]="Grammar";P[P.Style=2]="Style";P[P.Rnc=3]="Similarity";P[P.oqg=4]="ContextIQ";P[P.ZLj=5]="AutoReplace"})(I||(I={}));Object(E.b)("AnnotationRenderCategory",I);class N{static WRl(P){switch(N.vRd(P)){case I.Spelling:P=y.a.tfg;break;
case I.Grammar:P=y.a.Q9e;break;case I.Rnc:P=60!==P.M_.state&&70!==P.M_.state?y.a.Gsj:y.a.Fsj;break;case I.oqg:if(H.a.qqg()&&H.a.lBi(P))return;P=y.a.Nzd;break;case I.ZLj:P=y.a.cBd;break;default:P=y.a.Nzd}return P}static Jgm(P){switch(N.vRd(P)){case I.Spelling:return u.f.SpellingSquiggle;case I.Grammar:return u.f.GrammarSquiggle;default:return u.f.CritiqueSquiggle}}static vRd(P){let M;if(N.SVc(P))switch(P.priority){case 0:M=I.Spelling;break;case 1:M=I.Grammar;break;default:M=I.Style}else N.vbc(P)?M=
I.Rnc:N.WTc(P)&&(M=I.oqg);return M}static SVc(P){P=k.a.getTypeNameFor(P);return P===x.a.getTypeName()||P===n.a.getTypeName()}static WTc(P){return k.a.getTypeNameFor(P)===w.FlagAnnotation.getTypeName()}static vbc(P){return k.a.getTypeNameFor(P)===a.a.getTypeName()}static l_d(P){return N.SVc(P)?0===P.priority:!1}static DYd(P){return N.SVc(P)?1===P.priority:!1}static nEm(P){return k.a.getTypeNameFor(P)===n.a.getTypeName()}static zBf(P){return null!=P&&"Spelling"===P.categoryName&&1===P.suggestions.length&&
4===(P.suggestions[0].suggestionActions&4)}static udm(P,M){const J=[u.b.IgnoreOnce];switch(P){case 0:J.push(u.b.IgnoreAll);M&&J.push(u.b.AddToDictionary);break;case 1:J.push(u.b.Options)}return J}static K4h(P){return N.SVc(P)?P.categoryName:N.vbc(P)?N.Esj:N.WTc(P)?N.EEl:null}static Ptf(P,M){let J=z.a.gjc;switch(P){case 0:J=M?z.a.vhe:z.a.Noj;break;case 1:J=z.a.Moj}return J}static Q6b(P,M=!1,J){J="IntentProvider_Suggestion_"+J;let V=l.a.Db(P,J);M&&!V&&l.a.Kl(P,J,V=new F.a);return V}static rwf(P,M,J,
V,X,W,U,Y,ca=!1,aa){V&&J&&(!(J=W.V2h(J,X))||!f.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")&&f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.vRd(J)==I.Style||(U.gKd(P,M,Y),N.Q6b(P,!0,aa).add(J.id),M=N.WRl(J),P.classList.add(M),N.RQb&&N.mYe(P,J),ca&&G.a.dYc()))}static get RQb(){return null!=N.JIg?N.JIg:N.JIg=f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static mYe(P,
M){N.l_d(M)?P.setAttribute("aria-invalid","spelling"):N.DYd(M)&&P.setAttribute("aria-invalid","grammar")}static $Pa(P,M,J){P=(P=N.Q6b(P,!1,J))?L.firstOrDefault(P):null;return{returnValue:!!P,type:P?J:null,data:P}}}N.Esj="Similarity";N.EEl="FlagAnnotation";Object(E.a)(N,"AnnotationHelper",null,[])},1569:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(152),f=c(243);class a{o4a(k){a.vh.gP(k);return k.Sb(16)}static Jr(){return new f.a(()=>new a)}static get instance(){return a._instance.value}static get vh(){return l.PageNavigator.instance}}
a._instance=a.Jr();Object(E.a)(a,"CommentNavigator",null,[400])},1571:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l extends Sys.EventArgs{constructor(){super();this.RTi=this.eGa=null}}Object(E.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1572:function(E,K,c){c.d(K,"a",function(){return y});E=c(0);var l=c(54),f=c(145),a=c(7),k=c(84),x=c(60);class y{constructor(n,u,z){a.ULS.shipAssertTag(6305502,307,!!n);this.properties=n;this.Ic=u;this.$S=z}gdi(){return this.properties.ia(f.a.jP,"")}d2i(){return!0}GBj(){let n=
!1,u=null;const z=this.gdi();if(this.$S||""!==z)try{({Wua:u,returnValue:n}=this.Zlc(z))}catch(w){a.ULS.shipAssertTag(4203138,307,!1),this.Ic.Yb(k.a.gna,{["Reason"]:x.a.j4e}),l.a.f_(u)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Ic.Yb(k.a.n1,{["Reason"]:x.a.Oif});return{returnValue:n,uFd:u}}}Object(E.a)(y,"AStringInputImportStrategy",null,[678])},1573:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.o$=[]}v6h(){const f=new l;for(let a=0;a<
this.o$.length;a++)f.add(this.J(a));return f}get count(){return this.o$.length}J(f){return this.o$[f]}Z(f,a){return this.o$[f]=a}add(f){this.o$.push(f)}clear(){Array.clear(this.o$)}contains(f){return Array.contains(this.o$,f)}getRange(f,a){const k=new l;for(let x=0;x<a;x++)k.add(this.J(f+x));return k}indexOf(f){return Array.indexOf(this.o$,f)}insert(f,a){Array.insert(this.o$,f,a)}remove(f){return Array.remove(this.o$,f)}removeAt(f){Array.removeAt(this.o$,f)}removeRange(f,a){for(let k=0;k<a;k++)Array.removeAt(this.o$,
f)}reverse(){this.o$.reverse()}sort(){this.o$.sort()}toArray(){return Array.clone(this.o$)}}Object(E.a)(l,"List",null,[])},1575:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.generalException="GeneralException";l.invalidArgument="InvalidArgument";l.notImplemented="NotImplemented";l.Ryb="AccessDenied";l.XUm="ItemNotFound";l.notSupported="NotSupported";l.apiNotAvailable="ApiNotAvailable";l.notAllowed="NotAllowed";l.rwn="OperationCancelled";l.userNotSignedIn="UserNotSignedIn";l.userAborted=
"UserAborted";l.invalidResourceUrl="InvalidResourceUrl";l.invalidGrant="InvalidGrant";l.clientError="ClientError";l.serverError="ServerError";Object(E.a)(l,"ErrorCodes",null,[])},1576:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f){this.id=f}}Object(E.a)(l,"DesignerPaneToggleData",null,[])},1578:function(E,K,c){c.d(K,"a",function(){return x});E=c(0);var l=c(1852),f=c(538),a=c(6),k=c(1043);class x{constructor(y){this.NVl=(n,u)=>{const z=this.afi(n),w=this.Wc.Wf(u);return w.zb(z)?
(w.jd(z),new l.a(w.currentNode,u,n)):null};this.MVl=(n,u)=>{let z=null,w=null;const F=this.afi(n);u=this.Wc.Wf(u);({rootNode:z,gja:w}=this.ylo(u,n,F,z,w));return z&&w?new l.a(z,w,n):null};this.RVl=n=>{n=this.Wc.Wf(n);return(this.P8(2)||this.P8(4))&&n.zb(36)?(n.jd(36),this.PCl(n.currentNode)):(this.P8(8)||this.P8(16))&&n.zb(37)?(n.jd(37),this.UZh(n.currentNode)):this.P8(32)&&n.zb(40)?32:this.P8(1)&&n.zb(8)?1:0};this.Wc=y;this.QCl=this.RVl;this.BCl=this.NVl;this.ACl=this.MVl;this.fDl=31;this.Rgg=this.VVl()}n8h(y){const n=
[],u=this.QCl(y);if(u){var z=this.BCl(u,y);z&&(n[n.length]=z)}for(const w of this.Rgg)w!==u&&w&&(z=this.ACl(w,y))&&(n[n.length]=z);return n}P8(y){return!!y&&!!(this.fDl&y)}ylo(y,n,u,z,w){if(y.zb(7)){y.jd(7);if(8===u||37===u||39===u)for(var F=y.Qd();F;){if(F.type===u)if(37===u){if((8===n||16===n)&&n===this.UZh(F)){z=y.currentNode;break}}else{z=y.currentNode;break}F=y.Rj()}z&&y.wA()&&(F=this.Wc.Wf(z),k.b(F,u,n)&&(w=y.currentNode))}return{rootNode:z,gja:w}}VVl(){const y=[];this.P8(1)&&(y[y.length]=1);
this.P8(2)&&(y[y.length]=2);this.P8(4)&&(y[y.length]=4);this.P8(8)&&(y[y.length]=8);this.P8(16)&&(y[y.length]=16);this.P8(32)&&(y[y.length]=32);return y}afi(y){let n=8;switch(y){case 1:case 2:case 4:n=8;break;case 8:case 16:n=37;break;case 32:n=39}return n}UZh(y){y=y.properties.getValue(a.a.K3);return this.P8(8)&&1===y?8:this.P8(16)&&!y?16:0}PCl(y){y=y.getValue(a.a.m9b);return this.P8(2)&&x.LKm(y)?2:this.P8(4)&&x.jKm(y)?4:0}static WE(){return new x(new f.a)}static get instance(){return null!=x.FBg?
x.FBg:x.FBg=x.WE()}static LKm(y){return y&&1!==y&&2!==y?!1:!0}static jKm(y){return 3===y||4===y||5===y?!0:!1}}Object(E.a)(x,"WordFindContextHelper",null,[378])},1593:function(E,K,c){var l=c(1523);E=c(0);class f{}Object(E.a)(f,"SerializableAnchorDataV1",null,[]);class a{}Object(E.a)(a,"SerializableCpDataV1",null,[]);var k=c(983);c.d(K,"a",function(){return x});c.d(K,"c",function(){return y});c.d(K,"b",function(){return n});c.d(K,"d",function(){return u});const x=z=>new l.a(z.RK,z.PS,z.TS,c(1625).versionedDeserialize(z.OS),
z.PE,z.TE,c(1625).versionedDeserialize(z.OE),z.DK,z.SI),y=z=>{const w=new f;w.RK=z.dce;w.PS=z.KRa;w.TS=z.n7a;w.DK=z.DH;w.SI=z.shapeId;z.xR&&(w.OS=u(z.xR));z.yGa&&(w.PE=z.yGa);z.alc&&(w.TE=z.alc);z.C4&&(w.OE=u(z.C4));return w},n=z=>{if(!z)return null;const w=new k.a(z.CP);w.nva=null!=z.FB?z.FB:0;w.mga=null!=z.FE?z.FE:0;w.lua=null!=z.CB?z.CB:0;w.mua=null!=z.CE?z.CE:0;w.APa=null!=z.HB?z.HB:0;w.Wga=null!=z.HE?z.HE:0;w.qya=null!=z.R?z.R:0;w.kva=null!=z.E?z.E:0;w.Tya=null!=z.TW?z.TW:0;w.Ixa=null!=z.PB?
z.PB:0;w.symbols=null!=z.SYM?z.SYM:0;w.pwa=null!=z.IE?z.IE:0;w.pxa=null!=z.OO?z.OO:0;w.Bta=null!=z.AX?z.AX:0;w.rua=null!=z.CCI?z.CCI:0;w.dryDeletion=null!=z.DD?z.DD:0;return w},u=z=>{if(!z)return null;const w=new a;w.CP=z.cp;w.VS=1;0<z.nva&&(w.FB=z.nva);0<z.mga&&(w.FE=z.mga);0<z.lua&&(w.CB=z.lua);0<z.mua&&(w.CE=z.mua);0<z.APa&&(w.HB=z.APa);0<z.Wga&&(w.HE=z.Wga);0<z.qya&&(w.R=z.qya);0<z.kva&&(w.E=z.kva);0<z.Tya&&(w.TW=z.Tya);0<z.Ixa&&(w.PB=z.Ixa);0<z.symbols&&(w.SYM=z.symbols);0<z.pwa&&(w.IE=z.pwa);
0<z.pxa&&(w.OO=z.pxa);0<z.Bta&&(w.AX=z.Bta);0<z.rua&&(w.CCI=z.rua);0<z.dryDeletion&&(w.DD=z.dryDeletion);return w}},1603:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a="",k="",x=""){this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=k;this.Email=x}}Object(E.a)(l,"CommentTaskPerson",null,[1262])},1604:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x,y=!1){this.priority=this.completion=-1;this.type=f;this.user=a;this.time=
k;this.recordId=x;this.isLossy=y}}Object(E.a)(l,"HistoryRecord",null,[])},1605:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(498),f=c(392),a=c(614);class k{constructor(){this.xKg=null;this.gY=!1;this.gKb=this.Geb=null;this.Ox=new l.a(new f.a);this.KU=new l.a(new f.a);this.x2f=this.lGb=!1;this.L6a=!0}get $m(){return a.a.$m}set $m(x){a.a.$m=x}get ldb(){return this.xKg}set ldb(x){this.xKg=x}}k.Fj=1;Object(E.a)(k,"CommentsState",null,[])},1606:function(E,K,c){c.d(K,"a",function(){return l});
E=c(0);class l{}l.yellow="FFFF00";l.HYm="00FF00";l.NFk="00FFFF";l.bIl="FF00FF";l.blue="0000FF";l.red="FF0000";l.jfn="000080";l.teal="008080";l.green="008000";l.purple="800080";l.u$m="800000";l.bjn="808000";l.gray="808080";l.myo="C0C0C0";l.black="000000";Object(E.a)(l,"FontHighlightColorEnum",null,[])},1607:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.E$={};this.E$.ops=[]}aha(f){const a=this.E$.ops;if(a.length){var k=a.length-1;const x=a[k];if(!x.attributes){x.insert+=
f;a[k]=x;this.E$.ops=a;return}}k={};k.insert=f;Array.add(a,k)}Cri(f,a){const k={};this.mmj(k,a);Array.add(this.E$.ops,this.I3b(f,k))}dAf(f,a,k,x=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;a={};a.atmention=y;f=this.I3b(f,a);k&&(y={},y.contentId=k.contentId,a={},a.atmention=y,x&&(y.isCurrentUser=k.isCurrentUser),f.optional=a);Array.add(this.E$.ops,f)}insertImage(f,a){f=this.I3b(f,{});const k={};k.base64=a.base64;a={};a.image=k;f.optional=a;Array.add(this.E$.ops,
f)}iri(f,a){const k={};k.link=a.link;this.mmj(k,a);Array.add(this.E$.ops,this.I3b(f,k))}LNc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.E$)}I3b(f,a){const k={};k.insert=f;k.attributes=a;return k}mmj(f,a){this.SNb(a.weight>=l.VMf,f,"weight",a.weight);this.SNb(a.italic,f,"italic",!0);this.SNb(a.underline,f,"underline",!0);this.SNb(a.strikethrough,f,"strikethrough",!0);this.SNb(!!a.highlight,f,"highlight",a.highlight);this.SNb(!!a.color,f,"color",a.color);this.SNb(!!a.paragraph,f,
"paragraph",a.paragraph)}SNb(f,a,k,x){f&&(a[k]=x)}static bEb(f){return Sys.Serialization.JavaScriptSerializer.deserialize(f,!0)}}l.VMf=700;Object(E.a)(l,"DeltaFormatCreator",null,[1219])},1608:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(585),f=c(392);class a{constructor(k=!1){this.NM=null;this.P1a=!1;k&&(this.NM=new l.a(new f.a))}}Object(E.a)(a,"OpenCommentInfo",null,[])},1609:function(E,K,c){c.d(K,"b",function(){return u});c.d(K,"a",function(){return z});c.d(K,"c",function(){return w});
c.d(K,"d",function(){return F});c.d(K,"e",function(){return G});var l=c(20),f=c(2),a=c(116),k=c(7),x=c(454),y=c(439),n=c(258);const u=()=>l.a.du,z=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,w=H=>!!H&&H.isConnected,F=(H,L,I,N)=>{if(!L||!L.isConnected)return H.dispose(),!1;const P=L.Bi(),M=L.ia(a.a.CJ,n.a.Ft),J={};J[x.a.nodeId]=L.id.toString();J[x.a.cellId]=P.nm.toString();J[x.a.fileId]=P.sr;J[x.a.Vta]=P.contentReplicator.Bt.toString();J[x.a.HM]=P.contentReplicator.HM;J[x.a.lX]=
I.toString();J[x.a.lcid]=f.AFrameworkApplication.lcid.toString();J[x.a.accessToken]=f.AFrameworkApplication.accessToken;J[x.a.classId]=L.Qc.toString();J[x.a.CJ]=M;N=N||{};for(const V of y.a(N))J[V]=N[V];for(const V of y.a(J))H.E3b(V,J[V]);return!0},G=(H,L,I)=>{const N={};N.IsResponseNull=!L;L&&(N.OperationResult=L.StatusCode,N.RevisionListLength=L.RevisionList?L.RevisionList.length.toString():"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",N);I&&I.isConnected&&(L&&!L.StatusCode?
(I.IH().contentReplicator.aF(null,null,null),H.UYo()):H.KLb(null,L?L.StatusCode:14))}},1610:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1824),K);f(c(1825),K);E.exports.DocumentPullQuoteAnnotation||
Object.defineProperty(E.exports,"DocumentPullQuoteAnnotation",{enumerable:!0,get:function(){return E.exports.DocumentPullQuoteAnnotation}});E.exports.PullQuoteAnnotation||Object.defineProperty(E.exports,"PullQuoteAnnotation",{enumerable:!0,get:function(){return E.exports.PullQuoteAnnotation}});E.exports.PullQuotesSignal||Object.defineProperty(E.exports,"PullQuotesSignal",{enumerable:!0,get:function(){return E.exports.PullQuotesSignal}})},1611:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);
class l{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(E.a)(l,"InsightsParameters",null,[])},1615:function(E,K,c){c.d(K,"a",function(){return M});E=c(0);var l=c(22),f=c(889),a=c(56),k=c(5),x=c(32),y=c(152),n=c(6),u=c(42),z=c(15),w=c(7),F=c(243),G=c(110),H=c(73),L=c(55),I=c(77),N=c(469),P=c(144);class M{constructor(J,V,X,W,U,Y){this.Tu=J;this.m4j=V;this.mgd=X;this.qLa=W;this.JBe=U;this.IBe=Y;this.hta=new F.a(()=>this.iSd())}get vk(){return null!=this.fHg?this.fHg:
this.fHg=l.a.instance.resolve("WordEditor.ITableEditor")}get Ld(){return null!=this.jIg?this.jIg:this.jIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.PHg?this.PHg:this.PHg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get a4e(){return this.Tu.value}C6a(J,V,X=!0){const W=this.a4e.Thb(V);if(W&&(J=this.m4j(J),W.Pi(J))){const U=this.a4e.aU(V);let Y="Unknown";this.hta.value&&(Y=this.hta.value.nb(J)?J:"CustomStyle");
w.ULS.sendTraceTag(39661653,311,50,"{0}",{["ApplyTableStyleId"]:Y,["RowCount"]:this.JBe(V),["ColumnCount"]:this.IBe(V),["HR"]:!!(U&32),["FC"]:!!(U&128),["TR"]:!!(U&64),["LC"]:!!(U&256),["BR"]:!(U&512),["BC"]:!(U&1024),["TableId"]:V.id.toString()});X&&this.Yia(V);this.Tmg(V,W);X=W.Pi(J);V.properties.setValue(n.a.tableStyle,X.id);this.m7e(V);V.tT.z8(!0)}}m7c(J,V,X){if(J=this.a4e.C8b(X,J))this.Fya(V,X),this.C6a(J,X)}Fya(J,V,X=!0){X&&this.Yia(V);V.properties.setValue(n.a.tableLook,J);w.ULS.sendTraceTag(39661654,
311,50,"{0}",{["HR"]:!!(J&32),["FC"]:!!(J&128),["TR"]:!!(J&64),["LC"]:!!(J&256),["BR"]:!(J&512),["BC"]:!(J&1024),["TableId"]:V.id.toString()});V.tT.z8(!0)}Tmg(J,V){(J=this.qLa(J))&&V.Yic(J)}m7e(J){if(J.isConnected){J.hasProperty(u.a.Tv)&&J.removeProperty(u.a.Tv);this.r5f(J);this.f4c(J);J=this.mgd(J);for(var V=J.Sb(1);V;){for(V=J.Sb(1);V;)V.hasProperty(z.a.yH)&&V.removeProperty(z.a.yH),V.hasProperty(n.a.Gqa)&&V.removeProperty(n.a.Gqa),this.sSa(V),this.f4c(V),V=J.xi(1);V=J.xi(1)}}}r5f(J){J.Eg(n.a.Wa,
n.a.Xa,n.a.Fqa,n.a.ob,n.a.pb,n.a.Dqa,n.a.Ua,n.a.Va,n.a.Cqa,n.a.qb,n.a.rb,n.a.Eqa,n.a.tb,n.a.ub,n.a.Nya,n.a.Lb,n.a.Mb,n.a.Oya)}sSa(J){J.Eg.apply(J,this.vk.a6e)}f4c(J){J.Eg(n.a.Ca,n.a.za,n.a.Aa,n.a.Ba,n.a.uP,n.a.QR,n.a.WHa,n.a.UHa)}ujj(J,V,X,W,U){J.properties.setValue(V.style,X);J.properties.setValue(V.size,W*P.a.A1b);J.properties.setValue(V.color,U)}iSd(){const J=new I.a;J.Z(f.a.K9c,WordEditorIntl.WordEditorStrings.L_TableGrid);J.Z(f.a.b$d,WordEditorIntl.WordEditorStrings.L_PlainTable1);J.Z(f.a.c$d,
WordEditorIntl.WordEditorStrings.L_PlainTable2);J.Z(f.a.d$d,WordEditorIntl.WordEditorStrings.L_PlainTable3);J.Z(f.a.e$d,WordEditorIntl.WordEditorStrings.L_PlainTable4);J.Z(f.a.f$d,WordEditorIntl.WordEditorStrings.L_PlainTable5);J.Z(f.a.cUd,WordEditorIntl.WordEditorStrings.L_TableGridLight);J.Z(f.a.mTd,WordEditorIntl.WordEditorStrings.L_GridTable1Light);J.Z(f.a.gTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.hTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.iTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.jTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.kTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.lTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.tTd,WordEditorIntl.WordEditorStrings.L_GridTable2);
J.Z(f.a.nTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.oTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.pTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.qTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.rTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel9));
J.Z(f.a.sTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.ATd,WordEditorIntl.WordEditorStrings.L_GridTable3);J.Z(f.a.uTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.vTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.wTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.xTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.yTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.zTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.HTd,WordEditorIntl.WordEditorStrings.L_GridTable4);J.Z(f.a.BTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.CTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel6));
J.Z(f.a.DTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.ETd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.FTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.GTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.OTd,WordEditorIntl.WordEditorStrings.L_GridTable5Dark);J.Z(f.a.ITd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.JTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.KTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.LTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.MTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.NTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.VTd,WordEditorIntl.WordEditorStrings.L_GridTable6Colorful);J.Z(f.a.PTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.QTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.RTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.STd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.TTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.UTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.bUd,WordEditorIntl.WordEditorStrings.L_GridTable7Colorful);J.Z(f.a.WTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.XTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.YTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.ZTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.$Td,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.aUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.f1d,WordEditorIntl.WordEditorStrings.L_ListTable1Light);
J.Z(f.a.$0d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.a1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.b1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.c1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.d1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.e1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.m1d,WordEditorIntl.WordEditorStrings.L_ListTable2);J.Z(f.a.g1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.h1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.i1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel7));
J.Z(f.a.j1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.k1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.l1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.t1d,WordEditorIntl.WordEditorStrings.L_ListTable3);J.Z(f.a.n1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.o1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,
Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.p1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.q1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.r1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.s1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.A1d,WordEditorIntl.WordEditorStrings.L_ListTable4);
J.Z(f.a.u1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.v1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.w1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.x1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.y1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel9));
J.Z(f.a.z1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.H1d,WordEditorIntl.WordEditorStrings.L_ListTable5Dark);J.Z(f.a.B1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.C1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.D1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.E1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.F1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.G1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.N1d,WordEditorIntl.WordEditorStrings.L_ListTable6Colorful);J.Z(f.a.Mcc,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.I1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.J1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.K1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.L1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.M1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.U1d,WordEditorIntl.WordEditorStrings.L_ListTable7Colorful);
J.Z(f.a.O1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.P1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.Q1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.R1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.S1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.T1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));return J}Od(J,V){return String.format(WordEditorIntl.WordEditorStrings.L_TableStyleNameWithThemeFormat,J,V)}Yia(J){if(this.Ld.rg){let V=null;if(Object(G.a)(N.a,J)){const X=Object(H.a)(N.a,J);X&&(V=X.FR())}V&&this.lj.Yia(J,V)}}static yuf(){return new M(new F.a(()=>a.StyleReader.GTa),a.StyleReader.pg,k.GraphIterator.$a,Object(L.a)(M.vh,M.vh.Xs,"navigateToPageContentNode"),
x.TableReader.fg,x.TableReader.Yg)}static get vh(){return y.PageNavigator.instance}static get instance(){return null!=M.yCg?M.yCg:M.yCg=M.yuf()}}Object(E.a)(M,"TableStyleEditor",null,[65])},1616:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.Unknown=-1]="Unknown";f[f.g$o=0]="RichText";f[f.M9o=1]="PlainText";f[f.K9o=2]="Picture";f[f.F7o=3]="ComboBox";f[f.m8o=4]="DropDownList";f[f.x7o=5]="BuildingBlockGallery";f[f.Date=6]="Date";f[f.b$o=7]="RepeatSectionItem";f[f.C7o=
8]="CheckBox";f[f.a$o=9]="RepeatSection";f[f.Bibliography=10]="Bibliography";f[f.A$o=11]="TableOfContents";f[f.y9o=12]="NumberOfContentControlKinds"})(l||(l={}));Object(E.b)("ContentControlKind",l)},1617:function(E,K,c){c.d(K,"c",function(){return y});c.d(K,"b",function(){return n});c.d(K,"a",function(){return u});var l=c(39),f=c(587),a=c(62),k=c(61),x=c(276);const y=(z,w,F)=>{var G=z.characterData.length;if(w>F||F>G)return null;a:{for(H of z.XG)if(G=H.nc,G.qe&&G===k.InteractiveViewManager.instance.Bd){var H=
G;break a}H=null}if(!H)return null;H=z.Gj(H.ic);if(!H)return null;G=[];z=z.pa;for(let I=z.Jga(w);I<z.length;I++){var L=z.J(I);if(L.cp>F||L.cp===F&&w!==F)break;(L=x.a.Qva(H,L.cp))&&0>Array.indexOf(G,L)&&G.push(L)}return G},n=z=>{let w=null;for(const G of z){var F=l.a.getElementBounds(G);w?(z=w,z.x>F.x&&(z.x=F.x),z.x+z.width<F.x+F.width&&(z.width=F.x+F.width-z.x),z.y>F.y&&(z.y=F.y),z.y+z.height<F.y+F.height&&(z.height=F.y+F.height-z.y)):w=F}w||(w=new Sys.UI.Bounds(0,0,0,0));return w},u=(z,w)=>{z=n(z);
if(!z.width&&!z.height)return null;const F=document.createElement("div");F.id=w;F.style.position="absolute";F.style.left=z.x+"px";F.style.top=z.y+"px";F.style.width=z.width+"px";F.style.height=z.height+"px";F.style.zIndex="-9999";a.d(F,f.a.wzb,"true");return F}},1618:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||
function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1846),K);f(c(1847),K);f(c(1848),K);f(c(1849),K);f(c(1850),K);E.exports.SuggestionCategory||Object.defineProperty(E.exports,"SuggestionCategory",{enumerable:!0,get:function(){return E.exports.SuggestionCategory}})},1619:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f){this.source=f}}Object(E.a)(l,"AcceptAllActionData",null,
[])},1621:function(E,K,c){c.d(K,"a",function(){return P});E=c(0);var l=c(702),f=c(28),a=c(9),k=c(17),x=c(23),y=c(8),n=c(12),u=c(744),z=c(540),w=c(238),F=c(73),G=c(74),H=c(110),L=c(1199),I=c(1522),N=c(855);c.n(N);class P{constructor(M,J,V,X,W,U,Y){this.ELa=M;this.ib=J;this.Fm=V;this.sn=X;this.f$a=W;this.I4j=U;this.hUb=Y}yna(M){return(M=this.sn.yna(M))&&Object(F.a)(l.a,M.errorDetails)&&!M.errorDetails.W2a()?M:null}dEa(M){return this.f$a.dEa(M)}Imf(M){if(!M)return null;if(u.a(M.annotationType)){if((M=
M.content)&&M.suggestions&&!P.L0b(M))return M}else if(M.annotationType===z.a.getTypeName()){if((M=M.content)&&M.suggestions)return M}else if(M.annotationType===N.FlagAnnotation.getTypeName()&&(M=M.content)&&M.results)return M;return null}vLd(M,J,V){let X=null,W=null,U=null;var Y=this.Fm.uOc(M,0);if(!Y||!Y.count)return{returnValue:!1,annotation:X,W3i:W,v0e:U};for(const ca of Y){if(J&&(ca.begin!==M.cpBegin||ca.end!==M.cpEnd))continue;Y=this.Imf(ca.intent);if(!Y||V&&!V(Y))continue;let aa;({stop:aa}=
P.wqj(W,Y)).returnValue&&(X=ca.intent,W=Y,U=f.a.createTextRange(M.node,ca.begin,ca.end));if(aa)break}return{returnValue:!!W,annotation:X,W3i:W,v0e:U}}V2h(M,J){let V=null;for(const X of M){if(X.type)continue;M=this.Imf(X.intent);if(!M||J&&!J(M))continue;let W;({stop:W}=P.wqj(V,M)).returnValue&&(V=M);if(W)break}return V}Jhi(M,J,V,X,W){const U=new G.a;if(X.SVd){var Y=this.Fm.$Oa(M,0,ca=>{if(J>ca.begin||ca.begin>V)return!1;ca=this.Imf(ca.intent);return!ca||P.L0b(ca)||X.i3c&&!X.i3c(ca)?!1:!0});for(const ca of Y)U.add(ca)}if(X.RVd){Y=
this.sn.Q3(M,ca=>{if(J>ca.begin||ca.begin>V)return!1;ca=ca.errorDetails;return ca.W2a()||X.d2c&&!X.d2c(ca)?!1:!0});for(const ca of Y)U.add(ca)}if(X.QVd){M=this.f$a.hpf(M,ca=>J>ca.begin||ca.begin>V||X.tJc&&!X.tJc(ca.ED)?!1:!0);for(const ca of M)U.add(ca)}U.Sc(W);return U}kpf(M,J){return Math.min(Math.abs(J-M.begin),Math.abs(J-M.end))}Q3l(M,J,V,X){let W,U=0;X?(X=0,W=J-1):(X=J+1,W=M.characterData.length);V=this.Jhi(M,X,W,V,(Y,ca)=>this.kpf(Y,J)-this.kpf(ca,J));if(!V.count)return{returnValue:null,offset:U};
U=J<V.J(0).begin||J>V.J(0).end?this.kpf(V.J(0),J):0;return{returnValue:f.a.createTextRange(M,V.J(0).begin,V.J(0).end),offset:U}}Vrf(M,J,V,X){let W=0;var U=({offset:W}=this.Q3l(M,J,V,X)).returnValue;if(U)return{returnValue:U,offset:W};U=this.ELa.cNh(M,X);if(!U)return{returnValue:null,offset:W};for(W=X?J:M.characterData.length-J;U.Lba();){M=U.Cx;J=this.Jhi(M,0,M.characterData.length,V,(Y,ca)=>Y.begin===ca.begin?Y.end-ca.end:Y.begin-ca.begin);if(J.count)return V=X?J.J(J.count-1):J.J(0),W+=X?M.characterData.length-
V.end:V.begin,{returnValue:f.a.createTextRange(M,V.begin,V.end),offset:W};W+=M.characterData.length}return{returnValue:null,offset:W}}Urf(M,J,V,X){return this.Vrf(M,J,V,X).returnValue}oJc(M,J,V){let X=0,W=1;this.Urf(M,J,V,!1)&&W++;this.Urf(M,J,V,!0)&&(X++,W++);return{index:X,count:W}}vPl(M,J,V){let X;const W=({offset:X}=this.Vrf(M,J<M.characterData.length?J+1:J,V,!0)).returnValue;if(W&&!X)return W;J=({offset:M}=this.Vrf(M,1<J?J-1:0,V,!1)).returnValue;return W&&J?X<M?W:J:W?W:J}Qgj(M,J){let V=null;
a.App.xa&&Object(H.a)(L.PageView,a.App.xa.hb.rc)&&(V=a.App.xa.hb.rc);if(!V)return!1;this.ib.setSelection(k.SelectionEditor.xj(x.SelectionFactory.io(M),!0,!1));M=V.Ns.wam();const X=(M-250)/2;V.Ns.b5(100<X?100-100*X/M:-1,void 0,void 0,W=>{window.setTimeout(()=>{J(W)},0)});return!0}KJb(M,J,V=4,X=!0){const W=()=>{J.Uj.kF||J.kN(new I.a(M,V,!1,X,void 0,!0))};J.Uj.dismiss();this.I4j.select(M.node,M.cpBegin,M.cpBegin);if(!this.hUb.XId(M.node))return this.Qgj(M,()=>{W()});W();return!0}static L0b(M){if(!M)return!0;
if(!M.M_||!M.M_.state)return!1;M=M.M_.state;return 60===M||70===M}static wqj(M,J){const V=w.a.getTypeNameFor(J)===z.a.getTypeName();return{returnValue:!M||V||u.a(w.a.getTypeNameFor(J))&&M.priority>J.priority,stop:V}}aQf(M,J,V,X,W=4,U=!0){M=this.bRl(M);if(!M)return!1;J=this.MQh(M,J,V,X);return this.KJb(M,J,W,U)}bRl(M){var J=this.ib.gb.kb;for(const V of J)if(y.ParagraphReader.Vb(V.node)&&(J=V.contextId,J===n.a.Tc||J===n.a.Hd||J===n.a.paragraph))return this.vPl(V.node,J!==n.a.paragraph?V.cpBegin:0,M);
return null}MQh(M,J,V,X){return this.lEm(M)?J:this.pIm(M)?X:V}lEm(M){return this.vLd(M,!0,null).returnValue}pIm(M){return!!this.dEa(M)}}Object(E.a)(P,"SuggestionNavigator",null,[])},1622:function(E,K,c){c.d(K,"c",function(){return f});c.d(K,"a",function(){return a});c.d(K,"b",function(){return k});var l=c(25);const f=(x,y,n)=>{if(!l.c(x)&&"#text"!==x.nodeName&&(y?x.setAttribute("unselectable","on"):x.setAttribute("unselectable","off"),n))for(x=x.firstChild;x;)f(x,y,!0),x=x.nextSibling},a=x=>{x=document.createElement(x);
x.setAttribute("unselectable","on");return x},k=(x,y)=>{if(!l.c(x)){var n=x.className;if(l.c(n)||-1===n.indexOf(y))y=n.trim()+" "+y,y=y.trim(),x.className=y}}},1623:function(E,K,c){c.d(K,"a",function(){return u});E=c(0);var l=c(7),f=c(55),a=c(2),k=c(185),x=c(22),y=c(288),n=c(31);class u{constructor(){this.Oea=null}zme(){try{this.Oea||(this.Oea=x.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(z){l.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+
z)}}Uuf(z,w){return this.Oea?this.Oea.getToken(z,w):new Promise(F=>{x.a.instance.Sa("Common.App.SearchCommon.ISearchOAuthManager").execute(G=>{G?(this.Oea=G,this.Oea.getToken(z,w).then(H=>F(H))):F(null)})})}F1l(){this.zme();return this.Oea?this.Oea.getToken("Search",a.AFrameworkApplication.XKf):null}Fgi(){if("Dev Box"===a.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>
{z(window.TellMeSubstrateTokenOverride)},750)});this.zme();return this.Oea?this.Oea.getToken("Search",a.AFrameworkApplication.Hgg):null}Pem(){this.zme();return this.Oea?this.Oea.getToken("Search",this.Mem()):null}Mem(){return a.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")}Tbm(){if("Dev Box"===a.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>
{z(window.TellMeSubstrateTokenOverride)},750)});this.zme();return this.Oea?this.Oea.getToken("SmartLookup",this.Qbm()):null}Qbm(){return a.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")}G1l(){return Object(f.a)(this,this.F1l,"getLokiTokenPromise")}kdm(){return Object(f.a)(this,this.Fgi,"getSubstrateTokenPromise")}GOb(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.GOb}Dfm(){const z={};this.GOb()&&(z.Loki=this.G1l(),z.Substrate=this.kdm());return z}bYc(z){k.a.pHa(Object.assign(new y.a,
{name:"Events",dataFields:[Object.assign(new n.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new n.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}N_m(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.bYc(!1);return!1}).then(()=>{this.bYc(!0);return!0}):new Promise((z,w)=>{const F=x.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Pz;F?F.loadScript("tellme-strings").then(()=>
{this.bYc(!0);z(!0)}).catch(()=>{this.bYc(!1);w(!1)}):(this.bYc(!1),w(!1))})}static QQm(){return!!a.AFrameworkApplication.ta&&(a.AFrameworkApplication.ta.Nb.$Vc||a.AFrameworkApplication.ta.Nb.ubc)}static ZZd(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.ubc}}Object(E.a)(u,"ReactSharedHeaderSearchUtils",null,[])},1625:function(E,K,c){c.r(K);c.d(K,"validateCpDataV1",function(){return f});c.d(K,"isEqual",function(){return a});c.d(K,"isSupportedCpVersion",function(){return k});c.d(K,
"validateVersionedCpData",function(){return y});c.d(K,"versionedDeserialize",function(){return n});var l=c(1593);const f=u=>"number"!==typeof u.CP||null!=u.FB&&"number"!==typeof u.FB||null!=u.FE&&"number"!==typeof u.FE||null!=u.HB&&"number"!==typeof u.HB||null!=u.HE&&"number"!==typeof u.HE||null!=u.CB&&"number"!==typeof u.CB||null!=u.CE&&"number"!==typeof u.CE||null!=u.R&&"number"!==typeof u.R||null!=u.E&&"number"!==typeof u.E||null!=u.TW&&"number"!==typeof u.TW||null!=u.PB&&"number"!==typeof u.PB||
null!=u.SYM&&"number"!==typeof u.SYM||null!=u.IE&&"number"!==typeof u.IE||null!=u.OO&&"number"!==typeof u.OO||null!=u.AX&&"number"!==typeof u.AX||null!=u.CCI&&"number"!==typeof u.CCI||null!=u.DD&&"number"!==typeof u.DD?!1:!0,a=(u,z)=>u||z?u&&z&&u.CP===z.CP&&u.FB===z.FB&&u.FE===z.FE&&u.HB===z.HB&&u.HE===z.HE&&u.CB===z.CB&&u.CE===z.CE&&u.R===z.R&&u.E===z.E&&u.TW===z.TW&&u.PB===z.PB&&u.SYM===z.SYM&&u.IE===z.IE&&u.OO===z.OO&&u.AX===z.AX&&u.CCI===z.CCI&&u.DD===z.DD?!0:!1:!0,k=u=>1===u,x=u=>{let z=u,w=
0;"number"===typeof z.VS&&(w=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,fog:w};z=null;for(let F=0;F<u.length;F++){const G=u[F];1===G.VS&&G.VS>w&&(w=G.VS,z=u[F])}return{returnValue:z,fog:w}},y=u=>{const z=({fog:u}=x(u)).returnValue;if(!z)return!1;switch(u){case 0:case 1:return f(z);default:return!1}},n=u=>{if(!u)return null;const z=({fog:u}=x(u)).returnValue;if(!z)return null;switch(u){case 0:case 1:return l.b(z);default:return null}}},1638:function(E,K,c){c.d(K,"a",
function(){return a});E=c(0);var l=c(91),f=c(1525);class a{constructor(k){this.taskManager=k}lgb(k,x){const {priority:y=2,delay:n=0}=null!==x&&void 0!==x?x:{},u=new f.a,z=async()=>await k();x=new l.a(y,1,n,()=>{z().then(u.resolve).catch(u.reject)});this.taskManager.Wb(x);return u.completion}}Object(E.a)(a,"TaskDispatcher",null,[])},1639:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(135),f=c(2),a=c(7);class k{constructor(x,y){this.sQ=x;this.aIa=y}tP(x,y,n){x={["appId"]:2155,["manifestType"]:"Fps",
["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:l.a.create().toString(),["email"]:y,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(n)})},["survey"]:{["surveyId"]:x},["telemetry"]:this.Vzb(),["web"]:this.lFc()};this.OGa(JSON.stringify(x),{["Content-Type"]:"application/json"})}Vzb(){const x=f.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:f.AFrameworkApplication.buildVersion,
["featureArea"]:"EditorAi",["audienceGroup"]:x.AudienceGroup,["osBuild"]:x.OsVersion,["platform"]:x.Platform,["processSessionId"]:x.WACSessionID,["flights"]:f.AFrameworkApplication.K.jb("FlightId"),["loggableUserId"]:f.AFrameworkApplication.K.jb("LoggableUserId"),["tenantId"]:f.AFrameworkApplication.K.jb("TenantId")}}OGa(x,y,n=0){3<n||this.aIa.lgb(()=>{this.sQ.tj("https://petrol.office.microsoft.com/v1/feedback",2,x,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},
()=>{this.OGa(x,y,n+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",n)},null)},{delay:this.hTl(n)})}hTl(x=0){let y=0;1===x?y=200:1<x&&(y=200+500*(x-1));return y}lFc(){const x=f.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:x.Browser,["browserVersion"]:x.BrowserVersion,["dataCenter"]:x.WACDatacenter}}}Object(E.a)(k,"EditorAiSurveysApiClient",null,[])},1640:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);class l{constructor(a){this.selectedRating=
a}}Object(E.a)(l,"EditorAiRatingData",null,[]);class f{constructor(a,k,x){this.rating=[new l(a)];this.comment=[k,...x]}}Object(E.a)(f,"EditorAiSurveyData",null,[])},1641:function(E,K,c){E=c(0);var l=c(742),f=c(19),a=c(171),k=c(79),x=c(2),y=c(22),n=c(7),u=c(1448),z=c(12),w=c(101),F=c(28),G=c(3),H=c(1053),L=c(132),I=c(17),N=c(23),P=c(121),M=c(8);class J{static get xvh(){J.Uoc||(J.Uoc=[],J.hdc(l.a.og("ar-sa")),J.hdc(l.a.og("de-de")),J.hdc(l.a.og("es-es")),J.l0(l.a.og("en-029"),l.a.og("en-us")),J.l0(l.a.og("en-au"),
l.a.og("en-us")),J.l0(l.a.og("en-bz"),l.a.og("en-us")),J.l0(l.a.og("en-ca"),l.a.og("en-us")),J.l0(l.a.og("en-gb"),l.a.og("en-us")),J.l0(l.a.og("en-id"),l.a.og("en-us")),J.l0(l.a.og("en-my"),l.a.og("en-us")),J.l0(l.a.og("en-ph"),l.a.og("en-us")),J.l0(l.a.og("zh-tw"),l.a.og("en-us")),J.hdc(l.a.og("fr-fr")),J.l0(l.a.og("hr-ba"),l.a.og("hr-hr")),J.l0(l.a.og("it-ch"),l.a.og("it-it")),J.l0(l.a.og("nb-no"),l.a.og("nn-no")),J.hdc(l.a.og("nl-nl")),J.l0(l.a.og("ro-md"),l.a.og("ro-ro")),J.l0(l.a.og("ru-md"),
l.a.og("ru-ru")),J.l0(l.a.og("sr-latn-ba"),l.a.og("sr-latn-cs")),J.l0(l.a.og("sr-latn-me"),l.a.og("sr-latn-cs")),J.l0(l.a.og("sr-latn-rs"),l.a.og("sr-latn-cs")),J.hdc(l.a.og("sr-cyrl-cs")),J.l0(l.a.og("sv-fi"),l.a.og("sv-se")));return J.Uoc}static hdc(Ra){J.Uoc[Ra.languageId]=Ra.LCID}static l0(Ra,gb){J.Uoc[Ra.LCID]=gb.LCID}static d8h(Ra){var gb=l.a.og(Ra);if(!gb)return 0;gb=J.xvh[gb.LCID]||J.xvh[gb.languageId]||0;return gb===Ra?0:gb}}J.Uoc=null;Object(E.a)(J,"AutoCorrectListFallback",null,[]);var V=
c(354),X=c(83),W=c(145),U=c(116),Y=c(6),ca=c(15),aa=c(5),fa=c(90),pa=c(374),ra=c(36),la=c(59),qa=c(92),La=c(43),Pa=c(1528);class Ka extends Pa.a{constructor(Ra,gb,Bb,$b,Qb,Ac){super(Ra,gb,Bb,$b,Ac);this.oY=Qb}get VC(){return!0}get commandId(){return G.a.QHk}set VC(Ra){super.VC=Ra}}Object(E.a)(Ka,"ARegexCorrectAction",Pa.a,[]);class Na extends Ka{static get Rkb(){if(null!=Na.oDg)var Ra=Na.oDg;else(Ra=y.a.instance.Na("Box4.List.IListCommands"))||n.ULS.sendTraceTag(512357316,393,50,"IListCommands was tried to be resolved before it was registered."),
Ra=Na.oDg=Ra;return Ra}static get Un(){return null!=Na.sDg?Na.sDg:Na.sDg=y.a.instance.resolve("Box4.List.IListEditor")}static get Gd(){return null!=Na.JDg?Na.JDg:Na.JDg=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [Ra,gb]=this.oY;return gb?Ra.replace(gb,"%1"):Ra}}Object(E.a)(Na,"AListAutoCorrectAction",Ka,[]);var sa=c(140);class wa extends Na{get commandId(){return G.a.IHk}Rma(Ra){if(wa.Rkb){var gb=aa.GraphIterator.$a(Ra);gb.vd();ra.OutlineElementNavigator.Vd(gb);if(wa.Un.Ahe(gb,
this.oY[0])){var Bb=wa.Gd.lw(gb),$b=this.oY[0],Qb=f.a.charAt($b,0),Ac=this.X1l(Qb),Db=pa.a.n_(1,Ac.listStyle);Bb&&Db.cxf(Bb)||(Bb=new La.GraphTransaction(15),Bb.ku(gb),this.Kd.replaceTextRange(F.a.createTextRange(Ra,this.FG,this.m0+1),"",!0,!1),wa.Un.djo(Db),Ra=new V.DictionaryPropertySet,Ra.setValue(W.a.xlf,!0),Qb&&(Db.pQ=Qb,Ra.setValue(U.a.pQ,Db.pQ)),Ra.setValue(Y.a.lv,Ac.levelText),Ra.setValue(ca.a.font,Ac.fontName),"-"===Qb&&X.Health.instance.recordKpiUsage("DashBulletAutoCreate",0,wa.sB,null),
sa.a.eY&&(Ra.setValue(U.a.Xoa,"autocorrect"),Ra.setValue(U.a.Aha,$b)),wa.Rkb.MOk(Db.listType,Db.listStyle,Ra),Bb.dispose())}}}X1l(Ra){const gb={listStyle:0,levelText:fa.a.GHd,fontName:fa.a.VIc};switch(Ra){case "*":return{...gb,listStyle:1};case "-":return{...gb,levelText:"-",fontName:qa.a.kG};default:return gb}}static gG(Ra,gb,Bb,$b,Qb){return new wa(null,Ra,gb,Bb,$b,Qb)}static xT(Ra,gb,Bb,$b,Qb){return new wa(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb)}}wa.sB="wwaengidc";wa.F3f=["[\\*](?![\\*])","[\\-](?![\\-])"];
Object(E.a)(wa,"BulletListAction",Na,[]);var ja=c(77);class ha extends Ka{constructor(Ra,gb,Bb,$b,Qb,Ac){super(Ra,gb,Bb,$b,Qb,Ac);this.evc=!1;this.VC=!Ra;ha.kp=new ja.a}get VC(){return this.evc}set VC(Ra){this.evc=Ra}eCb(Ra){this.I6e(Ra.innerText,(gb,Bb,$b)=>{Ra.innerText=f.a.substring(Ra.innerText,0,gb)+$b+f.a.right(Ra.innerText,Bb)})}Rma(Ra){this.I6e(M.ParagraphReader.text(Ra).substring(this.FG,this.m0),(gb,Bb,$b)=>{this.Kd.replaceTextRange(F.a.createTextRange(Ra,this.FG+gb,this.FG+Bb),$b,!0,!1)})}I6e(Ra,
gb){if(!(2>this.oY.length)&&this.oY[1]){var Bb=this.oY[1];ha.kp.count||this.t1i();ha.kp.nb(Bb)&&(Ra=Ra.lastIndexOf(Bb),-1!==Ra&&gb(Ra,Ra+Bb.length,ha.kp.J(Bb)))}}}Object(E.a)(ha,"ADictionarySequenceReplacerAction",Ka,[]);class va extends ha{get commandId(){return G.a.u2e}t1i(){ha.kp.Z("--","\u2014");ha.kp.Z(" -- "," \u2013 ");ha.kp.Z(" - "," \u2013 ");ha.kp.Z("-- ","\u2014");ha.kp.Z(" --"," \u2013");ha.kp.Z(" -"," \u2013")}static gG(Ra,gb,Bb,$b,Qb){return new va(null,Ra,gb,Bb,$b,Qb)}static xT(Ra,
gb,Bb,$b,Qb){return new va(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb)}}Object(E.a)(va,"DashAction",ha,[]);class xa extends ha{constructor(Ra,gb,Bb,$b,Qb,Ac,Db){super(Ra,gb,Bb,$b,Qb,Ac);this.ga=Db}get commandId(){return G.a.JHk}t1i(){ha.kp.Z(":)","\ud83d\ude0a");ha.kp.Z(":-)","\ud83d\ude0a");ha.kp.Z(":|","\ud83d\ude10");ha.kp.Z(":-|","\ud83d\ude10");ha.kp.Z(":(","\ud83d\ude41");ha.kp.Z(":-(","\ud83d\ude41");ha.kp.Z(";)","\ud83d\ude09");ha.kp.Z(";-)","\ud83d\ude09");ha.kp.Z(":D","\ud83d\ude00");ha.kp.Z(":-D","\ud83d\ude00");
ha.kp.Z(":')","\ud83d\ude02");ha.kp.Z("=D","\ud83d\ude03");ha.kp.Z(":>","\ud83d\ude06");ha.kp.Z(":->","\ud83d\ude06");ha.kp.Z(":3","\ud83d\ude0a");ha.kp.Z(":-3","\ud83d\ude0a");ha.kp.Z("B-)","\ud83d\ude0e");ha.kp.Z("*-*","\ud83d\ude0d");ha.kp.Z(":*","\ud83d\ude19");ha.kp.Z(":-*","\ud83d\ude19");ha.kp.Z(":X","\ud83d\ude36");ha.kp.Z(":-X","\ud83d\ude36");ha.kp.Z(":O","\ud83d\ude2e");ha.kp.Z(":-O","\ud83d\ude2e");ha.kp.Z(":#","\ud83e\udd10");ha.kp.Z(":-#","\ud83e\udd10");ha.kp.Z(":P","\ud83d\ude1b");
ha.kp.Z(":-P","\ud83d\ude1b");ha.kp.Z(";P","\ud83d\ude1c");ha.kp.Z(";-P","\ud83d\ude1c");ha.kp.Z(":-/","\ud83d\ude15");ha.kp.Z("$-$","\ud83e\udd11");ha.kp.Z(":S","\ud83d\ude16");ha.kp.Z(":-S","\ud83d\ude16");ha.kp.Z(":[","\ud83d\ude1f");ha.kp.Z(":-[","\ud83d\ude1f");ha.kp.Z(":\u2019(","\ud83d\ude22");ha.kp.Z(":'(","\ud83d\ude22");ha.kp.Z("@-@","\ud83d\ude31")}Rma(Ra){this.I6e(M.ParagraphReader.text(Ra).substring(this.FG,this.m0),(gb,Bb,$b)=>{gb=F.a.createTextRange(Ra,this.FG+gb,this.FG+Bb);Bb={};
Bb.MenuItemId=$b;this.ga.Of(gb,G.a.Vib,2,!1,null,Bb,null)})}static gG(Ra,gb,Bb,$b,Qb,Ac){return new xa(null,Ra,gb,Bb,$b,Qb,Ac)}static xT(Ra,gb,Bb,$b,Qb,Ac){return new xa(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb,Ac)}}Object(E.a)(xa,"EmojiAction",ha,[]);class ma{constructor(Ra,gb,Bb,$b){this.pS=Ra;this.Nwd=gb;this.Mvc=$b;this.LF=Bb}ozi(){if(!this.LF)return!1;this.pS=this.pS.trimStart();return this.pS===this.LF?!0:!1}GUm(){if(!this.pS)return!1;const Ra=this.pS.lastIndexOf(" ");return-1!==Ra&&"."===this.pS.charAt(Ra-
1)&&"."===this.pS.charAt(Ra-3)?!0:!1}FUm(){if(!this.pS)return!1;var Ra=this.pS.lastIndexOf(" ");return-1!==Ra&&(Ra=this.pS.substring(0,Ra-1).lastIndexOf(" "),"."===this.pS.charAt(Ra+2))?!0:!1}YNm(){return this.ozi()&&(1===this.LF.length&&"."===this.Nwd||"."===this.pS.charAt(1))?!0:!1}ZNm(){return this.LF?0<="\\/".indexOf(this.Nwd)||3===this.LF.length&&0<="\\/".indexOf(this.LF.charAt(1))?!0:!1:!1}TMm(){return this.LF?0<=this.LF.indexOf("@")?!0:!1:!1}DB(){if(!this.LF)return!1;for(const Ra of ma.Gvf())if(f.a.startsWith(this.LF+
this.Nwd,Ra))return!0;return!1}AMm(){return this.LF?"i"===this.LF&&0<=ma.quotes.indexOf(this.Nwd)?!0:!1:!1}MGm(){if(!this.pS)return!1;const Ra=f.a.D3a(this.pS,this.pS.length-1);if(-1!==Ra&&this.pS.substring(Ra+1,this.pS.length)===this.LF){const gb=this.pS.charAt(Ra-1);if(0<=ma.m$f.indexOf(gb)||0<=ma.quotes.indexOf(gb)&&0<=ma.m$f.indexOf(this.pS.charAt(Ra-2)))return!0}return!1}CUk(){return!this.pS||this.GUm()||this.YNm()||this.ZNm()||this.FUm()||this.TMm()||this.DB()?!1:this.ozi()||this.AMm()||this.MGm()?
!0:!1}static Gvf(){return ma.w4g||(ma.w4g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}ma.m$f=".!?";ma.quotes="'\"";ma.w4g=null;Object(E.a)(ma,"FirstLetterUpperCaseRules",null,[]);class Ja{constructor(Ra){this.LF=Ra}zHl(){if(!this.LF)return null;for(let Ra=0;Ra<Ja.qji().length;Ra++)if(this.LF===Ja.qji()[Ra])return Ja.ljm()[Ra];return null}static qji(){return Ja.PVg||(Ja.PVg=["1/2","1/4","3/4"])}static ljm(){return Ja.OVg||(Ja.OVg=["\u00bd","\u00bc","\u00be"])}}Ja.PVg=null;Ja.OVg=null;Object(E.a)(Ja,
"FractionsCollection",null,[]);class oa extends Pa.a{constructor(Ra,gb,Bb,$b,Qb,Ac){super(Ra,gb,Bb,$b,Ac);this.qJh=Qb}get VC(){return!0}get commandId(){return G.a.KHk}eCb(Ra){Ra.innerText=f.a.substring(Ra.innerText,0,this.FG)+this.qJh+f.a.right(Ra.innerText,this.m0)}Rma(Ra){this.Kd.replaceTextRange(F.a.createTextRange(Ra,this.FG,this.m0),this.qJh,!0,!1)}set VC(Ra){super.VC=Ra}static gG(Ra,gb,Bb,$b,Qb){return new oa(null,Ra,gb,Bb,$b,Qb)}}Object(E.a)(oa,"FractionsReplaceCorrectAction",Pa.a,[]);class za extends Na{get commandId(){return G.a.MHk}Rma(Ra){if(za.Rkb){var gb=
aa.GraphIterator.$a(Ra);gb.vd();ra.OutlineElementNavigator.Vd(gb);if(za.Un.Ahe(gb,this.oY[0])){var [Bb,$b]=this.oY,Qb=za.$hn($b),Ac=f.a.Kbc($b)?4:2,Db=F.a.createTextRange(Ra,this.FG,this.m0+1);za.Un.m1b(Ra,gb,Ac,Qb,Db,Bb,this.levelText,za.Rkb)}}}static gG(Ra,gb,Bb,$b,Qb){return new za(null,Ra,gb,Bb,$b,Qb)}static xT(Ra,gb,Bb,$b,Qb){return new za(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb)}static $hn(Ra){if(!Ra)return 0;Ra=f.a.Ug(Ra);if(!f.a.nXd(Ra.charAt(0)))return 0;const gb=Ra.charCodeAt(0)-97+1;let Bb;for(Bb=1;Bb<
Ra.length&&Ra.charAt(Bb)===Ra.charAt(0);Bb++);return 26*(Bb-1)+gb}}Object(E.a)(za,"LetterListAction",Na,[]);var Fa=c(120);class kb extends Na{get commandId(){return G.a.m1b}Rma(Ra){if(kb.Rkb){var gb=aa.GraphIterator.$a(Ra);gb.vd();ra.OutlineElementNavigator.Vd(gb);if(kb.Un.Ahe(gb,this.oY[0])){var [Bb,$b]=this.oY,Qb=parseInt($b);if(!(99999999<=Qb)){var Ac=F.a.createTextRange(Ra,this.FG,this.m0+1);Fa.a.X_d()&&Fa.a.hlm();kb.Un.m1b(Ra,gb,1,Qb,Ac,Bb,this.levelText,kb.Rkb)}}}}static gG(Ra,gb,Bb,$b,Qb){return new kb(null,
Ra,gb,Bb,$b,Qb)}static xT(Ra,gb,Bb,$b,Qb){return new kb(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb)}}Object(E.a)(kb,"NumberListAction",Na,[]);class fb extends Pa.a{get VC(){return!0}get commandId(){return G.a.OHk}eCb(){}Rma(Ra){const gb=F.a.createTextRange(Ra,this.m0-2,this.m0),Bb=new La.GraphTransaction(15);Bb.Cb(Ra);let $b=!1,Qb=null,Ac=0;for(;Ac<Ra.pa.length;){var Db=Ra.pa.J(Ac),dc=Db.O8;const Pb=Db.sU;if(Db.cp>=gb.cpBegin){Db.cp>gb.cpBegin||!Db.formatting?Qb=$b?Db.formatting:this.Kd.MY(Ra,Ac,gb.cpBegin,Qb):(Qb=
Db.formatting,Pb&&($b=!1),dc&&($b=!0));Ac++;break}Db.formatting&&(Qb=Db.formatting);Pb&&($b=!1);dc&&($b=!0);Ac++}for(;Ac<Ra.pa.length;){dc=Ra.pa.J(Ac);if(dc.cp>=gb.cpEnd){if(dc.cp>gb.cpEnd||!dc.formatting&&!dc.Uh)$b||this.Kd.MY(Ra,Ac,gb.cpEnd,Qb);$b||fb.Sn.oqa(Qb,!0);break}dc.formatting&&($b||fb.Sn.oqa(Qb,!0),Qb=dc.formatting);Db=dc.O8;dc=dc.sU;Db&&($b=!0);!Db&&dc&&($b=!1);Ac++}Bb.dispose()}set VC(Ra){super.VC=Ra}static get Sn(){return null!=fb.Mzg?fb.Mzg:fb.Mzg=y.a.instance.resolve("Box4.IFormattingEditor")}static gG(Ra,
gb,Bb,$b){return new fb(null,Ra,gb,Bb,$b)}}Object(E.a)(fb,"OrdinalsReplaceCorrectAction",Pa.a,[]);var lb=c(103),sb=c(210),ab;(function(Ra){Ra[Ra.rand=0]="rand";Ra[Ra.randOld=1]="randOld";Ra[Ra.lorem=2]="lorem"})(ab||(ab={}));Object(E.b)("RandTextType",ab);class Ga extends Ka{constructor(Ra,gb,Bb,$b,Qb,Ac){super(Ra,gb,Bb,$b,Qb,Ac);Ga.AOe||Ga.OBo()}static JNm(){var Ra;return null===(Ra=x.AFrameworkApplication.K)||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",
!0)}get commandId(){return G.a.PHk}Rma(Ra){if(!(Ra.Us||sa.a.getInstance().Iv&&(sa.a.getInstance().kAi?lb.ListItemReader.isListItem(Ra):sb.a.woa(Ra)))){var gb=this.V$a.Oa.node===Ra,Bb=5,$b=3;if(this.oY[0].startsWith("=rand.old")){var Qb=ab.randOld;Bb=3}else if(this.oY[0].startsWith("=rand"))Qb=ab.rand;else if(this.oY[0].startsWith("=lorem"))Qb=ab.lorem;else return;this.oY[1]&&(Bb=parseInt(this.oY[1]));this.oY[2]&&($b=parseInt(this.oY[2]));if(!(20<$b||100<Bb)){Ra.IH().hF.w7(7);var Ac=aa.GraphIterator.$a(Ra);
Ac.vd();ra.OutlineElementNavigator.Vd(Ac);Ga.lg.yA(Ac,!1,!1);Ga.lg.YI(Ac);var Db=!1;switch(Qb){case ab.rand:Qb=Ga.AOe;break;case ab.randOld:Qb=Ga.qbh;break;case ab.lorem:Qb=Ga.r5g;Db=!0;break;default:return}var dc=0;for(let Ub=0;Ub<Bb;++Ub){const rb=[];for(var Pb=0;Pb<$b;Pb++)rb.push(Qb[dc++%Qb.length]);Pb=F.a.Rc(Ac.currentNode,0);if(Db){const Yb=w.FormattingReader.Kr(Pb);Ga.Sn.Wl(Yb,Y.a.noProof,!0)}this.Kd.replaceTextRange(Pb,rb.join(Ga.JNm()?"":" "),!0,!1);Ub<Bb-1&&(ra.OutlineElementNavigator.Vd(Ac),
Ga.lg.yA(Ac,!1,!1),Ga.lg.YI(Ac))}Bb=Ac.currentNode;Ac=aa.GraphIterator.$a(Ra);Ac.vd();ra.OutlineElementNavigator.Vd(Ac);Ac.Cg();gb&&(this.V$a=N.SelectionFactory.ue(Bb,M.ParagraphReader.textLength(Bb)))}}}static get lg(){return null!=Ga.pEg?Ga.pEg:Ga.pEg=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get Sn(){return null!=Ga.Qzg?Ga.Qzg:Ga.Qzg=y.a.instance.resolve("Box4.IFormattingEditor")}static OBo(){Ga.AOe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Ga.qbh=["The quick brown fox jumps over the lazy dog. "];Ga.r5g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static gG(Ra,
gb,Bb,$b,Qb){return new Ga(null,Ra,gb,Bb,$b,Qb)}static xT(Ra,gb,Bb,$b,Qb){return new Ga(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb)}}Ga.AOe=null;Ga.qbh=null;Ga.r5g=null;Object(E.a)(Ga,"RandAction",Ka,[]);class Ua{constructor(Ra,gb,Bb,$b){this.pattern=$b&8?new RegExp(Ra,"i"):new RegExp(Ra);this.ktm=gb;this.$jm=Bb;this.flags=$b}}Object(E.a)(Ua,"RegexAutoCorrectEntry",null,[]);class wb extends Na{get commandId(){return G.a.RHk}Rma(Ra){if(wb.Rkb){var gb=aa.GraphIterator.$a(Ra);gb.vd();ra.OutlineElementNavigator.Vd(gb);
if(wb.Un.Ahe(gb,this.oY[0])){var [Bb,$b]=this.oY,Qb=wb.ain($b);if(!(0>=Qb)){var Ac=f.a.Kbc($b.charAt(0))?5:3,Db=F.a.createTextRange(Ra,this.FG,this.m0+1);wb.Un.m1b(Ra,gb,Ac,Qb,Db,Bb,this.levelText,wb.Rkb)}}}}static gG(Ra,gb,Bb,$b,Qb){return new wb(null,Ra,gb,Bb,$b,Qb)}static xT(Ra,gb,Bb,$b,Qb){return new wb(Ra,la.a(Ra).Bb,gb,Bb,$b,Qb)}static xvl(){wb.ZLa||(wb.ZLa={},wb.ZLa.M=1E3,wb.ZLa.D=500,wb.ZLa.C=100,wb.ZLa.L=50,wb.ZLa.X=10,wb.ZLa.V=5,wb.ZLa.I=1)}static ain(Ra){if(!Ra)return 0;wb.xvl();Ra=f.a.VA(Ra);
let gb=0,Bb=0;for(let $b=Ra.length-1;0<=$b;$b--){const Qb=wb.ZLa[f.a.charAt(Ra,$b).toString()];Bb=Qb<gb?Bb-Qb:Bb+Qb;gb=Qb}return Bb}}wb.ZLa=null;wb.F3f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Ra=>`\\(?(${Ra})[\\.\\)\\-]`);Object(E.a)(wb,"RomanListAction",Na,[]);var cc=c(40);class zb extends Pa.a{constructor(Ra,gb,Bb,$b,Qb,Ac){super(Ra,gb,Bb,Bb+1,Ac);this.Fmk=
$b;this.RPg=Qb;this.sZc=!1}get VC(){return!1}get commandId(){return G.a.SHk}eCb(Ra){Ra.innerText=f.a.substring(Ra.innerText,0,this.FG)+this.RPg+f.a.right(Ra.innerText,this.m0)}Rma(Ra){this.Kd.replaceTextRange(F.a.createTextRange(Ra,this.FG,this.m0),this.Fmk,!0,!1);this.Kd.replaceTextRange(F.a.createTextRange(Ra,this.FG,this.FG+1),this.RPg,!0,!1)}set VC(Ra){super.VC=Ra}static gG(Ra,gb,Bb,$b,Qb,Ac){if("'"!==Bb&&'"'!==Bb)return null;var Db=aa.GraphIterator.$a(Ra);Db.vd();ra.OutlineElementNavigator.Vd(Db);
if(cc.OutlineElementReader.an(Db.currentNode))return null;$b=!gb||f.a.lca($b)||-1!==Array.indexOf(zb.uvn,$b);Db="'"===Bb;return new zb(Ac,Ra,gb,Bb+"",$b?Db?"\u2018":"\u201c":Db?"\u2019":"\u201d",Qb)}}zb.uvn=["[","{","("];Object(E.a)(zb,"SmartQuoteCorrectAction",Pa.a,[]);class nb extends Pa.a{constructor(Ra,gb,Bb,$b,Qb,Ac){super(Ra,gb,Bb,$b,Ac);this.QPg=Qb}get VC(){return nb.evc}set VC(Ra){nb.evc=Ra}get commandId(){return G.a.THk}GIj(){this.Jnd=this.GCh();this.Jnd||(this.$3g=!1,this.VZg="MatchTextIsNotTheSame")}eCb(Ra){Ra.innerText=
f.a.substring(Ra.innerText,0,this.FG)+this.QPg+f.a.right(Ra.innerText,this.m0)}Rma(Ra){this.Kd.replaceTextRange(F.a.createTextRange(Ra,this.FG,this.m0),this.QPg,!0,!1)}static xT(Ra,gb,Bb,$b,Qb){const Ac=la.a(Ra);return new nb(Ra,Ac?Ac.Bb:null,gb,Bb,$b,Qb)}static gG(Ra,gb,Bb,$b,Qb){return new nb(null,Ra,gb,Bb,$b,Qb)}}nb.evc=!1;Object(E.a)(nb,"StringReplaceCorrectAction",Pa.a,[]);class eb extends Pa.a{constructor(Ra,gb,Bb,$b,Qb,Ac,Db,dc){super(Ra,gb,Bb,$b,Qb);this.Ik=Ac;this.j8j=Db;this.yD=dc}get VC(){return!0}get commandId(){return G.a.UHk}eCb(Ra){let gb=
f.a.substring(Ra.innerText,this.FG,this.m0);gb.charAt(0)!==gb.charAt(0).toUpperCase()&&(gb=gb.charAt(0).toUpperCase()+gb.substring(1,gb.length));Ra.innerText=f.a.substring(Ra.innerText,0,this.FG)+gb+f.a.right(Ra.innerText,this.m0)}Rma(Ra){const gb=this.FG,Bb=this.FG+1,$b=Ra.characterData.substring(gb,Bb).charAt(0);if(!f.a.Kbc($b)){const Qb=F.a.createTextRange(Ra,gb,Bb);this.iHm(Qb)||this.yD&&this.yD.cWc(Ra,gb,Bb)||this.Kd.replaceTextRange(Qb,$b.toUpperCase().toString(),!0,!1)}}iHm(Ra){return this.j8j?
!!this.Ik&&this.Ik.I8(Ra):!1}set VC(Ra){super.VC=Ra}static xT(Ra,gb,Bb,$b){const Qb=la.a(Ra);return new eb(Ra,Qb?Qb.Bb:null,gb,Bb,$b,null,!1,null)}static gG(Ra,gb,Bb,$b,Qb,Ac){return new eb(null,Ra,gb,Bb,$b,Qb,!0,Ac)}}Object(E.a)(eb,"UpperFirstLetterAutoCorrectAction",Pa.a,[]);class Ib{constructor(Ra,gb){this.Mvc=gb;this.LF=Ra}Y_o(){const Ra=Number.parseInvariant(this.LF.substring(0,this.LF.length-2));switch(Number.parseInvariant(this.LF.charAt(this.LF.length-3).toString())){case 1:return 11===Ra?
"th":"st";case 2:return 12===Ra?"th":"nd";case 3:return 13===Ra?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}lOm(){var Ra=l.a.og(this.Mvc);if(!Ra||!Ra.name.toLowerCase().startsWith("en")||!this.LF||2>=this.LF.length)return!1;for(Ra=0;Ra<Ib.PSd().length;Ra++)if(this.LF.toLowerCase().endsWith(Ib.PSd()[Ra])){if(RegExp("^\\d+$").test(this.LF.substr(0,this.LF.length-2))){const gb=this.Y_o();if(this.LF.toLowerCase().endsWith(Ib.PSd()[Ra])&&gb===Ib.PSd()[Ra])return!0}break}return!1}static PSd(){return Ib.D9g||
(Ib.D9g=["st","nd","rd","th"])}}Ib.D9g=null;Object(E.a)(Ib,"ValidateOrdinalsRule",null,[]);c.d(K,"a",function(){return Xa});class Xa{constructor(Ra,gb,Bb,$b,Qb,Ac,Db){this.Azc=[];this.ySb=[];this.Toc=[];this.fte=new Set;this.pab=-1;this.IYg=this.Kea=!1;this.E5j=Ra;this.Kd=gb;this.Ik=Bb;this.ga=$b;this.BV=Ac;this.yD=Db;Qb?(this.Kea=Qb.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.IYg=Qb.$("HyperlinkUrlValidationIsEnabled"),n.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Kea})):
(n.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Kea=!1)}sjb(Ra){return 0<=Xa.v2e.indexOf(Ra)}DGf(Ra){return 0<=Xa.w2e.indexOf(Ra)}kEf(Ra){return Ra.toLowerCase()===Ra}Kbc(Ra){return Ra.toUpperCase()===Ra}nXd(Ra){return Ra.toLowerCase()!==Ra.toUpperCase()}IJm(Ra,gb,Bb,$b){return(new ma(Ra,gb,Bb,$b)).CUk()}bSl(Ra){do{if(Ra.getAttribute("xml:lang"))return l.a.og(Ra.getAttribute("xml:lang"))||l.a.aTc;if(Ra.getAttribute("lang"))return l.a.og(Ra.getAttribute("lang"))||
l.a.aTc;Ra=Ra.parentNode}while(Ra&&1===Ra.nodeType);return l.a.aTc}Sof(Ra){return l.a.og(w.FormattingReader.language(w.FormattingReader.Kr(Ra)))||l.a.aTc}QLd(Ra,gb){0>gb&&(gb=0);let Bb=-1;const $b=Xa.v2e.length;for(let Qb=0;Qb<$b;++Qb){const Ac=Ra.lastIndexOf(f.a.charAt(Xa.v2e,Qb),gb);Ac>Bb&&(Bb=Ac)}Ra=f.a.D3a(Ra,gb);Ra>Bb&&(Bb=Ra);return Bb}OBl(Ra){for(let gb=0;gb<Ra.length;++gb)if(this.nXd(f.a.charAt(Ra,gb)))return gb;return-1}nkf(Ra,gb){if(!Ra||0>gb)return-1;let Bb=gb;Bb=Bb?this.QLd(Ra,Bb-1):-1;
Bb=Bb>f.a.D3a(Ra,gb-1)?Bb:f.a.D3a(Ra,gb-1);Bb++;return Bb}a_h(Ra,gb,Bb){this.MKc(gb);if(!this.ySb[gb]){gb=J.d8h(gb);if(0>=gb)return null;this.MKc(gb);if(!this.ySb[gb])return null}if(Bb&&this.Toc[gb]&&Array.contains(this.Toc[gb],Ra+Bb))return null;Bb=this.ySb[gb][f.a.Ug(Ra)];if("string"!==typeof Bb||Bb===Ra||!Bb)return null;var $b=this.OBl(Ra);if(0>$b||this.kEf(f.a.charAt(Ra,$b)))return Bb;gb=!0;for($b+=1;$b<Ra.length;++$b){const Qb=f.a.charAt(Ra,$b);gb&&!this.Kbc(Qb)&&(gb=!1)}return gb?null:f.a.VA(f.a.substring(Bb,
0,1))+f.a.right(Bb,1)}aCl(Ra,gb,Bb,$b){a.a.mark(4666);const Qb=this.bSl(gb).LCID;let Ac=0,Db=Ra;const dc=gb.innerText;var Pb=dc.lastIndexOf(" ",Ra);if(this.UCf(dc.substring(Pb+1,Ra)))return a.a.mark(4667),null;Pb=null;var Ub=!1;do{Db=Db?this.QLd(dc,Db-1):-1;if(-1===Db&&!Bb){Ub=gb;var rb=null;if(!this.sjb(dc.charAt(0))){do{for(;Ub&&!Ub.previousSibling;)Ub=Ub.parentNode;Ub&&(Ub=Ub.previousSibling,rb=Ub.innerText)}while(Ub&&!rb);if(Ub&&rb&&!this.sjb(f.a.charAt(rb,rb.length-1)))return a.a.mark(4667),
null}Ub=!0}rb=f.a.substring(dc,Db+1,Ra);++Ac;var Yb=this.a_h(rb,Qb,$b.toString());if(Yb)Pb=nb.xT(gb,Db+1,Ra,Yb,this.Kd),Xa.WJf();else for(const Ya of this.Azc)if(!(Ya.flags&1&&!(Bb&&1>Db)||Ya.flags&4||Ya.flags&2&&" "!==$b)&&(Yb=Ya.pattern.exec(rb))){Pb=Ya.ktm(gb,Db+1,Ra,Yb,this.Kd,this.ga);break}}while(!Ub&&!Pb&&Ac<Xa.tMi&&0<=Db);a.a.mark(4667);return Pb}ZBl(Ra,gb,Bb){const $b=Ra.node;let Qb=M.ParagraphReader.text($b);0>gb&&(gb=Ra.cpBegin);Ra=this.Sof(Ra).LCID;if(this.UCf(Qb.substring(f.a.D3a(Qb,
gb)+1,gb)))return null;var Ac=-1,Db=P.HyperlinkReader.nOc($b);for(var dc=0;dc<Db.length;dc++)if(gb>Db[dc].cpEnd)Ac=Db[dc].cpEnd;else{if(gb>Db[dc].cpBegin)return null;break}Db=null;dc=(dc=gb)?this.QLd(Qb,dc-1):-1;dc<Ac&&(dc=Ac-1);Ac=f.a.substring(Qb,dc+1,gb);Ac=Ac.trimStart();if(1>dc)for(const Pb of this.Azc){let Ub=Qb;" "!==Bb&&(Ub=Qb+Bb);if(Pb.pattern.exec(Ub))return null}Qb=Qb.substring(0,gb);if(!this.IJm(Qb,Bb.toString(),Ac,Ra))return null;Ac.charAt(0).toUpperCase()!==Ac.charAt(0)&&(Db=eb.gG($b,
dc+1,gb,this.Kd,this.Ik,this.yD));return Db}BZh(Ra,gb,Bb){Ra=N.SelectionFactory.ho(Ra,!1);if(!Ra)return null;Ra=Ra.Pc;return I.SelectionEditor.gf(Ra)?this.ZBl(Ra,gb,Bb):null}UCf(Ra){return f.a.yU(Ra)}Tjf(Ra,gb,Bb,$b){a.a.mark(4666);const Qb=Ra.node,Ac=this.Sof(Ra).LCID,Db=M.ParagraphReader.text(Qb);0>gb&&(gb=Ra.cpBegin);if(Bb&&!this.sjb(f.a.charAt(Db,gb))||this.UCf(Db.substring(f.a.D3a(Db,gb)+1,gb)))return a.a.mark(4667),null;Ra=-1;Bb=P.HyperlinkReader.nOc(Qb);for(var dc=0;dc<Bb.length;dc++)if(gb>
Bb[dc].cpEnd)Ra=Bb[dc].cpEnd;else{if(gb>Bb[dc].cpBegin)return null;break}Bb=0;dc=gb;let Pb=null;do{dc=dc?this.QLd(Db,dc-1):-1;dc<Ra&&(dc=Ra-1);const rb=f.a.substring(Db,dc+1,gb);++Bb;var Ub=null;let Yb=!1;if(H.a.wTh){const Ya=Db+String.fromCharCode($b);Yb=this.Azc.some(Ob=>Ob.pattern.exec(Ya))}Yb||(Ub=this.a_h(rb,Ac,null));if(Ub)this.BV.vSa&&(Pb=nb.gG(Qb,dc+1,gb,Ub,this.Kd),Xa.WJf());else for(const Ya of this.Azc)if(!(Ya.flags&1&&-1!==dc||Ya.flags&4&&$b!==k.a.Bs||Ya.flags&2&&$b!==k.a.JIa)&&(Ub=Ya.pattern.exec(rb))){Pb=
Ya.$jm(Qb,dc+1,gb,Ub,this.Kd,this.ga);if(Pb.commandId!==G.a.u2e&&!this.BV.vSa||Pb.commandId===G.a.u2e&&!this.BV.A4c)Pb=null;break}}while(0<=dc&&dc>=Ra&&!Pb&&Bb<Xa.tMi);a.a.mark(4667);return Pb}AZh(Ra,gb,Bb){Ra=N.SelectionFactory.ho(Ra,!1);if(!Ra)return null;Ra=Ra.Pc;return I.SelectionEditor.gf(Ra)?this.Tjf(Ra,gb,!1,Bb):null}IZh(Ra,gb){var Bb=N.SelectionFactory.ho(Ra,!1);if(!Bb)return null;let $b=Bb.Pc;Bb.iy&&Bb.Pc.contextId!==z.a.endOfParagraph&&0<=gb&&($b=F.a.Rc(Ra,gb));if(!I.SelectionEditor.gf($b)||
P.HyperlinkReader.Ewa($b,!1))return null;Bb=M.ParagraphReader.text($b.node);Ra=0<gb?f.a.D3a(Bb,gb-1)+1:f.a.D3a(Bb,Bb.length-1)+1;gb=0<gb?gb:Bb.length;Bb=f.a.substring(Bb,Ra,gb);return!Bb||this.IYg&&!P.HyperlinkReader.r3a(Bb)||!f.a.yU(Bb)&&!f.a.PTc(Bb)||!Xa.hyperlinkEditor.KZn($b,Ra,gb)?null:this.E5j.J$k($b.node,Ra,gb)}NZh(Ra,gb){var Bb=N.SelectionFactory.ho(Ra,!1);if(!Bb)return null;var $b=Bb.Pc;if(!I.SelectionEditor.gf($b))return null;0>gb&&(gb=$b.cpBegin);var Qb=M.ParagraphReader.text($b.node);
Bb=this.nkf(Qb,gb);const Ac=Xa.w2e.length;for(let Db=0;Db<Ac;++Db){const dc=Qb.lastIndexOf(f.a.charAt(Xa.w2e,Db),gb-1);dc>Bb&&(Bb=dc+1)}Qb=f.a.substring(Qb,Bb,gb);if(!Qb)return null;$b=this.Sof($b).LCID;return(new Ib(Qb,$b)).lOm()?fb.gG(Ra,Bb,gb,this.Kd):null}xZh(Ra,gb){var Bb=N.SelectionFactory.ho(Ra,!1);if(!Bb)return null;Bb=Bb.Pc;if(!I.SelectionEditor.gf(Bb))return null;0>gb&&(gb=Bb.cpBegin);var $b=M.ParagraphReader.text(Bb.node);Bb=this.nkf($b,gb);$b=f.a.substring($b,Bb,gb);return $b?($b=(new Ja($b)).zHl())?
oa.gG(Ra,Bb,gb,$b,this.Kd):null:null}XCl(Ra,gb,Bb,$b,Qb){var Ac=N.SelectionFactory.ho(Ra,!1);if(!Ac)return null;Ac=Ac.Pc;if(Bb>gb||!I.SelectionEditor.gf(Ac))return null;0>gb&&(gb=Ac.cpBegin);if(0>gb)return null;Ac=M.ParagraphReader.text(Ac.node);return zb.gG(Ra,Bb,Qb,gb?Ac.charAt(gb-1):"\x00",this.Kd,$b)}Yyb(Ra,gb,Bb,$b){this.Azc.push(new Ua(`^${Ra}$`,gb,Bb,$b))}CMf(Ra){if(this.ySb[this.pab]){const gb=this.ySb[this.pab];for(const Bb in Ra)gb[Bb]=Ra[Bb]}else this.ySb[this.pab]=Ra}HMf(Ra){this.Toc[this.pab]?
this.Toc[this.pab].push(...(Ra||[])):this.Toc[this.pab]=Ra}RZm(Ra,gb){var Bb;this.fte.has(gb)||(this.fte.add(gb),null===(Bb=x.AFrameworkApplication.Ne)||void 0===Bb?void 0:Bb.tj(Ra,1,null,null,!1,3,$b=>{this.pab=gb;try{Object(u.a)($b.data.we)}catch(Qb){n.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:$b.data?$b.data.we:""})}this.pab=-1},()=>{this.Iul(gb)},null,void 0,void 0,void 0,void 0,"27"))}Iul(Ra){Ra=J.d8h(Ra);0<Ra&&this.MKc(Ra)}static get nIk(){return null!=
Xa.Zvg?Xa.Zvg:Xa.Zvg=(()=>Xa.Dvh.map(([Ra,...gb])=>(new Ua(`^${Ra}`,...gb)).pattern))()}static get Dvh(){return null!=Xa.$vg?Xa.$vg:Xa.$vg=(()=>[...wa.F3f.map(Ra=>[Ra,wa.xT,wa.gG,3]),["\\(?(\\d+)[\\.\\)\\-]",kb.xT,kb.gG,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",za.xT,za.gG,3],...wb.F3f.map(Ra=>[Ra,wb.xT,wb.gG,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",za.xT,za.gG,3]])()}$Zm(){this.MKc(1033);this.Yyb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ga.xT,Ga.gG,5);this.Yyb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Ga.xT,Ga.gG,5);this.Yyb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ga.xT,Ga.gG,5);Xa.Dvh.forEach(Ra=>this.Yyb(...Ra));this.Yyb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",va.xT,va.gG,0);this.Yyb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",xa.xT,xa.gG,0);this.Yyb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",xa.xT,xa.gG,0)}MKc(Ra){this.fte.has(Ra)||this.RZm(L.a.pLk(String.format("Acl/Acl{0}.js",Ra)),Ra)}static WJf(){y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(Ra=>{Ra.logActivity("AutocorrectStringMatch",
null)})}static get hyperlinkEditor(){return null!=Xa.BAg?Xa.BAg:Xa.BAg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}Xa.v2e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Xa.w2e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Xa.m$f=".!?";Xa.tMi=5;Object(E.a)(Xa,"AutoCorrectRules",null,[680])},1646:function(E,K,c){E=c(0);var l=c(35),f=c(7),a=c(454),k=c(568),x=c(55),y=c(2),n=c(38);const u=(Y,ca,aa)=>{if(Y){var fa=0;do{try{Y();break}catch(pa){if(f.ULS.sendTraceTag(50946190,
306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",fa,aa,pa.message,pa.stack),fa>=ca)break}fa++}while(1)}};var z=c(91),w=c(26),F=c(201),G=c(191),H=c(57),L=c(311),I=c(20),N=c(135);class P{constructor(Y,ca,aa,fa,pa,ra,la,qa,La=!0,Pa=null,Ka=!1){this.$Yh="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.Bl=this.Usc=this.lAe=this.CYa=this.Fid=this.rE=this._form=null;this.Oh=!1;this.My=this.Gid=this.Ycb=null;this._parent=Y;this.y6j=ca;this.Ogk=aa;this.SVg=
pa;this.yBa=la;this.fKg=qa;this.DNg=Pa;this.oWe=!1;this.x7j=fa.$("CanaryRenewalForFileUploadIsEnabled");this.CZo=!1;(this.ubb=Ka)||this.Z7k(ra);La&&this.Aqi()}get zdj(){return this.Ogk}get sessionId(){return this.yBa}get iFrame(){return this._iframe}get OT(){return this.rE}get JJb(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get UYh(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get OMm(){return this.ubb?
!1:G.b(this._iframe.contentWindow.location.pathname,this.$Yh,0)}get XAk(){return!I.a.voa&&y.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}Aqi(){this.My=N.a.create().toString();this.ubb?this.Jhf():this.MCk()}Z7k(Y){this._iframe=document.createElement("iframe");this._iframe.className=Y;this._iframe.id=Y;this.SVg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.CYa=Object(x.a)(this,this.kWf,"onUploadFrameLoad");
n.a.addHandler(this._iframe,"load",this.CYa)}OId(Y=null){y.AFrameworkApplication.ta.J$d();if(!this.rE)return f.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";n.a.addHandler(this.rE,"change",()=>{this.oAl(Y)});u(Object(x.a)(this,this.TYh,"fileInputClick"),1,"DoFileOpenDialog");return this.rE.value}oAl(Y){Y&&Y(this.rE.value)}pAl(){this.Fid&&(this.Fid.innerText=this.r$h())}HVn(Y){n.a.addHandler(this.rE,"change",()=>{Y(this.r$h())})}r$h(){let Y=null;if(this.rE.value){const ca=this.rE.value,
aa=ca.lastIndexOf("\\");0<aa&&(Y=ca.substring(aa+1,ca.length))}return Y?Y:""}TYh(){try{f.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.rE.click()}catch(Y){throw f.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}}q9c(){this.lRm()?this.Wvj():(this.$mg(),this._form.submit())}lRm(){return(this.x7j||this.ubb)&&!(void 0===window.self.FormData||null===window.self.FormData)}uij(Y){if(Y){const ca=this.LJh();
this.Bl=new XMLHttpRequest;this.Bl.open("POST",ca);this.Bl.setRequestHeader("X-CorrelationId",this.My);this.g2m(Y);this.Bl.onreadystatechange=Object(x.a)(this,this.hza,"uploadResponseReceived");this.Bl.send(Y)}}g2m(Y){if(!I.a.voa&&Y.get){var ca=Y.get("ImageId");Y=window.self.navigator;ca={["CorrelationId"]:this.My,["Canary"]:y.AFrameworkApplication.canary,["ImageNodeId"]:ca};Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?Y.webkitConnection:null)&&(ca.effectiveType=
Y.effectiveType,ca.downlink=Y.downlink,ca.type=Y.type,ca.rtt=Y.rtt);f.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",ca)}}Wvj(){try{this.$mg();f.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const Y=new (Type.parse("FormData"))(this._form);this.uij(Y)}catch(Y){f.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Y.message),this.Xec(null)}}Vvj(Y){try{if(this.$mg(),f.ULS.sendTraceTag(594888406,
322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.h0o(Y)){this.Gid=Y;this._form.contains(this.rE)&&this._form.removeChild(this.rE);var ca=new (Type.parse("FormData"))(this._form);ca.append("applicationfileInput",Y.blob,Y.filename);this.uij(ca)}else this.Xec(null)}catch(aa){f.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+aa.message),this.Xec(null)}}h0o(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==
Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(f.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",f.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),
!1)}hza(){if(4===this.Bl.readyState)if(200===this.Bl.status){f.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.My);const Y=this.Bl.getResponseHeader("X-NewKey"),ca=this.$Fm(this.Bl);let aa=!1;if(void 0!==Y&&null!==Y&&ca&&(aa=this.T_o(Y),!this.oWe&&aa)){f.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.My);this.oWe=!0;this.xGd();void 0!==this.Gid&&
null!==this.Gid?this.Vvj(this.Gid):this.Wvj();return}f.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.oWe,ca,!(void 0===Y||null===Y),aa,this.My);this.Xec(this.Bl.responseText)}else f.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Bl.status,this.Bl.responseText?!1:!0,this.My),this.Xec(null)}$Fm(Y){try{const ca=
l.a(Y.responseText).Responses;if(void 0!==ca&&null!==ca&&1===ca.length){const aa=ca[0];if(void 0!==aa&&null!==aa&&2===aa.length&&28===aa[1].StatusCode)return!0}}catch(ca){}return!1}T_o(Y){L.a.Hlg(Y);return y.AFrameworkApplication.canary!==Y?!1:!0}$mg(){this.Ycb||(this.Ycb=new Date)}dispose(){this.Oh||(this.ubb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),n.a.removeHandler(this._iframe,"load",this.CYa),this.CYa=null),this.lAe&&(n.a.removeHandler(this.rE,"change",this.lAe),
this.lAe=null),this.UYh&&(this.Usc&&(n.a.removeHandler(this.rE,"change",this.Usc),this.Usc=null),this.Fid=null),this.rE=this._form=this._parent=this._iframe=null,this.Oh=!0,this.Ycb=null,f.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}E3b(Y,ca){if(this._form){var aa;(aa=this._form.querySelector("input[name="+Y+"]"))?aa.value=ca:(aa=this.yaf(),aa.type="hidden",aa.id=Y,aa.name=Y,aa.value=ca,this._form.appendChild(aa))}}yaf(){return this.ubb?document.createElement("input"):
this._iframe.contentWindow.document.createElement("input")}kWf(){try{if(!this._iframe.contentWindow.document.body)return}catch(ca){this.vQc();return}if(!(this._initialized||this.JJb&&I.a.PH))this.Jhf();else if(!this.JJb||!I.a.PH||this.OMm){let ca;ca=I.a.At?this._iframe.contentWindow.document.body.innerText:this.CZo?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var Y=this._iframe.contentWindow.document.body.innerText.toLowerCase();
const aa=0<=Y.indexOf("responses")||0<=Y.indexOf("wopisrc");Y=0<=Y.indexOf("http error");!aa&&Y&&f.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.Xec(ca)}}Jhf(){if(!this._initialized){var Y=this.QD("uploadForm");const ca=this.QD("fileInput"),aa=this.LJh();this.h$k();this._form.id=Y;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=aa;this.rE.type="file";this.fKg&&
(this.rE.accept=this.fKg,this.DNg&&(this.rE.capture=this.DNg));this.rE.id=ca;this.rE.name=ca;this.XAk&&(this.rE.multiple=!0);!this.UYh||I.a.At||I.a.du||(this.Usc=Object(x.a)(this,this.pAl,"fileInputChangedHandleAccessibility"),n.a.addHandler(this.rE,"change",this.Usc),this.Fid=w.a.osh(this._form,this.rE,"InputFileDescription"));this.SVg&&(this.ubb||(Y=this._iframe.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=y.AFrameworkApplication.ta,this.rE.style.fontFamily=Y.aza,
this.rE.style.fontSize=Y.$kg,this.rE.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&this.E3b("__REQUESTDIGEST",Y.value);this.xGd();this._form.appendChild(this.rE);this._initialized=!0;this.y6j(this)}}h$k(){if(this.ubb)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.rE=document.createElement("input");else{this._form=this._iframe.contentWindow.document.createElement("form");const Y=this._iframe.contentWindow.document;Y.body.appendChild(this._form);
this.rE=Y.createElement("input")}}MCk(){this._parent.appendChild(this._iframe);this.JJb&&I.a.PH&&this.Jhf()}LJh(){var Y=new F.QueryStringBuilder(this.$Yh);y.AFrameworkApplication.dfa(Y);this.afo(Y);Y=Y.toString();if(I.a.jj||I.a.PH||I.a.du)Y=H.a.LMc(Y);return Y}Qyd(){const Y=new z.a(2,1,0,Object(x.a)(this,this.delayedDispose,"delayedDispose"),4);y.AFrameworkApplication.pc.Wb(Y)}}Object(E.a)(P,"UploadFrame",null,[10]);var M=c(19),J=c(251),V=c(9),X=c(1767);class W extends P{constructor(Y,ca,aa,fa,pa,
ra,la=null,qa=!1){super(Y,ca,aa,fa,pa,"WACUploadFrame",y.AFrameworkApplication.userSessionId,ra,!1,la,qa)}QD(Y){return V.App.xa.kj(Y)}afo(Y){J.a.instance.czb(Y)}xGd(){y.AFrameworkApplication.canary&&this.E3b(a.a.canary,y.AFrameworkApplication.canary);V.App.xa.hb.activeSection.FH&&this.E3b(a.a.FH,V.App.xa.hb.activeSection.FH)}Ltf(Y){let ca=null,aa;({group:aa}=k.a.l1(Y)).returnValue?ca=aa.Responses[0]:f.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");
return ca}vQc(){f.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const Y=new X.a;Y.StatusCode=14;this.zdj(Y);this.Qyd()}Xec(Y){Y?(Y=M.a.Hvj(Y),Y=Y.replace(RegExp("&amp;","g"),"&"),(Y=this.Ltf(Y))?(this.zdj(Y),this.Qyd()):this.vQc()):this.vQc()}}Object(E.a)(W,"Box4UploadFrame",P,[]);c.d(K,"a",function(){return U});class U extends W{constructor(Y,ca,aa,fa,pa,ra=null,la=!1){super(Y,ca,aa,fa,pa,
U.VJl(),ra,la);this.Aqi()}static VJl(){return U.pkh.join(",")+","+U.yWe.join(",")}xGd(){super.xGd();this.E3b(a.a.Cqb,"1");this.E3b(a.a.XQb,"1")}vQc(){super.vQc();f.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}Ltf(Y){const ca=super.Ltf(Y);if(!ca)try{const aa=l.a(Y);k.a.Zlf(aa)}catch(aa){f.ULS.sendTraceTag(41697633,322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",aa.toString())}return ca}}U.pkh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");
U.yWe=[".webp"];Object(E.a)(U,"Box4ImageUploadFrame",W,[])},1648:function(E,K,c){E=c(0);var l=c(135),f=c(58),a=c(354),k=c(53),x=c(3),y=c(1185),n=c(18),u=c(5),z=c(298),w=c(43),F=c(1322),G=c(817),H=c(116),L=c(42),I=c(15),N=c(6),P=c(145),M=c(41),J=c(7),V=c(1861),X=c(680),W=c(1702),U=c(123),Y=c(1553);class ca{constructor(la,qa,La,Pa,Ka,Na){this.k5b=this.EH=null;this.hmf=qa;if(la[X.a.cQc])this.gU=la[X.a.cQc],this.ZDc=la[X.a.ZDc],this.k5b=Array(4),this.k5b[0]=la[X.a.Rfb],this.k5b[1]=la[X.a.Sfb],this.k5b[2]=
la[X.a.Tfb],this.k5b[3]=la[X.a.Qfb],this.x2o=la[X.a.width],this.urm=la[X.a.height],this.Uwa=void 0!==la[X.a.Uwa]?"true"===la[X.a.Uwa].toLowerCase():void 0,this.gt=La,this.$4b=Pa;else{qa=la[X.a.Rfb];const sa=la[X.a.Sfb],wa=la[X.a.Tfb],ja=la[X.a.Qfb];Na&&Na.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==qa&&void 0!==sa&&void 0!==wa&&void 0!==ja?(this.Rfb=qa,this.Sfb=sa,this.Tfb=wa,this.Qfb=ja):(this.Rfb=la[X.a.left],this.Sfb=la[X.a.right],this.Tfb=la[X.a.top],this.Qfb=la[X.a.bottom]);this.width=
la[X.a.width];this.height=la[X.a.height];this.rotationAngle=la[X.a.angle];this.tCn=la[X.a.sCn];this.gt=La;this.$4b=Pa;this.yeb=Ka;this.PEa=2;this.flipH=this.zX(la,X.a.flipH);this.flipV=this.zX(la,X.a.flipV);this.Kgn();this.XTo()}}XTo(){this.EH||(this.EH=Array(4),this.EH[0]=U.a.oG(this.Rfb),this.EH[1]=U.a.oG(this.Sfb),this.EH[2]=U.a.oG(this.Tfb),this.EH[3]=U.a.oG(this.Qfb))}Kgn(){var la=Y.c(this.rotationAngle);if(45<=la&&135>=la||225<=la&&315>=la){la=this.width/2;const qa=this.height/2;this.Rfb-=la-
qa;this.Sfb+=la-qa;this.Tfb-=qa-la;this.Qfb+=qa-la}}zX(la,qa){if(la.hasOwnProperty(qa))return la[qa]}}Object(E.a)(ca,"JsonToDocumentXmlResponseCommonParams",null,[]);class aa extends ca{constructor(la,qa,La,Pa,Ka,Na){super(la,qa,La,Pa,Ka,Na);this.kBk="string"===typeof la[X.a.dAd]?la[X.a.dAd]:null;this.S5b="string"===typeof la[X.a.S5b]?la[X.a.S5b]:null}}Object(E.a)(aa,"JsonToDocumentXmlResponseDrawingParams",ca,[]);var fa=c(515);class pa extends ca{constructor(la,qa,La,Pa,Ka,Na){var sa,wa,ja,ha,va;
super(la,qa,La,Pa,Ka,Na);this.PYo=la[X.a.cCn];this.$3k=la[X.a.VBn];this.PEa=1;this.$3k||(this.PEa=0,this.EH=fa.a.instance.wna(U.a.oG(this.width),U.a.oG(this.height),this.rotationAngle));this.KWf=this.zX(la,X.a.efc);this.J8d=this.zX(la,X.a.J8d);this.LWf=this.zX(la,X.a.LWf);this.UJj=this.zX(la,X.a.TJj);this.Moe=this.zX(la,X.a.Moe);this.Nog=this.zX(la,X.a.Nog);this.O3c=null!==(sa=this.zX(la,X.a.O3c))&&void 0!==sa?sa:"";this.extension=la[X.a.extension];this.Gua=null!==(wa=this.zX(la,X.a.left))&&void 0!==
wa?wa:0;this.Iua=null!==(ja=this.zX(la,X.a.top))&&void 0!==ja?ja:0;this.Hua=null!==(ha=this.zX(la,X.a.right))&&void 0!==ha?ha:0;this.Fua=null!==(va=this.zX(la,X.a.bottom))&&void 0!==va?va:0;this.lockAspectRatio=this.zX(la,X.a.lockAspectRatio);this.Zwh=this.zX(la,X.a.mia);this.borderStyle=this.zX(la,X.a.Dpa);this.borderColor=this.zX(la,X.a.DGa);this.OKk=void 0!==this.Zwh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.zX(la,X.a.altTextDescription);this.alphaModFix=
this.zX(la,X.a.alphaModFix)}}Object(E.a)(pa,"JsonToDocumentXmlResponsePictureParams",ca,[]);c.d(K,"a",function(){return ra});class ra{constructor(la,qa,La,Pa,Ka,Na,sa,wa,ja,ha,va,xa,ma,Ja,oa,za,Fa){this.D$a=this.Nxb=null;this.Kjd=la;this.lBe=qa;this.dK=La;this.Jm=Pa;this.Nl=Ka;this.Gc=Na;this.L1j=wa;this.TSg=sa;this.Oj=ja;this.Eo=ha;this.Eek=va;this.Dek=xa;this.Ma=ma;this.DV=Ja;this.ld=oa;this.b8j=za;this.e6j=Fa}ppa(la,qa,La,Pa,Ka,Na,sa){Na.stop();sa?J.ULS.sendTraceTag(575522565,3001,10,la):J.ULS.sendTraceTag(575522566,
3001,10,la);this.TSg?(Pa=this.Gc.Oc(7,x.a.dQc),Pa.Cb(La),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&qa.Fb.setValue(H.a.xOa,!1),qa.Fb.setValue(L.a.O_,0),qa.Fb.setValue(I.a.zha,qa.GPk),qa.Fb.setValue(I.a.yha,qa.EPk),Pa.dispose()):Pa();this.D$a&&this.D$a(la);Ka()}Mec(la,qa,La,Pa,Ka,Na,sa){J.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:sa.ti});
var wa=la.data.we,ja=null;try{ja=JSON.parse(wa)}catch(va){this.ppa("Failed to parse incoming JSON blob.",qa,Ka,Pa,La,sa,!1);return}if(V.a.error in ja)this.ppa("Error code returned from WordGraphicsEditorHandler endpoint: "+ja[V.a.error],qa,Ka,Pa,La,sa,!1);else{wa=10;var ha=1;try{wa=parseInt(ja[X.a.gt]),ha=parseInt(ja[X.a.$4b])}catch(va){this.ppa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",qa,Ka,Pa,La,sa,!1);return}La=la.data.request?y.a.tLc(la.data.request.get_body()):
null;la=null;la=qa.Fb;Pa=qa.getId();qa=la.getValue(N.a.gt);qa=qa!==wa&&(5===qa||5===wa||this.jpm(la,ja));5===wa?(ja=new pa(ja,this.lBe,wa,ha,La,this.Ma),la=this.nQl(Ka,Na,ja,qa,la,Pa)):(ja=new aa(ja,this.lBe,wa,ha,La,this.Ma),la=this.mQl(Ka,Na,ja,qa,la,Pa));ja=this.Gc.Oc(7,x.a.dQc);wa=Ka;n.ImageReader.C8(Ka)&&qa&&(wa=u.GraphIterator.$a(Ka),wa.zb(12),wa=wa.parentNode);ja.Cb(wa);la();this.dK.sHa(Na);ja.dispose();if(this.Nl&&this.Nl!==l.a.nil){const va=wa.Bi();null===va||void 0===va?void 0:va.contentReplicator.forceOutbound(()=>
{J.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:sa.ti});sa.stop();const xa=new f.a(this.Nl,1);this.Jm.U2b(va,xa);const ma=this.Kjd.properties;null!=ma&&Object(z.a)(()=>{const Ja=new w.GraphTransaction(3,x.a.imageRotate);Ja.Cb(Ka);ma.setValue(H.a.Y4,1);Ja.dispose()})},null,null)}this.Nxb&&this.Nxb(Ka)}}rsh(la,qa){la.Ce(V.a.fZf,"false");la.Ce(V.a.hmf,this.lBe);la.Ce(V.a.W9e,"0");la.JI(X.a.yeb,window.self.devicePixelRatio.toString());
void 0!==qa&&null!==qa&&(qa=this.Eo.Zm(qa.$j),qa=this.Eo.mk(qa),la.Ce(X.a.gt,F.a[qa]));this.b8j&&(la.Ce(X.a.JVd,"true"),la.Ce(X.a.evm,this.e6j.toString()))}cmh(la){if(this.TSg){la=la.$j;var qa=this.Eo.Zm(la);if(!qa)return null;const La=new W.a(this.L1j,qa),Pa=this.Gc.Oc(15,x.a.dQc);Pa.Cb(la.node);this.F0i(qa,!1);qa.setValue(N.a.gt,qa.ia(N.a.gt,10));Pa.fk=x.a.dQc;Pa.TFa(this.Nl,1);Pa.dispose();return La}qa=new a.DictionaryPropertySet;this.F0i(qa,!0);return(la=this.Oj.zSh(la,qa,this.Nl))&&la.blob?new W.a(la.blob.id,
la.blob.properties):null}xRd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}F0i(la,qa){la.setValue(I.a.zha,k.a.Tl(this.Eek,0));la.setValue(I.a.yha,k.a.Tl(this.Dek,1));this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!qa?la.setValue(H.a.xOa,!0):la.setValue(L.a.O_,1);la.setValue(P.a.e4,!0)}mQl(la,qa,La,Pa,Ka,Na){const sa=wa=>{this.Kjd.vUo(La,wa,la)};return this.FPi(Pa,Ka,la)?this.Q5h(qa,Ka,Na,sa):()=>{sa(Ka)}}nQl(la,qa,La,Pa,Ka,Na){const sa=
wa=>{this.Kjd.wUo(La,wa,la)};return this.FPi(Pa,Ka,la,La)?this.Q5h(qa,Ka,Na,sa):()=>sa(Ka)}FPi(la,qa,La,Pa){return la?!0:Pa?n.ImageReader.DQd(qa,La.Jc,!1)!==Pa.KWf:!1}Q5h(la,qa,La,Pa){const Ka=G.a.instance.Mcd;Ka.Vw(qa);Ka.id=La;return()=>{this.Kjd.N2n(la,La,Ka,this.DV,Pa)}}Dmo(la){this.Nxb=la}cho(la){this.D$a=la}jpm(la,qa){return this.ld.isFeatureEnabled(46)&&(la.hasProperty(M.a.gU)&&!qa[X.a.cQc]||!la.hasProperty(M.a.gU)&&qa[X.a.cQc])?!0:!1}}Object(E.a)(ra,"GraphicsEditorJsonToDocumentXmlRequestHelper",
null,[736])},1649:function(E,K,c){E=c(0);var l=c(74),f=c(55),a=c(321),k=c(337);class x{constructor(F,G,H,L=0,I=0,N=null,P=null){this.commandId=F;this.controlId=G;this.timeStamp=H;this.commandSurface=a.a[L];this.Ix=k.a[I];this.contentType=N;this.ale=P}}Object(E.a)(x,"CommandActionInfo",null,[]);class y{constructor(){this.nUj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}jUm(F){return!this.nUj.exec(F)}}Object(E.a)(y,"EventsCacheLoggingUtils",null,
[]);var n=c(2),u=c(1821),z=c(650);c.d(K,"a",function(){return w});class w{constructor(){this.n5g=null;this.sJe=20;this.Ysc=this.tfd=this.Xfd=null}init(){this.n5g=new y;this.Xfd=new l.a;this.tfd=new l.a;this.Ysc=new l.a;this.sJe=n.AFrameworkApplication.K.mc("MaxCommandClickedEventQueueSize",20);u.a.Nwk(Object(f.a)(this,this.e0k,"commandClickEventRaised"));z.a.instance.vph(Object(f.a)(this,this.vPn,"recordActionEvent"))}pkg(F){F.count>this.sJe&&F.removeAt(this.sJe)}e0k(F,G){this.Xfd.insert(0,new x(G.commandId,
G.controlId,G.time,G.commandSurface,G.Ix,G.contentType));this.pkg(this.Xfd)}vPn(F,G){this.tfd.insert(0,new x(G.actionName,G.controlId,G.timeStamp,G.commandSurface,G.Ix,G.contentType,G.ale));this.pkg(this.tfd);this.n5g.jUm(G.actionName)&&(this.Ysc.insert(0,new x(G.actionName,G.controlId,G.timeStamp,G.commandSurface,G.Ix,G.contentType,G.ale)),this.pkg(this.Ysc))}uNc(){return this.Xfd}Wgb(){return this.tfd}static get instance(){return w._instance||(w._instance=new w)}}w._instance=null;Object(E.a)(w,
"CommandClickEventsCache",null,[])},1651:function(E,K,c){E=c(0);class l{}Object(E.a)(l,"AuthContext",null,[]);var f=c(2),a=c(743);c.d(K,"a",function(){return k});class k{static getAuthContext(){const x=f.AFrameworkApplication.K.jb("UserPrincipalName")||"";let y=x;f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(y=a.OAuthManagerSettings.xin||x);return Object.assign(new l,{upn:x,loginHint:y,authority:a.OAuthManagerSettings.authority,authorityType:k.GNd(),
tenantId:f.AFrameworkApplication.K.jb("TenantId")||""})}static GNd(){let x=0;const y=k.V3h();"aad"===y.toLowerCase()?x=2:"msa"===y.toLowerCase()&&(x=1);return x}static V3h(){return f.AFrameworkApplication.K.jb("HostAuthType")||""}}Object(E.a)(k,"OAuthIdentity",null,[])},1652:function(E,K,c){c.r(K);E=c(0);var l=c(1812),f=c(55),a=c(1814),k=c(444),x=c(1815),y=c(166),n=c(2),u=c(95),z=c(88),w=c(526),F=c(230),G=c(11),H=c(65),L=c(79),I=c(96),N=c(91),P=c(26),M=c(54),J=c(39),V=c(20),X=c(13);class W{constructor(ca){this.f4d=
4;this.Vah=0;this.nRg=this.vNg=this.rch=this.uSg=this.Ldh=this.EBa=this.NZb=this.Lw=this.Lgh=this.yVg=this.zVg=this.vBa=this.HXa=this.Gye=this.HVa=this.zVa=this.W=this.e6=this.Rza=null;V.a.Cwa&&(this.f4d=6);this.rv=ca;this.sZ=I.KeyInputManager.kc(L.a.t1,0);this.render()}get containerElement(){return this.W}dispose(){var ca=n.AFrameworkApplication.ta.hD;const aa=n.AFrameworkApplication.ta.iD;ca.uc(G.a.click,this.W,Object(f.a)(this,this.$Si,"onContainerClick"));ca.uc(G.a.oB,this.W,Object(f.a)(this,
this.aTi,"onContainerDoubleClick"));aa.uc(G.a.uh,this.W,Object(f.a)(this,this.bTi,"onContainerKeyPress"));this.zVa&&(ca.uc(G.a.click,this.zVa,Object(f.a)(this,this.mTf,"onDeleteButtonClick")),aa.dqb(this.zVa,this.nRg));this.HVa&&(ca.uc(G.a.click,this.HVa,Object(f.a)(this,this.tTf,"onDoneButtonClick")),aa.dqb(this.HVa,this.uSg));this.vBa&&(ca.uc(G.a.click,this.vBa,Object(f.a)(this,this.J7d,"onSaveButtonClick")),aa.dqb(this.vBa,this.Ldh));this.Rza&&(ca.uc(G.a.click,this.Rza,Object(f.a)(this,this.LSf,
"onCancelButtonClick")),aa.dqb(this.Rza,this.vNg));this.HXa&&(ca.uc(G.a.click,this.HXa,Object(f.a)(this,this.rVf,"onReplyButtonClick")),aa.dqb(this.HXa,this.rch));this.Lw&&(aa.uc(G.a.eu,this.Lw,Object(f.a)(this,this.oGa,"onKeyEvent")),aa.uc(G.a.uh,this.Lw,Object(f.a)(this,this.oGa,"onKeyEvent")),V.a.ui&&(ca=n.AFrameworkApplication.ta.glc,ca.uc(G.a.bHc,this.Lw,Object(f.a)(this,this.iGa,"onCompositionEvent")),ca.uc(G.a.X2b,this.Lw,Object(f.a)(this,this.iGa,"onCompositionEvent")),ca.uc(G.a.Y2b,this.Lw,
Object(f.a)(this,this.iGa,"onCompositionEvent"))),w.a.instance.uc(G.a.paste,this.Lw,Object(f.a)(this,this.K_c,"onPaste")));this.EBa=this.NZb=this.Lw=this.Rza=this.vBa=this.Gye=this.HVa=this.HXa=this.zVa=this.W=null}focus(){H.FocusManager.instance().dD(y.AFrame.Gr);this.W.focus();this.rv.Uq.hof().Zj.Iy(this.W)}p0h(){H.FocusManager.instance().dD(a.a.SGc);this.Lw.focus();this.rv.Uq.hof().Zj.Iy(this.Lw);2===this.rv.Vq&&this.Lw.value&&0<this.Lw.value.length&&J.a.Z5c(this.Lw);const ca=this.rv.Uq.Hca.L0c,
aa=J.a.s1a(ca,this.W);aa.y+this.W.clientHeight>ca.scrollTop+ca.clientHeight&&(ca.scrollTop=aa.y+this.W.clientHeight-ca.clientHeight)}sDl(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.Rza.style.display="none";this.Lw.style.display="none";H.FocusManager.ukg(this.Lw);H.FocusManager.ukg(this.vBa);H.FocusManager.instance().fe(a.a.SGc).ir(this.sZ);H.FocusManager.instance().E5a(a.a.SGc);I.KeyInputManager.instance.uc(G.a.eu,this.Lw,Object(f.a)(this,this.oGa,"onKeyEvent"));I.KeyInputManager.instance.uc(G.a.uh,
this.Lw,Object(f.a)(this,this.oGa,"onKeyEvent"));if(V.a.ui){const ca=n.AFrameworkApplication.ta.glc;ca.uc(G.a.bHc,this.Lw,Object(f.a)(this,this.iGa,"onCompositionEvent"));ca.uc(G.a.X2b,this.Lw,Object(f.a)(this,this.iGa,"onCompositionEvent"));ca.uc(G.a.Y2b,this.Lw,Object(f.a)(this,this.iGa,"onCompositionEvent"))}w.a.instance.uc(G.a.paste,this.Lw,Object(f.a)(this,this.K_c,"onPaste"));this.e6.removeChild(this.Lw);this.e6.removeChild(this.NZb);this.EBa=this.NZb=this.Lw=null;this.Hmg();this.Tad();this.focus()}Tad(){this.tbj(this.Lgh,
this.zVg,this.yVg,this.Gye,this.W)}render(){var ca=k.a("a",this.Kha("cc"),"CommentContainer");P.a.gr(ca,P.a.ofa,a.a.u1k);ca.tabIndex=0;this.rv.Df&&(ca.className+=" Reply1");var aa=k.a("div",this.Kha("ch"),"CommentHeaderRow");const fa=k.a("span",this.Kha("ca"),"CommentAuthor UIFontBold");fa.innerText=this.rv.author;aa.appendChild(fa);const pa=k.a("span",this.Kha("ct"),"CommentDate");pa.innerText=W.Dgl(this.rv.date,this.rv.Uq.Cgl,this.rv.Uq.zIo);Sys.UI.DomElement.addCssClass(pa,n.AFrameworkApplication.isRtl?
"FloatLeft":"FloatRight");aa.appendChild(pa);const ra=k.a("span",this.Kha("ci"),"CommentStatusIcon");aa.appendChild(ra);let la=null;this.rv.WGb&&(la=x.a.m_a(this.Kha("cl"),a.a.y0k,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(la,n.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),la.tabIndex=0,aa.appendChild(la));this.e6=k.a("div",this.Kha("cn"),"CommentContent");let qa=null,La=null,Pa=null;this.rv.WGb?(qa=k.a("textarea",this.Kha("ce"),a.a.dGh+
" UIFont"),qa.rows=this.f4d,qa.cols=50,qa.tabIndex=0,P.a.gr(qa,"title",CommonUIStrings.l_CommentContent),this.e6.appendChild(qa),La=k.a("div","","CommentTextMeasurementContainer"),Pa=k.a("textarea","",a.a.dGh+" UIFont"),Pa.rows=1,Pa.cols=50,Pa.style.visibility="hidden",Pa.spellcheck=!1,La.appendChild(Pa),this.e6.appendChild(La),2===this.rv.Vq&&(qa.value=this.rv.text.join("\n")+"\n")):this.Hmg();const Ka=k.a("div","","CommentFooterRow"),Na=k.a("span",this.Kha("cf"),""),sa=x.a.m_a(this.Kha("cr"),a.a.o1k+
" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);sa.tabIndex=0;sa.setAttribute(P.a.qh,P.a.f3);Na.appendChild(sa);const wa=x.a.m_a(this.Kha("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);wa.tabIndex=0;const ja=wa.childNodes[0].childNodes[0];Na.appendChild(wa);const ha=x.a.m_a(this.Kha("cx"),a.a.z0k+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);wa.tabIndex=
0;Na.appendChild(ha);Ka.appendChild(Na);const va=k.a("span",this.Kha("cfa"),""),xa=x.a.m_a(this.Kha("cs"),a.a.p1k,CommonUIStrings.l_CommentSaveCommentButton,null);x.a.TNb(xa,!1);xa.tabIndex=0;va.appendChild(xa);Ka.appendChild(va);this.tbj(ra,Na,va,ja,ca);this.rv.Uq.lJh||(fa.setAttribute("Unselectable","on"),pa.setAttribute("Unselectable","on"));ca.appendChild(aa);ca.appendChild(this.e6);ca.appendChild(Ka);this.W=ca;this.HVa=wa;this.Gye=ja;this.zVa=ha;this.HXa=sa;this.vBa=xa;this.Lw=qa;this.NZb=La;
this.EBa=Pa;this.Rza=la;this.zVg=Na;this.yVg=va;this.Lgh=ra;ca=n.AFrameworkApplication.ta.hD;aa=n.AFrameworkApplication.ta.iD;ca.mb(G.a.click,this.W,Object(f.a)(this,this.$Si,"onContainerClick"));ca.mb(G.a.oB,this.W,Object(f.a)(this,this.aTi,"onContainerDoubleClick"));aa.mb(G.a.uh,this.W,Object(f.a)(this,this.bTi,"onContainerKeyPress"));this.HVa&&(ca.mb(G.a.click,this.HVa,Object(f.a)(this,this.tTf,"onDoneButtonClick")),this.uSg=aa.pnb(this.HVa,Object(f.a)(this,this.tTf,"onDoneButtonClick"),L.a.Bs));
this.HXa&&(ca.mb(G.a.click,this.HXa,Object(f.a)(this,this.rVf,"onReplyButtonClick")),this.rch=aa.pnb(this.HXa,Object(f.a)(this,this.rVf,"onReplyButtonClick"),L.a.Bs));this.vBa&&(ca.mb(G.a.click,this.vBa,Object(f.a)(this,this.J7d,"onSaveButtonClick")),this.Ldh=aa.pnb(this.vBa,Object(f.a)(this,this.J7d,"onSaveButtonClick"),L.a.Bs));this.zVa&&(ca.mb(G.a.click,this.zVa,Object(f.a)(this,this.mTf,"onDeleteButtonClick")),this.nRg=aa.pnb(this.zVa,Object(f.a)(this,this.mTf,"onDeleteButtonClick"),L.a.Bs));
this.Rza&&(ca.mb(G.a.click,this.Rza,Object(f.a)(this,this.LSf,"onCancelButtonClick")),this.vNg=aa.pnb(this.Rza,Object(f.a)(this,this.LSf,"onCancelButtonClick"),L.a.Bs));qa&&(aa.mb(G.a.eu,qa,Object(f.a)(this,this.oGa,"onKeyEvent")),aa.mb(G.a.uh,qa,Object(f.a)(this,this.oGa,"onKeyEvent")),V.a.ui&&(ca=n.AFrameworkApplication.ta.glc,ca.mb(G.a.bHc,qa,Object(f.a)(this,this.iGa,"onCompositionEvent"),null),ca.mb(G.a.X2b,qa,Object(f.a)(this,this.iGa,"onCompositionEvent"),null),ca.mb(G.a.Y2b,qa,Object(f.a)(this,
this.iGa,"onCompositionEvent"),null)),w.a.instance.mb(G.a.paste,qa,Object(f.a)(this,this.K_c,"onPaste")),this.Uoo())}qmj(ca){x.a.TNb(this.vBa,ca)}Kha(ca){return ca+"_"+this.rv.id}tbj(ca,aa,fa,pa,ra){switch(this.rv.LSa){case 0:case 1:this.esj(ca,0);break;case 2:case 4:ca.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(ra,"SaveFailure"),Sys.UI.DomElement.addCssClass(ra,"NoReply"),this.esj(ca,1)}this.rv.done?(Sys.UI.DomElement.addCssClass(ra,"CommentIsDone"),pa.className=z.getImageClass("CheckboxChecked_16x16x32")):
(Sys.UI.DomElement.removeCssClass(ra,"CommentIsDone"),pa.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.rv.WGb?(Sys.UI.DomElement.addCssClass(ra,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(ra,"SelectedComment"),ca.style.display="none",aa.style.display="none",fa.style.display="inline",0===this.rv.Uq.mode&&(this.qmj(!1),x.a.TNb(this.Rza,!1))):(1===this.rv.Qia?(Sys.UI.DomElement.addCssClass(ra,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ra,"SelectedParentComment"),aa.style.display=
1!==this.rv.Uq.mode||3===this.rv.LSa||this.rv.fQa?"none":"inline"):(2===this.rv.Qia?(Sys.UI.DomElement.removeCssClass(ra,"SelectedComment"),Sys.UI.DomElement.addCssClass(ra,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(ra,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ra,"SelectedParentComment")),aa.style.display="inline"),fa.style.display="none")}esj(ca,aa){M.a.vC(ca);switch(aa){case 0:aa=document.createElement("img");aa.alt=CommonUIStrings.l_CommentProgressTooltip;aa.src=u.a.Yaa("progress16.gif");
ca.appendChild(aa);break;case 1:aa=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),ca.appendChild(aa)}ca.style.display="inline-block"}Hmg(){M.a.f_(this.e6);var ca=this.rv.text;1===ca.length&&ca[0]&&(ca=ca[0].split("\n"));for(const aa of ca)ca=k.a("p","","CommentContentPara"),ca.innerText=aa||"\u00a0",this.rv.Uq.lJh||ca.setAttribute("Unselectable","on"),this.e6.appendChild(ca)}Uoo(){const ca=H.FocusManager.instance().fe(a.a.SGc);ca.parent=y.AFrame.Gr;F.a.instance.$_b(a.a.SGc,
this.Lw);ca.bindAction(I.KeyInputManager.kc(L.a.Vqe,2),X.a.Hg);ca.bindAction(this.sZ,X.a.m8e);ca.bindAction(I.KeyInputManager.kc(L.a.O5,0),X.a.S_a);ca.bindAction(I.KeyInputManager.kc(L.a.Fda,0),X.a.S_a);ca.ir(H.FocusManager.instance().vW);ca.ir(H.FocusManager.instance().wW)}$Si(ca){if(this.rv.WGb&&ca.Gb.target===this.Lw)return!0;this.rv.GVf();return!0}aTi(){this.rv.ETi();return!0}bTi(ca){let aa=!1;ca.Gb.keyCode===L.a.Bs&&(0===this.rv.Qia?this.rv.GVf():this.rv.ETi(),aa=!0);return aa}mTf(){if(this.zVa.disabled)return!0;
this.rv.Wha();return!0}tTf(){if(this.HVa.disabled)return!0;this.rv.fun();return!0}rVf(){if(this.HXa.disabled)return!0;this.rv.$rn();return!0}J7d(){if(this.vBa.disabled)return!0;this.rv.GKb(this.Lw.value);return!0}LSf(){if(this.Rza.disabled)return!0;this.rv.fKb();return!0}oGa(ca){if(ca.Gb.ctrlKey&&ca.Gb.keyCode===L.a.Bs)return 0<this.Lw.value.length&&this.J7d(null),!0;if(ca.Gb.keyCode===L.a.t1)return!0;this.onTextEntered(ca.eventName===G.a.eu&&ca.Gb.charCode===L.a.Bs);return!1}iGa(){this.onTextEntered(!1);
return!1}K_c(){const ca=new N.a(0,1,0,()=>{this.onTextEntered(!1)},1);n.AFrameworkApplication.pc.Wb(ca);return!1}onTextEntered(ca){if(0!==this.rv.Uq.mode&&(this.qmj(0<this.Lw.value.length),!V.a.Cwa)){this.NZb.clientWidth!==this.Lw.clientWidth&&(this.NZb.style.width=this.Lw.clientWidth+"px");this.EBa.value=this.Lw.value+"___";this.Vah>this.Lw.value.length&&(this.EBa.rows=1);for(var aa=0,fa=Number.MAX_VALUE;1<=(aa=this.EBa.scrollHeight-this.EBa.clientHeight)&&aa<fa;)fa=aa,this.EBa.rows++;this.EBa.rows<
this.f4d?this.Lw.rows=this.f4d:(ca&&this.EBa.rows++,this.Lw.rows=this.EBa.rows);this.Vah=this.Lw.value.length}}static Dgl(ca,aa,fa){if(!ca||isNaN(ca.getDate()))return"";let pa=fa;const ra=new Date;if(ra.getFullYear()!==ca.getFullYear()||ra.getMonth()!==ca.getMonth()||ra.getDate()!==ca.getDate())pa=String.format(CommonUIStrings.l_CommentLongDateFormat,aa,fa);return ca.localeFormat(pa)}}Object(E.a)(W,"CommentViewObject",null,[10,1432]);var U=c(135);c.d(K,"Comment",function(){return Y});class Y{constructor(ca,
aa,fa,pa,ra,la,qa,La,Pa=!1,Ka=null,Na=null,sa=null){this.YKg=this.ZKg=this.PSg=null;this.Jtd=0;this.jcb=2;this.Xza=0;this.Pye=this.XN=null;this.wEf=!1;this.objectId=null;this.fQa=!1;this._id=ca;this.aXg=aa;this.LLg=fa;this.Tgd=pa;this.Bsd=ra;this.VJa=la;this.lW=qa;this.ZWg=La;this.OHh=Pa;this.BWj=Ka;this.CWj=Na;this.usersByReactionType=sa;this.Xi=l.a.instance}get id(){return this._id}set id(ca){this._id=ca}get author(){return this.YZd?CommonUIStrings.l_RemovedAuthorName:this.LLg}get authorId(){return this.BWj}get l1b(){return this.CWj}get date(){return this.YZd?
null:this.Tgd}set date(ca){this.Tgd=ca}get done(){return this.VJa}set done(ca){this.VJa!==ca&&(this.VJa=ca,this.XN&&this.XN.Tad())}get rki(){return this.ZWg}set rki(ca){this.ZWg=ca}get Df(){return this.Bsd}set Df(ca){this.Bsd=ca}get text(){return this.lW}set text(ca){this.lW=ca;this.XN&&this.XN.Hmg()}get nPa(){return this.aXg}set nPa(ca){this.aXg=ca}get X_a(){return this.PSg}set X_a(ca){this.PSg=ca}get bEc(){return this.ZKg}set bEc(ca){this.ZKg=ca}get aEc(){return this.YKg}set aEc(ca){this.YKg=ca}get Qia(){return this.Jtd}set Qia(ca){this.Jtd!==
ca&&(this.Jtd=ca,this.XN&&this.XN.Tad())}get LSa(){return this.jcb}set LSa(ca){this.jcb===ca||0===this.jcb&&2===ca||3===this.jcb||(this.jcb=ca,this.XN&&this.XN.Tad())}get Vq(){return this.Xza}set Vq(ca){if(this.Xza!==ca){const aa=this.WGb&&0===ca;this.Xza=ca;aa&&this.XN&&this.XN.sDl()}}get WGb(){return 1===this.Xza||2===this.Xza}get YZd(){return!!this.Xi&&this.Xi.removePersonalInformation}get containerElement(){return this.XN?this.XN.containerElement:null}get Uq(){return this.Xi}get iz(){return this.Pye}set iz(ca){this.Pye=
ca}dispose(){this.XN&&(this.XN.dispose(),this.XN=null)}render(){this.XN=new W(this);return this.XN.containerElement}l4a(){this.XN&&this.XN.Tad()}focus(){this.GVf();this.XN.focus();this.WGb&&this.XN.p0h()}toString(){let ca="[null]";this.lW&&0<this.lW.length&&(ca=30<this.lW[0].length?this.lW[0].substr(0,30)+"...":this.lW[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.LLg||"[null]",this.Tgd?this.Tgd.toString():"[null]",this.Bsd||"[null]",this.VJa,ca)}GVf(){2===
this.Uq.mode||3===this.Uq.mode?this.WGb&&this.XN.p0h():(H.FocusManager.instance().dD(y.AFrame.Gr),1!==this.Jtd&&this.Uq.selectComment(this._id))}ETi(){this.Uq.JDo&&0===this.Xza&&(H.FocusManager.instance().dD(y.AFrame.Gr),this.Xza=2,this.jcb=0,this.Uq.editComment(this,null))}Qmn(){3===this.Uq.mode&&(H.FocusManager.instance().dD(y.AFrame.Gr),this.Xza=0,this.jcb=2,this.Uq.J5e())}Wha(){H.FocusManager.instance().dD(y.AFrame.Gr);this.Uq.deleteComment(this)}fun(){this.Uq.qAb(this,!this.VJa)}$rn(){2!==this.Uq.mode&&
(H.FocusManager.instance().dD(y.AFrame.Gr),this.Uq.addReply(this.Bsd||this._id,null))}GKb(ca){H.FocusManager.instance().dD(y.AFrame.Gr);this.lW=Array(1);this.lW[0]=ca;1===this.Xza?this.Uq.oua(this):this.Uq.Ieb(this)}fKb(){H.FocusManager.instance().dD(y.AFrame.Gr);this.Uq.Hca.L0c&&this.Uq.Hca.L0c.focus();1===this.Xza?(this.Uq.deleteComment(this),this.Uq.cfe(this.Df)):this.Qmn()}static mKh(ca,aa,fa,pa){const ra=U.a.create().toString();ca=new Y(ra,Y.Rkm,ca,new Date,aa,!1,[],fa,!1,n.AFrameworkApplication.K.jb("PresenceUserId"),
n.AFrameworkApplication.K.jb("PresenceProvider"));ca.Xza=1;ca.jcb=0;ca.Pye=pa;return ca}}Y.Rkm=null;Y.FZi=-1;Object(E.a)(Y,"Comment",null,[10,560])},1653:function(E,K,c){E=c(0);var l=c(1205),f=c(2030),a=c(1080),k=c(8),x=c(101),y=c(43),n=c(28),u=c(23),z=c(303),w=c(1085),F=c(936),G=c(58),H=c(2),L=c(763),I=c(20),N=c(79),P=c(397),M=c(742),J=c(19),V=c(16),X=c(7),W=c(368),U=c(853),Y=c(331),ca=c(855),aa=c(501),fa=c(1033),pa=c(31);class ra{constructor(){this.QLe=void 0}onKeyPressed(wa){return this.QLe?this.QLe(wa):
!1}setKeyPressHandler(wa){this.QLe=wa}}var la=c(1446),qa=c(1621),La=c(1557),Pa=c(1521);c.d(K,"a",function(){return sa});var Ka;(function(wa){wa[wa.VLj=0]="ArrowDown";wa[wa.WLj=1]="ArrowUp";wa[wa.l7o=2]="ArrowLeft";wa[wa.m7o=3]="ArrowRight";wa[wa.End=4]="End";wa[wa.NNj=5]="Enter";wa[wa.s8o=6]="Escape";wa[wa.lOj=7]="Home";wa[wa.x$o=8]="Space";wa[wa.Tab=9]="Tab"})(Ka||(Ka={}));Object(E.b)("KeyIdentifier",Ka);var Na;(function(wa){wa.Seen="Seen";wa.Tried="Tried";wa.Kept="Kept";wa.Rejected="Rejected"})(Na||
(Na={}));Object(E.b)("EngagementType",Na);class sa extends F.a{constructor(wa,ja,ha,va,xa,ma,Ja,oa,za,Fa,kb,fb,lb,sb,ab,Ga,Ua,wb,cc){super();this.ga=wa;this.Te=ja;this.Kd=ha;this.tD=va;this.ib=xa;this.uI=ma;this.dA=Ja;this.yV=oa;this.QAa=za;this.DI=kb;this.AK=fb;this.gBa=lb;this.gVj=sb;this.Fm=ab;this.fd=Ga;this.eC=Ua;this.IF=wb;this.Gc=cc;this.ujk=0;this.ERe=!1;this.FJe=1E3;this.xjk=3500;this.Bud="ContextIQSignalId";this.gSe=0;this.l0g=!0;this.Oma=()=>{this.QAa.reset();this.S0m()};this.w_c=(zb,nb)=>
{for(const eb of nb.Ij)zb=eb.intent,8===zb.type&&(0<=eb.IIb?(zb=zb.Ib.paragraph,nb=this.Fm.LPd(zb,8,eb.cpBegin,eb.cpEnd),1<=nb.count&&nb.J(0)&&(nb=zb.characterData.indexOf("@",nb.J(0).begin),this.Fm.jlg(zb,eb.cpBegin,eb.cpEnd),nb=new l.a(8,nb,nb+1,G.a.create()),this.Fm.$Qa(zb,nb))):this.OAa.Mv(V.a.O9e,!0,void 0,void 0,void 0,void 0))};Fa&&Fa.execute(zb=>this.Vka=zb);this.OAa=new fa.a;this.K2g=new ra;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.J2h(!0);this.l2h();this.Kd.$Ze(this.w_c);
this.gVj.EMb(this);this.lea=[new f.a(Pa.a.wdb,Pa.a.wdb)]}onSessionClose(){}onSessionConnect(){this.J2h(!1);this.l2h()}onSessionDisconnect(){}get XFb(){return this.lea}static lBi(wa){return La.a.WTc(wa)?wa.isStealth:!1}static gPd(wa){var ja,ha;if(0!==(null===(ja=null===wa||void 0===wa?void 0:wa.results)||void 0===ja?void 0:ja.length))return null===(ha=null===wa||void 0===wa?void 0:wa.results[0])||void 0===ha?void 0:ha.entityType}$Pa(wa,ja){return La.a.$Pa(wa,ja,aa.a.xAb)}t_a(wa,ja){wa=La.a.Q6b(wa,
!1,aa.a.xAb);if(!wa||!wa.contains(ja))return null;ja=this.Te.vga(ja);return sa.qqg()&&sa.lBi(null===ja||void 0===ja?void 0:ja.content)?Pa.a.Nzd:Pa.a.wdb}snb(wa){sa.Acd()&&!this.wv&&(this.wv=wa,this.gBa.MMa((ja,ha)=>{ja=ha.paragraphNode;const va=ha.zia;for(const xa of ha.contents)1!=xa.nG&&0!=xa.nG||La.a.rwf(xa.element,ja,xa.intents,this.eEc,this.BHa,this.AK,this.wv,va,!1,aa.a.xAb)}))}l2h(){const wa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),ja=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),ha=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),va=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),xa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",!1),ma=sa.Bcd()&&sa.UBf?void 0:[Object.assign(new ca.CustomProp,{name:"Filter",
value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],Ja=Object.assign(new U.a,{parentPath:["Signal",ca.ClientConfigSignal.getTypeName()],items:[Object.assign(new W.a,{id:"ClientConfigSignal",body:Object.assign(new ca.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new ca.SessionConfig,{clientConfig:Object.assign(new ca.ClientConfig,{ecc:Object.assign(new ca.EccConfig,{enabled:sa.Ccd()||sa.Bcd(),entities:[Object.assign(new ca.EccEntityConfig,
{entityType:ca.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:ma}),Object.assign(new ca.EccEntityConfig,{entityType:ca.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new ca.EccEntityConfig,{entityType:ca.EntityType.Loop,enabled:wa,queryPrefix:["@"]})],bestMatch:Object.assign(new ca.BestMatchConfig,{enabled:sa.pqg()}),scopes:Object.assign(new ca.ScopeConfig,{enabled:!1})}),flag:Object.assign(new ca.FlagConfig,{enabled:sa.Acd(),entities:[Object.assign(new ca.EntityConfig,{entityType:ca.EntityType.Loop,
enabled:wa&&xa}),Object.assign(new ca.EntityConfig,{entityType:ca.EntityType.Topic,enabled:va}),Object.assign(new ca.EntityConfig,{entityType:ca.EntityType.Address,enabled:ha}),Object.assign(new ca.EntityConfig,{entityType:ca.EntityType.Satori,enabled:ja})]}),nudge:Object.assign(new ca.NudgeConfig,{enabled:!1}),prediction:Object.assign(new ca.PredictionConfig,{enabled:!1})})})})})]});this.dA.$k().then(()=>{this.yV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:Ja}));X.ULS.sendTraceTag(520104021,
3034,50,"Submitted ClientConfigSignal Operation.")})}J2h(wa){const ja=Object.assign(new U.a,{parentPath:["Signal",ca.StartupSignal.getTypeName()],items:[Object.assign(new W.a,{id:"SessionStartupSignal",body:Object.assign(new ca.StartupSignal,{timestamp:Date.now()})})]});this.dA.$k().then(()=>{wa&&this.QB();this.yV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:ja}));X.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}QB(){sa.Ccd()&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",
!1)?(this.Te.mb(this,ca.EccResultAnnotation.getTypeName()),X.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Te.mb(this,ca.UserInitiatedResultAnnotation.getTypeName()),X.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));sa.Acd()&&(this.Te.mb(this,ca.FlagResultAnnotation.getTypeName()),X.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}tSo(wa,ja,ha,va,xa){const ma=void 0===ja?!1:this.gSe>ja;this.Uj.kF&&
!ma&&(wa=this.p2h(wa),va&&wa.suggestionGroups&&0<wa.suggestionGroups.length&&(wa.suggestionGroups[0].previewData=va.substring(xa+1,va.length)),this.Uj.definition=wa,ja&&(this.gSe=ja));ja?(va=Date.now(),ha=[Object.assign(new pa.a,{name:this.Bud,string:ha}),Object.assign(new pa.a,{name:"ContextIQMenuOpen",bool:this.Uj.kF}),Object.assign(new pa.a,{name:"ContextIQStaleAnnotation",bool:ma})],this.OAa.SXc("ContextIQUserInitUserPerceivedLatency",va-ja,1,!0,void 0,ha)):X.ULS.sendTraceTag(537966025,3034,15,
"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}p2h(wa){if(wa){var ja=[],ha=[];switch(wa.annotationType){case ca.UserInitiatedResultAnnotation.getTypeName():var va=wa.content;if(!va)return;for(var xa of va.results)ja=ja.concat(xa.results);va=aa.a.MZa;break;case ca.EccResultAnnotation.getTypeName():xa=wa.content;if(!xa)return;for(const ma of xa.entityResults)ja=ja.concat(ma.entities);sa.pqg()&&(ha=null===(va=xa.treatments)||
void 0===va?void 0:va.bestMatchEntries);va=aa.a.MZa;break;case ca.FlagAnnotation.getTypeName():ja=ja.concat(wa.content.results);va=aa.a.xAb;break;default:return}wa={annotationId:wa.id,results:ja,bestMatchResults:ha};if(ja=this.l0g)this.l0g=!1;return{...z.g,id:va,suggestionGroups:[{type:va,isContentPending:!1,contentData:wa,isFirstInvoke:ja}]}}}async getPersonImageUrl(wa,ja){wa=new L.a(wa,"O365",ja,wa);if(this.Vka&&this.Vka.getPersonaIconPropertiesArray&&(wa=await this.Vka.getPersonaIconPropertiesArray([wa]),
0<wa.length&&wa[0].authorImageURL))return wa[0].authorImageURL}static Jpe(){return sa.Ccd()||sa.Acd()}static Ccd(){return sa.Dpe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static Bcd(){return sa.Dpe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",!1)}static Acd(){return sa.Dpe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",
!1)}static qqg(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static NMj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CIQFlagsIgnoreOnce",!1)}static pqg(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",!1)}static Dpe(){return!I.a.hca&&!I.a.c4}static get R6a(){return sa.wjk}cxo(wa){if(this.Vka){var ja={...z.g,id:aa.a.MZa,
suggestionGroups:[{type:aa.a.MZa,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},ha=!1;this.ga.w_(V.a.kTa)&&(ha=!0);this.Uj.uqa(wa,ja,this,!0,!1,null,this.Oma,null,!1,va=>{va.shouldIgnoreFocusEvent=xa=>{var ma;return this.ERe?!0:xa===(null===(ma=this.fd.editingView)||void 0===ma?void 0:ma.editingElement)};va.getPersonImageUrl=this.getPersonImageUrl},ha,!1,this.K2g)}else X.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}DEh(){this.Uj.dismiss()}onKeyDown(wa){if(wa&&
wa.Gb){switch(wa.Gb.keyCode){case N.a.Fda:var ja=Ka.VLj;break;case N.a.zL:ja=Ka.End;break;case N.a.Bs:ja=Ka.NNj;break;case N.a.N5:ja=Ka.lOj;break;case N.a.Aw:ja=Ka.Tab;break;case N.a.O5:ja=Ka.WLj}void 0!==ja&&(wa.Gb.stopPropagation(),wa.Gb.preventDefault(),this.K2g.onKeyPressed(ja))}}PC(wa,ja){if(wa&&wa.content&&ja===w.a.getTypeName()&&(wa.annotationType===ca.UserInitiatedResultAnnotation.getTypeName()||wa.annotationType===ca.EccResultAnnotation.getTypeName())){var ha=ja=void 0,va=void 0,xa=0,ma=
wa.parentPath.split("\\");if(ma&&6===ma.length)if(ha=ma[5],ma=Date.now(),ha in sa.R6a){clearTimeout(sa.R6a[ha].QIo);ja=sa.R6a[ha].startTime;va=sa.R6a[ha].txo;xa=sa.R6a[ha].XAd;delete sa.R6a[ha];const Ja=[Object.assign(new pa.a,{name:this.Bud,string:ha})];this.OAa.SXc("ContextIQUserInitALLatency",ma-ja,1,!0,void 0,Ja)}else X.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else X.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");
this.tSo(wa,ja,ha,va,xa)}}get types(){return[aa.a.MZa,aa.a.xAb]}Nlg(wa,ja){this.Uj.kF&&this.Uj.Nlg(wa,ja)}get eEc(){return!P.SessionStatusManager.instance.Aj&&1!=H.AFrameworkApplication.ta.mode}BHa(wa){return wa&&La.a.WTc(wa)?!qa.a.L0b(wa):!1}kN(wa){if(sa.Jpe()){var ja,ha;if(P.SessionStatusManager.instance.Aj||!this.eEc||!({annotation:ja,v0e:ha}=this.AK.vLd(wa.ll,wa.vif,this.BHa)).returnValue)return!1;if(ja.annotationType===ca.FlagAnnotation.getTypeName()){let va=!1;this.ga.w_(V.a.kTa)&&(va=!0);const xa=
this.p2h(ja);wa=this.Uj.uqa(ha,xa,this,wa.BQa,wa.TNa,null,ma=>{(null===ma||void 0===ma?void 0:ma.cardType)!==aa.a.xAb||(null===ma||void 0===ma?0:ma.Lgg)||this.OAa.Mv(V.a.yFd,!0,void 0,void 0,void 0,void 0,{shf:Na.Tried,entityType:sa.gPd(ja.content)})},null,!1,null,va);this.Uj.Lic({Lgg:!1,cardType:aa.a.xAb});wa&&this.OAa.Mv(V.a.yFd,!0,void 0,void 0,void 0,void 0,{shf:Na.Seen,entityType:sa.gPd(ja.content)});return wa}return!1}}iOo(wa,ja){this.Te.dza(wa,70);const ha=this.eC.n6h(wa,0);if(ha){const va=
new a.a;va.contentDescriptor=ha;va.annotationType=wa.annotationType;va.state=70;this.IF.setState(ja,va)}}executeAction(wa,ja,ha,va){var xa,ma,Ja,oa=Date.now();if(!ja)return!1;switch(wa.actionType){case z.b.Apply:this.Uj.Lic({cardType:null===(xa=this.Uj.definition)||void 0===xa?void 0:xa.id,Lgg:!0});this.gUd(wa.descriptorData,ja,ha,va);ja={shf:Na.Kept,entityType:sa.gPd(null===(ma=this.Te.vga(wa.descriptorData.annotationId))||void 0===ma?void 0:ma.content)};this.OAa.Mv(V.a.yFd,!0,void 0,void 0,void 0,
void 0,ja);this.DEh();break;case z.b.ClearSearch:this.ERe=!0;this.clearSearch(ja,ha,va,!1);this.Uj.kF&&(this.Jrj(),ma=k.ParagraphReader.text(ja).substring(0,ha+1),this.ymf(ja,ma,ha,oa));this.ERe=!1;break;case z.b.Retry:this.Uj.kF&&(this.Jrj(),ma=k.ParagraphReader.text(ja).substring(0,va),this.ymf(ja,ma,ha,oa));break;case z.b.OpenEditorPane:if(32!==this.ga.processAction(V.a.kTa,2))return X.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",wa.actionType),!1;
break;case z.b.IgnoreOnce:if(!sa.NMj)return!1;ha=this.Te.vga(null===(Ja=wa.descriptorData)||void 0===Ja?void 0:Ja.annotationId);this.iOo(ha,ja.Jc);oa=this.Gc.Oc(3);try{oa.Cb(ja),ja.Tk(16,!0)}finally{oa&&oa.dispose()}this.OAa.Mv(V.a.yFd,!0,void 0,void 0,void 0,void 0,{shf:Na.Rejected,entityType:sa.gPd(ha.content)});this.Uj.dismiss();break;default:return X.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",wa.actionType),!1}return!0}ymf(wa,ja,ha,va){var xa,
ma;const Ja=ha.toString(),oa=wa.id.toString(),za=oa+"-"+Ja;var Fa=++this.ujk;const kb=za+"-"+Fa;Fa=(Fa=x.FormattingReader.ePd(wa,ha,k.ParagraphReader.textLength(wa)))?x.FormattingReader.language(Fa):H.AFrameworkApplication.lcid;Fa=null!==(ma=null===(xa=M.a.og(Fa))||void 0===xa?void 0:xa.Olf)&&void 0!==ma?ma:"";ja.length>this.FJe&&(ha-=ja.length-this.FJe,ja=ja.slice(-this.FJe));const fb=Object.assign(new U.a,{parentPath:["Signal",la.a.getTypeName(),oa,Ja,za],items:[Object.assign(new W.a,{id:kb,body:Object.assign(new la.a,
{languageId:Fa,startOfSentence:!0,text:ja,timestamp:Date.now(),userInitQuery:!0})})]});this.dA.$k().then(()=>{this.yV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:fb}));X.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const lb=[Object.assign(new pa.a,{name:this.Bud,string:kb})];this.OAa.SXc("ContextIQUserInitSignalGenerationLatency",Date.now()-va,1,!0,void 0,lb)});"@"===ja.slice(-1)&&ha===ja.length-1&&(xa=this.Fm.LPd(wa,8,ha,ha))&&0===xa.count&&
(xa=new l.a(8,ha,ha+1,G.a.create()),this.Fm.$Qa(wa,xa));wa=setTimeout(()=>{this.Suo(kb)},this.xjk);sa.R6a[kb]={startTime:va,txo:ja,XAd:ha,QIo:wa}}eVo(){if(this.Uj.kF&&this.Uj.definition&&this.Uj.definition.suggestionGroups&&this.Uj.definition.suggestionGroups[0]){const wa=this.Uj.definition;wa.suggestionGroups[0].isContentPending=!0;this.Uj.definition=wa}}Jrj(){this.Uj.definition={...z.g,id:aa.a.MZa,suggestionGroups:[{type:aa.a.MZa,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}Suo(wa){if(wa in
sa.R6a){var ja=sa.R6a[wa].startTime;ja=void 0===ja?!1:this.gSe>ja;!ja&&this.Uj.kF&&(this.Uj.definition={...z.g,id:aa.a.MZa,suggestionGroups:[{type:aa.a.MZa,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});wa=[Object.assign(new pa.a,{name:this.Bud,string:wa}),Object.assign(new pa.a,{name:"ContextIQMenuOpen",bool:this.Uj.kF}),Object.assign(new pa.a,{name:"ContextIQStaleSignal",bool:ja})];this.OAa.SXc("ContextIQUserInitALTimeout",1,0,!0,
void 0,wa)}}gUd(wa,ja,ha,va){var xa=wa.type;switch(xa){case ca.EntityType.File:this.insertHyperlink(ja,ha,va,wa.fileName,wa.url+"?web=1");break;case ca.EntityType.People:sa.UBf?this.insertHyperlink(ja,ha,va,wa.displayName,"mailto:"+wa.primaryEmailAddress):this.ONo(wa,ja,ha,va);break;case ca.EntityType.Loop:this.dBm(wa,ja,ha,va);break;case ca.EntityType.Address:this.eAm(wa,ja,ha,va);break;case ca.EntityType.Satori:xa="https://www.bing.com/search?q="+wa.title.replace(" ","+");this.insertHyperlink(ja,
ha,va,wa.title,xa);break;case ca.EntityType.Topic:this.insertHyperlink(ja,ha,va,wa.title,wa.url);break;default:X.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",xa)}}ONo(wa,ja,ha,va){const xa=wa.primaryEmailAddress,ma=new L.a(xa,"O365",wa.displayName,xa);this.Vka.checkUserAccess(ma).then(Ja=>{Ja.UserCanWrite?(X.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.ESc(ja,ha,va,ma)):this.XBj(ma,ja,ha,va)},
()=>{X.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.XBj(ma,ja,ha,va)})}XBj(wa,ja,ha,va){this.Vka.grantUsersAccess([wa]).then(xa=>{let ma=!1;xa.Details&&(ma=xa.Details.Result[0].UserCanWrite);ma?(X.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.ESc(ja,ha,va,wa)):(X.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(ja,ha,va,!0))},()=>{X.ULS.sendTraceTag(539100305,
3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}ESc(wa,ja,ha,va){this.Fm.jlg(wa,ja,ha);this.OAa.Mv(V.a.O9e,!0,void 0,void 0,void 0,void 0);this.uI.ESc(wa,ja,ha,va.DisplayName,va.Email)}insertHyperlink(wa,ja,ha,va,xa){if(wa){var ma=new y.GraphTransaction(15),Ja=va+" ";try{ma.Cb(wa);this.Fm.jlg(wa,ja,ha);this.OAa.Mv(V.a.O9e,!0,void 0,void 0,void 0,void 0);this.Kd.replaceTextRange(n.a.createTextRange(wa,ja,ha),Ja);const oa=J.a.C9b(xa);this.tD.hG(n.a.createTextRange(wa,ja,
ja+va.length),oa,!1,!1,!1);this.ib.setSelection(u.SelectionFactory.ue(wa,ja+Ja.length))}finally{ma&&ma.dispose()}}else X.ULS.sendTraceTag(509612897,3034,15,"Paragraph node is undefined/null.")}dBm(wa,ja,ha,va){if(ja){var xa=new y.GraphTransaction(15);try{xa.Cb(ja);this.Kd.replaceTextRange(n.a.createTextRange(ja,ha,va),"");this.ib.setSelection(u.SelectionFactory.ue(ja,ha));const ma=wa.id;ma===aa.a.T7m?this.ga.processAction(V.a.KSc,2):ma===aa.a.R7m?this.ga.processAction(V.a.xSc,2):X.ULS.sendTraceTag(537458136,
3034,15,"Trying to insert unsupported loop type.")}finally{xa&&xa.dispose()}}else X.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}eAm(wa,ja,ha,va){if(ja){var xa=new y.GraphTransaction(15);try{xa.Cb(ja);const ma=J.a.C9b(wa.url);this.tD.hG(n.a.createTextRange(ja,ha,va),ma,!1,!1,!1);this.ib.setSelection(u.SelectionFactory.ue(ja,va));const Ja=this.Te.vga(wa.annotationId);this.Te.dza(Ja,60)}finally{xa&&xa.dispose()}}else X.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(wa,
ja,ha,va){if(wa){var xa=new y.GraphTransaction(15);va||(ja+=1);try{xa.Cb(wa),this.Kd.replaceTextRange(n.a.createTextRange(wa,ja,ha),""),this.ib.setSelection(u.SelectionFactory.ue(wa,ja))}finally{xa&&xa.dispose()}}else X.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}S0m(){this.DI.execute(wa=>{wa.logActivity("CIQ_AtInvoke",null)})}}sa.UBf=!1;sa.wjk={};Object(E.a)(sa,"ContextIQIntentProvider",F.a,[52,379])},1655:function(E,K,c){E=c(0);var l=c(332),f=c(271);class a{constructor(x,
y,n,u,z,w,F){this.ol=x;this.focusManager=y;this.$E=n;this.clickInputManager=u;this.Whc=z;this.x_i=w;this.jPh=F;this.KQ=this.hBb();this.$E.Eaa(this.KQ.name);this.clickInputManager.$_b(this.KQ.name,this.ol,this.KQ.jUa);x=this.daf();this.focusManager.Wzb(this.ol,this.KQ,x)}focus(){this.focusManager.mg(this.KQ.name)}get isFocused(){return this.focusManager.currentScope===this.KQ}addIsFocusChangedHandler(x){this.KQ.k7(()=>x(!0));this.KQ.TYa(()=>x(!1))}aoh(x){this.KQ.RYa(x)}dispose(){var x;this.focusManager.E5a(this.KQ.name);
this.focusManager.currentScope||this.focusManager.mg(null!==(x=this.jPh)&&void 0!==x?x:f.a.Pn)}hBb(){var x;const y=this.focusManager.fe(this.Whc);y.parent=null!==(x=this.x_i)&&void 0!==x?x:f.a.vp;y.jUa=!0;y.h5c=!0;y.TH=!0;return y}daf(){const x=new l.DOMFocusListing(()=>this.ol);x.Xm(8);return x}}Object(E.a)(a,"EditorAiFocusScopeImpl",null,[]);c.d(K,"a",function(){return k});class k{constructor(x,y,n,u){this.options=x;this.focusManager=y;this.$E=n;this.clickInputManager=u}registerScope(x){return new a(x,
this.focusManager,this.$E,this.clickInputManager,this.options.Whc,this.options.x_i,this.options.jPh)}}Object(E.a)(k,"EditorAiFocusManagerImpl",null,[])},1664:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.handler=null}}Object(E.a)(l,"SetAnnotationResultCallbackParameters",null,[])},1666:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{static get ofc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}l.pDb="fontInfoTaskPane";l.experienceId=
"modernfontpicker";Object(E.a)(l,"FontInfoPaneConstants",null,[])},1667:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.endDate=this.startDate=null}}Object(E.a)(l,"CommentTaskSchedule",null,[])},1668:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(80);class f{static get hd(){return null!=f.Xxg?f.Xxg:f.Xxg=new l.a}static Owk(a){f.hd.addHandler(f.dTi,a)}static txk(a){f.hd.addHandler(f.DVi,a)}}f.dTi="OnCopyComment";f.DVi="OnPasteComment";Object(E.a)(f,
"CommentEventsManager",null,[])},1669:function(E,K,c){c.d(K,"a",function(){return l});const l={ljf:"TasksFeatureUsage",tGo:"TaskExperienceDegraded",Qke:"TaskCreate",Rke:"TaskEngagement"}},1672:function(E,K,c){c.d(K,"c",function(){return x});c.d(K,"b",function(){return y});c.d(K,"a",function(){return n});var l=c(74),f=c(7),a=c(2),k=c(35);const x=u=>{if(!u)return null;let z;try{z=k.b(u)}catch(w){z=null,f.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",
w)}return z},y=(u,z)=>{let w=[];if(u.breadcrumbs&&0<u.breadcrumbs.length)w=u.breadcrumbs;else{const F=u.service_info;F&&F.friendly_service_name&&Array.add(w,F.friendly_service_name);u.display_path&&Array.addRange(w,u.display_path)}return w.join(z?" \u00ab ":" \u200f\u00bb ")},n=(u,z=!1)=>{if(!u)return[];if(!u.documents)return f.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!u.documents.items)return f.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];u=u.documents.items;
const w=new l.a;for(let G=0;G<u.length;G++){const H=u[G];var F=H.web_url;if(!F){f.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!H.url){f.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}F=String.format("{0}?web=1",H.url)}const L={};L.DocumentUrl=F;L.MruId=H.mru_id;{F=H;let I=F.title;I?(F.extension&&(I=String.format("{0}.{1}",I,F.extension)),F=I):(f.ULS.sendTraceTag(578352837,202,15,"empty file title"),F="")}L.FileName=F;L.IsPinned=H.is_pinned;L.Path=y(H,a.AFrameworkApplication.isRtl);
z&&(L.App=H.app,L.TimeStamp=H.time_stamp);w.add(L)}return w.toArray()}},1673:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.Callback="action";Object(E.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1674:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===
x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1826),K);f(c(1827),K);f(c(1828),K);f(c(1829),K);f(c(1830),K);f(c(1831),K);E.exports.TextToImageAnnotation||Object.defineProperty(E.exports,"TextToImageAnnotation",{enumerable:!0,get:function(){return E.exports.TextToImageAnnotation}});E.exports.TextToImageSignal||Object.defineProperty(E.exports,"TextToImageSignal",{enumerable:!0,get:function(){return E.exports.TextToImageSignal}})},1675:function(E,
K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1832),K);f(c(1833),K);E.exports.ThemeExtractorAnnotation||
Object.defineProperty(E.exports,"ThemeExtractorAnnotation",{enumerable:!0,get:function(){return E.exports.ThemeExtractorAnnotation}});E.exports.ThemeExtractorSignal||Object.defineProperty(E.exports,"ThemeExtractorSignal",{enumerable:!0,get:function(){return E.exports.ThemeExtractorSignal}})},1676:function(E,K,c){var l=this&&this.dC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};
Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1834),K);f(c(1835),K);E.exports.TableType||Object.defineProperty(E.exports,"TableType",{enumerable:!0,get:function(){return E.exports.TableType}});E.exports.TableTypeAnnotation||Object.defineProperty(E.exports,"TableTypeAnnotation",{enumerable:!0,
get:function(){return E.exports.TableTypeAnnotation}})},1678:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(E.a)(l,"CalloutButtonProps",null,[])},1679:function(E,K,c){function l(){a||(f.Health.instance.addQosPillar("AsyncCollab"),a=!0)}c.d(K,"a",function(){return l});var f=c(83);let a=!1},1680:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a=0,k=!1){this.qIj=!1;this.paragraphNode=
f;this.DQf=a;this.qIj=k}}Object(E.a)(l,"ReviewActionArgs",null,[])},1684:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f=0,a=0,k=0,x=0,y="",n="",u="",z="",w="0pt",F="0pt",G="0pt",H="0pt"){this.borderTopStyle=f;this.borderRightStyle=a;this.borderBottomStyle=k;this.borderLeftStyle=x;this.borderTopColor=y;this.borderRightColor=n;this.borderBottomColor=u;this.borderLeftColor=z;this.borderTopWidth=w;this.borderRightWidth=F;this.borderBottomWidth=G;this.borderLeftWidth=H}}Object(E.a)(l,
"TableCellBorderProperties",null,[])},1685:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f="",a="",k="",x=""){this.CTk=f;this.BTk=a;this.zTk=k;this.ATk=x}}Object(E.a)(l,"TableCellMarginProperties",null,[])},1689:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(43);c(6);var f=c(7);class a{constructor(k,x){this.r6m=()=>{f.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.axa=(y,n)=>{f.ULS.sendTraceTag(39358977,
324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",n)};this.ttb=x}zij(k,x,y,n=null,u=null,z=null){if(k){var w=new l.GraphTransaction(0);w.Cb(k);k.setValue(x,y);w.dispose();try{this.ttb(15,!1,n||this.r6m,u||this.axa,z,null,null)}catch(F){f.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",F.message)}}else f.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}
Object(E.a)(a,"AutoSaveParamsUpdateService",null,[392])},1690:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(7);class f{constructor(a){this.Ayj=a}he(a,k){if(a){var x=this.Ayj();a();a=this.Ayj();l.ULS.sendTraceTag(555307094,345,50,`${k}-${a-x}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}Object(E.a)(f,"PerfLogger",null,[622])},1691:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.paragraphNode=f;this.state=a}}Object(E.a)(l,"ReviewCompletedArgs",
null,[])},1692:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.index=f;this.count=a}}Object(E.a)(l,"DesignerReviewPosition",null,[])},1693:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(l||(l={}));Object(E.b)("BlueDotHighlightContextType",l);class f{constructor(a,k,x=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=l.empty){this.Vr=a;this.YEc=k;this.XJo=x;this.hKk=y}}
Object(E.a)(f,"BlueDotHighlightContext",null,[])},1694:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.nv=this.Bo=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.Fwa=!1;this.UKb=this.oJb=5;this.pma=this.NE=this.LGc=0;this.Q_k=!1}}Object(E.a)(l,"SectionPropertiesData",null,[])},1695:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(190);class l extends c.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=
this.IconName=this.Label=null}get ControlType(){return 12}}Object(E.a)(l,"ErrorViewProps",c.a,[])},1696:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(190);class l extends c.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionId=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(E.a)(l,"MultiActionButtonProps",c.a,[])},1697:function(E,K,c){c.d(K,
"a",function(){return l});E=c(0);class l{}Object(E.a)(l,"PersonaInfo",null,[])},1698:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}Object(E.a)(l,"PersonaIdentifiers",null,[])},1699:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);K=c(1131);c=c(1063);class l{}l.F0=[new K.a(1440,1440,1440,1440),new K.a(720,720,720,720),new K.a(1440,1440,1080,1080),new K.a(1440,1440,2880,2880),new K.a(1440,1440,1800,1800)];l.Ipa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),
new c.a(11907,16839),new c.a(8391,11907)];Object(E.a)(l,"PredefinedPageProperties",null,[])},1701:function(E,K,c){c.d(K,"a",function(){return G});E=c(0);var l=c(201),f=c(2),a=c(22),k=c(20),x=c(18),y=c(1322),n=c(251),u=c(438),z=c(7),w=c(454),F=c(680);class G{constructor(H,L,I,N,P,M,J,V,X,W,U,Y,ca,aa){this.kr=H;this.aub=L;this.Ma=I;this.sq=N;this.Gs=P;this.lE=M;this.uaa=J;this.T9a=V;this.P9a=X;this.R9a=W;this.S9a=U;this.M$a=Y;this.N$a=ca;this.Mmd=aa}build(H,L,I,N){const P=new l.QueryStringBuilder("WordOart.ashx");
f.AFrameworkApplication.dfa(P);P.Ce(w.a.nodeId,L.id.toString());L=x.ImageReader.F7l(L,H.Jc);P.Ce(F.a.zHd,L?L.ia(u.a.HRf,""):"");P.Ce(F.a.width,this.sq.toString());P.Ce(F.a.height,this.Gs.toString());P.Ce(F.a.o1c,this.uaa.toString());P.Ce(F.a.g2n,y.a[this.aub]);L=this.Ma.$("WordEditorImageCropIsEnabled");P.Ce(F.a.oNh,L.toString());L&&(P.Ce(F.a.top,this.T9a.toString()),P.Ce(F.a.bottom,this.P9a.toString()),P.Ce(F.a.left,this.R9a.toString()),P.Ce(F.a.right,this.S9a.toString()));L=this.Ma.$("WordEditorImageRotateIsEnabled");
P.Ce(F.a.Wej,L.toString());L&&(P.Ce(F.a.angle,this.lE.toString()),P.Ce(F.a.flipH,this.M$a?"true":"false"),P.Ce(F.a.flipV,this.N$a?"true":"false"));P.Ce(F.a.fZf,I?"true":"false");P.Ce(F.a.strict,this.Mmd?"true":"false");this.Ma.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.kr&&this.kr.Nxf&&P.Ce(F.a.U1a,this.kr.Nxf);(H=H.Bi())?(P.Ce(w.a.fileId,H.sr),P.Ce(w.a.cellId,H.nm.toString())):z.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",
P.toString());H=a.a.instance.Na("Box4.IFeatureHelper");H=!!H&&H.isFeatureEnabled(49);P.Ce(F.a.irl,"true");P.Ce(F.a.Mzm,H.toString());P.Ce(F.a.LUh,"true");H&&P.Ce(F.a.U0i,H.toString());P.Ce(F.a.Pzm,"true");n.a.instance.czb(P);I&&N&&!k.a.At&&P.JI(F.a.yeb,window.self.devicePixelRatio.toString());P.Ce(F.a.Ivh,"true");return P.toString()}}Object(E.a)(G,"WordOartEndpointUrlBuilder",null,[])},1702:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(15);class f{constructor(a,k){this._id=a;this.Fb=
k;this.GPk=k.ia(l.a.zha,0);this.EPk=k.ia(l.a.yha,0)}getId(){return this._id}}Object(E.a)(f,"GraphicsEditorImageContainer",null,[746])},1703:function(E,K,c){c.d(K,"a",function(){return J});E=c(0);var l=c(58),f=c(2),a=c(123),k=c(201),x=c(18),y=c(515),n=c(1185),u=c(6),z=c(145),w=c(42),F=c(15),G=c(41),H=c(438),L=c(116),I=c(991),N=c(7),P=c(680),M=c(1701);class J{constructor(V,X,W,U,Y,ca){this.properties=null;this.kr=X;this.Oj=U;this.Ma=Y;this.Yz=ca}vUo(V,X,W){V.gU||(X.setValue(u.a.cAd,V.kBk),X.setValue(u.a.aLd,
V.S5b));this.jLj(V,X,W)}wUo(V,X,W){X.setValue(u.a.kLb,V.PYo);x.ImageReader.DQd(X,W.Jc,!1)!==V.KWf&&X.Eg(u.a.U9d,z.a.au,z.a.tpa,w.a.j8a);if(V.J8d)X.setValue(F.a.Mca,l.a.Ff(V.J8d));else{var U=this.OKh(V.KWf,V.LWf,V.extension);W.Jc.Lu(U);X.setValue(F.a.Mca,U.id)}V.Moe?X.setValue(w.a.j8a,l.a.Ff(V.Moe)):V.UJj&&(U=this.OKh(V.UJj,V.Nog,V.extension),W.Jc.Lu(U),X.setValue(w.a.j8a,U.id));X.ia(u.a.V9d,"")!==V.O3c&&(""!==V.O3c?X.setValue(u.a.V9d,V.O3c):X.removeProperty(u.a.V9d));0===V.Gua&&0===V.Iua&&0===V.Hua&&
0===V.Fua||this.Oj.yag(X,V.Iua,V.Fua,V.Gua,V.Hua);void 0!==V.lockAspectRatio?X.setValue(u.a.VX,V.lockAspectRatio):X.setValue(u.a.VX,!1);V.OKk&&(this.gOb(X,u.a.mia,V.Zwh),this.gOb(X,u.a.Dpa,V.borderStyle),this.gOb(X,u.a.DGa,V.borderColor));void 0!==V.altTextDescription&&X.setValue(u.a.UX,V.altTextDescription);this.gOb(X,G.a.alphaModFix,V.alphaModFix);this.jLj(V,X,W);V=y.a.instance.nif(X);X.setValue(u.a.Nca,V)}OKh(V,X,W){const U=new I.a(524345);U.setValue(H.a.HRf,V);U.setValue(H.a.efc,V);U.setValue(w.a.lAl,
l.a.Ff(V).guid);U.setValue(u.a.Goi,X);U.setValue(H.a.yjf,f.AFrameworkApplication.rootQuerySignature);U.setValue(w.a.RYh,W);return U}jLj(V,X,W){V.gU?(this.properties=X,X.setValue(G.a.gU,V.gU),V.ZDc&&X.setValue(G.a.bAd,V.ZDc),X.setValue(G.a.Vva,V.x2o),X.setValue(G.a.Wva,V.urm),X.setValue(G.a.mPa,V.k5b),X.setValue(u.a.gt,V.gt),X.setValue(u.a.qCb,V.$4b),X.setValue(w.a.O_,0),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&X.setValue(L.a.xOa,
!1),X.setValue(L.a.Y4,0),this.gOb(X,G.a.I2a,V.Uwa),this.pnh(X,W,!1,!0),this.HWk(X)):(X.setValue(u.a.PEa,V.PEa),X.setValue(z.a.au,V.PEa?V.tCn:""),V.yeb&&X.setValue(z.a.iGb,V.yeb),X.setValue(u.a.gt,V.gt),X.setValue(u.a.qCb,V.$4b),X.setValue(u.a.Nca,V.EH),X.setValue(F.a.zha,a.a.oG(V.width)),X.setValue(F.a.yha,a.a.oG(V.height)),X.setValue(w.a.WYf,a.a.oG(V.width)),X.setValue(w.a.UYf,a.a.oG(V.height)),X.setValue(z.a.NEa,-1),X.setValue(z.a.MEa,-1),X.setValue(F.a.Hwa,!0),X.setValue(u.a.qJ,V.rotationAngle),
this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&X.setValue(L.a.xOa,!1),X.setValue(w.a.O_,0),V.PEa&&this.pnh(X,W,!0,!1),this.IWk(X));5!=x.ImageReader.mk(X)?this.KWk(X):this.GWk(X);this.gOb(X,u.a.CQc,V.flipH);this.gOb(X,u.a.OQc,V.flipV)}N2n(V,X,W,U,Y=null){V=this.Oj.I2n(V.$j,X,W,U);null==V?N.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):Y&&Y(V)}pnh(V,X,W,U){let Y=!1;var ca=this.Yz.Xs(X);ca&&ca.Hf(u.a.dGf)&&(Y=
!0);ca=x.ImageReader.Bba(V);X=(new M.a(this.kr,x.ImageReader.mk(V),this.Ma,x.ImageReader.dF(V),x.ImageReader.wG(V),x.ImageReader.A_(V),x.ImageReader.Nhb(V),Math.max(ca.top,0),Math.max(ca.bottom,0),Math.max(ca.left,0),Math.max(ca.right,0),x.ImageReader.APd(V),x.ImageReader.kEb(V),Y)).build(X,V,!0,!1);U&&(U=new k.QueryStringBuilder(X),U.Ce(P.a.JVd,"true"),X=U.toString());V.setValue(u.a.Ofb,X);W&&n.a.hOb(V,1,f.AFrameworkApplication.K,this.kr)}gOb(V,X,W){void 0===W||null===W?V.removeProperty(X):V.setValue(X,
W)}IWk(V){V.removeProperty(G.a.gU);V.removeProperty(G.a.bAd);V.removeProperty(G.a.Vva);V.removeProperty(G.a.Wva);V.removeProperty(G.a.mPa);V.removeProperty(G.a.G5d);V.removeProperty(G.a.Lpl);V.removeProperty(G.a.I2a)}KWk(V){V.removeProperty(u.a.U9d);V.removeProperty(u.a.kLb);V.removeProperty(F.a.Mca);V.removeProperty(u.a.V9d)}GWk(V){V.removeProperty(u.a.aLd);V.removeProperty(u.a.cAd);V.removeProperty(G.a.gU);V.removeProperty(G.a.bAd)}HWk(V){V.removeProperty(u.a.cAd);V.removeProperty(z.a.au);V.removeProperty(F.a.zha);
V.removeProperty(F.a.yha);V.removeProperty(u.a.Nca);V.removeProperty(z.a.tpa);V.removeProperty(u.a.aLd);V.removeProperty(u.a.qJ)}}Object(E.a)(J,"GraphicsEditorImageEditor",null,[737])},1704:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}Object(E.a)(l,"SmartLookupApplicationInterface",null,[])},1705:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x,y,n){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=
f;this.url=a;this.spWebUrl=k;this.uniqueId=x;this.size=y;this.lastModified=n}}Object(E.a)(l,"FileInfo",null,[])},1712:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);K=c(231);var l=c(107);class f extends K.a{constructor(){super();this.CellId=this.FileId=null}al(){return 37}static construct(a){const k=new f;k.FileId=a.Bi().sr;k.CellId=l.a(a.Jc.id);return k}}Object(E.a)(f,"LastSavedRevisionRequest",K.a,[])},1732:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(7);c=c(255);class f extends c.a{constructor(a,
k,x,y){super(f.g3e);this.In=a;this.zk=k;this.view=x;this.options=y}initialize(){super.initialize();const a=this.options.zNb==this.zk.Xla(this.view.Yc,{VO:this.options.VO,Tba:this.options.W9b,doa:this.options.V9b,UO:this.options.UO});a&&!this.Hoa&&l.ULS.sendTraceTag(557114691,3028,50,this.wT(this.In,!0,`satisfiedIfBlank=${this.options.zNb}`));this.Sg(a)}Md(){super.Md()}}f.g3e="BlankDocumentConditionId";Object(E.a)(f,"BlankDocumentCondition",c.a,[])},1736:function(E,K,c){c.d(K,"a",function(){return l});
E=c(0);class l{constructor(f){this.alt=this.ariaLabel=this.src=null;this.src=f}}Object(E.a)(l,"ImageProps",null,[])},1738:function(E,K,c){c.d(K,"a",function(){return w});E=c(0);var l=c(58),f=c(8),a=c(12),k=c(7),x=c(16),y=c(1534),n=c(1518),u=c(1529),z=c(1522);class w{constructor(F,G,H,L,I,N,P){this.pTi=(M,J)=>{J&&J.data&&J.data.ll&&(M=new z.a(J.data.ll,1,!0),this.Dxe.kN(M))};this.uWi=(M,J)=>{J&&J.data&&J.data.ll&&J.data.ll.node&&this.h0j.xPi(this.Dxe,J.data.ll.node)};this.Ahc=(M,J,V)=>{M=J.view.qe?
J.view:null;if(!M||!M.lb)return 8;M=M.lb.gb.J(0).Oa;return f.ParagraphReader.Vb(M.node)?1===V?32:2===V?(V=new z.a(M,2,!1),this.Dxe.kN(V),32):2:2};this.M3b=(M,J,V)=>{var X,W;M=J.view.qe?J.view:null;if(!M||!M.lb)return 8;M=null===(X=M.lb.gb.J(0))||void 0===X?void 0:X.Oa;return M&&M.node?f.ParagraphReader.Vb(M.node)?1===V?32:2===V?(V=M.node,X=f.ParagraphReader.text(M.node),J=M.cpBegin,M=M.cpEnd-J,0<M&&(X=X.substr(J,M)),M=Math.floor(Math.random()*w.Ffj),J=l.a.create(),k.ULS.sendTraceTag(541446531,3016,
50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:J,["textLength"]:X.length,["paragraphLength"]:f.ParagraphReader.textLength(V),["paragraphRole"]:null===(W=this.gQ.uA(V))||void 0===W?void 0:W.role,["styleId"]:M},this.Q$j.GPd()),W=[new y.c(new n.d(J,3,null,null,!1,M,X),V,M,X,U=>{this.STb.f3c(u.a.create(U));this.STb.Fgc({role:27,paragraphNode:U,placeholder:!1})},3)],this.Afk.DAd(W),32):2:2:8};this.ga=F;this.Dxe=G;this.h0j=H;this.STb=L;this.Afk=
I;this.gQ=N;this.Q$j=P}initialize(){this.ga.fb(x.a.Ahc,a.a.view,this.Ahc,1028);this.STb.Nxk(this.uWi);this.STb.Kwk(this.pTi);this.ga.fb(x.a.M3b,a.a.view,this.M3b,4)}dispose(){this.ga.Qv(x.a.M3b,a.a.view,this.M3b);this.STb.g0n(this.pTi);this.STb.C0n(this.uWi);this.ga.Qv(x.a.Ahc,a.a.view,this.Ahc)}}w.Ffj=5;Object(E.a)(w,"DesignerActionListener",null,[1054,10])},1740:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(E.a)(l,"CritiqueAction",
null,[])},1749:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.lQj="PageContentOrigin";this.JNj=500;this.mvg=["resize"];this.pIo=f=>()=>{!this.Mjd&&f&&(this.Mjd=setTimeout(()=>this.GDh(),this.JNj),f())}}addHandler(f){this.JMb();this.BKa=this.pIo(f);this.cvn(this.BKa);this.mvg.forEach(a=>{window.addEventListener(a,this.BKa)})}JMb(){var f;this.GDh();null===(f=this.Clh)||void 0===f?void 0:f.disconnect();this.mvg.forEach(a=>{window.removeEventListener(a,this.BKa)});this.BKa=
void 0}GDh(){this.Mjd&&(clearTimeout(this.Mjd),this.Mjd=void 0)}cvn(f){this.Clh=new MutationObserver(f);(f=document.getElementsByClassName(this.lQj)[0])&&this.Clh.observe(f,{attributes:!0,attributeFilter:["style"]})}}Object(E.a)(l,"EditorAiWindowEventManager",null,[])},1750:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(38),f=c(11);class a{constructor(k){var x,y;this.yo=k;this.JR=null;this.JR=null===(y=null===(x=this.yo)||void 0===x?void 0:x.Bd)||void 0===y?void 0:y.container}addHandler(k){this.JR&&
(this.JMb(),this.BKa=k,l.a.addHandler(this.JR,f.a.scroll,this.BKa),l.a.addHandler(this.JR,f.a.resize,this.BKa))}JMb(){this.JR&&this.BKa&&(l.a.removeHandler(this.JR,f.a.scroll,this.BKa),l.a.removeHandler(this.JR,f.a.resize,this.BKa))}}Object(E.a)(a,"EditorAiPositionManager",null,[])},1752:function(E,K,c){var l=c(0),f=c(1813),a=c(365),k=c(602),x=c(58),y=c(22),n=c(2026),u=c(2),z=c(106),w=c(91),F=c(1607),G=c(182);class H{constructor(ec,Bc){this.CommentId=ec;this.ResolveState=Bc}}Object(l.a)(H,"CommentProperties",
null,[]);var L=c(575),I=c(2028),N=c(2029),P=c(1652),M=c(189),J=c(1811);class V extends J.a{constructor(ec,Bc="",Vc="",xd="",ee=!1){super(ec,Bc,Vc,xd,ee);this.DateUtc=null}}Object(l.a)(V,"CommentReactionUser",J.a,[]);var X;(function(ec){ec[ec.like=1]="like"})(X||(X={}));Object(l.b)("ReactionType",X);var W;(function(ec){ec[ec.first=0]="first";ec[ec.done=0]="done";ec[ec.undone=1]="undone";ec[ec.addComment=2]="addComment";ec[ec.deleteComment=3]="deleteComment";ec[ec.editComment=4]="editComment";ec[ec.addReaction=
5]="addReaction";ec[ec.removeReaction=6]="removeReaction";ec[ec.last=7]="last"})(W||(W={}));Object(l.b)("CommentChangeType",W);var U=c(239),Y=c(586),ca=c(243);class aa{constructor(){this.Ueh=this.jhh=!1;this.umk=[]}get Ilc(){return this.umk}get oPb(){return this.jhh}set oPb(ec){this.jhh=ec;for(const Bc of this.Ilc)Bc.oPb=ec}get bOb(){return this.Ueh}set bOb(ec){this.Ueh=ec;for(const Bc of this.Ilc)Bc.bOb=ec}B7a(ec){for(const Bc of this.Ilc)ec=Bc.B7a(ec);return ec}}Object(l.a)(aa,"AggregateCommentTaskPersonTransformer",
null,[1270]);var fa=c(7),pa=c(135),ra=c(1604);class la{constructor(ec,Bc){this.N9j=new ca.a(()=>Bc.B7a(ec.value))}QSl(){return new Date}l_a(ec,Bc,Vc){if(0===ec)throw fa.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const xd=pa.a.create().toString();Vc=new ra.a(ec,this.N9j.value,Vc,xd,!1);Vc.commentId=Bc;fa.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",
ec);return Vc}}Object(l.a)(la,"HistoryRecordFactory",null,[1271]);var qa=c(1667);class La{constructor(ec,Bc,Vc,xd,ee,Me){this.isLossy=ec;this.title=Bc;this.assignees=Vc;this.schedule=xd;this.completion=ee;this.priority=Me}}Object(l.a)(La,"CommentTaskState",null,[]);class Pa{constructor(){this.commentId=null}}Object(l.a)(Pa,"HistoryItem",null,[]);class Ka{constructor(ec,Bc,Vc,xd,ee,Me,De){this.JEe=!1;if(1!==Bc.type)throw Error.argument("createRecord");this.mrc=Vc;this.jrc=xd;this.krc=ee;this.q7g=1;
this.ykd=ec;this.Oak=Me;this._state=new La(!1,this.mrc,De,new qa.a,this.krc,this.jrc);this._history=[];this.GLh(Bc)}P3b(ec,Bc){if(1!==ec.type)throw Error.argument("createRecordTemplate");const Vc=Ka.Edm(ec,this.q7g);this.q7g++;return Object.assign(new ra.a(Bc,ec.user,ec.time,Vc),{commentId:ec.commentId})}get aEi(){return this.history[this.history.length-1]}get Oli(){return this.state.completion===this.krc}get Nli(){return this.state.priority===this.jrc}get Pli(){return(void 0===this.state.schedule.startDate||
null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Qli(){return this.state.title===this.mrc}GLh(ec){ec=Object.assign(new Pa,{commentId:ec.commentId,records:[ec]});this.history.push(ec)}Q3h(ec){let Bc=-1;for(let Vc=0;Vc<this.state.assignees.length;Vc++)if(this.ykd.equals(this.state.assignees[Vc],ec)){Bc=Vc;break}return Bc}Gpo(ec){const Bc=this.aEi,Vc=Bc.records[Bc.records.length-1];return this.ykd.equals(Vc.user,ec.user)&&Bc.commentId===
ec.commentId&&Vc.time.getTime()===ec.time.getTime()?!0:!1}HYo(ec){switch(ec.type){case 2:-1===this.Q3h(ec.assignee)&&this.state.assignees.push(ec.assignee);break;case 3:const Bc=this.Q3h(ec.assignee);0<=Bc&&this.state.assignees.splice(Bc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=ec.schedule;break;case 6:this.state.completion=ec.completion;break;case 9:this.state.title=ec.title;break;case 10:this.state.priority=ec.priority;break;case 0:this.state.isLossy=!0;
break;case 1:fa.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.JEe=!0;break;case 8:this.JEe=!1;break;case -1:fa.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}ec.isLossy&&(this.state.isLossy=!0);this.Gpo(ec)?this.aEi.records.push(ec):this.GLh(ec)}get isDeleted(){return this.JEe}get state(){return this._state}get history(){return this._history}CYl(ec){if(!ec)return this.history;const Bc=
Array.clone(this.history),Vc=Bc[0],xd=Vc.records.shift();if(!this.Oak){var ee=this.P3b(xd,4);Vc.records.unshift(ee)}!ec.Oli&&this.Oli&&(ee=this.P3b(xd,6),ee.completion=this.krc,Vc.records.unshift(ee));!ec.Nli&&this.Nli&&(ee=this.P3b(xd,10),ee.priority=this.jrc,Vc.records.unshift(ee));!ec.Pli&&this.Pli&&(ee=this.P3b(xd,5),ee.schedule=new qa.a,Vc.records.unshift(ee));!ec.Qli&&this.Qli&&(ee=this.P3b(xd,9),ee.title=this.mrc,Vc.records.unshift(ee));ec.isDeleted&&(ec=this.P3b(xd,8),Vc.records.unshift(ec));
return Bc}static Edm(ec,Bc){return"Synthesized-"+ec.recordId+"-"+Bc}}Object(l.a)(Ka,"CommentTaskStateBuilder",null,[]);class Na{constructor(ec,Bc,Vc,xd){this.id=ec;this.commentId=Bc;this.currentState=Vc;this.history=xd}}Object(l.a)(Na,"CommentTaskItem",null,[]);var sa=c(1603);const wa=ec=>{const Bc=new sa.a(ec.UserId,ec.Provider,ec.DisplayName,ec.Email);Bc.IsCurrentUser=ec.IsCurrentUser;return Bc};var ja=c(1808);class ha{static clone(ec){ec=ha.oZk(ec.extensions);return new ja.a(ec)}static vEh(ec){return ec?
ha.clone(ec):null}static isEmpty(ec){return!ec.extensions||!ec.extensions.count}static jf(ec){return!ec||ha.isEmpty(ec)}static oZk(ec){if(!ec)return null;const Bc=new a.a;ec.forEach((Vc,xd)=>{Bc.add(Vc,xd);return!0});return Bc}}Object(l.a)(ha,"ExtensionListExtensions",null,[]);class va{static clone(ec){var Bc=wa(ec.user);Bc=new ra.a(ec.type,Bc,ec.time,ec.recordId,ec.isLossy);Bc.commentId=ec.commentId;Bc.anchorExtensionList=ha.vEh(ec.anchorExtensionList);Bc.recordExtensionList=ha.vEh(ec.recordExtensionList);
ec.assignee&&(Bc.assignee=wa(ec.assignee));if(ec.schedule){var Vc=ec.schedule;const xd=new qa.a;xd.startDate=Vc.startDate;xd.endDate=Vc.endDate;Bc.schedule=xd}Bc.completion=ec.completion;Bc.title=ec.title;Bc.priority=ec.priority;Bc.undoId=ec.undoId;return Bc}}Object(l.a)(va,"HistoryRecordExtensions",null,[]);class xa{constructor(ec,Bc,Vc,xd,ee,Me,De,oe=!1){this.ykd=ec;this.crd=Bc;this.SLa=Vc;this.QZj=xd;this.mrc=ee;this.jrc=Me;this.krc=De;this.mmd=oe}Odl(ec,Bc,Vc,xd=null){if(!ec)throw fa.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Bc)throw fa.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Vc||!Vc.length)throw fa.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Vc[0].type)throw fa.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var ee=[],Me=null,De=this.GIn(Vc);
for(var oe of Vc)if(!De.contains(oe.recordId))if(Vc=this.pii(oe.commentId,xd),Vc=this.DJl(oe,Vc),1===Vc.type){let Qe=[];this.mmd&&Me&&Me.state&&(Qe=Me.state.assignees);Me=new Ka(this.ykd,Vc,this.mrc,this.jrc,this.krc,this.mmd,Qe);ee.push(Me)}else if(Me)Me.HYo(Vc);else throw fa.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");
De=null;oe=[];if(Me){Me.isDeleted||(De=Me.state);Me=null;for(var nf of ee)ee=nf.CYl(Me),Array.addRange(oe,ee),Me=nf}nf=this.pii(Bc,xd);De&&(De.completion=this.x2k(Bc,xd,De.completion));return new Na(ec,nf,De,oe)}v2h(ec,Bc,Vc,xd=null){if(!Bc)throw fa.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Vc&&!ec)throw fa.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const ee=[],Me=this.SLa.QSl();if(Vc){var De=
this.SLa.l_a(1,ec,Me);ee.push(De)}De=null;if(Bc.assigneeUpdate){if(!Bc.assigneeUpdate.assigneesToAdd||!Bc.assigneeUpdate.assigneesToRemove)throw fa.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var oe=0;oe<Bc.assigneeUpdate.assigneesToAdd.length;oe++){var nf=this.HLh(2,Bc.assigneeUpdate.assigneesToAdd[oe],ec,Me);nf&&ee.push(nf)}for(oe=0;oe<Bc.assigneeUpdate.assigneesToRemove.length;oe++)(nf=this.HLh(3,Bc.assigneeUpdate.assigneesToRemove[oe],
ec,Me))&&ee.push(nf)}else Bc.assignee&&(Vc||(De=this.SLa.l_a(4,ec,Me),ee.push(De)),oe=this.SLa.l_a(2,ec,Me),De=this.crd.B7a(Bc.assignee),oe.assignee=De,ee.push(oe));Bc.title?(xd=this.SLa.l_a(9,ec,Me),xd.title=Bc.title,ee.push(xd)):Vc&&xd&&(oe=this.SLa.l_a(9,ec,Me),oe.title=this.QZj.ugm(xd,De),ee.push(oe));if(Bc.schedule){if(Bc.schedule.startDate>Bc.schedule.endDate)throw fa.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");xd=this.SLa.l_a(5,ec,Me);
xd.schedule=Bc.schedule;ee.push(xd)}if(void 0!==Bc.completion&&null!==Bc.completion){xd=Bc.completion;if(0>xd||100<xd)throw fa.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Vc||fa.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",xd);Vc=this.SLa.l_a(6,ec,Me);Vc.completion=xd;ee.push(Vc)}if(void 0!==Bc.priority&&null!==Bc.priority){Bc=Bc.priority;if(0>Bc||10<Bc)throw fa.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),
Error.argumentOutOfRange("priority");ec=this.SLa.l_a(10,ec,Me);ec.priority=Bc;ee.push(ec)}return ee}HLh(ec,Bc,Vc,xd){if(2!==ec&&3!==ec)return fa.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;ec=this.SLa.l_a(ec,Vc,xd);ec.assignee=this.crd.B7a(Bc);return ec}GIn(ec){const Bc=new k.a,Vc=new k.a;for(let xd=ec.length-1;0<=xd;xd--){const ee=ec[xd],Me=Vc.contains(ee.recordId);Me||-1!==ee.type||(Vc.contains(ee.undoId)?fa.ULS.sendTraceTag(578670598,
327,50,"Multiple Undo records attempting to undo the same record."):Vc.add(ee.undoId));if(Me||-1===ee.type)Bc.contains(ee.recordId)?fa.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Bc.add(ee.recordId)}return Bc}DJl(ec,Bc){const Vc=va.clone(ec);Vc.commentId=Bc;Vc.user=this.crd.B7a(ec.user);Vc.assignee=this.crd.B7a(ec.assignee);return Vc}x2k(ec,Bc,Vc){let xd=Vc;ec&&Bc&&(({value:Bc}=Bc.Dc(ec)).returnValue?(xd=Bc.ResolveState?
100:100===Vc?0:Vc,xd!==Vc&&fa.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",ec)):fa.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",ec));return xd}pii(ec,Bc){let Vc=ec;ec&&Bc&&(({value:Bc}=Bc.Dc(ec)).returnValue?Vc=Bc.CommentId:(fa.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",ec),Vc=ec));return Vc}}
Object(l.a)(xa,"CommentTaskTranslatorImpl",null,[1272]);var ma=c(1034),Ja=c(1210);class oa{constructor(){this.Vfb=CommonUIStrings.l_Ellipsis}ugm(ec,Bc){if(!ec)throw fa.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var Vc=F.a.bEb(ec)}catch(nf){throw fa.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var xd=ec=0,ee=0;const Me=RegExp("\\s+","g"),De=new Sys.StringBuilder;
for(var oe of Vc.ops)oe.attributes&&oe.attributes.atmention&&oe.attributes.atmention.email&&Bc&&(Vc=oe.attributes.atmention.email,0<Vc.length&&(Vc===Bc.UserId||Vc===Bc.Email||Vc===ma.a.wgb(Bc.UserId))&&(xd=ec,ee=xd+oe.insert.length)),Vc=oe.insert.replace(Me," "),ec+=Vc.length,De.append(Vc);!ee&&Bc&&fa.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Bc.Provider);Bc=De.toString().trimEnd();ec=Bc.length;255<ec?(oe=(255-(ee-xd))/2,0>xd-oe?(ec=Ja.a.instance.H0a(Bc,255-this.Vfb.length),
ee=Bc.substring(0,ec)+this.Vfb,ec="Trimmed End"):ee+oe>ec?(xd=Ja.a.instance.$0a(Bc,ec-255+this.Vfb.length),ee=this.Vfb+Bc.substring(xd,ec),ec="Trimmed Start"):(xd=Ja.a.instance.$0a(Bc,xd-oe+this.Vfb.length),ec=Ja.a.instance.H0a(Bc,ee+oe-this.Vfb.length),ee=this.Vfb+Bc.substring(xd,ec)+this.Vfb,ec="Trimmed Both")):(ec="No Trim",ee=Bc);fa.ULS.sendTraceTag(592998804,327,50,ec);return ee}}Object(l.a)(oa,"ContentExtractor",null,[]);class za{constructor(ec,Bc){this.L5j=ec;this.O9j=Bc;this.bOb=this.oPb=
!1}B7a(ec){if(!ec)return null;if(void 0===ec.UserId||null===ec.UserId)throw fa.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(ec.IsCurrentUser||!this.L5j.equals(this.O9j.value,ec))return ec;ec=wa(ec);ec.IsCurrentUser=!0;return ec}}Object(l.a)(za,"EnsureIsCurrentUserSetTransformer",null,[1270]);class Fa{constructor(){this.bOb=this.oPb=!1}B7a(ec){if(!ec)return null;if(void 0===ec.UserId||null===ec.UserId)return ec;if(!ec.Email||""===ec.Email){let Bc;
if(Bc=ma.a.wgb(ec.UserId))return ec=wa(ec),ec.Email=Bc,ec}return ec}}Object(l.a)(Fa,"RestoreEmailTransformer",null,[1270]);class kb{constructor(){this.bOb=this.oPb=!1}B7a(ec){if(!ec)return null;if(void 0!==ec.UserId&&null!==ec.UserId)return ec;switch(this.oPb?this.bOb?2:1:0){case 0:if(void 0===ec.UserId||null===ec.UserId)throw fa.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");ec=wa(ec);break;case 1:if(void 0===ec.Id||null===ec.Id)throw fa.ULS.sendTraceTag(593368214,
327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===ec.Email||null===ec.Email)throw fa.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Bc=kb.J_i(ec.Id,ec.Email,null);if(!Bc||""===Bc)throw fa.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Vc=u.AFrameworkApplication.K.jb("HostAuthType")||"";if("aad"!==Vc.toLowerCase()||Bc.startsWith("S::")){if("msa"===Vc.toLowerCase())throw fa.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");fa.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Vc)}else throw fa.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");ec=new sa.a(Bc,"AD",ec.DisplayName,ec.Email);break;case 2:if(void 0===ec.UserPrincipalName||null===ec.UserPrincipalName)throw fa.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==ec.SuggestionSubtype&&null!==ec.SuggestionSubtype)if("OrganizationUser"===ec.SuggestionSubtype)Bc="AD";else throw fa.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",ec.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw fa.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Vc=kb.J_i(ec.Id,ec.UserPrincipalName,ec.AadObjectId);if(!Vc||""===Vc)throw fa.ULS.sendTraceTag(593368205,327,
10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Bc&&!Vc.startsWith("S::"))throw fa.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");ec=new sa.a(Vc,Bc,ec.Name,ec.UserPrincipalName);break;default:throw fa.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return ec}static J_i(ec,Bc,Vc){if(!Bc||""===Bc)return fa.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),ec;if(Vc&&""!==Vc)return"S::"+
Bc+"::"+Vc;if(!ec||""===ec)return fa.ULS.sendTraceTag(593368217,327,50,"Missing ID"),ec;if(ec.startsWith("S::"))return ec;if(-1!==ec.indexOf("@")){Vc=ec.split("@");if(pa.a.isValid(Vc[0]))return"S::"+Bc+"::"+Vc[0];fa.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return ec}}Object(l.a)(kb,"UserIdCanonicalizationTransformer",null,[1270]);class fb{constructor(ec,Bc,Vc=!1,xd=!1){this.x1j=ec;this.xNg=Bc;this.z$j=Vc;this.mmd=xd}T8k(){const ec=new ma.a;var Bc=new ca.a(fb.tSl);
const Vc=new aa;this.xNg&&(Vc.Ilc.push(new kb),Vc.Ilc.push(new Fa));this.x1j&&Vc.Ilc.push(new za(ec,Bc));Vc.oPb=this.xNg;Vc.bOb=this.z$j;Bc=new la(Bc,Vc);const xd=new oa;return new xa(ec,Vc,Bc,xd,fb.Qhl,fb.Hhl,fb.Ihl,this.mmd)}static tSl(){const ec=new sa.a(u.AFrameworkApplication.K.jb("PresenceUserId")||"",u.AFrameworkApplication.K.jb("PresenceProvider")||"",u.AFrameworkApplication.userName||"");ec.IsCurrentUser=!0;return ec}}fb.Qhl="";fb.Hhl=5;fb.Ihl=0;Object(l.a)(fb,"CommentTaskTranslatorFactory",
null,[1261]);var lb=c(44),sb=c(170),ab=c(13),Ga=c(5),Ua=c(51),wb=c(9),cc=c(152),zb=c(46),nb=c(23),eb=c(725),Ib=c(37),Xa=c(17),Ra=c(8),gb=c(1205),Bb=c(28),$b=c(75),Qb=c(285),Ac=c(133),Db=c(202),dc=c(392),Pb=c(706),Ub=c(369),rb=c(61),Yb=c(235),Ya=c(12),Ob=c(246),vc=c(6),Sa=c(694),Ab=c(585),Fb=c(355),Va=c(55),Wa=c(603),jb=c(110),mc=c(77),yb=c(219),Oa=c(1468),Gb=c(35),Wb=c(1036);class kc{create(){return new Wb.a}}Object(l.a)(kc,"CommentNodeFactory",null,[395]);var Mb=c(1199),Qc=c(1057),Ic=c(1508),Ed=
c(1569);class me{constructor(){this.DKc=this.a9c=null;this.TJd=this.xje=!1;this.tNa=this.RCa=null}}Object(l.a)(me,"CommentAnchorParaNodesStatus",null,[]);var Be=c(1405),ad=c(15);class Nc extends Be.a{constructor(ec){super();this.$fk=ec}get index(){return 2}run(){this.$fk()}DFh(ec,Bc){Bc.property===ad.a.ef&&this.rY()}}Object(l.a)(Nc,"CommentContentPropertyTracker",Be.a,[]);var Sc=c(1499);class Gc{constructor(ec,Bc){this.vfc=ec;this.psi=Bc}}Object(l.a)(Gc,"CommentIntentIdentifier",null,[]);var ie=c(1026),
cf=c(1211),Ge=c(193),gf=c(157);class Ie extends Be.a{constructor(ec,Bc){super();this.u9a=new Ab.a(new ie.a);this.k_b=new cf.a(Sc.c);this.l_b=new Ge.ScriptSharpLegacyMap;this.Xbk=ec;this.adk=Bc;this.l_b.add(vc.a.Waa,1);this.l_b.add(vc.a.zH,0);this.l_b.add(ad.a.ef,0);this.l_b.add(vc.a.F7,2)}get index(){return 4}run(){let ec="";for(const Bc of this.u9a)if(this.Xbk(Bc),this.k_b.nb(Bc.id))for(const Vc of this.k_b.J(Bc.id))ec+="_"+Vc;this.adk(ec);this.u9a.clear();this.k_b=new cf.a(Sc.c)}j1k(ec,Bc){ec=Bc.property;
if(ec===vc.a.Waa||ec===vc.a.zH||ec===ad.a.ef||gf.App.cpe&&ec===vc.a.N2b||ec===vc.a.F7)this.u9a.add(Bc.node),this.l_b.nb(ec)&&(this.k_b.nb(Bc.node.id)||this.k_b.add(Bc.node.id,new Wa.a),this.k_b.J(Bc.node.id).add(this.l_b.J(ec))),this.rY();Ic.a.hOh.has(Bc.node.id.toString())&&ec===vc.a.XE&&fa.ULS.sendTraceTag(521484097,327,15,"Durable ID changed of a Cut Pasted Comment")}v1k(ec,Bc){Bc.property===ad.a.mo&&(ec=Bc.node,ec.YGb&&(this.u9a.add(ec),this.rY()))}AGo(ec,Bc){this.u9a.add(Bc.node);this.rY()}}
Object(l.a)(Ie,"CommentNodeTransactionCompletedProcessor",Be.a,[]);var zf=c(1571),uc=c(1608);class Rc{constructor(){this.Tye=new Map;this.XBe=new Map}Uqk(ec,Bc){if(this.Tye.has(ec))throw Error("DuplicateDurableId");if(this.XBe.has(Bc))throw Error("DuplicateGuardId");this.Tye.set(ec,Bc);this.XBe.set(Bc,ec)}LXl(ec){return this.Tye.get(ec)}A7h(ec){return this.XBe.get(ec)}}Object(l.a)(Rc,"CommentIdMapper",null,[]);var Dd=c(16),Id=c(1520),Kd=c(1669),af=c(1550),Dg=c(119),oi=c(113);c.d(K,"a",function(){return zg});
class zg extends f.a{constructor(ec,Bc,Vc,xd,ee,Me,De,oe,nf,Qe,of,mf,jg,pf,xb,Tb,Xc,Fd,Se,pd,lf,Ze,Vg,Pi,Sh,wh=null,rm){super();this.vx=ec;this.uIe=Bc;this.pIe=Vc;this.Gc=xd;this.aZj=ee;this.Xub=Me;this.kXe=De;this.hqc=oe;this.Ma=nf;this.ld=Qe;this.Fm=of;this.RWb=mf;this.F6=jg;this.FWb=pf;this.k4g=xb;this.ah=Tb;this.Jm=Xc;this.IUa=Fd;this.Yi=Se;this.P1=pd;this.eK=lf;this.oYa=Ze;this.Yzc=Vg;this.lqc=[];this.aVa=[];this.zUe=new a.a(0);this.Ksd=new a.a;this.Ovd=new Ab.a(Fb.a.ai());this.$Te=new Ab.a(Fb.a.ai());
this.Ehd=null;this.Osb=new a.a;this.wxe=!1;this.Dfd=new k.a;this.QZg=!1;this.Hve=new Set;this.eve=0;this.oZ=[];this.lUb=2;this.GBa=new a.a(!1);this.yxc=new k.a;this.dsc=new Map;this.yfd=new Rc;this.zfd=0;this.$Yj=5;this.aKb=(xf,lg)=>{xf=lg.paragraphNode;for(const nd of lg.contents)this.Zva(nd.element,xf,nd.intents,nd.nG)};this.e_c=(xf,lg)=>{if(xf.Jc.id.equals(this.od.id)){this.IUa.SGa(7);var nd=xf.getValue(vc.a.zH),ud=xf.getValue(vc.a.XE).toString();nd=this.ah.cgb?this.dsc.has(ud)?this.dsc.get(ud):
ud:nd;nd=this.LD(nd);if(lg){if(nd){this.oy&&this.oy.Df===nd.id&&(fa.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.eK.logKpiFailure(Id.a.IEd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Id.a.tEd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));lg=nd.Df?"The comment is a reply":"";ud=Sc.k(xf,x.a.nil).toString();const Bd=Sc.h(xf,x.a.nil).toString();if(this.Dfd.contains(nd.id)&&!Ic.a.YHm(nd.X_a)){this.Dfd.remove(nd.id);const kl=+new Date-+nd.date;
fa.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",Sc.a(nd),kl,ud,Bd,lg)}else fa.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Sc.a(nd),ud,Bd,lg);this.Xi.dJc(nd);this.XPh(xf.id)}}else if(!nd){this.eK.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();y.a.instance.Na("WordEditor.Comments.EditorCommentManager")||fa.ULS.sendTraceTag(525379405,
327,10,"comment Manager resolve failed");if(this.ah.UBb&&!this.Yi.gY){this.P1.T4("OnCommentInit",Object.assign(new zf.a,{RTi:()=>{this.dTf(xf);this.AMb()}}));return}this.ah.Wq||this.Yi.gY||this.P1.T4("OnCommentInit");this.WLn(xf)||this.dTf(xf)}this.wxe=!0}};this.AMb=(xf=null)=>{this.ah.OPb&&this.oqi();this.ah.OPb&&this.qul();this.dJ.CMb(void 0,xf);this.IUa.SGa(8)};this.AXi=(xf,lg,nd)=>{if(xf.Jc.id.equals(this.od.id)){var ud=xf.ia(vc.a.taskId,"");if(""===ud)fa.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");
else{if(lg)if(this.$Te.add(ud),ud=this.FWb.value.phi(xf),void 0!==ud&&null!==ud)this.Osb.remove(ud);else{fa.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Ovd.add(ud),lg=this.FWb.value,xf=lg.phi(xf),void 0!==xf&&null!==xf)for(this.Osb.J(xf)?this.Osb.Z(xf,ud):this.Osb.add(xf,ud),xf=lg.rhi(ud),lg=0;lg<xf.length;lg++){var Bd=xf[lg].commentId;Bd&&(Bd=Number.parseInvariant(Bd),this.Osb.J(Bd)||this.Osb.add(Bd,ud))}else{fa.ULS.sendTraceTag(591971723,
3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}nd&&this.AMb()}}};this.RSo=xf=>{if(Ic.a.KXd(xf)){const nd=this.x_(xf.id.toString());if(nd){const ud={text:nd.text,done:nd.done};var lg=Ga.GraphIterator.$a(xf);nd.text=this.QDb(lg);this.TIi(nd.text);nd.done=xf.ia(vc.a.Waa,!1);xf.hasProperty(vc.a.F7)&&(lg=(lg=xf.getValue(vc.a.F7))?Gb.b(lg||""):null,nd.usersByReactionType=lg,af.a.xCh(nd.usersByReactionType),this.wVk(nd));this.USo(xf,nd);nd.Df||this.ZSo(xf,
nd);!this.ah.nua||!this.vE||this.oy&&this.oy.id===nd.id||this.vE.fireEvent(10,{comment:nd,QRi:ud})}}else this.ld.isFeatureEnabled(115)&&72===xf.type?this.AXi(xf,!1,!1):this.TSo(xf)};this.rul=()=>{const xf=this.dOd();for(this.lqc.sort((lg,nd)=>{const ud=lg.ia(vc.a.iM,null),Bd=nd.ia(vc.a.iM,null);if(!ud&&Bd)return-1;if(!Bd&&ud)return 1;lg.hasProperty(vc.a.SCa)&&nd.hasProperty(vc.a.SCa)?(lg=lg.getValue(vc.a.SCa),nd=nd.getValue(vc.a.SCa),nd=lg<nd):(lg=new Date(lg.getValue(vc.a.RGc)),nd=new Date(nd.getValue(vc.a.RGc)),
nd=lg<nd);return nd?-1:1});this.lqc.length;){const lg=this.lqc[0];xf.jib(lg)&&(xf.Fi(lg),this.Xi.addComment(this.qGd(xf),null),this.Xi.mode=1);Array.removeAt(this.lqc,0)}if(xf.Sb(1))for(;xf.vf(1););this.ld.isFeatureEnabled(115)&&this.FWb.value.thi();this.wxe&&(this.AMb(),this.wxe=!1)};this.Zll=xf=>{1===xf&&(yb.WoncaApp.hle.VJh(),this.RWb.value.m6a(!0,"CommentInboundFailed"));this.F6.XC(Ua.a.z$e,this.MDi)};this.dha=xf=>{if(!this.ah.Wq||xf.done)return!1;if(xf.Vq===n.a.beingCreated)return!0;if(xf.objectId){if(this.GGm(xf))return!1;
if(!this.QMm(xf.objectId)||xf.Df)return!0;for(const lg of this.BO())if(lg.Df===xf.id)return!0}return!1};zg.dK=wh;this.cpd=new Ab.a(Fb.a.ai());!this.ah.UBb&&this.ah.Wq||Wb.a.mSa(this.e_c);Sh.MMa(this.aKb);Pi&&(Pi.Ow((xf,lg)=>{xf=Sc.o(this.oZ,lg.node.id);0<this.oZ.length&&(!xf||xf===this.oZ.length-1)&&(this.lUb=1,this.oZ=[])}),rm.execute(xf=>{this.vE=xf}),u.AFrameworkApplication.uJ&&(u.AFrameworkApplication.te("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.ah.cIk&&this.eqk()))}eqk(){z.a.instance.Wb(new w.a(5,
1,0,()=>{const ec=this.Gc.Oc(7);ec.Cb(this.SIa);var Bc=wb.App.xa.hb.Uc;Bc&&(Bc=cc.PageNavigator.instance.MO(Bc),Bc=Ga.GraphIterator.$a(Bc),Bc.Qd(),Bc.Qd(),Bc.Qd(),Bc.Qd(),zb.a.instance.setSelection(nb.SelectionFactory.LK(Bc.currentNode,0,0)),Bc=new F.a,Bc.aha("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),this.nBb(zb.a.instance.gb.kb,"Microsoft Word",Bc),ec.dispose(),lb.a("ShareTUICommentCreated"),
fa.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get dJ(){return this.Xi}get g0e(){return this.$g}get MDi(){return null!=this.eDg?this.eDg:this.eDg=Object.assign(new eb.a,{m3:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,zfa:1})}get Ts(){return this.Gc}get hx(){return this.vx.value}get od(){return this.hx.od}get SIa(){return this.uIe.value}get UCa(){return this.pIe.value}get lb(){return this.Xub.value}get AY(){return this.Ma.jb("PresenceUserId")}get b5a(){return this.Ma.jb("PresenceProvider")}Zva(ec,
Bc,Vc,xd){if(Vc&&this.oy&&(!this.oy||!this.oy.Df)){var ee=!1;for(const Me of Vc)if(3===Me.type)switch(ee=!0,Vc=Sc.n(this.oZ,Me.id),-1<Vc&&(this.oZ[Vc].vfc=Bc.id),ec.classList.add(Ib.a.nJd),xd){case 1:ec.classList.add(Ib.a.Xff);break;case 0:ec.classList.add(Ib.a.Yff)}ee||ec.classList.remove(Ib.a.nJd,Ib.a.Yff,Ib.a.Xff);this.IUa.SGa(3)}}iof(ec=!1){return this.kXe.WHl(this.$g,u.AFrameworkApplication.va.mode,Bc=>!this.ah.cPb||!ec||this.dha(Bc))}Onf(ec){return this.kXe.dOl(this.Xi.model.BO(),u.AFrameworkApplication.va.mode,
ec)}Gsf(ec){if(!ec||!ec.Df)return ec;ec=ec.Df;for(let Bc=0;Bc<this.$g.length;Bc++)if(this.$g[Bc].id===ec)return this.$g[Bc];return null}S8k(){const ec=[];if(this.ld.isFeatureEnabled(115)){var Bc=this.FWb.value;for(const Vc of Bc.thi())(Bc=this.L2h(Vc))&&ec.push(Bc)}return ec}Svm(ec){if(!this.aVa)throw G.a.invalidOperation("UpdateContent must have been called before this.");for(let Bc=0;Bc<this.aVa.length;Bc++)if(this.aVa[Bc].id===ec)return Bc;return-1}oqi(){const ec=new mc.a;for(const Vc of this.$g)if(Vc.objectId&&
Vc.nPa){var Bc=x.a.Ff(Vc.objectId);if((Bc=this.od.Db(Bc))&&Bc.hasProperty(vc.a.XE))if(Bc=Bc.getValue(vc.a.XE).toString(),ec.nb(Bc)){const xd=ec.J(Bc).CommentId;this.lPj(xd,Vc,Bc)}else ec.add(Bc,new H(Vc.id,Vc.done))}this.Ehd=ec}lPj(ec,Bc,Vc){ec!==Bc.nPa?(fa.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",Vc,Bc.objectId,Bc.nPa,ec),this.eK.logKpiFailure(Id.a.Q2b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:Id.a.P2b,isInternal:!0})):fa.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",Vc,Bc.nPa,Bc.objectId)}L2h(ec){const Bc=this.k4g.value;var Vc=this.FWb.value;const xd=Vc.H8b(ec);if(void 0===xd||null===xd)return fa.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",ec),null;Vc=Vc.rhi(ec);try{return Bc.Odl(ec,xd.toString(),Vc,this.Ehd)}catch(ee){return fa.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",ee.message),null}}O5h(ec=!1,Bc=!1){const Vc=new k.a,xd=Bc?Sc.j():new Set;this.GBa.keys.forEach(ee=>{xd.has(ee)||ec&&this.GBa.J(ee)||Vc.add(ee);return!0});return Vc}CQd(){if(!this.$g)return 0;let ec=0;for(const Bc of this.$g)Bc.Df||ec++;return ec}OTc(ec){var Bc,Vc;return(null===(Vc=null===(Bc=this.oy)||void 0===Bc?void 0:Bc.iz)||void 0===Vc?void 0:Vc.draftId)===ec}Xqk(ec){var Bc;if(ec.Vq===n.a.beingCreated){if(this.Xi.mode=2,this.oab=ec,
this.lb.gb){var Vc=this.lb.gb.kb;if(Vc&&Vc.Oa){if(Xa.SelectionEditor.km(Vc)){var xd=Xa.SelectionEditor.F3(Vc.Oa,!1);xd&&(this.lb.setSelection(xd),Vc=xd)}for(xd=0;xd<Vc.length;xd++){var ee=Vc.J(xd).node;if(!Ra.ParagraphReader.Vb(ee)||!(-1!==Vc.J(xd).cpBegin&&-1!==Vc.J(xd).cpEnd||-1!==Vc.J(xd).oj&&-1!==Vc.J(xd).Yo))continue;var Me=-1===Vc.J(xd).cpBegin?Vc.J(xd).oj:Vc.J(xd).cpBegin;const De=-1===Vc.J(xd).cpEnd?Vc.J(xd).Yo:Vc.J(xd).cpEnd,oe=x.a.create();this.Fm.$Qa(ee,new gb.a(3,Me,De,oe));this.oZ.push(new Gc(ee.id,
oe));this.Crk(null===(Bc=ec.iz)||void 0===Bc?void 0:Bc.draftId,ee,Me,Vc)}}}}else this.q3f(ec);Vc=({index:Bc}=this.rme(ec)).returnValue;xd=null;if(!ec.Df){ee=this.O5h();ec.Vq!==n.a.beingCreated&&(xd=this.fbm(ec),ee.remove(ec.objectId));ee=({index:Me}=this.i3l(xd,ee)).returnValue;Bc=-1<Me?Me:Bc;Me=0;if(ee)for(;Bc<this.$g.length&&this.$g[Bc].Df;)Bc++;if(!ee&&this.ah.Wq&&ec.Vq===n.a.beingCreated)for(ee=0;ee<Bc;ee++)this.$g[ee].Df||this.$g[ee].done||Me++;this.JCo(ec,Me)}Vc&&(Array.insert(this.$g,Bc,ec),
this.ah.nua&&this.vE&&ec.Vq!==n.a.beingCreated&&(ec.Df?this.vE.fireEvent(10,{comment:ec,changeType:"replyAdded"}):this.vE.fireEvent(11,{comment:ec})),this.$qk(ec,xd))}Crk(ec,Bc,Vc,xd){this.ah.contentNavigationApiEnabled&&ec&&Bc&&xd&&this.Yzc.zZe({contentId:ec,containerContentType:0,x9:{yd:Vc,MM:Bc.Al}},{selection:xd})}$qk(ec,Bc){if(this.ah.contentNavigationApiEnabled&&ec&&!ec.Df&&ec.Vq!==n.a.beingCreated){var Vc=this.od.Db(ec.objectId);if(Vc){var xd=Sc.k(Vc,x.a.nil);xd=this.od.Db(xd);xd=Ic.a.Ava(xd,
Vc.id,!1);(null===xd||void 0===xd?0:xd.Ib)&&(null===xd||void 0===xd?0:xd.paragraph)?this.Yzc.zZe({contentId:ec.id,containerContentType:0,x9:{yd:xd.Ib.cp,MM:xd.paragraph.Al}},{selection:Bc}):fa.ULS.sendTraceTag(520717896,327,10,`comment object id: ${Vc.id},
        commentStartRangeObject Valid: ${!!xd},
        containingProperties Valid: ${!(null===xd||void 0===xd||!xd.Ib)},
        paragraph valid: ${!(null===xd||void 0===xd||!xd.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}oua(ec){super.oua(ec);this.Dfd.add(ec.id)}z2n(ec,Bc){this.ah.contentNavigationApiEnabled&&this.Yzc.y2n(ec,Bc)}JCo(ec,Bc){this.ah.Wq&&ec.Vq===n.a.beingCreated&&ec.iz&&this.zUe.Z(ec.iz.draftId,Bc)}kfm(ec){return this.zUe.J(ec)}K9i(ec){this.zUe.remove(ec)}GZl(ec){let Bc=0,Vc=0;for(let xd=0;xd<this.$g.length;xd++){if(this.$g[xd].id===ec.id){Vc=xd;break}this.$g[xd].Df||this.$g[xd].done||Bc++}return{returnValue:Vc,mIo:Bc}}Htf(ec){var Bc=null,Vc=this.od.Db(ec);
ec=Ic.a.yba(Vc,this.od,!0);Vc=Ic.a.yba(Vc,this.od,!1);ec&&Vc&&(Bc=nb.SelectionFactory.ue(ec.Ib.paragraph,ec.Ib.cp),Bc=nb.SelectionFactory.oA(Bc,Bb.a.Rc(Vc.Ib.paragraph,Vc.Ib.cp)));ec&&Vc||this.eK.logKpiFailure(Id.a.Q2b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return Bc}fbm(ec){ec=x.a.Ff(ec.objectId);return this.Htf(ec)}e5f(ec,Bc){var Vc=this.od.Db(ec);if(Vc){var xd=this.od.Db(Sc.k(Vc));Vc=this.od.Db(Sc.h(Vc));if(xd===Vc)for(Vc=0;Vc<xd.pa.length&&!xd.pa.J(Vc).sOo(ec,Bc);Vc++);}}i3l(ec,
Bc){let Vc=-1;var xd=null;ec||(ec=this.lb.gb?this.lb.gb.kb:null);if(!ec||!ec.Oa)return{returnValue:null,index:Vc};const ee=this.Edi(ec.Oa);if(!ee)return{returnValue:null,index:Vc};var Me=Ic.a.$_l(ee.iterator.currentNode,ec.Oa.cpBegin,this.ah.Wq,Bc);Me&&(xd=this.x_(Me.Xj.toString()),Me=Array.indexOf(this.$g,xd),xd=0<=Me?xd:null,Vc=0<=Me?Me+1:Vc);xd||(ec=this.M5h(ee,ec.Oa,this.ah.Wq,Bc),xd=0<=ec?this.$g[ec]:null,Vc=0<=ec?ec:Vc);return{returnValue:xd,index:Vc}}aQl(ec=null){var Bc=null;Bc=this.lb.gb.kb;
return Bc&&Bc.Oa?this.bWl(Bc.Oa,this.ah.Wq,ec):null}Edi(ec){const Bc=new Ga.GraphIterator;Bc.set(ec.node);return Bc.Ep()?$b.a.Qs(Bc,Bc.origin):null}bWl(ec,Bc,Vc=null){const xd=this.Edi(ec);ec=this.M5h(xd,ec,Bc,Vc);return-1<ec?this.$g[ec]:null}M5h(ec,Bc,Vc,xd=null){let ee=-1;if(ec)for(Bc=Bc.cpBegin;-1===ee&&ec.moveNext();)Ra.ParagraphReader.sh(ec.iterator)&&((Bc=Ic.a.vNc(ec.iterator.currentNode,Bc,Vc,xd))&&(ee=Array.indexOf(this.$g,this.x_(Bc.Xj.toString()))),Bc=0);return ee}Cui(ec){const Bc=ec.toString();
return this.GBa.nb(Bc)&&this.GBa.J(Bc)||this.yxc.contains(ec)&&this.od.cwa(ec)&&this.od.Db(ec).ia(vc.a.Waa,!1)}Njj(ec,Bc=!1){if(ec=this.wNc(ec))ec.wEf=!Bc}UEf(ec){return this.GBa.nb(ec.toString())||this.yxc.contains(ec)&&this.od.cwa(ec)&&!this.od.Db(ec).ia(vc.a.iM,null)}q3f(ec){!ec.objectId||ec.Df||this.GBa.nb(ec.objectId)||this.GBa.add(ec.objectId,ec.done)}deleteComment(ec){ec&&!ec.Df&&(this.ah.Wq&&ec.Vq!==n.a.beingCreated?this.GBa.remove(ec.objectId):ec.Vq===n.a.beingCreated&&this.kDj());this.Dfd.remove(ec.id);
return super.deleteComment(ec)}rpf(ec){return ec&&ec.hasProperty(vc.a.XE)?ec.Hf(vc.a.XE).toString():""}wNc(ec){if(!ec)return null;if(this.ah.cgb)return this.LD(ec);for(const Bc of this.$g){const Vc=this.od.Db(x.a.Ff(Bc.objectId));if(this.rpf(Vc)===ec.toString())return ec=Vc.Hf(vc.a.zH),this.LD(ec)}return null}f2f(ec,Bc=!1){if(ec&&Ic.a.KXd(ec)&&this.ld.isFeatureEnabled(115)){const Vc=this.rpf(ec);if(""!==Vc){if(Bc){let xd;if(this.Ehd&&({value:xd}=this.Ehd.Dc(Vc,xd)).returnValue&&xd.ResolveState===
ec.ia(vc.a.Waa,!1))return}(ec=this.Osb.J(Number.parseInvariant(Vc)))&&this.Ovd.add(ec)}}}WLn(ec){const Bc=this.gof(ec);let Vc=!1;Bc.xje&&Bc.TJd||(this.yxc.add(ec.id),Vc=!0,this.YSi(ec));return Vc}YSi(ec){L.a.a3(u.AFrameworkApplication.pc,()=>{this.dTf(ec);this.yxc.remove(ec.id);this.yxc.count||(this.AMb(),this.dJ.aUo())},"DelayLoadCommentNodeIntoModel")}dTf(ec){if(!this.Xi&&(fa.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.zfd<this.$Yj)){this.zfd+=1;this.YSi(ec);fa.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.zfd}`);return}const Bc=this.dOd();Bc.Fi(ec);if(Bc.wA()){let Vc;try{Vc=this.qGd(Bc)}catch(xd){fa.ULS.eD(512553930,327,10,xd,"create comment from comment node failed")}if(!Vc){fa.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===ec||void 0===ec?void 0:ec.id}`);this.eK.logKpiFailure(Id.a.Q2b,"CommentCreationFailed",{isInternal:!0},{name:Id.a.P2b,isInternal:!0});return}this.Xi.addComment(Vc,null);2!==this.Xi.mode&&3!==this.Xi.mode&&(this.Xi.mode=
1);this.f2f(ec);this.ohn(Vc);this.hJj(Vc)}else this.lqc.push(ec);this.P1.T4("OnCommentNodeAdded",{commentNode:ec})}ohn(ec){this.ah.Wq&&!this.Yi.$m&&this.dJ.Cz&&ec.Df&&this.dJ.Cz.id===ec.Df&&this.dJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,ec.author),!1)}gof(ec){const Bc=new me;Bc.a9c=Sc.k(ec,x.a.nil);Bc.DKc=Sc.h(ec,x.a.nil);ec=Bc.a9c.equals(x.a.nil);const Vc=Bc.DKc.equals(x.a.nil);ec||(Bc.RCa=this.od.Db(Bc.a9c),Bc.xje=!!Bc.RCa&&Bc.RCa.isConnected);Vc||(Bc.tNa=this.od.Db(Bc.DKc),
Bc.TJd=!!Bc.tNa&&Bc.tNa.isConnected);return Bc}VVh(ec,Bc){const Vc=this.Svm(ec);-1!==Vc&&Array.removeAt(this.aVa,Vc);Bc||((ec=this.L2h(ec))?this.aVa.push(ec):fa.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}qul(){for(const ec of this.Ovd)this.VVh(ec,!1);this.Ovd.clear();for(const ec of this.$Te)this.VVh(ec,!0);this.$Te.clear()}rme(ec){var Bc=this.$g.length,Vc=!1;if(ec.Df){var xd=(Vc=this.LD(ec.Df))&&Vc.objectId?this.od.Db(x.a.Ff(Vc.objectId)):null;xd=!!xd&&xd.hasProperty(vc.a.SCa);
Bc=Array.indexOf(this.$g,Vc);Vc=0>Bc;for(Bc+=1;Bc<this.$g.length&&this.$g[Bc].Df===ec.Df&&this.$g[Bc]!==this.oy&&!(xd&&ec.date<this.$g[Bc].date);)Bc++}return{returnValue:!Vc,index:Bc}}xsm(){const ec=new Ie(this.RSo,this.AMb),Bc=wb.App.Tj.zl;Bc.Ye(40).Go(Object(Va.a)(ec,ec.j1k,"commentPropertyChanged"));Bc.Ye(12).Go(Object(Va.a)(ec,ec.v1k,"commentTextChanged"));this.ld.isFeatureEnabled(115)&&Bc.Ye(72).Go(Object(Va.a)(ec,ec.AGo,"taskPropertyChanged"));Qb.GraphTransactionManager.instance.gqa(ec,3)}TIi(ec){this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&ec&&0!==ec.length&&(ec=F.a.bEb(ec[0]),1<ec.ops.length||0===ec.ops.length||("\n"===ec.ops[0].insert&&(this.eve+=1),3<this.eve&&fa.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}wVk(ec){if(ec&&this.Hve.has(ec.id)){var Bc=ec.usersByReactionType[1];for(let Vc=0;Bc&&Vc<Bc.length;Vc++)if(Bc[Vc].UserId===this.AY)return;fa.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${ec.objectId} removed by inbound changes`)}}ZSo(ec,Bc){this.AZk(Bc);
const Vc=this.ah.Wq;Vc&&this.fpm(Bc)?(this.kil(Bc),this.f2f(ec),this.bXo(Bc)):Vc||this.f2f(ec,!0)}TSo(ec){const Bc=new Ga.GraphIterator;Bc.set(ec);Bc.zb(40);Bc.jd(40);if(Bc.currentNode){if(ec=this.x_(Bc.currentNode.id.toString())){const Vc={done:ec.done,text:ec.text};ec.text=this.QDb(Bc);this.TIi(ec.text);!this.ah.nua||!this.vE||this.oy&&this.oy.id===ec.id||this.vE.fireEvent(10,{comment:ec,QRi:Vc})}}else fa.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Ac.a[ec.type])}bXo(ec){if(!this.Yi.$m){var Bc=
new Wa.a;this.Cne(ec,Bc);0<Bc.count&&Sa.b(Bc)}}kil(ec){const Bc=new w.a(0,1,0,()=>{this.SSo(ec)},137,void 0,!0);u.AFrameworkApplication.pc.Wb(Bc)}AZk(ec){var Bc;null!==(Bc=this.oy)&&void 0!==Bc&&Bc.iz&&this.oy.iz.sessionType!==I.a.metadata&&(Bc=this.oy,ec.Df||!ec.done||Bc.Df!==ec.id&&Bc.id!==ec.id||(fa.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",Bc.Vq),this.eK.logKpiFailure(Id.a.IEd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Id.a.tEd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),Bc.Vq===n.a.beingCreated?(this.Xi.clearSelection(),this.deleteComment(Bc),this.selectComment(ec)):Bc.Vq===n.a.beingEdited&&(Bc.Vq=n.a.normal,Bc.LSa=N.a.succeeded,this.Xi.J5e())))}USo(ec,Bc){var Vc;const xd=null===(Vc=Bc.iz)||void 0===Vc?void 0:Vc.draftId;if(this.ah.cgb){if(ec=ec.getValue(vc.a.XE).toString(),Bc.id!==ec){if(!Bc.Df)for(Vc=Array.indexOf(this.$g,Bc)+1;Vc<this.$g.length&&this.$g[Vc].Df===Bc.id;Vc++)this.$g[Vc].Df=ec;fa.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");Bc.id=ec;this.dsc.has(ec)&&this.dsc.delete(ec)}}else if(ec=ec.getValue(vc.a.zH),Bc.id!==ec){if(!Bc.Df)for(Vc=Array.indexOf(this.$g,Bc)+1;Vc<this.$g.length&&this.$g[Vc].Df===Bc.id;Vc++)this.$g[Vc].Df=ec;Bc.id=ec}xd&&this.z2n(xd,Bc.id)}fpm(ec){return this.GBa.nb(ec.objectId)&&this.GBa.J(ec.objectId)!==ec.done}SSo(ec){this.GBa.Z(ec.objectId,ec.done);if(ec.done)if(this.dJ.omc(ec),this.Yi.$m)this.dJ.A_c(ec,!0);else{var Bc=new w.a(0,1,0,()=>{this.dJ.A_c(ec,!0,!1);this.Ksd.remove(ec.id)},
139);this.Ksd.add(ec.id,Bc);u.AFrameworkApplication.pc.Wb(Bc);this.Sy&&ec.id===(void 0===this.Sy.Df||null===this.Sy.Df?this.Sy.id:this.Sy.Df)&&this.dJ.clearSelection()}else this.dJ.omc(ec),Bc=null,({value:Bc}=this.Ksd.Dc(ec.id)).returnValue?(u.AFrameworkApplication.pc.We(Bc),this.Ksd.remove(ec.id)):this.dJ.A_c(ec,!1)}$Ui(){this.Oxm();this.Mxm();u.AFrameworkApplication.K.$("IsDocumentOwner")||y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(ec=>{ec.logActivity("ShowTUIForCommentAwareness",
null)})}Mxm(){this.ah.OPb&&this.oqi();this.ah.OPb&&(this.aVa=this.S8k(),Qc.a.mSa(this.AXi))}Oxm(){!this.ah.UBb&&this.ah.Wq&&Wb.a.mSa(this.e_c);this.xsm();this.wsm()}wsm(){const ec=new Nc(this.rul),Bc=wb.App.Tj.zl;Bc.Ye(39).Go(Object(Va.a)(ec,ec.DFh,"commentContainerPropertyChanged"));this.ld.isFeatureEnabled(115)&&Bc.Ye(71).Go(Object(Va.a)(ec,ec.DFh,"commentContainerPropertyChanged"));Qb.GraphTransactionManager.instance.gqa(ec,3)}x_(ec){for(let Bc=0;Bc<this.$g.length;Bc++){const Vc=this.$g[Bc];if(Vc.objectId===
ec)return Vc}return null}$uk(ec){if(ec)for(const Bc of ec)Bc&&this.cpd.add(Bc)}MXk(){this.cpd.clear()}tYe(ec,Bc){Array.insert(this.$g,Bc,ec);this.q3f(ec);this.e1m(ec);Bc=this.HOd(ec);this.cpd.contains(Bc)&&(ec.wEf=!0,this.cpd.remove(Bc))}hJj(ec){Sc.p(ec)||fa.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${ec.objectId}`)}e1m(ec){fa.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Sc.a(ec)} `)}qGd(ec){40!==ec.Ve&&fa.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const Bc=ec.currentNode;var Vc=Bc.getValue(vc.a.N2b);const xd=Bc.getValue(vc.a.zH),ee=Bc.getValue(vc.a.XE).toString(),Me=Bc.getValue(vc.a.RGc);let De=null,oe=null;if(Bc.hasProperty(vc.a.F7)){var nf=Bc.getValue(vc.a.F7);De=nf?Gb.b(nf||""):null;af.a.xCh(De)}Bc.hasProperty(vc.a.SCa)&&(oe=Bc.getValue(vc.a.SCa));let Qe=null,of=null;Bc.hasProperty(vc.a.qEd)&&Bc.hasProperty(vc.a.QGc)&&(Qe=Bc.getValue(vc.a.qEd),of=Bc.getValue(vc.a.QGc));nf=Sc.k(Bc,x.a.nil).toString();const mf=Sc.h(Bc,x.a.nil).toString(),
jg=Bc.ia(vc.a.Waa,!1),pf=Bc.ia(vc.a.iM,null),xb=Bc.ia(vc.a.pib,!1),Tb=this.QDb(ec);Vc=new P.Comment(this.ah.cgb?ee:xd,xd,Vc,oe||new Date(Me),this.ah.cgb?this.yfd.A7h(pf):pf,jg,Tb,P.Comment.FZi,xb,of,Qe,De);Vc.bEc=nf;Vc.aEc=mf;Vc.objectId=Bc.id.toString();Vc.X_a=ee;this.fnh(ee,xd);ec.jd(39);return Vc}fnh(ec,Bc){(!ec||Number.parseInvariant(ec)>=Ic.a.pMi)&&fa.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${ec}`);Bc||fa.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${Bc}`);try{this.yfd.Uqk(ec,
Bc)}catch(Vc){"DuplicateDurableId"===Vc.message?fa.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${ec} with Guard Id: ${Bc}`):"DuplicateGuardId"===Vc.message?fa.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${Bc} with Durable Id: ${ec}`):fa.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${Vc}`)}}QDb(ec){var Bc;if(40!==ec.Ve)return fa.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",ec.Ve),this.hqc.jjg([]);let Vc=ec.Ve+
":";const xd=ec.xq();0<xd?(ec.Qd(),Vc+=ec.Ve+":"):(fa.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(Bc=ec.currentNode)||void 0===Bc?void 0:Bc.id}`),Bc=new Dg.a,Bc.inStaging=!0,this.eK.logKpiFailure(Id.a.Q2b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Id.a.tEd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Bc},oi.a));Bc=Array(xd);for(let ee=0;ee<xd;ee++){ec.Qd();Vc+=ec.Ve+":";const Me=ec.currentNode;Me.YGb=!0;Bc[ee]=Me;Me.pa||fa.ULS.sendTraceTag(594363293,
327,15,"[GetCommentText_Crash] "+Vc);!Me.pa&&this.ah.wco&&(u.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.zp());ec.sc();ec.Rj();Vc+=ee<xd-1?":"+ec.Ve+":":":"}return this.hqc.jjg(Bc)}zp(){if(yb.WoncaApp.hle){var ec=new Oa.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);ec.Ad=
1;ec.Ee(1,WoncaIntl.WoncaStrings.l_SendErrorReport);ec.Ee(0,WoncaIntl.WoncaStrings.l_NoThanks);ec.cV(1);ec.mx(Ua.a.z$e,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.Zll,!1)}else this.F6.XC(Ua.a.z$e,this.MDi)}HOd(ec){if(!ec||!ec.objectId)return"";ec=x.a.Ff(ec.objectId);ec=this.od.Db(ec);return this.rpf(ec)}Z6l(ec){return this.HOd(ec.Df?this.LD(ec.Df):ec)}gSn(ec,Bc){if(this.ld.isFeatureEnabled(115))if(this.ah.removePersonalInformation)fa.ULS.sendTraceTag(595128897,
3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.AMb();else{this.oYa.Mv(ab.a.ncg);var Vc=null===Bc||void 0===Bc?void 0:Bc.taskId,xd=!Vc;xd?this.oYa.logKpiUsage(Kd.a.Qke,0):this.oYa.logKpiUsage(Kd.a.Rke,0);try{const nf=this.FWb.value,Qe=this.HOd(ec);if(""===Qe)this.O2d(xd,"FailedDurableIdForComment");else{var ee=this.Z6l(ec);if(""===ee)this.O2d(xd,"FailedDurableIdForParentComment");else if(xd&&ec.iz.sessionType!==I.a.create&&ec.iz.sessionType!==I.a.reply)fa.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",ec.iz.sessionType),this.oYa.logKpiFailure(Kd.a.Qke,"FailedTaskCreateInvalidSessionType");else{var Me=null;ec.iz.sessionType!==I.a.metadata&&(Me=Qe);var De=this.k4g.value;var oe=M.a.jf(ec.text)?De.v2h(Me,Bc,xd):De.v2h(Me,Bc,xd,ec.text[0]);0<oe.length?xd?(nf.hfb(Number.parseInvariant(ee),oe)||this.oYa.logKpiFailure(Kd.a.Qke,"TaskCreateFailed"),this.AMb()):(this.oYa.logKpiUsage(Kd.a.Rke,0),nf.aDk(Vc,oe)||this.oYa.logKpiFailure(Kd.a.Rke,
"TaskEngagementFailed")):this.O2d(xd,"HistoryRecordsLengthZero")}}}catch(nf){this.O2d(xd,"RecordTaskChangesFailed")}}}O2d(ec,Bc){const Vc={name:Kd.a.tGo,isInternal:!0};ec?this.oYa.logKpiFailure(Kd.a.Qke,Bc,Vc):this.oYa.logKpiFailure(Kd.a.Rke,Bc,Vc)}Hyd(ec,Bc){if(ec){var Vc=u.AFrameworkApplication.userName,xd=Bc.toString();ec.usersByReactionType||(ec.usersByReactionType={});var ee=ec.usersByReactionType[xd];Vc=new V(this.AY,this.b5a,Vc);Vc.DateUtc=new Date;ee?ee.push(Vc):ec.usersByReactionType[xd]=
[Vc];fa.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",Bc,ec.Df?"reply":"parent",ec.objectId);xd=[ec];this.eK.Mv(Dd.a.k1k,{succeeded:!0,customData:{reactionType:X[Bc]}});this.r3c(xd,W.addReaction);this.Hve.add(ec.id)}}Rce(ec,Bc){if(ec&&ec.usersByReactionType){var Vc=ec.usersByReactionType[Bc.toString()];if(Vc&&Vc.length){for(let xd=0;xd<Vc.length;xd++)if(Vc[xd].UserId===this.AY){Array.removeAt(Vc,xd);break}fa.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
Bc,ec.Df?"reply":"parent",ec.objectId);Vc=[ec];this.eK.Mv(Dd.a.l1k,{succeeded:!0,customData:{reactionType:X[Bc]}});this.Hve.delete(ec.id);this.r3c(Vc,W.removeReaction)}}}r3c(ec,Bc){const Vc=this.Gc.Oc(15);Vc.Cb(this.SIa);this.hx.hF.w7(3);switch(Bc){case W.deleteComment:for(Bc=0;Bc<ec.length;Bc++){var xd=ec[Bc];if(xd.Vq===n.a.beingCreated)this.ah.contentNavigationApiEnabled&&this.Yzc.remove(xd.iz.draftId),this.dJ.$lg();else{var ee=x.a.Ff(xd.objectId);(ee=this.od.Db(ee))&&Ic.a.ZHd(ee,this.od);fa.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${xd.objectId}]`);this.ah.nua&&this.vE&&(xd.Df?this.vE.fireEvent(10,{comment:xd,changeType:"replyDeleted"}):this.vE.fireEvent(7,{comment:xd}));this.ah.contentNavigationApiEnabled&&this.Yzc.remove(xd.id)}}break;case W.addComment:this.Xi.mode=1;ec=ec[0];ec.date=new Date;Bc=this.mbl(ec);xd=Bc.getValue(vc.a.XE).toString();ec.X_a=xd;this.ah.cgb&&this.dsc.set(xd,ec.id);xd=ec.text;ee=this.dOd();if(ec.Df){var Me=this.LD(ec.Df),De=this.od.Db(x.a.Ff(Me.objectId));
Bc.setValue(vc.a.iM,De.getValue(vc.a.zH));this.addReply(Bc,xd,this.od,ee,De);fa.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${ec.objectId}][ParentObjectId:${Me.objectId}]`)}else(Me=this.lb.gb.kb)&&Me.Oa&&(Xa.SelectionEditor.km(Me)&&(De=Xa.SelectionEditor.F3(Me.Oa,!1))&&(this.lb.setSelection(De),Me=De,fa.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Ra.ParagraphReader.Vb(Me.Oa.node)&&Ra.ParagraphReader.Vb(Me.Pc.node)&&(this.Xyb(Bc,xd,ee,Me),fa.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${ec.objectId}]`)));xd=Bc.ia(vc.a.zH,null);ec.nPa=xd;ec.LSa=N.a.sentToServer;ec.LSa=N.a.succeeded;ec.objectId=Bc.id.toString();this.q3f(ec);this.hJj(ec);this.fnh(ec.X_a,ec.nPa);this.ah.nua&&this.vE&&(ec.Df?this.vE.fireEvent(10,{comment:ec,changeType:"replyAdded"}):this.vE.fireEvent(11,{comment:ec}));break;case W.editComment:this.Xi.mode=1;ec=ec[0];Bc=x.a.Ff(ec.objectId);Bc=this.od.Db(Bc);xd=ec.nPa;ec.nPa||(xd=Bc.getValue(vc.a.zH),fa.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${ec.objectId} while editing`),xd=this.ah.cgb?xd:ec.id);this.tEj(Bc,ec.text,xd);fa.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${ec.objectId}]`);ec.LSa=N.a.sentToServer;ec.LSa=N.a.succeeded;this.ah.nua&&this.vE&&this.vE.fireEvent(10,{comment:ec,changeType:ec.Df?"replyEdited":"edited"});break;case W.addReaction:case W.removeReaction:Bc=ec[0];ec=x.a.Ff(Bc.objectId);ec=this.od.Db(ec);(Bc=(Bc=Bc.usersByReactionType)?Gb.c(Bc):"")&&ec.setValue(vc.a.F7,
Bc);break;case W.done:case W.undone:for(Bc=0;Bc<ec.length;Bc++)xd=ec[Bc],ee=x.a.Ff(xd.objectId),this.od.Db(ee).setValue(vc.a.Waa,xd.done),fa.ULS.sendTraceTag(594124932,327,50,`${xd.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${xd.objectId}]`),this.ah.nua&&this.vE&&this.vE.fireEvent(10,{comment:xd,changeType:xd.done?"resolved":"reopened"})}this.Jm.iF();fa.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");Vc.dispose()}dOd(){const ec=new Ga.GraphIterator;
ec.set(this.hx);this.UCa.o4a(ec);return ec}d6c(){return this.xhj(!0)}e6c(){return this.xhj(!1)}xhj(ec){if(!this.$g.length)return null;let Bc=this.Sy;do{if(Bc){const Vc=this.ah.Wq&&!this.Yi.$m;Bc=ec?this.$Vl(Bc,Vc):this.aWl(Bc,Vc)}else Bc=ec?this.$g[0]:this.$g[this.$g.length-1];if(!Bc)return null}while(Bc.Df&&""!==Bc.Df);this.selectComment(Bc);return Bc}nKh(ec,Bc,Vc,xd,ee){const Me=this.aZj.create(1074135127);this.ah.removePersonalInformation&&(Bc=CommonUIStrings.l_RemovedAuthorName,Vc=null);Me.setValue(vc.a.commentId,
U.a.tF());Me.setValue(vc.a.XE,Ic.a.qpf());Me.setValue(vc.a.uNa,u.AFrameworkApplication.userSessionId);Me.setValue(vc.a.zH,ec);Me.setValue(vc.a.N2b,Bc);Me.setValue(vc.a.XFh,Bc);Me.setValue(vc.a.RGc,Vc?Y.a.YMd(Vc,"MM/dd/yyyy HH:mm:ss",Y.a.dataCulture):"");Me.setValue(vc.a.SCa,Vc);Me.setValue(vc.a.Waa,xd);ee&&(ec=ee?Gb.c(ee):"",Me.setValue(vc.a.F7,ec));Me.setValue(vc.a.QGc,this.AY);Me.setValue(vc.a.qEd,this.b5a);return Me}mbl(ec){var Bc;const Vc=this.nKh(ec.id,ec.author,ec.date,ec.done,null!==(Bc=ec.usersByReactionType)&&
void 0!==Bc?Bc:{});ec.Df&&(this.ah.cgb?((Bc=this.yfd.LXl(ec.Df))||fa.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${ec.Df}`),ec=Bc):ec=ec.Df,Vc.setValue(vc.a.iM,ec));return Vc}addReply(ec,Bc,Vc,xd,ee){this.addComment(ec,Bc,xd);Bc=zg.uoh(ec,Vc,ee,!0);Vc=zg.uoh(ec,Vc,ee,!1);Bc&&Sc.v(ec,Bc.Ib.paragraph.id);Vc&&(Sc.u(ec,Vc.Ib.paragraph.id),Vc.Ib.paragraph.id||fa.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}Xyb(ec,Bc,Vc,xd){this.addComment(ec,Bc,
Vc);let ee,Me;({start:Bc,end:ee,startCp:Vc,endCp:Me,juh:De}=this.LPk());De&&(xd.Oa.node===Bc&&(Vc=Db.a.mhb(xd,!0)),xd.Pc.node===ee&&(Me=Db.a.mhb(xd,!1)));if(-1===Vc||-1===Me){this.QZg||0!==this.lUb||(this.eK.logKpiFailure(Id.a.v8e,"DraftSelectionLost",{isInternal:!0},{name:Id.a.P2b,isInternal:!0}),this.QZg=!0);Bc=xd.Oa.node;Vc=Db.a.mhb(xd,!0);ee=xd.Pc.node;Me=Db.a.mhb(xd,!1);if(2<xd.length){var De=[];for(let oe=0;oe<xd.length;oe++)De.push(xd.J(oe).node.id);this.Ynh(ec,De)}fa.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.lUb)}else if(2<this.oZ.length){De=[];for(xd=0;xd<this.oZ.length;xd++)De.push(this.oZ[xd].vfc);this.Ynh(ec,De)}Ic.a.X_b(Bc,ec.id,Vc,!0);Ic.a.X_b(ee,ec.id,Me,!1);Sc.v(ec,Bc.id);Sc.u(ec,ee.id);this.kDj();ee.id||fa.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}Ynh(ec,Bc){if(!(2>=Bc.length||!ec||Sc.s(ec))){this.Yi.KU.add(ec.id,new Ab.a(new dc.a));for(var Vc=x.a.Zp(Bc[0],Bc[1])?2:1,xd=Bc.length-2;Vc<=xd;Vc++){const ee=Bc[Vc];this.Yi.Ox.nb(ee)?
this.Yi.Ox.J(ee).NM||(this.Yi.Ox.J(ee).NM=new Ab.a(new dc.a)):this.Yi.Ox.add(ee,new uc.a(!0));this.Yi.Ox.J(ee).P1a=!0;this.Yi.Ox.J(ee).NM.add(ec.id);this.Yi.KU.J(ec.id).add(ee)}}}LPk(){let ec=null,Bc=-1,Vc=null;var xd=-1;let ee=!1;if(!this.oZ.length||2!==this.lUb)return{start:ec,end:Vc,startCp:Bc,endCp:xd,juh:ee};ec=this.od.Db(this.oZ[0].vfc);Vc=1===this.oZ.length?ec:this.od.Db(this.oZ[this.oZ.length-1].vfc);if(Ra.ParagraphReader.Vb(ec)&&Ra.ParagraphReader.Vb(Vc)){xd=De=>3===De.type;let Me=this.Fm.$Oa(ec,
3,xd);Bc=0<Me.count?Me.J(0).begin:-1;ec!==Vc&&(Me=this.Fm.$Oa(Vc,3,xd));xd=0<Me.count?Me.J(0).end:-1;-1===Bc&&null!=ec&&(Bc=ec.pa.first.cp,ee=!0,fa.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===xd&&null!=Vc&&(xd=Vc.pa.last.cp,ee=!0,fa.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.lUb=-1===Bc||-1===xd?0:2;return{start:ec,end:Vc,startCp:Bc,endCp:xd,juh:ee}}kDj(){for(const ec of this.oZ){const Bc=this.od.Db(ec.vfc);Ra.ParagraphReader.Vb(Bc)&&
this.Fm.$Ta(Bc,3)}this.oZ=[];this.lUb=2}addComment(ec,Bc,Vc){ec.anchor||(Vc.Jf(ec,1),Vc.Fi(ec),this.Ojj(ec,Bc,Vc))}Ojj(ec,Bc,Vc){let xd=0;var ee=null;Bc=this.hqc.jJo(Bc,Me=>{const De=new Pb.a;Vc.Jf(De,1);Vc.Fi(De);Vc.Jf(Me,2);Vc.Fi(Me);Vc.sc();Vc.sc()});for(let Me=0;Me<Bc.length;Me++)ee=Bc[Me],xd=ee.getValue(vc.a.Lc),zg.paragraphEditor.hUa(ee),zg.dK&&zg.dK.dNa&&zg.dK.sHa(Bb.a.create(ee));ec.setValue(vc.a.zH,xd.toString());return ee}ojb(ec,Bc){return this.TEm(ec,Bc)}npm(){return 0<this.oZ.length}nBb(ec,
Bc,Vc){return ec.Oa&&Ra.ParagraphReader.Vb(ec.Oa.node)&&Ra.ParagraphReader.Vb(ec.Pc.node)?(Bc=this.nKh(Ra.ParagraphReader.RQ(ec.Pc.node).toString(),Bc?Bc:u.AFrameworkApplication.userName,new Date,!1,{}),Vc||(Vc=new F.a,Vc.aha("\n")),this.Xyb(Bc,[Vc.LNc()],this.dOd(),ec),Bc):null}hs(ec){return!this.kXe.idg(this.wNc(ec.getValue(vc.a.XE)))}tEj(ec,Bc,Vc){const xd=new Ga.GraphIterator;for(xd.set(ec);xd.Qd();)xd.Cg();this.Ojj(ec,Bc,xd).Zg(vc.a.Lc,Number.parseInvariant(Vc));ec.setValue(vc.a.zH,Vc);if(Bc=
this.x_(ec.id.toString()))Bc.OHh=!1;ec.setValue(vc.a.pib,!1)}sEj(ec,Bc){this.tEj(ec,[Sys.Serialization.JavaScriptSerializer.serialize(Bc)],ec.getValue(vc.a.zH))}DG(ec){ec=this.od.Db(x.a.Ff(ec));return!!ec&&ec.ia(vc.a.DG,!1)}W0i(ec){ec=this.od.Db(x.a.Ff(ec));return!!ec&&ec.ia(vc.a.wHh,!1)}GGm(ec){const Bc=Sc.j();return ec&&Bc.has(ec.objectId)}QMm(ec){const Bc=this.od.Db(x.a.Ff(ec));return Bc?this.Lac(Bc):(fa.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+ec),!1)}Lac(ec){var Bc=
ec.id,Vc=Sc.k(ec),xd=Sc.h(ec);if(!x.a.Zp(Vc,xd))return!1;Vc=ec.Jc.Db(Vc);if(!Vc)return!1;xd=({gGc:ec}=this.QHc(Vc,Bc,!0)).returnValue;var ee=({gGc:Bc}=this.QHc(Vc,Bc,!1)).returnValue;if(-1===xd||-1===ee)return!1;Vc=Vc.pa;xd=Vc.J(ec);ee=Vc.J(Bc);if(!xd.hyperlink||!xd.hyperlink.CG||!ee.Pm)return!1;for(ec+=1;ec<Bc;ec++)if(xd=Vc.J(ec),xd.hyperlink||xd.Pm)return!1;return!0}zQc(){return zg.xpm(this.$g,ec=>this.DG(ec),ec=>this.W0i(ec))}QHc(ec,Bc,Vc){let xd;for(xd=0;xd<ec.pa.length;xd++){const ee=ec.pa.J(xd);
if(ee.tf)for(let Me=0;Me<ee.tf.length;Me++){const De=ee.tf.J(Me);if(De.Xj.equals(Bc)&&De.Mc===Vc)return{returnValue:ee.cp,gGc:xd}}}return{returnValue:-1,gGc:xd}}XPh(ec){if(this.Yi.KU.nb(ec)){const Bc=new Wa.a;for(const Vc of this.Yi.KU.J(ec))this.sYn(Vc,ec,Bc);this.Yi.KU.remove(ec);Sa.b(Bc)}}Cne(ec,Bc){if(ec.objectId){ec=x.a.Ff(ec.objectId);var Vc=this.od.Db(ec);if(Vc){var xd=Sc.k(Vc,x.a.nil);Vc=Sc.h(Vc,x.a.nil);xd.equals(x.a.nil)||Bc.add(this.od.Db(xd));Vc.equals(x.a.nil)||Bc.add(this.od.Db(Vc));
if(this.Yi.KU.nb(ec))for(const ee of this.Yi.KU.J(ec))Bc.add(this.od.Db(ee))}}}sYn(ec,Bc,Vc){let xd;({value:xd}=this.Yi.Ox.Dc(ec,xd));xd&&(xd.NM.remove(Bc),xd.NM.count||(xd.P1a=!1,Vc.add(this.od.Db(ec))))}static get paragraphEditor(){return null!=zg.aFg?zg.aFg:zg.aFg=y.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return zg.Rl()}static Rl(){if(zg._instance)return zg._instance;const ec=new ca.a(()=>(new fb(!0,!0,!0)).T8k()),Bc=y.a.instance;zg._instance=new zg(new ca.a(()=>wb.App.xa.hb.Uc),
new ca.a(()=>wb.App.xa.hb.rc.Yc),new ca.a(()=>Ed.a.instance),new Ub.a,new kc,new ca.a(()=>zb.a.instance),Bc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),Bc.resolve("WordEditor.Comments.ICommentFormatTranslator"),Bc.resolve("Common.IAppSettingsManager"),Bc.resolve("Box4.IFeatureHelper"),Bc.resolve("Box4.Intent.IIntentRangeEditor"),new ca.a(()=>wb.App.lV),Bc.resolve("Box4.IKickoutExecutor"),Bc.Ue("WordEditor.Tasks.ITaskActor"),ec,Bc.resolve("WordEditor.Comments.CommentsSettings"),
Bc.resolve("Box4.IUndoManager"),Bc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),Bc.resolve("WordEditor.Comments.CommentsState"),Bc.resolve("WordEditor.Comments.WordCommentEventsActor"),Bc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Bc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),Bc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),wb.App.Tj.zl.Ye(12),Bc.resolve("Box4.ParagraphRenderEvents"),Bc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
Bc.Sa("WordEditor.Extension.RichApiEventManager"));return zg._instance}static uoh(ec,Bc,Vc,xd){Bc=Ic.a.yba(Vc,Bc,xd);if(!Bc)return null;Bc=Bc.Ib.tf;return Ic.a.Gyd(ec.id,Bc,Bc.J(0).$u,xd)}TEm(ec,Bc){if(wb.App.lostSession||(Bc?!wb.App.hs:!wb.App.hs&&!wb.App.vm)||1===ec.mode||!Object(jb.a)(Mb.PageView,rb.InteractiveViewManager.instance.Bd))return!1;ec=this.LLl();return!ec||Yb.a.instance.j_(ec)||Yb.a.instance.nha(ec)||ec.contextId===Ya.a.anchoredObject||Ob.a.gDf(ec)&&Ob.a.kac()?!1:!0}LLl(){const ec=
rb.InteractiveViewManager.instance.Bd;var Bc=ec.lb.tg;this.IGm()&&this.oy&&sb.n(Bc.node)&&(Bc=Ga.GraphIterator.$a(Bc.node),Bc.zb(12),Bc=Bc.Xn(12),Bc=nb.SelectionFactory.zma(Bc),ec.lb.setSelection(Bc),Bc=ec.lb.tg);return Bc}IGm(){var ec;return null===(ec=this.Ma)||void 0===ec?void 0:ec.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static xpm(ec,Bc,Vc){const xd=new Wa.a,ee=new Wa.a,Me=new mc.a,De=new mc.a;for(const Qe of ec){var oe=Qe.id,nf=Qe.objectId;ec=Qe.done;
const of=!!nf&&Bc(nf);oe&&(ec&&xd.add(oe),of&&ee.add(oe),nf&&Me.Z(oe,nf));if(oe=Qe.Df)({value:nf}=De.Dc(oe,0)).returnValue||(nf=0),De.Z(oe,nf+1);if(!oe&&!ec&&!of)return!0}for(const Qe of ee){if(xd.contains(Qe))continue;let of;if(({value:of}=Me.Dc(Qe,of)).returnValue&&Vc(of))return!0;let mf;if(({value:mf}=De.Dc(Qe,0)).returnValue&&0<mf)return!0}return!1}VPl(ec){const Bc=[];let Vc=this.$g.findIndex(xd=>xd.id===ec);if(-1<Vc)for(Bc.push(this.$g[Vc]);++Vc<this.$g.length&&this.$g[Vc].Df===ec;)Bc.push(this.$g[Vc]);
return Bc}lUl(ec){return this.yfd.A7h(ec)}}zg._instance=null;zg.dK=null;Object(l.a)(zg,"EditorCommentModel",f.a,[363,364,365])},1755:function(E,K,c){E=c(0);var l=c(397),f=c(135),a=c(44),k=c(303),x=c(3),y=c(7),n=c(16),u=c(1619),z=c(1576);class w{constructor(aa,fa,pa=!1){this.paragraphNode=aa;this.role=fa;this.btj=pa}}Object(E.a)(w,"DesignerReviewActionData",null,[]);class F{constructor(aa,fa,pa){this.paragraphNode=aa;this.Fq=fa;this.role=pa}}Object(E.a)(F,"TriageActionData",null,[]);class G extends F{constructor(aa,
fa){super(aa,0,fa)}}Object(E.a)(G,"RoleTriageActionData",F,[]);class H extends F{constructor(aa,fa,pa){super(aa,1,27);this.styleId=fa;this.lX=pa}}Object(E.a)(H,"PullQuoteTriageActionData",F,[]);class L extends F{constructor(aa,fa){super(aa,2,28);this.$na=fa}}Object(E.a)(L,"ImageTriageActionData",F,[]);class I{constructor(aa,fa){this.paragraphNode=aa;this.hIb=fa}}Object(E.a)(I,"ViewOriginalActionData",null,[]);var N=c(134),P=c(1518),M=c(1691);class J{constructor(aa,fa){this.currentNode=aa;this.nextNode=
fa}}Object(E.a)(J,"ReviewNavigationArgs",null,[]);class V{constructor(aa,fa){this.paragraphNode=aa;this.isVisible=fa}}Object(E.a)(V,"ReviewVisibilityArgs",null,[]);class X{constructor(aa){this.Lhk=aa}getSelectedOption(){return this.Lhk}getSeparatorIndexes(){return[1]}}Object(E.a)(X,"DesignerPreviewData",null,[]);var W=c(501),U=c(936),Y=c(1692);c.d(K,"a",function(){return ca});class ca extends U.a{constructor(aa,fa,pa,ra,la,qa,La,Pa,Ka,Na,sa,wa){super();this.oc=aa;this.Ud=fa;this.oId=pa;this.swa=ra;
this.zk=la;this.TB=qa;this.AAj=La;this.Vl=Pa;this.Fv=Ka;this.pId=Na;this.ps=sa;this.gmf=wa;this.Rcb=null;this.jed=void 0;this.gwe=0;this.rH=[W.a.sQh]}get types(){return this.rH}get Nhj(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get H$d(){return 0}Oso(aa){return 3!==aa.suggestion.Fq&&!this.Fv.isVisible&&(!this.gwe||!aa.szb&&1===this.gwe)}kN(aa){var fa;if(!aa.source||l.SessionStatusManager.instance.Aj)return!1;const pa=aa.ll;var ra=this.swa.uOc(pa,1);if(!ra||!ra.count)return!1;
const la=ra.J(0).intent;if(aa.Ujc)return.5!=(null===la||void 0===la?void 0:la.state)&&4!=(null===la||void 0===la?void 0:la.state);const qa=pa.node;if(0==(null===la||void 0===la?void 0:la.state)&&(2==(null===la||void 0===la?void 0:la.suggestion.Fq)||1==(null===la||void 0===la?void 0:la.suggestion.Fq)))return la.szb(),this.swa.$Ta(qa,1),this.TB.y5i(new M.a(qa,1)),!0;if(1==aa.source&&27==(null===la||void 0===la?void 0:la.Sib)&&(.5==(null===la||void 0===la?void 0:la.state)||4==(null===la||void 0===la?
void 0:la.state)))return!1;ra=this.Fv.isVisible?this.oId.tll(qa):new Y.a(0,1);let La;const Pa=this.m_l(null===(fa=null===la||void 0===la?void 0:la.suggestion)||void 0===fa?void 0:fa.Fq);fa=this.Uj.uqa(pa,{id:"Intent-"+W.a.sQh,suggestionGroups:[{type:Pa,id:Pa,title:la.description,snippet:this.vFn(this.zk.plainText(pa.node)),snippetFormatting:[],supportedActions:this.Tnf(null===la||void 0===la?void 0:la.suggestion,!0),suggestions:({Hbo:La}=this.ZMh(qa)).returnValue,previewData:La?new X(La):null,isContentPending:!1}],
setSize:ra.count,positionInSet:ra.index},this,aa.BQa,!1,()=>{var Ka;this.TB.z5i(new V(qa,!0));this.Fv.isVisible||3===(null===(Ka=null===la||void 0===la?void 0:la.suggestion)||void 0===Ka?void 0:Ka.Fq)||this.gwe++},()=>{this.TB.z5i(new V(qa,!1))},null,!1,Ka=>{Ka.showDesignerButton=!this.Fv.isVisible;Ka.shouldSkipTwoStepReview=!0;Ka.isFormattingSuggestion=0==la.suggestion.Fq;Ka.isMultiParagraphSuggestion=1<la.aO.length;Ka.proactivePromptHintType=this.Oso(la)?k.e.HideFromReviewCardAndRibbon:k.e.None});
a.c(n.a.Avn,fa,void 0,void 0,30);return fa}executeAction(aa,fa){var pa,ra,la,qa,La;if(!aa||!fa)return!1;const Pa=this.Vl.uA(fa);y.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",aa.actionType,null===Pa||void 0===Pa?void 0:Pa.role,this.Fv.isVisible);const Ka=this.pId.fU(fa);try{switch(aa.actionType){case k.b.Accepted:const Na=this.oc.Qb(n.a.cyd,2,new w(fa,null===Pa||void 0===Pa?void 0:Pa.role,!0));this.pmg(Ja=>{Ja.supportedActions=this.Tnf(null===Ka||void 0===Ka?void 0:Ka.suggestion,
!1)});return this.Fv.isVisible&&32===Na?this.$Pf(fa):32===Na;case k.b.Rejected:const sa=this.oc.Qb(n.a.Ece,2,new w(fa,null===Pa||void 0===Pa?void 0:Pa.role,!0));2===(null===Ka||void 0===Ka?void 0:Ka.suggestion.Fq)||Object(P.e)(null===Ka||void 0===Ka?void 0:Ka.suggestion)||this.Lad(fa,!1);2===(null===Ka||void 0===Ka?void 0:Ka.suggestion.Fq)&&this.Uj.dismiss();return this.Fv.isVisible&&32===sa?this.$Pf(fa):32===sa;case k.b.Next:case k.b.Previous:return!this.Fv.isVisible||this.$Pf(fa,aa.actionType===
k.b.Previous);case k.b.Apply:const wa=null===(pa=aa.suggestion)||void 0===pa?void 0:pa.contentData;let ja;switch(null===wa||void 0===wa?void 0:wa.Fq){case 0:ja=new G(fa,wa.role);break;case 1:case 3:const Ja=wa.i5a;y.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(ra=null===Ka||void 0===Ka?void 0:Ka.suggestion)||void 0===ra?void 0:ra.id,["newStyleId"]:Ja});Ka.suggestion.i5a=Ja;ja=new H(fa,Ja,f.a.create());break;case 2:ja=new L(fa,wa.$na);break;default:return y.ULS.shipAssertTag(527459665,
3016,!1,String.format("DesignerSuggestionType: {0}",wa.Fq)),!1}this.Uj.focus();const ha=this.oc.Qb(n.a.changeDesignerRole,2,ja);this.Lad(fa,!1);return 32===ha;case k.b.AcceptAll:return 32===this.oc.Qb(x.a.jdb,2,new u.a(2));case k.b.RejectAll:return 32===this.oc.processAction(n.a.N3c,2);case k.b.SnoozeAll:return 32===this.oc.processAction(n.a.designerSnoozeContextualSuggestions,2);case k.b.Undo:const va=this.oc.Qb(n.a.yIa,2,new w(fa,null===Pa||void 0===Pa?void 0:Pa.role));this.Lad(fa,!0);return 32===
va;case k.b.OpenDesignerPane:return 32===this.oc.Qb(n.a.fIa,2,new z.a(6));case k.b.ViewOriginal:const xa={hIb:aa.descriptorData.isViewingOriginal,Dag:aa.descriptorData.setIsViewingOriginal};if(void 0==(null===xa||void 0===xa?void 0:xa.hIb)||void 0==(null===xa||void 0===xa?void 0:xa.Dag))return y.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===xa||void 0===xa?void 0:xa.hIb,null===xa||void 0===xa?void 0:xa.Dag)),!1;this.Uj.focus();const ma=
this.oc.Qb(n.a.Sdf,2,new I(fa,xa.hIb));xa.Dag(!xa.hIb);this.Lad(fa,!0);return 32===ma;case k.b.GiveFeedback:switch(null===(la=null===Ka||void 0===Ka?void 0:Ka.suggestion)||void 0===la?void 0:la.Fq){case 0:return this.ps.invokeUserFeedback(N.a.iTj),!0;case 1:case 3:return this.ps.invokeUserFeedback(N.a.oTj),!0;case 2:return this.ps.invokeUserFeedback(N.a.kTj),!0;default:return y.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(qa=null===Ka||void 0===Ka?void 0:
Ka.suggestion)||void 0===qa?void 0:qa.Fq)),!1}case k.b.ShowMore:switch(null===(La=null===Ka||void 0===Ka?void 0:Ka.suggestion)||void 0===La?void 0:La.Fq){case 2:y.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Ka.suggestion.Evm(),this.Lad(fa,!0,!0)}return!0;default:return!1}}catch(Na){return y.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",Na.message,Na.stack)),!1}}$Pf(aa,fa=!1){const pa=this.oId.Q7b(aa,fa)||this.oId.Q7b(aa,!fa);this.TB.fNn(new J(aa,pa,!fa));return!pa||
this.oId.xPi(this,pa)}hXl(aa){switch(aa.Fq){case 0:case 1:case 3:return{...k.h,font:aa.font,cssColor:aa.color,fontSize:aa.fontSize,fontWeight:aa.bold?k.d.Bold:k.d.Normal,italic:aa.italic,underlineType:aa.underline?k.f.Single:k.f.None,backgroundImg:aa.backgroundImg};case 2:break;default:y.ULS.shipAssertTag(527569927,3016,!1,`${aa.Fq}`)}}iZl(aa){if(2===aa.Fq)return{src:aa.imageUrl,width:0,height:0,imageAltText:aa.altText}}ZMh(aa){var fa=null;let pa=null;if(this.Rcb=this.AAj.c5l(aa)){pa=Array(this.Rcb.options.length);
for(aa=0;aa<this.Rcb.options.length;aa++)fa=this.Rcb.options[aa],pa[aa]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",aa),title:fa.title,supportedActions:[k.b.Apply],contentData:fa,image:this.iZl(fa),titleFormatting:[this.hXl(fa)]};fa=(null===pa||void 0===pa?0:pa.length)?pa[this.Rcb.selectedIndex]:void 0}return{returnValue:pa,Hbo:fa}}pmg(aa){this.Uj.definition?this.Uj.definition.suggestionGroups?1===this.Uj.definition.suggestionGroups.length&&(aa(this.Uj.definition.suggestionGroups[0]),
this.Uj.definition=this.Uj.definition):y.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):y.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}Lad(aa,fa,pa=!1){const ra=this.pId.fU(aa);this.pmg(la=>{la.supportedActions=this.Tnf(null===ra||void 0===ra?void 0:ra.suggestion,fa);if(this.Rcb){if(pa){var qa=this.ZMh(aa).returnValue;la.suggestions=qa}qa=this.AAj.Kam(this.Rcb.options,aa);la.previewData=new X(la.suggestions[qa])}})}Tnf(aa,fa){const pa=[];fa?
(pa.push(k.b.Accepted),pa.push(k.b.Rejected),0==(null===aa||void 0===aa?void 0:aa.Fq)&&pa.push(k.b.ViewOriginal)):(pa.push(k.b.Next),pa.push(k.b.Undo));this.Fv.isVisible||(this.Ud.nHm()&&this.ZFk(ra=>{ra&&this.pmg(la=>la.supportedActions.push(k.b.GiveFeedback))})&&pa.push(k.b.GiveFeedback),this.Ud.aIm()&&pa.push(k.b.OpenDesignerPane),pa.push(k.b.SnoozeAll));0===(null===aa||void 0===aa?void 0:aa.Fq)&&pa.push(k.b.AcceptAll);pa.push(k.b.RejectAll);(null===aa||void 0===aa?0:aa.gmi())&&pa.push(k.b.ShowMore);
return pa}vFn(aa){const fa=aa.split(" ",10);return 10>fa.length?aa:fa.join(" ")+"\u2026"}static gIm(aa){return aa===W.a.tQh||aa===W.a.uQh||aa===W.a.yQh}m_l(aa){return 2===aa?W.a.uQh:1===aa||3===aa?W.a.yQh:W.a.tQh}ZFk(aa){void 0===this.jed&&this.gmf.execute(async fa=>{this.jed=await fa.isFeatureEnabled(N.a.lPi,!1);aa(this.jed)});return!!this.jed}}Object(E.a)(ca,"DesignerIntentProvider",U.a,[])},1763:function(E,K,c){E=c(0);var l=c(2),f=c(2039),a=c(397),k=c(179),x=c(80),y=c(311),n=c(9),u=c(590),z=c(7),
w=c(568),F=c(1712);class G{constructor(X,W){this.ahk=X;this.bhk=W}}Object(E.a)(G,"LastSavedToHostDetailsEventArgs",null,[891]);class H{constructor(X,W,U,Y,ca,aa){this.dmk=5E4;this.LUe=0;this.Qab=new Date(Date.UTC(0,1,1,0,0));this.s_j=6E4;this.BYb=this.AWb=0;this.ra=new x.a;this.ndo=()=>{z.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.BYb++);this.$e.Ao||this.y6b().then(fa=>{this.ra.raiseEvent(H.rEi,fa);this.S3g=new Date;fa=this.DZb;this.il&&!this.il.isVisible&&
(fa=this.Akk);this.fza(fa)}).catch(fa=>{this.fza(this.rfm(fa))})};this.Eud=X;this.$e=U;this.w2=ca;this.yv=aa;this.DZb=W.mc("LastSavedToHostDetailsIntervalMs",6E4);this.htb=W.mc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.Akk=W.mc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.DZb);this.iRe=W.mc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.S3g=new Date;Y.execute(fa=>{this.il=fa;this.il.ZYa((pa,ra)=>{this.IX(ra)})});0==l.AFrameworkApplication.Kg.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Kg.hMi();
this.fza(this.DZb)}IX(X){0!==X.newState&&1!==X.newState||0===X.oldState||1===X.oldState||this.$e.Ao||(this.fza(this.LUe),z.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.S3g,this.LUe))}gQa(){return this.xro?1==this.$e.networkState:1==this.$e.networkState||3==this.$e.networkState}y6b(){this.Qab=new Date;return new Promise((X,W)=>{if(this.gQa())z.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),
W(0);else if(this.$e.cca)z.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),W(2);else if(this.yv.fR)z.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),W(3);else{var U=u.b(F.a.construct(this.G8b()));z.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");var Y=0;Y=this.Eud.tj(H.serviceUrl,2,U,{"Content-Type":"application/json; charset=utf-8"},!1,0,ca=>this.OWm(ca,X,W),ca=>this.PWm(ca,
W),null,null,!0,this.iRe);0>=Y&&(z.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Y.toString()),W(0))}})}PWm(X,W){let U=2;if(X=X.data){if(5===X.status)U=1;else if(7===X.status||13===X.status)U=this.dqo?0:1;z.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",X.status))}else z.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");W(U)}OWm(X,W,U){if(X=X.data){var Y={},ca=X.wj?X.wj[y.a.L7]:"";
Y.HttpStatus=X.Qe;Y.Correlation=ca;Y.Id=X.id;z.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Y);(X=this.Rua(X.we))?(this.w2.dUa(X),W(new G(X.LastSavedRevisionId,X.RevisionSequenceNumber))):(z.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),U(2))}else z.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),U(2)}fza(X){0!==this.AWb&&window.clearTimeout(this.AWb);this.AWb=window.setTimeout(this.ndo,X);z.ULS.sendTraceTag(525100416,
3037,50,"LastSavedToHostDetails request queued with timeout "+X)}G8b(){const X=n.App.xa.hb.rc;return X?X.Yc:null}rfm(X){return 1===X?this.LUe:0===X?this.dmk:3===X?this.DZb:this.htb}Rua(X){let W;return({group:W}=w.a.l1(X)).returnValue?W.Responses[0]:null}Iyk(X){this.ra.addHandler(H.rEi,X)}async i1h(){const X=new Promise((W,U)=>{window.setTimeout(U,3E3)});await Promise.race([X,this.y6b()]).then(()=>{z.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{z.ULS.sendTraceTag(509100304,
3038,15,"LSTHDM ran Synchronously: Failure")})}dvj(){0!==this.AWb&&(z.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.AWb),this.AWb=0)}puj(X){z.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",X);this.fza(X)}get rcc(){return this.Qab.getTime()}get LNh(){return this.s_j}sA(){const X={};X.LastScanTime=this.Qab.toISOString();X.RunCounter=this.BYb;return X}get dqo(){return null!=this.cGg?this.cGg:this.cGg=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}get xro(){return null!=this.gGg?this.gGg:this.gGg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotCheckAppNetworkStatusTimeout",!1):!1}}H.rEi="ULSTHD";H.serviceUrl=n.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(E.a)(H,"LastSavedToHostDetailsManager",null,[863,862]);var L=c(251),I=c(2070),N=c(12),
P=c(16);class M{constructor(X,W,U){this.eqm=X;this.pya=W;this.NWm=U;this.tYf=()=>{const Y=this.eqm();return 32!==Y?Y:!this.pya||this.pya.fR?32:8};this.rVo=(Y,ca,aa,fa,pa)=>{this.NWm.fza(parseInt(pa.toString()));return 32}}Tb(X){X.qa(P.a.tYf,N.a.view,this.tYf);X.qa(P.a.TEj,N.a.view,this.rVo);X.Vc(P.a.TEj,101)}}Object(E.a)(M,"LastSavedToHostDetailsManagerActor",null,[]);var J=c(219);c.d(K,"a",function(){return V});class V{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}xc(X){const W=
l.AFrameworkApplication.K;this.W=X;const U=new f.a(l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.Ne.SY,l.AFrameworkApplication.Ne.kPh);this.W.ha("WordEditor.ILastSavedToHostDetailsManager",()=>new H(U,W,this.W.Na("Common.ISessionStatus")||a.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),L.a.instance,this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).singleInstance();this.p4f()}init(){(new M(()=>J.WoncaApp.BF.mmi(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),
this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Tb(l.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){k.a.instance.Fc(new V)}p4f(){this.W.ha("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new I.a(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),l.AFrameworkApplication.K.mc("LastSavedToHostDetailsIntervalMs",6E4),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",
18E4))).singleInstance()}}Object(E.a)(V,"LastSavedToHostDetailsPackage",null,[1,2])},1764:function(E,K,c){E=c(0);var l=c(499),f=c(459),a=c(11),k=c(1472),x=c(2031),y=c(350),n=c(7),u=c(110),z=c(1529);class w{constructor(I,N,P){this.isVisible=I;this.elements=N;this.content=P}}Object(E.a)(w,"TooltipVisibilityArgs",null,[]);var F;(function(I){I[I.consistency=0]="consistency";I[I.Ujp=1]="pullQuote";I[I.rmp=2]="suggestedImage";I[I.Vjp=3]="pullQuoteMenu";I[I.ndp=4]="designerPaste"})(F||(F={}));Object(E.b)("DesignerSuggestionType",
F);var G=c(134),H=c(1693);c.d(K,"a",function(){return L});class L extends k.a{constructor(I,N,P,M,J,V,X,W){super();this.Om=I;this.Cu=N;this.CYk=P;this.tOi=M;this.zk=J;this.TB=V;this.ZH=X;this.rc=W;this.dua=this.JEa=null;this.onMouseEnter=U=>{U=U.Ro;this.TB.S5i(new w(!0,[U.YEc],U.XJo));if(U.Vr&&0<U.Vr.length){const Y=this.ZH.fU(U.Vr[0]);Y&&Y.suggestion.M2m()}return this.Tkj(U)};this.npa=U=>{this.TB.S5i(new w(!1));return this.IDh(U.Ro)};this.hGa=U=>{if(L.l3a(U.Ro,this.dua))return!0;this.TB.gNn(z.a.create(U.Ro.Vr[0]));
return!0};this.tVf=(U,Y)=>{Y.data?Y.data.isVisible?this.Lfo(Y.data.paragraphNode):this.lXk():n.ULS.shipAssertTag(573850384,3016,!1)};this.TB.i_e(this.tVf)}cio(I){I?(I=this.sqf(I))&&this.Tkj(I):n.ULS.shipAssertTag(589693324,3016,!1)}BXk(){this.IDh(this.JEa)}Hob(I){I=this.zk.kl(I.Bb);return!!I&&this.ZH.xVc(I)}bfb(I){const N=I.geb(0,G.a.gKk,this.zoom),P=[];P.push(this.gDa(I.M4,N,I.$mc[0].y-I.Vba[0].y));return P}gDa(I,N,P){var M,J=I.fh.ownerDocument;const V=l.a.createElement(J,f.a.div);V.className=G.a.bKk;
V.style.left=N+"px";V.style.top=P+"px";N=l.a.createElement(J,f.a.div);N.className=G.a.eKk;J=l.a.createElement(J,f.a.div);J.className=G.a.cKk;I=this.zk.kl(I.Bb);P=this.ZH.fU(I);if(null===(M=null===P||void 0===P?void 0:P.suggestion)||void 0===M?0:M.Fq)J.className+=String.format(" {0}",F[P.suggestion.Fq]);N.appendChild(J);V.appendChild(N);V.id=L.j4h(I);M=this.sqf(I,V);1==M.hKk&&(J.className+=String.format(" {0}",G.a.dKk));this.dua&&this.dua.Vr.includes(I)?(V.className+=String.format(" {0}",G.a.o3e),
this.dua=M):this.JEa&&this.JEa.Vr.includes(I)&&(V.className+=String.format(" {0}",G.a.n3e),this.JEa=M);this.tOi(a.a.rR,V,this.onMouseEnter,M);this.tOi(a.a.hL,V,this.npa,M);this.CYk(a.a.click,V,this.hGa,M);return V}Lfo(I){if(I){var N=this.sqf(I);N?(this.ZH.fU(I)&&(I=Object.assign(new x.a,{action:0,type:3,xA:N,JJ:this.dua}),this.Cu.yF(I)),this.dua=N,L.l3a(this.JEa,this.dua)&&(this.JEa=null)):n.ULS.shipAssertTag(590112344,3016,!1)}else n.ULS.shipAssertTag(590112343,3016,!1)}lXk(){if(this.dua){var I=
Object.assign(new x.a,{action:1,type:3,xA:null,JJ:this.dua});this.dua=null;this.Cu.yF(I)}}Tkj(I){if(L.l3a(I,this.dua)||L.l3a(I,this.JEa))return!0;const N=Object.assign(new x.a,{action:2,type:3,xA:I,JJ:this.JEa});this.JEa=I;this.Cu.yF(N);return!0}IDh(I){if(L.l3a(I,this.dua))return!0;I=Object.assign(new x.a,{action:3,type:3,xA:null,JJ:this.JEa});this.JEa=null;this.Cu.yF(I);return!0}sqf(I,N){N=N?N:this.eNl(I);if(!N)return null;const P=this.ZH.fU(I);return new H.a(0<(null===P||void 0===P?void 0:P.aO.length)?
null===P||void 0===P?void 0:P.aO:[I],N,L.bii(P),L.fNl(P))}static bii(I){if(!I)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;switch(I.suggestion.Fq){case 0:return L.xXd(I.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return L.xXd(I.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;
case 2:return L.xXd(I.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static fNl(I){return I?L.xXd(I.state)?1:0:0}static xXd(I){return 0!==I&&.1!==I}eNl(I){var N=null,P=this.Om.Wf(I);P.zb(11)&&(P.sc(),P=P.currentNode.Gj(this.rc.ic))&&(I=String.format("#{0}",L.j4h(I)),N=P.htmlElement.querySelector(I),!N&&Object(u.a)(y.a,
P)&&(N=(N=P.Xjf())?N.querySelector(I):null));return N}static j4h(I){return String.format("p{0}{1}",I.id.guid,I.id.n)}static l3a(I,N){return!!N&&!!I&&I.YEc===N.YEc}}Object(E.a)(L,"BlueDotActor",k.a,[711,712])},1766:function(E,K,c){E=c(0);var l=c(631);class f{constructor(k){this.cFa=k.p_l();this.wFb=k.kqf("intCopy");this.r9d=k.Uci("intCopy");this.wAb=k.Ynf("intCopy");this.Sdb=k.vnf("intCopy")}static cF(){return f.Jr()}static Jr(){return new f(l.a.instance)}}Object(E.a)(f,"InternalCopyUsageHelper",null,
[]);c.d(K,"a",function(){return a});class a{constructor(k,x,y){this.GW=f.cF();this.lDd=null;this.COb=this.Xne=!1;this.oUg=null;this.source=k;this.target=x;this.LXf=y}get Dja(){return this.GW}get Mo(){return this.oUg}set Mo(k){this.oUg=k}}Object(E.a)(a,"InternalCopyArguments",null,[])},1767:function(E,K,c){E=c(0);var l=c(1443);class f extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=
null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(E.a)(f,"ALocalCobaltServerResponse",l.a,[]);c.d(K,"a",function(){return a});class a extends f{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(E.a)(a,
"GetChangesResponse",f,[])},1768:function(E,K,c){E=c(0);var l=c(80);class f extends Sys.EventArgs{constructor(){super()}}Object(E.a)(f,"UploadEventArgs",Sys.EventArgs,[]);c.d(K,"a",function(){return a});class a{constructor(){this.ra=new l.a}ing(k){this.ra.raiseEvent("UploadStarted",new f(k,-1))}ymc(k,x){this.ra.raiseEvent("UploadComplete",new f(k,x))}static get instance(){return null!=a.mCg?a.mCg:a.mCg=new a}}Object(E.a)(a,"Box4UploadNotifier",null,[453])},1769:function(E,K,c){E=c(0);var l=c(2),f=
c(397),a=c(22),k=c(179),x=c(9),y=c(2070),n=c(219),u=c(725),z=c(51),w=c(7),F=c(2040),G=c(1402),H=c(83),L=c(119),I=c(500);class N{constructor(M,J,V,X,W,U,Y,ca){this.RV=null;this.Tyc=this.EZ=0;this.Qab=new Date(Date.UTC(0,1,1,0,0));this.Xv={};this.kAc=this.BYb=0;this.LCh=async()=>{var aa;w.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",this.BYb++);if(this.$e.Ao)this.V4c(),this.stop(),w.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",
this.yv.I7a);else{this.Qab=new Date;var fa={};fa.DocxSaveMonitor_IsUpToDate=null===(aa=this.RV)||void 0===aa?void 0:aa.fR;fa.RSNManager_IsUpToDate=this.yv.fR;fa.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.yv.t3b();fa.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.yv.cGd();w.ULS.sendTraceTag(521413850,3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",fa);if(this.il&&!this.il.isVisible)w.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",
this.yv.I7a),this.QEn();else if(aa=this.yv.u3b(this.jAc),0<aa){aa=this.M3h(aa);w.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(aa));this.Mll&&w.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.sA());if(0==this.EZ)this.Tyc=this.rcc;else if(1<this.EZ){w.ULS.sendTraceTag(524137233,3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.EZ,this.rcc-this.Tyc);if(this.hGm&&(!await this.yv.CUd(this.ipm)||0===this.yv.u3b(this.jAc))){this.V4c();return}this.ZLi(aa,this.rcc);
this.Xv.ShouldKickout&&(w.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.Xv)),aa=this.I_l(),fa=this.$Ml(aa),this.F6.XC(aa,fa))}this.EZ++}else this.V4c(),this.KVk()}};this.MCh=async()=>{await this.LCh();this.Pfg()};this.yv=M;this.$e=J;this.F6=Y;this.$hk=ca;this.rQe=X;this.jAc=W;this.whk=U;this.RV=a.a.instance.Na("Wonca.IDocxSaveMonitor");this.Xv.ShouldKickout=!1;this.S9d=this.DBn;this.QYf=this.EBn;V.execute(aa=>{this.il=aa});this.$e.NMa(this.tY.bind(this))}get rcc(){return this.Qab.getTime()}M3h(M){return{["NumberOfStaleRevisions"]:M,
["BrowserIsOnline"]:F.a[this.$e.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.$e.Ao,["IsSessionExpired"]:this.$e.cca,["IsSessionLost"]:this.$e.DUc,["HasEmergencyViewDeployed"]:this.$e.Aj,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),["VisibilityManager_AppVisibilityState"]:this.il?G.a[this.il.rC]:"undefined"}}tY(M,J){if(J){M=Date.now();var V=this.yv.u3b(this.jAc);0<V&&(V=this.M3h(V),this.ZLi(V,M));this.c9n();this.t3m(J.errorCode)}this.stop();
this.RV=a.a.instance.Na("Wonca.IDocxSaveMonitor")}KVk(){this.yv.NUd(this.whk)&&this.vRo()}vRo(){w.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.$hk.H5e();I.a.Alf(21)}$Ml(M){let J=new u.a;M==z.a.opg&&(J=Object.assign(new u.a,{zfa:4,XW:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,m3:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0}));return J}I_l(){return this.qRm?z.a.n4o:this.$e.cca?z.a.opg:z.a.m4o}stop(){0!==
this.kAc&&(window.clearInterval(this.kAc),this.kAc=0);w.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async i1h(){this.Uap&&this.stop();this.MCh();w.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}fBo(M){this.kAc=window.setTimeout(this.MCh,M);w.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.V4c()}Pfg(){this.kAc=window.setInterval(this.LCh,this.rQe);w.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.V4c()}c9n(){this.qpj?this.b2h(this.Xv):(this.Xv.shouldKickout||
(0==this.yv.u3b(this.jAc)?(this.Xv.NoKickoutReason="No Stale Revisions",this.Xv.OldestRevisionCreationTime=this.yv.ZDb()):this.il&&!this.il.isVisible?(this.Xv.NoKickoutReason="Session not active",this.Xv.VisibilityManager_AppVisibilityState=this.il.rC):this.QFf&&this.EZ<=this.QYf?(this.Xv.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",this.Xv.ScansWithPersistentRunawayDataLoss=this.EZ):this.EZ<=this.S9d?(this.Xv.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",
this.Xv.ScansWithPersistentRunawayDataLoss=this.EZ):this.Xv.NoKickoutReason="undefined",this.Xv.LastScanTime=this.Qab.toISOString(),this.Xv.RunCounter=this.BYb),w.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.Xv)))}get Cfj(){if(this.qpj){const M=Object.assign({},this.Xv);this.b2h(M);return M}return this.Xv}b2h(M){M.shouldKickout||(0==this.yv.u3b(this.jAc)?(M.NoKickoutReason="No Stale Revisions",M.OldestRevisionCreationTime=this.yv.ZDb()):this.il&&!this.il.isVisible?(M.NoKickoutReason="Session not active",
M.VisibilityManager_AppVisibilityState=this.il.rC):this.QFf&&this.EZ<=this.QYf?(M.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",M.ScansWithPersistentRunawayDataLoss=this.EZ):this.EZ<=this.S9d?(M.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",M.ScansWithPersistentRunawayDataLoss=this.EZ):M.NoKickoutReason="undefined");M.LastScanTime=this.Qab.toISOString();M.RunCounter=this.BYb}sA(){const M={};this.RV&&(M.DSM=this.RV.sA());this.yv&&
(M.RSN=this.yv.sA());return M}V4c(){w.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",this.EZ,this.Tyc);this.Tyc=this.EZ=0}QEn(){this.EZ=Math.min(this.S9d-1,this.EZ);this.Tyc=Date.now()}QFf(){return 0===this.il.rC&&this.$e.OH&&!this.$e.DUc&&!this.$e.cca&&!this.$e.Aj}ZLi(M,J){this.EZ>this.QYf&&this.QFf()?this.Xv.ShouldKickout||(this.Xv.ShouldKickout=!0,this.c2h("Persistent RunawayDataLoss detected in active session",
J,M)):this.EZ>this.S9d&&!this.Xv.ShouldKickout&&(this.Xv.ShouldKickout=!0,this.c2h("Runaway DataLoss persists for more than 3 minutes.",J,M))}c2h(M,J,V){this.Xv.KickoutTime=(new Date(J)).toISOString();this.Xv.KickoutReason=M;this.Xv.DSM_isUpToDate=this.RV?this.RV.fR:"Undefined";this.Xv.SessionInfo=V}t3m(M){const J=this.Xv.ShouldKickout;H.Health.instance.recordKpiUsage(N.nqe,1,N.sLd,null);const V=new Map;M&&V.set("ErrorCode",M.toString());J?(V.set("ShouldKickout","true"),V.set("KickoutTime",this.Xv.KickoutTime),
V.set("Reason",this.Xv.KickoutReason),H.Health.instance.recordKpiSuccess(N.nqe,Object.assign(new L.a,{extendedProperties:V}))):(V.set("ShouldKickout","false"),M=this.Xv.NoKickoutReason,V.set("Reason",M),H.Health.instance.recordKpiFailure(N.nqe,M,!1,!1,Object.assign(new L.a,{extendedProperties:V})))}dvj(){w.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}puj(M){w.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",M);this.CFf?this.fBo(M):
(this.rQe=M,this.Pfg())}get Mll(){return null!=this.Dxg?this.Dxg:this.Dxg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",!0)}get ipm(){return null!=this.oAg?this.oAg:this.oAg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get hGm(){return null!=this.FCg?this.FCg:this.FCg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",
!0)}get CFf(){return null!=this.ZCg?this.ZCg:this.ZCg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}get qpj(){return null!=this.dGg?this.dGg:this.dGg=l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldOnlyKickoutWhenVisible",!1)||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1))}get EBn(){return null!=
this.uFg?this.uFg:this.uFg=l.AFrameworkApplication.K.mc("RunawayDataLossMinimumScansBeforeKickout",1)}get DBn(){return null!=this.tFg?this.tFg:this.tFg=l.AFrameworkApplication.K.mc("RunawayDataLossMaximumScansBeforeKickout",5)}get qRm(){return 1===this.$e.networkState||3===this.$e.networkState}get LNh(){return this.rQe}}N.nqe="RunAwayDataLossKickout";N.sLd="wwrelfc";Object(E.a)(N,"RunawayDataLossMonitor",null,[861,862]);c.d(K,"a",function(){return P});class P{constructor(){this.cRg=3E4;this.Q_j=24E4;
this.R_j=12E4;this.W=this.rtd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(x.App.hs||x.App.vm)this.rtd=this.W.resolve(this.name),this.rtd.Pfg(),this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==l.AFrameworkApplication.Kg.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Kg.hMi()}Vcl(){return new N(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("Common.ISessionStatus")||f.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),
l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",this.cRg),this.r9n,this.R_j,a.a.instance.Na("Wonca.KickoutExecutor"),n.WoncaApp.BF)}xc(M){if(x.App.hs||x.App.vm)this.W=M,M.ha(this.name,this.Vcl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").singleInstance(),this.p4f()}dispose(){this.rtd&&this.rtd.stop()}static main(){k.a.instance.Fc(new P)}p4f(){this.W.ha("WordEditor.RunawayDataLossMonitorWatchDog",()=>new y.a(this.W.resolve(this.name),l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",
this.cRg),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",18E4))).singleInstance()}get r9n(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.s9n)}get s9n(){return l.AFrameworkApplication.K.mc("RunawayDataLossKickoutIntervalInMs",this.Q_j)}}Object(E.a)(P,"WordEditorRunawayDataLossMonitorPackage",null,[1,2])},1772:function(E,K,c){E=c(0);var l=c(31),f=c(1050);class a extends f.a{isUserPromptField(H){return new k(H)}annotationStatusField(H){return new x(H)}annotationCharCountField(H){return new y(H)}userPromptCharCountField(H){return new n(H)}precedingTextsCharCountField(H){return new u(H)}followingTextsCharCountField(H){return new z(H)}promptTriggerSourceField(H){return new w(H)}promptIdField(H){return new F(H)}}
Object(E.a)(a,"AiInserterDataFieldsFactoryImpl",f.a,[]);class k extends l.a{constructor(H){super();this.name="isUserPrompt";this.bool=H}}Object(E.a)(k,"IsUserPromptDataField",l.a,[]);class x extends l.a{constructor(H){super();this.name="annotationStatus";this.int64=H}}Object(E.a)(x,"AnnotationStatusDataField",l.a,[]);class y extends l.a{constructor(H){super();this.name="annotationCharCount";this.int64=H}}Object(E.a)(y,"AnnotationCharCountField",l.a,[]);class n extends l.a{constructor(H){super();this.name=
"userPromptCharCount";this.int64=H}}Object(E.a)(n,"UserPromptCharCountField",l.a,[]);class u extends l.a{constructor(H){super();this.name="precedingTextsCharCount";this.int64=H}}Object(E.a)(u,"PrecedingTextsCharCountField",l.a,[]);class z extends l.a{constructor(H){super();this.name="followingTextsCharCount";this.int64=H}}Object(E.a)(z,"FollowingTextsCharCountField",l.a,[]);class w extends l.a{constructor(H){super();this.name="promptTriggerSource";this.string=H}}Object(E.a)(w,"PromptTriggerSourceField",
l.a,[]);class F extends l.a{constructor(H){super();this.name="promptId";this.string=H}}Object(E.a)(F,"PromptIdField",l.a,[]);l=c(946);c.d(K,"a",function(){return G});class G extends l.a{constructor(H){super(H,"AiInsert");this.fieldsFactory=new a}}Object(E.a)(G,"AiInserterTelemetryLoggerImpl",l.a,[])},1802:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=
!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static U3h(f){switch(f){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(E.a)(l,"WopiAuthContext",null,[814])},1803:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.jvn="OneDriveWOPI";Object(E.a)(l,"HostApplicationType",null,[])},1804:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.eLj="WAC_Word";
l.fRc=null;Object(E.a)(l,"AddinHostApp",null,[])},1806:function(E,K){Object.defineProperty(K,"__esModule",{value:!0});K.RoleType=K.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(K.ErrorCode||(K.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";
c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(K.RoleType||(K.RoleType={}))},1807:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.NavigationPaneInputClassifierSignal=K.DesignerInputClassifierSignal=K.DocumentRoleDetectionAnnotation=K.RoleDetectionAnnotation=K.RoleDetectionSettings=K.RoleDetectionCustomMetadata=
K.BasePartialDocumentLevelAnnotation=K.WordNavPaneInputTargetDocumentClassificationAnnotation=K.WordDesignerInputTargetDocumentClassificationAnnotation=K.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=c(196);class f{constructor(G){l.SchemaObject.assign(f,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[f.getTypeName()])}}K.BaseInputTargetDocumentClassificationAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(G){l.SchemaObject.assign(a,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[a.getTypeName()])}}K.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(G){l.SchemaObject.assign(k,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[k.getTypeName()])}}K.WordNavPaneInputTargetDocumentClassificationAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(G){l.SchemaObject.assign(x,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[x.getTypeName()])}}K.BasePartialDocumentLevelAnnotation=x;x.H_=
{T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(G){l.SchemaObject.assign(y,this,G)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[y.getTypeName()])}}K.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class n{constructor(G){l.SchemaObject.assign(n,this,G)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[n.getTypeName()])}}K.RoleDetectionSettings=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class u{constructor(G){l.SchemaObject.assign(u,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[u.getTypeName()])}}K.RoleDetectionAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};
class z{constructor(G){l.SchemaObject.assign(z,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[z.getTypeName()])}}K.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class w{constructor(G){l.SchemaObject.assign(w,
this,G)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[w.getTypeName()])}}K.DesignerInputClassifierSignal=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class F{constructor(G){l.SchemaObject.assign(F,this,G)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[F.getTypeName()])}}K.NavigationPaneInputClassifierSignal=F;F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()}},1808:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f){this.extensions=f}}Object(E.a)(l,"ExtensionList",null,[])},1809:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(1766);class l extends c.a{constructor(f,a){super(f.source,f.target,f.LXf);this.Di=f;this.insertAfter=a}get Dja(){return this.Di.Dja}get Mo(){return this.Di.Mo}set Mo(f){this.Di.Mo=f}}Object(E.a)(l,
"CoreInternalCopyArguments",c.a,[])},1810:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x,y=null){this.source=f;this.target=a;this.insertAfter=k;this.UWf=x;this.Mo=y||{}}}Object(E.a)(l,"CoreInternalPasteArguments",null,[])},1811:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a="",k="",x="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=k;this.Email=
x;this.IsCurrentUser=y}}Object(E.a)(l,"OfficeSharedCommentUser",null,[])},1812:function(E,K,c){c.d(K,"a",function(){return I});E=c(0);var l=c(55),f=c(1813),a=c(166),k=c(2),x=c(126),y=c(332),n=c(1380),u=c(758),z=c(530),w=c(1381),F=c(176),G=c(175),H=c(67),L=c(13);class I{constructor(N){this.M$=this.$h=this.Q1=null;this.oD=0;this.hTb=this.nka=this.Ub=null;this.efh=!1;this.Dve=null;this.lJh=!0;this.ga=N;this.Tb()}get Hca(){return this.Q1}get model(){return this.$h}get w9b(){return this.M$}get Cgl(){return k.AFrameworkApplication.Apo}get zIo(){return k.AFrameworkApplication.Uoj}get Sil(){return CommonUIStrings.l_DeleteCommentConfirm}get JDo(){return!1}get mA(){return!1}get YPi(){return!1}get dij(){return!1}get UWh(){return this.nka}set UWh(N){this.nka=
N}get mode(){return this.oD}set mode(N){N!==this.oD&&(this.oD=N,-1!==this.oD&&(this.Q1.l4a(),this.$h.l4a(),0===this.oD&&this.ihf()))}get xOb(){return this.efh}set xOb(N){this.efh=N}get removePersonalInformation(){return!1}get Vqj(){return!0}dispose(){this.Q1&&(this.Q1.dispose(),this.Q1=null);this.$h&&(this.$h.dispose(),this.$h=null);this.M$&&(this.M$.dispose(),this.M$=null);this.ihf()}selectComment(N,P=1){const M=this.$h.LD(N);!M||2===this.mode&&1!==M.Vq||(this.$h.selectComment(M),this.M$.highlightComment(M,
!0),this.Q1.selectComment(M,P),1===P&&this.xOb&&this.nka.selectComment(N))}d6c(){const N=this.$h.d6c();N&&(this.M$.highlightComment(N,!0),this.Q1.selectComment(N),this.xOb&&this.nka.selectComment(N.id))}e6c(){const N=this.$h.e6c();N&&(this.M$.highlightComment(N,!0),this.Q1.selectComment(N),this.xOb&&this.nka.selectComment(N.id))}cfe(N){N?this.selectComment(N,0):this.Q1.NPi&&this.hof().Zj.Iy(this.Q1.NPi)}clearSelection(){this.$h.clearSelection();this.xOb&&this.nka.selectComment(null);this.M$.zXk()}paneClosing(){this.mA||
(2===this.oD?(this.clearSelection(),this.deleteComment(this.$h.oy)):this.clearSelection())}Xyb(N){if(1===this.mode){N=f.a.nBb(N);var P=({anchor:M}=this.M$.U7k()).returnValue;if(M&&0===P)this.addComment(N,M);else{switch(P){case 1:N=CommonUIStrings.l_NewCommentError;break;case 2:N=CommonUIStrings.l_NewCommentInvalidContent;break;default:N=CommonUIStrings.l_NewCommentError}var M=new G.StandardDialog;M.Ad=0;M.cja(CommonUIStrings.l_DefaultDialogTitle,N,null)}}}addComment(N){0!==this.mode&&(this.$h.Xqk(N),
0===N.Vq||this.YPi||this.selectComment(N.id),this.ga.processAction(L.a.ZFh,2))}editComment(N,P){1===this.mode&&N&&(this.$h.kKc(N,P),this.selectComment(N.id))}J5e(){this.$h.KSk()}addReply(N,P){1===this.mode&&(N=this.$h.QJh(N,P),this.selectComment(N.id,0),this.ga.processAction(L.a.cGh,2))}deleteComment(N){if(1!==this.mode)if(2===this.mode){if(1!==N.Vq)return;this.mode=1}else return;this.Vqj&&1!==N.Vq?(this.hTb=N,N=new G.StandardDialog,N.Ad=4,N.cV(2),N.peg(CommonUIStrings.l_DefaultDialogTitle,this.Sil,
Object(l.a)(this,this.Zil,"deleteDialogHandler"))):this.dJc(N)}Tb(){this.ga.fb(L.a.u0k,H.a.frame,x.ActionManager.Pf,64);this.ga.fb(L.a.v0k,H.a.frame,x.ActionManager.Pf,64);this.ga.fb(L.a.yFh,H.a.frame,x.ActionManager.Pf,64);this.ga.qa(L.a.m8e,H.a.frame,x.ActionManager.Pf);this.ga.qa(L.a.FFh,H.a.frame,x.ActionManager.Pf);this.ga.qa(L.a.GFh,H.a.frame,x.ActionManager.Pf);this.ga.fb(L.a.A0k,H.a.frame,x.ActionManager.Pf,64);this.ga.fb(L.a.B0k,H.a.frame,x.ActionManager.Pf,64);this.ga.qa(L.a.ZFh,H.a.frame,
x.ActionManager.Pf);this.ga.qa(L.a.$Fh,H.a.frame,x.ActionManager.Pf);this.ga.qa(L.a.cGh,H.a.frame,x.ActionManager.Pf);this.ga.fb(L.a.q1k,H.a.frame,x.ActionManager.Pf,64);this.ga.fb(L.a.s1k,H.a.frame,x.ActionManager.Pf,64);this.ga.fb(L.a.r1k,H.a.frame,x.ActionManager.Pf,64);this.ga.qa(L.a.eGh,H.a.frame,x.ActionManager.Pf);this.ga.qa(L.a.t4a,H.a.frame,()=>{this.t4a();return 32})}Zil(N){1===N?this.dJc(this.hTb):(this.hTb&&this.selectComment(this.hTb.id),this.hTb=null)}dJc(N){const P=N.Df;1===N.Vq?this.ga.processAction(L.a.m8e,
2):this.ga.processAction(L.a.FFh,2);this.hTb=null;this.xOb||this.clearSelection();N=this.$h.deleteComment(N);for(let M=0;M<N.length;M++)N[M].dispose();this.cfe(P)}qAb(N,P){0!==this.mode&&(this.ga.processAction(P?L.a.GFh:L.a.eGh,2),this.$h.qAb(N,P))}oua(N){this.$h.oua(N);this.mode=1;this.ga.processAction(L.a.$Fh,2)}Ieb(N){this.$h.Ieb(N);this.mode=1}G1k(N,P){this.$h.gSn(N,P)}qSc(){}ihf(){}UOb(N,P,M,J,V){return this.Q1.UOb(N,P,M,J,V)}mV(N,P,M,J,V){return this.Q1.mV(N,P,M,J,V)}hof(){var N=this.Ub.getRegion(a.AFrame.Gr);
if(!N){const P=this.Ub.fe(a.AFrame.Gr);N=new y.DOMFocusListing(()=>this.Hca.L0c);N.Tpa=!0;N.Xm(3);N.Xm(2);N.Xm(4);N.Xm(1);N.Xm(6);N.Xm(5);this.Ub.ema(()=>this.Hca.L0c,P,N);N=this.Ub.getRegion(a.AFrame.Gr);N.oSa();N.oR=!0;N.ZZa=!0;P.ir(this.Ub.vW);P.ir(this.Ub.wW)}return N}Hyd(N,P){0!==this.mode&&this.$h.Hyd(N,P)}Rce(N,P){0!==this.mode&&this.$h.Rce(N,P)}t4a(){F.UISurfaces.uM().then(N=>{var P=Object.assign(new n.a,{target:this.dij?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new w.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});P=N.callout(P);const M=Object.assign(new z.a,{expirationOptions:Object.assign(new u.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.Dve=N.addNotification(P,M)})}dismiss(){F.UISurfaces.uM().then(N=>{N.removeNotification(this.Dve);return this.Dve=null})}static get instance(){return I._instance||
(I.factory?I._instance=I.factory():null)}static set instance(N){I._instance=N}}I._instance=null;I.factory=null;Object(E.a)(I,"CommentManager",null,[360,361,10])},1813:function(E,K,c){c.d(K,"a",function(){return a});E=c(0);var l=c(2),f=c(937);class a{constructor(){this.Xi=null;this.$g=[];this._changes=[];this.oab=this.NYb=this.Sy=null}get jt(){return this.Sy}get oy(){return this.oab}initialize(k){this.Xi=k}dispose(){const k=this.$g.length;for(let x=0;x<k;x++)this.$g[x].dispose();this.$g=[]}l4a(){this.Sy&&
this.Sy.l4a();this.NYb&&this.NYb.l4a()}selectComment(k){this.clearSelection();k.Qia=1;this.Sy=k;if(k.Df){var x=Array.indexOf(this.$g,k);for(--x;0<=x;x--){const y=this.$g[x];if(y.id===k.Df){y.Qia=2;this.NYb=y;break}}}l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.Ioa&&f.ShyRibbon.qeb(1,0)}d6c(){if(!this.$g.length)return null;let k;k=this.Sy?this.J5h(this.Sy,!0):this.$g[0];this.selectComment(k);return k}e6c(){if(!this.$g.length)return null;let k;k=this.Sy?this.WPl(this.Sy):this.$g[this.$g.length-
1];this.selectComment(k);return k}clearSelection(){this.Sy&&(this.Sy.Qia=0,this.Sy=null);this.NYb&&(this.NYb.Qia=0,this.NYb=null)}kKc(k,x){this.Xi.mode=3;k.Vq=2;k.LSa=0;k.iz=x;this.oab=k}KSk(){this.oab=null;this.Xi.mode=1}QJh(k,x){var y=this.LD(k);this.Xi.mode=2;this.oab=k=c(1652).Comment.mKh(l.AFrameworkApplication.userName,k,y.rki,x);for(x=this.$g.length-1;0<=x;x--)if(y=this.$g[x],y.Df===k.Df||y.id===k.Df){Array.insert(this.$g,x+1,k);break}return k}oua(k){this.fGh(k,2)}Ieb(k){this.fGh(k,4)}deleteComment(k){const x=
[],y=Array.indexOf(this.$g,k);for(;y<this.$g.length;){const n=this.$g[y];if(n.id===k.id||n.Df===k.id)Array.removeAt(this.$g,y),Array.add(x,n);else break}this.r3c(x,3);-1<Array.indexOf(x,this.oab)&&(this.oab=null,this.Xi.mode=1);return x}qAb(k,x){const y=[];let n=Array.indexOf(this.$g,k);for(;n<this.$g.length;){const u=this.$g[n];if(u.id===k.id||u.Df===k.id)u.done=x,Array.add(y,u),n++;else break}this.r3c(y,x?0:1)}BO(){return Array.clone(this.$g)}b9b(){return!!this.$g&&!!this.$g.length}LD(k){for(let x=
0;x<this.$g.length;x++){const y=this.$g[x];if(y.id===k)return y}return null}J5h(k,x){k=Array.indexOf(this.$g,k);return k===this.$g.length-1?x?this.$g[0]:null:this.$g[k+1]}$Vl(k,x=!1){let y=k=Array.indexOf(this.$g,k);do if(y=y===this.$g.length-1?0:y+1,!x||!this.$g[y].done)return this.$g[y];while(y!==k);return this.$g[k]}WPl(k){return(k=Array.indexOf(this.$g,k))?this.$g[k-1]:this.$g[this.$g.length-1]}aWl(k,x=!1){let y=k=Array.indexOf(this.$g,k);do if(y=y?y-1:this.$g.length-1,!x||!this.$g[y].done)return this.$g[y];
while(y!==k);return this.$g[k]}Hyd(){}Rce(){}fGh(k,x){const y=[];k.Vq=0;Array.add(y,k);this.r3c(y,x);this.oab=null}static nBb(k){return c(1652).Comment.mKh(l.AFrameworkApplication.userName,null,c(1652).Comment.FZi,k)}}Object(E.a)(a,"CommentModel",null,[10,364])},1814:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{}l.SGc="CommentPaneTextbox";l.GEd="CommentPane";l.z0k="CommentDeleteButton";l.p1k="CommentSaveButton";l.o1k="CommentReplyButton";l.y0k="CommentCancelButton";l.dGh="CommentTextEntry";
l.u1k="CommentTabHelp";Object(E.a)(l,"CommentManagerConstants",null,[])},1815:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(444),f=c(88),a=c(26);class k{dispose(){}static m_a(x,y,n,u=null,z=!0){var w=z?"":n;x=l.a("a",x,"StandardButton "+y);x.title=w;x.tabIndex=0;w=null;u?(w=f.createClusteredImage(16,16,u,"StandardButtonImage",!0,null),w.setAttribute(a.a.qh,a.a.$y),x.appendChild(w)):Sys.UI.DomElement.addCssClass(x,"StandardButtonNoImage");z?(u=l.a("span",null,"StandardButtonLabel"),
u.innerText=n,x.appendChild(u)):Sys.UI.DomElement.addCssClass(w,"StandardButtonImageNoText");x.setAttribute(a.a.qh,a.a.f3);return x}static TNb(x,y){void 0!==x&&null!==x&&(x.disabled=!y,y?(y=a.a.fM,Sys.UI.DomElement.removeCssClass(x,"DisabledButton"),Sys.UI.DomElement.removeCssClass(x,"cui-disabled")):(y=a.a.np,Sys.UI.DomElement.containsCssClass(x,"DisabledButton")||Sys.UI.DomElement.addCssClass(x,"DisabledButton"),Sys.UI.DomElement.containsCssClass(x,"cui-disabled")||Sys.UI.DomElement.addCssClass(x,
"cui-disabled")),a.a.gr(x,a.a.S1e,y))}}Object(E.a)(k,"SimpleButtonFactory",null,[10])},1817:function(E,K,c){c.d(K,"a",function(){return w});E=c(0);var l=c(79),f=c(11),a=c(2),k=c(20),x=c(19),y=c(44),n=c(7),u=c(3),z=c(9);class w{constructor(F,G,H,L,I="@"){this.zPe=this.Ymd=this.$De=this.ae=null;this.H2g=this.mub=this.Cka=this.rsa=this.gMg=!1;this.wea=0;this.udg=!1;this.LKb=()=>{this.reset()};this.WMa=N=>{this.wea=N.Gb.keyCode;var P=N.Gb.rawEvent.key;P&&P!==this.Mma||(this.udg=!0);return this.Cka&&this.Ymd?
N.Gb.keyCode===l.a.t1||N.Gb.keyCode===l.a.Bs||N.Gb.keyCode===l.a.Aw?(P=!1,N.Gb.keyCode===l.a.t1?(n.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),P=!0):N.Gb.keyCode===l.a.Bs?n.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):N.Gb.keyCode===l.a.Aw&&n.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Ymd(N),P&&this.reset(),!0):N.Gb.keyCode===l.a.Fda||N.Gb.keyCode===l.a.O5||N.Gb.keyCode===
l.a.u1||N.Gb.keyCode===l.a.v1||N.Gb.keyCode===l.a.N5||N.Gb.keyCode===l.a.zL?(this.Ymd(N),!0):!1:!1};this.Mqa=N=>{if(this.udg||this.Cka){this.udg=!1;var P=this.XOc(),M=this.KNc(N.Gb.target),J=N.Gb.rawEvent.inputType;return(void 0!==J&&null!==J||this.wea!==l.a.cC&&this.wea!==l.a.s1)&&"deleteContentBackward"!==J&&"deleteContentForward"!==J?this.wli(P,M,N.Gb.target):!1}};this.$Ik=N=>{if(1!==N.Gb.rawEvent.key.length)return!1;const P=this.XOc(),M=this.KNc(N.Gb.target);return this.wli(P,M,N.Gb.target)};
this.CQa=N=>{if(!this.Cka)return!1;const P=this.XOc(),M=this.KNc(N.Gb.target);(N.Gb.keyCode===l.a.cC||N.Gb.keyCode===l.a.s1||(N.Gb.keyCode===l.a.HUa||N.Gb.keyCode===l.a.$nc)&&N.Gb.ctrlKey)&&this.uwf(P,M,N.Gb.target);return!1};this.I2e=(N,P)=>{this.wea=P.ABf?l.a.cC:P.isDelete?l.a.s1:this.wea;this.Cka&&(P.ABf?this.jlm(P.HDi):P.isDelete&&this.Plm(P.HDi))};this.ze=F;this.nk=G;this.Woc=H;this.fd=L;this.Mma=I;this.reset()}Pdb(F,G){this.rsa||(this.rsa=!0,F.vwa?this.Qdb(G):F.ifa(()=>{this.rsa||this.Qdb(G)}))}dispose(){this.mub&&
(z.App.xa.jlc.uc(f.a.input,this.fd.editingView.editingElement,this.Mqa),this.mub=!1);this.gMg&&(this.ae.uc(f.a.mBd,this.fd.editingView.editingElement,this.$Ik),this.gMg=!1);this.H2g&&(this.ae.uc(f.a.XF,this.fd.editingView.editingElement,this.WMa),this.ae.uc(f.a.uh,this.fd.editingView.editingElement,this.CQa));z.App.xa.Uca(this.LKb);this.cvj()}a4f(F){this.$De=F}k4f(F){this.zPe=F}b4f(F){this.Ymd=F}fJk(){this.Cka=!0;a.AFrameworkApplication.te("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}cvj(){this.Cka=
!1}kF(){return this.Cka}Qdb(F){this.ae=F;if(!this.fd.Bd)n.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.fd.Bd.Vi){if(z.App.fFc&&k.a.ike||k.a.du)z.App.xa.jlc.mb(f.a.input,this.fd.editingView.editingElement,this.Mqa,null),this.mub=!0;this.ae&&(this.ae.mb(f.a.XF,this.fd.editingView.editingElement,this.WMa),this.ae.mb(f.a.uh,this.fd.editingView.editingElement,this.CQa),this.H2g=!0);this.Woc.Cph(this.I2e);z.App.xa.VZ(this.LKb)}}wli(F,
G,H){if(1>G)return!1;F=F.replace(new RegExp(w.newLine,"g"),"");const L=F.charAt(G-1);this.Cka&&L!==this.Mma?this.uwf(F,G,H):this.Cka||L!==this.Mma?this.Cka&&L===this.Mma&&n.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.$De&&(this.reset(),this.lGn(G,F)&&(this.fJk(),this.uwf(F,G,H),n.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===G?"true":"false")));return this.Cka}reset(){this.rsa=!1;this.cvj();this.zPe&&this.zPe()}KNc(F){return this.nk.X6b(2,
F)}XOc(){return this.ze.kw().innerText}lGn(F,G){return 0>F-2||this.gUk(G.charAt(F-2))?!0:!1}gUk(F){return x.a.lca(F)||"("===F}uwf(F,G,H){if(!F||""===F||0>G)this.reset();else{const {ahj:L,XAd:I}=this.cWm(F,G);this.$De(L,H,I)}}cWm(F,G){const H=this.sMl(F,G);if(0<=H&&G<=F.length)return{ahj:F.substring(H,G),XAd:H};this.reset();return{ahj:"",XAd:H}}sMl(F,G){let H=-1,L=G;for(L;0<=L&&63>=G-L;L--)if(F.charAt(L)===this.Mma){H=L;break}63<G-L&&-1==H&&y.c(u.a.TOo,!0,void 0,void 0,void 0,void 0);return H}jlm(F){F=
this.KNc(F.Gb.target);F=this.XOc().charAt(F-1);this.Cka&&F===this.Mma&&this.reset()}Plm(F){F=this.KNc(F.Gb.target);F=this.XOc().charAt(F);this.Cka&&F===this.Mma&&this.reset()}}w.newLine="\n";Object(E.a)(w,"AtMentionsListener",null,[17])},1818:function(E,K,c){c.d(K,"a",function(){return z});E=c(0);var l=c(7),f=c(78),a=c(756),k=c(124),x=c(8),y=c(347),n=c(1819);class u{constructor(w,F){this.bRc=w;this.oTc=F}C7h(){return this.oTc?this.bRc.begin:this.bRc.end}Jgo(w){this.oTc?this.bRc.begin=w:this.bRc.end=
w}nxi(w,F){const G=this.C7h()+(this.oTc?0:-1);return G>=w&&G<F}}Object(E.a)(u,"HitRangeEdge",null,[]);class z{get Uc(){return null}get vj(){return null}get Boa(){return!1}get $Bf(){return!1}lZe(){}F4d(){return!1}Ikg(){return!1}p8h(w){return f.f(w,()=>!1)}hEa(){return null}Y3d(w,F,G,H,L){F=F||[];G=G||[];const I=[];let N=0,P=0,M=0;for(;N<F.length||P<G.length;){const J=N<F.length&&P<G.length?F[N].begin<G[P].begin?F[N++]:G[P++]:N<F.length?F[N++]:G[P++];I[M]=n.a.createInstance(J.begin,J.end,w,M,H,L);++M}return I}DYl(w,
F){if(!F)return null;if(!x.ParagraphReader.AHh(w))return this.dib(w.characterData,F);const G=this.bim(w,k.AParagraphNode.ZLc);w=this.fim(w,G);F=this.dib(w,F);if(!F)return F;F=this.kDn(F);this.KXn(F,G);return F=this.aBl(F,G)}bim(w,F){F=Object(y.c)(F);const G=Object(y.a)(F);return[...x.ParagraphReader.hPc(w)].map(H=>{H.isVisible=G(H);return H})}fim(w,F){F=F.filter(G=>G.isVisible);return x.ParagraphReader.pSd(w,F)}kDn(w){const F=[];for(const G of w)F.push(new u(G,!0)),F.push(new u(G,!1));return F}KXn(w,
F){if(0!==w.length){var G=0,H=0;for(const L of F){if(G>=w.length)break;if(L.isVisible)for(;G<w.length;){F=w[G];if(!F.nxi(L.chp.cp-H,L.cpEnd-H))break;F.Jgo(F.C7h()+H);G++}else H+=L.cpEnd-L.chp.cp}}}aBl(w,F){if(0===w.length)return[];const G=[];let H=0,L=!1;for(const I of F){if(H>=w.length)break;if(I.isVisible)for(;H<w.length;){F=w[H];if(!F.nxi(I.chp.cp,I.cpEnd))break;F.oTc?L=!0:!F.oTc&&L&&(G.push(F.bRc),L=!1);H++}else L=!1}return G}bAi(){return!1}mAi(){return!1}dib(w,F){if(F&&w){let G;const H=[];try{for(;G=
F.exec(w);){const L=new a.a(G.index,F.lastIndex);H.push(L)}return H}catch(L){l.ULS.sendTraceTag(522846819,313,15,L instanceof SyntaxError?"Invalid regular expression":`errorName: ${L.name}`)}}return null}Bce(){}}Object(E.a)(z,"BaseFindManagerHelper",null,[423])},1819:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x,y,n,u){this.id=++l.Sgk;this.hMg=f;this.x$a=a;this.x7g=k;this.dYg=x;this.Ck=y;this.e_g=n;this.gp=u;this.next=this.previous=null}get begin(){return this.hMg}get end(){return this.x$a}get type(){return this.Ck}nci(){return this.gp.hEa(this.nodeId)}get nodeId(){return this.x7g}get wPa(){return this.dYg}get lXd(){return this.e_g}R6k(f){this.hMg=
f.begin;this.x$a=f.end;this.x7g=f.nodeId;this.dYg=f.wPa;this.Ck=f.type;this.e_g=f.lXd}static createInstance(f,a,k,x,y,n){const {FindManagerHelper:u}=c(1539);return new l(f,a,k,x,y,n,u.instance)}}l.Sgk=0;Object(E.a)(l,"FindResult",null,[442])},1820:function(E,K,c){c.d(K,"a",function(){return k});E=c(0);var l=c(55),f=c(91),a=c(20);class k{constructor(x,y,n){this.As=this.jWf=null;this.Sch=this.ccb=this.Rch=this.pBa=0;this.Iid=null;this._context=x;this.Hb=y;this.Ma=n;this.C4b=!1;this.aoe=!0;this.g5n();
this.JJb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ma}get retryCount(){return this.pBa}get e7n(){return this.Rch}get S5a(){return this.ccb}get f7n(){return this.Sch}Wec(x){this.As=x;if(!this.C4b){if(this.aoe){if(this.JJb&&a.a.PH){this.Iid=x.OId(Object(l.a)(this,this.xTf,"onFileChosen"));return}this.Iid=x.OId(null);if(!this.pza(this.Iid,x))return}this.sOa(x,null)}}xTf(x){if(this.pza(x,this.As)){if(a.a.PH||a.a.jj)this.Iid=x;this.sOa(this.As,null)}}Z_c(){this.jWf&&
this.jWf()}l7n(x){if(!x||this.retryCount>=this.e7n)return!1;this.pBa=this.retryCount+1;const y=new f.a(2,1,this.S5a,()=>{this.Bde(x)},110);this.Hb.Wb(y);this.S5a<this.f7n&&(this.ccb=2*this.S5a);return!0}g5n(){this.pBa=0;this.Rch=this.K.mc("Box4UploadRetryCount",20);this.ccb=this.K.mc("Box4UploadRetryDelayStart",200);this.Sch=this.K.mc("Box4UploadRetryDelayMax",3200);this.As&&(this.As.dispose(),this.As=null)}}Object(E.a)(k,"FileUploader",null,[])},1821:function(E,K,c){c.d(K,"a",function(){return f});
E=c(0);var l=c(2);c=c(80);class f{static Nwk(a){f.Bvg.addHandler(f.kFh,a)}static AMn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&f.Bvg.raiseEvent(f.kFh,a)}}f.kFh="CommandClickEvent";f.Bvg=new c.a;Object(E.a)(f,"CommandClickEvents",null,[])},1822:function(E,K){Object.defineProperty(K,"__esModule",{value:!0});K.ErrorCode=K.FormattingSuggestionsRange=K.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";
c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(K.FormattingSuggestionType||(K.FormattingSuggestionType={}));(function(c){c[c.Paragraph=
0]="Paragraph";c[c.List=1]="List"})(K.FormattingSuggestionsRange||(K.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(K.ErrorCode||(K.ErrorCode={}))},1823:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.FormattingSuggestionsSummaryAnnotation=K.FormattingSuggestionsAnnotation=void 0;const l=c(196);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}K.FormattingSuggestionsAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1824:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1825:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.PullQuotesSignal=K.DocumentPullQuoteAnnotation=K.PullQuoteAnnotation=void 0;const l=c(196);class f{constructor(x){l.SchemaObject.assign(f,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[f.getTypeName()])}}K.PullQuoteAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}K.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,
this,x)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}K.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1826:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1827:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1828:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1829:function(E,K,
c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToImageAnnotation=void 0;var l=c(196);E=function(){function f(a){l.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};
f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToImageAnnotation=E},1830:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToImageSignal=void 0;var l=c(196);E=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};f.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToImageSignal=E},1831:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToImageTraceSignal=void 0;var l=c(196);E=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_=
{T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToImageTraceSignal=E},1832:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1833:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.ThemeExtractorSignal=K.ThemeExtractorAnnotation=void 0;const l=c(196);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}K.ThemeExtractorAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1834:function(E,K){Object.defineProperty(K,"__esModule",{value:!0});K.TableType=
void 0;E=K.TableType||(K.TableType={});E[E.Other=0]="Other";E[E.SimpleHeaded=1]="SimpleHeaded"},1835:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TableTypeAnnotation=void 0;const l=c(196);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.TableTypeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1836:function(E,K,c){c.d(K,"a",function(){return w});E=c(0);c(1554);var l=c(1611),f=c(2),a=c(19);c(1540);c(35);var k=c(7),x=c(1408),y=c(9),n=c(17),u=c(124),z=c(8);class w{constructor(F=2E3){this.lnk=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.dbb=F}EHm(){w.XT();return!0}RTm(){return!0}getSelectedText(){const F=w.XT();return this.LRd(F)}Etf(){const F=
w.XT();return this.Xam(F)}LRd(F){return this.zfi(F,!0)}Xam(F){return this.zfi(F,!1)}zfi(F,G){try{return this.Wam(F,G)}catch(H){k.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",H)}return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0})}Wam(F,G){var H=null;let L=!1;G&&F&&F.iy&&n.SelectionEditor.gf(F.Oa)&&n.SelectionEditor.ckb(F.Oa)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),L=n.SelectionEditor.gf(F.Oa),(H=
n.SelectionEditor.F3(F.Oa,!1))&&H.iy&&0<=H.Oa.cpBegin&&0<=H.Oa.cpEnd&&1>=H.Oa.cpEnd-H.Oa.cpBegin&&(H=null));H&&(F=H);if(!F)return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0});const I=new Sys.StringBuilder;H=G=0;const N=[],P=F.length;let M=null;for(let W=0;W<P;W++){var J=F.J(W);if(!z.ParagraphReader.Vb(J.node)||Array.contains(N,J.node.Al))continue;N.push(J.node.Al);const U=x.a.create(J.cpBegin,J.cpEnd),Y=z.ParagraphReader.Bgb(J.node,u.AParagraphNode.ZLc,null,U);f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&L&&(M=this.Oyl(Y,U.yd));let ca=Y,aa=0;var V=z.ParagraphReader.jg(J.node,!0,!0,!0);J=z.ParagraphReader.jg(J.node,!1,!0,!0);let fa=0;for(;ca.length<this.dbb&&(V||J);){if(!(fa%2)&&V){var X=z.ParagraphReader.text(V,u.AParagraphNode.ZLc);X&&(ca=X+" "+ca,aa+=X.length+1);V=z.ParagraphReader.jg(V,!0,!0,!0)}1===fa%2&&J&&(ca=(X=z.ParagraphReader.text(J,u.AParagraphNode.ZLc))?ca+" "+X:ca,J=z.ParagraphReader.jg(J,!1,!0,!0));fa++}V=W===P-1;W||-1===U.yd||(G=U.yd);H+=V&&-1!==U.endCp?U.endCp:Y.length;I.append(ca);
f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&L&&M&&(G=M.start,H=M.start+M.length);G+=aa;H+=aa;V||(I.append(" "),H++)}for(F=u.AParagraphNode.IR(I.toString()," ");G<H&&a.a.Jv(F.charCodeAt(G));)G++;for(;H>G&&a.a.Jv(F.charCodeAt(H-1));)H--;return this.Nzk(F,G,H)}Oyl(F,G){for(var H;null!==(H=this.lnk.exec(F));){const L=H.index;H=H[0].length;if(G>=L&&G<=L+H)return{start:L,length:H}}return null}Nzk(F,G,H){if(F.length>this.dbb){var L=H-G;if(L>
this.dbb)F=F.substr(G,this.dbb),H=this.dbb,G=0;else{L=Math.max(G-Math.floor((this.dbb-L)/2),0);let I;I=Math.min(L+this.dbb,F.length);L=Math.max(I-this.dbb,0);G-=L;H-=L;F=F.substring(L,I)}}return Object.assign(new l.a,{neighborhood:F,mentionStart:G,mentionLength:H-G})}static XT(){var F=y.App.xa.hb.rc;if(!F)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;F=F.lb;return F&&F.gb&&F.gb.length?F.gb.kb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(E.a)(w,"Box4InsightsSelection",null,[405,406])},1837:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(402);class l extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(E.a)(l,"IconGalleryButtonProps",c.a,[])},1838:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.y=this.x=0}}Object(E.a)(l,"IPoint",null,[])},1839:function(E,K,c){c.d(K,"a",function(){return a});
E=c(0);var l=c(19),f=c(7);c=c(1572);class a extends c.a{constructor(k,x,y,n,u){super(k,x,u);this.hk=y;this.Lfh=u}Zlc(k){let x;if(this.$S&&!k)return f.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,Wua:null};if(this.Lfh){if(this.hk)return x=this.hk.dYf(k,!1),{returnValue:!0,Wua:x};f.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}x=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var y=0;y<k.length-1;y++){const n=document.createElement("p");
n.innerText=this.wXc(k[y]);x.appendChild(n)}y=document.createElement("span");y.innerText=l.a.BKc(k[k.length-1]);x.appendChild(y);return{returnValue:!0,Wua:x}}wXc(k){return l.a.BKc(k.length?k:" ")}}Object(E.a)(a,"MultiLineTextImportStrategy",c.a,[])},1840:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(852);class l extends c.a{constructor(f,a,k,x,y=null,n=0,u=0,z=null,w=null,F=null,G=null){super(y?y.o9:null,y?y.xB:null,y?y.Gxa:null,y?y.cultureName:null,y?y.WBa:null);this.src=f;this.alt=
a;this.width=k;this.height=x;this.maxWidth=n;this.maxHeight=u;this.href=z;this.dkl=w;this.Zif=F;this.MDd=G}}Object(E.a)(l,"ImageSemanticArgs",c.a,[])},1841:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);var l=c(107);class f{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,k,x,y,n,u,z,w,F,G,H,L,I,N,P,M=null){const J=new f;J.ImageId=a;J.Src=k;J.Alt=x;J.Width=y;J.Height=n;J.Desc=u;J.LockId=z;J.ImageAnchorId=w;J.IsImageFromPaste=F;J.EditContainerWidth=G;J.LocalizedPicture=H;J.IsLayoutSizeSetByUser=L;if(I&&0<I.length){J.ContentNodes=Array(I.length);a=0;for(const V of I)J.ContentNodes[a]=l.a(V),a++}J.RunId=N;J.WordId=P;J.ClipServiceArgs=M;return J}}Object(E.a)(f,"PastedPicture",null,[])},1842:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);
var l=c(22);c=c(582);class f extends c.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}al(){return 31}static construct(a,k,x=null,y=!1){const n=new f;n.DataUriPictures=k;n.PastedPictures=a;(a=l.a.instance.Na("Box4.IFeatureHelper"))&&a.isFeatureEnabled(11)&&a.isFeatureEnabled(49)&&
(n.ClipServicePictures=y,n.ChartsPasteFromXLOIsEnabled=!0,n.InkEditingInCanvasSupportedIsEnabled=!0,n.PictureEditingInIllustrationCanvasIsEnabled=!0,n.InkExternalPartFileFormatFixIsEnabled=!0);x&&x.length&&(n.FileId=x);return n}}Object(E.a)(f,"PicturePasteRequest",c.a,[])},1843:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k,x=!1){this.vDb=f;this.GDi=a;this.FRk=k;this.IVm=x}}Object(E.a)(l,"ClearSpecificFormattingProperties",null,[])},1846:function(E,K){Object.defineProperty(K,
"__esModule",{value:!0})},1847:function(E,K){Object.defineProperty(K,"__esModule",{value:!0});K.SuggestionCategory=void 0;E=K.SuggestionCategory||(K.SuggestionCategory={});E[E.TextRelatedImage=0]="TextRelatedImage";E[E.AbstractImage=1]="AbstractImage";E[E.Icon=2]="Icon"},1848:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1849:function(E,K){Object.defineProperty(K,"__esModule",{value:!0})},1850:function(E,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToSuggestionSignal=
void 0;var l=c(196);E=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToSuggestionSignal=E},1851:function(E,K,c){c.d(K,"a",function(){return y});E=c(0);var l=c(91),f=c(189),a=c(7),k=c(110),x=c(48);class y{constructor(n,
u,z,w,F,G,H,L,I){this.Lxd=0;this.jW=null;this.FYa="";this.HVb=this.qAe=!1;this.jKa=this.g7=null;this.r6f=!1;this.OUb=null;this.WAo=N=>{this.jKa===N&&(this.jKa=null,this.g7?this.FYa=this.Jea.I1c(this.jW.text):(this.zSf(),this.findInternal(null)),this.kuj())};this.findInternal=()=>{this.g7=null;if(!this.L5e())if(!this.Jea.dLb(this.FYa).length)this.jeb(),this.Cob(!0);else if(!this.u7f())switch(this._state){case 0:this.W1o();break;case 1:this.F6i()}};this.J$a=n;this.Jea=u;this.o2j=z;this.gp=w;this.sIe=
F;this.Xwb=G;this.y2j=H;this.PUb=L;this.Kj=I;this._state=2;this.IL=0}get Cog(){return this.Lxd}set Cog(n){this.Lxd=n}get enc(){return this.Lxd}set enc(n){this.Lxd=n}get taskManager(){return this.sIe.value}get UMb(){return this.Xwb.value}get i5c(){return this.y2j.value}get yBl(){return this.qAe}Cob(n){(this.qAe=n)&&this.J$a&&this.J$a.d6b()}get fkf(){return null}get VLc(){return this.OUb}find(n){this.jW=n;this.XXk();this.jKa=new l.a(2,1,this.Cog,this.WAo,51);this.taskManager.Wb(this.jKa)}DZa(){}e5c(){}Voj(){return!1}VSd(){}WSd(){}umi(){return!1}XXk(){this.g7&&
(this.taskManager.We(this.g7),this.g7=null);this.jKa&&(this.taskManager.We(this.jKa),this.jKa=null)}W1o(){var n=(new Date).getTime();this.CSi();const u=this.X1o(n);this._state||(this.g7=new l.a(2,1,this.enc,this.findInternal,52),this.taskManager.Wb(this.g7));n=(new Date).getTime()-n;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:n,["Count"]:u})}awf(n,u,z=!0){this.oCh(n);if(Object(k.a)(58,n))if(12===n.type)this.xkm(n,u,this.HVb,z);else{const w=this.gp.dib(n.hEa(),this.VLc);z&&(w&&
0<w.length?this.WSa(n,w):n.kma());z=this.gp.Y3d(n.id,w,null,u,this.HVb);this.gzd(n.id,z,n,u);this.ZLf(n)}}xkm(n,u,z,w=!0){const F=[];var G=this.gp.p8h(n);if(!f.a.jf(G)&&(this.ZLf(n),w))for(var H of G)G=this.gp.dib(H.hEa(),this.VLc),f.a.jf(G)?this.kma(H):(this.WSa(H,G),F.push(G));H=x.a.Pj?this.gp.DYl(n,this.VLc):this.gp.dib(n.hEa(),this.VLc);this.kma(n);!f.a.jf(H)&&w&&this.WSa(n,H);z=this.gp.Y3d(n.id,H,F,u,z);this.gzd(n.id,z,n,u)}X1o(n){let u=this._state=0;const z=this.pgi();this.i2i();const w=this.jnj();
do this.qWf(),u++;while(this.R8e(z)&&(new Date).getTime()-n<y.MMi);w&&w.dispose();this.jSf();return u}zSf(){}kuj(){}L5e(){return!1}jeb(){}u7f(){return!1}F6i(){}CSi(){}oCh(){}WSa(){}kma(){}ZLf(){}gzd(){}jSf(){}pgi(){return null}i2i(){}jnj(){return null}qWf(){}R8e(){return!1}}y.MMi=200;Object(E.a)(y,"BaseFindManager",null,[1650])},1852:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a,k){this.rootNode=f;this.gja=a;this.j6b=k}}Object(E.a)(l,"FindNodeContext",null,[])},1858:function(E,
K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a=null,k=null,x=null){this.iconSet={};this.iconSet["default"]=f;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=x}}Object(E.a)(l,"IconSetContainer",null,[])},1861:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);c=c(454);class l extends c.a{constructor(){super()}}l.W9e="conversionRequestType";l.fZf="png";l.hmf="gc2json";l.strict="strict";l.xxl="existingcontent";l.error="error";Object(E.a)(l,"GraphicsEditorParameters",
c.a,[])},1874:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f){this.Hrb=0;this.Lod=isFinite(f)?Math.max(f,8):8;this.jp=Array(this.Lod);this.aj=this.gdb=this.AXa=0;this.WPg=this.A6h(this.Lod)}get count(){return this.aj}get isEmpty(){return!this.count}enqueue(f){this.count===this.Hrb&&this.zvm();this.jp[this.gdb]=f;this.gdb++;this.gdb===this.Hrb&&(this.gdb=0);this.aj=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const f=this.jp[this.AXa];this.AXa++;
this.AXa===this.Hrb&&(this.AXa=0);this.aj=this.count-1;this.count<=this.WPg&&this.Pgl();return f}NA(){if(!this.count)throw Error.create("Empty Queue");return this.jp[this.AXa]}zvm(){this.Glj(2*this.Hrb)}Pgl(){const f=Math.max(this.Hrb/2,this.Lod);this.count>f||this.Glj(f)}Glj(f){const a=Array(f);let k=0;if(this.AXa<this.gdb||!this.count)for(var x=this.AXa;x<this.gdb;x++)a[k]=this.jp[x],k++;else{for(x=this.AXa;x<this.Hrb;x++)a[k]=this.jp[x],k++;for(x=0;x<this.gdb;x++)a[k]=this.jp[x],k++}this.jp=a;
this.Hrb=f;this.AXa=0;this.gdb=k;this.WPg=this.A6h(f)}A6h(f){return f<=this.Lod?-1:Math.floor(.25*f)}}Object(E.a)(l,"Queue",null,[])},1955:function(E,K,c){c.r(K);E=c(0);var l=c(2),f=c(91),a=c(2034),k=c(7),x=c(73),y=c(55),n=c(110),u=c(243),z=c(538),w=c(369),F=c(75),G=c(3),H=c(9),L=c(71),I=c(43),N=c(1043),P=c(5),M=c(94);class J extends L.a{constructor(){super(new M.a(33));this.hkf=this.r8f=0}aWd(){return 0}gGa(){const fb=new I.GraphTransaction(3);fb.Cb(this);const lb=new P.GraphIterator;lb.set(this);
if(lb.wA()){const sb=lb.Qd();lb.set(sb);const ab=N.b(lb,this.r8f,this.hkf),Ga=new P.GraphIterator;Ga.set(this);Ga.Qd();Ga.Cg();ab&&lb.currentNode!==sb&&Ga.Jf(lb.currentNode,-2)}fb.dispose()}}Object(E.a)(J,"FindTrackingNode",L.a,[]);var V=c(17),X=c(46),W=c(8),U=c(1851),Y=c(1852);class ca{constructor(fb){this.Wc=fb;fb=[];fb.push(1);this.Rgg=fb}n8h(fb){const lb=this.Wc.yk();lb.set(fb);const sb=[];lb.zb(8)&&(lb.jd(8),sb.push(new Y.a(lb.currentNode,fb,1)));return sb}static WE(){return new ca(new z.a)}static get instance(){return null!=
ca.rBg?ca.rBg:ca.rBg=ca.WE()}}Object(E.a)(ca,"FindContextHelper",null,[378]);var aa=c(1539),fa=c(365),pa=c(106),ra=c(15);class la{constructor(fb,lb,sb,ab,Ga,Ua,wb,cc,zb){this.vo=null;this.lVb=this.$Be=!1;this.d$a=this.CKg=this.u9a=null;this.Lch=!1;this.uY=(nb,eb)=>{nb=eb.node;eb.property===ra.a.mo&&this.OUc(nb)&&this.AFb(nb,3)};this.gmb=(nb,eb)=>{nb=eb.node;this.OUc(nb)&&this.AFb(nb,2)};this.Yha=(nb,eb)=>{nb=eb.node;eb=eb.rCf;!this.$A.yBl&&eb||!this.OUc(nb)||this.AFb(nb,1)};this.processDirtyNodes=
()=>{const nb=this.ge.$f("UserAction","ProcessDirtyNodesInFindResultsTime");this.vo=null;const eb=this.Gc.Oc(3);eb.Cb(this.gp.Uc);0<this.addedNodes.count&&(this.lVb=!0,this.lOg(this.addedNodes,this.$A.Kj));0<this.hJc.count&&this.lOg(this.hJc,this.$A.Kj);if(0<this.reb.count){const Ib=!this.dgk(this.reb,this.$A,this.gp,this.cgk);this.lVb=this.lVb||Ib}eb.dispose();this.$A.Kj.eqb();this.tob(this.lVb);this.ygj();nb.stop()};this.U$n=()=>{this.EDd();if(0<this.reb.count||0<this.addedNodes.count||0<this.hJc.count)this.vo=
new f.a(2,1,500,this.processDirtyNodes,53),this.Hb.Wb(this.vo)};this.$A=fb;this.TV=lb;this.gp=sb;this.Hb=ab;this.Gc=Ga;this.lOg=Ua;this.dgk=wb;this.cgk=cc;this.ge=zb;this.reset();this.ygj=this.U$n;this.gp.Bce(this.uY,this.Yha,this.gmb)}get reb(){return this.u9a}get addedNodes(){return this.CKg}get hJc(){return this.d$a}get Kdj(){return this.Lch}get dpm(){return 0<this.reb.count||0<this.hJc.count}start(){this.$Be=!0;this.tob(!1)}stop(){this.reset()}reset(){this.$Be=!1;this.tob(!1);this.u9a=new fa.a;
this.CKg=new fa.a;this.d$a=new fa.a;this.EDd()}OUc(fb){return!!fb.Jc&&!!this.gp.vj&&fb.Jc.id.equals(this.gp.vj.id)}AFb(fb,lb){if(this.$Be&&Object(n.a)(58,fb)&&!this.$A.UMb.B4c)if(this.$A.Kj.v7a||this.$A.Kj.Bkb.length){switch(lb){case 1:this.reb.nb(fb.id)||this.addedNodes.Z(fb.id,fb);break;case 2:this.reb.nb(fb.id)&&this.reb.remove(fb.id);this.addedNodes.nb(fb.id)?this.addedNodes.remove(fb.id):this.hJc.Z(fb.id,fb);break;case 3:this.reb.Z(fb.id,fb)}this.ygj()}else 2!==lb&&this.tob(this.lVb=!0)}EDd(){this.vo&&
(this.Hb.We(this.vo),this.vo=null)}tob(fb){this.Kdj!==fb&&(this.Lch=fb,this.TV.tob(fb));fb||(this.lVb=!1)}static WE(fb,lb){return new la(fb,lb,aa.FindManagerHelper.instance,pa.a.instance,new w.a,la.rXk,la.nXn,la.mXn,H.App.xa.Gq)}static createInstance(fb,lb){return la._instance||(la._instance=la.WE(fb,lb))}static nXn(fb,lb,sb,ab){let Ga=!1;const Ua=la.zii(fb,la.ian);for(let wb=0;wb<Ua.length;++wb){const cc=!ab(Ua[wb],lb,sb);Ga=Ga||cc;fb.remove(Ua[wb].id)}return!Ga}static mXn(fb,lb,sb){const ab=lb.Kj;
fb.kma();const Ga=fb.id,Ua=ab.q8b(Ga);if(Ua)lb=sb.dib(fb.hEa(),lb.VLc),sb=sb.Y3d(Ga,lb,null,Ua.type,Ua.lXd),fb.WSa(lb),ab.xde(Ga,sb);else return!1;return!0}static rXk(fb,lb){const sb=la.zii(fb,la.han);for(let ab=0;ab<sb.length;++ab){const Ga=sb[ab],Ua=Ga.id;Ga.kma();lb.d4c(Ua);fb.remove(Ua)}}static zii(fb,lb){const sb=[];let ab=lb;fb.forEach((Ga,Ua)=>{sb.push(Ua);--ab;return ab?!0:!1});return sb}}la.ian=5;la.han=15;la._instance=null;Object(E.a)(la,"FindResultAppEventCoordinator",null,[1673]);class qa{constructor(fb,
lb){this.iyb=this.aSb=0;this.Rqc=this.sBc=this.Kja=null;this.b_b=0;this.Mub=null;this.TV=fb;this.qka=lb;this.MXa=new fa.a;this.axb=new fa.a;this.nbb=new fa.a;this.l$a=new fa.a;this.LXa=new fa.a(0);this.Vzc=new fa.a;for(fb=0;fb<lb.length;++fb)this.LXa.Z(lb[fb],0);this.Bkb=[]}get BE(){return this.Kja}set BE(fb){this.Kja=fb;fb=Array(1);fb[0]=this.Kja;this.TV.tOa(3,fb)}get Z9(){return this.sBc}set Z9(fb){this.sBc=fb}get w3(){return this.Rqc}set w3(fb){this.Rqc=fb}get UDa(){let fb=null;for(const lb of this.qka)if(fb=
this.MXa.J(lb))break;return fb}get bYe(){return this.aSb}she(fb){fb!==this.aSb&&(this.aSb=fb)}get qja(){return this.iyb}ejc(fb){fb!==this.iyb&&(this.iyb=fb,this.TV&&!this.iyb&&(this.TV.Gfe(0),this.TV.nhe(0)))}get v7a(){return this.b_b}get mcc(){return this.Mub}jYe(fb,lb){if(fb&&!(0>=fb.length)){var sb=fb[0].type,ab=lb,Ga=ab?ab.next:this.MXa.J(sb);ab||this.MXa.Z(sb,fb[0]);for(const Ua of fb){const wb=Ua;this.Vzc.Z(wb.id,wb);ab&&(ab.next=wb);wb.previous=ab;ab=wb}ab&&(ab.next=Ga);Ga&&(Ga.previous=ab);
lb&&fb[0].nodeId.equals(lb.nodeId)||this.nbb.Z(fb[0].nodeId,fb[0]);!Ga&&ab&&this.axb.Z(ab.type,ab);this.mcc===lb&&(this.Mub=ab);this.LXa.Z(sb,this.LXa.J(sb)+fb.length);this.ejc(this.qja+fb.length);this.b_b=this.v7a+fb.length;this.TV&&this.TV.tOa(0,fb)}}lzd(fb){!fb||0>=fb.length||this.jYe(fb,this.axb.J(fb[0].type))}Mmh(fb){!fb||0>=fb.length||(this.mcc&&this.mcc.type!==fb[0].type&&(this.Mub=null),this.jYe(fb,this.mcc))}d4c(fb){const lb=this.q8b(fb);if(lb){fb=lb;for(var sb=0;fb;){++sb;if(!fb.next||!fb.nodeId.equals(fb.next.nodeId))break;
fb=fb.next}this.H$i(lb,fb)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",fb.toString())}H$i(fb,lb){let sb=0,ab=0;const Ga=[];let Ua=fb;for(;Ua!==lb.next;){const wb=this.xAi(Ua);this.nbb.J(Ua.nodeId).id===Ua.id&&(Ua.next&&Ua.next.nodeId.equals(Ua.nodeId)?(this.nbb.Z(Ua.nodeId,Ua.next),wb&&this.l$a.Z(Ua.nodeId,Ua.next)):(this.nbb.remove(Ua.nodeId),wb&&this.l$a.remove(Ua.nodeId)));this.mcc&&this.mcc.id===Ua.id&&(this.Mub=fb.previous);this.Z9&&this.Z9.id===
Ua.id&&(this.Z9=this.Wrf(Ua,fb));this.w3&&this.w3.id===Ua.id&&(this.w3=this.Wrf(Ua,fb));this.BE&&this.BE.id===Ua.id&&(this.BE=this.Wrf(Ua,fb));this.Vzc.remove(Ua.id);Ga.push(Ua);Ua=Ua.next;wb?++ab:++sb}fb.previous?fb.previous.next=lb.next:lb.next?this.MXa.Z(lb.type,lb.next):this.MXa.remove(lb.type);lb.next?lb.next.previous=fb.previous:fb.previous?this.axb.Z(fb.type,fb.previous):this.axb.remove(fb.type);lb.next=null;fb.previous=null;this.LXa.Z(fb.type,this.LXa.J(fb.type)-sb);this.ejc(this.qja-sb);
this.b_b=this.v7a-(sb+ab);this.TV&&this.TV.tOa(1,Ga)}xde(fb,lb){const sb=this.q8b(fb);if(sb){const ab=[],Ga=[],Ua=[];let wb=sb,cc,zb=0;do zb<lb.length?(wb.R6k(lb[zb]),ab.push(wb)):(Ga.push(wb),this.Z9&&this.Z9.id===wb.id&&0<ab.length&&(this.Z9=ab[ab.length-1])),++zb,cc=wb,wb=wb.next;while(wb&&cc.nodeId.equals(wb.nodeId));for(;zb<lb.length;++zb)Ua.push(lb[zb]);0<Ga.length&&this.H$i(Ga[0],Ga[Ga.length-1]);0<Ua.length&&this.jYe(Ua,0<ab.length?ab[ab.length-1]:sb);lb=ab.length;if(0<lb){if(this.l$a.nb(fb)){this.l$a.remove(fb);
this.ejc(this.qja+lb);let nb,eb;(nb=this.LXa).Z(eb=ab[0].type,nb.J(eb)+lb)}this.TV&&this.TV.tOa(4,ab)}}else k.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",fb.toString())}TDh(){this.nbb=new fa.a;this.l$a=new fa.a;this.MXa=new fa.a;this.axb=new fa.a;this.Vzc=new fa.a;for(let fb=0;fb<this.qka.length;++fb)this.LXa.Z(this.qka[fb],0);this.BE=null;this.she(0);this.w3=this.Z9=this.Mub=null;this.ejc(0);this.b_b=0;this.TV&&this.TV.tOa(2,null)}WLi(){this.l$a=
new fa.a;this.nbb.forEach((fb,lb)=>{this.l$a.Z(fb,lb);return!0});for(let fb=0;fb<this.qka.length;++fb)this.LXa.Z(this.qka[fb],0);this.BE=null;this.she(0);this.Mub=null;this.ejc(0);this.TV&&this.TV.tOa(2,null)}q8b(fb){return this.nbb.nb(fb)?this.nbb.J(fb):null}Yj(fb){let lb=null;this.Vzc.nb(fb)&&(lb=this.Vzc.J(fb));return lb}A8h(fb){return this.MXa.nb(fb)?this.MXa.J(fb):null}b0l(fb){return this.axb.nb(fb)?this.axb.J(fb):null}eqb(){var fb=0;if(this.BE){fb=0;const ab=this.BE.type;var lb=this.MXa.J(ab);
if(lb){for(var sb=1;lb&&this.BE.id!==lb.id;)this.xAi(lb)||++sb,lb=lb.next;lb&&(fb=sb)}if(lb){lb=0;for(sb=0;sb<this.qka.length&&this.qka[sb]!==ab;++sb)lb+=this.LXa.J(this.qka[sb]);fb=lb+fb}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.BE=null,fb=0}this.she(fb);this.TV&&(this.TV.Gfe(this.bYe),this.TV.nhe(this.qja))}l1a(fb){return this.zQd(fb,!1)}nRd(fb){return this.zQd(fb,!0)}zQd(fb,lb){let sb=lb?fb.previous:fb.next,
ab=fb.type;for(;!sb&&(ab=this.P3l(ab,lb),sb=lb?this.b0l(ab):this.A8h(ab),ab!==fb.type););return sb||fb}t7b(fb){return this.v5h(fb,!1)}aai(fb){return this.v5h(fb,!0)}v5h(fb,lb){let sb=this.zQd(fb,lb);for(;sb.nodeId.equals(fb.nodeId)&&sb.id!==fb.id;)sb=this.zQd(sb,lb);return sb}P3l(fb,lb){let sb=0;for(let ab=0;ab<this.qka.length;++ab)if(fb===this.qka[ab]){sb=ab;break}lb?(--sb,0>sb&&(sb=this.qka.length-1)):(++sb,sb===this.qka.length&&(sb=0));return this.qka[sb]}$cj(){this.Mub=null}Wrf(fb,lb){fb=this.l1a(fb);
fb.id===lb.id&&(fb=null);return fb}xAi(fb){return this.l$a.nb(fb.nodeId)}static createInstance(fb,lb,sb=!1){return sb?new qa(fb,lb):qa._instance||(qa._instance=new qa(fb,lb))}}qa._instance=null;Object(E.a)(qa,"FindResultManager",null,[1649]);class La{constructor(fb,lb){this.Rjm=sb=>{const ab=this.gp.vj.Db(sb.nodeId);if(ab){if(this.nC.BE){var Ga=this.gp.vj.Db(this.nC.BE.nodeId);(Ga=Object(x.a)(58,Ga))?Ga.wDh():k.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",
["NodeId"]:this.nC.BE.nodeId})}ab.MLf(sb.wPa,sb.type)?(this.nC.BE=sb,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:sb.id})):c(1955).FindManager.instance.umi()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:ab.id,["HitIndexInNode"]:sb.wPa,["ResultId"]:sb.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:ab.id,["HitIndexInNode"]:sb.wPa,["ResultId"]:sb.id});this.nC.eqb()}else k.ULS.sendTraceTag(4069059,
313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:sb.nodeId})};this.nC=fb;this.gp=lb;this.Jvf=this.Rjm}Uji(){const fb=this.nC.BE?this.nC.l1a(this.nC.BE):this.nC.UDa;this.Jvf(fb)}Qjm(){const fb=this.nC.BE?this.nC.nRd(this.nC.BE):this.nC.UDa;this.Jvf(fb)}Xji(fb){const lb=this.nC.Yj(fb);lb?this.Jvf(lb):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:fb})}static WE(fb){return new La(fb,aa.FindManagerHelper.instance)}static createInstance(fb){return La._instance||
(La._instance=La.WE(fb))}}La._instance=null;Object(E.a)(La,"FindResultNavigator",null,[1648]);var Pa=c(19),Ka=c(1210);L=c(146);class Na{static dLb(fb){const lb=[];var sb=RegExp('"[^"\\r\\n]*"',"ig"),ab=fb.match(sb);let Ga;if(ab&&0<ab.length)for(Ga=0;Ga<ab.length;Ga++){var Ua=ab[Ga].split('"').join("");Ua=Ua.trim();Ua=Ua.split(Na.M8c).join(" ");if(""!==Ua){lb.push(Ua);var wb=Ua.split(Na.punctuation).join(" ");wb=wb.trim();wb=wb.split(Na.M8c).join(" ");""!==wb&&wb!==Ua&&lb.push(wb)}}fb=fb.split(sb).join(" ");
sb=Ka.a.instance.INl(fb);if(!sb.length)return lb.sort(Na.vtj),lb;ab=sb[0];for(Ga=1;Ga<sb.length;Ga++)if(wb=sb[Ga],2!==ab.AL||2!==wb.AL)Ua=fb.substring(ab.cp,wb.cp),Ua=Ua.trim(),Na.lDi(Ua,ab)&&lb.push(Ua),ab=wb;Ua=fb.substring(ab.cp,fb.length);Ua=Ua.trim();Na.lDi(Ua,ab)&&lb.push(Ua);lb.sort(Na.vtj);return lb}static lDi(fb,lb){return""!==fb&&'"'!==fb&&1!==lb.AL}static P2n(fb){for(let lb=0;lb<fb.length;lb++)fb[lb]=fb[lb].split(Na.M8c).join("\\s+");return fb}static vtj(fb,lb){return fb.length>lb.length?
-1:fb.length===lb.length?0:1}}Na.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");Na.M8c=RegExp("\\s+");Na.aTn=[new L.a(RegExp("\\[","g"),"\\["),new L.a(RegExp("\\]","g"),"\\]"),new L.a(RegExp("\\\\","g"),"\\\\"),new L.a(RegExp("\\^","g"),"\\^"),new L.a(RegExp("\\$","g"),"\\$"),new L.a(RegExp("\\.","g"),"\\."),new L.a(RegExp("\\|","g"),"\\|"),new L.a(RegExp("\\+","g"),"\\+"),new L.a(RegExp("\\(","g"),"\\("),new L.a(RegExp("\\)","g"),"\\)"),new L.a(RegExp("\\?","g"),
"\\?"),new L.a(RegExp("\\*","g"),"\\*")];Object(E.a)(Na,"SearchAndFindUtils",null,[]);class sa{I1c(fb){return Pa.a.fga(fb,Na.aTn)}dLb(fb){fb=Na.dLb(fb);return fb=Na.P2n(fb)}m2i(){return null}O_d(){return!1}static get instance(){return null!=sa.SBg?sa.SBg:sa.SBg=new sa}}Object(E.a)(sa,"QueryProcessor",null,[1277]);var wa=c(720),ja=c(22),ha=c(12),va=c(28),xa=c(642),ma=c(756),Ja=c(202),oa=c(235);class za{constructor(){this.C4c=this.transaction=null;this.hIa=this.t6f=0;this.q6f=this.nfb=null}}Object(E.a)(za,
"ReplaceAllContext",null,[]);class Fa{constructor(fb,lb,sb,ab,Ga,Ua,wb,cc,zb,nb,eb){this.Lnn=(Ib,Xa,Ra,gb,Bb)=>{let $b=null;if(Ib>Xa)for($b=Ra;0<Xa&&$b.nodeId.equals(Bb.id);)$b=this.nC.l1a($b),--Xa;else 0<Ib?$b=this.nC.t7b(Ra):gb.nodeId!==Bb.id&&($b=gb);return $b};this.LDh=()=>{const Ib=this.nC.Bkb;if(Ib&&0<Ib.length){const Xa=this.Gc.Oc(3);Xa.Cb(this.gp.vj.Db(Ib[0]));for(let Ra=0;Ra<Ib.length;++Ra){const gb=this.gp.vj.Db(Ib[Ra]);gb?gb.kma(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",
Ib[Ra])}Xa.dispose();Array.clear(this.nC.Bkb)}};this.wtn=(Ib,Xa)=>{this.Mzc=!0;this.j$i();const Ra=new za;Ra.C4c=Ib?Ib:"";Ra.q6f=Xa;Ra.hIa=this.nC.qja;Ib=this.Gc.Oc(15);Ib.Cb(this.gp.Uc);Ra.transaction=Ib;this.mxl(Ra,Ib)};this.dnn=(Ib,Xa)=>{Ib=new wa.a(null,this.gIn,Ib);const Ra=this.gp.Uc;Ra&&Ra.IH().hF.w7(9);Ib.Jl("ReplaceAll");Xa.rHa(Ib);Ib.run()};this.mrn=(Ib,Xa)=>{Ib=this.ge.$f("UserAction","OnProcessReplaceAll");if(this.hQm(Xa))return this.j2k(Xa),!1;let Ra=Xa.nfb;Ra||(Ra=this.nC.UDa);Xa.nfb=
this.nC.t7b(Ra);const gb=this.gp.vj.Db(Ra.nodeId);if(!gb)return k.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Ra.id,Ra.nodeId),!0;const Bb=gb.VOa();if(Bb&&Bb.length)if(this.oUk(gb,Bb[0].begin,Bb[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",gb.id);else{let $b=0;for(let Qb=0;Qb<Bb.length;++Qb){Xa.t6f+=1;const Ac=this.replaceText(this.$A.fkf,gb,Xa.C4c,va.a.createTextRange(gb,Bb[Qb].begin+$b,
Bb[Qb].end+$b));$b+=Xa.C4c.length-(Bb[Qb].end-Bb[Qb].begin)+Ac;gb.ibg(0,Xa.C4c.length)}0<Xa.C4c.length&&this.nC.Bkb.push(Ra.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Ra.id,Ra.nodeId);Ib.stop();return!0};this.Gln=Ib=>{Ib.transaction.dispose();this.Mzc=!1;this.$A.DZa(!1);Ib.q6f&&Ib.q6f(Ib.t6f,Ib.hIa)};this.Yrn=(Ib,Xa,Ra,gb)=>{!Ib.matchCase&&0<Ra.length&&(Ib=Xa.hEa().substr(gb.cpBegin,gb.cpEnd-gb.cpBegin),Ra=this.ZSk(Ra,Ib));return this.Nzc(gb,
Ra,!0,!1)};this.$A=fb;this.nC=lb;this.gp=sb;this.Gc=ab;this.rIe=Ga;this.E7j=wb;this.kKg=cc;this.Nzc=zb;this.M9j=nb;this.ge=eb;this.Mzc=!1;this.rBo=this.wtn;this.gIn=this.mrn;this.j2k=this.Gln;this.mxl=this.dnn;this.j$i=this.LDh;this.replaceText=this.Yrn;this.ZSk=Fa.Qkn;this.W3l=this.Lnn}get P0(){return this.rIe.value}get B4c(){return this.Mzc}replace(fb){var lb=!1;if(this.B4c)return k.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),lb;if(this.P0.Kfl){var sb=
this.P0.I3;const Ua=sb.node;sb.contextId===ha.a.paragraph&&(sb=va.a.createTextRange(Ua,0,W.ParagraphReader.textLength(Ua)));var ab=Object(x.a)(58,Ua);if(ab){var Ga=new ma.a(sb.cpBegin,sb.cpEnd);Ga=ab.h$h(Ga);if(Ga!==xa.a.invalid&&0<=Ga){if(this.YBh(sb))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),lb;this.Mzc=!0;lb=this.Gc.Oc(15);lb.Cb(Ua);this.replaceText(this.$A.fkf,ab,fb,sb);lb.dispose();this.j$i();ab.ibg(Ga,fb.length);0<fb.length&&this.nC.Bkb.push(Ua.id);
fb=this.nC.q8b(Ua.id);sb=this.nC.l1a(fb);ab=ab.VOa();ab=this.gp.Y3d(Ua.id,ab,null,fb.type,fb.lXd);this.nC.xde(Ua.id,ab);(sb=this.W3l(ab.length,Ga,fb,sb,Ua))?this.$A.i5c.Xji(sb.id):this.nC.eqb();lb=!0;this.Mzc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");
lb?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this.$A.r6f=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.$A.i5c.Uji());return lb}replaceAll(fb,lb){this.B4c?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.nC.qja?this.rBo(fb,lb):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}YBh(fb){const lb=this.E7j(fb);!lb&&this.kKg.value&&this.M9j.value&&this.kKg.value(fb.node);
return lb}oUk(fb,lb,sb){return this.YBh(va.a.createTextRange(fb,lb,sb))}hQm(fb){return fb.nfb===this.nC.UDa}static get characterPropertiesEditor(){return null!=Fa.qwg?Fa.qwg:Fa.qwg=ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static WE(fb,lb){const sb=new u.a(()=>H.App.qd&&H.App.qd.Qp?Object(y.a)(H.App.qd.Qp,H.App.qd.Qp.QF,"acquireAndApplyLock"):null);return new Fa(fb,lb,aa.FindManagerHelper.instance,new w.a,new u.a(()=>Ja.a.instance),new u.a(()=>X.a.instance),Object(y.a)(oa.a.instance,
oa.a.instance.lHm,"isContextSetInLockedRange"),sb,Object(y.a)(Fa.characterPropertiesEditor,Fa.characterPropertiesEditor.replaceTextRange,"replaceTextRange"),new u.a(()=>H.App.qd.Qo),H.App.xa.Gq)}static createInstance(fb,lb){return Fa._instance||(Fa._instance=Fa.WE(fb,lb))}static Qkn(fb,lb){const sb=Pa.a.Ug(lb);!Pa.a.localeCompare(Pa.a.VA(lb),lb)&&Pa.a.localeCompare(sb,lb)?fb=Pa.a.VA(fb):Pa.a.Kbc(lb.charAt(0))&&!Pa.a.kEf(lb.charAt(0))&&(lb=Pa.a.VA(fb.substr(0,1)),fb=1===fb.length?lb:lb+fb.substr(1,
fb.length-1));return fb}}Fa._instance=null;Object(E.a)(Fa,"ReplaceManager",null,[1586]);c.d(K,"FindManager",function(){return kb});class kb extends U.a{constructor(fb,lb,sb,ab,Ga,Ua,wb,cc,zb,nb,eb,Ib,Xa,Ra,gb,Bb=!1){super(fb,lb,sb,Ga,Ua,Xa,Ra,eb,Ib);this.pka=this.sAc=null;this.Nxd=!1;this.RBa=this.$9a=this.Pab=null;this.Csc=0;this.nvd=ab;this.Xub=wb;this.Wc=cc;this.Gc=zb;this.FNe=nb;this.x2j=gb;this.iwc=[];this._state=2;this.zxb=!Bb;this.lsb=new J;this.gp.lZe(this.lsb);this.tZb=new J;this.gp.lZe(this.tZb);
this.gp.Uc&&(this.Pab=this.gp.vj);this.Cog=400;this.enc=100}get lb(){return this.Xub.value}get fkf(){return this.sAc}get WLd(){return this.x2j.value}DZa(fb=!0){this.UMb&&this.UMb.B4c||(this.jeb(fb),this.J$a.reset(),this.FYa="",this.nvd&&this.WLd.stop(),this.YXk(),this.Hmj(null))}YXk(){this.g7&&(this.taskManager.We(this.g7),this.g7=null);this.jKa&&(this.taskManager.We(this.jKa),this.jKa=null)}jeb(fb=!0){!this.Pab&&0<this.Kj.v7a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});
if(0<this.Kj.v7a&&this.Pab){let sb=this.Kj.UDa;const ab=sb.nodeId;if(this.Pab.Db(ab)){const Ga=this.Gc.Oc(3);for(Ga.Cb(this.Pab.Db(ab));sb;){const Ua=this.Pab.Db(sb.nodeId);var lb=Object(x.a)(58,Ua);if(lb){if(this.zxb&&(lb.kma(void 0,fb),W.ParagraphReader.Vb(Ua)&&(lb=this.gp.p8h(Ua))))for(const wb of lb)wb.kma(void 0,fb);Ua.Tk(16,!0)}sb=this.Kj.t7b(sb);if(!sb||sb.nodeId.equals(ab))break}Ga.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Kj.TDh()}fb&&
this.UMb&&this.UMb.LDh();this.gdj();this.iwc=[];this.OUb=this.sAc=null;this.IL=0;this.r6f=this.Nxd=!1}e5c(){const fb=this.jW;this.jeb();fb&&""!==fb.text&&this.find(fb)}Voj(){return""===this.FYa}umi(){return this.nvd&&this.WLd.dpm}Cdj(){10>this.Csc?(this.Csc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.Csc}),this.find(this.jW)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.va.processAction(G.a.lAb,2),this.Csc=
0)}F6i(){var fb=(new Date).getTime();let lb=!1;this.Kj.v7a||(lb=!0);let sb=0;if(!lb){this.Kj.Z9||(this.Kj.Z9=this.Kj.UDa);this.Kj.w3||(this.Kj.w3=this.Kj.Z9,this.Kj.BE=null);let ab=null,Ga=!0;for(;!lb&&this.Kj.w3&&(new Date).getTime()-fb<U.a.MMi;){const Ua=this.Kj.w3,wb=this.gp.vj.Db(Ua.nodeId);wb?(Ga&&(ab=this.Gc.Oc(3),ab.Cb(wb),Ga=!1),Ua.lXd&&!this.$9a&&(this.$9a=wb),this.Kj.w3=this.Kj.t7b(this.Kj.w3),lb=!this.Kj.w3||this.Kj.w3.nodeId.equals(this.Kj.Z9.nodeId),this.awf(wb,Ua.type,this.zxb),++sb):
this.Kj.d4c(Ua.nodeId)}ab&&ab.dispose()}this.Kj.eqb();lb&&(this.Kj.w3=null,this.Nxd?this._state=0:(this._state=2,this.Cob(!0)));this.g7=new f.a(2,1,this.enc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.g7);fb=(new Date).getTime()-fb;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:fb,["Count"]:sb,["Total"]:this.Kj.qja,["TotalWithDirty"]:this.Kj.v7a})}eFn(){this.jeb();this.IL=0;if(this.gp.$Bf&&this.zxb){var fb=this.lb;if(fb){var lb=fb.gb.kb;if(lb){var sb=
H.App.xa.hb.rc;(sb=sb?sb.Ns:null)&&sb.g7a();lb=V.SelectionEditor.xj(lb,!1,!1);fb.setSelection(lb);sb&&sb.cZa()}}}fb=this.Gll();this.pka=this.o2j.n8h(fb)}Imj(){this.Hmj(this.pka[this.IL].gja)}Hmj(fb){this.umo(fb);this.Yjj(fb)}gdj(){this.$9a=null;this.HVb=!1}Trf(fb){const lb=this.Wc.yk();lb.set(fb);if(!lb.zb(7))return lb.reset(),null;if(this.gp.F4d(lb,7,0))return fb=lb.currentNode,lb.reset(),fb;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");lb.reset();return null}Gll(){if(this.gp.$Bf){var fb=
this.lb;if((fb=fb?fb.gb.kb:null)&&this.zxb)return fb.Pc.el?(fb=fb.Pc,V.SelectionEditor.jv(fb)?(fb=fb.node,Object(n.a)(58,fb)?fb:this.Trf(fb)):Object(n.a)(58,fb.node)?fb.node:this.Trf(fb.node)):this.Trf(this.gp.Uc);fb=this.Wc.yk();fb.set(this.gp.Uc);if(this.gp.Ikg(fb,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const lb=fb.currentNode;fb.reset();return lb}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,
313,10,"Error: ContentView isn't PageView");return null}Ytf(){const fb=this.Wc.yk();fb.set(this.tZb);if(1===fb.xq())return fb.Qd(),fb.currentNode;k.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}umo(fb){const lb=this.Gc.Oc(3);lb.Cb(this.tZb);const sb=this.Wc.yk();sb.set(this.tZb);sb.wA()&&(sb.Qd(),sb.Cg());fb&&(sb.Jf(fb,81),fb=this.pka[this.IL],this.tZb.r8f=fb.rootNode.type,this.tZb.hkf=fb.j6b);lb.dispose()}nSl(){if(this.lsb){var fb=this.Wc.yk();fb.set(this.lsb);
if(fb.xq())return fb.Qd(),fb.currentNode;fb=this.FNe(this.gp.Uc);fb.moveNext();if(fb.currentNode)return fb.currentNode}k.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");return null}Yjj(fb){const lb=this.Gc.Oc(3);lb.Cb(this.lsb);const sb=this.Wc.yk();sb.set(this.lsb);sb.wA()&&(sb.Qd(),sb.Cg());fb&&(sb.Jf(fb,81),fb=this.pka[this.IL],this.lsb.r8f=fb.rootNode.type,this.lsb.hkf=fb.j6b);lb.dispose()}VSd(){let fb=this.Kj.BE||this.Kj.UDa;if(fb){for(var lb=!1,sb=!0;fb;){var ab=
this.gp.vj.Db(fb.nodeId);if(ab=Object(x.a)(58,ab))if(lb=ab.NLf(fb.type)){sb&&(fb=this.Kj.l1a(fb));break}else fb=this.Kj.l1a(fb);else if(sb=fb,fb=this.Kj.t7b(fb),this.Kj.d4c(sb.nodeId),!fb||sb.nodeId.equals(fb.nodeId))break;sb=!1}lb?(this.Kj.BE=fb,this.Kj.eqb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}WSd(){let fb=this.Kj.BE||this.Kj.UDa;if(fb){for(var lb=!1,sb=!0;fb;){var ab=this.gp.vj.Db(fb.nodeId);if(ab=
Object(x.a)(58,ab))if(lb=ab.PLi(fb.type)){sb&&(fb=this.Kj.nRd(fb));break}else fb=this.Kj.nRd(fb);else if(sb=fb,fb=this.Kj.aai(fb),this.Kj.d4c(sb.nodeId),!fb||sb.nodeId.equals(fb.nodeId))break;sb=!1}lb?(this.Kj.BE=fb,k.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Kj.eqb()}}ySk(){return 2===this._state&&(this.r6f||this.nvd&&this.WLd.Kdj)}zSf(){this.gp.Boa?(this.FYa=this.Jea.I1c(this.jW.text),this.Pab=this.gp.vj,
this.gdj()):this.Cdj()}kuj(){this.nvd&&this.WLd.start()}L5e(){if(!this.gp.Boa||this.Pab!==this.gp.vj)return this.jeb(),this.Cdj(),!0;this.Csc=0;return!1}u7f(){const fb=this.Jea.dLb(this.FYa),lb=this.ySk();let sb=!1;if(lb||this.gp.bAi(this.sAc,this.iwc,this.jW,fb)){sb=!0;this.Cob(!1);this.J$a.update();this.J$a.kkf();!lb&&this.gp.mAi(this.sAc,this.iwc,this.jW,fb)?(this.Kj.WLi(),this.Kj.w3=null,this._state=1):(this.eFn(),this.Imj(),this._state=0,this.Nxd=!0);this.sAc=this.jW;this.iwc=fb;try{this.OUb=
this.PUb.n8b(this.iwc.join("|"),this.jW)}catch(ab){return k.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.jW.matchCase,this.jW.matchWholeWord),this.OUb=null,this._state=2,this.Cob(!0),!0}this.g7=new f.a(2,1,this.enc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.g7)}return sb}CSi(){if(!this.$9a){const fb=this.Wc.yk();fb.set(1===this.pka[this.IL].j6b?this.gp.Uc:this.pka[this.IL].rootNode);
this.gp.Ikg(fb,this.pka[this.IL].rootNode.type,this.pka[this.IL].j6b)?(this.$9a=fb.currentNode,fb.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),fb.reset(),this.g7=new f.a(2,1,this.enc,Object(y.a)(this,this.findInternal,"findInternal"),52),this.taskManager.Wb(this.g7))}}jSf(){this.Kj.eqb();this.Yjj(this.RBa.currentNode);this.RBa.currentNode===this.Ytf()&&(this.IL++,this.IL===this.pka.length?(this.IL=0,this._state=2,this.Nxd=!1,this.Cob(!0)):this.Imj());this.RBa=
null}pgi(){return this.Ytf()}i2i(){const fb=this.nSl();this.RBa=this.Wc.yk();this.RBa.set(fb);this.RBa.m1(this.pka[this.IL].rootNode)}jnj(){const fb=this.Gc.Oc(3);fb.Cb(this.RBa.currentNode);return fb}qWf(){this.awf(this.RBa.currentNode,this.pka[this.IL].j6b,this.zxb);this.gp.F4d(this.RBa,this.pka[this.IL].rootNode.type,this.pka[this.IL].j6b)}R8e(fb){return!!this.RBa.currentNode&&!this.RBa.currentNode.id.equals(fb.id)}oCh(fb){!this.HVb&&this.$9a&&fb.id===this.$9a.id&&this.Ytf().id!==this.$9a.id&&
0<this.Kj.v7a&&(this.HVb=!0,this.Kj.$cj())}gzd(fb,lb,sb,ab){const Ga=this.Kj.q8b(fb);Ga?this.Kj.xde(fb,lb):this.HVb?this.Kj.Mmh(lb):this.Kj.lzd(lb);this.zxb&&!this.Kj.BE&&0<lb.length&&sb.NLf(ab)&&(this.Kj.BE=Ga?Ga:lb[0],this.Kj.Z9||(this.Kj.Z9=this.Kj.BE))}WSa(fb,lb){fb.WSa(lb)}kma(fb){this.zxb&&fb.kma()}ZLf(fb){fb.Tk(16,!0)}static WE(fb,lb,sb,ab,Ga=!1){lb||(lb=sa.instance);sb||(sb=ca.instance);const Ua=qa.createInstance(fb,sb.Rgg,Ga),wb=new u.a(()=>Fa.createInstance(kb.instance,kb.instance.Kj)),
cc=new u.a(()=>La.createInstance(kb.instance.Kj)),zb=new u.a(()=>la.createInstance(kb.instance,fb));return new kb(fb,lb,sb,ab,aa.FindManagerHelper.instance,new u.a(()=>l.AFrameworkApplication.pc),new u.a(()=>X.a.instance),new z.a,new w.a,F.a.createInstance,a.a.instance,Ua,wb,cc,zb,Ga)}static get instance(){return kb._instance}static createInstance(fb,lb=null,sb=null,ab=!1,Ga=!1){return Ga?kb.WE(fb,lb,sb,ab,!0):kb.instance||(kb._instance=kb.WE(fb,lb,sb,ab))}}kb._instance=null;Object(E.a)(kb,"FindManager",
U.a,[])},1957:function(E,K,c){E=c(0);var l=c(22),f=c(2),a=c(239),k=c(44),x=c(6),y=c(15),n=c(42),u=c(7),z=c(73),w=c(110),F=c(74),G=c(86),H=c(207),L=c(12),I=c(5),N=c(588),P=c(101),M=c(817),J=c(1030),V=c(36),X=c(218),W=c(205),U=c(81);class Y{constructor(zb){this.ipa=zb}}Object(E.a)(Y,"ValidParentData",null,[]);var ca=c(40),aa=c(334),fa=c(658),pa=c(363),ra=c(657),la=c(509);class qa{constructor(){this.w4b=0}}Object(E.a)(qa,"BelowOutlineElementData",null,[]);var La=c(629),Pa=c(859),Ka=c(532);class Na extends La.a{constructor(zb,
nb,eb,Ib){super(4,Ib);this.v4b=zb;this.Qyb=nb;this.REc=eb}Q8b(){var zb=this.v4b;if(!zb)return u.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const nb=[],eb=new Pa.a(this.v4b.id,this.v4b.Lc,this.Qyb?this.Qyb.id:null);""!==zb.characterData&&zb.characterData&&(zb=new Ka.DeleteTextUpdateHint(this.v4b.id,0,zb.characterData),nb.push(zb));nb.push(eb);return nb}}Object(E.a)(Na,"DeleteParagraphOperation",La.a,[]);var sa=c(940),wa=
c(464);class ja extends La.a{constructor(zb,nb,eb,Ib,Xa){super(3,Xa);this.kpa=zb;this.rRa=nb;this.vfn=eb;this.kxa=Ib}Q8b(){const zb=[];var nb=new sa.AddParagraphUpdateHint(this.kxa.id,this.kxa.Lc,this.kpa?this.kpa.id:null);zb.push(nb);""!==this.kxa.characterData&&this.kxa.characterData&&(nb=new wa.a(this.kxa.id,0,this.kxa.characterData),zb.push(nb));return zb}}Object(E.a)(ja,"InsertNewParagraphOperation",La.a,[]);var ha=c(939);class va extends La.a{constructor(zb,nb,eb,Ib){super(2,Ib);this.kpa=zb;
this.rRa=nb;this.W3d=eb}Q8b(){const zb=[],nb=new ha.MergeParagraphUpdateHint(this.kpa.id,this.kpa.Lc,this.kpa.characterData.length,this.rRa.id,this.rRa.Lc,this.W3d.id,this.W3d.Lc);zb.push(nb);return zb}}Object(E.a)(va,"MergeParagraphOperation",La.a,[]);var xa=c(858);class ma extends La.a{constructor(zb,nb,eb,Ib,Xa){super(1,Xa);this.D4=zb;this.Ntj=nb;this.Qyb=eb;this.REc=Ib}Q8b(){const zb=[],nb=new xa.a(this.D4.id,this.D4.Lc,this.Ntj,this.Qyb.id,this.Qyb.Lc,this.REc.id,this.REc.Lc);zb.push(nb);return zb}}
Object(E.a)(ma,"SplitParagraphOperation",La.a,[]);var Ja=c(373),oa=c(9),za=c(529),Fa=c(43),kb=c(1091),fb=c(32),lb=c(124),sb=c(235),ab=c(8),Ga=c(178),Ua=c(13),wb=c(103);c.d(K,"a",function(){return cc});class cc{constructor(zb,nb,eb,Ib,Xa,Ra,gb=null,Bb=null,$b=null,Qb=null,Ac=null){this.q9=Ac;this.tK=zb;this.qK=nb;this.If=eb;this.w6=gb;this.Ru=Bb;this.Uy=$b;this.Ip=Qb}rpk(zb){var nb;(null===(nb=oa.App.qd)||void 0===nb?0:nb.Qo)&&oa.App.qd.Qp.QF(zb)}Dya(zb,nb,eb,Ib=!1){V.OutlineElementNavigator.Ge(zb);
ab.ParagraphReader.sh(zb)?cc.paragraphEditor.gq.Dya(zb,nb,eb):fb.TableReader.isTable(zb)&&14===zb.Ve&&(nb=(new pa.a(1,eb)).Lt,eb=Object(z.a)(aa.TableNode,zb.currentNode),this.Smj(eb,nb,Ib));V.OutlineElementNavigator.Vd(zb)}Smj(zb,nb,eb=!1){zb&&Object(w.a)(aa.TableNode,zb)&&(eb?nb?(zb.setValue(x.a.$d,nb),nb=fb.TableReader.Yg(zb),cc.vk.Vag(zb,nb)):zb.removeProperty(x.a.$d):zb.$d=nb)}get gq(){return J.a.NEb}get ZG(){return this.Ru||(this.Ru=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get wc(){return this.Uy||
(this.Uy=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Ld(){return null!=this.$Hg?this.$Hg:this.$Hg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.LHg?this.LHg:this.LHg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Un(){return this.qK.value}get Gd(){return this.If.value}get lL(){return this.tK.value}get Xf(){return sb.a.instance}get BD(){return null!=this.Twg?this.Twg:this.Twg=l.a.instance.Na("Box4.IContentControlConverter")}ffb(){const zb=
M.a.instance.createInstance(393229);zb.setValue(y.a.mL,X.a.first);zb.setValue(y.a.Rel,new Date);zb.qmc();return zb}Ibl(){const zb=new kb.a;zb.setValue(y.a.mL,X.a.first);return zb}jgf(zb,nb,eb=!1){ca.OutlineElementReader.BFf(zb)?(zb=ca.OutlineElementReader.isRtl(zb),eb?this.kOb(nb,zb):this.jOb(nb,zb)):this.g_n(nb)}bjc(zb,nb){const eb=V.OutlineElementNavigator.Gl(zb);ca.OutlineElementReader.an(eb)!==nb&&(this.jOb(eb,nb),zb.anchor.XX(4))}jOb(zb,nb){const eb=new Fa.GraphTransaction(7);eb.Cb(zb);this.kOb(zb,
nb);const Ib=new I.GraphIterator;Ib.set(zb);Ja.a.instance.fDm(Ib);if(Ib.zb(10)){const Xa=Ib.jd(10);Ib.Sb(1)===zb&&this.lL.jOb(Xa,nb)}eb.dispose()}kOb(zb,nb){let eb=null,Ib=null;if(G.a.instance.J(1)&&zb.isConnected){eb=ab.ParagraphReader.ow(zb,!0,!0);Ib=new F.a;for(let Xa=0;Xa<eb.count;Xa++)12===eb.J(Xa).type&&Ib.add(eb.J(Xa).MD())}zb.properties.setValue(y.a.y0,nb);if(G.a.instance.J(1)&&eb&&Ib)if(eb.count!==Ib.count)u.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",
eb.count,Ib.count);else for(zb=0;zb<eb.count;zb++)this.lj.dV(eb.J(zb),Ib.J(zb),this.Ld.rg)}g_n(zb){zb.properties.removeProperty(y.a.y0)}YI(zb,nb=null,eb=!1){var Ib,Xa=null;let Ra=null;if(!ca.OutlineElementReader.Dh(zb))return u.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let gb=null,Bb=null,$b=0;nb&&(gb=nb.formatting,Bb=nb.cra,$b=nb.languageId);eb||({kpa:Xa,rRa:Ra}=this.W2h(zb,Xa,Ra));nb=H.a.instance.createInstance(393230);nb.setValue(y.a.mo,"");zb.Jf(nb,
2);zb.Fi(nb);cc.paragraphEditor.LMb(nb);cc.paragraphEditor.O8m(nb);cc.paragraphEditor.hUa(nb);this.rpk(nb);f.AFrameworkApplication.uJ&&!f.AFrameworkApplication.Saj&&(f.AFrameworkApplication.te("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),(null===(Ib=f.AFrameworkApplication.K)||void 0===Ib?0:Ib.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.fIk());gb&&(nb.pa.first.formatting.Qj=gb);$b||($b=f.AFrameworkApplication.lcid);zb.currentNode.Zg(y.a.t5c,zb.currentNode.ia(y.a.t5c,
$b));zb.currentNode.setValue(x.a.LRa,0);Bb&&this.ZG.PJ(Bb,nb,!0);!eb&&Xa&&(eb=new la.a(nb),Xa=new ja(Xa,Ra,Xa,eb,nb.Uma),zb.currentNode.IH().hF.HI(Xa));return nb}fIk(){if(this.q9){for(var zb,nb=this.q9.vkf();nb;){const eb=nb.node;if(0<ab.ParagraphReader.textLength(eb,9)&&(zb=lb.AParagraphNode.GVl(eb.characterData.trim()),0<zb.length))break;nb=nb.next}zb&&32===f.AFrameworkApplication.va.Qb(Ua.a.renameFile,2,zb)&&this.Ip&&(this.Ip.execute(eb=>{eb.logActivity("AutoRenameDocumentCallout",null)}),k.a("AutoRenameDocumentSuccess"))}}W2h(zb,
nb,eb){eb=new I.GraphIterator;eb.Zc(zb);nb=null;eb.aDf?eb.currentNode.IH().hF.w7(6):(V.OutlineElementNavigator.q0(eb,!0,!1),nb=this.qPd(eb));eb.Zc(zb);eb=this.c4h(eb);return{kpa:nb,rRa:eb}}c4h(zb){const nb=new I.GraphIterator;nb.Zc(zb);zb=null;nb.vFa||(V.OutlineElementNavigator.Ur(nb,!0,!1),zb=this.qPd(nb));return zb}qPd(zb,nb=!1){zb=V.OutlineElementNavigator.Ge(zb,!0);return zb?this.l9h(zb,nb):(u.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}l9h(zb,nb=!1){if(12===
zb.type)return nb?new la.a(zb):new ra.a(zb);zb.IH().hF.w7(5);return new fa.a(zb)}YYk(zb,nb){var eb=nb.currentNode.clone();zb.LH(eb,null,1);zb.Fi(eb);eb.Uaa=nb.currentNode;V.OutlineElementNavigator.Ge(nb);nb.y8&1&&nb.currentNode.cRb(null);eb=nb.currentNode.clone();eb.RHa=nb.currentNode.RHa;eb.lN=nb.currentNode.lN;zb.LH(eb,null,2);zb.Fi(eb);zb.S_(1);eb.Uaa=nb.currentNode;eb.setValue(x.a.Lc,a.a.tF());nb.Ht(11)}LMb(zb){zb.Sb(2)&&zb.Cg()}A2n(zb,nb){const eb=zb.currentNode;V.OutlineElementNavigator.Ge(zb);
const Ib=zb.currentNode;V.OutlineElementNavigator.Vd(zb);nb.gF(1);V.OutlineElementNavigator.Ge(nb);zb.Jf(nb.currentNode,2);nb.Cg();var Xa=new I.GraphIterator;Xa.Zc(nb);if(Xa.Sb(1)){const Ra=new I.GraphIterator;Ra.Zc(zb);const gb=new Y(null);if(!this.Ehm(Ra,Xa.currentNode,gb))return;N.f(Ra,null,1,1,Xa,-1)}nb.Cg();Xa=null;zb.NC(1)&&(Xa=zb.currentNode);for(zb.sc();W.OutlineNavigator.c9(nb);)zb.LH(nb.currentNode,Xa,1),Xa=nb.currentNode,nb.Cg();zb.Fi(eb);zb.Fi(Ib);zb.Cg()}X9(zb,nb,eb,Ib,Xa,Ra,gb=!1,Bb=
!1){var $b=ca.OutlineElementReader.Dh(zb),Qb=ca.OutlineElementReader.Dh(nb),Ac=eb.isValid&&eb.contextId===L.a.Tc;$b&&Qb&&Ac||u.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",$b,Qb,Ac);var Db=zb.currentNode;this.LMb(nb);Qb=nb.Ve;let dc,Pb=null;$b=Ac=null;let Ub=!1;V.OutlineElementNavigator.Ge(zb);const rb=zb.Ve;if(ab.ParagraphReader.sh(zb)){dc=zb.currentNode;(Ac=Object(z.a)(lb.AParagraphNode,dc))?Ac.pa&&Ac.pa.length||
u.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Ac):u.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");Ac=new la.a(Ac);(Ub=eb.cpBegin===ab.ParagraphReader.textLength(dc))&&($b=this.c4h(nb));const Yb=nb.currentNode;Pb=this.YI(nb,void 0,!0);cc.paragraphEditor.qTa(zb,nb,eb,Xa,Ra,gb,Bb);Ib?(Xa=this.wc.No(dc))&&this.ZG.PJ(Xa,Pb,!0):Ub&&(Xa=this.wc.No(dc))&&((Bb=Xa.ia(n.a.Xd,null))?(Xa=this.wc.MC(Pb).Pi(Bb),this.ZG.PJ(Xa,Pb,!1)):this.ZG.PJ(Xa,Pb,!0));
this.jgf(Db,Yb)}V.OutlineElementNavigator.Vd(zb);V.OutlineElementNavigator.Vd(nb);V.OutlineElementNavigator.Ge(zb);(Db=Object(z.a)(lb.AParagraphNode,zb.currentNode))?Db.pa&&Db.pa.length||u.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Db):u.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Db=new la.a(Db);V.OutlineElementNavigator.Vd(zb);(zb=Pb)?zb.pa&&zb.pa.length||u.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",
zb):(u.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),u.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:Ub,["moveText"]:Ra,["overrideParagraphStyle"]:Ib,["sourceOutlineElementContentNodeType"]:rb,["destinationOutlineElementNodeType"]:Qb,["alwaysMoveEopToDestinationPara"]:gb}));Ub?(eb=new la.a(zb),eb=new ja(Ac,$b,Db,eb,zb.Uma),nb.currentNode.IH().hF.HI(eb)):(eb=Ra?new ma(Ac,eb.cpBegin,Db,new la.a(zb),zb.Uma):new ma(Ac,eb.cpBegin,new la.a(zb),Db,zb.Uma),nb.currentNode.IH().hF.HI(eb))}gAh(zb,
nb){V.OutlineElementNavigator.Ge(zb);let eb=ab.ParagraphReader.Xt(zb.currentNode)&&this.eSk(zb);const Ib=zb.currentNode;eb=nb?eb&&!this.Xf.bzn(Ib):eb&&!this.Xf.Syn(Ib);V.OutlineElementNavigator.Vd(zb);return eb}eSk(zb){return ab.ParagraphReader.sh(zb)&&!ab.ParagraphReader.Neb(zb.currentNode)}merge(zb,nb,eb,Ib,Xa=null,Ra=!1,gb,Bb=!1,$b=!1,Qb=!1){var Ac;if(zb.currentNode.id===nb.currentNode.id)return!1;let Db;const dc=new I.GraphIterator;dc.Zc(nb);gb=this.qPd(dc);dc.Zc(zb);Db=this.qPd(dc,!0);if(!this.gAh(nb,
!0)||!this.gAh(zb,!1))return!1;if(this.Xf.gh){V.OutlineElementNavigator.Ge(zb);V.OutlineElementNavigator.Ge(nb);var Pb=ab.ParagraphReader.sh(zb)?zb.currentNode:null,Ub=ab.ParagraphReader.sh(nb)?nb.currentNode:null;V.OutlineElementNavigator.Vd(zb);V.OutlineElementNavigator.Vd(nb);if(Pb&&Ub&&!this.Xf.hAh(Pb,Ub,!1)){if(!this.BD||!this.Xf.hAh(Pb,Ub,!0))return!1;this.BD&&(this.BD.CCj(Pb,!1),this.BD.CCj(Ub,!0))}}Pb=Object(z.a)(lb.AParagraphNode,zb.currentNode);Pb=(eb||!Pb||!Pb.characterData.length)&&!wb.ListItemReader.Ig(zb);
Bb||this.Un.merge(zb,nb,Pb,Xa);V.OutlineElementNavigator.Ge(zb);Xa=zb.currentNode.Uma;V.OutlineElementNavigator.Ge(nb);if(ab.ParagraphReader.sh(nb)){Bb=nb.currentNode;if(null===(Ac=oa.App.qd)||void 0===Ac?0:Ac.Qo)if(Ac=zb.currentNode,Pb=za.CoauthLockEditor.getInstance(),Pb.G6a(this.Xf.d7b(Bb))||Pb.G6a(this.Xf.d7b(Ac)))return nb.sc(),zb.sc(),!1;Ac=!1;(Bb=zb.parentNode)&&ca.OutlineElementReader.Aoa(Bb)&&(Ac=wb.ListItemReader.Ig(Bb));(Bb=this.Lpo(ab.ParagraphReader.isEmpty(zb),Ac,eb,Ib,$b))&&(Pb=this.wc.buf(nb))&&
this.ZG.PJ(Pb,zb.currentNode,!0);eb&&(Pb=nb.currentNode,Ub=zb.currentNode,(Bb||Ac)&&Ga.b(Pb,Ub),$b&&Ib||this.w6.ANi(Pb,Ub,Ac),f.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),Qb&&($b=this.P6k(Ub,Pb),u.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",$b)));eb=cc.paragraphEditor.merge(zb,nb,eb,Ib,Ra);Ra=dc.currentNode;Ib=zb.currentNode;zb.sc();eb&&ca.OutlineElementReader.isEmpty(nb,!0)&&this.Q_a(nb);zb=new va(Db,gb,new ra.a(Ra),Xa);Ib.IH().hF.HI(zb);
return!0}nb.sc();zb.sc();return!1}P6k(zb,nb){let eb=null;nb&&nb.pa&&0<nb.pa.length&&nb.pa.first.Uh&&(eb=nb.pa.first.formatting);return eb&&zb&&zb.pa&&0<zb.pa.length&&P.FormattingReader.h4k(zb.pa)?(zb.pa.last.formatting=eb.Ef(zb.pa.last),!0):!1}Lpo(zb,nb,eb,Ib,Xa){return nb?!1:eb?!(Ib&&Xa):zb}wBm(zb){const nb=new I.GraphIterator;nb.set(zb.node);nb.vd();V.OutlineElementNavigator.Vd(nb);const eb=this.joa(nb),Ib=this.joa(nb);this.X9(nb,eb,zb,!1,!0,!0);ca.OutlineElementReader.isEmpty(nb,!1)&&(this.Un.Sca(nb),
nb.Cg());ca.OutlineElementReader.isEmpty(eb,!1)&&!ca.OutlineElementReader.Jjb(eb)&&(this.Un.Sca(eb),eb.Cg());return Ib}yA(zb,nb,eb,Ib=null,Xa=!1,Ra=!0){if(!this.aSk(zb))return null;const gb=zb.currentNode;var Bb=!1;Ra&&(Bb=wb.ListItemReader.Ig(zb),Xa=nb||Xa||!ca.OutlineElementReader.isEmpty(zb,!1),Bb=this.Un.oto(Bb,Xa));Xa=nb?zb.NC(1):zb.currentNode;zb.sc();eb=this.lL.Wib(zb,Xa,eb,Ib);if(!eb)return null;this.jgf(gb,eb);Ra&&Bb&&this.Un.nLo(zb,nb,gb,eb);return eb}aSk(zb){return ca.OutlineElementReader.Dh(zb)&&
(zb=zb.parentNode,U.OutlineReader.AZd(zb)||ca.OutlineElementReader.Aoa(zb)||ca.OutlineElementReader.jQa(zb))?!0:!1}WGa(zb){const nb=new I.GraphIterator;nb.set(zb);nb.vd();nb.Ht(11);let eb=null,Ib=null;({kpa:eb,rRa:Ib}=this.W2h(nb,eb,Ib));let Xa=-1;12===zb.type&&(Xa=zb.Uma);nb.currentNode?(nb.currentNode.IH().hF.HI(new Na(this.l9h(zb,!0),eb,Ib,Xa)),this.Q_a(nb)):u.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}Q_a(zb){if(zb.Nr(1)){const nb=new qa,eb=new I.GraphIterator;
eb.Zc(zb);this.OMl(eb,nb)&&this.gq.iJc(zb,-nb.w4b)}zb.Cg();fb.TableReader.ex(zb)&&this.WDn(zb)}uAf(zb,nb,eb){if(!U.OutlineReader.fx(zb)&&!ca.OutlineElementReader.Dh(zb))return null;const Ib=this.Ibl();0<eb&&eb<X.a.last&&Ib.setValue(y.a.mL,Math.min(X.a.nil,eb));zb.LH(Ib,nb,1);return Ib}yBm(zb,nb){if(!ca.OutlineElementReader.Dh(zb)&&!ca.OutlineElementReader.dL(zb)||!U.OutlineReader.Jwa(zb.parentNode)&&!ca.OutlineElementReader.Aoa(zb.parentNode))return null;const eb=zb.currentNode;let Ib;Ib=zb.currentNode;
zb.sc();nb=this.uAf(zb,Ib,nb);zb.Fi(eb);return nb}WDn(zb){ca.OutlineElementReader.dL(zb)&&(zb.Nr(1)||zb.Cg());this.J_h(zb,!1);this.Yqh(zb)}J_h(zb,nb){var eb,Ib=null;for(eb=zb.Sb(1);eb;){var Xa=!1;ca.OutlineElementReader.jQa(eb)&&!zb.Nr(1)&&(Xa=!0);var Ra=eb;eb=zb.xi(1);if(Xa)Xa=new I.GraphIterator,Xa.set(Ra),Xa.vd(),Xa.Cg();else if(ca.OutlineElementReader.jQa(Ra)){if(Ib){Xa=new I.GraphIterator;Xa.set(Ib);var gb=new I.GraphIterator;gb.set(Ra);gb.vd();Xa.Jf(gb.currentNode,1);gb.Cg();gb=ca.OutlineElementReader.xga(Ra);
gb===X.a.nil&&(gb=1);const Bb=ca.OutlineElementReader.xga(Ra);(gb=Math.max(0,Bb-gb))?Ra.setValue(y.a.mL,Math.min(X.a.nil,gb)):(Xa.Fi(Ra),zb.Sb(1),N.d(Xa),Xa.sc());nb&&this.J_h(Xa,!0)}}else Ib=Ra}nb=null;Ib=X.a.last+1;for(eb=zb.Sb(1);eb;eb=zb.xi(1))if(ca.OutlineElementReader.dL(zb))Ra=ca.OutlineElementReader.xga(eb),Ib>Ra&&(Ib=Ra,nb=eb);else{zb.sc();return}if(nb){for(eb=zb.Sb(1);eb;eb=zb.xi(1))eb!==nb&&(eb=ca.OutlineElementReader.xga(eb),zb.currentNode.setValue(y.a.mL,Math.min(X.a.nil,eb-Ib)));Ib+=
ca.OutlineElementReader.xga(zb.currentNode);zb.currentNode.setValue(y.a.mL,Math.min(X.a.nil,Ib));eb=new I.GraphIterator;eb.Zc(zb);eb.Fi(nb);eb.Sb(1);N.d(eb)}}Ehm(zb,nb,eb){var Ib=ca.OutlineElementReader.xga(zb.currentNode);if(1===Ib)return!0;if(ca.OutlineElementReader.dL(zb))return!1;if(!zb.hhb(1)||this.cOm(zb,nb))return zb.currentNode.setValue(y.a.mL,Math.min(X.a.nil,1)),!0;if(eb.ipa&&zb.Fi(eb.ipa)){if(ca.OutlineElementReader.dL(zb)&&1===Ib+ca.OutlineElementReader.xga(zb.currentNode))return eb.ipa=
zb.gF(1),zb.sc(),!0;zb.sc()}if(eb.ipa&&zb.Fi(eb.ipa)||!eb.ipa&&zb.Sb(1)){if(zb.currentNode!==nb&&zb.vf(1)&&ca.OutlineElementReader.dL(zb)&&1===Ib+ca.OutlineElementReader.xga(zb.currentNode))return eb.ipa=null,!0;zb.sc()}if(zb.jib(nb)&&this.bOm(zb,nb)){for(eb=zb.Sb(1);eb;eb=zb.xi(1))if(eb!==nb){var Xa=ca.OutlineElementReader.xga(eb);eb.setValue(y.a.mL,Math.min(X.a.nil,Xa+(Ib-1)))}zb.currentNode.setValue(y.a.mL,Math.min(X.a.nil,1));return!0}if(1>Ib)return Ib=this.uAf(zb,eb.ipa,1-Ib),zb.Fi(Ib),eb.ipa=
null,!0;if(1<Ib){zb.currentNode.setValue(y.a.mL,Math.min(X.a.nil,1));nb=null;for(Xa=zb.Sb(1);Xa;){if(ca.OutlineElementReader.dL(zb)){Xa.setValue(y.a.mL,Math.min(X.a.nil,Ib-1+ca.OutlineElementReader.xga(Xa)));Xa=zb.xi(1);continue}nb||(nb=this.yBm(zb,Ib-1));const Ra=Xa;Xa=N.h(zb,nb,1);Xa===nb&&(Xa=zb.xi(1));eb.ipa===Ra&&(eb.ipa=nb,nb=null)}return!0}return!1}cOm(zb,nb){return I.GraphIterator.pba(()=>{if(1===zb.hhb(1)){const eb=zb.Sb(1);zb.sc();if(eb===nb)return!0}return!1})}bOm(zb,nb){return I.GraphIterator.pba(()=>
{let eb;for(eb=zb.Sb(1);eb;eb=zb.xi(1))if(eb!==nb&&!ca.OutlineElementReader.dL(zb))return zb.sc(),!1;return!0})}OMl(zb,nb){nb.w4b=0;do{const eb=zb.currentNode;if(zb.Sb(1))nb.w4b-=ca.OutlineElementReader.xga(eb);else{if(U.OutlineReader.fx(zb)||null===zb.currentNode)return!1;if(3!==zb.role||!zb.Tga(1))for(;!zb.xi(1);)if(nb.w4b+=ca.OutlineElementReader.xga(zb.currentNode),U.OutlineReader.fx(zb)||null===zb.currentNode)return!1}}while(ca.OutlineElementReader.dL(zb));return!0}joa(zb,nb=!1){return this.vWd(zb,
!1,nb)}vBm(zb){return this.vWd(zb,!0,!1)}vWd(zb,nb,eb=!1){const Ib=new I.GraphIterator;Ib.Zc(zb);zb=new I.GraphIterator;zb.Zc(Ib);this.yA(zb,nb,!1,null,eb);zb.currentNode.setValue(y.a.mL,Math.min(X.a.nil,ca.OutlineElementReader.xga(Ib.currentNode)));Ib.Sb(1)&&N.f(zb,null,1,1,Ib,-1);return zb}Yqh(zb){if(ca.OutlineElementReader.k4n(zb)){1!==ca.OutlineElementReader.xga(zb.currentNode)&&zb.currentNode.setValue(y.a.mL,X.a.first);for(var nb=zb.Sb(1);nb;)if(ca.OutlineElementReader.dL(zb)){nb=new I.GraphIterator;
nb.Zc(zb);nb.sc();const eb=new I.GraphIterator;eb.Zc(zb);eb.Sb(1);N.f(nb,zb.currentNode,1,1,eb,-1);nb=zb.Efb(1)}else this.Yqh(zb),nb=zb.xi(1)}}static get vk(){return null!=cc.kHg?cc.kHg:cc.kHg=l.a.instance.resolve("Box4.ITableEditor")}static get paragraphEditor(){return cc.Ks||(cc.Ks=l.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(zb){cc.Ks=zb}}cc.Ks=null;Object(E.a)(cc,"OutlineElementEditor",null,[399])},1958:function(E,K,c){E=c(0);var l=c(135),f=c(57),a=c(22),k=c(2),x=
c(58),y=c(638),n=c(91),u=c(83),z=c(397),w=c(353),F=c(19),G=c(354),H=c(53),L=c(175),I=c(44),N=c(35),P=c(13),M=c(1573),J=c(116),V=c(6),X=c(15),W=c(145),U=c(7),Y=c(454),ca=c(680),aa=c(568),fa=c(119),pa=c(18),ra=c(245),la=c(247),qa=c(28),La=c(34);class Pa{constructor(sb){this.Ky=null;this.S5g=!1;this.Gp=null;this.XL=new M.a;this.ADe=new M.a;this.Ec=sb}get Jlb(){La.a(4281429,307,this.XL.count===this.ADe.count);return this.XL.count}get K3d(){return this.S5g}set K3d(sb){this.S5g=sb}r1b(sb){this.Ky=sb}get lX(){return null}frh(sb,
ab){this.XL.add(sb);this.ADe.add(ab)}}Pa.glb=2712;Object(E.a)(Pa,"APicturePasteHandler",null,[675]);var Ka=c(251),Na=c(3),sa=c(9),wa=c(1145),ja;(function(sb){sb[sb.unknown=0]="unknown";sb[sb.other=1]="other";sb[sb.file=2]="file";sb[sb.blob=3]="blob";sb[sb.chromeExtension=4]="chromeExtension";sb[sb.cid=5]="cid"})(ja||(ja={}));Object(E.b)("UnsupportedUrlScheme",ja);var ha=c(258),va=c(43),xa=c(8),ma=c(1841),Ja=c(1842),oa=c(1768);class za{constructor(){this.delay=this.retry=0}}Object(E.a)(za,"ForceInboundData",
null,[]);class Fa{constructor(sb,ab,Ga,Ua){this.zUd=!1;this.request=sb;this.b4n=ab;this.url=Ua;this.KBm=Ga}}Object(E.a)(Fa,"PicturePasteRequestInfo",null,[]);var kb=c(394);c.d(K,"a",function(){return lb});const fb=["ImageInsertFailed"];class lb extends Pa{constructor(sb,ab,Ga,Ua,wb,cc=null,zb=null,nb=!1,eb=null,Ib=null){super(sb);this.Nl=l.a.nil;this.hB=new M.a;this.sLa=0;this.Wvc=this.Zch=null;this.jbh=!1;this.Xyc=null;this.gjd=new M.a;this.Rp=null;this.qFn=()=>{var Xa=this.JMl(),Ra=131073;this.g9j&&
(Ra=1073872970);Xa=f.a.fo(Xa,Y.a.cellId,this.Gp.nm.toString());Xa=f.a.fo(Xa,Y.a.lX,this.Nl.toString());Xa=f.a.fo(Xa,Y.a.classId,Ra.toString());this.Gp.FH&&(Xa=f.a.fo(Xa,Y.a.FH,this.Gp.FH));Xa=f.a.fo(Xa,Y.a.Cqb,"1");Xa=f.a.fo(Xa,ca.a.imageType,"1");Xa=Ka.a.instance.BZe(Xa);this.Gp.contentReplicator&&this.Gp.contentReplicator.eIb&&(Xa=f.a.fo(Xa,Y.a.m3e,"1"));let gb=0;Ra=Xa;var Bb=new M.a;const $b=new M.a,Qb=new M.a,Ac=new M.a,Db=new M.a,dc=new M.a;var Pb="",Ub=a.a.instance.Na("Box4.IFeatureHelper");
Ub=!!Ub&&Ub.isFeatureEnabled(11)&&Ub.isFeatureEnabled(49);for(let vc=0;vc<this.Jlb;vc++){var rb=this.ADe.J(vc);U.ULS.shipAssertTag(7869452,307,!!rb.src);U.ULS.shipAssertTag(7869453,307,""!==rb.src);U.ULS.shipAssertTag(7869454,307,19922944>rb.src.length);const Sa=this.XL.J(vc);var Yb=Sa.node.ia(J.a.CJ,ha.a.Ft);this.WUo(Sa.blob,rb);var Ya=rb.alt;var Ob=rb.dkl;Ob||(Ob=Ya,Ya="");const Ab=Sa.blob;Yb=ma.a.construct(Ab?Ab.id.toString():Sa.node.id.toString(),rb.src,Ya,rb.width,rb.height,Ob,Yb,Sa.mU,!!Ab&&
Ab.properties.ia(V.a.lha,!1),Ab?Ab.properties.ia(J.a.bga,-1):-1,Ab?Ab.properties.ia(V.a.Ykb,Box4Intl.Box4Strings.l_Picture):"",Sa.node.properties.ia(X.a.Hwa,!1),null,null,null,rb.MDd);rb.src.startsWith("data:")?(Ob=!1,Ub&&rb.MDd?(Ob=!0,rb=Db,Ya=dc):(rb=Qb,Ya=Ac),rb.add(Yb),Ya.add(Sa),Ob=Ja.a.construct(rb.toArray(),!Ob,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null,Ob),Ob=N.c(Ob),Ob.length>lb.Ean?(U.ULS.shipAssertTag(7869456,307,1<rb.count),rb.remove(Yb),
Ya.remove(Sa),Ob=this.hB.count?(new x.a(this.Nl,gb)).toString():this.Gp.contentReplicator.Bt.toString(),Ra=f.a.fo(Ra,Y.a.Vta,Ob),Ra=f.a.fo(Ra,Y.a.Cfc,gb.toString()),pa.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Ra=f.a.fo(Ra,Y.a.XQb,"1")),this.hB.add(new Fa(Ja.a.construct(rb.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null),Pb,Ya,Ra)),gb+=Qb.count,rb=new M.a,rb.add(Yb),Ya=new M.a,Ya.add(Sa)):Pb=Ob):(Bb.add(Yb),$b.add(Sa))}Qb.count&&(Ra=
Xa,Ob=this.hB.count?(new x.a(this.Nl,gb)).toString():this.Gp.contentReplicator.Bt.toString(),Ra=f.a.fo(Ra,Y.a.Vta,Ob),Ra=f.a.fo(Ra,Y.a.Cfc,gb.toString()),pa.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Ra=f.a.fo(Ra,Y.a.XQb,"1")),Pb=Ja.a.construct(Qb.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null),this.hB.add(new Fa(Pb,N.c(Pb),Ac,Ra)),gb+=Qb.count,this.gjd.add(lb.ulf));Bb.count&&(Ra=Xa,Ob=this.hB.count?(new x.a(this.Nl,gb)).toString():
this.Gp.contentReplicator.Bt.toString(),Ra=f.a.fo(Ra,Y.a.Vta,Ob),Ra=f.a.fo(Ra,Y.a.Cfc,gb.toString()),Ra=f.a.fo(Ra,Y.a.XQb,"1"),Bb=Ja.a.construct(Bb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null),this.hB.add(new Fa(Bb,N.c(Bb),$b,Ra)),k.AFrameworkApplication.Fha("WoInc325;WoInc325cf"),this.gjd.add(this.CVg));Db.count&&(Ra=Xa,Ob=this.hB.count?(new x.a(this.Nl,gb)).toString():this.Gp.contentReplicator.Bt.toString(),Ra=f.a.fo(Ra,Y.a.Vta,Ob),Ra=
f.a.fo(Ra,Y.a.Cfc,gb.toString()),Ra=f.a.fo(Ra,Y.a.XQb,"1"),Xa=Ja.a.construct(Db.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Gp.sr:null,!0),this.hB.add(new Fa(Xa,N.c(Xa),dc,Ra)),this.gjd.add(this.CVg));U.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.hB?this.hB.count:-1)+" picture paste requests to send");this.aob()};this.picturePasteRequestSucceeded=Xa=>{var Ra;U.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",
this.PYl(Xa));if(({group:gb}=aa.a.l1(Xa.data.we)).returnValue){var gb=gb.Responses[0];if(gb.StatusCode)if(46!==gb.StatusCode||this.hB.J(this.sLa).zUd){U.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+gb.StatusCode);Xa=Object.assign(new fa.a,{extendedProperties:new Map});Xa.extendedProperties.set("statuscode",gb.StatusCode.toString());if(null===(Ra=k.AFrameworkApplication.K)||void 0===Ra?0:Ra.$("ShouldLogPicturesExtendedHealthKpis")){var Bb={name:kb.c.L9b,errorNameOverride:null,
isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Xa};Xa.extendedProperties.set("ErrorLevel","warning");this.Nh.logKpiFailure({kpiName:kb.c.OEa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Xa},optionalVeto:Bb})}else u.Health.instance.recordQosError("PictureRemotePasteFailed",fb,!1,!0,!1,!1,Xa);this.nmm()}else this.hB.J(this.sLa).zUd=!0,this.aob();else{gb=Ra="";Xa&&Xa.data&&Xa.data.wj&&(ca.a.VH in Xa.data.wj&&
Xa.data.wj[ca.a.VH]&&(gb=Xa.data.wj[ca.a.VH]),"X-CorrelationId"in Xa.data.wj&&Xa.data.wj["X-CorrelationId"]&&(Ra=Xa.data.wj["X-CorrelationId"]));U.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",gb,Ra);(null===(Bb=k.AFrameworkApplication.K)||void 0===Bb?0:Bb.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Nh.logKpiSuccess({kpiName:kb.c.OEa});this.Xyc&&(this.Xyc.stop(),this.Xyc=null);this.sLa++;this.yDj&&this.aob();this.Zch=this.Gp.contentReplicator.Bt;
let $b=null;$b=Object.assign(new za,{retry:0,delay:this.gjd.J(this.sLa-1)});Xa=new n.a(2,1,lb.ulf,()=>{this.Gp.contentReplicator.D$d(this.a1h,null,$b)},124);this.Hb.Wb(Xa)}}else U.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),Xa=new y.a(Xa.data),this.Jfc(Xa)};this.a1h=Xa=>{const Ra=!x.a.Zp(this.Zch,this.Gp.contentReplicator.Bt);U.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",Ra);if(Ra)this.Xzh();else{const gb=
Xa?Xa:null;if(Xa&&gb&&gb.retry<lb.CGl){gb.retry+=1;Xa=new n.a(2,1,gb.delay,()=>{this.Gp.contentReplicator.D$d(this.a1h,null,gb)},125);this.Hb.Wb(Xa);return}Xa=lb.ulf;null!=gb&&(Xa=gb.delay);Xa=new n.a(2,1,Xa,()=>{this.Gp.contentReplicator.D$d(null,null,null)},125);this.Hb.Wb(Xa);this.Yzh()}lb.ARf--;k.AFrameworkApplication.va.processAction(P.a.V7a,2);oa.a.instance.ymc(this.Gp,0);this.Fug();this.uu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.Jfc=Xa=>{var Ra,gb="",Bb="";Xa&&Xa.data&&
Xa.data.wj&&("X-CorrelationId"in Xa.data.wj&&Xa.data.wj["X-CorrelationId"]&&(gb=Xa.data.wj["X-CorrelationId"]),ca.a.VH in Xa.data.wj&&Xa.data.wj[ca.a.VH]&&(Bb=Xa.data.wj[ca.a.VH]));Bb=""===Bb?"":String.format("[Operation Result: {0}]",Bb);gb=""===gb?"":String.format("[X-CorrelationID: {0}]",gb);U.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",Bb,gb,Xa.data.Qe,z.SessionStatusManager.instance.OH);9===Xa.data.status||this.hB.J(this.sLa).zUd?
(oa.a.instance.ymc(this.Gp,127),this.HBh(),this.Xyc=null,(null===(Ra=k.AFrameworkApplication.K)||void 0===Ra?0:Ra.$("ShouldLogPicturesExtendedHealthKpis"))?(Xa=Object.assign(new fa.a,{extendedProperties:new Map([["HttpStatus",String(Xa.data.Qe)],["ConnectionState",String(z.SessionStatusManager.instance.OH)],["OperationResult",Bb],["CorrelationId",gb],["ErrorLevel","warning"]])}),this.Nh.logKpiFailure({kpiName:kb.c.OEa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,
additionalValues:Xa},optionalVeto:{name:kb.c.L9b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):u.Health.instance.recordQosError("PictureRemotePasteFailed",fb,!1,!0,!1,!1,null)):(this.hB.J(this.sLa).zUd=!0,this.aob())};this.Nh=w.a.getInstance(kb.a);this.Oj=ab;this.Hb=Ga;this.Jm=Ua;this.ge=sa.App.xa.Gq;this.BDe=cc;this.P6=zb;this.G$j=nb;this._operationId=eb;this.uhk=Ib;this.CVg=k.AFrameworkApplication.K.mc("PicturePasteHttpForceInboundDelay",
3E3);this.jbh=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;sa.App.hlc.addHandler(this);this.g9j=!!wb&&wb.isFeatureEnabled(121)}get uu(){return this.Rp||(this.Rp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get Ifc(){return sa.App.Ifc}get HMi(){return this.Jlb===sa.App.gMf}get yDj(){return this.sLa!==this.hB.count}Fug(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>
{const sb=a.a.instance.Sa("Common.ISystemInitiatedFeedback");sb&&sb.execute(ab=>{ab.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get lX(){return this.Nl}txa(sb){var ab;sb.alt.length>Pa.glb&&(sb.alt=sb.alt.substring(0,F.a.pz(sb.alt,Pa.glb)?Pa.glb-1:Pa.glb));this.Nh.logKpiUsage({kpiName:kb.c.OEa,kpiType:0});if(this.P6&&lb.mLm(sb)){this.G$j&&I.c(Na.a.Zyl);var Ga="unknown";this.jbh&&(sb=new URL(sb.src),Ga=ja[wa.a.xRo(sb.protocol)]);U.ULS.sendTraceTag(41969745,
322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,Ga,this.uhk);sb=Object.assign(new fa.a,{extendedProperties:new Map});sb.extendedProperties.set("protocol",Ga);(null===(ab=k.AFrameworkApplication.K)||void 0===ab?0:ab.$("ShouldLogPicturesExtendedHealthKpis"))?(ab={name:kb.c.L9b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:sb},sb.extendedProperties.set("ErrorLevel",
"warning"),this.Nh.logKpiFailure({kpiName:kb.c.OEa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:sb},optionalVeto:ab})):u.Health.instance.recordQosError("PictureRemoteWithLocalPath",fb,!0,!0,!1,!1,sb);this.Awo()}else ab=new G.DictionaryPropertySet,sb=this.ogj(sb),null!==sb.MDd&&"chart"===sb.MDd.type&&ab.setValue(V.a.gt,7),this.Oj.K$d(ab,sb.width,sb.height,!0),U.ULS.shipAssertTag(7869444,307,xa.ParagraphReader.Vb(this.Ec.currentNode)),this.Xyc=
this.ge.$f("WebServiceCall",lb.XBn),U.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",sb.width,sb.height)),Ga=qa.a.jw(this.Ec.currentNode),ab=this.Oj.yWd(Ga,ab),this.frh(ab,sb)}XUf(){0<this.Jlb&&(this.Nl=l.a.create(),this.Gp=this.XL.J(0).node.Bi(),U.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.Jlb),this.K3d&&(U.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.Hvo()),oa.a.instance.ing(this.Gp),this.Fug(),this.Gp.contentReplicator.forceOutbound(this.qFn,
null,null))}qge(sb){if(0<this.Jlb){const Ga=sb.ia(V.a.lha,!1),Ua=sb.ia(W.a.nWc,!1),wb=sb.ia(W.a.e4,!1);sb=sb.ia(J.a.bga,-1);for(let cc=0;cc<this.XL.count;cc++){var ab=this.XL.J(cc).blob;ab&&(ab=ab.properties,ab.setValue(V.a.lha,Ga),ab.setValue(W.a.nWc,Ua),ab.setValue(W.a.e4,wb),ab.setValue(J.a.bga,sb),this.Oj.Z8f(ab,sb))}}}I4a(){}ogj(sb){var ab=ra.WordSectionNavigator.instance.EJ(this.Ec.Nn);if(!ab)return sb;var Ga=H.a.Mi(lb.Tf.wB(ab)-lb.Tf.Lva(ab)-lb.Tf.Cna(ab),1);ab=H.a.Mi(lb.Tf.$t(ab)-lb.Tf.mJ(ab)-
lb.Tf.ZK(ab),0);U.ULS.shipAssertTag(7869449,307,0<=Ga);U.ULS.shipAssertTag(7869450,307,0<=ab);if(sb.height>Ga){const Ua=Ga/sb.height;sb.height=Ga;sb.width=Math.floor(sb.width*Ua)}sb.width>ab&&(Ga=ab/sb.width,sb.width=ab,sb.height=Math.floor(sb.height*Ga));return sb}Awo(){const sb=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;if(!this.Wvc||this.Wvc.message!==sb&&!this.Wvc.tha)this.Wvc=this.P6.Ama(sb,!1),this.P6.fA(this.Wvc)}JMl(){if(this.BDe&&this.BDe.Hgp())return this.BDe.mfp();var sb=new Sys.Net.WebRequest;
sb.set_url("PicturePaste.ashx");sb=sb.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(sb=f.a.fo(sb,Y.a.fileId,this.Gp.sr));return sb}WUo(sb,ab){if(sb&&ab){const Ga=H.a.xf(pa.ImageReader.HC(sb.properties),0);sb=H.a.xf(pa.ImageReader.JH(sb.properties),1);0<Ga&&Ga<ab.width&&(ab.width=Ga,ab.height=sb)}}aob(){const sb={},ab=l.a.create().toString();sb[lb.correlationID]=ab;k.AFrameworkApplication.Ne.tj(this.hB.J(this.sLa).url,2,this.hB.J(this.sLa).b4n,sb,!1,
2,this.picturePasteRequestSucceeded,this.Jfc,null,void 0,void 0,void 0,void 0,"26");lb.ARf++;U.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",ab)}PYl(sb){return sb&&sb.data?sb.data.Qe:-1}nmm(){oa.a.instance.ymc(this.Gp,127);this.HBh()}HBh(){U.ULS.shipAssertTag(7869458,307,this.yDj);const sb=new va.GraphTransaction(15);sb.Cb(this.XL.J(0).node);for(let ab=this.sLa;ab<this.hB.count;ab++){const Ga=this.hB.J(ab).KBm;for(let Ua=
0;Ua<Ga.count;Ua++){const wb=Ga.J(Ua).blob.properties;this.Oj.XSa(wb,Box4Intl.Box4Strings.l_PastedImageFailed);pa.ImageReader.Ykj(wb)}}sb.dispose();this.Jm.E2b(this.Gp,!1);this.Wzh()}Hvo(){const sb=new L.StandardDialog;sb.Ad=0;sb.mx(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,sa.App.gMf),null,!0);k.AFrameworkApplication.va.processAction(Na.a.d0i,2)}Ion(sb,ab){sb.alt.length>Pa.glb&&(sb.alt=sb.alt.substring(0,F.a.pz(sb.alt,Pa.glb)?
Pa.glb-1:Pa.glb));const Ga=new G.DictionaryPropertySet;this.Oj.K$d(Ga,sb.width,sb.height);ab=this.Oj.yWd(ab,Ga);sb=this.ogj(sb);this.frh(ab,sb)}Wzh(){}Xzh(){}Yzh(){}QUd(){return!!lb.ARf}static get Tf(){return la.a.instance}static mLm(sb){return!!sb&&!!sb.src&&!wa.a.yBi(sb.src)}}lb.ulf=1E3;lb.CGl=4;lb.XBn="PicturePasteRequestTime";lb.correlationID="X-CorrelationId";lb.ARf=0;lb.Ean=20971520;Object(E.a)(lb,"Box4ImageSteward",Pa,[444])},1960:function(E,K,c){E=c(0);var l=c(55),f=c(88),a=c(11),k=c(26);
class x extends Sys.UI.Control{constructor(H,L,I,N){super(document.createElement("div"));this.gZ=this.Tja=this.GL=this.Wv=this.m2=this.f9a=this.wbb=null;this.Ntc=this.Y$a=!1;this.content=this._title=null;this.Hja=0;this.Nvh=null;this.tfa=0;this.YWi=null;this.Jhh=H;this.GXb=L;this.qk=I;this.yEh=N;this.ej=L.ownerDocument;this.PUd=this.yt=this.AS=!1}get m9(){this.wbb||(this.wbb=this.ej.createElement("div"),this.wbb.id=this.kj("WACCalloutOuter"),this.wbb.className="WACCalloutOuter",this.wbb.setAttribute(k.a.qh,
k.a.suh),this.wbb.style.width=this.Hja+"px");return this.wbb}get PEc(){if(!this.f9a){this.f9a=this.ej.createElement("div");this.f9a.id=this.kj("WACCalloutBeakContainer");this.f9a.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";if(5===this.tfa||6===this.tfa||4===this.tfa)H="CalloutBeakBottomFilled_32x16x32";H=f.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.f9a.appendChild(H)}return this.f9a}set PEc(H){this.f9a=H}get ax(){return this.AS}get title(){return this._title}set title(H){this._title!==
H&&(this._title=H,this.Tja&&(this.Tja.innerText=this._title))}get yt(){return this.Y$a}set yt(H){this.Y$a!==H&&(this.Y$a=H,this.m2&&(this.m2.contains(this.GL)&&!this.Y$a?this.m2.removeChild(this.GL):!this.m2.contains(this.GL)&&this.Y$a&&this.enh()))}get PUd(){return this.Ntc}set PUd(H){this.Ntc!==H&&(this.Ntc=H,this.m2&&(this.m2.contains(this.Tja)&&!this.Ntc?this.m2.removeChild(this.Tja):!this.m2.contains(this.Tja)&&this.Ntc&&this.Ooh()))}show(){this.AS||(this.F9k(),this.LI(),this.GXb.appendChild(this.m9),
this.m9.style.display="Block",this.lmo(),this.AS=!0,this.YWi&&this.YWi())}dismiss(){this.AS&&(this.$kl(),this.GXb.removeChild(this.m9),this.AS=!1,this.yEh&&this.yEh())}dispose(){this.dismiss();this.Tja=this.GL=this.Wv=this.f9a=this.m2=this.wbb=null;Sys.Component.prototype.dispose.call(this)}kj(H){return this.get_element().id+H}F9k(){this.m2=this.ej.createElement("div");this.m2.id=this.kj("WACCalloutHeader");this.m2.className="WACCalloutHeader";this.yt&&this.enh();this.PUd&&this.Ooh();this.Wv=this.ej.createElement("div");
this.Wv.id=this.kj("WACCalloutContent");this.Wv.className="WACCalloutContent";this.Wv.style.width=190<this.Hja?this.Hja-26+"px":"164px";this.Wv.appendChild(this.content);this.m9.appendChild(this.PEc);this.m9.appendChild(this.m2);this.m9.appendChild(this.Wv)}enh(){this.GL=this.ej.createElement("a");this.GL.className="WACCalloutCloseAnchor";this.GL.id=this.kj("WACCalloutCloseAnchor");this.GL.href="#";this.m2.appendChild(this.GL);const H=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.GL.appendChild(H)}Ooh(){this.Tja=this.ej.createElement("div");this.Tja.className="WACCalloutTitle UIFontBold";this.Tja.style.width=190<this.Hja?this.Hja-30+"px":"160px";this.Tja.id=this.kj("WACCalloutTitle");this.Tja.innerText=this.title;this.m2.contains(this.GL)?this.m2.insertBefore(this.Tja,this.GL):this.m2.appendChild(this.Tja)}lmo(){var H=this.Jhh;let L;if(1===this.tfa){var I=this.Nvh.y+16;L=-16}else 2===this.tfa||3===this.tfa||0===this.tfa?(I=H.y+H.height+
15,L=-15):(I=H.y-this.m9.clientHeight-15-2,L=this.m9.clientHeight-1);this.m9.style.top=I+"px";this.PEc.style.top=L+"px";1===this.tfa?(H=this.Nvh.x-16,this.m9.style.left="50%",this.m9.style.marginLeft=-this.Hja/2+"px",I=Sys.UI.DomElement.getBounds(this.m9),this.PEc.style.left=H-I.x+"px"):(I=H.x+this.Jhh.width/2,2===this.tfa||5===this.tfa?(H=20,I-=36):0===this.tfa||4===this.tfa?(H=this.Hja/2-16,I-=this.Hja/2):(H=this.Hja-20-32,I=I-this.Hja+36),this.m9.style.left=I+"px",this.PEc.style.left=H+"px")}LI(){this.yt&&
!this.gZ&&(this.gZ=Object(l.a)(this,this.nma,"closeHandler"),this.qk.mb(a.a.click,this.GL,this.gZ,null))}$kl(){this.yt&&this.gZ&&(this.qk.uc(a.a.click,this.GL,this.gZ),this.gZ=null)}nma(){this.dismiss();return!0}}Object(E.a)(x,"Callout",Sys.UI.Control,[1365]);class y extends x{constructor(H,L,I,N,P,M=null){super(H,I,P.f1,M);this.B6g=0;this.Hja=this.z2l(N);this.a_b=L;this.Ti=P;this.PIo=7;this.Nq=this.a_b.ownerDocument.createElement("div");this.Nq.className="ModalCalloutControlOverlay";this.Nq.tabIndex=
0;this.a_b.insertBefore(this.Nq,this.a_b.firstChild)}show(){this.ax||(this.Ti.J$d(),this.Ti.ufa(!1),this.Nq.style.zIndex=String(this.Ti.ZBa),super.show(),this.zz(),this.B6g=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.PIo))}dismiss(){this.ax&&(this.Ti.nba(!1),this.h$(),this.a_b&&this.a_b.contains(this.Nq)&&this.a_b.removeChild(this.Nq),super.dismiss(),window.clearTimeout(this.B6g))}zz(){this.Ti.VZ(Object(l.a)(this,this.dismiss,"dismiss"));this.Ti.hD.mb(a.a.click,this.Nq,Object(l.a)(this,
this.onClick,"onClick"))}h$(){this.Ti.Uca(Object(l.a)(this,this.dismiss,"dismiss"));this.Ti.hD.uc(a.a.click,this.Nq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}z2l(H){let L=0;switch(H){case 0:L=190;break;case 1:L=250;break;case 2:L=300;break;case 3:L=360}return L}}Object(E.a)(y,"ModalCallout",x,[]);var n=c(7),u=c(530),z=c(176);class w extends y{constructor(H,L,I,N,P,M=null){super(H,L,I,N,P,M);this.JS=null}show(){if(!this.ax){const H=Object.assign(new u.a,{onShow:()=>
{y.prototype.show.call(this)}});z.UISurfaces.uM().then(L=>{const I=L.externalNotification();this.JS=L.addNotification(I,H);return null},L=>{n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null})}}dismiss(){this.ax&&this.JS&&(z.UISurfaces.uM().then(H=>{H.removeNotification(this.JS);return this.JS=null},H=>{n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(E.a)(w,"ReactManagedModalCallout",
y,[]);var F=c(2);c.d(K,"a",function(){return G});class G{static zLh(H,L,I,N){return F.AFrameworkApplication.ta.Nb.oQa?new w(H,L,I,N,F.AFrameworkApplication.ta,null):new y(H,L,I,N,F.AFrameworkApplication.ta,null)}}Object(E.a)(G,"ModalCalloutControlFactory",null,[])},1964:function(E,K,c){E=c(0);var l=c(53),f=c(123),a=c(19),k=c(2),x=c(82);class y{constructor(G,H){this.value=G;this.UHl=H}get zYd(){return this.UHl}}Object(E.a)(y,"ElementValueWrapper",null,[]);class n extends y{constructor(G,H,L){super(G,
H);this.pAi=L}}Object(E.a)(n,"DimensionWrapper",y,[]);var u=c(1684),z=c(1685),w=c(7);c.d(K,"a",function(){return F});class F{static get Xni(){return F.z5j}static get Bke(){return F.Tkk}static get zke(){return F.Skk}static svf(G,H,...L){H=F.Iii(H);let I=!1;H||(H=F.Khm(G,...L),I=!!H);return new y(H,I)}static Iii(G){for(const H of G)if(void 0!==H&&null!==H&&""!==H)return H.trim();return null}static Khm(G,...H){for(const L of H)if(H=G.getAttribute(L),void 0!==H&&null!==H&&(H+="",void 0!==H&&null!==H&&
""!==H))return H.trim();return null}static H7l(G,H){H=parseFloat(H);if(isNaN(H))return 0;switch(G){case "px":return Math.round(H);case "pt":return Math.round(l.a.E0(H,0,!1));case "in":return Math.round(l.a.Sba(H,0,!1));case "cm":return Math.round(l.a.Sba(f.a.BBh(H),0,!1));case "mm":return Math.round(l.a.Sba(f.a.BBh(.1*H),0,!1));default:return H}}static dee(G,H,...L){G=F.svf(G,H,...L);L=0;H=!1;if(G.value){H=G.value.endsWith("%");let I;H?(L="%",I=a.a.substring(G.value,0,G.value.length-1)):G.zYd?(L=
"px",I=G.value):(L=G.value.substr(G.value.length-2),isNaN(parseFloat(L))?I=a.a.substring(G.value,0,G.value.length-2):(L="px",I=G.value));L=F.H7l(L,I)}return new n(L,G.zYd,H)}static Vii(G){return F.dee(G,[G.style.width],"width","WIDTH","Width")}static z9h(G){return F.dee(G,[G.style.height],"height","HEIGHT","Height")}static mJ(G){return F.dee(G,[G.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static ZK(G){return F.dee(G,[G.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Phm(G){G=
F.svf(G,[G.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return G.value&&G.value in F.Bke&&void 0!==F.Bke[G.value]&&null!==F.Bke[G.value]?F.Bke[G.value]:0}static ySm(G){G=F.Iii([G.style.borderCollapse]);return!!G&&!(void 0===G||null===G)&&("collapse"===G||"COLLAPSE"===G||"Collapse"===G)}static DMl(G){return F.svf(G,[G.style.backgroundColor,G.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static k6k(G){const H=a.a.substring(G,0,1),L=a.a.substring(G,1,2);G=a.a.substring(G,
2,3);return H+H+L+L+G+G}static uua(G){let H="";if(!G||""===G)return H;H=G.trim();if(H.startsWith("rgb")){H=a.a.substring(H,H.indexOf("(")+1,H.length-1);G=H.split(",");if(3!==G.length)return"";H="";for(let I=0;I<G.length;I++){var L=parseInt(G[I]);if(isNaN(L)||0>L||255<L)return"";L=L.toString(16);1===L.length&&(L="0"+L);H+=L}return a.a.VA(H)}if(F.Xni[a.a.Ug(H)])return F.Xni[a.a.Ug(H)];H.startsWith("#")&&(H=a.a.substring(H,1,H.length));if(isNaN(parseInt(H,16)))return"";3===H.length&&(H=F.k6k(H));return 6!==
H.length?"":H}static Rzn(G){var H=G.indexOf("mso-tab-count");if(-1===H)return 0;const L=RegExp("([\\d])");let I="";for(H=H+13+1;H<G.length;H++){const N=G.charAt(H).toString();if(L.test(N))I+=N;else break}G=0;""!==I&&(G=parseInt(I));return G}static jUd(G,H){const L=F.DMl(G);L&&""!==L&&H.fv(I=>I.L9(F.uua(L)))}static L4h(G){var H,L=G.style;if(!L)return null;let I=F.zke[L.borderTopStyle];const N=F.uua(L.borderTopColor);let P=L.borderTopWidth,M=F.zke[L.borderRightStyle];const J=F.uua(L.borderRightColor);
let V=L.borderRightWidth,X=F.zke[L.borderBottomStyle];const W=F.uua(L.borderBottomColor);let U=L.borderBottomWidth,Y=F.zke[L.borderLeftStyle];const ca=F.uua(L.borderLeftColor);L=L.borderLeftWidth;k.AFrameworkApplication.te("gdea6103;0df65435");if(null===(H=k.AFrameworkApplication.K)||void 0===H?0:H.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))G=G.getAttribute("border"),null!==G&&(I=this.Bic(G,I),X=this.Bic(G,X),Y=this.Bic(G,Y),M=this.Bic(G,M),P=this.Cic(G,P),
V=this.Cic(G,V),U=this.Cic(G,U),L=this.Cic(G,L),w.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new u.a(I,M,X,Y,N,J,W,ca,P,V,U,L)}static Cic(G,H){return""===H?G+"px":H}static Bic(G,H){return 0===H?"0"===G?1:11:H}static wOl(G){var H=G.querySelectorAll("[class^=TableCellContent]");H=1===H.length?H[0]:void 0;return(G=(null===H||void 0===H?0:H.style)?H.style:G.style)?new z.a(G.paddingTop,G.paddingRight,G.paddingBottom,G.paddingLeft):null}}F.z5j=x.a.B5("aliceblue",
"F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9",
"darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia",
"FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3",
"lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise",
"48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080",
"red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5",
"yellow","FFFF00","yellowgreen","9ACD32");F.Tkk=x.a.B5("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);F.Skk=x.a.B5("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(E.a)(F,"DefaultHtmlTranslatorHelper",null,[])},1967:function(E,K,c){E=c(0);class l{constructor(a){this.next=null;this.data=a}}Object(E.a)(l,
"QueueNode",null,[]);c.d(K,"a",function(){return f});class f{constructor(){this.wtb=this.wrb=null;this.aj=0}get count(){return this.aj}get isEmpty(){return!this.count||!this.wrb||!this.wtb}enqueue(a){a=new l(a);this.isEmpty?this.wtb=this.wrb=a:this.wrb=this.wrb.next=a;this.aj=this.count+1}back(){return this.isEmpty?null:this.wrb.data}dequeue(){if(this.isEmpty)return null;const a=this.wtb;this.wtb=a.next;this.aj=this.count-1;this.wtb||(this.wrb=null);return a.data}clear(){this.wtb=this.wrb=null;this.aj=
0}toArray(){const a=Array(this.count);let k=this.wtb;for(let x=0;x<this.count&&k;x++)a[x]=k.data,k=k.next;return a}}Object(E.a)(f,"Queue",null,[])},2024:function(E,K,c){c.d(K,"b",function(){return l});c.d(K,"e",function(){return f});c.d(K,"d",function(){return a});c.d(K,"c",function(){return k});c.d(K,"h",function(){return x});c.d(K,"a",function(){return y});c.d(K,"f",function(){return n});c.d(K,"g",function(){return u});var l;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=1]="Inline";z[z.Floating=
2]="Floating"})(l||(l={}));var f;(function(z){z[z.Undefined=0]="Undefined";z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(f||(f={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=10]="Heavy"})(a||
(a={}));var k;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(k||(k={}));var x;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]="DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=7]="DashLine";
z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=17]="WavyDoubleLine"})(x||(x={}));var y;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";z[z.Justified=
3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var n;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";z[z.PageNumbers=
11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(n||(n={}));var u;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(u||(u={}))},2026:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.normal=0]="normal";f[f.beingCreated=1]="beingCreated";f[f.beingEdited=2]="beingEdited"})(l||
(l={}));Object(E.b)("CommentType",l)},2028:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{static Nqf(f){return f===l.create?0:f===l.reply?1:f===l.edit?2:f===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(E.a)(l,"CommentSessionType",null,[])},2029:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.unsaved=0]="unsaved";f[f.sentToServer=1]="sentToServer";f[f.succeeded=2]="succeeded";f[f.failed=3]="failed";f[f.saveNotNeeded=
4]="saveNotNeeded"})(l||(l={}));Object(E.b)("CommentSaveStatus",l)},2030:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this.className=f;this.eQc=a}}Object(E.a)(l,"HighlightCssClassPair",null,[])},2031:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(){this.type=this.action=0;this.JJ=this.xA=null}}Object(E.a)(l,"HighlightOperation",null,[])},2032:function(E,K,c){c.d(K,"a",function(){return f});E=c(0);K=c(231);var l=c(107);class f extends K.a{constructor(){super();
this.LastKnownPaginationRevision=this.FileId=null}al(){return 36}static Zaa(a,k){const x=new f;x.FileId=a;x.LastKnownPaginationRevision=l.a(k);return x}}Object(E.a)(f,"PaginationRequest",K.a,[])},2034:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{n8b(f,a){let k="g";a.matchCase||a.C3d||(k+="i");if(a.matchPrefix||a.matchWholeWord)f="\\b"+f;if(a.matchSuffix||a.matchWholeWord)f+="\\b";return new RegExp(f,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;
Object(E.a)(l,"FindUtils",null,[1446])},2036:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);class l{constructor(f,a){this._text=f;this.Zsc=a}get text(){return this._text}get matchCase(){return this.IHb(1)}get matchWholeWord(){return this.IHb(2)}get C3d(){return this.IHb(4)}get matchPrefix(){return this.IHb(8)}get matchSuffix(){return this.IHb(16)}get ignorePunct(){return this.IHb(32)}get ignoreSpace(){return this.IHb(64)}IHb(f){return(this.Zsc&f)===f}static createQuery(f,a){return new l(f,
a)}}Object(E.a)(l,"Query",null,[1436])},2037:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.none=0]="none";f[f.matchCase=1]="matchCase";f[f.wholeWordOnly=2]="wholeWordOnly";f[f.wildCards=4]="wildCards";f[f.prefix=8]="prefix";f[f.suffix=16]="suffix";f[f.ignorePunct=32]="ignorePunct";f[f.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(E.b)("QueryFilters",l)},2038:function(E,K,c){c.d(K,"a",function(){return y});E=c(0);var l=c(174),f=c(166),a=c(2),k=c(65),x=c(199);class y extends l.a{constructor(n,
u=!1){super(n,!1,u)}get JUc(){return!1}get TK(){return x.a.sJc+"/modeless"}get Dkb(){return null}set Dkb(n){}get zkb(){return null}set zkb(n){}Yh(n,u=null,z=null){this.eT&&(z.isModal=!1);super.Yh(n,u,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Hc)this.HFj(),a.AFrameworkApplication.ta.nx.Ww(f.AFrame.kNf),super.hide()}Lrk(){const n=a.AFrameworkApplication.ta.nx,u=a.AFrameworkApplication.ta.Dp;n.Eaa(this.TK);
n.gT(this.TK);u.fe(this.TK).parent=f.AFrame.vp}cCa(){k.FocusManager.$J()&&(super.cCa(),this.Lrk(),a.AFrameworkApplication.ta.nx.FI(f.AFrame.kNf))}S4f(){if(k.FocusManager.$J()&&!a.AFrameworkApplication.Lk){const n=k.FocusManager.instance();n.CR(this.TK);const u=n.getRegion(this.TK);u&&u.Zj.Iy(null);n.E5a(this.TK)}}Qca(){"DL"===this.TBa||"DP"===this.TBa?super.Qca():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.HFj(),this.Avh()&&this.Qsj(this.Hc.clientHeight,
this.Hc.clientWidth)):this.tL()}tL(){this.Qsj(l.a.ZQg,l.a.fRg)}Qsj(n,u){if(this.zkb&&this.Dkb){let z,w;z=x.a.z$d+this.Dkb;w=x.a.y$d+this.zkb;z+n>this.wB()&&(z=this.wB()-n);w+u>this.$t()&&(w=this.$t()-u);this.Rsj(z,w)}else super.tL()}csf(n){if(!n)return null;n.endsWith("px")&&(n=n.substring(0,n.length-2));return x.a.Tac(n)?((n=parseInt(n))||(n=1),n):null}HFj(){if(this.Hc&&this.Hc.style){var n=this.csf(this.Hc.style.top);n&&(this.Dkb=n-x.a.z$d);if(n=a.AFrameworkApplication.isRtl?this.csf(this.Hc.style.right):
this.csf(this.Hc.style.left))this.zkb=n-x.a.y$d}}}Object(E.a)(y,"ModelessCustomDialog",l.a,[])},2039:function(E,K,c){c.d(K,"a",function(){return z});E=c(0);var l=c(7),f=c(2),a=c(311),k=c(197),x=c(638),y=c(761),n=c(762),u=c(19);class z{constructor(w,F=null,G=-1,H=null){this.b7=w;this.Hkh=H||(()=>F);this.Ygd=G}tj(w,F,G,H,L,I,N,P,M,J=null,V=!1,X=null,W=null){const U=new XMLHttpRequest;let Y="";I="";2===F?(Y="POST",G&&(I=G)):Y="GET";F={};this.b7&&(w=a.a.JYe(F,w,a.a.joe,f.AFrameworkApplication.aRb,this.b7));
U.open(Y,w,!0);this.ONk(F,w);if(H)for(let aa in H)U.setRequestHeader(aa,u.a.$Q(H[aa]));for(let aa in F)U.setRequestHeader(aa,F[aa]);w=X||this.Ygd;0<w&&(U.timeout=w);w=[];Array.add(w,a.a.L7);H=new Sys.Net.WebRequest;const ca=new y.a(1,2,H,w,L,N,P,M,V,J,W);U.onreadystatechange=()=>{this.yrn(U,ca)};try{U.send(I)}catch(aa){l.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}p8b(){return 1}yrn(w,F){if(this.MVk(w,F)&&4===w.readyState)if(w.getResponseHeader(a.a.AVh)&&
f.AFrameworkApplication.FKc)f.AFrameworkApplication.FKc();else{var G=w.getResponseHeader(a.a.CAh);a.a.Hlg(G);this.ZWo(w,F);w.status===k.a.Jy?(F.status=2,F.eI(new n.a(F))):(F.status=w.status&&w.status!==k.a.ghc?w.status===k.a.sia?5:3:7,F.G3(new x.a(F)))}}ONk(w,F){w["X-xhr"]=1;f.AFrameworkApplication.e3a&&(w[a.a.dJi]=1);f.AFrameworkApplication.buildVersion&&(w[a.a.jec]=u.a.$Q(f.AFrameworkApplication.buildVersion));let G=null;this.Hkh&&(G=this.Hkh());G&&(w[a.a.wog]=G);f.AFrameworkApplication.canary&&
(w[a.a.c2b]=u.a.$Q(f.AFrameworkApplication.canary),f.AFrameworkApplication.TXc&&l.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",w[a.a.c2b]));f.AFrameworkApplication.accessToken&&(a.a.uAb(F,f.AFrameworkApplication.h7)||(w[a.a.JXe]=u.a.$Q(f.AFrameworkApplication.accessToken)),a.a.uAb(F,f.AFrameworkApplication.YBa)||(w[a.a.KXe]=f.AFrameworkApplication.DMa.toString()));f.AFrameworkApplication.userType&&(w[a.a.nIj]=u.a.$Q(f.AFrameworkApplication.userType))}ZWo(w,F){F.Qe=w.status?w.status:k.a.ghc;
try{F.we=w.responseText;if(void 0!==F.DSa&&null!==F.DSa){F.wj={};for(let G=0;G<F.DSa.length;++G){const H=F.DSa[G];F.wj[H]=w.getResponseHeader(H)}}F.Qhe&&(F.Fia=w.responseText&&w.responseText.length?w.responseXML:null)}catch(G){l.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",F.id,F.request.get_url(),4===w.readyState)}}MVk(w,F){return w?F?!0:(l.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(l.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(w,F,G){return new z(w,null,G,F)}}Object(E.a)(z,"SimpleClientRequestSender",null,[1196])},2040:function(E,K,c){c.d(K,"a",function(){return l});E=c(0);var l;(function(f){f[f.connected=0]="connected";f[f.disconnected=1]="disconnected";f[f.connecting=2]="connecting";f[f.timeout=3]="timeout"})(l||(l={}));Object(E.b)("AppNetworkConnectivityState",l)},2041:function(E,
K,c){c.d(K,"a",function(){return l});E=c(0);class l{tOa(){}d6b(){}nhe(){}Gfe(){}reset(){}kkf(){}update(){}tob(){}dispose(){}}Object(E.a)(l,"FindStatusManagerStub",null,[533,10])},2049:function(E,K,c){c.d(K,"b",function(){return l});c.d(K,"a",function(){return f});var l;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(l||(l={}));var f;(function(a){a.left="left";a.center=
"center";a.right="right";a.both="both"})(f||(f={}))},2069:function(E,K,c){E=c(0);var l=c(1603),f=c(1604),a=c(1667),k=c(223),x=c(35);class y{}y.eventType="Type";y.kgb="Time";y.eventId="Id";y.hvh="AttributionId";y.ivh="AttributionProvider";y.gvh="AttributionName";y.Ruh="AssigneeId";y.Suh="AssigneeProvider";y.Quh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.xFh="Anchor";y.anchorExtensionList="AnchorExtensionList";y.l0i="Percent";y.priority="Priority";y.undoId="UndoId";y.isLossy=
"IsLossy";y.recordExtensionList="RecordExtensionList";Object(E.a)(y,"Key",null,[]);var n=c(365),u=c(1808);const z=F=>{if(!F)return null;let G=null;F=n.a.C3b(F,H=>H.toString(),H=>H.toString());0<F.count&&(G=new u.a(F));return G};c.d(K,"a",function(){return w});class w{n$f(F){if(!F)return"[]";F=w.$5k(F);return x.c(F)}y4b(F){F=x.b(F||"[]");return w.J5k(F)}static Bda(F,G){throw Error.argument(F,G);}static W7b(F,G){G=G.toString();return G in F?F[G].toString():null}static eFb(F,G){G=G.toString();G in F||
w.Bda("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",G));return F[G].toString()}static Qqf(F,G){G=G.toString();G in F||w.Bda("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",G));return Number.parseInvariant(F[G].toString())}static a5l(F,G,H){G=G.toString();return G in F?Boolean.parse(F[G].toString()):H}static b5l(F,G){G=G.toString();return G in F?F[G]:null}static ogg(F){F=new Date(F);isNaN(F.getUTCMilliseconds())&&w.Bda("dateTime",
"Date and time is in invalid format");return F}static Fcf(F){return F.toISOString()}static MKh(F,G){return z(w.b5l(F,G))}static a6k(F){const G={};G[y.eventType]=F.type;G[y.kgb]=w.Fcf(F.time);G[y.eventId]=F.recordId;F.isLossy!==w.qyi&&(G[y.isLossy]=F.isLossy);F.user&&(F.user.UserId&&F.user.Provider&&F.user.DisplayName||w.Bda("record","HistoryRecord has invalid attribution"),G[y.hvh]=F.user.UserId,G[y.ivh]=F.user.Provider,G[y.gvh]=F.user.DisplayName);F.commentId&&(G[y.xFh]=F.commentId);if(F.anchorExtensionList&&
F.anchorExtensionList.extensions){var H=F.anchorExtensionList.extensions.tlc();G[y.anchorExtensionList]=H}F.recordExtensionList&&F.recordExtensionList.extensions&&(H=F.recordExtensionList.extensions.tlc(),G[y.recordExtensionList]=H);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee&&F.assignee.UserId&&F.assignee.Provider&&F.assignee.DisplayName||w.Bda("record","HistoryRecord has invalid assignee");G[y.Ruh]=F.assignee.UserId;G[y.Suh]=F.assignee.Provider;G[y.Quh]=F.assignee.DisplayName;
break;case 5:F.schedule||w.Bda("record","Schedule history record must have a schedule object");F.schedule.startDate&&(G[y.startDate]=w.Fcf(F.schedule.startDate));F.schedule.endDate&&(G[y.endDate]=w.Fcf(F.schedule.endDate));break;case 6:(0>F.completion||100<F.completion)&&w.Bda("record","Progress history record must have a completion >= 0 and <= 100");G[y.l0i]=F.completion;break;case 10:(0>F.priority||10<F.priority)&&w.Bda("record","Priority history record must have a completion >= 0 and <= 10");G[y.priority]=
F.priority;break;case 9:F.title||w.Bda("record","SetTitle history record must have a title");G[y.title]=F.title;break;case -1:F.undoId||w.Bda("record","Undo history record must have an id to undo");G[y.undoId]=F.undoId;break;default:w.Bda("record","Unsupported history record type")}return G}static j6k(F){var G=null,H=w.W7b(F,y.hvh);const L=w.W7b(F,y.ivh),I=w.W7b(F,y.gvh);if(H||L||I)H&&L&&I||w.Bda("dictionary","Record has invalid attribution user"),G=new l.a(H,L,I);G=new f.a(w.Qqf(F,y.eventType),G,
w.ogg(w.eFb(F,y.kgb)),w.eFb(F,y.eventId));G.commentId=w.W7b(F,y.xFh);G.anchorExtensionList=w.MKh(F,y.anchorExtensionList);G.recordExtensionList=w.MKh(F,y.recordExtensionList);G.isLossy=w.a5l(F,y.isLossy,w.qyi);switch(G.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:G.assignee=new l.a(w.eFb(F,y.Ruh),w.eFb(F,y.Suh),w.eFb(F,y.Quh));break;case 5:G.schedule=new a.a;if(H=w.W7b(F,y.startDate))G.schedule.startDate=w.ogg(H);if(F=w.W7b(F,y.endDate))G.schedule.endDate=w.ogg(F);break;case 10:G.priority=
w.Qqf(F,y.priority);(0>G.priority||10<G.priority)&&w.Bda("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:G.completion=w.Qqf(F,y.l0i);(0>G.completion||100<G.completion)&&w.Bda("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:G.title=w.eFb(F,y.title);break;case -1:G.undoId=w.eFb(F,y.undoId);break;default:w.Bda("dictionary","Unsupported history record type")}return G}static $5k(F){const G=Array(F.length);for(let H=0;H<F.length;++H)G[H]=w.a6k(F.J(H));
return G}static J5k(F){const G=new k.a;for(const H of F)F=w.j6k(H),G.add(F);return G}}w.qyi=!1;Object(E.a)(w,"JsonTaskHistorySerialization",null,[590])},2070:function(E,K,c){E=c(0);var l=c(2),f=c(7),a;(function(x){x[x.Healthy=0]="Healthy";x[x.MissedScan=1]="MissedScan";x[x.NeedsReset=2]="NeedsReset";x[x.CriticalUnresponsive=3]="CriticalUnresponsive";x[x.KickoutComponent=4]="KickoutComponent"})(a||(a={}));Object(E.b)("TimerBasedWatchDogStatus",a);c.d(K,"a",function(){return k});class k{constructor(x,
y,n){this.utd=this.Z2g=this.b4g=this.rTb=this.RAa=0;this.kOi=3;this.LHd=3E4;this.VZb=x;this.C9a=y;this.$ji=n}O5a(){this.RAa=0}async zdn(){const x=Date.now(),y=this.VZb.rcc;this.utd++;if(this.Z2g==y&&this.cto(x,this.b4g))return{["WatchDogScanTime"]:x,["LastComponentScanTime"]:y,["ComponentStatus"]:a[this.rTb],["ActionTaken"]:"None. Skipping to Match Interval"};this.Z2g=y;this.b4g=x;this.C9a=this.VZb.LNh;this.rTb=this.T5h(x,y);3===this.rTb&&(await this.tPo(),this.rTb=this.T5h(x,this.VZb.rcc));return this.oBk(this.rTb,
x,y)}uUm(){return 0===this.rTb}T5h(x,y){let n=0;x>y+Math.max(this.C9a,this.LHd)+this.$ji&&(n=0===this.RAa?1:this.RAa<this.kOi?2:this.RAa===this.kOi?3:4);return n}oBk(x,y,n){const u={};u.WatchDogScanNumber=this.utd;u.WatchDogScanTime=y;u.LastComponentScanTime=n;u.ComponentStatus=a[x];u.ExpectedComponentScanInterval=this.C9a;u.GraceTimeInMS=this.$ji;u.ActualTimeBetweenWatchDogAndComponentScans=y-n;switch(x){case 0:u.ActionTaken="None";this.RAa=0;break;case 1:this.RAa++;u.ActionTaken="Missed Scan, Wait to Restart component";
break;case 2:this.RAa++;u.ActionTaken="Component restarted";f.ULS.sendTraceTag(509686347,3037,15,"Restarting Component with interval {0}",this.C9a);this.VZb.dvj();x=this.C9a;this.CFf&&(x=Math.min(this.C9a,this.LHd/2));this.VZb.puj(x);break;case 3:this.RAa++;u["ActionTaken?"]="Attempted Synchronous run: "+a[x];break;case 4:f.ULS.sendTraceTag(512570578,3037,10,"Component is not Responding. WatchDog would kickout now"),u["ActionTaken?"]="Kickout would happen here",this.RAa++}u.NextExpectedComponentScanTimeInMs=
n+(this.RAa+1)*this.C9a;u.MissedScans=this.RAa;return u}async tPo(){return this.VZb.i1h()}cto(x,y){return y+this.C9a>x}get CFf(){return null!=this.YCg?this.YCg:this.YCg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}}Object(E.a)(k,"TimerBasedWatchDog",null,[1471])},2072:function(E,K,c){E=c(0);class l{constructor(k){this.result=null;this.X7i=k}exec(k){return(this.result=this.X7i.exec(k))?!0:!1}kJ(){return this.result.index}YPd(){return this.X7i.lastIndex}}
Object(E.a)(l,"RegularExpressionWrapper",null,[]);var f=c(19);c.d(K,"a",function(){return a});class a{I1c(k){return this.buj(k).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}m2i(k){var x=k.text;x=k.C3d?this.hAo(x):this.buj(x);if(k.ignorePunct||k.ignoreSpace){let y="";k.ignoreSpace&&(y+="\\s");k.ignorePunct&&(y+=a.UJn);y="["+y+"]*";for(let n=1;n<x.length;n++)if(!k.C3d||"{"!==x[n].charAt(0)&&"@"!==x[n].charAt(0))x[n]=y+x[n]}return x.join("")}dLb(k){return[k]}O_d(k){for(let x=
0;x<k.length;++x){const y=k.charAt(x);let n=0;if("["===y){if(!({KD:n}=this.VRm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("<"===y){if(!this.SRm(k.substr(x)))return!1}else if(">"===y){if(!x)return!1}else if("{"===y){if(!x||!({KD:n}=this.URm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("@"===y){if(!x||!this.TRm(k.substr(x)))return!1}else if("("===y){if(!({KD:n}=this.RRm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}i_h(k,x){let y,n;n=y=
0;if(k.length<=x)return{returnValue:!1,KD:y,Qbd:n};const u=k.length;var z=k.charAt(x);if("["===z)for(z=x+1;z<u;z++){if("]"===k.charAt(z)&&1!==z-x)return y=z,n=5,{returnValue:!0,KD:y,Qbd:n}}else if("{"===z)for(z=-1,x+=1;x<u;x++){let w=k.charAt(x);if(","===w)z=x;else if("}"===w)return n=-1===z?6:1!==x-z?7:8,y=x,{returnValue:!0,KD:y,Qbd:n}}return{returnValue:!1,KD:y,Qbd:n}}ROo(k,x,y){let n;if((n=x)||1!==k.length)switch(k.charAt(x+1)){case "{":let u,z;if(!({KD:u,Qbd:z}=this.i_h(k,x+1)).returnValue)return{returnValue:this.vIa("*",
y,!1),KD:n};k=this.vIa("*",y,!0)+this.vIa(k.substring(x+1,u+1),z);n=u;if(7===z||8===z)k+="?";return{returnValue:k,KD:n};case "@":return n=x+1,{returnValue:this.vIa("*",y,!0),KD:n};case "*":if(!x){for(n++;"*"===k.charAt(n);)n++;if(n===k.length)return{returnValue:this.vIa("*",y,!0),KD:n}}return{returnValue:this.vIa("*",y,!1),KD:n};default:return{returnValue:this.vIa("*",y,!1),KD:n}}else return{returnValue:this.vIa(k,y,!0),KD:n}}vIa(k,x,y=!1){const n=k.length;switch(x){case 5:return"!"===k.charAt(1)&&
2<n?"([^"+this.n2i(k.substr(2,n-3))+"]\u0640*)":"(["+this.n2i(k.substr(1,n-2))+"]\u0640*)";case 6:return k;case 7:return k;case 9:return"+?";case 8:return k;case 3:return"\\b";case 4:return"\\b";case 1:return".";case 2:return y?"(.+?)":"(.*?)";case 10:return k}return null}Xii(k){switch(k){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}wEn(k){return"["===k||"]"===k||"\\"===k||"("===k||")"===k?String.format("\\{0}",k):"'"===k||"\u2018"===k||"\u2019"===
k||'"'===k||"\u201c"===k||"\u201d"===k||f.a.lca(k)?this.Q_f(k):k}n2i(k){const x=[];for(let y=0;y<k.length;++y)x[y]=this.wEn(k.charAt(y));return x.join("")}VRm(k){let x;var y;x=-1;var n=new l(RegExp("\\[.+?\\]","g"));if(n.exec(k)){if(y=n.kJ())return{returnValue:!1,KD:x};x=n.YPd()}else return{returnValue:!1,KD:x};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(k.substring(1,x-1)))return{returnValue:!1,KD:x};y=new l(RegExp("[^!\\[]-[^\\]]","g"));for(k.substring(0,x);y.exec(k.substring(0,x));){n=y.kJ();
const u=RegExp("[-]","g");n=k.substring(n,y.YPd()).split(u);if(n[0].charAt(0)>n[1].charAt(0))return{returnValue:!1,KD:x}}return{returnValue:!0,KD:x}}SRm(k){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(k)?!1:!0}URm(k){let x;x=-1;var y;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(k))return{returnValue:!1,KD:x};const n=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(n.exec(k)){if(y=n.kJ())return{returnValue:!1,KD:x};x=n.YPd();y=RegExp("[{,}]","g");y=k.substring(0,x).split(y);if(4===
y.length&&(k=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),k>=y))return{returnValue:!1,KD:x}}else return{returnValue:!1,KD:x};return{returnValue:!0,KD:x}}TRm(k){return(new l(RegExp("\\@\\{","g"))).exec(k)?!1:!0}RRm(k){let x;x=-1;let y;const n=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(n.exec(k)){y=n.kJ();x=n.YPd();if(y)return{returnValue:!1,KD:x};if(this.O_d(k.substring(1,x-1)))return{returnValue:!0,KD:x}}return{returnValue:!1,KD:x}}hAo(k){const x=[],y=k.length;let n=0;
for(let u=0;u<y;++u){const z=n,w=k.charAt(u);let F=0,G=0;"["===w||"\\"===w||"^"===w||"$"===w||"."===w||"|"===w||"+"===w||"("===w||")"===w||"?"===w||"*"===w||"<"===w||">"===w||"@"===w||"?"===w||"{"===w?"["!==w&&"{"!==w||!({KD:F,Qbd:G}=this.i_h(k,u)).returnValue?"?"===w||"<"===w||">"===w||"@"===w?(G=this.Xii(w),x[z]=this.vIa(w,G)):"*"===w?(G=this.Xii(w),x[z]=({KD:F}=this.ROo(k,u,G)).returnValue,u=F):"("===w||")"===w?(G=10,x[z]=this.vIa(w,G)):x[z]=String.format("\\{0}",w):(x[z]=this.vIa(k.substr(u,F+
1-u),G),u=F):x[z]="'"===w||"\u2018"===w||"\u2019"===w||'"'===w||"\u201c"===w||"\u201d"===w||"-"===w||"\u2013"===w||"\u2014"===w||f.a.lca(w)?"["+this.Q_f(w)+"]":"\u2026"===w?"\\.\\.\\.":w;""!==x[z]&&0===G&&(x[z]=u<k.length-1&&("@"===k.charAt(u+1)||"{"===k.charAt(u+1))?"("+x[z]+"\u0640*)":x[z]+"\u0640*");n++}return x}buj(k){const x=[];for(let y=0;y<k.length;++y){const n=k.charAt(y);x[y]="["===n||"\\"===n||"^"===n||"$"===n||"."===n||"|"===n||"+"===n||"("===n||")"===n||"?"===n||"*"===n?String.format("\\{0}",
n):"'"===n||"\u2018"===n||"\u2019"===n||'"'===n||"\u201c"===n||"\u201d"===n||"-"===n||"\u2013"===n||"\u2014"===n||f.a.lca(n)?"["+this.Q_f(n)+"]":"\u2026"===n?"\\.\\.\\.":n;""!==x[y]&&(x[y]+="\u0640*")}return x}Q_f(k){return"'"===k||"\u2018"===k||"\u2019"===k?"'\u2018\u2019":'"'===k||"\u201c"===k||"\u201d"===k?'"\u201c\u201d':"-"===k||"\u2013"===k||"\u2014"===k?"-\u2013\u2014":f.a.lca(k)?a.VPo:k}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.VPo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";
a.UJn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(E.a)(a,"WordQueryProcessor",null,[1277])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19660862/wdjs/WordEditorDSVersionHistoryRemoved.common.js.map